import{a as I}from"../chunk-T5C54KDK.js";import{a as C}from"../chunk-ZZTYZOVH.js";import{a as x}from"../chunk-FE2D6PWX.js";import{a as W}from"../chunk-HUQAMCEL.js";import{a as w}from"../chunk-Z2BWQNYI.js";import"../chunk-DHKC46AY.js";import{d as v,h as E}from"../chunk-IZOY2GXC.js";import{a as m}from"../chunk-AEEBJP5X.js";import{a as y}from"../chunk-NGPHGB55.js";import{a as f}from"../chunk-2QPOFOOR.js";import{a as h,b as l,c as ke,e as M,f as Te,g as J,h as T,j as F}from"../chunk-2DNXUWM5.js";import"../chunk-EDKSZH7L.js";function st(s){if(s&&s.length>0)return v`${s.map(e=>v`${I(e.html)}`)}`}function Ce(s,e,t=!1){return v`<div data-mod-name="welcomeback">
    <div class="wbcontent__top">
      <div class="welcome">
        ${I(s)}<span class="greetings">Das k√∂nnte Sie auch interessieren</span>
      </div>
    </div>

    <div class="wbcontent ${t?"has-taboola":""}">
      <div class="wbcontent__teasers">
        ${t?at():ot(e)}
      </div>

      <div class="wbcontent__hpad">
        <div class="co-container-container">
          <div class="co-container co-wbhalfpage js-co-dynamic" data-service-param-tagid="rectangle_layer"></div>
        </div>
      </div>
    </div>

    <!--hide further popups-->
    <a href="#" class="hint js-shownomore">Nicht mehr anzeigen</a>
  </div>`}var ot=s=>v`
  <div class="teaser-list-horizontal">
    ${st(s)}
  </div>
`,at=()=>v`
  <div class="co-container-container">
    <div class="co-container co-taboola-wb" data-service-param-tagid="rectangle_layer" data-taboola-wb></div>
  </div>
`;var G=class{},Z=class{constructor(){this.name_="welcomeback";this.dataURL_="";this.shutdown=!1;this.welcomeBackTimeOut=window.ui.wb&&window.ui.wb.timeout>=0?window.ui.wb.timeout:void 0}logError(e){h.logUnknownError(e,this.name_),l.publish("sentry:log",{error:e,module:this.name_})}start(){try{if(this.welcomeBackTimeOut===void 0||f.isMobile()){h.log(this.name_,"No ui.wb.timeout object in body. Module init cancelled.");return}l.subscribe("welcomeback:restartWBTimer",()=>{h.log(this.name_,"welcomeback:restartWBTimer"),this.shutdown=!1,this.restartWBTimer()}),l.subscribe("welcomeback:stopWBTimer",e=>{this.shutdown=e!==void 0,this.welcomeBackTimer_&&clearTimeout(this.welcomeBackTimer_)}),l.subscribe("windowScrolling",()=>{this.restartWBTimer()}),l.subscribe("visibilityStateChanged",e=>{this.handleVisibilityStateChange(e)})}catch(e){this.logError(e)}}showAd(e){if(!f.isDesktop())return;let t=e.getElementsByClassName("co-container")[0];t&&l.publish("dynamicAdsNeeded",[t])}handleJsonData(){h.log(this.name_,"handleJsonData()"),M.getJSON(this.dataURL_).then(e=>{this.openWelcomeBack(e)}).catch(e=>this.logError(e))}openWelcomeBack(e){h.log(this.name_,"openWelcomeBack()");try{let t=T.fromHtml(""),i=!this.adblockerDetected()&&window.ui.wb?.taboola;E(Ce(e.mandant,e.recommended,i),t);let n=document.createElement("div");n.style.display="none",n.appendChild(t),l.publish("overlay:showWelcomeback",{content:n.innerHTML,module:"welcomelayer",opts:{wbTrackingVar:e.clickSuffix},callback:r=>{this.moduleNode=r.querySelector('[data-mod-name="welcomeback"]'),this.moduleNode&&(this.handleWBEvents(this.moduleNode),this.showAd(this.moduleNode))}})}catch(t){this.logError(t)}}setWBCookie(e){let t=new G;try{switch(e){case"hideForever":t.hide=!0;break;case"pageInactive":t.timestamp=Date.now();break;default:break}Object.keys(t).length>0&&localStorage.setItem(e,JSON.stringify(t))}catch(i){this.logError(i)}}handleCookieData(e){let t=!1;h.log(this.name_,"handleCookieData "+e);try{t=this.parseLocalStorage(e)}catch(i){this.logError(i)}return t}parseLocalStorage(e){let t=!1;try{let i=localStorage.getItem(e);if(i){let n=JSON.parse(i);n&&(h.log(this.name_,"SESSIONSTORAGE AVAILABLE: "+e),h.log(this.name_,i),e==="hideForever"?t=n.hide:e==="pageInactive"&&this.compareTime(n.timestamp,this.welcomeBackTimeOut||0)&&(t=!0))}}catch(i){this.logError(i)}return t}handleWBEvents(e){try{l.publish("mod:dynInit",e),l.publish("welcomeback:brainzone",e);let t=e.getElementsByClassName("js-shownomore")[0];t&&t.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),this.setWBCookie("hideForever"),l.publish("overlay:close",{moduleName:"welcomelayer",optTrackingName:"_close_remembered"});let r=n.currentTarget,o=r.innerText??r.getAttribute("aria-label")??"",a=r.tagName.toLowerCase();m.callTealiumLink({businessEventType:"userAction",componentPath:"welcomelayer.dialogcontent.welcomeback",componentResultState:"close_remembered",componentLabel:o,elementTagName:a,eventType:"mousedown"})});let i=e.getElementsByClassName("js-backbutton")[0];i&&i.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),l.publish("overlay:close",{moduleName:"welcomelayer"});let r=n.currentTarget,o=r.innerText??r.getAttribute("aria-label")??"",a=r.tagName.toLowerCase();m.callTealiumLink({businessEventType:"userAction",componentPath:"welcomelayer.dialogcontent.welcomeback",componentResultState:"close_back",componentLabel:o,elementTagName:a,eventType:"mousedown"})})}catch(t){this.logError(t)}}handleVisibilityStateChange(e){if(e.target.hidden)this.dataURL_=window.ui.wb?.dataUrl??"",this.setWBCookie("pageInactive");else if(document.querySelector('[data-mod-name="welcomeback"]')!==null){let i=this.handleCookieData("hideForever"),n=this.handleCookieData("pageInactive");!i&&n&&this.handleJsonData()}}compareTime(e,t){let i=!1;try{Date.now()-e>=t&&(i=!0)}catch(n){this.logError(n)}return i}restartWBTimer(){try{this.welcomeBackTimer_!==void 0&&clearTimeout(this.welcomeBackTimer_),this.shutdown||(this.welcomeBackTimer_=setTimeout(()=>{this.dataURL_=window.ui.wb?.dataUrl??"",document.querySelector('[data-mod-name="welcomeback"]')===null&&!this.handleCookieData("hideForever")&&this.handleJsonData()},this.welcomeBackTimeOut))}catch(e){this.logError(e)}}adblockerDetected(){return window.AdService?.info.abd().isBlocked}},Se=new Z;function Ee(){let s=!1,e=document.createElement("div");return e.className="advertorial adv ad co-container ad-contain",e.setAttribute("style","width:300px;height:250px;position:absolute;top:-1000px;left:-1000px"),document.body.appendChild(e),s=(e.clientHeight||e.offsetHeight)<=0,s}function Q(s){return s.endsWith("/")?s.slice(0,-1):s}function H(s,e,t=""){let i=[],r=(e||t).split("#");return r.length>1&&(i=r[1].split(s)),i}function _e(s,e){let t={},i,n;return s.forEach(r=>{i=r.replace(e,"").split("=")[0],n=r.replace(e,"").split("=")[1],t[i]=n}),t}function Le(){try{return window.history.replaceState?window.history.replaceState(null,document.title,window.location.pathname+window.location.search):window.location.hash="",window.location.href}catch{return window.location.href}}var Y=class{constructor(){this.completionRate=0;this.dataAlreadySent=!1;this.feedbackCount=0;this.socialShareCount=0;this.piCount=0;this.startTime=Date.now(),this.pixelId=""}init(){if(window.ui.recom)this.recoUrl=window.ui.recom.endpoint,this.contentType=window.ui.recom.contentType,this.contentType==="Video"&&(this.completionRate=-1);else return;this.attachRecoListeners(),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&this.sendTrackingData()})}attachRecoListeners(){l.subscribe("content:recoCCR",e=>{let t=e,i=t.progress*100||0,n=t.contentType??"";this.contentType===n&&i>=this.completionRate&&(this.completionRate=i)}),l.subscribe("globalReco:userFeedback",e=>{this.increaseTrackingCounter(e)}),l.subscribeOnce("analyticsReco:clicksReady",e=>{if(this.recoUrl){let t=this.recoUrl.includes("?"),i=e&&Array.isArray(e)?(t?"&":"?")+"module="+decodeURIComponent(e.join(".")):"";this.fireRecoTracking(this.recoUrl+i)}}),l.subscribe("analyticsReco:clickOut",e=>{let{recoUrl:t,clicks:i}=e;if(t){let n=t.includes("?"),r=i?(n?"&":"?")+"module="+decodeURIComponent(i):"";this.fireRecoTracking(t+r)}})}increaseTrackingCounter(e){switch(e){case"feedbackCount":this.feedbackCount++;break;case"socialShareCount":this.socialShareCount++;break;case"piCount":this.piCount++;break}}async fireRecoTracking(e){await M.putJSON(e,{}).then(t=>{let i=t.pixelId;i&&(this.pixelId=i)})}limitNumberWithinRange(e,t=1,i=100){let n=Math.round(e);return Math.min(Math.max(n,t),i)}getTrackingData(){let e=Date.now(),t=Math.floor((e-this.startTime)/1e3),i={pixelId:this.pixelId,timeOnPage:t.toString()};return(this.contentType==="Article"||this.contentType==="Video"||this.contentType==="Slideshow")&&this.completionRate>-1&&(this.completionRate=this.limitNumberWithinRange(this.completionRate,0,100),i.completionRate=this.completionRate.toString()),this.feedbackCount>0&&(i.feedbackCount=this.limitNumberWithinRange(this.feedbackCount).toString()),this.socialShareCount>0&&(i.socialShareCount=this.limitNumberWithinRange(this.socialShareCount).toString()),this.piCount>1&&(i.piCount=this.limitNumberWithinRange(this.piCount,2,1e3).toString()),i}sendTrackingData(){if(!(this.dataAlreadySent||this.pixelId==="")&&this.recoUrl)try{let e=new URL(this.recoUrl);for(let[t,i]of Object.entries(this.getTrackingData()))e.searchParams.set(t,i);this.fireTrackingRequest(e.href),window.ui.recom.urlsend=e.href,this.dataAlreadySent=!0}catch(e){h.logUnknownError(e,"RecoTracking")}}fireTrackingRequest(e){navigator.sendBeacon(e)}},K=new Y;var X=class{constructor(){this.name_="analytics",this.dom_=T,this.logger_=h,this.pubsub_=l,this.currentLocation_={href:"",msctObj:!1,brainObj:!1,untreatedBrainZone:!1,layoutClass:void 0,deviceClass:void 0,deviceClient:void 0,ff:void 0},this.videoAutoplay_=void 0,this.isEvent_=!1,this.hashActive_=!1,this.adblockerDetected_=!1,this.iframeTrackingStarted_=!1,this.bypassFirstPixelPatterns_=["wahlomat-"],this.bypassFirstPixelReqs_=[],this.tcfLayerShown_=!1,this.permissionGranted_=!1,this.paramsNeedConsent_=[],this.alreadyGotDeviceClass_=!1}set currentLocationHref(e){this.currentLocation_.href=e}init(e={},t=!1){this.currentLocation_.href=e.href||window.location.href,this.currentLocation_.deviceClient=window.ui&&window.ui.pageinfo?window.ui.pageinfo.deviceclient:"browser";try{window.sessionStorage.getItem("_rfcp_")&&(this.tcfLayerShown_=!0)}catch(i){h.logUnknownError(i,"analytics")}this.permissionGranted_=t,this.paramsNeedConsent_=["hid","loginstate","lvts","sample","screenres","screenresolution","segment","session","var","viewportheight","viewportwidth","viewres"],K.init(),this.adblockerDetected_=Ee(),m.updateUtagData(this.adblockerDetected_),this.readTraceTracking(),this.attachAnalyticsListeners(),this.addPartnerTrackingPixel(),window.potec||(window.potec={}),typeof window.potec.countWAPI!="function"&&(window.potec.countWAPI=this.countWAPI),l.subscribe("multisearch:pingAnalyticsReady",()=>{l.publish("analytics:ServiceReady")}),l.publish("analytics:ServiceReady")}readTraceTracking(){let e;try{J.getItem("trace")&&J.removeItem("trace");let i=localStorage.getItem("trace");i&&(i=JSON.parse(i),i.location===Q(this.currentLocation_.href)&&(e=i.brainZone.split("."),this.currentLocation_.brainObj=e,this.currentLocation_.untreatedBrainZone=i.brainZone,localStorage.removeItem("trace")))}catch(t){this.log(t.toString())}}attachAnalyticsListeners(){this.subscribe("tracker:sendEventPixel",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("staticnext:sendPIPixel",e=>{this.controlTracking(e,!1)}),this.subscribe("starpreview:openOrCloseEvent",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("starpreview:textlink1",e=>{this.setTraceTracking(e.targetUrl,e.brainData)}),this.subscribe("analytics:trackVideoEvent",e=>{this.log(`Video: ${e}`)}),this.subscribe("video-slider:setEventPixel",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("video-slideshow:setPixel",e=>{this.controlTracking(this.readTriggerTracking(e),!1)}),this.subscribe("video-slideshow:setEventPixel",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("video-slider:brain-tracking",e=>{this.controlTracking(e,!1)}),this.subscribe("quiz:setPixel",e=>{this.controlTracking(e,!1),m.callTealiumView({newContentType:"quiz.detail"})}),this.subscribe("slideshow:setPixel",e=>{this.controlTracking(this.readTriggerTracking(e),!1),m.callTealiumView({newContentType:"slideshow.detail"})}),this.subscribe("slideshow:arrowClicked",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("votingtool:setPixel",e=>{this.controlTracking(this.readTriggerTracking(e),!1),m.callTealiumView()}),this.subscribe("video:setPixel",e=>{e.autoPlay&&(this.videoAutoplay_=e.autoplay,delete e.autoplay),this.controlTracking(this.readTriggerTracking(e),!1)}),this.subscribe("magnifier:setPixel",e=>{this.controlTracking(e,!1),m.callTealiumView({newContentType:"article.fullscreen-image"})}),this.subscribe("region:open-select",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("figcaption:setPixel",e=>{this.isEvent_=!0,this.controlTracking(e,!1),m.callTealiumView()}),this.subscribe("social:share",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("header:multisearch",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("createHeaderBiddingPixel",e=>{new Image().src=e}),this.subscribe("content:feedback",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("content:articleReadProgress",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("content:infinitescrollScrolling",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("content:voting",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("article:rating",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("general:newContent",e=>{this.appendBrainZone(e)}),this.subscribe("navigation:ready",e=>{this.appendBrainZone(e)}),this.subscribe("slideshow:ready",e=>{this.appendBrainZone(e)}),this.subscribe("region:optionClick",e=>{this.setTraceTracking(e.targetUrl,e.brainData)}),this.subscribe("horoscope:brainzone",e=>{let t=e.getElementsByTagName("a")[0],i=t.getAttribute("data-brain-zone");this.setTraceTracking(t.href,i),location.href=t.href}),this.subscribe("track:dialogShow",e=>{this.controlTracking(e,!1),m.callTealiumView()}),this.subscribe("track:welcomebackDialogShow",e=>{this.controlTracking(e,!1),m.callTealiumView({newContentName:"welcome-layer",newPageType:"layer",newAgof:"735"})}),this.subscribe("track:dialogCloseNormalPi",e=>{this.controlTracking(this.readTriggerTracking(e),!1)}),this.subscribe("track:emojifeedback",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("feedback:form",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("welcomeback:brainzone",e=>{this.appendBrainZone(e)}),this.subscribe("relatedvideo:setclick",e=>{this.setTraceTracking(e.destination,e.brainData)}),this.subscribe("navigation:brainZone",e=>{console.log("click from navi ",e),this.setTraceTracking(e.destination,e.brainData)}),this.subscribe("ad:gotDeviceClass",e=>{if(!(Object.keys(e).length<1)&&!this.alreadyGotDeviceClass_){if(this.currentLocation_.ff=e.ff,this.currentLocation_.layoutClass=e.layoutclass,this.currentLocation_.deviceClass=e.deviceclass,this.appendBrainZone(),document.querySelector('[data-mod-name="inboxnews"]'))this.controlTracking({clickname:"open",referrer:"undef",contentmode:W.isActivated()?"darkmode-on":"darkmode-off"},!1);else if(document.querySelector('[data-mod-name="imagegallery"]')){let t=document.querySelector('[data-mod-name="imagegallery"]').dataset.slideTotal;this.controlTracking({clickname:"slideshow_right",slidenumber:"0/"+t,contentmode:W.isActivated()?"darkmode-on":"darkmode-off"},!1)}else this.controlTracking({contentmode:W.isActivated()?"darkmode-on":"darkmode-off"},!0),this.clickOuts(),this.trackTeaserImpressions(),this.optOutTransfer();this.alreadyGotDeviceClass_=!0}}),this.subscribe("inboxnews:optOut",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("externalembed:optin",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("topnav",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.subscribe("appbanner:event",e=>{this.isEvent_=!0,this.controlTracking(e,!1)}),this.attachWhitelabelListener()}addPartnerTrackingPixel(){try{window.ui.partnerTrackingPixel&&window.ui.partnerTrackingPixel.forEach(t=>{new Image().src=t})}catch(e){this.log(e)}}controlTracking(e,t){e||(e={});let i=this.getControllVars();if(i.fireBrain){if(this.checkBypassFirstPixel(e.clickname))return;this.buildAndFireBrainUrl(e,t)}i.retVal&&this.initMsct(i.retVal,i.removeStr,e)}getControllVars(){let e="",t="",i=this.currentLocation_.href.indexOf("#"),n=this.currentLocation_.href.slice(i,i+5),r=!0;if(i!==-1||window.homepagehash)if(this.hashActive_=!0,n==="#msct")e="msct",t="msct_";else{let o=this.currentLocation_.href.slice(i,this.currentLocation_.href.length),a=o.indexOf("#.");window.homepagehash&&(this.log('Got "window.homepagehash" for tv program. Overwriting variables.'),o=window.homepagehash,a=0,delete window.homepagehash,this.hashActive_=!0),a===0&&(e=H(".",o,this.currentLocation_.href)[2]==="inbox"?"inbox":"homepage",r=!1,t=o)}return{retVal:e,fireBrain:r,removeStr:t}}buildAndFireBrainUrl(e,t){if(!window.ui.brain)return;let i=window.ui.brain.piUrl;this.isEvent_&&(i=window.ui.brain.eventUrl,this.isEvent_=!1);let n={piUrl:i,screenres:window.screen.width+"x"+window.screen.height,viewres:document.documentElement.clientWidth+"x"+document.documentElement.clientHeight,layoutclass:this.currentLocation_.layoutClass,deviceclass:this.currentLocation_.deviceClass,deviceclient:this.currentLocation_.deviceClient,click1:this.currentLocation_.brainObj[1],click2:this.currentLocation_.brainObj[2],click3:this.currentLocation_.brainObj[3],click4:this.currentLocation_.brainObj[4],clickname:e.clickname||"undefined",pageVisibility:document.visibilityState,ts:Date.now(),random:parseInt((Math.random()*1e5).toString(),10),adblock:this.adblockerDetected_?"1":"0",title:encodeURIComponent(document.title),tcflayer:this.tcfLayerShown_?1:0};i.includes("type=")||(n.type="view");let r=sessionStorage.getItem("originalReferrer");r?sessionStorage.removeItem("originalReferrer"):r=document.referrer;let o={pageurl:encodeURIComponent(this.currentLocation_.href),referrer:encodeURIComponent(r)},a=this.buildTrackingUrl(n,o,e,t);if(!this.isEvent_)try{let c=new URL(a);new URLSearchParams(c.search).get("name").includes(".pi.")&&K.increaseTrackingCounter("piCount")}catch(c){h.logUnknownError(c,"analyticsReco")}this.pubsub_.publish("analyticsReco:clicksReady",this.currentLocation_.brainObj),e.videoaction?window.navigator.sendBeacon(a):document.createElement("img").src=a,Array.isArray(window.ui.brain.pisend)?window.ui.brain.pisend.indexOf(a)<0&&window.ui.brain.pisend.push(a):window.ui.brain.pisend=[a]}buildTrackingUrl(e,t,i,n){let r="";e.type&&i.piUrl&&i.piUrl.includes("type=")&&(delete i.type,delete e.type);let o=Object.assign(e,i),a=Object.assign(t,i);o=Object.assign(o,a),r=o.piUrl,delete o.piUrl,o=this.onlyPermittedParams(o);for(let c in o)if(C.hasProperty(o,c)){let d=String(o[c]).replace(`&${c}=`,"");r+=`&${c}=${d}`}return this.generateDerefererLink(e,t,n),r}generateDerefererLink(e,t,i){let n="";if(!i)return;let r=Object.assign(e,t);if(window.ui.brain){let o=this.currentLocation_.brainObj;r.piUrl="",[1,2,3,4].forEach(a=>{r["click"+a.toString()]=o[a]&&o[a]!==""?`&click${a}=${o[a]}`:""}),delete r.type,r=this.onlyPermittedParams(r);for(let a in r)C.hasProperty(r,a)&&(n+=`&${a}=${r[a]}`);window.ui.brain.dereferer=n}}onlyPermittedParams(e){return this.permissionGranted_||this.paramsNeedConsent_.forEach(t=>{delete e[t]}),e}initMsct(e,t,i){let n=this.getMsctControlVars(e,t);try{n.fireBrain!==!1&&(this.currentLocation_.brainObj=n.fireBrain,this.buildAndFireBrainUrl(i,!1)),n.removeHash&&this.hashActive_&&(this.hashActive_=!1,this.currentLocation_.href=Le())}catch(r){this.log(r)}}getMsctControlVars(e,t){let i=!1,n=!1,r=!1,o=a=>(C.hasProperty(a,"mtype")||(a.mtype="wsite"),a.pageid=0,a);switch(e){case"msct":{let a=_e(H(";",void 0,this.currentLocation_.href),t);n=o(a),i=!0;break}case"homepage":case"inbox":{r=H(".",t),i=!0;break}case"advertorial":n=o({});break}return{fireConversion:n,fireBrain:r,removeHash:i}}readTriggerTracking(e){let t;try{this.currentLocation_.brainObj=!1,window.ui.brain&&window.ui.brain.trigger&&(this.log("brain.trigger: "+window.ui.brain.trigger),t=window.ui.brain.trigger.split("."),this.currentLocation_.brainObj=t,delete window.ui.brain.trigger,[1,2,3,4].forEach(i=>{delete e[`click${i.toString()}`]}),this.log("readTriggerTracking: "+JSON.stringify(e)))}catch(i){this.log(i)}return e}appendBrainZone(e){let i=(e||document).querySelectorAll("a[data-brain-zone]"),n=e?e.classList.contains("innernav"):!1,r=o=>{o.addEventListener("click",async a=>{let c=a.currentTarget,d=c.getAttribute("data-brain-zone"),u=c.getAttribute("href");await window.yieldToMain(),this.setTraceTracking(u,d)}),o.setAttribute("data-brained","true")};Array.from(i).forEach(o=>{(n||!o.hasAttribute("data-brained")&&!o.hasAttribute("data-co"))&&r(o)})}setTraceTracking(e,t){try{let i=JSON.stringify({location:Q(e),brainZone:t});localStorage.setItem("trace",i)}catch(i){this.log(i)}}clickOuts(){let e=document.querySelectorAll("a[data-co]"),t=window.ui.brain?window.ui.brain.dereferer:"";if(!t)return!1;t=t.split("&").filter(n=>!(n.indexOf("click1")>-1||n.indexOf("click2")>-1||n.indexOf("click3")>-1||n.indexOf("click4")>-1)).join("&"),Array.from(e).forEach(n=>{if(n.hasAttribute("data-msctd"))return;n.getAttribute("data-co")==="brain"&&(n.href+=t),n.setAttribute("data-msctd","true")})}trackTeaserImpressions(){if(window.ui.brain){let e=window.ui.brain.teaserImpressions;e&&(e+="&layoutclass="+this.currentLocation_.layoutClass,e+="&deviceclass="+this.currentLocation_.deviceClass,e+="&deviceclient="+this.currentLocation_.deviceClient,e+="&ts="+new Date().getTime().toString(),new Image().src=e)}}attachWhitelabelListener(){window.addEventListener("message",e=>{e.origin==="https://widget.civey.com"&&(e.data.type==="CIVEY_WIDGET_LOADED"||e.data.type==="CIVEY_WIDGET_VOTE")&&window.postMessage({method:"adRefresh",rect:!0},"*")}),window.addEventListener("message",e=>{if(e.data.method==="countWAPI"){let t={referrer:"undefined",click1:"undefined",click2:"undefined",click3:"undefined",click4:"undefined",clickname:"undefined"};e.data.eventname!==!1&&(this.isEvent_=!0),delete e.data.method,delete e.data.eventname,delete e.data.trigger;let i=Object.assign(t,e.data);this.controlTracking(i,!1)}},!1)}countWAPI(e,t){try{let i={method:"countWAPI",clickname:e?e.toString():"undefined",eventname:!!t};window.postMessage(i,"*")}catch(i){this.log(i)}}optOutTransfer(){let e=window.ui.brain;if(e){let t=e.optOutTransferUrl;t&&(new Image().src=t)}}checkBypassFirstPixel(e){let t=!1;return e&&this.bypassFirstPixelPatterns_.forEach(i=>{e.indexOf(i)>=0?this.bypassFirstPixelReqs_.indexOf(e)>=0?t=!1:(this.bypassFirstPixelReqs_.push(e),t=!0):t=!1}),t}log(e){this.logger_.log(this.name_,e)}subscribe(e,t){this.pubsub_.subscribe(e,t)}},ee=new X;var te=class{constructor(){this.adServiceBundleUrl="";this.adServiceConnectorUrl="";this.biddingConfigUrls={b:"",m:"",s:""};this.biddingEnabled=!0;this.config={configurations:{prebidVideoTimeout:{s:0,m:0,b:0},visibilityLookahead:0},exclusionRules:{},prebidRules:{}};this.exclusionRules={};this.prebidRules={};this.enabled=!0;this.init={};this.nonFriendlyIFrameDocument="";this.pageCategory="";this.configurations={}}},ie=class{},ne=class{constructor(){this.adBiddingConfigFileUrl_="";this.adServiceConfig_=new te;this.adComponentsLoaded_=new ie;this.pubSub_=l;this.logger_=h}set adBiddingConfigFileUrl(e){this.adBiddingConfigFileUrl_=e}set adServiceConfig(e){this.adServiceConfig_=e}get externalConfig(){return this.externalConfig_}checkRequireJs(){typeof window.requireJS=="object"&&typeof window.requireJS.define=="function"||this.mockRequireJs()}mockRequireJs(){window.requireJS={define:e=>{this.externalConfig_=e},require:()=>{}}}run(){if(!y.get("adServiceEnabled")){this.sendFallbackTrackingInfo();return}this.checkRequireJs(),window.ui.noCORSUrls=window.ui.noCORSUrls||[],window.ui.noCORSUrls.push(this.adBiddingConfigFileUrl_),this.perf_=window.performance??{mark:()=>{}},this.loadAdServiceBundle(()=>{this.setAdComponentLoaded("bundle")}),this.loadAdServiceConfig(e=>{this.applyExternalConfig(e)},()=>{this.useDefaultConfig()})}adBiddingEnabled(){return this.adServiceConfig_.biddingEnabled||!1}sendFallbackTrackingInfo(){let e="s",t=document.documentElement.clientWidth;document.documentElement.classList.add("ab-active"),t>=768&&t<1024?e="m":t>=1024&&(e="b"),this.pubSub_.publish("ad:gotDeviceClass",{layoutclass:e,deviceclass:"undef",ff:"unknown"})}startAdService(){typeof window.AdService>"u"?this.sendFallbackTrackingInfo():(this.adServiceConfig_.config||(this.adServiceConfig_.config={exclusionRules:this.adServiceConfig_.exclusionRules,prebidRules:this.adServiceConfig_.prebidRules,configurations:{}}),this.perf_.mark("adservice-init-start"),this.pubSub_.publish("asLoader:AdServiceLoaded"))}setAdComponentLoaded(e){this.adComponentsLoaded_[e]=!0,this.adComponentsLoaded_.bundle&&this.adComponentsLoaded_.config&&(window.ui.AdServiceConfig=Object.assign(window.ui.AdServiceConfig,this.adServiceConfig_),this.startAdService())}useDefaultConfig(){this.setAdComponentLoaded("config")}loadAdServiceConfig(e,t){this.adBiddingEnabled()?this.adBiddingConfigFileUrl_&&x.fetch(this.adBiddingConfigFileUrl_,!1,!1).then(()=>{e(this.externalConfig_)}).catch(()=>{t()}):this.useDefaultConfig()}loadAdServiceBundle(e){let t=window.ui.AdServiceAlternativeUrl||window.ui?.AdServiceConfig?.adServiceBundleUrl;t?(this.perf_.mark("adservice-load-start"),x.fetch(t,void 0,!1).then(()=>{this.perf_.mark("adservice-load-end"),this.setAdComponentLoaded("bundle")}).catch(()=>{typeof e=="function"&&e()})):this.logger_.log("Adservice","Cant load adservice bundle provide adservice url")}applyExternalConfig(e){this.adServiceConfig_.config={exclusionRules:e.exclusionRules,prebidRules:e.prebidRules,configurations:e.configurations||{}},this.setAdComponentLoaded("config")}},D=new ne;var lt=(s,e,t)=>v`
  <div class="imageFullScreen">
    <a href="#" class="closeOverlay">
      <span class="icon icon-close"></span>
    </a>
    <figure class="imgContainer bgimg" style="background-image: url('${t}');">
      <figcaption class="figcaption">
        <span class="icon-subtext icon"></span>
        <div class="caption">
          <span class="description">
            <span class="copyright">
              ${s}
            </span>
            ${e}
          </span>
        </div>
      </figcaption>
    </figure>
  </div>`,re=class{constructor(){this.lineHeight=25}init(){try{l.subscribe("overlay:showBiggerImage",e=>{let t=e,i=t.copyright,n=t.description,r=t.pictureContent,o=T.fromHtml(""),a=t.trackingData;E(lt(i,n,r),o),document.getElementsByClassName("ocw")[0].appendChild(o);let d=document.querySelector("a.closeOverlay"),u=t.overlayInfo.overlayElem;d&&u&&d.addEventListener("click",A=>{A.preventDefault(),u.parentNode?.removeChild(u),this.sendCloseEvent(a)}),document.addEventListener("keyup",A=>{A.key==="Escape"&&(u.parentNode?.removeChild(u),this.sendCloseEvent(a))}),this.sendOpenEvent(a);let g=document.querySelector(".imageFullScreen")?.querySelector("figcaption");g&&(this.configureCaptionStyling(g,!1),g.classList.contains("is-extendable")&&g.addEventListener("click",function(A){A.stopPropagation(),g.classList.contains("opened")?g.classList.remove("opened"):g.classList.add("opened");let N=g.querySelector(".caption");try{N&&(g.classList.contains("opened")?(localStorage.setItem("descriptionState","opened"),N.style.height=N.dataset.height+"px"):(localStorage.setItem("descriptionState","false"),N.style.height=""))}catch(rt){h.logUnknownError(rt,"Magnifier")}}))})}catch(e){h.logUnknownError(e,"[magnifier]"),l.publish("sentry:log",{error:e})}}configureCaptionStyling(e,t){let i=e.getElementsByClassName("description")[0],n=e.getElementsByClassName("caption")[0],r=0;i.style.whiteSpace="normal",r=i.offsetHeight,i.style.whiteSpace="",t==="opened"?(e.classList.add("opened"),window.setTimeout(()=>{n.style.height=r+"px"},500)):e.classList.remove("opened");let o=e.getElementsByClassName("copyright")[0];o.textContent&&o.textContent.length-2===0&&(o.style.display="none"),(i.offsetWidth<i.scrollWidth||i.offsetHeight>this.lineHeight*1.5)&&e.classList.add("is-extendable"),n.dataset.height=r.toString()}sendOpenEvent(e){let{componentName:t,componentPath:i}=e;if(l.publish("magnifier:setPixel",{referrer:"&referrer=undefined",click1:"&click1="+window.ui.pageinfo.coremid,click2:"&click2=magnifier",click3:"&click3=open",click4:"&click4=1",clickname:"&clickname=magnifier_open"}),i){let n={businessEventType:"userAction",componentResultState:"enlarged",componentPath:i,elementTagName:"a",eventType:"mousedown"};t&&(n.componentName=t),m.callTealiumLink(n)}}sendCloseEvent(e){let{componentName:t,componentPath:i}=e;if(l.publish("overlayDestroyed",{resetAdConfig:!1,moduleName:"magnifier",optTrackingName:"_close"}),i){let n={businessEventType:"userAction",componentPath:i,componentResultState:"minimized",elementTagName:"span",eventType:"mousedown"};t&&(n.componentName=t),m.callTealiumLink(n)}}},Pe=new re;var dt=v`
<div class="siteOverlay">
  <div class="overlayWrapper">
    <div class="tr">
      <div class="overlayContent tc">
        <div class="ocw"></div>
      </div>
      <div class="tc sky-overlay-wrapper">
        <div class="co-container ad-overlay-sky js-co-dynamic" data-service-param-tagid="sky_on_overlay"></div>
      </div>
    </div>
  </div>
</div>`,ht=(s,e)=>v`
<div class="dialogOverlay" data-type="${e}">
  <div class="dialogWrapper bouncein">
    <div class="close-bar">
      <span class="icon icon-close js-close"></span>
    </div>
    <div class="dialogContent">${I(s)}</div>
  </div>
</div>`,se=class{constructor(){this.selectors={layerContent:".overlayContent",layerContentWrapper:".overlayContent .ocw",dialogWrapper:".dialogWrapper",dialogContent:".dialogContent"},this.isDialog=!1,this.avoidVerticalStylingCss=null,this.lastScrollPosition=0,this.overlayElement=null}log(e,t){console.log("[overlay]",e,t)}publish(e,t={}){l.publish(e,t)}subscribe(e,t){l.subscribe(e,t)}init(){this.log("init");try{this.subscribe("article:magnifier",e=>{this.log("Magnifier triggered from article",e),e.overlayInfo=this.createOverlay(),this.publish("overlay:showBiggerImage",e)}),this.subscribe("overlayDestroyed",e=>{e=e||"",this.log("overlayDestroyed",e);try{this.overlayElement=null,f.showScrollbar(),(this.avoidVerticalStylingCss!==null||typeof this.avoidVerticalStylingCss<"u")&&(this.avoidVerticalStylingCss.innerHTML="",window.scrollTo(0,this.lastScrollPosition)),this.publish("ad:refreshAll"),this.fireTrackingPixel(e),this.publish("welcomeback:restartWBTimer")}catch(t){this.log(t),this.publish("sentry:log",{error:t})}}),this.subscribe("overlay:showWelcomeback",e=>{this.createWelcomebackDialog(e.content,e.module,e.opts,e.callback),this.setDialogSize(e.module)}),this.subscribe("overlay:close",e=>{this.closeDialog(e)}),this.subscribe("window:resize",()=>{this.isDialog&&this.overlayElement&&this.setDialogSize()})}catch(e){this.log(e),this.publish("sentry:log",{error:e})}}createWelcomebackDialog(e,t,i,n){if(n=n||function(){},i=i||{},this.overlayElement){this.log("An overlay already exists.");return}let r=T.fromHtml("");E(ht(e,t),r),this.overlayElement=r.firstElementChild,this.overlayElement.setAttribute("data-open","true"),document.body.appendChild(r),this.overlayElement=this.overlayElement||document.querySelector(".dialogOverlay"),this.log("this.overlayElement",this.overlayElement),this.isDialog=!0,f.hideScrollbar();let o=i.wbTrackingVar?i.wbTrackingVar:"";this.publish("track:welcomebackDialogShow",{referrer:"&referrer=undefined",click1:"&click1="+y.get("pageinfo").coremid,click2:"&click2="+t,click3:"&click3=open"+o,click4:"&click4=1",clickname:"&clickname="+t+"_open"}),this.overlayElement.style.height=window.innerHeight+"px",window.setTimeout(()=>{this.overlayElement.classList.add("fadeIn")},100);let a=this.overlayElement.getElementsByClassName("dialogContent")[0];n(a),this.publish("video:pauseAllPlayers"),this.publish("welcomeback:stopWBTimer"),this.overlayElement.getElementsByClassName("js-close")[0].addEventListener("click",c=>{c.preventDefault(),this.closeDialog(t)}),document.addEventListener("keyup",c=>{c.key==="Escape"&&this.closeDialog(t)})}closeDialog(e){this.log("closeDialog()",e);try{this.isDialog=!1,this.overlayElement.setAttribute("data-open","false"),this.publish("ad:refreshAll"),this.fireTrackingPixel(e),e==="welcomelayer"&&m.callTealiumLink({businessEventType:"userAction",componentPath:"welcomelayer.close-bar.icon-close",componentResultState:"close",elementTagName:"div",eventType:"mousedown"}),this.publish("welcomeback:restartWBTimer"),this.overlayElement.classList.remove("fadeIn");let t=document.querySelector(this.selectors.dialogWrapper);t.classList.remove("bouncein"),e==="feedback_success"?t.classList.add("closed"):t.classList.add("bounceout"),setTimeout(()=>{this.removeDialog()},1e3)}catch(t){this.log(t),this.publish("sentry:log",{error:t})}}removeDialog(){this.overlayElement.remove(),this.overlayElement=null,f.showScrollbar()}setDialogSize(e){e=e||this.overlayElement.dataset.type;try{let t=document.getElementsByClassName("content")[0];if(t){let i=t.getBoundingClientRect().width-32;i>900&&(i=900),e==="welcomelayer"&&(i=Math.min(document.documentElement.clientWidth-32,1144));let n=this.overlayElement.getElementsByClassName("close-bar")[0],r=this.overlayElement.getElementsByClassName("dialogContent")[0],o=window.innerHeight+"px",a=i+"px";n.style.width=a,r.style.width=a,r.style.maxHeight=o,this.overlayElement.style.height=o}}catch(t){this.log(t),this.publish("sentry:log",{error:t})}}createOverlay(){try{if(this.log("createOverlay()"),this.overlayElement){this.log("An overlay already exists.");return}this.lastScrollPosition=window.scrollY;let e=T.fromHtml("");E(dt,e),this.overlayElement=e.firstElementChild,document.body.appendChild(e);let t=document.getElementById("avoidVerticalScroll"),i="html, body {margin: 0; height: 100%; overflow: hidden}";t?t.innerHTML=i:(this.avoidVerticalStylingCss=document.createElement("style"),this.avoidVerticalStylingCss.id="avoidVerticalScroll",this.avoidVerticalStylingCss.innerHTML=i,document.getElementsByTagName("head")[0].appendChild(this.avoidVerticalStylingCss)),this.overlayElement=this.overlayElement||document.querySelector(".siteOverlay");let n={overlayElem:this.overlayElement,overlayContentSelector:this.selectors.layerContent,overlayContentWrapperSelector:this.selectors.layerContentWrapper};return f.hideScrollbar(),this.refreshAds(),this.log("overlay created"),n}catch(e){console.error(e),this.publish("sentry:log",{error:e})}}refreshAds(){try{if(this.log("refreshAds()"),f.matches("tablet")){let e=[],t=document.querySelectorAll(".js-co-dynamic");this.log("dynamicAds",t),t.forEach(i=>{this.log("refreshAds: got ad container ",i),!(!f.matches("desktop")&&i.classList.contains("ad-overlay-sky"))&&(this.log("refreshAds: pushing ad container",i),e.push(i))}),this.publish("dynamicAdsNeeded",e)}}catch(e){this.log(e),this.publish("sentry:log",{error:e})}}fireTrackingPixel(e){try{let t="",i="";if(typeof e=="object"?(e.resetAdConfig===!0&&this.publish("ad:resetAdConfig"),i=e.moduleName,t=i+(e.optTrackingName?e.optTrackingName:"_close")):(i=e,t=e+"_close"),y.get("brain")){let n=e.coremId?e.coremId:y.get("pageinfo").coremid;window.ui.brain.trigger="."+n+"."+i+".close.1"}this.publish("track:dialogCloseNormalPi",{referrer:"&referrer=undefined",click1:"&click1=undefined",click2:"&click2=undefined",click3:"&click3=undefined",click4:"&click4=undefined",clickname:"&clickname="+t})}catch(t){this.log(t),this.publish("sentry:log",{error:t})}}},Ae=new se;var oe=class{init(){try{this.setToolsClassSize(),l.subscribe("layoutChanged",()=>{this.setToolsClassSize()}),l.subscribe("window:resize",()=>{this.setToolsClassSize()}),l.subscribe("masonrized",()=>{this.setToolsClassSize()})}catch(e){l.publish("sentry:log",{error:e})}}setToolsClassSize(){try{document.querySelectorAll(".mod-tool").forEach(t=>{t.offsetWidth<350?(t.classList.add("tiny"),t.offsetWidth<320?t.classList.add("xs"):t.classList.remove("xs"),t.classList.remove("maxi"),this.modifySuggestion(t,"tiny")):t.offsetWidth>670?(t.classList.add("maxi"),t.classList.remove("tiny"),t.classList.remove("xs"),this.modifySuggestion(t,"maxi")):(t.classList.remove("maxi"),t.classList.remove("tiny"),t.classList.remove("xs"),this.modifySuggestion(t,"maxi"))})}catch(e){l.publish("sentry:log",{error:e})}}modifySuggestion(e,t){let i=e.querySelectorAll(".suggestion");switch(t){case"tiny":i.forEach(n=>{n.classList.remove("maxi"),n.classList.add("tiny")});break;case"maxi":i.forEach(n=>{n.classList.remove("tiny"),n.classList.add("maxi")});break;default:break}}},xe=new oe;var S,R,Ve,q,de,qe=-1,_=function(s){addEventListener("pageshow",function(e){e.persisted&&(qe=e.timeStamp,s(e))},!0)},he=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},z=function(){var s=he();return s&&s.activationStart||0},p=function(s,e){var t=he(),i="navigate";return qe>=0?i="back-forward-cache":t&&(document.prerendering||z()>0?i="prerender":document.wasDiscarded?i="restore":t.type&&(i=t.type.replace(/_/g,"-"))),{name:s,value:e===void 0?-1:e,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:i}},P=function(s,e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(s)){var i=new PerformanceObserver(function(n){Promise.resolve().then(function(){e(n.getEntries())})});return i.observe(Object.assign({type:s,buffered:!0},t||{})),i}}catch{}},b=function(s,e,t,i){var n,r;return function(o){e.value>=0&&(o||i)&&((r=e.value-(n||0))||n===void 0)&&(n=e.value,e.delta=r,e.rating=function(a,c){return a>c[1]?"poor":a>c[0]?"needs-improvement":"good"}(e.value,t),s(e))}},ue=function(s){requestAnimationFrame(function(){return requestAnimationFrame(function(){return s()})})},$=function(s){var e=function(t){t.type!=="pagehide"&&document.visibilityState!=="hidden"||s(t)};addEventListener("visibilitychange",e,!0),addEventListener("pagehide",e,!0)},me=function(s){var e=!1;return function(t){e||(s(t),e=!0)}},L=-1,Ie=function(){return document.visibilityState!=="hidden"||document.prerendering?1/0:0},j=function(s){document.visibilityState==="hidden"&&L>-1&&(L=s.type==="visibilitychange"?s.timeStamp:0,ut())},De=function(){addEventListener("visibilitychange",j,!0),addEventListener("prerenderingchange",j,!0)},ut=function(){removeEventListener("visibilitychange",j,!0),removeEventListener("prerenderingchange",j,!0)},fe=function(){return L<0&&(L=Ie(),De(),_(function(){setTimeout(function(){L=Ie(),De()},0)})),{get firstHiddenTime(){return L}}},U=function(s){document.prerendering?addEventListener("prerenderingchange",function(){return s()},!0):s()},Be=[1800,3e3],mt=function(s,e){e=e||{},U(function(){var t,i=fe(),n=p("FCP"),r=P("paint",function(o){o.forEach(function(a){a.name==="first-contentful-paint"&&(r.disconnect(),a.startTime<i.firstHiddenTime&&(n.value=Math.max(a.startTime-z(),0),n.entries.push(a),t(!0)))})});r&&(t=b(s,n,Be,e.reportAllChanges),_(function(o){n=p("FCP"),t=b(s,n,Be,e.reportAllChanges),ue(function(){n.value=performance.now()-o.timeStamp,t(!0)})}))})},Re=[.1,.25],je=function(s,e){e=e||{},mt(me(function(){var t,i=p("CLS",0),n=0,r=[],o=function(c){c.forEach(function(d){if(!d.hadRecentInput){var u=r[0],O=r[r.length-1];n&&d.startTime-O.startTime<1e3&&d.startTime-u.startTime<5e3?(n+=d.value,r.push(d)):(n=d.value,r=[d])}}),n>i.value&&(i.value=n,i.entries=r,t())},a=P("layout-shift",o);a&&(t=b(s,i,Re,e.reportAllChanges),$(function(){o(a.takeRecords()),t(!0)}),_(function(){n=0,i=p("CLS",0),t=b(s,i,Re,e.reportAllChanges),ue(function(){return t()})}),setTimeout(t,0))}))},B={passive:!0,capture:!0},ft=new Date,Ue=function(s,e){S||(S=e,R=s,Ve=new Date,$e(removeEventListener),ze())},ze=function(){if(R>=0&&R<Ve-ft){var s={entryType:"first-input",name:S.type,target:S.target,cancelable:S.cancelable,startTime:S.timeStamp,processingStart:S.timeStamp+R};q.forEach(function(e){e(s)}),q=[]}},gt=function(s){if(s.cancelable){var e=(s.timeStamp>1e12?new Date:performance.now())-s.timeStamp;s.type=="pointerdown"?function(t,i){var n=function(){Ue(t,i),o()},r=function(){o()},o=function(){removeEventListener("pointerup",n,B),removeEventListener("pointercancel",r,B)};addEventListener("pointerup",n,B),addEventListener("pointercancel",r,B)}(e,s):Ue(e,s)}},$e=function(s){["mousedown","keydown","touchstart","pointerdown"].forEach(function(e){return s(e,gt,B)})},Oe=[100,300],Je=function(s,e){e=e||{},U(function(){var t,i=fe(),n=p("FID"),r=function(c){c.startTime<i.firstHiddenTime&&(n.value=c.processingStart-c.startTime,n.entries.push(c),t(!0))},o=function(c){c.forEach(r)},a=P("first-input",o);t=b(s,n,Oe,e.reportAllChanges),a&&$(me(function(){o(a.takeRecords()),a.disconnect()})),a&&_(function(){var c;n=p("FID"),t=b(s,n,Oe,e.reportAllChanges),q=[],R=-1,S=null,$e(addEventListener),c=r,q.push(c),ze()})})},Ge=0,ae=1/0,V=0,pt=function(s){s.forEach(function(e){e.interactionId&&(ae=Math.min(ae,e.interactionId),V=Math.max(V,e.interactionId),Ge=V?(V-ae)/7+1:0)})},Ze=function(){return de?Ge:performance.interactionCount||0},bt=function(){"interactionCount"in performance||de||(de=P("event",pt,{type:"event",buffered:!0,durationThreshold:0}))},Ne=[200,500],Qe=0,Me=function(){return Ze()-Qe},k=[],ce={},Fe=function(s){var e=k[k.length-1],t=ce[s.interactionId];if(t||k.length<10||s.duration>e.latency){if(t)t.entries.push(s),t.latency=Math.max(t.latency,s.duration);else{var i={id:s.interactionId,latency:s.duration,entries:[s]};ce[i.id]=i,k.push(i)}k.sort(function(n,r){return r.latency-n.latency}),k.splice(10).forEach(function(n){delete ce[n.id]})}},Ye=function(s,e){e=e||{},U(function(){var t;bt();var i,n=p("INP"),r=function(a){a.forEach(function(u){u.interactionId&&Fe(u),u.entryType==="first-input"&&!k.some(function(O){return O.entries.some(function(g){return u.duration===g.duration&&u.startTime===g.startTime})})&&Fe(u)});var c,d=(c=Math.min(k.length-1,Math.floor(Me()/50)),k[c]);d&&d.latency!==n.value&&(n.value=d.latency,n.entries=d.entries,i())},o=P("event",r,{durationThreshold:(t=e.durationThreshold)!==null&&t!==void 0?t:40});i=b(s,n,Ne,e.reportAllChanges),o&&("PerformanceEventTiming"in window&&"interactionId"in PerformanceEventTiming.prototype&&o.observe({type:"first-input",buffered:!0}),$(function(){r(o.takeRecords()),n.value<0&&Me()>0&&(n.value=0,n.entries=[]),i(!0)}),_(function(){k=[],Qe=Ze(),n=p("INP"),i=b(s,n,Ne,e.reportAllChanges)}))})},We=[2500,4e3],le={},Ke=function(s,e){e=e||{},U(function(){var t,i=fe(),n=p("LCP"),r=function(c){var d=c[c.length-1];d&&d.startTime<i.firstHiddenTime&&(n.value=Math.max(d.startTime-z(),0),n.entries=[d],t())},o=P("largest-contentful-paint",r);if(o){t=b(s,n,We,e.reportAllChanges);var a=me(function(){le[n.id]||(r(o.takeRecords()),o.disconnect(),le[n.id]=!0,t(!0))});["keydown","click"].forEach(function(c){addEventListener(c,function(){return setTimeout(a,0)},!0)}),$(a),_(function(c){n=p("LCP"),t=b(s,n,We,e.reportAllChanges),ue(function(){n.value=performance.now()-c.timeStamp,le[n.id]=!0,t(!0)})})}})},He=[800,1800],vt=function s(e){document.prerendering?U(function(){return s(e)}):document.readyState!=="complete"?addEventListener("load",function(){return s(e)},!0):setTimeout(e,0)},Xe=function(s,e){e=e||{};var t=p("TTFB"),i=b(s,t,He,e.reportAllChanges);vt(function(){var n=he();if(n){var r=n.responseStart;if(r<=0||r>performance.now())return;t.value=Math.max(r-z(),0),t.entries=[n],i(!0),_(function(){t=p("TTFB",0),(i=b(s,t,He,e.reportAllChanges))(!0)})}})};var ge=class{constructor(){this.analyticsUrl_="",this.clsEntries=[],this.metricNeeded_=["CLS","FID","LCP","TTFB","INP"],this.metricsSent_=!1,this.alreadyGotDeviceClass_=!1,this.analyticsBody_={}}getAnalyticsUrl(){return window.ui?.webvitals?window.ui.webvitals.endpoint:""}setAnalyticsUrl(e){this.analyticsUrl_=e}initBody(e,t){this.analyticsBody_.deviceclass=e,this.analyticsBody_.layoutclass=t}resetBody(){this.analyticsBody_={},this.clsEntries=[],this.metricsSent_=!1}collectLayoutShift(e){try{window.ui.webvitals?.debugCls&&e.entries.slice(0,10).forEach(t=>{let i=t;i?.sources?.length>0&&this.clsEntries.push(this.convertLayoutShiftEntry(i))})}finally{this.collectMetric(e)}}collectTTFB(e){try{let t=e.entries[0];t&&(this.analyticsBody_.redirectStart=t.redirectStart.toFixed(3),this.analyticsBody_.redirectEnd=t.redirectEnd.toFixed(3),this.analyticsBody_.domainLookupStart=t.domainLookupStart.toFixed(3),this.analyticsBody_.domainLookupEnd=t.domainLookupEnd.toFixed(3),this.analyticsBody_.requestStart=t.requestStart.toFixed(3))}catch(t){console.warn("Unable to add TTFB details",t)}finally{this.collectMetric(e)}}convertLayoutShiftEntry(e){let t=[];return e.sources.slice(0,10).forEach(i=>{t.push(this.convertElementToIdentifier(i.node))}),{value:e.value,sources:t}}convertElementToIdentifier(e){try{if(e){let t=[];for(let i=e;i;i=i.parentNode){if(i.nodeName===null)continue;let n=i.nodeName.toLowerCase();if(n==="html")break;let r=i;r.className&&(n+="."+r.className.replace(/ /g,".")),t.push(n)}return t.reverse(),t.join(" ")}return"no element"}catch(t){return console.error("Unable to create path",t),"error"}}collectMetric(e){console.log("[CWV]",e),this.analyticsBody_[e.name.toLowerCase()]=e.value.toString(),this.metricsSent_||this.allMetricGot()&&(this.sendToAnalytics(),this.metricsSent_=!0)}allMetricGot(){let e=!0,t=Object.keys(this.analyticsBody_);return this.metricNeeded_.forEach(i=>{t.includes(i.toLowerCase())||(e=!1)}),e}objToQueryString(e){let t="";return t=Object.keys(e).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(e[n])}`).join("&"),t}collectElementHeights(){let e=new Map;if(!window.ui?.webvitals)return e;let t=window.ui.webvitals.analyzeElementHeights;return t&&t.forEach(i=>{let n=document.getElementsByClassName(i);if(n&&n.length>0){let r=n[0];r&&e.set(i,r.offsetHeight)}}),e}sendToAnalytics(){let e=this.objToQueryString(this.analyticsBody_),t=this.analyticsUrl_;t.indexOf("?")>0?t+=`&${e}`:t+=`?${e}`;let i={elementHeights:this.collectElementHeights(),clsEntries:this.clsEntries},n=JSON.stringify(i);console.log("[CWV] Details ",n),window.navigator.sendBeacon?typeof Blob<"u"?window.navigator.sendBeacon(t,new Blob([n],{type:"application/json"})):window.navigator.sendBeacon(t):fetch(t,{method:"POST",keepalive:!0,headers:{"Content-Type":"application/json"},body:n})}run(){this.analyticsUrl_=this.getAnalyticsUrl(),this.analyticsUrl_?l.subscribe("ad:gotDeviceClass",e=>{let t=e;if(!(Object.keys(t).length<1)&&!this.alreadyGotDeviceClass_){this.initBody(t.deviceclass,t.layoutclass);try{je(i=>this.collectLayoutShift(i)),Je(i=>this.collectMetric(i)),Ke(i=>this.collectMetric(i)),Xe(i=>this.collectTTFB(i)),Ye(i=>this.collectMetric(i))}catch(i){console.error("Error calling APIs:",i)}this.alreadyGotDeviceClass_=!0}}):console.log("[CWV] Collecting core web vitals disabled.")}},et=new ge;var pe=class{constructor(){this.loadedServices=new Map,h.log("ServiceFactory","initialization completed")}async getService(e){let t=this.loadedServices.get(e);if(t)return t;{let i=await import(`${w.sn}/${e}`);if(i)return this.loadedServices.set(e,i.default),i.default;throw new Error("Unable to load the service: "+e)}}},be=new pe;function ve(s,e){s=s||document,s.querySelectorAll("[data-wc-name]").forEach(i=>{let n=i.tagName,r=i.getAttribute("data-wc-name");if(customElements.get(n)===void 0&&r){let o=`${e}/mod-${r}/${r}.js`;try{import(o)}catch(a){console.error("Dynamic loading error: ",a)}}})}var ye=class{constructor(){this.loader_=ke,this.logger_=h,this.pubsub_=l,this.perf_=window.performance||{mark:()=>{}},this.sentryErrors_=[],this.adDeviceClass_=null}start(){try{let e=Te;if(typeof e!="function"){console.warn("No auto-initializer set!");return}let t=this.pubsub_.subscribe("sentry:log",r=>{this.sentryErrors_.push(r)});y.get("logging")||this.logger_.mute(),y.get("adServiceEnabled")||(window.ui.adServiceEnabled=window.ui.AdServiceConfig&&window.ui.AdServiceConfig.enabled===!0);let i={css:w.css,js:w.jsAsset,modules:w.modules};F.init(),window.ui&&window.ui.sentry&&be.getService("ts/services/sentry.js").then(r=>{t.remove(),r.init(this.sentryErrors_)}),Ae.init(),Pe.init(),xe.init(),this.pubsub_.subscribe("mod:init",r=>{this.logger_.log("app",`Module "${r.moduleName}" initialized.`)}),this.pubsub_.subscribe("mod:dynInit",r=>{e(r,void 0,this.loader_,i)}),this.pubsub_.subscribe("webcomponent:dynInit",r=>{ve(r,w.modules)}),window.addEventListener("resize",()=>{this.pubsub_.publish("window:resize")}),window.addEventListener("load",()=>{this.pubsub_.publish("windowLoaded"),console.log("windowLoaded")}),document.addEventListener("visibilitychange",r=>{this.pubsub_.publish("visibilityStateChanged",r),this.logger_.log("app","visibilityState (hidden) changed to: "+r.target.hidden)}),this.pubsub_.subscribe("asLoader:AdServiceLoaded",()=>{window.ui&&window.ui.adServiceEnabled&&be.getService("js/services/ads.js").then(r=>{r.initialize(),this.perf_.mark("adservice-init-end")})}),this.pubsub_.subscribeOnce("ad:gotDeviceClass",r=>{this.adDeviceClass_=r}),window.addEventListener("message",r=>{if(r.data.method==="scrollup"){let o="iFrameResizer0";r.data.offSet||(r.data.offSet=100),r.data.id&&(o=r.data.id),f.scrollViewPortTo(document.getElementById(o),r.data.offSet)}},!1),window.addEventListener("message",r=>{if(r.origin==="https://player.glomex.com"){console.log("glomex events",r);let o=r.data.__tcfapiCall,a=Array.from(document.querySelectorAll("iframe.video__content")).filter(c=>c.src.indexOf("glomex")>-1);o&&(o.command==="getTCData"||o.command==="addEventListener")&&(console.log("glomex data",o),a.forEach(c=>{F.getTCData((d,u)=>{console.log("glomex","sending"),c.contentWindow.postMessage({__tcfapiReturn:{returnValue:d,success:u,callId:o.callId}},"*")})}))}r.data.externalEmbed&&this.pubsub_.publish("externalembed:loaded",r.data.externalEmbed)},!1),this.loadAdService();try{ee.init(void 0,F.getPermission("brainTracking"))}catch{ee.init(void 0)}et.run(),this.pubsub_.publish("ad:gotDeviceClass",this.adDeviceClass_),e(void 0,void 0,this.loader_,i,!0),ve(document,w.modules),(r=>{let o;window.addEventListener("scroll",()=>{o&&window.clearTimeout(o),o=setTimeout(()=>{this.pubsub_.publish("windowScrolling")},r)})})(50),window.potec||(window.potec={}),typeof window.potec.handleAdRefresh>"u"&&(window.potec.handleAdRefresh=function(r){try{if(r){let o={trigger:"",method:"adRefresh",top:C.hasProperty(r,"top")&&r.top===!0,sky:C.hasProperty(r,"sky")&&r.sky===!0,rect:C.hasProperty(r,"rect")&&r.rect===!0};window.postMessage(o,"*")}}catch(o){console.log(o),this.pubsub_.publish("sentry:log",{error:o})}})}catch(e){console.log(e),this.pubsub_.publish("sentry:log",{error:e})}}loadAdService(){if(y.get("adServiceEnabled")){let e=window.ui.AdServiceConfig.biddingConfigUrls,t=f.getLayoutClassForCurrentViewPortWidth();D.adServiceConfig=window.ui.AdServiceConfig,D.adBiddingConfigFileUrl=e[t],D.run()}else D.sendFallbackTrackingInfo()}},tt=new ye;window.requestIdleCallback=window.requestIdleCallback||function(s){return setTimeout(function(){let e=Date.now();s({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-e))}})},1)};window.cancelIdleCallback=window.cancelIdleCallback||function(s){clearTimeout(s)};window.yieldToMain=()=>new Promise(s=>{setTimeout(s,0)});requestAnimationFrame(()=>{document.documentElement.classList.remove("no-js")});requestIdleCallback(()=>{Se.start()},{timeout:5e3});var we=[];window.ui.tcfUrl&&we.push(window.ui.tcfUrl);window.ui.AdServiceConfig&&window.ui.AdServiceConfig.enabled===!0&&we.push(w.sn+"/vendor/adservice2-defaultConfig.js");var it=document.readyState,nt=()=>{x.fetchAll(we).catch(s=>{console.error("Error loading scripts!",s)}).finally(()=>{tt.start()})};it==="interactive"||it==="complete"?nt():document.addEventListener("DOMContentLoaded",nt);
//# sourceMappingURL=entry.js.map
