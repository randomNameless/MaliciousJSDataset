<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DatePicker_v63856218962.html</title>
</head>
<body>

<script>
NewMind.registerNameSpace("NewMind.ETWP.env");NewMind.registerNameSpace("NewMind.ETWP.ControlData");if(NewMind.env&&NewMind.env.platform){$(function(){NewMind.env.platform.traceIsEnabled=($("div#PageTimer").length>0)&&($("table.trace").length>0);});}$(function(){var objQueryData=NewMind.GetQuerystringData();if(objQueryData["widget_marketsource"]!==undefined){$("a:not([href*='widget_marketsource'])").attr("target","_blank");}});function AddEventListener(obj,type,action){NewMind.dom.addEventListener(obj,type,action);}function GetEventSource(pthis){if(!document.all){var x=pthis;}else{var x=window.event.srcElement;}return x;}function returnFalse(e){var ev=e||window.event;if(ev.preventDefault){ev.preventDefault();}else{ev.returnValue=false;}}function findAncestorNode(el,strAncestorNode,strAncestorClassName){var ancestorNode=el;do{ancestorNode=ancestorNode.parentNode;}while(ancestorNode.nodeName.toLowerCase()!=strAncestorNode.toLowerCase()&&ancestorNode.className!=strAncestorClassName);return ancestorNode;}function iefix(){try{objects=document.getElementsByTagName("object");for(var i=0;i<objects.length;i++){if(objects[i].className=='iefix'){objects[i].outerHTML=objects[i].outerHTML;}}}catch(e){}}AddEventListener(window,'load',iefix);function getAnchorPosition(anchorname){var useWindow=false;var coordinates=new Object();var x=0,y=0;var use_gebi=false,use_css=false,use_layers=false;if(document.getElementById){use_gebi=true;}else if(document.all){use_css=true;}else if(document.layers){use_layers=true;}if(use_gebi&&document.all){x=AnchorPosition_getPageOffsetLeft(document.all[anchorname]);y=AnchorPosition_getPageOffsetTop(document.all[anchorname]);}else if(use_gebi){var o=document.getElementById(anchorname);x=AnchorPosition_getPageOffsetLeft(o);y=AnchorPosition_getPageOffsetTop(o);}else if(use_css){x=AnchorPosition_getPageOffsetLeft(document.all[anchorname]);y=AnchorPosition_getPageOffsetTop(document.all[anchorname]);}else if(use_layers){var found=0;for(var i=0;i<document.anchors.length;i++){if(document.anchors[i].name==anchorname){found=1;break;}}if(found==0){coordinates.x=0;coordinates.y=0;return coordinates;}x=document.anchors[i].x;y=document.anchors[i].y;}else{coordinates.x=0;coordinates.y=0;return coordinates;}coordinates.x=x;coordinates.y=y;return coordinates;}function getAnchorWindowPosition(anchorname){var coordinates=getAnchorPosition(anchorname);var x=0;var y=0;if(document.getElementById){if(isNaN(window.screenX)){x=coordinates.x-document.body.scrollLeft+window.screenLeft;y=coordinates.y-document.body.scrollTop+window.screenTop;}else{x=coordinates.x+window.screenX+(window.outerWidth-window.innerWidth)-window.pageXOffset;y=coordinates.y+window.screenY+(window.outerHeight-24-window.innerHeight)-window.pageYOffset;}}else if(document.all){x=coordinates.x-document.body.scrollLeft+window.screenLeft;y=coordinates.y-document.body.scrollTop+window.screenTop;}else if(document.layers){x=coordinates.x+window.screenX+(window.outerWidth-window.innerWidth)-window.pageXOffset;y=coordinates.y+window.screenY+(window.outerHeight-24-window.innerHeight)-window.pageYOffset;}coordinates.x=x;coordinates.y=y;return coordinates;}function AnchorPosition_getPageOffsetLeft(el){var ol=el.offsetLeft;while((el=el.offsetParent)!=null){ol+=el.offsetLeft;}return ol;}function AnchorPosition_getWindowOffsetLeft(el){return AnchorPosition_getPageOffsetLeft(el)-document.body.scrollLeft;}function AnchorPosition_getPageOffsetTop(el){var ot=el.offsetTop;while((el=el.offsetParent)!=null){ot+=el.offsetTop;}return ot;}function AnchorPosition_getWindowOffsetTop(el){return AnchorPosition_getPageOffsetTop(el)-document.body.scrollTop;}function ElementScrollTo(objEleSrc){if((!window.scroll)||(!objEleSrc))return false;var intImageStart=AnchorPosition_getWindowOffsetTop(objEleSrc);if(isNaN(parseInt(intImageStart)))return false;var OFFSET_TOP=16;var intImageHeight=parseInt(objEleSrc.height);if(isNaN(intImageHeight)||(intImageHeight<=0)&&!isNaN(objEleSrc.offsetHeight))intImageHeight=parseInt(objEleSrc.offsetHeight);var intScrollPosY=GetScrollPosY();var intViewHeight=GetViewHeight();if(isNaN(intImageHeight)||(intImageHeight<=0)||(intScrollPosY==null)||(intViewHeight==null)){var intScrollToY=intImageStart-OFFSET_TOP;if(intScrollToY<0)intScrollToY=0;scroll(0,intScrollToY);return true;}var intImageEnd=intImageStart+intImageHeight;if((intScrollPosY>intImageStart)||(intScrollPosY+intViewHeight<intImageEnd)){var intScrollToY=intImageStart-OFFSET_TOP;if(intScrollToY<0)intScrollToY=0;scroll(0,intScrollToY);}return true;function GetScrollPosY(){var intScrollY=null;if(document.all){if(!document.documentElement.scrollTop)intScrollY=document.body.scrollTop;else intScrollY=document.documentElement.scrollTop;}else intScrollY=window.pageYOffset;if(isNaN(parseInt(intScrollY)))intScrollY=null;return intScrollY;}function GetViewHeight(){if(document.documentElement&&document.documentElement.clientWidth){return document.documentElement.clientHeight;}else if(document.body){return document.body.clientHeight;}return null;}}NewMind.ETWP.GetRelativeSizeFromPixels=function(strPixels){if(!strPixels)return strPixels;strPixels=String(strPixels);if(strPixels.length<3)return strPixels;if(strPixels.substring(strPixels.length-2).toUpperCase()!="PX")return strPixels;var intPixels=parseInt(strPixels,10);if(isNaN(intPixels))return strPixels;return(intPixels/16)+"em";};function ControlScriptEnablerInit(bPrevCtrl){var strId="ElScriptEnabler"+parseInt(Math.random()*1000000000);document.write("<div id=\""+strId+"\"><!-- --></div>");var fncEnable=function(){Enable(bPrevCtrl);};setTimeout(fncEnable,1);return;function Enable(bPrevCtrl){if((typeof(bPrevCtrl)==="undefined")||(bPrevCtrl!==true))bPrevCtrl=false;var objEle=document.getElementById(strId);if(!objEle)return;var objEleCtrl=findAncestorNode(objEle,"div","sys_control");if(!objEleCtrl)return;if(bPrevCtrl){objEleCtrl=PreviousSibling(objEleCtrl);if(!objEleCtrl)return;}if(!objEleCtrl.hasChildNodes())return;for(var intIndex=0;intIndex<objEleCtrl.childNodes.length;intIndex++)ApplyScriptClass(objEleCtrl.childNodes[intIndex]);return;function ApplyScriptClass(objEle){if(IsTextNode(objEle))return;var strScriptEnabled="ScriptEnabled";var strClass=objEle.className;if((" "+strClass+" ").indexOf(" "+strScriptEnabled+" ")===-1)strClass=strClass+" "+strScriptEnabled;objEle.className=strClass;}function PreviousSibling(objEle){while(1){objEle=objEle.previousSibling;if(!objEle)return null;if(!IsTextNode(objEle))return objEle;}}function IsTextNode(objEle){return((!objEle)||(typeof(objEle.tagName)==="undefined")||(objEle.tagName==="!"));}}}function externalLinks(){if(!document.getElementsByTagName)return;var arrLinks=document.getElementsByTagName("a");for(var i=0;i<arrLinks.length;i++){var objLink=arrLinks[i];if((objLink.getAttribute("href"))&&((" "+objLink.getAttribute("rel")+" ").indexOf(" external ")!==-1)){objLink.onclick=GenNewFunc(TargetAttribCheat,(typeof(objLink.onclick)==="undefined")?null:objLink.onclick);}}function GenNewFunc(fncNew,fncOld){var objLink=null;return function(){fncNew.apply(this,arguments);if(fncOld!=null)return fncOld.apply(this,arguments);};}function TargetAttribCheat(e,bEnable,bAutoDisable,intAutoDisTimeout){e=e||window.event;if(!e)return;var objSrc=e.srcElement||e.target;if(!objSrc)return;while(String(objSrc.tagName).toUpperCase()!=="A"){if((!objSrc)||(objSrc.parentNode===objSrc))return;objSrc=objSrc.parentNode;}if((typeof(bEnable)==="undefined")||(bEnable!==false))bEnable=true;if((typeof(bAutoDisable)==="undefined")||(bAutoDisable!==false))bAutoDisable=true;if((typeof(intAutoDisTimeout)==="undefined")||isNaN(intAutoDisTimeout))intAutoDisTimeout=100;Work(objSrc,bEnable,bAutoDisable,intAutoDisTimeout);function Work(objSrc,bEnable,bAutoDisable,intAutoDisTimeout){if(bEnable){if((typeof(objSrc.targetOldNM)==="undefined")||(objSrc.targetOldNM===null)){if(typeof(objSrc.target)==="undefined")objSrc.targetOldNM="";else objSrc.targetOldNM=objSrc.target;}objSrc.target="_blank";if(bAutoDisable)setTimeout(function(){Work(objSrc,false);},intAutoDisTimeout);}else{if(typeof(objSrc.targetOldNM)!=="undefined"){objSrc.target=objSrc.targetOldNM;try{delete objSrc["targetOldNM"];}catch(e){objSrc.targetOldNM=null;}}}}}}AddEventListener(window,'load',externalLinks);NewMind.ETWP.GetQuerystringData=NewMind.GetQuerystringData;NewMind.ETWP.GetControlKey=function(node,bTraceParents){if(bTraceParents!==true){bTraceParents=false;}$node=$(node);while(true){var iControlKey=GetControlKeyForNode($node);if(iControlKey||!bTraceParents){return iControlKey;}$node=$node.parent();if($node.length===0){return 0;}}function GetControlKeyForNode($node){var nodeClass=String($node.attr('class'));var arrSegments=nodeClass.split(" ");for(var iIndex=0;iIndex<arrSegments.length;iIndex++){var strSegment=arrSegments[iIndex];if(strSegment.substring(0,1)==="c"){strSegment=strSegment.substring(1,strSegment.length);var iKey=parseInt(strSegment,10);if(!isNaN(iKey)){return iKey;}}}return 0;}};NewMind.ETWP.MouseOver=function(){return{init:function(sSelector){$(sSelector).mouseover(function(){$(this).addClass('ie-hover');}).mouseout(function(){$(this).removeClass('ie-hover');});}};}();NewMind.ETWP.TabSwitcherHelpers=function(){return{IsInTabControl:function($control){if(typeof($control.jquery)==="undefined"){return;}var bIsInTabControl=false;if(typeof(NewMind.ETWP.TabSwitcher)!=="undefined"){bIsInTabControl=$control.parents("div.ctl_Tabs").length>0;}return bIsInTabControl;},CheckForTabReSize:function($control){if(typeof($control.jquery)==="undefined"){return;}if(typeof(NewMind.ETWP.TabSwitcher)!=="undefined"){var $tabContainer=$control.parents("div.ctl_Tabs");if($tabContainer.length>0){var tabVariableName='tabs'+NewMind.ETWP.GetControlKey($tabContainer[0]);var tabToResize=NewMind.ETWP.ActiveTabSwitchers[tabVariableName];if(typeof(tabToResize)!=="undefined"){tabToResize.ResizeContainerFromJQueryObject($control);}}}}};}();NewMind.ETWP.AjaxForms=function(){var arrCallbacks=[];var doPostBack=function(node){var $node=$(node);var postbackURL=$node.attr('action');var $parentSysContainer;$parentSysContainer=$node.parents('div.sys_control');var iControlKey=NewMind.ETWP.GetControlKey($parentSysContainer);if($node.parents('div.blockMsg').length>0){$parentSysContainer=$node.parents('div.blockMsg').find('div.sys_control');iControlKey=NewMind.ETWP.GetControlKey($parentSysContainer);}var strUrl=String(postbackURL);if(strUrl.indexOf("?")===-1){strUrl=postbackURL+"?PartialRenderControlList="+iControlKey;}else{strUrl=postbackURL+"&PartialRenderControlList="+iControlKey;}$.ajax({type:'post',url:strUrl,data:$node.serialize(),success:function(data,iControlKey){var rawdata=eval(data);if(NewMind.ETWP.FormPostBack[0].redirectURL){window.location=NewMind.ETWP.FormPostBack[0].redirectURL;}if(NewMind.ETWP.FormPostBack[0].formHTML){$html=$(NewMind.ETWP.FormPostBack[0].formHTML);$parentSysContainer.html($html);NewMind.ETWP.TabSwitcherHelpers.CheckForTabReSize($node);var intCurrentScrollTop=NewMind.ETWP.GetScrollDistanceFromTopOfBody();var intControlTop=$parentSysContainer.parent().offset().top;var intViewportHeight=$(window).height();var intControlHeight=$parentSysContainer.height();var intControlEndPosition=intControlTop+intControlHeight;var intTargetScrollPosition=0;if(intControlEndPosition>intViewportHeight){intTargetScrollPosition=intControlEndPosition-intViewportHeight;}if(intTargetScrollPosition<intCurrentScrollTop){$("html,body").animate({scrollTop:intTargetScrollPosition},1000);}for(var i=0;i<arrCallbacks.length;i++){try{arrCallbacks[i](node);}catch(e){if((typeof(console)!=="undefined")&&console.warn){console.warn("NewMind.ETWP.AjaxForms callback failed: "+e.message);}}}}return false;},error:function(){$.unblockUI();$node.unbind('submit').submit();}});};return{postback:function(node){doPostBack(node);return false;},register:function(callback){arrCallbacks.push(callback);}};}();NewMind.ETWP.ColumnResizer=function(){var resizeCols=function(sSelectors){var iHeight=0;$(sSelectors).each(function(){if($(this).height()>iHeight){iHeight=$(this).height();}}).height(iHeight);};return{init:function(){},resize:function(sSelectors){resizeCols(sSelectors);}};}();NewMind.ETWP.TwoColumnMaker=function(){var makeCols=function(sContainer,bKeepHeader){var $items=$(sContainer);var $parent=$items.parent();if(bKeepHeader){$items.before($items.find("h2"));}$items.before('<div class="oddColumn"></div><div class="evenColumn"></div>');$items.find("h3:odd").each(function(i){var $this=$(this);var $objChild=$this.next();$parent.find('.oddColumn').append($this).append($objChild);});$items.find("h3").each(function(i){var $this=$(this);var $objChild=$this.next();$parent.find('.evenColumn').append($this).append($objChild);});$items.remove();};var makeCols2=function(sSelector,sParent,breakPosition,offset){var $items=$(sSelector);var $parent=$(sParent);$parent.empty();if(offset>0){$parent.append($items.slice(0,offset));}$parent.append('<div class="oddColumn"></div><div class="evenColumn"></div>');$parent.find('.oddColumn').append($items.slice(offset,breakPosition));$parent.find('.evenColumn').append($items.slice(breakPosition,$items.length));};return{init:function(){},makeCols:function(sContainer,bKeepHeader){makeCols(sContainer,bKeepHeader);},makeCols2:function(sSelector,sParent,breakPosition,offset){makeCols2(sSelector,sParent,breakPosition,offset);}};}();NewMind.ETWP.GetResource=function(sResource,sDefault){var sRoot="NewMind";sResource=rewriteInDotNotation($.trim(""+sResource));if(sResource.substr(0,sRoot.length+1)!==(sRoot+".")){return sDefault;}sResource=sResource.substr(sRoot.length+1);return useDefaultIfUndefined(getPropertyIfItExists(NewMind,sResource),sDefault);function rewriteInDotNotation(sResource){while(sResource.indexOf("[\"")!==-1){sResource=sResource.replace("[\"",".").replace("\"]","");}while(sResource.indexOf("['")!==-1){sResource=sResource.replace("['",".").replace("']","");}return sResource;}function getPropertyIfItExists(objCore,strPath){var arrSegments=(""+strPath).split(".");for(var i=0;i<arrSegments.length;i++){objCore=objCore[arrSegments[i]];if(typeof(objCore)==="undefined"){return;}}return objCore;}function useDefaultIfUndefined(objValue,strDefault){return(typeof(objValue)==="undefined")?strDefault:objValue;}};NewMind.ETWP.GetScrollDistanceFromTopOfBody=function(){var scrOfY=0;if(typeof(window.pageYOffset)=='number'){scrOfY=window.pageYOffset;}else if(document.body&&(document.body.scrollTop)){scrOfY=document.body.scrollTop;}else if(document.documentElement&&(document.documentElement.scrollTop)){scrOfY=document.documentElement.scrollTop;}return scrOfY;};NewMind.ETWP.NoCache=(function(){var objQuerystring=NewMind.ETWP.GetQuerystringData();var strNoCache=objQuerystring.get("nocache");if(strNoCache===null)return false;strNoCache=String(strNoCache).toLowerCase();return((strNoCache==="1")||(strNoCache==="true"));})();NewMind.ETWP.HtmlEncode=function(strName){strName=$("<div>"+strName+"</div>").html();while(strName.indexOf("£")!==-1){strName=strName.replace("£","&pound;");}return strName;};NewMind.registerNameSpace("NewMind.ETWP.RelatedProducts");NewMind.ETWP.RelatedProducts.Paging=function(controlKey){var $objControl=$('div.c'+controlKey);if($objControl.length>0){var cPlaceholder="rppagesize";$objControl.find('div[class*="'+cPlaceholder+'"]').each(function(){var pageNum=1;var intPageSize;var $relatedProductWrapper=$(this);var aryClasses=$relatedProductWrapper.attr("class").split(' ');for(var i=0;i<aryClasses.length;i++){if(aryClasses[i].indexOf(cPlaceholder)>=0){intPageSize=parseInt(aryClasses[i].slice(cPlaceholder.length),10);}}if(isNaN(intPageSize)||(intPageSize==0)){return;}var $relatedProductItems=$relatedProductWrapper.find('.relatedproductitem');if($relatedProductItems.length>intPageSize){$relatedProductItems.each(function(index){if(index>=(intPageSize*pageNum)){pageNum++;}if(pageNum>1){$(this).hide();}$(this).addClass('page'+pageNum);});var resourceSection='productdetail';if($objControl.hasClass('ctl_ProductList')){resourceSection='productlist';}$relatedProductWrapper.append('<a href="#" class="pagingNextBtn">'+NewMind.ETWP.GetResource('NewMind.env.lang.resources.'+resourceSection+'.relatedproducts["pagingbutton"]','Show more related')+'</a>');var $pagingBtn=$relatedProductWrapper.find('.pagingNextBtn');$pagingBtn.data('pageNum',1);$pagingBtn.click(function(event){event.preventDefault();var $pagingBtn=$(this);var $currentPage=$(this).data('pageNum');if($currentPage<pageNum){$pagingBtn.parent().find('.page'+($currentPage+1)).slideDown('fast',function(){$pagingBtn.data('pageNum',$currentPage+1);if($pagingBtn.data('pageNum')>=pageNum){$pagingBtn.hide().unbind('click');}if(typeof(NewMind.ETWP.TabSwitcherHelpers)!=="undefined"){NewMind.ETWP.TabSwitcherHelpers.CheckForTabReSize($pagingBtn);}});}});}});}};NewMind.registerNameSpace("NewMind.ETWP").Trace=(function(){var timerFirst=null;var timerLast=null;function getTimeFromStartInMs(){if(timerFirst===null){timerFirst=new Date().getTime();return 0;}return(new Date().getTime())-timerFirst;}function getTimeFromLastInMs(){var time=(timerLast===null)?0:(new Date().getTime())-timerLast;timerLast=new Date().getTime();return time;}function getTraceTable(){var $table=$("table.trace.javascript");if($table.length>0){return $table;}var html=["<table border=\"1\" class=\"trace javascript\">","<col width=\"1000\" /><col width=\"100\"/><col width=\"100\"/>","<thead>","<tr class=\"heading\">","<th colspan=\"3\">Javascript</th></tr><tr class=\"colheader\"><th>Action</th><th class=\"time\">From Start(s)</th><th class=\"time\">From Last(s)</th>","</tr>","</thead>","<tbody>","</tbody>","</table>"].join("");$table=$(html);$("body").append($table);return $table;}function writeTraceHeaderEntry(strMessage){if(!isJavascriptTraceEnabled()||!strMessage){return;}var $table=getTraceTable();var $tableBody=$table.find("tbody");var $newRow=$("<tr class=\"subheading\"><td colspan=\"3\"></td></tr>");$tableBody.append($newRow);$newRow.find("td")[0].innerHTML=strMessage;getTimeFromStartInMs();getTimeFromLastInMs();}function writeTraceEntry(strMessage,bIsErrorRow,bIsTimedEntry){if(!isJavascriptTraceEnabled()||!strMessage){return;}var $table=getTraceTable();var $tableBody=$table.find("tbody");var strRowClass=(($tableBody.children("tr").length%2)==0)?"row1":"row2";if(bIsErrorRow){strRowClass="error"+strRowClass;}var $newRow=$("<tr><td></td><td></td><td></td></tr>");$tableBody.append($newRow);$newRow.addClass(strRowClass);$newRow.find("td")[0].innerHTML=strMessage;if(bIsTimedEntry){$newRow.find("td")[1].innerHTML=getTimeAsDisplayValue(getTimeFromStartInMs());$newRow.find("td")[2].innerHTML=getTimeAsDisplayValue(getTimeFromLastInMs());}}function getTimeAsDisplayValue(intTimeInMilliseconds){return(intTimeInMilliseconds===0)?"0":(intTimeInMilliseconds/1000).toFixed(8);}function isJavascriptTraceEnabled(){return(NewMind.env&&NewMind.env.platform&&NewMind.env.platform.traceIsEnabled);}return{PrintTrace:function(strMessage){writeTraceEntry(strMessage,false,false);},PrintTraceError:function(strMessage){if(strMessage){writeTraceEntry("<span><strong>!!ERROR!!</strong> "+strMessage+"</span>",true,false);}},PrintTraceWarning:function(strMessage){if(strMessage){writeTraceEntry("<span class=\"warning\"><strong>!!WARNING!!</strong> "+strMessage+"</span>",false,false);}},TimedTraceTableSubHeading:writeTraceHeaderEntry,TimedTraceTableRow:function(strMessage){writeTraceEntry(strMessage,false,true);}};})();
NewMind.registerNameSpace("NewMind.ETWP").PersistentAttempt=function(options){var fncCondition,intMaxNumberOfAttempts,fncGetPauseTimeInMilliseconds,fncSuccess,fncOptionalFailure;if(!options){throw new Error("No options specified");}if(typeof(options.Condition)==="undefined"){throw new Error("No options.Condition specified");}if(typeof(options.Condition)!=="function" ){throw new Error("Invalid options.Condition - not a function");}fncCondition=options.Condition;if(typeof(options.Success)==="undefined"){throw new Error("No options.Success specified");}if(typeof(options.Success)!=="function" ){throw new Error("Invalid options.Success - not a function");}fncSuccess=options.Success;if((typeof(options.Failure)!=="undefined")&&(typeof(options.Success)!=="function" )){throw new Error("Invalid options.Failure - not a function");}fncOptionalFailure=options.Failure;if((typeof(options.DelayCalculator)!=="undefined")&&(typeof(options.FixedDelayInMs)!=="undefined")){throw new Error("Only one of DelayCalculator and FixedDelayInMs may be specified, not both (or neither to use defaults)");}if(typeof(options.DelayCalculator)!=="undefined"){if(typeof(options.DelayCalculator)!=="function" ){throw new Error("Invalid options.DelayCalculator - not a function");}fncGetPauseTimeInMilliseconds=options.DelayCalculator;}if(typeof(options.FixedDelayInMs)!=="undefined"){var intTimeToPauseInMilliseconds=parseInt(options.FixedDelayInMs,10);if(isNaN(intTimeToPauseInMilliseconds)){throw new Error("Invalid options.FixedDelayInMs - not a function");}if(intTimeToPauseInMilliseconds<=0){throw new Error("Invalid options.FixedDelayInMs, must be a positive value");}fncGetPauseTimeInMilliseconds=function(){return intTimeToPauseInMilliseconds;};}if(typeof(options.MaxNumberOfAttempts)!=="undefined"){intMaxNumberOfAttempts=parseInt(options.MaxNumberOfAttempts,10);if(isNaN(intMaxNumberOfAttempts)){throw new Error("Invalid options.MaxNumberOfAttempts - not a function");}if(intMaxNumberOfAttempts<=0){throw new Error("Invalid options.MaxNumberOfAttempts, must be a positive value");}}intMaxNumberOfAttempts=intMaxNumberOfAttempts||10;fncGetPauseTimeInMilliseconds=fncGetPauseTimeInMilliseconds||function(){return 100;};var intNumberOfAttempts=0;function Process(){if(fncCondition(intNumberOfAttempts)){fncSuccess();return;}intNumberOfAttempts++;if(intNumberOfAttempts>=intMaxNumberOfAttempts){if(fncOptionalFailure){fncOptionalFailure(intNumberOfAttempts);}return;}var intTimeToPauseInMilliseconds=parseInt(fncGetPauseTimeInMilliseconds(intNumberOfAttempts),10);if(isNaN(intTimeToPauseInMilliseconds)||(intTimeToPauseInMilliseconds<=0)){if(fncFailure){fncFailure(intNumberOfAttempts);}return;}setTimeout(Process,intTimeToPauseInMilliseconds);}Process();};
NewMind.registerNameSpace("NewMind.ETWP").Bookmarklets=(function(){var ControlNameDataLoader=(function(){var bControlNameDataBeingLoaded=false;var objControlData=null;var arrControlNameDataLoadedCallbacks=[];function unique(arr){var u={},a=[];for(var i=0,l=arr.length;i<l;++i){if(!u.hasOwnProperty(arr[i])){a.push(arr[i]);u[arr[i]]=1;}}return a;}return{requestControlNames:function(callback){if(objControlData){callback(objControlData);return;}arrControlNameDataLoadedCallbacks.push(callback);if(bControlNameDataBeingLoaded){return;}var bControlNameDataBeingLoaded=true;var pageControlKeys=[];$("div.sys_control").each(function(){pageControlKeys.push(NewMind.ETWP.GetControlKey(this));});$.getJSON("/engine/controlNameLookup.asp?pageControlKeys="+unique(pageControlKeys),function(data){objControlData=data;bControlNameDataBeingLoaded=false;for(var i=0;i<arrControlNameDataLoadedCallbacks.length;i++){arrControlNameDataLoadedCallbacks[i](objControlData);}arrControlNameDataLoadedCallbacks=[];});}};}());var $controlNameOverlay=null;return{ControlParams:function(fncControlClicked){fncControlClicked=fncControlClicked||openInLegacyCMS;ControlNameDataLoader.requestControlNames(function(){});var $currentlySelected=null;var $overlay=null;function interceptClick(){release();var intCtrlKey=getNormalisedControlKey(NewMind.ETWP.GetControlKey(this));if(intCtrlKey){fncControlClicked(intCtrlKey);}return false;}function interceptMouseOver(e){var intCurrentControlKey=($currentlySelected?getNormalisedControlKey(NewMind.ETWP.GetControlKey($currentlySelected[0])):0);var intCtrlKey=getNormalisedControlKey(NewMind.ETWP.GetControlKey(e.target,true));if(intCtrlKey!==intCurrentControlKey){releaseControl();$currentlySelected=$("div.sys_control.c"+intCtrlKey);$currentlySelected.fadeTo("fast",0.2);$currentlySelected.click(interceptClick);if(!intCtrlKey){if($controlNameOverlay){$controlNameOverlay.hide();}}else{ControlNameDataLoader.requestControlNames(function(controlData){if(!$controlNameOverlay){$controlNameOverlay=$("<div class='BookmarkletControlNameOverlay' />").css({position:"fixed","z-index":10002,bottom:0,right:0,padding:"8px",background:"#f8f8f8",color:"#777",border:"1px solid #c0c0c0",opacity:0.8});$("body").append($controlNameOverlay);}if(controlData.hasOwnProperty(intCtrlKey)){$controlNameOverlay.html(controlData[intCtrlKey].join(" / ")).show();}else{$controlNameOverlay.hide();}});}}return false;};function getNormalisedControlKey(intCtrlKey){if(intCtrlKey===-4){return 0;}return Math.abs(intCtrlKey);}function releaseControl(){if($currentlySelected){$currentlySelected.fadeTo("fast",1);$currentlySelected.unbind("click",interceptClick);}$currentlySelected=null;}function release(){releaseControl();$("*").unbind("mouseover",interceptMouseOver);$(document).unbind("click",interceptClick);if($controlNameOverlay){$controlNameOverlay.hide();}}function openInLegacyCMS(intCtrlKey){window.open(NewMind.env.platform.interface+"/admininc/editParams.asp?table=params&popup=1&paramtype=pagecontrol&id="+intCtrlKey+"&page="+NewMind.env.page.pagekey,"EnterprisePopup"+Math.floor(Math.random()*100000000),"width=1200,height=600");}$("*").mouseover(interceptMouseOver);$(document).click(interceptClick);}};}());
NewMind.registerNameSpace("NewMind.ETWP").GoogleAnalyticsExtensions=(function(){$(function(){if(NewMind.env&&NewMind.env.page&&NewMind.env.page.gatrackexitlinks){if(typeof ga==="object"||typeof pageTracker==="object"||typeof _gaq==="object"){$("a[href*='://'],a[href*='%3A%2F%2F']").live("click",function(){var href=unescape($(this).attr("href"));if(href.indexOf(window.location.hostname.replace("www.",""))!==-1){return true;}var fakePageName=href.substr(href.indexOf("://")+3);var utmVarsStartIndex=fakePageName.indexOf("utm_source");if(utmVarsStartIndex!==-1){fakePageName=fakePageName.substr(0,utmVarsStartIndex-1);}fakePageName="/external-link/"+fakePageName.replace("www.","");if(typeof(ga)==="object"){ga('send','pageview',fakePageName);}else if(typeof(_gaq)==="object"){_gaq.push(["_trackPageview",fakePageName]);}else{pageTracker._trackPageview(fakePageName);}});}}});function recordBookingForGoogleAnalyticsUniversal(objData){ga('require','ecommerce');ga('ecommerce:addTransaction',{'id':objData.RequirementRef,'affiliation':objData.MarketSourceId,'revenue':""+objData.Price.Total});var intItemIndex=0;for(var i=0;i<objData.OrderLines.length;i++){var objOrderLine=objData.OrderLines[i];var sngAveragePrice=objOrderLine.Cost/objOrderLine.Quantity;for(var j=0;j<objOrderLine.Quantity;j++){ga('ecommerce:addItem',{'id':objData.RequirementRef,'name':objData.Product.Key+"-"+objData.Product.Name,'sku':generateSKU(objOrderLine,intItemIndex,objData),'price':""+sngAveragePrice,'quantity':'1'});intItemIndex++;}}ga('ecommerce:send');}function recordBookingForLegacyGoogleAnalyticsAccount(objData){_gaq.push(["_addTrans",objData.RequirementRef,objData.MarketSourceId,""+objData.Price.Total,"",""+objData.Price.BookingFee,objData.ConsumerAddressSummary.Address4IfAny,objData.ConsumerAddressSummary.Address5IfAny,objData.ConsumerAddressSummary.Country]);var intPlaceKey=objData.Product.PlaceIfAny?objData.Product.PlaceIfAny.Key:0;var strPlaceName=objData.Product.PlaceIfAny?objData.Product.PlaceIfAny.Name:"None";var strPlaceCat=intPlaceKey+"-"+strPlaceName+"-"+objData.Product.PrimaryCategoryIdIfAny;var intItemIndex=0;for(var i=0;i<objData.OrderLines.length;i++){var objOrderLine=objData.OrderLines[i];var sngAveragePrice=objOrderLine.Cost/objOrderLine.Quantity;for(var j=0;j<objOrderLine.Quantity;j++){_gaq.push(["_addItem",objData.RequirementRef,generateSKU(objOrderLine,intItemIndex,objData),objData.Product.Key+"-"+objData.Product.Name,strPlaceCat,""+sngAveragePrice,"1"]);intItemIndex++;}}_gaq.push(["_trackTrans"]);}function generateSKU(objOrderLine,intItemIndex,objParentOrderDetails){return [objParentOrderDetails.Product.Key,objOrderLine.UnitKey,"A"+objOrderLine.NumberOfAdults,"C"+objOrderLine.NumberOfChildren,"N"+objParentOrderDetails.NumberOfNights,"R"+(intItemIndex+1)].join("-");}return{RecordBooking:function(objData){if(typeof(ga)!=="undefined"){recordBookingForGoogleAnalyticsUniversal(objData);}else if(typeof(_gaq)!=="undefined"){recordBookingForLegacyGoogleAnalyticsAccount(objData);}}};}());
(function(){window.NewMind=window.NewMind||{};var NewMind=window.NewMind;NewMind.ajax={ajaxEnableItineraryLinks:function(){$("p.ex_AddButton a, td.delete a").each(function(){if(this.attachedItinButtonClickHandler){return;}$(this).click(NewMind.ajax.itinButtonClickHandler);this.attachedItinButtonClickHandler=true;});$("p.ex_AddButton a.ep_Add, p.ex_AddButton a.ep_Added").each(function(){var objItineraryAction=TryToGetItinActionDataFromLink(this.href);if(!objItineraryAction){return;}var $this=$(this);if($this.hasClass("ep_Add")&&IsProductInItinData(objItineraryAction.ProductKey)){$this.removeClass("ep_Add").addClass("ep_Added");}else if($this.hasClass("ep_Added")&&!IsProductInItinData(objItineraryAction.ProductKey)){$this.removeClass("ep_Added").addClass("ep_Add");}});$("div.blogpostrelatedproductsaddalltoitinerary > a").each(function(){if(this.attachedItinButtonClickHandler){return;}$(this).click(function(e){e.preventDefault();var productKeys=$(this).attr("data-relatedproductsaddalltoitinerary");if(!productKeys){return;}NewMind.ajax.doItinAjaxAction("addmultiple",productKeys,null);});this.attachedItinButtonClickHandler=true;});},urlencode:function(strValue){return encodeURIComponent((strValue+'').toString()).replace(/!/g,'%21').replace(/'/g,'%27').replace(/\(/g,'%28').replace(/\)/g,'%29').replace(/\*/g,'%2A').replace(/%20/g,'+');},itinButtonClickHandler:function(e){var objEleLink=this;if(objEleLink.tagName.toLowerCase()!=="a"){return;}var objItineraryAction=TryToGetItinActionDataFromLink(objEleLink.href);if(objItineraryAction.Action!=="ctrlremove"){objItineraryAction.Action=IsProductInItinData(objItineraryAction.ProductKey)?"remove":"add";}if((objItineraryAction.Action==="remove")&&(!IsItinButtonInItinControl(objEleLink))){e.preventDefault();JumpToItinBasket();return;}if(NewMind.ETWP&&NewMind.ETWP.env&&NewMind.ETWP.env.Disable_Ajax_Itinerary===true&&!NewMind.env.suggesteditinerary){return;}if(!objItineraryAction){return;}e.preventDefault();if(objItineraryAction.Action==="add"){$("a.ep_"+objItineraryAction.ProductKey).removeClass("ep_Add").addClass("ep_Adding").children("img").attr("alt",function(){return $(this).attr("alt").replace("Add","Adding");});}else if(objItineraryAction.Action==="remove"||objItineraryAction.Action==="ctrlremove"){$("a.ep_"+objItineraryAction.ProductKey).removeClass("ep_Added").addClass("ep_Removing").children("img").attr("alt",function(){return $(this).attr("alt").replace("Remove","Removing");});}NewMind.ajax.doItinAjaxAction(objItineraryAction.Action,objItineraryAction.ProductKey,objEleLink);function IsItinButtonInItinControl(objEle){while(objEle){if((objEle.parentNode===objEle)||(!objEle.parentNode))break;objEle=objEle.parentNode;if($(objEle).hasClass("sys_control")){if(($(objEle).hasClass("ctl_ItineraryBasket"))||($(objEle).hasClass("ctl_ItineraryDetail")))return true;else return false;}}return false;}function JumpToItinBasket(){var arrEles=$("div.ctl_ItineraryBasket");if(arrEles.length>0){var objEleBasket=arrEles[0];ElementScrollTo(objEleBasket);arrEles.css({opacity:0.5}).animate({opacity:1});}}},doItinAjaxAction:function(action,key,btn){var intItinLibCtrlKey=NewMind.env.page.itinlibkey;var strPostUrl=NewMind.ajax.CleanCurrentUrlForAjax();var objPostData={PartialRenderControlList:intItinLibCtrlKey,AsyncAction:"get-itin-data",epaction:action,epkey:key};$.get(strPostUrl,objPostData,function(data){if(arguments[1]=='success'){NewMind.ajax.itinAjaxCallback(action,key,btn,data);}});},itinAjaxCallback:function(action,key,btn,data){var rawData=eval(data);var strBasketTable=rawData[0].baskettable||"";var strBasketLinks=rawData[0].basketlinks||"";NewMind.env.excursion=rawData[0].products;if(action==="addmultiple"){UpdateItinBasket(strBasketTable,strBasketLinks);}if(action=="add"){var objEleItinBasket=$("div.ctl_ItineraryBasket");$("a.ep_"+key).removeClass("ep_Adding").addClass("ep_Added").attr("href",function(){return $(this).attr("href").replace("add","remove");}).children("img").attr("alt",function(){return $(this).attr("alt").replace("Adding","Remove").replace(" to "," from ");}).end().flyTo(objEleItinBasket);UpdateItinBasket(strBasketTable,strBasketLinks);}if(action=="remove"||action=="ctrlremove"){$('a.ep_'+key).removeClass("ep_Added").removeClass("ep_Removing").addClass("ep_Add").attr("href",function(){return $(this).attr("href").replace("remove","add");}).children("img").attr("alt",function(){return $(this).attr("alt").replace("Removing","Add").replace(" from "," to ");});UpdateItinBasket(strBasketTable,strBasketLinks);}if(NewMind.env.excursion.length==0){$("div.ctl_ItineraryBasket > div.EmptyMsg").show();}else{$("div.ctl_ItineraryBasket > div.EmptyMsg").hide();}setTimeout(function(){NewMind.ajax.itinUpdated.fire(action,key);},50);function UpdateItinBasket(strBasketTable,strBasketLinks){if($("table.ItineraryTbl").length>0){$("table.ItineraryTbl").replaceWith(strBasketTable);}else{$(".ctl_ItineraryBasket p.link").before(strBasketTable);}$("table.ItineraryTbl td.delete a").click(NewMind.ajax.itinButtonClickHandler);$(".ctl_ItineraryBasket p.link").replaceWith(strBasketLinks);NewMind.ajax.ajaxEnableItineraryLinks();}function addProduct(key){var arrExcursion=NewMind.env.excursion;for(var intIndex=0;intIndex<arrExcursion.length;intIndex++){if(arrExcursion[intIndex].product_key===key){return;}}arrExcursion.push({product_key:key});}function removeProduct(key){var arrExcursion=NewMind.env.excursion;for(var intIndex=0;intIndex<arrExcursion.length;intIndex++){if(arrExcursion[intIndex].product_key==key){arrExcursion.splice(intIndex,1);}}}},itinUpdated:new NewMind.CustomEvent("itinUpdated",this),CleanCurrentUrlForAjax:function(){var arrRemove=["Action","AsyncAction","PartialRender","PartialRenderControlList","PartialRenderType","epaction","epkey","suggesteditin"];return CleanCurrentUrlQuerystring(arrRemove,true);function CleanCurrentUrlQuerystring(arrRemove,bDropHash){if(!arrRemove)arrRemove=[];arrRemove.push("");var strQuery=String(document.location.search);var strHash=String(document.location.hash);var strUrl=String(document.location.href);if(strUrl.indexOf("?")!=-1)strUrl=strUrl.substring(0,strUrl.indexOf("?"));if(strUrl.indexOf("#")!=-1)strUrl=strUrl.substring(0,strUrl.indexOf("#"));if(strQuery.substring(0,1)==="?")strQuery=strQuery.substring(1);arrQuery=strQuery.split("&");for(var iQ=arrQuery.length-1;iQ>=0;iQ--){var strName=arrQuery[iQ].toLowerCase();if(strName.indexOf("=")!=-1)strName=strName.substring(0,strName.indexOf("="));var bRemoved=false;for(var iR=0;iR<arrRemove.length;iR++){if(String(arrRemove[iR]).toLowerCase()===strName){bRemoved=true;break;}}if(bRemoved){arrQuery.splice(iQ,1);}}var strOut=strUrl;if(arrQuery.length>0)strOut+="?"+arrQuery.join("&");if(!bDropHash)strOut+=strHash;return strOut;}}};function TryToGetItinActionDataFromLink(strHref){var aryActionMatches=(""+strHref).match(/epaction=([a-z]+)/);if(aryActionMatches.length<2){return null;}var aryKeyMatches=(""+strHref).match(/epkey=([0-9]+)/);if(aryKeyMatches.length===0){return null;}var intKey=parseInt(aryKeyMatches[1]);if(isNaN(intKey)){return null;}return{Action:aryActionMatches[1],ProductKey:intKey};}function IsProductInItinData(intKey){var arrExcursion=NewMind.env.excursion;for(var intIndex=0;intIndex<arrExcursion.length;intIndex++){if(arrExcursion[intIndex].product_key==intKey){return true;}}return false;}$(document).ready(NewMind.ajax.ajaxEnableItineraryLinks);})();
NewMind.CookieWarning=(function(){var bCookieWarningPopupVisible=false;function displayCookieInfo(strContent,strTitle,strConfirmLabel,bJumpToCookieSettingInfo){strContent=["<div class=\"CookieWarningPopup\">",strTitle?("<h2 class=\"CookieWarningTitle\">"+strTitle+"</h2>"):"","<div class=\"CookieWarningPopupContent\">",strContent,"</div>","<div class=\"CookieWarningPopupConfirm\">","<input type=\"submit\" />","</div>","</div>"].join("");var $content=$(strContent);$content.find("input[type=submit]").val(strConfirmLabel||"Ok").click(function(){$.unblockUI();hideBanner();bCookieWarningPopupVisible=false;});$.blockUI({message:$content[0],css:{width:"750px","height":"600px",top:"0",left:"0",padding:"0",textAlign:"center",cursor:"auto","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px","border-width":"6px"},overlayCSS:{backgroundColor:"#fff",opacity:"0.6",cursor:null},baseZ:5000,fadeIn:200,fadeOut:200});$(".blockUI.blockMsg a[rel=external]").attr("target","_blank");bCookieWarningPopupVisible=true;if(bJumpToCookieSettingInfo){document.location="#HowToChangeCookieSettings";}resizeMessageContainerIfDisplayingWarning();setAcceptanceCookie();}function setAcceptanceCookie(){document.cookie="AcceptCookies=1; expires="+getCookieExpirationDate().toGMTString()+"; path=/";function getCookieExpirationDate(){var dtExpiration=new Date();dtExpiration.setTime(dtExpiration.getTime()+(10*365*24*60*60*1000));return dtExpiration;}}function hideBanner(){$("div.ctl_CookieWarning").slideUp();}function resizeMessageContainerIfDisplayingWarning(){if(!bCookieWarningPopupVisible){return;}$(".blockUI.blockMsg").each(function(){var $this=$(this);var $window=$(window);var sngTop=($window.height()-$this.height())/2+$window.scrollTop();var sngLeft=($window.width()-$this.width())/2+$window.scrollLeft();$this.css("position","absolute");$this.css("top",((sngTop<0)?0:sngTop)+"px");$this.css("left",((sngLeft<0)?0:sngLeft)+"px");});}function getCookieLinkHandler(objEleSrcLink,strContentUrl,strTitle,strConfirmLabel,bJumpToCookieSettingInfo){return function(){$.ajax({type:"GET",url:strContentUrl,success:function(data){if(!data){window.location=objEleSrcLink.href;return;}displayCookieInfo(data,strTitle,strConfirmLabel,bJumpToCookieSettingInfo);},error:function(){window.location=strContentUrl;}});return false;};}return{Init:function(strContentUrl,strTitle,strConfirmLabel){if(!strContentUrl){return;}$("div.CookieWarning div.CookieMessage a.CookieSettingsLink").click(getCookieLinkHandler(this,strContentUrl,strTitle,strConfirmLabel,true));$("div.CookieWarning div.CookieMessage a.CookieInfoLink").click(getCookieLinkHandler(this,strContentUrl,strTitle,strConfirmLabel,false));$("div.CookieWarning a.CookieWarningHide").click(function(){setAcceptanceCookie();hideBanner();return false;});$(window).resize(function(){resizeMessageContainerIfDisplayingWarning();});}};})();
NewMind.registerNameSpace("NewMind.ETWP").LazyLoadImages=(function(){"use strict";var strLazySrcAttributeName="data-lazy-src";var strInProgressSrcAttributeName="data-in-progress-src";var strLazyLoadTransitionInProgress="LazyLoadInProgress";var bDisableLoading=false;var arrPreLoadCallbacks=[];var arrPostLoadCallbacks=[];var fncOptionalTransitionHandler=null;var intPreviewDistanceInPixels=64;var fncThrottledTrigger=$.throttle(100,loadAnyVisibleLazyImages);var $missingImagesOverlay=$("<div />");function getAllLazyLoadImages(){return $("img["+strLazySrcAttributeName+"]");}function loadAllLazyImages(){loadSpecificLazyImages(getAllLazyLoadImages());}function loadAnyVisibleLazyImages(){loadSpecificLazyImages(getAllLazyLoadImages().filter(function(){return $(this).isOnScreen(intPreviewDistanceInPixels);}));}function loadSpecificLazyImages($imgs){$imgs.each(function(){var $this=$(this);var strImageUrl=$this.attr(strLazySrcAttributeName);if(!strImageUrl){return;}if(bDisableLoading){if((typeof(console)!=="undefined")&&console.log){console.log("NewMind.ETWP.LazyLoadImages: Image loading has been disabled for testing - not loading "+strImageUrl);}return;}$this.removeAttr(strLazySrcAttributeName);for(var i=0;i<arrPreLoadCallbacks.length;i++){var strNewImageUrl=arrPreLoadCallbacks[i]($this,strImageUrl);if(strNewImageUrl){strImageUrl=strNewImageUrl;}}$this.addClass(strLazyLoadTransitionInProgress).attr(strInProgressSrcAttributeName,strImageUrl);completeInProgressImageLoading($this,false);});}function completeInProgressImageLoading($imgs,bManualRequest){$imgs.filter("."+strLazyLoadTransitionInProgress).each(function(){var $this=$(this);var strImageUrl=$this.attr(strInProgressSrcAttributeName);if(!strImageUrl){return;}if(bManualRequest){$this.removeClass(strLazyLoadTransitionInProgress).removeAttr(strInProgressSrcAttributeName);}$this.stop(true,false);var fncTransitionHandler=fncOptionalTransitionHandler||defaultTransitionHandler;fncTransitionHandler($this,strImageUrl,function(){$this.removeClass(strLazyLoadTransitionInProgress).removeAttr(strInProgressSrcAttributeName);for(var i=0;i<arrPostLoadCallbacks.length;i++){arrPostLoadCallbacks[i]($this,strImageUrl);}});});}function defaultTransitionHandler($img,strImageUrl,fncCallback){$img.css("opacity",0);var fncImageLoaded=function(){$img.animate({"opacity":1},fncCallback);};if(($img.attr("src")===strImageUrl)&&$img[0].complete){fncImageLoaded();return;}$img.one("load",fncImageLoaded);$img.attr("src",strImageUrl);}$(loadAnyVisibleLazyImages);var $window=$(window);$window.scroll(fncThrottledTrigger);$window.resize(fncThrottledTrigger);$window.bind("beforeprint",function(){if(getAllLazyLoadImages().length===0){$missingImagesOverlay.hide();}else{$missingImagesOverlay.show();}loadAllLazyImages();});if(window.matchMedia){window.matchMedia("print").addListener(function(mql){if(mql.matches){$window.trigger("beforeprint");}});}$(displayInitiallyHiddenLazyLoadImages);function displayInitiallyHiddenLazyLoadImages(){getAllLazyLoadImages().show();setTimeout(fncThrottledTrigger);}$(function(){$missingImagesOverlay.addClass("lazyLoadImageInProgressMessage");var $message=$("<span class='notReadyYetMessage' />");$message.html(NewMind.ETWP.GetResource("NewMind.env.lang.resources.lazyloadingimages.printmessage","Some images are still being loaded, please cancel the print request and try again"));$missingImagesOverlay.append($message);$missingImagesOverlay.hide();$("body").append($missingImagesOverlay);});return{EarlyInit:displayInitiallyHiddenLazyLoadImages,RegisterLazyLoadTrigger:fncThrottledTrigger,LoadSpecificLazyImages:loadSpecificLazyImages,BumpInProgressImages:function($img){completeInProgressImageLoading($img,true);},OverrideTransition:function(fncTransitionHandler){fncOptionalTransitionHandler=fncTransitionHandler;},AddPreLoadCallback:function(fncPreLoadCallback){arrPreLoadCallbacks.push(fncPreLoadCallback);},AddPostLoadCallback:function(fncPostLoadCallback){arrPostLoadCallbacks.push(fncPostLoadCallback);},DisableForTesting:function(){bDisableLoading=true;}};})();
NewMind.registerNameSpace("NewMind.ETWP").LazyLoadImagesExtensions=(function(){"use strict";var arrImageResizerActionReplacements=[];function rewriteImageRequestIfRequired($img,strImageUrl){var intBreakQueryString=strImageUrl.indexOf("?");if(intBreakQueryString===-1){return;}var objQueryStringContent=NewMind.GetQuerystringData(strImageUrl,true);strImageUrl=strImageUrl.substring(0,intBreakQueryString);var strImageUrlShouldEndWith="/imageresizer/";if((strImageUrl.length<strImageUrlShouldEndWith.length)||(strImageUrl.substr(-strImageUrlShouldEndWith.length)!==strImageUrlShouldEndWith)){return;}var strAction=objQueryStringContent.get("action");if(!strAction){return;}var strNewAction=null;for(var intIndex=0;intIndex<arrImageResizerActionReplacements.length;intIndex++){if(arrImageResizerActionReplacements[intIndex].From===strAction){strNewAction=arrImageResizerActionReplacements[intIndex].To;break;}}if(!strNewAction){return;}objQueryStringContent.set("action",strNewAction);return strImageUrl+objQueryStringContent.toString();}function logWarning(strContent){if(!console||!console.warn){console.warn(strContent);}}return{RewriteImageResizerAction:function(strFrom,strTo){strFrom=""+strFrom;if(!strFrom){logWarning("RewriteImageResizerAction: No \"from\" value specified");return;}strTo=""+strTo;if(!strTo){logWarning("RewriteImageResizerAction: No \"to\" value specified");return;}if(!NewMind.ETWP.LazyLoadImages){logWarning("RewriteImageResizerAction: NewMind.ETWP.LazyLoadImages not initialised");return;}if(arrImageResizerActionReplacements.length===0){NewMind.ETWP.LazyLoadImages.AddPreLoadCallback(rewriteImageRequestIfRequired);}arrImageResizerActionReplacements.push({From:strFrom,To:strTo});}};})();
NewMind.ETWP.Navigation=function(){return{InitialiseQuickFind:function(){var sels=document.getElementsByTagName('SELECT');if(sels!=null){for(var i=0;i<sels.length;i++){if(sels[i].className=='quickfindDrop'){NewMind.dom.addEventListener(sels[i],'change',NewMind.ETWP.Navigation.QuickFind_OnChange);}}}},QuickFind_OnChange:function(){var sel=GetEventSource(this);var elmForm=sel;do{elmForm=elmForm.parentNode;}while(elmForm.nodeName!='FORM'&&elmForm.nodeName!='BODY');if(elmForm.nodeName=='FORM'){elmForm.action=sel.value;elmForm.submit();}}};}();NewMind.dom.addEventListener(window,'load',NewMind.ETWP.Navigation.InitialiseQuickFind);
NewMind.registerNameSpace("NewMind.ETWP.SiteSearch");NewMind.ETWP.SiteSearch=function(){function LegacyInitDefaultText(){$(".ctl_SiteSearchForm .field input").focus(function(){var $this=$(this);var strDefaultText=$this.attr("title");if(strDefaultText!==""){if($this.val()===strDefaultText){$this.val("").parent().removeClass("defaultText");}}}).blur(function(){var $this=$(this);var strDefaultText=$this.attr("title");if(strDefaultText!==""){if($this.val()===""){$this.val(strDefaultText);}if($this.val()===strDefaultText){$this.parent().addClass("defaultText");}}}).blur();}function InitRequestValidation(){$(".ctl_SiteSearchForm form.SearchSite").submit(function(e){var $form=$(this);var controlKey=NewMind.ETWP.GetControlKey($form.closest(".sys_control"));var $objFormInput=$form.find("input#search_"+controlKey);if($objFormInput.length===0){return true;}var bUsingLegacyDefaultText=NewMind.env.platform.disableWCAGCompliance&&$objFormInput.parent().hasClass("defaultText");var strUserInput=($objFormInput.val()+"").trim();if(!bUsingLegacyDefaultText&&strUserInput!==""){var strAbsoluteUrl=this.action+"?"+encodeURIComponent($objFormInput[0].name)+"="+encodeURIComponent(strUserInput);var strSiteSearchEventID=NewMind.DataCapture.Core.generateNewEventId();var objSiteSearchEvent={type:"siteSearch",id:strSiteSearchEventID,textSearch:strUserInput,url:strAbsoluteUrl,controlKey:NewMind.ETWP.GetControlKey($form,true),pageViewId:NewMind.DataCapture.PageView?NewMind.DataCapture.PageView.PageViewEventId:null};NewMind.DataCapture.Core.record(objSiteSearchEvent,true);NewMind.DataCapture.Core.registerImminentNavigation(strAbsoluteUrl,strSiteSearchEventID);window.location=strAbsoluteUrl;e.preventDefault();return;}var strMessage=NewMind.ETWP.GetResource("NewMind.env.lang.resources.sitesearch[\"error\"][\"emptysearch\"]","Your search was empty, please try again.");if(strUserInput!==""){strMessage=NewMind.ETWP.GetResource("NewMind.env.lang.resources.sitesearch[\"error\"][\"jsnotspecific\"]","Your search was not specific enough, please try again.").replace("#searchterm#",strUserInput);}alert(strMessage);e.preventDefault();});}return{Init:function(){if(NewMind.env.platform.disableWCAGCompliance){LegacyInitDefaultText();}InitRequestValidation();}};}();NewMind.dom.addEventListener(window,'load',NewMind.ETWP.SiteSearch.Init);
NewMind.ETWP.FeaturedGallery=function(){var objImageResizerActionOverrides={};var GalleryRendered=false;var GalleryRendering=false;var eventGalleryRendered=new NewMind.CustomEvent();var eventGalleryRendering=new NewMind.CustomEvent();var eventSelectionChanged=new NewMind.CustomEvent();var setupGallery=function(objGallery,objGalleryFullData){var bSlideShow=objGalleryFullData.SlideShow;var iSlideShowInterval=objGalleryFullData.SlideShowInterval;if(iSlideShowInterval<2500){iSlideShowInterval=2500;}var bEnableSwipe=objGalleryFullData.EnableSwipe;var bShowNPNav=objGalleryFullData.ShowNPNav;var bShowTickerCtrls=objGalleryFullData.ShowTickerCtrls;var bShowTBNav=objGalleryFullData.ShowTBNav;var iTBNavItmGrp=parseInt(objGalleryFullData.TBNavItmGrp,10);var iNumberOfItemsToDisplayInGallery=parseInt(objGalleryFullData.NumberOfItemsToDisplayInGallery,10);if(isNaN(iNumberOfItemsToDisplayInGallery)||(iNumberOfItemsToDisplayInGallery<1)){iNumberOfItemsToDisplayInGallery=1;}else if((iNumberOfItemsToDisplayInGallery>1)&&!bEnableSwipe){try{console.log("FeaturedGallery.js: Ignoring NumberOfItemsToDisplayInGallery greater than one when Swipe gesture supported is not enabled since multiple gallery items are not currently supported in this legacy rendering configuration");}catch(e){}iNumberOfItemsToDisplayInGallery=1;}var objGalleryData=objGalleryFullData.FeatData;var iTotalCount=objGalleryData.length;var objGalItem=objGallery.find('.galItem');var $items=$([]);for(var i=0;i<objGalleryFullData.FeatData.length;i++){var $item=$(objGalleryFullData.FeatData[i].Content);$items=$items.add($item);}if($items.length<=iNumberOfItemsToDisplayInGallery){if((iNumberOfItemsToDisplayInGallery>1)&&($items.length>1)){objGalItem.empty().append($items);}return;}var objSwipeGalleryHandler,currentSlideShowGalleryIndex=0,transitionInProgress=false;function UpdateThumbnailsHighlights(){var strCurrent='current';var $thumbnailWrappers=objGallery.find('ul.galTBnav > li > div');$thumbnailWrappers.each(function(i){var $this=$(this);if((i>=currentSlideShowGalleryIndex)&&(i<(currentSlideShowGalleryIndex+iNumberOfItemsToDisplayInGallery))){$this.addClass(strCurrent);}else{$this.removeClass(strCurrent);}});eventSelectionChanged.fire();}function SetCurrentGalleryItem(iIndex){if(iIndex<0){iIndex=0;}var iMaxIndex=iTotalCount-iNumberOfItemsToDisplayInGallery;if(iIndex>iMaxIndex){iIndex=iMaxIndex;}if(objSwipeGalleryHandler){objSwipeGalleryHandler.goTo(iIndex);}else{if(bSlideShow){transitionInProgress=true;objGalItem.fadeOut("slow",function(){$(this).empty().append($items[iIndex]).fadeIn("slow",function(){transitionInProgress=false;});});}else{objGalItem.empty().append($items[iIndex]);}}currentSlideShowGalleryIndex=iIndex;UpdateThumbnailsHighlights();}function MoveToPrevious(){if(transitionInProgress){return;}var iNewIndex=currentSlideShowGalleryIndex-1;if(iNewIndex<0){iNewIndex=iTotalCount-iNumberOfItemsToDisplayInGallery;}SetCurrentGalleryItem(iNewIndex);}function MoveToNext(){if(transitionInProgress){return;}var iNewIndex=currentSlideShowGalleryIndex+1;if(iNewIndex>(iTotalCount-iNumberOfItemsToDisplayInGallery)){iNewIndex=0;}SetCurrentGalleryItem(iNewIndex);}var slideShowRotateToken=null;function GalleryItemRotate(){if(transitionInProgress){return;}MoveToNext();};function ResetSlideShow(){StopSlideShow();StartSlideShow();}function StopSlideShow(){if(slideShowRotateToken!==null){clearTimeout(slideShowRotateToken);slideShowRotateToken=null;}}function StartSlideShow(){if(slideShowRotateToken===null){slideShowRotateToken=setInterval(GalleryItemRotate,iSlideShowInterval);}}function StopTicker($tickerActionLinkWrapper){if($tickerActionLinkWrapper.hasClass('started')){StopSlideShow();var sText=NewMind.ETWP.GetResource('NewMind.env.lang.resources.featuredgallery["play"]','Play');$tickerActionLinkWrapper.toggleClass('started').toggleClass('stopped').find('span').text(sText);}}function StartTicker($tickerActionLinkWrapper){if($tickerActionLinkWrapper.hasClass('stopped')){StartSlideShow();var sText=NewMind.ETWP.GetResource('NewMind.env.lang.resources.featuredgallery["pause"]','Pause');$tickerActionLinkWrapper.toggleClass('started').toggleClass('stopped').find('span').text(sText);}}if(bEnableSwipe){objGalItem.empty().append($items);objSwipeGalleryHandler=NewMind.ETWP.SwipeGallery.Init({$masterContainer:$("<div class='swipeGalleryOuter' />").appendTo(objGalItem),$elements:$items,NumberOfItemsToShow:iNumberOfItemsToDisplayInGallery,OptionalSelectionChangedCallback:function(iNewIndex,iPrevIndex){currentSlideShowGalleryIndex=iNewIndex;UpdateThumbnailsHighlights();}});}if(bSlideShow){StartSlideShow();objGalItem.hover(function(){StopSlideShow();},function(){if(bShowTickerCtrls&&objGallery.find('ul.galNPnav li.start_stop').hasClass('stopped')){return;}StartSlideShow();});}if(bShowTBNav){var iGalItmCount=0,iListItmCount=0,iListCount=0,iScrollListCount=0,iScrollListItmCount=0;var galTBnav;if(iTBNavItmGrp===0){iTBNavItmGrp=iTotalCount;}for(iGalItmCount=0;iGalItmCount<iTotalCount;iGalItmCount++){if(iListItmCount===0){iListCount++;galTBnav=$("<ul/>").attr('class','galTBnav '+'gr_'+iListCount);objGallery.append(galTBnav);}$('<li>'+objGalleryData[iGalItmCount].Thumbnail+'</li>').attr('class','itm_'+iGalItmCount).appendTo(galTBnav);iListItmCount++;if(iListItmCount===iTBNavItmGrp){iListItmCount=0;}}UpdateThumbnailsHighlights();objGallery.find('.galTBnav > li').click(function(){var iCurrentItm=parseInt($(this).attr('class').replace('itm_',''));if(isNaN(iCurrentItm)){iCurrentItm=0;}else{iCurrentItm=iCurrentItm-parseInt(iNumberOfItemsToDisplayInGallery/2);if(iCurrentItm<0){iCurrentItm=0;}else if(iCurrentItm+iNumberOfItemsToDisplayInGallery>=iTotalCount){intViewOffset=iTotalCount-iNumberOfItemsToDisplayInGallery;}}SetCurrentGalleryItem(iCurrentItm);if(bSlideShow){ResetSlideShow();}}).dblclick(function(){var iCurrentItm=$(this).attr('class').replace('itm_','');window.location=$items.eq(iCurrentItm).find('a').attr('href');});}if((bShowNPNav||bShowTickerCtrls)&&iTotalCount>1){var galNPnav=$('<ul class="galNPnav">');if(bShowTickerCtrls){var sPause=NewMind.ETWP.GetResource('NewMind.env.lang.resources.featuredgallery["pause"]','Pause');galNPnav.append($('<li class="start_stop started"><span>'+sPause+'</span></li>'));}var sPrev=NewMind.ETWP.GetResource('NewMind.env.lang.resources.featuredgallery["prev"]','Prev');var sNext=NewMind.ETWP.GetResource('NewMind.env.lang.resources.featuredgallery["next"]','Next');galNPnav.append($('<li class="prev"><span>'+sPrev+'</span></li>'));galNPnav.append($('<li class="next"><span>'+sNext+'</span></li>'));objGallery.append(galNPnav);galNPnav.children().click(function(){var $this=$(this);if($this.hasClass('start_stop')){if($this.hasClass('started')){StopTicker($this);}else if($this.hasClass('stopped')){StartTicker($this);}}else{var sCurrentClass=$this.attr('class');if(sCurrentClass==='prev'){MoveToPrevious();}else if(sCurrentClass==='next'){MoveToNext();}if(bShowTickerCtrls){StopTicker($this.siblings('.start_stop'));}else if(bSlideShow){ResetSlideShow();}}});}GalleryRendered=true;eventGalleryRendered.fire();};var replaceImageResizerActionsInContent=function(objFeaturedData,strImageResizerActionOverride,strThumbnailImageResizerActionOverride){if(!objFeaturedData||!objFeaturedData.FeatData||(objFeaturedData.FeatData.length===0)){return;}for(var intIndex=0;intIndex<objFeaturedData.FeatData.length;intIndex++){if(strImageResizerActionOverride){objFeaturedData.FeatData[intIndex].Content=getContentWithAlteredImageResizerAction(objFeaturedData.FeatData[intIndex].Content,strImageResizerActionOverride);}if(strThumbnailImageResizerActionOverride){objFeaturedData.FeatData[intIndex].Thumbnail=getContentWithAlteredImageResizerAction(objFeaturedData.FeatData[intIndex].Thumbnail,strThumbnailImageResizerActionOverride);}}function getContentWithAlteredImageResizerAction(strContent,strImageResizerActionOverride){var arrImageResizerQueryStrings=getImageResizerQueryStrings(strContent);for(var intIndexImageResizerUrl=0;intIndexImageResizerUrl<arrImageResizerQueryStrings.length;intIndexImageResizerUrl++){var strImageResizerQueryString=arrImageResizerQueryStrings[intIndexImageResizerUrl];var objQueryStringData=NewMind.GetQuerystringData(htmlDecode(strImageResizerQueryString));objQueryStringData.set("action",strImageResizerActionOverride);strContent=strContent.replace(strImageResizerQueryString,htmlEncode(objQueryStringData.toString()));}return strContent;}function htmlEncode(value){return $("<div/>").text(value).html();}function htmlDecode(value){return $("<div/>").html(value).text();}};var reImageResizerUrl=/("\/imageresizer\/(.*?)")/g;var getImageResizerQueryStrings=function(strContent){var arrImageResizerQueryStrings=[];var objMatch;while(objMatch=reImageResizerUrl.exec(strContent)){arrImageResizerQueryStrings.push(objMatch[2]);}return arrImageResizerQueryStrings;};return{Init:function(){if(GalleryRendered===true||GalleryRendering===true){return false;}GalleryRendering=true;eventGalleryRendering.fire();var arrFeaturedCtrlIds=[];$('.gallery').each(function(){var strId=this.id;if(!strId||(strId.substring(0,8)!=="gallery_")){return;}var intControlKey=parseInt(strId.substring(8));if(isNaN(intControlKey)||(intControlKey!==NewMind.ETWP.GetControlKey(this,true))){return;}arrFeaturedCtrlIds[arrFeaturedCtrlIds.length]=$(this).attr('id').replace('gallery_','');});if(arrFeaturedCtrlIds.length!==0){$.getScript("?PartialRenderControlList="+arrFeaturedCtrlIds.join(","),function(obj){$('.gallery').each(function(){var intCtrlKey=$(this).attr('id').replace('gallery_','');var objFeaturedData=NewMind.ETWP.ControlData[intCtrlKey];if(!objFeaturedData){try{console.log("FeaturedGallery.Init: $.script callback failed to initialise data, attempting additional eval");}catch(e){}eval(obj);objFeaturedData=NewMind.ETWP.ControlData[intCtrlKey];}var objImageResizerActionOverride=objImageResizerActionOverrides[""+intCtrlKey];if(objImageResizerActionOverride){replaceImageResizerActionsInContent(objFeaturedData,objImageResizerActionOverride.ImageResizerAction,objImageResizerActionOverride.ThumbnailImageResizerAction);}setupGallery($(this),objFeaturedData);var title=$(this).find("div.galItem h3").text();$(this).find("ul span.title:contains('"+title+"')").parents('li').click();if(NewMind.env.install.IPTV){$("div.itm_0").find('a').focus();}});});}return false;},GalleryRendered:eventGalleryRendered,GalleryRendering:eventGalleryRendering,SelectionChanged:eventSelectionChanged,OverrideGalleryImageResizerAction:function(intControlKey,strImageResizerAction,strThumbnailImageResizerAction){if(!intControlKey){log("NewMind.ETWP.FeaturedGallery.OverrideGalleryImageResizerAction: No Control Key specified");return;}intControlKey=parseInt(""+intControlKey,10);if(isNaN(intControlKey)){log("NewMind.ETWP.FeaturedGallery.OverrideGalleryImageResizerAction: Invalid Control Key specified (not a number)");return;}objImageResizerActionOverrides[""+intControlKey]={ImageResizerAction:strImageResizerAction,ThumbnailImageResizerAction:strThumbnailImageResizerAction};function log(strMessage){try{console.log(strMessage);}catch(e){}}}};}();
var arrRearrangeCallbacks=[];NewMind.registerNameSpace("NewMind.ETWP.FeaturedItems").subscribeToRearrange=function(fncCallback){arrRearrangeCallbacks.push(fncCallback);};var arrCallbacks=[];NewMind.registerNameSpace("NewMind.ETWP.FeaturedItems").subscribe=function(fncCallback){arrCallbacks.push(fncCallback);};$(function(){function reset(wall){wall.reset({fixSize:false,gutterX:0,gutterY:0,selector:'>div>ol>li'});}var walls=$(".ctl_FeaturedItems").map(function(){var wall=new Freewall(this);reset(wall);return wall;});function debounce(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args);};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)func.apply(context,args);};};function fitAllWallsToCurrentWidth(){for(var i=0;i<walls.length;i++){var wall=walls[i];var $wall=$(wall.container[0]);reset(wall);for(var iCallback=0;iCallback<arrRearrangeCallbacks.length;iCallback++){try{arrRearrangeCallbacks[iCallback](NewMind.ETWP.GetControlKey($wall),$wall);}catch(e){}}}}fitAllWallsToCurrentWidth();window.addEventListener('resize',debounce(fitAllWallsToCurrentWidth));var arrControlNumbers=[];$(".ctl_FeaturedItems").find(".loading").each(function(){var iControlNumber=NewMind.ETWP.GetControlKey(this,true);if(arrControlNumbers.indexOf(iControlNumber)===-1)arrControlNumbers.push(iControlNumber);});if(arrControlNumbers.length>0){$.ajax({type:'GET',url:'',data:{partialrendercontrollist:arrControlNumbers.join(","),partialrendertype:'html'},success:function(data){$(data).find(">div.wrapper>ol>li").each(function(){var $li=$(this),iControlNumber=NewMind.ETWP.GetControlKey(this,true),arrLiClasses=$li.attr("class").split(' '),strLiUniqueCellClass="";for(var i=0;i<arrLiClasses.length;i++){var strLiClass=arrLiClasses[i];if(strLiClass.substring(0,4)!=="cell"){continue;}if(isNaN(parseInt(strLiClass.substring(4)))){continue;}strLiUniqueCellClass=strLiClass;break;}$(".c"+iControlNumber).find(">div.wrapper>ol>li").filter(function(){return $(this).hasClass(strLiUniqueCellClass);}).html($li.html()).attr("class",$li.attr("class"));});},complete:function(){for(var i=0;i<arrCallbacks.length;i++){arrCallbacks[i]();}},error:function(){var strMessage="Featured Items partial rendering failed for ["+arrControlNumbers.join(",")+"]";NewMind.ETWP.Trace.PrintTraceWarning(strMessage);try{console.warn(strMessage);}catch(e){}}});}});
NewMind.registerNameSpace("NewMind.ETWP");NewMind.ETWP.ProductSearch=function(){var $=jQuery;var loadingAnimation="/engine/shared_gfx/ajax-loader-arrows-white.gif";var loadingText="updating...";var loadingHTML="";var resultsAjaxError="Sorry an Error Has Occurred, Please Try Again";var numBlockUIFadeOut=0;var numBlockUIFadeIn=0;var blockUISettings={message:loadingText+' <img src="'+loadingAnimation+'" alt="" />',centerX:true,centerY:true,showOverlay:true,fadeIn:numBlockUIFadeIn,fadeOut:numBlockUIFadeOut,css:{backgroundColor:'#fff',cursor:'wait',textAlign:'center'},overlayCSS:{backgroundColor:'#fff',opacity:'0.6'}};var loadMessageBoxes=function(){if($('div.productSearchMessage').length>0){return;}loadingAnimation=NewMind.ETWP.GetResource('NewMind.env.imgs.resources.searchresults["loadingAnimation"]',loadingAnimation);var availLoadingText=NewMind.ETWP.GetResource('NewMind.env.lang.resources.blockui["productsearch"]["availability"]["loadingtext"]',loadingText);var availLoadingHTML=NewMind.ETWP.GetResource('NewMind.env.lang.resources.blockui["productsearch"]["availability"]["loadingHTML"]',loadingHTML);loadingText=NewMind.ETWP.GetResource('NewMind.env.lang.resources.blockui["productsearch"]["default"]["loadingtext"]',loadingText);loadingHTML=NewMind.ETWP.GetResource('NewMind.env.lang.resources.blockui["productsearch"]["default"]["loadingHTML"]',loadingHTML);resultsAjaxError=NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["ajaxError"]',resultsAjaxError);var loadingMessage=loadingHTML.toString().length>0?loadingHTML:(loadingText+' <img src="'+loadingAnimation+'" alt="" />');var loadingAvailMessage=availLoadingHTML.toString().length>0?availLoadingHTML:(availLoadingText+' <img src="'+loadingAnimation+'" alt="" />');$('<div></div>').addClass("productSearchMessage").hide().appendTo('body').append(loadingMessage).hide();$('<div></div>').addClass("productAvailabilitySearchMessage").hide().appendTo('body').append(loadingAvailMessage).hide();};var setupChildAges=function($containerSelector){var $childrenField=$containerSelector.find(".childrenfield select");$childrenField.change(function(e){var $this=$(this);showhideAgeFields($this,$this.val());});$containerSelector.find(".childrenageslabel, .childageWrapper").hide();$childrenField.each(function(){var $this=$(this);showhideAgeFields($this,$this.val());});};var showhideAgeFields=function($this,value){$this.parent().siblings(".childrenageslabel").hide();$this.parent().siblings(".childrenagesfield").find(".childageWrapper").hide().each(function(i){if(!isNaN(value)&&i<Number(value)){$(this).show().parent().siblings(".childrenageslabel").show();}});};function initUrlRewritingAndDataCapture(){$(".ctl_ProductSearch").find("form").submit(function(){var $form=$(this);if($form.valid()){var strFormData=$form.serialize();var arrUncheckedBoxNames=[];$form.find(":checkbox:not(:checked)").each(function(){arrUncheckedBoxNames.push(this.name);});if(arrUncheckedBoxNames.length>0){if(strFormData!==""){strFormData+="&";}strFormData+=arrUncheckedBoxNames.join("=&")+"=";}strFormData=combineSerialisedFormData(strFormData);if(NewMind.ETWP.ProductSearch.UrlRewriter){strFormData=NewMind.ETWP.ProductSearch.UrlRewriter.ReduceQuery(strFormData);}var strAbsoluteUrl=$form[0].action+"?"+strFormData;if(NewMind.DataCapture&&NewMind.DataCapture.Core){var strProductSearchEventID=NewMind.DataCapture.Core.generateNewEventId();var objProductSearchEvent={type:"productSearch",id:strProductSearchEventID,searchType:$form.closest(".ctl_ProductSearch").find(".accommodationSearchImg h2:first").text(),url:strAbsoluteUrl,controlKey:NewMind.ETWP.GetControlKey($form,true),pageViewId:NewMind.DataCapture.PageView?NewMind.DataCapture.PageView.PageViewEventId:null};var objQueryString=NewMind.ETWP.GetQuerystringData(strAbsoluteUrl,true);var strCategoryKeys="categoryKeys";var arrPossibleValueMappings=[{name:"producttype",eventProperty:"productTypeIDs"},{name:"cat",eventProperty:strCategoryKeys},{name:"fac",eventProperty:"facilityKeys"},{name:"grade",eventProperty:"gradings"},{name:"poly",eventProperty:"polygonKeys"},{name:"unittype",eventProperty:"unitTypeIDs"}];for(var i=0;i<arrPossibleValueMappings.length;i++){var strQueryStringName=arrPossibleValueMappings[i].name;var strValue=objQueryString.get(strQueryStringName);if(!strValue){continue;}var arrValues=strValue.split(",");for(var j=0;j<arrValues.length;j++){arrValues[j]=$.trim(arrValues[j]);}var strEventPropertyName=arrPossibleValueMappings[i].eventProperty;if((strEventPropertyName===strCategoryKeys)&&/\D/.test(arrValues[0])){strEventPropertyName="categoryIDs";}objProductSearchEvent[strEventPropertyName]=arrValues;}var strTextSearch=objQueryString.get("name");if(strTextSearch){objProductSearchEvent.textSearch=strTextSearch;}var dStart=new Date(objQueryString.get("stay"));if(!isNaN(dStart)){var dEnd;var iNights=parseInt(objQueryString.get("dur"),10);if(!isNaN(iNights)&&(iNights>0)){dEnd=new Date(dStart.getTime()+(iNights*24*60*60*1000));}else{dEnd=new Date(objQueryString.get("end"));if(isNaN(dEnd)){dEnd=dStart;}}var iFuzzyFactor=parseInt(objQueryString.get("fuzzy"),10);var iRooms=parseInt(objQueryString.get("rooms"),10);var arrRoomCapacities=[];if(!isNaN(iRooms)&&(iRooms>0)){for(var i=0;i<iRooms;i++){var iCapacity=parseInt(objQueryString.get("r"+(i+1)),10);if(!isNaN(iCapacity)&&(iCapacity>0)){arrRoomCapacities.push({capacity:iCapacity});}}}var objAvailCriteria={startDate:NewMind.DataCapture.Core.formatDate(dStart),endDate:NewMind.DataCapture.Core.formatDate(dEnd)};if(!isNaN(iFuzzyFactor)&&(iFuzzyFactor>0)){objAvailCriteria.fuzzyAvailabilityFactor=iFuzzyFactor;}if(arrRoomCapacities.length>0){objAvailCriteria.roomRequirements=arrRoomCapacities;}objProductSearchEvent.availabilityCriteria=objAvailCriteria;}var strConferenceCapacityRange=objQueryString.get("cap");if(strConferenceCapacityRange){var arrConferenceCapacityRange=strConferenceCapacityRange.split("-");if(arrConferenceCapacityRange.length===2){var iMinCapacity=parseInt(arrConferenceCapacityRange[0],10);var iMaxCapacity=parseInt(arrConferenceCapacityRange[1],10);if(!isNaN(iMinCapacity)&&!isNaN(iMaxCapacity)&&(iMinCapacity>=0)&&(iMaxCapacity>0)){objProductSearchEvent.conferenceCapacity={minimum:iMinCapacity,maximum:iMaxCapacity};}}}var iMinPrice=parseInt(objQueryString.get("minprice"),10);if(iMinPrice){objProductSearchEvent.minimumPrice=iMinPrice;}var iMaxPrice=parseInt(objQueryString.get("maxprice"),10);if(iMaxPrice){objProductSearchEvent.maximumPrice=iMaxPrice;}NewMind.DataCapture.Core.record(objProductSearchEvent,true);NewMind.DataCapture.Core.registerImminentNavigation(strAbsoluteUrl,strProductSearchEventID);}window.location=strAbsoluteUrl;}return false;});function combineSerialisedFormData(strEscapedSerialisedFormData){var arrFormData=strEscapedSerialisedFormData.split("&");var dictCombinedKeys={};for(var i=0;i<arrFormData.length;i++){var arrParam=arrFormData[i].split("=");var strKey=arrParam[0];var strValue=arrParam[1];if(strKey!==""){if(typeof(dictCombinedKeys[strKey])==="undefined"){dictCombinedKeys[strKey]=strValue;}else if(strValue!==""){if(dictCombinedKeys[strKey]!==""){dictCombinedKeys[strKey]+=",";}dictCombinedKeys[strKey]+=strValue;}}}var arrKeyValuePairs=[];for(var key in dictCombinedKeys){if(dictCombinedKeys.hasOwnProperty(key)){arrKeyValuePairs.push(key+"="+dictCombinedKeys[key]);}}return arrKeyValuePairs.join("&");}}function blockOutInterface(bShowAvailabilitySearchMessage){if(bShowAvailabilitySearchMessage){blockUISettings.message=$("div.productAvailabilitySearchMessage");}else{blockUISettings.message=$("div.productSearchMessage");}$.blockUI(blockUISettings);$("div.blockUI.blockMsg").addClass("ProductSearchBlockElement");window.addEventListener('pageshow',function(ev){if(ev.persisted){window.location.reload();}});}return{InitUrlRewritingAndDataCapture:initUrlRewritingAndDataCapture,initBlockUI:function(){loadMessageBoxes();$('.ctl_ProductSearch').find('form').bind("submit.productSearchBlockUI",function(e){var $availability=$(this).find(':input[name="refine-availability"]');var bShowAvailabilitySearchMessage=($availability.is(':checked')&&$availability.attr('checked'))||(!$availability.is(':checkbox')&&$availability.val()==="on");blockOutInterface(bShowAvailabilitySearchMessage);});},PreviewBlockingOverlay:function(bShowAvailabilitySearchMessage){blockOutInterface(bShowAvailabilitySearchMessage);},InitCollapsibleSearch:function(iControlKey){$('div.c'+iControlKey+' div.accommodationSearchImg').click(function(){$(this).siblings("form").slideToggle('fast',function(){$(this).parent('div').toggleClass("open");});});},AddNewUnit:function(){function hpaccosearchAddUnit(e){var $this=$(this);var $parentRefineAvailability=$this.parents('form');if($parentRefineAvailability.length===0){$parentRefineAvailability=$this.parents('.refine-availability');}var iRoomCount=$parentRefineAvailability.find('#roomReqs div').length;iRoomCount++;e.preventDefault();if($parentRefineAvailability.length===0){return;}var objRoomSpan=$parentRefineAvailability.find('#roomsReqRow1').clone().html().replace(/roomReq_1/g,'roomReq_'+iRoomCount);var objRoomSpanAdditional=$('<div id="roomsReqRow'+iRoomCount+'" class="row roomsReqRow'+iRoomCount+'">'+objRoomSpan+'</div>');var bIsChildPricingEnabled=(typeof(NewMind.ETWP.ProductSearch.ChildPricingEnabled)!=="undefined")&&NewMind.ETWP.ProductSearch.ChildPricingEnabled;var strLastRowAdultDropdownFindSelector=bIsChildPricingEnabled?".row:last .adultsfield select:visible":".row:last select:visible";$parentRefineAvailability.find('#roomReqs').append(objRoomSpanAdditional).find(strLastRowAdultDropdownFindSelector).prepend('<option value="0">0</option>').end().find('.row:last .unitlabel').find('span').text(iRoomCount);var $AddAnotherUnit=$this.parents('.AddAnotherUnit');var iMaxRoomCount=$AddAnotherUnit.data("MaxRoomCount");if(iMaxRoomCount>0&&iRoomCount>=iMaxRoomCount){$AddAnotherUnit.hide();}$parentRefineAvailability.find('#NumRoomReqs').attr('value',iRoomCount);if(bIsChildPricingEnabled){setupChildAges($(".ctl_ProductSearch .roomsReqRow"+iRoomCount+", .ctl_Booking_AvailSearch .roomsReqRow"+iRoomCount));}if($this.parents('#refinePopup').length>0){objRoomSpanAdditional.find('ul.selectlist').remove();NewMind.ETWP.ProductSearch.InitialiseFancySelectDropdowns(objRoomSpanAdditional,10);}return false;}$('.addAnotherRoom').each(function(){var $addAnotherRoom=$(this);if(!$addAnotherRoom.data("eventBound")){$addAnotherRoom.bind("click keypress",hpaccosearchAddUnit);if(typeof(NewMind.ETWP.TabSwitcher)!=="undefined"){var $tabContainer=$addAnotherRoom.parents("div.ctl_Tabs");if($tabContainer.length>0){var tabVariableName='tabs'+NewMind.ETWP.GetControlKey($tabContainer[0]);if(typeof(NewMind.ETWP.ActiveTabSwitchers[tabVariableName])!=='undefined'){$addAnotherRoom.bind("click keypress",NewMind.ETWP.ActiveTabSwitchers[tabVariableName].ResizeContainer);}}}$addAnotherRoom.data("eventBound",true);}});},AddNewUnitCapacity:function(){function hpaccosearchAddUnitCapacity(e){var $this=$(this);var $thisParentForm=$this.parents("form");var iCapCount=$thisParentForm.find('#numUnitCapacity').val();iCapCount++;e.preventDefault();var objCapSpan=$thisParentForm.find('#capacityReqRow1').clone().html();objCapSpan=objCapSpan.replace(/Unit 1/g,'Unit '+iCapCount);var objCapSpanAdditional='<div id="capacityReqRow'+iCapCount+'" class="row">'+objCapSpan+'</div>';$thisParentForm.find('#unitcapacity').append(objCapSpanAdditional).end().find('label:last').find('span').text(iCapCount);var $AddAnotherUnit=$thisParentForm.find(".AddAnotherCapacityUnit");var iMaxRoomCount=$AddAnotherUnit.data("MaxRoomCount");if(iMaxRoomCount>0&&iCapCount>=iMaxRoomCount){$AddAnotherUnit.hide();}$thisParentForm.find('#numUnitCapacity').val(iCapCount);}$('.AddAnotherCapacityUnit').bind("click keypress",hpaccosearchAddUnitCapacity);NewMind.ETWP.ProductSearch.AddNewUnitCapacity=function(){};},InitialiseRefineBy:function(){var $refineByForm=$('form.searchform');if($refineByForm.hasClass('horizontal')){NewMind.ETWP.ProductSearch.InitialiseRefineByHorizontal($refineByForm);}else{NewMind.ETWP.ProductSearch.InitialiseRefineByStandard($refineByForm);}},InitialiseRefineByStandard:function($refineByForm){$refineByForm.find('dl.refineByDefList').each(function(){var $this=$(this);var definitionListItems=$this.find("dt[class^=\"refine-\"], dd[class^=\"refine-\"]");var bHideNextDD=false;definitionListItems.each(function(){var nodeName=this.nodeName.toLowerCase();if(nodeName==="dt"){NewMind.dom.addEventListener(this.firstChild,'click',NewMind.ETWP.ProductSearch.ShowHideRefine);if(this.firstChild.checked!==true){bHideNextDD=true;}}else if(nodeName==="dd"&&bHideNextDD===true){bHideNextDD=false;this.style.display="none";}});});},InitialiseRefineByHorizontal:function($refineByForm){var $refineDL=$refineByForm.find('dl.refineByDefList');var $refineDDs=$refineDL.find('dd');NewMind.ETWP.ProductSearch.InitialiseFancySelectDropdowns($refineDDs,10);NewMind.ETWP.ProductSearch.InitialiseFancyCheckBoxes($refineDDs);var $refineAdvancedOptions=$refineDL.find('.advanced');if($refineAdvancedOptions.length>0){var $refineAdvancedDD=$('<dd class="refine-advancedoptions"></dd>');$('<dl class="refineByDefListAdvanced"></dl>').append($refineDL.find('.advanced').removeClass('advanced')).appendTo($refineAdvancedDD);$('<dt class="refine-advancedoptions">'+NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["advancedoptions"]','Advanced Options')+'</dt>').appendTo($refineDL).after($refineAdvancedDD);}$refineDL.find('dt').each(function(i){var $this=$(this);$this.find('input[type="checkbox"]').removeAttr('checked').toggle();var $relevantDD=$this.parent().find("dd[class='"+$this.attr('class')+"']").toggle();if($relevantDD.length>0){if($this.attr('class')!=='refine-awards'){$this.bind('click',$relevantDD,function(e){NewMind.ETWP.ProductSearch.ShowHideRefinePopup($refineByForm,$this,$relevantDD,e);});}else{NewMind.ETWP.ProductSearch.InitialiseFancyCheckBoxes($this);}}});},InitialiseFancyCheckBoxes:function($container){var addremoveItem=function(e){$(this).toggleClass("addItem").toggleClass("removeItem").find('input').attr("checked",$(this).hasClass("addItem"));};$container.find('input[type="checkbox"]').each(function(){if($(this).attr('checked')){sClass='addItem';}else{sClass='removeItem';}$(this).css('visibility','hidden').wrap('<span class="'+sClass+'"></span>');}).end().find("span.addItem, span.removeItem").click(addremoveItem);},InitialiseFancySelectDropdowns:function($container,iMaxItemsVisible){var ConvertSelectToList=function($select,$placeholder,iMaxItemsVisible){$selectOptions=$select.find('option');if(!($selectOptions.length>1)){return;}iMaxIndexVisible=(iMaxItemsVisible>0&&$selectOptions.length>iMaxItemsVisible)?iMaxItemsVisible-1:0;var $newUL=$select.next('ul.selectlist');if($newUL.length===0){$newUL=$('<ul class="selectlist '+$select.attr('class')+'"></ul>');if($placeholder!==null){$newUL.css('position','absolute').addClass('collapsible');}$selectOptions.each(function(i){$newLI=$('<li>'+$(this).text()+'</li>').appendTo($newUL).mouseover(function(){$(this).addClass('current');}).mouseout(function(){$(this).removeClass('current');}).click(function(e){$select.find('option:eq('+i+')').attr('selected',true);$(this).siblings().removeClass('selected');$(this).addClass('selected');if($placeholder===null){$select.parents('#refinePopup:first').find('#setRefine').trigger('click');}else{$newUL.toggle();$placeholder.text($(this).text());}});if($(this).attr('selected')){$newLI.addClass('selected');}if(iMaxIndexVisible>0&&i>iMaxIndexVisible){$newLI.toggle();}});if(iMaxIndexVisible>0){$newUL.prepend($('<li id="prevOption" class="scroll"><span class="prevTxt">'+NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["previous"]','Previous')+'</span></li>')).append($('<li id="nextOption" class="scroll"><span class="nextTxt">'+NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["next"]','Next')+'</span></li>'));$newUL.children('.scroll').mouseover(function(){$(this).addClass('current');}).mouseout(function(){$(this).removeClass('current');}).click(function(e){var $toHide;var $toShow;var iLastVisible=$newUL.children('li:visible[id!="prevOption"][id!="nextOption"]').length;var sThisId=$(this).attr('id');if(sThisId==='nextOption'){$toHide=$newUL.children('li:visible').eq(1);$toShow=$newUL.children('li:visible').eq(iLastVisible).next('[id!="'+sThisId+'"]');}else if(sThisId==='prevOption'){$toHide=$newUL.children('li:visible').eq(iLastVisible);$toShow=$newUL.children('li:visible').eq(1).prev('[id!="'+sThisId+'"]');}if($toShow.length>0&&$toHide.length>0){$toHide.toggle();$toShow.toggle();}});}$select.after($newUL);}else{$newUL.toggle();}};var hideOnClickOff=function(e){$(window).bind('click',function(e){if(!$(e.target).is('div.selectedplaceholder')&&$(e.target).parents('ul.collapsible').length===0){$('ul.collapsible').hide();}});};$container.find('select').each(function(i){var $select=$(this);if($select.parents('dd').children().length===1){$select.toggle();ConvertSelectToList($select,null,iMaxItemsVisible);}else{var placeholder=$select.siblings('div.selectedplaceholder');if(placeholder.length===0){placeholder=$('<div class="selectedplaceholder">'+$select.find('option:selected').text()+'</div>');$select.toggle().after(placeholder);}placeholder.bind('click',function(e){$('ul.collapsible').hide();ConvertSelectToList($select,$(this),iMaxItemsVisible);$('ul.collapsible').focus(hideOnClickOff(e));});}});},TFAGroupInit:function(){$('.refine-tfa, .refine-tfa-nocollapse').find('legend').css("cursor","pointer").next('ul').hide().end().bind('click',function(){$(this).next('ul').toggle();});},ShowHideCapacityRefine:function(){var $availInput=$('input#refine-availability_'+NewMind.ETWP.ProductSearch.ControlKey);var $capInput=$('input#refine-unitcapacitytype_'+NewMind.ETWP.ProductSearch.ControlKey);var $typeInput=$('input#refine-category_'+NewMind.ETWP.ProductSearch.ControlKey);if($availInput!==null&&$capInput!==null){if($typeInput.attr('checked')===true&&$availInput.attr('checked')===false){showCapacity();}else{hideCapacity();}}else if($typeInput!==null&&$capInput!==null){if($typeInput.attr('checked')===true){showCapacity();}else{hideCapacity();}}function hideCapacity(){$capInput.parent('dt').hide().next('dd').hide();}function showCapacity(){$capInput.parent('dt').show().next('dd').show();}},ChildAges:function(){$(".ctl_ProductSearch .RoomReqs, .ctl_Booking_AvailSearch .RoomReqs").each(function(){if(!$(this).parents('.SlfCatAvailUI').length>0){setupChildAges($(this));}});},ShowHideRefine:function(e){var objInput=NewMind.dom.getEventSource(e);var objEleTarget=objInput.parentNode.nextSibling;if(!objEleTarget.tagName){objEleTarget=objEleTarget.nextSibling;}objEleTarget.style.display=(objInput.checked===true)?"block":"none";},ShowHideRefinePopup:function($refineByForm,$refineDT,$relevantDD,e){var blockUISettings=function(oMessage,iOffSetTop,iOffSetLeft,bCenterX,bCenterY){return{message:oMessage,css:{width:'auto',top:iOffSetTop,left:iOffSetLeft,padding:'0',margin:'0',textAlign:'center',cursor:null,border:'none'},overlayCSS:{backgroundColor:'#88898B',opacity:'0.6',cursor:null},centerX:bCenterX,centerY:bCenterY,fadeOut:0,baseZ:5000};};var UpdateRefineSearchSummary=function($refineByForm,$relevantDD,sRefineDTLabel,sAction){var clearInputItemVal=function(item){var $item=$(item);if(item.type==='text'&&$item.val().length>0){$item.val('');}else if(item.type==='checkbox'&&item.checked){$item.removeAttr('checked').parent('span.addItem').toggleClass("addItem").toggleClass("removeItem");}else if(item.type==='select-one'){}};var getInputItemVal=function(item){var $item=$(item);if(item.type==='text'&&$item.val().length>0){return $item.val();}else if(item.type==='checkbox'&&item.checked){return $item.val();}else if(item.type==='select-one'){return $item.find('option:selected').text();}else if(item.type==='hidden'&&($item.attr('name')==='isostartdate'||$item.attr('name')==='isoenddate')){return $item.val();}else{return '';}};var getInputItemTxt=function(item,bWrap){var sItemTxt='';var sName=$(item).attr('name');var sItemVal=getInputItemVal(item);var sId=item.id;if(sItemVal!==''&&sItemVal!==undefined&&sItemVal!=='None'&&sItemVal!=='-- Any --'){switch(sName){case 'isostartdate':sItemTxt=NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["startdate"]','starts on')+' '+sItemVal;break;case 'isoenddate':sItemTxt=NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["enddate"]','ends on')+' '+sItemVal;break;case 'src_anydate':sItemTxt=(sItemVal==='yes')?NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["anydateinfuture"]','Any date in the future'):'';break;case 'nights':sItemTxt=NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["fornights"]','for #nights# night(s)').replace('#nights#',sItemVal);break;case 'fuzzy':sItemTxt=NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["flexibledates"]','flexible dates')+': '+sItemVal;break;case 'autoshowmap':if(sItemVal==='-1'){sItemTxt=NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["resultsonmap"]','Results on map');}break;case 'tfa':sItemTxt=(sItemVal==='-1')?NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["accessible"]','Accessible'):'';break;case 'src_grading':if(sItemVal==='0'){sItemTxt=NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["awaitinggrading"]','Awaiting Grading')+',';}else{sItemTxt=sItemVal+',';}break;case 'src_minprice':sItemTxt=NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["pricefrom"]','from &#163;')+' '+sItemVal;break;case 'src_maxprice':sItemTxt=NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["priceto"]','to &#163;')+' '+sItemVal;break;case 'src_facility':sItemTxt=$(item).parents('li:first').find('label[for="'+sId+'"]').text()+',';break;case 'src_facilitygroup':sItemTxt=$(item).parents('li:first').find('label[for="'+sId+'"]').text()+',';break;case 'src_mingroup':sItemTxt=NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["groupsize"]','Group size')+' '+sItemVal;break;case 'vaqas':sItemTxt=(sItemVal==='-1')?NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["vaqas"]','VAQAS'):'';break;default:if(sName.indexOf("roomReq_")!=-1){sItemTxt=', '+sItemVal+' quest(s)'+' in ' +NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["room"]','room')+' '+sName.replace("roomReq_","");}else{sItemTxt=sItemVal;}}sItemTxt=(bWrap)?'<span class="'+sName+'">'+sItemTxt+'</span>':sItemTxt;}return sItemTxt;};var UpdateAddToRefineSummary=function(){var sItem='';var sItemTxt;inputItems.each(function(){sItemTxt=getInputItemTxt(this,bWrap);if(sItemTxt!==''){switch($(this).attr('name')){case 'refine-awards':sItem=sItem+' '+$(this).parents('dt').find('label').text();break;case 'src_anydate':sItem=sItemTxt;break;default:sItem=sItem+' '+sItemTxt;}}});if(sItem!==''){switch(sLIClass){case 'refine-availability':sItem=NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["stay"]','stay')+" "+sItem;break;case 'refine-grading':case 'refine-facility':sItem=sItem.slice(0,-1);break;default:}if(sRefineDTLabel!==''){sItem='<span class="summarylabel">'+sRefineDTLabel+':</span>'+sItem;}}summaryLI=refineSearchSummary.find('li.'+sLIClass);if(summaryLI.length===0){if(sItem!==''){refineSearchSummary.append('<li class="'+sLIClass+'">'+sItem+'</li>');}}else{if(sItem!==''){summaryLI.html(sItem);}else{summaryLI.remove();}}};var RemoveFromRefineSummary=function(){if(sLIClass==='refine-advancedoptions'){inputItems.each(function(){clearInputItemVal(this);});}refineSearchSummary.find('li.'+sLIClass).remove();};var UpdateRefineSummaryTitle=function(){var bVisible=refineSearchSummaryTitle.is(':visible');if(refineSearchSummary.children('li').length===0&&bVisible){refineSearchSummaryTitle.hide();}else if(refineSearchSummary.children('li').length>0&&!bVisible){refineSearchSummaryTitle.show();}};var refineSearchSummaryTitle=$refineByForm.find('h2#refineSearchSummaryTitle');if(refineSearchSummaryTitle.length===0){refineSearchSummaryTitle=$('<h2 id="refineSearchSummaryTitle">'+NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["yousearchingfor"]','You are searching for:')+'</h2>');$refineByForm.append(refineSearchSummaryTitle);}var refineSearchSummary=$refineByForm.find('ul#refineSearchSummary');if(refineSearchSummary.length===0){refineSearchSummary=$('<ul id="refineSearchSummary" class="searchsummary"></ul>');$refineByForm.append(refineSearchSummary);}var inputItems;var bWrap;var sLIClass=$relevantDD.attr('class');if(sLIClass==='refine-advancedoptions'){inputItems=$relevantDD.find('dd:visible :input,dt.refine-awards :input');bWrap=true;}else{inputItems=$relevantDD.find(":input");bWrap=false;}if(sAction==='set'){UpdateAddToRefineSummary();}else if(sAction==='remove'){RemoveFromRefineSummary();}UpdateRefineSummaryTitle();};var InitPopup=function($refineByForm,$refineDT,$relevantDD,e){var bShowPooupSummaryTitle=true;e.preventDefault();refinePopup=$('<div id="refinePopup" class="'+sClass+'-popup"></div>');refinePopupControls=$('<div id="refinePopupControls"><a id="setRefine" href="#" class="refineControl"><span>'+NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["set"]','Set')+'</span></a><a id="removeRefine" href="#" class="refineControl"><span>'+NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["remove"]','Remove')+'</span></a></div>');refinePopup.append(refinePopupControls);if($relevantDD.children(':not(dl)').length===1&&$relevantDD.children(':has(ul.selectlist)').length===1){refinePopupControls.css('display','none');bShowPooupSummaryTitle=false;}else{refinePopup.prepend($('<a id="closeRefine" href="#" class="refineControl"><span>'+NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["close"]','Close')+'</span></a>'));}var iOffSetTop=AnchorPosition_getPageOffsetTop($refineDT.get(0));var iOffSetLeft=AnchorPosition_getPageOffsetLeft($refineDT.get(0));if($refineDT.parent('dl').attr('class')!=='refineByDefListAdvanced'){$('body').block(blockUISettings(refinePopup,iOffSetTop,iOffSetLeft,false,false));}else{$('div.blockElement div#refinePopup').block(blockUISettings(refinePopup,iOffSetTop,iOffSetLeft,true,true));}$('.blockOverlay').attr('title',NewMind.ETWP.GetResource('NewMind.env.lang.resources.productsearch["searchsummary"]["clicktounblock"]','Click to unblock')).click(function(){$(this).removeAttr('title');$.unblockUI();});$("div.blockUI.blockMsg").addClass("HorizontalSearchBlockElement");$(window).keydown(function(e){if(e.which===27){$.unblockUI();}});refinePopup.prepend($relevantDD);$relevantDD.css('display','block');if(bShowPooupSummaryTitle){refinePopup.prepend('<h2 id="refinePopupTitle">'+$refineDT.find('label').text()+'</h2>');}};var InitPopupControls=function($refineByForm,$refineDT,$relevantDD,sRelevantInputType,sRefineDTLabel,e){refinePopup.find('a.refineControl').one('click',function(e){e.preventDefault();var sAction=$(this).attr('id').replace('Refine','');if(sRelevantInputType==='checkbox'){if(sAction==='set'){relevantInput.attr('checked','checked');}else if(sAction==='remove'){relevantInput.removeAttr('checked');}}else if(sRelevantInputType==='hidden'){if(sAction==='set'){relevantInput.attr('value','on');}else if(sAction==='remove'){relevantInput.attr('value','');}}if($.blockUI){$(this).parents('.blockElement:first').parent().unblock();}$relevantDD.css('display','none');refinePopup.css('display','none');UpdateRefineSearchSummary($refineByForm,$relevantDD,sRefineDTLabel,sAction);$refineDT.after($relevantDD);});};var refinePopup;var sClass=$refineDT.attr('class').split(' ')[0];var relevantInput=$refineDT.find("input[name='"+sClass+"']");var sRefineDTLabel=$refineDT.find('label').text();var sRelevantInputType=relevantInput.attr('type');InitPopup($refineByForm,$refineDT,$relevantDD,e);InitPopupControls($refineByForm,$refineDT,$relevantDD,sRelevantInputType,sRefineDTLabel,e);}};}();NewMind.ETWP.MultiSearchSwitcher=function(){var MultiSearchRendered=false;var callBackEvent=new NewMind.CustomEvent("searchOpened");function closeSearch(intCtrlKey){if(!intCtrlKey){return;}var objProdMltSrch=NewMind.ETWP.ControlData[intCtrlKey];if(!objProdMltSrch){return;}var $productSearch=$(".ctl_ProductSearch.c"+intCtrlKey);if($productSearch.length===0){return;}var $container=$productSearch.find('.prodMltSrch.open');if($container.length===0){return;}var sProdSearchClosed=objProdMltSrch.SearchClosed;$container.html(objProdMltSrch.SearchClosed).removeClass("open").addClass("closed");}function closeAll(eleOptionalContainer){var $container=$(eleOptionalContainer||document.body).find(".ctl_ProductSearch").each(function(){var intCtrlKey=NewMind.ETWP.GetControlKey(this);if(intCtrlKey){closeSearch(intCtrlKey);}});}return{Init:function(){if(MultiSearchRendered){return false;}$('.prodMltSrchLnk').click(function(ev){ev.preventDefault();});var arrProdSearchCtrlIds=[];$('.prodMltSrch').each(function(){arrProdSearchCtrlIds[arrProdSearchCtrlIds.length]=$(this).attr('id').replace('ctl_','');});if(arrProdSearchCtrlIds.length!==0){$('.prodMltSrch').click(function(e){var objSearchCliked=$(this);if(objSearchCliked.attr('class')!=='prodMltSrch open'){e.preventDefault();var intCtrlKey=objSearchCliked.attr('id').replace('ctl_','');var objProdMltSrch=NewMind.ETWP.ControlData[intCtrlKey];var sProdSearchOpen=objProdMltSrch.SearchOpen;var bCollapsible=objProdMltSrch.Collapsible;closeAll(objSearchCliked.parent().parent());objSearchCliked.html(sProdSearchOpen);objSearchCliked.removeClass('closed');objSearchCliked.addClass('open');callBackEvent.fire();if(window.NewMind.env.install.mapping.enabled===true){NewMind.mapping.MapInit.InitDynamicMappingControls();}NewMind.ETWP.ProductSearch.InitialiseRefineBy();NewMind.ETWP.ProductSearch.AddNewUnit();if(NewMind.ETWP.DatePicker!==undefined){NewMind.ETWP.DatePicker.Init();}if(bCollapsible){NewMind.ETWP.ProductSearch.InitCollapsibleSearch(intCtrlKey);}}});MultiSearchRendered=true;}},CallBackEvent:callBackEvent,Close:closeSearch,CloseAll:closeAll};}();if(typeof NewMind.ETWP.LocationSelector==="undefined"){NewMind.ETWP.LocationSelector=function(){var objLocations={};var bEnableFormSubmit=false;var autocompleteOptions={minChars:1,width:200,max:20,autoFill:true,highlight:false,formatItem:function(row,i,max){return row.place;},formatMatch:function(row,i,max){return NewMind.ETWP.FoldToASCII(row.place);},formatTerm:function(term){return NewMind.ETWP.FoldToASCII(term);}};var initialiseAutoComplete=function(iControlKey){var objLocationData=objLocations[iControlKey];if(objLocationData){setupLocationEvents(iControlKey);return;}var host=(typeof NewMindWidgetHostURL==="undefined")?"":NewMindWidgetHostURL;var strUrl=host+"/engine/locationLookup.asp"+"?channelid="+NewMind.ETWP.LocationSelector[iControlKey].channelID+"&prodtypes="+NewMind.ETWP.LocationSelector[iControlKey].prodtypes+"&placelevels="+NewMind.ETWP.LocationSelector[iControlKey].placeLevels+"&estate="+NewMind.ETWP.LocationSelector[iControlKey].estate+"&usePlaces="+NewMind.ETWP.LocationSelector[iControlKey].usePlaces+"&useAddress4="+NewMind.ETWP.LocationSelector[iControlKey].useAddress4+"&usePolygons="+NewMind.ETWP.LocationSelector[iControlKey].usePolygons+"&onlyincludeplaceswithcentrepoints="+NewMind.ETWP.LocationSelector[iControlKey].onlyincludeplaceswithcentrepoints;$.getScript(strUrl,function(data){if(arguments[1]=='success'){objLocations[iControlKey]=eval(data);setupLocationEvents(iControlKey);}});};var setupLocationEvents=function(iControlKey){var $objLocSel=$('.sys_control.c'+iControlKey);var $objLocationInput=$objLocSel.find('input[name="src_location"]');var strDefaultText;if(NewMind.ETWP.LocationSelector[iControlKey].showdefaulttext){strDefaultText=NewMind.ETWP.GetResource('NewMind.env.lang.resources.search["location"]["defaulttext"]','Type location / postcode');if(strDefaultText!==''){if($objLocationInput.val()==='')$objLocationInput.val(strDefaultText).parent().addClass('defaultText');}}$objLocationInput.focus(function(){if(NewMind.ETWP.LocationSelector[iControlKey].showdefaulttext){if(strDefaultText!==''){if($(this).val()===strDefaultText)$(this).val('').parent().removeClass('defaultText');}}}).keydown(function(){$(this).removeClass('validation_error');$(this).parent().find('span.validation_error').css('display','block').hide();}).keyup(function(e){var code=e.keyCode||e.which;if(code!='9'&&code!='13'){performLatLngAndPostCodeCheck($(this),$(this).attr('value'));}}).autocomplete(objLocations[iControlKey],autocompleteOptions).result(function(e,item){$objLocSel=$(this).parent('.locSel');selectLocation(item,$objLocSel,iControlKey);}).blur(function(e){$(this).search();});};var selectLocation=function(objSelectedItem,$objLocSel,iControlKey){if(objSelectedItem===undefined){resetHiddenFields($objLocSel);performLatLngAndPostCodeCheck($objLocSel,$objLocSel.find("input[name='src_location']").attr('value'));return;}$objLocSel.find('span.postcodeProximity').hide();bEnableFormSubmit=true;var intPolygonKey=objSelectedItem.polygon_key||"";$objLocSel.find("input[name='loc_polygon']").attr('value',intPolygonKey);var intPlaceKey=objSelectedItem.place_key||"";$objLocSel.find("input[name='loc_place']").attr('value',intPlaceKey);var placeProxEnabled="0";if(NewMind.ETWP.LocationSelector[iControlKey].usePlaceCentreProximity&&objSelectedItem.hasCoords){$objLocSel.parents('form').find('div.postcodeProximity').show();placeProxEnabled="1";}else{$objLocSel.parents('form').find('div.postcodeProximity').hide();placeProxEnabled="0";}$objLocSel.find("input[name='loc_placeprox']").attr('value',placeProxEnabled);var bIsAddress=objSelectedItem.isAddress||"";$objLocSel.find("input[name='loc_address']").attr('value',bIsAddress);};var resetHiddenFields=function($objLocSel){$objLocSel.find("input[type='hidden']").attr('value','').end();bEnableFormSubmit=false;};var performLatLngAndPostCodeCheck=function($objLocSel,strValue){var objRegEx=/^([A-PR-UWYZ0-9][A-HK-Y0-9][AEHMNPRTVXY0-9]?[ABEHMNPRVWXY0-9]?\s{0,1}[0-9][ABD-HJLN-UW-Z]{2}|GIR 0AA)\s*$/i;var $postcodeProximity=$objLocSel.parents('form').find('div.postcodeProximity');var objRegExMatch=""+objRegEx.exec(strValue);var objLatLngRegEx=/^(\-?\d+(\.\d+)?),\s*(\-?\d+(\.\d+)?)/gi;var objLatLngRegExMatch=""+objLatLngRegEx.exec(strValue);if(objRegExMatch!=="null"||objLatLngRegExMatch!=="null"){bEnableFormSubmit=true;$postcodeProximity.slideDown('slow');}else{$postcodeProximity.hide();bEnableFormSubmit=false;}};var initialiseLocationTextBox=function(iControlKey){var $objForm=$('div.c'+iControlKey).find('form');var objQueryStringData=NewMind.GetQuerystringData();var strLocation='';if(NewMind.ETWP.ProductSearch.UrlRewriter){if(typeof(objQueryStringData.get(NewMind.ETWP.ProductSearch.UrlRewriter.GetShortName('src_location')))!=="undefined"){strLocation=decodeURIComponent(objQueryStringData.get(NewMind.ETWP.ProductSearch.UrlRewriter.GetShortName('src_location')));}}if((strLocation==="")&&(typeof(objQueryStringData.get('src_location'))!=="undefined")){strLocation=decodeURIComponent(objQueryStringData.get('src_location'));}if(strLocation!==""){strLocation=strLocation.replace(/\+/g,' ');}var strRequired=NewMind.ETWP.LocationSelector[iControlKey].required&&$objForm.find('input[name="refine-location"]').attr('type')!=="checkbox"?" class=\"required\"":"";var labelledby="";var expectedLabelId='src_area-'+iControlKey+'-label';if(iControlKey&&$('#'+expectedLabelId).length){labelledby=' aria-labelledby="'+expectedLabelId+'" ';}$objForm.find('span.locSel').find('select#src_area').remove().end().find('input[name="loc_polygon"]').after('<input name="src_location" value="'+strLocation+'"'+strRequired+labelledby+'/>');if(NewMind.ETWP.LocationSelector[iControlKey].useGeolocation){if(navigator.geolocation){var $locationTextBox=$objForm.find("input[name=\"src_location\"]");$locationTextBox.after("<a class=\"usegeolocation\" href=\"#\">"+NewMind.ETWP.GetResource("NewMind.env.lang.resources.search.location.geolocation.mylocation","Use my location")+"</a>");$objForm.find("a.usegeolocation").click(function(event){event.preventDefault();populateLocationTextBoxWithGeoLocation(iControlKey);});}}$('div.c'+iControlKey+' form').validate({messages:{src_location:NewMind.ETWP.GetResource('NewMind.env.lang.resources.search.location.validationerror','Please select a location')},errorClass:'validation_error'});};var populateLocationTextBoxWithGeoLocation=function(iControlKey){if(typeof(iControlKey)==="undefined"){return;}if(navigator.geolocation){var loadingAnimation=NewMind.ETWP.GetResource("NewMind.env.imgs.resources.search.geolocation.loadingAnimation","/engine/shared_gfx/ajax-loader-arrows-white.gif");var loadingText=NewMind.ETWP.GetResource("NewMind.env.lang.resources.blockui.productsearch.geolocation.loadingtext","Please wait while we find your location, this may take a moment.");var loadingHTML=NewMind.ETWP.GetResource("NewMind.env.lang.resources.blockui.productsearch.geolocation.loadingHTML","");var loadingMessage=loadingHTML.toString().length>0?loadingHTML:(loadingText+' <img src="'+loadingAnimation+'" alt="" />');var blockUISettings={message:loadingMessage,fadeIn:0,fadeOut:0,overlayCSS:{backgroundColor:'#fff',opacity:'0.6'}};$.blockUI(blockUISettings);navigator.geolocation.getCurrentPosition(function(position){if(!isNaN(position.coords.latitude)&&!isNaN(position.coords.longitude)){var $locationTextBox=$('div.c'+iControlKey).find("form input[name=\"src_location\"]");$locationTextBox.val((position.coords.latitude).toFixed(6)+","+(position.coords.longitude).toFixed(6));performLatLngAndPostCodeCheck($locationTextBox,$locationTextBox.attr("value"));}$.unblockUI();},function(error){$.unblockUI({onUnblock:function(){switch(error.code){case error.TIMEOUT:alert(NewMind.ETWP.GetResource("NewMind.env.lang.resources.search.location.geolocation.timeout","The location request timed out, please try again."));break;case error.POSITION_UNAVAILABLE:alert(NewMind.ETWP.GetResource("NewMind.env.lang.resources.search.location.geolocation.unavailable","Your location was unavailable."));break;case error.PERMISSION_DENIED:alert(NewMind.ETWP.GetResource("NewMind.env.lang.resources.search.location.geolocation.denied","You have not authorised the use of your current location."));break;default:alert(NewMind.ETWP.GetResource("NewMind.env.lang.resources.search.location.geolocation.error","An error occurred when retrieving your location."));break;}}});},{timeout:10000});}};return{Init:function(iControlKey){initialiseLocationTextBox(iControlKey);initialiseAutoComplete(iControlKey);autocompleteOptions.width=NewMind.ETWP.LocationSelector[iControlKey].width||autocompleteOptions.width;},PopulateLocationTextBoxWithGeoLocation:function(iControlKey){populateLocationTextBoxWithGeoLocation(iControlKey);}};}();}NewMind.ETWP.PolygonAutocomplete=(function PolygonAutocomplete(){"use strict";var ANY_POLYGON_KEY=-1;return{Init:function Init(iControlKey){var $ctrl=$('div.c'+iControlKey);if($ctrl.length!=1){console.warn('NewMind.ETWP.PolygonAutocomplete.Init called for control '+iControlKey+'. Expected 1 control div on the page but got '+$ctrl.length+'.');return;}$ctrl.find('div.row.refine-polygon > span.field').each(function(){var $field=$(this);var $select=$field.find('> select[name="src_polygon"]');if($select.length==0){console.warn('NewMind.ETWP.PolygonAutocomplete.Init called for control '+iControlKey+'. No <select> element was found. Autocomplete is only supported when the render type is "select".');return;}var $polygonOptions=$select.find('> option').filter(function(){return(this.value!=ANY_POLYGON_KEY);});var polygonData=$polygonOptions.map(function mapOptionToObject(){return{key:this.value,name:this.label};}).get();var $selectedOption=$polygonOptions.filter(':selected');if($selectedOption.length>1){$selectedOption=$($selectedOption[0]);}var selectedPolygonKey=($selectedOption.length!==0)?$selectedOption.val():ANY_POLYGON_KEY;var $hiddenInput=$('<input type="hidden" name="src_polygon">');$hiddenInput.val(selectedPolygonKey);$hiddenInput.appendTo($field);$select.remove();var $textInput=$('<input type="text">');$textInput.val(selectedPolygonKey!=ANY_POLYGON_KEY?$selectedOption.text():'');$textInput.autocomplete(polygonData,{autoFill:true,highlight:false,max:100,formatItem:function(polygon,i,max){return polygon.name;},formatMatch:function(polygon,i,max){return NewMind.ETWP.FoldToASCII(polygon.name);},formatTerm:function(term){return NewMind.ETWP.FoldToASCII(term);}});$textInput.result(function(ev,polygon){if(polygon!==undefined){$hiddenInput.val(polygon.key);$textInput.val(polygon.name);}else{$hiddenInput.val(ANY_POLYGON_KEY);$textInput.val('');}}).blur(function(ev){$(this).search();});$textInput.appendTo($field);});}};}());$(function(){NewMind.ETWP.ProductSearch.AddNewUnitCapacity();NewMind.ETWP.ProductSearch.AddNewUnit();NewMind.ETWP.ProductSearch.InitialiseRefineBy();NewMind.ETWP.ProductSearch.ShowHideCapacityRefine();NewMind.ETWP.ProductSearch.InitUrlRewritingAndDataCapture();NewMind.ETWP.MultiSearchSwitcher.CallBackEvent.subscribe(NewMind.ETWP.ProductSearch.InitUrlRewritingAndDataCapture);if(NewMind.ETWP.DatePicker&&NewMind.ETWP.DatePicker.CallBackEvent){NewMind.ETWP.DatePicker.CallBackEvent.subscribe(function(){$(".ctl_ProductSearch, .ctl_Booking_AvailSearch").each(function(){applyDatePickerLabelIfRequired($(this).find(".calStartStayDate"));applyDatePickerLabelIfRequired($(this).find(".calStartDate"));applyDatePickerLabelIfRequired($(this).find(".calEndDate"));function applyDatePickerLabelIfRequired($startOrEndCalSpan){if(!$startOrEndCalSpan.length){return;}var $datePicker=$startOrEndCalSpan.find(">.hasDatepicker");if(!$datePicker.length||$datePicker.attr("aria-labelledby")){return;}var $datePickerLabel=$startOrEndCalSpan.parent().find("span.label>label, span.labelwide");if($datePickerLabel.length&&$datePickerLabel.attr("id")){$datePicker.attr("aria-labelledby",$datePickerLabel.attr("id"));}}});});}});
if(typeof(NewMind)==="undefined"){NewMind={ETWP:{ProductSearch:{}}};}NewMind.ETWP.ProductSearch.UrlRewriter=(function(){var arrMappings=[["advancedsearch","adv"],["end_day","ed"],["end_month","em"],["end_year","ey"],["isoenddate","end"],["loc_address","locaddr"],["loc_place","locplace"],["loc_placeprox","locprox"],["loc_polygon","locpoly"],["numUnitCapacity","nuc"],["refine-capacity","rcap"],["refine-category","cat"],["refine-date","rd"],["refine-facility","fac"],["refine-facilitygroup","facgrp"],["refine-grading","grade"],["refine-grouptravel","group"],["refine-keywords","key"],["refine-location","rloc"],["refine-name","name"],["refine-nasrating","nas"],["refine-place","area"],["refine-polygon","poly"],["refine-postcard","rpc"],["refine-price","rprice"],["refine-product","rprod"],["refine-productproximity","rprodprox"],["refine-producttype","producttype"],["refine-proximity","rprox"],["refine-specialoffers","offer"],["refine-tfa","rtfa"],["refine-tripadvisorminrating","tripadvisor"],["refine-unittype","unittype"],["refine-unitcapacitytype","runitcaptype"],["refine-vaqas","vq"],["refine-whatsnearbyproximity","nearprox"],["refined","sr"],["src_address","addr"],["src_anydate","anydate"],["src_area","area"],["src_capacity","cap"],["src_capacityranges","caprng"],["src_category","cat"],["src_facility","fac"],["src_facilitygroup","facgrp"],["src_grading","grade"],["src_location","loc"],["src_mingroup","group"],["src_maxprice","maxprice"],["src_minprice","minprice"],["src_name","name"],["src_nashearing","nash"],["src_nasmobility","nasm"],["src_nasrating","nasr"],["src_nasvisual","nasv"],["src_pcproximity_bands","areaproxbands"],["src_pcproximity_dist","areaproxdist"],["src_polygon","poly"],["src_mapproduct","mapproduct"],["src_priceranges","pricerng"],["src_producttype","producttype"],["src_proximity","prox"],["src_proximity_bands","proxbands"],["src_proximity_dist","proxdist"],["src_specoff","offer"],["src_tfa","stfa"],["src_tfaorder","tfaorder"],["src_tripadvisorminrating","tripadvisor"],["src_unitcapacity","unitcap"],["src_unitcapacitytype","unitcaptype"],["src_unittype","unittype"],["start_day","dd"],["start_month","dm"],["start_year","dy"],["vaqas","vq"],["NumRoomReqs","rooms"],["isostartdate","stay"],["refine-availability","avail"],["src_discountAvailOnly","disc"],["nights","dur"]];var arrRegExMappings=[["roomReq_([0-9]+)$","r$1"],["roomReq_([0-9]+)_adults$","r$1a"],["roomReq_([0-9]+)_children$","r$1c"],["roomReq_([0-9]+)_children_childage([0-9]+)$","r$1c$2"],["refine-groupedFac([0-9]+)$","facOneOf$1"],["groupedFac([0-9]+)$","facOneOf$1"]];function getShortName(strName){strName=(""+strName);for(var i=0;i<arrMappings.length;i++){if(strName===arrMappings[i][0]){return arrMappings[i][1];}}for(var i=0;i<arrRegExMappings.length;i++){var patt1=new RegExp(arrRegExMappings[i][0]);var PattTest=strName.match(patt1);var strShortenedName="";if(PattTest){strShortenedName=arrRegExMappings[i][1];for(var p=1;p<PattTest.length;p++){strShortenedName=strShortenedName.replace("$"+p,PattTest[p]);}return strShortenedName;}}return strName;}function reduceQuery(strQueryString){if((""+strQueryString)===""){return "";}var arrQueryString=(""+strQueryString).split("&");var arrValues=[];for(var i=0;i<arrQueryString.length;i++){var strSegment=arrQueryString[i];var intBreak=strSegment.indexOf("=");var strKey,strValue;if(intBreak===-1){strKey=strSegment;strValue="";}else{strKey=strSegment.substring(0,intBreak);strValue=strSegment.substring(intBreak+1,strSegment.length);}arrValues.push({Key:strKey,Value:strValue});}arrValues=arrValues.concat(getAnyRequiredAdditions(arrValues));arrValues=removeUnnecessaryValues(arrValues);var arrQueryStringNew=[];for(var i=0;i<arrValues.length;i++){arrQueryStringNew.push(getShortName(arrValues[i].Key)+"="+arrValues[i].Value);}return arrQueryStringNew.join("&");}function removeUnnecessaryValues(arrValues){var bAvailUnchecked=isPresentWithConsistentValues(arrValues,"refine-availability","");var arrAvailFields=["isostartdate","nights","fuzzy","NumRoomReqs","src_discountAvailOnly","incnotavail"];arrValues=rewriteGroupedFacilityValues(arrValues);var arrSimpleRemovalNames=getSimpleRemovalNames(arrValues);var arrValuesNew=[];for(var i=0;i<arrValues.length;i++){var objValue=arrValues[i];if(objValue.Value==""){continue;}if(bAvailUnchecked&&((objValue.Key.substring(0,7)==="roomReq")||doesArrayContain(arrAvailFields,objValue.Key))){continue;}if(objValue.Key.substring(0,12)==="src_awards__"){var intIndex=parseInt(objValue.Key.substr(12));if(!isNaN(intIndex)){if(!isPresentWithAnyNonBlankValue(arrValues,"refine-awards__"+intIndex)){continue;}}}if((objValue.Key==="_isostartdate")||(objValue.Key==="_isoenddate")){continue;}if(doesArrayContain(arrSimpleRemovalNames,objValue.Key)){continue;}arrValuesNew.push(objValue);}return arrValuesNew;}function getSimpleRemovalNames(arrValues){var arrSimpleRemovalNames=[];var arrIgnoreIfUnchecked=["category","facility","facilitygroup","grading","name","polygon","producttype","unittype","vaqas",["place","area"],["grouptravel","mingroup"],["specialoffers","specoff"]];for(var i=arrIgnoreIfUnchecked.length-1;i>=0;i--){var varName=arrIgnoreIfUnchecked[i];var strRefineName,strSrcName;if(typeof(varName)==="string"){strRefineName="refine-"+varName;strSrcName="src_"+varName;if(isPresentWithConsistentValues(arrValues,strRefineName,"")){arrSimpleRemovalNames.push(strSrcName);}}else{strRefineName="refine-"+varName[0];strSrcName="src_"+varName[1];if(isPresentWithConsistentValues(arrValues,strRefineName,"")){arrSimpleRemovalNames.push(strSrcName);}}}var arrIgnoreIfMinusOne=["category","polygon","facilitygroup"];for(var i=0;i<arrIgnoreIfMinusOne.length;i++){var strName=arrIgnoreIfMinusOne[i];if(isPresentWithConsistentValues(arrValues,"src_"+strName,"-1")){arrSimpleRemovalNames.push("src_"+strName);arrSimpleRemovalNames.push("refine-"+strName);}}if(isPresentWithConsistentValues(arrValues,"src_area","-1")){arrSimpleRemovalNames.push("src_area");arrSimpleRemovalNames.push("refine-place");}var arrIgnoreIfBlank=["name","unittype"];for(var i=0;i<arrIgnoreIfBlank.length;i++){var strName=arrIgnoreIfBlank[i];if(isPresentWithConsistentValues(arrValues,"src_"+strName,"")){arrSimpleRemovalNames.push("src_"+strName);arrSimpleRemovalNames.push("refine-"+strName);}}if(isPresentWithConsistentValues(arrValues,"refine-location","")||isPresentWithConsistentValues(arrValues,"src_location","")){arrSimpleRemovalNames.push("loc_address");arrSimpleRemovalNames.push("loc_place");arrSimpleRemovalNames.push("loc_placeprox");arrSimpleRemovalNames.push("loc_polygon");arrSimpleRemovalNames.push("refine-location");arrSimpleRemovalNames.push("src_location");arrSimpleRemovalNames.push("src_pcproximity_bands");arrSimpleRemovalNames.push("src_pcproximity_dist");}var arrIgnoreRefinementForParamCombination=["category","facility","facilitygroup","grading","name","polygon","producttype","unittype","vaqas",["place","area"],["grouptravel","mingroup"],["specialoffers","specoff"]];for(var i=0;i<arrIgnoreRefinementForParamCombination.length;i++){var varName=arrIgnoreRefinementForParamCombination[i];var strRefineName,strSrcName;if(typeof(varName)==="string"){strRefineName="refine-"+varName;strSrcName="src_"+varName;}else{strRefineName="refine-"+varName[0];strSrcName="src_"+varName[1];}if(isPresentWithAnyNonBlankValue(arrValues,strRefineName)&&isPresentWithAnyNonBlankValue(arrValues,strSrcName)){arrSimpleRemovalNames.push(strRefineName);}}for(var i=0;i<=arrValues.length-1;i++){var strKey=arrValues[i].Key;var strRef="refine-awards__";if(strKey.indexOf(strRef)>=0){if(isPresentWithConsistentValues(arrValues,strKey,"")){var strSrcKey="src_awards__"+strKey.substr(strRef.length,strKey.length);arrSimpleRemovalNames.push(strKey);arrSimpleRemovalNames.push(strSrcKey);}}}for(var i=0;i<=arrValues.length-1;i++){var strKey=arrValues[i].Key;if(strKey.match(/roomReq_[0-9]+_adults/)){var matches=strKey.match(/\d/);if(matches!=null){var RoomKey=matches[0];var strRef="roomReq_"+RoomKey;var ChildCount=0;if(!isPresentWithIntGreaterThanZero(arrValues,strKey)){arrSimpleRemovalNames.push(strKey);arrSimpleRemovalNames.push(strRef+"_children");}else if(!isPresentWithIntGreaterThanZero(arrValues,strRef+"_children")){arrSimpleRemovalNames.push(strRef+"_children");}else{ChildCount=getValueFromKey(arrValues,strRef+"_children",0);}for(var ca=0;isPresent(arrValues,strRef+"_children_childage"+ca);ca++){if(ca>=ChildCount){arrSimpleRemovalNames.push(strRef+"_children_childage"+ca);}}}}}if(isPresentWithAnyNonBlankValue(arrValues,"refine-facility")&&!isPresentWithAnyNonBlankValue(arrValues,"src_facility")){arrSimpleRemovalNames.push("refine-facility");}if(!isPresentWithAnyNonBlankValue(arrValues,"refine-price")){arrSimpleRemovalNames.push("refine-price");arrSimpleRemovalNames.push("src_maxprice");arrSimpleRemovalNames.push("src_minprice");}if(isPresentWithAnyNonBlankValue(arrValues,"refine-date")&&isPresentWithConsistentValues(arrValues,"src_anydate","yes")){arrSimpleRemovalNames.push("isostartdate");arrSimpleRemovalNames.push("isoenddate");}return arrSimpleRemovalNames;}function getAnyRequiredAdditions(arrValues){var arrFieldsToAdd=[];var arrStandardZeroCheckboxSelectionsTypes=["category","facilitygroup","polygon",["place","area"]];for(var i=arrStandardZeroCheckboxSelectionsTypes.length-1;i>=0;i--){var varName=arrStandardZeroCheckboxSelectionsTypes[i];var strRefineName,strSrcName;if(typeof(varName)==="string"){strRefineName="refine-"+varName;strSrcName="src_"+varName;}else{strRefineName="refine-"+varName[0];strSrcName="src_"+varName[1];}if(isPresentWithAnyNonBlankValue(arrValues,strRefineName)&&!isPresentWithAnyNonBlankValue(arrValues,strSrcName)){arrFieldsToAdd.push({Key:strSrcName,Value:"-1"});}}if(isPresentWithAnyNonBlankValue(arrValues,"refine-grading")&&!isPresentWithAnyNonBlankValue(arrValues,"src_grading")){arrFieldsToAdd.push({Key:"src_grading",Value:"-2"});}return arrFieldsToAdd}function rewriteGroupedFacilityValues(arrValues){var dictGroupedFacHasOptionsSelectedLookup={};for(var i=0;i<arrValues.length;i++){var strPrefix="groupedFac";var strKey=arrValues[i].Key;if(strKey.substring(0,strPrefix.length)!==strPrefix){continue;}var strGroupedFacId=strKey.substring(strPrefix.length,strKey.length);if(isNaN(parseInt(strGroupedFacId,10))){continue;}if(arrValues[i].Value){dictGroupedFacHasOptionsSelectedLookup[strGroupedFacId]=true;}}var dictGroupedFacAllOptionsLookup={};var intLargestGroupedFacNumberFound=0;for(var i=0;i<arrValues.length;i++){var strPrefix="groupedFacOptions";var strKey=arrValues[i].Key;if(strKey.substring(0,strPrefix.length)!==strPrefix){continue;}var strGroupedFacId=strKey.substring(strPrefix.length,strKey.length);var intGroupedFacNumber=parseInt(strGroupedFacId,10);if(intGroupedFacNumber>intLargestGroupedFacNumberFound){intLargestGroupedFacNumberFound=intGroupedFacNumber;}if(arrValues[i].Value){dictGroupedFacAllOptionsLookup[strGroupedFacId]=arrValues[i].Value;}}var dictGroupedFacilitiesMappings={};var intNumberOfGroupedFacEntries=0;var arrToRemove=[],arrToRename=[];var arrExcludeValues=[];for(var i=0;i<arrValues.length;i++){var strPrefix="refine-groupedFac";var strKey=arrValues[i].Key;if(strKey.substring(0,strPrefix.length)!==strPrefix){continue;}var strGroupedFacId=strKey.substring(strPrefix.length,strKey.length);if(isPresentWithAnyNonBlankValue(arrValues,strKey)){if(dictGroupedFacHasOptionsSelectedLookup.hasOwnProperty(strGroupedFacId)){intNumberOfGroupedFacEntries++;dictGroupedFacilitiesMappings[strGroupedFacId]=intNumberOfGroupedFacEntries;arrToRename.push({From:"groupedFac"+strGroupedFacId,To:"facOneOf"+intNumberOfGroupedFacEntries});}else{if(dictGroupedFacAllOptionsLookup.hasOwnProperty(strGroupedFacId)){arrExcludeValues.push(dictGroupedFacAllOptionsLookup[strGroupedFacId]);}}arrToRemove.push("refine-groupedFac"+strGroupedFacId);arrToRemove.push("groupedFacOptions"+strGroupedFacId);}}for(var i=1;i<=intLargestGroupedFacNumberFound;i++){if(!dictGroupedFacilitiesMappings.hasOwnProperty(""+i)){arrToRemove.push("groupedFacOptions"+i);arrToRemove.push("groupedFac"+i);}}var arrValuesNew=[];for(var i=0;i<arrValues.length;i++){var bExclude=false;var strKey=arrValues[i].Key;for(var j=0;j<arrToRemove.length;j++){if(strKey===arrToRemove[j]){bExclude=true;break;}}if(bExclude){continue;}for(var j=0;j<arrToRename.length;j++){if(strKey===arrToRename[j].From){strKey=arrToRename[j].To;break;}}arrValuesNew.push({Key:strKey,Value:arrValues[i].Value});}if(arrExcludeValues.length>0){arrValuesNew.push({Key:"facExclude",Value:arrExcludeValues.join(",")});}return arrValuesNew;}function doesArrayContain(arrValues,strName){for(var i=0;i<arrValues.length;i++){if(arrValues[i]===strName){return true;}}return false;}function isPresentWithConsistentValues(arrValues,strName,strValueToMatch){var intMatchCount=0;for(var i=0;i<arrValues.length;i++){if(arrValues[i].Key===strName){if(arrValues[i].Value!==strValueToMatch){return false;}intMatchCount++;}}return(intMatchCount>0);}function isPresentWithAnyNonBlankValue(arrValues,strName){for(var i=0;i<arrValues.length;i++){if((arrValues[i].Key===strName)&&(arrValues[i].Value!=="")){return true;}}return false;}function getValueFromKey(arrValues,strName,varReturnValue){for(var i=0;i<arrValues.length;i++){if((arrValues[i].Key===strName)){return arrValues[i].Value;}}return varReturnValue;}function isPresent(arrValues,strName){for(var i=0;i<arrValues.length;i++){if((arrValues[i].Key===strName)){return true;}}return false;}function isPresentWithIntGreaterThanZero(arrValues,strName){for(var i=0;i<arrValues.length;i++){if((arrValues[i].Key===strName)&&(arrValues[i].Value>0)){return true;}}return false;}return{GetShortName:getShortName,ReduceQuery:reduceQuery};})();
(function(){'use strict';var _charReplacements={'\u00C0':'A','\u00C1':'A','\u00C2':'A','\u00C3':'A','\u00C4':'A','\u00C5':'A','\u0100':'A','\u0102':'A','\u0104':'A','\u018F':'A','\u01CD':'A','\u01DE':'A','\u01E0':'A','\u01FA':'A','\u0200':'A','\u0202':'A','\u0226':'A','\u023A':'A','\u1D00':'A','\u1E00':'A','\u1EA0':'A','\u1EA2':'A','\u1EA4':'A','\u1EA6':'A','\u1EA8':'A','\u1EAA':'A','\u1EAC':'A','\u1EAE':'A','\u1EB0':'A','\u1EB2':'A','\u1EB4':'A','\u1EB6':'A','\u24B6':'A','\uFF21':'A','\u00E0':'a','\u00E1':'a','\u00E2':'a','\u00E3':'a','\u00E4':'a','\u00E5':'a','\u0101':'a','\u0103':'a','\u0105':'a','\u01CE':'a','\u01DF':'a','\u01E1':'a','\u01FB':'a','\u0201':'a','\u0203':'a','\u0227':'a','\u0250':'a','\u0259':'a','\u025A':'a','\u1D8F':'a','\u1D95':'a','\u1E01':'a','\u1E9A':'a','\u1EA1':'a','\u1EA3':'a','\u1EA5':'a','\u1EA7':'a','\u1EA9':'a','\u1EAB':'a','\u1EAD':'a','\u1EAF':'a','\u1EB1':'a','\u1EB3':'a','\u1EB5':'a','\u1EB7':'a','\u2090':'a','\u2094':'a','\u24D0':'a','\u2C65':'a','\u2C6F':'a','\uFF41':'a','\uA732':'AA','\u00C6':'AE','\u01E2':'AE','\u01FC':'AE','\u1D01':'AE','\uA734':'AO','\uA736':'AU','\uA738':'AV','\uA73A':'AV','\uA73C':'AY','\u249C':'(a)','\uA733':'aa','\u00E6':'ae','\u01E3':'ae','\u01FD':'ae','\u1D02':'ae','\uA735':'ao','\uA737':'au','\uA739':'av','\uA73B':'av','\uA73D':'ay','\u0181':'B','\u0182':'B','\u0243':'B','\u0299':'B','\u1D03':'B','\u1E02':'B','\u1E04':'B','\u1E06':'B','\u24B7':'B','\uFF22':'B','\u0180':'b','\u0183':'b','\u0253':'b','\u1D6C':'b','\u1D80':'b','\u1E03':'b','\u1E05':'b','\u1E07':'b','\u24D1':'b','\uFF42':'b','\u249D':'(b)','\u00C7':'C','\u0106':'C','\u0108':'C','\u010A':'C','\u010C':'C','\u0187':'C','\u023B':'C','\u0297':'C','\u1D04':'C','\u1E08':'C','\u24B8':'C','\uFF23':'C','\u00E7':'c','\u0107':'c','\u0109':'c','\u010B':'c','\u010D':'c','\u0188':'c','\u023C':'c','\u0255':'c','\u1E09':'c','\u2184':'c','\u24D2':'c','\uA73E':'c','\uA73F':'c','\uFF43':'c','\u249E':'(c)','\u00D0':'D','\u010E':'D','\u0110':'D','\u0189':'D','\u018A':'D','\u018B':'D','\u1D05':'D','\u1D06':'D','\u1E0A':'D','\u1E0C':'D','\u1E0E':'D','\u1E10':'D','\u1E12':'D','\u24B9':'D','\uA779':'D','\uFF24':'D','\u00F0':'d','\u010F':'d','\u0111':'d','\u018C':'d','\u0221':'d','\u0256':'d','\u0257':'d','\u1D6D':'d','\u1D81':'d','\u1D91':'d','\u1E0B':'d','\u1E0D':'d','\u1E0F':'d','\u1E11':'d','\u1E13':'d','\u24D3':'d','\uA77A':'d','\uFF44':'d','\u01C4':'DZ','\u01F1':'DZ','\u01C5':'Dz','\u01F2':'Dz','\u249F':'(d)','\u0238':'db','\u01C6':'dz','\u01F3':'dz','\u02A3':'dz','\u02A5':'dz','\u00C8':'E','\u00C9':'E','\u00CA':'E','\u00CB':'E','\u0112':'E','\u0114':'E','\u0116':'E','\u0118':'E','\u011A':'E','\u018E':'E','\u0190':'E','\u0204':'E','\u0206':'E','\u0228':'E','\u0246':'E','\u1D07':'E','\u1E14':'E','\u1E16':'E','\u1E18':'E','\u1E1A':'E','\u1E1C':'E','\u1EB8':'E','\u1EBA':'E','\u1EBC':'E','\u1EBE':'E','\u1EC0':'E','\u1EC2':'E','\u1EC4':'E','\u1EC6':'E','\u24BA':'E','\u2C7B':'E','\uFF25':'E','\u00E8':'e','\u00E9':'e','\u00EA':'e','\u00EB':'e','\u0113':'e','\u0115':'e','\u0117':'e','\u0119':'e','\u011B':'e','\u01DD':'e','\u0205':'e','\u0207':'e','\u0229':'e','\u0247':'e','\u0258':'e','\u025B':'e','\u025C':'e','\u025D':'e','\u025E':'e','\u029A':'e','\u1D08':'e','\u1D92':'e','\u1D93':'e','\u1D94':'e','\u1E15':'e','\u1E17':'e','\u1E19':'e','\u1E1B':'e','\u1E1D':'e','\u1EB9':'e','\u1EBB':'e','\u1EBD':'e','\u1EBF':'e','\u1EC1':'e','\u1EC3':'e','\u1EC5':'e','\u1EC7':'e','\u2091':'e','\u24D4':'e','\u2C78':'e','\uFF45':'e','\u24A0':'(e)','\u0191':'F','\u1E1E':'F','\u24BB':'F','\uA730':'F','\uA77B':'F','\uA7FB':'F','\uFF26':'F','\u0192':'f','\u1D6E':'f','\u1D82':'f','\u1E1F':'f','\u1E9B':'f','\u24D5':'f','\uA77C':'f','\uFF46':'f','\u24A1':'(f)','\uFB00':'ff','\uFB03':'ffi','\uFB04':'ffl','\uFB01':'fi','\uFB02':'fl','\u011C':'G','\u011E':'G','\u0120':'G','\u0122':'G','\u0193':'G','\u01E4':'G','\u01E5':'G','\u01E6':'G','\u01E7':'G','\u01F4':'G','\u0262':'G','\u029B':'G','\u1E20':'G','\u24BC':'G','\uA77D':'G','\uA77E':'G','\uFF27':'G','\u011D':'g','\u011F':'g','\u0121':'g','\u0123':'g','\u01F5':'g','\u0260':'g','\u0261':'g','\u1D77':'g','\u1D79':'g','\u1D83':'g','\u1E21':'g','\u24D6':'g','\uA77F':'g','\uFF47':'g','\u24A2':'(g)','\u0124':'H','\u0126':'H','\u021E':'H','\u029C':'H','\u1E22':'H','\u1E24':'H','\u1E26':'H','\u1E28':'H','\u1E2A':'H','\u24BD':'H','\u2C67':'H','\u2C75':'H','\uFF28':'H','\u0125':'h','\u0127':'h','\u021F':'h','\u0265':'h','\u0266':'h','\u02AE':'h','\u02AF':'h','\u1E23':'h','\u1E25':'h','\u1E27':'h','\u1E29':'h','\u1E2B':'h','\u1E96':'h','\u24D7':'h','\u2C68':'h','\u2C76':'h','\uFF48':'h','\u01F6':'HV','\u24A3':'(h)','\u0195':'hv','\u00CC':'I','\u00CD':'I','\u00CE':'I','\u00CF':'I','\u0128':'I','\u012A':'I','\u012C':'I','\u012E':'I','\u0130':'I','\u0196':'I','\u0197':'I','\u01CF':'I','\u0208':'I','\u020A':'I','\u026A':'I','\u1D7B':'I','\u1E2C':'I','\u1E2E':'I','\u1EC8':'I','\u1ECA':'I','\u24BE':'I','\uA7FE':'I','\uFF29':'I','\u00EC':'i','\u00ED':'i','\u00EE':'i','\u00EF':'i','\u0129':'i','\u012B':'i','\u012D':'i','\u012F':'i','\u0131':'i','\u01D0':'i','\u0209':'i','\u020B':'i','\u0268':'i','\u1D09':'i','\u1D62':'i','\u1D7C':'i','\u1D96':'i','\u1E2D':'i','\u1E2F':'i','\u1EC9':'i','\u1ECB':'i','\u2071':'i','\u24D8':'i','\uFF49':'i','\u0132':'IJ','\u24A4':'(i)','\u0133':'ij','\u0134':'J','\u0248':'J','\u1D0A':'J','\u24BF':'J','\uFF2A':'J','\u0135':'j','\u01F0':'j','\u0237':'j','\u0249':'j','\u025F':'j','\u0284':'j','\u029D':'j','\u24D9':'j','\u2C7C':'j','\uFF4A':'j','\u24A5':'(j)','\u0136':'K','\u0198':'K','\u01E8':'K','\u1D0B':'K','\u1E30':'K','\u1E32':'K','\u1E34':'K','\u24C0':'K','\u2C69':'K','\uA740':'K','\uA742':'K','\uA744':'K','\uFF2B':'K','\u0137':'k','\u0199':'k','\u01E9':'k','\u029E':'k','\u1D84':'k','\u1E31':'k','\u1E33':'k','\u1E35':'k','\u24DA':'k','\u2C6A':'k','\uA741':'k','\uA743':'k','\uA745':'k','\uFF4B':'k','\u24A6':'(k)','\u0139':'L','\u013B':'L','\u013D':'L','\u013F':'L','\u0141':'L','\u023D':'L','\u029F':'L','\u1D0C':'L','\u1E36':'L','\u1E38':'L','\u1E3A':'L','\u1E3C':'L','\u24C1':'L','\u2C60':'L','\u2C62':'L','\uA746':'L','\uA748':'L','\uA780':'L','\uFF2C':'L','\u013A':'l','\u013C':'l','\u013E':'l','\u0140':'l','\u0142':'l','\u019A':'l','\u0234':'l','\u026B':'l','\u026C':'l','\u026D':'l','\u1D85':'l','\u1E37':'l','\u1E39':'l','\u1E3B':'l','\u1E3D':'l','\u24DB':'l','\u2C61':'l','\uA747':'l','\uA749':'l','\uA781':'l','\uFF4C':'l','\u01C7':'LJ','\u1EFA':'LL','\u01C8':'Lj','\u24A7':'(l)','\u01C9':'lj','\u1EFB':'ll','\u02AA':'ls','\u02AB':'lz','\u019C':'M','\u1D0D':'M','\u1E3E':'M','\u1E40':'M','\u1E42':'M','\u24C2':'M','\u2C6E':'M','\uA7FD':'M','\uA7FF':'M','\uFF2D':'M','\u026F':'m','\u0270':'m','\u0271':'m','\u1D6F':'m','\u1D86':'m','\u1E3F':'m','\u1E41':'m','\u1E43':'m','\u24DC':'m','\uFF4D':'m','\u24A8':'(m)','\u00D1':'N','\u0143':'N','\u0145':'N','\u0147':'N','\u014A':'N','\u019D':'N','\u01F8':'N','\u0220':'N','\u0274':'N','\u1D0E':'N','\u1E44':'N','\u1E46':'N','\u1E48':'N','\u1E4A':'N','\u24C3':'N','\uFF2E':'N','\u00F1':'n','\u0144':'n','\u0146':'n','\u0148':'n','\u0149':'n','\u014B':'n','\u019E':'n','\u01F9':'n','\u0235':'n','\u0272':'n','\u0273':'n','\u1D70':'n','\u1D87':'n','\u1E45':'n','\u1E47':'n','\u1E49':'n','\u1E4B':'n','\u207F':'n','\u24DD':'n','\uFF4E':'n','\u01CA':'NJ','\u01CB':'Nj','\u24A9':'(n)','\u01CC':'nj','\u00D2':'O','\u00D3':'O','\u00D4':'O','\u00D5':'O','\u00D6':'O','\u00D8':'O','\u014C':'O','\u014E':'O','\u0150':'O','\u0186':'O','\u019F':'O','\u01A0':'O','\u01D1':'O','\u01EA':'O','\u01EC':'O','\u01FE':'O','\u020C':'O','\u020E':'O','\u022A':'O','\u022C':'O','\u022E':'O','\u0230':'O','\u1D0F':'O','\u1D10':'O','\u1E4C':'O','\u1E4E':'O','\u1E50':'O','\u1E52':'O','\u1ECC':'O','\u1ECE':'O','\u1ED0':'O','\u1ED2':'O','\u1ED4':'O','\u1ED6':'O','\u1ED8':'O','\u1EDA':'O','\u1EDC':'O','\u1EDE':'O','\u1EE0':'O','\u1EE2':'O','\u24C4':'O','\uA74A':'O','\uA74C':'O','\uFF2F':'O','\u00F2':'o','\u00F3':'o','\u00F4':'o','\u00F5':'o','\u00F6':'o','\u00F8':'o','\u014D':'o','\u014F':'o','\u0151':'o','\u01A1':'o','\u01D2':'o','\u01EB':'o','\u01ED':'o','\u01FF':'o','\u020D':'o','\u020F':'o','\u022B':'o','\u022D':'o','\u022F':'o','\u0231':'o','\u0254':'o','\u0275':'o','\u1D16':'o','\u1D17':'o','\u1D97':'o','\u1E4D':'o','\u1E4F':'o','\u1E51':'o','\u1E53':'o','\u1ECD':'o','\u1ECF':'o','\u1ED1':'o','\u1ED3':'o','\u1ED5':'o','\u1ED7':'o','\u1ED9':'o','\u1EDB':'o','\u1EDD':'o','\u1EDF':'o','\u1EE1':'o','\u1EE3':'o','\u2092':'o','\u24DE':'o','\u2C7A':'o','\uA74B':'o','\uA74D':'o','\uFF4F':'o','\u0152':'OE','\u0276':'OE','\uA74E':'OO','\u0222':'OU','\u1D15':'OU','\u24AA':'(o)','\u0153':'oe','\u1D14':'oe','\uA74F':'oo','\u0223':'ou','\u01A4':'P','\u1D18':'P','\u1E54':'P','\u1E56':'P','\u24C5':'P','\u2C63':'P','\uA750':'P','\uA752':'P','\uA754':'P','\uFF30':'P','\u01A5':'p','\u1D71':'p','\u1D7D':'p','\u1D88':'p','\u1E55':'p','\u1E57':'p','\u24DF':'p','\uA751':'p','\uA753':'p','\uA755':'p','\uA7FC':'p','\uFF50':'p','\u24AB':'(p)','\u024A':'Q','\u24C6':'Q','\uA756':'Q','\uA758':'Q','\uFF31':'Q','\u0138':'q','\u024B':'q','\u02A0':'q','\u24E0':'q','\uA757':'q','\uA759':'q','\uFF51':'q','\u24AC':'(q)','\u0239':'qp','\u0154':'R','\u0156':'R','\u0158':'R','\u0210':'R','\u0212':'R','\u024C':'R','\u0280':'R','\u0281':'R','\u1D19':'R','\u1D1A':'R','\u1E58':'R','\u1E5A':'R','\u1E5C':'R','\u1E5E':'R','\u24C7':'R','\u2C64':'R','\uA75A':'R','\uA782':'R','\uFF32':'R','\u0155':'r','\u0157':'r','\u0159':'r','\u0211':'r','\u0213':'r','\u024D':'r','\u027C':'r','\u027D':'r','\u027E':'r','\u027F':'r','\u1D63':'r','\u1D72':'r','\u1D73':'r','\u1D89':'r','\u1E59':'r','\u1E5B':'r','\u1E5D':'r','\u1E5F':'r','\u24E1':'r','\uA75B':'r','\uA783':'r','\uFF52':'r','\u24AD':'(r)','\u015A':'S','\u015C':'S','\u015E':'S','\u0160':'S','\u0218':'S','\u1E60':'S','\u1E62':'S','\u1E64':'S','\u1E66':'S','\u1E68':'S','\u24C8':'S','\uA731':'S','\uA785':'S','\uFF33':'S','\u015B':'s','\u015D':'s','\u015F':'s','\u0161':'s','\u017F':'s','\u0219':'s','\u023F':'s','\u0282':'s','\u1D74':'s','\u1D8A':'s','\u1E61':'s','\u1E63':'s','\u1E65':'s','\u1E67':'s','\u1E69':'s','\u1E9C':'s','\u1E9D':'s','\u24E2':'s','\uA784':'s','\uFF53':'s','\u1E9E':'SS','\u24AE':'(s)','\u00DF':'ss','\uFB06':'st','\u0162':'T','\u0164':'T','\u0166':'T','\u01AC':'T','\u01AE':'T','\u021A':'T','\u023E':'T','\u1D1B':'T','\u1E6A':'T','\u1E6C':'T','\u1E6E':'T','\u1E70':'T','\u24C9':'T','\uA786':'T','\uFF34':'T','\u0163':'t','\u0165':'t','\u0167':'t','\u01AB':'t','\u01AD':'t','\u021B':'t','\u0236':'t','\u0287':'t','\u0288':'t','\u1D75':'t','\u1E6B':'t','\u1E6D':'t','\u1E6F':'t','\u1E71':'t','\u1E97':'t','\u24E3':'t','\u2C66':'t','\uFF54':'t','\u00DE':'TH','\uA766':'TH','\uA728':'TZ','\u24AF':'(t)','\u02A8':'tc','\u00FE':'th','\u1D7A':'th','\uA767':'th','\u02A6':'ts','\uA729':'tz','\u00D9':'U','\u00DA':'U','\u00DB':'U','\u00DC':'U','\u0168':'U','\u016A':'U','\u016C':'U','\u016E':'U','\u0170':'U','\u0172':'U','\u01AF':'U','\u01D3':'U','\u01D5':'U','\u01D7':'U','\u01D9':'U','\u01DB':'U','\u0214':'U','\u0216':'U','\u0244':'U','\u1D1C':'U','\u1D7E':'U','\u1E72':'U','\u1E74':'U','\u1E76':'U','\u1E78':'U','\u1E7A':'U','\u1EE4':'U','\u1EE6':'U','\u1EE8':'U','\u1EEA':'U','\u1EEC':'U','\u1EEE':'U','\u1EF0':'U','\u24CA':'U','\uFF35':'U','\u00F9':'u','\u00FA':'u','\u00FB':'u','\u00FC':'u','\u0169':'u','\u016B':'u','\u016D':'u','\u016F':'u','\u0171':'u','\u0173':'u','\u01B0':'u','\u01D4':'u','\u01D6':'u','\u01D8':'u','\u01DA':'u','\u01DC':'u','\u0215':'u','\u0217':'u','\u0289':'u','\u1D64':'u','\u1D99':'u','\u1E73':'u','\u1E75':'u','\u1E77':'u','\u1E79':'u','\u1E7B':'u','\u1EE5':'u','\u1EE7':'u','\u1EE9':'u','\u1EEB':'u','\u1EED':'u','\u1EEF':'u','\u1EF1':'u','\u24E4':'u','\uFF55':'u','\u24B0':'(u)','\u1D6B':'ue','\u01B2':'V','\u0245':'V','\u1D20':'V','\u1E7C':'V','\u1E7E':'V','\u1EFC':'V','\u24CB':'V','\uA75E':'V','\uA768':'V','\uFF36':'V','\u028B':'v','\u028C':'v','\u1D65':'v','\u1D8C':'v','\u1E7D':'v','\u1E7F':'v','\u24E5':'v','\u2C71':'v','\u2C74':'v','\uA75F':'v','\uFF56':'v','\uA760':'VY','\u24B1':'(v)','\uA761':'vy','\u0174':'W','\u01F7':'W','\u1D21':'W','\u1E80':'W','\u1E82':'W','\u1E84':'W','\u1E86':'W','\u1E88':'W','\u24CC':'W','\u2C72':'W','\uFF37':'W','\u0175':'w','\u01BF':'w','\u028D':'w','\u1E81':'w','\u1E83':'w','\u1E85':'w','\u1E87':'w','\u1E89':'w','\u1E98':'w','\u24E6':'w','\u2C73':'w','\uFF57':'w','\u24B2':'(w)','\u1E8A':'X','\u1E8C':'X','\u24CD':'X','\uFF38':'X','\u1D8D':'x','\u1E8B':'x','\u1E8D':'x','\u2093':'x','\u24E7':'x','\uFF58':'x','\u24B3':'(x)','\u00DD':'Y','\u0176':'Y','\u0178':'Y','\u01B3':'Y','\u0232':'Y','\u024E':'Y','\u028F':'Y','\u1E8E':'Y','\u1EF2':'Y','\u1EF4':'Y','\u1EF6':'Y','\u1EF8':'Y','\u1EFE':'Y','\u24CE':'Y','\uFF39':'Y','\u00FD':'y','\u00FF':'y','\u0177':'y','\u01B4':'y','\u0233':'y','\u024F':'y','\u028E':'y','\u1E8F':'y','\u1E99':'y','\u1EF3':'y','\u1EF5':'y','\u1EF7':'y','\u1EF9':'y','\u1EFF':'y','\u24E8':'y','\uFF59':'y','\u24B4':'(y)','\u0179':'Z','\u017B':'Z','\u017D':'Z','\u01B5':'Z','\u021C':'Z','\u0224':'Z','\u1D22':'Z','\u1E90':'Z','\u1E92':'Z','\u1E94':'Z','\u24CF':'Z','\u2C6B':'Z','\uA762':'Z','\uFF3A':'Z','\u017A':'z','\u017C':'z','\u017E':'z','\u01B6':'z','\u021D':'z','\u0225':'z','\u0240':'z','\u0290':'z','\u0291':'z','\u1D76':'z','\u1D8E':'z','\u1E91':'z','\u1E93':'z','\u1E95':'z','\u24E9':'z','\u2C6C':'z','\uA763':'z','\uFF5A':'z','\u24B5':'(z)','\u2070':'0','\u2080':'0','\u24EA':'0','\u24FF':'0','\uFF10':'0','\u00B9':'1','\u2081':'1','\u2460':'1','\u24F5':'1','\u2776':'1','\u2780':'1','\u278A':'1','\uFF11':'1','\u2488':'1.','\u2474':'(1)','\u00B2':'2','\u2082':'2','\u2461':'2','\u24F6':'2','\u2777':'2','\u2781':'2','\u278B':'2','\uFF12':'2','\u2489':'2.','\u2475':'(2)','\u00B3':'3','\u2083':'3','\u2462':'3','\u24F7':'3','\u2778':'3','\u2782':'3','\u278C':'3','\uFF13':'3','\u248A':'3.','\u2476':'(3)','\u2074':'4','\u2084':'4','\u2463':'4','\u24F8':'4','\u2779':'4','\u2783':'4','\u278D':'4','\uFF14':'4','\u248B':'4.','\u2477':'(4)','\u2075':'5','\u2085':'5','\u2464':'5','\u24F9':'5','\u277A':'5','\u2784':'5','\u278E':'5','\uFF15':'5','\u248C':'5.','\u2478':'(5)','\u2076':'6','\u2086':'6','\u2465':'6','\u24FA':'6','\u277B':'6','\u2785':'6','\u278F':'6','\uFF16':'6','\u248D':'6.','\u2479':'(6)','\u2077':'7','\u2087':'7','\u2466':'7','\u24FB':'7','\u277C':'7','\u2786':'7','\u2790':'7','\uFF17':'7','\u248E':'7.','\u247A':'(7)','\u2078':'8','\u2088':'8','\u2467':'8','\u24FC':'8','\u277D':'8','\u2787':'8','\u2791':'8','\uFF18':'8','\u248F':'8.','\u247B':'(8)','\u2079':'9','\u2089':'9','\u2468':'9','\u24FD':'9','\u277E':'9','\u2788':'9','\u2792':'9','\uFF19':'9','\u2490':'9.','\u247C':'(9)','\u2469':'10','\u24FE':'10','\u277F':'10','\u2789':'10','\u2793':'10','\u2491':'10.','\u247D':'(10)','\u246A':'11','\u24EB':'11','\u2492':'11.','\u247E':'(11)','\u246B':'12','\u24EC':'12','\u2493':'12.','\u247F':'(12)','\u246C':'13','\u24ED':'13','\u2494':'13.','\u2480':'(13)','\u246D':'14','\u24EE':'14','\u2495':'14.','\u2481':'(14)','\u246E':'15','\u24EF':'15','\u2496':'15.','\u2482':'(15)','\u246F':'16','\u24F0':'16','\u2497':'16.','\u2483':'(16)','\u2470':'17','\u24F1':'17','\u2498':'17.','\u2484':'(17)','\u2471':'18','\u24F2':'18','\u2499':'18.','\u2485':'(18)','\u2472':'19','\u24F3':'19','\u249A':'19.','\u2486':'(19)','\u2473':'20','\u24F4':'20','\u249B':'20.','\u2487':'(20)','\u00AB':'"','\u00BB':'"','\u201C':'"','\u201D':'"','\u201E':'"','\u2033':'"','\u2036':'"','\u275D':'"','\u275E':'"','\u276E':'"','\u276F':'"','\uFF02':'"','\u2018':'\'','\u2019':'\'','\u201A':'\'','\u201B':'\'','\u2032':'\'','\u2035':'\'','\u2039':'\'','\u203A':'\'','\u275B':'\'','\u275C':'\'','\uFF07':'\'','\u2010':'-','\u2011':'-','\u2012':'-','\u2013':'-','\u2014':'-','\u207B':'-','\u208B':'-','\uFF0D':'-','\u2045':'[','\u2772':'[','\uFF3B':'[','\u2046':']','\u2773':']','\uFF3D':']','\u207D':'(','\u208D':'(','\u2768':'(','\u276A':'(','\uFF08':'(','\u2E28':'((','\u207E':')','\u208E':')','\u2769':')','\u276B':')','\uFF09':')','\u2E29':'))','\u276C':'<','\u2770':'<','\uFF1C':'<','\u276D':'>','\u2771':'>','\uFF1E':'>','\u2774':'{','\uFF5B':'{','\u2775':'}','\uFF5D':'}','\u207A':'+','\u208A':'+','\uFF0B':'+','\u207C':'=','\u208C':'=','\uFF1D':'=','\uFF01':'!','\u203C':'!!','\u2049':'!?','\uFF03':'#','\uFF04':'$','\u2052':'%','\uFF05':'%','\uFF06':'&','\u204E':'*','\uFF0A':'*','\uFF0C':',','\uFF0E':'.','\u2044':'/','\uFF0F':'/','\uFF1A':':','\u204F':';','\uFF1B':';','\uFF1F':'?','\u2047':'??','\u2048':'?!','\uFF20':'@','\uFF3C':'\\','\u2038':'^','\uFF3E':'^','\uFF3F':'_','\u2053':'~','\uFF5E':'~'};NewMind.ETWP.FoldToASCII=function(str){var chars=str.split(''),charsLength=chars.length,modified=false;for(var i=0;i<charsLength;i++){if(_charReplacements.hasOwnProperty(chars[i])){chars[i]=_charReplacements[chars[i]];modified=true;}}return(modified?chars.join(''):str);};})();
var MONTH_NAMES=new Array('January','February','March','April','May','June','July','August','September','October','November','December','Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec');var DAY_NAMES=new Array('Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday','Sun','Mon','Tue','Wed','Thu','Fri','Sat');function LZ(x){return(x<0||x>9?"":"0")+x}function isDate(val,format){var date=getDateFromFormat(val,format);if(date==0){return false;}return true;}function compareDates(date1,dateformat1,date2,dateformat2){var d1=getDateFromFormat(date1,dateformat1);var d2=getDateFromFormat(date2,dateformat2);if(d1==0||d2==0){return -1;}else if(d1>d2){return 1;}return 0;}function formatDate(date,format){format=format+"";var result="";var i_format=0;var c="";var token="";var y=date.getYear()+"";var M=date.getMonth()+1;var d=date.getDate();var E=date.getDay();var H=date.getHours();var m=date.getMinutes();var s=date.getSeconds();var yyyy,yy,MMM,MM,dd,hh,h,mm,ss,ampm,HH,H,KK,K,kk,k;var value=new Object();if(y.length<4){y=""+(y-0+1900);}value["y"]=""+y;value["yyyy"]=y;value["yy"]=y.substring(2,4);value["M"]=M;value["MM"]=LZ(M);value["MMM"]=MONTH_NAMES[M-1];value["NNN"]=MONTH_NAMES[M+11];value["d"]=d;value["dd"]=LZ(d);value["E"]=DAY_NAMES[E+7];value["EE"]=DAY_NAMES[E];value["H"]=H;value["HH"]=LZ(H);if(H==0){value["h"]=12;}else if(H>12){value["h"]=H-12;}else{value["h"]=H;}value["hh"]=LZ(value["h"]);if(H>11){value["K"]=H-12;}else{value["K"]=H;}value["k"]=H+1;value["KK"]=LZ(value["K"]);value["kk"]=LZ(value["k"]);if(H>11){value["a"]="PM";}else{value["a"]="AM";}value["m"]=m;value["mm"]=LZ(m);value["s"]=s;value["ss"]=LZ(s);while(i_format<format.length){c=format.charAt(i_format);token="";while((format.charAt(i_format)==c)&&(i_format<format.length)){token+=format.charAt(i_format++);}if(value[token]!=null){result=result+value[token];}else{result=result+token;}}return result;}function _isInteger(val){var digits="1234567890";for(var i=0;i<val.length;i++){if(digits.indexOf(val.charAt(i))==-1){return false;}}return true;}function _getInt(str,i,minlength,maxlength){for(var x=maxlength;x>=minlength;x--){var token=str.substring(i,i+x);if(token.length<minlength){return null;}if(_isInteger(token)){return token;}}return null;}function getDateFromFormat(val,format){val=val+"";format=format+"";var i_val=0;var i_format=0;var c="";var token="";var token2="";var x,y;var now=new Date();var year=now.getYear();var month=now.getMonth()+1;var date=1;var hh=now.getHours();var mm=now.getMinutes();var ss=now.getSeconds();var ampm="";while(i_format<format.length){c=format.charAt(i_format);token="";while((format.charAt(i_format)==c)&&(i_format<format.length)){token+=format.charAt(i_format++);}if(token=="yyyy"||token=="yy"||token=="y"){if(token=="yyyy"){x=4;y=4;}if(token=="yy"){x=2;y=2;}if(token=="y"){x=2;y=4;}year=_getInt(val,i_val,x,y);if(year==null){return 0;}i_val+=year.length;if(year.length==2){if(year>70){year=1900+(year-0);}else{year=2000+(year-0);}}}else if(token=="MMM"||token=="NNN"){month=0;for(var i=0;i<MONTH_NAMES.length;i++){var month_name=MONTH_NAMES[i];if(val.substring(i_val,i_val+month_name.length).toLowerCase()==month_name.toLowerCase()){if(token=="MMM"||(token=="NNN"&&i>11)){month=i+1;if(month>12){month-=12;}i_val+=month_name.length;break;}}}if((month<1)||(month>12)){return 0;}}else if(token=="EE"||token=="E"){for(var i=0;i<DAY_NAMES.length;i++){var day_name=DAY_NAMES[i];if(val.substring(i_val,i_val+day_name.length).toLowerCase()==day_name.toLowerCase()){i_val+=day_name.length;break;}}}else if(token=="MM"||token=="M"){month=_getInt(val,i_val,token.length,2);if(month==null||(month<1)||(month>12)){return 0;}i_val+=month.length;}else if(token=="dd"||token=="d"){date=_getInt(val,i_val,token.length,2);if(date==null||(date<1)||(date>31)){return 0;}i_val+=date.length;}else if(token=="hh"||token=="h"){hh=_getInt(val,i_val,token.length,2);if(hh==null||(hh<1)||(hh>12)){return 0;}i_val+=hh.length;}else if(token=="HH"||token=="H"){hh=_getInt(val,i_val,token.length,2);if(hh==null||(hh<0)||(hh>23)){return 0;}i_val+=hh.length;}else if(token=="KK"||token=="K"){hh=_getInt(val,i_val,token.length,2);if(hh==null||(hh<0)||(hh>11)){return 0;}i_val+=hh.length;}else if(token=="kk"||token=="k"){hh=_getInt(val,i_val,token.length,2);if(hh==null||(hh<1)||(hh>24)){return 0;}i_val+=hh.length;hh--;}else if(token=="mm"||token=="m"){mm=_getInt(val,i_val,token.length,2);if(mm==null||(mm<0)||(mm>59)){return 0;}i_val+=mm.length;}else if(token=="ss"||token=="s"){ss=_getInt(val,i_val,token.length,2);if(ss==null||(ss<0)||(ss>59)){return 0;}i_val+=ss.length;}else if(token=="a"){if(val.substring(i_val,i_val+2).toLowerCase()=="am"){ampm="AM";}else if(val.substring(i_val,i_val+2).toLowerCase()=="pm"){ampm="PM";}else{return 0;}i_val+=2;}else{if(val.substring(i_val,i_val+token.length)!=token){return 0;}else{i_val+=token.length;}}}if(i_val!=val.length){return 0;}if(month==2){if(((year%4==0)&&(year%100!=0))||(year%400==0)){if(date>29){return 0;}}else{if(date>28){return 0;}}}if((month==4)||(month==6)||(month==9)||(month==11)){if(date>30){return 0;}}if(hh<12&&ampm=="PM"){hh=hh-0+12;}else if(hh>11&&ampm=="AM"){hh-=12;}var newdate=new Date(year,month-1,date,hh,mm,ss);return newdate.getTime();}function parseDate(val){var preferEuro=(arguments.length==2)?arguments[1]:false;generalFormats=new Array('y-M-d','MMM d, y','MMM d,y','y-MMM-d','d-MMM-y','MMM d');monthFirst=new Array('M/d/y','M-d-y','M.d.y','MMM-d','M/d','M-d');dateFirst=new Array('d/M/y','d-M-y','d.M.y','d-MMM','d/M','d-M');var checkList=new Array('generalFormats',preferEuro?'dateFirst':'monthFirst',preferEuro?'monthFirst':'dateFirst');var d=null;for(var i=0;i<checkList.length;i++){var l=window[checkList[i]];for(var j=0;j<l.length;j++){d=getDateFromFormat(val,l[j]);if(d!=0){return new Date(d);}}}return null;}function PopupWindow_getXYPosition(anchorname){var coordinates;if(this.type=="WINDOW"){coordinates=getAnchorWindowPosition(anchorname);}else{coordinates=getAnchorPosition(anchorname);}this.x=coordinates.x;this.y=coordinates.y;}function PopupWindow_setSize(width,height){this.width=width;this.height=height;}function PopupWindow_populate(contents){this.contents=contents;this.populated=false;}function PopupWindow_setUrl(url){this.url=url;}function PopupWindow_setWindowProperties(props){this.windowProperties=props;}function PopupWindow_refresh(){if(this.divName!=null){if(this.use_gebi){document.getElementById(this.divName).innerHTML=this.contents;}else if(this.use_css){document.all[this.divName].innerHTML=this.contents;}else if(this.use_layers){var d=document.layers[this.divName];d.document.open();d.document.writeln(this.contents);d.document.close();}}else{if(this.popupWindow!=null&&!this.popupWindow.closed){if(this.url!=""){this.popupWindow.location.href=this.url;}else{this.popupWindow.document.open();this.popupWindow.document.writeln(this.contents);this.popupWindow.document.close();}this.popupWindow.focus();}}}function PopupWindow_showPopup(anchorname){this.getXYPosition(anchorname);this.x+=this.offsetX;this.y+=this.offsetY;if(!this.populated&&(this.contents!="")){this.populated=true;this.refresh();}if(this.divName!=null){if(this.use_gebi){document.getElementById(this.divName).style.left=this.x+"px";document.getElementById(this.divName).style.top=this.y+"px";document.getElementById(this.divName).style.visibility="visible";}else if(this.use_css){document.all[this.divName].style.left=this.x;document.all[this.divName].style.top=this.y;document.all[this.divName].style.visibility="visible";}else if(this.use_layers){document.layers[this.divName].left=this.x;document.layers[this.divName].top=this.y;document.layers[this.divName].visibility="visible";}}else{if(this.popupWindow==null||this.popupWindow.closed){if(this.x<0){this.x=0;}if(this.y<0){this.y=0;}if(screen&&screen.availHeight){if((this.y+this.height)>screen.availHeight){this.y=screen.availHeight-this.height;}}if(screen&&screen.availWidth){if((this.x+this.width)>screen.availWidth){this.x=screen.availWidth-this.width;}}var avoidAboutBlank=window.opera||(document.layers&&!navigator.mimeTypes['*'])||navigator.vendor=='KDE'||(document.childNodes&&!document.all&&!navigator.taintEnabled);this.popupWindow=window.open(avoidAboutBlank?"":"about:blank","window_"+anchorname,this.windowProperties+",width="+this.width+",height="+this.height+",screenX="+this.x+",left="+this.x+",screenY="+this.y+",top="+this.y+"");}this.refresh();}}function PopupWindow_hidePopup(){if(this.divName!=null){if(this.use_gebi){document.getElementById(this.divName).style.visibility="hidden";}else if(this.use_css){document.all[this.divName].style.visibility="hidden";}else if(this.use_layers){document.layers[this.divName].visibility="hidden";}}else{if(this.popupWindow&&!this.popupWindow.closed){this.popupWindow.close();this.popupWindow=null;}}}function PopupWindow_isClicked(e){if(this.divName!=null){if(this.use_layers){var clickX=e.pageX;var clickY=e.pageY;var t=document.layers[this.divName];if((clickX>t.left)&&(clickX<t.left+t.clip.width)&&(clickY>t.top)&&(clickY<t.top+t.clip.height)){return true;}else{return false;}}else if(document.all){var t=window.event.srcElement;while(t.parentElement!=null){if(t.id==this.divName){return true;}t=t.parentElement;}return false;}else if(this.use_gebi&&e){var t=e.originalTarget;while(t.parentNode!=null){if(t.id==this.divName){return true;}t=t.parentNode;}return false;}return false;}return false;}function PopupWindow_hideIfNotClicked(e){if(this.autoHideEnabled&&!this.isClicked(e)){this.hidePopup();}}function PopupWindow_autoHide(){this.autoHideEnabled=true;}function PopupWindow_hidePopupWindows(e){for(var i=0;i<popupWindowObjects.length;i++){if(popupWindowObjects[i]!=null){var p=popupWindowObjects[i];p.hideIfNotClicked(e);}}}function PopupWindow_attachListener(){if(document.layers){document.captureEvents(Event.MOUSEUP);}window.popupWindowOldEventListener=document.onmouseup;if(window.popupWindowOldEventListener!=null){document.onmouseup=new Function("window.popupWindowOldEventListener();PopupWindow_hidePopupWindows();");}else{document.onmouseup=PopupWindow_hidePopupWindows;}}function PopupWindow(){if(!window.popupWindowIndex){window.popupWindowIndex=0;}if(!window.popupWindowObjects){window.popupWindowObjects=new Array();}if(!window.listenerAttached){window.listenerAttached=true;PopupWindow_attachListener();}this.index=popupWindowIndex++;popupWindowObjects[this.index]=this;this.divName=null;this.popupWindow=null;this.width=0;this.height=0;this.populated=false;this.visible=false;this.autoHideEnabled=false;this.contents="";this.url="";this.windowProperties="toolbar=no,location=no,status=no,menubar=no,scrollbars=auto,resizable,alwaysRaised,dependent,titlebar=no";if(arguments.length>0){this.type="DIV";this.divName=arguments[0];}else{this.type="WINDOW";}this.use_gebi=false;this.use_css=false;this.use_layers=false;if(document.getElementById){this.use_gebi=true;}else if(document.all){this.use_css=true;}else if(document.layers){this.use_layers=true;}else{this.type="WINDOW";}this.offsetX=0;this.offsetY=0;this.getXYPosition=PopupWindow_getXYPosition;this.populate=PopupWindow_populate;this.setUrl=PopupWindow_setUrl;this.setWindowProperties=PopupWindow_setWindowProperties;this.refresh=PopupWindow_refresh;this.showPopup=PopupWindow_showPopup;this.hidePopup=PopupWindow_hidePopup;this.setSize=PopupWindow_setSize;this.isClicked=PopupWindow_isClicked;this.autoHide=PopupWindow_autoHide;this.hideIfNotClicked=PopupWindow_hideIfNotClicked;}function CalendarPopup(){var c;if(arguments.length>0){c=new PopupWindow(arguments[0]);}else{c=new PopupWindow();c.setSize(150,175);}c.offsetX=-152;c.offsetY=25;c.autoHide();c.monthNames=new Array("January","February","March","April","May","June","July","August","September","October","November","December");c.monthAbbreviations=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");c.dayHeaders=new Array("S","M","T","W","T","F","S");c.returnFunction="CP_tmpReturnFunction";c.returnMonthFunction="CP_tmpReturnMonthFunction";c.returnQuarterFunction="CP_tmpReturnQuarterFunction";c.returnYearFunction="CP_tmpReturnYearFunction";c.weekStartDay=0;c.isShowYearNavigation=false;c.displayType="date";c.disabledWeekDays=new Object();c.disabledDatesExpression="";c.yearSelectStartOffset=2;c.currentDate=null;c.todayText="Today";c.cssPrefix="";c.isShowNavigationDropdowns=false;c.isShowYearNavigationInput=false;window.CP_calendarObject=null;window.CP_targetInput=null;window.CP_dateFormat="MM/dd/yyyy";c.copyMonthNamesToWindow=CP_copyMonthNamesToWindow;c.setReturnFunction=CP_setReturnFunction;c.setReturnMonthFunction=CP_setReturnMonthFunction;c.setReturnQuarterFunction=CP_setReturnQuarterFunction;c.setReturnYearFunction=CP_setReturnYearFunction;c.setMonthNames=CP_setMonthNames;c.setMonthAbbreviations=CP_setMonthAbbreviations;c.setDayHeaders=CP_setDayHeaders;c.setWeekStartDay=CP_setWeekStartDay;c.setDisplayType=CP_setDisplayType;c.setDisabledWeekDays=CP_setDisabledWeekDays;c.addDisabledDates=CP_addDisabledDates;c.setYearSelectStartOffset=CP_setYearSelectStartOffset;c.setTodayText=CP_setTodayText;c.showYearNavigation=CP_showYearNavigation;c.showCalendar=CP_showCalendar;c.hideCalendar=CP_hideCalendar;c.getStyles=getCalendarStyles;c.refreshCalendar=CP_refreshCalendar;c.getCalendar=CP_getCalendar;c.select=CP_select;c.setCssPrefix=CP_setCssPrefix;c.showNavigationDropdowns=CP_showNavigationDropdowns;c.showYearNavigationInput=CP_showYearNavigationInput;c.copyMonthNamesToWindow();return c;}function CP_copyMonthNamesToWindow(){if(typeof(window.MONTH_NAMES)!="undefined"&&window.MONTH_NAMES!=null){window.MONTH_NAMES=new Array();for(var i=0;i<this.monthNames.length;i++){window.MONTH_NAMES[window.MONTH_NAMES.length]=this.monthNames[i];}for(var i=0;i<this.monthAbbreviations.length;i++){window.MONTH_NAMES[window.MONTH_NAMES.length]=this.monthAbbreviations[i];}}}function CP_tmpReturnFunction(y,m,d){if(window.CP_targetInput!=null){var dt=new Date(y,m-1,d,0,0,0);if(window.CP_calendarObject!=null){window.CP_calendarObject.copyMonthNamesToWindow();}window.CP_targetInput.value=formatDate(dt,window.CP_dateFormat);}else{alert('Use setReturnFunction() to define which function will get the clicked results!');}}function CP_tmpReturnMonthFunction(y,m){alert('Use setReturnMonthFunction() to define which function will get the clicked results!\nYou clicked: year='+y+' , month='+m);}function CP_tmpReturnQuarterFunction(y,q){alert('Use setReturnQuarterFunction() to define which function will get the clicked results!\nYou clicked: year='+y+' , quarter='+q);}function CP_tmpReturnYearFunction(y){alert('Use setReturnYearFunction() to define which function will get the clicked results!\nYou clicked: year='+y);}function CP_setReturnFunction(name){this.returnFunction=name;}function CP_setReturnMonthFunction(name){this.returnMonthFunction=name;}function CP_setReturnQuarterFunction(name){this.returnQuarterFunction=name;}function CP_setReturnYearFunction(name){this.returnYearFunction=name;}function CP_setMonthNames(){for(var i=0;i<arguments.length;i++){this.monthNames[i]=arguments[i];}this.copyMonthNamesToWindow();}function CP_setMonthAbbreviations(){for(var i=0;i<arguments.length;i++){this.monthAbbreviations[i]=arguments[i];}this.copyMonthNamesToWindow();}function CP_setDayHeaders(){for(var i=0;i<arguments.length;i++){this.dayHeaders[i]=arguments[i];}}function CP_setWeekStartDay(day){this.weekStartDay=day;}function CP_showYearNavigation(){this.isShowYearNavigation=(arguments.length>0)?arguments[0]:true;}function CP_setDisplayType(type){if(type!="date"&&type!="week-end"&&type!="month"&&type!="quarter"&&type!="year"){alert("Invalid display type! Must be one of: date,week-end,month,quarter,year");return false;}this.displayType=type;}function CP_setYearSelectStartOffset(num){this.yearSelectStartOffset=num;}function CP_setDisabledWeekDays(){this.disabledWeekDays=new Object();for(var i=0;i<arguments.length;i++){this.disabledWeekDays[arguments[i]]=true;}}function CP_addDisabledDates(start,end){if(arguments.length==1){end=start;}if(start==null&&end==null){return;}if(this.disabledDatesExpression!=""){this.disabledDatesExpression+="||";}if(start!=null){start=parseDate(start);start=""+start.getFullYear()+LZ(start.getMonth()+1)+LZ(start.getDate());}if(end!=null){end=parseDate(end);end=""+end.getFullYear()+LZ(end.getMonth()+1)+LZ(end.getDate());}if(start==null){this.disabledDatesExpression+="(ds<="+end+")";}else if(end==null){this.disabledDatesExpression+="(ds>="+start+")";}else{this.disabledDatesExpression+="(ds>="+start+"&&ds<="+end+")";}}function CP_setTodayText(text){this.todayText=text;}function CP_setCssPrefix(val){this.cssPrefix=val;}function CP_showNavigationDropdowns(){this.isShowNavigationDropdowns=(arguments.length>0)?arguments[0]:true;}function CP_showYearNavigationInput(){this.isShowYearNavigationInput=(arguments.length>0)?arguments[0]:true;}function CP_hideCalendar(){if(arguments.length>0){window.popupWindowObjects[arguments[0]].hidePopup();}else{this.hidePopup();}}function CP_refreshCalendar(index){var calObject=window.popupWindowObjects[index];if(arguments.length>1){calObject.populate(calObject.getCalendar(arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]));}else{calObject.populate(calObject.getCalendar());}calObject.refresh();}function CP_showCalendar(anchorname){if(arguments.length>1){if(arguments[1]==null||arguments[1]==""){this.currentDate=new Date();}else{this.currentDate=new Date(parseDate(arguments[1]));}}this.populate(this.getCalendar());this.showPopup(anchorname);}function CP_select(inputobj,linkname,format){var selectedDate=(arguments.length>3)?arguments[3]:null;if(!window.getDateFromFormat){alert("calendar.select: To use this method you must also include 'date.js' for date formatting");return;}if(this.displayType!="date"&&this.displayType!="week-end"){alert("calendar.select: This function can only be used with displayType 'date' or 'week-end'");return;}if(inputobj.type!="text"&&inputobj.type!="hidden"&&inputobj.type!="textarea"){alert("calendar.select: Input object passed is not a valid form input object");window.CP_targetInput=null;return;}if(inputobj.disabled){return;}window.CP_targetInput=inputobj;window.CP_calendarObject=this;this.currentDate=null;var time=0;if(selectedDate!=null){time=getDateFromFormat(selectedDate,format)}else if(inputobj.value!=""){time=getDateFromFormat(inputobj.value,format);}if(selectedDate!=null||inputobj.value!=""){if(time==0){this.currentDate=null;}else{this.currentDate=new Date(time);}}window.CP_dateFormat=format;this.showCalendar(linkname);}function getCalendarStyles(){var result="";var p="";if(this!=null&&typeof(this.cssPrefix)!="undefined"&&this.cssPrefix!=null&&this.cssPrefix!=""){p=this.cssPrefix;}result+="<STYLE>\n";result+="."+p+"cpYearNavigation,."+p+"cpMonthNavigation{background-color:#C0C0C0;text-align:center;vertical-align:center;text-decoration:none;color:#000000;font-weight:bold;}\n";result+="."+p+"cpDayColumnHeader, ."+p+"cpYearNavigation,."+p+"cpMonthNavigation,."+p+"cpCurrentMonthDate,."+p+"cpCurrentMonthDateDisabled,."+p+"cpOtherMonthDate,."+p+"cpOtherMonthDateDisabled,."+p+"cpCurrentDate,."+p+"cpCurrentDateDisabled,."+p+"cpTodayText,."+p+"cpTodayTextDisabled,."+p+"cpText{font-family:arial;font-size:8pt;}\n";result+="TD."+p+"cpDayColumnHeader{text-align:right;border:solid thin #C0C0C0;border-width:0px 0px 1px 0px;}\n";result+="."+p+"cpCurrentMonthDate, ."+p+"cpOtherMonthDate, ."+p+"cpCurrentDate{text-align:right;text-decoration:none;}\n";result+="."+p+"cpCurrentMonthDateDisabled, ."+p+"cpOtherMonthDateDisabled, ."+p+"cpCurrentDateDisabled{color:#D0D0D0;text-align:right;text-decoration:line-through;}\n";result+="."+p+"cpCurrentMonthDate, .cpCurrentDate{color:#000000;}\n";result+="."+p+"cpOtherMonthDate{color:#808080;}\n";result+="TD."+p+"cpCurrentDate{color:white;background-color: #C0C0C0;border-width:1px;border:solid thin #800000;}\n";result+="TD."+p+"cpCurrentDateDisabled{border-width:1px;border:solid thin #FFAAAA;}\n";result+="TD."+p+"cpTodayText, TD."+p+"cpTodayTextDisabled{border:solid thin #C0C0C0;border-width:1px 0px 0px 0px;}\n";result+="A."+p+"cpTodayText, SPAN."+p+"cpTodayTextDisabled{height:20px;}\n";result+="A."+p+"cpTodayText{color:black;}\n";result+="."+p+"cpTodayTextDisabled{color:#D0D0D0;}\n";result+="."+p+"cpBorder{border:solid thin #808080;}\n";result+="</STYLE>\n";return result;}function CP_getCalendar(){var now=new Date();if(this.type=="WINDOW"){var windowref="window.opener.";}else{var windowref="";}var result="";if(this.type=="WINDOW"){result+="<HTML><HEAD><TITLE>Calendar</TITLE>"+this.getStyles()+"</HEAD><BODY MARGINWIDTH=0 MARGINHEIGHT=0 TOPMARGIN=0 RIGHTMARGIN=0 LEFTMARGIN=0>\n";result+='<CENTER><TABLE WIDTH=100% BORDER=0 BORDERWIDTH=0 CELLSPACING=0 CELLPADDING=0>\n';}else{result+='<TABLE CLASS="'+this.cssPrefix+'cpBorder" WIDTH=144 BORDER=1 BORDERWIDTH=1 CELLSPACING=0 CELLPADDING=1>\n';result+='<TR><TD ALIGN=CENTER>\n';result+='<CENTER>\n';}if(this.displayType=="date"||this.displayType=="week-end"){if(this.currentDate==null){this.currentDate=now;}if(arguments.length>0){var month=arguments[0];}else{var month=this.currentDate.getMonth()+1;}if(arguments.length>1&&arguments[1]>0&&arguments[1]-0==arguments[1]){var year=arguments[1];}else{var year=this.currentDate.getFullYear();}var daysinmonth=new Array(0,31,28,31,30,31,30,31,31,30,31,30,31);if(((year%4==0)&&(year%100!=0))||(year%400==0)){daysinmonth[2]=29;}var current_month=new Date(year,month-1,1);var display_year=year;var display_month=month;var display_date=1;var weekday=current_month.getDay();var offset=0;offset=(weekday>=this.weekStartDay)?weekday-this.weekStartDay:7-this.weekStartDay+weekday;if(offset>0){display_month--;if(display_month<1){display_month=12;display_year--;}display_date=daysinmonth[display_month]-offset+1;}var next_month=month+1;var next_month_year=year;if(next_month>12){next_month=1;next_month_year++;}var last_month=month-1;var last_month_year=year;if(last_month<1){last_month=12;last_month_year--;}var date_class;if(this.type!="WINDOW"){result+="<TABLE WIDTH=144 BORDER=0 BORDERWIDTH=0 CELLSPACING=0 CELLPADDING=0>";}result+='<TR>\n';var refresh=windowref+'CP_refreshCalendar';var refreshLink='javascript:'+refresh;if(this.isShowNavigationDropdowns){result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="78" COLSPAN="3"><select CLASS="'+this.cssPrefix+'cpMonthNavigation" name="cpMonth" onChange="'+refresh+'('+this.index+',this.options[this.selectedIndex].value-0,'+(year-0)+');">';for(var monthCounter=1;monthCounter<=12;monthCounter++){var selected=(monthCounter==month)?'SELECTED':'';result+='<option value="'+monthCounter+'" '+selected+'>'+this.monthNames[monthCounter-1]+'</option>';}result+='</select></TD>';result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="10">&nbsp;</TD>';result+='<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="56" COLSPAN="3"><select CLASS="'+this.cssPrefix+'cpYearNavigation" name="cpYear" onChange="'+refresh+'('+this.index+','+month+',this.options[this.selectedIndex].value-0);">';for(var yearCounter=year-this.yearSelectStartOffset;yearCounter<=year+this.yearSelectStartOffset;yearCounter++){var selected=(yearCounter==year)?'SELECTED':'';result+='<option value="'+yearCounter+'" '+selected+'>'+yearCounter+'</option>';}result+='</select></TD>';}else{if(this.isShowYearNavigation){result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="10"><A CLASS="'+this.cssPrefix+'cpMonthNavigation" HREF="'+refreshLink+'('+this.index+','+last_month+','+last_month_year+');">&lt;</A></TD>';result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="58"><SPAN CLASS="'+this.cssPrefix+'cpMonthNavigation">'+this.monthNames[month-1]+'</SPAN></TD>';result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="10"><A CLASS="'+this.cssPrefix+'cpMonthNavigation" HREF="'+refreshLink+'('+this.index+','+next_month+','+next_month_year+');">&gt;</A></TD>';result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="10">&nbsp;</TD>';result+='<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="10"><A CLASS="'+this.cssPrefix+'cpYearNavigation" HREF="'+refreshLink+'('+this.index+','+month+','+(year-1)+');">&lt;</A></TD>';if(this.isShowYearNavigationInput){result+='<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="36"><INPUT NAME="cpYear" CLASS="'+this.cssPrefix+'cpYearNavigation" SIZE="4" MAXLENGTH="4" VALUE="'+year+'" onBlur="'+refresh+'('+this.index+','+month+',this.value-0);"></TD>';}else{result+='<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="36"><SPAN CLASS="'+this.cssPrefix+'cpYearNavigation">'+year+'</SPAN></TD>';}result+='<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="10"><A CLASS="'+this.cssPrefix+'cpYearNavigation" HREF="'+refreshLink+'('+this.index+','+month+','+(year+1)+');">&gt;</A></TD>';}else{result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="22"><A CLASS="'+this.cssPrefix+'cpMonthNavigation" HREF="'+refreshLink+'('+this.index+','+last_month+','+last_month_year+');">&lt;&lt;</A></TD>\n';result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="100"><SPAN CLASS="'+this.cssPrefix+'cpMonthNavigation">'+this.monthNames[month-1]+' '+year+'</SPAN></TD>\n';result+='<TD CLASS="'+this.cssPrefix+'cpMonthNavigation" WIDTH="22"><A CLASS="'+this.cssPrefix+'cpMonthNavigation" HREF="'+refreshLink+'('+this.index+','+next_month+','+next_month_year+');">&gt;&gt;</A></TD>\n';}}result+='</TR></TABLE>\n';result+='<TABLE WIDTH=120 BORDER=0 CELLSPACING=0 CELLPADDING=1 ALIGN=CENTER>\n';result+='<TR>\n';for(var j=0;j<7;j++){result+='<TD CLASS="'+this.cssPrefix+'cpDayColumnHeader" WIDTH="14%"><SPAN CLASS="'+this.cssPrefix+'cpDayColumnHeader">'+this.dayHeaders[(this.weekStartDay+j)%7]+'</TD>\n';}result+='</TR>\n';for(var row=1;row<=6;row++){result+='<TR>\n';for(var col=1;col<=7;col++){var disabled=false;if(this.disabledDatesExpression!=""){var ds=""+display_year+LZ(display_month)+LZ(display_date);eval("disabled=("+this.disabledDatesExpression+")");}var dateClass="";if((display_month==this.currentDate.getMonth()+1)&&(display_date==this.currentDate.getDate())&&(display_year==this.currentDate.getFullYear())){dateClass="cpCurrentDate";}else if(display_month==month){dateClass="cpCurrentMonthDate";}else{dateClass="cpOtherMonthDate";}if(disabled||this.disabledWeekDays[col-1]){result+='	<TD CLASS="'+this.cssPrefix+dateClass+'"><SPAN CLASS="'+this.cssPrefix+dateClass+'Disabled">'+display_date+'</SPAN></TD>\n';}else{var selected_date=display_date;var selected_month=display_month;var selected_year=display_year;if(this.displayType=="week-end"){var d=new Date(selected_year,selected_month-1,selected_date,0,0,0,0);d.setDate(d.getDate()+(7-col));selected_year=d.getYear();if(selected_year<1000){selected_year+=1900;}selected_month=d.getMonth()+1;selected_date=d.getDate();}result+='	<TD CLASS="'+this.cssPrefix+dateClass+'"><A HREF="javascript:'+windowref+this.returnFunction+'('+selected_year+','+selected_month+','+selected_date+');'+windowref+'CP_hideCalendar(\''+this.index+'\');" CLASS="'+this.cssPrefix+dateClass+'">'+display_date+'</A></TD>\n';}display_date++;if(display_date>daysinmonth[display_month]){display_date=1;display_month++;}if(display_month>12){display_month=1;display_year++;}}result+='</TR>';}var current_weekday=now.getDay()-this.weekStartDay;if(current_weekday<0){current_weekday+=7;}result+='<TR>\n';result+='	<TD COLSPAN=7 ALIGN=CENTER CLASS="'+this.cssPrefix+'cpTodayText">\n';if(this.disabledDatesExpression!=""){var ds=""+now.getFullYear()+LZ(now.getMonth()+1)+LZ(now.getDate());eval("disabled=("+this.disabledDatesExpression+")");}if(disabled||this.disabledWeekDays[current_weekday+1]){result+='		<SPAN CLASS="'+this.cssPrefix+'cpTodayTextDisabled">'+this.todayText+'</SPAN>\n';}else{result+='		<A CLASS="'+this.cssPrefix+'cpTodayText" HREF="javascript:'+windowref+this.returnFunction+'(\''+now.getFullYear()+'\',\''+(now.getMonth()+1)+'\',\''+now.getDate()+'\');'+windowref+'CP_hideCalendar(\''+this.index+'\');">'+this.todayText+'</A>\n';}result+='		<BR>\n';result+='	</TD></TR></TABLE></CENTER></TD></TR></TABLE>\n';}if(this.displayType=="month"||this.displayType=="quarter"||this.displayType=="year"){if(arguments.length>0){var year=arguments[0];}else{if(this.displayType=="year"){var year=now.getFullYear()-this.yearSelectStartOffset;}else{var year=now.getFullYear();}}if(this.displayType!="year"&&this.isShowYearNavigation){result+="<TABLE WIDTH=144 BORDER=0 BORDERWIDTH=0 CELLSPACING=0 CELLPADDING=0>";result+='<TR>\n';result+='	<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="22"><A CLASS="'+this.cssPrefix+'cpYearNavigation" HREF="javascript:'+windowref+'CP_refreshCalendar('+this.index+','+(year-1)+');">&lt;&lt;</A></TD>\n';result+='	<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="100">'+year+'</TD>\n';result+='	<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="22"><A CLASS="'+this.cssPrefix+'cpYearNavigation" HREF="javascript:'+windowref+'CP_refreshCalendar('+this.index+','+(year+1)+');">&gt;&gt;</A></TD>\n';result+='</TR></TABLE>\n';}}if(this.displayType=="month"){result+='<TABLE WIDTH=120 BORDER=0 CELLSPACING=1 CELLPADDING=0 ALIGN=CENTER>\n';for(var i=0;i<4;i++){result+='<TR>';for(var j=0;j<3;j++){var monthindex=((i*3)+j);result+='<TD WIDTH=33% ALIGN=CENTER><A CLASS="'+this.cssPrefix+'cpText" HREF="javascript:'+windowref+this.returnMonthFunction+'('+year+','+(monthindex+1)+');'+windowref+'CP_hideCalendar(\''+this.index+'\');" CLASS="'+date_class+'">'+this.monthAbbreviations[monthindex]+'</A></TD>';}result+='</TR>';}result+='</TABLE></CENTER></TD></TR></TABLE>\n';}if(this.displayType=="quarter"){result+='<BR><TABLE WIDTH=120 BORDER=1 CELLSPACING=0 CELLPADDING=0 ALIGN=CENTER>\n';for(var i=0;i<2;i++){result+='<TR>';for(var j=0;j<2;j++){var quarter=((i*2)+j+1);result+='<TD WIDTH=50% ALIGN=CENTER><BR><A CLASS="'+this.cssPrefix+'cpText" HREF="javascript:'+windowref+this.returnQuarterFunction+'('+year+','+quarter+');'+windowref+'CP_hideCalendar(\''+this.index+'\');" CLASS="'+date_class+'">Q'+quarter+'</A><BR><BR></TD>';}result+='</TR>';}result+='</TABLE></CENTER></TD></TR></TABLE>\n';}if(this.displayType=="year"){var yearColumnSize=4;result+="<TABLE WIDTH=144 BORDER=0 BORDERWIDTH=0 CELLSPACING=0 CELLPADDING=0>";result+='<TR>\n';result+='	<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="50%"><A CLASS="'+this.cssPrefix+'cpYearNavigation" HREF="javascript:'+windowref+'CP_refreshCalendar('+this.index+','+(year-(yearColumnSize*2))+');">&lt;&lt;</A></TD>\n';result+='	<TD CLASS="'+this.cssPrefix+'cpYearNavigation" WIDTH="50%"><A CLASS="'+this.cssPrefix+'cpYearNavigation" HREF="javascript:'+windowref+'CP_refreshCalendar('+this.index+','+(year+(yearColumnSize*2))+');">&gt;&gt;</A></TD>\n';result+='</TR></TABLE>\n';result+='<TABLE WIDTH=120 BORDER=0 CELLSPACING=1 CELLPADDING=0 ALIGN=CENTER>\n';for(var i=0;i<yearColumnSize;i++){for(var j=0;j<2;j++){var currentyear=year+(j*yearColumnSize)+i;result+='<TD WIDTH=50% ALIGN=CENTER><A CLASS="'+this.cssPrefix+'cpText" HREF="javascript:'+windowref+this.returnYearFunction+'('+currentyear+');'+windowref+'CP_hideCalendar(\''+this.index+'\');" CLASS="'+date_class+'">'+currentyear+'</A></TD>';}result+='</TR>';}result+='</TABLE></CENTER></TD></TR></TABLE>\n';}if(this.type=="WINDOW"){result+="</BODY></HTML>\n";}return result;}var now=new Date();now.setDate(now.getDate()-1);var calStartDate=new CalendarPopup();calStartDate.setReturnFunction("setStartDateValues");calStartDate.setWeekStartDay(1);calStartDate.addDisabledDates(null,formatDate(now,"yyyy-MM-dd"));var calEndDate=new CalendarPopup();calEndDate.setReturnFunction("setEndDateValues");function old_getCalForm(){if(document.getElementById("calendarForm"))return document.getElementById("calendarForm");return document.querySelector('.refineBySearchForm');}function getCalForm(){if(document.getElementById("calendarForm"))return document.getElementById("calendarForm");if(document.getElementById("refineBySearchForm_ACCO"))return document.getElementById("refineBySearchForm_ACCO");if(document.getElementById("refineBySearchForm_EVEN"))return document.getElementById("refineBySearchForm_EVEN");if(document.getElementById("refineBySearchForm_ATTR"))return document.getElementById("refineBySearchForm_ATTR");if(document.getElementById("refineBySearchForm_ACTI"))return document.getElementById("refineBySearchForm_ACTI");return document.querySelector('.refineBySearchForm');}function setStartDateValues(y,m,d){var a=getCalForm();a.staydate_year.value=y;a.staydate_month.value=m;a.staydate_day.value=d;}function setEndDateValues(y,m,d){var a=getCalForm();a.enddate_year.value=y;a.enddate_month.value=m;a.enddate_day.value=d;}function getDateString(y_obj,m_obj,d_obj){var y=y_obj.options[y_obj.selectedIndex].value;var m=m_obj.options[m_obj.selectedIndex].value;var d=d_obj.options[d_obj.selectedIndex].value;if(y==""||m==""){return null;}if(d==""){d=1;}return str=y+'-'+m+'-'+d;}function ShowStartDateCalendar(){var elmInput=GetEventSource(this);var name=elmInput.id;var elmsSelects=elmInput.parentNode.getElementsByTagName('select');if(elmsSelects.length>0){iIndexOfUnderscore=elmsSelects[0].name.indexOf('_');field=elmsSelects[0].name.substring(0,iIndexOfUnderscore);}var sId=getCalForm().id;calStartDate.showCalendar(name,eval('getDateString(document.getElementById(\''+sId+'\').'+field+'_year,document.getElementById(\''+sId+'\').'+field+'_month,document.getElementById(\''+sId+'\').'+field+'_day)'));}function ShowEndDateCalendar(){var elmInput=GetEventSource(this);var name=elmInput.id;var elmsSelects=elmInput.parentNode.getElementsByTagName('select');if(elmsSelects.length>0){iIndexOfUnderscore=elmsSelects[0].name.indexOf('_');field=elmsSelects[0].name.substring(0,iIndexOfUnderscore);}var sId=getCalForm().id;calEndDate.showCalendar(name,eval('getDateString(document.getElementById(\''+sId+'\').'+field+'_year,document.getElementById(\''+sId+'\').'+field+'_month,document.getElementById(\''+sId+'\').'+field+'_day)'));}function EviivoUnitSelectInitialise(){if(document.getElementById('EviivoAvailabilityResults')){RoomResultsInputs=document.getElementById('EviivoAvailabilityResults').getElementsByTagName('input');for(var i=0;i<RoomResultsInputs.length;i++){var x=RoomResultsInputs.item(i);if(x.type.toLowerCase()=='checkbox'){AvCalAddEventListener(x,'change',EviivoUnitSelectOnChange);AvCalAddEventListener(x,'click',EviivoUnitSelectOnChange);}}}}function EviivoUnitSelectOnChange(){if(this.name!=''){var o=this;}else{var o=window.event.srcElement;}EviivoUnitCalculateTotal();}function EviivoUnitCalculateTotal(){var total=0;if(document.getElementById('EviivoAvailabilityResults')){RoomResultsInputs=document.getElementById('EviivoAvailabilityResults').getElementsByTagName('input');for(var i=0;i<RoomResultsInputs.length;i++){var x=RoomResultsInputs.item(i);if(x.type.toLowerCase()=='checkbox'){if(x.checked){thisPrice=parseFloat(document.getElementById(x.id+'-price').value)}else{thisPrice=0;}total+=thisPrice;}}}document.getElementById('AvCalTotal').lastChild.data=String.fromCharCode(163)+MakePrice(total);}function AvCalInitialise(){var elmStartDate=document.getElementById('anchorStartDate');if(elmStartDate!=null)AddEventListener(elmStartDate,'click',ShowStartDateCalendar);var elmEndDate=document.getElementById('anchorEndDate');if(elmEndDate!=null)AddEventListener(elmEndDate,'click',ShowEndDateCalendar);$('form#FrmUnitOptions').each(function(index){var $this=$(this);var AvCalSelects=$this.find("select[name*='unit_']");if(AvCalSelects.length>0){AvCalSelects.each(function(){var x=this;AvCalAddEventListener(x,'change',AvCalOnChange);var unitkey=AvCalGetUnit(x,'actual');var unitid=AvCalGetUnit(x,'full');var y=document.getElementById('occu_'+unitid);var z=document.getElementById('occuC_'+unitid);AvCalRenderSelect(x,y);AvCalRenderSelect(x,z);AvCalShowChildAges(z);AvCalAddEventListener(y,'change',AvCalOnChange);AvCalAddEventListener(z,'change',AvCalOnChange);});$this.submit(function(){var iTotalUnits=0;AvCalSelects.each(function(){iTotalUnits=iTotalUnits+parseInt($(this).val(),10);});return(iTotalUnits>0);});}})}function AvCalCheckLinkedUnits(o){if(document.getElementById('FrmUnitOptions')){AvCalSelects=document.getElementById('FrmUnitOptions').getElementsByTagName('select');for(var i=0;i<AvCalSelects.length;i++){var x=AvCalSelects.item(i);if(AvCalGetName(x)=='unit'){if((AvCalGetUnit(o,'full')!=AvCalGetUnit(x,'full'))&&(AvCalGetUnit(o,'linked')==AvCalGetUnit(x,'linked'))){AvCalRenderSelect(o,x);}}}}}function AvCalCalculatePrices(){if(document.getElementById('FrmUnitOptions')){AvCalSelects=document.getElementById('FrmUnitOptions').getElementsByTagName('select');var total=0;for(var i=0;i<AvCalSelects.length;i++){var x=AvCalSelects.item(i);if(AvCalGetName(x)=='unit'){var subtotal=0;var unitid=AvCalGetUnit(x,'full');var unitkey=AvCalGetUnit(x,'actual');var prices=AvCalGetData(unitkey,'prices');var y=document.getElementById('occu_'+unitid);var z=document.getElementById('occuC_'+unitid);if(y){var ad=parseInt(y.value);}else{var ad=0;}if(z){var ch=parseInt(z.value);}else{var ch=0;}for(var j=0;j=prices.length;j++){if(AvCalGetData(unitkey,'basis')=='per per'){subtotal+=prices.shift()*(ad+ch);}else{subtotal+=prices.shift()*x.value;}}total+=subtotal;document.getElementById('data_'+unitkey).parentNode.lastChild.data=String.fromCharCode(163)+MakePrice(subtotal);}}document.getElementById('AvCalTotal').lastChild.data=String.fromCharCode(163)+MakePrice(total);}}function AvCalGetData(unitkey,type){if(document.getElementById('data_'+unitkey)){var data=document.getElementById('data_'+unitkey).value.split(',');if(type=='maxunit'){data=data.slice(0,1);}else if(type=='minocc'){data=data.slice(1,2);if(data==0||data==null)data=1;}else if(type=='maxocc'){data=data.slice(2,3);}else if(type=='basis'){data=data.slice(3,4);}else if(type=='prices'){data=data.slice(4);}return data;}else{return null;}}function AvCalGetName(obj){if(obj){var name=obj.name.substring(0,obj.name.indexOf('_',0));}else{var name=null;}return name;}function AvCalGetUnit(obj,type){if(obj){var unit=obj.name.substring(obj.name.indexOf('_',0)+1,obj.name.length);if(unit.indexOf('_',0)>0){if(type=='actual'){unit=unit.substring(unit.indexOf('_',0)+1,unit.length);}else if(type=='linked'){unit=unit.substring(0,unit.indexOf('_',0));}else if(type=='full'){}}return unit;}else{return null;}}function AvCalChildrenEnabled(obj){if(document.getElementById('occuC_'+AvCalGetUnit(obj,'full'))){return true;}else{return false;}}function AvCalOnChange(){if(!document.all){var o=this;}else{var o=window.event.srcElement;}var unitid=AvCalGetUnit(o,'full');var unitkey=AvCalGetUnit(o,'actual');var x=document.getElementById('unit_'+unitid);var y=document.getElementById('occu_'+unitid);var z=document.getElementById('occuC_'+unitid);if(AvCalGetName(o)=='unit'){AvCalRenderSelect(x,y);AvCalRenderSelect(x,z);}else if(AvCalGetName(o)=='occu'){AvCalRenderSelect(y,z);}else if(AvCalGetName(o)=='occuC'){AvCalRenderSelect(z,y);}AvCalShowChildAges(z);AvCalCalculatePrices();}function AvCalShowChildAges(x){if(document.getElementById('occuC_'+AvCalGetUnit(x,'full')+'_childages')!=null){var o=document.getElementById('occuC_'+AvCalGetUnit(x,'full')+'_childages');var l=o.previousSibling;if(x.value<1){o.className='hidden';l.className='hidden';}else{o.className='';l.className='';}}}function AvCalRenderSelect(o,obj){if(obj){var unitid=AvCalGetUnit(o,'full');var unitkey=AvCalGetUnit(o,'actual');var x=document.getElementById('unit_'+unitid);var y=document.getElementById('occu_'+unitid);var z=document.getElementById('occuC_'+unitid);if(x.value<1){obj.selectedIndex=0;obj.className='hidden';AvCalRemoveOptions(obj);AvCalCreateOptions(obj,0,0);}else{var minOcc=AvCalGetData(unitkey,'minocc');var maxOcc=AvCalGetData(unitkey,'maxocc');var iOldVal=obj.value;obj.className='';if(AvCalChildrenEnabled(x)){if(y){var ad=parseInt(y.value);}else{var ad=0;}if(z){var ch=parseInt(z.value);}else{var ch=0;}if(AvCalGetName(o)=='unit'){var maxVal=x.value*maxOcc;}else if(AvCalGetName(o)=='occu'){var maxVal=x.value*maxOcc-ad;}else if(AvCalGetName(o)=='occuC'){var maxVal=x.value*maxOcc-ch;}AvCalRemoveOptions(obj);AvCalCreateOptions(obj,0,maxVal);}else{AvCalRemoveOptions(obj);AvCalCreateOptions(obj,0,x.value*maxOcc);}for(i=0;i<obj.options.length;++i)if(obj.options[i].value==iOldVal)obj.options[i].selected=true;}}}function AvCalCreateOptions(obj,min,max){for(var i=min;i<=max;i++){AvCalAddOption(obj,i,i);}}function AvCalRemoveOptions(obj){while(obj.firstChild){obj.removeChild(obj.firstChild);}}function AvCalAddOption(obj,val,txt){var o=document.createElement("OPTION");var t=document.createTextNode(txt);o.setAttribute("value",val);o.appendChild(t);obj.appendChild(o);}function AvCalAddEventListener(obj,type,action){if(obj){NewMind.dom.addEventListener(obj,type,action);}}function MakePrice(amount){var i=parseFloat(amount);if(isNaN(i)){i=0.00;}var minus='';if(i<0){minus='-';}i=Math.abs(i);i=parseInt((i+.005)*100);i=i/100;var s=new String(i);if(s.indexOf('.')<0){s+='.00';}if(s.indexOf('.')==(s.length-2)){s+='0';}s=minus+s;return s;}AddEventListener(window,'load',AvCalInitialise);AddEventListener(window,'load',EviivoUnitSelectInitialise);
NewMind.ETWP.DatePicker=function($){(function(){$.datepicker.setDefaults({onClose:function(dateText,inst){$(this).attr("readonly",false);},beforeShow:function(input,inst){$(this).attr("readonly",true);}});}());var callBackEvent=new NewMind.CustomEvent("datePickerInitialised");var DatePickerInit=function(strContainerClass,strInputName){$(document).ready(function(){$('.'+strContainerClass).each(function(iIndex){var $this=$(this);if($this.find(".hasDatepicker").length>0){return;}var strInputID=strInputName;var iNumberOfInitialisedDatePickers=$("input.hasDatepicker").length;if(iNumberOfInitialisedDatePickers>0){strInputID=strInputID+'_'+iNumberOfInitialisedDatePickers;}var strInputAltID="alt_"+strInputID;var iDay=$this.find('select.day').attr('value');var iMonth=$this.find('select.month').attr('value');var iYear=$this.find('select.year').attr('value');var bBlankDate=(!iDay&&!iMonth&&!iYear);var dDefaultDate=new Date(iYear,iMonth-1,iDay);if($this.parents('form.horizontal').length>0){$this.html('<div id="'+strInputID+'"></div><input name="'+strInputName+'" id="'+strInputAltID+'" value="" type="hidden" />');}else{$this.html('<input name="_'+strInputName+'" id="'+strInputID+'" value="" /><input name="'+strInputName+'" id="'+strInputAltID+'" value="" type="hidden" />');}var $datePicker=$this.find('#'+strInputID).datepicker({altField:'#alt_'+strInputID,altFormat:$.datepicker.ATOM,minDate:new Date(),showAnim:""}).datepicker("setDate",dDefaultDate);if(bBlankDate){$datePicker.val("");}$this.find('#'+strInputID).datepicker("option","onSelect",function(){var $thisDP=$(this);var strInputName=$thisDP.attr("name");var oppositeInputName=strInputName==="_isostartdate"?"_isoenddate":"_isostartdate";var $theOtherDP=$thisDP.closest("form").find("[name='"+oppositeInputName+"']");if($theOtherDP.length==0){$theOtherDP=$thisDP.parent().parent().parent().find("[name='"+oppositeInputName+"']");}if($theOtherDP.length>0){var thisDate=$thisDP.datepicker("getDate");var otherDate=$theOtherDP.datepicker("getDate");if(thisDate&&!otherDate){$theOtherDP.datepicker("setDate",thisDate);}else{if((strInputName==="_isostartdate"&&thisDate>otherDate)||(strInputName==="_isoenddate"&&otherDate>thisDate)){$theOtherDP.datepicker("setDate",thisDate);}}}var $dateContainer=$thisDP.parent().find("[name^='iso']");if($dateContainer.length>0){$dateContainer[0].dispatchEvent(new Event('change'));}});$('#ui-datepicker-div').hide();callBackEvent.fire();});});};var DatePickerInitialiseEventsDates=function(){DatePickerInit('calStartDate','isostartdate');DatePickerInit('calEndDate','isoenddate');};var DatePickerInitialiseStartStayDate=function(){DatePickerInit('calStartStayDate','isostartdate');};var DatePickerInitBasic=function(strBasicContainerID,strBasicInputID){$(document).ready(function(){var dBasicCurrentDate;$this=$('#'+strBasicContainerID);if($this.find('select.day').length>0){var iDay=$this.find('select.day').attr('value');var iMonth=$this.find('select.month').attr('value');var iYear=$this.find('select.year').attr('value');dBasicCurrentDate=new Date(iYear,iMonth-1,iDay);}$('#'+strBasicContainerID).html('<input name="_'+strBasicInputID+'" id="'+strBasicInputID+'" /><input name="'+strBasicInputID+'" id="alt_'+strBasicInputID+'" value="" type="hidden" />');$('#'+strBasicInputID).datepicker({altField:'#alt_'+strBasicInputID,altFormat:$.datepicker.ATOM,showAnim:""});if(dBasicCurrentDate>0){$('#'+strBasicInputID).datepicker("setDate",dBasicCurrentDate);}callBackEvent.fire();});};DatePickerInitialiseEventsDates();DatePickerInitialiseStartStayDate();return{Init:function(){DatePickerInitialiseEventsDates();DatePickerInitialiseStartStayDate();},InitBasic:DatePickerInitBasic,CallBackEvent:callBackEvent};}(jQuery);
</script>

</body>
</html>
