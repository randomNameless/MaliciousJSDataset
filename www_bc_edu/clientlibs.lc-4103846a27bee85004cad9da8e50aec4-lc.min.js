/*!
 * bootstrap-select v1.5.4
 * http://silviomoreto.github.io/bootstrap-select/
 *
 * Copyright 2013 bootstrap-select
 * Licensed under the MIT license
 */
;!function(b){b.expr[":"].icontains=function(e,c,d){return b(e).text().toUpperCase().indexOf(d[3].toUpperCase())>=0};var a=function(d,c,f){if(f){f.stopPropagation();f.preventDefault()}this.$element=b(d);this.$newElement=null;this.$button=null;this.$menu=null;this.$lis=null;this.options=b.extend({},b.fn.selectpicker.defaults,this.$element.data(),typeof c=="object"&&c);if(this.options.title===null){this.options.title=this.$element.attr("title")}this.val=a.prototype.val;this.render=a.prototype.render;this.refresh=a.prototype.refresh;this.setStyle=a.prototype.setStyle;this.selectAll=a.prototype.selectAll;this.deselectAll=a.prototype.deselectAll;this.init()};a.prototype={constructor:a,init:function(){var c=this,d=this.$element.attr("id");this.$element.hide();this.multiple=this.$element.prop("multiple");this.autofocus=this.$element.prop("autofocus");this.$newElement=this.createView();this.$element.after(this.$newElement);this.$menu=this.$newElement.find("> .dropdown-menu");this.$button=this.$newElement.find("> button");this.$searchbox=this.$newElement.find("input");if(d!==undefined){this.$button.attr("data-id",d);b('label[for="'+d+'"]').click(function(f){f.preventDefault();c.$button.focus()})}this.checkDisabled();this.clickListener();if(this.options.liveSearch){this.liveSearchListener()}this.render();this.liHeight();this.setStyle();this.setWidth();if(this.options.container){this.selectPosition()}this.$menu.data("this",this);this.$newElement.data("this",this)},createDropdown:function(){var c=this.multiple?" show-tick":"";var d=this.$element.parent().hasClass("input-group")?" input-group-btn":"";var i=this.autofocus?" autofocus":"";var h=this.options.header?'<div class="popover-title"><button type="button" class="close" aria-hidden="true">&times;</button>'+this.options.header+"</div>":"";var g=this.options.liveSearch?'<div class="bootstrap-select-searchbox"><input type="text" class="input-block-level form-control" /></div>':"";var f=this.options.actionsBox?'<div class="bs-actionsbox"><div class="btn-group btn-block"><button class="actions-btn bs-select-all btn btn-sm btn-default">Select All</button><button class="actions-btn bs-deselect-all btn btn-sm btn-default">Deselect All</button></div></div>':"";var e='<div class="btn-group bootstrap-select'+c+d+'"><button type="button" class="btn dropdown-toggle selectpicker" data-toggle="dropdown"'+i+'><span class="filter-option pull-left"></span>&nbsp;<span class="caret"></span></button><div class="dropdown-menu open">'+h+g+f+'<ul class="dropdown-menu inner selectpicker" role="menu"></ul></div></div>';return b(e)},createView:function(){var c=this.createDropdown();var d=this.createLi();c.find("ul").append(d);return c},reloadLi:function(){this.destroyLi();var c=this.createLi();this.$menu.find("ul").append(c)},destroyLi:function(){this.$menu.find("li").remove()},createLi:function(){var d=this,e=[],c="";this.$element.find("option").each(function(){var i=b(this);var g=i.attr("class")||"";var h=i.attr("style")||"";var m=i.data("content")?i.data("content"):i.html();var k=i.data("subtext")!==undefined?'<small class="muted text-muted">'+i.data("subtext")+"</small>":"";var j=i.data("icon")!==undefined?'<i class="'+d.options.iconBase+" "+i.data("icon")+'"></i> ':"";if(j!==""&&(i.is(":disabled")||i.parent().is(":disabled"))){j="<span>"+j+"</span>"}if(!i.data("content")){m=j+'<span class="text">'+m+k+"</span>"}if(d.options.hideDisabled&&(i.is(":disabled")||i.parent().is(":disabled"))){e.push('<a style="min-height: 0; padding: 0"></a>')}else{if(i.parent().is("optgroup")&&i.data("divider")!==true){if(i.index()===0){var l=i.parent().attr("label");var n=i.parent().data("subtext")!==undefined?'<small class="muted text-muted">'+i.parent().data("subtext")+"</small>":"";var f=i.parent().data("icon")?'<i class="'+i.parent().data("icon")+'"></i> ':"";l=f+'<span class="text">'+l+n+"</span>";if(i[0].index!==0){e.push('<div class="div-contain"><div class="divider"></div></div><dt>'+l+"</dt>"+d.createA(m,"opt "+g,h))}else{e.push("<dt>"+l+"</dt>"+d.createA(m,"opt "+g,h))}}else{e.push(d.createA(m,"opt "+g,h))}}else{if(i.data("divider")===true){e.push('<div class="div-contain"><div class="divider"></div></div>')}else{if(b(this).data("hidden")===true){e.push("<a></a>")}else{e.push(d.createA(m,g,h))}}}}});b.each(e,function(g,h){var f=h==="<a></a>"?'class="hide is-hidden"':"";c+='<li rel="'+g+'"'+f+">"+h+"</li>"});if(!this.multiple&&this.$element.find("option:selected").length===0&&!this.options.title){this.$element.find("option").eq(0).prop("selected",true).attr("selected","selected")}return b(c)},createA:function(e,c,d){return'<a tabindex="0" class="'+c+'" style="'+d+'">'+e+'<i class="'+this.options.iconBase+" "+this.options.tickIcon+' icon-ok check-mark"></i></a>'},render:function(e){var d=this;if(e!==false){this.$element.find("option").each(function(i){d.setDisabled(i,b(this).is(":disabled")||b(this).parent().is(":disabled"));d.setSelected(i,b(this).is(":selected"))})}this.tabIndex();var h=this.$element.find("option:selected").map(function(){var k=b(this);var j=k.data("icon")&&d.options.showIcon?'<i class="'+d.options.iconBase+" "+k.data("icon")+'"></i> ':"";var i;if(d.options.showSubtext&&k.attr("data-subtext")&&!d.multiple){i=' <small class="muted text-muted">'+k.data("subtext")+"</small>"}else{i=""}if(k.data("content")&&d.options.showContent){return k.data("content")}else{if(k.attr("title")!==undefined){return k.attr("title")}else{return j+k.html()+i}}}).toArray();var g=!this.multiple?h[0]:h.join(this.options.multipleSeparator);if(this.multiple&&this.options.selectedTextFormat.indexOf("count")>-1){var c=this.options.selectedTextFormat.split(">");var f=this.options.hideDisabled?":not([disabled])":"";if((c.length>1&&h.length>c[1])||(c.length==1&&h.length>=2)){g=this.options.countSelectedText.replace("{0}",h.length).replace("{1}",this.$element.find('option:not([data-divider="true"]):not([data-hidden="true"])'+f).length)}}this.options.title=this.$element.attr("title");if(!g){g=this.options.title!==undefined?this.options.title:this.options.noneSelectedText}this.$button.attr("title",b.trim(g));this.$newElement.find(".filter-option").html(g)},setStyle:function(e,d){if(this.$element.attr("class")){this.$newElement.addClass(this.$element.attr("class").replace(/selectpicker|mobile-device/gi,""))}var c=e?e:this.options.style;if(d=="add"){this.$button.addClass(c)}else{if(d=="remove"){this.$button.removeClass(c)}else{this.$button.removeClass(this.options.style);this.$button.addClass(c)}}},liHeight:function(){if(this.options.size===false){return}var f=this.$menu.parent().clone().find("> .dropdown-toggle").prop("autofocus",false).end().appendTo("body"),g=f.addClass("open").find("> .dropdown-menu"),e=g.find("li > a").outerHeight(),d=this.options.header?g.find(".popover-title").outerHeight():0,h=this.options.liveSearch?g.find(".bootstrap-select-searchbox").outerHeight():0,c=this.options.actionsBox?g.find(".bs-actionsbox").outerHeight():0;f.remove();this.$newElement.data("liHeight",e).data("headerHeight",d).data("searchHeight",h).data("actionsHeight",c)},setSize:function(){var i=this,d=this.$menu,j=d.find(".inner"),u=this.$newElement.outerHeight(),f=this.$newElement.data("liHeight"),s=this.$newElement.data("headerHeight"),m=this.$newElement.data("searchHeight"),h=this.$newElement.data("actionsHeight"),l=d.find("li .divider").outerHeight(true),r=parseInt(d.css("padding-top"))+parseInt(d.css("padding-bottom"))+parseInt(d.css("border-top-width"))+parseInt(d.css("border-bottom-width")),p=this.options.hideDisabled?":not(.disabled)":"",o=b(window),g=r+parseInt(d.css("margin-top"))+parseInt(d.css("margin-bottom"))+2,q,v,t,k=function(){v=i.$newElement.offset().top-o.scrollTop();t=o.height()-v-u};k();if(this.options.header){d.css("padding-top",0)}if(this.options.size=="auto"){var e=function(){var x,w=i.$lis.not(".hide");k();q=t-g;if(i.options.dropupAuto){i.$newElement.toggleClass("dropup",(v>t)&&((q-g)<d.height()))}if(i.$newElement.hasClass("dropup")){q=v-g}if((w.length+w.find("dt").length)>3){x=f*3+g-2}else{x=0}d.css({"max-height":q+"px",overflow:"hidden","min-height":x+s+m+h+"px"});j.css({"max-height":q-s-m-h-r+"px","overflow-y":"auto","min-height":Math.max(x-r,0)+"px"})};e();this.$searchbox.off("input.getSize propertychange.getSize").on("input.getSize propertychange.getSize",e);b(window).off("resize.getSize").on("resize.getSize",e);b(window).off("scroll.getSize").on("scroll.getSize",e)}else{if(this.options.size&&this.options.size!="auto"&&d.find("li"+p).length>this.options.size){var n=d.find("li"+p+" > *").filter(":not(.div-contain)").slice(0,this.options.size).last().parent().index();var c=d.find("li").slice(0,n+1).find(".div-contain").length;q=f*this.options.size+c*l+r;if(i.options.dropupAuto){this.$newElement.toggleClass("dropup",(v>t)&&(q<d.height()))}d.css({"max-height":q+s+m+h+"px",overflow:"hidden"});j.css({"max-height":q-r+"px","overflow-y":"auto"})}}},setWidth:function(){if(this.options.width=="auto"){this.$menu.css("min-width","0");var e=this.$newElement.clone().appendTo("body");var c=e.find("> .dropdown-menu").css("width");var d=e.css("width","auto").find("> button").css("width");e.remove();this.$newElement.css("width",Math.max(parseInt(c),parseInt(d))+"px")}else{if(this.options.width=="fit"){this.$menu.css("min-width","");this.$newElement.css("width","").addClass("fit-width")}else{if(this.options.width){this.$menu.css("min-width","");this.$newElement.css("width",this.options.width)}else{this.$menu.css("min-width","");this.$newElement.css("width","")}}}if(this.$newElement.hasClass("fit-width")&&this.options.width!=="fit"){this.$newElement.removeClass("fit-width")}},selectPosition:function(){var e=this,d="<div />",f=b(d),h,g,c=function(i){f.addClass(i.attr("class").replace(/form-control/gi,"")).toggleClass("dropup",i.hasClass("dropup"));h=i.offset();g=i.hasClass("dropup")?0:i[0].offsetHeight;f.css({top:h.top+g,left:h.left,width:i[0].offsetWidth,position:"absolute"})};this.$newElement.on("click",function(){if(e.isDisabled()){return}c(b(this));f.appendTo(e.options.container);f.toggleClass("open",!b(this).hasClass("open"));f.append(e.$menu)});b(window).resize(function(){c(e.$newElement)});b(window).on("scroll",function(){c(e.$newElement)});b("html").on("click",function(i){if(b(i.target).closest(e.$newElement).length<1){f.removeClass("open")}})},mobile:function(){this.$element.addClass("mobile-device").appendTo(this.$newElement);if(this.options.container){this.$menu.hide()}},refresh:function(){this.$lis=null;this.reloadLi();this.render();this.setWidth();this.setStyle();this.checkDisabled();this.liHeight()},update:function(){this.reloadLi();this.setWidth();this.setStyle();this.checkDisabled();this.liHeight()},setSelected:function(c,d){if(this.$lis==null){this.$lis=this.$menu.find("li")}b(this.$lis[c]).toggleClass("selected",d)},setDisabled:function(c,d){if(this.$lis==null){this.$lis=this.$menu.find("li")}if(d){b(this.$lis[c]).addClass("disabled").find("a").attr("href","#").attr("tabindex",-1)}else{b(this.$lis[c]).removeClass("disabled").find("a").removeAttr("href").attr("tabindex",0)}},isDisabled:function(){return this.$element.is(":disabled")},checkDisabled:function(){var c=this;if(this.isDisabled()){this.$button.addClass("disabled").attr("tabindex",-1)}else{if(this.$button.hasClass("disabled")){this.$button.removeClass("disabled")}if(this.$button.attr("tabindex")==-1){if(!this.$element.data("tabindex")){this.$button.removeAttr("tabindex")}}}this.$button.click(function(){return !c.isDisabled()})},tabIndex:function(){if(this.$element.is("[tabindex]")){this.$element.data("tabindex",this.$element.attr("tabindex"));this.$button.attr("tabindex",this.$element.data("tabindex"))}},clickListener:function(){var c=this;b("body").on("touchstart.dropdown",".dropdown-menu",function(d){d.stopPropagation()});this.$newElement.on("click",function(){c.setSize();if(!c.options.liveSearch&&!c.multiple){setTimeout(function(){c.$menu.find(".selected a").focus()},10)}});this.$menu.on("click","li a",function(n){var t=b(this).parent().index(),m=c.$element.val(),i=c.$element.prop("selectedIndex");if(c.multiple){n.stopPropagation()}n.preventDefault();if(!c.isDisabled()&&!b(this).parent().hasClass("disabled")){var l=c.$element.find("option"),d=l.eq(t),f=d.prop("selected"),r=d.parent("optgroup"),p=c.options.maxOptions,h=r.data("maxOptions")||false;if(!c.multiple){l.prop("selected",false);d.prop("selected",true);c.$menu.find(".selected").removeClass("selected");c.setSelected(t,true)}else{d.prop("selected",!f);c.setSelected(t,!f);if((p!==false)||(h!==false)){var o=p<l.filter(":selected").length,j=h<r.find("option:selected").length,s=c.options.maxOptionsText,g=s[0].replace("{n}",p),q=s[1].replace("{n}",h),k=b('<div class="notify"></div>');if((p&&o)||(h&&j)){if(s[2]){g=g.replace("{var}",s[2][p>1?0:1]);q=q.replace("{var}",s[2][h>1?0:1])}d.prop("selected",false);c.$menu.append(k);if(p&&o){k.append(b("<div>"+g+"</div>"));c.$element.trigger("maxReached.bs.select")}if(h&&j){k.append(b("<div>"+q+"</div>"));c.$element.trigger("maxReachedGrp.bs.select")}setTimeout(function(){c.setSelected(t,false)},10);k.delay(750).fadeOut(300,function(){b(this).remove()})}}}if(!c.multiple){c.$button.focus()}else{if(c.options.liveSearch){c.$searchbox.focus()}}if((m!=c.$element.val()&&c.multiple)||(i!=c.$element.prop("selectedIndex")&&!c.multiple)){c.$element.change()}}});this.$menu.on("click","li.disabled a, li dt, li .div-contain, .popover-title, .popover-title :not(.close)",function(d){if(d.target==this){d.preventDefault();d.stopPropagation();if(!c.options.liveSearch){c.$button.focus()}else{c.$searchbox.focus()}}});this.$menu.on("click",".popover-title .close",function(){c.$button.focus()});this.$searchbox.on("click",function(d){d.stopPropagation()});this.$menu.on("click",".actions-btn",function(d){if(c.options.liveSearch){c.$searchbox.focus()}else{c.$button.focus()}d.preventDefault();d.stopPropagation();if(b(this).is(".bs-select-all")){c.selectAll()}else{c.deselectAll()}c.$element.change()});this.$element.change(function(){c.render(false)})},liveSearchListener:function(){var d=this,c=b('<li class="no-results"></li>');this.$newElement.on("click.dropdown.data-api",function(){d.$menu.find(".active").removeClass("active");if(!!d.$searchbox.val()){d.$searchbox.val("");d.$lis.not(".is-hidden").removeClass("hide");if(!!c.parent().length){c.remove()}}if(!d.multiple){d.$menu.find(".selected").addClass("active")}setTimeout(function(){d.$searchbox.focus()},10)});this.$searchbox.on("input propertychange",function(){if(d.$searchbox.val()){d.$lis.not(".is-hidden").removeClass("hide").find("a").not(":icontains("+d.$searchbox.val()+")").parent().addClass("hide");if(!d.$menu.find("li").filter(":visible:not(.no-results)").length){if(!!c.parent().length){c.remove()}c.html(d.options.noneResultsText+' "'+d.$searchbox.val()+'"').show();d.$menu.find("li").last().after(c)}else{if(!!c.parent().length){c.remove()}}}else{d.$lis.not(".is-hidden").removeClass("hide");if(!!c.parent().length){c.remove()}}d.$menu.find("li.active").removeClass("active");d.$menu.find("li").filter(":visible:not(.divider)").eq(0).addClass("active").find("a").focus();b(this).focus()});this.$menu.on("mouseenter","a",function(f){d.$menu.find(".active").removeClass("active");b(f.currentTarget).parent().not(".disabled").addClass("active")});this.$menu.on("mouseleave","a",function(){d.$menu.find(".active").removeClass("active")})},val:function(c){if(c!==undefined){this.$element.val(c);this.$element.change();return this.$element}else{return this.$element.val()}},selectAll:function(){if(this.$lis==null){this.$lis=this.$menu.find("li")}this.$element.find("option:enabled").prop("selected",true);b(this.$lis).filter(":not(.disabled)").addClass("selected");this.render(false)},deselectAll:function(){if(this.$lis==null){this.$lis=this.$menu.find("li")}this.$element.find("option:enabled").prop("selected",false);b(this.$lis).filter(":not(.disabled)").removeClass("selected");this.render(false)},keydown:function(p){var q,o,i,n,k,j,r,f,h,m,d,s,g={32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"};q=b(this);i=q.parent();if(q.is("input")){i=q.parent().parent()}m=i.data("this");if(m.options.liveSearch){i=q.parent().parent()}if(m.options.container){i=m.$menu}o=b("[role=menu] li:not(.divider) a",i);s=m.$menu.parent().hasClass("open");if(!s&&/([0-9]|[A-z])/.test(String.fromCharCode(p.keyCode))){if(!m.options.container){m.setSize();m.$menu.parent().addClass("open");s=m.$menu.parent().hasClass("open")}else{m.$newElement.trigger("click")}m.$searchbox.focus()}if(m.options.liveSearch){if(/(^9$|27)/.test(p.keyCode)&&s&&m.$menu.find(".active").length===0){p.preventDefault();m.$menu.parent().removeClass("open");m.$button.focus()}o=b("[role=menu] li:not(.divider):visible",i);if(!q.val()&&!/(38|40)/.test(p.keyCode)){if(o.filter(".active").length===0){o=m.$newElement.find("li").filter(":icontains("+g[p.keyCode]+")")}}}if(!o.length){return}if(/(38|40)/.test(p.keyCode)){n=o.index(o.filter(":focus"));j=o.parent(":not(.disabled):visible").first().index();r=o.parent(":not(.disabled):visible").last().index();k=o.eq(n).parent().nextAll(":not(.disabled):visible").eq(0).index();f=o.eq(n).parent().prevAll(":not(.disabled):visible").eq(0).index();h=o.eq(k).parent().prevAll(":not(.disabled):visible").eq(0).index();if(m.options.liveSearch){o.each(function(e){if(b(this).is(":not(.disabled)")){b(this).data("index",e)}});n=o.index(o.filter(".active"));j=o.filter(":not(.disabled):visible").first().data("index");r=o.filter(":not(.disabled):visible").last().data("index");k=o.eq(n).nextAll(":not(.disabled):visible").eq(0).data("index");f=o.eq(n).prevAll(":not(.disabled):visible").eq(0).data("index");h=o.eq(k).prevAll(":not(.disabled):visible").eq(0).data("index")}d=q.data("prevIndex");if(p.keyCode==38){if(m.options.liveSearch){n-=1}if(n!=h&&n>f){n=f}if(n<j){n=j}if(n==d){n=r}}if(p.keyCode==40){if(m.options.liveSearch){n+=1}if(n==-1){n=0}if(n!=h&&n<k){n=k}if(n>r){n=r}if(n==d){n=j}}q.data("prevIndex",n);if(!m.options.liveSearch){o.eq(n).focus()}else{p.preventDefault();if(!q.is(".dropdown-toggle")){o.removeClass("active");o.eq(n).addClass("active").find("a").focus();q.focus()}}}else{if(!q.is("input")){var c=[],l,t;o.each(function(){if(b(this).parent().is(":not(.disabled)")){if(b.trim(b(this).text().toLowerCase()).substring(0,1)==g[p.keyCode]){c.push(b(this).parent().index())}}});l=b(document).data("keycount");l++;b(document).data("keycount",l);t=b.trim(b(":focus").text().toLowerCase()).substring(0,1);if(t!=g[p.keyCode]){l=1;b(document).data("keycount",l)}else{if(l>=c.length){b(document).data("keycount",0);if(l>c.length){l=1}}}o.eq(c[l-1]).focus()}}if(/(13|32|^9$)/.test(p.keyCode)&&s){if(!/(32)/.test(p.keyCode)){p.preventDefault()}if(!m.options.liveSearch){b(":focus").click()}else{if(!/(32)/.test(p.keyCode)){m.$menu.find(".active a").click();q.focus()}}b(document).data("keycount",0)}if((/(^9$|27)/.test(p.keyCode)&&s&&(m.multiple||m.options.liveSearch))||(/(27)/.test(p.keyCode)&&!s)){m.$menu.parent().removeClass("open");m.$button.focus()}},hide:function(){this.$newElement.hide()},show:function(){this.$newElement.show()},destroy:function(){this.$newElement.remove();this.$element.remove()}};b.fn.selectpicker=function(e,f){var c=arguments;var g;var d=this.each(function(){if(b(this).is("select")){var m=b(this),l=m.data("selectpicker"),h=typeof e=="object"&&e;if(!l){m.data("selectpicker",(l=new a(this,h,f)))}else{if(h){for(var j in h){l.options[j]=h[j]}}}if(typeof e=="string"){var k=e;if(l[k] instanceof Function){[].shift.apply(c);g=l[k].apply(l,c)}else{g=l.options[k]}}}});if(g!==undefined){return g}else{return d}};b.fn.selectpicker.defaults={style:"btn-default",size:"auto",title:null,selectedTextFormat:"values",noneSelectedText:"Nothing selected",noneResultsText:"No results match",countSelectedText:"{0} of {1} selected",maxOptionsText:["Limit reached ({n} {var} max)","Group limit reached ({n} {var} max)",["items","item"]],width:false,container:false,hideDisabled:false,showSubtext:false,showIcon:true,showContent:true,dropupAuto:true,header:false,liveSearch:false,actionsBox:false,multipleSeparator:", ",iconBase:"glyphicon",tickIcon:"glyphicon-ok",maxOptions:false};b(document).data("keycount",0).on("keydown",".bootstrap-select [data-toggle=dropdown], .bootstrap-select [role=menu], .bootstrap-select-searchbox input",a.prototype.keydown).on("focusin.modal",".bootstrap-select [data-toggle=dropdown], .bootstrap-select [role=menu], .bootstrap-select-searchbox input",function(c){c.stopPropagation()})}(window.jQuery);
/*
 * From: https://github.com/benschwarz/matchMedia.js/blob/IE7-8/matchMedia.js
 * R2i - Small Modification to currWidth to work in IE8
 *
 */
/*! matchMedia() polyfill - Test a CSS media type/query in JS. Authors & copyright (c) 2012: Scott Jehl, Paul Irish, Nicholas Zakas. Dual MIT/BSD license */
window.matchMedia=window.matchMedia||function(doc,undefined){var docElem=doc.documentElement,refNode=docElem.firstElementChild||docElem.firstChild,fakeBody=doc.createElement("body"),div=doc.createElement("div");div.id="mq-test-1";div.style.cssText="position:absolute;top:-100em";fakeBody.style.background="none";fakeBody.appendChild(div);var mqRun=function(mq){div.innerHTML='&shy;<style media="'+mq+'"> #mq-test-1 { width: 42px; }</style>';docElem.insertBefore(fakeBody,refNode);bool=div.offsetWidth===42;docElem.removeChild(fakeBody);return{matches:bool,media:mq}},getEmValue=function(){var ret,body=docElem.body,fakeUsed=false;div.style.cssText="position:absolute;font-size:1em;width:1em";if(!body){body=fakeUsed=doc.createElement("body");body.style.background="none"}body.appendChild(div);docElem.insertBefore(body,docElem.firstChild);if(fakeUsed){docElem.removeChild(body)}else{body.removeChild(div)}ret=eminpx=parseFloat(div.offsetWidth);return ret},eminpx,mqSupport=mqRun("(min-width: 0px)").matches;return function(mq){if(mqSupport){return mqRun(mq)}else{var min=mq.match(/\(min\-width[\s]*:[\s]*([\s]*[0-9\.]+)(px|em)[\s]*\)/)&&parseFloat(RegExp.$1)+(RegExp.$2||""),max=mq.match(/\(max\-width[\s]*:[\s]*([\s]*[0-9\.]+)(px|em)[\s]*\)/)&&parseFloat(RegExp.$1)+(RegExp.$2||""),minnull=min===null,maxnull=max===null,currWidth=doc.body?doc.body.offsetWidth:0,em="em";if(!!min){min=parseFloat(min)*(min.indexOf(em)>-1?eminpx||getEmValue():1)}if(!!max){max=parseFloat(max)*(max.indexOf(em)>-1?eminpx||getEmValue():1)}bool=(!minnull||!maxnull)&&(minnull||currWidth>=min)&&(maxnull||currWidth<=max);return{matches:bool,media:mq}}}}(document);
/*! jQuery Mobile v1.4.4 | Copyright 2010, 2014 jQuery Foundation, Inc. | jquery.org/license */

(function(e,t,n){typeof define=="function"&&define.amd?define(["jquery"],function(r){return n(r,e,t),r.mobile}):n(e.jQuery,e,t)})(this,document,function(e,t,n,r){(function(e,t,n,r){function T(e){while(e&&typeof e.originalEvent!="undefined")e=e.originalEvent;return e}function N(t,n){var i=t.type,s,o,a,l,c,h,p,d,v;t=e.Event(t),t.type=n,s=t.originalEvent,o=e.event.props,i.search(/^(mouse|click)/)>-1&&(o=f);if(s)for(p=o.length,l;p;)l=o[--p],t[l]=s[l];i.search(/mouse(down|up)|click/)>-1&&!t.which&&(t.which=1);if(i.search(/^touch/)!==-1){a=T(s),i=a.touches,c=a.changedTouches,h=i&&i.length?i[0]:c&&c.length?c[0]:r;if(h)for(d=0,v=u.length;d<v;d++)l=u[d],t[l]=h[l]}return t}function C(t){var n={},r,s;while(t){r=e.data(t,i);for(s in r)r[s]&&(n[s]=n.hasVirtualBinding=!0);t=t.parentNode}return n}function k(t,n){var r;while(t){r=e.data(t,i);if(r&&(!n||r[n]))return t;t=t.parentNode}return null}function L(){g=!1}function A(){g=!0}function O(){E=0,v.length=0,m=!1,A()}function M(){L()}function _(){D(),c=setTimeout(function(){c=0,O()},e.vmouse.resetTimerDuration)}function D(){c&&(clearTimeout(c),c=0)}function P(t,n,r){var i;if(r&&r[t]||!r&&k(n.target,t))i=N(n,t),e(n.target).trigger(i);return i}function H(t){var n=e.data(t.target,s),r;!m&&(!E||E!==n)&&(r=P("v"+t.type,t),r&&(r.isDefaultPrevented()&&t.preventDefault(),r.isPropagationStopped()&&t.stopPropagation(),r.isImmediatePropagationStopped()&&t.stopImmediatePropagation()))}function B(t){var n=T(t).touches,r,i,o;n&&n.length===1&&(r=t.target,i=C(r),i.hasVirtualBinding&&(E=w++,e.data(r,s,E),D(),M(),d=!1,o=T(t).touches[0],h=o.pageX,p=o.pageY,P("vmouseover",t,i),P("vmousedown",t,i)))}function j(e){if(g)return;d||P("vmousecancel",e,C(e.target)),d=!0,_()}function F(t){if(g)return;var n=T(t).touches[0],r=d,i=e.vmouse.moveDistanceThreshold,s=C(t.target);d=d||Math.abs(n.pageX-h)>i||Math.abs(n.pageY-p)>i,d&&!r&&P("vmousecancel",t,s),P("vmousemove",t,s),_()}function I(e){if(g)return;A();var t=C(e.target),n,r;P("vmouseup",e,t),d||(n=P("vclick",e,t),n&&n.isDefaultPrevented()&&(r=T(e).changedTouches[0],v.push({touchID:E,x:r.clientX,y:r.clientY}),m=!0)),P("vmouseout",e,t),d=!1,_()}function q(t){var n=e.data(t,i),r;if(n)for(r in n)if(n[r])return!0;return!1}function R(){}function U(t){var n=t.substr(1);return{setup:function(){q(this)||e.data(this,i,{});var r=e.data(this,i);r[t]=!0,l[t]=(l[t]||0)+1,l[t]===1&&b.bind(n,H),e(this).bind(n,R),y&&(l.touchstart=(l.touchstart||0)+1,l.touchstart===1&&b.bind("touchstart",B).bind("touchend",I).bind("touchmove",F).bind("scroll",j))},teardown:function(){--l[t],l[t]||b.unbind(n,H),y&&(--l.touchstart,l.touchstart||b.unbind("touchstart",B).unbind("touchmove",F).unbind("touchend",I).unbind("scroll",j));var r=e(this),s=e.data(this,i);s&&(s[t]=!1),r.unbind(n,R),q(this)||r.removeData(i)}}}var i="virtualMouseBindings",s="virtualTouchID",o="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),u="clientX clientY pageX pageY screenX screenY".split(" "),a=e.event.mouseHooks?e.event.mouseHooks.props:[],f=e.event.props.concat(a),l={},c=0,h=0,p=0,d=!1,v=[],m=!1,g=!1,y="addEventListener"in n,b=e(n),w=1,E=0,S,x;e.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500};for(x=0;x<o.length;x++)e.event.special[o[x]]=U(o[x]);y&&n.addEventListener("click",function(t){var n=v.length,r=t.target,i,o,u,a,f,l;if(n){i=t.clientX,o=t.clientY,S=e.vmouse.clickDistanceThreshold,u=r;while(u){for(a=0;a<n;a++){f=v[a],l=0;if(u===r&&Math.abs(f.x-i)<S&&Math.abs(f.y-o)<S||e.data(u,s)===f.touchID){t.preventDefault(),t.stopPropagation();return}}u=u.parentNode}}},!0)})(e,t,n),function(e){e.mobile={}}(e),function(e,t){var r={touch:"ontouchend"in n};e.mobile.support=e.mobile.support||{},e.extend(e.support,r),e.extend(e.mobile.support,r)}(e),function(e,t,r){function l(t,n,i,s){var o=i.type;i.type=n,s?e.event.trigger(i,r,t):e.event.dispatch.call(t,i),i.type=o}var i=e(n),s=e.mobile.support.touch,o="touchmove scroll",u=s?"touchstart":"mousedown",a=s?"touchend":"mouseup",f=s?"touchmove":"mousemove";e.each("touchstart touchmove touchend tap taphold swipe swipeleft swiperight scrollstart scrollstop".split(" "),function(t,n){e.fn[n]=function(e){return e?this.bind(n,e):this.trigger(n)},e.attrFn&&(e.attrFn[n]=!0)}),e.event.special.scrollstart={enabled:!0,setup:function(){function s(e,n){r=n,l(t,r?"scrollstart":"scrollstop",e)}var t=this,n=e(t),r,i;n.bind(o,function(t){if(!e.event.special.scrollstart.enabled)return;r||s(t,!0),clearTimeout(i),i=setTimeout(function(){s(t,!1)},50)})},teardown:function(){e(this).unbind(o)}},e.event.special.tap={tapholdThreshold:750,emitTapOnTaphold:!0,setup:function(){var t=this,n=e(t),r=!1;n.bind("vmousedown",function(s){function a(){clearTimeout(u)}function f(){a(),n.unbind("vclick",c).unbind("vmouseup",a),i.unbind("vmousecancel",f)}function c(e){f(),!r&&o===e.target?l(t,"tap",e):r&&e.preventDefault()}r=!1;if(s.which&&s.which!==1)return!1;var o=s.target,u;n.bind("vmouseup",a).bind("vclick",c),i.bind("vmousecancel",f),u=setTimeout(function(){e.event.special.tap.emitTapOnTaphold||(r=!0),l(t,"taphold",e.Event("taphold",{target:o}))},e.event.special.tap.tapholdThreshold)})},teardown:function(){e(this).unbind("vmousedown").unbind("vclick").unbind("vmouseup"),i.unbind("vmousecancel")}},e.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1e3,horizontalDistanceThreshold:30,verticalDistanceThreshold:30,getLocation:function(e){var n=t.pageXOffset,r=t.pageYOffset,i=e.clientX,s=e.clientY;if(e.pageY===0&&Math.floor(s)>Math.floor(e.pageY)||e.pageX===0&&Math.floor(i)>Math.floor(e.pageX))i-=n,s-=r;else if(s<e.pageY-r||i<e.pageX-n)i=e.pageX-n,s=e.pageY-r;return{x:i,y:s}},start:function(t){var n=t.originalEvent.touches?t.originalEvent.touches[0]:t,r=e.event.special.swipe.getLocation(n);return{time:(new Date).getTime(),coords:[r.x,r.y],origin:e(t.target)}},stop:function(t){var n=t.originalEvent.touches?t.originalEvent.touches[0]:t,r=e.event.special.swipe.getLocation(n);return{time:(new Date).getTime(),coords:[r.x,r.y]}},handleSwipe:function(t,n,r,i){if(n.time-t.time<e.event.special.swipe.durationThreshold&&Math.abs(t.coords[0]-n.coords[0])>e.event.special.swipe.horizontalDistanceThreshold&&Math.abs(t.coords[1]-n.coords[1])<e.event.special.swipe.verticalDistanceThreshold){var s=t.coords[0]>n.coords[0]?"swipeleft":"swiperight";return l(r,"swipe",e.Event("swipe",{target:i,swipestart:t,swipestop:n}),!0),l(r,s,e.Event(s,{target:i,swipestart:t,swipestop:n}),!0),!0}return!1},eventInProgress:!1,setup:function(){var t,n=this,r=e(n),s={};t=e.data(this,"mobile-events"),t||(t={length:0},e.data(this,"mobile-events",t)),t.length++,t.swipe=s,s.start=function(t){if(e.event.special.swipe.eventInProgress)return;e.event.special.swipe.eventInProgress=!0;var r,o=e.event.special.swipe.start(t),u=t.target,l=!1;s.move=function(t){if(!o||t.isDefaultPrevented())return;r=e.event.special.swipe.stop(t),l||(l=e.event.special.swipe.handleSwipe(o,r,n,u),l&&(e.event.special.swipe.eventInProgress=!1)),Math.abs(o.coords[0]-r.coords[0])>e.event.special.swipe.scrollSupressionThreshold&&t.preventDefault()},s.stop=function(){l=!0,e.event.special.swipe.eventInProgress=!1,i.off(f,s.move),s.move=null},i.on(f,s.move).one(a,s.stop)},r.on(u,s.start)},teardown:function(){var t,n;t=e.data(this,"mobile-events"),t&&(n=t.swipe,delete t.swipe,t.length--,t.length===0&&e.removeData(this,"mobile-events")),n&&(n.start&&e(this).off(u,n.start),n.move&&i.off(f,n.move),n.stop&&i.off(a,n.stop))}},e.each({scrollstop:"scrollstart",taphold:"tap",swipeleft:"swipe.left",swiperight:"swipe.right"},function(t,n){e.event.special[t]={setup:function(){e(this).bind(n,e.noop)},teardown:function(){e(this).unbind(n)}}})}(e,this)});
(function($){var pl=/\+/g,searchStrict=/([^&=]+)=+([^&]*)/g,searchTolerant=/([^&=]+)=?([^&]*)/g,decode=function(s){return decodeURIComponent(s.replace(pl," "));};$.parseQuery=function(query,options){var match,o={},opts=options||{},search=opts.tolerant?searchTolerant:searchStrict;if('?'===query.substring(0,1)){query=query.substring(1);}while(match=search.exec(query)){o[decode(match[1])]=decode(match[2]);}return o;};$.getQuery=function(options){return $.parseQuery(window.location.search,options);};$.fn.parseQuery=function(options){return $.parseQuery($(this).serialize(),options);};}(jQuery));
/* HTML5 Placeholder jQuery Plugin - v2.1.1
 * Copyright (c)2015 Mathias Bynens
 * 2015-03-11
 */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof module&&module.exports?require("jquery"):jQuery)}(function(a){function b(b){var c={},d=/^jQuery\d+$/;return a.each(b.attributes,function(a,b){b.specified&&!d.test(b.name)&&(c[b.name]=b.value)}),c}function c(b,c){var d=this,f=a(d);if(d.value==f.attr("placeholder")&&f.hasClass(m.customClass))if(f.data("placeholder-password")){if(f=f.hide().nextAll('input[type="password"]:first').show().attr("id",f.removeAttr("id").data("placeholder-id")),b===!0)return f[0].value=c;f.focus()}else d.value="",f.removeClass(m.customClass),d==e()&&d.select()}function d(){var d,e=this,f=a(e),g=this.id;if(""===e.value){if("password"===e.type){if(!f.data("placeholder-textinput")){try{d=f.clone().attr({type:"text"})}catch(h){d=a("<input>").attr(a.extend(b(this),{type:"text"}))}d.removeAttr("name").data({"placeholder-password":f,"placeholder-id":g}).bind("focus.placeholder",c),f.data({"placeholder-textinput":d,"placeholder-id":g}).before(d)}f=f.removeAttr("id").hide().prevAll('input[type="text"]:first').attr("id",g).show()}f.addClass(m.customClass),f[0].value=f.attr("placeholder")}else f.removeClass(m.customClass)}function e(){try{return document.activeElement}catch(a){}}var f,g,h="[object OperaMini]"==Object.prototype.toString.call(window.operamini),i="placeholder"in document.createElement("input")&&!h,j="placeholder"in document.createElement("textarea")&&!h,k=a.valHooks,l=a.propHooks;if(i&&j)g=a.fn.placeholder=function(){return this},g.input=g.textarea=!0;else{var m={};g=a.fn.placeholder=function(b){var e={customClass:"placeholder"};m=a.extend({},e,b);var f=this;return f.filter((i?"textarea":":input")+"[placeholder]").not("."+m.customClass).bind({"focus.placeholder":c,"blur.placeholder":d}).data("placeholder-enabled",!0).trigger("blur.placeholder"),f},g.input=i,g.textarea=j,f={get:function(b){var c=a(b),d=c.data("placeholder-password");return d?d[0].value:c.data("placeholder-enabled")&&c.hasClass(m.customClass)?"":b.value},set:function(b,f){var g=a(b),h=g.data("placeholder-password");return h?h[0].value=f:g.data("placeholder-enabled")?(""===f?(b.value=f,b!=e()&&d.call(b)):g.hasClass(m.customClass)?c.call(b,!0,f)||(b.value=f):b.value=f,g):b.value=f}},i||(k.input=f,l.value=f),j||(k.textarea=f,l.value=f),a(function(){a(document).delegate("form","submit.placeholder",function(){var b=a("."+m.customClass,this).each(c);setTimeout(function(){b.each(d)},10)})}),a(window).bind("beforeunload.placeholder",function(){a("."+m.customClass).each(function(){this.value=""})})}});

/*
 * debouncedresize: special jQuery event that happens once after a window resize
 *
 * latest version and complete README available on Github:
 * https://github.com/louisremi/jquery-smartresize
 *
 * Copyright 2012 @louis_remi
 * Licensed under the MIT license.
 *
 * This saved you an hour of work? 
 * Send me music http://www.amazon.co.uk/wishlist/HNTU0468LQON
 */
(function($){var $event=$.event,$special,resizeTimeout;$special=$event.special.debouncedresize={setup:function(){$(this).on("resize",$special.handler)},teardown:function(){$(this).off("resize",$special.handler)},handler:function(event,execAsap){var context=this,args=arguments,dispatch=function(){event.type="debouncedresize";$event.dispatch.apply(context,args)};if(resizeTimeout){clearTimeout(resizeTimeout)}execAsap?dispatch():resizeTimeout=setTimeout(dispatch,$special.threshold)},threshold:150}})($CQ);
/**
* jquery.matchHeight-min.js v0.5.2
* http://brm.io/jquery-match-height/
* License: MIT
*/
(function(b){var f=-1,e=-1,m=function(a){var d=null,c=[];b(a).each(function(){var a=b(this),h=a.offset().top-g(a.css("margin-top")),k=0<c.length?c[c.length-1]:null;null===k?c.push(a):1>=Math.floor(Math.abs(d-h))?c[c.length-1]=k.add(a):c.push(a);d=h});return c},g=function(b){return parseFloat(b)||0};b.fn.matchHeight=function(a){if("remove"===a){var d=this;this.css("height","");b.each(b.fn.matchHeight._groups,function(b,a){a.elements=a.elements.not(d)});return this}if(1>=this.length)return this;a="undefined"!==
typeof a?a:!0;b.fn.matchHeight._groups.push({elements:this,byRow:a});b.fn.matchHeight._apply(this,a);return this};b.fn.matchHeight._groups=[];b.fn.matchHeight._throttle=80;b.fn.matchHeight._maintainScroll=!1;b.fn.matchHeight._apply=function(a,d){var c=b(a),e=[c],h=b(window).scrollTop(),k=b("html").outerHeight(!0),f=c.parents().filter(":hidden");f.css("display","block");d&&(c.each(function(){var a=b(this),c="inline-block"===a.css("display")?"inline-block":"block";a.data("style-cache",a.attr("style"));
a.css({display:c,"padding-top":"0","padding-bottom":"0","border-top-width":"0","border-bottom-width":"0",height:"100px"})}),e=m(c),c.each(function(){var a=b(this);a.attr("style",a.data("style-cache")||"").css("height","")}));b.each(e,function(a,c){var e=b(c),f=0;d&&1>=e.length||(e.each(function(){var a=b(this),c="inline-block"===a.css("display")?"inline-block":"block";a.css({display:c,height:""});a.outerHeight(!1)>f&&(f=a.outerHeight(!1));a.css("display","")}),e.each(function(){var a=b(this),c=0;
"border-box"!==a.css("box-sizing")&&(c+=g(a.css("border-top-width"))+g(a.css("border-bottom-width")),c+=g(a.css("padding-top"))+g(a.css("padding-bottom")));a.css("height",f-c)}))});f.css("display","");b.fn.matchHeight._maintainScroll&&b(window).scrollTop(h/k*b("html").outerHeight(!0));return this};b.fn.matchHeight._applyDataApi=function(){var a={};b("[data-match-height], [data-mh]").each(function(){var d=b(this),c=d.attr("data-match-height")||d.attr("data-mh");a[c]=c in a?a[c].add(d):d});b.each(a,
function(){this.matchHeight(!0)})};var l=function(){b.each(b.fn.matchHeight._groups,function(){b.fn.matchHeight._apply(this.elements,this.byRow)})};b.fn.matchHeight._update=function(a,d){if(d&&"resize"===d.type){var c=b(window).width();if(c===f)return;f=c}a?-1===e&&(e=setTimeout(function(){l();e=-1},b.fn.matchHeight._throttle)):l()};b(b.fn.matchHeight._applyDataApi);b(window).bind("load",function(a){b.fn.matchHeight._update()});b(window).bind("resize orientationchange",function(a){b.fn.matchHeight._update(!0,
a)})})(jQuery);
/*
 * Adobe Systems Incorporated
 * Modified: October 30th, 2012
 *
 * Picturefill - Responsive Images that work today. (and mimic the proposed Picture element with divs).
 * Author: Scott Jehl, Filament Group, 2012 | License: MIT/GPLv2
 */
jQuery.fn.picturefill=function(){$("div[data-picture]",$(this[0])).each(function(){var currentPicture=this;var matches=[];$("div[data-media]",currentPicture).each(function(){var media=$(this).attr("data-media");if(!media||window.matchMedia&&window.matchMedia(media).matches){matches.push(this)}});var $picImg=$("img",currentPicture).first();if(matches.length){if($picImg.size()===0){var $currentPicture=$(currentPicture);$picImg=$("<img />").attr("alt",$currentPicture.attr("data-alt")).appendTo($currentPicture)}$picImg.attr("src",matches.pop().getAttribute("data-src"))}else{$picImg.remove()}})};$(function(){$("body").picturefill()});$(window).on("debouncedresize",function(){$("body").picturefill()});
/**
 * Owl Carousel v2.2.0
 * Copyright 2013-2016 David Deutsch
 * Licensed under MIT (https://github.com/OwlCarousel2/OwlCarousel2/blob/master/LICENSE)
 */
!function(a,b,c,d){function e(b,c){this.settings=null,this.options=a.extend({},e.Defaults,c),this.$element=a(b),this._handlers={},this._plugins={},this._supress={},this._current=null,this._speed=null,this._coordinates=[],this._breakpoint=null,this._width=null,this._items=[],this._clones=[],this._mergers=[],this._widths=[],this._invalidated={},this._pipe=[],this._drag={time:null,target:null,pointer:null,stage:{start:null,current:null},direction:null},this._states={current:{},tags:{initializing:["busy"],animating:["busy"],dragging:["interacting"]}},a.each(["onResize","onThrottledResize"],a.proxy(function(b,c){this._handlers[c]=a.proxy(this[c],this)},this)),a.each(e.Plugins,a.proxy(function(a,b){this._plugins[a.charAt(0).toLowerCase()+a.slice(1)]=new b(this)},this)),a.each(e.Workers,a.proxy(function(b,c){this._pipe.push({filter:c.filter,run:a.proxy(c.run,this)})},this)),this.setup(),this.initialize()}e.Defaults={items:3,loop:!1,center:!1,rewind:!1,mouseDrag:!0,touchDrag:!0,pullDrag:!0,freeDrag:!1,margin:0,stagePadding:0,merge:!1,mergeFit:!0,autoWidth:!1,startPosition:0,rtl:!1,smartSpeed:250,fluidSpeed:!1,dragEndSpeed:!1,responsive:{},responsiveRefreshRate:100,responsiveBaseElement:b,fallbackEasing:"swing",info:!1,nestedItemSelector:!1,itemElement:"div",stageElement:"div",refreshClass:"owl-refresh",loadedClass:"owl-loaded",loadingClass:"owl-loading",rtlClass:"owl-rtl",responsiveClass:"owl-responsive",dragClass:"owl-drag",itemClass:"owl-item",stageClass:"owl-stage",stageOuterClass:"owl-stage-outer",grabClass:"owl-grab"},e.Width={Default:"default",Inner:"inner",Outer:"outer"},e.Type={Event:"event",State:"state"},e.Plugins={},e.Workers=[{filter:["width","settings"],run:function(){this._width=this.$element.width()}},{filter:["width","items","settings"],run:function(a){a.current=this._items&&this._items[this.relative(this._current)]}},{filter:["items","settings"],run:function(){this.$stage.children(".cloned").remove()}},{filter:["width","items","settings"],run:function(a){var b=this.settings.margin||"",c=!this.settings.autoWidth,d=this.settings.rtl,e={width:"auto","margin-left":d?b:"","margin-right":d?"":b};!c&&this.$stage.children().css(e),a.css=e}},{filter:["width","items","settings"],run:function(a){var b=(this.width()/this.settings.items).toFixed(3)-this.settings.margin,c=null,d=this._items.length,e=!this.settings.autoWidth,f=[];for(a.items={merge:!1,width:b};d--;)c=this._mergers[d],c=this.settings.mergeFit&&Math.min(c,this.settings.items)||c,a.items.merge=c>1||a.items.merge,f[d]=e?b*c:this._items[d].width();this._widths=f}},{filter:["items","settings"],run:function(){var b=[],c=this._items,d=this.settings,e=Math.max(2*d.items,4),f=2*Math.ceil(c.length/2),g=d.loop&&c.length?d.rewind?e:Math.max(e,f):0,h="",i="";for(g/=2;g--;)b.push(this.normalize(b.length/2,!0)),h+=c[b[b.length-1]][0].outerHTML,b.push(this.normalize(c.length-1-(b.length-1)/2,!0)),i=c[b[b.length-1]][0].outerHTML+i;this._clones=b,a(h).addClass("cloned").appendTo(this.$stage),a(i).addClass("cloned").prependTo(this.$stage)}},{filter:["width","items","settings"],run:function(){for(var a=this.settings.rtl?1:-1,b=this._clones.length+this._items.length,c=-1,d=0,e=0,f=[];++c<b;)d=f[c-1]||0,e=this._widths[this.relative(c)]+this.settings.margin,f.push(d+e*a);this._coordinates=f}},{filter:["width","items","settings"],run:function(){var a=this.settings.stagePadding,b=this._coordinates,c={width:Math.ceil(Math.abs(b[b.length-1]))+2*a,"padding-left":a||"","padding-right":a||""};this.$stage.css(c)}},{filter:["width","items","settings"],run:function(a){var b=this._coordinates.length,c=!this.settings.autoWidth,d=this.$stage.children();if(c&&a.items.merge)for(;b--;)a.css.width=this._widths[this.relative(b)],d.eq(b).css(a.css);else c&&(a.css.width=a.items.width,d.css(a.css))}},{filter:["items"],run:function(){this._coordinates.length<1&&this.$stage.removeAttr("style")}},{filter:["width","items","settings"],run:function(a){a.current=a.current?this.$stage.children().index(a.current):0,a.current=Math.max(this.minimum(),Math.min(this.maximum(),a.current)),this.reset(a.current)}},{filter:["position"],run:function(){this.animate(this.coordinates(this._current))}},{filter:["width","position","items","settings"],run:function(){var a,b,c,d,e=this.settings.rtl?1:-1,f=2*this.settings.stagePadding,g=this.coordinates(this.current())+f,h=g+this.width()*e,i=[];for(c=0,d=this._coordinates.length;d>c;c++)a=this._coordinates[c-1]||0,b=Math.abs(this._coordinates[c])+f*e,(this.op(a,"<=",g)&&this.op(a,">",h)||this.op(b,"<",g)&&this.op(b,">",h))&&i.push(c);this.$stage.children(".active").removeClass("active"),this.$stage.children(":eq("+i.join("), :eq(")+")").addClass("active"),this.settings.center&&(this.$stage.children(".center").removeClass("center"),this.$stage.children().eq(this.current()).addClass("center"))}}],e.prototype.initialize=function(){if(this.enter("initializing"),this.trigger("initialize"),this.$element.toggleClass(this.settings.rtlClass,this.settings.rtl),this.settings.autoWidth&&!this.is("pre-loading")){var b,c,e;b=this.$element.find("img"),c=this.settings.nestedItemSelector?"."+this.settings.nestedItemSelector:d,e=this.$element.children(c).width(),b.length&&0>=e&&this.preloadAutoWidthImages(b)}this.$element.addClass(this.options.loadingClass),this.$stage=a("<"+this.settings.stageElement+' class="'+this.settings.stageClass+'"/>').wrap('<div class="'+this.settings.stageOuterClass+'"/>'),this.$element.append(this.$stage.parent()),this.replace(this.$element.children().not(this.$stage.parent())),this.$element.is(":visible")?this.refresh():this.invalidate("width"),this.$element.removeClass(this.options.loadingClass).addClass(this.options.loadedClass),this.registerEventHandlers(),this.leave("initializing"),this.trigger("initialized")},e.prototype.setup=function(){var b=this.viewport(),c=this.options.responsive,d=-1,e=null;c?(a.each(c,function(a){b>=a&&a>d&&(d=Number(a))}),e=a.extend({},this.options,c[d]),"function"==typeof e.stagePadding&&(e.stagePadding=e.stagePadding()),delete e.responsive,e.responsiveClass&&this.$element.attr("class",this.$element.attr("class").replace(new RegExp("("+this.options.responsiveClass+"-)\\S+\\s","g"),"$1"+d))):e=a.extend({},this.options),this.trigger("change",{property:{name:"settings",value:e}}),this._breakpoint=d,this.settings=e,this.invalidate("settings"),this.trigger("changed",{property:{name:"settings",value:this.settings}})},e.prototype.optionsLogic=function(){this.settings.autoWidth&&(this.settings.stagePadding=!1,this.settings.merge=!1)},e.prototype.prepare=function(b){var c=this.trigger("prepare",{content:b});return c.data||(c.data=a("<"+this.settings.itemElement+"/>").addClass(this.options.itemClass).append(b)),this.trigger("prepared",{content:c.data}),c.data},e.prototype.update=function(){for(var b=0,c=this._pipe.length,d=a.proxy(function(a){return this[a]},this._invalidated),e={};c>b;)(this._invalidated.all||a.grep(this._pipe[b].filter,d).length>0)&&this._pipe[b].run(e),b++;this._invalidated={},!this.is("valid")&&this.enter("valid")},e.prototype.width=function(a){switch(a=a||e.Width.Default){case e.Width.Inner:case e.Width.Outer:return this._width;default:return this._width-2*this.settings.stagePadding+this.settings.margin}},e.prototype.refresh=function(){this.enter("refreshing"),this.trigger("refresh"),this.setup(),this.optionsLogic(),this.$element.addClass(this.options.refreshClass),this.update(),this.$element.removeClass(this.options.refreshClass),this.leave("refreshing"),this.trigger("refreshed")},e.prototype.onThrottledResize=function(){b.clearTimeout(this.resizeTimer),this.resizeTimer=b.setTimeout(this._handlers.onResize,this.settings.responsiveRefreshRate)},e.prototype.onResize=function(){return this._items.length?this._width===this.$element.width()?!1:this.$element.is(":visible")?(this.enter("resizing"),this.trigger("resize").isDefaultPrevented()?(this.leave("resizing"),!1):(this.invalidate("width"),this.refresh(),this.leave("resizing"),void this.trigger("resized"))):!1:!1},e.prototype.registerEventHandlers=function(){a.support.transition&&this.$stage.on(a.support.transition.end+".owl.core",a.proxy(this.onTransitionEnd,this)),this.settings.responsive!==!1&&this.on(b,"resize",this._handlers.onThrottledResize),this.settings.mouseDrag&&(this.$element.addClass(this.options.dragClass),this.$stage.on("mousedown.owl.core",a.proxy(this.onDragStart,this)),this.$stage.on("dragstart.owl.core selectstart.owl.core",function(){return!1})),this.settings.touchDrag&&(this.$stage.on("touchstart.owl.core",a.proxy(this.onDragStart,this)),this.$stage.on("touchcancel.owl.core",a.proxy(this.onDragEnd,this)))},e.prototype.onDragStart=function(b){var d=null;3!==b.which&&(a.support.transform?(d=this.$stage.css("transform").replace(/.*\(|\)| /g,"").split(","),d={x:d[16===d.length?12:4],y:d[16===d.length?13:5]}):(d=this.$stage.position(),d={x:this.settings.rtl?d.left+this.$stage.width()-this.width()+this.settings.margin:d.left,y:d.top}),this.is("animating")&&(a.support.transform?this.animate(d.x):this.$stage.stop(),this.invalidate("position")),this.$element.toggleClass(this.options.grabClass,"mousedown"===b.type),this.speed(0),this._drag.time=(new Date).getTime(),this._drag.target=a(b.target),this._drag.stage.start=d,this._drag.stage.current=d,this._drag.pointer=this.pointer(b),a(c).on("mouseup.owl.core touchend.owl.core",a.proxy(this.onDragEnd,this)),a(c).one("mousemove.owl.core touchmove.owl.core",a.proxy(function(b){var d=this.difference(this._drag.pointer,this.pointer(b));a(c).on("mousemove.owl.core touchmove.owl.core",a.proxy(this.onDragMove,this)),Math.abs(d.x)<Math.abs(d.y)&&this.is("valid")||(b.preventDefault(),this.enter("dragging"),this.trigger("drag"))},this)))},e.prototype.onDragMove=function(a){var b=null,c=null,d=null,e=this.difference(this._drag.pointer,this.pointer(a)),f=this.difference(this._drag.stage.start,e);this.is("dragging")&&(a.preventDefault(),this.settings.loop?(b=this.coordinates(this.minimum()),c=this.coordinates(this.maximum()+1)-b,f.x=((f.x-b)%c+c)%c+b):(b=this.settings.rtl?this.coordinates(this.maximum()):this.coordinates(this.minimum()),c=this.settings.rtl?this.coordinates(this.minimum()):this.coordinates(this.maximum()),d=this.settings.pullDrag?-1*e.x/5:0,f.x=Math.max(Math.min(f.x,b+d),c+d)),this._drag.stage.current=f,this.animate(f.x))},e.prototype.onDragEnd=function(b){var d=this.difference(this._drag.pointer,this.pointer(b)),e=this._drag.stage.current,f=d.x>0^this.settings.rtl?"left":"right";a(c).off(".owl.core"),this.$element.removeClass(this.options.grabClass),(0!==d.x&&this.is("dragging")||!this.is("valid"))&&(this.speed(this.settings.dragEndSpeed||this.settings.smartSpeed),this.current(this.closest(e.x,0!==d.x?f:this._drag.direction)),this.invalidate("position"),this.update(),this._drag.direction=f,(Math.abs(d.x)>3||(new Date).getTime()-this._drag.time>300)&&this._drag.target.one("click.owl.core",function(){return!1})),this.is("dragging")&&(this.leave("dragging"),this.trigger("dragged"))},e.prototype.closest=function(b,c){var d=-1,e=30,f=this.width(),g=this.coordinates();return this.settings.freeDrag||a.each(g,a.proxy(function(a,h){return"left"===c&&b>h-e&&h+e>b?d=a:"right"===c&&b>h-f-e&&h-f+e>b?d=a+1:this.op(b,"<",h)&&this.op(b,">",g[a+1]||h-f)&&(d="left"===c?a+1:a),-1===d},this)),this.settings.loop||(this.op(b,">",g[this.minimum()])?d=b=this.minimum():this.op(b,"<",g[this.maximum()])&&(d=b=this.maximum())),d},e.prototype.animate=function(b){var c=this.speed()>0;this.is("animating")&&this.onTransitionEnd(),c&&(this.enter("animating"),this.trigger("translate")),a.support.transform3d&&a.support.transition?this.$stage.css({transform:"translate3d("+b+"px,0px,0px)",transition:this.speed()/1e3+"s"}):c?this.$stage.animate({left:b+"px"},this.speed(),this.settings.fallbackEasing,a.proxy(this.onTransitionEnd,this)):this.$stage.css({left:b+"px"})},e.prototype.is=function(a){return this._states.current[a]&&this._states.current[a]>0},e.prototype.current=function(a){if(a===d)return this._current;if(0===this._items.length)return d;if(a=this.normalize(a),this._current!==a){var b=this.trigger("change",{property:{name:"position",value:a}});b.data!==d&&(a=this.normalize(b.data)),this._current=a,this.invalidate("position"),this.trigger("changed",{property:{name:"position",value:this._current}})}return this._current},e.prototype.invalidate=function(b){return"string"===a.type(b)&&(this._invalidated[b]=!0,this.is("valid")&&this.leave("valid")),a.map(this._invalidated,function(a,b){return b})},e.prototype.reset=function(a){a=this.normalize(a),a!==d&&(this._speed=0,this._current=a,this.suppress(["translate","translated"]),this.animate(this.coordinates(a)),this.release(["translate","translated"]))},e.prototype.normalize=function(a,b){var c=this._items.length,e=b?0:this._clones.length;return!this.isNumeric(a)||1>c?a=d:(0>a||a>=c+e)&&(a=((a-e/2)%c+c)%c+e/2),a},e.prototype.relative=function(a){return a-=this._clones.length/2,this.normalize(a,!0)},e.prototype.maximum=function(a){var b,c,d,e=this.settings,f=this._coordinates.length;if(e.loop)f=this._clones.length/2+this._items.length-1;else if(e.autoWidth||e.merge){for(b=this._items.length,c=this._items[--b].width(),d=this.$element.width();b--&&(c+=this._items[b].width()+this.settings.margin,!(c>d)););f=b+1}else f=e.center?this._items.length-1:this._items.length-e.items;return a&&(f-=this._clones.length/2),Math.max(f,0)},e.prototype.minimum=function(a){return a?0:this._clones.length/2},e.prototype.items=function(a){return a===d?this._items.slice():(a=this.normalize(a,!0),this._items[a])},e.prototype.mergers=function(a){return a===d?this._mergers.slice():(a=this.normalize(a,!0),this._mergers[a])},e.prototype.clones=function(b){var c=this._clones.length/2,e=c+this._items.length,f=function(a){return a%2===0?e+a/2:c-(a+1)/2};return b===d?a.map(this._clones,function(a,b){return f(b)}):a.map(this._clones,function(a,c){return a===b?f(c):null})},e.prototype.speed=function(a){return a!==d&&(this._speed=a),this._speed},e.prototype.coordinates=function(b){var c,e=1,f=b-1;return b===d?a.map(this._coordinates,a.proxy(function(a,b){return this.coordinates(b)},this)):(this.settings.center?(this.settings.rtl&&(e=-1,f=b+1),c=this._coordinates[b],c+=(this.width()-c+(this._coordinates[f]||0))/2*e):c=this._coordinates[f]||0,c=Math.ceil(c))},e.prototype.duration=function(a,b,c){return 0===c?0:Math.min(Math.max(Math.abs(b-a),1),6)*Math.abs(c||this.settings.smartSpeed)},e.prototype.to=function(a,b){var c=this.current(),d=null,e=a-this.relative(c),f=(e>0)-(0>e),g=this._items.length,h=this.minimum(),i=this.maximum();this.settings.loop?(!this.settings.rewind&&Math.abs(e)>g/2&&(e+=-1*f*g),a=c+e,d=((a-h)%g+g)%g+h,d!==a&&i>=d-e&&d-e>0&&(c=d-e,a=d,this.reset(c))):this.settings.rewind?(i+=1,a=(a%i+i)%i):a=Math.max(h,Math.min(i,a)),this.speed(this.duration(c,a,b)),this.current(a),this.$element.is(":visible")&&this.update()},e.prototype.next=function(a){a=a||!1,this.to(this.relative(this.current())+1,a)},e.prototype.prev=function(a){a=a||!1,this.to(this.relative(this.current())-1,a)},e.prototype.onTransitionEnd=function(a){return a!==d&&(a.stopPropagation(),(a.target||a.srcElement||a.originalTarget)!==this.$stage.get(0))?!1:(this.leave("animating"),void this.trigger("translated"))},e.prototype.viewport=function(){var d;if(this.options.responsiveBaseElement!==b)d=a(this.options.responsiveBaseElement).width();else if(b.innerWidth)d=b.innerWidth;else{if(!c.documentElement||!c.documentElement.clientWidth)throw"Can not detect viewport width.";d=c.documentElement.clientWidth}return d},e.prototype.replace=function(b){this.$stage.empty(),this._items=[],b&&(b=b instanceof jQuery?b:a(b)),this.settings.nestedItemSelector&&(b=b.find("."+this.settings.nestedItemSelector)),b.filter(function(){return 1===this.nodeType}).each(a.proxy(function(a,b){b=this.prepare(b),this.$stage.append(b),this._items.push(b),this._mergers.push(1*b.find("[data-merge]").addBack("[data-merge]").attr("data-merge")||1)},this)),this.reset(this.isNumeric(this.settings.startPosition)?this.settings.startPosition:0),this.invalidate("items")},e.prototype.add=function(b,c){var e=this.relative(this._current);c=c===d?this._items.length:this.normalize(c,!0),b=b instanceof jQuery?b:a(b),this.trigger("add",{content:b,position:c}),b=this.prepare(b),0===this._items.length||c===this._items.length?(0===this._items.length&&this.$stage.append(b),0!==this._items.length&&this._items[c-1].after(b),this._items.push(b),this._mergers.push(1*b.find("[data-merge]").addBack("[data-merge]").attr("data-merge")||1)):(this._items[c].before(b),this._items.splice(c,0,b),this._mergers.splice(c,0,1*b.find("[data-merge]").addBack("[data-merge]").attr("data-merge")||1)),this._items[e]&&this.reset(this._items[e].index()),this.invalidate("items"),this.trigger("added",{content:b,position:c})},e.prototype.remove=function(a){a=this.normalize(a,!0),a!==d&&(this.trigger("remove",{content:this._items[a],position:a}),this._items[a].remove(),this._items.splice(a,1),this._mergers.splice(a,1),this.invalidate("items"),this.trigger("removed",{content:null,position:a}))},e.prototype.preloadAutoWidthImages=function(b){b.each(a.proxy(function(b,c){this.enter("pre-loading"),c=a(c),a(new Image).one("load",a.proxy(function(a){c.attr("src",a.target.src),c.css("opacity",1),this.leave("pre-loading"),!this.is("pre-loading")&&!this.is("initializing")&&this.refresh()},this)).attr("src",c.attr("src")||c.attr("data-src")||c.attr("data-src-retina"))},this))},e.prototype.destroy=function(){this.$element.off(".owl.core"),this.$stage.off(".owl.core"),a(c).off(".owl.core"),this.settings.responsive!==!1&&(b.clearTimeout(this.resizeTimer),this.off(b,"resize",this._handlers.onThrottledResize));for(var d in this._plugins)this._plugins[d].destroy();this.$stage.children(".cloned").remove(),this.$stage.unwrap(),this.$stage.children().contents().unwrap(),this.$stage.children().unwrap(),this.$element.removeClass(this.options.refreshClass).removeClass(this.options.loadingClass).removeClass(this.options.loadedClass).removeClass(this.options.rtlClass).removeClass(this.options.dragClass).removeClass(this.options.grabClass).attr("class",this.$element.attr("class").replace(new RegExp(this.options.responsiveClass+"-\\S+\\s","g"),"")).removeData("owl.carousel")},e.prototype.op=function(a,b,c){var d=this.settings.rtl;switch(b){case"<":return d?a>c:c>a;case">":return d?c>a:a>c;case">=":return d?c>=a:a>=c;case"<=":return d?a>=c:c>=a}},e.prototype.on=function(a,b,c,d){a.addEventListener?a.addEventListener(b,c,d):a.attachEvent&&a.attachEvent("on"+b,c)},e.prototype.off=function(a,b,c,d){a.removeEventListener?a.removeEventListener(b,c,d):a.detachEvent&&a.detachEvent("on"+b,c)},e.prototype.trigger=function(b,c,d,f,g){var h={item:{count:this._items.length,index:this.current()}},i=a.camelCase(a.grep(["on",b,d],function(a){return a}).join("-").toLowerCase()),j=a.Event([b,"owl",d||"carousel"].join(".").toLowerCase(),a.extend({relatedTarget:this},h,c));return this._supress[b]||(a.each(this._plugins,function(a,b){b.onTrigger&&b.onTrigger(j)}),this.register({type:e.Type.Event,name:b}),this.$element.trigger(j),this.settings&&"function"==typeof this.settings[i]&&this.settings[i].call(this,j)),j},e.prototype.enter=function(b){a.each([b].concat(this._states.tags[b]||[]),a.proxy(function(a,b){this._states.current[b]===d&&(this._states.current[b]=0),this._states.current[b]++},this))},e.prototype.leave=function(b){a.each([b].concat(this._states.tags[b]||[]),a.proxy(function(a,b){this._states.current[b]--},this))},e.prototype.register=function(b){if(b.type===e.Type.Event){if(a.event.special[b.name]||(a.event.special[b.name]={}),!a.event.special[b.name].owl){var c=a.event.special[b.name]._default;a.event.special[b.name]._default=function(a){return!c||!c.apply||a.namespace&&-1!==a.namespace.indexOf("owl")?a.namespace&&a.namespace.indexOf("owl")>-1:c.apply(this,arguments)},a.event.special[b.name].owl=!0}}else b.type===e.Type.State&&(this._states.tags[b.name]?this._states.tags[b.name]=this._states.tags[b.name].concat(b.tags):this._states.tags[b.name]=b.tags,this._states.tags[b.name]=a.grep(this._states.tags[b.name],a.proxy(function(c,d){return a.inArray(c,this._states.tags[b.name])===d},this)))},e.prototype.suppress=function(b){a.each(b,a.proxy(function(a,b){this._supress[b]=!0},this))},e.prototype.release=function(b){a.each(b,a.proxy(function(a,b){delete this._supress[b]},this))},e.prototype.pointer=function(a){var c={x:null,y:null};return a=a.originalEvent||a||b.event,a=a.touches&&a.touches.length?a.touches[0]:a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:a,a.pageX?(c.x=a.pageX,c.y=a.pageY):(c.x=a.clientX,c.y=a.clientY),c},e.prototype.isNumeric=function(a){return!isNaN(parseFloat(a))},e.prototype.difference=function(a,b){return{x:a.x-b.x,y:a.y-b.y}},a.fn.owlCarousel=function(b){var c=Array.prototype.slice.call(arguments,1);return this.each(function(){var d=a(this),f=d.data("owl.carousel");f||(f=new e(this,"object"==typeof b&&b),d.data("owl.carousel",f),a.each(["next","prev","to","destroy","refresh","replace","add","remove"],function(b,c){f.register({type:e.Type.Event,name:c}),f.$element.on(c+".owl.carousel.core",a.proxy(function(a){a.namespace&&a.relatedTarget!==this&&(this.suppress([c]),f[c].apply(this,[].slice.call(arguments,1)),this.release([c]))},f))})),"string"==typeof b&&"_"!==b.charAt(0)&&f[b].apply(f,c)})},a.fn.owlCarousel.Constructor=e}(window.Zepto||window.jQuery,window,document),function(a,b,c,d){var e=function(b){this._core=b,this._interval=null,this._visible=null,this._handlers={"initialized.owl.carousel":a.proxy(function(a){a.namespace&&this._core.settings.autoRefresh&&this.watch()},this)},this._core.options=a.extend({},e.Defaults,this._core.options),this._core.$element.on(this._handlers)};e.Defaults={autoRefresh:!0,autoRefreshInterval:500},e.prototype.watch=function(){this._interval||(this._visible=this._core.$element.is(":visible"),this._interval=b.setInterval(a.proxy(this.refresh,this),this._core.settings.autoRefreshInterval))},e.prototype.refresh=function(){this._core.$element.is(":visible")!==this._visible&&(this._visible=!this._visible,this._core.$element.toggleClass("owl-hidden",!this._visible),this._visible&&this._core.invalidate("width")&&this._core.refresh())},e.prototype.destroy=function(){var a,c;b.clearInterval(this._interval);for(a in this._handlers)this._core.$element.off(a,this._handlers[a]);for(c in Object.getOwnPropertyNames(this))"function"!=typeof this[c]&&(this[c]=null)},a.fn.owlCarousel.Constructor.Plugins.AutoRefresh=e}(window.Zepto||window.jQuery,window,document),function(a,b,c,d){var e=function(b){this._core=b,this._loaded=[],this._handlers={"initialized.owl.carousel change.owl.carousel resized.owl.carousel":a.proxy(function(b){if(b.namespace&&this._core.settings&&this._core.settings.lazyLoad&&(b.property&&"position"==b.property.name||"initialized"==b.type))for(var c=this._core.settings,e=c.center&&Math.ceil(c.items/2)||c.items,f=c.center&&-1*e||0,g=(b.property&&b.property.value!==d?b.property.value:this._core.current())+f,h=this._core.clones().length,i=a.proxy(function(a,b){this.load(b)},this);f++<e;)this.load(h/2+this._core.relative(g)),h&&a.each(this._core.clones(this._core.relative(g)),i),g++},this)},this._core.options=a.extend({},e.Defaults,this._core.options),this._core.$element.on(this._handlers)};e.Defaults={lazyLoad:!1},e.prototype.load=function(c){var d=this._core.$stage.children().eq(c),e=d&&d.find(".owl-lazy");!e||a.inArray(d.get(0),this._loaded)>-1||(e.each(a.proxy(function(c,d){var e,f=a(d),g=b.devicePixelRatio>1&&f.attr("data-src-retina")||f.attr("data-src");this._core.trigger("load",{element:f,url:g},"lazy"),f.is("img")?f.one("load.owl.lazy",a.proxy(function(){f.css("opacity",1),this._core.trigger("loaded",{element:f,url:g},"lazy")},this)).attr("src",g):(e=new Image,e.onload=a.proxy(function(){f.css({"background-image":"url("+g+")",opacity:"1"}),this._core.trigger("loaded",{element:f,url:g},"lazy")},this),e.src=g)},this)),this._loaded.push(d.get(0)))},e.prototype.destroy=function(){var a,b;for(a in this.handlers)this._core.$element.off(a,this.handlers[a]);for(b in Object.getOwnPropertyNames(this))"function"!=typeof this[b]&&(this[b]=null)},a.fn.owlCarousel.Constructor.Plugins.Lazy=e}(window.Zepto||window.jQuery,window,document),function(a,b,c,d){var e=function(b){this._core=b,this._handlers={"initialized.owl.carousel refreshed.owl.carousel":a.proxy(function(a){a.namespace&&this._core.settings.autoHeight&&this.update()},this),"changed.owl.carousel":a.proxy(function(a){a.namespace&&this._core.settings.autoHeight&&"position"==a.property.name&&this.update()},this),"loaded.owl.lazy":a.proxy(function(a){a.namespace&&this._core.settings.autoHeight&&a.element.closest("."+this._core.settings.itemClass).index()===this._core.current()&&this.update()},this)},this._core.options=a.extend({},e.Defaults,this._core.options),this._core.$element.on(this._handlers)};e.Defaults={autoHeight:!1,autoHeightClass:"owl-height"},e.prototype.update=function(){var b=this._core._current,c=b+this._core.settings.items,d=this._core.$stage.children().toArray().slice(b,c),e=[],f=0;a.each(d,function(b,c){e.push(a(c).height())}),f=Math.max.apply(null,e),this._core.$stage.parent().height(f).addClass(this._core.settings.autoHeightClass)},e.prototype.destroy=function(){var a,b;for(a in this._handlers)this._core.$element.off(a,this._handlers[a]);for(b in Object.getOwnPropertyNames(this))"function"!=typeof this[b]&&(this[b]=null)},a.fn.owlCarousel.Constructor.Plugins.AutoHeight=e}(window.Zepto||window.jQuery,window,document),function(a,b,c,d){var e=function(b){this._core=b,this._videos={},this._playing=null,this._handlers={"initialized.owl.carousel":a.proxy(function(a){a.namespace&&this._core.register({type:"state",name:"playing",tags:["interacting"]})},this),"resize.owl.carousel":a.proxy(function(a){a.namespace&&this._core.settings.video&&this.isInFullScreen()&&a.preventDefault()},this),"refreshed.owl.carousel":a.proxy(function(a){a.namespace&&this._core.is("resizing")&&this._core.$stage.find(".cloned .owl-video-frame").remove()},this),"changed.owl.carousel":a.proxy(function(a){a.namespace&&"position"===a.property.name&&this._playing&&this.stop()},this),"prepared.owl.carousel":a.proxy(function(b){if(b.namespace){var c=a(b.content).find(".owl-video");c.length&&(c.css("display","none"),this.fetch(c,a(b.content)))}},this)},this._core.options=a.extend({},e.Defaults,this._core.options),this._core.$element.on(this._handlers),this._core.$element.on("click.owl.video",".owl-video-play-icon",a.proxy(function(a){this.play(a)},this))};e.Defaults={video:!1,videoHeight:!1,videoWidth:!1},e.prototype.fetch=function(a,b){var c=function(){return a.attr("data-vimeo-id")?"vimeo":a.attr("data-vzaar-id")?"vzaar":"youtube"}(),d=a.attr("data-vimeo-id")||a.attr("data-youtube-id")||a.attr("data-vzaar-id"),e=a.attr("data-width")||this._core.settings.videoWidth,f=a.attr("data-height")||this._core.settings.videoHeight,g=a.attr("href");if(!g)throw new Error("Missing video URL.");if(d=g.match(/(http:|https:|)\/\/(player.|www.|app.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com)|vzaar\.com)\/(video\/|videos\/|embed\/|channels\/.+\/|groups\/.+\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/),d[3].indexOf("youtu")>-1)c="youtube";else if(d[3].indexOf("vimeo")>-1)c="vimeo";else{if(!(d[3].indexOf("vzaar")>-1))throw new Error("Video URL not supported.");c="vzaar"}d=d[6],this._videos[g]={type:c,id:d,width:e,height:f},b.attr("data-video",g),this.thumbnail(a,this._videos[g])},e.prototype.thumbnail=function(b,c){var d,e,f,g=c.width&&c.height?'style="width:'+c.width+"px;height:"+c.height+'px;"':"",h=b.find("img"),i="src",j="",k=this._core.settings,l=function(a){e='<div class="owl-video-play-icon"></div>',d=k.lazyLoad?'<div class="owl-video-tn '+j+'" '+i+'="'+a+'"></div>':'<div class="owl-video-tn" style="opacity:1;background-image:url('+a+')"></div>',b.after(d),b.after(e)};return b.wrap('<div class="owl-video-wrapper"'+g+"></div>"),this._core.settings.lazyLoad&&(i="data-src",j="owl-lazy"),h.length?(l(h.attr(i)),h.remove(),!1):void("youtube"===c.type?(f="//img.youtube.com/vi/"+c.id+"/hqdefault.jpg",l(f)):"vimeo"===c.type?a.ajax({type:"GET",url:"//vimeo.com/api/v2/video/"+c.id+".json",jsonp:"callback",dataType:"jsonp",success:function(a){f=a[0].thumbnail_large,l(f)}}):"vzaar"===c.type&&a.ajax({type:"GET",url:"//vzaar.com/api/videos/"+c.id+".json",jsonp:"callback",dataType:"jsonp",success:function(a){f=a.framegrab_url,l(f)}}))},e.prototype.stop=function(){this._core.trigger("stop",null,"video"),this._playing.find(".owl-video-frame").remove(),this._playing.removeClass("owl-video-playing"),this._playing=null,this._core.leave("playing"),this._core.trigger("stopped",null,"video")},e.prototype.play=function(b){var c,d=a(b.target),e=d.closest("."+this._core.settings.itemClass),f=this._videos[e.attr("data-video")],g=f.width||"100%",h=f.height||this._core.$stage.height();this._playing||(this._core.enter("playing"),this._core.trigger("play",null,"video"),e=this._core.items(this._core.relative(e.index())),this._core.reset(e.index()),"youtube"===f.type?c='<iframe width="'+g+'" height="'+h+'" src="//www.youtube.com/embed/'+f.id+"?autoplay=1&v="+f.id+'" frameborder="0" allowfullscreen></iframe>':"vimeo"===f.type?c='<iframe src="//player.vimeo.com/video/'+f.id+'?autoplay=1" width="'+g+'" height="'+h+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>':"vzaar"===f.type&&(c='<iframe frameborder="0"height="'+h+'"width="'+g+'" allowfullscreen mozallowfullscreen webkitAllowFullScreen src="//view.vzaar.com/'+f.id+'/player?autoplay=true"></iframe>'),a('<div class="owl-video-frame">'+c+"</div>").insertAfter(e.find(".owl-video")),this._playing=e.addClass("owl-video-playing"))},e.prototype.isInFullScreen=function(){var b=c.fullscreenElement||c.mozFullScreenElement||c.webkitFullscreenElement;return b&&a(b).parent().hasClass("owl-video-frame")},e.prototype.destroy=function(){var a,b;this._core.$element.off("click.owl.video");for(a in this._handlers)this._core.$element.off(a,this._handlers[a]);for(b in Object.getOwnPropertyNames(this))"function"!=typeof this[b]&&(this[b]=null)},a.fn.owlCarousel.Constructor.Plugins.Video=e}(window.Zepto||window.jQuery,window,document),function(a,b,c,d){var e=function(b){this.core=b,this.core.options=a.extend({},e.Defaults,this.core.options),this.swapping=!0,this.previous=d,this.next=d,this.handlers={"change.owl.carousel":a.proxy(function(a){a.namespace&&"position"==a.property.name&&(this.previous=this.core.current(),this.next=a.property.value)},this),"drag.owl.carousel dragged.owl.carousel translated.owl.carousel":a.proxy(function(a){a.namespace&&(this.swapping="translated"==a.type)},this),"translate.owl.carousel":a.proxy(function(a){a.namespace&&this.swapping&&(this.core.options.animateOut||this.core.options.animateIn)&&this.swap()},this)},this.core.$element.on(this.handlers)};e.Defaults={animateOut:!1,animateIn:!1},e.prototype.swap=function(){if(1===this.core.settings.items&&a.support.animation&&a.support.transition){this.core.speed(0);var b,c=a.proxy(this.clear,this),d=this.core.$stage.children().eq(this.previous),e=this.core.$stage.children().eq(this.next),f=this.core.settings.animateIn,g=this.core.settings.animateOut;this.core.current()!==this.previous&&(g&&(b=this.core.coordinates(this.previous)-this.core.coordinates(this.next),d.one(a.support.animation.end,c).css({left:b+"px"}).addClass("animated owl-animated-out").addClass(g)),f&&e.one(a.support.animation.end,c).addClass("animated owl-animated-in").addClass(f))}},e.prototype.clear=function(b){a(b.target).css({left:""}).removeClass("animated owl-animated-out owl-animated-in").removeClass(this.core.settings.animateIn).removeClass(this.core.settings.animateOut),this.core.onTransitionEnd()},e.prototype.destroy=function(){var a,b;for(a in this.handlers)this.core.$element.off(a,this.handlers[a]);for(b in Object.getOwnPropertyNames(this))"function"!=typeof this[b]&&(this[b]=null);
},a.fn.owlCarousel.Constructor.Plugins.Animate=e}(window.Zepto||window.jQuery,window,document),function(a,b,c,d){var e=function(b){this._core=b,this._timeout=null,this._paused=!1,this._handlers={"changed.owl.carousel":a.proxy(function(a){a.namespace&&"settings"===a.property.name?this._core.settings.autoplay?this.play():this.stop():a.namespace&&"position"===a.property.name&&this._core.settings.autoplay&&this._setAutoPlayInterval()},this),"initialized.owl.carousel":a.proxy(function(a){a.namespace&&this._core.settings.autoplay&&this.play()},this),"play.owl.autoplay":a.proxy(function(a,b,c){a.namespace&&this.play(b,c)},this),"stop.owl.autoplay":a.proxy(function(a){a.namespace&&this.stop()},this),"mouseover.owl.autoplay":a.proxy(function(){this._core.settings.autoplayHoverPause&&this._core.is("rotating")&&this.pause()},this),"mouseleave.owl.autoplay":a.proxy(function(){this._core.settings.autoplayHoverPause&&this._core.is("rotating")&&this.play()},this),"touchstart.owl.core":a.proxy(function(){this._core.settings.autoplayHoverPause&&this._core.is("rotating")&&this.pause()},this),"touchend.owl.core":a.proxy(function(){this._core.settings.autoplayHoverPause&&this.play()},this)},this._core.$element.on(this._handlers),this._core.options=a.extend({},e.Defaults,this._core.options)};e.Defaults={autoplay:!1,autoplayTimeout:5e3,autoplayHoverPause:!1,autoplaySpeed:!1},e.prototype.play=function(a,b){this._paused=!1,this._core.is("rotating")||(this._core.enter("rotating"),this._setAutoPlayInterval())},e.prototype._getNextTimeout=function(d,e){return this._timeout&&b.clearTimeout(this._timeout),b.setTimeout(a.proxy(function(){this._paused||this._core.is("busy")||this._core.is("interacting")||c.hidden||this._core.next(e||this._core.settings.autoplaySpeed)},this),d||this._core.settings.autoplayTimeout)},e.prototype._setAutoPlayInterval=function(){this._timeout=this._getNextTimeout()},e.prototype.stop=function(){this._core.is("rotating")&&(b.clearTimeout(this._timeout),this._core.leave("rotating"))},e.prototype.pause=function(){this._core.is("rotating")&&(this._paused=!0)},e.prototype.destroy=function(){var a,b;this.stop();for(a in this._handlers)this._core.$element.off(a,this._handlers[a]);for(b in Object.getOwnPropertyNames(this))"function"!=typeof this[b]&&(this[b]=null)},a.fn.owlCarousel.Constructor.Plugins.autoplay=e}(window.Zepto||window.jQuery,window,document),function(a,b,c,d){"use strict";var e=function(b){this._core=b,this._initialized=!1,this._pages=[],this._controls={},this._templates=[],this.$element=this._core.$element,this._overrides={next:this._core.next,prev:this._core.prev,to:this._core.to},this._handlers={"prepared.owl.carousel":a.proxy(function(b){b.namespace&&this._core.settings.dotsData&&this._templates.push('<div class="'+this._core.settings.dotClass+'">'+a(b.content).find("[data-dot]").addBack("[data-dot]").attr("data-dot")+"</div>")},this),"added.owl.carousel":a.proxy(function(a){a.namespace&&this._core.settings.dotsData&&this._templates.splice(a.position,0,this._templates.pop())},this),"remove.owl.carousel":a.proxy(function(a){a.namespace&&this._core.settings.dotsData&&this._templates.splice(a.position,1)},this),"changed.owl.carousel":a.proxy(function(a){a.namespace&&"position"==a.property.name&&this.draw()},this),"initialized.owl.carousel":a.proxy(function(a){a.namespace&&!this._initialized&&(this._core.trigger("initialize",null,"navigation"),this.initialize(),this.update(),this.draw(),this._initialized=!0,this._core.trigger("initialized",null,"navigation"))},this),"refreshed.owl.carousel":a.proxy(function(a){a.namespace&&this._initialized&&(this._core.trigger("refresh",null,"navigation"),this.update(),this.draw(),this._core.trigger("refreshed",null,"navigation"))},this)},this._core.options=a.extend({},e.Defaults,this._core.options),this.$element.on(this._handlers)};e.Defaults={nav:!1,navText:["prev","next"],navSpeed:!1,navElement:"div",navContainer:!1,navContainerClass:"owl-nav",navClass:["owl-prev","owl-next"],slideBy:1,dotClass:"owl-dot",dotsClass:"owl-dots",dots:!0,dotsEach:!1,dotsData:!1,dotsSpeed:!1,dotsContainer:!1},e.prototype.initialize=function(){var b,c=this._core.settings;this._controls.$relative=(c.navContainer?a(c.navContainer):a("<div>").addClass(c.navContainerClass).appendTo(this.$element)).addClass("disabled"),this._controls.$previous=a("<"+c.navElement+">").addClass(c.navClass[0]).html(c.navText[0]).prependTo(this._controls.$relative).on("click",a.proxy(function(a){this.prev(c.navSpeed)},this)),this._controls.$next=a("<"+c.navElement+">").addClass(c.navClass[1]).html(c.navText[1]).appendTo(this._controls.$relative).on("click",a.proxy(function(a){this.next(c.navSpeed)},this)),c.dotsData||(this._templates=[a("<div>").addClass(c.dotClass).append(a("<span>")).prop("outerHTML")]),this._controls.$absolute=(c.dotsContainer?a(c.dotsContainer):a("<div>").addClass(c.dotsClass).appendTo(this.$element)).addClass("disabled"),this._controls.$absolute.on("click","div",a.proxy(function(b){var d=a(b.target).parent().is(this._controls.$absolute)?a(b.target).index():a(b.target).parent().index();b.preventDefault(),this.to(d,c.dotsSpeed)},this));for(b in this._overrides)this._core[b]=a.proxy(this[b],this)},e.prototype.destroy=function(){var a,b,c,d;for(a in this._handlers)this.$element.off(a,this._handlers[a]);for(b in this._controls)this._controls[b].remove();for(d in this.overides)this._core[d]=this._overrides[d];for(c in Object.getOwnPropertyNames(this))"function"!=typeof this[c]&&(this[c]=null)},e.prototype.update=function(){var a,b,c,d=this._core.clones().length/2,e=d+this._core.items().length,f=this._core.maximum(!0),g=this._core.settings,h=g.center||g.autoWidth||g.dotsData?1:g.dotsEach||g.items;if("page"!==g.slideBy&&(g.slideBy=Math.min(g.slideBy,g.items)),g.dots||"page"==g.slideBy)for(this._pages=[],a=d,b=0,c=0;e>a;a++){if(b>=h||0===b){if(this._pages.push({start:Math.min(f,a-d),end:a-d+h-1}),Math.min(f,a-d)===f)break;b=0,++c}b+=this._core.mergers(this._core.relative(a))}},e.prototype.draw=function(){var b,c=this._core.settings,d=this._core.items().length<=c.items,e=this._core.relative(this._core.current()),f=c.loop||c.rewind;this._controls.$relative.toggleClass("disabled",!c.nav||d),c.nav&&(this._controls.$previous.toggleClass("disabled",!f&&e<=this._core.minimum(!0)),this._controls.$next.toggleClass("disabled",!f&&e>=this._core.maximum(!0))),this._controls.$absolute.toggleClass("disabled",!c.dots||d),c.dots&&(b=this._pages.length-this._controls.$absolute.children().length,c.dotsData&&0!==b?this._controls.$absolute.html(this._templates.join("")):b>0?this._controls.$absolute.append(new Array(b+1).join(this._templates[0])):0>b&&this._controls.$absolute.children().slice(b).remove(),this._controls.$absolute.find(".active").removeClass("active"),this._controls.$absolute.children().eq(a.inArray(this.current(),this._pages)).addClass("active"))},e.prototype.onTrigger=function(b){var c=this._core.settings;b.page={index:a.inArray(this.current(),this._pages),count:this._pages.length,size:c&&(c.center||c.autoWidth||c.dotsData?1:c.dotsEach||c.items)}},e.prototype.current=function(){var b=this._core.relative(this._core.current());return a.grep(this._pages,a.proxy(function(a,c){return a.start<=b&&a.end>=b},this)).pop()},e.prototype.getPosition=function(b){var c,d,e=this._core.settings;return"page"==e.slideBy?(c=a.inArray(this.current(),this._pages),d=this._pages.length,b?++c:--c,c=this._pages[(c%d+d)%d].start):(c=this._core.relative(this._core.current()),d=this._core.items().length,b?c+=e.slideBy:c-=e.slideBy),c},e.prototype.next=function(b){a.proxy(this._overrides.to,this._core)(this.getPosition(!0),b)},e.prototype.prev=function(b){a.proxy(this._overrides.to,this._core)(this.getPosition(!1),b)},e.prototype.to=function(b,c,d){var e;!d&&this._pages.length?(e=this._pages.length,a.proxy(this._overrides.to,this._core)(this._pages[(b%e+e)%e].start,c)):a.proxy(this._overrides.to,this._core)(b,c)},a.fn.owlCarousel.Constructor.Plugins.Navigation=e}(window.Zepto||window.jQuery,window,document),function(a,b,c,d){"use strict";var e=function(c){this._core=c,this._hashes={},this.$element=this._core.$element,this._handlers={"initialized.owl.carousel":a.proxy(function(c){c.namespace&&"URLHash"===this._core.settings.startPosition&&a(b).trigger("hashchange.owl.navigation")},this),"prepared.owl.carousel":a.proxy(function(b){if(b.namespace){var c=a(b.content).find("[data-hash]").addBack("[data-hash]").attr("data-hash");if(!c)return;this._hashes[c]=b.content}},this),"changed.owl.carousel":a.proxy(function(c){if(c.namespace&&"position"===c.property.name){var d=this._core.items(this._core.relative(this._core.current())),e=a.map(this._hashes,function(a,b){return a===d?b:null}).join();if(!e||b.location.hash.slice(1)===e)return;b.location.hash=e}},this)},this._core.options=a.extend({},e.Defaults,this._core.options),this.$element.on(this._handlers),a(b).on("hashchange.owl.navigation",a.proxy(function(a){var c=b.location.hash.substring(1),e=this._core.$stage.children(),f=this._hashes[c]&&e.index(this._hashes[c]);f!==d&&f!==this._core.current()&&this._core.to(this._core.relative(f),!1,!0)},this))};e.Defaults={URLhashListener:!1},e.prototype.destroy=function(){var c,d;a(b).off("hashchange.owl.navigation");for(c in this._handlers)this._core.$element.off(c,this._handlers[c]);for(d in Object.getOwnPropertyNames(this))"function"!=typeof this[d]&&(this[d]=null)},a.fn.owlCarousel.Constructor.Plugins.Hash=e}(window.Zepto||window.jQuery,window,document),function(a,b,c,d){function e(b,c){var e=!1,f=b.charAt(0).toUpperCase()+b.slice(1);return a.each((b+" "+h.join(f+" ")+f).split(" "),function(a,b){return g[b]!==d?(e=c?b:!0,!1):void 0}),e}function f(a){return e(a,!0)}var g=a("<support>").get(0).style,h="Webkit Moz O ms".split(" "),i={transition:{end:{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"}},animation:{end:{WebkitAnimation:"webkitAnimationEnd",MozAnimation:"animationend",OAnimation:"oAnimationEnd",animation:"animationend"}}},j={csstransforms:function(){return!!e("transform")},csstransforms3d:function(){return!!e("perspective")},csstransitions:function(){return!!e("transition")},cssanimations:function(){return!!e("animation")}};j.csstransitions()&&(a.support.transition=new String(f("transition")),a.support.transition.end=i.transition.end[a.support.transition]),j.cssanimations()&&(a.support.animation=new String(f("animation")),a.support.animation.end=i.animation.end[a.support.animation]),j.csstransforms()&&(a.support.transform=new String(f("transform")),a.support.transform3d=j.csstransforms3d())}(window.Zepto||window.jQuery,window,document);
/*
 * backgroundSize: A jQuery cssHook adding support for "cover" and "contain" to IE6,7,8
 *
 * Requirements:
 * - jQuery 1.7.0+
 *
 * Limitations:
 * - doesn't work with multiple backgrounds (use the :after trick)
 * - doesn't work with the "4 values syntax" of background-position
 * - doesn't work with lengths in background-position (only percentages and keywords)
 * - doesn't work with "background-repeat: repeat;"
 * - doesn't work with non-default values of background-clip/origin/attachment/scroll
 * - you should still test your website in IE!
 *
 * latest version and complete README available on Github:
 * https://github.com/louisremi/jquery.backgroundSize.js
 *
 * Copyright 2012 @louis_remi
 * Licensed under the MIT license.
 *
 * This saved you an hour of work?
 * Send me music http://www.amazon.co.uk/wishlist/HNTU0468LQON
 *
 */
(function($,window,document,Math,undefined){var div=$("<div>")[0],rsrc=/url\(["']?(.*?)["']?\)/,watched=[],positions={top:0,left:0,bottom:1,right:1,center:.5};if("backgroundSize"in div.style&&!$.debugBGS){return}$.cssHooks.backgroundSize={set:function(elem,value){var firstTime=!$.data(elem,"bgsImg"),pos,$wrapper,$img;$.data(elem,"bgsValue",value);if(firstTime){watched.push(elem);$.refreshBackgroundDimensions(elem,true);$wrapper=$("<div>").css({position:"absolute",zIndex:-1,top:0,right:0,left:0,bottom:0,overflow:"hidden"});$img=$("<img>").css({position:"absolute"}).appendTo($wrapper),$wrapper.prependTo(elem);$.data(elem,"bgsImg",$img[0]);pos=($.css(elem,"backgroundPosition")||$.css(elem,"backgroundPositionX")+" "+$.css(elem,"backgroundPositionY")).split(" ");$.data(elem,"bgsPos",[positions[pos[0]]||parseFloat(pos[0])/100,positions[pos[1]]||parseFloat(pos[1])/100]);$.css(elem,"zIndex")=="auto"&&(elem.style.zIndex=0);$.css(elem,"position")=="static"&&(elem.style.position="relative");$.refreshBackgroundImage(elem)}else{$.refreshBackground(elem)}},get:function(elem){return $.data(elem,"bgsValue")||""}};$.cssHooks.backgroundImage={set:function(elem,value){return $.data(elem,"bgsImg")?$.refreshBackgroundImage(elem,value):value}};$.refreshBackgroundDimensions=function(elem,noBgRefresh){var $elem=$(elem),currDim={width:$elem.innerWidth(),height:$elem.innerHeight()},prevDim=$.data(elem,"bgsDim"),changed=!prevDim||currDim.width!=prevDim.width||currDim.height!=prevDim.height;$.data(elem,"bgsDim",currDim);if(changed&&!noBgRefresh){$.refreshBackground(elem)}};$.refreshBackgroundImage=function(elem,value){var img=$.data(elem,"bgsImg"),currSrc=(rsrc.exec(value||$.css(elem,"backgroundImage"))||[])[1],prevSrc=img&&img.src,changed=currSrc!=prevSrc,imgWidth,imgHeight;if(changed){img.style.height=img.style.width="auto";img.onload=function(){var dim={width:img.width,height:img.height};if(dim.width==1&&dim.height==1){return}$.data(elem,"bgsImgDim",dim);$.data(elem,"bgsConstrain",false);$.refreshBackground(elem);img.style.visibility="visible";img.onload=null};img.style.visibility="hidden";img.src=currSrc;if(img.readyState||img.complete){img.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";img.src=currSrc}elem.style.backgroundImage="none"}};$.refreshBackground=function(elem){var value=$.data(elem,"bgsValue"),elemDim=$.data(elem,"bgsDim"),imgDim=$.data(elem,"bgsImgDim"),$img=$($.data(elem,"bgsImg")),pos=$.data(elem,"bgsPos"),prevConstrain=$.data(elem,"bgsConstrain"),currConstrain,elemRatio=elemDim.width/elemDim.height,imgRatio=imgDim.width/imgDim.height,delta;if(value=="contain"){if(imgRatio>elemRatio){$.data(elem,"bgsConstrain",currConstrain="width");delta=Math.floor((elemDim.height-elemDim.width/imgRatio)*pos[1]);$img.css({top:delta});if(currConstrain!=prevConstrain){$img.css({width:"100%",height:"auto",left:0})}}else{$.data(elem,"bgsConstrain",currConstrain="height");delta=Math.floor((elemDim.width-elemDim.height*imgRatio)*pos[0]);$img.css({left:delta});if(currConstrain!=prevConstrain){$img.css({height:"100%",width:"auto",top:0})}}}else if(value=="cover"){if(imgRatio>elemRatio){$.data(elem,"bgsConstrain",currConstrain="height");delta=Math.floor((elemDim.height*imgRatio-elemDim.width)*pos[0]);$img.css({left:-delta});if(currConstrain!=prevConstrain){$img.css({height:"100%",width:"auto",top:0})}}else{$.data(elem,"bgsConstrain",currConstrain="width");delta=Math.floor((elemDim.width/imgRatio-elemDim.height)*pos[1]);$img.css({top:-delta});if(currConstrain!=prevConstrain){$img.css({width:"100%",height:"auto",left:0})}}}};var $event=$.event,$special,dummy={_:0},frame=0,wasResized,animRunning;$special=$event.special.throttledresize={setup:function(){$(this).on("resize",$special.handler)},teardown:function(){$(this).off("resize",$special.handler)},handler:function(event,execAsap){var context=this,args=arguments;wasResized=true;if(!animRunning){$(dummy).animate(dummy,{duration:Infinity,step:function(){frame++;if(frame>$special.threshold&&wasResized||execAsap){event.type="throttledresize";$event.dispatch.apply(context,args);wasResized=false;frame=0}if(frame>9){$(dummy).stop();animRunning=false;frame=0}}});animRunning=true}},threshold:1};$(window).on("throttledresize",function(){$(watched).each(function(){$.refreshBackgroundDimensions(this)})})})(jQuery,window,document,Math);
/*
 * printThis v1.9.1
 * @desc Printing plug-in for jQuery
 * @author Jason Day
 *
 * Resources (based on) :
 *              jPrintArea: http://plugins.jquery.com/project/jPrintArea
 *              jqPrint: https://github.com/permanenttourist/jquery.jqprint
 *              Ben Nadal: http://www.bennadel.com/blog/1591-Ask-Ben-Print-Part-Of-A-Web-Page-With-jQuery.htm
 *
 * Licensed under the MIT licence:
 *              http://www.opensource.org/licenses/mit-license.php
 *
 * (c) Jason Day 2015
 *
 * Usage:
 *
 *  $("#mySelector").printThis({
 *      debug: false,               * show the iframe for debugging
 *      importCSS: true,            * import page CSS
 *      importStyle: false,         * import style tags
 *      printContainer: true,       * grab outer container as well as the contents of the selector
 *      loadCSS: "path/to/my.css",  * path to additional css file - us an array [] for multiple
 *      pageTitle: "",              * add title to print page
 *      removeInline: false,        * remove all inline styles from print elements
 *      printDelay: 333,            * variable print delay
 *      header: null,               * prefix to html
 *      footer: null,               * postfix to html
 *      base: false,                * preserve the BASE tag, or accept a string for the URL
 *      formValues: true            * preserve input/form values
 *      canvas: false               * copy canvas elements (experimental)
 *      doctypeString: '...'        * enter a different doctype for older markup
 *  });
 *
 * Notes:
 *  - the loadCSS will load additional css (with or without @media print) into the iframe, adjusting layout
 */
;(function($){var opt;$.fn.printThis=function(options){opt=$.extend({},$.fn.printThis.defaults,options);var $element=this instanceof jQuery?this:$(this);var strFrameName="printThis-"+(new Date).getTime();if(window.location.hostname!==document.domain&&navigator.userAgent.match(/msie/i)){var iframeSrc='javascript:document.write("<head><script>document.domain=\\"'+document.domain+'\\";</s'+'cript></head><body></body>")';var printI=document.createElement("iframe");printI.name="printIframe";printI.id=strFrameName;printI.className="MSIE";document.body.appendChild(printI);printI.src=iframeSrc}else{var $frame=$("<iframe id='"+strFrameName+"' name='printIframe' />");$frame.appendTo("body")}var $iframe=$("#"+strFrameName);if(!opt.debug)$iframe.css({position:"absolute",width:"0px",height:"0px",left:"-600px",top:"-600px"});setTimeout(function(){function setDocType($iframe,doctype){var win,doc;win=$iframe.get(0);win=win.contentWindow||win.contentDocument||win;doc=win.document||win.contentDocument||win;doc.open();doc.write(doctype);doc.close()}if(opt.doctypeString){setDocType($iframe,opt.doctypeString)}function appendContent($el,content){if(!content)return;$el.append(content.jquery?content.clone():content)}var $doc=$iframe.contents(),$head=$doc.find("head"),$body=$doc.find("body"),$base=$("base"),baseURL;if(opt.base===true&&$base.length>0){baseURL=$base.attr("href")}else if(typeof opt.base==="string"){baseURL=opt.base}else{baseURL=document.location.protocol+"//"+document.location.host}$head.append('<base href="'+baseURL+'">');if(opt.importCSS)$("link[rel=stylesheet]").each(function(){var href=$(this).attr("href");if(href){var media=$(this).attr("media")||"all";$head.append("<link type='text/css' rel='stylesheet' href='"+href+"' media='"+media+"'>")}});if(opt.importStyle)$("style").each(function(){$(this).clone().appendTo($head)});if(opt.pageTitle)$head.append("<title>"+opt.pageTitle+"</title>");if(opt.loadCSS){if($.isArray(opt.loadCSS)){jQuery.each(opt.loadCSS,function(index,value){$head.append("<link type='text/css' rel='stylesheet' href='"+this+"'>")})}else{$head.append("<link type='text/css' rel='stylesheet' href='"+opt.loadCSS+"'>")}}appendContent($body,opt.header);if(opt.canvas){var canvasId=0;$element.find("canvas").each(function(){$(this).attr("data-printthis",canvasId++)})}if(opt.printContainer)$body.append($element.outer());else $element.each(function(){$body.append($(this).html())});if(opt.canvas){$body.find("canvas").each(function(){var cid=$(this).data("printthis"),$src=$('[data-printthis="'+cid+'"]');this.getContext("2d").drawImage($src[0],0,0);$src.removeData("printthis")})}if(opt.formValues){var $input=$element.find("input");if($input.length){$input.each(function(){var $this=$(this),$name=$(this).attr("name"),$checker=$this.is(":checkbox")||$this.is(":radio"),$iframeInput=$doc.find('input[name="'+$name+'"]'),$value=$this.val();if(!$checker){$iframeInput.val($value)}else if($this.is(":checked")){if($this.is(":checkbox")){$iframeInput.attr("checked","checked")}else if($this.is(":radio")){$doc.find('input[name="'+$name+'"][value="'+$value+'"]').attr("checked","checked")}}})}var $select=$element.find("select");if($select.length){$select.each(function(){var $this=$(this),$name=$(this).attr("name"),$value=$this.val();$doc.find('select[name="'+$name+'"]').val($value)})}var $textarea=$element.find("textarea");if($textarea.length){$textarea.each(function(){var $this=$(this),$name=$(this).attr("name"),$value=$this.val();$doc.find('textarea[name="'+$name+'"]').val($value)})}}if(opt.removeInline){if($.isFunction($.removeAttr)){$doc.find("body *").removeAttr("style")}else{$doc.find("body *").attr("style","")}}appendContent($body,opt.footer);setTimeout(function(){if($iframe.hasClass("MSIE")){window.frames["printIframe"].focus();$head.append("<script>  window.print(); </s"+"cript>")}else{if(document.queryCommandSupported("print")){$iframe[0].contentWindow.document.execCommand("print",false,null)}else{$iframe[0].contentWindow.focus();$iframe[0].contentWindow.print()}}if(!opt.debug){setTimeout(function(){$iframe.remove()},1e3)}},opt.printDelay)},333)};$.fn.printThis.defaults={debug:false,importCSS:true,importStyle:false,printContainer:true,loadCSS:"",pageTitle:"",removeInline:false,printDelay:333,header:null,footer:null,formValues:true,canvas:false,base:false,doctypeString:"<!DOCTYPE html>"};jQuery.fn.outer=function(){return $($("<div></div>").html(this.clone())).html()}})(jQuery);
/*!
 * typeahead.js 0.11.1
 * https://github.com/twitter/typeahead.js
 * Copyright 2013-2015 Twitter, Inc. and other contributors; Licensed MIT
 */
(function(root,factory){if(typeof define==="function"&&define.amd){define("typeahead.js",["jquery"],function(a0){return factory(a0)})}else if(typeof exports==="object"){module.exports=factory(require("jquery"))}else{factory(jQuery)}})(this,function($){var _=function(){"use strict";return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:false},isBlankString:function(str){return!str||/^\s*$/.test(str)},escapeRegExChars:function(str){return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(obj){return typeof obj==="string"},isNumber:function(obj){return typeof obj==="number"},isArray:$.isArray,isFunction:$.isFunction,isObject:$.isPlainObject,isUndefined:function(obj){return typeof obj==="undefined"},isElement:function(obj){return!!(obj&&obj.nodeType===1)},isJQuery:function(obj){return obj instanceof $},toStr:function toStr(s){return _.isUndefined(s)||s===null?"":s+""},bind:$.proxy,each:function(collection,cb){$.each(collection,reverseArgs);function reverseArgs(index,value){return cb(value,index)}},map:$.map,filter:$.grep,every:function(obj,test){var result=true;if(!obj){return result}$.each(obj,function(key,val){if(!(result=test.call(null,val,key,obj))){return false}});return!!result},some:function(obj,test){var result=false;if(!obj){return result}$.each(obj,function(key,val){if(result=test.call(null,val,key,obj)){return false}});return!!result},mixin:$.extend,identity:function(x){return x},clone:function(obj){return $.extend(true,{},obj)},getIdGenerator:function(){var counter=0;return function(){return counter++}},templatify:function templatify(obj){return $.isFunction(obj)?obj:template;function template(){return String(obj)}},defer:function(fn){setTimeout(fn,0)},debounce:function(func,wait,immediate){var timeout,result;return function(){var context=this,args=arguments,later,callNow;later=function(){timeout=null;if(!immediate){result=func.apply(context,args)}};callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow){result=func.apply(context,args)}return result}},throttle:function(func,wait){var context,args,timeout,result,previous,later;previous=0;later=function(){previous=new Date;timeout=null;result=func.apply(context,args)};return function(){var now=new Date,remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0){clearTimeout(timeout);timeout=null;previous=now;result=func.apply(context,args)}else if(!timeout){timeout=setTimeout(later,remaining)}return result}},stringify:function(val){return _.isString(val)?val:JSON.stringify(val)},noop:function(){}}}();var WWW=function(){"use strict";var defaultClassNames={wrapper:"twitter-typeahead",input:"tt-input",hint:"tt-hint",menu:"tt-menu",dataset:"tt-dataset",suggestion:"tt-suggestion",selectable:"tt-selectable",empty:"tt-empty",open:"tt-open",cursor:"tt-cursor",highlight:"tt-highlight"};return build;function build(o){var www,classes;classes=_.mixin({},defaultClassNames,o);www={css:buildCss(),classes:classes,html:buildHtml(classes),selectors:buildSelectors(classes)};return{css:www.css,html:www.html,classes:www.classes,selectors:www.selectors,mixin:function(o){_.mixin(o,www)}}}function buildHtml(c){return{wrapper:'<span class="'+c.wrapper+'"></span>',menu:'<div class="'+c.menu+'"></div>'}}function buildSelectors(classes){var selectors={};_.each(classes,function(v,k){selectors[k]="."+v});return selectors}function buildCss(){var css={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},menu:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};if(_.isMsie()){_.mixin(css.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"})}return css}}();var EventBus=function(){"use strict";var namespace,deprecationMap;namespace="typeahead:";deprecationMap={render:"rendered",cursorchange:"cursorchanged",select:"selected",autocomplete:"autocompleted"};function EventBus(o){if(!o||!o.el){$.error("EventBus initialized without el")}this.$el=$(o.el)}_.mixin(EventBus.prototype,{_trigger:function(type,args){var $e;$e=$.Event(namespace+type);(args=args||[]).unshift($e);this.$el.trigger.apply(this.$el,args);return $e},before:function(type){var args,$e;args=[].slice.call(arguments,1);$e=this._trigger("before"+type,args);return $e.isDefaultPrevented()},trigger:function(type){var deprecatedType;this._trigger(type,[].slice.call(arguments,1));if(deprecatedType=deprecationMap[type]){this._trigger(deprecatedType,[].slice.call(arguments,1))}}});return EventBus}();var EventEmitter=function(){"use strict";var splitter=/\s+/,nextTick=getNextTick();return{onSync:onSync,onAsync:onAsync,off:off,trigger:trigger};function on(method,types,cb,context){var type;if(!cb){return this}types=types.split(splitter);cb=context?bindContext(cb,context):cb;this._callbacks=this._callbacks||{};while(type=types.shift()){this._callbacks[type]=this._callbacks[type]||{sync:[],async:[]};this._callbacks[type][method].push(cb)}return this}function onAsync(types,cb,context){return on.call(this,"async",types,cb,context)}function onSync(types,cb,context){return on.call(this,"sync",types,cb,context)}function off(types){var type;if(!this._callbacks){return this}types=types.split(splitter);while(type=types.shift()){delete this._callbacks[type]}return this}function trigger(types){var type,callbacks,args,syncFlush,asyncFlush;if(!this._callbacks){return this}types=types.split(splitter);args=[].slice.call(arguments,1);while((type=types.shift())&&(callbacks=this._callbacks[type])){syncFlush=getFlush(callbacks.sync,this,[type].concat(args));asyncFlush=getFlush(callbacks.async,this,[type].concat(args));syncFlush()&&nextTick(asyncFlush)}return this}function getFlush(callbacks,context,args){return flush;function flush(){var cancelled;for(var i=0,len=callbacks.length;!cancelled&&i<len;i+=1){cancelled=callbacks[i].apply(context,args)===false}return!cancelled}}function getNextTick(){var nextTickFn;if(window.setImmediate){nextTickFn=function nextTickSetImmediate(fn){setImmediate(function(){fn()})}}else{nextTickFn=function nextTickSetTimeout(fn){setTimeout(function(){fn()},0)}}return nextTickFn}function bindContext(fn,context){return fn.bind?fn.bind(context):function(){fn.apply(context,[].slice.call(arguments,0))}}}();var highlight=function(doc){"use strict";var defaults={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:false,caseSensitive:false};return function hightlight(o){var regex;o=_.mixin({},defaults,o);if(!o.node||!o.pattern){return}o.pattern=_.isArray(o.pattern)?o.pattern:[o.pattern];regex=getRegex(o.pattern,o.caseSensitive,o.wordsOnly);traverse(o.node,hightlightTextNode);function hightlightTextNode(textNode){var match,patternNode,wrapperNode;if(match=regex.exec(textNode.data)){wrapperNode=doc.createElement(o.tagName);o.className&&(wrapperNode.className=o.className);patternNode=textNode.splitText(match.index);patternNode.splitText(match[0].length);wrapperNode.appendChild(patternNode.cloneNode(true));textNode.parentNode.replaceChild(wrapperNode,patternNode)}return!!match}function traverse(el,hightlightTextNode){var childNode,TEXT_NODE_TYPE=3;for(var i=0;i<el.childNodes.length;i++){childNode=el.childNodes[i];if(childNode.nodeType===TEXT_NODE_TYPE){i+=hightlightTextNode(childNode)?1:0}else{traverse(childNode,hightlightTextNode)}}}};function getRegex(patterns,caseSensitive,wordsOnly){var escapedPatterns=[],regexStr;for(var i=0,len=patterns.length;i<len;i++){escapedPatterns.push(_.escapeRegExChars(patterns[i]))}regexStr=wordsOnly?"\\b("+escapedPatterns.join("|")+")\\b":"("+escapedPatterns.join("|")+")";return caseSensitive?new RegExp(regexStr):new RegExp(regexStr,"i")}}(window.document);var Input=function(){"use strict";var specialKeyCodeMap;specialKeyCodeMap={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"};function Input(o,www){o=o||{};if(!o.input){$.error("input is missing")}www.mixin(this);this.$hint=$(o.hint);this.$input=$(o.input);this.query=this.$input.val();this.queryWhenFocused=this.hasFocus()?this.query:null;this.$overflowHelper=buildOverflowHelper(this.$input);this._checkLanguageDirection();if(this.$hint.length===0){this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=_.noop}}Input.normalizeQuery=function(str){return _.toStr(str).replace(/^\s*/g,"").replace(/\s{2,}/g," ")};_.mixin(Input.prototype,EventEmitter,{_onBlur:function onBlur(){this.resetInputValue();this.trigger("blurred")},_onFocus:function onFocus(){this.queryWhenFocused=this.query;this.trigger("focused")},_onKeydown:function onKeydown($e){var keyName=specialKeyCodeMap[$e.which||$e.keyCode];this._managePreventDefault(keyName,$e);if(keyName&&this._shouldTrigger(keyName,$e)){this.trigger(keyName+"Keyed",$e)}},_onInput:function onInput(){this._setQuery(this.getInputValue());this.clearHintIfInvalid();this._checkLanguageDirection()},_managePreventDefault:function managePreventDefault(keyName,$e){var preventDefault;switch(keyName){case"up":case"down":preventDefault=!withModifier($e);break;default:preventDefault=false}preventDefault&&$e.preventDefault()},_shouldTrigger:function shouldTrigger(keyName,$e){var trigger;switch(keyName){case"tab":trigger=!withModifier($e);break;default:trigger=true}return trigger},_checkLanguageDirection:function checkLanguageDirection(){var dir=(this.$input.css("direction")||"ltr").toLowerCase();if(this.dir!==dir){this.dir=dir;this.$hint.attr("dir",dir);this.trigger("langDirChanged",dir)}},_setQuery:function setQuery(val,silent){var areEquivalent,hasDifferentWhitespace;areEquivalent=areQueriesEquivalent(val,this.query);hasDifferentWhitespace=areEquivalent?this.query.length!==val.length:false;this.query=val;if(!silent&&!areEquivalent){this.trigger("queryChanged",this.query)}else if(!silent&&hasDifferentWhitespace){this.trigger("whitespaceChanged",this.query)}},bind:function(){var that=this,onBlur,onFocus,onKeydown,onInput;onBlur=_.bind(this._onBlur,this);onFocus=_.bind(this._onFocus,this);onKeydown=_.bind(this._onKeydown,this);onInput=_.bind(this._onInput,this);this.$input.on("blur.tt",onBlur).on("focus.tt",onFocus).on("keydown.tt",onKeydown);if(!_.isMsie()||_.isMsie()>9){this.$input.on("input.tt",onInput)}else{this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function($e){if(specialKeyCodeMap[$e.which||$e.keyCode]){return}_.defer(_.bind(that._onInput,that,$e))})}return this},focus:function focus(){this.$input.focus()},blur:function blur(){this.$input.blur()},getLangDir:function getLangDir(){return this.dir},getQuery:function getQuery(){return this.query||""},setQuery:function setQuery(val,silent){this.setInputValue(val);this._setQuery(val,silent)},hasQueryChangedSinceLastFocus:function hasQueryChangedSinceLastFocus(){return this.query!==this.queryWhenFocused},getInputValue:function getInputValue(){return this.$input.val()},setInputValue:function setInputValue(value){this.$input.val(value);this.clearHintIfInvalid();this._checkLanguageDirection()},resetInputValue:function resetInputValue(){this.setInputValue(this.query)},getHint:function getHint(){return this.$hint.val()},setHint:function setHint(value){this.$hint.val(value)},clearHint:function clearHint(){this.setHint("")},clearHintIfInvalid:function clearHintIfInvalid(){var val,hint,valIsPrefixOfHint,isValid;val=this.getInputValue();hint=this.getHint();valIsPrefixOfHint=val!==hint&&hint.indexOf(val)===0;isValid=val!==""&&valIsPrefixOfHint&&!this.hasOverflow();!isValid&&this.clearHint()},hasFocus:function hasFocus(){return this.$input.is(":focus")},hasOverflow:function hasOverflow(){var constraint=this.$input.width()-2;this.$overflowHelper.text(this.getInputValue());return this.$overflowHelper.width()>=constraint},isCursorAtEnd:function(){var valueLength,selectionStart,range;valueLength=this.$input.val().length;selectionStart=this.$input[0].selectionStart;if(_.isNumber(selectionStart)){return selectionStart===valueLength}else if(document.selection){range=document.selection.createRange();range.moveStart("character",-valueLength);return valueLength===range.text.length}return true},destroy:function destroy(){this.$hint.off(".tt");this.$input.off(".tt");this.$overflowHelper.remove();this.$hint=this.$input=this.$overflowHelper=$("<div>")}});return Input;function buildOverflowHelper($input){return $('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:$input.css("font-family"),fontSize:$input.css("font-size"),fontStyle:$input.css("font-style"),fontVariant:$input.css("font-variant"),fontWeight:$input.css("font-weight"),wordSpacing:$input.css("word-spacing"),letterSpacing:$input.css("letter-spacing"),textIndent:$input.css("text-indent"),textRendering:$input.css("text-rendering"),textTransform:$input.css("text-transform")}).insertAfter($input)}function areQueriesEquivalent(a,b){return Input.normalizeQuery(a)===Input.normalizeQuery(b)}function withModifier($e){return $e.altKey||$e.ctrlKey||$e.metaKey||$e.shiftKey}}();var Dataset=function(){"use strict";var keys,nameGenerator;keys={val:"tt-selectable-display",obj:"tt-selectable-object"};nameGenerator=_.getIdGenerator();function Dataset(o,www){o=o||{};o.templates=o.templates||{};o.templates.notFound=o.templates.notFound||o.templates.empty;if(!o.source){$.error("missing source")}if(!o.node){$.error("missing node")}if(o.name&&!isValidName(o.name)){$.error("invalid dataset name: "+o.name)}www.mixin(this);this.highlight=!!o.highlight;this.name=o.name||nameGenerator();this.limit=o.limit||5;this.displayFn=getDisplayFn(o.display||o.displayKey);this.templates=getTemplates(o.templates,this.displayFn);this.source=o.source.__ttAdapter?o.source.__ttAdapter():o.source;this.async=_.isUndefined(o.async)?this.source.length>2:!!o.async;this._resetLastSuggestion();this.$el=$(o.node).addClass(this.classes.dataset).addClass(this.classes.dataset+"-"+this.name)}Dataset.extractData=function extractData(el){var $el=$(el);if($el.data(keys.obj)){return{val:$el.data(keys.val)||"",obj:$el.data(keys.obj)||null}}return null};_.mixin(Dataset.prototype,EventEmitter,{_overwrite:function overwrite(query,suggestions){suggestions=suggestions||[];if(suggestions.length){this._renderSuggestions(query,suggestions)}else if(this.async&&this.templates.pending){this._renderPending(query)}else if(!this.async&&this.templates.notFound){this._renderNotFound(query)}else{this._empty()}this.trigger("rendered",this.name,suggestions,false)},_append:function append(query,suggestions){suggestions=suggestions||[];if(suggestions.length&&this.$lastSuggestion.length){this._appendSuggestions(query,suggestions)}else if(suggestions.length){this._renderSuggestions(query,suggestions)}else if(!this.$lastSuggestion.length&&this.templates.notFound){this._renderNotFound(query)}this.trigger("rendered",this.name,suggestions,true)},_renderSuggestions:function renderSuggestions(query,suggestions){var $fragment;$fragment=this._getSuggestionsFragment(query,suggestions);this.$lastSuggestion=$fragment.children().last();this.$el.html($fragment).prepend(this._getHeader(query,suggestions)).append(this._getFooter(query,suggestions))},_appendSuggestions:function appendSuggestions(query,suggestions){var $fragment,$lastSuggestion;$fragment=this._getSuggestionsFragment(query,suggestions);$lastSuggestion=$fragment.children().last();this.$lastSuggestion.after($fragment);this.$lastSuggestion=$lastSuggestion},_renderPending:function renderPending(query){var template=this.templates.pending;this._resetLastSuggestion();template&&this.$el.html(template({query:query,dataset:this.name}))},_renderNotFound:function renderNotFound(query){var template=this.templates.notFound;this._resetLastSuggestion();template&&this.$el.html(template({query:query,dataset:this.name}))},_empty:function empty(){this.$el.empty();this._resetLastSuggestion()},_getSuggestionsFragment:function getSuggestionsFragment(query,suggestions){var that=this,fragment;fragment=document.createDocumentFragment();_.each(suggestions,function getSuggestionNode(suggestion){var $el,context;context=that._injectQuery(query,suggestion);$el=$(that.templates.suggestion(context)).data(keys.obj,suggestion).data(keys.val,that.displayFn(suggestion)).addClass(that.classes.suggestion+" "+that.classes.selectable);fragment.appendChild($el[0])});this.highlight&&highlight({className:this.classes.highlight,node:fragment,pattern:query});return $(fragment)},_getFooter:function getFooter(query,suggestions){return this.templates.footer?this.templates.footer({query:query,suggestions:suggestions,dataset:this.name}):null},_getHeader:function getHeader(query,suggestions){return this.templates.header?this.templates.header({query:query,suggestions:suggestions,dataset:this.name}):null},_resetLastSuggestion:function resetLastSuggestion(){this.$lastSuggestion=$()},_injectQuery:function injectQuery(query,obj){return _.isObject(obj)?_.mixin({_query:query},obj):obj},update:function update(query){var that=this,canceled=false,syncCalled=false,rendered=0;this.cancel();this.cancel=function cancel(){canceled=true;that.cancel=$.noop;that.async&&that.trigger("asyncCanceled",query)};this.source(query,sync,async);!syncCalled&&sync([]);function sync(suggestions){if(syncCalled){return}syncCalled=true;suggestions=(suggestions||[]).slice(0,that.limit);rendered=suggestions.length;that._overwrite(query,suggestions);if(rendered<that.limit&&that.async){that.trigger("asyncRequested",query)}}function async(suggestions){suggestions=suggestions||[];if(!canceled&&rendered<that.limit){that.cancel=$.noop;rendered+=suggestions.length;that._append(query,suggestions.slice(0,that.limit-rendered));that.async&&that.trigger("asyncReceived",query)}}},cancel:$.noop,clear:function clear(){this._empty();this.cancel();this.trigger("cleared")},isEmpty:function isEmpty(){return this.$el.is(":empty")},destroy:function destroy(){this.$el=$("<div>")}});return Dataset;function getDisplayFn(display){display=display||_.stringify;return _.isFunction(display)?display:displayFn;function displayFn(obj){return obj[display]}}function getTemplates(templates,displayFn){return{notFound:templates.notFound&&_.templatify(templates.notFound),pending:templates.pending&&_.templatify(templates.pending),header:templates.header&&_.templatify(templates.header),footer:templates.footer&&_.templatify(templates.footer),suggestion:templates.suggestion||suggestionTemplate};function suggestionTemplate(context){return $("<div>").text(displayFn(context))}}function isValidName(str){return/^[_a-zA-Z0-9-]+$/.test(str)}}();var Menu=function(){"use strict";function Menu(o,www){var that=this;o=o||{};if(!o.node){$.error("node is required")}www.mixin(this);this.$node=$(o.node);this.query=null;this.datasets=_.map(o.datasets,initializeDataset);function initializeDataset(oDataset){var node=that.$node.find(oDataset.node).first();oDataset.node=node.length?node:$("<div>").appendTo(that.$node);return new Dataset(oDataset,www)}}_.mixin(Menu.prototype,EventEmitter,{_onSelectableClick:function onSelectableClick($e){this.trigger("selectableClicked",$($e.currentTarget))},_onRendered:function onRendered(type,dataset,suggestions,async){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty());this.trigger("datasetRendered",dataset,suggestions,async)},_onCleared:function onCleared(){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty());this.trigger("datasetCleared")},_propagate:function propagate(){this.trigger.apply(this,arguments)},_allDatasetsEmpty:function allDatasetsEmpty(){return _.every(this.datasets,isDatasetEmpty);function isDatasetEmpty(dataset){return dataset.isEmpty()}},_getSelectables:function getSelectables(){return this.$node.find(this.selectors.selectable)},_removeCursor:function _removeCursor(){var $selectable=this.getActiveSelectable();$selectable&&$selectable.removeClass(this.classes.cursor)},_ensureVisible:function ensureVisible($el){var elTop,elBottom,nodeScrollTop,nodeHeight;elTop=$el.position().top;elBottom=elTop+$el.outerHeight(true);nodeScrollTop=this.$node.scrollTop();nodeHeight=this.$node.height()+parseInt(this.$node.css("paddingTop"),10)+parseInt(this.$node.css("paddingBottom"),10);if(elTop<0){this.$node.scrollTop(nodeScrollTop+elTop)}else if(nodeHeight<elBottom){this.$node.scrollTop(nodeScrollTop+(elBottom-nodeHeight))}},bind:function(){var that=this,onSelectableClick;onSelectableClick=_.bind(this._onSelectableClick,this);this.$node.on("click.tt",this.selectors.selectable,onSelectableClick);_.each(this.datasets,function(dataset){dataset.onSync("asyncRequested",that._propagate,that).onSync("asyncCanceled",that._propagate,that).onSync("asyncReceived",that._propagate,that).onSync("rendered",that._onRendered,that).onSync("cleared",that._onCleared,that)});return this},isOpen:function isOpen(){return this.$node.hasClass(this.classes.open)},open:function open(){this.$node.addClass(this.classes.open)},close:function close(){this.$node.removeClass(this.classes.open);this._removeCursor()},setLanguageDirection:function setLanguageDirection(dir){this.$node.attr("dir",dir)},selectableRelativeToCursor:function selectableRelativeToCursor(delta){var $selectables,$oldCursor,oldIndex,newIndex;$oldCursor=this.getActiveSelectable();$selectables=this._getSelectables();oldIndex=$oldCursor?$selectables.index($oldCursor):-1;newIndex=oldIndex+delta;newIndex=(newIndex+1)%($selectables.length+1)-1;newIndex=newIndex<-1?$selectables.length-1:newIndex;return newIndex===-1?null:$selectables.eq(newIndex)},setCursor:function setCursor($selectable){this._removeCursor();if($selectable=$selectable&&$selectable.first()){$selectable.addClass(this.classes.cursor);this._ensureVisible($selectable)}},getSelectableData:function getSelectableData($el){return $el&&$el.length?Dataset.extractData($el):null},getActiveSelectable:function getActiveSelectable(){var $selectable=this._getSelectables().filter(this.selectors.cursor).first();return $selectable.length?$selectable:null},getTopSelectable:function getTopSelectable(){var $selectable=this._getSelectables().first();return $selectable.length?$selectable:null},update:function update(query){var isValidUpdate=query!==this.query;if(isValidUpdate){this.query=query;_.each(this.datasets,updateDataset)}return isValidUpdate;function updateDataset(dataset){dataset.update(query)}},empty:function empty(){_.each(this.datasets,clearDataset);this.query=null;this.$node.addClass(this.classes.empty);function clearDataset(dataset){dataset.clear()}},destroy:function destroy(){this.$node.off(".tt");this.$node=$("<div>");_.each(this.datasets,destroyDataset);function destroyDataset(dataset){dataset.destroy()}}});return Menu}();var DefaultMenu=function(){"use strict";var s=Menu.prototype;function DefaultMenu(){Menu.apply(this,[].slice.call(arguments,0))}_.mixin(DefaultMenu.prototype,Menu.prototype,{open:function open(){!this._allDatasetsEmpty()&&this._show();return s.open.apply(this,[].slice.call(arguments,0))},close:function close(){this._hide();return s.close.apply(this,[].slice.call(arguments,0))},_onRendered:function onRendered(){if(this._allDatasetsEmpty()){this._hide()}else{this.isOpen()&&this._show()}return s._onRendered.apply(this,[].slice.call(arguments,0))},_onCleared:function onCleared(){if(this._allDatasetsEmpty()){this._hide()}else{this.isOpen()&&this._show()}return s._onCleared.apply(this,[].slice.call(arguments,0))},setLanguageDirection:function setLanguageDirection(dir){this.$node.css(dir==="ltr"?this.css.ltr:this.css.rtl);return s.setLanguageDirection.apply(this,[].slice.call(arguments,0))},_hide:function hide(){this.$node.hide()},_show:function show(){this.$node.css("display","block")}});return DefaultMenu}();var Typeahead=function(){"use strict";function Typeahead(o,www){var onFocused,onBlurred,onEnterKeyed,onTabKeyed,onEscKeyed,onUpKeyed,onDownKeyed,onLeftKeyed,onRightKeyed,onQueryChanged,onWhitespaceChanged;o=o||{};if(!o.input){$.error("missing input")}if(!o.menu){$.error("missing menu")}if(!o.eventBus){$.error("missing event bus")}www.mixin(this);this.eventBus=o.eventBus;this.minLength=_.isNumber(o.minLength)?o.minLength:1;this.input=o.input;this.menu=o.menu;this.enabled=true;this.active=false;this.input.hasFocus()&&this.activate();this.dir=this.input.getLangDir();this._hacks();this.menu.bind().onSync("selectableClicked",this._onSelectableClicked,this).onSync("asyncRequested",this._onAsyncRequested,this).onSync("asyncCanceled",this._onAsyncCanceled,this).onSync("asyncReceived",this._onAsyncReceived,this).onSync("datasetRendered",this._onDatasetRendered,this).onSync("datasetCleared",this._onDatasetCleared,this);onFocused=c(this,"activate","open","_onFocused");onBlurred=c(this,"deactivate","_onBlurred");onEnterKeyed=c(this,"isActive","isOpen","_onEnterKeyed");onTabKeyed=c(this,"isActive","isOpen","_onTabKeyed");onEscKeyed=c(this,"isActive","_onEscKeyed");onUpKeyed=c(this,"isActive","open","_onUpKeyed");onDownKeyed=c(this,"isActive","open","_onDownKeyed");onLeftKeyed=c(this,"isActive","isOpen","_onLeftKeyed");onRightKeyed=c(this,"isActive","isOpen","_onRightKeyed");onQueryChanged=c(this,"_openIfActive","_onQueryChanged");onWhitespaceChanged=c(this,"_openIfActive","_onWhitespaceChanged");this.input.bind().onSync("focused",onFocused,this).onSync("blurred",onBlurred,this).onSync("enterKeyed",onEnterKeyed,this).onSync("tabKeyed",onTabKeyed,this).onSync("escKeyed",onEscKeyed,this).onSync("upKeyed",onUpKeyed,this).onSync("downKeyed",onDownKeyed,this).onSync("leftKeyed",onLeftKeyed,this).onSync("rightKeyed",onRightKeyed,this).onSync("queryChanged",onQueryChanged,this).onSync("whitespaceChanged",onWhitespaceChanged,this).onSync("langDirChanged",this._onLangDirChanged,this)}_.mixin(Typeahead.prototype,{_hacks:function hacks(){var $input,$menu;$input=this.input.$input||$("<div>");$menu=this.menu.$node||$("<div>");$input.on("blur.tt",function($e){var active,isActive,hasActive;active=document.activeElement;isActive=$menu.is(active);hasActive=$menu.has(active).length>0;if(_.isMsie()&&(isActive||hasActive)){$e.preventDefault();$e.stopImmediatePropagation();_.defer(function(){$input.focus()})}});$menu.on("mousedown.tt",function($e){$e.preventDefault()})},_onSelectableClicked:function onSelectableClicked(type,$el){this.select($el)},_onDatasetCleared:function onDatasetCleared(){this._updateHint()},_onDatasetRendered:function onDatasetRendered(type,dataset,suggestions,async){this._updateHint();this.eventBus.trigger("render",suggestions,async,dataset)},_onAsyncRequested:function onAsyncRequested(type,dataset,query){this.eventBus.trigger("asyncrequest",query,dataset)},_onAsyncCanceled:function onAsyncCanceled(type,dataset,query){this.eventBus.trigger("asynccancel",query,dataset)},_onAsyncReceived:function onAsyncReceived(type,dataset,query){this.eventBus.trigger("asyncreceive",query,dataset)},_onFocused:function onFocused(){this._minLengthMet()&&this.menu.update(this.input.getQuery())},_onBlurred:function onBlurred(){if(this.input.hasQueryChangedSinceLastFocus()){this.eventBus.trigger("change",this.input.getQuery())}},_onEnterKeyed:function onEnterKeyed(type,$e){var $selectable;if($selectable=this.menu.getActiveSelectable()){this.select($selectable)&&$e.preventDefault()}},_onTabKeyed:function onTabKeyed(type,$e){var $selectable;if($selectable=this.menu.getActiveSelectable()){this.select($selectable)&&$e.preventDefault()}else if($selectable=this.menu.getTopSelectable()){this.autocomplete($selectable)&&$e.preventDefault()}},_onEscKeyed:function onEscKeyed(){this.close()},_onUpKeyed:function onUpKeyed(){this.moveCursor(-1)},_onDownKeyed:function onDownKeyed(){this.moveCursor(+1)},_onLeftKeyed:function onLeftKeyed(){if(this.dir==="rtl"&&this.input.isCursorAtEnd()){this.autocomplete(this.menu.getTopSelectable())}},_onRightKeyed:function onRightKeyed(){if(this.dir==="ltr"&&this.input.isCursorAtEnd()){this.autocomplete(this.menu.getTopSelectable())}},_onQueryChanged:function onQueryChanged(e,query){this._minLengthMet(query)?this.menu.update(query):this.menu.empty()},_onWhitespaceChanged:function onWhitespaceChanged(){this._updateHint()},_onLangDirChanged:function onLangDirChanged(e,dir){if(this.dir!==dir){this.dir=dir;this.menu.setLanguageDirection(dir)}},_openIfActive:function openIfActive(){this.isActive()&&this.open()},_minLengthMet:function minLengthMet(query){query=_.isString(query)?query:this.input.getQuery()||"";return query.length>=this.minLength},_updateHint:function updateHint(){var $selectable,data,val,query,escapedQuery,frontMatchRegEx,match;$selectable=this.menu.getTopSelectable();data=this.menu.getSelectableData($selectable);val=this.input.getInputValue();if(data&&!_.isBlankString(val)&&!this.input.hasOverflow()){query=Input.normalizeQuery(val);escapedQuery=_.escapeRegExChars(query);frontMatchRegEx=new RegExp("^(?:"+escapedQuery+")(.+$)","i");match=frontMatchRegEx.exec(data.val);match&&this.input.setHint(val+match[1])}else{this.input.clearHint()}},isEnabled:function isEnabled(){return this.enabled},enable:function enable(){this.enabled=true},disable:function disable(){this.enabled=false},isActive:function isActive(){return this.active},activate:function activate(){if(this.isActive()){return true}else if(!this.isEnabled()||this.eventBus.before("active")){return false}else{this.active=true;this.eventBus.trigger("active");return true}},deactivate:function deactivate(){if(!this.isActive()){return true}else if(this.eventBus.before("idle")){return false}else{this.active=false;this.close();this.eventBus.trigger("idle");return true}},isOpen:function isOpen(){return this.menu.isOpen()},open:function open(){if(!this.isOpen()&&!this.eventBus.before("open")){this.menu.open();this._updateHint();this.eventBus.trigger("open")}return this.isOpen()},close:function close(){if(this.isOpen()&&!this.eventBus.before("close")){this.menu.close();this.input.clearHint();this.input.resetInputValue();this.eventBus.trigger("close")}return!this.isOpen()},setVal:function setVal(val){this.input.setQuery(_.toStr(val))},getVal:function getVal(){return this.input.getQuery()},select:function select($selectable){var data=this.menu.getSelectableData($selectable);if(data&&!this.eventBus.before("select",data.obj)){this.input.setQuery(data.val,true);this.eventBus.trigger("select",data.obj);this.close();return true}return false},autocomplete:function autocomplete($selectable){var query,data,isValid;query=this.input.getQuery();data=this.menu.getSelectableData($selectable);isValid=data&&query!==data.val;if(isValid&&!this.eventBus.before("autocomplete",data.obj)){this.input.setQuery(data.val);this.eventBus.trigger("autocomplete",data.obj);return true}return false},moveCursor:function moveCursor(delta){var query,$candidate,data,payload,cancelMove;query=this.input.getQuery();$candidate=this.menu.selectableRelativeToCursor(delta);data=this.menu.getSelectableData($candidate);payload=data?data.obj:null;cancelMove=this._minLengthMet()&&this.menu.update(query);if(!cancelMove&&!this.eventBus.before("cursorchange",payload)){this.menu.setCursor($candidate);if(data){this.input.setInputValue(data.val)}else{this.input.resetInputValue();this._updateHint()}this.eventBus.trigger("cursorchange",payload);return true}return false},destroy:function destroy(){this.input.destroy();this.menu.destroy()}});return Typeahead;function c(ctx){var methods=[].slice.call(arguments,1);return function(){var args=[].slice.call(arguments);_.each(methods,function(method){return ctx[method].apply(ctx,args)})}}}();(function(){"use strict";var old,keys,methods;old=$.fn.typeahead;keys={www:"tt-www",attrs:"tt-attrs",typeahead:"tt-typeahead"};methods={initialize:function initialize(o,datasets){var www;datasets=_.isArray(datasets)?datasets:[].slice.call(arguments,1);o=o||{};www=WWW(o.classNames);return this.each(attach);function attach(){var $input,$wrapper,$hint,$menu,defaultHint,defaultMenu,eventBus,input,menu,typeahead,MenuConstructor;_.each(datasets,function(d){d.highlight=!!o.highlight});$input=$(this);$wrapper=$(www.html.wrapper);$hint=$elOrNull(o.hint);$menu=$elOrNull(o.menu);defaultHint=o.hint!==false&&!$hint;defaultMenu=o.menu!==false&&!$menu;defaultHint&&($hint=buildHintFromInput($input,www));defaultMenu&&($menu=$(www.html.menu).css(www.css.menu));$hint&&$hint.val("");$input=prepInput($input,www);if(defaultHint||defaultMenu){$wrapper.css(www.css.wrapper);$input.css(defaultHint?www.css.input:www.css.inputWithNoHint);$input.wrap($wrapper).parent().prepend(defaultHint?$hint:null).append(defaultMenu?$menu:null)}MenuConstructor=defaultMenu?DefaultMenu:Menu;eventBus=new EventBus({el:$input});input=new Input({hint:$hint,input:$input},www);menu=new MenuConstructor({node:$menu,datasets:datasets},www);typeahead=new Typeahead({input:input,menu:menu,eventBus:eventBus,minLength:o.minLength},www);$input.data(keys.www,www);$input.data(keys.typeahead,typeahead)}},isEnabled:function isEnabled(){var enabled;ttEach(this.first(),function(t){enabled=t.isEnabled()});return enabled},enable:function enable(){ttEach(this,function(t){t.enable()});return this},disable:function disable(){ttEach(this,function(t){t.disable()});return this},isActive:function isActive(){var active;ttEach(this.first(),function(t){active=t.isActive()});return active},activate:function activate(){ttEach(this,function(t){t.activate()});return this},deactivate:function deactivate(){ttEach(this,function(t){t.deactivate()});return this},isOpen:function isOpen(){var open;ttEach(this.first(),function(t){open=t.isOpen()});return open},open:function open(){ttEach(this,function(t){t.open()});return this},close:function close(){ttEach(this,function(t){t.close()});return this},select:function select(el){var success=false,$el=$(el);ttEach(this.first(),function(t){success=t.select($el)});return success},autocomplete:function autocomplete(el){var success=false,$el=$(el);ttEach(this.first(),function(t){success=t.autocomplete($el)});return success},moveCursor:function moveCursoe(delta){var success=false;ttEach(this.first(),function(t){success=t.moveCursor(delta)});return success},val:function val(newVal){var query;if(!arguments.length){ttEach(this.first(),function(t){query=t.getVal()});return query}else{ttEach(this,function(t){t.setVal(newVal)});return this}},destroy:function destroy(){ttEach(this,function(typeahead,$input){revert($input);typeahead.destroy()});return this}};$.fn.typeahead=function(method){if(methods[method]){return methods[method].apply(this,[].slice.call(arguments,1))}else{return methods.initialize.apply(this,arguments)}};$.fn.typeahead.noConflict=function noConflict(){$.fn.typeahead=old;return this};function ttEach($els,fn){$els.each(function(){var $input=$(this),typeahead;(typeahead=$input.data(keys.typeahead))&&fn(typeahead,$input)})}function buildHintFromInput($input,www){return $input.clone().addClass(www.classes.hint).removeData().css(www.css.hint).css(getBackgroundStyles($input)).prop("readonly",true).removeAttr("id name placeholder required").attr({autocomplete:"off",spellcheck:"false",tabindex:-1})}function prepInput($input,www){$input.data(keys.attrs,{dir:$input.attr("dir"),autocomplete:$input.attr("autocomplete"),spellcheck:$input.attr("spellcheck"),style:$input.attr("style")});$input.addClass(www.classes.input).attr({autocomplete:"off",spellcheck:false});try{!$input.attr("dir")&&$input.attr("dir","auto")}catch(e){}return $input}function getBackgroundStyles($el){return{backgroundAttachment:$el.css("background-attachment"),backgroundClip:$el.css("background-clip"),backgroundColor:$el.css("background-color"),backgroundImage:$el.css("background-image"),backgroundOrigin:$el.css("background-origin"),backgroundPosition:$el.css("background-position"),backgroundRepeat:$el.css("background-repeat"),backgroundSize:$el.css("background-size")}}function revert($input){var www,$wrapper;www=$input.data(keys.www);$wrapper=$input.parent().filter(www.selectors.wrapper);_.each($input.data(keys.attrs),function(val,key){_.isUndefined(val)?$input.removeAttr(key):$input.attr(key,val)});$input.removeData(keys.typeahead).removeData(keys.www).removeData(keys.attr).removeClass(www.classes.input);if($wrapper.length){$input.detach().insertAfter($wrapper);$wrapper.remove()}}function $elOrNull(obj){var isValid,$el;isValid=_.isJQuery(obj)||_.isElement(obj);$el=isValid?$(obj).first():[];return $el.length?$el:null}})()});
/*!
 * hoverIntent v1.8.0 // 2014.06.29 // jQuery v1.9.1+
 * http://cherne.net/brian/resources/jquery.hoverIntent.html
 *
 * You may use hoverIntent under the terms of the MIT license. Basically that
 * means you are free to use hoverIntent as long as this header is left intact.
 * Copyright 2007, 2014 Brian Cherne
 */
(function($){$.fn.hoverIntent=function(handlerIn,handlerOut,selector){var cfg={interval:100,sensitivity:6,timeout:100};if(typeof handlerIn==="object"){cfg=$.extend(cfg,handlerIn)}else{if($.isFunction(handlerOut)){cfg=$.extend(cfg,{over:handlerIn,out:handlerOut,selector:selector})}else{cfg=$.extend(cfg,{over:handlerIn,out:handlerIn,selector:handlerOut})}}var cX,cY,pX,pY;var track=function(ev){cX=ev.pageX;cY=ev.pageY};var compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if(Math.sqrt((pX-cX)*(pX-cX)+(pY-cY)*(pY-cY))<cfg.sensitivity){$(ob).off("mousemove.hoverIntent",track);ob.hoverIntent_s=true;return cfg.over.apply(ob,[ev])}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}};var delay=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=false;return cfg.out.apply(ob,[ev])};var handleHover=function(e){var ev=$.extend({},e);var ob=this;if(ob.hoverIntent_t){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t)}if(e.type==="mouseenter"){pX=ev.pageX;pY=ev.pageY;$(ob).on("mousemove.hoverIntent",track);if(!ob.hoverIntent_s){ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}}else{$(ob).off("mousemove.hoverIntent",track);if(ob.hoverIntent_s){ob.hoverIntent_t=setTimeout(function(){delay(ev,ob)},cfg.timeout)}}};return this.on({"mouseenter.hoverIntent":handleHover,"mouseleave.hoverIntent":handleHover},cfg.selector)}})(jQuery);



/*
 * jQuery Easing v1.3 - http://gsgd.co.uk/sandbox/jquery/easing/
 *
 *
*/
jQuery.easing["jswing"]=jQuery.easing["swing"];jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(a,b,c,d,e){return jQuery.easing[jQuery.easing.def](a,b,c,d,e)},easeInQuad:function(a,b,c,d,e){return d*(b/=e)*b+c},easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c},easeInOutQuad:function(a,b,c,d,e){if((b/=e/2)<1)return d/2*b*b+c;return-d/2*(--b*(b-2)-1)+c},easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){if((b/=e/2)<1)return d/2*b*b*b+c;return d/2*((b-=2)*b*b+2)+c},easeInQuart:function(a,b,c,d,e){return d*(b/=e)*b*b*b+c},easeOutQuart:function(a,b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},easeInOutQuart:function(a,b,c,d,e){if((b/=e/2)<1)return d/2*b*b*b*b+c;return-d/2*((b-=2)*b*b*b-2)+c},easeInQuint:function(a,b,c,d,e){return d*(b/=e)*b*b*b*b+c},easeOutQuint:function(a,b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutQuint:function(a,b,c,d,e){if((b/=e/2)<1)return d/2*b*b*b*b*b+c;return d/2*((b-=2)*b*b*b*b+2)+c},easeInSine:function(a,b,c,d,e){return-d*Math.cos(b/e*(Math.PI/2))+d+c},easeOutSine:function(a,b,c,d,e){return d*Math.sin(b/e*(Math.PI/2))+c},easeInOutSine:function(a,b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c},easeInExpo:function(a,b,c,d,e){return b==0?c:d*Math.pow(2,10*(b/e-1))+c},easeOutExpo:function(a,b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},easeInOutExpo:function(a,b,c,d,e){if(b==0)return c;if(b==e)return c+d;if((b/=e/2)<1)return d/2*Math.pow(2,10*(b-1))+c;return d/2*(-Math.pow(2,-10*--b)+2)+c},easeInCirc:function(a,b,c,d,e){return-d*(Math.sqrt(1-(b/=e)*b)-1)+c},easeOutCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},easeInOutCirc:function(a,b,c,d,e){if((b/=e/2)<1)return-d/2*(Math.sqrt(1-b*b)-1)+c;return d/2*(Math.sqrt(1-(b-=2)*b)+1)+c},easeInElastic:function(a,b,c,d,e){var f=1.70158;var g=0;var h=d;if(b==0)return c;if((b/=e)==1)return c+d;if(!g)g=e*.3;if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g))+c},easeOutElastic:function(a,b,c,d,e){var f=1.70158;var g=0;var h=d;if(b==0)return c;if((b/=e)==1)return c+d;if(!g)g=e*.3;if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return h*Math.pow(2,-10*b)*Math.sin((b*e-f)*2*Math.PI/g)+d+c},easeInOutElastic:function(a,b,c,d,e){var f=1.70158;var g=0;var h=d;if(b==0)return c;if((b/=e/2)==2)return c+d;if(!g)g=e*.3*1.5;if(h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);if(b<1)return-.5*h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g)+c;return h*Math.pow(2,-10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g)*.5+d+c},easeInBack:function(a,b,c,d,e,f){if(f==undefined)f=1.70158;return d*(b/=e)*b*((f+1)*b-f)+c},easeOutBack:function(a,b,c,d,e,f){if(f==undefined)f=1.70158;return d*((b=b/e-1)*b*((f+1)*b+f)+1)+c},easeInOutBack:function(a,b,c,d,e,f){if(f==undefined)f=1.70158;if((b/=e/2)<1)return d/2*b*b*(((f*=1.525)+1)*b-f)+c;return d/2*((b-=2)*b*(((f*=1.525)+1)*b+f)+2)+c},easeInBounce:function(a,b,c,d,e){return d-jQuery.easing.easeOutBounce(a,e-b,0,d,e)+c},easeOutBounce:function(a,b,c,d,e){if((b/=e)<1/2.75){return d*7.5625*b*b+c}else if(b<2/2.75){return d*(7.5625*(b-=1.5/2.75)*b+.75)+c}else if(b<2.5/2.75){return d*(7.5625*(b-=2.25/2.75)*b+.9375)+c}else{return d*(7.5625*(b-=2.625/2.75)*b+.984375)+c}},easeInOutBounce:function(a,b,c,d,e){if(b<e/2)return jQuery.easing.easeInBounce(a,b*2,0,d,e)*.5+c;return jQuery.easing.easeOutBounce(a,b*2-e,0,d,e)*.5+d*.5+c}});


/*! jCarousel - v0.3.3 - 2015-02-28
* http://sorgalla.com/jcarousel/
* Copyright (c) 2006-2015 Jan Sorgalla; Licensed MIT */
(function(t){"use strict";var i=t.jCarousel={};i.version="0.3.3";var s=/^([+\-]=)?(.+)$/;i.parseTarget=function(t){var i=!1,e="object"!=typeof t?s.exec(t):null;return e?(t=parseInt(e[2],10)||0,e[1]&&(i=!0,"-="===e[1]&&(t*=-1))):"object"!=typeof t&&(t=parseInt(t,10)||0),{target:t,relative:i}},i.detectCarousel=function(t){for(var i;t.length>0;){if(i=t.filter("[data-jcarousel]"),i.length>0)return i;if(i=t.find("[data-jcarousel]"),i.length>0)return i;t=t.parent()}return null},i.base=function(s){return{version:i.version,_options:{},_element:null,_carousel:null,_init:t.noop,_create:t.noop,_destroy:t.noop,_reload:t.noop,create:function(){return this._element.attr("data-"+s.toLowerCase(),!0).data(s,this),!1===this._trigger("create")?this:(this._create(),this._trigger("createend"),this)},destroy:function(){return!1===this._trigger("destroy")?this:(this._destroy(),this._trigger("destroyend"),this._element.removeData(s).removeAttr("data-"+s.toLowerCase()),this)},reload:function(t){return!1===this._trigger("reload")?this:(t&&this.options(t),this._reload(),this._trigger("reloadend"),this)},element:function(){return this._element},options:function(i,s){if(0===arguments.length)return t.extend({},this._options);if("string"==typeof i){if(s===void 0)return this._options[i]===void 0?null:this._options[i];this._options[i]=s}else this._options=t.extend({},this._options,i);return this},carousel:function(){return this._carousel||(this._carousel=i.detectCarousel(this.options("carousel")||this._element),this._carousel||t.error('Could not detect carousel for plugin "'+s+'"')),this._carousel},_trigger:function(i,e,r){var n,o=!1;return r=[this].concat(r||[]),(e||this._element).each(function(){n=t.Event((s+":"+i).toLowerCase()),t(this).trigger(n,r),n.isDefaultPrevented()&&(o=!0)}),!o}}},i.plugin=function(s,e){var r=t[s]=function(i,s){this._element=t(i),this.options(s),this._init(),this.create()};return r.fn=r.prototype=t.extend({},i.base(s),e),t.fn[s]=function(i){var e=Array.prototype.slice.call(arguments,1),n=this;return"string"==typeof i?this.each(function(){var r=t(this).data(s);if(!r)return t.error("Cannot call methods on "+s+" prior to initialization; "+'attempted to call method "'+i+'"');if(!t.isFunction(r[i])||"_"===i.charAt(0))return t.error('No such method "'+i+'" for '+s+" instance");var o=r[i].apply(r,e);return o!==r&&o!==void 0?(n=o,!1):void 0}):this.each(function(){var e=t(this).data(s);e instanceof r?e.reload(i):new r(this,i)}),n},r}})(jQuery),function(t,i){"use strict";var s=function(t){return parseFloat(t)||0};t.jCarousel.plugin("jcarousel",{animating:!1,tail:0,inTail:!1,resizeTimer:null,lt:null,vertical:!1,rtl:!1,circular:!1,underflow:!1,relative:!1,_options:{list:function(){return this.element().children().eq(0)},items:function(){return this.list().children()},animation:400,transitions:!1,wrap:null,vertical:null,rtl:null,center:!1},_list:null,_items:null,_target:t(),_first:t(),_last:t(),_visible:t(),_fullyvisible:t(),_init:function(){var t=this;return this.onWindowResize=function(){t.resizeTimer&&clearTimeout(t.resizeTimer),t.resizeTimer=setTimeout(function(){t.reload()},100)},this},_create:function(){this._reload(),t(i).on("resize.jcarousel",this.onWindowResize)},_destroy:function(){t(i).off("resize.jcarousel",this.onWindowResize)},_reload:function(){this.vertical=this.options("vertical"),null==this.vertical&&(this.vertical=this.list().height()>this.list().width()),this.rtl=this.options("rtl"),null==this.rtl&&(this.rtl=function(i){if("rtl"===(""+i.attr("dir")).toLowerCase())return!0;var s=!1;return i.parents("[dir]").each(function(){return/rtl/i.test(t(this).attr("dir"))?(s=!0,!1):void 0}),s}(this._element)),this.lt=this.vertical?"top":"left",this.relative="relative"===this.list().css("position"),this._list=null,this._items=null;var i=this.index(this._target)>=0?this._target:this.closest();this.circular="circular"===this.options("wrap"),this.underflow=!1;var s={left:0,top:0};return i.length>0&&(this._prepare(i),this.list().find("[data-jcarousel-clone]").remove(),this._items=null,this.underflow=this._fullyvisible.length>=this.items().length,this.circular=this.circular&&!this.underflow,s[this.lt]=this._position(i)+"px"),this.move(s),this},list:function(){if(null===this._list){var i=this.options("list");this._list=t.isFunction(i)?i.call(this):this._element.find(i)}return this._list},items:function(){if(null===this._items){var i=this.options("items");this._items=(t.isFunction(i)?i.call(this):this.list().find(i)).not("[data-jcarousel-clone]")}return this._items},index:function(t){return this.items().index(t)},closest:function(){var i,e=this,r=this.list().position()[this.lt],n=t(),o=!1,l=this.vertical?"bottom":this.rtl&&!this.relative?"left":"right";return this.rtl&&this.relative&&!this.vertical&&(r+=this.list().width()-this.clipping()),this.items().each(function(){if(n=t(this),o)return!1;var a=e.dimension(n);if(r+=a,r>=0){if(i=a-s(n.css("margin-"+l)),!(0>=Math.abs(r)-a+i/2))return!1;o=!0}}),n},target:function(){return this._target},first:function(){return this._first},last:function(){return this._last},visible:function(){return this._visible},fullyvisible:function(){return this._fullyvisible},hasNext:function(){if(!1===this._trigger("hasnext"))return!0;var t=this.options("wrap"),i=this.items().length-1,s=this.options("center")?this._target:this._last;return i>=0&&!this.underflow&&(t&&"first"!==t||i>this.index(s)||this.tail&&!this.inTail)?!0:!1},hasPrev:function(){if(!1===this._trigger("hasprev"))return!0;var t=this.options("wrap");return this.items().length>0&&!this.underflow&&(t&&"last"!==t||this.index(this._first)>0||this.tail&&this.inTail)?!0:!1},clipping:function(){return this._element["inner"+(this.vertical?"Height":"Width")]()},dimension:function(t){return t["outer"+(this.vertical?"Height":"Width")](!0)},scroll:function(i,s,e){if(this.animating)return this;if(!1===this._trigger("scroll",null,[i,s]))return this;t.isFunction(s)&&(e=s,s=!0);var r=t.jCarousel.parseTarget(i);if(r.relative){var n,o,l,a,h,u,c,f,d=this.items().length-1,_=Math.abs(r.target),p=this.options("wrap");if(r.target>0){var g=this.index(this._last);if(g>=d&&this.tail)this.inTail?"both"===p||"last"===p?this._scroll(0,s,e):t.isFunction(e)&&e.call(this,!1):this._scrollTail(s,e);else if(n=this.index(this._target),this.underflow&&n===d&&("circular"===p||"both"===p||"last"===p)||!this.underflow&&g===d&&("both"===p||"last"===p))this._scroll(0,s,e);else if(l=n+_,this.circular&&l>d){for(f=d,h=this.items().get(-1);l>f++;)h=this.items().eq(0),u=this._visible.index(h)>=0,u&&h.after(h.clone(!0).attr("data-jcarousel-clone",!0)),this.list().append(h),u||(c={},c[this.lt]=this.dimension(h),this.moveBy(c)),this._items=null;this._scroll(h,s,e)}else this._scroll(Math.min(l,d),s,e)}else if(this.inTail)this._scroll(Math.max(this.index(this._first)-_+1,0),s,e);else if(o=this.index(this._first),n=this.index(this._target),a=this.underflow?n:o,l=a-_,0>=a&&(this.underflow&&"circular"===p||"both"===p||"first"===p))this._scroll(d,s,e);else if(this.circular&&0>l){for(f=l,h=this.items().get(0);0>f++;){h=this.items().eq(-1),u=this._visible.index(h)>=0,u&&h.after(h.clone(!0).attr("data-jcarousel-clone",!0)),this.list().prepend(h),this._items=null;var v=this.dimension(h);c={},c[this.lt]=-v,this.moveBy(c)}this._scroll(h,s,e)}else this._scroll(Math.max(l,0),s,e)}else this._scroll(r.target,s,e);return this._trigger("scrollend"),this},moveBy:function(t,i){var e=this.list().position(),r=1,n=0;return this.rtl&&!this.vertical&&(r=-1,this.relative&&(n=this.list().width()-this.clipping())),t.left&&(t.left=e.left+n+s(t.left)*r+"px"),t.top&&(t.top=e.top+n+s(t.top)*r+"px"),this.move(t,i)},move:function(i,s){s=s||{};var e=this.options("transitions"),r=!!e,n=!!e.transforms,o=!!e.transforms3d,l=s.duration||0,a=this.list();if(!r&&l>0)return a.animate(i,s),void 0;var h=s.complete||t.noop,u={};if(r){var c={transitionDuration:a.css("transitionDuration"),transitionTimingFunction:a.css("transitionTimingFunction"),transitionProperty:a.css("transitionProperty")},f=h;h=function(){t(this).css(c),f.call(this)},u={transitionDuration:(l>0?l/1e3:0)+"s",transitionTimingFunction:e.easing||s.easing,transitionProperty:l>0?function(){return n||o?"all":i.left?"left":"top"}():"none",transform:"none"}}o?u.transform="translate3d("+(i.left||0)+","+(i.top||0)+",0)":n?u.transform="translate("+(i.left||0)+","+(i.top||0)+")":t.extend(u,i),r&&l>0&&a.one("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",h),a.css(u),0>=l&&a.each(function(){h.call(this)})},_scroll:function(i,s,e){if(this.animating)return t.isFunction(e)&&e.call(this,!1),this;if("object"!=typeof i?i=this.items().eq(i):i.jquery===void 0&&(i=t(i)),0===i.length)return t.isFunction(e)&&e.call(this,!1),this;this.inTail=!1,this._prepare(i);var r=this._position(i),n=this.list().position()[this.lt];if(r===n)return t.isFunction(e)&&e.call(this,!1),this;var o={};return o[this.lt]=r+"px",this._animate(o,s,e),this},_scrollTail:function(i,s){if(this.animating||!this.tail)return t.isFunction(s)&&s.call(this,!1),this;var e=this.list().position()[this.lt];this.rtl&&this.relative&&!this.vertical&&(e+=this.list().width()-this.clipping()),this.rtl&&!this.vertical?e+=this.tail:e-=this.tail,this.inTail=!0;var r={};return r[this.lt]=e+"px",this._update({target:this._target.next(),fullyvisible:this._fullyvisible.slice(1).add(this._visible.last())}),this._animate(r,i,s),this},_animate:function(i,s,e){if(e=e||t.noop,!1===this._trigger("animate"))return e.call(this,!1),this;this.animating=!0;var r=this.options("animation"),n=t.proxy(function(){this.animating=!1;var t=this.list().find("[data-jcarousel-clone]");t.length>0&&(t.remove(),this._reload()),this._trigger("animateend"),e.call(this,!0)},this),o="object"==typeof r?t.extend({},r):{duration:r},l=o.complete||t.noop;return s===!1?o.duration=0:t.fx.speeds[o.duration]!==void 0&&(o.duration=t.fx.speeds[o.duration]),o.complete=function(){n(),l.call(this)},this.move(i,o),this},_prepare:function(i){var e,r,n,o,l=this.index(i),a=l,h=this.dimension(i),u=this.clipping(),c=this.vertical?"bottom":this.rtl?"left":"right",f=this.options("center"),d={target:i,first:i,last:i,visible:i,fullyvisible:u>=h?i:t()};if(f&&(h/=2,u/=2),u>h)for(;;){if(e=this.items().eq(++a),0===e.length){if(!this.circular)break;if(e=this.items().eq(0),i.get(0)===e.get(0))break;if(r=this._visible.index(e)>=0,r&&e.after(e.clone(!0).attr("data-jcarousel-clone",!0)),this.list().append(e),!r){var _={};_[this.lt]=this.dimension(e),this.moveBy(_)}this._items=null}if(o=this.dimension(e),0===o)break;if(h+=o,d.last=e,d.visible=d.visible.add(e),n=s(e.css("margin-"+c)),u>=h-n&&(d.fullyvisible=d.fullyvisible.add(e)),h>=u)break}if(!this.circular&&!f&&u>h)for(a=l;;){if(0>--a)break;if(e=this.items().eq(a),0===e.length)break;if(o=this.dimension(e),0===o)break;if(h+=o,d.first=e,d.visible=d.visible.add(e),n=s(e.css("margin-"+c)),u>=h-n&&(d.fullyvisible=d.fullyvisible.add(e)),h>=u)break}return this._update(d),this.tail=0,f||"circular"===this.options("wrap")||"custom"===this.options("wrap")||this.index(d.last)!==this.items().length-1||(h-=s(d.last.css("margin-"+c)),h>u&&(this.tail=h-u)),this},_position:function(t){var i=this._first,s=i.position()[this.lt],e=this.options("center"),r=e?this.clipping()/2-this.dimension(i)/2:0;return this.rtl&&!this.vertical?(s-=this.relative?this.list().width()-this.dimension(i):this.clipping()-this.dimension(i),s+=r):s-=r,!e&&(this.index(t)>this.index(i)||this.inTail)&&this.tail?(s=this.rtl&&!this.vertical?s-this.tail:s+this.tail,this.inTail=!0):this.inTail=!1,-s},_update:function(i){var s,e=this,r={target:this._target,first:this._first,last:this._last,visible:this._visible,fullyvisible:this._fullyvisible},n=this.index(i.first||r.first)<this.index(r.first),o=function(s){var o=[],l=[];i[s].each(function(){0>r[s].index(this)&&o.push(this)}),r[s].each(function(){0>i[s].index(this)&&l.push(this)}),n?o=o.reverse():l=l.reverse(),e._trigger(s+"in",t(o)),e._trigger(s+"out",t(l)),e["_"+s]=i[s]};for(s in i)o(s);return this}})}(jQuery,window),function(t){"use strict";t.jcarousel.fn.scrollIntoView=function(i,s,e){var r,n=t.jCarousel.parseTarget(i),o=this.index(this._fullyvisible.first()),l=this.index(this._fullyvisible.last());if(r=n.relative?0>n.target?Math.max(0,o+n.target):l+n.target:"object"!=typeof n.target?n.target:this.index(n.target),o>r)return this.scroll(r,s,e);if(r>=o&&l>=r)return t.isFunction(e)&&e.call(this,!1),this;for(var a,h=this.items(),u=this.clipping(),c=this.vertical?"bottom":this.rtl?"left":"right",f=0;;){if(a=h.eq(r),0===a.length)break;if(f+=this.dimension(a),f>=u){var d=parseFloat(a.css("margin-"+c))||0;f-d!==u&&r++;break}if(0>=r)break;r--}return this.scroll(r,s,e)}}(jQuery),function(t){"use strict";t.jCarousel.plugin("jcarouselControl",{_options:{target:"+=1",event:"click",method:"scroll"},_active:null,_init:function(){this.onDestroy=t.proxy(function(){this._destroy(),this.carousel().one("jcarousel:createend",t.proxy(this._create,this))},this),this.onReload=t.proxy(this._reload,this),this.onEvent=t.proxy(function(i){i.preventDefault();var s=this.options("method");t.isFunction(s)?s.call(this):this.carousel().jcarousel(this.options("method"),this.options("target"))},this)},_create:function(){this.carousel().one("jcarousel:destroy",this.onDestroy).on("jcarousel:reloadend jcarousel:scrollend",this.onReload),this._element.on(this.options("event")+".jcarouselcontrol",this.onEvent),this._reload()},_destroy:function(){this._element.off(".jcarouselcontrol",this.onEvent),this.carousel().off("jcarousel:destroy",this.onDestroy).off("jcarousel:reloadend jcarousel:scrollend",this.onReload)},_reload:function(){var i,s=t.jCarousel.parseTarget(this.options("target")),e=this.carousel();if(s.relative)i=e.jcarousel(s.target>0?"hasNext":"hasPrev");else{var r="object"!=typeof s.target?e.jcarousel("items").eq(s.target):s.target;i=e.jcarousel("target").index(r)>=0}return this._active!==i&&(this._trigger(i?"active":"inactive"),this._active=i),this}})}(jQuery),function(t){"use strict";t.jCarousel.plugin("jcarouselPagination",{_options:{perPage:null,item:function(t){return'<a href="#'+t+'">'+t+"</a>"},event:"click",method:"scroll"},_carouselItems:null,_pages:{},_items:{},_currentPage:null,_init:function(){this.onDestroy=t.proxy(function(){this._destroy(),this.carousel().one("jcarousel:createend",t.proxy(this._create,this))},this),this.onReload=t.proxy(this._reload,this),this.onScroll=t.proxy(this._update,this)},_create:function(){this.carousel().one("jcarousel:destroy",this.onDestroy).on("jcarousel:reloadend",this.onReload).on("jcarousel:scrollend",this.onScroll),this._reload()},_destroy:function(){this._clear(),this.carousel().off("jcarousel:destroy",this.onDestroy).off("jcarousel:reloadend",this.onReload).off("jcarousel:scrollend",this.onScroll),this._carouselItems=null},_reload:function(){var i=this.options("perPage");if(this._pages={},this._items={},t.isFunction(i)&&(i=i.call(this)),null==i)this._pages=this._calculatePages();else for(var s,e=parseInt(i,10)||0,r=this._getCarouselItems(),n=1,o=0;;){if(s=r.eq(o++),0===s.length)break;this._pages[n]=this._pages[n]?this._pages[n].add(s):s,0===o%e&&n++}this._clear();var l=this,a=this.carousel().data("jcarousel"),h=this._element,u=this.options("item"),c=this._getCarouselItems().length;t.each(this._pages,function(i,s){var e=l._items[i]=t(u.call(l,i,s));e.on(l.options("event")+".jcarouselpagination",t.proxy(function(){var t=s.eq(0);if(a.circular){var e=a.index(a.target()),r=a.index(t);parseFloat(i)>parseFloat(l._currentPage)?e>r&&(t="+="+(c-e+r)):r>e&&(t="-="+(e+(c-r)))}a[this.options("method")](t)},l)),h.append(e)}),this._update()},_update:function(){var i,s=this.carousel().jcarousel("target");t.each(this._pages,function(t,e){return e.each(function(){return s.is(this)?(i=t,!1):void 0}),i?!1:void 0}),this._currentPage!==i&&(this._trigger("inactive",this._items[this._currentPage]),this._trigger("active",this._items[i])),this._currentPage=i},items:function(){return this._items},reloadCarouselItems:function(){return this._carouselItems=null,this},_clear:function(){this._element.empty(),this._currentPage=null},_calculatePages:function(){for(var t,i,s=this.carousel().data("jcarousel"),e=this._getCarouselItems(),r=s.clipping(),n=0,o=0,l=1,a={};;){if(t=e.eq(o++),0===t.length)break;i=s.dimension(t),n+i>r&&(l++,n=0),n+=i,a[l]=a[l]?a[l].add(t):t}return a},_getCarouselItems:function(){return this._carouselItems||(this._carouselItems=this.carousel().jcarousel("items")),this._carouselItems}})}(jQuery),function(t){"use strict";t.jCarousel.plugin("jcarouselAutoscroll",{_options:{target:"+=1",interval:3e3,autostart:!0},_timer:null,_init:function(){this.onDestroy=t.proxy(function(){this._destroy(),this.carousel().one("jcarousel:createend",t.proxy(this._create,this))},this),this.onAnimateEnd=t.proxy(this.start,this)},_create:function(){this.carousel().one("jcarousel:destroy",this.onDestroy),this.options("autostart")&&this.start()},_destroy:function(){this.stop(),this.carousel().off("jcarousel:destroy",this.onDestroy)},start:function(){return this.stop(),this.carousel().one("jcarousel:animateend",this.onAnimateEnd),this._timer=setTimeout(t.proxy(function(){this.carousel().jcarousel("scroll",this.options("target"))},this),this.options("interval")),this},stop:function(){return this._timer&&(this._timer=clearTimeout(this._timer)),this.carousel().off("jcarousel:animateend",this.onAnimateEnd),this}})}(jQuery);



/**
 * Copyright (c) 2007-2015 Ariel Flesler - aflesler<a>gmail<d>com | http://flesler.blogspot.com
 * Licensed under MIT
 * @author Ariel Flesler
 * @version 2.1.1
 */
(function(f){"use strict";"function"===typeof define&&define.amd?define(["jquery"],f):"undefined"!==typeof module&&module.exports?module.exports=f(require("jquery")):f(jQuery)})(function($){"use strict";function n(a){return!a.nodeName||-1!==$.inArray(a.nodeName.toLowerCase(),["iframe","#document","html","body"])}function h(a){return $.isFunction(a)||$.isPlainObject(a)?a:{top:a,left:a}}var p=$.scrollTo=function(a,d,b){return $(window).scrollTo(a,d,b)};p.defaults={axis:"xy",duration:0,limit:!0};$.fn.scrollTo=function(a,d,b){"object"=== typeof d&&(b=d,d=0);"function"===typeof b&&(b={onAfter:b});"max"===a&&(a=9E9);b=$.extend({},p.defaults,b);d=d||b.duration;var u=b.queue&&1<b.axis.length;u&&(d/=2);b.offset=h(b.offset);b.over=h(b.over);return this.each(function(){function k(a){var k=$.extend({},b,{queue:!0,duration:d,complete:a&&function(){a.call(q,e,b)}});r.animate(f,k)}if(null!==a){var l=n(this),q=l?this.contentWindow||window:this,r=$(q),e=a,f={},t;switch(typeof e){case "number":case "string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(e)){e= h(e);break}e=l?$(e):$(e,q);if(!e.length)return;case "object":if(e.is||e.style)t=(e=$(e)).offset()}var v=$.isFunction(b.offset)&&b.offset(q,e)||b.offset;$.each(b.axis.split(""),function(a,c){var d="x"===c?"Left":"Top",m=d.toLowerCase(),g="scroll"+d,h=r[g](),n=p.max(q,c);t?(f[g]=t[m]+(l?0:h-r.offset()[m]),b.margin&&(f[g]-=parseInt(e.css("margin"+d),10)||0,f[g]-=parseInt(e.css("border"+d+"Width"),10)||0),f[g]+=v[m]||0,b.over[m]&&(f[g]+=e["x"===c?"width":"height"]()*b.over[m])):(d=e[m],f[g]=d.slice&& "%"===d.slice(-1)?parseFloat(d)/100*n:d);b.limit&&/^\d+$/.test(f[g])&&(f[g]=0>=f[g]?0:Math.min(f[g],n));!a&&1<b.axis.length&&(h===f[g]?f={}:u&&(k(b.onAfterFirst),f={}))});k(b.onAfter)}})};p.max=function(a,d){var b="x"===d?"Width":"Height",h="scroll"+b;if(!n(a))return a[h]-$(a)[b.toLowerCase()]();var b="client"+b,k=a.ownerDocument||a.document,l=k.documentElement,k=k.body;return Math.max(l[h],k[h])-Math.min(l[b],k[b])};$.Tween.propHooks.scrollLeft=$.Tween.propHooks.scrollTop={get:function(a){return $(a.elem)[a.prop]()}, set:function(a){var d=this.get(a);if(a.options.interrupt&&a._last&&a._last!==d)return $(a.elem).stop();var b=Math.round(a.now);d!==b&&($(a.elem)[a.prop](b),a._last=this.get(a))}};return p});


// JavaScript Document
// Created by Nick D - 03.21.2014 - Version 0.5
// designed to keep image aspect ratio inside set divs or as a body background
//
//sample html:
/*
<div class="image-holder">
	<img src="whatever/image.jpg" />
</div>

notes:
1) that object holding the div MUST have a declared height (which is the whole point of this plugin) unless it is going to be a full screen background image.
2) the image should be the direct child of the object that it will be filling unless a class is declared on the image and/or a targetFill object is declared

*/
(function($){$.fn.backFill=function(options,c){return this.each(function(){var settings=$.extend({targetImage:"",targetFill:"",isFullScreen:false,verticallyCenter:false,onComplete:function(){}},options);var $theImage,$theObject,$theContainer,imageRatio,objHeight,objWidth,objRatio;$theImage=settings.targetImage.length?$(this).find("img"+settings.targetImage):$(this).find("img:first");$theImageContainer=$theImage.parent();$theObject=settings.targetFill.length?$(settings.targetFill):$theImage.parent();$theObject.css({overflow:"hidden"});imageRatio=$theImage.width()/$theImage.height();if(settings.isFullScreen){$theObject.css({position:"fixed"})}if(settings.targetFill.length){$theImageContainer.css({position:"absolute",left:0,top:0,"z-index":1,width:"100%"});$theObject.css({position:"relative"})}resizeImage();var resizeWaitInterval;$(window).resize(function(){clearTimeout(resizeWaitInterval);resizeWaitInterval=setTimeout(resizeImage,100)});function resizeImage(){objHeight=$theObject.outerHeight();objWidth=$theObject.outerWidth();objRatio=objWidth/objHeight;objRatio>imageRatio?$theImage.css({width:"100%",height:Math.round(objWidth/imageRatio)}):$theImage.css({width:Math.round(objHeight*imageRatio),height:objHeight});$theImage.width()>objWidth?$theImage.css({"margin-left":(objWidth-$theImage.width())/2}):$theImage.css({"margin-left":0});if(settings.verticallyCenter){objHeight<$theImage.height()?$theImage.css({"margin-top":($theImage.height()-objHeight)/2*-1}):$theImage.css({"margin-top":0})}settings.onComplete.call(this)}})}})(jQuery);


$(document).ready(function() {

	//main navigation hover functions
	$("#mainNav > ul > li").hoverIntent( makeTall, makeShort );

     //main navigation Mega Menu focus functions when tabs are used for accessibility
    $("#mainNav > ul > li a").focus( function(e){
		var windowWidth = $(window).width();
        $(this).parent().siblings().find('.dropdown[style="display: block;"]').hide();

        if ($(this).siblings('.dropdown').length > 0 && windowWidth > 991){
            $('.nav-wrap').attr('style','');
		    $('.nav-wrap').addClass('on');
		    $('header').addClass('alt');
            $(this).siblings('.dropdown').stop(true,true).fadeIn('fast');
		    theDropdown = $(this).siblings('.dropdown').outerHeight();
            var theTotal = theDropdown + 110;
            $('.nav-wrap').css({'height':theTotal});
        } else if (windowWidth < 991){
            e.stopPropagation();
            if ($(this).siblings('.dropdown').length > 0){
                $(this).parent().siblings().children('.dropdown.visible').removeClass('visible');
                $(this).siblings('.dropdown').addClass('visible');
                $('.nav-wrap').addClass('out');
        	    $('.icon-hamburger').addClass('out');
                $('.bulk-wrap').addClass('out');
            }

        }
      }).blur(function(){
        // sub menu on focus function
        $("#mainNav > ul > li .dropdown li a").focus(function(){
            var windowWidth = $(window).width();
            if (windowWidth > 991){
                $('.nav-wrap').attr('style','');
                $('.nav-wrap').addClass('on');
                $('header').addClass('alt');
                theDropdown = $(this).parents().find('.dropdown').outerHeight();
                var theTotal = theDropdown + 110;
                $('.nav-wrap').css({'height':theTotal});
            }
        });
    });

    //if the template has no hero image, resolve focus overlap issue, if homeCarouseel, pagecontent, videoCarousel blur out

    $(".breadcrumb-wrap li:first-child a, #homeCarousel a, #pagecontent a, .videoCarousel a").focus(function(e){
        e.stopPropagation();
        $('.nav-wrap.on').removeClass("on");
        $('.navbar-nav .dropdown').hide();
        navHide();
    });

    // mobile menu on focus
     if ($(window).width() < 991){
         $("a.icon-hamburger, .relatedlinks a, .mobile-bread a, .nav-wrap a.close.close-bottom.icon-close").focus(function(e){
            e.stopPropagation();
			$('.nav-wrap').addClass('out');
        	$('.icon-hamburger').addClass('out');
            $('.bulk-wrap').addClass('out');
   		 });



		//interior template side nav mobile on focus, open the drop down
        $('.sidenav-toggle').focus(function(){
            $(this).addClass('open')
                   .next().attr('style', "display: block");
        });
		//when focus move out of side nav, close the drop down
         var $sideNavOut = $('.sidenav.section'),
			 $sideNavOutP = $('.sidenav.section').parents();

		 $sideNavOutP.add($sideNavOut).siblings().find('a').focus(function(){
            $('.sidenav-toggle').removeClass('open')
                                .next().attr('style', "display: none");
        });

    }


    // Audience manager tab drop down
    //BC Audiece button focus
    $('button.bc-link-button-wcmode').focus( function(){
		$(this).find('.btn-group').addClass('open')
                                  .find('>div').attr('aria-expanded', 'true');

    });
    $('button.bc-link-button-wcmode').mouseleave( function(){
        $(this).find('.btn-group').removeClass('open')
                                  .find('>div').attr('aria-expanded', 'false');
        document.activeElement.blur();
    });

    //BC Search Menu on focus
    $('.navbar-nav .search a').focus(function(){
		$('button.bc-link-button-wcmode').find('.btn-group').removeClass('open')
                                  .find('>div').attr('aria-expanded', 'false');
		$('header .search-wrap').show();
        $('header .search-wrap a').eq(0).focus();
    });

	$('header .search-wrap a.icon-close').focus(function(){
        $('header .search-wrap').hide();
        $(".utility .menu a.icon-menu").focus();
    });

    //BC link
    $('a.icon-menu').focus(function() {
   		$('.menu-wrap').show();
        $('#menuLogo a, .menu-wrap .row>div:first-child>ul.links2:first-child >li:first-child > a').focus();

    });
    $('.menu-wrap a.icon-close.bottom-close').focus(function(){
        $('.menu-wrap').hide();
        $("#mainNav > ul > li:nth-child(2) > a").focus();

    });
    $('.menu-wrap a.icon-close').focus(function(){
        $('.menu-wrap').hide();
    });
    $('#bcLink a').click(function(){
		$('#bcLink_content').toggleClass('on');
		$('#bcLink .row').toggleClass('changeColor');
    });
    $('#bcLink a').focus(function(){
        $('#bcLink_content').toggleClass('on');
		$('#bcLink .row').toggleClass('changeColor');
    });



	//utility search click event
    $('nav.utility li.search, .search-wrap .icon-close').on('mousedown', function(e) {
		e.preventDefault();

		$('nav.utility li.search').toggleClass('on');
		$('.search-wrap').slideToggle('fast');
        $('.search-form input[type="text"]').focus();

		$('nav.utility li.menu').removeClass('on');
		$('.menu-wrap').slideUp('fast');
		navHide();
	});

	//utility menu click event
	$('nav.utility li.menu, .menu-wrap .icon-close').on('mousedown', function(e) {
		e.preventDefault();
		$('nav.utility li.menu').toggleClass('on');
		$('.menu-wrap').slideToggle('fast');
		$('.menu-wrap #menuLogo a').focus();

		$('nav.utility li.search').removeClass('on');
		$('.search-wrap').slideUp('fast');
		navHide();
	});


	// mobile navigation toggle
	var $navButton = $('.icon-hamburger');
	var $navWrap = $('header .nav-wrap');
	var $bulkWrap = $('.bulk-wrap');
	var $breadHome = $('header .nav-wrap .mobile-bread .home');
	var $breadBack = $('header .nav-wrap .mobile-bread .back');
	var $navClose = $('header .nav-wrap .close, header .nav-wrap .mobile-bread .home');
	var $navBack = $('header .nav-wrap .mobile-bread .back');
	var $mainNav = $('header #mainNav .navbar-nav'); // the main navigation ul
	var $sideNav = $('#sideNav .sidenav-wrap'); // side navigation
	var $newsNav = $('.news-wrap #sideNav'); // news side navigation
	var $detNav = $('.news-detail #sideNav'); //news detail navigation
	var $navCurrent = $('#mainNav li.current'); //current item
	var $isFourth;
	var $isFifth;
    var $isSixth;


	// the hamburger navigation toggle
	$navButton.click(function(e){
		e.preventDefault();
		$navButton.toggleClass('out');
		$navWrap.toggleClass('out');
		$bulkWrap.toggleClass('out');
	});

	// close buttons within the nav wrapper
	$navClose.click(function(e){
		e.preventDefault();
		navHide();
	});
    var windowWidth = $(window).width();
    if (windowWidth < 991){
        $navClose.focus(function(){
            navHide();
            $('.sidenav-toggle').focus();
        });
    }

	// slide nav out to view subnav
	$mainNav.find('li > a').on('click','span', function(e){
		e.preventDefault();

        $isFourth = $(this).closest('li').hasClass("fourth");
        $isFifth = $(this).closest('li').hasClass("fifth");
        $isSixth = $(this).closest('li').hasClass("sixth");

		//if we're at root going to 2nd tier
		if (!$mainNav.hasClass('nav-slide')){
			$mainNav.addClass('nav-slide');
			$(this).closest('li').find('> .dropdown').addClass('visible');
			$breadBack.show();
			$breadHome.hide();
		} else{//if we're at 2nd tier going to 3rd tier
		    $(this).closest('.dropdown.visible').addClass('push-more child'); //added child
			$(this).closest('li').find('> .dropdown').addClass('visible push-more'); //added push-more
		}
		if ($isFourth || $isFifth || $isSixth) { //if we're at 4th, 5th, or 6th levels, add "more" class to dropdown div when navigating to a child.
            $(this).closest('.dropdown.visible.push-more').addClass('more');
		}

		heightFix();


		//this hides the search/utility menu HOWEVER menu button should not be visible is search/utility are open. this is here for precaution
		$('nav.utility li.menu').removeClass('on');
		$('.menu-wrap').slideUp('fast');
		$('nav.utility li.search').removeClass('on');
		$('.search-wrap').slideUp('fast');

	});


	// slide back to view root nav in mobile view
	$navBack.click(function(e){
		e.preventDefault();
		//set last tiers

		if ($('.fourth.dropdown').hasClass('visible') && !$('.fourth.dropdown').hasClass('more')){
            $isFourth = true;
            $isFifth = false;
            $isSixth = false;
        }
        else if ($('.fourth.dropdown').hasClass('more') && !$('.fifth.dropdown').hasClass('more')){
		    $isFourth = false;
		    $isFifth = true;
		    $isSixth = false;

            if ($('.fourth.dropdown').hasClass('lastlevel')){
                $isFourth = true;
                $isFifth = false;
                $isSixth = false;
            }
		}
		else if ($('.fifth').hasClass('more')){
            $isFifth = false;
            $isSixth = true;
        }
        else {
            $isFourth = false;
            $isFifth = false;
            $isSixth = false;
        }

        //checks for 5th and 6th tier
        if (!$isFifth && !$isSixth) {

            //first checks if we're at 3rd tier
            if (!$mainNav.find('.dropdown').hasClass('push-more')){
                $breadBack.hide();
                $breadHome.show();
                $mainNav.removeClass('nav-slide');
                setTimeout(function() {
                   $mainNav.find('.dropdown').removeClass('visible');
                   heightFix();
                }, 300);
            } if ($mainNav.find('.dropdown.push-more').hasClass('child')){

                $mainNav.find('.dropdown.push-more.child .dropdown.push-more').removeClass('push-more');
                $mainNav.find('.dropdown.visible.push-more').removeClass('push-more');
                $mainNav.find('.dropdown.child').removeClass('child');
                setTimeout(function() {
                   $mainNav.find('.dropdown.child ul .dropdown').removeClass('visible');
                   heightFix();
                }, 300);
            } //first checks if we're at last tier
        }

		if ($isFifth) { //if fifth level, go back to 4th level
		    $('.fourth.more .fifth.visible').removeClass('visible');
		    $('.fourth.more').removeClass('more');
		    heightFix();
		} else if ($isSixth) { //if sixth level, go back to 5th level
            $('.fifth.more .sixth.visible').removeClass('visible');
            $('.fifth.more').removeClass('more');
            heightFix();
        }
        else {
            if ($navCurrent.closest('.dropdown').hasClass('lastlevel')){
                $navCurrent.closest('.dropdown').removeClass('visible');
                setTimeout(function() {
                   $navCurrent.closest('.dropdown').removeClass('visible');
                   heightFix();
                }, 300);
            }else { //defaults to 2nd tier hiding
                $mainNav.find('.dropdown.push-more').removeClass('push-more');
                setTimeout(function() {
                   $mainNav.find('.dropdown ul .dropdown').removeClass('visible');
                   heightFix();
                }, 300);
            }
        }

	});

	//mobile navigation height fixing for subnavs

	function heightFix(){
		var theHeight;
		if ($mainNav.find('>li .dropdown').hasClass('push-more') && !$mainNav.find('>li .dropdown.push-more').hasClass('child')){
			theHeight = $mainNav.find('.dropdown.visible.push-more').height();

		} else if ($mainNav.hasClass('nav-slide') && !$mainNav.find('>li .dropdown.push-more').hasClass('child')){
			theHeight = $mainNav.find('.dropdown.visible').height();
        //fix 2
		} else if ($mainNav.find('>li .dropdown.push-more').hasClass('child')) {
            theHeight = $('.dropdown.push-more.child .dropdown.push-more').not('.child.more').outerHeight(true);

            if(('.dropdown.push-more.child.visible .dropdown.push-more').length == 0){
                theHeight = $('.dropdown.push-more.child.visible').outerHeight(true);
            }
        }
		else {
            theHeight = $mainNav.closest('#mainNav .navbar-nav').outerHeight(true);
        }

		theHeight = theHeight + 50;
		$mainNav.closest('#mainNav').height(theHeight);

	}

	//hide mobile navigation
	function navHide(){

		$navButton.removeClass('out');
		$navWrap.removeClass('out');
		$bulkWrap.removeClass('out');

		heightFix();
		$('#sideNav').removeClass('open');
		$('#mainNav').attr('style','');

	}


	// add spans to list items that have dropdowns (subnavs)
	// add mobile titles to each subnav. only visible in mobile view
	$mainNav.find('> li .dropdown').each(function(){
		var theTitle = $(this).prev().text();
		$(this).prev('a').append('<span></span>');

		//$(this).find('> div > .row > div:first-child > ul').prepend('<li class="title"><h5>'+theTitle+'</h5></li>');
		$(this).find('> div > .row > div:first-child').prepend('<h5>'+theTitle+'</h5>');
	});

	$mainNav.prepend('<li class="title">Home</li>');

	//news side nav, append spans for side nav dropdown
	$newsNav.find('li.has-children > a').each(function(){
		$(this).append('<span></span>');
	});

    $('.news-wrap #sideNav .nav-wrap li.has-children span').click(function(e) {
        e.preventDefault();
        var parentListItem = $(this).closest('li.has-children');
        var subList = parentListItem.find('ul');
        parentListItem.toggleClass('open');
        subList.slideToggle('fast');
    });


    //mobile test
    var isMobile = {
        Android: function() {
            return navigator.userAgent.match(/Android/i);
        },
        BlackBerry: function() {
            return navigator.userAgent.match(/BlackBerry/i);
        },
        iOS: function() {
            return navigator.userAgent.match(/iPhone|iPad|iPod/i);
        },
        Opera: function() {
            return navigator.userAgent.match(/Opera Mini/i);
        },
        Windows: function() {
            return navigator.userAgent.match(/IEMobile/i);
        },
        any: function() {
            return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows());
        }
    };


	//run resize functions
	var resizeTimer;
	$(window).resize(function(){
		clearTimeout(resizeTimer);
		resizeTimer = setTimeout(function() {
			if(isMobile.any()) {
				//do nothing
			} else{
				navHide();
			}
		}, 300);
	});


	//interior side nav opening
	$('#sideNav .sidenav-toggle').click(function(e){
		e.preventDefault();
		$(this).toggleClass('open').next('.sidenav-wrap').slideToggle('fast');
	});

	//interior news nav opening
	$('.news-sub-header .news-navigation-toggle, #sideNav .close').click(function(e){
		e.preventDefault();
		if ($('#sideNav').hasClass('open')){
			navHide();
		} else{
			$('#sideNav').toggleClass('open');
		}
	});

	//news-detail dropdown nav
	$('.channel').click(function(e){
		e.preventDefault();
		if ($(this).hasClass('open')){
			$detNav.slideUp('fast');
			$(this).removeClass('open');
		} else {
			$detNav.slideDown('fast');
			$(this).addClass('open');
		}
	});
	$('.news-navigation-toggle').click(function(e){
		e.preventDefault();
		$(this).toggleClass('open');
	});
    $('nav#sideNav.side-nav > .close').click(function(e){
		e.preventDefault();
        $(this).removeClass('open');
	});

    if($(window).width() > 991) {
        var firstHeight = $('.int-wrap .whats-section .col-md-7 .col-md-6:first-child .callout-box.section:first-child > a').height();
        var secondHeight = $('.int-wrap .whats-section .col-md-7 .col-md-6 + .col-md-6 .callout-box.section:first-child > a').height();
        var heightMatch = $(firstHeight > secondHeight ? firstHeight : secondHeight);
        $('.int-wrap .whats-section .col-md-7 .col-md-6.col-sm-6.col-xs-12 .callout-box.section:first-child > a').css('height',heightMatch[0]+'px');
    }
    $('.article.col-sm-12 img').each(function() {
        if($(this).get(0).src == '') {
            $(this).css('height','1px');
        }
    });

    $('.news-wrap #sideNav .nav-wrap ul li > a').mouseenter(function() {
        $(this).addClass('mouse-enter');
    });
    $('.news-wrap #sideNav .nav-wrap ul li > a').mouseleave(function() {
        $(this).removeClass('mouse-enter');
    });
    $('.news-wrap #sideNav .nav-wrap ul li > a').touchstart(function() {
        $(this).addClass('mouse-enter');
    });
    $('.news-wrap #sideNav .nav-wrap ul li > a').touchmove(function() {
        $(this).removeClass('mouse-enter');
    });
    $('.news-wrap #sideNav .nav-wrap ul li > a').click(function() {
        $(this).removeClass('mouse-enter');
    });
    $('.news-wrap #sideNav .nav-wrap ul li.has-children > a + .subnav').mouseenter(function() {
        $(this).prev().addClass('mouse-enter');
    });
    $('.news-wrap #sideNav .nav-wrap ul li.has-children > a + .subnav').mouseleave(function() {
        $(this).prev().removeClass('mouse-enter');
    });


    //Retain tab toggle after linking off to external URL
	/*var hash = window.location.hash;
	hash && $('ul.nav a[href="' + hash + '"]').tab('show');
	$('.nav-tabs a').click(function (e) {
         e.preventDefault();
		window.location.hash = this.hash;
	});*/

    //Switch Slider and Back to top button
        //Check to if screen is scrolling down
        $(window).scroll(function(){
            if ($(this).scrollTop() > 300) {
                $('#back-to-top,.top-scroll').fadeIn();
            } else {
                $('#back-to-top,.top-scroll').fadeOut();
            }
        });
        //on click animate scrolltop
        $('#back-to-top, .top-scroll').click(function(){
            $('html, body').animate({scrollTop : 0},800);
            return false;
        });

     //mobile menu open animate scrolltop
    $('.menulabel').click(function(){
        $('.departments a.icon-hamburger >.deptHome').hide();
        $('html, body').animate({scrollTop : 0},800);
    });

     //selectpicker plugin function
	$('.selectpicker').selectpicker();

    // add hover state for touch on mobile
        document.body.addEventListener('touchstart',function(){},false);
});

 var myTimeOut;
    //main navigation hover on desktop
    function makeTall(){
        var theHeight = 0;
        var theDropdown = 0;
        var windowWidth = $(window).width();

        if ($(this).find('> .dropdown').length > 0 && windowWidth > 991){
            //if focus is on, step 1, remove focused display items
            $(this).parents().find('.dropdown[style="display: block;"]').hide();
            //if focus is on, step 2, set is as blur
            $(this).parents().find('a').blur();
            clearTimeout(myTimeOut);
            $('.nav-wrap').attr('style','');
            $('.nav-wrap').addClass('on');
            $('header').addClass('alt');

            $(this).find('> .dropdown').stop(true,true).fadeIn('fast');
            //theHeight = $('.nav-wrap').height();
            theDropdown = $(this).find('.dropdown').outerHeight();
            var theTotal = theDropdown + 110;
            $('.nav-wrap').css({'height':theTotal});

        } else {
            $('.nav-wrap').removeClass('on');
            $('header').removeClass('alt');
            $('.nav-wrap').attr('style','');
        }
    }

    //main navigation hover off desktop
    function makeShort(){
        var windowWidth = $(window).width();
        if (windowWidth > 991){
            myTimeOut=setTimeout(function() {
                $('.nav-wrap').removeClass('on');
                $('header').removeClass('alt');
                $('.nav-wrap').attr('style','');
            },300);
                $(this).find('> .dropdown').fadeOut(20, function(){
                $(this).attr('style',''); //removes display none so mobile subnav works properly if resized down then back up
            });
        }
    }


    function hoverFix() {
        var el = this;
        var par = el.parentNode;
        var next = el.nextSibling;
        par.removeChild(el);
        setTimeout(function() {par.insertBefore(el, next);}, 0)
    }

    //Create iframe for youtube
    function makeYoutubeIframe(div, vid) {
        var videoEmbed = '<iframe width="{0}" height="{1}" title="Video" src="https://www.youtube.com/embed/{2}?rel=0&amp;showinfo=0&amp;autoplay=1&amp;controls=0&amp;enablejsapi=1" frameborder="0" allowfullscreen></iframe>';
        var width = $(div).width();
        var height = $(div).height();
        var iframe = videoEmbed.format(width, height, vid);

        return iframe;
    }

    //function to dynamically adding scripts tags and only once
     function loadScriptOnce(ScriptSrc) {
    	 if ($('script[src="'+ScriptSrc+'"]').length == 0) { //create the script tag
            var createScript = document.createElement("script");
            createScript.src = ScriptSrc;
            $("head").append(createScript);
          }
     }



$(window).load(function(){
	//news home campaign backfill
	$('.news-detail .jumbotron .detail').backFill({
		verticallyCenter: true,
		targetFill: ".jumbotron"
	});
});
/*Match regex to Uppercase the first letter with exception of exc_match pattern */
navTitleDialog = function(field,value){
    "use strict";
    var  comp = field.findParentByType('dialog'),
         navTitle= comp.getField('./navTitle'), 
         navString = navTitle.getValue();

    //exception match with one white space before and after

	var exc_match = /((\s)(a|an|and|as|at|by|for|in|of|on|or|the|to|with))($|\s)/gi;

    //Capitalize the first letter
    var capStr = navString.replace(/[A-Za-z0-9_'-\u00C0-\u00FF]*/g, function(origStr){
         return origStr.charAt(0).toUpperCase() + origStr.substring(1);
         });
    //Add double white space when there is one single space, find whole word match begin and end with space
    capStr = capStr.replace(/\s/g,'\xa0\xa0');
    //lowercase the exception
     var match_title = capStr.charAt(0).toUpperCase()+capStr.substring(1).replace(exc_match, function(matchStr) {
        return matchStr.charAt(1).toLowerCase()+matchStr.substring(2);
    });
    //return to single space
    var final_title = match_title.replace(/\s\s/g, ' ');

    navTitle.setValue(final_title);

};

//Set a default Value for navTitle = jcr:title if navTitleV is an empty string
navTitleDefault = function(field,value){
	"use strict"; 
	var  comp = field.findParentByType('dialog'), 
		 navTitle = comp.getField('./navTitle'),
		 navTitleV = navTitle.getValue(), 
		 defaultV = comp.getField('./jcr:title').getValue(); 

	if (navTitleV == ''){

	    navTitle.setValue(defaultV);

    }

}

/*Match regex to Uppercase the first letter with exception of exc_match pattern */
navTitleDialog = function(field,value){
    "use strict";
    var  comp = field.findParentByType('dialog'),
         navTitle= comp.getField('./navTitle'), 
         navString = navTitle.getValue();

    //exception match with one white space before and after

	var exc_match = /((\s)(a|an|and|as|at|by|for|in|of|on|or|the|to|with))($|\s)/gi;

    //Capitalize the first letter
    var capStr = navString.replace(/[A-Za-z0-9_'-\u00C0-\u00FF]*/g, function(origStr){
         return origStr.charAt(0).toUpperCase() + origStr.substring(1);
         });
    //Add double white space when there is one single space, find whole word match begin and end with space
    capStr = capStr.replace(/\s/g,'\xa0\xa0');
    //lowercase the exception
     var match_title = capStr.charAt(0).toUpperCase()+capStr.substring(1).replace(exc_match, function(matchStr) {
        return matchStr.charAt(1).toLowerCase()+matchStr.substring(2);
    });
    //return to single space
    var final_title = match_title.replace(/\s\s/g, ' ');

    navTitle.setValue(final_title);

};

//Set a default Value for navTitle = jcr:title if navTitleV is an empty string
navTitleDefault = function(field,value){
	"use strict"; 
	var  comp = field.findParentByType('dialog'), 
		 navTitle = comp.getField('./navTitle'),
		 navTitleV = navTitle.getValue(), 
		 defaultV = comp.getField('./jcr:title').getValue(); 

	if (navTitleV == ''){

	    navTitle.setValue(defaultV);

    }

}

/*If it is a home page display the Page Level Field */
function setPageLevel(selection, isChecked){
    "use strict";

    var  theDialog = selection.findParentByType('dialog'),
         isHome = theDialog.getField('./isHome').getValue(),
         theLevel= theDialog.getField('./theLevel');

   if (isHome == "true")
       theLevel.show();
   else
       theLevel.hide();

};

function bc_addRandomImage(){
    var bannerPaths = document.querySelectorAll('#img-banner-src li');
    if( bannerPaths.length > 0){
        var randomNumBanner = Math.floor((Math.random() * bannerPaths.length));
        var banner = bannerPaths[randomNumBanner];
        var captionBS = '';
        if( banner.dataset.caption && banner.dataset.caption != null && banner.dataset.caption != ''){
            captionBS = banner.dataset.caption;
        }
        var linkBS = "";
        if( banner.dataset.link && banner.dataset.link != null && banner.dataset.link != ''){
            linkBS = banner.dataset.link;
        }
        var randomBanner = document.querySelector('.random-banner');
        randomBanner.style.backgroundImage = 'url("' + banner.dataset.path + '")';
        randomBanner.style.backgroundPositionX = banner.dataset.xfocus + '%';
        randomBanner.style.backgroundPositionY = banner.dataset.yfocus + '%';

        if(captionBS != "")
        {
            if( linkBS != "" )
            {
                $(".banner-caption").html("<a href='" + linkBS + "' class='randomImageBannerLink'>" + captionBS + "</a>");
            }
            else
            {
                $(".banner-caption").html(captionBS);
            }
        }
    }
}
/*If it is a home page display the Page Level Field */
function setPageLevel(selection, isChecked){
    "use strict";

    var  theDialog = selection.findParentByType('dialog'),
         isHome = theDialog.getField('./isHome').getValue(),
         theLevel= theDialog.getField('./theLevel');

   if (isHome == "true")
       theLevel.show();
   else
       theLevel.hide();

};

/*If it is a home page display the Page Level Field */
function setPageLevel(selection, isChecked){
    "use strict";

    var  theDialog = selection.findParentByType('dialog'),
         isHome = theDialog.getField('./isHome').getValue(),
         theLevel= theDialog.getField('./theLevel');

   if (isHome == "true")
       theLevel.show();
   else
       theLevel.hide();

};

$(document).ready(function (){
    // if the page is a newsletter   will be true
    // otherwise there is no reason to run the setup.
    if(typeof school_newsletter_page_bool !== 'undefined' && school_newsletter_page_bool){
        school_newsletter_page();
    }
});

function school_newsletter_page(){
    var videoContainer = $(".videoContainer");
    var gradient = $(".videoGradient");
    videoContainer.mouseenter(function() {
        gradient.css("display","none");
    });
    videoContainer.click(function() {
        gradient.css("display","none");
    });
    videoContainer.mouseleave(function() {
        gradient.css("display","block");
    });
}


/*** For New Alert Banner ***/

$(document).ready( function() {

    /*
    * get dates from JCR. If none, use fallback
    * touch UI uses different data type for date, so we need to set unique variables
    * for both classic and Touch UI, and compare. The assumption is that the latest
    * date is the most current, regardless of the source.
    *
    */
    var alertBanner = $('.alert-banner-content');
    var contentDate = alertBanner.data('content-date') || "1976-01-01" ;
    var touchUIContentDate = alertBanner.data('touch-content-date') || "1976-01-01";

    contentDate = Date.parse(contentDate);
    touchUIContentDate = Date.parse(touchUIContentDate);
    contentDate = (contentDate >= touchUIContentDate) ? contentDate : touchUIContentDate;
    var contentSeen = localStorage.getItem("contentSeen"); //get date of user's last banner dismissal from local storage
    //console.log("contentSeen " + contentSeen);

    /*
    // if there is no local storage OR
    // the see date is less than the date set by page properties
    // show the alert
    */
     if(contentSeen == null || contentSeen < contentDate ) {
        $('.alert-banner').css("display","block");
     }

    $('.alert-banner button').click( function() {
        $(this).closest('.alert-banner').addClass('hide'); //hide the banner
        var contentSeen = new Date();
        contentSeen = Date.parse(contentSeen);
        localStorage.setItem("contentSeen",contentSeen); //set today's date in localStorage
    });

    /*************************
        ANNOUNCEMENT BANNER
        If announcement-banner is on the page and the has not expired (date past expiration date.)
        if not seen, then announcement is visible
        if seen, then announcement is hidden, but the icon is visible
        clicking on close marks announcemnt as seen and records page url and date seen
        if the expiration date changes, assume new announcement and open by default
        If an update date is added the code checks that against the seen date. If update is different announcement displays.
        announcement can be closed by clicking on 'close' or by clicking icon.
        accouncement can be opened by clicking icon
        icon is always visible. only thing that can cover it is alert bar.
    **************************/
    var announcementBanner = $('.announcement-banner');
    var announcementBannerToday = new Date();
    var announcementExpirationDate = new Date($('.announcement-banner-content').data('expiration-date'));
    var announcementUpdateDate = new Date($('.announcement-banner-content').data('update-date'));
    var announcementBannerPathKey = 'announcement' + window.location.pathname;
    var announcementBannerUpdateKey = 'announcementUpdate' + window.location.pathname;
     //console.log('announcementUpdateDate ',announcementUpdateDate,' announcementExpirationDate', announcementExpirationDate, 'announcementBannerToday', announcementBannerToday,announcementExpirationDate > announcementBannerToday)

    /*
        If the accouncement banner is on the page, check if the expiration date is still good. Otherwise hide the expired announcment.
    */
    if((announcementBanner !== null && typeof announcementBanner !== 'undefined') && (announcementExpirationDate > announcementBannerToday)){
        //console.log('announcementExists')
        var announcementSeen;
        var announcementUpdateStoredDate;
        var dateSeen = localStorage.getItem(announcementBannerPathKey);
        var updateDate = localStorage.getItem(announcementBannerUpdateKey);
        var seenBoolean = (dateSeen !== null && dateSeen !== 'undefined');
        var updateBoolean = (updateDate !== null && updateDate !== 'undefined');
        // check if the banner has been seen
        if(seenBoolean){
            announcementSeen = new Date(dateSeen);
        }
        // check if an update date has been stored
        if(updateBoolean){
            announcementUpdateStoredDate = new Date(updateDate);
        }
        if(announcementSeen === null || typeof announcementSeen === 'undefined' || (updateBoolean && announcementUpdateStoredDate.getTime() !== announcementUpdateDate.getTime()) || (!updateBoolean && !isNaN(announcementUpdateDate.getTime())) ) {
            $('.announcement-banner-content').css("display","block");
         }
        else{
            toggleAnnouncement( $('.announcement-banner-content'), false);
        }
        $('.announcement-close').click( function() {
            var content = $('.announcement-banner-content');
            toggleAnnouncement(content, false); //hide the banner
            setAnnouncementSeen();
            console.log('announcementUpdateDate', announcementUpdateDate)
            if( !isNaN(announcementUpdateDate.getTime()) ){
                setAnnouncementUpdateDate();
                //console.log('setAnnouncementUpdateDate');
            }
        });
        // if teh announcement is open, close it and vice-versa
        // if it is open, mark it as seen
        $('.announcement-icon').click( function() {
            var content = $('.announcement-banner-content');
            if( !content.hasClass('hide') ){
                setAnnouncementSeen();
            }
            toggleAnnouncement(content, content.hasClass('hide') );
        });
    }
    else{
        //console.log('not seen');
        //console.log('accouncement',document.getElementById('announcement-banner'));
        if(document.getElementById('announcement-banner') != null ){
            document.getElementById('announcement-banner').style.display = 'none';
        }
    }

    function setAnnouncementSeen(){
        localStorage.setItem(announcementBannerPathKey,announcementBannerToday); //set value in localStorage
    }

    function setAnnouncementUpdateDate(){
        localStorage.setItem(announcementBannerUpdateKey,announcementUpdateDate); //set value in localStorage
    }

    // FALSE = seen, so true means toggle off
    function toggleAnnouncement( _content, _state ){
        if(_state){
            _content.removeClass('hide');
            _content.css('display','block');
        }
        else{
            _content.addClass('hide');
        }
    }
});
// addthis social media share
function addthisController(toolstyle) {

    if (toolstyle == "inline") {
      const removeFloat = setInterval(function(){
            const floatDesk = document.querySelector(".addthis-smartlayers.addthis-smartlayers-desktop");
			if (floatDesk !== undefined) {
                 floatDesk.remove();
                 clearInterval(removeFloat);
              }
		}, 500);

      const removeMobile =  setInterval(function(){
            const floatMobile = document.querySelector(".addthis-smartlayers.addthis-smartlayers-mobile");
			if (floatMobile!== undefined) {
                        floatMobile.remove();
                 clearInterval(removeMobile);
              }
		}, 500);

    } else {
		const inline = document.querySelector(".addthis_inline_share_toolbox");
		inline.remove();
    }
}
 /*
 *
 * send custom event to google analytics
 * args _dataObj an object with multiple properties
 * the first property must be 'event':'eventName' where event name is the name of the custom event
 * you can also add Tag Manager built in variables
 * and user-defined variables
 * object coded like this{'event':'button1-click','conversionValue':25}
 */
 function bcGaFireCustomEvent(_dataObj){
     window.dataLayer = window.dataLayer || [];
     window.dataLayer.push(_dataObj);
 }
var dayNames = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
var shortDayNames = ["Sun", "Mon", "Tues", "Wed", "Thur", "Fri", "Sat"];
var monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
var longMonthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];

function eventList(path, days, totalEvents) {
    this.path = path;
    this.days = days;
    this.totalEvents = totalEvents;

    this.buildUrl = function () {
        return this.path + ".events.json?days=" + this.days + "&totalEvents=" + this.totalEvents;
    };

    this.getEvents = function () {
        // use this.elementId instead of the event-list class
        var element = $('.event-list');
        
        $.getJSON(this.buildUrl(), function (data) {
            if (data.events && data.events.length > 0) {
                for (var i = 0; i < data.events.length; i++) {

                    var event = data.events[i].event;
                    var description = $("<div/>").html(event.description).text();
                    var eventDate = new Date(event.event_instances[0].event_instance.start);
                    var eventDayName = dayNames[eventDate.getDay()];
                    var eventMonth = monthNames[eventDate.getMonth()];
                    var eventShortDayName = shortDayNames[eventDate.getDay()];
                    var eventLongMonth = longMonthNames[eventDate.getMonth()];
                    var eventDay = eventDate.getDate();

                    markup = '<div class="content"><p>' + event.title + '</p><p>' + description + '</p></div></li>'

                    $(element).append(markup);
                }
            }
        });
    };
}


    $(document).ready(function () {
        $('.detailed .contact').each(function( index ) {
            var existingLinks = $(this).find('a');

            if(existingLinks.length < 1) {
                $(this).filter(function () {
                    var html = $(this).html();
                    var emailPattern = /[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}/g;

                    var matched_str = $(this).html().match(emailPattern);
                    if ( matched_str ) {
                        var text = $(this).html();
                        $.each(matched_str, function (index, value) {
                            text = text.replace(value,'<a href="mailto:'+value+'">'+value+'</a>');
                        });
                        $(this).html(text);
                        return $(this)
                    }
                });
            }

        });
    });

    function eventsApplyColorStyle( _selectorText, _repeatAt ){
        var eventTiles = $(_selectorText);
        var l = eventTiles.length;
        for (var i=0; i < l; i++){
            $(eventTiles[i]).addClass("color-" + (i % _repeatAt));
        }
    }



/************************* Classic UI functions ********************/

/*BC Facts and Figures layout selection event handler*/
function layoutDialog(selection,value){
    "use strict";
     var  comp = selection.findParentByType('dialog'),
          type = comp.getField('./type').getValue(),
          bgColor = comp.getField('./bgColor'),
          bgColor2 = comp.getField('./bgColor2'),
          title = comp.getField('./title'),
          button = comp.getField('./isButton'),
          columns = comp.getField('./columns').getValue(),
          columnSets = comp.findByType('dialogfieldset');


    //figures layout group datafield
      var figure1 = comp.getField('./figure1'),
          fact1 = comp.getField('./fact1'),
          credit1 = comp.getField('./credit1'),
          figure2 = comp.getField('./figure2'),
          fact2 = comp.getField('./fact2'),
          credit2 = comp.getField('./credit2'),
          figure3 = comp.getField('./figure3'),
          fact3 = comp.getField('./fact3'),
          credit3 = comp.getField('./credit3'),
          figure4 = comp.getField('./figure4'),
          fact4 = comp.getField('./fact4'),
          credit4 = comp.getField('./credit4');

     //Icons layout group datafield
        var iconFigure1 = comp.getField('./iconFigure1'),
            icon1 = comp.getField('./icon1'),
            text1 = comp.getField('./text1'),
            iconFigure2 = comp.getField('./iconFigure2'),
            icon2 = comp.getField('./icon2'),
            text2 = comp.getField('./text2'),
            iconFigure3 = comp.getField('./iconFigure3'),
            icon3 = comp.getField('./icon3'),
            text3 = comp.getField('./text3'),
            iconFigure4 = comp.getField('./iconFigure4'),
            icon4 = comp.getField('./icon4'),
            text4 = comp.getField('./text4');

     //function to toggle columnSet from 1-4
     var toggleColumn = function(b){
                   for (var i = 0; i <b ; i++) {
                     var columnSet = columnSets[i];
                     columnSet.show();

                   }
                }

     //Function to toggle fields base on layout options
     var toggleFields = function(b){

			if(type == "icons"){

              switch(b) {
                  case 1: case "1":
                       iconFigure1.show();
                       icon1.show();
                       text1.show();
                       figure1.hide();
                       fact1.hide();
                       credit1.hide();
                  	   break;
                  case 2: case "2": 
                       iconFigure2.show();
                       icon2.show();
                       text2.show();
                       figure2.hide();
                       fact2.hide();
                       credit2.hide();
                       break;
                  case 3: case "3": 
                       iconFigure3.show();
                       icon3.show();
                       text3.show();
                       figure3.hide();
                       fact3.hide();
                       credit3.hide();
                       break;
                  case 4: case "4": 
                       iconFigure4.show();
                       icon4.show();
                       text4.show();
                       figure4.hide();
                       fact4.hide();
                       credit4.hide();
                       break;
              }



            }
            if(type == "figures"){

              switch(b) {
                  case 1: case "1": 
                   figure1.show();
                   fact1.show();
                   credit1.show();
                   iconFigure1.hide();
                   icon1.hide();
                   text1.hide();
               	   break;
                  case 2: case "2": 
                   figure2.show();
                   fact2.show();
                   credit2.show();
                   iconFigure2.hide();
                   icon2.hide();
                   text2.hide();
                   break;
                  case 3: case "3": 
                   figure3.show();
                   fact3.show();
                   credit3.show();
                   iconFigure3.hide();
                   icon3.hide();
                   text3.hide();
                   break;
                  case 4: case "4": 
                   figure4.show();
                   fact4.show();
                   credit4.show();
                   iconFigure4.hide();
                   icon4.hide();
                   text4.hide();
                   break;

            }
           }
     }

        if(type == "figures"){
            bgColor.show();
            bgColor2.hide();
            bgColor2.setValue('');
            //alert(typeof columns);
            toggleColumn(columns);
            for(var i=1; i<Number(columns)+1; i++){
				toggleFields(i);
            }
        }else{

			bgColor.hide();
            bgColor2.show();
            bgColor.setValue('');
            toggleColumn(columns);
			for(var i=1; i<Number(columns)+1; i++){
				toggleFields(i);
            }
        }

}

/* BC Facts and Figures Column selection event handler */
function columnDialog(selection,value){
    "use strict";
     var  comp = selection.findParentByType('dialog'),
          type = comp.getField('./type').getValue(),
          columns = comp.getField('./columns').getValue(),
		  columnSets = comp.findByType('dialogfieldset');

     //figures layout group datafield

      var figure1 = comp.getField('./figure1'),
          fact1 = comp.getField('./fact1'),
          credit1 = comp.getField('./credit1'),
          figure2 = comp.getField('./figure2'),
          fact2 = comp.getField('./fact2'),
          credit2 = comp.getField('./credit2'),
          figure3 = comp.getField('./figure3'),
          fact3 = comp.getField('./fact3'),
          credit3 = comp.getField('./credit3'),
          figure4 = comp.getField('./figure4'),
          fact4 = comp.getField('./fact4'),
          credit4 = comp.getField('./credit4');

     //Icons layout group datafield
        var iconFigure1 = comp.getField('./iconFigure1'),
            icon1 = comp.getField('./icon1'),
            text1 = comp.getField('./text1'),
            iconFigure2 = comp.getField('./iconFigure2'),
            icon2 = comp.getField('./icon2'),
            text2 = comp.getField('./text2'),
            iconFigure3 = comp.getField('./iconFigure3'),
            icon3 = comp.getField('./icon3'),
            text3 = comp.getField('./text3'),
            iconFigure4 = comp.getField('./iconFigure4'),
            icon4 = comp.getField('./icon4'),
            text4 = comp.getField('./text4');


     var toggleColumn = function(b){
                   for (var i = 0; i <b ; i++) {
                     var columnSet = columnSets[i];
                     columnSet.show();

                   }
         }


     var toggleFields = function(b){

			if(type == "icons"){

              switch(b) {
                  case 1: 
                       iconFigure1.show();
                       icon1.show();
                       text1.show();
                       figure1.hide();
                       fact1.hide();
                       credit1.hide();
                       break;
                   case 2: 
                       iconFigure2.show();
                       icon2.show();
                       text2.show();
                       figure2.hide();
                       fact2.hide();
                       credit2.hide();
                       break;
                   case 3: 
                       iconFigure3.show();
                       icon3.show();
                       text3.show();
                       figure3.hide();
                       fact3.hide();
                       credit3.hide();
                       break;
                   case 4: 
                       iconFigure4.show();
                       icon4.show();
                       text4.show();
                       figure4.hide();
                       fact4.hide();
                       credit4.hide();
                       break;

              }



            }
            if(type == "figures"){
               // alert("figures");'
              switch(b) {
               case 1: 
                   figure1.show();
                   fact1.show();
                   credit1.show();
                   iconFigure1.hide();
                   icon1.hide();
                   text1.hide();
                   break;
               case 2: 
                   figure2.show();
                   fact2.show();
                   credit2.show();
                   iconFigure2.hide();
                   icon2.hide();
                   text2.hide();
                   break;
               case 3: 
                   figure3.show();
                   fact3.show();
                   credit3.show();
                   iconFigure3.hide();
                   icon3.hide();
                   text3.hide();
                   break;
               case 4: 
                   figure4.show();
                   fact4.show();
                   credit4.show();
                   iconFigure4.hide();
                   icon4.hide();
                   text4.hide();
                   break;
               }
           }
     }

    //toggle columnSet
     toggleColumn(columns);
     for(var i=1; i<Number(columns)+1; i++){
        toggleFields(i);
     }
    //hide columns
    for(var i=columns; i<=4; i++){

          columnSets[i].hide();

    }

}

/*BC Facts Figures add buttons event handler*/
function addButton(selection, isChecked){
    var  comp = selection.findParentByType('dialog'),
         isButton = comp.getField('./isButton').getValue(),
         buttonText = comp.getField('./buttonText'),
         buttonLink = comp.getField('./buttonLink');

    if(isButton=="true"){
        buttonText.show();
        buttonLink.show();

    }else{
        buttonText.hide();
        buttonLink.hide();
    }

}


var filtersArray = [];
var filterParams;
var textSearch = false;
var tagLimit = "tagLimit";
var itemName="";

function loadDiscernmentContent(params){
    //console.log('filterParams', filterParams);
    url = $('.bc-discernment .discernment').data('path');
    sortOrder = ( $('.bc-discernment .discernment').attr('tile-order') );

    //ADD LIMITER TAGS TO SEARCH URL
    limitsURL = ""
    limiter = $(".discernment").attr("limit-tags");

    if (typeof limiter != 'undefined' && limiter!=""){
        limitsURL = createLimits(limiter,tagLimit);
    }
    if (typeof params != 'undefined'){
        url = discernmentAddToURL( url, params );
    }
    if( typeof sortOrder != 'undefined' && sortOrder == 'true' )
    {
         url = discernmentAddToURL( url,"sortOrder=nodeOrder" );
    }

    url = discernmentAddToURL( url, limitsURL );
    url = url.replace("?&", "?");
    //console.log('url', url);
    $('.bc-discernment .results').load(url, function() {
        var blocks = $(".major");
        var blocksLen = blocks.length;
        var delayTime = 0;
        var delayIncrement = 100;
        var fadeTime = 300;
        var titleHeight = 0;
        // get the max height for the title h3
        for(var i = 0; i < blocksLen; i++){
            var blockTitleHeight = blocks[i].querySelector('.card h3').offsetHeight;
            titleHeight = (titleHeight > blockTitleHeight)?titleHeight:blockTitleHeight;
        }
		// apply the height to all the titles and show the cards
        for(var i = 0; i < blocksLen; i++){
			blocks[i].querySelector('.card h3').style.height = titleHeight+'px';
            $(blocks[i]).delay(delayTime).fadeTo(fadeTime,1);
            delayTime += delayIncrement;
        }

        if(blocksLen == 1){
            openBlock();
        }
    });
}

function discernmentAddToURL( _url, _strToAdd ){
    ( _url.indexOf("?") >= 0 ) ? _url += "&" + _strToAdd:_url += "?" + _strToAdd;
    return _url;
}

function openBlock(){
    $('.discernment .major button').trigger( "click" );
}

function createLimits(_array, _name){
    var tagURL="";
    var limiterArray = _array.split(",");
    var l = limiterArray.length;
        for(i=0;i<l;i++){
            if( i > 0 ){
                tagURL = tagURL + "&" + _name + "=" + limiterArray[i];
            }
            else{
                tagURL = tagURL + _name + "=" + limiterArray[i];
            }
        }
    return tagURL
}

function searchFilter(tag){

    //remove any current filters
    filtersArray = [];
    filterParams = '';

    //add to filters array
    filtersArray.push(tag);

    //create url parameters
    filterParams = 'tagFilter=' + filtersArray[0];

    //load content
    //console.log('searchFilter', filterParams);
    loadDiscernmentContent(filterParams);
}

function dt_clearTextBox(){
    $('#discernment-search').val("");
}

function dt_clearButtons(){
     $('.filters button').removeClass('active');
     filtersArray = [];
     filterParams = '';
}
function dt_clearAllButton(){
    $('button.clear-filter').removeClass('active');
}
function dt_activateAllButton(){
    $('button.clear-filter').addClass('active');
}
function dt_multiResult(_data){

    //remove any current filters
    filtersArray = [];
    filterParams = '';

    //add to filters array
    //filtersArray.push(tag);

    //create url parameters
    var pathObj = getCommonPath(_data);
	//console.log(pathObj.basePath);
    //console.log('pathObj.finishArray 1',pathObj.finishArray);
	filterParams = 'tagBase=' + pathObj.basePath + '&';
    pathObj.finishArray.forEach(function(_item){
       //console.log(_item.getAttribute("tag-filter"));
        filterParams += 'tagFilter=' + _item + '&';
    });
    //console.log('dt_multiResult filterParams' , filterParams);
    //load content
    //console.log('dt_multiResult', filterParams);
    loadDiscernmentContent(filterParams);
}
// compare path strings of tags and get the common path of the tags
// take data array and split each item into an array on "/"
// compare the items and when we get to differences in the arrays concatenate the differences
// into "finishing" strings
// return object with commonPath and an array of strings that finish the path
function getCommonPath(_data){
    var pathObj = {};
    var splitArrays = [];
    var finishArray = [];
    var basePath = '';
    var breakIndex = 0;
	_data.forEach(function(_item){
		splitArrays.push(_item.getAttribute("tag-filter").split('/'));
		//console.log('getCommonPath', _item.getAttribute("tag-filter"));
		//console.log(splitArrays);
    });
    var l = splitArrays.length;
    var subl = splitArrays[0].length;
    if( l == 1){subl--};
    for( var j = 0; j < subl; j++){
        var currentCheck = splitArrays[0][j];
        var isFound = true;
        for(var i = 0; i < l; i++){
            //console.log('currentCheck ', currentCheck , ' splitArrays[i][j] ', splitArrays[i][j] );
            if( currentCheck !== splitArrays[i][j] ){
				isFound = false;
                breakIndex = j;
                break;
            }
        }
        if(isFound){
			basePath += currentCheck + '/';
			//console.log('basePath', basePath)
        }
    }
    if( l == 1){ breakIndex = subl};
	for(i = 0; i < l; i++){
        var finishStringArray = [];
		subl = splitArrays[i].length;
		//console.log('breakIndex', breakIndex);
        for( j = breakIndex; j < subl; j++ ){
			finishStringArray.push(splitArrays[i][j]);
			//console.log('finishStringArray.push(splitArrays[i][j]);', splitArrays[i][j])
        }
        finishArray.push(finishStringArray.join('/'));
    }
    pathObj.basePath = basePath;
	pathObj.finishArray = finishArray;
    return pathObj;
}

$(document).ready( function() {
    itemName = $(".results-count").attr("item-label");
    if($('.discernment').length > 0){
        loadDiscernmentContent();

        //scroll to fixed header function
        $(window).bind('scroll', function () {
            $topPosition = $('.discernment').offset().top;
            $header = $('.discernment .header');
            $headerHeight = $header.outerHeight() + 40; //add 40px for space above results
            $container = $('.discernment .results');
            $bottomPosition =  $topPosition + $('.discernment').outerHeight() - $headerHeight;

            var breadcrumb = $(".breadcrumb-wrap");
            var breadcrumbHeight = 0;
            /* CHECK FOR BREADCRUMB */
            if( breadcrumb.hasClass("affix") ){
                breadcrumbHeight = breadcrumb.innerHeight();
            }

            if ($(window).scrollTop() > $topPosition && $(window).scrollTop() < $bottomPosition) {
                $header.addClass('affixed');
                $header.css('top',breadcrumbHeight);
                $container.css('padding-top', $headerHeight + 'px'); //adjust for fixed position
            } else {
                $header.removeClass('affixed');
                $container.css('padding-top', '');
            }
        });

        //tag active/inactive function
        $('.filters button').click(function(){
            $(this).toggleClass('active');
            dt_clearAllButton();

            if(textSearch){
                filtersArray = [];
                textSearch = false;
            }
            //get tag id
            var $tag = $(this).data('tag-filter');

            //find index of filter in filters array
            var $i = jQuery.inArray($tag, filtersArray);

            //if filter exists in array then remove and the button is on
            if($i != -1) {
                //remove tag
                filtersArray.splice($i,1);
            } //otherwise, add to filters array
            else {
                filtersArray.push($tag);
            }

            //create url parameters
            var filterLength = filtersArray.length;
            filterParams = '';
            if (filterLength > 1 && filterLength < 2) {
                filterParams = 'tagFilter=' + filtersArray[0];
            }
            else {
                for (i = 0; i < filtersArray.length; ++i) {
                    if (i > 0) {
                        filterParams += '&';
                    }
                    filterParams += 'tagFilter=' + filtersArray[i];
                }
            }
            if( filterLength < 1 )
            {
                dt_activateAllButton();
            }
            dt_clearTextBox();
            //console.log('document.ready', filterParams);
            loadDiscernmentContent(filterParams);
        });

        //clear filters function
        $('button.clear-filter').click(function(){
            $(this).addClass('active');
            dt_clearButtons();
            dt_clearTextBox();
            //console.log('button.clear-filter', filterParams);
            loadDiscernmentContent(filterParams);
        });

        //tags expand/collapse function
        $('.right-col > button').click(function(){
            $(this).toggleClass('open');
        });

        var majors = [];
        //add majors to array
        $('#search-data .major').each(function() {
            $title = $(this).find('.title').text();
            $description = $(this).find('.description').text().replace(/<\/?[^>]+(>|$)/g, " ");
            $introText = $(this).find('.introText').text().replace(/<\/?[^>]+(>|$)/g, " ");
            $keywords = $(this).find('.keywords').text();
            $careers = $(this).find('.careers').text();
            $tagPath = $(this).find('.tagpath').text();

            var major = {};
            major['value'] = $title + ' ' + $introText + ' ' + $description + ' ' + $keywords + ' ' + $careers;
            major['title'] = $title;
            major['tagpath'] = $tagPath;

            majors.push(major);
        });
        $('#search-data').remove();

        var substringMatcher = function(strs) {
            return function findMatches(q, cb) {
                var matches, substringRegex;

                // an array that will be populated with substring matches
                matches = [];

                // regex used to determine if a string contains the substring `q`
                substrRegex = new RegExp(q, 'i');

                // iterate through the pool of strings and for any string that
                // contains the substring `q`, add it to the `matches` array
                $.each(strs, function(i, str) {
                  if (substrRegex.test(str.value)) {
                    matches.push(str);
                  }
                });
                cb(matches);
            };
        };

        $('#discernment-search').typeahead({

            hint: true,
            highlight: true,
            minLength: 1
        },
        {
            limit: 100,
            name: 'majors',
            display: 'title',
            source: substringMatcher(majors),
            templates: {
                empty: ['<p>There are no areas of interest matching your search</p>'],
                suggestion: function(data){
                    return '<a href="javascript:searchFilter(\'' + data.tagpath + '\');" tag-filter="' + data.tagpath + '"><span>' + data.title + '</span></a>'; //add tag path in data tag to target on click for filtering
                }
            }
        }).on('keyup', function(e){
              if(e.which == 13) {
                  dt_multiResult( document.querySelectorAll(".tt-suggestion") );
                  dt_clearButtons();
                  dt_clearAllButton();
                  textSearch = true;
              }

        });
        $('.discernment .icon-search').on('click', function(e){
            dt_multiResult( document.querySelectorAll(".tt-suggestion") );
            dt_clearButtons();
            dt_clearAllButton();
            textSearch = true;
        });
         $(".tt-dataset-majors").on('click', function(e){
            dt_clearButtons();
            dt_clearAllButton();
            textSearch = true;
         });
    }
});
function doFragments(){
    var frags = document.getElementsByClassName('bc-basic-fragment');
    //console.log(frags);
    for(var i = 0; i < frags.length; i++){
		//console.log('url',frags[i].dataset.fragment);
        loadFragmentJSON(frags[i]);
    }
}

function loadFragmentJSON(_div){
    // URL pattern needed /api/assets/bc1/fragments/fragment-1.json
	// URL passed /content/dam/bc1/fragments/fragment-1
    var dataFragment = _div.dataset.fragment;
    var jsonUrl = dataFragment.replace('content/dam','api/assets') + '.json';
	//console.log('jsonUrl', jsonUrl);

	fragmentLoadJSON(jsonUrl, _div, fragmentParseJSON, fragmentError );
}

function fragmentLoadJSON(_path, _target, _success, _error){
    //console.log("loadJSON", path, _id, _chart, _style);
    var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function()
    {
        if (xhr.readyState === XMLHttpRequest.DONE) {
            //console.log('xhr.status',xhr.status)
            if (xhr.status === 200) {
                //console.log('_success', _success);
                if (_success)
                    //console.log(typeof xhr.responseText)
                    //console.log('success' , xhr.responseText);
                    _success(JSON.parse(xhr.responseText), _target);
            } else {
                if (_error)
                    _error(xhr);
            }
        }
    };
    xhr.open("GET", _path, true);
    xhr.send();
}

function fragmentParseJSON(_response, _target){
	//console.log('xhr success', _response.properties.elements)
    var obj = _response.properties.elements;
    var order = _response.properties.elementsOrder;
    var html = '';
    for(var i = 0; i < order.length; i ++){
		html+= obj[order[i]].value;

    }
    //console.log('html',html);

    childDiv = document.createElement('div');
    childDiv.innerHTML = html;
	_target.append(childDiv);
}

function fragmentError(_xhr){
	//console.log('xhr error', _xhr)
}
function videoModal(videoTarget){
    var videoModal = videoTarget.data("target");
    var src = '';
    var iframePlayer = document.querySelector("#modal-body iframe");
    if (videoTarget.attr("data-videotype") == "vimeo"){
        src = 'https://player.vimeo.com/video/' + videoTarget.attr("data-video")+'?autoplay=1';
		iframePlayer.src = src;
        iframePlayer.setAttribute('id','vimeoPlayer');

     } else {
         src = 'https://www.youtube.com/embed/'+ videoTarget.attr("data-video")+'?autoplay=1';
         iframePlayer.src=src;
         iframePlayer.setAttribute('id','ytPlayer');
     }

	$('#videoModal, button.close').click(function (event) {
    	event.stopImmediatePropagation;
    	var iframePlayer = document.querySelector("#modal-body iframe");
    	iframePlayer.src='';

    });

}


function addModal(){
    // add Modal Window
	// add player div
    var player = document.createElement('div');
    player.classList.add('modal', 'fade', 'video-modal');
    player.innerHTML ='<div class="modal-dialog"><div class="modal-content"><div id="modal-body" class="modal-body">'+
    				  '<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>'+
                      '<div class="responsive-video"><iframe id="" src="" frameborder="0" allow="autoplay" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>'+
                      '</div></div></div></div>'
	player.id = 'videoModal';
    player['aria-labelledby'] = 'videoModal';
	player['tabindex']="-1";
    player['role']="dialog";
    player['aria-hidden']="true";

    var currentDiv = document.getElementById("pagecontent");
    currentDiv.appendChild(player);

}




function storyBoxSetup(){
    //wrap listStories in otherStories class with JavaScript
    let list = document.querySelector(".listStories");
    //create a wrapper
    let wrapDiv = document.createElement("div");
    wrapDiv.className = 'otherStories';
    let parentDiv = document.querySelector(".listStories").parentNode;
    parentDiv.insertBefore(wrapDiv, list);
    let allitems = document.querySelectorAll(".listStories");
    for (let i = 0; i < allitems.length; ++i) {
    	wrapDiv.appendChild(allitems[i]);
    };
    //Append addMore as the last box
    let addMore = document.querySelector(".listStories.more");
    let wrapper = document.querySelector(".otherStories");
    wrapper.append(addMore);

    //Group into two rows
    $('.listStories:lt(3)').wrapAll('<div class="group" />');
    $('.listStories:gt(2)').wrapAll('<div class="group" />');

    moreBoxHeight();
    setTimeout(setBoxHeight, 250);
}

function moreBoxHeight(){
   if ($(window).width() >975) {
        let moreBoxWidth = $('.listStories.more').width();
        let moreTextHeight = $('.listStories.more > div >a').height();
        let morePadding = (moreBoxWidth-moreTextHeight)/2;
        $('.listStories.more > div >a').css('padding',morePadding+'px 0px');
        if ($('.listStories.more > div >a > br').length<1){
            $('<br>').insertBefore('.listStories.more span');
            $('.listStories.more > div >a').removeAttr("style");
        }
   } else {
       $('.listStories.more > div >a').removeAttr("style");
       $('.listStories.more > div >a  br').remove();
       $('.listStories.more > div >a').css('margin','15px');
   }
}

function setBoxHeight(){
    if ($(window).width() >975) {
		let newHeight = $('.otherStories').height();
		$('.topStory').height(newHeight);
        let contentHeight = newHeight - ($('.thumb').height()) -30;
        $('.topStory .content').height(contentHeight);

	} else {
		$('.topStory').removeAttr("style");
        $('.topStory .content').removeAttr("style");
    }
}

$( document ).ready(function() {
//Allow table overflow-x scroll
    $('.bc-text .text-new').each(function() {
        if ($(this).find('table').length > 0){
            var myTarget = $(this).find('table');
            myTarget.wrap("<div class='tableWrapper'></div>");
            $('.tableWrapper').css({'overflow-x':'auto',
                        '-webkit-overflow-scrolling': 'touch'
						});
        }
    });
});
/* Switching to json
    instead of having to load function do one load function to get json, then either use every file up to limkit,
    or go through the nodes and selet only the specified ones
    there may more than one pub componenet on the page, so do for each specified url
*/
 function bc_publications(){
     //console.log('bc_publications', bc_publications_array);
    var l = bc_publications_array.length;
     var loadObjArray=[];
    // for each section use the data object to populate the section
    //console.log('bc_publications_array', bc_publications_array);
    for( var i=0; i<l; i++ ){
        loadObjArray.push({'pubData':bc_publications_array[i]})
        // hide the buttons until needed
        $('#' + bc_publications_array[i].id + ' .loadmore').hide();
        $('#' + bc_publications_array[i].id + ' .loadless').hide();
        // hide the arrows until needed
		$('#' + bc_publications_array[i].id + ' .leftArrow').hide();
        $('#' + bc_publications_array[i].id + ' .rightArrow').hide();
    }
     //console.log(bc_publications_array);
    $('.loadless').on('click', function() {
        element = document.getElementById(bc_publications_array[0].id);
        element.scrollIntoView();
    })
	loadBCPubs(loadObjArray);
}

function loadBCPubs(_pubObjArray){
    //console.log('loadBCPubs', _pubObjArray, _pubObjArray[0]['pubData'].checkSelect)
    if( _pubObjArray[0]['pubData'].checkSelect != 'true' ) {
        //console.log('in pub json')
        var nRequest = new Array();
        for (var i=0; i<_pubObjArray.length; i++){
           (function(i) {
               //console.log('pubpath', _pubObjArray[i].pubData.pubpath + '.3.json')
              nRequest[i] = new XMLHttpRequest();
              nRequest[i].pubObj =  _pubObjArray[i];
              nRequest[i].open("GET", _pubObjArray[i].pubData.pubpath + '.3.json', true);
              nRequest[i].onreadystatechange = function (oEvent) {
                 if (nRequest[i].readyState === 4) {
                    if (nRequest[i].status === 200) {
                      loadPubData( nRequest[i].pubObj, nRequest[i].responseText );
                    } else {
                      console.log("Error", nRequest[i].statusText);
                    }
                 }
              };
              nRequest[i].send(null);
           })(i);
        }
    }
    else{
       loadBcPublicationsdoLocalLoadmore(_pubObjArray[0]['pubData'])
    }
}

function loadPubData(_obj, _data){
    //console.log('_obj_obj', _obj, '_data_data', _data)
    //console.log('_obj', _obj);
    //console.log('_obj.pubData',_obj.pubData)
    //console.log('checkSelect', _obj.pubData.checkSelect)
    if(_obj.pubData.checkSelect != 'true'){
        _obj.data = JSON.parse(_data);
        var myDiv = $('#' + _obj.pubData.id + ' .bc-pubs-container .bc-pubs');
        var innerHTML = loadBcPublications(_obj);
        myDiv.html(innerHTML);
        loadBcPublicationsdoLocalLoadmore(_obj.pubData);
    }
}

//load based on tag
function loadBcPublications(_obj) {
   // console.log('loadBcPublications', _obj);
	var bcPubsInnerHTML = '';
    var pubsArray = [];
    for (var property in _obj.data) {
        if( typeof(_obj.data[property]['jcr:content'])!== 'undefined' ){
            var jcrData = _obj.data[property]['jcr:content'];
            bcPubsInnerHTML += parseToInnerHTML(jcrData, _obj);
        }
    }
	return bcPubsInnerHTML;
}

function parseToInnerHTML( _jcrData, _obj ){
    //console.log('_jcrData',_jcrData);
	var bcPubsInnerHTML = '';
    bcPubsInnerHTML += '<div class="bc-pub"><div class="img-container">';
    var link = (typeof(_jcrData.link) !== 'undefined')?_jcrData.link:'';
    //console.log("_jcrData['articleimage']['fileReference']", typeof _jcrData['articleimage']['fileReference'] == 'undefined');
    try{
        //if( typeof (_jcrData['articleimage']['fileReference']) != 'undefined' && _jcrData['articleimage']['fileReference'] != null   ){
            if(link !=''){
                bcPubsInnerHTML += '<a href="' + link + '">'
            }
            var alt = (_jcrData['articleimage'].alt != '')?_jcrData['articleimage'].alt:_jcrData['jcr:title'];
            bcPubsInnerHTML += '<img src="' + _jcrData['articleimage']['fileReference'] + '" alt="' + alt +  '"/>';
            if(link !=''){
                bcPubsInnerHTML += '</a>';
            }
        //}
    }
    catch{}
    bcPubsInnerHTML += '</div>'; // img-container end;
    bcPubsInnerHTML += '<div class="img-text">'
    bcPubsInnerHTML += '<h3 class="title">';
    if(link !=''){
        bcPubsInnerHTML += '<a href="' + link + '">'
    }
    bcPubsInnerHTML += _jcrData['headline'];
    if(link !=''){
        bcPubsInnerHTML += '</a>';
    }
    bcPubsInnerHTML += '</h3>';
    if(typeof(_jcrData['author'] != 'undefined')){
        bcPubsInnerHTML += '<p class="authors">' + _jcrData['author'] + '</p>';
    }
    //console.log('abstract', _jcrData['abstract'], typeof(_jcrData['abstract']) );
    if( typeof(_jcrData['abstract']) != 'undefined' && _jcrData['abstract'] != null && _obj.pubData.hideAbstract != 'true'){
        bcPubsInnerHTML += '<p class="abstract">' + _jcrData['abstract'] + '</p>';
    }
    if(typeof(_jcrData['shortHeadline']) != 'undefined'){
        bcPubsInnerHTML += '<p class="citations">' + _jcrData['shortHeadline'] + '</p>';
    }
    bcPubsInnerHTML += '</div>';
    bcPubsInnerHTML += '</div>';

    return bcPubsInnerHTML;
}


function loadBcPublicationsdoLocalLoadmore(_dataObj)
{
	var vertical = "";
    var pubs = $('#'+ _dataObj.id + ' .bc-pub');
    //console.log('pubs' , pubs)
    vertical = _dataObj.displayMode;

    if( vertical == "vertical")
    {
        var container = $('#'+ _dataObj.id + ' .bc-pubs-container');
        $(container).addClass( "vertical" );
        //console.log(pubs.length, _dataObj.display_limit);
        if (pubs.length > _dataObj.display_limit){
            // hide the pubs over the length
        	loadBcPublicationsHidePubs(pubs, _dataObj);
        	$('#'+ _dataObj.id + ' .loadmore').on('click', function (e) {
            	loadBcPublicationsShowPubs(pubs, _dataObj);
            	return false;
        	});
        	$('#'+ _dataObj.id + ' .loadless').on('click', function (e) {
            	loadBcPublicationsHidePubs(pubs, _dataObj);
            	return false;
        	});
            $('#' + _dataObj.id + ' .loadmore').show();
    	}
    }
    else{
		//if display is horizontal limit visible items to 5
        $( window ).resize(function() {
            doResize(pubs, _dataObj, true);
        });
		doResize(pubs,_dataObj);

        if (pubs.length > _dataObj.display_limit){
        // hide the pubs over the length
        	loadBcPublicationsArrowPubs(pubs, _dataObj);
        	$('#' + _dataObj.id + ' .rightArrow').show();
        	$('#'+ _dataObj.id + ' .rightArrow').on('click', function (e) {
            	loadBcPublicationsRightArrow(pubs, _dataObj);
            	return false;
        	});
       		$('#'+ _dataObj.id + ' .leftArrow').on('click', function (e) {
            	loadBcPublicationsLeftArrow(pubs, _dataObj);
            	return false;
        	});
    	}
        setPublicationArrowHeight(_dataObj);
 	}
}

function doResize(_pubs, _dataObj, _isResize){
	var windowWidth = $( window ).width();
    var displayLimit;
    if(windowWidth >= 1200){
		displayLimit = 5;
    } else if (windowWidth < 1200 && windowWidth >= 992){
		displayLimit = 4;
    } else if (windowWidth < 992 && windowWidth >= 768){
		displayLimit = 3;
    } else if (windowWidth < 768 && windowWidth >= 600){
		displayLimit = 2;
    } else {
		displayLimit = 1;
    }
    _dataObj.display_limit = displayLimit;

    if(_isResize)
    {
        loadBcPublicationsArrowPubs(_pubs, _dataObj);
    }
}

function setPublicationArrowHeight(_dataObj)
{
	var pubHeight = ($('#'+ _dataObj.id + ' .bc-pubs').height())/2;
    var arrowHeight = ($('#'+ _dataObj.id + ' .leftArrow').height())/2;
    var newHeight = pubHeight - arrowHeight;
    $('#'+ _dataObj.id + ' .leftArrow').css("margin-top",pubHeight);
    $('#'+ _dataObj.id + ' .rightArrow').css("margin-top",pubHeight);
}

function  loadBcPublicationsRightArrow(_pubs, _dataObj)
{
    _dataObj.displayIndex +=_dataObj.display_limit;
    loadBcPublicationsArrowPubs(_pubs, _dataObj);
}

function  loadBcPublicationsLeftArrow(_pubs, _dataObj)
{
    _dataObj.displayIndex -=_dataObj.display_limit;
    loadBcPublicationsArrowPubs(_pubs, _dataObj);
}

function loadBcPublicationsArrowPubs(_pubs, _dataObj){
	var myDisplayIndex = _dataObj.displayIndex;
    var pubsLength = _pubs.length;
    if(myDisplayIndex < 0){
        myDisplayIndex=0;
    };
    if(myDisplayIndex > pubsLength){
        myDisplayIndex = _dataObj.pubs_total - _dataObj.display_limit;
    };
    if(myDisplayIndex > 0){
		$('#' + _dataObj.id + ' .leftArrow').show();
    }
    else
    {
        $('#' + _dataObj.id + ' .leftArrow').hide();
    }

    if(pubsLength > myDisplayIndex + _dataObj.display_limit ){
		$('#' + _dataObj.id + ' .rightArrow').show();
    }
    else
    {
        $('#' + _dataObj.id + ' .rightArrow').hide();
    }
	var upperlimit = myDisplayIndex + ( _dataObj.display_limit - 1);
	var magwrap = document.querySelector('.magazine-wrap');
        //console.log('magwrap',magwrap);
        if(typeof(magwrap) === 'undefined' || !magwrap){
        for( var i = 0; i < pubsLength; i++){
            if( i < myDisplayIndex || i > upperlimit ){
                $(_pubs[i]).css({"position":"absolute", "left":"-5000px"} );
            }
            else {
                $(_pubs[i]).css({"position":"relative", "left":"initial"} );
            }
        }
    }
}

function loadBcPublicationsHidePubs(_pubs, _dataObj)
{
    var magwrap = document.querySelector('.magazine-wrap');
    //console.log('magwrap',magwrap);
    if( typeof(magwrap) == 'undefined' || !magwrap){
		//console.log('_pubs.length',_pubs.length);
        for( var i = 0; i < _pubs.length; i++){
            if( i >= _dataObj.display_limit){
                	//console.log("counter", i)
                $(_pubs[i]).css({"position":"absolute", "left":"-5000px"} );
            }
        }
        var loadmore =  $('#'+ _dataObj.id + ' .loadmore');
        loadmore.show();
        $('#'+ _dataObj.id + ' .loadless').hide();
        scrollTo = loadmore;
    }
}

function loadBcPublicationsShowPubs(_pubs, _dataObj)
{
    for( var i = 0; i < _pubs.length; i++){
        $(_pubs[i]).css({"position":"relative", "left":"initial"} );     
    }
    $('#'+ _dataObj.id + ' .loadmore').hide();
    $('#'+ _dataObj.id + ' .loadless').show();
}

$(document).ready( function() {

    $('.bc-person-bio .person-info.add-button').click( function() {
        console.log('clicked button');
        $(this).toggleClass('open');
    });
});

// timeout function to control the frquency of refresh on scolling
function bcDebounce( func, wait, immediate ) {
  var timeout;
  return function() {
    var context = this, args = arguments;
    var later = function() {
      timeout = null;
      if (!immediate) func.apply(context, args);
    };
    var callNow = immediate && !timeout;
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
    if (callNow) func.apply(context, args);
  };
}

// check the vertical position of the journey items on the page to control the the state of the nav
function checkJourney(){
    checkScrollDirection();
    // if it's the sticky bar check to see if we should show the bar
    if(bcStickyTop){
        showStickyJourneyBar();
    }
    if(bcJourneyDoChecks)
    {
        var bcJourneyDownSpot = 0;
        var bcJourneyUpSpot = 30;
        if(bcJourneyDownSpot < bcJourneyUpSpot){
			bcJourneyDownSpot = bcJourneyUpSpot;
        }
        var windowBottomY =  window.scrollY + window.innerHeight;
        var l = bcJourneyStops.length;
        if(getScrollDirection()){
            //scroll towards bottom of page
            for(var i = l-1; i >= 0 ; i--){
                var sq = bcJourneyStops[i].getBoundingClientRect();
                if( sq.top < bcJourneyDownSpot ){
                     bcJourneyAllStops.forEach( function(stopTrigger) {
                        changeNav(bcJourneyStops[i].dataset.barid, stopTrigger, "");
                     });
                    return;
                }
            }
        }
        else
        {
            //scroll towards top of page
            for(var i = 0; i < l ; i++){
                var sq = bcJourneyStops[i].getBoundingClientRect();
                if( sq.top > bcJourneyUpSpot ){
                     bcJourneyAllStops.forEach( function(stopTrigger) {
                        changeNav(bcJourneyStops[i].dataset.barid, stopTrigger, "");
                     });
                    return;
                }
            }
        }

        // if the journey starts below the fold, don't highlight nav
        var sq = bcJourneyStops[0].getBoundingClientRect();
        if ( sq.top > window.innerHeight ){
            bcJourneyAllStops.forEach( function(stopTrigger) {
                changeNav("", stopTrigger, "");
            });
        }
    }
}

function getScrollDirection(){
    var bcScrollDirectionDown;
    if((document.body.getBoundingClientRect()).top > checkScrollDirection()){
		bcScrollDirectionDown = false;
    }
    else
    {
        bcScrollDirectionDown = true;
    }
    return bcScrollDirectionDown;
}

function checkScrollDirection()
{
    var bcJourneyScrollPos = (document.body.getBoundingClientRect()).top;
    moveJourneyBar(bcJourneyScrollPos);
    return bcJourneyScrollPos;
}

// only for the side journey bar
function hideJourneyBar(){
    var journeyBarWidth = bcjourneyBar.offsetWidth;
    if(showJourneyBar){
        bcjourneyBar.style.right = "-80px";
    }
    else{
        bcjourneyBar.style.right = 0 + "px";
    }
    showJourneyBar = !showJourneyBar;
}

// figure out vertical position of first journey item
// turn on nav when it gets to the top of the page.
function showStickyJourneyBar(){
	var journeyBarContainer = document.getElementsByClassName('journey-bar-sticky')[0];
    var journeyItem = document.getElementsByClassName('bc-journey-bar')[0];
    var contentArea = document.getElementById('pagecontent');
    if (!contentArea) { contentArea = document.getElementsByClassName('page')[0] };
	var bounding = journeyItem.getBoundingClientRect();
    var navOn = journeyBarContainer.style.display == 'inline-block';
    var topBoundry = navOn ? 120 : 60;
    //console.log('journeyBarItem',bounding.top, journeyItem);
    if(bounding.top < topBoundry){
        journeyBarContainer.style.display = 'inline-block';
        contentArea.style.paddingTop = '60px';
    }
    else
    {
		journeyBarContainer.style.display = 'none';
        contentArea.style.paddingTop = '0';
    }

}

// the function expects different items based on whether the call is by click or scroll
function changeNav(_comparisionValue, _navItem, _method){
    //console.log(_comparisionValue,_navItem,_method)
    if(_method != "click"){ // navItem is the actual journeybar item
        if(_comparisionValue === _navItem.firstChild.firstChild.dataset.barid){
        	_navItem.firstChild.classList.add(BC_JOURNEY_ON_COLOR);
            _navItem.classList.add(BC_JOURNEY_ON_COLOR);
        }
        else
        {
            _navItem.firstChild.classList.remove(BC_JOURNEY_ON_COLOR);
            _navItem.classList.remove(BC_JOURNEY_ON_COLOR);
        }
    }
    else // _navItem is the clicked item
    {
		bcJourneyAllStops.forEach(function(stop){
            if( stop.firstChild.firstChild.dataset.barid === _navItem.dataset.barid){
				stop.firstChild.classList.add(BC_JOURNEY_ON_COLOR);
                stop.classList.add(BC_JOURNEY_ON_COLOR);
            }
            else{
				stop.firstChild.classList.remove(BC_JOURNEY_ON_COLOR);
                stop.classList.remove(BC_JOURNEY_ON_COLOR);
            }
        });

    }
    // control which nav items are active
    if(bcStickyTop){
        fillJourneyNav();
    }
}

function fillJourneyNav(){
	//console.log('fillJourneyNav');
    var fillRest = false;
    var l = bcJourneyAllStops.length - 1;
    for(var i=l; i >= 0; i--){
        if(fillRest){
			bcJourneyAllStops[i].classList.add(BC_JOURNEY_ON_COLOR);
        }
        if(bcJourneyAllStops[i].classList.contains('active')){
			//console.log('nav index is ', i);
            fillRest = true;
        }
    }
}

// scroll the page to teh targeted journey item
function doJourney(e){
    //zero is top of the page
    bcJourneyDoChecks = false;
    bcJourneyStops.forEach( function(stop) {
        if( e.target.dataset.barid === stop.dataset.barid){
            e.preventDefault();
           	changeNav(e.target.dataset.barid, e.target, "click");
            var stopTop = $(stop).offset().top + bcStopPadding;
            $('body,html').animate({
              scrollTop: stopTop
            }, 1000, 'swing', function(){
				// set the update flag back to true to handle scrolling
                bcJourneyDoChecks = true;
            });
        }
    });
}

// after page load, set the journey bar to the inactive state
function journeyRemoveInitHover(){
	//console.log('journeyRemoveInitHover');
    var journeyLabel = document.querySelectorAll('.initHoverLabel');
    journeyLabel.forEach( function(item) {
		item.classList.remove('initHoverLabel');
    });
    var journeyA = document.querySelectorAll('.initHoverA');
    journeyA.forEach( function(item) {
		item.classList.remove('initHoverA');
    });
    var blackBG = document.querySelector('.initHoverBar');
    if(blackBG){
        blackBG.classList.remove('initHoverBar');
    }
}

// set the vertical position of the journey bar based on hero elements
function moveJourneyBar(_offset){
	var hero = document.querySelector(".hero");
    var jumbo = document.querySelector(".jumbotron");
    var heroSpace;
    if(hero != null){
        heroSpace = hero;
    }
    if(jumbo != null){
        heroSpace = jumbo;
    }
	var journeybarTop = 0;
    if(heroSpace != null){
		journeybarTop = heroSpace.offsetTop + heroSpace.clientHeight + _offset;
        journeybarTop = (journeybarTop < 0)?0:journeybarTop;
        bcjourneyBar.style.top = journeybarTop + 'px';
	}
}

function journeyScrollToTop(){
	$("html, body").animate({ scrollTop: 0 }, "slow");
}

/* set top of journey bar to either the breadcrumb wrap height or the hero bottom */

function doBCJourneyBar (_barType){
    /*
    /* create logic branch based on first journey bar node 'data-bartype'
    /* if it's sidebar (default) keep everything the same.
    /* if it's sticky bar append a hidden div to the top of the page.
    /* display bar when first item on the page hits the trigger zone.
    /* hide bar when first item on the page goes below the trigger zone.
    /* display "top" anchor when bar is on.
    /*
    */
    var bcJourneyAllStopsA;
    var bcMaxJourneyItems = 6;
    var bcJourneyscrollTrigger = document.querySelector("#pagecontent");
    if (!bcJourneyscrollTrigger) { bcJourneyscrollTrigger = document.getElementsByClassName('page')[0] };
    var ulNode = document.createElement('div');
    var bcjourneyBarSelector;
    var isDefaultBar= true;
    var isbarType  = _barType.indexOf('jb-sticky') > -1 ? 'jb-sticky' : 'sidebar';
    var stickyLiClass = '';
    var stopLi = '';
    switch(isbarType){
        case 'jb-sticky':
			//console.log('do sticky bar', _barType);
            ulNode.classList.add("journey-bar-sticky");
            bcJourneyscrollTrigger.appendChild(ulNode);
            ulNode.innerHTML = '<div id="journey-bar-top"  title="back to top" class="journey-bar-top ' + _barType + '"><a href="#" onclick="return false;"></a></div><ul class="journey-bar-sticky-ul ' + _barType + '"></ul>';
            bcjourneyBarSelector = ".journey-bar-sticky-ul";
            isDefaultBar = false;
            stickyLiClass = _barType+'-li';
            bcStickyTop = true;
            bcStopPadding = -60;
        break;

        default:
            ulNode.classList.add("journey-bar-nav", "initHoverBar");
            bcJourneyscrollTrigger.appendChild(ulNode);
            ulNode.innerHTML = '<ul class="journey-bar-ul initHover"></ul>';
            bcjourneyBarSelector = ".journey-bar-ul";
            stopLi = '<li id="journey-bar-top" title="back to top" class="journey-bar-top ' + _barType + '"><a class="initHoverA" href="#" onclick="return false;"><span class="label">&nbsp;</span></a></li>';
    }

    bcjourneyBar = document.querySelector(bcjourneyBarSelector);
    //console.log('bcjourneyBar', bcjourneyBar)
    bcJourneyStops = document.querySelectorAll(".bc-journey-bar-a");
    if(isDefaultBar){
        moveJourneyBar((document.body.getBoundingClientRect()).top);
        bcjourneyBar.addEventListener('mouseover', function(){
            moveJourneyBar( ( document.body.getBoundingClientRect() ).top );
        });
        showJourneyBar = true;
    }

    var l = bcJourneyStops.length > bcMaxJourneyItems ? bcMaxJourneyItems : bcJourneyStops.length;
    for( var i = 0; i < l; i++) {
        //console.log('bcJourneyStops[i].dataset.bartitle' ,bcJourneyStops[i].dataset.bartitle);
        stopLi += '<li class="journey-bar-stop ' + stickyLiClass + '"><a class="initHoverA" href="#" onclick="return false;"><span class="label initHoverLabel" data-barid="' + bcJourneyStops[i].dataset.barid + '">' + bcJourneyStops[i].dataset.bartitle + '</span></a></li>'
    };

    var barContainer = document.querySelector(bcjourneyBarSelector)
    barContainer.innerHTML = stopLi;

	// 2 different selects, bcJourneyAllStops is the containers, bcJourneyAllStopsA are the actual anchors
    bcJourneyAllStops =  document.querySelectorAll(".journey-bar-stop");
    bcJourneyAllStops.forEach( function(stopTrigger) {
        $(stopTrigger).on('click', function(e){
            $(e.target.firstChild).trigger('click');
        });
    });

    bcJourneyAllStopsA = document.querySelectorAll(".journey-bar-stop a");
    bcJourneyAllStopsA.forEach( function(stopTrigger) {
        stopTrigger.addEventListener('click', doJourney );
    });
    window.addEventListener('scroll', bcDebounce(checkJourney, 10, true) );

	document.getElementById('journey-bar-top').addEventListener('click', journeyScrollToTop);

    var sq = bcJourneyStops[0].getBoundingClientRect();
    if ( sq.top > window.innerHeight ){
        bcJourneyAllStopsA[0].classList.remove(BC_JOURNEY_ON_COLOR);
        bcJourneyAllStops[0].classList.remove(BC_JOURNEY_ON_COLOR);
    } else{
        bcJourneyAllStopsA[0].classList.add(BC_JOURNEY_ON_COLOR);
        bcJourneyAllStops[0].classList.add(BC_JOURNEY_ON_COLOR);
    }
    setTimeout(function(){journeyRemoveInitHover()}, 5000);
}
/*
  On mobile view:
  1) The text layer will be under the image
  2) The author defined overlay background color will turn to solid color, the opacity will be 1
  3) If no background color, maroon will be the default overlay background color.
  4) When resize to desktop, the overlay change from 2) and 3) for the mobile view will return to the author defined input data for the overlay
*/
function imageMobileTest(id){

    var textEle = document.querySelector('#' + id +' .bgImage .text-over');

    var enterWidth = textEle.getAttribute('data-width');
    if (enterWidth == '0'){
    	enterWidth = 'auto';
    } else {
        enterWidth = enterWidth +'%';
    }
    var enterHeight = textEle.getAttribute('data-height');
    if (enterHeight == '0'){
    	enterHeight = 'auto';
    } else {
        enterHeight = enterHeight +'%';
    }

	var bgColor = textEle.getAttribute('data-color');
    var bgOpa = textEle.getAttribute('data-opa');
    if (bgOpa <= '0') {
		bgColor = "rgba(138,16,11,";
    } 

    if ($(window).width() <768){
        //Mobile: update the style to place the text over under the image with solid background color
        textEle.style.position = "static";
        textEle.style.width = "100%";
        textEle.style.height = enterHeight;
        textEle.style.background = bgColor+"1)";
    } else {
		//Desktop view with the author's input
        textEle.style.position = "absolute";
        textEle.style.width = enterWidth;
        textEle.style.height = enterHeight;
        textEle.style.background = bgColor+bgOpa;
    }
}
function modifySlate(){

    /* add side padding to the form question */
   var formQuestion = document.querySelector('.form-slate form');
   if (formQuestion){
       formQuestion.style.cssText = 'padding:0 '+ sidepadding +'px ' + sidepadding +'px';
	   formQuestion.classList.add('isLoad');
   }

    /* Animate input fields labels */
      //Label control: move label down under input
		moveLabels();

      //If the input changed, add a "filled" class
        $('.form-slate input').on('change keydown paste input', function(){
           if($(this).val().length >= 1){
              $(this).addClass("filled");
           }else{
              $(this).removeClass("filled");
           }
        });

    //Button control
 	btnControl();

    //Multi-Panel Control
     if (formType == "multi"){
		 multiControl();
     };
};

function moveLabels() {
	//Label control: move label down under input
    document.querySelectorAll('.form-slate .form_text input[type="text"], .form-slate .form_text input[type="email"], .form-slate .form_text input[type="tel"]').forEach(function(item){
        var theLabel = item.parentNode.parentNode.children[0];
        //character count on label 40 char
        if (theLabel.innerHTML.length < 40){
        	item.parentNode.append(theLabel);
        } else {
          	theLabel.classList.add('original');
        }
    });
}

function btnControl() {
	//Button control
 	var el = document.querySelector('.form-slate button.default');
    var els = document.querySelectorAll('.form-slate button.default');

    /* update button label */
    if (btnLabel && formType == "single"){
    	el.innerHTML = btnLabel;
    }
 	if (btnStyle){
		el.parentNode.classList.add(btnStyle);
 	}
    if (btnColor){
    	els.forEach(function(e){
			e.classList.add(btnColor);
        })
    }
}

function changeBtn() {
    var btnBack = document.querySelector('button.default.back');
    var btnNext = document.querySelector('button.default.next');
    var buttonBWidth = btnBack.clientWidth;
    var buttonNWidth = btnNext.clientWidth;

    if (buttonBWidth != 0) {
        if (btnStyle == "full") {
            if (buttonBWidth < 103 || (document.querySelector('.full button.default.form_button_submit').style.display == 'block' && buttonBWidth < 103) ){
               btnBack.innerHTML = '\&#171;';
            } else {
				btnBack.innerHTML = '\&#171; Back';
            }
        }else {
            if (buttonBWidth < 71 || document.querySelector('.' +btnStyle+' button.default.form_button_submit').style.display == 'block'){
               btnBack.innerHTML = '\&#171;';
            } else {
				btnBack.innerHTML = '\&#171; Back';
            }
        }
    }
    if (buttonNWidth != 0) {
        if (btnStyle == "full") {
            if (buttonNWidth < 103 || (document.querySelector('.full button.default.form_button_submit').style.display == 'block' && buttonNWidth < 103) ){
                btnNext.innerHTML ='\&#187;';
            } else {
				btnNext.innerHTML ='Next &#187;';
            }
        }else {
            if (buttonNWidth < 71 || document.querySelector('.' +btnStyle+' button.default.form_button_submit').style.display == 'block' ){
               btnNext.innerHTML ='\&#187;';
            } else {
				btnNext.innerHTML ='Next &#187;';
            }
        }
    }
}

// hide the hidden field
function hideField(){
      $('.form_question[data-type !="p"][aria-hidden ="false"]:not(.on):not(.off)').addClass('hidden')
                                                                                   .attr("data-hidden-by-condition","1")
               																	   .attr("aria-hidden", "true");
}

//Multi-Form control
  function multiControl(){
        var form_id = document.querySelector('form[enctype="multipart/form-data"]').parentNode.getAttribute('id');
        var frameNum = breakString.split(',').length;
        var breakList = [];

        //Initial steps label
         document.querySelector('.form-slate .progress_label').innerHTML = "Step 1 of "+frameNum;

        //get the breakpoint list
        for (var i = 0; i < frameNum; i++){
             var item = parseInt(breakString.split(',')[i]);
             breakList.push(item);
        }

        /* First Frame Set up*/
        var breakStart = breakList[0];
        var breakEnd = breakList[1];

        $('.form_question[data-type !="p"]:not(.hidden):lt('+breakStart+')').addClass('on');
        $('.form_question[data-type !="p"]:not(.hidden):gt('+breakStart+'),.form_question[data-type !="p"]:not(.hidden):eq('+breakStart+') ').addClass('off');
        $('.action button').hide();
        $('<button class="default next '+btnColor+'" type="button" data-frame ="0" data-point='+breakStart+'>Next &#187;</button>').appendTo('.action');

        //Bind next and back function with Key board
        $(document).keydown(function(e) {
            if(e.which == 13 || e.which == 39) {//"enter" or "right arrow")
                $('button.default.next').click();
            }else if (e.which == 37) {
                $('button.default.back').click();
            }
        });

        //click next
        $('button.default.next').unbind().click(function(){
            //hide the description
            $('#form_description').hide();
            //hide question p
            $('.form_question[data-type="p"]').hide();
            var frameData = $('button.default.next').attr('data-frame');
            frameData = parseInt(frameData);
            //console.log("frameData" +frameData);
            //console.log("frameNum" +frameNum);

           //Validate the fields
            var form = window[form_id];
            var point1 =  $('button.default.next').attr('data-point');
            point1 = parseInt(point1);
            var point2 = point1 + breakList[frameData+1];
            //console.log("two points",point1, point2);

            //Validate the form
            if (form.Validate()){
				// hide the hidden field
                hideField();
                $('.form_question[data-type !="p"]:not(.hidden).on').removeClass('on').addClass('off');
                 // $('.form_question[data-type !="p"],.form_question:not([aria-hidden])').not('.hidden').slice(point1,point2).removeClass('off').addClass('on');
                 //$('.form_question[data-type !="p"]').filter(':not([aria-hidden])').not('.hidden').slice(point1,point2).removeClass('off').addClass('on');
				 //$('.form_question[data-type !="p"]:not(.hidden)').filter(':not([aria-hidden])').slice(point1,point2).removeClass('off').addClass('on');
                $('.form_question[data-type !="p"]:not(.hidden)').slice(point1,point2).removeClass('off').addClass('on');

                if ($('button.default.back').length == 0){
                	$('<button class="default back '+btnColor+'" type="button" data-frame ="0" data-point='+point1+'>&#171; Back</button>').prependTo('.action');
    			}else {
					$('button.default.back').show();
                }
                if (frameData == frameNum-2){//End of the questions
                    $('.action button.form_button_submit').show().removeAttr("onClick").addClass('submit');
                    $('.action.form_action.full button.default.back').html('\&#171; Back');
					$('.action.form_action.full button.default.back').css('flex','1');
					$('.action.form_action.full button.form_button_submit').css('flex','5');
                    $('.action.form_action.full button.default.next').css('flex','1');
                    $('.action.form_action.left button.default.back, .action.form_action.right button.default.back').html('\&#171;');
                    if (btnLabel){
                    	document.querySelector(".form-slate button.default.form_button_submit").innerHTML = btnLabel;
                    }
                    $('.action .default.next').hide();
                }

                /* Update the bar */
                //fill the bar
                var barWidth = parseInt(frameData+1)/parseInt(frameNum) * 100;
                $('.progress_bar').animate({
                    width: barWidth+'%'
                }, 1000);
                //Update the bar label
                $('.progress_label').text('Step '+parseInt(frameData+2) + ' of '+frameNum);

                /* increment the frame count and record the last point */
                $('button.default.next').attr('data-frame', frameData+1);
                $('button.default.next').attr('data-point', point2);

                /* increment the frame count and record the first point */
                $('button.default.back').attr('data-frame', frameData);
                $('button.default.back').attr('data-point', point1);

                changeBtn();
            };

            //Submit the form
            $('button.default.submit').click(function(){
                var form = window[form_id];
                if (form.Validate()) {
                    //FW.Lazy.Commit(this, { cmd: 'submit'});
                    //hide the progress bar
                    $('.progress_max').hide();
                    //remove the padding from the form
                    $('.form-slate .heading').next().removeAttr('style');
                }
            });

           $('button.default.back').unbind().click(function() {
               //Force one way traffic
			   $('button.default.submit').hide();
               $('button.default.next').show();

              //Find the frame number
              // if frameData is 1, the back button needs to be remove.
               var backEnd = $('button.default.back').attr('data-point');
               backEnd = parseInt(backEnd);
               var backStart = parseInt(backEnd - breakList[parseInt(frameData)]);
               var backFwd = backStart + breakList[parseInt(frameData)];

               // hide the hidden field
                hideField();

               if (frameData == 0) {
                  $('#form_description p').show();
                  //$('.form_question[data-type !="p"]').removeClass('on').removeClass('off').addClass('off');

                  $('.form_question[data-type !="p"]:not(.hidden).on').removeClass('on').addClass('off');
                  $('.form_question[data-type !="p"]:not(.hidden):lt('+backEnd+')').removeClass('off').addClass('on');
                  $('button.default.back').hide();
                  $('button.default.next').show();

                  /* decrease the frame count and record the last point */
                  $('button.default.next').attr('data-frame', parseInt(frameData));
                  $('button.default.next').attr('data-point', parseInt(backEnd));
               }
               else {
                  $('button.default.back').show();
                  $('.form_question[data-type !="p"]:not(.hidden).on').removeClass('on').addClass('off');

                  //$('.form_question[data-type !="p"]').filter(':not([aria-hidden])').not('.hidden').slice(backStart,backEnd).removeClass('off').addClass('on');
                  //$('.form_question[data-type !="p"]:not(.hidden)').filter(':not([aria-hidden])').slice(backStart,backEnd).removeClass('off').addClass('on');
                  $('.form_question[data-type !="p"]:not(.hidden)').slice(backStart,backEnd).removeClass('off').addClass('on');

                    /* decrease the frame count and record the last point */
                    $('button.default.next').attr('data-frame', parseInt(frameData-1));
                    $('button.default.next').attr('data-point', parseInt(backStart));

                    /* increment the frame count and record the first point */
                    $('button.default.back').attr('data-frame', parseInt(frameData-1));
                    $('button.default.back').attr('data-point', parseInt(backStart));
               }

               changeBtn();
               var barWidth = parseInt(frameData+1)/parseInt(frameNum) * 100;
                $('.progress_bar').animate({
                    width: barWidth+'%'
                }, 1000);
                //Update the bar label
                $('.progress_label').text('Step '+parseInt(frameData+1) + ' of '+frameNum);
                frameData--;
        	});
        });
     };

// Convert term value to term Name
      function courseConvertKey(termName){
          var termSymbol = termName.slice(-4);
          var termKey;
          if (termSymbol == "SPRG"){
                termKey = "Spring " + termName.substr(0,4);
          } else if (termSymbol == "FALL") {
                termKey = "Fall " + termName.substr(0,4);
          } else if (termSymbol == "SUMM") {
                termKey = "Summer " + termName.substr(0,4);
          }
       return termKey;
      }

      // Replace null to "None"

      function courseReplaceNull(origString, endString){
           if (origString == null){
			 endString = endString;
           }else{
             endString = origString;
           }
           return endString;
      }
     // Covert frequency abbreviation to a word
      function courseTranslateFreq(abbr){
           switch(abbr){
             case 'AN':
             	abbr = 'Annually';
                break;
             case 'BI':
             	abbr = 'Biennially';
                break;
             case 'PE':
             	abbr = 'Periodically';
                break;
             case 'TR':
             	abbr = 'Triennially';
                break;
             default:
                freqA = '';
            }
          return abbr;

       }
var CHART_COLOR_ARRAY = [
                                    'rgba(80, 20, 22)',
                                    'rgba(138, 16, 11)',
                                    'rgba(180, 0, 1)',
                                    'rgba(139, 107, 69)',
                                    'rgba(114, 97, 89)',
                                    'rgba(172, 109, 55)',
                                    'rgba(215, 151, 19)',
                                    'rgba(159, 171, 121)',
                                    'rgba(99, 150, 169)',
                                    'rgba(146, 132, 121)',
                                    'rgba(184, 155, 115)'
                                  ];

function getColorByIndex( _num ){
    var myColors = CHART_COLOR_ARRAY
    if( _num > -1 )
    {
        return myColors[ _num % myColors.length];
    }
    else
    {
        return myColors[ 0 ];
    }
}

function getColorArray( _array ){
    var myColors = CHART_COLOR_ARRAY;
    var extendedColors = [];
    for(var i = 0; i < _array.length; i++)
    {
        extendedColors.push( myColors[ i % myColors.length ] );
    }
    return extendedColors;
}

function makeChart( _data, _id, _chart, _style, _ticks) {
    //console.log('make chart _data, _id, _chart, _style');
    //console.log(_data, _id, _chart, _style);
    var thisChartLabel = [];
    var thisChartData = [];
    var chartDataArray =[];
    var chartDataObject = {};
    var startTicks = _ticks;
    //alert(startTicks);
    // chartType is type defined by chart.js
    // useChartType tells the script how to process the data and layout options
    var chartType = _style;
    var useChartType = "simpleBar";

    switch(chartType)
    {
        case "pie":
            useChartType = 'circle';
        break;

        case "doughnut":
            useChartType = 'circle';
        break;

        case "polarArea":
            useChartType = 'circle';
        break;

        case "groupedBar":
            useChartType = 'fancyBar';
            chartType = 'bar';
        break;

        case "horizontalGroupedBar":
            useChartType = 'fancyBar';
            chartType = 'horizontalBar';
        break;

        case "groupedLine":
            useChartType = 'fancyBar';
            chartType = 'line';
        break;
    }

    // set options and format data based on chart type
    switch(useChartType){
        case 'fancyBar': // for charts with more than basic xy data
			 var isLine = (chartType == 'line')
             legendOptions = {
                              display: true,
                              labels:{
                                   display:true
                                }
                              };

             var topLabels = get2DCharlabels(_data);
           //console.log('fancyBar toplabels', topLabels);

             for( var i = 1; i < _data[0].length; i++){
                chartDataArray.push(
                    {
                        backgroundColor:getColorByIndex(i-1),
                        borderColor:getColorByIndex(i-1),
                        label:topLabels[i],
                        data:[],
                        fill:!isLine,
                        lineTension: 0
                    }
                );
             }
				//console.log('chartDataArray', chartDataArray, chartDataArray.length);
               // each array item is an object
               // each object has bgcolor, label, and an array of items

             var chartLabels = topLabels[0].split("0x0x0");
			 var l = _data.length;
             for(var i = 1; i < l; i++){

                thisChartLabel.push(capitalizeFirstLetter(_data[i].label) );
                var c = chartDataArray.length;
                for( j = 0; j < c; j++)
                {
                   chartDataArray[j].data.push( _data[i].value[j]);
                }
             }

            var variableLable1;
            var variableLable2;
            var yTicks = false;
            var xTicks = false;
            if(chartType == 'horizontalBar')
            {
				variableLable1 = capitalizeFirstLetter(chartLabels[1]);
                variableLable2 = capitalizeFirstLetter(chartLabels[0]);
                xTicks = startTicks;
            }
            else
            {
				variableLable1 = capitalizeFirstLetter(chartLabels[0]);
                variableLable2 = capitalizeFirstLetter(chartLabels[1]);
                yTicks = startTicks;
            }

            var xAxesOptions =[{
                                 display: true,
                                 scaleLabel: {
                                   display: true,
                                   labelString: variableLable1
                                 },
                				ticks: {
                                        beginAtZero: xTicks
                                    }

                               }];
            var yAxesOptions = [{
                                  display: true,
                                  scaleLabel: {
                                    display: true,
                                    labelString: variableLable2
                                  },
                                    ticks: {
                                       beginAtZero: yTicks
                                    }
                                }];

            chartDataObject = {
                                   labels: thisChartLabel,
                                   datasets: chartDataArray
                                 };
        break;

        case 'circle':
            var chartLabels = get2DCharlabels(_data);
			//console.log('circle toplabels', chartLabels);
            legendOptions = {position: 'bottom',
                              display: true,
                              labels:{
                                   fontColor: '#666',
                                  //  fontSize: 14,
                                    arc: true,
                                    padding: 10
                                }
                              };
            xAxesOptions=[{display: false}];
            yAxesOptions=[{display: false}];
            for(var i = 1; i < _data.length; i++){
                thisChartLabel.push(_data[i].label);
                thisChartData.push(_data[i].value[0]);
            }

            chartDataArray = [{
                data: thisChartData,
                backgroundColor:getColorArray(thisChartData)
            }];
             chartDataObject = {
                              labels: thisChartLabel,
                              datasets: chartDataArray
                            };
        break;

        default:
            var chartLabels = get2DCharlabels(_data);
            //console.log('default toplabels', chartLabels);
            var legendOptions = {display: false,};
            var variableLable1;
            var variableLable2;
            var yTicks = false;
            var xTicks = false;
            if(chartType == 'horizontalBar')
            {
                variableLable1 = capitalizeFirstLetter(chartLabels[1]);
                variableLable2 = capitalizeFirstLetter(chartLabels[0]);
                xTicks = startTicks;
            }
            else
            {
                variableLable1 = capitalizeFirstLetter(chartLabels[0]);
                variableLable2 = capitalizeFirstLetter(chartLabels[1]);
                yTicks = startTicks;
            }
            var xAxesOptions =[{
                                display: true,
                                scaleLabel: {
                                  display: true,
                                  labelString: variableLable1
                                },
                				ticks: {
                                	beginAtZero: xTicks
                                }
                              }];
            var yAxesOptions = [{
                                 display: true,
                                 scaleLabel: {
                                   display: true,
                                   labelString: variableLable2
                                 },
                				ticks: {
                                	beginAtZero: yTicks
                                }
                               }];

            for(var i = 1; i < _data.length; i++){
                thisChartLabel.push(_data[i].label);
                thisChartData.push(_data[i].value[0]);
            }
            chartDataArray = [{
                data: thisChartData,
                backgroundColor:getColorArray(thisChartData)
            }];
            chartDataObject = {
                  labels: thisChartLabel,
                  datasets: chartDataArray
                };
    }
	var checkExist = setInterval(function() {
        if(Chart && Chart != 'undefined'){
            clearInterval(checkExist);
            //console.log('chartDataObject', chartDataObject);
            var chart = new Chart(_id, {
            type: chartType,
            options: {
              maintainAspectRatio: true,
              legend: legendOptions,
              scales: {
                xAxes:xAxesOptions,
                yAxes:yAxesOptions
              },
              layout: {
                padding: {
                  left: 0,
                  right:0,
                  top:0,
                  bottom:0
                }
              }
            },
            data: chartDataObject
          });

        }
     });
}

function get2DCharlabels(_data){
    //console.log('get2DCharlabels', _data)
    var chartLabels = [];
    //console.log('get2DCharlabels', _data[0]);
    for( i = 0; i < _data[0].length; i++){
        //console.log('_data[0][i]', _data[0][i], i)
         chartLabels.push( capitalizeFirstLetter(_data[0][i]) );
    }
    return chartLabels;
}

// take the data and make an array for the chart.js module
function weedJSON(_data){
    //console.log('weedJSON', _data)

    var resultArray = [];
    // get the labels
    var arr =[];
    for(var i = 1; i < _data.table.cols.length; i++){
		arr.push(_data.table.cols[i].label);
    }
    resultArray.push(arr);
    for(var i = 0; i < _data.table.rows.length; i++)
    {
        //arr.push(_data.table.rows[i]);
        resultArray.push( parseArrayItem(_data.table.rows[i].c) );
    }
    return resultArray;
}

function parseArrayItem( _data ){
    //console.log('parseArrayItem', _data)
    //var dataArray = _data.split(", ");
    var valueArrayString = '[';
    var newString='{';
    for(var i=1; i < _data.length; i++){
        //var valuePair = _data[i].split(": ");
        if(i == 1){
			newString += '"label"' + ':' + '"'+_data[i].v+'",';
        }
        else{
			valueArrayString += '"' + _data[i].f + '"';
            if( i+1 < _data.length ){
            	valueArrayString += ',';
        	}
        }
    }
    newString += '"value"' + ':' + valueArrayString + ']';
    newString+='}';
    //console.log('newString', newString)
    return JSON.parse(newString);
}

function capitalizeFirstLetter(_str){
    //console.log('capitalizeFirstLetter', _str);
    var upper = _str.charAt(0).toUpperCase();
    var rest = _str.slice(1);
    return upper + rest;
}

function loadJSON(path, _id, _chart, _style, _ticks, success, error){
    //console.log("loadJSON", path, _id, _chart, _style);
    var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function()
    {
        if (xhr.readyState === XMLHttpRequest.DONE) {
            if (xhr.status === 200) {
                if (success)
                    //console.log(typeof xhr.responseText)
                    //console.log('success' , xhr.responseText);
                    success(JSON.parse(xhr.responseText.substr(47).slice(0, -2)), _id,  _chart, _style, _ticks);
            } else {
                if (error)
                    error(xhr);
            }
        }
    };
    xhr.open("GET", path, true);
    xhr.send();
}

 /*
URL FOR JSON MUST BE FORMED THIS WAY
https://docs.google.com/spreadsheets/d/GOOGLE_ID/gviz/tq?tqx=out:json
 */
// use the default google sheets url, parse out the id and create a a URL to return JSON
//https://docs.google.com/spreadsheets/d/1T5fEMRMvM4jrBaTNiKTmyg9q2Y-yH7iPepCCVLHCyUQ/edit#gid=0

function getJsonURL(_url){
    var ID_INDEX_NUMBER = 5;
    var jsonURL = '';
    var URL_PREFIX = 'https://docs.google.com/spreadsheets/d/';
    var URL_SUFFIX = '/gviz/tq?tqx=out:json';
    var urlArray = _url.split('/');
    jsonURL = URL_PREFIX + urlArray[ID_INDEX_NUMBER] + URL_SUFFIX;
    return jsonURL;
}

$(document).ready(function(){
    if(typeof bcChartComponent !== 'undefined'){
        loadScriptOnce("https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js");

        var charts = $('.bc-chart-wrapper');
        for( var i= 0; i < charts.length; i++)
        {
            var chartID = $(charts[i]).attr('data-id');
            var chartTitle = $(charts[i]).attr('data-title');
            var chartStyle = $(charts[i]).attr('data-style');
            var url = getJsonURL($(charts[i]).attr('data-url'));
            var ticks = ($(charts[i]).attr('data-ticks')==='true')?true:false;
            loadJSON(url,
            chartID,
            chartTitle,
            chartStyle,
            ticks,
            function(data, _id, _chart, _style, _ticks) {
                makeChart(weedJSON(data), _id, _chart, _style, _ticks);
            },
            function(xhr) { console.error(xhr); }
            );
        }
    }
});
