function LinkSearch(){this.LINK_SEARCH_ID="LinkSearch";this.LINK_SEARCH_CLASS_NAME="linkSearch";this.LINK_SEARCH_ALL_FIELDS_PANEL_CLASS_NAME="linkSearchAllFieldsPanel";this.LINK_SEARCH_THIS_FIELD_PANEL_CLASS_NAME="linkSearchThisFieldPanel";this.LINK_SEARCH_MAIN_PANEL_CLASS_NAME="linkSearchMainPanel";this.LINK_SEARCH_THIS_FIELD_MENU_CLASS_NAME="linkSearchThisFieldMenu";this.LINK_SEARCH_ALL_FIELDS_MENU_CLASS_NAME="linkSearchAllFieldsMenu";this.LINK_SEARCH_VALUE_SEPARATOR=/;(?!\S+&)|\s>rb<\s/;this.SEARCH_THIS_FIELD="Search ";this.SEARCH_ALL_FIELDS="Search All Fields";this.SEARCH_OR_OPERATOR=" or ";this.mLinkSearchAllFieldsPanel=null;this.mLinkSearchThisFieldPanel=null;this.mLinkSearchThisFieldMenu=null;this.mLinkSearchAllFieldsMenu=null;this.mLinkSearchMainPanel=null;this.mMediaInformationContainer=null;this.mSearchPrefixUrl=null;this.mExcludedFields=null;this.mShowTimeout=0;this.mHideTimeout=0;this.mSortFields=null;this.mLinkSearch=document.createElement("div");this.mLinkSearch.classList.add(this.LINK_SEARCH_CLASS_NAME);this.mLinkSearch.id=this.LINK_SEARCH_ID;this.mLinkSearch.linkSearch=this;this.init=function(){var B=this.mMediaInformationContainer.getElementsByClassName("singleValueValue");var E=this.mMediaInformationContainer.getElementsByClassName("valueFieldDisplayNameTD");for(var D=0;D<B.length;D++){var F=E[D].innerHTML.trim();if(F.endsWith(":")){F=F.substring(0,F.length-1)}if(this.isExcludedField(F)){continue}$(B[D]).closest(".clsb").on("mouseover",Static_Media_Value_MouseOver)}var A=document.getElementById("MediaInformation");var C=A.getElementsByClassName("body");YAHOO.util.Event.addListener(C,"mouseout",Static_Media_Container_Body_MouseOut)};this.render=function(A){if(A){this.mMediaInformationContainer=A;this.mMediaInformationContainer.appendChild(this.mLinkSearch);this.init()}};this.setSearchPrefixUrl=function(A){if(A){this.mSearchPrefixUrl=A}};this.setExcludedFields=function(A){if(A){for(i=0;i<A.length;i++){A[i]=A[i].trim()}this.mExcludedFields=A}};this.setShowTimeOut=function(A){if(A&&A>0){this.mShowTimeout=A}};this.setHideTimeOut=function(A){if(A&&A>0){this.mHideTimeout=A}};this.setSort=function(A){if(A!=null){this.mSortFields=A}};this.isExcludedField=function(A){if(this.mExcludedFields!=null){for(i=0;i<this.mExcludedFields.length;i++){if(this.mExcludedFields[i].toLowerCase()==A.toLowerCase()){return true}}}return false};this.constructLinkSearchMainPanel=function(D,C,B){var A=$("<div>",{"class":this.LINK_SEARCH_MAIN_PANEL_CLASS_NAME});A.css({position:"absolute",top:D+"px",left:C+"px"});if(B.hideSearchAll!=="true"){this.mLinkSearchAllFieldsPanel=this.constructLinkSearchAllFieldsPanel(B);A.append(this.mLinkSearchAllFieldsPanel)}this.mLinkSearchThisFieldPanel=this.constructLinkSearchThisFieldPanel(B);A.append(this.mLinkSearchThisFieldPanel);A.on("mouseout",Static_Link_Search_MouseOut);return A};this.constructLinkSearchAllFieldsPanel=function(A){var B=$("<div>",{"class":this.LINK_SEARCH_ALL_FIELDS_PANEL_CLASS_NAME,css:{cssFloat:"left",backgroundColor:"#CAC2B7",textAlign:"center"},text:this.SEARCH_ALL_FIELDS});B.on("click",function(){Static_Field_Button_MouseClick(A)}).on("mouseover",Static_All_Fields_MouseOver).on("mouseout",Static_All_Fields_MouseOut);return B};this.constructLinkSearchThisFieldPanel=function(C){var A=C.displayName.unescapeHTML().trim();var B=$("<div>",{"class":this.LINK_SEARCH_THIS_FIELD_PANEL_CLASS_NAME,css:{cssFloat:"left",backgroundColor:"#CAC2B7",textAlign:"center"},on:{click:function(){Static_Field_Button_MouseClick(C)},mouseover:Static_This_Field_MouseOver,mouseout:Static_This_Field_MouseOut},text:this.SEARCH_THIS_FIELD+" "+A});return B};this.constructLinkSearchThisFieldMenu=function(E){var D=E.fieldName.split(/]\|#/);var C=$("<div>",{"class":this.LINK_SEARCH_THIS_FIELD_MENU_CLASS_NAME});var A=jshReverseString(E.fieldValue).split(this.LINK_SEARCH_VALUE_SEPARATOR).reverse();var B=this;$.each(A,function(I,J){var H=I;while(D[H]==null&&H>0){H--}var F=jshReverseString(J.trim()).unescapeHTML();var G=$("<a>",{href:B.mSearchPrefixUrl+"?q="+D[H].trim().replace(/\s+/g,"")+'="'+encodeURIComponent(F)+'"'+(B.mSortFields!=null?"&sort="+B.mSortFields:""),text:E.fieldDisplayValue?B.fixedLengthString(E.fieldDisplayValue):B.fixedLengthString(F),css:{display:"block",textAlign:"left",textDecoration:"none",}});C.append(G)});C.on("mouseover",Static_Field_Menu_MouseOver);return C[0]};this.constructLinkSearchAllFieldsMenu=function(E){var D=E.fieldName.split(/]\|#/);var C=$("<div>",{"class":this.LINK_SEARCH_ALL_FIELDS_MENU_CLASS_NAME});var A=jshReverseString(E.fieldValue).split(this.LINK_SEARCH_VALUE_SEPARATOR).reverse();var B=this;$.each(A,function(I,J){var H=I;while(D[H]==null&&H>0){H--}var F=jshReverseString(J.trim()).unescapeHTML();var G=$("<a>",{href:B.mSearchPrefixUrl+'?q=="'+encodeURIComponent(F)+'"'+(B.mSortFields!=null?"&sort="+B.mSortFields:""),text:B.fixedLengthString(F),css:{display:"block",textAlign:"left",textDecoration:"none"}});C.append(G)});C.on("mouseover",Static_Field_Menu_MouseOver);return C[0]};this.fixedLengthString=function(A){return A.truncate()};this.buildSearchQuery=function(F,A){var B=jshReverseString(F.fieldValue).split(this.LINK_SEARCH_VALUE_SEPARATOR);var E=F.fieldName.split(/<br>|<br\s*\/>|]\|#/);var D=this.mSearchPrefixUrl+"?q=";B=B.reverse();if(A){for(i=0;i<B.length;i++){if(i>0){D+=" AND ="}else{if(i==0){D+="="}}D+='"'+encodeURIComponent(jshReverseString(B[i].trim()).unescapeHTML())+'"'}}else{var C="";var G="";for(i=0;i<B.length;i++){if(i>0){D+=" AND "}if(i>=E.length){G=C}else{G=E[i].trim().replace(" ","");C=G}D+=G+'="'+encodeURIComponent(jshReverseString(B[i].trim()).unescapeHTML())+'"'}}if(D!=null&&this.mSortFields!=null){D+="&sort="+this.mSortFields}return D};this.performLinkSearch=function(B,A){window.document.location.href=this.buildSearchQuery(B,A)};this.hideLinkSearchContainer=function(A){if(A!=null&&A.descendantOf(this.mLinkSearch)){}else{if(this.mLinkSearch){while(this.mLinkSearch.hasChildNodes()){this.mLinkSearch.removeChild(this.mLinkSearch.lastChild)}}}};this.showLinkSearchContainer=function(E,A){this.hideLinkSearchContainer();if(E&&A){var B=$(A).parent().find(".linkSearchContainer");if(B==null||B.length==0){return }var C=$(E).closest(".clsb");var G=C.offset();var F={fieldName:B[0].getElementsByClassName("linkSearchFieldName")[0].innerHTML,fieldValue:B[0].getElementsByClassName("linkSearchFieldValue")[0].innerHTML,displayName:B[0].getElementsByClassName("linkSearchFieldDisplayName")[0].innerHTML,hideSearchAll:B[0].getElementsByClassName("linkSearchHideSearchAll")[0].innerHTML};if(B[0].getElementsByClassName("linkSearchFieldDisplayValue").length>0){F.fieldDisplayValue=B[0].getElementsByClassName("linkSearchFieldDisplayValue")[0].innerHTML}if(YAHOO.env.ua.ie>0){F.fieldValue=F.fieldValue.replace(/<BR>/,"<br> ")}var D=this.constructLinkSearchMainPanel(G.top,G.left+C.getWidth(),F);this.mLinkSearchAllFieldsMenu=this.constructLinkSearchAllFieldsMenu(F);this.mLinkSearchThisFieldMenu=this.constructLinkSearchThisFieldMenu(F);$(this.mLinkSearch).appendChild(D);$(this.mLinkSearch).appendChild(this.mLinkSearchAllFieldsMenu);$(this.mLinkSearch).appendChild(this.mLinkSearchThisFieldMenu);if(this.mLinkSearchAllFieldsPanel){if($("div.linkSearchThisFieldPanel").length>0){$("div.linkSearchThisFieldPanel")[0].style.minWidth=this.mLinkSearchAllFieldsPanel.getWidth()+"px"}if($("div.linkSearchAllFieldsPanel").length>0){$("div.linkSearchAllFieldsPanel")[0].style.minWidth=this.mLinkSearchAllFieldsPanel.getWidth()+"px"}}}};this.showThisFieldMenu=function(){if(this.mLinkSearchThisFieldMenu){this.mLinkSearchThisFieldMenu.style.display="block";this.mLinkSearchThisFieldMenu.style.visibility="visible";if(this.mLinkSearchThisFieldPanel){var A=$(this.mLinkSearchThisFieldPanel).offset();this.mLinkSearchThisFieldMenu.style.position="absolute";this.mLinkSearchThisFieldMenu.style.top=A.top+this.mLinkSearchThisFieldPanel.getHeight()+5+"px";this.mLinkSearchThisFieldMenu.style.left=A.left+"px";this.mLinkSearchThisFieldMenu.style.width=this.mLinkSearchThisFieldPanel.getWidth()+"px"}}};this.showAllFieldsMenu=function(){if(this.mLinkSearchAllFieldsMenu){this.mLinkSearchAllFieldsMenu.style.display="block";this.mLinkSearchAllFieldsMenu.style.visibility="visible";if(this.mLinkSearchAllFieldsPanel){var A=$(this.mLinkSearchAllFieldsPanel).offset();this.mLinkSearchAllFieldsMenu.style.position="absolute";this.mLinkSearchAllFieldsMenu.style.top=A.top+this.mLinkSearchAllFieldsPanel.getHeight()+5+"px";this.mLinkSearchAllFieldsMenu.style.left=A.left+"px";this.mLinkSearchAllFieldsMenu.style.width=this.mLinkSearchAllFieldsPanel.getWidth()+"px"}}};this.hideThisFieldMenu=function(C,B){if(B!=null&&B.descendantOf(this.mLinkSearch)&&C.className!=this.LINK_SEARCH_ALL_FIELDS_PANEL_CLASS_NAME){}else{if(C&&C.className==this.LINK_SEARCH_ALL_FIELDS_PANEL_CLASS_NAME){var A=$(C).closest("."+this.LINK_SEARCH_CLASS_NAME).find("."+this.LINK_SEARCH_THIS_FIELD_MENU_CLASS_NAME);if(A.length!=0){A[0].style.display="none";A[0].style.visibility="hidden"}}}};this.hideAllFieldsMenu=function(C,A,D){if(A!=null&&A.descendantOf(this.mLinkSearch)&&C.className!=this.LINK_SEARCH_THIS_FIELD_PANEL_CLASS_NAME){}if(D||(C&&C.className==this.LINK_SEARCH_THIS_FIELD_PANEL_CLASS_NAME)){var B=$(C).closest("."+this.LINK_SEARCH_CLASS_NAME).find("."+this.LINK_SEARCH_ALL_FIELDS_MENU_CLASS_NAME);if(B.length!=0){B[0].style.display="none";B[0].style.visibility="hidden"}}};this.resetRowStyle=function(){var B=$("div.valueFieldDisplayNameTD");for(i=0;i<B.length;i++){B[i].closest("div").style.backgroundColor=""}var A=$("div.valueValueTD");for(i=0;i<A.length;i++){if(A[i].closest(".clsb")){A[i].closest(".clsb").style.backgroundColor=""}}};this.enableRowStyle=function(B,A){if(B){this.resetRowStyle();var C;C=$(B).closest(".clsb");if(C.length!=0){C[0].style.backgroundColor="#E7E1D8"}C=$(A).closest(".clsb");if(C.length!=0){C[0].style.backgroundColor="#E7E1D8"}}};this.disableRowStyle=function(B,A){var C;if(B){C=$(B).closest(".clsb");if(C.length!=0){C[0].style.backgroundColor=""}}if(A){C=$(A).closest(".clsb");if(C.length!=0){C[0].style.backgroundColor=""}}};this.destroy=function(){this.resetRowStyle();this.hideLinkSearchContainer()}}function Static_Is_Row_Style_Enabled(A){if(A instanceof jQuery){A=A[0]}if(A&&A.style.backgroundColor==""){return false}else{return true}}function Static_Is_Same_Field(B,A){if(B&&A){if(B instanceof jQuery){B=B[0]}if(A instanceof jQuery){A=A[0]}var D=$(B),C=$(A);if(D.closest("div")&&C.closest("div")&&D.closest("div")==C.closest("div")){return true}if(B.className=="valueFieldDisplayNameTD"&&C.descendantOf(D.closest("div").nextSiblings()[0])){return true}else{if(A.className=="valueFieldDisplayNameTD"&&D.descendantOf(D.closest("div").nextSiblings()[0])){return true}else{if((B.className=="valueValueTD"||B.className=="singleValueValue")&&C.descendantOf(D.closest("div").previousSiblings()[0])){return true}else{if((A.className=="valueValueTD"||A.className=="singleValueValue")&&D.descendantOf(C.closest("div").previousSiblings()[0])){return true}}}}}return false}function Static_Media_Value_MouseOver(G){G=jshGetEvent(G);var C=jshGetSourceElement(G);var I=$(C);var B="linkSearch";var D=null;var H=null;var E=G.relatedTarget||G.toElement;E=(E==null?null:$(E));if(Static_Is_Same_Field(C,E)&&Static_Is_Row_Style_Enabled(I.closest(".clsb"))){return }if(C){var A=document.getElementById("MediaInformation");var F=A.getElementsByClassName(B)[0].linkSearch;if(I.closest(".clsb")&&C.className=="valueFieldDisplayNameTD"){H=C;D=I.closest(".clsb").find(".singleValueValue")}else{if(I.closest(".clsb")&&C.className=="singleValueValue"){H=I.closest(".clsb").find(".valueFieldDisplayNameTD");D=C}else{if(I.closest(".clsb").length>0){H=I.closest(".clsb").find(".valueFieldDisplayNameTD");D=I.closest(".clsb").find(".singleValueValue")}}}YAHOO.util.Event.addListener(H,"mouseout",Static_Media_Value_MouseOut);YAHOO.util.Event.addListener(D,"mouseout",Static_Media_Value_MouseOut);if(H&&D&&$(H).closest(".clsb")&&$(D).closest(".clsb")){YAHOO.util.Event.addListener($(H).closest(".clsb"),"mouseout",Static_Media_Value_MouseOut);YAHOO.util.Event.addListener($(D).closest(".clsb"),"mouseout",Static_Media_Value_MouseOut)}F.enableRowStyle(I.closest(".clsb")[0],null);F.hideLinkSearchContainer();if(linkSearchShowTimerId!=null&&linkSearchShowTimerId>0){window.clearTimeout(linkSearchShowTimerId)}linkSearchShowTimerId=window.setTimeout(function(){F.showLinkSearchContainer(H,D)},F.mShowTimeout)}}function Static_Media_Container_Body_MouseOut(F){var C=jshGetSourceElement(F);var D="linkSearch";var B=F.relatedTarget||F.toElement;B=(B==null?null:$(B));var A=document.getElementById("MediaInformation");var E=A.getElementsByClassName(D)[0].linkSearch;if($(B).length==0||$(B).closest(".body").length==0){if(linkSearchHideTimerId!=null&&linkSearchHideTimerId>0){window.clearTimeout(linkSearchHideTimerId)}linkSearchHideTimerId=window.setTimeout(function(){E.hideLinkSearchContainer();E.resetRowStyle()},E.mHideTimeout)}}function Static_Media_Value_MouseOut(G){G=jshGetEvent(G);var C=jshGetSourceElement(G);var I=$(C);var B="linkSearch";var E=G.relatedTarget||G.toElement;E=(E==null?null:$(E));var D=null;var H=null;var A=document.getElementById("MediaInformation");var F=A.getElementsByClassName(B)[0].linkSearch;if(Static_Is_Same_Field(C,E)){}else{if(E==null||E.closest("#MediaInformation").length==0){if(I.closest(".clsb")&&C.className=="valueFieldDisplayNameTD"){H=C;D=I.closest(".clsb").nextSiblings()[0].getElementsByClassName("singleValueValue")}else{if(I.closest(".clsb")&&(C.className=="singleValueValue"||C.className=="valueValueTD")){H=I.closest(".clsb").previousSiblings()[0].getElementsByClassName("valueFieldDisplayNameTD");D=C}}if(linkSearchHideTimerId!=null&&linkSearchHideTimerId>0){window.clearTimeout(linkSearchHideTimerId)}linkSearchHideTimerId=window.setTimeout(function(){F.hideLinkSearchContainer();F.disableRowStyle(H,D)},F.mHideTimeout)}}}function Static_Link_Search_MouseOut(G){G=jshGetEvent(G);var C=jshGetSourceElement(G);var I=$(C);var B="linkSearch";var E=G.relatedTarget||G.toElement;E=(E==null?null:$(E));var D=null;var H=null;var A=document.getElementById("MediaInformation");var F=A.getElementsByClassName(B)[0].linkSearch;if($(E).length==0||$(E).closest(".body").length==0){if(linkSearchHideTimerId!=null&&linkSearchHideTimerId>0){window.clearTimeout(linkSearchHideTimerId)}linkSearchHideTimerId=window.setTimeout(function(){F.hideLinkSearchContainer();F.resetRowStyle()},F.mHideTimeout)}}function Static_Field_Button_MouseClick(H,G){H=jshGetEvent(H);var C=jshGetSourceElement(H);var F=$(C);var D="linkSearch";var B=false;if(C){var A=document.getElementById("MediaInformation");var E=A.getElementsByClassName(D)[0].linkSearch;if(C.className.indexOf("All")>=0){B=true}E.performLinkSearch(G,B)}}function Static_All_Fields_MouseOver(G){G=jshGetEvent(G);var C=jshGetSourceElement(G);var F=$(C);var D="linkSearch";var B=G.relatedTarget||G.toElement;B=(B==null?null:$(B));if(C){if(linkSearchHideTimerId!=null&&linkSearchHideTimerId>0){window.clearTimeout(linkSearchHideTimerId)}var A=document.getElementById("MediaInformation");var E=A.getElementsByClassName(D)[0].linkSearch;E.showAllFieldsMenu(C);E.hideThisFieldMenu(C,B)}}function Static_All_Fields_MouseOut(G){G=jshGetEvent(G);var C=jshGetSourceElement(G);var F=$(C);var D="linkSearch";var B=G.relatedTarget||G.toElement;B=(B==null?null:$(B));if(C){var A=document.getElementById("MediaInformation");var E=A.getElementsByClassName(D)[0].linkSearch;E.hideAllFieldsMenu(C,B)}}function Static_This_Field_MouseOver(G){G=jshGetEvent(G);var C=jshGetSourceElement(G);var F=$(C);var D="linkSearch";var B=G.relatedTarget||G.toElement;B=(B==null?null:$(B));if(C){if(linkSearchHideTimerId!=null&&linkSearchHideTimerId>0){window.clearTimeout(linkSearchHideTimerId)}var A=document.getElementById("MediaInformation");var E=A.getElementsByClassName(D)[0].linkSearch;E.showThisFieldMenu();E.hideAllFieldsMenu(C,B,true)}}function Static_This_Field_MouseOut(G){G=jshGetEvent(G);var C=jshGetSourceElement(G);var F=$(C);var D="linkSearch";var B=G.relatedTarget||G.toElement;B=(B==null?null:$(B));if(C){var A=document.getElementById("MediaInformation");var E=A.getElementsByClassName(D)[0].linkSearch;E.hideThisFieldMenu(C,B)}}function Static_Field_Menu_MouseOver(E){E=jshGetEvent(E);var B=jshGetSourceElement(E);var D=$(B);var C="linkSearch";var A=E.relatedTarget||E.toElement;A=(A==null?null:$(A));if(B){if(linkSearchHideTimerId!=null&&linkSearchHideTimerId>0){window.clearTimeout(linkSearchHideTimerId)}}}function Static_Collapse_Button_Click(F){F=jshGetEvent(F);var B=jshGetSourceElement(F);var E=$(B);var C="linkSearch";if(B){var A=document.getElementById("MediaInformation");var D=A.getElementsByClassName(C)[0].linkSearch;D.destroy()}};