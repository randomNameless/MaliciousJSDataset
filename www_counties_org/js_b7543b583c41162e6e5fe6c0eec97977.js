
/*
 * jQuery 1.2.6 - New Wave Javascript
 *
 * Copyright (c) 2008 John Resig (jquery.com)
 * Dual licensed under the MIT (MIT-LICENSE.txt)
 * and GPL (GPL-LICENSE.txt) licenses.
 *
 * Date: 2008-05-24 14:22:17 -0400 (Sat, 24 May 2008)
 * Rev: 5685
 */
eval(function(p,a,c,k,e,r){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('(H(){J w=1b.4M,3m$=1b.$;J D=1b.4M=1b.$=H(a,b){I 2B D.17.5j(a,b)};J u=/^[^<]*(<(.|\\s)+>)[^>]*$|^#(\\w+)$/,62=/^.[^:#\\[\\.]*$/,12;D.17=D.44={5j:H(d,b){d=d||S;G(d.16){7[0]=d;7.K=1;I 7}G(1j d=="23"){J c=u.2D(d);G(c&&(c[1]||!b)){G(c[1])d=D.4h([c[1]],b);N{J a=S.61(c[3]);G(a){G(a.2v!=c[3])I D().2q(d);I D(a)}d=[]}}N I D(b).2q(d)}N G(D.1D(d))I D(S)[D.17.27?"27":"43"](d);I 7.6Y(D.2d(d))},5w:"1.2.6",8G:H(){I 7.K},K:0,3p:H(a){I a==12?D.2d(7):7[a]},2I:H(b){J a=D(b);a.5n=7;I a},6Y:H(a){7.K=0;2p.44.1p.1w(7,a);I 7},P:H(a,b){I D.P(7,a,b)},5i:H(b){J a=-1;I D.2L(b&&b.5w?b[0]:b,7)},1K:H(c,a,b){J d=c;G(c.1q==56)G(a===12)I 7[0]&&D[b||"1K"](7[0],c);N{d={};d[c]=a}I 7.P(H(i){R(c 1n d)D.1K(b?7.V:7,c,D.1i(7,d[c],b,i,c))})},1g:H(b,a){G((b==\'2h\'||b==\'1Z\')&&3d(a)<0)a=12;I 7.1K(b,a,"2a")},1r:H(b){G(1j b!="49"&&b!=U)I 7.4E().3v((7[0]&&7[0].2z||S).5F(b));J a="";D.P(b||7,H(){D.P(7.3t,H(){G(7.16!=8)a+=7.16!=1?7.76:D.17.1r([7])})});I a},5z:H(b){G(7[0])D(b,7[0].2z).5y().39(7[0]).2l(H(){J a=7;1B(a.1x)a=a.1x;I a}).3v(7);I 7},8Y:H(a){I 7.P(H(){D(7).6Q().5z(a)})},8R:H(a){I 7.P(H(){D(7).5z(a)})},3v:H(){I 7.3W(19,M,Q,H(a){G(7.16==1)7.3U(a)})},6F:H(){I 7.3W(19,M,M,H(a){G(7.16==1)7.39(a,7.1x)})},6E:H(){I 7.3W(19,Q,Q,H(a){7.1d.39(a,7)})},5q:H(){I 7.3W(19,Q,M,H(a){7.1d.39(a,7.2H)})},3l:H(){I 7.5n||D([])},2q:H(b){J c=D.2l(7,H(a){I D.2q(b,a)});I 7.2I(/[^+>] [^+>]/.11(b)||b.1h("..")>-1?D.4r(c):c)},5y:H(e){J f=7.2l(H(){G(D.14.1f&&!D.4n(7)){J a=7.6o(M),5h=S.3h("1v");5h.3U(a);I D.4h([5h.4H])[0]}N I 7.6o(M)});J d=f.2q("*").5c().P(H(){G(7[E]!=12)7[E]=U});G(e===M)7.2q("*").5c().P(H(i){G(7.16==3)I;J c=D.L(7,"3w");R(J a 1n c)R(J b 1n c[a])D.W.1e(d[i],a,c[a][b],c[a][b].L)});I f},1E:H(b){I 7.2I(D.1D(b)&&D.3C(7,H(a,i){I b.1k(a,i)})||D.3g(b,7))},4Y:H(b){G(b.1q==56)G(62.11(b))I 7.2I(D.3g(b,7,M));N b=D.3g(b,7);J a=b.K&&b[b.K-1]!==12&&!b.16;I 7.1E(H(){I a?D.2L(7,b)<0:7!=b})},1e:H(a){I 7.2I(D.4r(D.2R(7.3p(),1j a==\'23\'?D(a):D.2d(a))))},3F:H(a){I!!a&&D.3g(a,7).K>0},7T:H(a){I 7.3F("."+a)},6e:H(b){G(b==12){G(7.K){J c=7[0];G(D.Y(c,"2A")){J e=c.64,63=[],15=c.15,2V=c.O=="2A-2V";G(e<0)I U;R(J i=2V?e:0,2f=2V?e+1:15.K;i<2f;i++){J d=15[i];G(d.2W){b=D.14.1f&&!d.at.2x.an?d.1r:d.2x;G(2V)I b;63.1p(b)}}I 63}N I(7[0].2x||"").1o(/\\r/g,"")}I 12}G(b.1q==4L)b+=\'\';I 7.P(H(){G(7.16!=1)I;G(b.1q==2p&&/5O|5L/.11(7.O))7.4J=(D.2L(7.2x,b)>=0||D.2L(7.34,b)>=0);N G(D.Y(7,"2A")){J a=D.2d(b);D("9R",7).P(H(){7.2W=(D.2L(7.2x,a)>=0||D.2L(7.1r,a)>=0)});G(!a.K)7.64=-1}N 7.2x=b})},2K:H(a){I a==12?(7[0]?7[0].4H:U):7.4E().3v(a)},7b:H(a){I 7.5q(a).21()},79:H(i){I 7.3s(i,i+1)},3s:H(){I 7.2I(2p.44.3s.1w(7,19))},2l:H(b){I 7.2I(D.2l(7,H(a,i){I b.1k(a,i,a)}))},5c:H(){I 7.1e(7.5n)},L:H(d,b){J a=d.1R(".");a[1]=a[1]?"."+a[1]:"";G(b===12){J c=7.5C("9z"+a[1]+"!",[a[0]]);G(c===12&&7.K)c=D.L(7[0],d);I c===12&&a[1]?7.L(a[0]):c}N I 7.1P("9u"+a[1]+"!",[a[0],b]).P(H(){D.L(7,d,b)})},3b:H(a){I 7.P(H(){D.3b(7,a)})},3W:H(g,f,h,d){J e=7.K>1,3x;I 7.P(H(){G(!3x){3x=D.4h(g,7.2z);G(h)3x.9o()}J b=7;G(f&&D.Y(7,"1T")&&D.Y(3x[0],"4F"))b=7.3H("22")[0]||7.3U(7.2z.3h("22"));J c=D([]);D.P(3x,H(){J a=e?D(7).5y(M)[0]:7;G(D.Y(a,"1m"))c=c.1e(a);N{G(a.16==1)c=c.1e(D("1m",a).21());d.1k(b,a)}});c.P(6T)})}};D.17.5j.44=D.17;H 6T(i,a){G(a.4d)D.3Y({1a:a.4d,31:Q,1O:"1m"});N D.5u(a.1r||a.6O||a.4H||"");G(a.1d)a.1d.37(a)}H 1z(){I+2B 8J}D.1l=D.17.1l=H(){J b=19[0]||{},i=1,K=19.K,4x=Q,15;G(b.1q==8I){4x=b;b=19[1]||{};i=2}G(1j b!="49"&&1j b!="H")b={};G(K==i){b=7;--i}R(;i<K;i++)G((15=19[i])!=U)R(J c 1n 15){J a=b[c],2w=15[c];G(b===2w)6M;G(4x&&2w&&1j 2w=="49"&&!2w.16)b[c]=D.1l(4x,a||(2w.K!=U?[]:{}),2w);N G(2w!==12)b[c]=2w}I b};J E="4M"+1z(),6K=0,5r={},6G=/z-?5i|8B-?8A|1y|6B|8v-?1Z/i,3P=S.3P||{};D.1l({8u:H(a){1b.$=3m$;G(a)1b.4M=w;I D},1D:H(a){I!!a&&1j a!="23"&&!a.Y&&a.1q!=2p&&/^[\\s[]?H/.11(a+"")},4n:H(a){I a.1C&&!a.1c||a.2j&&a.2z&&!a.2z.1c},5u:H(a){a=D.3k(a);G(a){J b=S.3H("6w")[0]||S.1C,1m=S.3h("1m");1m.O="1r/4t";G(D.14.1f)1m.1r=a;N 1m.3U(S.5F(a));b.39(1m,b.1x);b.37(1m)}},Y:H(b,a){I b.Y&&b.Y.2r()==a.2r()},1Y:{},L:H(c,d,b){c=c==1b?5r:c;J a=c[E];G(!a)a=c[E]=++6K;G(d&&!D.1Y[a])D.1Y[a]={};G(b!==12)D.1Y[a][d]=b;I d?D.1Y[a][d]:a},3b:H(c,b){c=c==1b?5r:c;J a=c[E];G(b){G(D.1Y[a]){2U D.1Y[a][b];b="";R(b 1n D.1Y[a])1X;G(!b)D.3b(c)}}N{1U{2U c[E]}1V(e){G(c.5l)c.5l(E)}2U D.1Y[a]}},P:H(d,a,c){J e,i=0,K=d.K;G(c){G(K==12){R(e 1n d)G(a.1w(d[e],c)===Q)1X}N R(;i<K;)G(a.1w(d[i++],c)===Q)1X}N{G(K==12){R(e 1n d)G(a.1k(d[e],e,d[e])===Q)1X}N R(J b=d[0];i<K&&a.1k(b,i,b)!==Q;b=d[++i]){}}I d},1i:H(b,a,c,i,d){G(D.1D(a))a=a.1k(b,i);I a&&a.1q==4L&&c=="2a"&&!6G.11(d)?a+"2X":a},1F:{1e:H(c,b){D.P((b||"").1R(/\\s+/),H(i,a){G(c.16==1&&!D.1F.3T(c.1F,a))c.1F+=(c.1F?" ":"")+a})},21:H(c,b){G(c.16==1)c.1F=b!=12?D.3C(c.1F.1R(/\\s+/),H(a){I!D.1F.3T(b,a)}).6s(" "):""},3T:H(b,a){I D.2L(a,(b.1F||b).6r().1R(/\\s+/))>-1}},6q:H(b,c,a){J e={};R(J d 1n c){e[d]=b.V[d];b.V[d]=c[d]}a.1k(b);R(J d 1n c)b.V[d]=e[d]},1g:H(d,e,c){G(e=="2h"||e=="1Z"){J b,3X={30:"5x",5g:"1G",18:"3I"},35=e=="2h"?["5e","6k"]:["5G","6i"];H 5b(){b=e=="2h"?d.8f:d.8c;J a=0,2C=0;D.P(35,H(){a+=3d(D.2a(d,"57"+7,M))||0;2C+=3d(D.2a(d,"2C"+7+"4b",M))||0});b-=29.83(a+2C)}G(D(d).3F(":4j"))5b();N D.6q(d,3X,5b);I 29.2f(0,b)}I D.2a(d,e,c)},2a:H(f,l,k){J e,V=f.V;H 3E(b){G(!D.14.2k)I Q;J a=3P.54(b,U);I!a||a.52("3E")==""}G(l=="1y"&&D.14.1f){e=D.1K(V,"1y");I e==""?"1":e}G(D.14.2G&&l=="18"){J d=V.50;V.50="0 7Y 7W";V.50=d}G(l.1I(/4i/i))l=y;G(!k&&V&&V[l])e=V[l];N G(3P.54){G(l.1I(/4i/i))l="4i";l=l.1o(/([A-Z])/g,"-$1").3y();J c=3P.54(f,U);G(c&&!3E(f))e=c.52(l);N{J g=[],2E=[],a=f,i=0;R(;a&&3E(a);a=a.1d)2E.6h(a);R(;i<2E.K;i++)G(3E(2E[i])){g[i]=2E[i].V.18;2E[i].V.18="3I"}e=l=="18"&&g[2E.K-1]!=U?"2F":(c&&c.52(l))||"";R(i=0;i<g.K;i++)G(g[i]!=U)2E[i].V.18=g[i]}G(l=="1y"&&e=="")e="1"}N G(f.4g){J h=l.1o(/\\-(\\w)/g,H(a,b){I b.2r()});e=f.4g[l]||f.4g[h];G(!/^\\d+(2X)?$/i.11(e)&&/^\\d/.11(e)){J j=V.1A,66=f.65.1A;f.65.1A=f.4g.1A;V.1A=e||0;e=V.aM+"2X";V.1A=j;f.65.1A=66}}I e},4h:H(l,h){J k=[];h=h||S;G(1j h.3h==\'12\')h=h.2z||h[0]&&h[0].2z||S;D.P(l,H(i,d){G(!d)I;G(d.1q==4L)d+=\'\';G(1j d=="23"){d=d.1o(/(<(\\w+)[^>]*?)\\/>/g,H(b,a,c){I c.1I(/^(aK|4f|7E|aG|4T|7A|aB|3n|az|ay|av)$/i)?b:a+"></"+c+">"});J f=D.3k(d).3y(),1v=h.3h("1v");J e=!f.1h("<au")&&[1,"<2A 7w=\'7w\'>","</2A>"]||!f.1h("<ar")&&[1,"<7v>","</7v>"]||f.1I(/^<(aq|22|am|ak|ai)/)&&[1,"<1T>","</1T>"]||!f.1h("<4F")&&[2,"<1T><22>","</22></1T>"]||(!f.1h("<af")||!f.1h("<ad"))&&[3,"<1T><22><4F>","</4F></22></1T>"]||!f.1h("<7E")&&[2,"<1T><22></22><7q>","</7q></1T>"]||D.14.1f&&[1,"1v<1v>","</1v>"]||[0,"",""];1v.4H=e[1]+d+e[2];1B(e[0]--)1v=1v.5T;G(D.14.1f){J g=!f.1h("<1T")&&f.1h("<22")<0?1v.1x&&1v.1x.3t:e[1]=="<1T>"&&f.1h("<22")<0?1v.3t:[];R(J j=g.K-1;j>=0;--j)G(D.Y(g[j],"22")&&!g[j].3t.K)g[j].1d.37(g[j]);G(/^\\s/.11(d))1v.39(h.5F(d.1I(/^\\s*/)[0]),1v.1x)}d=D.2d(1v.3t)}G(d.K===0&&(!D.Y(d,"3V")&&!D.Y(d,"2A")))I;G(d[0]==12||D.Y(d,"3V")||d.15)k.1p(d);N k=D.2R(k,d)});I k},1K:H(d,f,c){G(!d||d.16==3||d.16==8)I 12;J e=!D.4n(d),40=c!==12,1f=D.14.1f;f=e&&D.3X[f]||f;G(d.2j){J g=/5Q|4d|V/.11(f);G(f=="2W"&&D.14.2k)d.1d.64;G(f 1n d&&e&&!g){G(40){G(f=="O"&&D.Y(d,"4T")&&d.1d)7p"O a3 a1\'t 9V 9U";d[f]=c}G(D.Y(d,"3V")&&d.7i(f))I d.7i(f).76;I d[f]}G(1f&&e&&f=="V")I D.1K(d.V,"9T",c);G(40)d.9Q(f,""+c);J h=1f&&e&&g?d.4G(f,2):d.4G(f);I h===U?12:h}G(1f&&f=="1y"){G(40){d.6B=1;d.1E=(d.1E||"").1o(/7f\\([^)]*\\)/,"")+(3r(c)+\'\'=="9L"?"":"7f(1y="+c*7a+")")}I d.1E&&d.1E.1h("1y=")>=0?(3d(d.1E.1I(/1y=([^)]*)/)[1])/7a)+\'\':""}f=f.1o(/-([a-z])/9H,H(a,b){I b.2r()});G(40)d[f]=c;I d[f]},3k:H(a){I(a||"").1o(/^\\s+|\\s+$/g,"")},2d:H(b){J a=[];G(b!=U){J i=b.K;G(i==U||b.1R||b.4I||b.1k)a[0]=b;N 1B(i)a[--i]=b[i]}I a},2L:H(b,a){R(J i=0,K=a.K;i<K;i++)G(a[i]===b)I i;I-1},2R:H(a,b){J i=0,T,2S=a.K;G(D.14.1f){1B(T=b[i++])G(T.16!=8)a[2S++]=T}N 1B(T=b[i++])a[2S++]=T;I a},4r:H(a){J c=[],2o={};1U{R(J i=0,K=a.K;i<K;i++){J b=D.L(a[i]);G(!2o[b]){2o[b]=M;c.1p(a[i])}}}1V(e){c=a}I c},3C:H(c,a,d){J b=[];R(J i=0,K=c.K;i<K;i++)G(!d!=!a(c[i],i))b.1p(c[i]);I b},2l:H(d,a){J c=[];R(J i=0,K=d.K;i<K;i++){J b=a(d[i],i);G(b!=U)c[c.K]=b}I c.7d.1w([],c)}});J v=9B.9A.3y();D.14={5B:(v.1I(/.+(?:9y|9x|9w|9v)[\\/: ]([\\d.]+)/)||[])[1],2k:/75/.11(v),2G:/2G/.11(v),1f:/1f/.11(v)&&!/2G/.11(v),42:/42/.11(v)&&!/(9s|75)/.11(v)};J y=D.14.1f?"7o":"72";D.1l({71:!D.14.1f||S.70=="6Z",3X:{"R":"9n","9k":"1F","4i":y,72:y,7o:y,9h:"9f",9e:"9d",9b:"99"}});D.P({6W:H(a){I a.1d},97:H(a){I D.4S(a,"1d")},95:H(a){I D.3a(a,2,"2H")},91:H(a){I D.3a(a,2,"4l")},8Z:H(a){I D.4S(a,"2H")},8X:H(a){I D.4S(a,"4l")},8W:H(a){I D.5v(a.1d.1x,a)},8V:H(a){I D.5v(a.1x)},6Q:H(a){I D.Y(a,"8U")?a.8T||a.8S.S:D.2d(a.3t)}},H(c,d){D.17[c]=H(b){J a=D.2l(7,d);G(b&&1j b=="23")a=D.3g(b,a);I 7.2I(D.4r(a))}});D.P({6P:"3v",8Q:"6F",39:"6E",8P:"5q",8O:"7b"},H(c,b){D.17[c]=H(){J a=19;I 7.P(H(){R(J i=0,K=a.K;i<K;i++)D(a[i])[b](7)})}});D.P({8N:H(a){D.1K(7,a,"");G(7.16==1)7.5l(a)},8M:H(a){D.1F.1e(7,a)},8L:H(a){D.1F.21(7,a)},8K:H(a){D.1F[D.1F.3T(7,a)?"21":"1e"](7,a)},21:H(a){G(!a||D.1E(a,[7]).r.K){D("*",7).1e(7).P(H(){D.W.21(7);D.3b(7)});G(7.1d)7.1d.37(7)}},4E:H(){D(">*",7).21();1B(7.1x)7.37(7.1x)}},H(a,b){D.17[a]=H(){I 7.P(b,19)}});D.P(["6N","4b"],H(i,c){J b=c.3y();D.17[b]=H(a){I 7[0]==1b?D.14.2G&&S.1c["5t"+c]||D.14.2k&&1b["5s"+c]||S.70=="6Z"&&S.1C["5t"+c]||S.1c["5t"+c]:7[0]==S?29.2f(29.2f(S.1c["4y"+c],S.1C["4y"+c]),29.2f(S.1c["2i"+c],S.1C["2i"+c])):a==12?(7.K?D.1g(7[0],b):U):7.1g(b,a.1q==56?a:a+"2X")}});H 25(a,b){I a[0]&&3r(D.2a(a[0],b,M),10)||0}J C=D.14.2k&&3r(D.14.5B)<8H?"(?:[\\\\w*3m-]|\\\\\\\\.)":"(?:[\\\\w\\8F-\\8E*3m-]|\\\\\\\\.)",6L=2B 4v("^>\\\\s*("+C+"+)"),6J=2B 4v("^("+C+"+)(#)("+C+"+)"),6I=2B 4v("^([#.]?)("+C+"*)");D.1l({6H:{"":H(a,i,m){I m[2]=="*"||D.Y(a,m[2])},"#":H(a,i,m){I a.4G("2v")==m[2]},":":{8D:H(a,i,m){I i<m[3]-0},8C:H(a,i,m){I i>m[3]-0},3a:H(a,i,m){I m[3]-0==i},79:H(a,i,m){I m[3]-0==i},3o:H(a,i){I i==0},3S:H(a,i,m,r){I i==r.K-1},6D:H(a,i){I i%2==0},6C:H(a,i){I i%2},"3o-4u":H(a){I a.1d.3H("*")[0]==a},"3S-4u":H(a){I D.3a(a.1d.5T,1,"4l")==a},"8z-4u":H(a){I!D.3a(a.1d.5T,2,"4l")},6W:H(a){I a.1x},4E:H(a){I!a.1x},8y:H(a,i,m){I(a.6O||a.8x||D(a).1r()||"").1h(m[3])>=0},4j:H(a){I"1G"!=a.O&&D.1g(a,"18")!="2F"&&D.1g(a,"5g")!="1G"},1G:H(a){I"1G"==a.O||D.1g(a,"18")=="2F"||D.1g(a,"5g")=="1G"},8w:H(a){I!a.3R},3R:H(a){I a.3R},4J:H(a){I a.4J},2W:H(a){I a.2W||D.1K(a,"2W")},1r:H(a){I"1r"==a.O},5O:H(a){I"5O"==a.O},5L:H(a){I"5L"==a.O},5p:H(a){I"5p"==a.O},3Q:H(a){I"3Q"==a.O},5o:H(a){I"5o"==a.O},6A:H(a){I"6A"==a.O},6z:H(a){I"6z"==a.O},2s:H(a){I"2s"==a.O||D.Y(a,"2s")},4T:H(a){I/4T|2A|6y|2s/i.11(a.Y)},3T:H(a,i,m){I D.2q(m[3],a).K},8t:H(a){I/h\\d/i.11(a.Y)},8s:H(a){I D.3C(D.3O,H(b){I a==b.T}).K}}},6x:[/^(\\[) *@?([\\w-]+) *([!*$^~=]*) *(\'?"?)(.*?)\\4 *\\]/,/^(:)([\\w-]+)\\("?\'?(.*?(\\(.*?\\))?[^(]*?)"?\'?\\)/,2B 4v("^([:.#]*)("+C+"+)")],3g:H(a,c,b){J d,1t=[];1B(a&&a!=d){d=a;J f=D.1E(a,c,b);a=f.t.1o(/^\\s*,\\s*/,"");1t=b?c=f.r:D.2R(1t,f.r)}I 1t},2q:H(t,o){G(1j t!="23")I[t];G(o&&o.16!=1&&o.16!=9)I[];o=o||S;J d=[o],2o=[],3S,Y;1B(t&&3S!=t){J r=[];3S=t;t=D.3k(t);J l=Q,3j=6L,m=3j.2D(t);G(m){Y=m[1].2r();R(J i=0;d[i];i++)R(J c=d[i].1x;c;c=c.2H)G(c.16==1&&(Y=="*"||c.Y.2r()==Y))r.1p(c);d=r;t=t.1o(3j,"");G(t.1h(" ")==0)6M;l=M}N{3j=/^([>+~])\\s*(\\w*)/i;G((m=3j.2D(t))!=U){r=[];J k={};Y=m[2].2r();m=m[1];R(J j=0,3i=d.K;j<3i;j++){J n=m=="~"||m=="+"?d[j].2H:d[j].1x;R(;n;n=n.2H)G(n.16==1){J g=D.L(n);G(m=="~"&&k[g])1X;G(!Y||n.Y.2r()==Y){G(m=="~")k[g]=M;r.1p(n)}G(m=="+")1X}}d=r;t=D.3k(t.1o(3j,""));l=M}}G(t&&!l){G(!t.1h(",")){G(o==d[0])d.4s();2o=D.2R(2o,d);r=d=[o];t=" "+t.6v(1,t.K)}N{J h=6J;J m=h.2D(t);G(m){m=[0,m[2],m[3],m[1]]}N{h=6I;m=h.2D(t)}m[2]=m[2].1o(/\\\\/g,"");J f=d[d.K-1];G(m[1]=="#"&&f&&f.61&&!D.4n(f)){J p=f.61(m[2]);G((D.14.1f||D.14.2G)&&p&&1j p.2v=="23"&&p.2v!=m[2])p=D(\'[@2v="\'+m[2]+\'"]\',f)[0];d=r=p&&(!m[3]||D.Y(p,m[3]))?[p]:[]}N{R(J i=0;d[i];i++){J a=m[1]=="#"&&m[3]?m[3]:m[1]!=""||m[0]==""?"*":m[2];G(a=="*"&&d[i].Y.3y()=="49")a="3n";r=D.2R(r,d[i].3H(a))}G(m[1]==".")r=D.5m(r,m[2]);G(m[1]=="#"){J e=[];R(J i=0;r[i];i++)G(r[i].4G("2v")==m[2]){e=[r[i]];1X}r=e}d=r}t=t.1o(h,"")}}G(t){J b=D.1E(t,r);d=r=b.r;t=D.3k(b.t)}}G(t)d=[];G(d&&o==d[0])d.4s();2o=D.2R(2o,d);I 2o},5m:H(r,m,a){m=" "+m+" ";J c=[];R(J i=0;r[i];i++){J b=(" "+r[i].1F+" ").1h(m)>=0;G(!a&&b||a&&!b)c.1p(r[i])}I c},1E:H(t,r,h){J d;1B(t&&t!=d){d=t;J p=D.6x,m;R(J i=0;p[i];i++){m=p[i].2D(t);G(m){t=t.8r(m[0].K);m[2]=m[2].1o(/\\\\/g,"");1X}}G(!m)1X;G(m[1]==":"&&m[2]=="4Y")r=62.11(m[3])?D.1E(m[3],r,M).r:D(r).4Y(m[3]);N G(m[1]==".")r=D.5m(r,m[2],h);N G(m[1]=="["){J g=[],O=m[3];R(J i=0,3i=r.K;i<3i;i++){J a=r[i],z=a[D.3X[m[2]]||m[2]];G(z==U||/5Q|4d|2W/.11(m[2]))z=D.1K(a,m[2])||\'\';G((O==""&&!!z||O=="="&&z==m[5]||O=="!="&&z!=m[5]||O=="^="&&z&&!z.1h(m[5])||O=="$="&&z.6v(z.K-m[5].K)==m[5]||(O=="*="||O=="~=")&&z.1h(m[5])>=0)^h)g.1p(a)}r=g}N G(m[1]==":"&&m[2]=="3a-4u"){J e={},g=[],11=/(-?)(\\d*)n((?:\\+|-)?\\d*)/.2D(m[3]=="6D"&&"2n"||m[3]=="6C"&&"2n+1"||!/\\D/.11(m[3])&&"8q+"+m[3]||m[3]),3o=(11[1]+(11[2]||1))-0,d=11[3]-0;R(J i=0,3i=r.K;i<3i;i++){J j=r[i],1d=j.1d,2v=D.L(1d);G(!e[2v]){J c=1;R(J n=1d.1x;n;n=n.2H)G(n.16==1)n.4q=c++;e[2v]=M}J b=Q;G(3o==0){G(j.4q==d)b=M}N G((j.4q-d)%3o==0&&(j.4q-d)/3o>=0)b=M;G(b^h)g.1p(j)}r=g}N{J f=D.6H[m[1]];G(1j f=="49")f=f[m[2]];G(1j f=="23")f=6u("Q||H(a,i){I "+f+";}");r=D.3C(r,H(a,i){I f(a,i,m,r)},h)}}I{r:r,t:t}},4S:H(b,c){J a=[],1t=b[c];1B(1t&&1t!=S){G(1t.16==1)a.1p(1t);1t=1t[c]}I a},3a:H(a,e,c,b){e=e||1;J d=0;R(;a;a=a[c])G(a.16==1&&++d==e)1X;I a},5v:H(n,a){J r=[];R(;n;n=n.2H){G(n.16==1&&n!=a)r.1p(n)}I r}});D.W={1e:H(f,i,g,e){G(f.16==3||f.16==8)I;G(D.14.1f&&f.4I)f=1b;G(!g.24)g.24=7.24++;G(e!=12){J h=g;g=7.3M(h,H(){I h.1w(7,19)});g.L=e}J j=D.L(f,"3w")||D.L(f,"3w",{}),1H=D.L(f,"1H")||D.L(f,"1H",H(){G(1j D!="12"&&!D.W.5k)I D.W.1H.1w(19.3L.T,19)});1H.T=f;D.P(i.1R(/\\s+/),H(c,b){J a=b.1R(".");b=a[0];g.O=a[1];J d=j[b];G(!d){d=j[b]={};G(!D.W.2t[b]||D.W.2t[b].4p.1k(f)===Q){G(f.3K)f.3K(b,1H,Q);N G(f.6t)f.6t("4o"+b,1H)}}d[g.24]=g;D.W.26[b]=M});f=U},24:1,26:{},21:H(e,h,f){G(e.16==3||e.16==8)I;J i=D.L(e,"3w"),1L,5i;G(i){G(h==12||(1j h=="23"&&h.8p(0)=="."))R(J g 1n i)7.21(e,g+(h||""));N{G(h.O){f=h.2y;h=h.O}D.P(h.1R(/\\s+/),H(b,a){J c=a.1R(".");a=c[0];G(i[a]){G(f)2U i[a][f.24];N R(f 1n i[a])G(!c[1]||i[a][f].O==c[1])2U i[a][f];R(1L 1n i[a])1X;G(!1L){G(!D.W.2t[a]||D.W.2t[a].4A.1k(e)===Q){G(e.6p)e.6p(a,D.L(e,"1H"),Q);N G(e.6n)e.6n("4o"+a,D.L(e,"1H"))}1L=U;2U i[a]}}})}R(1L 1n i)1X;G(!1L){J d=D.L(e,"1H");G(d)d.T=U;D.3b(e,"3w");D.3b(e,"1H")}}},1P:H(h,c,f,g,i){c=D.2d(c);G(h.1h("!")>=0){h=h.3s(0,-1);J a=M}G(!f){G(7.26[h])D("*").1e([1b,S]).1P(h,c)}N{G(f.16==3||f.16==8)I 12;J b,1L,17=D.1D(f[h]||U),W=!c[0]||!c[0].32;G(W){c.6h({O:h,2J:f,32:H(){},3J:H(){},4C:1z()});c[0][E]=M}c[0].O=h;G(a)c[0].6m=M;J d=D.L(f,"1H");G(d)b=d.1w(f,c);G((!17||(D.Y(f,\'a\')&&h=="4V"))&&f["4o"+h]&&f["4o"+h].1w(f,c)===Q)b=Q;G(W)c.4s();G(i&&D.1D(i)){1L=i.1w(f,b==U?c:c.7d(b));G(1L!==12)b=1L}G(17&&g!==Q&&b!==Q&&!(D.Y(f,\'a\')&&h=="4V")){7.5k=M;1U{f[h]()}1V(e){}}7.5k=Q}I b},1H:H(b){J a,1L,38,5f,4m;b=19[0]=D.W.6l(b||1b.W);38=b.O.1R(".");b.O=38[0];38=38[1];5f=!38&&!b.6m;4m=(D.L(7,"3w")||{})[b.O];R(J j 1n 4m){J c=4m[j];G(5f||c.O==38){b.2y=c;b.L=c.L;1L=c.1w(7,19);G(a!==Q)a=1L;G(1L===Q){b.32();b.3J()}}}I a},6l:H(b){G(b[E]==M)I b;J d=b;b={8o:d};J c="8n 8m 8l 8k 2s 8j 47 5d 6j 5E 8i L 8h 8g 4K 2y 5a 59 8e 8b 58 6f 8a 88 4k 87 86 84 6d 2J 4C 6c O 82 81 35".1R(" ");R(J i=c.K;i;i--)b[c[i]]=d[c[i]];b[E]=M;b.32=H(){G(d.32)d.32();d.80=Q};b.3J=H(){G(d.3J)d.3J();d.7Z=M};b.4C=b.4C||1z();G(!b.2J)b.2J=b.6d||S;G(b.2J.16==3)b.2J=b.2J.1d;G(!b.4k&&b.4K)b.4k=b.4K==b.2J?b.6c:b.4K;G(b.58==U&&b.5d!=U){J a=S.1C,1c=S.1c;b.58=b.5d+(a&&a.2e||1c&&1c.2e||0)-(a.6b||0);b.6f=b.6j+(a&&a.2c||1c&&1c.2c||0)-(a.6a||0)}G(!b.35&&((b.47||b.47===0)?b.47:b.5a))b.35=b.47||b.5a;G(!b.59&&b.5E)b.59=b.5E;G(!b.35&&b.2s)b.35=(b.2s&1?1:(b.2s&2?3:(b.2s&4?2:0)));I b},3M:H(a,b){b.24=a.24=a.24||b.24||7.24++;I b},2t:{27:{4p:H(){55();I},4A:H(){I}},3D:{4p:H(){G(D.14.1f)I Q;D(7).2O("53",D.W.2t.3D.2y);I M},4A:H(){G(D.14.1f)I Q;D(7).4e("53",D.W.2t.3D.2y);I M},2y:H(a){G(F(a,7))I M;a.O="3D";I D.W.1H.1w(7,19)}},3N:{4p:H(){G(D.14.1f)I Q;D(7).2O("51",D.W.2t.3N.2y);I M},4A:H(){G(D.14.1f)I Q;D(7).4e("51",D.W.2t.3N.2y);I M},2y:H(a){G(F(a,7))I M;a.O="3N";I D.W.1H.1w(7,19)}}}};D.17.1l({2O:H(c,a,b){I c=="4X"?7.2V(c,a,b):7.P(H(){D.W.1e(7,c,b||a,b&&a)})},2V:H(d,b,c){J e=D.W.3M(c||b,H(a){D(7).4e(a,e);I(c||b).1w(7,19)});I 7.P(H(){D.W.1e(7,d,e,c&&b)})},4e:H(a,b){I 7.P(H(){D.W.21(7,a,b)})},1P:H(c,a,b){I 7.P(H(){D.W.1P(c,a,7,M,b)})},5C:H(c,a,b){I 7[0]&&D.W.1P(c,a,7[0],Q,b)},2m:H(b){J c=19,i=1;1B(i<c.K)D.W.3M(b,c[i++]);I 7.4V(D.W.3M(b,H(a){7.4Z=(7.4Z||0)%i;a.32();I c[7.4Z++].1w(7,19)||Q}))},7X:H(a,b){I 7.2O(\'3D\',a).2O(\'3N\',b)},27:H(a){55();G(D.2Q)a.1k(S,D);N D.3A.1p(H(){I a.1k(7,D)});I 7}});D.1l({2Q:Q,3A:[],27:H(){G(!D.2Q){D.2Q=M;G(D.3A){D.P(D.3A,H(){7.1k(S)});D.3A=U}D(S).5C("27")}}});J x=Q;H 55(){G(x)I;x=M;G(S.3K&&!D.14.2G)S.3K("69",D.27,Q);G(D.14.1f&&1b==1S)(H(){G(D.2Q)I;1U{S.1C.7V("1A")}1V(3e){3B(19.3L,0);I}D.27()})();G(D.14.2G)S.3K("69",H(){G(D.2Q)I;R(J i=0;i<S.4W.K;i++)G(S.4W[i].3R){3B(19.3L,0);I}D.27()},Q);G(D.14.2k){J a;(H(){G(D.2Q)I;G(S.3f!="68"&&S.3f!="1J"){3B(19.3L,0);I}G(a===12)a=D("V, 7A[7U=7S]").K;G(S.4W.K!=a){3B(19.3L,0);I}D.27()})()}D.W.1e(1b,"43",D.27)}D.P(("7R,7Q,43,85,4y,4X,4V,7P,"+"7O,7N,89,53,51,7M,2A,"+"5o,7L,7K,8d,3e").1R(","),H(i,b){D.17[b]=H(a){I a?7.2O(b,a):7.1P(b)}});J F=H(a,c){J b=a.4k;1B(b&&b!=c)1U{b=b.1d}1V(3e){b=c}I b==c};D(1b).2O("4X",H(){D("*").1e(S).4e()});D.17.1l({67:D.17.43,43:H(g,d,c){G(1j g!=\'23\')I 7.67(g);J e=g.1h(" ");G(e>=0){J i=g.3s(e,g.K);g=g.3s(0,e)}c=c||H(){};J f="2P";G(d)G(D.1D(d)){c=d;d=U}N{d=D.3n(d);f="6g"}J h=7;D.3Y({1a:g,O:f,1O:"2K",L:d,1J:H(a,b){G(b=="1W"||b=="7J")h.2K(i?D("<1v/>").3v(a.4U.1o(/<1m(.|\\s)*?\\/1m>/g,"")).2q(i):a.4U);h.P(c,[a.4U,b,a])}});I 7},aL:H(){I D.3n(7.7I())},7I:H(){I 7.2l(H(){I D.Y(7,"3V")?D.2d(7.aH):7}).1E(H(){I 7.34&&!7.3R&&(7.4J||/2A|6y/i.11(7.Y)||/1r|1G|3Q/i.11(7.O))}).2l(H(i,c){J b=D(7).6e();I b==U?U:b.1q==2p?D.2l(b,H(a,i){I{34:c.34,2x:a}}):{34:c.34,2x:b}}).3p()}});D.P("7H,7G,7F,7D,7C,7B".1R(","),H(i,o){D.17[o]=H(f){I 7.2O(o,f)}});J B=1z();D.1l({3p:H(d,b,a,c){G(D.1D(b)){a=b;b=U}I D.3Y({O:"2P",1a:d,L:b,1W:a,1O:c})},aE:H(b,a){I D.3p(b,U,a,"1m")},aD:H(c,b,a){I D.3p(c,b,a,"3z")},aC:H(d,b,a,c){G(D.1D(b)){a=b;b={}}I D.3Y({O:"6g",1a:d,L:b,1W:a,1O:c})},aA:H(a){D.1l(D.60,a)},60:{1a:5Z.5Q,26:M,O:"2P",2T:0,7z:"4R/x-ax-3V-aw",7x:M,31:M,L:U,5Y:U,3Q:U,4Q:{2N:"4R/2N, 1r/2N",2K:"1r/2K",1m:"1r/4t, 4R/4t",3z:"4R/3z, 1r/4t",1r:"1r/as",4w:"*/*"}},4z:{},3Y:H(s){s=D.1l(M,s,D.1l(M,{},D.60,s));J g,2Z=/=\\?(&|$)/g,1u,L,O=s.O.2r();G(s.L&&s.7x&&1j s.L!="23")s.L=D.3n(s.L);G(s.1O=="4P"){G(O=="2P"){G(!s.1a.1I(2Z))s.1a+=(s.1a.1I(/\\?/)?"&":"?")+(s.4P||"7u")+"=?"}N G(!s.L||!s.L.1I(2Z))s.L=(s.L?s.L+"&":"")+(s.4P||"7u")+"=?";s.1O="3z"}G(s.1O=="3z"&&(s.L&&s.L.1I(2Z)||s.1a.1I(2Z))){g="4P"+B++;G(s.L)s.L=(s.L+"").1o(2Z,"="+g+"$1");s.1a=s.1a.1o(2Z,"="+g+"$1");s.1O="1m";1b[g]=H(a){L=a;1W();1J();1b[g]=12;1U{2U 1b[g]}1V(e){}G(i)i.37(h)}}G(s.1O=="1m"&&s.1Y==U)s.1Y=Q;G(s.1Y===Q&&O=="2P"){J j=1z();J k=s.1a.1o(/(\\?|&)3m=.*?(&|$)/,"$ap="+j+"$2");s.1a=k+((k==s.1a)?(s.1a.1I(/\\?/)?"&":"?")+"3m="+j:"")}G(s.L&&O=="2P"){s.1a+=(s.1a.1I(/\\?/)?"&":"?")+s.L;s.L=U}G(s.26&&!D.4O++)D.W.1P("7H");J n=/^(?:\\w+:)?\\/\\/([^\\/?#]+)/;G(s.1O=="1m"&&O=="2P"&&n.11(s.1a)&&n.2D(s.1a)[1]!=5Z.al){J i=S.3H("6w")[0];J h=S.3h("1m");h.4d=s.1a;G(s.7t)h.aj=s.7t;G(!g){J l=Q;h.ah=h.ag=H(){G(!l&&(!7.3f||7.3f=="68"||7.3f=="1J")){l=M;1W();1J();i.37(h)}}}i.3U(h);I 12}J m=Q;J c=1b.7s?2B 7s("ae.ac"):2B 7r();G(s.5Y)c.6R(O,s.1a,s.31,s.5Y,s.3Q);N c.6R(O,s.1a,s.31);1U{G(s.L)c.4B("ab-aa",s.7z);G(s.5S)c.4B("a9-5R-a8",D.4z[s.1a]||"a7, a6 a5 a4 5N:5N:5N a2");c.4B("X-9Z-9Y","7r");c.4B("9W",s.1O&&s.4Q[s.1O]?s.4Q[s.1O]+", */*":s.4Q.4w)}1V(e){}G(s.7m&&s.7m(c,s)===Q){s.26&&D.4O--;c.7l();I Q}G(s.26)D.W.1P("7B",[c,s]);J d=H(a){G(!m&&c&&(c.3f==4||a=="2T")){m=M;G(f){7k(f);f=U}1u=a=="2T"&&"2T"||!D.7j(c)&&"3e"||s.5S&&D.7h(c,s.1a)&&"7J"||"1W";G(1u=="1W"){1U{L=D.6X(c,s.1O,s.9S)}1V(e){1u="5J"}}G(1u=="1W"){J b;1U{b=c.5I("7g-5R")}1V(e){}G(s.5S&&b)D.4z[s.1a]=b;G(!g)1W()}N D.5H(s,c,1u);1J();G(s.31)c=U}};G(s.31){J f=4I(d,13);G(s.2T>0)3B(H(){G(c){c.7l();G(!m)d("2T")}},s.2T)}1U{c.9P(s.L)}1V(e){D.5H(s,c,U,e)}G(!s.31)d();H 1W(){G(s.1W)s.1W(L,1u);G(s.26)D.W.1P("7C",[c,s])}H 1J(){G(s.1J)s.1J(c,1u);G(s.26)D.W.1P("7F",[c,s]);G(s.26&&!--D.4O)D.W.1P("7G")}I c},5H:H(s,a,b,e){G(s.3e)s.3e(a,b,e);G(s.26)D.W.1P("7D",[a,s,e])},4O:0,7j:H(a){1U{I!a.1u&&5Z.9O=="5p:"||(a.1u>=7e&&a.1u<9N)||a.1u==7c||a.1u==9K||D.14.2k&&a.1u==12}1V(e){}I Q},7h:H(a,c){1U{J b=a.5I("7g-5R");I a.1u==7c||b==D.4z[c]||D.14.2k&&a.1u==12}1V(e){}I Q},6X:H(a,c,b){J d=a.5I("9J-O"),2N=c=="2N"||!c&&d&&d.1h("2N")>=0,L=2N?a.9I:a.4U;G(2N&&L.1C.2j=="5J")7p"5J";G(b)L=b(L,c);G(c=="1m")D.5u(L);G(c=="3z")L=6u("("+L+")");I L},3n:H(a){J s=[];G(a.1q==2p||a.5w)D.P(a,H(){s.1p(3u(7.34)+"="+3u(7.2x))});N R(J j 1n a)G(a[j]&&a[j].1q==2p)D.P(a[j],H(){s.1p(3u(j)+"="+3u(7))});N s.1p(3u(j)+"="+3u(D.1D(a[j])?a[j]():a[j]));I s.6s("&").1o(/%20/g,"+")}});D.17.1l({1N:H(c,b){I c?7.2g({1Z:"1N",2h:"1N",1y:"1N"},c,b):7.1E(":1G").P(H(){7.V.18=7.5D||"";G(D.1g(7,"18")=="2F"){J a=D("<"+7.2j+" />").6P("1c");7.V.18=a.1g("18");G(7.V.18=="2F")7.V.18="3I";a.21()}}).3l()},1M:H(b,a){I b?7.2g({1Z:"1M",2h:"1M",1y:"1M"},b,a):7.1E(":4j").P(H(){7.5D=7.5D||D.1g(7,"18");7.V.18="2F"}).3l()},78:D.17.2m,2m:H(a,b){I D.1D(a)&&D.1D(b)?7.78.1w(7,19):a?7.2g({1Z:"2m",2h:"2m",1y:"2m"},a,b):7.P(H(){D(7)[D(7).3F(":1G")?"1N":"1M"]()})},9G:H(b,a){I 7.2g({1Z:"1N"},b,a)},9F:H(b,a){I 7.2g({1Z:"1M"},b,a)},9E:H(b,a){I 7.2g({1Z:"2m"},b,a)},9D:H(b,a){I 7.2g({1y:"1N"},b,a)},9M:H(b,a){I 7.2g({1y:"1M"},b,a)},9C:H(c,a,b){I 7.2g({1y:a},c,b)},2g:H(k,j,i,g){J h=D.77(j,i,g);I 7[h.36===Q?"P":"36"](H(){G(7.16!=1)I Q;J f=D.1l({},h),p,1G=D(7).3F(":1G"),46=7;R(p 1n k){G(k[p]=="1M"&&1G||k[p]=="1N"&&!1G)I f.1J.1k(7);G(p=="1Z"||p=="2h"){f.18=D.1g(7,"18");f.33=7.V.33}}G(f.33!=U)7.V.33="1G";f.45=D.1l({},k);D.P(k,H(c,a){J e=2B D.28(46,f,c);G(/2m|1N|1M/.11(a))e[a=="2m"?1G?"1N":"1M":a](k);N{J b=a.6r().1I(/^([+-]=)?([\\d+-.]+)(.*)$/),2b=e.1t(M)||0;G(b){J d=3d(b[2]),2M=b[3]||"2X";G(2M!="2X"){46.V[c]=(d||1)+2M;2b=((d||1)/e.1t(M))*2b;46.V[c]=2b+2M}G(b[1])d=((b[1]=="-="?-1:1)*d)+2b;e.3G(2b,d,2M)}N e.3G(2b,a,"")}});I M})},36:H(a,b){G(D.1D(a)||(a&&a.1q==2p)){b=a;a="28"}G(!a||(1j a=="23"&&!b))I A(7[0],a);I 7.P(H(){G(b.1q==2p)A(7,a,b);N{A(7,a).1p(b);G(A(7,a).K==1)b.1k(7)}})},9X:H(b,c){J a=D.3O;G(b)7.36([]);7.P(H(){R(J i=a.K-1;i>=0;i--)G(a[i].T==7){G(c)a[i](M);a.7n(i,1)}});G(!c)7.5A();I 7}});J A=H(b,c,a){G(b){c=c||"28";J q=D.L(b,c+"36");G(!q||a)q=D.L(b,c+"36",D.2d(a))}I q};D.17.5A=H(a){a=a||"28";I 7.P(H(){J q=A(7,a);q.4s();G(q.K)q[0].1k(7)})};D.1l({77:H(b,a,c){J d=b&&b.1q==a0?b:{1J:c||!c&&a||D.1D(b)&&b,2u:b,41:c&&a||a&&a.1q!=9t&&a};d.2u=(d.2u&&d.2u.1q==4L?d.2u:D.28.5K[d.2u])||D.28.5K.74;d.5M=d.1J;d.1J=H(){G(d.36!==Q)D(7).5A();G(D.1D(d.5M))d.5M.1k(7)};I d},41:{73:H(p,n,b,a){I b+a*p},5P:H(p,n,b,a){I((-29.9r(p*29.9q)/2)+0.5)*a+b}},3O:[],48:U,28:H(b,c,a){7.15=c;7.T=b;7.1i=a;G(!c.3Z)c.3Z={}}});D.28.44={4D:H(){G(7.15.2Y)7.15.2Y.1k(7.T,7.1z,7);(D.28.2Y[7.1i]||D.28.2Y.4w)(7);G(7.1i=="1Z"||7.1i=="2h")7.T.V.18="3I"},1t:H(a){G(7.T[7.1i]!=U&&7.T.V[7.1i]==U)I 7.T[7.1i];J r=3d(D.1g(7.T,7.1i,a));I r&&r>-9p?r:3d(D.2a(7.T,7.1i))||0},3G:H(c,b,d){7.5V=1z();7.2b=c;7.3l=b;7.2M=d||7.2M||"2X";7.1z=7.2b;7.2S=7.4N=0;7.4D();J e=7;H t(a){I e.2Y(a)}t.T=7.T;D.3O.1p(t);G(D.48==U){D.48=4I(H(){J a=D.3O;R(J i=0;i<a.K;i++)G(!a[i]())a.7n(i--,1);G(!a.K){7k(D.48);D.48=U}},13)}},1N:H(){7.15.3Z[7.1i]=D.1K(7.T.V,7.1i);7.15.1N=M;7.3G(0,7.1t());G(7.1i=="2h"||7.1i=="1Z")7.T.V[7.1i]="9m";D(7.T).1N()},1M:H(){7.15.3Z[7.1i]=D.1K(7.T.V,7.1i);7.15.1M=M;7.3G(7.1t(),0)},2Y:H(a){J t=1z();G(a||t>7.15.2u+7.5V){7.1z=7.3l;7.2S=7.4N=1;7.4D();7.15.45[7.1i]=M;J b=M;R(J i 1n 7.15.45)G(7.15.45[i]!==M)b=Q;G(b){G(7.15.18!=U){7.T.V.33=7.15.33;7.T.V.18=7.15.18;G(D.1g(7.T,"18")=="2F")7.T.V.18="3I"}G(7.15.1M)7.T.V.18="2F";G(7.15.1M||7.15.1N)R(J p 1n 7.15.45)D.1K(7.T.V,p,7.15.3Z[p])}G(b)7.15.1J.1k(7.T);I Q}N{J n=t-7.5V;7.4N=n/7.15.2u;7.2S=D.41[7.15.41||(D.41.5P?"5P":"73")](7.4N,n,0,1,7.15.2u);7.1z=7.2b+((7.3l-7.2b)*7.2S);7.4D()}I M}};D.1l(D.28,{5K:{9l:9j,9i:7e,74:9g},2Y:{2e:H(a){a.T.2e=a.1z},2c:H(a){a.T.2c=a.1z},1y:H(a){D.1K(a.T.V,"1y",a.1z)},4w:H(a){a.T.V[a.1i]=a.1z+a.2M}}});D.17.2i=H(){J b=0,1S=0,T=7[0],3q;G(T)ao(D.14){J d=T.1d,4a=T,1s=T.1s,1Q=T.2z,5U=2k&&3r(5B)<9c&&!/9a/i.11(v),1g=D.2a,3c=1g(T,"30")=="3c";G(T.7y){J c=T.7y();1e(c.1A+29.2f(1Q.1C.2e,1Q.1c.2e),c.1S+29.2f(1Q.1C.2c,1Q.1c.2c));1e(-1Q.1C.6b,-1Q.1C.6a)}N{1e(T.5X,T.5W);1B(1s){1e(1s.5X,1s.5W);G(42&&!/^t(98|d|h)$/i.11(1s.2j)||2k&&!5U)2C(1s);G(!3c&&1g(1s,"30")=="3c")3c=M;4a=/^1c$/i.11(1s.2j)?4a:1s;1s=1s.1s}1B(d&&d.2j&&!/^1c|2K$/i.11(d.2j)){G(!/^96|1T.*$/i.11(1g(d,"18")))1e(-d.2e,-d.2c);G(42&&1g(d,"33")!="4j")2C(d);d=d.1d}G((5U&&(3c||1g(4a,"30")=="5x"))||(42&&1g(4a,"30")!="5x"))1e(-1Q.1c.5X,-1Q.1c.5W);G(3c)1e(29.2f(1Q.1C.2e,1Q.1c.2e),29.2f(1Q.1C.2c,1Q.1c.2c))}3q={1S:1S,1A:b}}H 2C(a){1e(D.2a(a,"6V",M),D.2a(a,"6U",M))}H 1e(l,t){b+=3r(l,10)||0;1S+=3r(t,10)||0}I 3q};D.17.1l({30:H(){J a=0,1S=0,3q;G(7[0]){J b=7.1s(),2i=7.2i(),4c=/^1c|2K$/i.11(b[0].2j)?{1S:0,1A:0}:b.2i();2i.1S-=25(7,\'94\');2i.1A-=25(7,\'aF\');4c.1S+=25(b,\'6U\');4c.1A+=25(b,\'6V\');3q={1S:2i.1S-4c.1S,1A:2i.1A-4c.1A}}I 3q},1s:H(){J a=7[0].1s;1B(a&&(!/^1c|2K$/i.11(a.2j)&&D.1g(a,\'30\')==\'93\'))a=a.1s;I D(a)}});D.P([\'5e\',\'5G\'],H(i,b){J c=\'4y\'+b;D.17[c]=H(a){G(!7[0])I;I a!=12?7.P(H(){7==1b||7==S?1b.92(!i?a:D(1b).2e(),i?a:D(1b).2c()):7[c]=a}):7[0]==1b||7[0]==S?46[i?\'aI\':\'aJ\']||D.71&&S.1C[c]||S.1c[c]:7[0][c]}});D.P(["6N","4b"],H(i,b){J c=i?"5e":"5G",4f=i?"6k":"6i";D.17["5s"+b]=H(){I 7[b.3y()]()+25(7,"57"+c)+25(7,"57"+4f)};D.17["90"+b]=H(a){I 7["5s"+b]()+25(7,"2C"+c+"4b")+25(7,"2C"+4f+"4b")+(a?25(7,"6S"+c)+25(7,"6S"+4f):0)}})})();',62,669,'|||||||this|||||||||||||||||||||||||||||||||||if|function|return|var|length|data|true|else|type|each|false|for|document|elem|null|style|event||nodeName|||test|undefined||browser|options|nodeType|fn|display|arguments|url|window|body|parentNode|add|msie|css|indexOf|prop|typeof|call|extend|script|in|replace|push|constructor|text|offsetParent|cur|status|div|apply|firstChild|opacity|now|left|while|documentElement|isFunction|filter|className|hidden|handle|match|complete|attr|ret|hide|show|dataType|trigger|doc|split|top|table|try|catch|success|break|cache|height||remove|tbody|string|guid|num|global|ready|fx|Math|curCSS|start|scrollTop|makeArray|scrollLeft|max|animate|width|offset|tagName|safari|map|toggle||done|Array|find|toUpperCase|button|special|duration|id|copy|value|handler|ownerDocument|select|new|border|exec|stack|none|opera|nextSibling|pushStack|target|html|inArray|unit|xml|bind|GET|isReady|merge|pos|timeout|delete|one|selected|px|step|jsre|position|async|preventDefault|overflow|name|which|queue|removeChild|namespace|insertBefore|nth|removeData|fixed|parseFloat|error|readyState|multiFilter|createElement|rl|re|trim|end|_|param|first|get|results|parseInt|slice|childNodes|encodeURIComponent|append|events|elems|toLowerCase|json|readyList|setTimeout|grep|mouseenter|color|is|custom|getElementsByTagName|block|stopPropagation|addEventListener|callee|proxy|mouseleave|timers|defaultView|password|disabled|last|has|appendChild|form|domManip|props|ajax|orig|set|easing|mozilla|load|prototype|curAnim|self|charCode|timerId|object|offsetChild|Width|parentOffset|src|unbind|br|currentStyle|clean|float|visible|relatedTarget|previousSibling|handlers|isXMLDoc|on|setup|nodeIndex|unique|shift|javascript|child|RegExp|_default|deep|scroll|lastModified|teardown|setRequestHeader|timeStamp|update|empty|tr|getAttribute|innerHTML|setInterval|checked|fromElement|Number|jQuery|state|active|jsonp|accepts|application|dir|input|responseText|click|styleSheets|unload|not|lastToggle|outline|mouseout|getPropertyValue|mouseover|getComputedStyle|bindReady|String|padding|pageX|metaKey|keyCode|getWH|andSelf|clientX|Left|all|visibility|container|index|init|triggered|removeAttribute|classFilter|prevObject|submit|file|after|windowData|inner|client|globalEval|sibling|jquery|absolute|clone|wrapAll|dequeue|version|triggerHandler|oldblock|ctrlKey|createTextNode|Top|handleError|getResponseHeader|parsererror|speeds|checkbox|old|00|radio|swing|href|Modified|ifModified|lastChild|safari2|startTime|offsetTop|offsetLeft|username|location|ajaxSettings|getElementById|isSimple|values|selectedIndex|runtimeStyle|rsLeft|_load|loaded|DOMContentLoaded|clientTop|clientLeft|toElement|srcElement|val|pageY|POST|unshift|Bottom|clientY|Right|fix|exclusive|detachEvent|cloneNode|removeEventListener|swap|toString|join|attachEvent|eval|substr|head|parse|textarea|reset|image|zoom|odd|even|before|prepend|exclude|expr|quickClass|quickID|uuid|quickChild|continue|Height|textContent|appendTo|contents|open|margin|evalScript|borderTopWidth|borderLeftWidth|parent|httpData|setArray|CSS1Compat|compatMode|boxModel|cssFloat|linear|def|webkit|nodeValue|speed|_toggle|eq|100|replaceWith|304|concat|200|alpha|Last|httpNotModified|getAttributeNode|httpSuccess|clearInterval|abort|beforeSend|splice|styleFloat|throw|colgroup|XMLHttpRequest|ActiveXObject|scriptCharset|callback|fieldset|multiple|processData|getBoundingClientRect|contentType|link|ajaxSend|ajaxSuccess|ajaxError|col|ajaxComplete|ajaxStop|ajaxStart|serializeArray|notmodified|keypress|keydown|change|mouseup|mousedown|dblclick|focus|blur|stylesheet|hasClass|rel|doScroll|black|hover|solid|cancelBubble|returnValue|wheelDelta|view|round|shiftKey|resize|screenY|screenX|relatedNode|mousemove|prevValue|originalTarget|offsetHeight|keyup|newValue|offsetWidth|eventPhase|detail|currentTarget|cancelable|bubbles|attrName|attrChange|altKey|originalEvent|charAt|0n|substring|animated|header|noConflict|line|enabled|innerText|contains|only|weight|font|gt|lt|uFFFF|u0128|size|417|Boolean|Date|toggleClass|removeClass|addClass|removeAttr|replaceAll|insertAfter|prependTo|wrap|contentWindow|contentDocument|iframe|children|siblings|prevAll|wrapInner|nextAll|outer|prev|scrollTo|static|marginTop|next|inline|parents|able|cellSpacing|adobeair|cellspacing|522|maxLength|maxlength|readOnly|400|readonly|fast|600|class|slow|1px|htmlFor|reverse|10000|PI|cos|compatible|Function|setData|ie|ra|it|rv|getData|userAgent|navigator|fadeTo|fadeIn|slideToggle|slideUp|slideDown|ig|responseXML|content|1223|NaN|fadeOut|300|protocol|send|setAttribute|option|dataFilter|cssText|changed|be|Accept|stop|With|Requested|Object|can|GMT|property|1970|Jan|01|Thu|Since|If|Type|Content|XMLHTTP|th|Microsoft|td|onreadystatechange|onload|cap|charset|colg|host|tfoot|specified|with|1_|thead|leg|plain|attributes|opt|embed|urlencoded|www|area|hr|ajaxSetup|meta|post|getJSON|getScript|marginLeft|img|elements|pageYOffset|pageXOffset|abbr|serialize|pixelLeft'.split('|'),0,{}));
/**
 * For jQuery versions less than 3.4.0, this replaces the jQuery.extend
 * function with the one from jQuery 3.4.0, slightly modified (documented
 * below) to be compatible with older jQuery versions and browsers.
 *
 * This provides the Object.prototype pollution vulnerability fix to Drupal
 * installations running older jQuery versions, including the versions shipped
 * with Drupal core and https://www.drupal.org/project/jquery_update.
 *
 * @see https://github.com/jquery/jquery/pull/4333
 */

(function (jQuery) {

// Do not override jQuery.extend() if the jQuery version is already >=3.4.0.
var versionParts = jQuery.fn.jquery.split('.');
var majorVersion = parseInt(versionParts[0]);
var minorVersion = parseInt(versionParts[1]);
var patchVersion = parseInt(versionParts[2]);
var isPreReleaseVersion = (patchVersion.toString() !== versionParts[2]);
if (
  (majorVersion > 3) ||
  (majorVersion === 3 && minorVersion > 4) ||
  (majorVersion === 3 && minorVersion === 4 && patchVersion > 0) ||
  (majorVersion === 3 && minorVersion === 4 && patchVersion === 0 && !isPreReleaseVersion)
) {
  return;
}

/**
 * This adds some funtions from jQuery 1.4.4 (the default version used in
 * Drupal 7) for when they aren't present, like when using jQuery 1.2.6 (the
 * default version used in Drupal 6).
 */

if (typeof jQuery.type === 'undefined') {
  var toString = Object.prototype.toString,
      class2type = {};

  // Populate the class2type map
  jQuery.each("Boolean Number String Function Array Date RegExp Object".split(" "), function(i, name) {
    class2type[ "[object " + name + "]" ] = name.toLowerCase();
  });

  jQuery.type = function (obj) {
    return obj == null ?
      String( obj ) :
      class2type[ toString.call(obj) ] || "object";
  };
}

if (typeof jQuery.isArray === 'undefined') {
  jQuery.isArray = function (obj) {
    return jQuery.type(obj) === "array";
  };
}

if (typeof jQuery.isWindow === 'undefined') {
  jQuery.isWindow = function (obj) {
    return obj && typeof obj === "object" && "setInterval" in obj;
  };
}

if (typeof jQuery.isPlainObject === 'undefined') {
  var hasOwn = Object.prototype.hasOwnProperty;

  jQuery.isPlainObject = function (obj) {
    // Must be an Object.
    // Because of IE, we also have to check the presence of the constructor property.
    // Make sure that DOM nodes and window objects don't pass through, as well
    if ( !obj || jQuery.type(obj) !== "object" || obj.nodeType || jQuery.isWindow( obj ) ) {
      return false;
    }

    // Not own constructor property must be Object
    if ( obj.constructor &&
      !hasOwn.call(obj, "constructor") &&
      !hasOwn.call(obj.constructor.prototype, "isPrototypeOf") ) {
      return false;
    }

    // Own properties are enumerated firstly, so to speed up,
    // if last one is own, then all properties are own.

    var key;
    for ( key in obj ) {}

    return key === undefined || hasOwn.call( obj, key );
  };
}

/**
 * This is almost verbatim copied from jQuery 3.4.0.
 *
 * Only two minor changes have been made:
 * - The call to isFunction() is changed to jQuery.isFunction().
 * - The two calls to Array.isArray() is changed to jQuery.isArray().
 *
 * The above two changes ensure compatibility with all older jQuery versions
 * (1.2.6 - 3.3.1) and older browser versions (e.g., IE8).
 */
jQuery.extend = jQuery.fn.extend = function() {
  var options, name, src, copy, copyIsArray, clone,
    target = arguments[ 0 ] || {},
    i = 1,
    length = arguments.length,
    deep = false;

  // Handle a deep copy situation
  if ( typeof target === "boolean" ) {
    deep = target;

    // Skip the boolean and the target
    target = arguments[ i ] || {};
    i++;
  }

  // Handle case when target is a string or something (possible in deep copy)
  if ( typeof target !== "object" && !jQuery.isFunction( target ) ) {
    target = {};
  }

  // Extend jQuery itself if only one argument is passed
  if ( i === length ) {
    target = this;
    i--;
  }

  for ( ; i < length; i++ ) {

    // Only deal with non-null/undefined values
    if ( ( options = arguments[ i ] ) != null ) {

      // Extend the base object
      for ( name in options ) {
        copy = options[ name ];

        // Prevent Object.prototype pollution
        // Prevent never-ending loop
        if ( name === "__proto__" || target === copy ) {
          continue;
        }

        // Recurse if we're merging plain objects or arrays
        if ( deep && copy && ( jQuery.isPlainObject( copy ) ||
          ( copyIsArray = jQuery.isArray( copy ) ) ) ) {
          src = target[ name ];

          // Ensure proper type for the source value
          if ( copyIsArray && !jQuery.isArray( src ) ) {
            clone = [];
          } else if ( !copyIsArray && !jQuery.isPlainObject( src ) ) {
            clone = {};
          } else {
            clone = src;
          }
          copyIsArray = false;

          // Never move original objects, clone them
          target[ name ] = jQuery.extend( deep, clone, copy );

          // Don't bring in undefined values
        } else if ( copy !== undefined ) {
          target[ name ] = copy;
        }
      }
    }
  }

  // Return the modified object
  return target;
};

})(jQuery);
;
/**
 * For jQuery versions less than 3.5.0, this replaces the jQuery.htmlPrefilter()
 * function with one that fixes these security vulnerabilities while also
 * retaining the pre-3.5.0 behavior where it's safe to do so.
 * - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11022
 * - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11023
 *
 * Additionally, for jQuery versions that do not have a jQuery.htmlPrefilter()
 * function (1.x prior to 1.12 and 2.x prior to 2.2), this adds it, and
 * extends the functions that need to call it to do so.
 *
 * Drupal core's jQuery version is 1.4.4, but jQuery Update can provide a
 * different version, so this covers all versions between 1.4.4 and 3.4.1.
 * The GitHub links in the code comments below link to jQuery 1.5 code, because
 * 1.4.4 isn't on GitHub, but the referenced code didn't change from 1.4.4 to
 * 1.5.
 */

(function (jQuery) {

  // Parts of this backport differ by jQuery version.
  var versionParts = jQuery.fn.jquery.split('.');
  var majorVersion = parseInt(versionParts[0]);
  var minorVersion = parseInt(versionParts[1]);

  // No backport is needed if we're already on jQuery 3.5 or higher.
  if ( (majorVersion > 3) || (majorVersion === 3 && minorVersion >= 5) ) {
    return;
  }

  // Prior to jQuery 3.5, jQuery converted XHTML-style self-closing tags to
  // their XML equivalent: e.g., "<div />" to "<div></div>". This is
  // problematic for several reasons, including that it's vulnerable to XSS
  // attacks. However, since this was jQuery's behavior for many years, many
  // Drupal modules and jQuery plugins may be relying on it. Therefore, we
  // preserve that behavior, but for a limited set of tags only, that we believe
  // to not be vulnerable. This is the set of HTML tags that satisfy all of the
  // following conditions:
  // - In DOMPurify's list of HTML tags. If an HTML tag isn't safe enough to
  //   appear in that list, then we don't want to mess with it here either.
  //   @see https://github.com/cure53/DOMPurify/blob/2.0.11/dist/purify.js#L128
  // - A normal element (not a void, template, text, or foreign element).
  //   @see https://html.spec.whatwg.org/multipage/syntax.html#elements-2
  // - An element that is still defined by the current HTML specification
  //   (not a deprecated element), because we do not want to rely on how
  //   browsers parse deprecated elements.
  //   @see https://developer.mozilla.org/en-US/docs/Web/HTML/Element
  // - Not 'html', 'head', or 'body', because this pseudo-XHTML expansion is
  //   designed for fragments, not entire documents.
  // - Not 'colgroup', because due to an idiosyncrasy of jQuery's original
  //   regular expression, it didn't match on colgroup, and we don't want to
  //   introduce a behavior change for that.
  var selfClosingTagsToReplace = [
    'a', 'abbr', 'address', 'article', 'aside', 'audio', 'b', 'bdi', 'bdo',
    'blockquote', 'button', 'canvas', 'caption', 'cite', 'code', 'data',
    'datalist', 'dd', 'del', 'details', 'dfn', 'div', 'dl', 'dt', 'em',
    'fieldset', 'figcaption', 'figure', 'footer', 'form', 'h1', 'h2', 'h3',
    'h4', 'h5', 'h6', 'header', 'hgroup', 'i', 'ins', 'kbd', 'label', 'legend',
    'li', 'main', 'map', 'mark', 'menu', 'meter', 'nav', 'ol', 'optgroup',
    'option', 'output', 'p', 'picture', 'pre', 'progress', 'q', 'rp', 'rt',
    'ruby', 's', 'samp', 'section', 'select', 'small', 'source', 'span',
    'strong', 'sub', 'summary', 'sup', 'table', 'tbody', 'td', 'tfoot', 'th',
    'thead', 'time', 'tr', 'u', 'ul', 'var', 'video'
  ];

  // Define regular expressions for <TAG/> and <TAG ATTRIBUTES/>. Doing this as
  // two expressions makes it easier to target <a/> without also targeting
  // every tag that starts with "a".
  var xhtmlRegExpGroup = '(' + selfClosingTagsToReplace.join('|') + ')';
  var whitespace = '[\\x20\\t\\r\\n\\f]';
  var rxhtmlTagWithoutSpaceOrAttributes = new RegExp('<' + xhtmlRegExpGroup + '\\/>', 'gi');
  var rxhtmlTagWithSpaceAndMaybeAttributes = new RegExp('<' + xhtmlRegExpGroup + '(' + whitespace + '[^>]*)\\/>', 'gi');

  // jQuery 3.5 also fixed a vulnerability for when </select> appears within
  // an <option> or <optgroup>, but it did that in local code that we can't
  // backport directly. Instead, we filter such cases out. To do so, we need to
  // determine when jQuery would otherwise invoke the vulnerable code, which it
  // uses this regular expression to determine. The regular expression changed
  // for version 3.0.0 and changed again for 3.4.0.
  // @see https://github.com/jquery/jquery/blob/1.5/jquery.js#L4958
  // @see https://github.com/jquery/jquery/blob/3.0.0/dist/jquery.js#L4584
  // @see https://github.com/jquery/jquery/blob/3.4.0/dist/jquery.js#L4712
  var rtagName;
  if (majorVersion < 3) {
    rtagName = /<([\w:]+)/;
  }
  else if (minorVersion < 4) {
    rtagName = /<([a-z][^\/\0>\x20\t\r\n\f]+)/i;
  }
  else {
    rtagName = /<([a-z][^\/\0>\x20\t\r\n\f]*)/i;
  }

  // The regular expression that jQuery uses to determine which self-closing
  // tags to expand to open and close tags. This is vulnerable, because it
  // matches all tag names except the few excluded ones. We only use this
  // expression for determining vulnerability. The expression changed for
  // version 3, but we only need to check for vulnerability in versions 1 and 2,
  // so we use the expression from those versions.
  // @see https://github.com/jquery/jquery/blob/1.5/jquery.js#L4957
  var rxhtmlTag = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi;

  jQuery.extend({
    htmlPrefilter: function (html) {
      // This is how jQuery determines the first tag in the HTML.
      // @see https://github.com/jquery/jquery/blob/1.5/jquery.js#L5521
      var tag = ( rtagName.exec( html ) || [ "", "" ] )[ 1 ].toLowerCase();

      // It is not valid HTML for <option> or <optgroup> to have <select> as
      // either a descendant or sibling, and attempts to inject one can cause
      // XSS on jQuery versions before 3.5. Since this is invalid HTML and a
      // possible XSS attack, reject the entire string.
      // @see https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11023
      if ((tag === 'option' || tag === 'optgroup') && html.match(/<\/?select/i)) {
        html = '';
      }

      // Retain jQuery's prior to 3.5 conversion of pseudo-XHTML, but for only
      // the tags in the `selfClosingTagsToReplace` list defined above.
      // @see https://github.com/jquery/jquery/blob/1.5/jquery.js#L5518
      // @see https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-11022
      html = html.replace(rxhtmlTagWithoutSpaceOrAttributes, "<$1></$1>");
      html = html.replace(rxhtmlTagWithSpaceAndMaybeAttributes, "<$1$2></$1>");

      // Prior to jQuery 1.12 and 2.2, this function gets called (via code later
      // in this file) in addition to, rather than instead of, the unsafe
      // expansion of self-closing tags (including ones not in the list above).
      // We can't prevent that unsafe expansion from running, so instead we
      // check to make sure that it doesn't affect the DOM returned by the
      // browser's parsing logic. If it does affect it, then it's vulnerable to
      // XSS, so we reject the entire string.
      if ( (majorVersion === 1 && minorVersion < 12) || (majorVersion === 2 && minorVersion < 2) ) {
        var htmlRisky = html.replace(rxhtmlTag, "<$1></$2>");
        if (htmlRisky !== html) {
          // Even though htmlRisky and html are different strings, they might
          // represent the same HTML structure once parsed, in which case,
          // htmlRisky is actually safe. We can ask the browser to parse both
          // to find out, but the browser can't parse table fragments (e.g., a
          // root-level "<td>"), so we need to wrap them. We just need this
          // technique to work on all supported browsers; we don't need to
          // copy from the specific jQuery version we're using.
          // @see https://github.com/jquery/jquery/blob/3.5.1/dist/jquery.js#L4939
          var wrapMap = {
            thead: [ 1, "<table>", "</table>" ],
            col: [ 2, "<table><colgroup>", "</colgroup></table>" ],
            tr: [ 2, "<table><tbody>", "</tbody></table>" ],
            td: [ 3, "<table><tbody><tr>", "</tr></tbody></table>" ],
          };
          wrapMap.tbody = wrapMap.tfoot = wrapMap.colgroup = wrapMap.caption = wrapMap.thead;
          wrapMap.th = wrapMap.td;

          // Function to wrap HTML into something that a browser can parse.
          // @see https://github.com/jquery/jquery/blob/3.5.1/dist/jquery.js#L5032
          var getWrappedHtml = function (html) {
            var wrap = wrapMap[tag];
            if (wrap) {
              html = wrap[1] + html + wrap[2];
            }
            return html;
          };

          // Function to return canonical HTML after parsing it. This parses
          // only; it doesn't execute scripts.
          // @see https://github.com/jquery/jquery-migrate/blob/3.3.0/src/jquery/manipulation.js#L5
          var getParsedHtml = function (html) {
            var doc = window.document.implementation.createHTMLDocument( "" );
            doc.body.innerHTML = html;
            return doc.body ? doc.body.innerHTML : '';
          };

          // If the browser couldn't parse either one successfully, or if
          // htmlRisky parses differently than html, then html is vulnerable,
          // so reject it.
          var htmlParsed = getParsedHtml(getWrappedHtml(html));
          var htmlRiskyParsed = getParsedHtml(getWrappedHtml(htmlRisky));
          if (htmlRiskyParsed === '' || htmlParsed === '' || (htmlRiskyParsed !== htmlParsed)) {
            html = '';
          }
        }
      }

      return html;
    }
  });

  // Prior to jQuery 1.12 and 2.2, jQuery.clean(), jQuery.buildFragment(), and
  // jQuery.fn.html() did not call jQuery.htmlPrefilter(), so we add that.
  if ( (majorVersion === 1 && minorVersion < 12) || (majorVersion === 2 && minorVersion < 2) ) {
    // Filter the HTML coming into jQuery.fn.html().
    var fnOriginalHtml = jQuery.fn.html;
    jQuery.fn.extend({
      // @see https://github.com/jquery/jquery/blob/1.5/jquery.js#L5147
      html: function (value) {
        if (typeof value === "string") {
          value = jQuery.htmlPrefilter(value);
        }
        // .html() can be called as a setter (with an argument) or as a getter
        // (without an argument), so invoke fnOriginalHtml() the same way that
        // we were invoked.
        return fnOriginalHtml.apply(this, arguments.length ? [value] : []);
      }
    });

    // The regular expression that jQuery uses to determine if a string is HTML.
    // Used by both clean() and buildFragment().
    // @see https://github.com/jquery/jquery/blob/1.5/jquery.js#L4960
    var rhtml = /<|&#?\w+;/;

    // Filter HTML coming into:
    // - jQuery.clean() for versions prior to 1.9.
    // - jQuery.buildFragment() for 1.9 and above.
    //
    // The looping constructs in the two functions might be essentially
    // identical, but they're each expressed here in the way that most closely
    // matches their original expression in jQuery, so that we filter all of
    // the items and only the items that jQuery will treat as HTML strings.
    if (majorVersion === 1 && minorVersion < 9) {
      var originalClean = jQuery.clean;
      jQuery.extend({
        // @see https://github.com/jquery/jquery/blob/1.5/jquery.js#L5493
        'clean': function (elems, context, fragment, scripts) {
          for ( var i = 0, elem; (elem = elems[i]) != null; i++ ) {
            if ( typeof elem === "string" && rhtml.test( elem ) ) {
              elems[i] = elem = jQuery.htmlPrefilter(elem);
            }
          }
          return originalClean.call(this, elems, context, fragment, scripts);
        }
      });
    }
    else {
      var originalBuildFragment = jQuery.buildFragment;
      jQuery.extend({
        // @see https://github.com/jquery/jquery/blob/1.9.0/jquery.js#L6419
        'buildFragment': function (elems, context, scripts, selection) {
          var l = elems.length;
          for ( var i = 0; i < l; i++ ) {
            var elem = elems[i];
            if (elem || elem === 0) {
              if ( jQuery.type( elem ) !== "object" && rhtml.test( elem ) ) {
                elems[i] = elem = jQuery.htmlPrefilter(elem);
              }
            }
          }
          return originalBuildFragment.call(this, elems, context, scripts, selection);
        }
      });
    }
  }

})(jQuery);
;

/**
 * Override jQuery.fn.init to guard against XSS attacks.
 *
 * See http://bugs.jquery.com/ticket/9521
 */
(function () {
  var jquery_init = jQuery.fn.init;
  jQuery.fn.init = function (selector, context, rootjQuery) {
    // If the string contains a "#" before a "<", treat it as invalid HTML.
    if (selector && typeof selector === 'string') {
      var hash_position = selector.indexOf('#');
      if (hash_position >= 0) {
        var bracket_position = selector.indexOf('<');
        if (bracket_position > hash_position) {
          throw 'Syntax error, unrecognized expression: ' + selector;
        }
      }
    }
    return jquery_init.call(this, selector, context, rootjQuery);
  };
  jQuery.fn.init.prototype = jquery_init.prototype;

  /**
   * Pre-filter Ajax requests to guard against XSS attacks.
   *
   * See https://github.com/jquery/jquery/issues/2432
   */
  if ($.ajaxPrefilter) {
    // For newer versions of jQuery, use an Ajax prefilter to prevent
    // auto-executing script tags from untrusted domains. This is similar to the
    // fix that is built in to jQuery 3.0 and higher.
    $.ajaxPrefilter(function (s) {
      if (s.crossDomain) {
        s.contents.script = false;
      }
    });
  }
  else if ($.httpData) {
    // For the version of jQuery that ships with Drupal core, override
    // jQuery.httpData to prevent auto-detecting "script" data types from
    // untrusted domains.
    var jquery_httpData = $.httpData;
    $.httpData = function (xhr, type, s) {
      // @todo Consider backporting code from newer jQuery versions to check for
      //   a cross-domain request here, rather than using Drupal.urlIsLocal() to
      //   block scripts from all URLs that are not on the same site.
      if (!type && (!s || !Drupal.urlIsLocal(s.url))) {
        var content_type = xhr.getResponseHeader('content-type') || '';
        if (content_type.indexOf('javascript') >= 0) {
          // Default to a safe data type.
          type = 'text';
        }
      }
      return jquery_httpData.call(this, xhr, type, s);
    };
    $.httpData.prototype = jquery_httpData.prototype;
  }
})();

var Drupal = Drupal || { 'settings': {}, 'behaviors': {}, 'themes': {}, 'locale': {} };

/**
 * Set the variable that indicates if JavaScript behaviors should be applied
 */
Drupal.jsEnabled = true;

/**
 * Attach all registered behaviors to a page element.
 *
 * Behaviors are event-triggered actions that attach to page elements, enhancing
 * default non-Javascript UIs. Behaviors are registered in the Drupal.behaviors
 * object as follows:
 * @code
 *    Drupal.behaviors.behaviorName = function () {
 *      ...
 *    };
 * @endcode
 *
 * Drupal.attachBehaviors is added below to the jQuery ready event and so
 * runs on initial page load. Developers implementing AHAH/AJAX in their
 * solutions should also call this function after new page content has been
 * loaded, feeding in an element to be processed, in order to attach all
 * behaviors to the new content.
 *
 * Behaviors should use a class in the form behaviorName-processed to ensure
 * the behavior is attached only once to a given element. (Doing so enables
 * the reprocessing of given elements, which may be needed on occasion despite
 * the ability to limit behavior attachment to a particular element.)
 *
 * @param context
 *   An element to attach behaviors to. If none is given, the document element
 *   is used.
 */
Drupal.attachBehaviors = function(context) {
  context = context || document;
  // Execute all of them.
  jQuery.each(Drupal.behaviors, function() {
    this(context);
  });
};

/**
 * Encode special characters in a plain-text string for display as HTML.
 */
Drupal.checkPlain = function(str) {
  str = String(str);
  var replace = { '&': '&amp;', "'": '&#39;', '"': '&quot;', '<': '&lt;', '>': '&gt;' };
  for (var character in replace) {
    var regex = new RegExp(character, 'g');
    str = str.replace(regex, replace[character]);
  }
  return str;
};

/**
 * Translate strings to the page language or a given language.
 *
 * See the documentation of the server-side t() function for further details.
 *
 * @param str
 *   A string containing the English string to translate.
 * @param args
 *   An object of replacements pairs to make after translation. Incidences
 *   of any key in this array are replaced with the corresponding value.
 *   Based on the first character of the key, the value is escaped and/or themed:
 *    - !variable: inserted as is
 *    - @variable: escape plain text to HTML (Drupal.checkPlain)
 *    - %variable: escape text and theme as a placeholder for user-submitted
 *      content (checkPlain + Drupal.theme('placeholder'))
 * @return
 *   The translated string.
 */
Drupal.t = function(str, args) {
  // Fetch the localized version of the string.
  if (Drupal.locale.strings && Drupal.locale.strings[str]) {
    str = Drupal.locale.strings[str];
  }

  if (args) {
    // Transform arguments before inserting them
    for (var key in args) {
      switch (key.charAt(0)) {
        // Escaped only
        case '@':
          args[key] = Drupal.checkPlain(args[key]);
        break;
        // Pass-through
        case '!':
          break;
        // Escaped and placeholder
        case '%':
        default:
          args[key] = Drupal.theme('placeholder', args[key]);
          break;
      }
      str = str.replace(key, args[key]);
    }
  }
  return str;
};

/**
 * Format a string containing a count of items.
 *
 * This function ensures that the string is pluralized correctly. Since Drupal.t() is
 * called by this function, make sure not to pass already-localized strings to it.
 *
 * See the documentation of the server-side format_plural() function for further details.
 *
 * @param count
 *   The item count to display.
 * @param singular
 *   The string for the singular case. Please make sure it is clear this is
 *   singular, to ease translation (e.g. use "1 new comment" instead of "1 new").
 *   Do not use @count in the singular string.
 * @param plural
 *   The string for the plural case. Please make sure it is clear this is plural,
 *   to ease translation. Use @count in place of the item count, as in "@count
 *   new comments".
 * @param args
 *   An object of replacements pairs to make after translation. Incidences
 *   of any key in this array are replaced with the corresponding value.
 *   Based on the first character of the key, the value is escaped and/or themed:
 *    - !variable: inserted as is
 *    - @variable: escape plain text to HTML (Drupal.checkPlain)
 *    - %variable: escape text and theme as a placeholder for user-submitted
 *      content (checkPlain + Drupal.theme('placeholder'))
 *   Note that you do not need to include @count in this array.
 *   This replacement is done automatically for the plural case.
 * @return
 *   A translated string.
 */
Drupal.formatPlural = function(count, singular, plural, args) {
  var args = args || {};
  args['@count'] = count;
  // Determine the index of the plural form.
  var index = Drupal.locale.pluralFormula ? Drupal.locale.pluralFormula(args['@count']) : ((args['@count'] == 1) ? 0 : 1);

  if (index == 0) {
    return Drupal.t(singular, args);
  }
  else if (index == 1) {
    return Drupal.t(plural, args);
  }
  else {
    args['@count['+ index +']'] = args['@count'];
    delete args['@count'];
    return Drupal.t(plural.replace('@count', '@count['+ index +']'), args);
  }
};

/**
 * Returns the passed in URL as an absolute URL.
 *
 * @param url
 *   The URL string to be normalized to an absolute URL.
 *
 * @return
 *   The normalized, absolute URL.
 *
 * @see https://github.com/angular/angular.js/blob/v1.4.4/src/ng/urlUtils.js
 * @see https://grack.com/blog/2009/11/17/absolutizing-url-in-javascript
 * @see https://github.com/jquery/jquery-ui/blob/1.11.4/ui/tabs.js#L53
 */
Drupal.absoluteUrl = function (url) {
  var urlParsingNode = document.createElement('a');

  // Decode the URL first; this is required by IE <= 6. Decoding non-UTF-8
  // strings may throw an exception.
  try {
    url = decodeURIComponent(url);
  } catch (e) {}

  urlParsingNode.setAttribute('href', url);

  // IE <= 7 normalizes the URL when assigned to the anchor node similar to
  // the other browsers.
  return urlParsingNode.cloneNode(false).href;
};

/**
 * Returns true if the URL is within Drupal's base path.
 *
 * @param url
 *   The URL string to be tested.
 *
 * @return
 *   Boolean true if local.
 *
 * @see https://github.com/jquery/jquery-ui/blob/1.11.4/ui/tabs.js#L58
 */
Drupal.urlIsLocal = function (url) {
  // Always use browser-derived absolute URLs in the comparison, to avoid
  // attempts to break out of the base path using directory traversal.
  var absoluteUrl = Drupal.absoluteUrl(url);
  var protocol = location.protocol;

  // Consider URLs that match this site's base URL but use HTTPS instead of HTTP
  // as local as well.
  if (protocol === 'http:' && absoluteUrl.indexOf('https:') === 0) {
    protocol = 'https:';
  }
  var baseUrl = protocol + '//' + location.host + Drupal.settings.basePath.slice(0, -1);

  // Decoding non-UTF-8 strings may throw an exception.
  try {
    absoluteUrl = decodeURIComponent(absoluteUrl);
  } catch (e) {}
  try {
    baseUrl = decodeURIComponent(baseUrl);
  } catch (e) {}

  // The given URL matches the site's base URL, or has a path under the site's
  // base URL.
  return absoluteUrl === baseUrl || absoluteUrl.indexOf(baseUrl + '/') === 0;
};

/**
 * Generate the themed representation of a Drupal object.
 *
 * All requests for themed output must go through this function. It examines
 * the request and routes it to the appropriate theme function. If the current
 * theme does not provide an override function, the generic theme function is
 * called.
 *
 * For example, to retrieve the HTML that is output by theme_placeholder(text),
 * call Drupal.theme('placeholder', text).
 *
 * @param func
 *   The name of the theme function to call.
 * @param ...
 *   Additional arguments to pass along to the theme function.
 * @return
 *   Any data the theme function returns. This could be a plain HTML string,
 *   but also a complex object.
 */
Drupal.theme = function(func) {
  for (var i = 1, args = []; i < arguments.length; i++) {
    args.push(arguments[i]);
  }

  return (Drupal.theme[func] || Drupal.theme.prototype[func]).apply(this, args);
};

/**
 * Parse a JSON response.
 *
 * The result is either the JSON object, or an object with 'status' 0 and 'data' an error message.
 */
Drupal.parseJson = function (data) {
  if ((data.substring(0, 1) != '{') && (data.substring(0, 1) != '[')) {
    return { status: 0, data: data.length ? data : Drupal.t('Unspecified error') };
  }
  return eval('(' + data + ');');
};

/**
 * Freeze the current body height (as minimum height). Used to prevent
 * unnecessary upwards scrolling when doing DOM manipulations.
 */
Drupal.freezeHeight = function () {
  Drupal.unfreezeHeight();
  var div = document.createElement('div');
  $(div).css({
    position: 'absolute',
    top: '0px',
    left: '0px',
    width: '1px',
    height: $('body').css('height')
  }).attr('id', 'freeze-height');
  $('body').append(div);
};

/**
 * Unfreeze the body height
 */
Drupal.unfreezeHeight = function () {
  $('#freeze-height').remove();
};

/**
 * Wrapper around encodeURIComponent() which avoids Apache quirks (equivalent of
 * drupal_urlencode() in PHP). This function should only be used on paths, not
 * on query string arguments.
 */
Drupal.encodeURIComponent = function (item, uri) {
  uri = uri || location.href;
  item = encodeURIComponent(item).replace(/%2F/g, '/');
  return (uri.indexOf('?q=') != -1) ? item : item.replace(/%26/g, '%2526').replace(/%23/g, '%2523').replace(/\/\//g, '/%252F');
};

/**
 * Get the text selection in a textarea.
 */
Drupal.getSelection = function (element) {
  if (typeof(element.selectionStart) != 'number' && document.selection) {
    // The current selection
    var range1 = document.selection.createRange();
    var range2 = range1.duplicate();
    // Select all text.
    range2.moveToElementText(element);
    // Now move 'dummy' end point to end point of original range.
    range2.setEndPoint('EndToEnd', range1);
    // Now we can calculate start and end points.
    var start = range2.text.length - range1.text.length;
    var end = start + range1.text.length;
    return { 'start': start, 'end': end };
  }
  return { 'start': element.selectionStart, 'end': element.selectionEnd };
};

/**
 * Sanitizes a URL for use with jQuery.ajax().
 *
 * @param url
 *   The URL string to be sanitized.
 *
 * @return
 *   The sanitized URL.
 */
Drupal.sanitizeAjaxUrl = function (url) {
  var regex = /\=\?(&|$)/;
  while (url.match(regex)) {
    url = url.replace(regex, '');
  }
  return url;
}

/**
 * Build an error message from ahah response.
 */
Drupal.ahahError = function(xmlhttp, uri) {
  if (xmlhttp.status == 200) {
    if (jQuery.trim(xmlhttp.responseText)) {
      var message = Drupal.t("An error occurred. \n@uri\n@text", {'@uri': uri, '@text': xmlhttp.responseText });
    }
    else {
      var message = Drupal.t("An error occurred. \n@uri\n(no information available).", {'@uri': uri });
    }
  }
  else {
    var message = Drupal.t("An HTTP error @status occurred. \n@uri", {'@uri': uri, '@status': xmlhttp.status });
  }
  return message.replace(/\n/g, '<br />');
}

// Global Killswitch on the <html> element
$(document.documentElement).addClass('js');
// Attach all behaviors.
$(document).ready(function() {
  Drupal.attachBehaviors(this);
});

/**
 * The default themes.
 */
Drupal.theme.prototype = {

  /**
   * Formats text for emphasized display in a placeholder inside a sentence.
   *
   * @param str
   *   The text to format (plain-text).
   * @return
   *   The formatted text (html).
   */
  placeholder: function(str) {
    return '<em>' + Drupal.checkPlain(str) + '</em>';
  }
};
;

/*
 * Superfish v1.4.8 - jQuery menu widget
 * Copyright (c) 2008 Joel Birch
 *
 * Dual licensed under the MIT and GPL licenses:
 * 	http://www.opensource.org/licenses/mit-license.php
 * 	http://www.gnu.org/licenses/gpl.html
 *
 * CHANGELOG: http://users.tpg.com.au/j_birch/plugins/superfish/changelog.txt
 */

;(function($){
	$.fn.superfish = function(op){

		var sf = $.fn.superfish,
			c = sf.c,
			$arrow = $(['<span class="',c.arrowClass,'"> &#187;</span>'].join('')),
			over = function(){
				var $$ = $(this), menu = getMenu($$);
				clearTimeout(menu.sfTimer);
				$$.showSuperfishUl().siblings().hideSuperfishUl();
			},
			out = function(){
				var $$ = $(this), menu = getMenu($$), o = sf.op;
				clearTimeout(menu.sfTimer);
				menu.sfTimer=setTimeout(function(){
					o.retainPath=($.inArray($$[0],o.$path)>-1);
					$$.hideSuperfishUl();
					if (o.$path.length && $$.parents(['li.',o.hoverClass].join('')).length<1){over.call(o.$path);}
				},o.delay);	
			},
			getMenu = function($menu){
				var menu = $menu.parents(['ul.',c.menuClass,':first'].join(''))[0];
				sf.op = sf.o[menu.serial];
				return menu;
			},
			addArrow = function($a){ $a.addClass(c.anchorClass).append($arrow.clone()); };
			
		return this.each(function() {
			var s = this.serial = sf.o.length;
			var o = $.extend({},sf.defaults,op);
			o.$path = $('li.'+o.pathClass,this).slice(0,o.pathLevels).each(function(){
				$(this).addClass([o.hoverClass,c.bcClass].join(' '))
					.filter('li:has(ul)').removeClass(o.pathClass);
			});
			sf.o[s] = sf.op = o;
			
			$('li:has(ul)',this)[($.fn.hoverIntent && !o.disableHI) ? 'hoverIntent' : 'hover'](over,out).each(function() {
				if (o.autoArrows) addArrow( $('>a:first-child',this) );
			})
			.not('.'+c.bcClass)
				.hideSuperfishUl();
			
			var $a = $('a',this);
			$a.each(function(i){
				var $li = $a.eq(i).parents('li');
				$a.eq(i).focus(function(){over.call($li);}).blur(function(){out.call($li);});
			});
			o.onInit.call(this);
			
		}).each(function() {
			var menuClasses = [c.menuClass];
			if (sf.op.dropShadows  && !($.browser.msie && $.browser.version < 7)) menuClasses.push(c.shadowClass);
			$(this).addClass(menuClasses.join(' '));
		});
	};

	var sf = $.fn.superfish;
	sf.o = [];
	sf.op = {};
	sf.IE7fix = function(){
		var o = sf.op;
		if ($.browser.msie && $.browser.version > 6 && o.dropShadows && o.animation.opacity!=undefined)
			this.toggleClass(sf.c.shadowClass+'-off');
		};
	sf.c = {
		bcClass     : 'sf-breadcrumb',
		menuClass   : 'sf-js-enabled',
		anchorClass : 'sf-with-ul',
		arrowClass  : 'sf-sub-indicator',
		shadowClass : 'sf-shadow'
	};
	sf.defaults = {
		hoverClass	: 'sfHover',
		pathClass	: 'overideThisToUse',
		pathLevels	: 1,
		delay		: 800,
		animation	: {opacity:'show'},
		speed		: 'normal',
		autoArrows	: true,
		dropShadows : true,
		disableHI	: false,		// true disables hoverIntent detection
		onInit		: function(){}, // callback functions
		onBeforeShow: function(){},
		onShow		: function(){},
		onHide		: function(){}
	};
	$.fn.extend({
		hideSuperfishUl : function(){
			var o = sf.op,
				not = (o.retainPath===true) ? o.$path : '';
			o.retainPath = false;
			var $ul = $(['li.',o.hoverClass].join(''),this).add(this).not(not).removeClass(o.hoverClass)
					.find('>ul').hide().css('visibility','hidden');
			o.onHide.call($ul);
			return this;
		},
		showSuperfishUl : function(){
			var o = sf.op,
				sh = sf.c.shadowClass+'-off',
				$ul = this.addClass(o.hoverClass)
					.find('>ul:hidden').css('visibility','visible');
			sf.IE7fix.call($ul);
			o.onBeforeShow.call($ul);
			$ul.animate(o.animation,o.speed,function(){ sf.IE7fix.call($ul); o.onShow.call($ul); });
			return this;
		}
	});

})(jQuery);
;
/*! Copyright (c) 2013 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Version 3.0.0
 */
(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(jQuery)}})(function(e){function t(e){return e&&e.constructor===Number?e+"px":e}e.fn.bgiframe=function(n){n=e.extend({top:"auto",left:"auto",width:"auto",height:"auto",opacity:true,src:"javascript:false;",conditional:/MSIE 6.0/.test(navigator.userAgent)},n);if(!e.isFunction(n.conditional)){var r=n.conditional;n.conditional=function(){return r}}var i=e('<iframe class="bgiframe"frameborder="0"tabindex="-1"src="'+n.src+'"'+'style="display:block;position:absolute;z-index:-1;"/>');return this.each(function(){var r=e(this);if(n.conditional(this)===false){return}var o=r.children("iframe.bgiframe");var u=o.length===0?i.clone():o;u.css({top:n.top=="auto"?(parseInt(r.css("borderTopWidth"),10)||0)*-1+"px":t(n.top),left:n.left=="auto"?(parseInt(r.css("borderLeftWidth"),10)||0)*-1+"px":t(n.left),width:n.width=="auto"?this.offsetWidth+"px":t(n.width),height:n.height=="auto"?this.offsetHeight+"px":t(n.height),opacity:n.opacity===true?0:undefined});if(o.length===0){r.prepend(u)}})};e.fn.bgIframe=e.fn.bgiframe})
;
/**
* hoverIntent r5 // 2007.03.27 // jQuery 1.1.2+
* <http://cherne.net/brian/resources/jquery.hoverIntent.html>
* 
* @param  f  onMouseOver function || An object with configuration options
* @param  g  onMouseOut function  || Nothing (use configuration options object)
* @author    Brian Cherne <brian@cherne.net>
*/
(function($){$.fn.hoverIntent=function(f,g){var cfg={sensitivity:7,interval:100,timeout:0};cfg=$.extend(cfg,g?{over:f,out:g}:f);var cX,cY,pX,pY;var track=function(ev){cX=ev.pageX;cY=ev.pageY;};var compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if((Math.abs(pX-cX)+Math.abs(pY-cY))<cfg.sensitivity){$(ob).unbind("mousemove",track);ob.hoverIntent_s=1;return cfg.over.apply(ob,[ev]);}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob);},cfg.interval);}};var delay=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=0;return cfg.out.apply(ob,[ev]);};var handleHover=function(e){var p=(e.type=="mouseover"?e.fromElement:e.toElement)||e.relatedTarget;while(p&&p!=this){try{p=p.parentNode;}catch(e){p=this;}}if(p==this){return false;}var ev=jQuery.extend({},e);var ob=this;if(ob.hoverIntent_t){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);}if(e.type=="mouseover"){pX=ev.pageX;pY=ev.pageY;$(ob).bind("mousemove",track);if(ob.hoverIntent_s!=1){ob.hoverIntent_t=setTimeout(function(){compare(ev,ob);},cfg.interval);}}else{$(ob).unbind("mousemove",track);if(ob.hoverIntent_s==1){ob.hoverIntent_t=setTimeout(function(){delay(ev,ob);},cfg.timeout);}}};return this.mouseover(handleHover).mouseout(handleHover);};})(jQuery);;
// $Id: nice_menus.js,v 1.21 2010/06/18 06:14:12 vordude Exp $

// This uses Superfish 1.4.8
// (http://users.tpg.com.au/j_birch/plugins/superfish)

// Add Superfish to all Nice menus with some basic options.
Drupal.behaviors.niceMenus = function() {
  $('ul.nice-menu').superfish({
    // Apply a generic hover class.
    hoverClass: 'over',
    // Disable generation of arrow mark-up.
    autoArrows: false,
    // Disable drop shadows.
    dropShadows: false,
    // Mouse delay.
    delay: Drupal.settings.nice_menus_options.delay,
    // Animation speed.
    speed: Drupal.settings.nice_menus_options.speed
    // Add in Brandon Aarons bgIframe plugin for IE select issues.
    // http://plugins.jquery.com/node/46/release
  }).find('ul').bgIframe({opacity:false});
  $('ul.nice-menu ul').css('display', 'none');
};
;
/*
 * jQuery doTimeout: Like setTimeout, but better! - v1.0 - 3/3/2010
 * http://benalman.com/projects/jquery-dotimeout-plugin/
 *
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($){var a={},c="doTimeout",d=Array.prototype.slice;$[c]=function(){return b.apply(window,[0].concat(d.call(arguments)))};$.fn[c]=function(){var f=d.call(arguments),e=b.apply(this,[c+f[0]].concat(f));return typeof f[0]==="number"||typeof f[1]==="number"?this:e};function b(l){var m=this,h,k={},g=l?$.fn:$,n=arguments,i=4,f=n[1],j=n[2],p=n[3];if(typeof f!=="string"){i--;f=l=0;j=n[1];p=n[2]}if(l){h=m.eq(0);h.data(l,k=h.data(l)||{})}else{if(f){k=a[f]||(a[f]={})}}k.id&&clearTimeout(k.id);delete k.id;function e(){if(l){h.removeData(l)}else{if(f){delete a[f]}}}function o(){k.id=setTimeout(function(){k.fn()},j)}if(p){k.fn=function(q){if(typeof p==="string"){p=g[p]}p.apply(m,d.call(n,i))===true&&!q?o():e()};o()}else{if(k.fn){j===undefined?e():k.fn(j===false);return true}else{e()}}}})(jQuery);;
/**
 * @plugin fantabulous
 *
 * @desc creates a organized group of elements with corresponding tabbed
 * navigation. Then it wraps all passed elements into a fantabulous wrapper then
 * creates the fantabulous functionality.
 */
 ;(function($, window, document, undefined){

  "use strict";

  var pluginName = "fantabulous",
    defaults = {
      duration: 500,
      defaultSelected: 0,
      tabbedBy: 'viewsBlocks'
    };

  function Plugin(element, options) {
    this.element   = element;
    this.options   = $.extend({}, defaults, options);
    this._name     = pluginName;
    this._defaults = defaults;

    this.$element  = $(element);
    this.currentTab = null;
    this.$tabbedContainer = this.$element.find('.fantabulous-content');
    this.$tabbedElements = this.$tabbedContainer.children();
    this.$tabbedElements.each(function(key, content) {
      // caches the heights for animations later.
      $(content).data('targetHeight', $(content).outerHeight(true));
    });
    this.$tabsContainer = this.render(this.options.tabbedBy);
    this.$tabsContainer.prependTo(this.$element);
    this.$tabs = this.$tabsContainer.children();
    this.init();
  }

  Plugin.prototype = {
    init: function() {
      var plugin = this;
      plugin.$tabs.eq(this.options.defaultSelected).trigger('click');
    },
    // -------------------------------------------------------------------------
    // Animations
    // -------------------------------------------------------------------------
    animateOpacity: function($element) {
      var plugin = this;
      plugin.$tabbedElements.stop(true,true).animate({opacity: 'hide'}, plugin.options.duration/2);
      $.doTimeout(plugin.options.duration/2, function() {
        $element.stop(true,true).animate({opacity: 'show'}, plugin.options.duration/2);
      });
    },
    animateHeight: function(value) {
      var plugin = this;
      plugin.$tabbedContainer.stop(true).animate({height: value}, plugin.options.duration/2);
    },
    // -------------------------------------------------------------------------
    // Event Handlers
    // -------------------------------------------------------------------------
    events: {
      tabClicked: function(event) {
        var plugin = event.data.scope,
          $this = $(this),
          previousIndex = plugin.currentTab,
          currentIndex = Number($this.data('index'));
        // was the same tab clicked ?
        if (currentIndex != previousIndex || !plugin.currentTab) {
          var $origin = plugin.$tabbedElements.eq(previousIndex),
            $destination = plugin.$tabbedElements.eq(currentIndex),
            targetHeight, difference;
          // set currentTab.
          plugin.currentTab = currentIndex;

          // tabs
          plugin.$tabs.eq(previousIndex).removeClass('active');
          $this.addClass('active');

          // tabbed content.
          $origin.removeClass('active');
          $destination.addClass('active');

          if ($origin.outerHeight(true) != $origin.data('targetHeight')) {
            $origin.data('targetHeight', $origin.outerHeight(true));
          }

          difference = $destination.data('targetHeight') - $origin.outerHeight(true);

          if (difference > 0) {
            plugin.animateOpacity($destination);
            plugin.animateHeight($destination.data('targetHeight'));
          }
          else {
            plugin.animateOpacity($destination);
            $.doTimeout(plugin.options.duration/2, function() {
              plugin.animateHeight($destination.data('targetHeight'));
            });
          }
        }

        event.preventDefault();
      }
    },
    // -------------------------------------------------------------------------
    // jQuery Template Renderer
    // -------------------------------------------------------------------------
    render: function(name, args, args2, args3) {
      var plugin = this,
        templates = {
          viewsBlocks: function() {
            var $tabs = $('<div class="fantabulous-tabs"></div>');
            $.each(plugin.$element.find('.block-title-text'), function(key, value){
              var $tab = $(value).clone()
                .attr({'class': 'tab'})
                .data('index', key)
                .bind('click', {scope: plugin}, plugin.events.tabClicked);
              $tab.appendTo($tabs);
            });
            return $tabs;
          }
        };
      // return a rendered template.
      return templates[name](args, args2, args3);
    }
  };

  $.fn[pluginName] = function(options) {
    var response = this,
        found = false;
    $.each(this, function(k, element) {
      // simple test to see if the elements are already wrapped in a element
      // with a class of [pluginName]-content.
      if ($(element).parent().hasClass(pluginName + '-content')) {
        found = true;
        console.log('[' + pluginName + '] reports:', 'One or more of the elements passed are already included in a previously defined ' + pluginName + ' instance.')
      }
    });
    if ( !found ) {
      var $element = $('<div class="fantabulous"></div>'),
          $tabbedContent = $('<div class="fantabulous-content"></div>');
      $element.insertBefore($(this).eq(0));
      $tabbedContent.appendTo($element);
      for (var i = 0; i < this.length; i += 1) {
        $tabbedContent.append(this[i]);
      }
      if ( !$.data($element, "plugin_" + pluginName) ) {
        $.data($element, "plugin_" + pluginName, new Plugin($element, options));
      }
      response = $element;
    }
    return response;
  };

})(jQuery, window, document);
;
/**
 * Infinity Carousel plugin.
 */
;(function($, window, document, undefined) {

  "use strict";


  var pluginName = "infinityCarousel",
    defaults = {
      overflow: true,
      slideDuration: 600,
      slidesToOffsetBy: 2,
      advanceToSlideClicked: true,
      offsetReferenceSelector: '#main',
      imageCachePresetRegExp: /files\/imagecache\/([^\/]+)/,
      // the entire plugin element
      carouselWidth: 980,
      carouselHeight: 400,
      // carousel slides
      carouselSlideWidth: 980,
      carouselSlideHeight: 400,
      // carousel filmstrip
      hasFilmstrip: true,
      filmstripWidth: 980,
      filmstripArrowWidth: 36,
      filmstripMarkersPerPage: 4,
      filmstripMarkerICP: 'thumbnail',
      hasFilmstripTitles: true,
      // autoSlide
      autoSlide: true,
      autoSlideDuration: 6000,
      // main carousel arrows
      hasCarouselArrows: true,
      hasStickyCarouselArrows: true
    };

  // Custom events declarations
  var SLIDE_CHANGED = 'slideChanged',
      SLIDE_CLICKED = 'slideClicked',
      AUTOSLIDE_COMPLETE = 'autoSlideComplete',
      FILMSTRIP_MARKER_CLICKED = 'filmstripMarkerClicked';

  /**
   * Infinity Carousel Plugin Model
   *
   * @param element {element}
   * @param options {Object}
   * @constructor
   */
  function Plugin(element, options) {
    this.element = element;
    this._name = pluginName;
    this._defaults = defaults;
    this.options = $.extend({}, defaults, options);

    // jQuery objects
    this.$window = $(window);
    this.$element = $(element);
    this.$offsetReference = this.getOffsetReference();
    this.$view = this.$element.find('.view');
    this.$nodes = this.$element.find('.node');
    this.$rows = this.$element.find('.views-row');
    this.$carousel = this.$element.find('.view-content');

    // Utility variables
    this.isMoving = false;
    this.currentSlide = 1;
    this.totalSlides = this.$nodes.length;
    this.isStatic = this.shouldCarouselBeStatic();

    // AutoSlider
    if (this.options.autoSlide) {
      this.autoSlider = new AutoSlider(this);
    }

    // Carousel Filmstrip
    if (this.options.hasFilmstrip) {
      this.filmstrip = new Filmstrip(this);
    }

    // Carousel Arrows
    if (this.options.hasCarouselArrows && !this.isStatic) {
      this.$arrows = this.addCarouselArrows();
    }

    this.init();
  }

  Plugin.prototype = {
    init: function() {
      var plugin = this;
      plugin.setStyles();
      plugin.labelSlides();
      plugin.setSlideOffset();
      plugin.addEventListeners();
      plugin.setCurrentIndex(plugin.currentSlide);
    },
    setCurrentIndex: function(index) {
      var plugin = this;

      if (index <= 0) {
        index = plugin.totalSlides;
      }
      else if (index > plugin.totalSlides) {
        index = 1;
      }

      plugin.currentSlide = index;
      plugin.setActiveClass(index);
      plugin.$element.trigger(SLIDE_CHANGED);
    },
    setActiveClass: function(index) {
      var plugin = this;
      plugin.$carousel.find('.slide').removeClass('active');
      plugin.$carousel.find('[data-slide=' + index + ']').addClass('active');
    },
    slideCarousel: function(event) {
      event.preventDefault();
      var plugin = event.data.scope;

      plugin.setCurrentIndex(plugin.currentSlide + 1);

      if (plugin.isStatic) {
        if (plugin.options.autoSlide && plugin.autoSlider.isRunning) {
          plugin.$element.trigger('mouseleave');
        }
      }
      else {
        plugin.isMoving = true;
        plugin.$carousel
          .css({left: 0})
          .stop(true, true)
          .animate({'left': -plugin.options.carouselSlideWidth}, plugin.options.slideDuration, function() {
            plugin.isMoving = false;
            plugin.goToNext(1);
            plugin.$carousel.css({left: 0});

            if (plugin.options.autoSlide && plugin.autoSlider.isRunning) {
              plugin.$element.trigger('mouseleave');
            }
          });
      }
    },
    goToNext: function(cycles) {
      var plugin = this;
      for (var i = 0; i < cycles; i += 1) {
        plugin.$carousel.find('.slide').eq(0).appendTo(plugin.$carousel);
      }
    },
    goToPrevious: function(cycles) {
      var plugin = this;
      for (var i = 0; i < cycles; i += 1) {
        plugin.$carousel.find('.slide').slice(-1).prependTo(plugin.$carousel);
      }
    },
    goToSpecific: function(event, data) {
      event.preventDefault();
      var plugin = event.data.scope,
        difference = data.difference,
        destination = data.destination,
        totalSlides = plugin.totalSlides,
        distance;

      // set the currentIndex
      plugin.setCurrentIndex(destination);

      // If the carousel is static, stop here. Don't advance the slides.
      if (plugin.isStatic) {
        return;
      }

      if (difference >= -(totalSlides/2) && (totalSlides/2) >= difference) {
        if (difference > 0) {
          distance = difference * plugin.options.carouselSlideWidth;
        }
        else {
          plugin.goToPrevious(-difference);
          distance = difference * plugin.options.carouselSlideWidth;
        }
      }
      else {
        if (difference > 0) {
          difference = (totalSlides - difference);
          plugin.goToPrevious(difference);
          distance = -difference * plugin.options.carouselSlideWidth;
        }
        else {
          difference = (difference + totalSlides);
          distance = difference * plugin.options.carouselSlideWidth;
        }
      }

      plugin.isMoving = true;

      if (distance > 0) {
        plugin.$carousel.css({left: 0}).animate({'left': -distance}, plugin.options.slideDuration, function() {
          plugin.$carousel.css({left: 0});
          plugin.goToNext(difference);
          plugin.isMoving = false;
        });
      }
      else {
        plugin.$carousel.css({left: distance}).animate({'left': 0}, plugin.options.slideDuration, function() {
          plugin.isMoving = false;
        });
      }
    },
    arrowClickEvent: function(event) {
      event.preventDefault();
      var plugin = event.data.scope;
      if (!plugin.isMoving) {
        plugin.isMoving = true;
        if (event.data.next) {
          plugin.setCurrentIndex(plugin.currentSlide + 1);
          plugin.$carousel.css({left: 0}).animate({'left': -plugin.options.carouselSlideWidth}, plugin.options.slideDuration, function() {
            plugin.isMoving = false;
            plugin.$carousel.css({left: 0});
            plugin.goToNext(1);
          });
        }
        else {
          plugin.setCurrentIndex(plugin.currentSlide - 1);
          plugin.goToPrevious(1);
          plugin.$carousel.css({left: -plugin.options.carouselSlideWidth}).animate({'left': 0}, plugin.options.slideDuration, function() {
            plugin.isMoving = false;
          });
        }
      }
    },
    slideClickEvent: function(event) {
      var plugin = event.data.scope,
        origin = plugin.currentSlide,
        destination = parseInt($(this).parents('.slide').attr('data-slide')),
        difference = destination - origin;

      if (difference !== 0) {
        event.preventDefault();
        if (!plugin.isMoving) {
          plugin.$element.trigger(SLIDE_CLICKED, {
            destination: destination,
            difference: difference
          });
        }
      }
    },
    shouldCarouselBeStatic: function() {
      var plugin = this,
        spaceAvailable = plugin.options.carouselWidth,
        spaceNeeded = plugin.totalSlides * plugin.options.carouselSlideWidth,
        result = false;

      if (spaceAvailable >= spaceNeeded) {
        result = true;
      }

      return result;
    },
    getOffsetReference: function() {
      var plugin = this,
        $element = $(plugin.options.offsetReferenceSelector);

      // if the passed reference isn't found, set the default
      if (!$element.length) {
        $element = $(defaults.offsetReferenceSelector);
      }

      // return only one element
      return $element.eq(0);
    },
    labelSlides: function() {
      // add data-slide attribute to all rows
      $.each(this.$rows, function(k, slide) {
        $(slide).attr('data-slide', k + 1).addClass('slide');
      });
    },
    setSlideOffset: function() {
      var plugin = this,
        offset = plugin.options.slidesToOffsetBy;

      if (!plugin.isStatic || offset > 0) {
        for (var i = 0; i < offset; i += 1) {
          plugin.$carousel.find('.slide').slice(-1).prependTo(plugin.$carousel);
        }

        plugin.$view.css({
          left: Math.ceil(-plugin.options.carouselSlideWidth * offset)
        });
      }
    },
    setStyles: function() {
      var plugin = this;

      plugin.$element.addClass('infinity-carousel');
      plugin.setCurrentIndex(plugin.currentSlide);

      if (!plugin.options.overflow) {
        if (!plugin.options.hasStickyCarouselArrows) {
          // unrestrict the plugin element
          plugin.$element.addClass('overflow');
        }
        // restrict the slide container
        plugin.$element.find('.block-inner').addClass('no-overflow').css({
          width: plugin.options.carouselWidth,
          height: plugin.options.carouselHeight
        });
      }

      plugin.$element.css({
        width:  plugin.options.carouselWidth,
        height: plugin.options.carouselHeight
      });

      plugin.$carousel.css({
        width: Math.ceil(plugin.totalSlides * plugin.options.carouselSlideWidth),
        height: plugin.options.carouselSlideHeight
      });

      plugin.$nodes.css({
        width: plugin.options.carouselSlideWidth,
        height: plugin.options.carouselSlideHeight
      });
    },
    resize: function(event) {
      var plugin = this;

      // IE and Safari fire this event continually, let's set a timeout
      plugin.$element.doTimeout('resizeCarousel', 250, function(){
        var totalWidth = $(document.body).width(),
          referenceWidth = plugin.$offsetReference.width();

        if (totalWidth < referenceWidth) {
          totalWidth = referenceWidth;
        }

        var offset = totalWidth/2 - referenceWidth/2,
          shift = referenceWidth/2 - plugin.options.carouselWidth/2;

        // centers content according to the reference and the slideWidth set.
        shift = offset + shift;

        // negative offsets the block container to the left edge of body.
        plugin.$element.width(totalWidth).css({left: -offset});
        plugin.$element.find('.block-inner').css({left: shift});

        // allows the navigation to stay within the width setting passed.
        if (!plugin.options.hasStickyCarouselArrows) {
          plugin.$element.find('.carousel-nav')
            .width(plugin.options.carouselWidth)
            .css({left: shift});
        }
      });
    },
    addEventListeners: function() {
      var plugin = this;

      // only add carousel marker and slide clicks if carousel is set to advance
      // and carousel isn't static
      if (!plugin.isStatic && plugin.options.advanceToSlideClicked) {
        plugin.$carousel.find('a').bind('click', {scope: plugin}, plugin.slideClickEvent);
      }

      // listen for the autoslide to complete
      if (plugin.options.autoSlide) {
        plugin.$element.bind(AUTOSLIDE_COMPLETE, {scope: plugin}, plugin.slideCarousel);
      }

      // Resize view on a window.resize event?
      if (plugin.options.hasStickyCarouselArrows || plugin.options.overflow) {
        $(window).bind('resize', {scope: plugin}, function(event) {
          plugin.resize(event);
        }).trigger('resize');
      }

      // Add filmstrip marker click event listener
      if (plugin.options.hasFilmstrip) {
        plugin.$element.bind(FILMSTRIP_MARKER_CLICKED, {scope: plugin}, plugin.goToSpecific);
      }

      if (!plugin.isStatic) {
        plugin.$element.bind(SLIDE_CLICKED, {scope: plugin}, plugin.goToSpecific);
      }
    },
    addCarouselArrows: function() {
      var $arrows = this.render('arrows');
      $arrows.prependTo(this.$element);
      return $arrows;
    },
    render: function(name, args, args2, args3) {
      var plugin = this,
        templates = {
          previous: function() {
            return $('<div class="arrow prev"><span>&lsaquo;</span></div>');
          },
          next: function() {
            return $('<div class="arrow next"><span>&rsaquo;</span></div>');
          },
          arrows: function() {
            var $arrows = $('<div class="carousel-nav"></div>'),
              $inner = $('<div class="nav-inner"></div>'),
              $prev = plugin.render('previous'),
              $next = plugin.render('next');
            $prev.appendTo($inner).bind('click', {scope: plugin, next: false}, plugin.arrowClickEvent);
            $next.appendTo($inner).bind('click', {scope: plugin, next: true }, plugin.arrowClickEvent);
            $inner.appendTo($arrows);
            return $arrows;
          }
        };

      return templates[name](args, args2, args3);
    }
  };

  /**
   * Filmstrip
   *
   * @param plugin {Plugin}
   * @constructor
   */
  function Filmstrip(plugin) {
    this.plugin = plugin;
    this.$element = plugin.$element;
    this.hasArrows = this.validateArrows();
    this.arrowOffset = this.getArrowsOffset();
    this.totalPages = this.getTotalPages();
    this.markerWidth = this.getMarkerWidth();
    this.$filmstrip = this.addFilmstrip();
    this.init();
  }

  Filmstrip.prototype = {
    init: function() {
      this.addEventListeners();
    },
    validateArrows: function() {
      var plugin = this.plugin;
      return plugin.totalSlides > plugin.options.filmstripMarkersPerPage;
    },
    getArrowsOffset: function() {
      var plugin = this.plugin,
        offset = plugin.options.filmstripArrowWidth * 2;
      return this.hasArrows ? offset : 0;
    },
    getTotalPages: function() {
      var plugin = this.plugin;
      return Math.ceil(plugin.totalSlides/plugin.options.filmstripMarkersPerPage);
    },
    getMarkerWidth: function() {
      var plugin = this.plugin;
      return Math.ceil((plugin.options.filmstripWidth - this.arrowOffset)/plugin.options.filmstripMarkersPerPage);
    },
    addFilmstrip: function() {
      var $filmstrip = this.render('filmstrip');
      $filmstrip.prependTo(this.$element);
      return $filmstrip;
    },
    move: function(event) {
      event.preventDefault();
      var self = event.data.scope,
        plugin = self.plugin,
        index = plugin.currentSlide,
        destination = Math.ceil(index/plugin.options.filmstripMarkersPerPage);

      if (destination !== self.currentPage) {
        if (destination > self.currentPage) {
          self.moveForward(destination);
        }
        else {
          self.moveBackward(destination);
        }
      }
      self.setActiveClass(index);
    },
    moveForward: function(destination) {
      var self = this,
        plugin = self.plugin,
        $content = self.$filmstrip.find('.markers-content'),
        distance = self.markerWidth * plugin.options.filmstripMarkersPerPage;

      if (destination <= self.totalPages) {
        self.currentPage = destination;
        $content.stop().animate({left: (destination - 1) * -distance}, plugin.options.slideDuration);
      }
      else {
        $content.stop().animate({left: -(distance * (self.totalPages - 1)) - 50}, 100, function() {
          $content.animate({left: -(distance * (self.totalPages - 1))}, 100);
        });
      }
    },
    moveBackward: function(destination) {
      var self = this,
        plugin = self.plugin,
        $content = self.$filmstrip.find('.markers-content'),
        distance = self.markerWidth * plugin.options.filmstripMarkersPerPage;

      if (destination > 0) {
        self.currentPage = destination;
        $content.stop().animate({left: (destination - 1) * -distance}, plugin.options.slideDuration);
      }
      else {
        $content.stop().animate({left: 50}, 100, function() {
          $content.animate({left: 0}, 100);
        });
      }
    },
    arrowClickEvent: function(event) {
      event.preventDefault();
      var self = event.data.scope;

      if (event.data.next) {
        self.moveForward(self.currentPage + 1);
      }
      else {
        self.moveBackward(self.currentPage - 1);
      }
    },
    markerClickEvent: function(event) {
      event.preventDefault();
      var self = event.data.scope,
        plugin = self.plugin,
        origin = plugin.currentSlide,
        destination = parseInt($(this).attr('data-marker')),
        difference = destination - origin;

      if (difference !== 0 && !plugin.isMoving) {
        self.$element.trigger(FILMSTRIP_MARKER_CLICKED, {
          destination: destination,
          difference: difference
        });
      }
    },
    setActiveClass: function(index) {
      this.$filmstrip.find('.marker').removeClass('active');
      this.$filmstrip.find('[data-marker=' + index + ']').addClass('active');
    },
    addEventListeners: function() {
      this.$element.bind(SLIDE_CHANGED, {scope: this}, this.move);
    },
    render: function(name, args, args2, args3) {
      var self = this,
        plugin = self.plugin,
        templates = {
          previous: function() {
            return $('<div class="arrow prev"><span>&lsaquo;</span></div>');
          },
          next: function() {
            return $('<div class="arrow next"><span>&rsaquo;</span></div>');
          },
          markers: function() {
            var $markers = $('<div class="markers"></div>'),
              $inner = $('<div class="markers-content"></div>');

            $.each(plugin.$nodes, function(key, node) {
              var $node  = $(node),
                $marker  = $node.find('.node-header a').clone().addClass('marker'),
                $imgWrap = $('<span class="marker-image"></span>'),
                $ttlWrap = $('<span class="marker-title"></span>'),
                $img     = $node.find('.field-image:first-child img').clone(),
                src      = $img.attr('src');
              $marker.attr('href', '#').attr('data-marker', key + 1).bind('click', {scope: self}, self.markerClickEvent);
              $img.attr('src', src.replace(plugin.options.imageCachePresetRegExp.exec(src)[1], plugin.options.filmstripMarkerICP));
              $marker.width(self.markerWidth);
              $marker.find('span.title').wrapAll($ttlWrap);
              if (!plugin.options.hasFilmstripTitles) {
                $marker.find('.marker-title').remove();
              }
              $img.appendTo($imgWrap);
              $imgWrap.prependTo($marker);
              $marker.appendTo($inner);
            });
            $inner.width(self.markerWidth * plugin.totalSlides);
            $inner.appendTo($markers);
            $markers.width(plugin.options.filmstripWidth - self.arrowOffset);
            return $markers;
          },
          filmstrip: function() {
            var $filmstrip = $('<div class="filmstrip-nav"></div>'),
              $inner = $('<div class="nav-inner"></div>'),
              $links = self.render('markers'),
              $prev  = self.render('previous'),
              $next  = self.render('next');
            if (self.hasArrows) {
              $prev.appendTo($inner).bind('click', {scope: self, next: false}, self.arrowClickEvent);
              $next.appendTo($inner).bind('click', {scope: self, next: true }, self.arrowClickEvent);
              $links.css({'margin': '0 ' + plugin.options.filmstripArrowWidth + 'px'});
            }
            $links.appendTo($inner);
            $inner.width(plugin.options.filmstripWidth).appendTo($filmstrip);
            return $filmstrip;
          }
        };

      return templates[name](args, args2, args3);
    }
  };

  /**
   * AutoSlider
   *
   * @param plugin {Plugin}
   * @constructor
   */
  function AutoSlider(plugin) {
    this.plugin = plugin;
    this.$element = plugin.$element;
    this.isRunning = false;
    this.init();
  }

  AutoSlider.prototype = {
    init: function() {
      this.addEventListeners();
      this.$element.trigger('mouseleave');
    },
    start: function(event) {
      var self = event.data.scope,
        plugin = self.plugin;
      self.isRunning = true;
      self.$element.doTimeout('autoSlide', plugin.options.autoSlideDuration, function() {
        self.$element.trigger(AUTOSLIDE_COMPLETE);
      });
    },
    stop: function(event) {
      var self = event.data.scope;
      self.isRunning = false;
      self.$element.doTimeout('autoSlide');
    },
    addEventListeners: function() {
      this.$element.bind('mouseleave', {scope: this}, this.start);
      this.$element.bind('mouseenter', {scope: this}, this.stop);
    }
  };

  $.fn[pluginName] = function (options) {
    return this.each(function () {
      if ( !$.data(this, "plugin_" + pluginName )) {
        $.data(this, "plugin_" + pluginName, new Plugin(this, options));
      }
    });
  };

})(jQuery, window, document);
;
/**
 * @plugin gallery
 * @desc Creates a slideshow of images by way of many structured template formats.
 * todo: extend this to be nodes and a full node page.
 * */
;(function($, window, document, undefined) {

  "use strict";

  var pluginName = "gallery",
    defaults = {
      autoPlay: true,
      width: null,
      height: null,
      duration: 600,
      aspectRatio: '4:3', // (default '4:3'), '3:4', '3:2', '1:1', '16:9'
      galleryBorderWidth: 5,
      slideshowDuration: 6000,
      navArrowWidth: 30,
      showProgressBar: true,
      filmstripMarkerWidth: 50,
      userInteruptsSlideshow: true,
      // sets alternate image cache preset's sizing for all image uses.
      imageSizing: {
        zoomed: 'lightbox',
        slide:  'gallery',
        marker: 'thumbnail'
      },
      // used to replace values from imageSizing within classes and src attr's.
      icpPathRegEx: /files\/imagecache\/([^\/]+)/,
      icpClassRegEx: /field-image-preset-([^ ]+)/
    };

  function Plugin(element, options) {
    this.element = element;
    this.$element = $(element);
    this._name = pluginName;
    this._defaults = defaults;
    this.options = $.extend({}, defaults, options);

    // allows for ratios or defined width/height's.
    if ( !this.options.width || !this.options.height ) {
      this.options.width = this.$element.width() - this.options.galleryBorderWidth * 2;
      switch (this.options.aspectRatio) {
        case '3:4' : this.options.height = this.options.width / 3 * 4;  break;
        case '3:2' : this.options.height = this.options.width / 3 * 2;  break;
        case '1:1' : this.options.height = this.options.width * 1.00;   break;
        case '16:9': this.options.height = this.options.width * 0.5625; break;
        default    : this.options.height = this.options.width * 0.75;
      }
    }

    this.$images = this.getImages();
    this.isPlaying = false;
    this.currentPage = 0;
    this.currentIndex = 0;
    this.currentCaption = '';
    this.totalImages = this.$images.length;
    this.markersPerPage = Math.floor((this.options.width - this.options.navArrowWidth * 2)/this.options.filmstripMarkerWidth);
    this.markerWidth = Math.floor((this.options.width - this.options.navArrowWidth * 2)/this.markersPerPage);
    this.pageWidth = this.markersPerPage * this.markerWidth;
    this.totalPages = Math.ceil(this.$images.length/this.markersPerPage);

    // creates the gallery.
    this.$gallery = this.render('gallery');
    this.$gallery.insertBefore(this.$images.eq(0));

    // wraps images with the gallery div.
    this.$galleryImages = this.render('galleryImages');
    this.$galleryImages.appendTo(this.$gallery);
    this.$images.appendTo(this.$galleryImages);

    // creates all buttons for the gallery controls.
    this.controls = this.render('controls');
    this.controls.$wrapper.appendTo(this.$gallery);

    // creates a caption container for passing captions for each image.
    this.$caption = this.render('caption');
    this.$caption.appendTo(this.$gallery);

    // creates a progress bar which visually animates the autoplay duration.
    this.$progress = this.render('progress');
    this.$progress.appendTo(this.$gallery);

    // creates a filmstrip and appends it to the gallery.
    this.$filmstrip = this.render('filmstrip');
    this.$filmstrip.appendTo(this.$gallery);

    // this is references the showcase which is used for zoom/lightbox feature.
    this.$showcase = this.render('showcase');

    // Add helper class to simplify gallery if there is only one image.
    if (this.totalImages <= 1) {
      this.$gallery.addClass('simple');
      // Assure elimination of the autoPlay feature.
      this.options.autoPlay = false;
    }

    // initialize.
    this.init();
  }

  Plugin.prototype = {
    init: function() {
      var plugin = this;

      // Fire up the carousel with the first indexed image.
      plugin.$filmstrip.find('.marker').eq(plugin.currentIndex).trigger('click');

      // Automatically start slideshow?
      if (plugin.options.autoPlay) {
        plugin.controls.$playBtn.trigger('click');
      }

      // set element resize event handler.
      plugin.$element.bind('resize.gallery', {scope: plugin}, plugin.events.resize);
    },
    // -------------------------------------------------------------------------
    // Smart get of image resources to use within the gallery.
    // -------------------------------------------------------------------------
    getImages: function() {
      var plugin = this, $images;
      $images = plugin.$element.find('.node-image .field-image, .node-upper-image .field-image');
      $images.each(function(key, image) {
        var $image = $(image),
          src, href, classes;
        src = $image.find('img').attr('src');
        href = $image.find('a').attr('href');
        classes = $image.attr('class');
        // swap out imagecache paths according to passed imageSizing options.
        $image.attr('class', classes.replace(plugin.options.icpClassRegEx.exec(classes)[1], plugin.options.imageSizing.slide));
        if ( !$image.hasClass('field-video') ) {
          $image.find('a').attr('href', href.replace(plugin.options.icpPathRegEx.exec(href)[1], plugin.options.imageSizing.zoomed));
        }
        $image.find('img').attr('src', src.replace(plugin.options.icpPathRegEx.exec(src)[1], plugin.options.imageSizing.slide));
      });

      // @todo: extend this to be nodes and a full node page.
      /*
       // node page
      if (plugin.$element.hasClass('node-full')) {
        // @note already implemented above ^
      }
      // views-blocks
      else if (plugin.$element.hasClass('views-block')) {
        $images = plugin.$element.find('.views-row');
      }
       */
      return $images;
    },
    // -------------------------------------------------------------------------
    // Sets plugin indexes for images and pages.
    // -------------------------------------------------------------------------
    setCurrentIndex: function(index) {
      var plugin = this;
      if (index <= 0) {
        index = plugin.totalImages;
      }
      else if (index > plugin.totalImages) {
        index = 1;
      }
      plugin.currentIndex = index;
      plugin.setActiveItems(index);
      var page = Math.ceil(index/plugin.markersPerPage);
      if (page !== plugin.currentPage) {
        plugin.gotoPage(page, false);
      }
      return index;
    },
    // -------------------------------------------------------------------------
    // Controls styling of active items.
    // -------------------------------------------------------------------------
    setActiveItems: function(index) {
      var plugin = this;
      // markers.
      plugin.$filmstrip.find('.active').removeClass('active');
      plugin.$filmstrip.find('.marker').eq(index - 1).addClass('active');
    },
    // -------------------------------------------------------------------------
    // Update current image.
    // -------------------------------------------------------------------------
    gotoImage: function(origin, destination, clickEvent) {
      var plugin = this,
        // -1 because the images are an array, index starts at 1.
        $origin = plugin.$images.eq(origin-1),
        $destination = plugin.$images.eq(destination-1);
      // resets the slideshow timer if caused by user interaction.
      if (clickEvent && plugin.isPlaying) {
        plugin.options.userInteruptsSlideshow
          ? plugin.controls.$pauseBtn.trigger('click')
          : plugin.options.userInteruptsSlideshow();
      }
      // shuffle images.
      $origin.css('z-index', 2).stop(true,true).animate({opacity:'hide'}, plugin.options.duration);
      $destination.css('z-index', 3).stop(true,true).animate({opacity:'show'}, plugin.options.duration);
      plugin.$images.not($origin).not($destination).css('z-index', 1).hide();
      // set caption.
      var $captionText = plugin.$caption.find('.gallery-caption-text'),
        prevHeight = $captionText.outerHeight();
      plugin.currentCaption = $destination.find('img').attr('title') || '';
      $captionText.stop(true,true).animate({opacity:'hide'}, plugin.options.duration/2, function() {
        $captionText.html(plugin.currentCaption);
        if (plugin.currentCaption.length > 0) {
          var newHeight = $captionText.outerHeight();
          plugin.$caption.height(prevHeight).stop(true,true).animate({height: newHeight}, plugin.options.duration/2);
          $captionText.animate({opacity:'show'}, plugin.options.duration/2);
        }
        else {
          plugin.$caption.stop(true,true).animate({height: 0}, plugin.options.duration/2);
        }
      });
    },
    // -------------------------------------------------------------------------
    // Update current filmstrip page.
    // -------------------------------------------------------------------------
    gotoPage: function(destination, clickEvent) {
      var plugin = this,
        origin = plugin.currentPage,
        difference = destination - origin,
        distance = plugin.markerWidth * plugin.markersPerPage,
        $content = plugin.$filmstrip.find('.markers-content'),
        duration = plugin.options.duration / 2,
        callback = function(){return true;};
      // resets the slideshow timer if caused by user interaction.
      if (clickEvent && plugin.isPlaying) {
        plugin.options.userInteruptsSlideshow
          ? plugin.controls.$pauseBtn.trigger('click')
          : plugin.options.userInteruptsSlideshow();
      }
      // is the destination greater than 1 page.
      if (difference <= -1 && difference >= 1) {
        distance = 0;
        if (difference > 0) {
          distance = -(plugin.totalPages - 1) * plugin.pageWidth;
        }
        duration = 50 * (plugin.totalPages - 1);
      }
      // next page.
      else if (destination > origin) {
        if (destination <= plugin.totalPages ) {
          distance = (destination - 1) * -distance;
        }
        else {
          duration = 100;
          distance = -(distance * (plugin.totalPages - 1)) - plugin.options.navArrowWidth;
          callback = function() {
            $content.animate({left: -(plugin.pageWidth * (plugin.totalPages - 1))}, 100);
          };
          destination = plugin.currentPage;
        }
      }
      // prev page.
      else if (destination < origin) {
        if (destination > 0) {
          distance = (destination - 1) * -distance;
        }
        else {
          duration = 100;
          distance = plugin.options.navArrowWidth;
          callback = function() {
            $content.animate({left: 0}, 100);
          };
          destination = plugin.currentPage;
        }
      }
      plugin.currentPage = destination;
      $content.animate({left: distance}, duration, callback);
    },
    // -------------------------------------------------------------------------
    // Slideshow Timer
    // -------------------------------------------------------------------------
    startSlideshowTimer: function() {
      var plugin = this;
      plugin.startProgressBar();
      $.doTimeout('slideshow', plugin.options.slideshowDuration, function() {
        var origin = plugin.currentIndex,
          destination = plugin.setCurrentIndex(plugin.currentIndex + 1);
        plugin.startProgressBar();
        plugin.gotoImage(origin, destination, false);
        return true;
      });
    },
    stopSlideshowTimer: function() {
      var plugin = this;
      $.doTimeout('slideshow');
      plugin.stopProgressBar();
    },
    // -------------------------------------------------------------------------
    // Progress Bar
    // -------------------------------------------------------------------------
    startProgressBar: function() {
      var plugin = this;
      if (plugin.options.showProgressBar) {
        plugin.$progress.width(0).show();
        plugin.$progress.stop(true).animate({width: plugin.options.width}, plugin.options.slideshowDuration, 'linear');
      }
    },
    stopProgressBar: function() {
      var plugin = this;
      if (plugin.options.showProgressBar) {
        plugin.$progress.stop(true,true).hide();
      }
    },
    // -------------------------------------------------------------------------
    // Event Handlers
    // -------------------------------------------------------------------------
    events: {
      resize: function(event) {
        console.log(event.type);
      },
      marker: function(event) {
        var plugin = event.data.scope,
          origin = plugin.currentIndex,
          destination = Number($(this).data('index'));
        if (origin != destination) {
          plugin.setCurrentIndex(destination);
          plugin.gotoImage(origin, destination, true);
        }
        event.preventDefault();
      },
      nextPage: function(event) {
        var plugin = event.data.scope;
        plugin.gotoPage(plugin.currentPage + 1, true);
      },
      prevPage: function(event) {
        var plugin = event.data.scope;
        plugin.gotoPage(plugin.currentPage - 1, true);
      },
      play: function(event) {
        var plugin = event.data.scope;
        if ( !plugin.isPlaying ) {
          $(this).hide();
          plugin.isPlaying = true;
          plugin.controls.$pauseBtn.show();
          plugin.startSlideshowTimer();
        }
      },
      pause: function(event) {
        var plugin = event.data.scope;
        if ( plugin.isPlaying ) {
          $(this).hide();
          plugin.isPlaying = false;
          plugin.controls.$playBtn.show();
          plugin.stopSlideshowTimer();
        }
      },
      prev: function(event) {
        var plugin = event.data.scope,
          origin = plugin.currentIndex,
          destination = plugin.setCurrentIndex(plugin.currentIndex - 1);
        plugin.gotoImage(origin, destination, true);
      },
      next: function(event) {
        var plugin = event.data.scope,
          origin = plugin.currentIndex,
          destination = plugin.setCurrentIndex(plugin.currentIndex + 1);
        plugin.gotoImage(origin, destination, true);
      },
      zoom: function(event) {
        var plugin = event.data.scope;
        // fire off the lightbox2 behavior.
        plugin.$images.eq(plugin.currentIndex-1).find('a').trigger('click');
      }
    },
    // -------------------------------------------------------------------------
    // jQuery Template Renderer
    // -------------------------------------------------------------------------
    render: function(name, args, args2, args3) {
      var plugin = this,
      templates = {
        gallery: function() {
          var $gallery = $('<div class="gallery"></div>');
          $gallery
            .addClass(pluginName)
            .width(plugin.options.width)
            .height(plugin.options.height)
            .css({
              border: plugin.options.galleryBorderWidth + 'px solid white',
              'margin-bottom': (plugin.options.galleryBorderWidth + 75) + 'px'
            });
          return $gallery;
        },
        galleryImages: function() {
          return $('<div class="gallery-images"></div>');
        },
        caption: function() {
          return $('<div class="gallery-caption"><div class="gallery-caption-text"></div></div>');
        },
        showcase: function() {
          var $showcase = $('#gallery-showcase');
          if ($showcase.length <= 0) {
            $showcase = $('<div id="gallery-showcase"></div>');
            plugin.$element.parents('body').append($showcase);
          }
          return $showcase;
        },
        button: function(type) {
          return $('<div class="btn-'+type+'"><span></span></div>');
        },
        controls: function() {
          var $wrapper = $('<div class="gallery-controls"></div>'),
            buttons = ['pause', 'play', 'zoom', 'next', 'prev'],
            controls = {};
          $.each(buttons, function(key, type) {
            var $btn = plugin.render('button', type);
            $btn.bind('click', {scope: plugin}, plugin.events[type]);
            $btn.appendTo($wrapper);
            controls['$'+type+'Btn'] = $btn;
          });
          controls.$wrapper = $wrapper;
          return controls;
        },
        markers: function() {
          var $markers = $('<div class="markers"></div>'),
            $inner = $('<div class="markers-content"></div>');
          $.each(plugin.$images, function(key, image) {
            var $marker = $('<a href="#" class="marker"></a>'),
              $wrap = $('<span class="marker-image"></span>'),
              $image = $(image).find('img').clone(),
              src = $image.attr('src');
            $image.attr('src', src.replace(plugin.options.icpPathRegEx.exec(src)[1], plugin.options.imageSizing.marker));
            $marker.data('index', key+1).width(plugin.markerWidth).bind('click', {scope: plugin}, plugin.events.marker);
            $image.prependTo($wrap);
            $wrap.prependTo($marker);
            $marker.appendTo($inner);
          });
          $inner.width(Math.ceil(plugin.pageWidth * plugin.totalPages));
          $inner.appendTo($markers);
          $markers.width(plugin.options.width - (plugin.options.navArrowWidth * 2));
          return $markers;
        },
        filmstrip: function() {
          var $filmstrip = $('<div class="gallery-filmstrip"></div>'),
            $inner = $('<div class="gallery-filmstrip-inner"></div>'),
            $links = plugin.render('markers'),
            $prev  = plugin.render('button', 'prev-page'),
            $next  = plugin.render('button', 'next-page');
          if (plugin.totalImages > 1) {
            $prev.appendTo($inner).bind('click', {scope: plugin}, plugin.events.prevPage);
            $next.appendTo($inner).bind('click', {scope: plugin}, plugin.events.nextPage);
            plugin.controls.$prevPageBtn = $prev;
            plugin.controls.$nextPageBtn = $next;
            $links.css({'margin': '0 '+plugin.options.navArrowWidth+'px'});
          }
          $inner.css({top: plugin.options.galleryBorderWidth+'px'});
          $links.appendTo($inner);
          $inner.appendTo($filmstrip);
          return $filmstrip;
        },
        progress: function() {
          return $('<div class="gallery-progress"></div>');
        }
      };

      return templates[name](args, args2, args3);
    }
  };

  $.fn[pluginName] = function (options) {
    return this.each(function () {
      if ( !$.data(this, "plugin_" + pluginName )) {
        $.data(this, "plugin_" + pluginName, new Plugin(this, options));
      }
    });
  };

})(jQuery, window, document);
;
Drupal.behaviors.ddAddDateToCalendarWidget = function(context) {
  if (Drupal.settings.ddCreate && Drupal.settings.ddCreate.addDateToCalendarWidget) {
    var attach = function() {
      $('#calpopup .node-teaser:has(.first-upcoming):not(:has(a.add))').each(function() {
        var $teaser = $(this);
        var $date = $teaser.find(".first-upcoming");
        var nodeId = $teaser.attr("id").replace(/(node-)|(-teaser)/g, "");

        var $addLink = $('<a class="add"></a>');
        var $addPopup = $('<div class="add-calendar-popup">Loading...</div>');

        $date.append($addLink).append($addPopup);
        $addLink.toggle(function() {
          // Hide any existing popups.
          $('.add-calendar-popup:visible').fadeOut('fast');

          $addPopup.fadeIn("fast").load(Drupal.settings.basePath + 'node/' + nodeId + ' #block-dd_create-calendar', function() {
            $addPopup.find("a").attr("target", "_blank");
          });
        }, function() {
          $addPopup.fadeOut("fast");
        });
      });
    };

    attach();

    $(document).ajaxComplete(function() {
      attach();
    });
  }
};

/**
 * Handles adding the "node-advanced" class to navigation terms which should be
 * hidden on the node edit/create form.
 */
Drupal.behaviors.ddNavTermVisibility = function(context) {
  if (Drupal.settings.pt_nav_terms_hidden) { 
    var el = $('#edit-taxonomy-2-wrapper', context);
    for (var i = 0; i < Drupal.settings.pt_nav_terms_hidden.length; i++) {
      var tid = Drupal.settings.pt_nav_terms_hidden[i]; 
      var li = $('#edit-taxonomy-2-' + tid).parents('li');
      if (li.length) {
        $(li[0]).addClass('node-advanced');
      }
    }
  }
};

/**
 * Handles the cloning form elements visiblity.
 */
Drupal.behaviors.ddClonePostVisibility = function(context) {
  if (Drupal.settings.clone_post) {
    // Hide tabs.
    $('.tabs').css("display","none");
  }
};

/**
 * Disable URL Alias and show warning message when creating/editing overviews.
 */
Drupal.behaviors.ddOverviewVisibility = function(context) {
  var urlAlias = $('.vertical-tabs-path', context);
  var clonedUrlAlias = urlAlias.html();
  var postSelect = $('#edit-taxonomy-1');
  var warningMessage = "URL aliases should be added to the navigation term, not the Overview post. <a href='https://support.digitaldeployment.com/support/solutions/articles/4000085428-advanced-creating-custom-urls-for-posts-and-url-aliases-for-navigation-terms-'>Learn how to create URL aliases for navigation terms</a>.";

  var postType = postSelect.find(":selected").text();
  if(postType == 'Overview') {
    urlAlias.html('<div style="white-space: normal;" class="messages warning no-attachment-text disable-url">' + warningMessage + '</div>');
  }

  // On post type change.
  postSelect.change(function() {
    if($(this).find(":selected").text() == 'Overview') {
      $('.vertical-tabs-path').html('<div style="white-space: normal;" class="messages warning no-attachment-text disable-url">' + warningMessage + '</div>');
    }
    else {
      $('.vertical-tabs-path').html(clonedUrlAlias);
      // Remove the additional legend.
      $('.vertical-tabs-path').find('legend').remove();
    }
  });

  $(".disable-url").unbind( "click" );
};

/**
 * Show Visibility to unauthorized users when we have peeking enabled.
 */
Drupal.behaviors.VisibillityUnauthorizedUsers= function(context) {
  var accessDefaultt = $('#edit-dd-access-default', context);
  var accessEveryone = $('#edit-dd-access-rids-0', context);
  var visibilityDiv = $('#edit-dd-access-peeking-wrapper', context);

  // Default state.
  if(accessEveryone.is(':checked')) {
    visibilityDiv.hide();
  }

  // Everyone change
  accessEveryone.change(function() {
    if(!$(this).is(":checked")) {
      visibilityDiv.show();
    }
    else {
      visibilityDiv.hide();
    }
  });

  // Default change
  accessDefaultt.change(function() {
    if(accessEveryone.is(":checked")) {
      visibilityDiv.hide();
    }
    else {
      visibilityDiv.show();
    }
  });
};

/**
 * Autocomplete the calendar end date.
 */
Drupal.behaviors.setCalendarEndDate = function(context) {
  $("input[name^='field_date['][name*='[value]']", context).change(function autocompleteEndDate() {
    // Only get the date field.
    if($(this).hasClass('hasDatepicker')) {
      const name = this.name.split('[');
      const fieldId = name[1].split(']');
      $("input[name='field_date["+ fieldId[0] +"][value2][date]']").val($(this).val());
    }
  });
};

/**
 * Handles temporary lat/lon field to be displayed under location.
 */
Drupal.behaviors.LatitudeLongitudeFields = function(context) {
  var latitude = $('#edit-location-x-wrapper');
  var longitude = $('#edit-location-y-wrapper');
  var locationField = $('#edit-field-location-0-text');
  // Place the inputs.
  longitude.insertBefore(locationField);
  latitude.insertBefore(locationField);
  // Display them.
  latitude.css('display','inline-block');
  longitude.css('display','inline-block');
};
;
Drupal.behaviors.ddLoginInit = function(context) {
  var $loginBlock = $('body.not-logged-in #block-dd_login-login', context);
  if ($loginBlock.size() == 0) {
    return;
  }

  $loginBlock.dialog({ modal: true, height: 'auto', autoOpen: false, dialogClass: 'dd-login'}); 

  $("body.not-logged-in a[href$='/user/login'], body.not-logged-in a[href$='/user']", context).click(function() {
    openLoginDialog();
    return false;
  });

  if (location.hash == '#dd-login') {
    openLoginDialog();
  }

  function openLoginDialog() {
    // Redirect to HTTPS, if necessary.
    if (Drupal.settings.ddForceHttpsAuthenticated && location.protocol != 'https:') {
      location.assign('https://' + location.hostname + location.pathname + location.search + '#dd-login');
      return;
    }

    $loginBlock.dialog('open');
    $loginBlock.find('#edit-name').focus();
  }
};
;
/**
 * Creates an anchor which can eliminate the nomobile cookie thus restoring
 * the mobile device auto redirection behavior.
 */
Drupal.behaviors.ddMobileAddBackToMobileButton = function(context) {
  if (ddMobileGetBackToMobile) {
    var $viewMobile = $('<div class="view-mobile"></div>'),
      $link = $('<a>View in mobile</a>');
    $link.attr('href', window.location.pathname + window.location.search + '#viewmobile');

    // Control the links click event.
    $link.click(function(event) {
      event.preventDefault();
      window.location.href = $(this).attr('href');
      window.location.reload();
    });

    // Append the link to the view mobile container.
    $link.appendTo($viewMobile);
    // Append view mobile element to the document body.
    $viewMobile.appendTo(document.body, context);
  }
};
;
Drupal.behaviors.ddPoll = function(context) {
  // Optimization: first search for .dd-poll-node, then search for the rest.
  $('.dd-poll-node', context).each(function() {
    var $node = $(this);

    if ($node.find('.vote form').length) {
      new Drupal.ddPollNodeVote($node);
    }
    else if ($node.find('.results table').length) {
      new Drupal.ddPollNodeResults($node);
    }
  });

  // Draw charts, if any, once all other behaviors are done processing.
  setTimeout(function() {
    Drupal.ddPollNodeResultsGraph.ready = true;
    Drupal.ddPollNodeResultsGraph.drawCharts();
  }, 0);
};

Drupal.ddPollNodeVote = function($element) {
  var self = this;
  this.$element = $element;
  this.nid = this.$element.find('input[name=nid]').val();
  this.vid = this.getVid();

  // If we couldn't establish a unique voter ID, leave the poll disabled.
  if (!this.vid) {
    this.$element.addClass('initialized');
    return;
  }

  // Enable the poll.
  this.setMessage();

  // Enable the submit button.
  this.$element.find('input.form-submit')
    .attr('disabled', false)
    .attr('data-disabled', false);

  // Remove the dd_mobile 'disabled' button theme.
  this.$element.find('.ui-submit')
    .removeClass('ui-disabled')
    .attr('aria-disabled', false)
    .attr('data-disabled', false);

  this.$element.addClass('initialized');

  // Load the poll results if the voter has already voted for this poll.
  var nids = self.getVotedNids();

  if ($.inArray(this.nid, nids) != -1) {
    this.$element.addClass('in-progress');

    // Request the results.
    $.ajax({
      type: "GET",
      url: Drupal.settings.ddPoll['resultsURI'],
      data: { nid: this.nid, vid: this.vid },
      dataType: 'html',
      success: function(data) {
        self.setResults(data);
      },
      complete: function() {
        self.$element.removeClass('in-progress');
      }
    });
  }

  // Submit the vote when the form is submitted.
  this.$element.find('form').submit(function() {
    var $form = $(this);

    // Throw a fit if no answer has been selected.
    if ($form.find('input[name=aid]:checked').length == 0) {
      self.setMessage('Please select an answer in order to vote.', 'warning');
      return false;
    }

    // Populate the voter ID.
    $form.find('input[name=vid]').val(self.vid);

    // Disable the submit button.
    $form.find('input.form-submit')
      .attr('disabled', true)
      .attr('data-disabled', true);

    // Adds the dd_mobile 'disabled' button theme.
    $form.find('.ui-submit')
      .addClass('ui-disabled')
      .attr('aria-disabled', true)
      .attr('data-disabled', true);

    // Show something's going on.
    self.$element.addClass('in-progress');

    $.ajax({
      type: "POST",
      url: $form.attr('action'),
      data: $form.serialize(),
      dataType: 'json',
      success: function(data) {
        // Remember this poll has been voted on.
        if (data['voted']) {
          var nids = self.getVotedNids();

          if ($.inArray(self.nid, nids) == -1) {
            nids.push(self.nid);
          }

          self.setVotedNids(nids);
        }

        // Show a message, if necessary.
        if (data['message'] && data['messageType']) {
          self.setMessage(data['message'], data['messageType']);
        }

        // Show the poll results, if available.
        if (data['results']) {
          self.setResults(data['results']);
        }
      },
      complete: function() {
        self.$element.removeClass('in-progress');
      }
    });

    return false;
  });
};

Drupal.ddPollNodeVote.prototype.setMessage = function(message, type) {
  var $element = this.$element.find('div.message');

  // Reset the message element's classes.
  $element.attr('class', '');
  $element.addClass('message');

  // Set the message.
  if (message) {
    $element.html(message);

    if (!type) {
      type = 'notice';
    }
    $element.addClass('message-' + type);
  }
  else {
    $element.empty();
  }
};

Drupal.ddPollNodeVote.prototype.setResults = function(results) {
  this.$element.find('div.vote').empty();
  this.$element.find('div.results').empty();
  this.$element.find('div.results').append(results);

  new Drupal.ddPollNodeResults(this.$element);
};

Drupal.ddPollNodeVote.prototype.getVid = function() {
  var vid = this.getPrimitiveVid();

  if (!vid) {
    var randomVid = this.generateRandomVid();
    this.setVid(randomVid);

    // Check whether we were actually able to save the
    if (this.getPrimitiveVid() == randomVid) {
      vid = randomVid;
    }
  }

  return vid;
};

Drupal.ddPollNodeVote.prototype.generateRandomVid = function() {
  // Generates a random two-byte integer.
  var randomWord = function() {
    return (Math.random() * 0x10000) | 0;
  };

  // Formats a two-byte integer into a padded hex string.
  var formatWord = function(word) {
    var string = word.toString(16);
    while (string.length < 4) string = '0' + string;
    return string;
  };

  // Generate a v4 UUID.
  var words = [null, null, null, null, null, null, null, null];
  words = $.map(words, randomWord);
  words[3] = words[3] & 0x0FFF | 0x4000;
  words[4] = words[4] & 0x3FFF | 0x8000;

  return $.map(words, formatWord).join('');
};

Drupal.ddPollNodeVote.prototype.setVid = function(vid) {
  if (typeof window.localStorage != 'undefined') {
    window.localStorage.setItem('VSESSIONID', vid);
  }
  else {
    document.cookie = "VSESSIONID=" + vid + "; expires=Sat, 1 Jan 2050 00:00:00 UTC; path=/";
  }
};

Drupal.ddPollNodeVote.prototype.getPrimitiveVid = function() {
  var vid = undefined;

  if (typeof window.localStorage != 'undefined') {
    vid = window.localStorage.getItem('VSESSIONID');
  }

  if (vid === undefined) {
    var name = "VSESSIONID=";

    $.each(document.cookie.split(';'), function(index, cookie) {
      cookie = $.trim(cookie);

      if (cookie.indexOf(name) == 0) {
        vid = cookie.substring(name.length, cookie.length);
      }
    });
  }

  if (typeof(vid) != 'string' || vid.length != 32) {
    vid = undefined;
  }

  return vid;
};

Drupal.ddPollNodeVote.prototype.setVotedNids = function(nids) {
  if ((typeof window.localStorage != 'undefined') && (typeof window.JSON != 'undefined')) {
    window.localStorage.setItem('ddPollVotedNids', JSON.stringify(nids));
  }
  else {
    document.cookie = "ddPollVotedNids=" + nids.join(',') + "; expires=Sat, 1 Jan 2050 00:00:00 UTC; path=/";
  }
};

Drupal.ddPollNodeVote.prototype.getVotedNids = function() {
  var nids = undefined;

  if ((typeof window.localStorage != 'undefined') && (typeof window.JSON != 'undefined')) {
    try {
      nids = JSON.parse(window.localStorage.getItem('ddPollVotedNids'));
    }
    catch(e) {
      // Ignore
    }
  }

  if (nids == undefined) {
    var name = "ddPollVotedNids=";

    $.each(document.cookie.split(';'), function(index, cookie) {
      cookie = $.trim(cookie);

      if (cookie.indexOf(name) == 0) {
        nids = cookie.substring(name.length, cookie.length);
      }
    });

    if (nids) {
      nids = nids.split(',');
    }
  }

  if (typeof(nids) != 'object' || !(nids instanceof Array)) {
    nids = [];
  }

  return nids;
};

Drupal.ddPollNodeResults = function($element) {
//  var self = this;
  this.$element = $element;

  // Add this to the array of results to be graphed and trigger them to be
  // drawn.
  Drupal.ddPollNodeResultsGraph.results.push(this);
  Drupal.ddPollNodeResultsGraph.drawCharts();

  $element.addClass('initialized');
};

Drupal.ddPollNodeResults.prototype.drawChart = function() {
  //noinspection JSUnresolvedFunction,JSUnresolvedVariable
  var data = new google.visualization.DataTable();
  //noinspection JSUnresolvedFunction
  data.addColumn('string', 'Answer');
  //noinspection JSUnresolvedFunction
  data.addColumn('number', 'Votes');

  var $table = this.$element.find('table.dd-poll-results');

  $table.find('tbody tr').each(function() {
    var $columns = $(this).find('td');

    if ($columns.length == 2) {
      var answer = $columns.eq(0).text();
      var percent = parseFloat($columns.eq(1).text().replace('%', ''));
      //noinspection JSUnresolvedFunction
      data.addRow([answer, percent]);
    }
  });

  var options = {
    width: '100%',
    height: 200,
    chartArea: {
      width: '100%'
    },
    legend: {
      position: 'bottom'
    },
    tooltip: {
      text: 'percentage'
    },
    backgroundColor: 'transparent',
    // So that slices with 0 votes still show up in the legend.
    sliceVisibilityThreshold: 0
  };

  if (Drupal.ddPollNodeResultsGraphOptionsAlter) {
    Drupal.ddPollNodeResultsGraphOptionsAlter(this.$element, options);
  }

  // Make a div to hold the chart, replacing the table.
  var $chartDiv = $('<div></div>');
  $table.css('display', 'none').after($chartDiv);

  //noinspection JSUnresolvedFunction,JSUnresolvedVariable
  var chart = new google.visualization.PieChart($chartDiv.get(0));
  //noinspection JSUnresolvedFunction
  chart.draw(data, options);
};

Drupal.ddPollNodeResultsGraph = {
  // Wether all graphs have been initialized.
  ready: false,
  // Whether the graph API has been loaded.
  prepared: false,
  // The results that need to be graphed.
  results: []
};

Drupal.ddPollNodeResultsGraph.prepareCharts = function() {
  // Don't attempt to load the API more than once.
  if (Drupal.ddPollNodeResultsGraph.prepared) {
    return;
  }

  var autoload = '{"modules":[{"name":"visualization","version":"1.0","packages":["corechart"],"callback":"Drupal.ddPollNodeResultsGraph.chartsPrepared"}]}';

  // We don't use $.getScript, because it does unnecessary cache breaking.
  $.ajax({
    url: 'https://www.google.com/jsapi?autoload=' + encodeURIComponent(autoload),
    dataType: 'script',
    cache: true
  });
};

Drupal.ddPollNodeResultsGraph.chartsPrepared = function() {
  // Now that the graph API has been loaded, re-trigger graphs to be drawn.
  Drupal.ddPollNodeResultsGraph.prepared = true;
  Drupal.ddPollNodeResultsGraph.drawCharts();
};

Drupal.ddPollNodeResultsGraph.drawCharts = function() {
  // Abort if we're not ready yet or if there's nothing to draw.
  if (!Drupal.ddPollNodeResultsGraph.ready || Drupal.ddPollNodeResultsGraph.results.length == 0) {
    return;
  }

  // Load the graph API first, if necessary.
  if (!Drupal.ddPollNodeResultsGraph.prepared) {
    Drupal.ddPollNodeResultsGraph.prepareCharts();
    return;
  }

  while (Drupal.ddPollNodeResultsGraph.results.length > 0) {
    Drupal.ddPollNodeResultsGraph.results.pop().drawChart();
  }
};
;
Drupal.behaviors.ddShareThisAttachLinks = function(context) {
  var $links = $(".link.dd-share-this a", context).not('.dd-share-this-processed');
  
  $links.click(function(e) {
    // Quickly run the script only after the ShareThis link is clicked
    $(this).html("<span class='st_sharethis' displayText='ShareThis'>ShareThis</span>");
    $(this).addClass('loading');
    
    // Add global variable used by ShareThis to determine version number
    window.switchTo5x = false;
    
    // Add script asynchonously
    var s = document.createElement('script');
    s.type = 'text/javascript';
    s.src = 'http://w.sharethis.com/button/buttons.js';
    this.parentNode.appendChild(s, this);
    
    //Then, hover over the invisible ShareThis widget to open the box after it had time to load
    window.setTimeout(function() {$(".st_sharethis").trigger('mouseover'); $links.removeClass('loading')}, 1000);
    
    // Ensure this isn't run again
    $(this).unbind('click');
    $(this).click(function(e) {
      // but keep preventDefault behavior on the link in case it is used again
      e.preventDefault();
    });
    e.preventDefault();
  });
  
  $links.addClass('dd-share-this-processed');
};;
// Get all cookieconsent cookies on a a site.
function getAllConsentCookies() {
  var theCookies = document.cookie.split(';');
  var cookieconsent_cookies = [];

  $.each( theCookies, function( key, value ) {
    // if(value.includes('cookieconsent_status_')) { // fix this for IE 11 on Win 7
    if(value.indexOf('cookieconsent_status_') > -1) {
      cookieconsent_cookies.push(value.split("=")[0].replace(/ /g,''));
    }
  });
  return cookieconsent_cookies;
}

// Retrieve an array key out of Drupal.settings.dd_sitewide_message_notification for a specific cookie.
function getArrayKey(name) {
  var cookie_key = null;

  $.each(Drupal.settings.dd_sitewide_message_notification.dd_sitewide_message_cookie_name, function( key, value ) {
    if(value == name) {
      cookie_key = key;
    }
  });
  return cookie_key;
}

// Get a cookie by name
function getCookie(name) {
  var value = "; " + document.cookie;
  var parts = value.split("; " + name + "=");
  if (parts.length == 2) return parts.pop().split(";").shift();
}

// Delete a cookie by setting expire date to the past.
function deleteCookie(name) {
  document.cookie = name +'=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';
}

Drupal.behaviors.dd_sitewide_message_reset_notifications = function (context) {
  // Check if we have any data.
  if( typeof Drupal.settings.dd_sitewide_message_notification === "undefined") {
    return;
  }

  // Iterate over cookie consent cookies and check if needs to be reset.
  $.each( getAllConsentCookies(), function( key, value ) {
    var existing_cookie_version = getCookie(value).split(',')[1];
    var cookieArrayKey = getArrayKey(value);
    var cookie_version = Drupal.settings.dd_sitewide_message_notification.dd_sitewide_message_cookie_version;

    // Check if we have more than one message.
    if (typeof(cookie_version) === 'object') {
      current_cookie_version = cookie_version[cookieArrayKey];
    } else {
      current_cookie_version = cookie_version;
    }

    // Delete the cookie so it will re-appear.
    if (existing_cookie_version != current_cookie_version) {
      deleteCookie(value);
    }
  });
};
;
Drupal.behaviors.ddTwitterFeed = function(context) {
  var $feedBlock = $('.dd-twitter-feed', context);
  // See if there is a DD Twitter Feed Block present.
  if ($feedBlock.length > 0) {
    new Drupal.DDTwitterFeedTweets($feedBlock);
  }
};

Drupal.DDTwitterFeedTweets = function($element) {
  var self = this;
  this.$element = $element;

  // Add helper class for theming the load of tweets.
  this.$element.addClass('loading-tweets');

  // Request the tweets.
  $.ajax({
    type: 'GET',
    cache: true,
    url: Drupal.settings.ddTwitterFeed['getTweetsURI'],
    dataType: 'html',
    success: function(data) {
      self.$element.find('.dd-twitter-feed-tweets').html(data);
      self.animateResults();
    },
    complete: function() {
      self.$element.removeClass('loading-tweets');
    }
  });
};

Drupal.DDTwitterFeedTweets.prototype.animateResults = function() {
  var $tweets = this.$element.find('.dd-twitter-feed-tweet'),
        count = 0,
        total = $tweets.length,
        delay = 5500;

  // show the first tweet.
  $tweets.eq(count).show();

  // only animate if there is more than one tweet.
  if (total > 1) {
    window.setInterval(function() {
      // fade out current tweet.
      $tweets.eq(count).animate({opacity:'hide'}, 200, function() {
        count++;
        // keeps count in bounds.
        if (count >= total) count = 0;
        // fade in the next tweet.
        $tweets.eq(count).animate({opacity:'show'}, 300);
      });
    }, delay);
  }
};
;
// $Id: extlink.js,v 1.4.2.12 2010/05/26 01:25:56 quicksketch Exp $

// This is unnecessary and breaks webwraps in IE
//(function ($) {

function extlinkAttach(context) {
  // Strip the host name down, removing ports, subdomains, or www.
  var pattern = /^(([^\/:]+?\.)*)([^\.:]{4,})((\.[a-z]{1,4})*)(:[0-9]{1,5})?$/;
  var host = window.location.host.replace(pattern, '$3$4');
  var subdomain = window.location.host.replace(pattern, '$1');

  // Determine what subdomains are considered internal.
  if (Drupal.settings.extlink.extSubdomains) {
    var subdomains = "([^/]*\\.)?";
  }
  else if (subdomain == 'www.' || subdomain == '') {
    var subdomains = "(www\\.)?";
  }
  else {
    var subdomains = subdomain.replace(".", "\\.");
  }

  // Build regular expressions that define an internal link.
  var internal_link = new RegExp("^https?://" + subdomains + host, "i");

  // Extra internal link matching.
  var extInclude = false;
  if (Drupal.settings.extlink.extInclude) {
    extInclude = new RegExp(Drupal.settings.extlink.extInclude.replace(/\\/, '\\'));
  }

  // Extra external link matching.
  var extExclude = false;
  if (Drupal.settings.extlink.extExclude) {
    extExclude = new RegExp(Drupal.settings.extlink.extExclude.replace(/\\/, '\\'));
  }

  // Find all links which are NOT internal and begin with http (as opposed
  // to ftp://, javascript:, etc. other kinds of links.
  // When operating on the 'this' variable, the host has been appended to
  // all links by the browser, even local ones.
  // In jQuery 1.1 and higher, we'd use a filter method here, but it is not
  // available in jQuery 1.0 (Drupal 5 default).
  var external_links = new Array();
  var mailto_links = new Array();
  $("a:not(." + Drupal.settings.extlink.extClass + ", ." + Drupal.settings.extlink.mailtoClass + ")", context).each(function(el) {
    try {
      var url = this.href.toLowerCase();
      if (url.indexOf('http') == 0 && (!url.match(internal_link) || (extInclude && url.match(extInclude))) && !(extExclude && url.match(extExclude))) {
        external_links.push(this);
      }
      else if (url.indexOf('mailto:') == 0) {
        mailto_links.push(this);
      }
    }
    // IE7 throws errors often when dealing with irregular links, such as:
    // <a href="node/10"></a> Empty tags.
    // <a href="http://user:pass@example.com">example</a> User:pass syntax.
    catch(error) {
      return false;
    }
  });

  if (Drupal.settings.extlink.extClass) {
    // Apply the "ext" class to all links not containing images.
    if (parseFloat($().jquery) < 1.2) {
      $(external_links).not('[img]').addClass(Drupal.settings.extlink.extClass).each(function() { if ($(this).css('display') == 'inline') $(this).after('<span class=' + Drupal.settings.extlink.extClass + '></span>'); });
    }
    else {
      $(external_links).not($(external_links).find('img').parents('a')).addClass(Drupal.settings.extlink.extClass).each(function() { if ($(this).css('display') == 'inline') $(this).after('<span class=' + Drupal.settings.extlink.extClass + '></span>'); });
    }
  }

  if (Drupal.settings.extlink.mailtoClass) {
    // Apply the "mailto" class to all mailto links not containing images.
    if (parseFloat($().jquery) < 1.2) {
      $(mailto_links).not('[img]').addClass(Drupal.settings.extlink.mailtoClass).each(function() { if ($(this).css('display') == 'inline') $(this).after('<span class=' + Drupal.settings.extlink.mailtoClass + '></span>'); });
    }
    else {
      $(mailto_links).not($(mailto_links).find('img').parents('a')).addClass(Drupal.settings.extlink.mailtoClass).each(function() { if ($(this).css('display') == 'inline') $(this).after('<span class=' + Drupal.settings.extlink.mailtoClass + '></span>'); });
    }
  }

  if (Drupal.settings.extlink.extTarget) {
    // Apply the target attribute to all links.
    $(external_links).attr('target', Drupal.settings.extlink.extTarget);
  }

  if (Drupal.settings.extlink.extAlert) {
    // Add pop-up click-through dialog.
    $(external_links).click(function(e) {
     return confirm(Drupal.settings.extlink.extAlertText);
    });
  }

  // Work around for Internet Explorer box model problems.
  if (($.support && !($.support.boxModel === undefined) && !$.support.boxModel) || ($.browser.msie && parseInt($.browser.version) <= 7)) {
    $('span.ext, span.mailto').css('display', 'inline-block');
  }
}

Drupal.behaviors.extlink = function(context) {
  extlinkAttach(context);
}

//})(jQuery);
;

/**
 * Manage the active and inactive states of the commands menu.
 */

Drupal.DigitaldCoreCommandsMenu = function(element, options) {
  var self = this;
  self.element = element;
  self.$element = $(element);
  self._defaults = {delay: 300};
  self.settings = $.extend({}, true, this._defaults, options);
  self.init();
};

Drupal.DigitaldCoreCommandsMenu.prototype = {
  init: function() {
    this.addListeners();
  },
  hide: function($element) {
    // Set the element(s) inactive
    $element.removeClass('active');
  },
  show: function($element) {
    // Set the element(s) active
    $element.addClass('active');
    // Cancel the timeout delay for the element(s)
    $element.doTimeout('deactivate');
  },
  on: function(event) {
    var self = event.data.self;
    var $this = $(this);
    if ($this.is('.active')) {
      self.show($this);
    }
  },
  off: function(event) {
    var self = event.data.self;
    var $this = $(this);
    // Add a delay before deactivating the menu
    $this.doTimeout('deactivate', self.settings.delay, function() {
      self.hide($this);
    });
  },
  click: function(event) {
    var self = event.data.self;
    if (self.$element.is('.active')) {
      self.hide(self.$element);
    }
    else {
      self.show(self.$element);
    }
  },
  addListeners: function() {
    // Add a click event to toggle the display of the menu
    this.$element.find('.block-title').bind('click', {self: this}, this.click);
    // Add a listener to hide/show the menu if the user hovers on/off of it.
    this.$element.bind('mouseenter', {self: this}, this.on);
    this.$element.bind('mouseleave', {self: this}, this.off);
  }
};

Drupal.behaviors.digitaldcoreCommandsMenu = function(context) {
  $('#block-digitaldcore-command_menu', context).each(function(i, element) {
    if (!element.digitaldcoreCommandsMenu) {
      element.digitaldcoreCommandsMenu = new Drupal.DigitaldCoreCommandsMenu(element);
    }
  });
};

Drupal.behaviors.digitaldcoreInitialize = function(context) {
  $("body.page-manage-content-advanced .admin-content .view-filters > form > div", context).before("<div class='filter-title'>Filter and search content</div>");
  
  $("body.page-manage-content-advanced .admin-content #edit-submit-manage-content", context).parent().append('<button type="button" onclick="window.location = &quot;/manage/content/advanced?filters=reset&quot;;" class="admin-reset-filters">Reset filters</button>');
  
  $("body.page-manage-content-advanced .admin-content #views-bulk-operations-select #views-bulk-operations-dropdown", context).before("<div class='bulk-instructions'>Choose posts to perform a batch operation:</div>");

  // Create a sitemap using the default site navigation menu (.navbar)

  var sitemap = $("#site-map", context);
  var navbar = $(".navbar .block-content", context);

  if (sitemap.length && navbar.length) {
    Drupal.digitaldcoreCreateSiteMap(sitemap, navbar);
  }
};

/**
 * Function that creates a sitemap display using the main site navigation menu
 *
 * @param $sitemap (jQuery element) Sitemap container
 * @param $navbar (jQuery element) Main site navigation menu
 */

Drupal.digitaldcoreCreateSiteMap = function($sitemap, $navbar) {
  // Get reference to the sitemap message
  var message = $('.site-map-message', $sitemap).html();

  // Clear out any existing content within the sitemap container
  $sitemap.empty();

  // If a message was found, add that back into the new sitemap content
  if (message) {
    $sitemap.before('<div id="site-map-message">' + message + '</div>');
  }

  // Convert the crazy long menu item classname to cleaner alternative
  $sitemap.append($navbar.html().replace(/menu-path-taxonomy-term-/ig, 'tid-'));
  $sitemap.find('a[href="/"]').removeClass('hidden');

  // Remove hidden term links
  $sitemap.find('a.hidden').remove();

  // Remove hidden terms associated to a hidden navigation term
  $sitemap.find('li').map(function() {
    if(!$(this).children('a').length) {
      return this;
    }
  }).remove();

  // Remove class names from lists
  $sitemap.find('ul').removeAttr('class');

  // Remove inline styling, titles, ids, and focus from any sitemap element
  $sitemap.find("*").removeAttr('style').removeAttr('title').removeAttr('id').removeAttr('hidefocus');

  // Add an RSS feed icon which links to each menu items RSS output
  $sitemap.find('a.menu-link:not(.ext)').each(function() {
    var link = $(this);
    var match = link.attr('class').match(/\btid-(\d+)\b/);
    if (!match) {
      return;
    }
    var tid = match[1];
    link.after(link.clone());
    link.html('<img src="/misc/feed.png" alt="RSS Feed" />');
    link.addClass('sitemap-rss');
    link.attr('href', Drupal.settings.basePath + 'taxonomy/term/' + tid + '/0/feed');
  });
};

Drupal.behaviors.digitaldcoreInterrupt = function(context) {
  var showDialog = true;

  // Take care of the multivariateness
  if (Drupal.settings.ddCreatePopup) {
    var winner = null;
    var accumulator = 0.0;
    var threshold = Math.random();

    $.each(Drupal.settings.ddCreatePopup, function(key, popup) {
      var probability = parseFloat(popup.probability);
      accumulator += probability;

      if (accumulator > threshold) {
        winner = popup.content_nid;
        return false;
      }
    });

    if (winner) {
      $('#block-digitaldcore-interrupt .node-teaser').hide();
      $('#block-digitaldcore-interrupt .node-teaser.node-' + winner).show();
    }
    else {
      showDialog = false;
    }
  }

  if (showDialog && $('#block-digitaldcore-interrupt', context).size()) {
    setTimeout(function() {
      // Ensure that the plugin is still available, since being called via setTimeout
      if (typeof $.fn.dialog === 'function') {
        $('#block-digitaldcore-interrupt', context).dialog({ dialogClass: 'dd-interrupt', modal: true, width: 550, height: 400 });
      }
    }, 3000);  // 6 second delay will work with every browser
    
    $('#block-digitaldcore-interrupt .dd-hover-expand', context).click(function() {
      $('.ui-dialog-overlay').fadeOut();
    });
    $('#block-digitaldcore-interrupt .dd-hover-wrapper').css({ left:'100px', right:'auto' });
  }
  else {
    $('#block-digitaldcore-interrupt', context).hide();
  }
};

Drupal.behaviors.ddCalendarAttachBehaviors = function(context) {
  $('body.section-calendar article header .event-date .date-display-single', context).each(function () {
    if (this.children.length === 0 && $(this).text() === '12:00am') {
      $(this).hide();
    }
  });
  $("body.section-calendar", context).ajaxComplete(function() {
    Drupal.attachBehaviors($("#calpopup", context));
  });
};

/**
 * Force all links to common files (pdf, doc, etc) to open in a new window.
 */
Drupal.behaviors.fileLinks = function(context) {
  var pattern = /\.(pdf|doc|docx|xls|xlsx|csv|txt|rtf|odf|ppt|pptx|xml)$/; 
  $('#main a', context).each(function() {
    if (this.href.match(pattern)) {
      this.target = "_blank";
    }
  });
};

Drupal.behaviors.webformDuplicateSubmissions = function(context) {
  $('form.webform-client-form', context).submit(function(event) {
    if (event.defaultPrevented) {
      return;
    }

    var $submit = $('input#edit-submit', this);

    // Disable the button asynchronously, so that its value still gets submitted
    // to the server. This is important for webforms with multiple buttons, such
    // as multipage webforms or webforms that support drafts.
    setTimeout(function() {
      $submit.attr('disabled', 'disabled');
    }, 1);

    // Change the button label after a delay, so that it only shows up if the
    // form submission is slower.
    setTimeout(function() {
      $submit.attr('value', 'Please wait...');
    }, 2500);
  });
};
;
/* Modernizr 2.8.3 (Custom Build) | MIT & BSD
 * Build: http://modernizr.com/download/#-fontface-backgroundsize-borderradius-boxshadow-flexbox-flexboxlegacy-multiplebgs-opacity-rgba-textshadow-cssanimations-csscolumns-generatedcontent-cssgradients-csstransforms-csstransforms3d-csstransitions-canvas-canvastext-draganddrop-audio-video-input-inputtypes-localstorage-sessionstorage-geolocation-inlinesvg-svg-touch-shiv-cssclasses-teststyles-testprop-testallprops-hasevent-prefixes-domprefixes
 */
;



window.Modernizr = (function( window, document, undefined ) {

    var version = '2.8.3',

    Modernizr = {},

    enableClasses = true,

    docElement = document.documentElement,

    mod = 'modernizr',
    modElem = document.createElement(mod),
    mStyle = modElem.style,

    inputElem  = document.createElement('input')  ,

    smile = ':)',

    toString = {}.toString,

    prefixes = ' -webkit- -moz- -o- -ms- '.split(' '),



    omPrefixes = 'Webkit Moz O ms',

    cssomPrefixes = omPrefixes.split(' '),

    domPrefixes = omPrefixes.toLowerCase().split(' '),

    ns = {'svg': 'http://www.w3.org/2000/svg'},

    tests = {},
    inputs = {},
    attrs = {},

    classes = [],

    slice = classes.slice,

    featureName,


    injectElementWithStyles = function( rule, callback, nodes, testnames ) {

      var style, ret, node, docOverflow,
          div = document.createElement('div'),
                body = document.body,
                fakeBody = body || document.createElement('body');

      if ( parseInt(nodes, 10) ) {
                      while ( nodes-- ) {
              node = document.createElement('div');
              node.id = testnames ? testnames[nodes] : mod + (nodes + 1);
              div.appendChild(node);
          }
      }

                style = ['&#173;','<style id="s', mod, '">', rule, '</style>'].join('');
      div.id = mod;
          (body ? div : fakeBody).innerHTML += style;
      fakeBody.appendChild(div);
      if ( !body ) {
                fakeBody.style.background = '';
                fakeBody.style.overflow = 'hidden';
          docOverflow = docElement.style.overflow;
          docElement.style.overflow = 'hidden';
          docElement.appendChild(fakeBody);
      }

      ret = callback(div, rule);
        if ( !body ) {
          fakeBody.parentNode.removeChild(fakeBody);
          docElement.style.overflow = docOverflow;
      } else {
          div.parentNode.removeChild(div);
      }

      return !!ret;

    },



    isEventSupported = (function() {

      var TAGNAMES = {
        'select': 'input', 'change': 'input',
        'submit': 'form', 'reset': 'form',
        'error': 'img', 'load': 'img', 'abort': 'img'
      };

      function isEventSupported( eventName, element ) {

        element = element || document.createElement(TAGNAMES[eventName] || 'div');
        eventName = 'on' + eventName;

            var isSupported = eventName in element;

        if ( !isSupported ) {
                if ( !element.setAttribute ) {
            element = document.createElement('div');
          }
          if ( element.setAttribute && element.removeAttribute ) {
            element.setAttribute(eventName, '');
            isSupported = is(element[eventName], 'function');

                    if ( !is(element[eventName], 'undefined') ) {
              element[eventName] = undefined;
            }
            element.removeAttribute(eventName);
          }
        }

        element = null;
        return isSupported;
      }
      return isEventSupported;
    })(),


    _hasOwnProperty = ({}).hasOwnProperty, hasOwnProp;

    if ( !is(_hasOwnProperty, 'undefined') && !is(_hasOwnProperty.call, 'undefined') ) {
      hasOwnProp = function (object, property) {
        return _hasOwnProperty.call(object, property);
      };
    }
    else {
      hasOwnProp = function (object, property) {
        return ((property in object) && is(object.constructor.prototype[property], 'undefined'));
      };
    }


    if (!Function.prototype.bind) {
      Function.prototype.bind = function bind(that) {

        var target = this;

        if (typeof target != "function") {
            throw new TypeError();
        }

        var args = slice.call(arguments, 1),
            bound = function () {

            if (this instanceof bound) {

              var F = function(){};
              F.prototype = target.prototype;
              var self = new F();

              var result = target.apply(
                  self,
                  args.concat(slice.call(arguments))
              );
              if (Object(result) === result) {
                  return result;
              }
              return self;

            } else {

              return target.apply(
                  that,
                  args.concat(slice.call(arguments))
              );

            }

        };

        return bound;
      };
    }

    function setCss( str ) {
        mStyle.cssText = str;
    }

    function setCssAll( str1, str2 ) {
        return setCss(prefixes.join(str1 + ';') + ( str2 || '' ));
    }

    function is( obj, type ) {
        return typeof obj === type;
    }

    function contains( str, substr ) {
        return !!~('' + str).indexOf(substr);
    }

    function testProps( props, prefixed ) {
        for ( var i in props ) {
            var prop = props[i];
            if ( !contains(prop, "-") && mStyle[prop] !== undefined ) {
                return prefixed == 'pfx' ? prop : true;
            }
        }
        return false;
    }

    function testDOMProps( props, obj, elem ) {
        for ( var i in props ) {
            var item = obj[props[i]];
            if ( item !== undefined) {

                            if (elem === false) return props[i];

                            if (is(item, 'function')){
                                return item.bind(elem || obj);
                }

                            return item;
            }
        }
        return false;
    }

    function testPropsAll( prop, prefixed, elem ) {

        var ucProp  = prop.charAt(0).toUpperCase() + prop.slice(1),
            props   = (prop + ' ' + cssomPrefixes.join(ucProp + ' ') + ucProp).split(' ');

            if(is(prefixed, "string") || is(prefixed, "undefined")) {
          return testProps(props, prefixed);

            } else {
          props = (prop + ' ' + (domPrefixes).join(ucProp + ' ') + ucProp).split(' ');
          return testDOMProps(props, prefixed, elem);
        }
    }    tests['flexbox'] = function() {
      return testPropsAll('flexWrap');
    };


    tests['flexboxlegacy'] = function() {
        return testPropsAll('boxDirection');
    };


    tests['canvas'] = function() {
        var elem = document.createElement('canvas');
        return !!(elem.getContext && elem.getContext('2d'));
    };

    tests['canvastext'] = function() {
        return !!(Modernizr['canvas'] && is(document.createElement('canvas').getContext('2d').fillText, 'function'));
    };
    tests['touch'] = function() {
        var bool;

        if(('ontouchstart' in window) || window.DocumentTouch && document instanceof DocumentTouch) {
          bool = true;
        } else {
          injectElementWithStyles(['@media (',prefixes.join('touch-enabled),('),mod,')','{#modernizr{top:9px;position:absolute}}'].join(''), function( node ) {
            bool = node.offsetTop === 9;
          });
        }

        return bool;
    };



    tests['geolocation'] = function() {
        return 'geolocation' in navigator;
    };



    tests['draganddrop'] = function() {
        var div = document.createElement('div');
        return ('draggable' in div) || ('ondragstart' in div && 'ondrop' in div);
    };



    tests['rgba'] = function() {
        setCss('background-color:rgba(150,255,150,.5)');

        return contains(mStyle.backgroundColor, 'rgba');
    };


    tests['multiplebgs'] = function() {
                setCss('background:url(https://),url(https://),red url(https://)');

            return (/(url\s*\(.*?){3}/).test(mStyle.background);
    };    tests['backgroundsize'] = function() {
        return testPropsAll('backgroundSize');
    };    tests['borderradius'] = function() {
        return testPropsAll('borderRadius');
    };

    tests['boxshadow'] = function() {
        return testPropsAll('boxShadow');
    };

    tests['textshadow'] = function() {
        return document.createElement('div').style.textShadow === '';
    };


    tests['opacity'] = function() {
                setCssAll('opacity:.55');

                    return (/^0.55$/).test(mStyle.opacity);
    };


    tests['cssanimations'] = function() {
        return testPropsAll('animationName');
    };


    tests['csscolumns'] = function() {
        return testPropsAll('columnCount');
    };


    tests['cssgradients'] = function() {
        var str1 = 'background-image:',
            str2 = 'gradient(linear,left top,right bottom,from(#9f9),to(white));',
            str3 = 'linear-gradient(left top,#9f9, white);';

        setCss(
                       (str1 + '-webkit- '.split(' ').join(str2 + str1) +
                       prefixes.join(str3 + str1)).slice(0, -str1.length)
        );

        return contains(mStyle.backgroundImage, 'gradient');
    };    tests['csstransforms'] = function() {
        return !!testPropsAll('transform');
    };


    tests['csstransforms3d'] = function() {

        var ret = !!testPropsAll('perspective');

                        if ( ret && 'webkitPerspective' in docElement.style ) {

                      injectElementWithStyles('@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}', function( node, rule ) {
            ret = node.offsetLeft === 9 && node.offsetHeight === 3;
          });
        }
        return ret;
    };


    tests['csstransitions'] = function() {
        return testPropsAll('transition');
    };



    tests['fontface'] = function() {
        var bool;

        injectElementWithStyles('@font-face {font-family:"font";src:url("https://")}', function( node, rule ) {
          var style = document.getElementById('smodernizr'),
              sheet = style.sheet || style.styleSheet,
              cssText = sheet ? (sheet.cssRules && sheet.cssRules[0] ? sheet.cssRules[0].cssText : sheet.cssText || '') : '';

          bool = /src/i.test(cssText) && cssText.indexOf(rule.split(' ')[0]) === 0;
        });

        return bool;
    };

    tests['generatedcontent'] = function() {
        var bool;

        injectElementWithStyles(['#',mod,'{font:0/0 a}#',mod,':after{content:"',smile,'";visibility:hidden;font:3px/1 a}'].join(''), function( node ) {
          bool = node.offsetHeight >= 3;
        });

        return bool;
    };
    tests['video'] = function() {
        var elem = document.createElement('video'),
            bool = false;

            try {
            if ( bool = !!elem.canPlayType ) {
                bool      = new Boolean(bool);
                bool.ogg  = elem.canPlayType('video/ogg; codecs="theora"')      .replace(/^no$/,'');

                            bool.h264 = elem.canPlayType('video/mp4; codecs="avc1.42E01E"') .replace(/^no$/,'');

                bool.webm = elem.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,'');
            }

        } catch(e) { }

        return bool;
    };

    tests['audio'] = function() {
        var elem = document.createElement('audio'),
            bool = false;

        try {
            if ( bool = !!elem.canPlayType ) {
                bool      = new Boolean(bool);
                bool.ogg  = elem.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,'');
                bool.mp3  = elem.canPlayType('audio/mpeg;')               .replace(/^no$/,'');

                                                    bool.wav  = elem.canPlayType('audio/wav; codecs="1"')     .replace(/^no$/,'');
                bool.m4a  = ( elem.canPlayType('audio/x-m4a;')            ||
                              elem.canPlayType('audio/aac;'))             .replace(/^no$/,'');
            }
        } catch(e) { }

        return bool;
    };


    tests['localstorage'] = function() {
        try {
            localStorage.setItem(mod, mod);
            localStorage.removeItem(mod);
            return true;
        } catch(e) {
            return false;
        }
    };

    tests['sessionstorage'] = function() {
        try {
            sessionStorage.setItem(mod, mod);
            sessionStorage.removeItem(mod);
            return true;
        } catch(e) {
            return false;
        }
    };

    tests['svg'] = function() {
        return !!document.createElementNS && !!document.createElementNS(ns.svg, 'svg').createSVGRect;
    };

    tests['inlinesvg'] = function() {
      var div = document.createElement('div');
      div.innerHTML = '<svg/>';
      return (div.firstChild && div.firstChild.namespaceURI) == ns.svg;
    };    function webforms() {
                                            Modernizr['input'] = (function( props ) {
            for ( var i = 0, len = props.length; i < len; i++ ) {
                attrs[ props[i] ] = !!(props[i] in inputElem);
            }
            if (attrs.list){
                                  attrs.list = !!(document.createElement('datalist') && window.HTMLDataListElement);
            }
            return attrs;
        })('autocomplete autofocus list placeholder max min multiple pattern required step'.split(' '));
                            Modernizr['inputtypes'] = (function(props) {

            for ( var i = 0, bool, inputElemType, defaultView, len = props.length; i < len; i++ ) {

                inputElem.setAttribute('type', inputElemType = props[i]);
                bool = inputElem.type !== 'text';

                                                    if ( bool ) {

                    inputElem.value         = smile;
                    inputElem.style.cssText = 'position:absolute;visibility:hidden;';

                    if ( /^range$/.test(inputElemType) && inputElem.style.WebkitAppearance !== undefined ) {

                      docElement.appendChild(inputElem);
                      defaultView = document.defaultView;

                                        bool =  defaultView.getComputedStyle &&
                              defaultView.getComputedStyle(inputElem, null).WebkitAppearance !== 'textfield' &&
                                                                                  (inputElem.offsetHeight !== 0);

                      docElement.removeChild(inputElem);

                    } else if ( /^(search|tel)$/.test(inputElemType) ){
                                                                                    } else if ( /^(url|email)$/.test(inputElemType) ) {
                                        bool = inputElem.checkValidity && inputElem.checkValidity() === false;

                    } else {
                                        bool = inputElem.value != smile;
                    }
                }

                inputs[ props[i] ] = !!bool;
            }
            return inputs;
        })('search tel url email datetime date month week time datetime-local number range color'.split(' '));
        }
    for ( var feature in tests ) {
        if ( hasOwnProp(tests, feature) ) {
                                    featureName  = feature.toLowerCase();
            Modernizr[featureName] = tests[feature]();

            classes.push((Modernizr[featureName] ? '' : 'no-') + featureName);
        }
    }

    Modernizr.input || webforms();


     Modernizr.addTest = function ( feature, test ) {
       if ( typeof feature == 'object' ) {
         for ( var key in feature ) {
           if ( hasOwnProp( feature, key ) ) {
             Modernizr.addTest( key, feature[ key ] );
           }
         }
       } else {

         feature = feature.toLowerCase();

         if ( Modernizr[feature] !== undefined ) {
                                              return Modernizr;
         }

         test = typeof test == 'function' ? test() : test;

         if (typeof enableClasses !== "undefined" && enableClasses) {
           docElement.className += ' ' + (test ? '' : 'no-') + feature;
         }
         Modernizr[feature] = test;

       }

       return Modernizr;
     };


    setCss('');
    modElem = inputElem = null;

    ;(function(window, document) {
                var version = '3.7.0';

            var options = window.html5 || {};

            var reSkip = /^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i;

            var saveClones = /^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i;

            var supportsHtml5Styles;

            var expando = '_html5shiv';

            var expanID = 0;

            var expandoData = {};

            var supportsUnknownElements;

        (function() {
          try {
            var a = document.createElement('a');
            a.innerHTML = '<xyz></xyz>';
                    supportsHtml5Styles = ('hidden' in a);

            supportsUnknownElements = a.childNodes.length == 1 || (function() {
                        (document.createElement)('a');
              var frag = document.createDocumentFragment();
              return (
                typeof frag.cloneNode == 'undefined' ||
                typeof frag.createDocumentFragment == 'undefined' ||
                typeof frag.createElement == 'undefined'
              );
            }());
          } catch(e) {
                    supportsHtml5Styles = true;
            supportsUnknownElements = true;
          }

        }());

            function addStyleSheet(ownerDocument, cssText) {
          var p = ownerDocument.createElement('p'),
          parent = ownerDocument.getElementsByTagName('head')[0] || ownerDocument.documentElement;

          p.innerHTML = 'x<style>' + cssText + '</style>';
          return parent.insertBefore(p.lastChild, parent.firstChild);
        }

            function getElements() {
          var elements = html5.elements;
          return typeof elements == 'string' ? elements.split(' ') : elements;
        }

            function getExpandoData(ownerDocument) {
          var data = expandoData[ownerDocument[expando]];
          if (!data) {
            data = {};
            expanID++;
            ownerDocument[expando] = expanID;
            expandoData[expanID] = data;
          }
          return data;
        }

            function createElement(nodeName, ownerDocument, data){
          if (!ownerDocument) {
            ownerDocument = document;
          }
          if(supportsUnknownElements){
            return ownerDocument.createElement(nodeName);
          }
          if (!data) {
            data = getExpandoData(ownerDocument);
          }
          var node;

          if (data.cache[nodeName]) {
            node = data.cache[nodeName].cloneNode();
          } else if (saveClones.test(nodeName)) {
            node = (data.cache[nodeName] = data.createElem(nodeName)).cloneNode();
          } else {
            node = data.createElem(nodeName);
          }

                                                    return node.canHaveChildren && !reSkip.test(nodeName) && !node.tagUrn ? data.frag.appendChild(node) : node;
        }

            function createDocumentFragment(ownerDocument, data){
          if (!ownerDocument) {
            ownerDocument = document;
          }
          if(supportsUnknownElements){
            return ownerDocument.createDocumentFragment();
          }
          data = data || getExpandoData(ownerDocument);
          var clone = data.frag.cloneNode(),
          i = 0,
          elems = getElements(),
          l = elems.length;
          for(;i<l;i++){
            clone.createElement(elems[i]);
          }
          return clone;
        }

            function shivMethods(ownerDocument, data) {
          if (!data.cache) {
            data.cache = {};
            data.createElem = ownerDocument.createElement;
            data.createFrag = ownerDocument.createDocumentFragment;
            data.frag = data.createFrag();
          }


          ownerDocument.createElement = function(nodeName) {
                    if (!html5.shivMethods) {
              return data.createElem(nodeName);
            }
            return createElement(nodeName, ownerDocument, data);
          };

          ownerDocument.createDocumentFragment = Function('h,f', 'return function(){' +
                                                          'var n=f.cloneNode(),c=n.createElement;' +
                                                          'h.shivMethods&&(' +
                                                                                                                getElements().join().replace(/[\w\-]+/g, function(nodeName) {
            data.createElem(nodeName);
            data.frag.createElement(nodeName);
            return 'c("' + nodeName + '")';
          }) +
            ');return n}'
                                                         )(html5, data.frag);
        }

            function shivDocument(ownerDocument) {
          if (!ownerDocument) {
            ownerDocument = document;
          }
          var data = getExpandoData(ownerDocument);

          if (html5.shivCSS && !supportsHtml5Styles && !data.hasCSS) {
            data.hasCSS = !!addStyleSheet(ownerDocument,
                                                                                'article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}' +
                                                                                    'mark{background:#FF0;color:#000}' +
                                                                                    'template{display:none}'
                                         );
          }
          if (!supportsUnknownElements) {
            shivMethods(ownerDocument, data);
          }
          return ownerDocument;
        }

            var html5 = {

                'elements': options.elements || 'abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video',

                'version': version,

                'shivCSS': (options.shivCSS !== false),

                'supportsUnknownElements': supportsUnknownElements,

                'shivMethods': (options.shivMethods !== false),

                'type': 'default',

                'shivDocument': shivDocument,

                createElement: createElement,

                createDocumentFragment: createDocumentFragment
        };

            window.html5 = html5;

            shivDocument(document);

    }(this, document));

    Modernizr._version      = version;

    Modernizr._prefixes     = prefixes;
    Modernizr._domPrefixes  = domPrefixes;
    Modernizr._cssomPrefixes  = cssomPrefixes;


    Modernizr.hasEvent      = isEventSupported;

    Modernizr.testProp      = function(prop){
        return testProps([prop]);
    };

    Modernizr.testAllProps  = testPropsAll;


    Modernizr.testStyles    = injectElementWithStyles;    docElement.className = docElement.className.replace(/(^|\s)no-js(\s|$)/, '$1$2') +

                                                    (enableClasses ? ' js ' + classes.join(' ') : '');

    return Modernizr;

})(this, this.document);
;
;
;(function() {

  var BrowserDetect = function() {
    this.browser = this.getBrowserAgent();
    this.version = this.getBrowserVersion();
  };

  BrowserDetect.prototype = {
    getBrowserAgent: function() {
      return this.searchString(this.dataBrowser);
    },
    getBrowserVersion: function() {
      return this.searchVersion(navigator.userAgent) || this.searchVersion(navigator.appVersion);
    },
    searchString: function (data) {
      for (var i = 0; i < data.length; i++) {
        var dataString = data[i].string;
        this.versionSearchString = data[i].subString;
        if (dataString.indexOf(data[i].subString) != -1) {
          return data[i].identity;
        }
      }
    },
    searchVersion: function (dataString) {
      var index = dataString.indexOf(this.versionSearchString);
      if (index == -1) return;
      return parseFloat(dataString.substring(index + this.versionSearchString.length + 1));
    },
    dataBrowser: [
      { string: navigator.userAgent, subString: "Chrome",  identity: "chrome"  },
      { string: navigator.userAgent, subString: "MSIE",    identity: "ie"      },
      { string: navigator.userAgent, subString: "Firefox", identity: "firefox" },
      { string: navigator.userAgent, subString: "Safari",  identity: "safari"  },
      { string: navigator.userAgent, subString: "Opera",   identity: "opera"   }
    ],
    addClasses: function() {
      var b = browserDetect.browser,
          v = browserDetect.version;
      // add the browser name
      $(document.documentElement).addClass(b);
      // add the browser version too if it's available
      if (v) $(document.documentElement).addClass(b + '-' + v);
    }
  };

  // Create an instance of the BrowserDetect and add the browser and version
  // to the HTML doc element.
  var browserDetect = new BrowserDetect();
  if (browserDetect.browser) {
    browserDetect.addClasses();
  }

})();
;
Drupal.behaviors.ddSearchBox = function(context) {
  $('#dd-search').each(function() {
    new Drupal.ddSearchBox($(this));
  });
};

Drupal.ddSearchBox = function($search) {
  var self = this;
  this.$search = $search;
  this.placeholderText = $('#edit-box-text').val();

  // Don't do anything if we have no placeholder text.
  if (!this.placeholderText) {
    return;
  }

  this.$input = this.$search.find('.dd-search-keywords input');
 
  // Initialize.
  this.update(false);

  // Update when the input field receives focus.
  this.$input.focus(function() {
    self.update(true);
  });

  // Update when the input field looses focus.
  this.$input.blur(function() {
    self.update(false);
  });

  // Update when the form gets submitted.
  $search.find('form').submit(function() {
    self.update(true);
  });
};

Drupal.ddSearchBox.prototype.update = function(active) {
  if (active) {
    // When getting focus, clear the placeholder text, if necessary.
    if (this.$input.val() == this.placeholderText) {
      this.clearPlaceholder();
    }
  }
  else {
    // When leaving focus, restore the placeholder text, if appropriate.
    if (this.$input.val() == '') {
      this.setPlaceholder();
    }
  }
};

Drupal.ddSearchBox.prototype.setPlaceholder = function() {
  this.$input.val(this.placeholderText);
  this.$search.removeClass('dd-search-active');
};

Drupal.ddSearchBox.prototype.clearPlaceholder = function() {
  this.$input.val('');
  this.$search.addClass('dd-search-active');
};
;
/*
 * jQuery UI 1.6
 *
 * Copyright (c) 2008 AUTHORS.txt (http://ui.jquery.com/about)
 * Dual licensed under the MIT (MIT-LICENSE.txt)
 * and GPL (GPL-LICENSE.txt) licenses.
 *
 * http://docs.jquery.com/UI
 */(function(C){var I=C.fn.remove,D=C.browser.mozilla&&(parseFloat(C.browser.version)<1.9);C.ui={version:"1.6",plugin:{add:function(K,L,N){var M=C.ui[K].prototype;for(var J in N){M.plugins[J]=M.plugins[J]||[];M.plugins[J].push([L,N[J]])}},call:function(J,L,K){var N=J.plugins[L];if(!N){return }for(var M=0;M<N.length;M++){if(J.options[N[M][0]]){N[M][1].apply(J.element,K)}}}},contains:function(L,K){var J=C.browser.safari&&C.browser.version<522;if(L.contains&&!J){return L.contains(K)}if(L.compareDocumentPosition){return !!(L.compareDocumentPosition(K)&16)}while(K=K.parentNode){if(K==L){return true}}return false},cssCache:{},css:function(J){if(C.ui.cssCache[J]){return C.ui.cssCache[J]}var K=C('<div class="ui-gen">').addClass(J).css({position:"absolute",top:"-5000px",left:"-5000px",display:"block"}).appendTo("body");C.ui.cssCache[J]=!!((!(/auto|default/).test(K.css("cursor"))||(/^[1-9]/).test(K.css("height"))||(/^[1-9]/).test(K.css("width"))||!(/none/).test(K.css("backgroundImage"))||!(/transparent|rgba\(0, 0, 0, 0\)/).test(K.css("backgroundColor"))));try{C("body").get(0).removeChild(K.get(0))}catch(L){}return C.ui.cssCache[J]},hasScroll:function(M,K){if(C(M).css("overflow")=="hidden"){return false}var J=(K&&K=="left")?"scrollLeft":"scrollTop",L=false;if(M[J]>0){return true}M[J]=1;L=(M[J]>0);M[J]=0;return L},isOverAxis:function(K,J,L){return(K>J)&&(K<(J+L))},isOver:function(O,K,N,M,J,L){return C.ui.isOverAxis(O,N,J)&&C.ui.isOverAxis(K,M,L)},keyCode:{BACKSPACE:8,CAPS_LOCK:20,COMMA:188,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38}};if(D){var F=C.attr,E=C.fn.removeAttr,H="http://www.w3.org/2005/07/aaa",A=/^aria-/,B=/^wairole:/;C.attr=function(K,J,L){var M=L!==undefined;return(J=="role"?(M?F.call(this,K,J,"wairole:"+L):(F.apply(this,arguments)||"").replace(B,"")):(A.test(J)?(M?K.setAttributeNS(H,J.replace(A,"aaa:"),L):F.call(this,K,J.replace(A,"aaa:"))):F.apply(this,arguments)))};C.fn.removeAttr=function(J){return(A.test(J)?this.each(function(){this.removeAttributeNS(H,J.replace(A,""))}):E.call(this,J))}}C.fn.extend({remove:function(){C("*",this).add(this).each(function(){C(this).triggerHandler("remove")});return I.apply(this,arguments)},enableSelection:function(){return this.attr("unselectable","off").css("MozUserSelect","").unbind("selectstart.ui")},disableSelection:function(){return this.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return false})},scrollParent:function(){var J;if((C.browser.msie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){J=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test(C.curCSS(this,"position",1))&&(/(auto|scroll)/).test(C.curCSS(this,"overflow",1)+C.curCSS(this,"overflow-y",1)+C.curCSS(this,"overflow-x",1))}).eq(0)}else{J=this.parents().filter(function(){return(/(auto|scroll)/).test(C.curCSS(this,"overflow",1)+C.curCSS(this,"overflow-y",1)+C.curCSS(this,"overflow-x",1))}).eq(0)}return(/fixed/).test(this.css("position"))||!J.length?C(document):J}});C.extend(C.expr[":"],{data:function(K,L,J){return C.data(K,J[3])},tabbable:function(L,M,K){var N=L.nodeName.toLowerCase();function J(O){return !(C(O).is(":hidden")||C(O).parents(":hidden").length)}return(L.tabIndex>=0&&(("a"==N&&L.href)||(/input|select|textarea|button/.test(N)&&"hidden"!=L.type&&!L.disabled))&&J(L))}});function G(M,N,O,L){function K(Q){var P=C[M][N][Q]||[];return(typeof P=="string"?P.split(/,?\s+/):P)}var J=K("getter");if(L.length==1&&typeof L[0]=="string"){J=J.concat(K("getterSetter"))}return(C.inArray(O,J)!=-1)}C.widget=function(K,J){var L=K.split(".")[0];K=K.split(".")[1];C.fn[K]=function(P){var N=(typeof P=="string"),O=Array.prototype.slice.call(arguments,1);if(N&&P.substring(0,1)=="_"){return this}if(N&&G(L,K,P,O)){var M=C.data(this[0],K);return(M?M[P].apply(M,O):undefined)}return this.each(function(){var Q=C.data(this,K);(!Q&&!N&&C.data(this,K,new C[L][K](this,P)));(Q&&N&&C.isFunction(Q[P])&&Q[P].apply(Q,O))})};C[L]=C[L]||{};C[L][K]=function(O,N){var M=this;this.widgetName=K;this.widgetEventPrefix=C[L][K].eventPrefix||K;this.widgetBaseClass=L+"-"+K;this.options=C.extend({},C.widget.defaults,C[L][K].defaults,C.metadata&&C.metadata.get(O)[K],N);this.element=C(O).bind("setData."+K,function(Q,P,R){return M._setData(P,R)}).bind("getData."+K,function(Q,P){return M._getData(P)}).bind("remove",function(){return M.destroy()});this._init()};C[L][K].prototype=C.extend({},C.widget.prototype,J);C[L][K].getterSetter="option"};C.widget.prototype={_init:function(){},destroy:function(){this.element.removeData(this.widgetName)},option:function(L,M){var K=L,J=this;if(typeof L=="string"){if(M===undefined){return this._getData(L)}K={};K[L]=M}C.each(K,function(N,O){J._setData(N,O)})},_getData:function(J){return this.options[J]},_setData:function(J,K){this.options[J]=K;if(J=="disabled"){this.element[K?"addClass":"removeClass"](this.widgetBaseClass+"-disabled")}},enable:function(){this._setData("disabled",false)},disable:function(){this._setData("disabled",true)},_trigger:function(K,L,M){var J=(K==this.widgetEventPrefix?K:this.widgetEventPrefix+K);L=L||C.event.fix({type:J,target:this.element[0]});return this.element.triggerHandler(J,[L,M],this.options[K])}};C.widget.defaults={disabled:false};C.ui.mouse={_mouseInit:function(){var J=this;this.element.bind("mousedown."+this.widgetName,function(K){return J._mouseDown(K)}).bind("click."+this.widgetName,function(K){if(J._preventClickEvent){J._preventClickEvent=false;return false}});if(C.browser.msie){this._mouseUnselectable=this.element.attr("unselectable");this.element.attr("unselectable","on")}this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);(C.browser.msie&&this.element.attr("unselectable",this._mouseUnselectable))},_mouseDown:function(L){(this._mouseStarted&&this._mouseUp(L));this._mouseDownEvent=L;var K=this,M=(L.which==1),J=(typeof this.options.cancel=="string"?C(L.target).parents().add(L.target).filter(this.options.cancel).length:false);if(!M||J||!this._mouseCapture(L)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){K.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(L)&&this._mouseDelayMet(L)){this._mouseStarted=(this._mouseStart(L)!==false);if(!this._mouseStarted){L.preventDefault();return true}}this._mouseMoveDelegate=function(N){return K._mouseMove(N)};this._mouseUpDelegate=function(N){return K._mouseUp(N)};C(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);if(!C.browser.safari){L.preventDefault()}return true},_mouseMove:function(J){if(C.browser.msie&&!J.button){return this._mouseUp(J)}if(this._mouseStarted){this._mouseDrag(J);return J.preventDefault()}if(this._mouseDistanceMet(J)&&this._mouseDelayMet(J)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,J)!==false);(this._mouseStarted?this._mouseDrag(J):this._mouseUp(J))}return !this._mouseStarted},_mouseUp:function(J){C(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;this._preventClickEvent=true;this._mouseStop(J)}return false},_mouseDistanceMet:function(J){return(Math.max(Math.abs(this._mouseDownEvent.pageX-J.pageX),Math.abs(this._mouseDownEvent.pageY-J.pageY))>=this.options.distance)},_mouseDelayMet:function(J){return this.mouseDelayMet},_mouseStart:function(J){},_mouseDrag:function(J){},_mouseStop:function(J){},_mouseCapture:function(J){return true}};C.ui.mouse.defaults={cancel:null,distance:1,delay:0}})(jQuery);
/*
 * jQuery UI Dialog 1.6
 *
 * Copyright (c) 2008 AUTHORS.txt (http://ui.jquery.com/about)
 * Dual licensed under the MIT (MIT-LICENSE.txt)
 * and GPL (GPL-LICENSE.txt) licenses.
 *
 * http://docs.jquery.com/UI/Dialog
 *
 * Depends:
 *	ui.core.js
 *	ui.draggable.js
 *	ui.resizable.js
 */(function(B){var A={dragStart:"start.draggable",drag:"drag.draggable",dragStop:"stop.draggable",maxHeight:"maxHeight.resizable",minHeight:"minHeight.resizable",maxWidth:"maxWidth.resizable",minWidth:"minWidth.resizable",resizeStart:"start.resizable",resize:"drag.resizable",resizeStop:"stop.resizable"};B.widget("ui.dialog",{_init:function(){this.originalTitle=this.element.attr("title");this.options.title=this.options.title||this.originalTitle;var M=this,N=this.options,F=this.element.removeAttr("title").addClass("ui-dialog-content").wrap("<div></div>").wrap("<div></div>"),I=(this.uiDialogContainer=F.parent()).addClass("ui-dialog-container").css({position:"relative",width:"100%",height:"100%"}),E=(this.uiDialogTitlebar=B("<div></div>")).addClass("ui-dialog-titlebar").mousedown(function(){M.moveToTop()}).prependTo(I),J=B('<a href="#"/>').addClass("ui-dialog-titlebar-close").attr("role","button").appendTo(E),G=(this.uiDialogTitlebarCloseText=B("<span/>")).text(N.closeText).appendTo(J),L=N.title||"&nbsp;",D=B.ui.dialog.getTitleId(this.element),C=B("<span/>").addClass("ui-dialog-title").attr("id",D).html(L).prependTo(E),K=(this.uiDialog=I.parent()).appendTo(document.body).hide().addClass("ui-dialog").addClass(N.dialogClass).css({position:"absolute",width:N.width,height:N.height,overflow:"hidden",zIndex:N.zIndex}).attr("tabIndex",-1).css("outline",0).keydown(function(O){(N.closeOnEscape&&O.keyCode&&O.keyCode==B.ui.keyCode.ESCAPE&&M.close())}).attr({role:"dialog","aria-labelledby":D}).mouseup(function(){M.moveToTop()}),H=(this.uiDialogButtonPane=B("<div></div>")).addClass("ui-dialog-buttonpane").css({position:"absolute",bottom:0}).appendTo(K),J=B(".ui-dialog-titlebar-close",E).hover(function(){B(this).addClass("ui-dialog-titlebar-close-hover")},function(){B(this).removeClass("ui-dialog-titlebar-close-hover")}).mousedown(function(O){O.stopPropagation()}).click(function(){M.close();return false});E.find("*").add(E).disableSelection();(N.draggable&&B.fn.draggable&&this._makeDraggable());(N.resizable&&B.fn.resizable&&this._makeResizable());this._createButtons(N.buttons);this._isOpen=false;(N.bgiframe&&B.fn.bgiframe&&K.bgiframe());(N.autoOpen&&this.open())},destroy:function(){(this.overlay&&this.overlay.destroy());this.uiDialog.hide();this.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content").hide().appendTo("body");this.uiDialog.remove();(this.originalTitle&&this.element.attr("title",this.originalTitle))},close:function(){if(false===this._trigger("beforeclose",null,{options:this.options})){return }(this.overlay&&this.overlay.destroy());this.uiDialog.hide(this.options.hide).unbind("keypress.ui-dialog");this._trigger("close",null,{options:this.options});B.ui.dialog.overlay.resize();this._isOpen=false},isOpen:function(){return this._isOpen},moveToTop:function(F){if((this.options.modal&&!F)||(!this.options.stack&&!this.options.modal)){return this._trigger("focus",null,{options:this.options})}var E=this.options.zIndex,D=this.options;B(".ui-dialog:visible").each(function(){E=Math.max(E,parseInt(B(this).css("z-index"),10)||D.zIndex)});(this.overlay&&this.overlay.$el.css("z-index",++E));var C={scrollTop:this.element.attr("scrollTop"),scrollLeft:this.element.attr("scrollLeft")};this.uiDialog.css("z-index",++E);this.element.attr(C);this._trigger("focus",null,{options:this.options})},open:function(){if(this._isOpen){return }this.overlay=this.options.modal?new B.ui.dialog.overlay(this):null;(this.uiDialog.next().length&&this.uiDialog.appendTo("body"));this._position(this.options.position);this.uiDialog.show(this.options.show);(this.options.autoResize&&this._size());this.moveToTop(true);(this.options.modal&&this.uiDialog.bind("keypress.ui-dialog",function(E){if(E.keyCode!=B.ui.keyCode.TAB){return }var D=B(":tabbable",this),F=D.filter(":first")[0],C=D.filter(":last")[0];if(E.target==C&&!E.shiftKey){setTimeout(function(){F.focus()},1)}else{if(E.target==F&&E.shiftKey){setTimeout(function(){C.focus()},1)}}}));this.uiDialog.find(":tabbable:first").focus();this._trigger("open",null,{options:this.options});this._isOpen=true},_createButtons:function(F){var E=this,C=false,D=this.uiDialogButtonPane;D.empty().hide();B.each(F,function(){return !(C=true)});if(C){D.show();B.each(F,function(G,H){B('<button type="button"></button>').text(G).click(function(){H.apply(E.element[0],arguments)}).appendTo(D)})}},_makeDraggable:function(){var C=this,D=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content",helper:D.dragHelper,handle:".ui-dialog-titlebar",start:function(){C.moveToTop();(D.dragStart&&D.dragStart.apply(C.element[0],arguments))},drag:function(){(D.drag&&D.drag.apply(C.element[0],arguments))},stop:function(){(D.dragStop&&D.dragStop.apply(C.element[0],arguments));B.ui.dialog.overlay.resize()}})},_makeResizable:function(F){F=(F===undefined?this.options.resizable:F);var C=this,E=this.options,D=typeof F=="string"?F:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",helper:E.resizeHelper,maxWidth:E.maxWidth,maxHeight:E.maxHeight,minWidth:E.minWidth,minHeight:E.minHeight,start:function(){(E.resizeStart&&E.resizeStart.apply(C.element[0],arguments))},resize:function(){(E.autoResize&&C._size.apply(C));(E.resize&&E.resize.apply(C.element[0],arguments))},handles:D,stop:function(){(E.autoResize&&C._size.apply(C));(E.resizeStop&&E.resizeStop.apply(C.element[0],arguments));B.ui.dialog.overlay.resize()}})},_position:function(H){var D=B(window),E=B(document),F=E.scrollTop(),C=E.scrollLeft(),G=F;if(B.inArray(H,["center","top","right","bottom","left"])>=0){H=[H=="right"||H=="left"?H:"center",H=="top"||H=="bottom"?H:"middle"]}if(H.constructor!=Array){H=["center","middle"]}if(H[0].constructor==Number){C+=H[0]}else{switch(H[0]){case"left":C+=0;break;case"right":C+=D.width()-this.uiDialog.outerWidth();break;default:case"center":C+=(D.width()-this.uiDialog.outerWidth())/2}}if(H[1].constructor==Number){F+=H[1]}else{switch(H[1]){case"top":F+=0;break;case"bottom":F+=(B.browser.opera?window.innerHeight:D.height())-this.uiDialog.outerHeight();break;default:case"middle":F+=((B.browser.opera?window.innerHeight:D.height())-this.uiDialog.outerHeight())/2}}F=Math.max(F,G);this.uiDialog.css({top:F,left:C})},_setData:function(D,E){(A[D]&&this.uiDialog.data(A[D],E));switch(D){case"buttons":this._createButtons(E);break;case"closeText":this.uiDialogTitlebarCloseText.text(E);break;case"draggable":(E?this._makeDraggable():this.uiDialog.draggable("destroy"));break;case"height":this.uiDialog.height(E);break;case"position":this._position(E);break;case"resizable":var C=this.uiDialog,F=this.uiDialog.is(":data(resizable)");(F&&!E&&C.resizable("destroy"));(F&&typeof E=="string"&&C.resizable("option","handles",E));(F||this._makeResizable(E));break;case"title":B(".ui-dialog-title",this.uiDialogTitlebar).html(E||"&nbsp;");break;case"width":this.uiDialog.width(E);break}B.widget.prototype._setData.apply(this,arguments)},_size:function(){var D=this.uiDialogContainer,G=this.uiDialogTitlebar,E=this.element,F=(parseInt(E.css("margin-top"),10)||0)+(parseInt(E.css("margin-bottom"),10)||0),C=(parseInt(E.css("margin-left"),10)||0)+(parseInt(E.css("margin-right"),10)||0);E.height(D.height()-G.outerHeight()-F);E.width(D.width()-C)}});B.extend(B.ui.dialog,{version:"1.6",defaults:{autoOpen:true,autoResize:true,bgiframe:false,buttons:{},closeOnEscape:true,closeText:"close",draggable:true,height:200,minHeight:100,minWidth:150,modal:false,overlay:{},position:"center",resizable:true,stack:true,width:300,zIndex:1000},getter:"isOpen",uuid:0,getTitleId:function(C){return"ui-dialog-title-"+(C.attr("id")||++this.uuid)},overlay:function(C){this.$el=B.ui.dialog.overlay.create(C)}});B.extend(B.ui.dialog.overlay,{instances:[],events:B.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(C){return C+".dialog-overlay"}).join(" "),create:function(D){if(this.instances.length===0){setTimeout(function(){B("a, :input").bind(B.ui.dialog.overlay.events,function(){var F=false;var H=B(this).parents(".ui-dialog");if(H.length){var E=B(".ui-dialog-overlay");if(E.length){var G=parseInt(E.css("z-index"),10);E.each(function(){G=Math.max(G,parseInt(B(this).css("z-index"),10))});F=parseInt(H.css("z-index"),10)>G}else{F=true}}return F})},1);B(document).bind("keydown.dialog-overlay",function(E){(D.options.closeOnEscape&&E.keyCode&&E.keyCode==B.ui.keyCode.ESCAPE&&D.close())});B(window).bind("resize.dialog-overlay",B.ui.dialog.overlay.resize)}var C=B("<div></div>").appendTo(document.body).addClass("ui-dialog-overlay").css(B.extend({borderWidth:0,margin:0,padding:0,position:"absolute",top:0,left:0,width:this.width(),height:this.height()},D.options.overlay));(D.options.bgiframe&&B.fn.bgiframe&&C.bgiframe());this.instances.push(C);return C},destroy:function(C){this.instances.splice(B.inArray(this.instances,C),1);if(this.instances.length===0){B("a, :input").add([document,window]).unbind(".dialog-overlay")}C.remove()},height:function(){if(B.browser.msie&&B.browser.version<7){var D=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);var C=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);if(D<C){return B(window).height()+"px"}else{return D+"px"}}else{if(B.browser.opera){return Math.max(window.innerHeight,B(document).height())+"px"}else{return B(document).height()+"px"}}},width:function(){if(B.browser.msie&&B.browser.version<7){var C=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth);var D=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth);if(C<D){return B(window).width()+"px"}else{return C+"px"}}else{if(B.browser.opera){return Math.max(window.innerWidth,B(document).width())+"px"}else{return B(document).width()+"px"}}},resize:function(){var C=B([]);B.each(B.ui.dialog.overlay.instances,function(){C=C.add(this)});C.css({width:0,height:0}).css({width:B.ui.dialog.overlay.width(),height:B.ui.dialog.overlay.height()})}});B.extend(B.ui.dialog.overlay.prototype,{destroy:function(){B.ui.dialog.overlay.destroy(this.$el)}})})(jQuery);
if ($.ui.version == '1.6') {
  // Backported from more recent version of jQuery UI for IE 9 and 10
  // compatbility, to make resizables and draggables work in those browsers.
  // https://github.com/jquery/jquery-ui/blob/83b3d67175f16057844e5719bcda56eeb74560f3/ui/mouse.js
  $.ui.mouse._mouseMove = function(event) {
    // IE mouseup check - mouseup happened when mouse was out of window
    if ($.browser.msie && (!document.documentMode || document.documentMode < 9) && !event.button) {
      return this._mouseUp(event);
    }

    if (this._mouseStarted) {
      this._mouseDrag(event);
      return event.preventDefault();
    }

    if (this._mouseDistanceMet(event) && this._mouseDelayMet(event)) {
      this._mouseStarted =
          (this._mouseStart(this._mouseDownEvent, event) !== false);
      (this._mouseStarted ? this._mouseDrag(event) : this._mouseUp(event));
    }

    return !this._mouseStarted;
  };
}
;
Drupal.behaviors.dmodel = function(context) {
  new Drupal.dmodelPositionFixed();
};

Drupal.dmodelPositionFixed = function() {
  // Bind 'this' so we can reference it in functions
  var self = this;

  // Find the elements we need to reposition and determine the current offsets
  this.bottomElements = $('#block-digitaldcore-command_menu, #channel-controls');

  if (this.bottomElements.length != 0) {
    this.lastScrollTop = $(window).scrollTop();
    this.lastTopOffset = this.bottomElements.offset().top;

    // Create a named function so that we can unbind it from the scroll event later
    this.scrollHandler = function() {
      self.update();
    };
    
    $(window).bind('scroll', this.scrollHandler);
    
    $(window).bind('orientationchange', function() {
      self.update(true);
    });
  }
};

Drupal.dmodelPositionFixed.prototype.update = function(force) {
  if (force === undefined) {
    force = false;
  }
  
  var scrollTop = $(window).scrollTop();

  // Only do something if we did scroll (sanity check)
  if (force || scrollTop != this.lastScrollTop) {
    var topOffset = this.bottomElements.offset().top;
    
    // If the elements were repositioned by the browser, we don't need to do anything
    if (!force && topOffset != this.lastTopOffset) {
      $(window).unbind('scroll', this.scrollHandler);
    }
    // Apparently, we're in a browser that doesn't reposition position:fixed elements (such as Mobile Safari)
    else {
      this.bottomElements.css('bottom', -scrollTop + 'px');
      this.lastScrollTop = $(window).scrollTop();
      this.lastTopOffset = this.bottomElements.offset().top;
    }
  }
};

Drupal.behaviors.dmodelMessageClosing = function(context) {
  var messages = $('.messages', context);
  
  // Filter out messages containing Krumo stuff output by dsm()
  messages = messages.filter(function() {
    return $('.krumo-root', this).length == 0;
  });
  
  // Fade out messages when clicking on them
  messages.click(function(event) {
    $(this).animate({opacity: 'hide', height: 'hide'}, 250);
  });
};

/**
 * Add additional behaviors to the date popups, especially to fix a problem with
 * tab order: https://support.digitaldeployment.com/helpdesk/tickets/459
 * 
 * @param context
 */
Drupal.behaviors.dmodelDatePopup = function(context) {
  for (var id in Drupal.settings.datePopup) {
    if (Drupal.settings.datePopup[id].func == 'datepicker') {
      // Add an "onClose" handler to each date popup
      // Check if date_year_range setting exists
      var datePopupConfig = {
        onClose: function(dateString, config) {
          // When the popup is closing set the focus to the time entry field
          $('#' + config.id.replace('-datepicker-popup-0', '-timeEntry-popup-1')).focus().click();
        }
      };
      if ('date_year_range' in Drupal.settings.dd) {
        datePopupConfig.yearRange = Drupal.settings.dd['date_year_range'];
      }
      $('#' + id).datepicker(datePopupConfig);
    }
  }
};

/**
 * Adds an active classname to all node's who's destination url matches the
 * current url path.
 */
Drupal.behaviors.dmodelLabelActiveNodes = function(context) {
  var pathname = document.location.pathname,
    $activeLinks = $('.link-read-more a', context).filter('[href=' + pathname + ']');
  $activeLinks.parents('.node-teaser').addClass('active');
};

/**
 * Email Campaign Assistant
 *
 * @desc: A user experience helper class to assist in the memory of previously
 * configured email campaign data. This functionality saves the user time since
 * they don't have to fill out the same form each and every time they're testing
 * e-blasts to their subscribers.
 */
Drupal.behaviors.dmodelEmailCampaign = function(context) {
  var $campaignForm = $('#banana-node-send-campaign-form', context);
  if ($campaignForm.length) {
    var results = $campaignForm.attr('action').match(/node\/([0-9]+)\/campaign/i);
    if (results) {
      new Drupal.EmailCampaignAssistant($campaignForm, {
        nid: results[1],
        formComponents: [
          '#edit-test-mail',        // Test email address
          '#edit-emailkit-address', // Direct email address(es)
          '#edit-from-name',        // Name of sender
          '#edit-from-address',     // From email address
          '#edit-subject'           // Subject of the email
        ]
      });
    }
  }
};

Drupal.EmailCampaignAssistant = function($element, options) {
  this.$element = $element;
  this.options = options;
  this.storageKey = 'EmailCampaignAssistantData_' + this.options.nid;
  this.$formComponents = this.getFormComponents();
  this.formData = this.getData();
  this.init();
};

Drupal.EmailCampaignAssistant.prototype = {
  init: function() {
    if (this.$formComponents.length) {
      this.addEventListeners();
      this.setData();
    }
  },
  getData: function() {
    var data = sessionStorage.getItem(this.storageKey) || '{}';
    return JSON.parse(data);
  },
  setData: function() {
    var self = this;
    self.$formComponents.each(function() {
      var key = '#' + $(this).attr('id');
      $(this).val(self.formData[key]);
      $(this).data('key', key);
    });
  },
  saveData: function() {
    sessionStorage.setItem(this.storageKey, JSON.stringify(this.formData));
  },
  updateData: function(event) {
    var self = event.data.self;
    self.formData[$(this).data('key')] = $(this).val();
    self.saveData();
  },
  getFormComponents: function() {
    return this.$element.find(this.options.formComponents.toString());
  },
  addEventListeners: function() {
    this.$formComponents.bind('keyup', {self: this} , this.updateData);
  }
};

/**
 * Simply applies a class to the standard overview block if an overview is
 * already present.
 */
Drupal.behaviors.dmodelOverviewHelper = function(context) {
  var $overviewBlock = $('.overview.block', context);
  if ($overviewBlock.find('.node').length) {
    $overviewBlock.addClass('hide-add-new');
  }
};
;
/****************************************************\
  Homepage Tabs


Drupal.behaviors.homepageTabs = function(context) {

   // Home tab selector
  var titles = $(".homepage-tab .block-title", context);
  var content = $(".homepage-tab .block-content", context);

  $(titles).click(function(event) {
    content.hide();
    titles.removeClass("active");
    $(this).addClass("active").next('.block-content').show();
  });
  
  $("#block-views_blocks-term-block_1-10 .block-title").trigger('click');

  $(".homepage-tab").wrapAll('<div class="homepage-tabs-wrapper" />').wrapAll('<div class="homepage-tabs-wrapper-inner" />');
};
\****************************************************/

/* =============================================== *\
   Filter by Post Type within the Calendar View
\* =============================================== */

Drupal.behaviors.dthemeCalendarFilter = function(context) {
  
  $("body.section-calendar #content-area > .view", context).attr("id", "cal");

  $("#cal", context).prepend("<div id='cal-filters'></div>");

  var filters = {
  "calendar" : "All Events",
  "wt440"    : "Board Meetings",
  "wt441"    : "Policy Committee Meetings",
  "wt442"    : "CSAC Institute",
  "wt443"    : "Conferences and Events"
  };

  $.each(filters, function(k,v) {
    $("#cal-filters", context).append("<a class='tab show-"+k+"'>" + v + "</a> ");
    $("#cal-filters .show-" + k, context).click(function(event) {
      $("#cal-filters a").removeClass("active");
      $(this).addClass("active");
      $("#cal .node:visible:not(."+k+")").hide();
      $("#cal .node." + k).fadeIn();
    });
  });

  $("#cal-filters a:first", context).click();

};


/* =============================================== *\
   Remove href in overview titles
\* =============================================== */

Drupal.behaviors.dthemeRemoveOverviewTitleLink = function(context) {
  $("#block-views_blocks-term-block_1-0 .node-header a").removeAttr("href");  
};


/****************************************************\
  Menu Term Highlight
  ---------------------------------------------------
  name    -> dthemeTermHighlight
  version -> 2.0
  info    -> copies the node from one block into the
             menu if the navterms match.

\****************************************************/

Drupal.behaviors.wmaHighlight = function(context) {
  $.each($("#nice-menu-1 > li:visible", context), function (k,li) {
    var navterm = $(li).attr('class').match(/menu-path-taxonomy-term-(\w+)\s/);
    if (navterm) {
      navterm = navterm[1];
      $(li).children("ul").append("<li class='term-highlight te-bpad-0 te-bm-0 icp-nav_term_highlight ip-above'></li>");
      var $node = $("#block-views_blocks-term-block_1-11 .node.wt" + navterm).eq(0).clone();
      $(li).find(".term-highlight").append($node);
    }
  });
};

/****************************************************\
  Orders the dtabs of for posts in a specific order

\****************************************************/
  
Drupal.behaviors.dthemePostTypeTabs = function(context) {
  var block = $('#block-views_blocks-term-block_1-10', context);

  if (block) {  
    var options = [
      {id: "pt452", name: "Partners"},
      {id: "pt438", name: "Premier Sponsors"},
      {id: "pt453", name: "Contact Us"},
    ];
    
    options = options.reverse();
    
    block.prepend('<div class="dtabs-temp"></div>');
    var temp  = $('.dtabs-temp' ,block);
    var dtabs = $('.dtabs', block);
    var tabs  = $('.tab', dtabs);
        
    // make temp grid of all available options as placeholder containers.
    $.each(options, function(key, option) {
      temp.append('<div class="temp-tab tab-'+options[key].id+'"></div>');
    });
           
    // stage the matching tab into the temp grid.
    $.each(tabs, function(key, tab) {
      for (var i = 0; i < options.length; i += 1) {
        if ($(tab).hasClass('tab-'+options[i].id)) {
          $(tab).removeAttr('class').addClass('tab tab-'+options[i].id+' reordered-tab');
          $('.tab-'+options[i].id, temp).replaceWith($(tab));
        }
      }
    });
    
    // move the stagged tab into the proper sequence of the dtabs container.
    $.each($('.reordered-tab', temp), function(key, tab) {
      $(tab).prependTo(dtabs);
      $(tab).addClass('tab-'+(key+1)).removeClass('reordered-tab');
    });
    
    // remove the temp grid element.
    temp.remove();

    // simulate a click of the first tab.
    $('.tab:first', dtabs).click();
  }

};


/* =============================================== *\
   Change parent z-index when dd-hover box appears
\* =============================================== */

Drupal.behaviors.dthemeDDHoverZIndex = function(context) {
  $(".dd-hover-expand", context).click(function() {
  if (! $(this).hasClass('dd-hover-expanded')) {
    $.each($(this).parents(), function(k,v) {
      var position = $(v).css('position');
      if (position == 'relative') {
        $(v).addClass('pull-forward');
      }
    });
  }
  else {
    $('.pull-forward').removeClass('pull-forward');
  }
});
};


/* =============================================== *\
   Remove image link in specific pod
\* =============================================== */

Drupal.behaviors.dthemeRemoveOverviewTitleLink = function(context) {
  $('#node-2025-teaser .field-image a').click(function(e) {
    e.preventDefault();
});
};



/* ===== GALLERY PLUGIN ===== */
Drupal.behaviors.dthemeGalleryPlugin = function(context) {
  $('#node-full.wt486', context).gallery();
};


// Infinity Carousel
Drupal.behaviors.dthemeInfinityCarousel = function(context) {
  $('#block-views_blocks-term-block_1-13, #block-views_blocks-term-block_1-14, #block-views_blocks-term-block_1-15', context).infinityCarousel({
    overflow: false,
    slideDuration: 300,
    slidesToOffsetBy: 0,
    advanceToSlideClicked: false,
    offsetReferenceSelector: '#footer',
    // the whole plugin element
    carouselWidth: 960,
    carouselHeight: 160,
    // carousel slides
    carouselSlideWidth: 160,
    carouselSlideHeight: 160,
    // filmstrip
    hasFilmstrip: false,
    // autoSlide
    autoSlide: true,
    autoSlideDuration: 3000,
    // main carousel arrows
    hasCarouselArrows: true,
    hasStickyCarouselArrows: false
  });
};
    
/* Infinity Carousel
Drupal.behaviors.dthemeInfinityCarousel = function(context) {
  $('#block-views_blocks-term-block_1-13, #block-views_blocks-term-block_1-14, #block-views_blocks-term-block_1-15', context).infinityCarousel(
    {
      overflow: false,
      autoSlide: true,
      preventFOUC: true,
      hasCarouselArrows: true,
      hasCarouselFilmstrip: false,
      hasStickyNavigation: false,
      hasFilmstripTitles: false,
      carouselSlideWidth: 160,
      carouselSlideHeight: 120,
      slideDuration: 300,
      autoSlideDuration: 3000,
      navigationArrowWidth: 60,
      filmstripMarkersPerPage: 6,
      imageCachePreset: 'thumbnail'
    }
  );
};
*/

// Fantabulous: order dependant
Drupal.behaviors.dthemeFantabulous = function(context) {
  $('#block-views_blocks-term-block_1-15, #block-views_blocks-term-block_1-14, #block-views_blocks-term-block_1-13', context).fantabulous({
    duration: 500,
    defaultSelected: 0,
    tabbedBy: "viewsBlocks"
  });
};
;
