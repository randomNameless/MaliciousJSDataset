!function(){"use strict";var Trigger=function(){function e(e,t){this.referencedTags=[],this.theTrigger={},this.id=e.id,this.triggerKey=e.triggerKey,this.triggerKey in t&&(this.theTrigger=new t[this.triggerKey])}return e.prototype.getId=function(){return this.id},e.prototype.addReferencedTag=function(e){this.referencedTags.push(e)},e.prototype.getReferencedTags=function(){return this.referencedTags},e.prototype.setUp=function(){if(this.theTrigger&&this.theTrigger.setUp){var e=this;this.theTrigger.setUp(function(t){if("event"in t&&e.meetsConditions())for(var n=0,r=e.getReferencedTags();n<r.length;n++){r[n].fire()}})}},e.prototype.meetsConditions=function(){return!0},e}(),Tag=function(){function e(e,t){this.theTag={},this.id=e.id,this.tagKey=e.tagKey,this.tagKey in t&&(this.theTag=new t[this.tagKey])}return e.prototype.fire=function(){this.theTag&&this.theTag.fire&&this.theTag.fire()},e}(),Container=function(){function e(e,t){if(this.triggers=[],this.tags=[],this.id=e.id,this.templates=t,e.triggerConfigs)for(var n=0,r=e.triggerConfigs;n<r.length;n++){var i=r[n];this.addTrigger(i)}if(e.tagConfigs)for(var o=0,a=e.tagConfigs;o<a.length;o++){var c=a[o],u=new Tag(c,this.templates);if(this.tags.push(u),c.fireTriggerIds)for(var l=0,s=c.fireTriggerIds;l<s.length;l++){var d=s[l],f=this.getTriggerById(d);f&&f.addReferencedTag(u)}}}return e.prototype.addTrigger=function(e){var t=this.getTriggerById(e.id);t||(t=new Trigger(e,this.templates),this.triggers.push(t))},e.prototype.getTriggerById=function(e){for(var t=0,n=this.triggers;t<n.length;t++){var r=n[t];if(r.getId()===e)return r}return undefined},e.prototype.run=function(){for(var e=0,t=this.triggers;e<t.length;e++){t[e].setUp()}},e}(),TagManager=function(){function e(){this.containers=[]}return e.prototype.addContainer=function(e,t){var n=new Container(e,t);this.containers.push(n),n.run()},e}();const tag_manager=TagManager;window.BdashTagManager=new tag_manager;var templates={UtilTag:function(){this.fire=function(){var e,t,n,r,i,o,a,c,u,l,s,d,f,h,m,g,p,w,v,_,y,b,C,x,k,T,V,A,E,D,S,B,F,R,O,I,j,L,U,P,M,$;!function(){
/* Copyright (C) 1999 Masanao Izumo <iz@onicos.co.jp>
   * Version: 1.0.1
   * LastModified: Dec 25 1999
   */
var e=32768,t=0,n=1,r=2,i=6,o=!0,a=32768,c=64,u=8192,l=2*e,s=3,d=258,f=16,h=8192,m=13;h>a&&alert("error: zip_INBUFSIZ is too small"),e<<1>1<<f&&alert("error: zip_WSIZE is too large"),m>f-1&&alert("error: zip_HASH_BITS is too large"),(m<8||258!=d)&&alert("error: Code too clever");var g,p,w,v,_,y,b,C,x,k,T,V,A,E,D,S,B,F,R,O,I,j,L,U,P,M,$,q,K,X,H,N,Y,J,z,Q,W,Z,G,ee,te,ne,re,ie,oe,ae,ce,ue,le,se,de,fe,he,me,ge,pe,we=h,ve=1<<m,_e=ve-1,ye=e-1,be=0,Ce=4096,xe=d+s+1,ke=e-xe,Te=1,Ve=15,Ae=7,Ee=29,De=256,Se=256,Be=De+1+Ee,Fe=30,Re=19,Oe=16,Ie=17,je=18,Le=2*Be+1,Ue=parseInt((m+s-1)/s),Pe=null,Me=function(){this.fc=0,this.dl=0},$e=function(){this.dyn_tree=null,this.static_tree=null,this.extra_bits=null,this.extra_base=0,this.elems=0,this.max_length=0,this.max_code=0},qe=function(e,t,n,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r},Ke=function(){this.next=null,this.len=0,this.ptr=new Array(u),this.off=0},Xe=new Array(0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0),He=new Array(0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13),Ne=new Array(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7),Ye=new Array(16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15),Je=new Array(new qe(0,0,0,0),new qe(4,4,8,4),new qe(4,5,16,8),new qe(4,6,32,32),new qe(4,4,16,16),new qe(8,16,32,32),new qe(8,16,128,128),new qe(8,32,128,256),new qe(32,128,258,1024),new qe(32,258,258,4096)),ze=function(e){var t;if(e?e<1?e=1:e>9&&(e=9):e=i,$=e,v=!1,L=!1,null==Pe){for(g=p=w=null,Pe=new Array(u),C=new Array(l),x=new Array(we),k=new Array(a+c),T=new Array(1<<f),X=new Array(Le),t=0;t<Le;t++)X[t]=new Me;for(H=new Array(2*Fe+1),t=0;t<2*Fe+1;t++)H[t]=new Me;for(N=new Array(Be+2),t=0;t<Be+2;t++)N[t]=new Me;for(Y=new Array(Fe),t=0;t<Fe;t++)Y[t]=new Me;for(J=new Array(2*Re+1),t=0;t<2*Re+1;t++)J[t]=new Me;z=new $e,Q=new $e,W=new $e,Z=new Array(Ve+1),G=new Array(2*Be+1),ne=new Array(2*Be+1),re=new Array(d-s+1),ie=new Array(512),oe=new Array(Ee),ae=new Array(Fe),ce=new Array(parseInt(h/8))}},Qe=function(e){e.next=g,g=e},We=function(){var e;return null!=g?(e=g,g=g.next):e=new Ke,e.next=null,e.len=e.off=0,e},Ze=function(t){return T[e+t]},Ge=function(t,n){return T[e+t]=n},et=function(e){Pe[y+_++]=e,y+_==u&&Ft()},tt=function(e){e&=65535,y+_<u-2?(Pe[y+_++]=255&e,Pe[y+_++]=e>>>8):(et(255&e),et(e>>>8))},nt=function(){D=(D<<Ue^255&C[I+s-1])&_e,S=Ze(D),T[I&ye]=S,Ge(D,I)},rt=function(e,t){Dt(t[e].fc,t[e].dl)},it=function(e){return 255&(e<256?ie[e]:ie[256+(e>>7)])},ot=function(e,t,n){return e[t].fc<e[n].fc||e[t].fc==e[n].fc&&ne[t]<=ne[n]},at=function(e,t,n){var r;for(r=0;r<n&&pe<ge.length;r++)e[t+r]=255&ge.charCodeAt(pe++);return r},ct=function(){var t;for(t=0;t<ve;t++)T[e+t]=0;if(M=Je[$].max_lazy,q=Je[$].good_length,o||(K=Je[$].nice_length),P=Je[$].max_chain,I=0,E=0,(U=at(C,0,2*e))<=0)return L=!0,void(U=0);for(L=!1;U<xe&&!L;)lt();for(D=0,t=0;t<s-1;t++)D=(D<<Ue^255&C[t])&_e},ut=function(e){var t,n,r=P,i=I,a=O,c=I>ke?I-ke:be,u=I+d,l=C[i+a-1],s=C[i+a];O>=q&&(r>>=2);do{if(C[(t=e)+a]==s&&C[t+a-1]==l&&C[t]==C[i]&&C[++t]==C[i+1]){i+=2,t++;do{}while(C[++i]==C[++t]&&C[++i]==C[++t]&&C[++i]==C[++t]&&C[++i]==C[++t]&&C[++i]==C[++t]&&C[++i]==C[++t]&&C[++i]==C[++t]&&C[++i]==C[++t]&&i<u);if(n=d-(u-i),i=u-d,n>a){if(j=e,a=n,o){if(n>=d)break}else if(n>=K)break;l=C[i+a-1],s=C[i+a]}}}while((e=T[e&ye])>c&&0!=--r);return a},lt=function(){var t,n,r=l-U-I;if(-1==r)r--;else if(I>=e+ke){for(t=0;t<e;t++)C[t]=C[t+e];for(j-=e,I-=e,E-=e,t=0;t<ve;t++)n=Ze(t),Ge(t,n>=e?n-e:be);for(t=0;t<e;t++)n=T[t],T[t]=n>=e?n-e:be;r+=e}L||((t=at(C,I+U,r))<=0?L=!0:U+=t)},st=function(){for(;0!=U&&null==p;){var e;if(nt(),S!=be&&I-S<=ke&&(R=ut(S))>U&&(R=U),R>=s)if(e=Vt(I-j,R-s),U-=R,R<=M){R--;do{I++,nt()}while(0!=--R);I++}else I+=R,R=0,D=((D=255&C[I])<<Ue^255&C[I+1])&_e;else e=Vt(0,255&C[I]),U--,I++;for(e&&(Tt(0),E=I);U<xe&&!L;)lt()}},dt=function(){for(;0!=U&&null==p;){if(nt(),O=R,B=j,R=s-1,S!=be&&O<M&&I-S<=ke&&((R=ut(S))>U&&(R=U),R==s&&I-j>Ce&&R--),O>=s&&R<=O){var e;e=Vt(I-1-B,O-s),U-=O-1,O-=2;do{I++,nt()}while(0!=--O);F=0,R=s-1,I++,e&&(Tt(0),E=I)}else 0!=F?(Vt(0,255&C[I-1])&&(Tt(0),E=I),I++,U--):(F=1,I++,U--);for(;U<xe&&!L;)lt()}},ft=function(){L||(V=0,A=0,gt(),ct(),p=null,_=0,y=0,F=0,$<=3?(O=s-1,R=0):(R=s-1,F=0,F=0),b=!1)},ht=function(e,t,n){var r;return v||(ft(),v=!0,0!=U)?(r=mt(e,t,n))==n?n:b?r:($<=3?st():dt(),0==U&&(0!=F&&Vt(0,255&C[I-1]),Tt(1),b=!0),r+mt(e,r+t,n-r)):(b=!0,0)},mt=function(e,t,n){var r,i,o;for(r=0;null!=p&&r<n;){for((i=n-r)>p.len&&(i=p.len),o=0;o<i;o++)e[t+r+o]=p.ptr[p.off+o];var a;p.off+=i,p.len-=i,r+=i,0==p.len&&(a=p,p=p.next,Qe(a))}if(r==n)return r;if(y<_){for((i=n-r)>_-y&&(i=_-y),o=0;o<i;o++)e[t+r+o]=Pe[y+o];r+=i,_==(y+=i)&&(_=y=0)}return r},gt=function(){var e,t,n,r,i;if(0==Y[0].dl){for(z.dyn_tree=X,z.static_tree=N,z.extra_bits=Xe,z.extra_base=De+1,z.elems=Be,z.max_length=Ve,z.max_code=0,Q.dyn_tree=H,Q.static_tree=Y,Q.extra_bits=He,Q.extra_base=0,Q.elems=Fe,Q.max_length=Ve,Q.max_code=0,W.dyn_tree=J,W.static_tree=null,W.extra_bits=Ne,W.extra_base=0,W.elems=Re,W.max_length=Ae,W.max_code=0,n=0,r=0;r<Ee-1;r++)for(oe[r]=n,e=0;e<1<<Xe[r];e++)re[n++]=r;for(re[n-1]=r,i=0,r=0;r<16;r++)for(ae[r]=i,e=0;e<1<<He[r];e++)ie[i++]=r;for(i>>=7;r<Fe;r++)for(ae[r]=i<<7,e=0;e<1<<He[r]-7;e++)ie[256+i++]=r;for(t=0;t<=Ve;t++)Z[t]=0;for(e=0;e<=143;)N[e++].dl=8,Z[8]++;for(;e<=255;)N[e++].dl=9,Z[9]++;for(;e<=279;)N[e++].dl=7,Z[7]++;for(;e<=287;)N[e++].dl=8,Z[8]++;for(_t(N,Be+1),e=0;e<Fe;e++)Y[e].dl=5,Y[e].fc=St(e,5);pt()}},pt=function(){var e;for(e=0;e<Be;e++)X[e].fc=0;for(e=0;e<Fe;e++)H[e].fc=0;for(e=0;e<Re;e++)J[e].fc=0;X[Se].fc=1,he=me=0,ue=le=se=0,de=0,fe=1},wt=function(e,t){for(var n=G[t],r=t<<1;r<=ee&&(r<ee&&ot(e,G[r+1],G[r])&&r++,!ot(e,n,G[r]));)G[t]=G[r],t=r,r<<=1;G[t]=n},vt=function(e){var t,n,r,i,o,a,c=e.dyn_tree,u=e.extra_bits,l=e.extra_base,s=e.max_code,d=e.max_length,f=e.static_tree,h=0;for(i=0;i<=Ve;i++)Z[i]=0;for(c[G[te]].dl=0,t=te+1;t<Le;t++)(i=c[c[n=G[t]].dl].dl+1)>d&&(i=d,h++),c[n].dl=i,n>s||(Z[i]++,o=0,n>=l&&(o=u[n-l]),a=c[n].fc,he+=a*(i+o),null!=f&&(me+=a*(f[n].dl+o)));if(0!=h){do{for(i=d-1;0==Z[i];)i--;Z[i]--,Z[i+1]+=2,Z[d]--,h-=2}while(h>0);for(i=d;0!=i;i--)for(n=Z[i];0!=n;)(r=G[--t])>s||(c[r].dl!=i&&(he+=(i-c[r].dl)*c[r].fc,c[r].fc=i),n--)}},_t=function(e,t){var n,r,i=new Array(Ve+1),o=0;for(n=1;n<=Ve;n++)o=o+Z[n-1]<<1,i[n]=o;for(r=0;r<=t;r++){var a=e[r].dl;0!=a&&(e[r].fc=St(i[a]++,a))}},yt=function(e){var t,n,r=e.dyn_tree,i=e.static_tree,o=e.elems,a=-1,c=o;for(ee=0,te=Le,t=0;t<o;t++)0!=r[t].fc?(G[++ee]=a=t,ne[t]=0):r[t].dl=0;for(;ee<2;){var u=G[++ee]=a<2?++a:0;r[u].fc=1,ne[u]=0,he--,null!=i&&(me-=i[u].dl)}for(e.max_code=a,t=ee>>1;t>=1;t--)wt(r,t);do{t=G[Te],G[Te]=G[ee--],wt(r,Te),n=G[Te],G[--te]=t,G[--te]=n,r[c].fc=r[t].fc+r[n].fc,ne[t]>ne[n]+1?ne[c]=ne[t]:ne[c]=ne[n]+1,r[t].dl=r[n].dl=c,G[Te]=c++,wt(r,Te)}while(ee>=2);G[--te]=G[Te],vt(e),_t(r,a)},bt=function(e,t){var n,r,i=-1,o=e[0].dl,a=0,c=7,u=4;for(0==o&&(c=138,u=3),e[t+1].dl=65535,n=0;n<=t;n++)r=o,o=e[n+1].dl,++a<c&&r==o||(a<u?J[r].fc+=a:0!=r?(r!=i&&J[r].fc++,J[Oe].fc++):a<=10?J[Ie].fc++:J[je].fc++,a=0,i=r,0==o?(c=138,u=3):r==o?(c=6,u=3):(c=7,u=4))},Ct=function(e,t){var n,r,i=-1,o=e[0].dl,a=0,c=7,u=4;for(0==o&&(c=138,u=3),n=0;n<=t;n++)if(r=o,o=e[n+1].dl,!(++a<c&&r==o)){if(a<u){do{rt(r,J)}while(0!=--a)}else 0!=r?(r!=i&&(rt(r,J),a--),rt(Oe,J),Dt(a-3,2)):a<=10?(rt(Ie,J),Dt(a-3,3)):(rt(je,J),Dt(a-11,7));a=0,i=r,0==o?(c=138,u=3):r==o?(c=6,u=3):(c=7,u=4)}},xt=function(){var e;for(bt(X,z.max_code),bt(H,Q.max_code),yt(W),e=Re-1;e>=3&&0==J[Ye[e]].dl;e--);return he+=3*(e+1)+5+5+4,e},kt=function(e,t,n){var r;for(Dt(e-257,5),Dt(t-1,5),Dt(n-4,4),r=0;r<n;r++)Dt(J[Ye[r]].dl,3);Ct(X,e-1),Ct(H,t-1)},Tt=function(e){var i,o,a,c,u;if(c=I-E,ce[se]=de,yt(z),yt(Q),a=xt(),(o=me+3+7>>3)<=(i=he+3+7>>3)&&(i=o),c+4<=i&&E>=0)for(Dt((t<<1)+e,3),Bt(),tt(c),tt(~c),u=0;u<c;u++)et(C[E+u]);else o==i?(Dt((n<<1)+e,3),At(N,Y)):(Dt((r<<1)+e,3),kt(z.max_code+1,Q.max_code+1,a+1),At(X,H));pt(),0!=e&&Bt()},Vt=function(e,t){if(k[ue++]=t,0==e?X[t].fc++:(e--,X[re[t]+De+1].fc++,H[it(e)].fc++,x[le++]=e,de|=fe),fe<<=1,0==(7&ue)&&(ce[se++]=de,de=0,fe=1),$>2&&0==(4095&ue)){var n,r=8*ue,i=I-E;for(n=0;n<Fe;n++)r+=H[n].fc*(5+He[n]);if(r>>=3,le<parseInt(ue/2)&&r<parseInt(i/2))return!0}return ue==h-1||le==we},At=function(e,t){var n,r,i,o,a=0,c=0,u=0,l=0;if(0!=ue)do{0==(7&a)&&(l=ce[u++]),r=255&k[a++],0==(1&l)?rt(r,e):(i=re[r],rt(i+De+1,e),0!=(o=Xe[i])&&(r-=oe[i],Dt(r,o)),n=x[c++],i=it(n),rt(i,t),0!=(o=He[i])&&(n-=ae[i],Dt(n,o))),l>>=1}while(a<ue);rt(Se,e)},Et=16,Dt=function(e,t){A>Et-t?(tt(V|=e<<A),V=e>>Et-A,A+=t-Et):(V|=e<<A,A+=t)},St=function(e,t){var n=0;do{n|=1&e,e>>=1,n<<=1}while(--t>0);return n>>1},Bt=function(){A>8?tt(V):A>0&&et(V),V=0,A=0},Ft=function(){if(0!=_){var e,t;for(e=We(),null==p?p=w=e:w=w.next=e,e.len=_-y,t=0;t<e.len;t++)e.ptr[t]=Pe[y+t];_=y=0}},Rt=function(e,t){var n,r;ge=e,pe=0,void 0===t&&(t=i),ze(t);for(var o=new Array(1024),a=[];(n=ht(o,0,o.length))>0;){var c=new Array(n);for(r=0;r<n;r++)c[r]=String.fromCharCode(o[r]);a[a.length]=c.join("")}return ge=null,a.join("")};window.BdashRawDeflate||(window.BdashRawDeflate={}),window.BdashRawDeflate.deflate=Rt}(),w=32768,v=0,_=9,y=6,b=null,C=new Array(0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535),x=new Array(3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0),k=new Array(0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99),T=new Array(1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577),V=new Array(0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13),A=new Array(16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15),E=function(){this.next=null,this.list=null},D=function(){this.e=0,this.b=0,this.n=0,this.t=null},S=function(e,t,n,r,i,o){this.BMAX=16,this.N_MAX=288,this.status=0,this.root=null,this.m=0;var a,c,u,l,s,d,f,h,m,g,p,w,v,_,y,b,C,x=new Array(this.BMAX+1),k=new Array(this.BMAX+1),T=new D,V=new Array(this.BMAX),A=new Array(this.N_MAX),S=new Array(this.BMAX+1);for(C=this.root=null,d=0;d<x.length;d++)x[d]=0;for(d=0;d<k.length;d++)k[d]=0;for(d=0;d<V.length;d++)V[d]=null;for(d=0;d<A.length;d++)A[d]=0;for(d=0;d<S.length;d++)S[d]=0;c=t>256?e[256]:this.BMAX,m=e,g=0,d=t;do{x[m[g]]++,g++}while(--d>0);if(x[0]==t)return this.root=null,this.m=0,void(this.status=0);for(f=1;f<=this.BMAX&&0==x[f];f++);for(h=f,o<f&&(o=f),d=this.BMAX;0!=d&&0==x[d];d--);for(l=d,o>d&&(o=d),_=1<<f;f<d;f++,_<<=1)if((_-=x[f])<0)return this.status=2,void(this.m=o);if((_-=x[d])<0)return this.status=2,void(this.m=o);for(x[d]+=_,S[1]=f=0,m=x,g=1,v=2;--d>0;)S[v++]=f+=m[g++];m=e,g=0,d=0;do{0!=(f=m[g++])&&(A[S[f]++]=d)}while(++d<t);for(t=S[l],S[0]=d=0,m=A,g=0,s=-1,w=k[0]=0,p=null,y=0;h<=l;h++)for(a=x[h];a-- >0;){for(;h>w+k[1+s];){if(w+=k[1+s],s++,y=(y=l-w)>o?o:y,(u=1<<(f=h-w))>a+1)for(u-=a+1,v=h;++f<y&&!((u<<=1)<=x[++v]);)u-=x[v];for(w+f>c&&w<c&&(f=c-w),y=1<<f,k[1+s]=f,p=new Array(y),b=0;b<y;b++)p[b]=new D;(C=null==C?this.root=new E:C.next=new E).next=null,C.list=p,V[s]=p,s>0&&(S[s]=d,T.b=k[s],T.e=16+f,T.t=p,f=(d&(1<<w)-1)>>w-k[s],V[s-1][f].e=T.e,V[s-1][f].b=T.b,V[s-1][f].n=T.n,V[s-1][f].t=T.t)}for(T.b=h-w,g>=t?T.e=99:m[g]<n?(T.e=m[g]<256?16:15,T.n=m[g++]):(T.e=i[m[g]-n],T.n=r[m[g++]-n]),u=1<<h-w,f=d>>w;f<y;f+=u)p[f].e=T.e,p[f].b=T.b,p[f].n=T.n,p[f].t=T.t;for(f=1<<h-1;0!=(d&f);f>>=1)d^=f;for(d^=f;(d&(1<<w)-1)!=S[s];)w-=k[s],s--}this.m=k[1],this.status=0!=_&&1!=l?1:0},B=function(){return g.length==p?-1:255&g.charCodeAt(p++)},F=function(e){for(;a<e;)o|=B()<<a,a+=8},R=function(e){return o&C[e]},O=function(e){o>>=e,a-=e},I=function(n,r,i){var o,a,u;if(0==i)return 0;for(u=0;;){for(F(h),o=(a=d.list[R(h)]).e;o>16;){if(99==o)return-1;O(a.b),F(o-=16),o=(a=a.t[R(o)]).e}if(O(a.b),16!=o){if(15==o)break;for(F(o),l=a.n+R(o),O(o),F(m),o=(a=f.list[R(m)]).e;o>16;){if(99==o)return-1;O(a.b),F(o-=16),o=(a=a.t[R(o)]).e}for(O(a.b),F(o),s=t-a.n-R(o),O(o);l>0&&u<i;)l--,s&=w-1,t&=w-1,n[r+u++]=e[t++]=e[s++];if(u==i)return i}else if(t&=w-1,n[r+u++]=e[t++]=a.n,u==i)return i}return c=-1,u},j=function(n,r,i){var u;if(O(u=7&a),F(16),u=R(16),O(16),F(16),u!=(65535&~o))return-1;for(O(16),l=u,u=0;l>0&&u<i;)l--,t&=w-1,F(8),n[r+u++]=e[t++]=R(8),O(8);return 0==l&&(c=-1),u},L=function(e,t,o){if(null==b){var a,c,u=new Array(288);for(a=0;a<144;a++)u[a]=8;for(;a<256;a++)u[a]=9;for(;a<280;a++)u[a]=7;for(;a<288;a++)u[a]=8;if(0!=(c=new S(u,288,257,x,k,r=7)).status)return alert("HufBuild error: "+c.status),-1;for(b=c.root,r=c.m,a=0;a<30;a++)u[a]=5;if((c=new S(u,30,0,T,V,i=5)).status>1)return b=null,alert("HufBuild error: "+c.status),-1;n=c.root,i=c.m}return d=b,f=n,h=r,m=i,I(e,t,o)},U=function(e,t,n){var r,i,o,a,c,u,l,s,g,p=new Array(316);for(r=0;r<p.length;r++)p[r]=0;if(F(5),l=257+R(5),O(5),F(5),s=1+R(5),O(5),F(4),u=4+R(4),O(4),l>286||s>30)return-1;for(i=0;i<u;i++)F(3),p[A[i]]=R(3),O(3);for(;i<19;i++)p[A[i]]=0;if(0!=(g=new S(p,19,19,null,null,h=7)).status)return-1;for(d=g.root,h=g.m,a=l+s,r=o=0;r<a;)if(F(h),i=(c=d.list[R(h)]).b,O(i),(i=c.n)<16)p[r++]=o=i;else if(16==i){if(F(2),i=3+R(2),O(2),r+i>a)return-1;for(;i-- >0;)p[r++]=o}else if(17==i){if(F(3),i=3+R(3),O(3),r+i>a)return-1;for(;i-- >0;)p[r++]=0;o=0}else{if(F(7),i=11+R(7),O(7),r+i>a)return-1;for(;i-- >0;)p[r++]=0;o=0}if(g=new S(p,l,257,x,k,h=_),0==h&&(g.status=1),0!=g.status)return g.status,-1;for(d=g.root,h=g.m,r=0;r<s;r++)p[r]=p[r+l];return g=new S(p,s,0,T,V,m=y),f=g.root,0==(m=g.m)&&l>257?-1:(g.status,0!=g.status?-1:I(e,t,n))},P=function(){null==e&&(e=new Array(2*w)),t=0,o=0,a=0,c=-1,u=!1,l=s=0,d=null},M=function(n,r,i){var o,a;for(o=0;o<i;){if(u&&-1==c)return o;if(l>0){if(c!=v)for(;l>0&&o<i;)l--,s&=w-1,t&=w-1,n[r+o++]=e[t++]=e[s++];else{for(;l>0&&o<i;)l--,t&=w-1,F(8),n[r+o++]=e[t++]=R(8),O(8);0==l&&(c=-1)}if(o==i)return o}if(-1==c){if(u)break;F(1),0!=R(1)&&(u=!0),O(1),F(2),c=R(2),O(2),d=null,l=0}switch(c){case 0:a=j(n,r+o,i-o);break;case 1:a=null!=d?I(n,r+o,i-o):L(n,r+o,i-o);break;case 2:a=null!=d?I(n,r+o,i-o):U(n,r+o,i-o);break;default:a=-1}if(-1==a)return u?0:-1;o+=a}return o},$=function(e){var t,n;P(),g=e,p=0;for(var r=new Array(1024),i=[];(t=M(r,0,r.length))>0;){var o=new Array(t);for(n=0;n<t;n++)o[n]=String.fromCharCode(r[n]);i[i.length]=o.join("")}return g=null,i.join("")},window.BdashRawDeflate||(window.BdashRawDeflate={}),window.BdashRawDeflate.inflate=$}}};templates.VisitorSessionTag=function(){return function(){this.fire=function(){!function(){function BdashTagUtil(){function matched(e,t,n){var r=encodeCondValue(e),i=encodeCondValue(n);switch(t){case"match":if(r===i)return!0;break;case"not_match":if(r!==i)return!0;break;case"include":if(r.indexOf(i)>=0)return!0;break;case"not_include":if(r.indexOf(i)<0)return!0;break;case"start_with":if(0===r.indexOf(i))return!0;break;case"not_start_with":if(0!==r.indexOf(i))return!0;break;case"end_with":if(new RegExp(i.replace(/[$()*+.[\]{}\\|^\\/,?]/g,"\\$&")+"$").test(r))return!0;break;case"not_end_with":if(!new RegExp(i.replace(/[$()*+.[\]{}\\|^\\/,?]/g,"\\$&")+"$").test(r))return!0;break;case"regex":if(new RegExp(n).test(e))return!0}return!1}function encodeCondValue(e){try{return encodeURIComponent(decodeURIComponent(e))}catch(t){return e}}function findHtmlChild(e,t){return e?e.querySelectorAll(t.element)[t.nth-1]:null}function extractAttributeValue(e,t){return e.getAttribute(t.key)}function extractString(e,t){switch(t.extract_type||t.type){case"left":var n=t.extract_length||t.length;return e.slice(0,1*n);case"mid":var r=t.extract_start||t.start,i=t.extract_end||t.end;return e.substring(1*r-1,1*i);case"right":n=t.extract_length||t.length;return e.slice(-1*n);default:return e}}function encodeCookieValue(e){var t=encodeURIComponent(e);if(window.BdashRawDeflate&&window.BdashRawDeflate.deflate&&"function"==typeof window.BdashRawDeflate.deflate){var n=window.BdashRawDeflate.deflate(t);if(window.BdashRawDeflate.inflate&&"function"==typeof window.BdashRawDeflate.inflate)window.BdashRawDeflate.inflate(n)!==t&&(n=window.BdashRawDeflate.deflate(t,3));t=DEFLATED_PREFIX+n}return t=window.btoa(t)}function decodeCookieValue(e){try{var t=!1;0===e.indexOf("@")&&(t=!0,e=e.slice(1));var n,r=window.atob(e);return 0===r.indexOf(DEFLATED_PREFIX)&&(t=!0,r=r.slice(DEFLATED_PREFIX.length)),t&&window.BdashRawDeflate&&window.BdashRawDeflate.inflate&&"function"==typeof window.BdashRawDeflate.inflate&&(n=window.BdashRawDeflate.inflate(r)),decodeURIComponent(n||r)}catch(i){return e}}function shouldFetchCustomColumnOnPageview(e){var t=e.fetch_conditions;return!t||t.pageview.enabled}function shouldFetchCustomColumnOnClick(e,t){var n=e.fetch_conditions;if(!n)return!0;if(!n.click.enabled)return!1;if("all"===n.click.condition.target)return!0;var r=n.click.condition.element_conditions,i=t&&t.target;if(!i)return!1;for(var o=i.parentElement,a=0;a<r.length;a++){var c=r[a];if(c.child&&c.child.enabled)for(var u=(o&&o.getAttribute(c.element_type)).split(" "),l=0;l<u.length;l++){if(matched(u[l],c.operator,c.value))if(o.querySelectorAll(c.child.tag_name)[c.child.nth-1]==i)return!0}else for(u=i.getAttribute(c.element_type).split(" "),l=0;l<u.length;l++)if(matched(u[l],c.operator,c.value))return!0}return!1}function filterByDomainLevel(e,t){for(var n,r=[],i=[],o=0;o<e.length;o++){var a=e[o];a.domainLevel===t?r.push(a):undefined===n||a.domainLevel<n?(i=[a],n=a.domainLevel):a.domainLevel===n&&i.push(a)}return 0<r.length?r:i}function extractFromHtml(e){if(!e.conditions.length)return"";for(var t={match:"=",include:"*=",start_with:"^=",end_with:"$="},n={not_match:"=",not_include:"*=",not_start_with:"^=",not_end_with:"$="},r=0;r<e.conditions.length;r++){var i=e.conditions[r],o=[];if(t[i.matching]){var a=t[i.matching],c="["+i.type+a+'"'+i.name+'"]';o=document.querySelectorAll(c)}if(n[i.matching]){a=n[i.matching],c="["+i.type+":not(["+i.type+a+'"'+i.name+'"]';o=document.querySelectorAll(c)}if("regex"==i.matching){var u=document.querySelectorAll("["+i.type+"]"),l=new RegExp(i.name);o=Array.from(u).filter(e=>l.test(e[i.type]))}if(o.length){var s=o[i.nth?i.nth-1:0];if(i.child&&i.child.enabled&&(s=findHtmlChild(s,i.child)),s){if(i.attribute&&i.attribute.enabled)return extractAttributeValue(s,i.attribute)||"";var d=s.outerHTML,f=d.indexOf(">")+1,h=d.lastIndexOf("<");return extractString(d=d.substring(f,h),e.extract)}}}}function extractFromJs(e){return window[e.conditions[0].name]||""}function extractByCustomScript(conditions){var customValue="";return eval(conditions.custom_script),customValue}function extractFromSourceCode(e){switch(e.source_type){case"html":return extractFromHtml(e);case"javascript":return extractFromJs(e);case"others":return extractByCustomScript(e)}return""}function extractFromUrl(e){var t=e.urls&&e.urls[0]||{},n=t.matching,r=self.getCurrentPageUrl();if("regex"===n){var i=new RegExp(t.name),o=r.match(i);return o&&o[0]||""}return"extract"===n?extractString(r,t):""}function extractFromCookie(e){for(var t=e.name,n=e.values||[],r=self.getCookieValues(t),i=0;i<r.length;i++)if(0===n.length||self.matchAny(r[i],n,"name","matching"))return r[i]}var self=this,DEFLATED_PREFIX="bd4_";this.getCurrentPageUrl=function(){var e="";if(window.dataLayer&&"[object Array]"===Object.prototype.toString.apply(window.dataLayer))for(var t=0;t<window.dataLayer.length;t++){var n=window.dataLayer[t];if(n&&"page_viewed"===n.event){e=n.url;break}}return e||(e=location.href),e},this.matchAny=function(e,t,n,r){for(var i=0;i<t.length;i++){var o=t[i];if(matched(e,o[r],o[n]))return!0}return!1},this.isString=function(e){return"[object String]"===Object.prototype.toString.apply(e)},this.isObject=function(e){return"[object Object]"===Object.prototype.toString.apply(e)},this.isArray=function(e){return"[object Array]"===Object.prototype.toString.apply(e)},this.isFunction=function(e){return"[object Function]"===Object.prototype.toString.apply(e)},this.getUnixtimeSec=function(){return Math.floor((new Date).getTime()/1e3)},this.isEncodingCookie=function(e){return["_bdnvf","_bd_prev_page","_bd_prev_page_ex","_bdcid","_bd_reception_request_timestamp"].indexOf(e)>=0},this.restoreCookieValue=function(e,t){return self.isEncodingCookie(e)?decodeCookieValue(t):t},this.getCookieValues=function(e){for(var t=[],n=document.cookie.split(";"),r=new RegExp("^\\s*"+e+"=\\s*(.*)\\s*$"),i=0;i<n.length;i++){var o=n[i].match(r);o&&t.push(self.restoreCookieValue(e,o[1]))}return t},this.getCookieValue=function(e){return self.getCookieValues(e)[0]},this.setCookie=function(e,t,n,r,i){var o=e+"="+(self.isEncodingCookie(e)?encodeCookieValue(t):t)+";";n&&(o+="expires="+new Date((new Date).getTime()+n).toUTCString()+";"),r&&(o+="domain="+r+";"),i&&(o+="path="+(i||"/")+";");var a=document.cookie;if(document.cookie=o,document.cookie!==a)return!0;for(var c=self.getCookieValues(e),u=0;u<c.length;u++)if(t===c[u])return!0;return!1},this.generateCookieStoreValue=function(e,t){return e&&t?["BD",e,t.split(".").length].join("."):""},this.extractValueFromCookie=function(e){var t,n=self.getCookieValues(e);if(n.length>0){for(var r=[],i=location.hostname.split("."),o=0;!t&&o<n.length;o++){var a=n[o].match(/^BD\.(.+)\.(\d+)$/);a&&r.push({domainLevel:1*a[2],value:a[1]})}if(0===r.length)t=n[0];else if(1===r.length)t=r[0].value;else{var c=i&&i.length,u=c&&filterByDomainLevel(r,c);t=u&&u[0]&&u[0].value}}return t},this.stringIncludes=function(e,t){return String.prototype.includes=function(e){var t=!1;return-1!==this.indexOf(e)&&(t=!0),t},e.includes(t)},this.isTargetDomain=function(){for(var e=[{domain:"www.miyakohotels.ne.jp",exclude_conditions:[]},{domain:"reservation.miyakohotels.ne.jp",exclude_conditions:[]}],t=0;t<e.length;t++){var n=e[t];if(location.hostname===n.domain&&!self.matchAny(self.getCurrentPageUrl(),n.exclude_conditions,"url","cond"))return!0}return!1},this.extractFromSource=function(e){try{var t="",n=e.source_type,r=e.source_conditions||{};switch(n){case"source_code":t=extractFromSourceCode(r);break;case"url":t=extractFromUrl(r);break;case"cookie":t=extractFromCookie.bind(this,r)()}return t}catch(i){return console.error(i),""}};var customColumns=[{id:"1",column_no:"1",relation_setting_id:"2",source_type:"cookie",column_type:"customer_id",page_conditions:[{id:1,matching:"match",name:"https://www.miyakohotels.ne.jp/member/"}],source_conditions:{name:"\u9867\u5ba2ID",values:[{id:0,matching:"match",name:"membership_number"}]},fetch_conditions:null},{id:"2",column_no:"11",relation_setting_id:"3",source_type:"source_code",column_type:"customer_id",page_conditions:[{id:0,matching:"include",name:"https://www.miyakohotels.ne.jp/member"},{id:1,matching:"include",name:"https://reservation.miyakohotels.ne.jp/my-account/"}],source_conditions:{custom_script:"try{\n    var bdCustomerId = document.querySelector('.tbl_complete .td_inner,.profile-item.text-truncate,.box_member .number').textContent.match(/\\d+/g)[0];\n    customValue = bdCustomerId;\n}\ncatch(e){\n    //\u51e6\u7406\u3057\u306a\u3044\n};",source_type:"others"},fetch_conditions:{click:{condition:{element_conditions:[{child:{enabled:!1,nth:1,tag_name:""},element_type:"id",id:1,operator:"match",value:""}],target:"all"},enabled:!0},pageview:{enabled:!0}}}];this.getCustomColumns=function(){return customColumns},this.canExtractValue=function(e,t,n){switch(t){case"pageview":if(!shouldFetchCustomColumnOnPageview(e))return!1;break;case"click":if(!shouldFetchCustomColumnOnClick(e,n))return!1;break;default:return console.error("eventType: "+t+" \u306f\u60f3\u5b9a\u5916\u306e\u5024\u3067\u3059\u3002"),!1}return!0},this.extractValue=function(e,t,n){if(self.matchAny(self.getCurrentPageUrl(),e.page_conditions,"name","matching"))try{if(!self.canExtractValue(e,t,n))return null;var r=self.extractFromSource(e);return{key:"customColumn"+e.column_no,value:r,column_type:e.column_type}}catch(i){return null}return null},this.getCustomColumnValues=function(e,t){for(var n=[],r=0;r<customColumns.length;r++){var i=self.extractValue(customColumns[r],e,t);i&&n.push(i)}return n},this.escapeValue=function(e){if("string"!=typeof e)return e;var t=e.replace(/\"/g,'""');return((t=t.trim()).indexOf(",")>=0||t.match(/\t|\n/))&&(t='"'+t+'"'),t}}var util=new BdashTagUtil;if(util&&(!util.isTargetDomain||"function"!=typeof util.isTargetDomain||util.isTargetDomain())){var toString64=function(e){for(var t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ+-",n="";e>0;)n=t.charAt(e%64)+n,e=Math.floor(e/64);return n},makeRandomNumber=function(e){return Math.round(Math.random()*e)},getIdFromLinker=function(){var e=function(e){var t=5,n=1*e,r=util.getUnixtimeSec();return n>r||r>=n+t},t=util.getCurrentPageUrl().match(/[?&#]_bdsid=([^&#]*)/),n="";if(t&&t[1]&&-1<t[1].indexOf(".")){var r=t[1].split(".");(3===r.length&&document.referrer||4===r.length&&!e(r[3]))&&(n=[r[0],r[1],r[2]].join(".").replace("~","-"))}return n},getRepeaterFlagFromLinker=function(){var e=util.getCurrentPageUrl().match(/[?&#]_bdrpf=([^&#]*)/);return e?decodeURIComponent(e[1]):null},removeLinkerFromUrl=function(){try{if(!util.isObject(window.bdashFlags)||!window.bdashFlags.removeBdld)return;var e=util.getCurrentPageUrl(),t=e.match(/(.*)([?&#])(?:_bdsid=[^&#]*)(?:&?)(.*)/);t&&3<=t.length&&(e=t[1]+(t[3]?t[2]+t[3]:"")),(t=e.match(/(.*)([?&#])(?:_bdrpf=[^&#]*)(?:&?)(.*)/))&&3<=t.length&&(e=t[1]+(t[3]?t[2]+t[3]:"")),util.isFunction(history.replaceState)&&history.replaceState("","",e)}catch(n){}},createVisitorId=function(){return[toString64(1*makeRandomNumber(4294967295)),toString64(1*(new Date).getTime())].join(".")},setVisitorIdCookie=function(e){for(var t="_bdck",n=63072e6,r="/",i=location.hostname.split("."),o=i.length-1;o>=0;o--){var a=i.slice(o).join("."),c=util.generateCookieStoreValue(e,a);if(util.setCookie(t,c,n,a,r))return window.BdashTagManager.Tracker.cookieDomain=a,!0}return window.BdashTagManager.Tracker.cookieDomain="failed",!1},createSessionId=function(e){return[e,(new Date).getTime()].join(".")},setSessionIdCookie=function(e){for(var t="_bdsid",n=18e5,r="/",i=location.hostname.split("."),o=i.length-1;o>=0;o--){var a=i.slice(o).join("."),c=util.generateCookieStoreValue(e,a);if(util.setCookie(t,c,n,a,r))return!0}return!1},setNewVisitorCookie=function(e,t){for(var n="_bdnvf",r="/",i=location.hostname.split("."),o=i.length-1;o>=0;o--){var a=i.slice(o).join("."),c=util.generateCookieStoreValue(e,a);if(util.setCookie(n,c,t,a,r))return!0}return!1},publishOrKeepVisitorIdAndSessionId=function(){var e=util.extractValueFromCookie("_bdck"),t=util.extractValueFromCookie("_bdsid"),n=getIdFromLinker();if(n){var r=n.split(".");t=n,e=[r[0],r[1]].join("."),"0"===getRepeaterFlagFromLinker()&&setNewVisitorCookie("",-1)}removeLinkerFromUrl(),e||(e=createVisitorId(),t=null),t||(t=createSessionId(e),window.BdashTagManager.Tracker.newSessionFlag="1"),setVisitorIdCookie(e),window.BdashTagManager.Tracker.vid=e,setSessionIdCookie(t),window.BdashTagManager.Tracker.sid=t;var i=util.extractValueFromCookie("_bdnvf");setNewVisitorCookie(i||t,63072e6),(i=util.extractValueFromCookie("_bdnvf"))===t&&(window.BdashTagManager.Tracker.repeaterFlag="0")};window.bdashFlags||(window.bdashFlags={}),window.BdashTagManager.Tracker={},publishOrKeepVisitorIdAndSessionId()}}()}}}(),templates.CmsEmbeddedVisitorTag=function(){return function(){this.fire=function(){!function(){function BdashTagUtil(){function matched(e,t,n){var r=encodeCondValue(e),i=encodeCondValue(n);switch(t){case"match":if(r===i)return!0;break;case"not_match":if(r!==i)return!0;break;case"include":if(r.indexOf(i)>=0)return!0;break;case"not_include":if(r.indexOf(i)<0)return!0;break;case"start_with":if(0===r.indexOf(i))return!0;break;case"not_start_with":if(0!==r.indexOf(i))return!0;break;case"end_with":if(new RegExp(i.replace(/[$()*+.[\]{}\\|^\\/,?]/g,"\\$&")+"$").test(r))return!0;break;case"not_end_with":if(!new RegExp(i.replace(/[$()*+.[\]{}\\|^\\/,?]/g,"\\$&")+"$").test(r))return!0;break;case"regex":if(new RegExp(n).test(e))return!0}return!1}function encodeCondValue(e){try{return encodeURIComponent(decodeURIComponent(e))}catch(t){return e}}function findHtmlChild(e,t){return e?e.querySelectorAll(t.element)[t.nth-1]:null}function extractAttributeValue(e,t){return e.getAttribute(t.key)}function extractString(e,t){switch(t.extract_type||t.type){case"left":var n=t.extract_length||t.length;return e.slice(0,1*n);case"mid":var r=t.extract_start||t.start,i=t.extract_end||t.end;return e.substring(1*r-1,1*i);case"right":n=t.extract_length||t.length;return e.slice(-1*n);default:return e}}function encodeCookieValue(e){var t=encodeURIComponent(e);if(window.BdashRawDeflate&&window.BdashRawDeflate.deflate&&"function"==typeof window.BdashRawDeflate.deflate){var n=window.BdashRawDeflate.deflate(t);if(window.BdashRawDeflate.inflate&&"function"==typeof window.BdashRawDeflate.inflate)window.BdashRawDeflate.inflate(n)!==t&&(n=window.BdashRawDeflate.deflate(t,3));t=DEFLATED_PREFIX+n}return t=window.btoa(t)}function decodeCookieValue(e){try{var t=!1;0===e.indexOf("@")&&(t=!0,e=e.slice(1));var n,r=window.atob(e);return 0===r.indexOf(DEFLATED_PREFIX)&&(t=!0,r=r.slice(DEFLATED_PREFIX.length)),t&&window.BdashRawDeflate&&window.BdashRawDeflate.inflate&&"function"==typeof window.BdashRawDeflate.inflate&&(n=window.BdashRawDeflate.inflate(r)),decodeURIComponent(n||r)}catch(i){return e}}function shouldFetchCustomColumnOnPageview(e){var t=e.fetch_conditions;return!t||t.pageview.enabled}function shouldFetchCustomColumnOnClick(e,t){var n=e.fetch_conditions;if(!n)return!0;if(!n.click.enabled)return!1;if("all"===n.click.condition.target)return!0;var r=n.click.condition.element_conditions,i=t&&t.target;if(!i)return!1;for(var o=i.parentElement,a=0;a<r.length;a++){var c=r[a];if(c.child&&c.child.enabled)for(var u=(o&&o.getAttribute(c.element_type)).split(" "),l=0;l<u.length;l++){if(matched(u[l],c.operator,c.value))if(o.querySelectorAll(c.child.tag_name)[c.child.nth-1]==i)return!0}else for(u=i.getAttribute(c.element_type).split(" "),l=0;l<u.length;l++)if(matched(u[l],c.operator,c.value))return!0}return!1}function filterByDomainLevel(e,t){for(var n,r=[],i=[],o=0;o<e.length;o++){var a=e[o];a.domainLevel===t?r.push(a):undefined===n||a.domainLevel<n?(i=[a],n=a.domainLevel):a.domainLevel===n&&i.push(a)}return 0<r.length?r:i}function extractFromHtml(e){if(!e.conditions.length)return"";for(var t={match:"=",include:"*=",start_with:"^=",end_with:"$="},n={not_match:"=",not_include:"*=",not_start_with:"^=",not_end_with:"$="},r=0;r<e.conditions.length;r++){var i=e.conditions[r],o=[];if(t[i.matching]){var a=t[i.matching],c="["+i.type+a+'"'+i.name+'"]';o=document.querySelectorAll(c)}if(n[i.matching]){a=n[i.matching],c="["+i.type+":not(["+i.type+a+'"'+i.name+'"]';o=document.querySelectorAll(c)}if("regex"==i.matching){var u=document.querySelectorAll("["+i.type+"]"),l=new RegExp(i.name);o=Array.from(u).filter(e=>l.test(e[i.type]))}if(o.length){var s=o[i.nth?i.nth-1:0];if(i.child&&i.child.enabled&&(s=findHtmlChild(s,i.child)),s){if(i.attribute&&i.attribute.enabled)return extractAttributeValue(s,i.attribute)||"";var d=s.outerHTML,f=d.indexOf(">")+1,h=d.lastIndexOf("<");return extractString(d=d.substring(f,h),e.extract)}}}}function extractFromJs(e){return window[e.conditions[0].name]||""}function extractByCustomScript(conditions){var customValue="";return eval(conditions.custom_script),customValue}function extractFromSourceCode(e){switch(e.source_type){case"html":return extractFromHtml(e);case"javascript":return extractFromJs(e);case"others":return extractByCustomScript(e)}return""}function extractFromUrl(e){var t=e.urls&&e.urls[0]||{},n=t.matching,r=self.getCurrentPageUrl();if("regex"===n){var i=new RegExp(t.name),o=r.match(i);return o&&o[0]||""}return"extract"===n?extractString(r,t):""}function extractFromCookie(e){for(var t=e.name,n=e.values||[],r=self.getCookieValues(t),i=0;i<r.length;i++)if(0===n.length||self.matchAny(r[i],n,"name","matching"))return r[i]}var self=this,DEFLATED_PREFIX="bd4_";this.getCurrentPageUrl=function(){var e="";if(window.dataLayer&&"[object Array]"===Object.prototype.toString.apply(window.dataLayer))for(var t=0;t<window.dataLayer.length;t++){var n=window.dataLayer[t];if(n&&"page_viewed"===n.event){e=n.url;break}}return e||(e=location.href),e},this.matchAny=function(e,t,n,r){for(var i=0;i<t.length;i++){var o=t[i];if(matched(e,o[r],o[n]))return!0}return!1},this.isString=function(e){return"[object String]"===Object.prototype.toString.apply(e)},this.isObject=function(e){return"[object Object]"===Object.prototype.toString.apply(e)},this.isArray=function(e){return"[object Array]"===Object.prototype.toString.apply(e)},this.isFunction=function(e){return"[object Function]"===Object.prototype.toString.apply(e)},this.getUnixtimeSec=function(){return Math.floor((new Date).getTime()/1e3)},this.isEncodingCookie=function(e){return["_bdnvf","_bd_prev_page","_bd_prev_page_ex","_bdcid","_bd_reception_request_timestamp"].indexOf(e)>=0},this.restoreCookieValue=function(e,t){
return self.isEncodingCookie(e)?decodeCookieValue(t):t},this.getCookieValues=function(e){for(var t=[],n=document.cookie.split(";"),r=new RegExp("^\\s*"+e+"=\\s*(.*)\\s*$"),i=0;i<n.length;i++){var o=n[i].match(r);o&&t.push(self.restoreCookieValue(e,o[1]))}return t},this.getCookieValue=function(e){return self.getCookieValues(e)[0]},this.setCookie=function(e,t,n,r,i){var o=e+"="+(self.isEncodingCookie(e)?encodeCookieValue(t):t)+";";n&&(o+="expires="+new Date((new Date).getTime()+n).toUTCString()+";"),r&&(o+="domain="+r+";"),i&&(o+="path="+(i||"/")+";");var a=document.cookie;if(document.cookie=o,document.cookie!==a)return!0;for(var c=self.getCookieValues(e),u=0;u<c.length;u++)if(t===c[u])return!0;return!1},this.generateCookieStoreValue=function(e,t){return e&&t?["BD",e,t.split(".").length].join("."):""},this.extractValueFromCookie=function(e){var t,n=self.getCookieValues(e);if(n.length>0){for(var r=[],i=location.hostname.split("."),o=0;!t&&o<n.length;o++){var a=n[o].match(/^BD\.(.+)\.(\d+)$/);a&&r.push({domainLevel:1*a[2],value:a[1]})}if(0===r.length)t=n[0];else if(1===r.length)t=r[0].value;else{var c=i&&i.length,u=c&&filterByDomainLevel(r,c);t=u&&u[0]&&u[0].value}}return t},this.stringIncludes=function(e,t){return String.prototype.includes=function(e){var t=!1;return-1!==this.indexOf(e)&&(t=!0),t},e.includes(t)},this.isTargetDomain=function(){for(var e=[{domain:"www.miyakohotels.ne.jp",exclude_conditions:[]},{domain:"reservation.miyakohotels.ne.jp",exclude_conditions:[]}],t=0;t<e.length;t++){var n=e[t];if(location.hostname===n.domain&&!self.matchAny(self.getCurrentPageUrl(),n.exclude_conditions,"url","cond"))return!0}return!1},this.extractFromSource=function(e){try{var t="",n=e.source_type,r=e.source_conditions||{};switch(n){case"source_code":t=extractFromSourceCode(r);break;case"url":t=extractFromUrl(r);break;case"cookie":t=extractFromCookie.bind(this,r)()}return t}catch(i){return console.error(i),""}};var customColumns=[{id:"1",column_no:"1",relation_setting_id:"2",source_type:"cookie",column_type:"customer_id",page_conditions:[{id:1,matching:"match",name:"https://www.miyakohotels.ne.jp/member/"}],source_conditions:{name:"\u9867\u5ba2ID",values:[{id:0,matching:"match",name:"membership_number"}]},fetch_conditions:null},{id:"2",column_no:"11",relation_setting_id:"3",source_type:"source_code",column_type:"customer_id",page_conditions:[{id:0,matching:"include",name:"https://www.miyakohotels.ne.jp/member"},{id:1,matching:"include",name:"https://reservation.miyakohotels.ne.jp/my-account/"}],source_conditions:{custom_script:"try{\n    var bdCustomerId = document.querySelector('.tbl_complete .td_inner,.profile-item.text-truncate,.box_member .number').textContent.match(/\\d+/g)[0];\n    customValue = bdCustomerId;\n}\ncatch(e){\n    //\u51e6\u7406\u3057\u306a\u3044\n};",source_type:"others"},fetch_conditions:{click:{condition:{element_conditions:[{child:{enabled:!1,nth:1,tag_name:""},element_type:"id",id:1,operator:"match",value:""}],target:"all"},enabled:!0},pageview:{enabled:!0}}}];this.getCustomColumns=function(){return customColumns},this.canExtractValue=function(e,t,n){switch(t){case"pageview":if(!shouldFetchCustomColumnOnPageview(e))return!1;break;case"click":if(!shouldFetchCustomColumnOnClick(e,n))return!1;break;default:return console.error("eventType: "+t+" \u306f\u60f3\u5b9a\u5916\u306e\u5024\u3067\u3059\u3002"),!1}return!0},this.extractValue=function(e,t,n){if(self.matchAny(self.getCurrentPageUrl(),e.page_conditions,"name","matching"))try{if(!self.canExtractValue(e,t,n))return null;var r=self.extractFromSource(e);return{key:"customColumn"+e.column_no,value:r,column_type:e.column_type}}catch(i){return null}return null},this.getCustomColumnValues=function(e,t){for(var n=[],r=0;r<customColumns.length;r++){var i=self.extractValue(customColumns[r],e,t);i&&n.push(i)}return n},this.escapeValue=function(e){if("string"!=typeof e)return e;var t=e.replace(/\"/g,'""');return((t=t.trim()).indexOf(",")>=0||t.match(/\t|\n/))&&(t='"'+t+'"'),t}}var util=new BdashTagUtil;if(util){var OPTIN_KEY="_bd4_optin_tracking_BD-C91DQS";window.BdashTagManager.optinTracking=function(e){var t="/",n=location.hostname.split("."),r=63072e6;e&&(r=e);for(var i=n.length-1;i>=0;i--){var o,a=n.slice(i).join(".");if(util.setCookie(OPTIN_KEY,(new Date).getTime(),r,a,t))return window.BdashTagManager.Optin.tracking=!!util.getCookieValue(OPTIN_KEY),"function"==typeof Event?o=new Event("optin"):(o=document.createEvent("Event")).initEvent("optin",!0,!0),dispatchEvent(o),!0}},window.BdashTagManager.optoutTracking=function(){for(var e="/",t=location.hostname.split("."),n=t.length-1;n>=0;n--){var r=t.slice(n).join(".");window.BdashTagManager.Optin.tracking=!1,util.setCookie(OPTIN_KEY,"",-1,r,e)}var i=new Event("optout");return"function"==typeof Event?i=new Event("optout"):(i=document.createEvent("Event")).initEvent("optout",!0,!0),dispatchEvent(i),!0},window.BdashTagManager.Optin===undefined&&(window.BdashTagManager.Optin={}),window.BdashTagManager.Optin.tracking=!!util.getCookieValue(OPTIN_KEY),window.BdashTagManager.OptinMode=!1;var passVisitorIdToCmsEmbedded=function(){var e=util.extractValueFromCookie("_bdck");passValueToCmsEmbedded(e)},clearVisitorIdToCmsEmbedded=function(){passValueToCmsEmbedded("")},passValueToCmsEmbedded=function(e){var t=0,n={},r=setInterval(function(){searchAndPostValueToCmsEmbedded(e,n),++t>=10&&clearInterval(r)},1e3)},searchAndPostValueToCmsEmbedded=function(e,t){for(var n=document.querySelectorAll('[id^="bdash_embed_form_container_prd_100253_"]'),r=0;r<n.length;r++)if(!t[n[r].id]){var i=n[r].querySelector("iframe");i&&i.loaded&&(i.contentWindow.postMessage(e,i.src),t[n[r].id]=!0)}};window.BdashTagManager.OptinMode&&!window.BdashTagManager.Optin.tracking||passVisitorIdToCmsEmbedded(),addEventListener("optin",function(){passVisitorIdToCmsEmbedded()}),addEventListener("optout",function(){window.BdashTagManager.OptinMode&&clearVisitorIdToCmsEmbedded()})}}()}}}(),templates.AccessLogTag=function(){return function(){this.fire=function(){!function(){function BdashTagUtil(){function matched(e,t,n){var r=encodeCondValue(e),i=encodeCondValue(n);switch(t){case"match":if(r===i)return!0;break;case"not_match":if(r!==i)return!0;break;case"include":if(r.indexOf(i)>=0)return!0;break;case"not_include":if(r.indexOf(i)<0)return!0;break;case"start_with":if(0===r.indexOf(i))return!0;break;case"not_start_with":if(0!==r.indexOf(i))return!0;break;case"end_with":if(new RegExp(i.replace(/[$()*+.[\]{}\\|^\\/,?]/g,"\\$&")+"$").test(r))return!0;break;case"not_end_with":if(!new RegExp(i.replace(/[$()*+.[\]{}\\|^\\/,?]/g,"\\$&")+"$").test(r))return!0;break;case"regex":if(new RegExp(n).test(e))return!0}return!1}function encodeCondValue(e){try{return encodeURIComponent(decodeURIComponent(e))}catch(t){return e}}function findHtmlChild(e,t){return e?e.querySelectorAll(t.element)[t.nth-1]:null}function extractAttributeValue(e,t){return e.getAttribute(t.key)}function extractString(e,t){switch(t.extract_type||t.type){case"left":var n=t.extract_length||t.length;return e.slice(0,1*n);case"mid":var r=t.extract_start||t.start,i=t.extract_end||t.end;return e.substring(1*r-1,1*i);case"right":n=t.extract_length||t.length;return e.slice(-1*n);default:return e}}function encodeCookieValue(e){var t=encodeURIComponent(e);if(window.BdashRawDeflate&&window.BdashRawDeflate.deflate&&"function"==typeof window.BdashRawDeflate.deflate){var n=window.BdashRawDeflate.deflate(t);if(window.BdashRawDeflate.inflate&&"function"==typeof window.BdashRawDeflate.inflate)window.BdashRawDeflate.inflate(n)!==t&&(n=window.BdashRawDeflate.deflate(t,3));t=DEFLATED_PREFIX+n}return t=window.btoa(t)}function decodeCookieValue(e){try{var t=!1;0===e.indexOf("@")&&(t=!0,e=e.slice(1));var n,r=window.atob(e);return 0===r.indexOf(DEFLATED_PREFIX)&&(t=!0,r=r.slice(DEFLATED_PREFIX.length)),t&&window.BdashRawDeflate&&window.BdashRawDeflate.inflate&&"function"==typeof window.BdashRawDeflate.inflate&&(n=window.BdashRawDeflate.inflate(r)),decodeURIComponent(n||r)}catch(i){return e}}function shouldFetchCustomColumnOnPageview(e){var t=e.fetch_conditions;return!t||t.pageview.enabled}function shouldFetchCustomColumnOnClick(e,t){var n=e.fetch_conditions;if(!n)return!0;if(!n.click.enabled)return!1;if("all"===n.click.condition.target)return!0;var r=n.click.condition.element_conditions,i=t&&t.target;if(!i)return!1;for(var o=i.parentElement,a=0;a<r.length;a++){var c=r[a];if(c.child&&c.child.enabled)for(var u=(o&&o.getAttribute(c.element_type)).split(" "),l=0;l<u.length;l++){if(matched(u[l],c.operator,c.value))if(o.querySelectorAll(c.child.tag_name)[c.child.nth-1]==i)return!0}else for(u=i.getAttribute(c.element_type).split(" "),l=0;l<u.length;l++)if(matched(u[l],c.operator,c.value))return!0}return!1}function filterByDomainLevel(e,t){for(var n,r=[],i=[],o=0;o<e.length;o++){var a=e[o];a.domainLevel===t?r.push(a):undefined===n||a.domainLevel<n?(i=[a],n=a.domainLevel):a.domainLevel===n&&i.push(a)}return 0<r.length?r:i}function extractFromHtml(e){if(!e.conditions.length)return"";for(var t={match:"=",include:"*=",start_with:"^=",end_with:"$="},n={not_match:"=",not_include:"*=",not_start_with:"^=",not_end_with:"$="},r=0;r<e.conditions.length;r++){var i=e.conditions[r],o=[];if(t[i.matching]){var a=t[i.matching],c="["+i.type+a+'"'+i.name+'"]';o=document.querySelectorAll(c)}if(n[i.matching]){a=n[i.matching],c="["+i.type+":not(["+i.type+a+'"'+i.name+'"]';o=document.querySelectorAll(c)}if("regex"==i.matching){var u=document.querySelectorAll("["+i.type+"]"),l=new RegExp(i.name);o=Array.from(u).filter(e=>l.test(e[i.type]))}if(o.length){var s=o[i.nth?i.nth-1:0];if(i.child&&i.child.enabled&&(s=findHtmlChild(s,i.child)),s){if(i.attribute&&i.attribute.enabled)return extractAttributeValue(s,i.attribute)||"";var d=s.outerHTML,f=d.indexOf(">")+1,h=d.lastIndexOf("<");return extractString(d=d.substring(f,h),e.extract)}}}}function extractFromJs(e){return window[e.conditions[0].name]||""}function extractByCustomScript(conditions){var customValue="";return eval(conditions.custom_script),customValue}function extractFromSourceCode(e){switch(e.source_type){case"html":return extractFromHtml(e);case"javascript":return extractFromJs(e);case"others":return extractByCustomScript(e)}return""}function extractFromUrl(e){var t=e.urls&&e.urls[0]||{},n=t.matching,r=self.getCurrentPageUrl();if("regex"===n){var i=new RegExp(t.name),o=r.match(i);return o&&o[0]||""}return"extract"===n?extractString(r,t):""}function extractFromCookie(e){for(var t=e.name,n=e.values||[],r=self.getCookieValues(t),i=0;i<r.length;i++)if(0===n.length||self.matchAny(r[i],n,"name","matching"))return r[i]}var self=this,DEFLATED_PREFIX="bd4_";this.getCurrentPageUrl=function(){var e="";if(window.dataLayer&&"[object Array]"===Object.prototype.toString.apply(window.dataLayer))for(var t=0;t<window.dataLayer.length;t++){var n=window.dataLayer[t];if(n&&"page_viewed"===n.event){e=n.url;break}}return e||(e=location.href),e},this.matchAny=function(e,t,n,r){for(var i=0;i<t.length;i++){var o=t[i];if(matched(e,o[r],o[n]))return!0}return!1},this.isString=function(e){return"[object String]"===Object.prototype.toString.apply(e)},this.isObject=function(e){return"[object Object]"===Object.prototype.toString.apply(e)},this.isArray=function(e){return"[object Array]"===Object.prototype.toString.apply(e)},this.isFunction=function(e){return"[object Function]"===Object.prototype.toString.apply(e)},this.getUnixtimeSec=function(){return Math.floor((new Date).getTime()/1e3)},this.isEncodingCookie=function(e){return["_bdnvf","_bd_prev_page","_bd_prev_page_ex","_bdcid","_bd_reception_request_timestamp"].indexOf(e)>=0},this.restoreCookieValue=function(e,t){return self.isEncodingCookie(e)?decodeCookieValue(t):t},this.getCookieValues=function(e){for(var t=[],n=document.cookie.split(";"),r=new RegExp("^\\s*"+e+"=\\s*(.*)\\s*$"),i=0;i<n.length;i++){var o=n[i].match(r);o&&t.push(self.restoreCookieValue(e,o[1]))}return t},this.getCookieValue=function(e){return self.getCookieValues(e)[0]},this.setCookie=function(e,t,n,r,i){var o=e+"="+(self.isEncodingCookie(e)?encodeCookieValue(t):t)+";";n&&(o+="expires="+new Date((new Date).getTime()+n).toUTCString()+";"),r&&(o+="domain="+r+";"),i&&(o+="path="+(i||"/")+";");var a=document.cookie;if(document.cookie=o,document.cookie!==a)return!0;for(var c=self.getCookieValues(e),u=0;u<c.length;u++)if(t===c[u])return!0;return!1},this.generateCookieStoreValue=function(e,t){return e&&t?["BD",e,t.split(".").length].join("."):""},this.extractValueFromCookie=function(e){var t,n=self.getCookieValues(e);if(n.length>0){for(var r=[],i=location.hostname.split("."),o=0;!t&&o<n.length;o++){var a=n[o].match(/^BD\.(.+)\.(\d+)$/);a&&r.push({domainLevel:1*a[2],value:a[1]})}if(0===r.length)t=n[0];else if(1===r.length)t=r[0].value;else{var c=i&&i.length,u=c&&filterByDomainLevel(r,c);t=u&&u[0]&&u[0].value}}return t},this.stringIncludes=function(e,t){return String.prototype.includes=function(e){var t=!1;return-1!==this.indexOf(e)&&(t=!0),t},e.includes(t)},this.isTargetDomain=function(){for(var e=[{domain:"www.miyakohotels.ne.jp",exclude_conditions:[]},{domain:"reservation.miyakohotels.ne.jp",exclude_conditions:[]}],t=0;t<e.length;t++){var n=e[t];if(location.hostname===n.domain&&!self.matchAny(self.getCurrentPageUrl(),n.exclude_conditions,"url","cond"))return!0}return!1},this.extractFromSource=function(e){try{var t="",n=e.source_type,r=e.source_conditions||{};switch(n){case"source_code":t=extractFromSourceCode(r);break;case"url":t=extractFromUrl(r);break;case"cookie":t=extractFromCookie.bind(this,r)()}return t}catch(i){return console.error(i),""}};var customColumns=[{id:"1",column_no:"1",relation_setting_id:"2",source_type:"cookie",column_type:"customer_id",page_conditions:[{id:1,matching:"match",name:"https://www.miyakohotels.ne.jp/member/"}],source_conditions:{name:"\u9867\u5ba2ID",values:[{id:0,matching:"match",name:"membership_number"}]},fetch_conditions:null},{id:"2",column_no:"11",relation_setting_id:"3",source_type:"source_code",column_type:"customer_id",page_conditions:[{id:0,matching:"include",name:"https://www.miyakohotels.ne.jp/member"},{id:1,matching:"include",name:"https://reservation.miyakohotels.ne.jp/my-account/"}],source_conditions:{custom_script:"try{\n    var bdCustomerId = document.querySelector('.tbl_complete .td_inner,.profile-item.text-truncate,.box_member .number').textContent.match(/\\d+/g)[0];\n    customValue = bdCustomerId;\n}\ncatch(e){\n    //\u51e6\u7406\u3057\u306a\u3044\n};",source_type:"others"},fetch_conditions:{click:{condition:{element_conditions:[{child:{enabled:!1,nth:1,tag_name:""},element_type:"id",id:1,operator:"match",value:""}],target:"all"},enabled:!0},pageview:{enabled:!0}}}];this.getCustomColumns=function(){return customColumns},this.canExtractValue=function(e,t,n){switch(t){case"pageview":if(!shouldFetchCustomColumnOnPageview(e))return!1;break;case"click":if(!shouldFetchCustomColumnOnClick(e,n))return!1;break;default:return console.error("eventType: "+t+" \u306f\u60f3\u5b9a\u5916\u306e\u5024\u3067\u3059\u3002"),!1}return!0},this.extractValue=function(e,t,n){if(self.matchAny(self.getCurrentPageUrl(),e.page_conditions,"name","matching"))try{if(!self.canExtractValue(e,t,n))return null;var r=self.extractFromSource(e);return{key:"customColumn"+e.column_no,value:r,column_type:e.column_type}}catch(i){return null}return null},this.getCustomColumnValues=function(e,t){for(var n=[],r=0;r<customColumns.length;r++){var i=self.extractValue(customColumns[r],e,t);i&&n.push(i)}return n},this.escapeValue=function(e){if("string"!=typeof e)return e;var t=e.replace(/\"/g,'""');return((t=t.trim()).indexOf(",")>=0||t.match(/\t|\n/))&&(t='"'+t+'"'),t}}function setCustomColumnValues(e,t){for(var n=util.getCustomColumnValues(e,t),r=0;r<n.length;r++){var i={};i[n[r].key]=util.escapeValue(n[r].value),bdash4("set",i)}}var util=new BdashTagUtil;if(util){var OPTIN_KEY="_bd4_optin_tracking_BD-C91DQS";window.BdashTagManager.optinTracking=function(e){var t="/",n=location.hostname.split("."),r=63072e6;e&&(r=e);for(var i=n.length-1;i>=0;i--){var o,a=n.slice(i).join(".");if(util.setCookie(OPTIN_KEY,(new Date).getTime(),r,a,t))return window.BdashTagManager.Optin.tracking=!!util.getCookieValue(OPTIN_KEY),"function"==typeof Event?o=new Event("optin"):(o=document.createEvent("Event")).initEvent("optin",!0,!0),dispatchEvent(o),!0}},window.BdashTagManager.optoutTracking=function(){for(var e="/",t=location.hostname.split("."),n=t.length-1;n>=0;n--){var r=t.slice(n).join(".");window.BdashTagManager.Optin.tracking=!1,util.setCookie(OPTIN_KEY,"",-1,r,e)}var i=new Event("optout");return"function"==typeof Event?i=new Event("optout"):(i=document.createEvent("Event")).initEvent("optout",!0,!0),dispatchEvent(i),!0},window.BdashTagManager.Optin===undefined&&(window.BdashTagManager.Optin={}),window.BdashTagManager.Optin.tracking=!!util.getCookieValue(OPTIN_KEY),window.BdashTagManager.OptinMode=!1,util.isTargetDomain&&"function"==typeof util.isTargetDomain&&!util.isTargetDomain()||(!function(e,t,n,r){if(!e.bdash4){e.bdash4=function(){e.bdash4.queue.push(arguments)},e.bdash4.queue=[],e.bdash4.load=new Date;var i=t.createElement(n);i.type="text/javascript",i.async=!0,i.src=r;var o=t.getElementsByTagName(n)[0];o.parentNode.insertBefore(i,o)}}(window,document,"script","//cdn.activity.smart-bdash.com/tracking-script/bdash_log.js"),bdash4("create",{id:"BD-C91DQS"}),setCustomColumnValues("pageview"),bdash4("addCallback",{type:"click",callback:function(e){setCustomColumnValues("click",e)}}),bdash4("send",{type:"pageview"}))}}()}}}(),templates.SetCurrentPageTag=function(){return function(){this.fire=function(){!function(){function BdashTagUtil(){function matched(e,t,n){var r=encodeCondValue(e),i=encodeCondValue(n);switch(t){case"match":if(r===i)return!0;break;case"not_match":if(r!==i)return!0;break;case"include":if(r.indexOf(i)>=0)return!0;break;case"not_include":if(r.indexOf(i)<0)return!0;break;case"start_with":if(0===r.indexOf(i))return!0;break;case"not_start_with":if(0!==r.indexOf(i))return!0;break;case"end_with":if(new RegExp(i.replace(/[$()*+.[\]{}\\|^\\/,?]/g,"\\$&")+"$").test(r))return!0;break;case"not_end_with":if(!new RegExp(i.replace(/[$()*+.[\]{}\\|^\\/,?]/g,"\\$&")+"$").test(r))return!0;break;case"regex":if(new RegExp(n).test(e))return!0}return!1}function encodeCondValue(e){try{return encodeURIComponent(decodeURIComponent(e))}catch(t){return e}}function findHtmlChild(e,t){return e?e.querySelectorAll(t.element)[t.nth-1]:null}function extractAttributeValue(e,t){return e.getAttribute(t.key)}function extractString(e,t){switch(t.extract_type||t.type){case"left":var n=t.extract_length||t.length;return e.slice(0,1*n);case"mid":var r=t.extract_start||t.start,i=t.extract_end||t.end;return e.substring(1*r-1,1*i);case"right":n=t.extract_length||t.length;return e.slice(-1*n);default:return e}}function encodeCookieValue(e){var t=encodeURIComponent(e);if(window.BdashRawDeflate&&window.BdashRawDeflate.deflate&&"function"==typeof window.BdashRawDeflate.deflate){var n=window.BdashRawDeflate.deflate(t);if(window.BdashRawDeflate.inflate&&"function"==typeof window.BdashRawDeflate.inflate)window.BdashRawDeflate.inflate(n)!==t&&(n=window.BdashRawDeflate.deflate(t,3));t=DEFLATED_PREFIX+n}return t=window.btoa(t)}function decodeCookieValue(e){try{var t=!1;0===e.indexOf("@")&&(t=!0,e=e.slice(1));var n,r=window.atob(e);return 0===r.indexOf(DEFLATED_PREFIX)&&(t=!0,r=r.slice(DEFLATED_PREFIX.length)),t&&window.BdashRawDeflate&&window.BdashRawDeflate.inflate&&"function"==typeof window.BdashRawDeflate.inflate&&(n=window.BdashRawDeflate.inflate(r)),decodeURIComponent(n||r)}catch(i){return e}}function shouldFetchCustomColumnOnPageview(e){var t=e.fetch_conditions;return!t||t.pageview.enabled}function shouldFetchCustomColumnOnClick(e,t){var n=e.fetch_conditions;if(!n)return!0;if(!n.click.enabled)return!1;if("all"===n.click.condition.target)return!0;var r=n.click.condition.element_conditions,i=t&&t.target;if(!i)return!1;for(var o=i.parentElement,a=0;a<r.length;a++){var c=r[a];if(c.child&&c.child.enabled)for(var u=(o&&o.getAttribute(c.element_type)).split(" "),l=0;l<u.length;l++){if(matched(u[l],c.operator,c.value))if(o.querySelectorAll(c.child.tag_name)[c.child.nth-1]==i)return!0}else for(u=i.getAttribute(c.element_type).split(" "),l=0;l<u.length;l++)if(matched(u[l],c.operator,c.value))return!0}return!1}function filterByDomainLevel(e,t){for(var n,r=[],i=[],o=0;o<e.length;o++){var a=e[o];a.domainLevel===t?r.push(a):undefined===n||a.domainLevel<n?(i=[a],n=a.domainLevel):a.domainLevel===n&&i.push(a)}return 0<r.length?r:i}function extractFromHtml(e){if(!e.conditions.length)return"";for(var t={match:"=",include:"*=",start_with:"^=",end_with:"$="},n={not_match:"=",not_include:"*=",not_start_with:"^=",not_end_with:"$="},r=0;r<e.conditions.length;r++){var i=e.conditions[r],o=[];if(t[i.matching]){var a=t[i.matching],c="["+i.type+a+'"'+i.name+'"]';o=document.querySelectorAll(c)}if(n[i.matching]){a=n[i.matching],c="["+i.type+":not(["+i.type+a+'"'+i.name+'"]';o=document.querySelectorAll(c)}if("regex"==i.matching){var u=document.querySelectorAll("["+i.type+"]"),l=new RegExp(i.name);o=Array.from(u).filter(e=>l.test(e[i.type]))}if(o.length){var s=o[i.nth?i.nth-1:0];if(i.child&&i.child.enabled&&(s=findHtmlChild(s,i.child)),s){if(i.attribute&&i.attribute.enabled)return extractAttributeValue(s,i.attribute)||"";var d=s.outerHTML,f=d.indexOf(">")+1,h=d.lastIndexOf("<");return extractString(d=d.substring(f,h),e.extract)}}}}function extractFromJs(e){return window[e.conditions[0].name]||""}function extractByCustomScript(conditions){var customValue="";return eval(conditions.custom_script),customValue}function extractFromSourceCode(e){switch(e.source_type){case"html":return extractFromHtml(e);case"javascript":return extractFromJs(e);case"others":return extractByCustomScript(e)}return""}function extractFromUrl(e){var t=e.urls&&e.urls[0]||{},n=t.matching,r=self.getCurrentPageUrl();if("regex"===n){var i=new RegExp(t.name),o=r.match(i);return o&&o[0]||""}return"extract"===n?extractString(r,t):""}function extractFromCookie(e){for(var t=e.name,n=e.values||[],r=self.getCookieValues(t),i=0;i<r.length;i++)if(0===n.length||self.matchAny(r[i],n,"name","matching"))return r[i]}var self=this,DEFLATED_PREFIX="bd4_";this.getCurrentPageUrl=function(){var e="";if(window.dataLayer&&"[object Array]"===Object.prototype.toString.apply(window.dataLayer))for(var t=0;t<window.dataLayer.length;t++){var n=window.dataLayer[t];if(n&&"page_viewed"===n.event){e=n.url;break}}return e||(e=location.href),e},this.matchAny=function(e,t,n,r){for(var i=0;i<t.length;i++){var o=t[i];if(matched(e,o[r],o[n]))return!0}return!1},this.isString=function(e){return"[object String]"===Object.prototype.toString.apply(e)},this.isObject=function(e){return"[object Object]"===Object.prototype.toString.apply(e)},this.isArray=function(e){return"[object Array]"===Object.prototype.toString.apply(e)},this.isFunction=function(e){return"[object Function]"===Object.prototype.toString.apply(e)},this.getUnixtimeSec=function(){return Math.floor((new Date).getTime()/1e3)},this.isEncodingCookie=function(e){return["_bdnvf","_bd_prev_page","_bd_prev_page_ex","_bdcid","_bd_reception_request_timestamp"].indexOf(e)>=0},this.restoreCookieValue=function(e,t){return self.isEncodingCookie(e)?decodeCookieValue(t):t},this.getCookieValues=function(e){for(var t=[],n=document.cookie.split(";"),r=new RegExp("^\\s*"+e+"=\\s*(.*)\\s*$"),i=0;i<n.length;i++){var o=n[i].match(r);o&&t.push(self.restoreCookieValue(e,o[1]))}return t},this.getCookieValue=function(e){return self.getCookieValues(e)[0]},this.setCookie=function(e,t,n,r,i){var o=e+"="+(self.isEncodingCookie(e)?encodeCookieValue(t):t)+";";n&&(o+="expires="+new Date((new Date).getTime()+n).toUTCString()+";"),r&&(o+="domain="+r+";"),i&&(o+="path="+(i||"/")+";");var a=document.cookie;if(document.cookie=o,document.cookie!==a)return!0;for(var c=self.getCookieValues(e),u=0;u<c.length;u++)if(t===c[u])return!0;return!1},this.generateCookieStoreValue=function(e,t){return e&&t?["BD",e,t.split(".").length].join("."):""},this.extractValueFromCookie=function(e){var t,n=self.getCookieValues(e);if(n.length>0){for(var r=[],i=location.hostname.split("."),o=0;!t&&o<n.length;o++){var a=n[o].match(/^BD\.(.+)\.(\d+)$/);a&&r.push({domainLevel:1*a[2],value:a[1]})}if(0===r.length)t=n[0];else if(1===r.length)t=r[0].value;else{var c=i&&i.length,u=c&&filterByDomainLevel(r,c);t=u&&u[0]&&u[0].value}}return t},this.stringIncludes=function(e,t){return String.prototype.includes=function(e){var t=!1;return-1!==this.indexOf(e)&&(t=!0),t},e.includes(t)},this.isTargetDomain=function(){for(var e=[{domain:"www.miyakohotels.ne.jp",exclude_conditions:[]},{domain:"reservation.miyakohotels.ne.jp",exclude_conditions:[]}],t=0;t<e.length;t++){var n=e[t];if(location.hostname===n.domain&&!self.matchAny(self.getCurrentPageUrl(),n.exclude_conditions,"url","cond"))return!0}return!1},this.extractFromSource=function(e){try{var t="",n=e.source_type,r=e.source_conditions||{};switch(n){case"source_code":t=extractFromSourceCode(r);break;case"url":t=extractFromUrl(r);break;case"cookie":t=extractFromCookie.bind(this,r)()}return t}catch(i){return console.error(i),""}};var customColumns=[{id:"1",column_no:"1",relation_setting_id:"2",source_type:"cookie",column_type:"customer_id",page_conditions:[{id:1,matching:"match",name:"https://www.miyakohotels.ne.jp/member/"}],source_conditions:{name:"\u9867\u5ba2ID",values:[{id:0,matching:"match",name:"membership_number"}]},fetch_conditions:null},{id:"2",column_no:"11",relation_setting_id:"3",source_type:"source_code",column_type:"customer_id",page_conditions:[{id:0,matching:"include",name:"https://www.miyakohotels.ne.jp/member"},{id:1,matching:"include",name:"https://reservation.miyakohotels.ne.jp/my-account/"}],source_conditions:{custom_script:"try{\n    var bdCustomerId = document.querySelector('.tbl_complete .td_inner,.profile-item.text-truncate,.box_member .number').textContent.match(/\\d+/g)[0];\n    customValue = bdCustomerId;\n}\ncatch(e){\n    //\u51e6\u7406\u3057\u306a\u3044\n};",source_type:"others"},fetch_conditions:{click:{condition:{element_conditions:[{child:{enabled:!1,nth:1,tag_name:""},element_type:"id",id:1,operator:"match",value:""}],target:"all"},enabled:!0},pageview:{enabled:!0}}}];this.getCustomColumns=function(){return customColumns},this.canExtractValue=function(e,t,n){switch(t){case"pageview":if(!shouldFetchCustomColumnOnPageview(e))return!1;break;case"click":if(!shouldFetchCustomColumnOnClick(e,n))return!1;break;default:return console.error("eventType: "+t+" \u306f\u60f3\u5b9a\u5916\u306e\u5024\u3067\u3059\u3002"),!1}return!0},this.extractValue=function(e,t,n){if(self.matchAny(self.getCurrentPageUrl(),e.page_conditions,"name","matching"))try{if(!self.canExtractValue(e,t,n))return null;var r=self.extractFromSource(e);return{key:"customColumn"+e.column_no,value:r,column_type:e.column_type}}catch(i){return null}return null},this.getCustomColumnValues=function(e,t){for(var n=[],r=0;r<customColumns.length;r++){var i=self.extractValue(customColumns[r],e,t);i&&n.push(i)}return n},this.escapeValue=function(e){if("string"!=typeof e)return e;var t=e.replace(/\"/g,'""');return((t=t.trim()).indexOf(",")>=0||t.match(/\t|\n/))&&(t='"'+t+'"'),t}}var util=new BdashTagUtil;util&&window.addEventListener("load",function(){for(var e=util.getCurrentPageUrl(),t="_bd_prev_page_ex",n=18e5,r="/",i=location.hostname.split("."),o=i.length-1;o>=0;o--){var a=i.slice(o).join("."),c=util.generateCookieStoreValue(e,a);if(util.setCookie(t,c,n,a,r))return!0}return!1})}()}}}(),templates.PageViewTrigger=function(){this.setUp=function(e){e({event:"btm.PageView"})}},window.BdashTagManager.addContainer({id:"container_id",triggerConfigs:[{id:1,triggerKey:"PageViewTrigger"}],tagConfigs:[{id:2,fireTriggerIds:[1],tagKey:"UtilTag"},{id:3,fireTriggerIds:[1],tagKey:"VisitorSessionTag"},{id:4,fireTriggerIds:[1],tagKey:"CmsEmbeddedVisitorTag"},{id:5,fireTriggerIds:[1],tagKey:"AccessLogTag"},{id:6,fireTriggerIds:[1],tagKey:"SetCurrentPageTag"}]},templates)}();