var DigitalAnalytics={SHOPACTION_BASKET_FULL_URL_ATTRIBUTE:"location.href.substring(0, 255)",RESERVED_URL_100_ATTRIBUTE_TOKEN:"location.href.substring(0, 100)",RESERVED_URL_200_ATTRIBUTE_TOKEN:"location.href.substring(100, 200)",RESERVED_URL_300_ATTRIBUTE_TOKEN:"location.href.substring(200, 300)",renderersByTagType:{pageView:"renderPageViewTag",fauxView:"renderFauxViewTags",manualPageView:"renderManualPageViewTag",productViews:"renderProductViewTag",element:"renderElementTags",shopActionBasket:"renderShopActionTag",shopActionConversion:"renderShopActionTag",order:"renderOrderTag",registration:"renderRegistrationTag"},pageViewAttributesToAugment:{clientId:"15",cmsp:"13",device:"18",collectionsCategoryId:"19"},extraAttributes:{tokenLength:50},COREMETRICS_CM_EMPTY_RESPONSE:"n/a",NULL_FOR_PERSONAL_DATA_CLASSIFICATION:null,init:function(){var e;"undefined"!=typeof cmSetClientID&&(void 0!==(e=window.digitalData)&&void 0===e.sendpixel?this.renderDigitalTags(e):this.sendErrorPixel("missing-data"))},sendErrorPixel:function(e){(new Image).src="/analyticserror.gif?msg="+e+"&path="+location.pathname},sendTaggingPixel:function(e,t){t=t||this.getUniqueIshId();(new Image).src="/analyticstag.gif?uuid="+t+"&tag="+encodeURIComponent(JSON.stringify(e))+"&path="+location.pathname},getUniqueIshId:function(){return Date.now().toString(36)+Math.random().toString(36).substr(2)},renderDigitalTags:function(e){this.renderDataTags(e.tags),this.renderManualDataTagQueue()},setSiteData:function(e){},hasRenderer:function(e){return this.renderersByTagType.hasOwnProperty(e)},getRendererByTagType:function(e){return this.renderersByTagType[e]},getExploreAttributes:function(e){e=e.attributes;return null==e?[]:this.createAndReturnAttributes(e)},createAndReturnAttributes:function(e){var t,i=this.extraAttributes.tokenLength,r=new Array(i);for(t in e)e.hasOwnProperty(t)&&this.addToAttributeArray(t,this.evalLocationStrings(e[t]),r);return r},evalLocationStrings:function(e){switch(e){case this.SHOPACTION_BASKET_FULL_URL_ATTRIBUTE:return location.href.substring(0,255);case this.RESERVED_URL_100_ATTRIBUTE_TOKEN:return location.href.substring(0,100);case this.RESERVED_URL_200_ATTRIBUTE_TOKEN:return location.href.substring(100,200);case this.RESERVED_URL_300_ATTRIBUTE_TOKEN:return location.href.substring(200,300);default:return e}},addToAttributeArray:function(e,t,i){i[e-1]=t},renderDataTags:function(e){var t,i,r;for(t in e)this.hasRenderer(t)?(i=e[t],"function"==typeof(r=this[this.getRendererByTagType(t)])?r.call(this,i,t):this.sendErrorPixel("missing-function")):this.sendErrorPixel("missing-renderer")},renderDynamicElementTag:function(e,t,i,r,n){this.renderTag({elementId:e,categoryId:t,attributes:i,productId:r,productCategory:n},"element")},renderDynamicPageViewTag:function(e,t,i,r,n){this.renderPageViewTag({pageId:e,categoryId:t,searchTerm:i,resultCount:r,attributes:n})},renderDynamicImpressionTag:function(e,t){this.renderTag({pageId:e,sitePromotion:t},"manualImpression")},renderManualDataTagQueue:function(){var e,t=document.querySelectorAll('[data-digital-tag-is-activated="false"]');for(e in t)t.hasOwnProperty(e)&&this.parseDataAttributesAndFireTag(t[e])},parseDataAttributesAndFireTag:function(e){"click"===e.dataset.digitalUserAction||"submit"===e.dataset.digitalUserAction?this.addEventListenerToTag(e):this.fireDataAttributeTags(e),e.dataset.digitalTagIsActivated="true"},addEventListenerToTag:function(e){e.addEventListener("click",this.fireDataAttributeTags.bind(this,e))},fireDataAttributeTags:function(e){var t=e.dataset;switch(t.digitalTagType){case"dynamicImpressionTag":this.renderDynamicImpressionTag(t.digitalPageId,t.digitalSitePromotion);break;case"dynamicElementTag":this.renderDynamicElementTag(t.digitalElementId,t.digitalCategoryId,this.parseAttributeString(t.digitalAttributes),t.digitalProductId,t.digitalProductCategory);break;case"dynamicPageViewTag":this.renderDynamicPageViewTag(t.digitalPageID,t.digitalCategoryId,t.digitalSearchTerm,t.digitalResultCount,this.parseAttributeString(t.digitalAttributes))}},parseAttributeString:function(e){var t,i,r,n,a={};if(!e||"string"!=typeof e)return null;try{for(r=(i=e.split("::")).length,t=0;t<r;t++)a[(n=i[t].split(":"))[0]]=n[1];return a}catch(e){return this.sendErrorPixel("malformed-attributes"),null}},renderProductViewTag:function(e){this.renderTagArray(e,"productViews")},renderPageViewTag:function(e){this.augmentPageViewAttributes(e),this.renderTag(e,"pageView")},renderManualPageViewTag:function(e){this.augmentPageViewAttributes(e),this.renderTag(e,"manualPageView")},renderRegistrationTag:function(e){this.renderTag(e,"registration")},renderElementTags:function(e){this.renderTagArray(e,"element")},renderFauxViewTags:function(e){this.renderTagArray(e,"fakePageView")},renderConversionEventTag:function(e){this.renderTag(e,"conversionEvent")},renderShopActionBasketTags:function(e){this.renderShopActionTag(e,"shopActionBasket")},renderOrderTag:function(e,t){"undefined"!=typeof cmSetClientID&&this.renderTag(e,t)},renderShopActionTag:function(e,t){this.renderTagArray(e,t)},renderTagArray:function(e,t){for(var i in e)e.hasOwnProperty(i)&&this.renderTag(e[i],t)},renderTag:function(e,t){"undefined"!=typeof cmSetClientID&&this.getExploreAttributes(e)},parseCmSpParameter:function(e){var t="[?&]cm_sp=([^&]+).*$",e=(e||window.location.search).match(t);return null===e?this.COREMETRICS_CM_EMPTY_RESPONSE:e[1]},augmentPageViewAttributes:function(e){window.abePv&&window.abePv.pvCatId&&this.addCollectionsCategoryId(e),this.getOrAddPageViewAttribute(e)},addCollectionsCategoryId:function(e){var t=this.pageViewAttributesToAugment.collectionsCategoryId;e.attributes[t]=window.abePv.pvCatId},addClientId:function(e){var t=this.pageViewAttributesToAugment.clientId,i=e.attributes[t];i&&"0"!==i||(e.attributes[t]=this.getSockCookieValue())},addCMSPValue:function(e){var t=this.pageViewAttributesToAugment.cmsp,i=e.attributes[t];i&&""!==i||(e.attributes[t]=this.parseCmSpParameter())},addDevice:function(e){var t=this.pageViewAttributesToAugment.device,i=e.attributes[t];i&&"na"!==i||"object"!=typeof utils||(e.attributes[t]=utils.getIsMobileByFallBackMethod()?"MOBILE":"DESKTOP")},getOrAddPageViewAttribute:function(e){void 0===e.attributes&&(e.attributes={}),this.addCMSPValue(e),this.addClientId(e),this.addDevice(e)},getSockCookieValue:function(){return document.cookie.replace(/(?:(?:^|.*;\s*)sock\s*\=\s*([^;]*).*$)|^.*$/,"$1")}};