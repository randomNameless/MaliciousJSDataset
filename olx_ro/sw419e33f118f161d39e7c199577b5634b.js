var InvoiceDropdowns=BaseClass.extend({init:function(form){var self=this;self.form=form;self.populateInvoiceDropdowns()},populateInvoiceDropdowns:function(){var self=this,nipField=$('#nip'),regonField=$('#regon'),nameField=$('#company_name'),nip={prefix:$('#nip_prefix'),number:$('#nip_number')},regon={subPrefix:$('#regon_prefix'),prefix:$('#regon_prefix_1'),numbers:$('#regon_numbers'),suffix:$('#regon_prefix_2')},name={prefix:$('#company_name_prefix'),main:$('#company_name_main')};if(nipField.val()!==null){var nipRegex=new RegExp('^([A-Z]+|)([0-9]+)$');if(nipRegex.test(nipField.val())){var nipMatch=nipRegex.exec(nipField.val());nip.prefix.val(nipMatch[1]);nip.number.val(nipMatch[2])}};if(regonField.val()!==null){var regonRegex=new RegExp('^(?:([A-Z-]{1,3}|)([0-9]{2}|)\/)?([0-9]{1,})\/([0-9]{4})$');if(regonRegex.test(regonField.val())){var regonMatch=regonRegex.exec(regonField.val());regon.subPrefix.val(regonMatch[1]);regon.prefix.val(regonMatch[2]);regon.numbers.val(regonMatch[3]);regon.suffix.val(regonMatch[4]<1990?'':regonMatch[4])}};if(nameField.val()!==null){var nameRegex=new RegExp('^(S\.C\.|S\.P\.R\.L\.|C\.M\.I\.|I\.F\.I\.|O\.N\.G\.|P\.F\.A\.|I\.I\.|)\\s?([\\w\\s.-]+)$');if(nameRegex.test(nameField.val())){var nameMatch=nameRegex.exec(nameField.val());name.prefix.val(nameMatch[1]);name.main.val(nameMatch[2])}};$('select').trigger('modified');self.form.bind('submit',function(e){function buildName(){if(name.prefix.val()==="")return name.main.val();return name.prefix.val()+" "+name.main.val()}
function buildNip(){if(nip.prefix.val()==="")return nip.number.val();return nip.prefix.val()+nip.number.val()}
function buildRegon(){if(regon.subPrefix.val()===""&&regon.prefix.val()==="")return regon.numbers.val()+'/'+regon.suffix.val();if(regon.subPrefix.val()===""||regon.prefix.val()==="")return(regon.subPrefix.val()?regon.subPrefix.val():regon.prefix.val()+"")+'/'+regon.numbers.val()+'/'+regon.suffix.val();return regon.subPrefix.val()+regon.prefix.val()+'/'+regon.numbers.val()+'/'+regon.suffix.val()};nameField.val(buildName());nipField.val(buildNip());regonField.val(buildRegon())})}});