L.DivIcon.SVGIcon=L.DivIcon.extend({options:{circleText:"",className:"svg-icon",circleAnchor:null,circleColor:null,circleOpacity:null,circleFillColor:"rgb(255,255,255)",circleFillOpacity:null,circleRatio:.5,circleWeight:null,color:"rgb(0,102,255)",fillColor:null,fillOpacity:.4,fontColor:"rgb(0, 0, 0)",fontOpacity:"1",fontSize:null,iconAnchor:null,iconSize:L.point(32,48),opacity:1,popupAnchor:null,weight:2},initialize:function(n){n=L.Util.setOptions(this,n);n.iconSize=L.point(n.iconSize);n.circleAnchor=n.circleAnchor?L.point(n.circleAnchor):L.point(Number(n.iconSize.x)/2,Number(n.iconSize.x)/2);n.circleColor||(n.circleColor=n.color);n.circleFillOpacity||(n.circleFillOpacity=n.opacity);n.circleOpacity||(n.circleOpacity=n.opacity);n.circleWeight||(n.circleWeight=n.weight);n.fillColor||(n.fillColor=n.color);n.fontSize||(n.fontSize=Number(n.iconSize.x/4));n.iconAnchor=n.iconAnchor?L.point(n.iconAnchor):L.point(Number(n.iconSize.x)/2,Number(n.iconSize.y));n.popupAnchor=n.popupAnchor?L.point(n.popupAnchor):L.point(0,-.75*n.iconSize.y);var t=this._createPath(),i=this._createCircle();n.html=this._createSVG()},_createCircle:function(){var n=Number(this.options.circleAnchor.x),t=Number(this.options.circleAnchor.y),i=this.options.iconSize.x/2*Number(this.options.circleRatio),r=this.options.circleFillColor,u=this.options.circleFillOpacity,f=this.options.circleColor,e=this.options.circleOpacity,o=this.options.circleWeight,s=this.options.className+"-circle";return'<circle class="'+s+'" cx="'+n+'" cy="'+t+'" r="'+i+'" fill="'+r+'" fill-opacity="'+u+'" stroke="'+f+'" stroke-opacity='+e+'" stroke-width="'+o+'"/>'},_createPathDescription:function(){var r=Number(this.options.iconSize.y),n=Number(this.options.iconSize.x),i=Number(this.options.weight),t=i/2,u="M "+t+" "+n/2+" ",f="L "+n/2+" "+(r-i)+" ",e="L "+(n-t)+" "+n/2+" ",o="A "+n/4+" "+n/4+" 0 0 0 "+t+" "+n/2+" Z";return u+f+e+o},_createPath:function(){var n=this._createPathDescription(),t=this.options.weight,i=this.options.color,r=this.options.Opacity,u=this.options.fillColor,f=this.options.fillOpacity,e=this.options.className+"-path";return'<path class="'+e+'" d="'+n+'" stroke-width="'+t+'" stroke="'+i+'" stroke-opacity="'+r+'" fill="'+u+'" fill-opacity="'+f+'"/>'},_createSVG:function(){var n=this._createPath(),t=this._createCircle(),i=this._createText(),r=this.options.className+"-svg",u="width:"+this.options.iconSize.x+"px; height:"+this.options.iconSize.y+"px;";return'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" class="'+r+'" style="'+u+'">'+n+t+i+"<\/svg>"},_createText:function(){var t=this.options.fontSize+"px",i=Number(this.options.fontSize),n=Number(this.options.iconSize.x)/2,r=n+i*.35,u=this.options.circleText,f=this.options.fontColor.replace("rgb(","rgba(").replace(")",","+this.options.fontOpacity+")");return'<text text-anchor="middle" x="'+n+'" y="'+r+'" style="font-size: '+t+'" fill="'+f+'">'+u+"<\/text>"}});L.divIcon.svgIcon=function(n){return new L.DivIcon.SVGIcon(n)};L.Marker.SVGMarker=L.Marker.extend({options:{iconFactory:L.divIcon.svgIcon,iconOptions:{}},initialize:function(n,t){t=L.Util.setOptions(this,t);t.icon=t.iconFactory(t.iconOptions);this._latlng=n},onAdd:function(n){L.Marker.prototype.onAdd.call(this,n)},setStyle:function(n){var t,i,u;if(this._icon){var e=this._icon.children[0],r=this._icon.children[0].children[0],f=this._icon.children[0].children[1];n.color&&!n.iconOptions&&(t=n.color.replace("rgb","rgba").replace(")",","+this.options.icon.options.opacity+")"),i=n.color.replace("rgb","rgba").replace(")",","+this.options.icon.options.fillOpacity+")"),r.setAttribute("stroke",t),r.setAttribute("fill",i),f.setAttribute("stroke",t),this.options.icon.fillColor=i,this.options.icon.color=t,this.options.icon.circleColor=t);n.opacity&&this.setOpacity(n.opacity);n.iconOptions&&(n.color&&(n.iconOptions.color=n.color),u=L.Util.setOptions(this.options.icon,n.iconOptions),this.setIcon(L.divIcon.svgIcon(u)))}}});L.marker.svgMarker=function(n,t){return new L.Marker.SVGMarker(n,t)};