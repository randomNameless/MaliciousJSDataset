!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="7ffe1773-0558-4b39-9c5e-95f9ac439b24",e._sentryDebugIdIdentifier="sentry-dbid-7ffe1773-0558-4b39-9c5e-95f9ac439b24")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"redpop@ce094590bd2291e3264b21d2f92bffc273e4a131"},(self.webpackChunk_tumblr_redpop=self.webpackChunk_tumblr_redpop||[]).push([[5165],{38800:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a={link:"fvSXi",loggedOutLink:"qRMZE"}},18618:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a={subSettings:"HPbUp",emoji:"sEK_i",radioGroup:"H3wvd",option:"RMFSy"}},2376:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var a=r(74059),s=/*#__PURE__*/r.n(a),o=r(98589),n=r(53986),i=r(38800),l=r(60397);let c=({label:e,className:t,getPath:r,children:a,onClick:c,disableNavigation:d,isAlreadyOnPostFormPath:h,forwardedRef:u,disabled:m,...g})=>{let{pathname:p}=(0,n.zy)(),b=(0,n.Zp)(),f=r?.();return/*#__PURE__*/(0,l.jsx)(o.x,{action:"base-post-button","aria-label":e,className:s()(i.A.link,t),href:m?void 0:f,onClick:m?void 0:e=>{c?.(e),e.ctrlKey||e.metaKey||d||(e.preventDefault(),f&&!h?.(p)&&b(f,{state:{previousPathname:p}}))},ref:u,...c&&{role:"button"},...g,children:a||e})}},97411:(e,t,r)=>{"use strict";r.d(t,{A:()=>m});var a=r(90657),s=r(71310),o=r(12044),n=r(36665),i=r(94048),l=r(4613),c=r(29557),d=r(91988),h=r(2376),u=r(60397);let m=({routeQueryProps:e,onClick:t,communityId:r,...m})=>{let{_c:g,isLoggedIn:p,logEvent:b}=(0,l.Us)(),{modalLocation:f}=(0,c.j)(),v=(0,n.useRef)(null),y=(0,d.A)(e),x=()=>r?(0,s.K3)({communityId:r}):(0,o.P1)({},y);return/*#__PURE__*/(0,u.jsx)(a.Ay,{hotkey:{key:a.qW.c,command:()=>{v.current?.click()}},children:/*#__PURE__*/(0,u.jsx)(h.A,{...m,disableNavigation:!p,forwardedRef:v,getPath:x,isAlreadyOnPostFormPath:()=>!!f&&(0,o.Ev)(f.pathname),onClick:e=>{b({eventName:i.R.PFComposePost}),t?.(e)},...!p&&{"data-login-wall-type":"newTaggedPost","data-login-wall-title":g('Login wall: Title shown when user clicks on the "New tagged post" button, after exceeding click counter limit',"You were *this close* to a post…"),"data-login-wall-page":"floating","data-login-wall-tag-label":y.tags,"data-login-wall-redirect":"/dashboard","data-login-wall-destination":(0,o.gn)(y.tags||""),"data-login-wall-new-post-path":x()}})})}},65506:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(88346),s=/*#__PURE__*/r.n(a),o=r(36665),n=r(44218),i=r(60397);class l extends o.Component{constructor(...e){super(...e),s()(this,"state",{error:null})}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e,t){let r;this.props.source&&(r={tags:{source:this.props.source}}),(0,n.Cp)(e,r),this.props.onError?.()}render(){let{error:e}=this.state;return e?this.props.FallbackComponent?/*#__PURE__*/(0,i.jsx)(this.props.FallbackComponent,{error:e}):null:this.props.children}}},68539:(e,t,r)=>{"use strict";r.d(t,{A:()=>eo});var a=r(74059),s=/*#__PURE__*/r.n(a),o=r(97411),n=r(65404),i=r(75941),l=r(58143),c=r(88791),d=r(42356),h=r(59271),u=r(86214),m=r(3103),g=r(74266),p=r(35001),b=r(65447),f=r(13134),v=r(60651),y=r(12044),x=r(72571),w=r(64663),T=r(8486);let j={light:"color",transparent:"color","transparent-dark":"transparent-dark"};var S=r(94048),A=r(4613),C=r(47738),k=r(82421),F=r(56040),N=/*#__PURE__*/r.n(F),M=r(21098),P=r(77683),H=r(85159),B=r(63135);let I=(0,B.A)(()=>Promise.all([r.e(8301),r.e(2291)]).then(r.bind(r,98301)).then(e=>({default:e.AccountPopover})),"AsyncAccountPopover"),R=(0,B.A)(()=>Promise.all([r.e(6275),r.e(715),r.e(7794),r.e(2953),r.e(6383),r.e(8013),r.e(1456),r.e(8601)]).then(r.bind(r,73851)),"AsyncActivityPopover");var E=r(11100),$=r(48422),D=r(21997),W=r(36665);let z={menuContainer:"KTRcB",menuTarget:"PK7qG",menuTargetWrapper:"B1L2M",activeButton:"cckUS",rounded:"ho0MD",sparkle:"Kz7JC",hidden:"YkYNc"},L=e=>`new-menu-item-seen-${e}`,_=e=>e.trim().toLowerCase().replace(/[^a-z0-9]+/g,"-");var U=r(81515),O=r(60397);let q=({children:e,label:t,isActive:r,link:a,useRouter:o,notificationCount:n=0,notificationStatus:i,krakenEvent:l,featureExposedKey:c,isNew:d})=>{let{logEvent:h,getCookie:u,setCookie:m}=(0,A.Us)();(0,W.useEffect)(()=>{c&&h({eventName:S.R.FeatureExposed,eventDetails:{feature_key:c}})},[]);let g=_(t),[p,b]=(0,W.useState)(d&&"1"===u(L(g))),f=/*#__PURE__*/(0,O.jsx)("span",{className:s()(z.sparkle,{[z.hidden]:!d||d&&p}),children:/*#__PURE__*/(0,O.jsx)($.A,{})}),v=/*#__PURE__*/(0,O.jsxs)(O.Fragment,{children:[/*#__PURE__*/(0,O.jsxs)(E.A,{"aria-current":!!r&&"page",className:s()(z.menuTarget,{[z.activeButton]:r}),label:t,onClick:()=>{l&&h({eventName:l}),d&&(b(!0),m(L(g),"1",{maxAge:24192e5}))},wrapperClassName:z.menuTargetWrapper,children:[e,f]}),n>0&&/*#__PURE__*/(0,O.jsx)(U.A,{count:n,showNumber:!0}),i&&/*#__PURE__*/(0,O.jsx)(U.A,{count:1,isCircle:!0,showNumber:!1,style:{top:-9,right:-9}})]});return/*#__PURE__*/(0,O.jsx)("div",{className:z.menuContainer,children:o?/*#__PURE__*/(0,O.jsx)(D.A,{tabIndex:-1,to:a,children:v}):/*#__PURE__*/(0,O.jsx)("a",{href:a,tabIndex:-1,children:v})})};var Y=r(88346),G=/*#__PURE__*/r.n(Y),K=r(24205),X=r(65506),Q=r(46670),J=r(86619),V=r(89972);let Z=(e,t)=>{let{children:r,label:a,isActive:o,notificationCount:n}=e;return/*#__PURE__*/(0,O.jsxs)(E.A,{"aria-current":!!o&&"page",label:a,wrapperClassName:z.menuTargetWrapper,children:[/*#__PURE__*/(0,O.jsxs)("span",{className:s()(z.menuTarget,{[z.activeButton]:o}),children:[r,t]}),/*#__PURE__*/(0,O.jsx)(U.A,{count:n})]})},ee=e=>{let{logEvent:t,configRef:r}=(0,A.Us)(),{isNew:a,label:o,componentWidth:n,componentMaxHeight:i,component:l,showOverflowY:c,controlledPopoverProps:d,theme:h="default"}=e,{getCookie:u,setCookie:m}=(0,A.Us)(),g=_(o),[p,b]=(0,W.useState)((()=>{if(!a)return!1;if("shop-tumblrmart"===g){let e=r?.tumblrmartLastUpdated?1e3*r.tumblrmartLastUpdated:0;return Number(u(L(g)))>e}return"1"===u(L(g))})()),f={onOpen:()=>{t({eventName:e.krakenEvent}),a&&(b(!0),m(L(g),"shop-tumblrmart"===g?new Date().getTime().toString():"1",{maxAge:24192e5}))},showOverflowY:c,component:/*#__PURE__*/(0,O.jsx)(X.A,{children:l},o),height:"auto",position:V.$x.Bottom,width:n,isFlipEnabled:!1,maxHeight:i,closeForAllExternalClicks:!0,popoverWrapperClassName:z[h]},v=/*#__PURE__*/(0,O.jsx)("span",{className:s()(z.sparkle,{[z.hidden]:!a||p}),children:/*#__PURE__*/(0,O.jsx)($.A,{})});return/*#__PURE__*/(0,O.jsx)("div",{className:z.menuContainer,children:d?/*#__PURE__*/(0,O.jsx)(J.Ay,{...f,...d,children:Z(e,v)}):/*#__PURE__*/(0,O.jsx)(Q.A,{...f,children:Z(e,v)})})},et={messagingPopover:"GcA7R"};class er extends W.Component{constructor(...e){super(...e),G()(this,"state",{isOpen:!1}),G()(this,"toggle",()=>this.setState(e=>({isOpen:!e.isOpen})))}render(){let{popoverMenuItemProps:e}=this.props,{isOpen:t}=this.state;return/*#__PURE__*/(0,O.jsx)(ee,{...e,component:/*#__PURE__*/(0,O.jsx)("div",{className:et.messagingPopover,children:/*#__PURE__*/(0,O.jsx)(K.A,{})}),controlledPopoverProps:{isOpen:t,toggle:this.toggle}})}}let ea={headerWrapper:"hlDot",headerWrapperTransparent:"C38Rc",backgroundTransparent:"hvZ5A",header:"_3kR_",menuLeft:"rllUD",searchBar:"nzmrE",menuLeftIsOnlyMenuPart:"BY8m2",loggedOutButtons:"yTPpj",menuRight:"uuWZ2",logo:"QOMh2",postIconButton:"xxqHJ"},es={width:22,height:22},eo=({activePage:e,blogName:t,hardLinkNavigation:r,headerTheme:a="light",hideLoggedOutButtons:F,hideLoginButton:B,hideSignUpButton:E,inboxCount:$=0,logoUrl:D,notificationCount:W=0,privateGroupBlogUnreadPostTotal:z=0,registrationSource:L,showLimitedHeader:_,transparentBackground:U,unreadMessagesCount:Y=0,unseenPostCount:G=0})=>{let K;let{_t:X,isLoggedIn:Q,features:J,getCookie:V}=(0,A.Us)(),Z=(0,M.n)(e),et=!_&&/*#__PURE__*/(0,O.jsxs)("div",{className:ea.menuRight,children:[/*#__PURE__*/(0,O.jsx)(v.A,{}),/*#__PURE__*/(0,O.jsx)(q,{isActive:(0,x.ho)(e),krakenEvent:S.R.HomeNavClick,label:X("Home"),link:(0,C.w)(V),notificationCount:G,useRouter:!0,children:/*#__PURE__*/(0,O.jsx)(c.A,{size:{width:20,height:21}})}),/*#__PURE__*/(0,O.jsx)(q,{isActive:(0,x.zZ)(e),krakenEvent:S.R.ExploreNavClick,label:X("Explore"),link:(0,k.A)(y.ry.exploreByMode,{exploreMode:T.SD}),useRouter:!0,children:/*#__PURE__*/(0,O.jsx)(l.A,{size:es})}),J.tumblrPatio?/*#__PURE__*/(0,O.jsx)(q,{isActive:!0,label:X("Patio"),link:y.ry.patio,useRouter:!0,children:/*#__PURE__*/(0,O.jsx)(i.E,{colors:{primary:N().paletteTransparentWhite40}})}):null,/*#__PURE__*/(0,O.jsx)(ee,{component:/*#__PURE__*/(0,O.jsx)(f.A,{source:"desktop-header"}),componentMaxHeight:"90vh",componentWidth:f.G,isNew:!0,krakenEvent:S.R.TumblrMartShopClick,label:X("Shop TumblrMart"),theme:"rounded",children:/*#__PURE__*/(0,O.jsx)(g.A,{size:es})}),/*#__PURE__*/(0,O.jsx)(q,{isActive:(0,x.Sb)(e),krakenEvent:S.R.InboxNavClick,label:X("Inbox"),link:y.ry.inbox,notificationCount:$,useRouter:!0,children:/*#__PURE__*/(0,O.jsx)(h.A,{size:{width:23,height:21}})}),/*#__PURE__*/(0,O.jsx)(er,{popoverMenuItemProps:{children:/*#__PURE__*/(0,O.jsx)(u.A,{size:es}),componentWidth:280,componentMaxHeight:490,label:X("Messaging"),isActive:(0,x.IC)(e),showOverflowY:!0,notificationCount:Y,krakenEvent:S.R.MessagesPopover}}),/*#__PURE__*/(0,O.jsx)(ee,{component:/*#__PURE__*/(0,O.jsx)(R,{}),componentMaxHeight:"90vh",componentWidth:380,isActive:(0,x.$A)(e),krakenEvent:S.R.ActivityPopover,label:X("Activity"),notificationCount:W,showOverflowY:!0,children:/*#__PURE__*/(0,O.jsx)(d.A,{size:{width:14,height:21}})}),/*#__PURE__*/(0,O.jsx)(ee,{component:/*#__PURE__*/(0,O.jsx)(I,{activePage:e}),componentMaxHeight:"90vh",componentWidth:240,isActive:(0,x.$X)(e),krakenEvent:S.R.AccountPopover,label:X("Account"),notificationCount:z,children:/*#__PURE__*/(0,O.jsx)(p.A,{size:{width:15,height:21}})}),/*#__PURE__*/(0,O.jsx)(o.A,{className:ea.postIconButton,label:X("New post"),routeQueryProps:{blogName:t,isPageBlogPage:(0,x.pO)(e),composeSettings:(0,w.e)(e)},children:/*#__PURE__*/(0,O.jsx)(m.A,{size:{height:22,width:22}})})]}),eo=!F&&/*#__PURE__*/(0,O.jsx)("div",{className:s()(ea.menuRight,ea.loggedOutButtons),children:/*#__PURE__*/(0,O.jsx)(H.A,{hideLoginButton:B,hideSignUpButton:e!==x.Qi.landing||E,loginButtonStyle:{marginRight:10},registrationSource:L,theme:j[a]})}),en=Q?et:eo,ei=U||"transparent"===a||"transparent-dark"===a;return K=D?/*#__PURE__*/(0,O.jsx)(n.A,{hardLinkHome:r,logoUrl:D}):/*#__PURE__*/(0,O.jsx)(P.A,{animatedGradientOnHover:!ei,hardLinkHome:r,theme:a}),/*#__PURE__*/(0,O.jsx)("div",{className:s()({[ea.headerWrapperTransparent]:U,[ea.headerWrapper]:!U,[ea.backgroundTransparent]:ei}),children:/*#__PURE__*/(0,O.jsxs)("header",{className:ea.header,children:[/*#__PURE__*/(0,O.jsxs)("div",{className:s()(ea.menuLeft,{[ea.menuLeftIsOnlyMenuPart]:!en}),children:[/*#__PURE__*/(0,O.jsx)("div",{className:ea.logo,children:K}),/*#__PURE__*/(0,O.jsx)(b.I,{className:ea.searchBar,context:ei?"image":"chrome",hardLinkToSearchPage:r,initialSearchTerm:Z,..._&&{enableTypeahead:!0}})]}),en]})})}},81515:(e,t,r)=>{"use strict";r.d(t,{A:()=>g});var a=r(88346),s=/*#__PURE__*/r.n(a),o=r(74059),n=/*#__PURE__*/r.n(o),i=r(36665),l=r(21728),c=r(53526),d=r(61703);let h={square:"XnKJk",circle:"e2EeC",notificationBadge:"jpu7k",notificationBadgeIn:"D0OOd"};var u=r(60397);class m extends i.Component{constructor(...e){super(...e),s()(this,"transitionNodeRef",/*#__PURE__*/(0,i.createRef)()),s()(this,"prevCount",0),s()(this,"renderContentFromTransitionStatus",e=>{let{count:t,showNumber:r,isCircle:a,className:s,style:o}=this.props,i=this.prevCount>t&&0===t,d=[l.ns,l._K,l.ze].includes(e),m=i&&d?this.prevCount:t;return/*#__PURE__*/(0,u.jsx)("div",{className:n()(h.notificationBadge,s,{[h.notificationBadgeIn]:[l.ns,l._K].includes(e),[h.circle]:a,[h.square]:!a}),ref:this.transitionNodeRef,role:"status",style:o,children:r&&(0,c.A)(m,99)})})}componentDidUpdate(e){this.prevCount=e?.count||0}render(){let{count:e}=this.props;return/*#__PURE__*/(0,u.jsx)(l.Ay,{in:e>0,nodeRef:this.transitionNodeRef,timeout:d.notificationBadgeTransitionDurationMs,children:this.renderContentFromTransitionStatus})}}s()(m,"defaultProps",{count:0,showNumber:!0});let g=m},65404:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(87433),s=r(60397);let o=function({logoUrl:e,hardLinkHome:t}){let r=/*#__PURE__*/(0,s.jsx)("div",{children:/*#__PURE__*/(0,s.jsx)("img",{alt:"Logo",src:e})});return/*#__PURE__*/(0,s.jsx)(a.R,{hardLinkHome:t,children:r})}},87433:(e,t,r)=>{"use strict";r.d(t,{R:()=>c});var a=r(21997),s=r(36665),o=r(94048),n=r(4613),i=r(47738),l=r(60397);let c=({children:e,hardLinkHome:t})=>{let{isLoggedIn:r,_t:c,logEvent:d,getCookie:h}=(0,n.Us)(),u=c("Home"),m=t||!r?"/":(0,i.w)(h),g=(0,s.useCallback)(()=>{d({eventName:o.R.LogoClick,eventDetails:{destination:m}})},[d,m]);return t||!r?/*#__PURE__*/(0,l.jsx)("a",{"aria-label":u,href:m,onClick:g,children:e}):/*#__PURE__*/(0,l.jsx)(a.A,{"aria-label":u,onClick:g,to:m,children:e})}},77683:(e,t,r)=>{"use strict";r.d(t,{A:()=>m});var a=r(74059),s=/*#__PURE__*/r.n(a),o=r(96248),n=r(60324),i=r(4613),l=r(56040),c=/*#__PURE__*/r.n(l),d=r(87433);let h={prideMonth:"Ovlgo",container:"FQkf4",gradient:"FP6oS",logo:"GjGsN",animatedGradientOnHover:"tSe6h"};var u=r(60397);let m=function({size:e,theme:t,hardLinkHome:r,animatedGradientOnHover:a=!1,showFullLogo:l=!1}){let{features:m}=(0,i.Us)(),g=l?n.A:o.Q,p=/*#__PURE__*/(0,u.jsxs)("div",{className:s()(h.container,{[h.animatedGradientOnHover]:a,[h.prideMonth]:m.prideMonthLogoAnimation}),style:{width:`${e?.width||o.L.width}px`,height:`${e?.height||o.L.height}px`},children:[/*#__PURE__*/(0,u.jsx)("div",{className:h.gradient}),/*#__PURE__*/(0,u.jsx)(g,{className:h.logo,colors:{primary:["light","transparent"].includes(t||"")?c().paletteWhiteOnDark:c().paletteBlack},...e&&{size:e}})]});return/*#__PURE__*/(0,u.jsx)(d.R,{hardLinkHome:r,children:p})}},85159:(e,t,r)=>{"use strict";r.d(t,{A:()=>v});var a=r(17886),s=r(12044),o=r(36665),n=r(53986),i=r(45872),l=r(94048),c=r(4613),d=r(68331),h=r(4532),u=r(56040),m=r(64893),g=r(79708),p=r(5537);let b=(e,t)=>!!e[p.g.LoginWall]&&("/"===t||(0,s.Bj)(t)||(0,s.it)(t)||(0,s.U8)(t)||(0,g.n6)(t)||(0,m.Cz)(t));var f=r(60397);let v=function({theme:e,hardLinkNavigation:t,hideLoginButton:r,hideSignUpButton:m,registrationSource:g,loginButtonStyle:p,signUpButtonStyle:v,disableLoginWall:y}){let x,w,T;let{_t:j,logEvent:S,features:A,wwwBaseUrl:C}=(0,c.Us)(),{openLoginWall:k}=(0,d.K)(),{pathname:F,search:N}=(0,n.zy)(),M=(0,o.useCallback)(()=>S({eventName:l.R.ClickSignup}),[]),P=(0,o.useCallback)(()=>S({eventName:l.R.ClickLogin}),[]),H=(0,o.useCallback)(e=>{e?.preventDefault(),k({form:i.t.Login,redirect:F})},[]),B=(0,o.useCallback)(e=>{e?.preventDefault(),k({form:i.t.Register})},[]),I=!y&&b(A,F)?H:P,R=!y&&b(A,F)?B:M,E=t&&"_blank",$=t?C:"",D=new URLSearchParams(N).get("redirect_to")||void 0;switch(g||(g=(0,h.i)(F,"register_button")),e){case"transparent-dark":w={backgroundColor:u.transparentBlack15,textColor:u.paletteBlack},T={backgroundColor:u.black,textColor:u.transparentWhite50},x={mixBlendMode:"hard-light"};break;case"greyscale":w={backgroundColor:u.paletteBlack,textColor:u.gray40},T={backgroundColor:u.gray40,textColor:u.paletteBlack};break;default:w={backgroundColor:u.glassGreen,textColor:"#000000"},T={backgroundColor:u.dreamcastBlue,textColor:"#000000"}}return/*#__PURE__*/(0,f.jsxs)(f.Fragment,{children:[!r&&/*#__PURE__*/(0,f.jsx)(a.A,{feature:!1,href:`${$}${(0,s.rn)({formToShow:i.t.Login},{redirect_to:D})}`,onClick:I,size:"small",style:p,...E&&{target:E},...w,children:j("Log in")}),!m&&/*#__PURE__*/(0,f.jsx)(a.A,{feature:!1,href:`${$}${(0,s.rn)({formToShow:i.t.Register},{source:g,redirect_to:D})}`,onClick:R,size:"small",style:v,...E&&{target:E},...T,...x&&{style:x},children:j("Sign up")})]})}},75941:(e,t,r)=>{"use strict";r.d(t,{E:()=>a});let a=(0,r(20928).Kk)("deck",{size:{width:20,height:20}})},58143:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(20928);let s=(0,a.Kk)("explore",{size:{width:22,height:24}});(0,a.Lz)("explore-24-filled",24)},88791:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(20928).Kk)("home",{size:{width:20,height:21}})},42356:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(20928).Kk)("lightning",{size:{width:24,height:24}})},96248:(e,t,r)=>{"use strict";r.d(t,{L:()=>n,Q:()=>i});var a=r(20928),s=r(60397);let o=(0,a.Kk)("logo-t"),n={width:20,height:33},i=({size:e=n,...t})=>/*#__PURE__*/(0,s.jsx)(o,{...t,size:e})},60324:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(20928).Kk)("logo-tumblr",{size:{width:274,height:56},className:"XnmP8"})},59271:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(20928).Kk)("mail",{size:{width:23,height:24}})},86214:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var a=r(20928),s=r(11221),o=r(58217),n=r(60397);let i=(0,a.Kk)("messaging"),l={default:i,ghost:(0,a.Kk)("messaging-ghost"),pumpkin:(0,a.Kk)("messaging-pumpkin"),vampire:(0,a.Kk)("messaging-vampire")},c=({forceVariant:e,size:t={width:21,height:21},...r})=>{let a=(0,o.M)(),i=e;i||(i=a?.name===s.A.ghost?"ghost":a?.name===s.A.vampire?"vampire":a?.name===s.A.pumpkin?"pumpkin":"default");let c=l[i];return/*#__PURE__*/(0,n.jsx)(c,{...r,size:t})}},3103:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(20928).Kk)("post",{size:{width:24,height:24}})},44554:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(20928);let s=(0,a.Kk)("search",{size:{width:14,height:14}});(0,a.Lz)("search-20",20)},98778:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(20928).Kk)("share-icon-proper",{size:{width:24,height:24}})},74266:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(20928).Kk)("shop",{size:{width:19,height:19}})},48422:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});let a={sparkleMulti:"JzQ6G"};var s=r(60397);let o=({useViewBox:e})=>/*#__PURE__*/(0,s.jsxs)("svg",{className:a.sparkleMulti,viewBox:e?"0 0 36 31":void 0,children:[/*#__PURE__*/(0,s.jsx)("path",{d:"M29.434 2.806c.125-.618 1.007-.618 1.132 0l.294 1.458a7.216 7.216 0 0 0 4.706 5.39l.864.3a.577.577 0 0 1 0 1.091l-.864.3a7.216 7.216 0 0 0-4.706 5.39l-.294 1.46c-.125.617-1.007.617-1.132 0l-.294-1.46a7.216 7.216 0 0 0-4.706-5.39l-.864-.3a.577.577 0 0 1 0-1.09l.864-.3a7.216 7.216 0 0 0 4.706-5.39l.294-1.46Z",fill:"var(--icon-color-primary, #ffffff)"}),/*#__PURE__*/(0,s.jsx)("path",{d:"M5.373 15.636c.11-.566.92-.566 1.03 0l.036.179a6.246 6.246 0 0 0 4.024 4.681.5.5 0 0 1 0 .94 6.246 6.246 0 0 0-4.024 4.682l-.035.18c-.11.566-.92.566-1.031 0l-.035-.18a6.246 6.246 0 0 0-4.024-4.681.5.5 0 0 1 0-.941 6.246 6.246 0 0 0 4.024-4.681l.035-.18Z",fill:"var(--icon-color-primary, #ffffff)"}),/*#__PURE__*/(0,s.jsx)("path",{d:"M26.27 25.604c.068-.344.56-.344.628 0l.021.11a3.802 3.802 0 0 0 2.45 2.849.304.304 0 0 1 0 .573 3.802 3.802 0 0 0-2.45 2.849l-.021.11c-.067.344-.56.344-.628 0l-.021-.11a3.802 3.802 0 0 0-2.45-2.85.304.304 0 0 1 0-.572 3.802 3.802 0 0 0 2.45-2.85l.021-.109Z",fill:"var(--icon-color-primary, #ffffff)"}),/*#__PURE__*/(0,s.jsx)("path",{d:"M9.719 1.595c.055-.315.507-.315.562 0l.021.116a3.36 3.36 0 0 0 2.069 2.54.268.268 0 0 1 0 .499 3.36 3.36 0 0 0-2.069 2.539l-.02.116c-.056.315-.508.315-.563 0l-.021-.116a3.36 3.36 0 0 0-2.069-2.54.269.269 0 0 1 0-.499 3.36 3.36 0 0 0 2.069-2.539l.02-.116Z",fill:"var(--icon-color-primary, #ffffff)"})]})},67819:(e,t,r)=>{"use strict";r.d(t,{A:()=>N});var a=r(46466),s=r(44554),o=r(13275),n=r(97816),i=r(36665),l=r(8079),c=r(4613),d=r(72991),h=r(74059),u=/*#__PURE__*/r.n(h),m=r(11100),g=r(75776),p=r(28230),b=r(66794),f=r(85191),v=r(12044),y=r(56040),x=/*#__PURE__*/r.n(y);let w=(0,r(81896).R)({moduleId:"followed-tags",getStableIdForItem:e=>String(e.tagId),fetchResults:async(e,t)=>{let r;return{items:(r=t?await e.apiFetch(t):await (0,l.bM)(e.apiFetch,{sort:"tag_name",sort_order:"asc"}).fetch()).response.elements,link:t,nextLink:r.response?.links?.next?.href,prevLink:r.response?.links?.prev?.href}}}),T={tagItem:"LpT7u",tagName:"gjXjl",goToTagLink:"THgNG",buttonWrapper:"oimUW",unfollowed:"Qp_8J",loader:"zSGUi"};var j=r(60397);let S=/*#__PURE__*/(0,j.jsx)("div",{className:T.loader,children:/*#__PURE__*/(0,j.jsx)(p.A,{centerOrientation:"horizontalAndVertical",color:x().paletteGray65})}),A=({unfollowedTags:e,toggleTag:t,onInteractWithFollowedTags:r})=>{let{_t:a}=(0,c.Us)(),s=(0,i.useCallback)(s=>{let o=e.includes(s.tagName),n=o?a("Follow"):a("Unfollow");return/*#__PURE__*/(0,j.jsx)(C,{actionLabel:n,isUnfollowed:o,onToggleStatus:()=>{r(),t(s.tagName)},tag:s})},[a,r,t,e]),o=(0,i.useMemo)(()=>({renderItem:s,renderType:"single",getIsAnchorCandidate:()=>!0,initialItemHeight:70,itemGap:0}),[s]);return/*#__PURE__*/(0,j.jsx)(b.n,{loader:S,module:w,paginationMode:"endless",proximityThreshold:500,renderer:o})},C=({tag:e,isUnfollowed:t,actionLabel:r,onToggleStatus:a})=>/*#__PURE__*/(0,j.jsxs)("div",{className:T.tagItem,children:[/*#__PURE__*/(0,j.jsxs)("span",{className:T.tagName,children:["#",e.tagName]}),/*#__PURE__*/(0,j.jsx)(g.A,{to:(0,v.gn)(e.tagName),wrapperClassName:T.goToTagLink,children:/*#__PURE__*/(0,j.jsx)(f.Ay,{comment:"Link button, close to a tag that directs the user to the tag page.",children:"Go to Tag"})}),/*#__PURE__*/(0,j.jsx)(m.A,{label:r,onClick:a,wrapperClassName:u()(T.buttonWrapper,{[T.unfollowed]:t}),children:r})]}),k={manageTagsModal:"tBdaa",cell:"bsPTt",searchbarContainer:"SzteP",searchIcon:"CC8h2",closeIcon:"nstz_",searchbar:"mlda0"},F=()=>{let{apiFetch:e}=(0,c.Us)(),[t,r]=(0,i.useState)([]);return{unfollowedTags:t,toggleTag:a=>{t.includes(a)?(0,l.Wy)(e,a).fetch().then(()=>{r(e=>e.filter(e=>e!==a))}):(0,l.Zo)(e,a).fetch().then(()=>{r(e=>[...e,a])})},resetUnfollowedtags:()=>r([])}},N=({onClose:e})=>{let[t,r]=(0,i.useState)(!1),[l,h]=(0,i.useState)(null),[u,m]=(0,i.useState)(""),{_c:g,_t:p}=(0,c.Us)(),{unfollowedTags:b,toggleTag:f,resetUnfollowedtags:v}=F(),[y,x]=(0,i.useState)(!1),{refresh:T}=w.useData(),S=()=>{y||x(!0)},C=t?{transform:"translateX(-100%)"}:{};return/*#__PURE__*/(0,j.jsxs)(o.A,{modalWrapperClass:"tagsManager",onClose:()=>{e(y)},title:p("Tags you follow"),children:[/*#__PURE__*/(0,j.jsxs)("div",{className:k.searchbarContainer,children:[/*#__PURE__*/(0,j.jsx)("div",{className:k.searchIcon,children:/*#__PURE__*/(0,j.jsx)(s.A,{size:{width:18,height:18}})}),/*#__PURE__*/(0,j.jsx)("input",{className:k.searchbar,onChange:e=>{t||r(!0),m(e.target.value)},placeholder:p("Find more tags"),value:u}),t&&/*#__PURE__*/(0,j.jsx)("button",{"aria-label":g("Label for a button that will allow a user to dismiss a tag search","Dismiss tag search"),className:k.closeIcon,onClick:()=>{m(""),r(!1),v(),T()},children:/*#__PURE__*/(0,j.jsx)(a.A,{size:{width:12,height:12}})})]}),/*#__PURE__*/(0,j.jsx)("hr",{}),/*#__PURE__*/(0,j.jsxs)("div",{className:k.manageTagsModal,children:[/*#__PURE__*/(0,j.jsx)("div",{className:k.cell,ref:e=>h(e),style:C,children:/*#__PURE__*/(0,j.jsx)(d.s.Provider,{value:l,children:/*#__PURE__*/(0,j.jsx)(A,{onInteractWithFollowedTags:S,toggleTag:f,unfollowedTags:b})})}),/*#__PURE__*/(0,j.jsx)("div",{className:k.cell,style:C,children:/*#__PURE__*/(0,j.jsx)(n.A,{hideSearchInput:!0,onInteractWithFollowedTags:S,searchKeyword:u})})]})]})}},24205:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(63135).A)(()=>Promise.all([r.e(6275),r.e(7794),r.e(6383),r.e(7626)]).then(r.bind(r,58770)),"AsyncMessaging")},46670:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(88346),s=/*#__PURE__*/r.n(a),o=r(36665),n=r(86619),i=r(60397);class l extends o.Component{constructor(...e){super(...e),s()(this,"state",{isOpen:!1}),s()(this,"toggle",()=>this.setState(e=>({isOpen:!e.isOpen})))}render(){return/*#__PURE__*/(0,i.jsx)(n.Ay,{isOpen:this.state.isOpen,toggle:this.toggle,...this.props,children:this.props.children})}}},65447:(e,t,r)=>{"use strict";r.d(t,{I:()=>J});var a=r(88346),s=/*#__PURE__*/r.n(a),o=r(74059),n=/*#__PURE__*/r.n(o),i=r(69998),l=r(90657),c=r(52017),d=r(44554),h=r(28230),u=r(86619),m=r(12044),g=r(49315),p=r(86115),b=r(59454),f=r(4613);let v=(e,t)=>["search-typeahead",e,t];var y=r(90789),x=r(10325),w=r(373);let T=w.z.lazy(()=>(0,y.h)(w.z.object({tags:w.z.array(w.z.object({id:w.z.string(),name:w.z.string(),thumbUrl:w.z.string().nullable(),unreadCount:w.z.string().nullable(),trending:w.z.boolean().nullable().optional(),recentPosts:w.z.number().nullable().optional(),followers:w.z.number().nullable().optional(),socialProof:w.z.object({followerCount:w.z.string(),recentPostsCount:w.z.string(),showFollowerCount:w.z.boolean(),showRecentPostsCount:w.z.boolean()}).nullable().optional()}).transform(x.N))})).transform(e=>e.response.tags)),j={sort:"tag_name",sort_order:"asc"},S=(e,t=j)=>["user-tags",e,t];var A=r(36665),C=r(33672),k=r(53986),F=r(12733),N=r(94048),M=r(89972),P=r(77717),H=r(5064),B=r(46302),I=r(25183);let R=()=>{let{logEvent:e}=(0,I.Ul)(),[t,r]=(0,A.useState)(null);return{log:(0,A.useCallback)((r,a)=>{e({eventName:r,eventDetails:{...a,...t&&{typeahead_request_id:t},...a?.search_query&&{search_query_length:a.search_query.length}}})},[e,t]),setSearchRequestId:r}};var E=r(67819),$=r(60397);let D=()=>{let[e,t]=(0,A.useState)(!1),r=()=>t(!1);return{modal:e?/*#__PURE__*/(0,$.jsx)(E.A,{onClose:r}):null,openModal:()=>t(!0),closeModal:r}};var W=r(14899),z=r(62391),L=r(47741);let _={formButtonContainer:"VsY8z",formContainer:"Mw2UR",form:"aogHd",searchbarContainer:"oPa7v",chromeContext:"Qqfho",contentContext:"u54ka",imageContext:"QkAgj",searchIcon:"Z3WPg",searchInput:"j8Eiw",loaderContainer:"GT10N",rounderCorners:"yrINf"};var U=r(63135);let O=(0,U.A)(()=>r.e(6957).then(r.bind(r,50612)).then(({TypeaheadDropdownContainer:e})=>({default:e})),"AsyncTypeaheadDropdown"),q=(0,U.A)(()=>r.e(6957).then(r.bind(r,18692)).then(({LoggedOutEmptyState:e})=>({default:e})),"AsyncLoggedOutEmptyState"),Y=e=>e?.map(e=>Object.keys(e)[0]),G=(e,t)=>e?.reduce((e,r)=>{let a=Object.keys(r)[0];return t&&!t.includes(a)?e:{...e,[a]:r[a]}},{}),K=(e,t)=>{let r=G(e,t);return!!r?.blogs?.length||!!r?.communities?.length||!!r?.searches?.length||!!r?.tags?.length};class X extends A.Component{constructor(...e){super(...e),s()(this,"state",{isLoading:!1,isOpen:!1,searchKeyword:this.props.initialSearchTerm||"",trendingTags:[]}),s()(this,"debounceDelay",250),s()(this,"debouncedTypeaheadSearch",(0,B.A)(this.typeaheadSearch,this.debounceDelay)),s()(this,"inputRef",/*#__PURE__*/(0,A.createRef)()),s()(this,"renderSearchForm",()=>{let{appContext:{_t:e,wwwBaseUrl:t},autoCapitalize:r="on",containerClassName:a,context:s,emptyStateQuery:o,followedTagsQuery:i,hasFocus:c,hideIcon:u,iconClassName:m,placeholder:g}=this.props,{searchKeyword:p,isLoading:b}=this.state,{isPending:f,isFetching:v}=o,{isPending:y,isFetching:x}=i,w={[_.chromeContext]:"chrome"===s,[_.contentContext]:"content"===s,[_.imageContext]:"image"===s};return/*#__PURE__*/(0,$.jsx)("form",{action:`${t}/search`,className:_.form,method:"GET",onSubmit:this.submitForm,role:"search",children:/*#__PURE__*/(0,$.jsxs)("div",{className:n()(_.searchbarContainer,w,a),children:[!u&&/*#__PURE__*/(0,$.jsx)("div",{className:n()(_.searchIcon,w,m),children:/*#__PURE__*/(0,$.jsx)(d.A,{size:{width:18,height:18}})}),/*#__PURE__*/(0,$.jsx)(l.Ay,{disable:c?l.WC:void 0,hotkey:{key:l.qW.Slash,command:this.focus,allowInputs:!1},children:/*#__PURE__*/(0,$.jsx)("input",{"aria-label":e("Search"),autoCapitalize:r,autoComplete:"off",className:n()(_.searchInput,w),name:"q",onChange:this.onInputChange,onFocus:this.onInputFocus,onKeyDown:this.onInputKeyDown,placeholder:g||e("Search Tumblr"),ref:this.inputRef,type:"text",value:p})}),(b||f&&v||y&&x)&&/*#__PURE__*/(0,$.jsx)("div",{className:_.loaderContainer,children:/*#__PURE__*/(0,$.jsx)(h.A,{centerOrientation:"horizontalAndVertical",color:"chrome"===s?L.colorChromeFgTertiary:"content"===s?L.colorContentFgTertiary:L.colorImageFgTertiary,small:!0})})]})})}),s()(this,"handleKeydownEvent",e=>t=>{let{key:r}=t;if(!["ArrowUp","ArrowDown"].includes(r))return;t.preventDefault?.();let a=Array.from(e?.getElementsByTagName("a")),s=a?.indexOf(document.activeElement);if("ArrowDown"===r?s++:s--,s<0){this.inputRef.current?.focus();return}s>=a.length&&(s=0),a[s]?.focus()}),s()(this,"onInputChange",({target:{value:e}})=>{this.setState({searchKeyword:e},()=>this.props.enableTypeahead&&this.debouncedTypeaheadSearch()),this.props.onInputChange?.(e)}),s()(this,"onInputFocus",()=>{let{appContext:{logEvent:e}}=this.props;this.props.setHasFocus(!0),this.getTrendingTagsIfNeeded(),e({eventName:N.R.SearchTypeaheadStartTap}),e({eventName:N.R.SearchBarClickExpanded})}),s()(this,"onInputKeyDown",e=>{e.key===l.qW.Escape&&this.closePopover(!0)}),s()(this,"onSearchBarBlur",async e=>{this.props.isTypeaheadFullscreen||await (0,W.A)(e)||!this.state.isOpen||this.closePopover(!0)}),s()(this,"renderSearchFormWithTypeahead",()=>{let{isOpen:e}=this.state,{isTypeaheadFullscreen:t,glassContext:{glassContainerRef:r},rightControl:a,withMobileControls:s}=this.props,o=/*#__PURE__*/(0,$.jsx)(Q,{...this.props,...this.state,closePopover:()=>this.closePopover(),debouncedTypeaheadSearch:()=>this.debouncedTypeaheadSearch()});return t?/*#__PURE__*/(0,$.jsxs)($.Fragment,{children:[s?/*#__PURE__*/(0,$.jsxs)("div",{className:_.formButtonContainer,children:[this.renderSearchForm(),a&&!e?a:/*#__PURE__*/(0,$.jsx)(i.sP,{context:"chrome",icon:/*#__PURE__*/(0,$.jsx)(c.V5W,{}),onClick:()=>this.closePopover(!0)})]}):this.renderSearchForm(),e&&this.hasResults()&&r&&/*#__PURE__*/(0,C.createPortal)(o,r)]}):/*#__PURE__*/(0,$.jsx)(u.Ay,{component:o,handleKeydownEvent:this.handleKeydownEvent,height:"auto",isOpen:e,maxHeight:"70vh",popoverWrapperClassName:_.rounderCorners,skipClickToOpen:!0,tabIndex:-1,toggle:null,type:M.oO.Click,width:"100%",children:this.renderSearchForm()})}),s()(this,"closePopover",(e=!1)=>{let{setHasFocus:t,logSearchEvent:r}=this.props;t(!1),this.setState({isOpen:!1}),e&&r(N.R.SearchTypeaheadCancelTap)}),s()(this,"focus",()=>this.inputRef.current?.focus()),s()(this,"blur",()=>this.inputRef.current?.blur()),s()(this,"submitForm",e=>{let{searchKeyword:t}=this.state,{getSearchPathWithFilters:r,hardLinkToSearchPage:a,searchInNewWindow:s,appContext:{wwwBaseUrl:o},logSearchEvent:n}=this.props;e.preventDefault();let i=e.target.querySelector('input[name="q"]'),l=i?.value?.trim(),c="/explore/";if(l&&(c=r?r(l,"typed_query"):(0,m.Tv)(l,"search",{src:"typed_query"})),n(N.R.SearchTypeaheadEnterTap,{search_query:t}),a){let e=`${o}${c}`;s?window.open(e):location.assign(e)}else this.props.navigate(c),this.closePopover();this.blur()}),s()(this,"hasResults",()=>{let{emptyStateQuery:e,followedTagsQuery:t,resultTypes:r}=this.props,{searchResults:a,trendingTags:s}=this.state,{data:o}=e,{data:n}=t,i=(0,z.wH)(),l=r&&!r.includes("searches"),c=r&&!r.includes("tags");return!c&&!!n?.length||!l&&!!i.length||!c&&!!s.length||K(o?.results,r)||K(a,r)})}componentDidUpdate(e){this.updateOpenState(),this.props.initialSearchTerm!==e.initialSearchTerm&&this.setState({searchKeyword:this.props.initialSearchTerm||""})}componentDidMount(){(this.props.autoFocus||this.props.location.state?.autoFocusSearch)&&this.focus(),this.props.enableTypeahead&&""!==this.state.searchKeyword&&this.debouncedTypeaheadSearch()}render(){let{className:e,enableTypeahead:t}=this.props;return/*#__PURE__*/(0,$.jsx)("div",{className:n()(_.formContainer,e),onBlur:this.onSearchBarBlur,children:t?this.renderSearchFormWithTypeahead():this.renderSearchForm()})}async getTrendingTagsIfNeeded(){let{appContext:{isLoggedIn:e,apiFetch:t}}=this.props;if(!e&&!this.state.trendingTags.length){this.setState({isLoading:!0});let{response:{timeline:{elements:e}}}=await (0,P.PG)(t);this.setState({isLoading:!1,trendingTags:e.map(e=>e.resources[0])})}}async typeaheadSearch(){let e;let{appContext:{apiFetch:t},setSearchRequestId:r}=this.props,{searchKeyword:a}=this.state;if(a){this.setState({isLoading:!0});let{response:{requestId:s,results:o}}=await (0,b.U1)(t,a,{query_source:"search_box"}).fetch();r?.(s),e=o}this.setState({isLoading:!1,searchResults:e})}updateOpenState(){let{isOpen:e}=this.state,{hasFocus:t}=this.props;!e&&t&&this.hasResults()&&this.setState({isOpen:!0})}}let Q=({closePopover:e,emptyStateQuery:t,followedTagsQuery:r,getSearchPathWithFilters:a,hidePivots:s=!1,isTypeaheadFullscreen:o,logSearchEvent:n,onClickManageTags:i,resultTypes:l,searchKeyword:c,searchResults:d,trendingTags:h})=>{let{isLoggedIn:u}=(0,f.Us)(),{data:m}=t,{data:g}=r;if(!u&&""===c&&h.length)return/*#__PURE__*/(0,$.jsx)(q,{isFullscreen:!!o,logSearchEvent:n,onClickRow:e,tags:h});let p=m?.results,b=l&&!l.includes("tags"),v=G(p,l),y=G(d,l),x=Y(d??p);return/*#__PURE__*/(0,$.jsx)(O,{emptyStateSuggestions:v,followedTags:!b&&g?g:[],getSearchPathWithFilters:a,hidePivots:s,isFullscreen:!!o,keywordSuggestions:y,logSearchEvent:n,onClickManageTags:i,onClickRow:e,order:x,query:c})},J=({enableTypeahead:e=!0,...t})=>{let r=(0,f.Us)(),a=(0,H.T2)(),s=(0,k.zy)(),o=(0,k.Zp)(),[n,i]=(0,A.useState)(!!s.state?.autoFocusSearch),{log:l,setSearchRequestId:c}=R(),d=(0,F.h)(),h=e&&n,u=function(e="",t,r){let{apiFetch:a}=(0,f.Us)();return(0,g.I)({queryFn:async()=>{let{response:r}=await (0,b.U1)(a,e,t).fetch();return r},queryKey:v(e,t),refetchOnMount:!1,refetchOnWindowFocus:!1,staleTime:10*p.g.Minute,...r})}(void 0,{query_source:"search_box"},{enabled:h,staleTime:1/0}),m=function(e,t){let{apiFetchWithSchema:r,isLoggedIn:a}=(0,f.Us)();return(0,g.I)({queryKey:S(a,void 0),queryFn:async()=>a?await r("/v2/user/tags",T,{schemaErrorPrintFullResponse:!0,queryParams:void 0}):null,refetchOnWindowFocus:!1,refetchOnMount:!1,staleTime:6e5,...e})}({enabled:h,staleTime:0}),{modal:y,openModal:x}=D();return/*#__PURE__*/(0,$.jsxs)($.Fragment,{children:[/*#__PURE__*/(0,$.jsx)(X,{appContext:r,emptyStateQuery:u,enableTypeahead:e,followedTagsQuery:m,getSearchPathWithFilters:d,glassContext:a,hasFocus:n,location:s,logSearchEvent:l,navigate:o,onClickManageTags:x,setHasFocus:i,setSearchRequestId:c,...t}),y]})}},97816:(e,t,r)=>{"use strict";r.d(t,{A:()=>k});var a=r(88346),s=/*#__PURE__*/r.n(a),o=r(44554),n=r(28230),i=r(36665),l=r(11221),c=r(77717),d=r(59454),h=r(54934),u=r(46302),m=r(79409),g=r(74082),p=r(56040),b=/*#__PURE__*/r.n(p),f=r(74059),v=/*#__PURE__*/r.n(f),y=r(11100),x=r(8079),w=r(4613);let T={formContainer:"icbzP",results:"QkCVo",searchbarContainer:"pQkU5",searchIcon:"dmeYi",searchbar:"nIUnP",loaderContainer:"N4KIX",resultRow:"hXWAf",rowContents:"GXxZQ",buttonWrapper:"Z6ZAw",unfollowed:"yqeGG",tagText:"Wc04C"};var j=r(60397);class S extends i.PureComponent{constructor(...e){super(...e),s()(this,"toggleTagFollowStatus",e=>{e.preventDefault();let{name:t,isFollowed:r,appContext:{apiFetch:a}}=this.props;return r?(this.unfollowTagRequest=(0,g.A)((0,x.Zo)(a,t,"explore").fetch()),this.unfollowTagRequest.then(()=>this.props.onUnfollow(t))):(this.followTagRequest=(0,g.A)((0,x.Wy)(a,t,"explore").fetch()),this.followTagRequest.then(()=>this.props.onFollow(t)))})}componentWillUnmount(){this.followTagRequest?.cancel(),this.unfollowTagRequest?.cancel()}render(){let{name:e,isFollowed:t,appContext:{_t:r}}=this.props,a=r(t?"Unfollow":"Follow"),s=/*#__PURE__*/(0,j.jsx)(y.A,{label:a,onClick:this.toggleTagFollowStatus,wrapperClassName:v()(T.buttonWrapper,{[T.unfollowed]:!!t}),children:a});return/*#__PURE__*/(0,j.jsx)("div",{className:T.resultRow,children:/*#__PURE__*/(0,j.jsxs)("div",{className:T.rowContents,children:[/*#__PURE__*/(0,j.jsxs)("span",{className:T.tagText,children:["#",e]})," ",s]})})}}let A=(0,w.Lk)(S);class C extends i.Component{constructor(...e){super(...e),s()(this,"state",{searchKeyword:"",followedTags:[],searchTags:[],recommendedTags:[],isLoading:!0}),s()(this,"debounceDelay",250),s()(this,"debouncedTypeaheadSearch",(0,u.A)(this.typeaheadSearch,this.debounceDelay)),s()(this,"inputRef",/*#__PURE__*/(0,i.createRef)()),s()(this,"followTag",e=>{this.setState(t=>{let r=[...t.followedTags];return r.push(e),this.props.onInteractWithFollowedTags?.(),{...t,followedTags:r}})}),s()(this,"unfollowTag",e=>{this.setState(t=>{let r=[...t.followedTags];return this.props.onInteractWithFollowedTags?.(),{...t,followedTags:r.filter(t=>t!==e)}})}),s()(this,"renderSearchForm",()=>{let{appContext:{_t:e},paletteContext:t}=this.props,{searchKeyword:r,isLoading:a}=this.state,s=t.name===l.A.trueBlue?b().paletteGray65:b().paletteTransparentWhite65;return/*#__PURE__*/(0,j.jsxs)("div",{className:T.searchbarContainer,children:[/*#__PURE__*/(0,j.jsx)("div",{className:T.searchIcon,children:/*#__PURE__*/(0,j.jsx)(o.A,{size:{width:18,height:18}})}),/*#__PURE__*/(0,j.jsx)("input",{"aria-label":e("Search"),autoComplete:"off",className:T.searchbar,name:"q",onChange:this.onInputChange,placeholder:e("What kind of things make you happy?"),ref:this.inputRef,type:"text",value:r}),a&&/*#__PURE__*/(0,j.jsx)("div",{className:T.loaderContainer,children:/*#__PURE__*/(0,j.jsx)(n.A,{centerOrientation:"horizontalAndVertical",color:s,small:!0})})]})}),s()(this,"renderRecommendedResults",()=>{let{recommendedTags:e,followedTags:t}=this.state,r=!(0,m.V)(e)&&/*#__PURE__*/(0,j.jsx)(j.Fragment,{children:e.map((e,r)=>/*#__PURE__*/(0,j.jsx)(A,{isFollowed:t.includes(e),name:e,onFollow:this.followTag,onUnfollow:this.unfollowTag},r))});return/*#__PURE__*/(0,j.jsx)("div",{className:T.results,children:r})}),s()(this,"onInputChange",({target:e})=>this.setState({searchKeyword:e.value},()=>this.debouncedTypeaheadSearch()))}componentDidMount(){let{apiFetch:e}=this.props.appContext;return this.recommendedFetch=(0,g.A)((0,c.fc)(e).fetch()),this.recommendedFetch.then(({response:{timeline:{elements:e}}})=>{let t=e.map(e=>e.tagName);this.setState({recommendedTags:t,isLoading:!1})})}componentDidUpdate(){let{searchKeyword:e}=this.props;e&&e!==this.state.searchKeyword&&this.setState({searchKeyword:e},()=>this.debouncedTypeaheadSearch())}componentWillUnmount(){this.recommendedFetch?.cancel(),this.searchFetch?.cancel()}render(){let{hideSearchInput:e}=this.props,{searchKeyword:t}=this.state;return/*#__PURE__*/(0,j.jsxs)("div",{className:T.formContainer,children:[!e&&this.renderSearchForm(),t?this.renderResults():this.renderRecommendedResults()]})}renderResults(){let{searchTags:e,followedTags:t}=this.state,r=!(0,m.V)(e)&&/*#__PURE__*/(0,j.jsx)(j.Fragment,{children:e.map((e,r)=>/*#__PURE__*/(0,j.jsx)(A,{isFollowed:t.includes(e.tag),name:e.tag,onFollow:this.followTag,onUnfollow:this.unfollowTag},r))});return/*#__PURE__*/(0,j.jsx)("div",{className:T.results,children:r})}async typeaheadSearch(){let{searchKeyword:e}=this.state;if(e){this.setState({isLoading:!0}),this.searchFetch=(0,g.A)((0,d.MS)(this.props.appContext.apiFetch,e).fetch());let{response:{typeahead:t}}=await this.searchFetch,r=t?.findIndex(t=>t.tag===e)||0;t&&r>0&&(t=[t[r],...t.filter(t=>t.tag!==e)]);let a=[...this.state.followedTags];t?.forEach(e=>{e.isTracked&&!a.includes(e.tag)&&a.push(e.tag)}),this.setState({searchTags:t?.length?t:[{tag:e}],isLoading:!1,followedTags:a})}else this.setState({searchTags:[],isLoading:!1})}}let k=(0,h.bb)(C,{appContext:!0,paletteContext:!0})},44842:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var a=r(27699),s=r(56365),o=r(85191),n=r(56356),i=r(31001);let l={ask:"XZFs6",askBubble:"WIYYp",message:"wvu3V",asker:"pM6pK",content:"IxFyd",point:"SBa73",avatarContainer:"ZCpAa"};var c=r(60397);let d=({blog:e,isAsking:t,components:r,post:d})=>{let h=(0,n.rr)(),u=(0,i.V)(),m=d||h?.post||u?.editablePost||null,g=/*#__PURE__*/(0,c.jsx)("span",{className:l.asker,children:e?e.name:/*#__PURE__*/(0,c.jsx)(o.Ay,{children:"Anonymous"})}),p=t?/*#__PURE__*/(0,c.jsx)(o.Ay,{components:{blog:g},children:"[blog/] asked:"}):/*#__PURE__*/(0,c.jsx)(o.Ay,{components:{blog:g},children:"[blog/] answered:"});m?.isAdFreeGiftAsk&&(p=/*#__PURE__*/(0,c.jsx)(o.Ay,{components:{blog:g},children:"[blog/] gifted you Tumblr Ad-Free Browsing!"})),m?.isTumblrmartGiftAsk&&(p=/*#__PURE__*/(0,c.jsx)(o.Ay,{components:{blog:g},children:"[blog/] sent you a gift from TumblrMart!"}));let b=e?/*#__PURE__*/(0,c.jsx)(s.A,{blog:e,blogName:e.name,href:e.url,children:p}):p;return/*#__PURE__*/(0,c.jsxs)("div",{className:l.ask,children:[/*#__PURE__*/(0,c.jsxs)("div",{className:l.askBubble,children:[/*#__PURE__*/(0,c.jsx)("div",{className:l.message,children:b}),/*#__PURE__*/(0,c.jsx)("div",{className:l.content,children:r}),/*#__PURE__*/(0,c.jsx)("div",{className:l.point})]}),/*#__PURE__*/(0,c.jsx)("div",{className:l.avatarContainer,children:/*#__PURE__*/(0,c.jsx)(a.A,{dimension:40,imageResponse:e?.avatar,isAnonymous:!e,name:e?.name,url:e?.url})})]})}},60651:(e,t,r)=>{"use strict";r.d(t,{A:()=>ea});var a=r(74059),s=/*#__PURE__*/r.n(a),o=r(29130),n=r(83087),i=r(27162),l=r(90657),c=r(84509),d=r(96894),h=r(70075);let u=r.p+"src/assets/images/horse-friend/horse-icon-e9d24a6a.png";var m=r(11100),g=r(46466),p=r(36665),b=r(33672),f=r(94048),v=r(4613),y=r(68484),x=r(99805);let w=r.p+"src/assets/images/horse-friend/headstone-f059b08d.png";var T=r(85191),j=r(21070);let S={horseFriend:"HNmfZ",horseFriendContainer:"Tcv9q",buttonIcon:"alRCv",active:"yHUeZ",horse:"VpfQW",horseFriendExpanded:"lVYgD",controlButtons:"C9Tsj",minimizeButton:"MgKiV",shareButton:"pyw0l",horseFriendGame:"XeOtC",sprite:"NZfyq",infoBox:"rDO3F",stats:"BZ18Y",poosRemoved:"lBtW2",comfortBarContainer:"CmXCV",comfortBar:"lvJLA",deathButtons:"FDLE7",horseFriendButton:"DUbBR",cemetery:"t551P",header:"OhWKq",headStones:"kGL95",headStone:"XLm40",headStoneText:"KPNq5",hide:"JOCmG"};var A=r(60397);let C=({onHeadstoneClick:e})=>{let{_c:t}=(0,v.Us)(),{state:r,dispatch:a}=(0,j.uA)(),[s,o]=(0,p.useState)(x.horseFriendHeaderHeight),[n,i]=(0,p.useState)(-1);(0,p.useEffect)(()=>{if(r.cemetery.length>x.horseFriendHeadstonesInViewport){let e=x.horseFriendHeadstoneViewportHeight-r.cemetery.length*x.horseFriendHeadstoneSize;-1===n&&s<e&&i(1),1===n&&s>x.horseFriendHeaderHeight&&i(-1),o(s+.5*n)}},[r.tick]);let l=t=>{let a=x.horseFriendHeadstoneSize+x.horseFriendHeadstoneTopMargin,o=parseInt(t.currentTarget.getAttribute("data-index")||"0");e({x:x.horseFriendPadding+x.horseFriendHeadstoneSize/2,y:s+o*a+a/2,id:`heart${o}${r.tick}`,opacity:1})};return/*#__PURE__*/(0,A.jsxs)("div",{className:S.cemetery,children:[/*#__PURE__*/(0,A.jsx)("div",{className:S.header,style:{height:x.horseFriendHeaderHeight},children:/*#__PURE__*/(0,A.jsx)("button",{className:S.horseFriendButton,onClick:()=>{a({type:"setShouldShowCemetery",shouldShowCemetery:!1})},children:/*#__PURE__*/(0,A.jsx)(T.Ay,{comment:"[Tumblrmart] Label on a button that brings the user back to playing Horse Friend",children:"tend to your horse"})})}),/*#__PURE__*/(0,A.jsx)("div",{className:S.headStones,style:{top:s},children:r.cemetery.map((e,r)=>/*#__PURE__*/(0,A.jsxs)("div",{className:S.headStone,children:[/*#__PURE__*/(0,A.jsx)("button",{"aria-label":t("[Tumblrmart] Label on a Horse Friend tombstone button that when clicked, allows the player to remember their dead horse","remember your horse"),"data-index":r,onClick:l,children:/*#__PURE__*/(0,A.jsx)("img",{alt:"",height:x.horseFriendHeadstoneSize,src:w,width:x.horseFriendHeadstoneSize})}),/*#__PURE__*/(0,A.jsxs)("div",{className:S.headStoneText,children:[/*#__PURE__*/(0,A.jsxs)(T.P0,{comment:"[Tumblrmart] text in Horse Friend that list a horse's name and how many days they lived",components:{br:/*#__PURE__*/(0,A.jsx)("br",{})},number:e.horse.age,params:{name:e.horse.name,number:e.horse.age},children:[/*#__PURE__*/(0,A.jsx)(T.M$,{children:"[name] [br /] lived for 1 day"}),/*#__PURE__*/(0,A.jsx)(T.$e,{children:"[name] [br /] lived for [number] days"})]})," - ",/*#__PURE__*/(0,A.jsx)(T.Ay,{comment:"[Tumblrmart] text in Horse Friend that lists the players numeric score",params:{scoreNumber:e.poosRemoved},children:"score: [scoreNumber]"})]})]},`headstone${e.horse.name}`))})]})},k=()=>{let{logEvent:e}=(0,v.Us)(),{state:t,dispatch:r}=(0,j.uA)();return t.currentHorse.isAlive?null:/*#__PURE__*/(0,A.jsxs)("div",{className:S.deathButtons,children:[/*#__PURE__*/(0,A.jsx)("button",{className:S.horseFriendButton,onClick:()=>{e({eventName:f.R.HorseFriendHatched}),r({type:"hatchNewHorse"})},children:/*#__PURE__*/(0,A.jsx)(T.Ay,{comment:"[Tumblrmart] Label on a Horse Friend button that allows player to hatch a new horse",children:"hatch a new one"})}),/*#__PURE__*/(0,A.jsx)("button",{className:S.horseFriendButton,onClick:()=>{r({type:"setShouldShowCemetery",shouldShowCemetery:!0})},children:/*#__PURE__*/(0,A.jsx)(T.Ay,{comment:"[Tumblrmart] Label on a Horse Friend button that brings player to the cemetery",children:"remember your dead"})})]})},F=r.p+"src/assets/images/horse-friend/heart-40ba85e3.png",N=({heart:e})=>{let{dispatch:t,state:r}=(0,j.uA)(),[a,s]=(0,p.useState)(1);(0,p.useEffect)(()=>{setTimeout(()=>o(),2e3)},[]),(0,p.useEffect)(()=>{r.tick%10==0&&s(-1*a),t({type:"updateHeart",heart:{...e,x:e.x+a*j.JA,y:e.y-j.JA,opacity:e.opacity-j._d}})},[r.tick]);let o=()=>{t({type:"removeHeart",heart:e})};return/*#__PURE__*/(0,A.jsx)("div",{className:S.sprite,style:{width:x.horseFriendHeartSize,height:x.horseFriendHeartSize,left:e.x,top:e.y,opacity:e.opacity},children:/*#__PURE__*/(0,A.jsx)("img",{alt:"",height:x.horseFriendHeartSize,role:"img",src:F,width:x.horseFriendHeartSize})})},M=({onHorseClick:e})=>{let[t,r]=(0,p.useState)(0),[a,s]=(0,p.useState)(0),[o,n]=(0,p.useState)(!1),[i,l]=(0,p.useState)(!0),[c,d]=(0,p.useState)(!1),{state:h,dispatch:u}=(0,j.uA)();(0,p.useEffect)(()=>{let{x:e,y:t}=m();u({type:"setHorseX",x:e}),u({type:"setHorseY",y:t})},[]),(0,p.useEffect)(()=>{g(),(h.horseDesiredX||h.horseDesiredY)&&C(),o&&h.currentHorse.isAlive?h.tick%2==0?w():T():h.currentHorse.isAlive?(y(),k()):v()},[h.tick]);let m=()=>({x:Math.floor(x.horseFriendCanvasWidth/2-x.horseFriendHorseWidth/2),y:h.currentHorse.isAlive?x.horseFriendCanvasHeight-x.horseFriendHorseHeight:x.horseFriendCanvasHeight/2+36}),g=(0,p.useCallback)(()=>{!o&&i&&h.currentHorse.isAlive&&(u({type:"setHorseDesiredX",x:Math.floor(Math.random()*(x.horseFriendCanvasWidth-x.horseFriendHorseWidth))}),l(!1))},[o,i,h.currentHorse,u]),b=()=>s(x.horseFriendHorseHeight+2*x.horseFriendHorsePadding),f=()=>s(x.horseFriendHorsePadding),v=()=>r(3*x.horseFriendHorseWidth+6*x.horseFriendHorsePadding),y=()=>r(x.horseFriendHorsePadding),w=()=>r(x.horseFriendHorseWidth+3*x.horseFriendHorsePadding),T=()=>r(2*x.horseFriendHorseWidth+5*x.horseFriendHorsePadding),C=(0,p.useCallback)(()=>{h.horseDesiredX&&(h.horseDesiredX>h.horseX?(n(!0),h.currentHorse.isAlive&&(b(),u({type:"setHorseFacingLeft",facingLeft:!1})),u({type:"setHorseX",x:Math.floor(h.horseX+1)})):h.horseDesiredX<h.horseX?(n(!0),h.currentHorse.isAlive&&(f(),u({type:"setHorseFacingLeft",facingLeft:!0})),u({type:"setHorseX",x:Math.floor(h.horseX-1)})):(n(!1),u({type:"setHorseDesiredX",x:null}))),h.horseDesiredY&&(h.horseDesiredY>h.horseY?u({type:"setHorseY",y:h.horseY+1}):h.horseDesiredY<h.horseY?u({type:"setHorseY",y:h.horseY-1}):u({type:"setHorseDesiredY",y:null}))},[u,h.currentHorse,h.horseDesiredX,h.horseX,h.horseY,h.horseDesiredY]),k=(0,p.useCallback)(()=>{!c&&h.currentHorse.isAlive&&(d(!0),setTimeout(()=>{h.currentHorse.isAlive&&(l(!0),d(!1))},(Math.floor(3*Math.random())+1)*1e3))},[h.currentHorse,c]);return/*#__PURE__*/(0,A.jsx)("button",{className:S.sprite,onClick:()=>{h.currentHorse.isAlive&&e({x:h.horseX+16,y:h.horseY,opacity:1,id:`heart${h.tick}${h.currentHorse.age}`})},style:{height:x.horseFriendHorseHeight,width:x.horseFriendHorseWidth,top:h.horseY,left:h.horseX},children:/*#__PURE__*/(0,A.jsx)("div",{className:S.horse,style:{backgroundPositionX:-t,backgroundPositionY:-a}})})},P=()=>{let{_c:e,_cn:t}=(0,v.Us)(),{state:r}=(0,j.uA)(),{name:a,age:s,isAlive:o}=r.currentHorse,[n,i]=(0,p.useState)(0);(0,p.useEffect)(()=>{i(r.horseComfortLevel/100*(x.horseFriendCanvasWidth/2-10))},[r.tick]);let l=o?"":e("[TumblrMart horse friend widget]: text indicating that the horse is dead. RIP is an acronym for rest in peace","(RIP)"),c=t("[TumblrMart horse friend widget]: text indicating the age of a horse in days","%1$s day old","%1$s days old",s);return/*#__PURE__*/(0,A.jsxs)(A.Fragment,{children:[/*#__PURE__*/(0,A.jsx)("div",{className:S.infoBox,children:/*#__PURE__*/(0,A.jsxs)("p",{children:[a,/*#__PURE__*/(0,A.jsx)("br",{}),`${c} ${l}`]})}),/*#__PURE__*/(0,A.jsxs)("div",{className:S.stats,children:[/*#__PURE__*/(0,A.jsx)("div",{className:S.comfortBarContainer,children:/*#__PURE__*/(0,A.jsx)("div",{className:S.comfortBar,style:{width:n}})}),/*#__PURE__*/(0,A.jsx)("div",{className:S.poosRemoved,children:r.poosRemoved})]})]})},H=r.p+"src/assets/images/horse-friend/poo-4d6e296d.png",B=({poo:e})=>{let{_c:t}=(0,v.Us)(),{state:r,dispatch:a}=(0,j.uA)(),s=(0,p.useCallback)(()=>{r.currentHorse.isAlive&&(a({type:"setPoos",poos:r.poos.filter(t=>t.id!==e.id)}),a({type:"setPoosRemoved",poosRemoved:r.poosRemoved+1}))},[a,r.poos,r.currentHorse.isAlive,r.poosRemoved,e.id]);return/*#__PURE__*/(0,A.jsx)(m.A,{className:S.sprite,label:t("[TumblrMart horse friend widget]: Label for a button that will clean up a horse's poo, and increase the player's score","Click to remove poo"),onClick:s,style:{height:x.horseFriendPooHeight,width:x.horseFriendPooWidth,top:e.y,left:e.x},children:/*#__PURE__*/(0,A.jsx)("img",{alt:"",height:x.horseFriendPooHeight,src:H,style:{top:0,left:0},width:x.horseFriendPooWidth})})},I=()=>{let{state:e,dispatch:t}=(0,j.uA)(),r=(0,p.useRef)();(0,p.useEffect)(()=>(r.current=setInterval(()=>{let{tick:r,currentHorse:a,poos:s,horseComfortLevel:o,cemetery:n,horseFacingLeft:i,horseX:l,horseDesiredX:c,horseDesiredY:d,poosRemoved:h,hearts:u}=e,m=r+1,g=a,p=o,b=n,f=s,v=c,y=d;if(m>=j.O2&&(m=0,g=a.isAlive?{...g,age:g.age+1}:g),a.isAlive){let e=.1*j.sv;0===s.length?p=o+1.5*e+u.length/25:0===u.length&&(p=o-s.length*e),(p=(0,j.qE)(p,0,100))<=0&&(b=[{horse:g={...g,isAlive:!1},poosRemoved:h}].concat(n),v=Math.floor(x.horseFriendCanvasWidth/2-x.horseFriendHorseWidth/2),y=x.horseFriendCanvasHeight/2+36)}if(g.isAlive&&(m+1)%300==0&&s.length<3&&.8>Math.random()&&0===u.length){let e=i?l+x.horseFriendHorseWidth:l-x.horseFriendPooWidth,t={id:`poo${r}${g.age}`,x:(0,j.qE)(e,0,x.horseFriendCanvasWidth-x.horseFriendPooWidth),y:x.horseFriendCanvasHeight-x.horseFriendPooHeight,opacity:1};f=s.concat([t])}t({type:"tick",gameState:{tick:m,cemetery:b,currentHorse:g,horseComfortLevel:p,poos:f,horseDesiredX:v,horseDesiredY:y}})},j.Mr),()=>clearInterval(r.current)),[e]);let a=(0,p.useCallback)(r=>{e.hearts.length<j.ej&&t({type:"addHeart",heart:r})},[e.hearts]);return/*#__PURE__*/(0,A.jsxs)("div",{className:S.horseFriendGame,children:[e.hearts.map(e=>/*#__PURE__*/(0,A.jsx)(N,{heart:e},e.id)),e.shouldShowCemetery?/*#__PURE__*/(0,A.jsx)(C,{onHeadstoneClick:a}):/*#__PURE__*/(0,A.jsxs)(A.Fragment,{children:[/*#__PURE__*/(0,A.jsx)(P,{}),/*#__PURE__*/(0,A.jsx)(k,{}),/*#__PURE__*/(0,A.jsx)(M,{onHorseClick:a}),e.poos.map(e=>/*#__PURE__*/(0,A.jsx)(B,{poo:e},e.id))]})]})},R=r.p+"src/assets/images/horse-friend/headstone@2x-41d6c585.png",E=r.p+"src/assets/images/horse-friend/horse-for-screen-shot@4x-9b8d777b.png";var $=r(98778),D=r(9814),W=r(12044),z=r(53986),L=r(66910),_=r(66869),U=r(56281),O=r(56040),q=/*#__PURE__*/r.n(O);let Y=()=>{let{toggleToast:e}=(0,U.Y)(),{_c:t,_cn:r,apiFetch:a,logEvent:s}=(0,v.Us)(),o=(0,z.Zp)(),{state:n,dispatch:i}=(0,j.uA)(),[l,c]=(0,p.useState)(!1),d=(0,p.useRef)(null),h=(0,p.useRef)(null),u=(0,p.useRef)(null),g=(0,p.useRef)(null),b=(0,p.useRef)(null),y=()=>{d.current&&d.current.toBlob(s=>{let l=new File([s||""],"horsefriend.png",{type:"image/png"});(0,_.Ay)(a).preUploadImageForNpf(l).fetch().then(({response:e})=>{let a=r("[TumblrMart horse friend widget]: Title on a pre-filled post that details progress in Horse Friend game.","My beloved horse friend","My beloved horse friends",n.shouldShowCemetery?n.cemetery.length:1),s={content:[{type:L._B.Title,text:a},{type:L._B.Image,media:[e]},{type:L._B.Text,text:t("[TumblrMart horse friend widget]: Text proceeds a number of how many horses were hatched while playing Horse Friend","Total horses hatched: %1$s",[(0,j.YJ)(n).toString()])},{type:L._B.Text,text:t("[TumblrMart horse friend widget]: Text proceeds a number of how much poop was collected while playing Horse Friend","Total manure harvested: %1$s",[(0,j.FA)(n).toString()])},...(0,D.b)([t("[TumblrMart horse friend widget]: Text on a link that will open tumblrmart. Gidy up is a command to a horse to make them go faster.","Horse Friend is a gift only available in TumblrMart 🐴"),t("[TumblrMart horse friend widget]: Text on a link that will open tumblrmart. Gidy up is a command to a horse to make them go faster.","Maybe your mutuals could use a Horse Friend right now ❤️ 🐴"),t("[TumblrMart horse friend widget]: Text on a link that will open tumblrmart. Gidy up is a command to a horse to make them go faster.","Find Horse Friend, a manure collecting game, in TumblrMart 🐴💩")])],isPrefilledPost:!0,disableBlogSelection:!1,tags:["horse friend"]};o((0,W.P1)({postType:L.xj.Text}),{state:{newPost:s}}),i({type:"setIsMinimized",isMinimized:!0})}).catch(()=>{e(t("[TumblrMart horse friend widget]: Error message when trying to share a Horse Friend post","Something went wrong. Try again"),"error")})})},w=e=>{if(e&&d.current){let a=Math.max(x.horseFriendCanvasHeight,n.cemetery.length*(x.horseFriendHeadstoneSize+x.horseFriendHeadstoneTopMargin)+x.horseFriendHeaderHeight);d.current.setAttribute("height",(a*j.Jd).toString()),e.scale(j.Jd,j.Jd),e.fillStyle=q().gray25,e.fillRect(0,0,x.horseFriendCanvasWidth,a),e.fillStyle=q().black,e.font="12px monospace",e.textBaseline="top",e.textAlign="center",e.fillText(t("[TumblrMart horse friend widget]: text on a button that will take a user to their cemetary to remember their dead horses","remember your dead"),x.horseFriendCanvasWidth/2,10),e.fillRect(x.horseFriendPadding,x.horseFriendHeaderHeight,x.horseFriendCanvasWidth-2*x.horseFriendPadding,2),e.textAlign="start",n.cemetery.forEach((a,s)=>{if(s<20){let o=s*(x.horseFriendHeadstoneSize+4)+x.horseFriendHeaderHeight+4,n=x.horseFriendHeadstoneSize+2*x.horseFriendPadding,i=r("[TumblrMart horse friend widget]: text indicating how many days a horse lived","lived for %1$s day","lived for %1$s days",a.horse.age),l=t("[TumblrMart horse friend widget]: text preceeds a numerical score acheived while playing Horse Friend","Score: %1$s",[a.poosRemoved.toString()]);g.current&&e.drawImage(g.current,x.horseFriendPadding,o,x.horseFriendHeadstoneSize,x.horseFriendHeadstoneSize),e.fillText(a.horse.name,n,o+2),e.fillText(`${i}, ${l}`,n,o+18)}}),y()}},T=e=>{if(e&&h.current){let a=n.currentHorse.isAlive?"":t("[TumblrMart horse friend widget]: text indicating that the horse is dead. RIP is an acronym for rest in peace","(RIP)"),s=r("[TumblrMart horse friend widget]: text indicating the age of a horse in days","%1$s day old","%1$s days old",n.currentHorse.age),o=x.horseFriendInfoBoxHeight+4*x.horseFriendPadding;e.fillStyle=q().gray25,e.strokeStyle=q().black,e.scale(j.Jd,j.Jd),e.fillRect(0,0,x.horseFriendCanvasWidth,x.horseFriendCanvasHeight),e.font="12px monospace",e.textBaseline="top",n.poos.forEach(t=>{u.current&&e.drawImage(u.current,t.x,t.y,x.horseFriendPooWidth,x.horseFriendPooHeight)}),n.hearts.forEach(t=>{e.globalAlpha=t.opacity,b.current&&e.drawImage(b.current,t.x,t.y,x.horseFriendHeartSize,x.horseFriendHeartSize)}),e.globalAlpha=1,n.hearts,e.strokeRect(x.horseFriendPadding,x.horseFriendPadding,x.horseFriendCanvasWidth-2*x.horseFriendPadding,x.horseFriendInfoBoxHeight+2*x.horseFriendPadding),e.fillStyle=q().black,e.textAlign="start",e.fillText(n.currentHorse.name,2*x.horseFriendPadding,2*x.horseFriendPadding),e.fillText(`${s} ${a}`,2*x.horseFriendPadding,28),e.textAlign="end",e.fillText(n.poosRemoved.toString(),x.horseFriendCanvasWidth-x.horseFriendPadding,o),e.strokeRect(x.horseFriendPadding,o,x.horseFriendCanvasWidth/2-x.horseFriendPadding,2*x.horseFriendPadding),e.fillRect(x.horseFriendPadding+2,o+2,n.horseComfortLevel/100*(x.horseFriendCanvasWidth/2-10),2*x.horseFriendPadding-4),n.currentHorse.isAlive||(e.textAlign="center",e.fillText(t("[TumblrMart horse friend widget]: text on a button that will take a user to their cemetary to remember their dead horses","remember your dead"),x.horseFriendCanvasWidth/2,o+(n.horseY-o+12)/2-x.horseFriendPadding)),e.drawImage(h.current,n.currentHorse.isAlive?0:4*x.horseFriendHorseWidth,n.horseFacingLeft?0:4*x.horseFriendHorseHeight+4,4*x.horseFriendHorseWidth,4*x.horseFriendHorseHeight,n.horseX,n.horseY,x.horseFriendHorseWidth,x.horseFriendHorseHeight),y()}},C=(0,p.useCallback)(()=>{if(!l&&d.current){s({eventName:f.R.HorseFriendScoreboardShare}),c(!0);let e=d.current.getContext("2d");n.shouldShowCemetery?w(e):T(e)}},[n]);return/*#__PURE__*/(0,A.jsxs)(A.Fragment,{children:[/*#__PURE__*/(0,A.jsx)(m.A,{className:S.shareButton,label:t("[TumblrMart horse friend widget] Label on a button that create a pre-filled post detailing their progress in the Horse Friend game","Share your Horse Friend progress"),onClick:C,children:/*#__PURE__*/(0,A.jsx)($.A,{})}),/*#__PURE__*/(0,A.jsxs)("div",{className:S.hide,children:[/*#__PURE__*/(0,A.jsx)("canvas",{className:S.hide,height:x.horseFriendCanvasHeight*j.Jd,ref:d,width:x.horseFriendCanvasWidth*j.Jd}),/*#__PURE__*/(0,A.jsx)("img",{alt:"",crossOrigin:"anonymous",ref:h,src:E}),/*#__PURE__*/(0,A.jsx)("img",{alt:"",crossOrigin:"anonymous",ref:u,src:H}),/*#__PURE__*/(0,A.jsx)("img",{alt:"",crossOrigin:"anonymous",ref:g,src:R}),/*#__PURE__*/(0,A.jsx)("img",{alt:"",crossOrigin:"anonymous",ref:b,src:F})]})]})},G=()=>{let{_c:e,logEvent:t}=(0,v.Us)(),[r,a]=(0,p.useReducer)(j.Wh,j.SS);(0,p.useEffect)(()=>{let e=y.A.getItem(j.cJ);e&&a({type:"loadStateFromStorage",gameState:JSON.parse(e)})},[]),(0,p.useEffect)(()=>{y.A.setItem(j.cJ,JSON.stringify(r))},[r]);let o=()=>{a({type:"setIsMinimized",isMinimized:!r.isMinimized})};return/*#__PURE__*/(0,A.jsxs)("div",{className:S.horseFriend,children:[/*#__PURE__*/(0,A.jsx)(m.A,{className:s()(S.buttonIcon,{[S.active]:r.isMinimized}),label:e("[Tumblrmart] Label on a button that will open Horse Friend game","Play Horse Friend"),onClick:()=>{t({eventName:f.R.HorseFriendWindowOpened}),o()},children:/*#__PURE__*/(0,A.jsx)("img",{alt:"",src:u,width:"22px"})}),!r.isMinimized&&/*#__PURE__*/(0,b.createPortal)(/*#__PURE__*/(0,A.jsx)("div",{className:S.horseFriendContainer,children:/*#__PURE__*/(0,A.jsx)(j.zD.Provider,{value:{state:r,dispatch:a},children:/*#__PURE__*/(0,A.jsxs)("div",{className:S.horseFriendExpanded,children:[/*#__PURE__*/(0,A.jsxs)("div",{className:S.controlButtons,children:[/*#__PURE__*/(0,A.jsx)(m.A,{className:S.minimizeButton,label:e("[Tumblrmart] Label on a button that will minimize Horse Friend game","Close Horse Friend"),onClick:o,children:/*#__PURE__*/(0,A.jsx)(g.A,{})}),/*#__PURE__*/(0,A.jsx)(Y,{})]}),/*#__PURE__*/(0,A.jsx)(I,{})]})})}),document?.body)]})};var K=r(8254),X=r(75170),Q=r(28304);let J=()=>{let{_c:e,apiFetch:t}=(0,v.Us)(),{toggleToast:r}=(0,U.Y)(),a=(0,K.jE)();return(0,X.n)({mutationFn:async e=>{if("opened"===e.status)return t("/v2/tumblrmart/orders/activate",{method:"POST",body:{uuid:e.uuid}})},onMutate:async e=>{if("opened"!==e.status)return;let t=(0,Q.Xy)(!0);await a.cancelQueries({queryKey:t});let r=a.getQueryData(t);return a.setQueryData(t,V({...e,status:"active"})),r},onError:(t,s,o)=>{o&&a.setQueryData((0,Q.Xy)(!0),o),r(e("error message when activating a tumblrmart gift fails","Oops. There was an error. Please reload the page and try again."),"error")},onSuccess:(t,s)=>{let o;if(t){switch(a.setQueryData((0,Q.Xy)(!0),V(t.response)),s.productSlug){case"tumblrmart-crabs-gift-day":o=e("[TumblrMart] Message that appears when a TumblrMart gift has been used for the first time","🦀 Your 24 hours of crabs has begun! 🦀");break;case"tumblrmart-horse-friend-month":o=e("[TumblrMart] Message that appears when a TumblrMart gift has been used for the first time","🐴 Your 30 days of horse friend has begun! 🐴");break;case"tumblrmart-horse-friend-day":o=e("[TumblrMart] Message that appears when a TumblrMart gift has been used for the first time","🐴 Your 24 hours of horse friend has begun! 🐴");break;default:o=e("[TumblrMart] Message that appears when a TumblrMart gift has been used for the first time","✨ Your TumblrMart order is activated! ✨")}r(o,"success")}},onSettled:()=>{a.invalidateQueries({queryKey:(0,Q.Xy)(!0)})}})},V=e=>t=>{if(!t)return;if(!t.isLoggedIn)return t;let r=t.user.blogs.map(t=>t.tumblrmartOrders?{...t,tumblrmartOrders:t.tumblrmartOrders.map(t=>t.uuid!==e.uuid?t:e)}:t);return{...t,user:{...t.user,blogs:r}}};var Z=r(25251);let ee=({className:e,isMobile:t,order:r,type:a})=>{let{_c:s}=(0,v.Us)(),{mutate:o}=J(),[n,i]=(0,p.useState)(!1);(0,p.useEffect)(()=>{let e=window.setTimeout(()=>{i(t)},5e3);return()=>window.clearTimeout(e)},[t]);let u=()=>{"active"!==r.status&&o(r)},m="crabs"===a?s("[TumblrMart] Tooltip text for when a user first sees the dashboard crab widget","Summon your crabs 🦀 Clack!"):s("[TumblrMart] Tooltip text for when a user first sees the horse friend widget","Play Horse Friend 🐴");return/*#__PURE__*/(0,A.jsxs)("div",{className:e,onClickCapture:u,onKeyDown:e=>{(e.key===l.qW.Enter||e.nativeEvent.isComposing)&&u()},role:"link",tabIndex:-1,children:[r?.gameAssets&&/*#__PURE__*/(0,A.jsx)(A.Fragment,{children:Object.entries(r.gameAssets).map(([e,t])=>/*#__PURE__*/(0,A.jsx)(Z.N_,{as:"image",href:t,imageSrcSet:`${t}, ${(0,d.wV)(t)} 2x`,rel:"preload"},e))}),/*#__PURE__*/(0,A.jsx)(c.A,{content:m,isOpen:"opened"===r.status&&!n,children:/*#__PURE__*/(0,A.jsxs)(A.Fragment,{children:["crabs"===a&&/*#__PURE__*/(0,A.jsx)(h.Ay,{...r}),"horseFriend"===a&&/*#__PURE__*/(0,A.jsx)(G,{})]})})]})},et={container:"aVu3s",vertical:"cQ0bC",widget:"_o6uV",isMobile:"Pfc8N"},er={horseFriend:["tumblrmart-horse-friend-gift-day","tumblrmart-horse-friend-month"],crabs:["tumblrmart-crabs-gift-day"]},ea=({className:e,vertical:t})=>{let{isMobile:r}=(0,n.Ri)(),a=(0,i.f)();if(!a?.length)return null;let l=a.find(e=>"completed"===e.status);if(l)return/*#__PURE__*/(0,A.jsx)(o.xh,{type:l.productSlug,uuid:l.uuid});let c=a.filter(({status:e})=>"active"===e||"opened"===e);return c.length?/*#__PURE__*/(0,A.jsx)("div",{className:s()(et.container,e,{[et.isMobile]:r,[et.vertical]:t}),children:Object.entries(er).map(([e,t])=>{let a=c.filter(({productSlug:e})=>t.includes(e));if(!a.length)return null;let s=a.find(({status:e})=>"active"===e)??a[0];return/*#__PURE__*/(0,A.jsx)(ee,{className:et.widget,isMobile:r,order:s,type:e},e)})}):null}},29130:(e,t,r)=>{"use strict";r.d(t,{d:()=>S,xh:()=>_,mQ:()=>eu});var a=r(8254),s=r(28230),o=r(13275),n=r(17886),i=r(96894),l=r(49315),c=r(90789),d=r(87800),h=r(4613),u=r(373);let m=u.z.object({productGroup:u.z.string(),imageUrls:u.z.object({avatar:d.HN.optional(),banner:d.HN}),title:u.z.string(),description:u.z.string(),button:u.z.object({label:u.z.string(),url:u.z.string()})}),g=(0,c.h)(m),p=(e,t)=>["unseen-badges",e,t],b=(e,t)=>{let{apiFetchWithSchema:r}=(0,h.Us)();return(0,l.I)({queryKey:p(e,t),queryFn:async()=>(await r("/v2/tumblrmart/earned_badges/modal",g,{method:"GET",queryParams:{tumblelog:e,product_group:t}})).response})};var f=r(61221),v=r(36665),y=r(53986),x=r(94048),w=r(56281);let T={wrapper:"tmwZ9",banner:"_7LoRz",bannerImage:"PSbZi",modalWrapper:"BMAgx",header:"GyLma",body:"x2z7r",actions:"E_rFJ",button:"SRvcI",loader:"DFvMP"};var j=r(60397);let S=({blogId:e,onClose:t,productGroup:r})=>{let{_c:l,isLoggedIn:c,logEvent:d}=(0,h.Us)(),u=(0,y.Zp)(),{toggleToast:m}=(0,w.Y)(),g=(0,a.jE)(),{data:p,isError:S,isPending:A}=b(e,r);if((0,v.useEffect)(()=>{d({eventName:x.R.BadgeEarnedClick,eventDetails:{product:r}})},[d,r]),(0,v.useEffect)(()=>{S&&m(l("[Badge Management] Error message for unseen badges","Something went wrong. Please try again."),"error")},[l,S,m]),S)return null;let C=()=>g.invalidateQueries({queryKey:(0,f.wM)(c)});return/*#__PURE__*/(0,j.jsx)(o.A,{headerIcon:A?void 0:/*#__PURE__*/(0,j.jsx)("span",{className:T.banner,children:(0,i.L6)(p?.imageUrls?.banner,l("[Badge Management] Banner image for unseen badge modal banner.","Badge banner image."),T.bannerImage)}),modalWrapperClass:"badge",modalWrapperClassname:T.wrapper,onClose:()=>{C(),t?.()},children:A?/*#__PURE__*/(0,j.jsx)("span",{className:T.loader,children:/*#__PURE__*/(0,j.jsx)(s.A,{centerOrientation:"horizontalAndVertical"})}):/*#__PURE__*/(0,j.jsxs)("div",{className:T.modalWrapper,children:[/*#__PURE__*/(0,j.jsx)("div",{className:T.header,children:/*#__PURE__*/(0,j.jsx)("h1",{className:T.title,children:p?.title})}),/*#__PURE__*/(0,j.jsx)("div",{className:T.body,children:/*#__PURE__*/(0,j.jsx)("p",{className:T.description,children:p?.description})}),/*#__PURE__*/(0,j.jsx)("div",{className:T.actions,children:/*#__PURE__*/(0,j.jsx)(n.A,{className:T.button,isRounded:!0,label:l("[Badge Management] Button label to trigger seeing an unseen badge.","Manage Badge"),onClick:()=>{!A&&p&&(d({eventName:x.R.BadgeEarnedManageClick,eventDetails:{product:r}},{sendPayloadImmediately:!0}),C(),(0,i.My)(p.button.url,u))},size:"small",theme:"border",children:p?.button?.label})})]})})};var A=r(75170),C=r(28304);let k=()=>{let{_c:e,apiFetch:t}=(0,h.Us)(),{toggleToast:r}=(0,w.Y)(),s=(0,a.jE)();return(0,A.n)({mutationFn:async({uuid:e,status:r})=>t(`/v2/tumblrmart/orders/${e}`,{method:"PATCH",body:{status:r}}),onMutate:async e=>{let t=(0,C.Xy)(!0);await s.cancelQueries({queryKey:t});let r=s.getQueryData(t);return s.setQueryData(t,F(e)),r},onError:(t,a,o)=>{o&&s.setQueryData((0,C.Xy)(!0),o),r(e("error message when activating a tumblrmart gift fails","Oops. There was an error. Please reload the page and try again."),"error")},onSuccess:t=>{t&&(s.setQueryData((0,C.Xy)(!0),F(t.response)),"active"===t.response.status&&r("tumblrmart-crabs-gift-day"===t.response.productSlug?e("[TumblrMart] Message that appears when a TumblrMart gift has been used for the first time","🦀 Your 24 hours of crabs has begun! 🦀"):e("[TumblrMart] Message that appears when a TumblrMart gift has been used for the first time","🐴 Your 24 hours of horse friend has begun! 🐴"),"success"))},onSettled:()=>{s.invalidateQueries({queryKey:(0,C.Xy)(!0)})}})},F=e=>t=>{if(!t)return;if(!t.isLoggedIn)return t;let r=t.user.blogs.map(t=>t.tumblrmartOrders?{...t,tumblrmartOrders:t.tumblrmartOrders.map(t=>t.uuid!==e.uuid?t:{...t,...e})}:t);return{...t,user:{...t.user,blogs:r}}};var N=r(85191),M=r(70075),P=r(12044),H=r(66910),B=r(6865),I=r(68484),R=r(56040);let E={text:"f5gD9"},$=()=>I.A.removeItem(M.R6),D=({onClickShare:e})=>{let t=(0,y.Zp)(),{_c:r,_cn:a,logEvent:s}=(0,h.Us)(),[o,i]=(0,v.useState)(null);(0,v.useEffect)(()=>{let e=I.A.getItem(M.R6);e&&i(JSON.parse(e))},[]),(0,v.useEffect)(()=>(window.addEventListener("beforeunload",$),()=>{$(),window.removeEventListener("beforeunload",$)}),[]);let l=o?a("[TumblrMart] Message that appears when a crab gift expires and crab counts are stored in local storage.","Your 24 hours of crabs is over. You summoned %1$s 🦀, captured %2$s 💰, befriended %3$s 🌼, and %4$s fell in love with you 💜 on the Tumblr web app. Share your time with crabs and we'll get this place cleaned up.","Your 24 hours of crabs is over. You summoned %1$s 🦀, captured %2$s 💰, befriended %3$s 🌼, and %4$s fell in love with you 💜 on the Tumblr web app. Share your time with crabs and we'll get this place cleaned up.",parseInt(o.summoned,10),[o.captured,o.befriended,o.beloved]):/*#__PURE__*/(0,j.jsx)(N.Ay,{comment:"[TumblrMart] Message that appears when a crab gift expires and crab counts are not stored in local storage.",children:"Your 24 hours of crabs is over. Write a Tumblr post to say farewell to the glorious crustaceans, and we'll get to work cleaning this place up."});return/*#__PURE__*/(0,j.jsxs)(j.Fragment,{children:[/*#__PURE__*/(0,j.jsx)("p",{className:E.text,children:l}),/*#__PURE__*/(0,j.jsx)(n.A,{onClick:()=>{s({eventName:x.R.CrabShareFarewell});let a=(0,B.y4)(r),n=o?{content:[{type:H._B.Text,subtype:H.pb.Heading1,text:r("[TumblrMart] Pre-filled title of a Tumblr post when a user's crab gift has expired","Farewell Sweet Crabs 👋 🦀")},{type:H._B.Text,text:r("[TumblrMart] Pre-filled text of a Tumblr post when a user's crab gift has expired and crab counts can be read from local storage.","I summoned %1$s 🦀, captured %2$s 💰, befriended %3$s 🌼, and %4$s fell in love with me 💜. I will miss you my sweet crabs.",[o.summoned,o.captured,o.befriended,o.beloved])}],isPrefilledPost:!0,tags:["time for crab"]}:{content:[{type:H._B.Text,subtype:H.pb.Heading1,text:r("[TumblrMart] Pre-filled title of a Tumblr post when a user's crab gift has expired","Farewell Sweet Crabs 👋 🦀")},{type:H._B.Text,text:r("[TumblrMart] Pre-filled text of a Tumblr post when a user's crab gift has expired and crab counts cannot be read from local storage.","When I remember my crab friends I'll think of:")},{type:H._B.Text,text:a,formatting:[{type:H.ww.Italic,start:0,end:a.length-1}]}],isPrefilledPost:!0,disableBlogSelection:!1,tags:["time for crab"]};e(),t((0,P.P1)({postType:H.xj.Text},{redirect_to:"/dashboard"}),{state:{newPost:n}})},size:"entireWidth",textColor:R.paletteWhite,children:/*#__PURE__*/(0,j.jsx)(N.Ay,{comment:"[TumblrMart] Text on a button that will create a Tumblr post sharing expired message.",children:"Share"})})]})};var W=r(21070);let z=()=>I.A.removeItem(W.cJ),L=({onClickShare:e})=>{let t=(0,y.Zp)(),{_c:r,logEvent:a}=(0,h.Us)(),[s,o]=(0,v.useState)(null);return(0,v.useEffect)(()=>{let e=I.A.getItem(W.cJ);e&&o((0,W.aq)(JSON.parse(e)))},[]),(0,v.useEffect)(()=>(window.addEventListener("beforeunload",z),()=>{z(),window.removeEventListener("beforeunload",z)}),[]),/*#__PURE__*/(0,j.jsxs)(j.Fragment,{children:[/*#__PURE__*/(0,j.jsx)("p",{className:E.text,children:/*#__PURE__*/(0,j.jsx)(N.Ay,{comment:"[TumblrMart] Text in a pop-up window shown when Horse Friend game expires.",children:"We at TumblrMart hope you enjoyed playing Horse Friend. Before you go, write a farewell post and we'll clean up any remaining poo."})}),/*#__PURE__*/(0,j.jsx)(n.A,{onClick:()=>{a({eventName:x.R.HorseFriendShareFarewell});let o=(0,B.WT)(r),n={content:[{type:H._B.Text,subtype:H.pb.Heading1,text:r("[TumblrMart] Pre-filled title of a Tumblr post when Horse Friend game has expired","Farewell Horse Friend 👋 🐴")},{type:H._B.Text,text:r("[TumblrMart] Text preceeding a memory of playing Horse Friend game","When I remember my beloved horse, I will think of:")},{type:H._B.Text,text:o,formatting:[{type:H.ww.Italic,start:0,end:o.length-1}]}],isPrefilledPost:!0,disableBlogSelection:!1,tags:["horse friend"]};s&&(n.content=n.content.concat([{type:H._B.Text,text:r("[TumblrMart horse friend widget]: Text proceeds a number of how many horses were hatched while playing Horse Friend","Total horses hatched: %1$s",[(0,W.YJ)(s).toString()])},{type:H._B.Text,text:r("[TumblrMart horse friend widget]: Text proceeds a number of how much poop was collected while playing Horse Friend","Total manure harvested: %1$s",[(0,W.FA)(s).toString()])}])),e(),t((0,P.P1)({postType:H.xj.Text},{redirect_to:"/dashboard"}),{state:{newPost:n}})},size:"entireWidth",textColor:R.paletteWhite,children:/*#__PURE__*/(0,j.jsx)(N.Ay,{comment:"[TumblrMart] Text on a button that will open the new post form with a pre-filled post that shares stats from playing Horse Friend",children:"Share"})})]})},_=({type:e,uuid:t})=>{let{_c:r}=(0,h.Us)(),{mutate:a}=k(),s=async()=>{a({uuid:t,status:"expired"})};return/*#__PURE__*/(0,j.jsx)(o.A,{compact:!0,onClose:s,title:(()=>{switch(e){case"tumblrmart-horse-friend-gift-day":return r("[TumblrMart] Title shown when the ability to play Horse Friend has expired","Time to say farewell to Horse Friend");case"tumblrmart-crabs-gift-day":return r("[TumblrMart] Title shown when the ability to use the crab widget has expired","Oh no! Crab time is up");default:return r("[TumblrMart] Title shown when a tumblrmart item is expired","Oh no! Your TumblrMart item has expired.")}})(),children:(()=>{switch(e){case"tumblrmart-crabs-gift-day":return/*#__PURE__*/(0,j.jsx)(D,{onClickShare:()=>s()});case"tumblrmart-horse-friend-gift-day":return/*#__PURE__*/(0,j.jsx)(L,{onClickShare:()=>s()});default:return/*#__PURE__*/(0,j.jsx)("p",{children:r("[TumblrMart] Default text shown when a tumblrmart item has expired.","Please visit Tumblrmart again real soon")})}})()})};var U=r(74059),O=/*#__PURE__*/r.n(U),q=r(27699),Y=r(57830),G=r(44842),K=r(55321),X=r(84160),Q=r(43776),J=r(84236),V=r(39460),Z=r(25183),ee=r(57620),et=r(25833),er=r(47741),ea=/*#__PURE__*/r.n(er),es=r(71273),eo=r(86619),en=r(76438),ei=r(38189),el=r(89972);let ec={modalWrapper:"xv_s5",modalBody:"HbNGL",splashImage:"AmghW",splashImageAdFree:"DsEBp",avatarWrapperOuter:"lbarB",avatarWrapperInner:"TSfr_",avatar:"FhsWI",header:"AE6WV",senderUser:"TT2qt",giftTitle:"bpnO8",emoji:"jjAEd",giftSubtitle:"_64hR",giftInfo:"rb92Y",info:"KVt3w",category:"K1c5K",actionDetails:"vzPt5",actionButtons:"WtbOv",actionButton:"ZQhIf",settingsWrapper:"fJ9Xt",settingsButton:"HQQhj",settingsInnerLabel:"PqBqd",settingsLabelText:"EQeW6"};function ed(){let{refetch:e,settings:t}=(0,et.t0)(),[r,a]=(0,v.useState)(null),[o,i]=(0,v.useState)(!1);(0,v.useEffect)(()=>{t&&!r&&a(t?.showAdsAnyway?"showAdsAnyway":t?.showBlazeAds?"showBlazeAds":"showNone")},[t]);let l=()=>i(e=>!e);return/*#__PURE__*/(0,j.jsx)(j.Fragment,{children:/*#__PURE__*/(0,j.jsx)(eo.Ay,{component:/*#__PURE__*/(0,j.jsx)("div",{className:ec.settingsWrapper,children:/*#__PURE__*/(0,j.jsx)(en.A,{disableRefresh:!0,name:"visibilityOptionModal",onUpdate:()=>{i(!1),a(null),e()}})}),height:"auto",isOpen:o,position:el.$x.BottomEnd,toggle:l,usePortals:!0,width:320,children:/*#__PURE__*/(0,j.jsx)(n.A,{backgroundColor:R.paletteBlack,borderColor:R.paletteWhite,isRounded:!0,onClick:l,size:"small",textColor:R.paletteWhite,wrapperClassName:ec.settingsButton,children:/*#__PURE__*/(0,j.jsx)("div",{className:ec.settingsInnerLabel,children:r?/*#__PURE__*/(0,j.jsxs)(j.Fragment,{children:[/*#__PURE__*/(0,j.jsx)("span",{className:ec.settingsLabelText,children:ei.A[ei.A.findIndex(e=>e.value===r)].children}),o?/*#__PURE__*/(0,j.jsx)(es.oj,{}):/*#__PURE__*/(0,j.jsx)(es.OH,{})]}):/*#__PURE__*/(0,j.jsx)(s.A,{centerOrientation:"horizontal",small:!0})})})})})}let eh=({gift:e,onClose:t})=>{let{_c:r,_t:a,_getLocaleDateString:s}=(0,h.Us)(),{openConversationWindow:l}=(0,ee.Z)(),c=(0,y.Zp)(),{toggleToast:d}=(0,w.Y)(),{logEvent:u}=(0,Z.Ul)(),[m,g]=(0,K.ok)();(0,v.useEffect)(()=>{m.get("success")&&(d(r("[TumblrMart] Success message after publishing a share post from a received gift","The love has been shared!"),"success"),m.delete("success"),g(m),window.location.reload())},[r,m,g,d]);let{actions:p,activatedTimestamp:b,askId:f,askTumblelog:T,askTumblelogName:S,availableUntilDate:A,displayStatus:C,imageUrls:{banner:k},isAnonymous:F,message:M,postActionDetails:B,preActionDetails:I,productGroup:E,receivedTimestamp:$,senderAvatar:D,senderUsername:W,subtitle:z,title:L,uuid:_}=e,U=F?void 0:{name:W,avatar:D,url:`https://${W}.tumblr.com`},et=({key:e,url:t},r)=>{switch(e){case"share":u({eventName:x.R.TumblrMartReceiveGiftShare,eventDetails:{group:r}}),en();break;case"message":u({eventName:x.R.TumblrMartReceiveGiftReply,eventDetails:{group:r}}),S&&W?(l({selectedBlogName:S,otherParticipantName:W}),er()):en();break;case"close":er();break;case"redirect":eo(t);break;case"view_perks":es()}},er=()=>t?.(),es=()=>{u({eventName:x.R.TumblrMartReceiveGiftViewPerks}),c(`${P.ry.premium}`)},eo=e=>{e&&((0,i.My)(e,c),er())},en=()=>{f&&T&&S?c((0,P.x1)({blogName:S,postId:f},{redirect_to:"/dashboard"}),{state:{giftAsk:{askTumblelog:T,redirectUrl:`${(0,P.yK)({page:V.e.Gifts})}?success=true`,uuid:_}}}):c((0,P.P1)({postType:H.xj.Text},{redirect_to:"/dashboard"}),{state:{newPost:{content:[{type:H._B.Text,text:r("[TumblrMart] Pre-filled text of a Tumblr post when a user shares they received a gift and asks are disabled for their account.","%1$s gifted me %2$s.",[W??a("anonymous"),L])}],isPrefilledPost:!0,disableBlogSelection:!1}}})},ei=/*#__PURE__*/(0,j.jsx)("img",{alt:r("[TumblrMart] Banner image for TumblrMart gift","TumblrMart gift banner"),className:O()(ec.splashImage),src:k,srcSet:`${k}, ${(0,i.wV)(k)} 2x`}),el=F?a("anonymous"):W;return/*#__PURE__*/(0,j.jsx)(o.A,{compact:!0,headerIcon:ei,modalWrapperClass:"tumblrMartReceiveModalWrapper",onClose:er,theme:o.v.Gradient,children:/*#__PURE__*/(0,j.jsxs)("div",{className:ec.modalWrapper,children:[/*#__PURE__*/(0,j.jsxs)("div",{className:ec.modalHeader,children:[/*#__PURE__*/(0,j.jsx)("div",{className:ec.avatarWrapperOuter,children:/*#__PURE__*/(0,j.jsx)("div",{className:ec.avatarWrapperInner,children:/*#__PURE__*/(0,j.jsx)("div",{className:ec.avatar,children:/*#__PURE__*/(0,j.jsx)(q.A,{avatarShape:Q.b.Circle,dimension:72,imageResponse:D||void 0,isAnonymous:F})})})}),/*#__PURE__*/(0,j.jsxs)("div",{className:ec.header,children:[/*#__PURE__*/(0,j.jsx)("p",{className:ec.sender,children:/*#__PURE__*/(0,j.jsx)(N.Ay,{components:{strong:/*#__PURE__*/(0,j.jsx)("strong",{}),span:/*#__PURE__*/(0,j.jsx)("span",{}),br:/*#__PURE__*/(0,j.jsx)("br",{})},params:{sender:el},children:"[strong][sender][/strong][br /][span]gifted you:[/span]"})}),/*#__PURE__*/(0,j.jsx)("h1",{className:ec.giftTitle,children:L})]}),M&&U&&/*#__PURE__*/(0,j.jsx)("div",{className:ec.giftMessage,children:/*#__PURE__*/(0,j.jsx)(G.A,{blog:U,components:[/*#__PURE__*/(0,j.jsx)(Y.Ay,{block:{text:M,type:H._B.Text}},0)],isAsking:!0,post:{isTumblrmartGiftAsk:!0}})})]}),/*#__PURE__*/(0,j.jsxs)("div",{className:ec.modalBody,children:[!(M&&U)&&z&&/*#__PURE__*/(0,j.jsx)("div",{className:ec.giftSubtitle,children:/*#__PURE__*/(0,j.jsx)("p",{dangerouslySetInnerHTML:{__html:z}})}),/*#__PURE__*/(0,j.jsxs)("div",{className:ec.giftInfo,children:[/*#__PURE__*/(0,j.jsxs)("div",{className:ec.info,children:[/*#__PURE__*/(0,j.jsx)("p",{className:ec.category,children:r("[TumblrMart] category title for when a gift was received","Received")}),/*#__PURE__*/(0,j.jsx)("p",{children:s(new Date(1e3*$),J.N.Notes,!0)})]}),/*#__PURE__*/(0,j.jsxs)("div",{className:ec.info,children:[/*#__PURE__*/(0,j.jsx)("p",{className:ec.category,children:r("[TumblrMart] category title for the status of a gift","Status")}),/*#__PURE__*/(0,j.jsx)(X.A,{status:C})]}),!!b&&/*#__PURE__*/(0,j.jsxs)("div",{className:ec.info,children:[/*#__PURE__*/(0,j.jsx)("p",{className:ec.category,children:r("[TumblrMart] category title for when when a gift was activated","Activated")}),/*#__PURE__*/(0,j.jsx)("p",{children:s(new Date(1e3*b),J.N.Notes,!0)})]}),!!A&&"expired"===C&&/*#__PURE__*/(0,j.jsxs)("div",{className:ec.info,children:[/*#__PURE__*/(0,j.jsx)("p",{className:ec.category,children:r("[TumblrMart] category title for when a gift expired","Expired")}),/*#__PURE__*/(0,j.jsx)("p",{children:s(new Date(1e3*A),J.N.Notes,!0)})]})]}),!!I&&/*#__PURE__*/(0,j.jsx)("div",{className:ec.actionDetails,children:/*#__PURE__*/(0,j.jsx)("p",{dangerouslySetInnerHTML:{__html:I}})}),p?.length&&/*#__PURE__*/(0,j.jsx)("div",{className:ec.actionButtons,children:p.map(e=>"ad_free_settings"===e.key?/*#__PURE__*/(0,j.jsx)(ed,{},e.key):"view_perks"===e.key?/*#__PURE__*/(0,j.jsx)(n.A,{backgroundColor:ea().colorChromeUi,isRounded:!0,label:e.label,onClick:()=>et(e,E),size:"small",textColor:ea().colorChromeUiFg,children:e.label},e.key):/*#__PURE__*/(0,j.jsx)(n.A,{backgroundColor:R.paletteWhite,borderColor:R.paletteBlack,className:ec.actionButton,isRounded:!0,label:e.label,onClick:()=>et(e,E),size:"small",textColor:R.paletteBlack,theme:"border",children:e.label},e.key))}),!!B&&/*#__PURE__*/(0,j.jsx)("div",{className:ec.actionDetails,children:/*#__PURE__*/(0,j.jsx)("p",{dangerouslySetInnerHTML:{__html:B}})})]})]})})},eu=e=>/*#__PURE__*/(0,j.jsx)(et.Z6,{children:/*#__PURE__*/(0,j.jsx)(eh,{...e})})},84509:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(86619),s=r(36665),o=r(89972);let n={tooltip:"H9EdA",tooltipArrow:"qZEjf"};var i=r(60397);let l=({children:e,content:t,isOpen:r})=>{let[l,c]=(0,s.useState)(!1);return(0,s.useEffect)(()=>c(r),[r,c]),/*#__PURE__*/(0,i.jsx)(a.Ay,{arrowWrapperClassName:n.tooltipArrow,component:/*#__PURE__*/(0,i.jsx)("div",{className:n.tooltip,onClick:()=>c(!1),onKeyDown:()=>c(!1),role:"button",tabIndex:0,children:t}),hasArrow:!0,isChromeless:!0,isOpen:l,position:o.$x.Bottom,strategy:"fixed",toggle:()=>c(!1),usePortals:!0,children:e})}},70075:(e,t,r)=>{"use strict";r.d(t,{R6:()=>$,Ay:()=>_});var a=r(74059),s=/*#__PURE__*/r.n(a),o=r(96894),n=r(36665),i=r(33672),l=r(94048),c=r(4613),d=r(78774),h=r(68484),u=r(84007),m=r(46302);let g=()=>{let[e,t]=(0,n.useState)({clientX:0,clientY:0}),r=(0,m.A)(e=>{let{clientX:r,clientY:a}=e;t({clientX:r,clientY:a})},100);return(0,n.useEffect)(()=>(document.addEventListener("mousemove",r,!1),document.addEventListener("mouseenter",r,!1),()=>{document.removeEventListener("mousemove",r),document.removeEventListener("mouseenter",r),r.cancel()}),[]),e};var p=r(90657),b=r(39977);let f={scoreboard:"PMWro",scoreCategory:"M6jBU",expand:"ZtoPL",hidden:"t7fs2"};var v=r(60397);let y=function({numSummoned:e,numFriends:t,numBeloved:r,numCaptured:a}){let{_c:o}=(0,c.Us)(),[i,l]=(0,n.useState)(!0),d=()=>l(!0),h=()=>l(!1);return e?/*#__PURE__*/(0,v.jsxs)(v.Fragment,{children:[/*#__PURE__*/(0,v.jsxs)("div",{"aria-label":o("[TumblrMart] Crab widget scoreboard","Scoreboard"),className:s()(f.scoreboard,{[f.hidden]:!i}),onClick:h,onKeyDown:e=>{e.key===p.qW.Enter&&h()},role:"button",tabIndex:0,children:[/*#__PURE__*/(0,v.jsxs)("div",{className:f.scoreCategory,children:[/*#__PURE__*/(0,v.jsx)("p",{children:o("[TumblrMart crab widget]: Label for displaying total number of summoned crabs","summoned:")}),/*#__PURE__*/(0,v.jsx)("span",{className:f.score,children:e})]}),null!==a&&/*#__PURE__*/(0,v.jsxs)("div",{className:f.scoreCategory,children:[/*#__PURE__*/(0,v.jsx)("p",{children:o("[TumblrMart crab widget]: Label for displaying total number of captured crabs","captured:")}),/*#__PURE__*/(0,v.jsx)("span",{className:f.score,children:a})]}),null!==t&&/*#__PURE__*/(0,v.jsxs)("div",{className:f.scoreCategory,children:[/*#__PURE__*/(0,v.jsx)("p",{children:o("[TumblrMart crab widget]: Label for displaying total number of friend crabs","befriended:")}),/*#__PURE__*/(0,v.jsx)("span",{className:f.score,children:t})]}),null!==r&&/*#__PURE__*/(0,v.jsxs)("div",{className:f.scoreCategory,children:[/*#__PURE__*/(0,v.jsx)("p",{children:o("[TumblrMart crab widget]: Label for displaying total number of crabs that have fallen in love with the user","beloved:")}),/*#__PURE__*/(0,v.jsx)("span",{className:f.score,children:r})]})]}),/*#__PURE__*/(0,v.jsx)("div",{"aria-label":o("[TumblrMart] Crab widget scoreboard expand icon","Expand"),className:s()(f.expand,{[f.hidden]:i}),onClick:d,onKeyDown:e=>{e.key===p.qW.Enter&&d()},role:"button",tabIndex:0,children:/*#__PURE__*/(0,v.jsx)(b.Q5,{size:{width:15,height:15}})})]}):null};var x=r(11100),w=r(98778),T=r(9814),j=r(12044),S=r(53986),A=r(66910),C=r(91514);let k={shareButton:"ZFczK"},F=["https://assets.tumblr.com/images/tumblrmart/crabs/90s_crabs_ad_v2.mp4","https://assets.tumblr.com/images/tumblrmart/crabs/crab_army_v2.mp4","https://assets.tumblr.com/images/tumblrmart/crabs/crab_tsd_v3.mp4","https://assets.tumblr.com/images/tumblrmart/crabs/space_crab_v2.mp4"];function N(e){return[{type:A._B.Text,text:(0,u.X)(e)}]}function M(e,t){return Array(t>=0?t:0).fill(e).join(" ")}function P({_c:e,showTitle:t=!0,numSummoned:r=0,numFriends:a=0,numBeloved:s=0,numCaptured:o=0,befriendedEmoji:n="🌼",belovedEmoji:i="💙",capturedEmoji:l="💰"}){let c=M(`🦀${i}`,s),d=M(`🦀${n}`,a),h=M("🦀",r-o-s-a),u=M(l,o),m=[];t&&m.push({type:A._B.Text,subtype:A.pb.Quirky,text:e("[TumblrMart crab widget]: Share post group picture title. Must be a litle silly and excitable.","group picture!!!")});let g=[];return c&&g.push(c),d&&g.push(d),h&&g.push(h),u&&g.push(u),g.length&&m.push({type:A._B.Text,subtype:A.pb.Quirky,text:g.join(" ")}),m}function H({className:e,...t}){return/*#__PURE__*/(0,v.jsx)(x.A,{...t,wrapperClassName:s()(k.shareButton,e),children:/*#__PURE__*/(0,v.jsx)(w.A,{})})}let B=function({numSummoned:e,numFriends:t,numBeloved:r,numCaptured:a}){let{_c:s,_cn:o,features:{halloweenCrabsSharing:n},logEvent:i}=(0,c.Us)(),d=(0,S.Zp)(),h=s("[TumblrMart crab widget]: Button that shares your crab scores as a new post","Share your crab counts!"),m=n?s("[TumblrMart crab widget]: Share post title during Halloween","🎃🦀 time for halloween crab 🦀🎃"):s("[TumblrMart crab widget]: Share post title","🦀 time for crab 🦀"),g=n?{befriendedEmoji:"🎃",belovedEmoji:"🖤",capturedEmoji:"👻"}:null,p=["time for crab","crab time","crustacean nation","crab","clack",...n?["halloween"]:[]];return/*#__PURE__*/(0,v.jsx)(H,{className:k.shareButton,onClick:()=>{let c={content:[{type:A._B.Text,subtype:A.pb.Heading1,text:m},...n?[]:N([s("[TumblrMart crab widget]: Share post copy. Intro content text.","Due to unforeseen circumstances, this post will be brought to you solely by crabs."),s("[TumblrMart crab widget]: Share post copy. Intro content text.","What’s that coming over the dash? Is it a monster? No. It’s just a crab 🦀"),s("[TumblrMart crab widget]: Share post copy. Intro content text.","*clack clack clack* It’s crab time *clack clack clack*")]),...function({_c:e,_cn:t,numSummoned:r,numFriends:a,numBeloved:s,numCaptured:o,befriendedEmoji:n="🌼",belovedEmoji:i="💙",capturedEmoji:l="💰"}){let c=r&&!o&&!a&&!s,d=r&&o&&!a&&!s,h=r&&o&&o>=r,u=r&&a&&!o&&!s&&a>=r,m=r&&s&&!o&&!a&&s>=r;if(!r)return[{type:A._B.Text,text:e("[TumblrMart crab widget]: Share post copy when no crabs summoned.","it is time for crab on tumblr, but not time for crab in my life. yet.")}];if(c)return[{type:A._B.Text,text:t("[TumblrMart crab widget]: Share post copy when only summoned crabs.","today i summoned a crab! it is a good day","today i summoned %1$s crabs! look at them!",r)},...P({_c:e,showTitle:!1,numSummoned:r,befriendedEmoji:n,belovedEmoji:i,capturedEmoji:l})];if(d)return h?[{type:A._B.Text,text:t("[TumblrMart crab widget]: Share post copy when user caught all summoned crabs. 1 is the number of summoned crabs. 2 is the emoji associated with being captured.","today i summoned one crab and then caught it %2$s","today i summoned %1$s crabs and then caught all of them %2$s what a harvest",r,[l])},...r>1?P({_c:e,showTitle:!1,numCaptured:o,befriendedEmoji:n,belovedEmoji:i,capturedEmoji:l}):[]]:[{type:A._B.Text,text:e("[TumblrMart crab widget]: Share post copy when user caught some of summoned crabs. 1 is the number of summoned crabs. 2 is the number of captured crabs. 3 is the emoji associated with being captured.","today i summoned %1$s crabs and caught %2$s %3$s of them. look at them all!",[String(r),String(o),l])},...P({_c:e,showTitle:!1,numSummoned:r,numCaptured:o,befriendedEmoji:n,belovedEmoji:i,capturedEmoji:l})];{if(u)return[{type:A._B.Text,text:t("[TumblrMart crab widget]: Share post copy when user is friends with all summoned crabs. 1 is the number of crabs summoned. 2 is the emoji associated with friends.","today i summoned %1$s crab and became best friends with it. it's just me and my crab friend against the world! 🦀%2$s","today i summoned %1$s crabs and became friends with all of them 🦀%2$s look at my new friends!!",r,[n])},...r>1?P({_c:e,showTitle:!1,numFriends:a,befriendedEmoji:n,belovedEmoji:i,capturedEmoji:l}):[]];if(m)return[{type:A._B.Text,text:t("[TumblrMart crab widget]: Share post copy when user summoned crabs and all of them fell in love with user. 1 is the number of summoned crabs. 2 is the emoji associated with love.","today i summoned one crab and then we fell in love 🦀%2$s crab my beloved","today i summoned %1$s crabs and they all fell in love with me 🦀%2$s i love them too.",r,[i])},...r>1?P({_c:e,showTitle:!1,numBeloved:s,befriendedEmoji:n,belovedEmoji:i,capturedEmoji:l}):[]];let c=[t("[Tumblrmart crab widget]: Share post copy. 1 is the number of summoned crabs.","today i summoned one crab!","today i summoned %1$s crabs!",r)];return o&&c.push(t("[TumblrMart crab widget]: Share post copy. 1 is the number of captured crabs. 2 is the emoji associated with being captured.","i caught one %2$s of them.","i caught %1$s %2$s of them.",o,[l])),a&&c.push(t("[TumblrMart crab widget]: Share post copy. 1 is the number of befriended crabs. 2 is the emoji associated with friends.","i became friends with one %2$s of them.","i became friends with %1$s %2$s of them.",a,[n])),s&&c.push(t("[TumblrMart crab widget]: Share post copy. 1 is the number of beloved crabs. 2 is the emoji associated with love.","one fell in love with me %2$s","%1$s fell in love with me %2$s",s,[i])),[{type:A._B.Text,text:c.join(" ")},...P({_c:e,numSummoned:r,numFriends:a,numBeloved:s,numCaptured:o,befriendedEmoji:n,belovedEmoji:i,capturedEmoji:l})]}}({_c:s,_cn:o,numSummoned:e,numFriends:t,numBeloved:r,numCaptured:a,...n&&g}),...n?[]:N([s("[TumblrMart crab widget]: Share post copy. Closing content text.","just me and my crab army *clack clack clack* 🦀"),s("[TumblrMart crab widget]: Share post copy. Closing content text.","i summoned some new orange friends 🦀")]),...n?[]:function(){let e=(0,u.X)(F);return[{media:{height:1e3,type:C.Yb.Mp4,url:e,width:1e3},provider:C.Nw.Tumblr,type:A._B.Video,url:e}]}(),...(0,T.b)([s("[TumblrMart crab widget]: Share post copy. TumblrMart link text.","Sharing is caring—and gifting your friends the crab army at TumblrMart…"),s("[TumblrMart crab widget]: Share post copy. TumblrMart link text.","Gift your friends the crab army!"),s("[TumblrMart crab widget]: Share post copy. TumblrMart link text.","Say it with the gift of the crab army—only at TumblrMart."),s("[TumblrMart crab widget]: Share post copy. TumblrMart link text.","Join us at crustacean nation, and buy your friends a gift…")])],isPrefilledPost:!0,disableBlogSelection:!1,tags:p};i({eventName:l.R.CrabsScoreboardShare}),d((0,j.P1)({postType:A.xj.Text}),{state:{newPost:c}})},title:h})},I={controlPanel:"n4ng3",buttonsWrapper:"o7Esz",summonButton:"rxrOL",wall:"y5_hQ",crabWrapper:"JljDF",isSpeaking:"vqBle",isCaptured:"ovjCT",isFriend:"GmAPq",isBeloved:"WxeRb",crab:"Acwsj",gameIcon:"PsGTl"},R=0,E=[[-1,-1],[-1,0],[0,-1],[0,1],[1,0],[1,1],[-1,1],[1,-1]],$="crab_counts";function D(e,t,r){let a=(0,d.A)(-1,1);if(0!==a){let s=e+a*t;s<100?a=(0,d.A)(0,1):s>=r&&(a=(0,d.A)(-1,0))}return a}function W(e,t,r,a){let s=e+t*r;return s<100||s>=a}function z({bagIcon:e,crabIcon:t,id:r,onClick:a,onFriend:o,onLove:i}){let{_t:l,_c:h}=(0,c.Us)(),[m]=(0,n.useState)((0,d.A)(400,1e3)),[p]=(0,n.useState)((0,d.A)(20,79)),b=window.innerWidth-100,f=window.innerHeight-100,[y,x]=(0,n.useState)([(0,d.A)(0,(b??0)-1),(0,d.A)(0,(f??0)-1)]),w=g(),T=(0,u.X)(E),[j,S]=(0,n.useState)(T[0]),[A,C]=(0,n.useState)(T[1]),[k,F]=(0,n.useState)(0),[N,M]=(0,n.useState)(0),[P,H]=(0,n.useState)(!1),[B,R]=(0,n.useState)(!1),[$,z]=(0,n.useState)(!1),[L,_]=(0,n.useState)(""),[U,O]=(0,n.useState)(!1),q=(0,n.useRef)(),Y=(0,n.useRef)();(0,n.useEffect)(()=>{if(!$&&!B)return q.current=setInterval(()=>{let[e,t]=y,r=j,a=A,s=k>5&&Math.random()>.5;(s||W(e,r,p,b))&&S(r=D(e,p,b)),(s||W(t,a,p,f))&&C(a=D(t,p,f)),x([e+j*p,t+A*p]),F(s?0:(k??0)+1)},m),()=>clearInterval(q.current)},[y,j,A,N,p,k]),(0,n.useEffect)(()=>{let e=RegExp(l("Avatar"),"i"),t=document?.elementFromPoint(...y),r=t?.tagName.toLowerCase(),a=(t?.getAttribute("data-crab-label")||"").toLowerCase(),s=t?.getAttribute("data-crab-clickable")||!1;if(a)_(a);else if("img"===r){let r=(t?.getAttribute("alt")||"").toLowerCase();r&&r.match(e)?_(h("[TumblrMart crab widget]: What a crab says when it walks on top of a blog name or avatar.","friend?")):r&&_(r)}else if("a"===r){let e=t?.getAttribute("href")||"";if(e.match(/\/tagged\//)){let e=t?.textContent||"";e.match(/\bc+r+a+b+\b/i)?_(h('[TumblrMart crab widget]: What a crab says when it walks on top of a tag link that contains "crab".',"about me?")):e.match(/🦀/i)?_(h("[TumblrMart crab widget]: What a crab says when it walks on top of a tag link that contains a crab emoji.","me??")):_(h("[TumblrMart crab widget]: What a crab says when it walks on top of a tag link.","tag"))}else e.match(/^https:\/\/.+\.tumblr.com\//)?_(h("[TumblrMart crab widget]: What a crab says when it walks on top of a blog name or avatar.","friend?")):_(h("[TumblrMart crab widget]: What a crab says when it walks on top of a link.","link"))}else"video"===r?_(h("[TumblrMart crab widget]: What a crab says when it walks on top of a video.","video")):_("");s&&t?.click?.()},[y]),(0,n.useEffect)(()=>{if(!$&&B)return q.current=setInterval(()=>{let e,t,r,a;let{clientX:s,clientY:o}=w,[n,i]=y;n+42<s-20?(e=1,r=s-20-n-42):n>s+20?(e=-1,r=n-s-20):(e=0,r=0),i+42<o-20?(t=1,a=o-20-i-42):i>o+20?(t=-1,a=i-o-20):(t=0,a=0),S(e),C(t),0===e&&0===t?_(h("[TumblrMart crab widget]: What a beloved crab says when it meets you","love <3")):x([n+e*Math.min(r,p),i+t*Math.min(a,p)])},.75*m),()=>clearInterval(q.current)},[y,j,A,N,p,w]);let G=()=>{if(!U){let e=(N??0)+1;!B&&e>=25?(H(!1),R(!0),i()):!(N>=10)&&e>=10&&(H(!0),o()),M(e)}},K=()=>{U||$||(z(!0),setTimeout(()=>a(r),3e3)),q.current&&clearInterval(q.current)};return/*#__PURE__*/(0,v.jsx)("div",{className:s()(I.crabWrapper,{[I.isFriend]:P&&!B,[I.isBeloved]:B,[I.isCaptured]:$,[I.isSpeaking]:!!L}),"data-css-text-friend":h("[TumblrMart crab widget]: What a friend crab says when you hover over it","friend <3"),"data-css-text-hand":h("[TumblrMart crab widget]: What a crab says when you hover over it","hand"),"data-css-text-love":h("[TumblrMart crab widget]: What a beloved crab says when it meets you","love <3"),"data-speech":L,"data-testid":"crab-wrapper",style:{transform:`translate(${y[0]}px, ${y[1]}px)`},children:/*#__PURE__*/(0,v.jsx)("button",{"aria-label":h("[TumblrMart crab widget]: Label for interactive crab","Interactive crab"),className:I.crab,onClick:K,onMouseEnter:G,onTouchStart:()=>{if(U)return clearTimeout(Y.current),O(!1),K();Y.current=setTimeout(()=>{O(!1),G()},300),O(!0)},children:$?e:t})})}function L({bagIcon:e,crabIcon:t,crabs:r,onFriendCrab:a,onLoveCrab:s,onDismissCrab:o}){return"undefined"!=typeof window?/*#__PURE__*/(0,i.createPortal)(/*#__PURE__*/(0,v.jsx)("div",{className:I.wall,"data-testid":"crab-wall",children:r.map(r=>/*#__PURE__*/(0,v.jsx)(z,{bagIcon:e,crabIcon:t,id:r.id,onClick:o,onFriend:a,onLove:s},r.id))}),document?.body):null}let _=function(e){let{_c:t,logEvent:r}=(0,c.Us)(),[a,s]=(0,n.useState)([]),[i,d]=(0,n.useState)(null),[u,m]=(0,n.useState)(null),[g,p]=(0,n.useState)(null),[b,f]=(0,n.useState)(null),x=(0,n.useRef)();(0,n.useEffect)(()=>(window.addEventListener("beforeunload",w),()=>{w(),window.removeEventListener("beforeunload",w)}),[]),(0,n.useEffect)(()=>{x.current={numBefriended:i??0,numBeloved:u??0,numCaptured:g??0,numSummoned:b??0}},[i,u,g,b]);let w=()=>{if(x.current?.numSummoned){let e=h.A.getItem($),{befriended:t,beloved:r,captured:a,summoned:s}=e?JSON.parse(e):{befriended:0,beloved:0,captured:0,summoned:0},{numBefriended:o,numBeloved:n,numCaptured:i,numSummoned:l}=x.current;h.A.setItem($,JSON.stringify({befriended:t+o,beloved:r+n,captured:a+i,summoned:s+l}))}},T=t("[TumblrMart crab widget]: What the crab says when it steps on the Summon Crab button.","click please"),j=e?.gameAssets?/*#__PURE__*/(0,v.jsx)("img",{alt:t("[TumblrMart crab widget]: Label for a crab that has been caught","Crab in a bag"),className:I.gameIcon,src:e.gameAssets.bag,srcSet:`${e.gameAssets.bag}, ${(0,o.wV)(e.gameAssets.bag)} 2x`}):/*#__PURE__*/(0,v.jsx)("span",{"aria-label":t("[TumblrMart crab widget]: Label for a crab that has been caught","Crab in a bag"),role:"img",children:"'\uD83D\uDCB0'"}),S=e?.gameAssets?/*#__PURE__*/(0,v.jsx)("img",{alt:t("[TumblrMart crab widget]: Label for a crab","Crab"),className:I.gameIcon,src:e.gameAssets.crabs,srcSet:`${e.gameAssets.crabs}, ${(0,o.wV)(e.gameAssets.crabs)} 2x`}):/*#__PURE__*/(0,v.jsx)("span",{"aria-label":t("[TumblrMart crab widget]: Label for a crab","Crab"),role:"img",children:"'\uD83E\uDD80'"});return/*#__PURE__*/(0,v.jsxs)(v.Fragment,{children:[/*#__PURE__*/(0,v.jsxs)("div",{className:I.controlPanel,children:[/*#__PURE__*/(0,v.jsxs)("div",{className:I.buttonsWrapper,children:[/*#__PURE__*/(0,v.jsx)("button",{className:I.summonButton,"data-crab-label":T,onClick:()=>{s([...a,{id:R++}]),f(e=>(e??0)+1),r({eventName:l.R.CrabSummoned})},children:t("[TumblrMart crab widget]: Button that produces a crab on click","Summon Crab!")}),b&&/*#__PURE__*/(0,v.jsx)(B,{numBeloved:u??0,numCaptured:g??0,numFriends:i??0,numSummoned:b})]}),/*#__PURE__*/(0,v.jsx)(y,{numBeloved:u,numCaptured:g,numFriends:i,numSummoned:b})]}),/*#__PURE__*/(0,v.jsx)(L,{bagIcon:j,crabIcon:S,crabs:a,onDismissCrab:e=>{a.findIndex(t=>t.id===e)>-1&&(p(e=>(e??0)+1),s(t=>{let r=t.findIndex(t=>t.id===e);return r>-1?[...t.slice(0,r),...t.slice((r??0)+1)]:t}))},onFriendCrab:()=>d(e=>(e??0)+1),onLoveCrab:()=>{d(e=>(e??0)-1),m(e=>(e??0)+1)}})]})}},21070:(e,t,r)=>{"use strict";r.d(t,{sv:()=>b,Mr:()=>f,_d:()=>y,JA:()=>v,cJ:()=>g,ej:()=>x,Jd:()=>w,O2:()=>p,aq:()=>S,qE:()=>M,SS:()=>j,YJ:()=>A,FA:()=>C,zD:()=>F,Wh:()=>k,uA:()=>N});var a=r(36665),s=r(99805);let o=["$singleWord","$title of $placeName","$role of $placeName","$adjective $singleThing","$firstName","$complicatedName"],n={adjective:["Ruthless","Imperious","Unimpeachable","Sinister","Corporate","Sensitive","Exhausting","Scandalous","Harrowing","Foolish","Domestic","Steely","Hidden","Principled","Constant","Venetian","Baroque","Arboreal","Genuine","Lucky","Absolute","Terrestrial","Curious","Morbid","Abandoned","Aristotelian","Bohemian","Abstract","Admired","Agreeable","Alleged","Amiable","Angelic","Besieged","Unreasonable","Sizable","Unsupervised","Esoteric","Amorphous","Nauseous","Misshapen","Elastic","Confident","Indomitable","Ambivalent","Impulsive","Metallic","Floral","Threatening","Mirrored","Life-Size","Approachable","Tangible","Reliable","Pensive","False","True","Long","Fine","Illustrious","Solemn","Discerning","Euridite","Sun-eyed","Jade","Unsung"],townsperson:["Baker","Lighthouse Keeper","Butcher","Orphan","Helpmeet","Chanteuse","Friar","Falconer","Wizard","Witch","Sorcerer","Incubus","Succubus","Harpist","Dairymaid","Reaper","Goatherd","Artisan","Sculptor","Furrier","Girdler","Bandit","Juggler","Piper","Bard","Fiddler","Thatcher","Vicar","Dancer","Vagrant","Astrologer","Fletcher","Cobbler","Ambassador","Troubadour","Fool","Clown"],nameNoun:["Monarch","Pegasus","Fantasy","Orphan","Encounter","Spirit","Rhapsody","Orb","Sphere","Shape","Monstrosity","Sonata","Etude","Refrain","Fantasia","Apparition","Detritus","Flotsam","Rendezvous","Appointment","Erasure","Terror","Figure","Alibi","Feather","Number","Dog","Godhead","Decision","Bystander","Undergrowth","Dirt","Container","Flesh","Dream","Compromise","Pleasure","Passage","Threat","Diagnosis","River","Calliope","Fountain","Ripple","Pebble","Precipice","Oasis","Illusion","Fragment","Carnival","Pirouette","Masquerade","Tone"],title:["Earl","Duchess","Reverend","Chief","Archduke","Boy-King","Dowager Queen","Tsar","Marquess","Baron","Viscount","Empress","Emperor","President","Captain","Best Boy","Director","Vice President","Secretary","Prince","Princess","Mother Superior","Deacon","Prognosticator","Professor","Doctor"],familyRelation:["Son","Daughter","Father","Mother","Aunt","Uncle","Brother","Sister","Grandfather","Grandmother","Nephew","Niece","Cousin","Littermate","Sire","Damsire","Ex-Husband","Ex-Wife"],singleThing:["$nameNoun","$nameNoun","$nameNoun","$title"],singleWord:["$nameNoun","$nameNoun","$adjective","$adjective","$title"],role:["$title","$townsperson"],complicatedName:["$firstName | , $familyRelation of $firstName","$firstName | , $accomplishment","$firstName | , $role of $placeName"],placeName:["$britishPlace","$greekPlace"],britishPlace:["$britishPlaceBase | $britishPlaceSuffix","$britishPlaceBase | $britishPlaceSuffix","$britishPlaceBase | $britishPlaceSuffix","$britishPlaceBase | $britishPlaceSuffix","$britishPlaceBase | $britishPlaceSuffix | $britishPlaceFinisher"],greekPlace:["$greekPlaceStarter | $greekPlaceFinisher"],britishPlaceBase:["Avon","Ash","Old","Favers","Birming","Bucking","Wrex","Chat","Punk","Lyne","Maker","Bourne","Canter","Alde","Tewkes","Chep","Drum","Dun","Swin","Glod","Win","Sea"],britishPlaceSuffix:["ton","ington","dale","dean","ham","keth","leigh","field","brook","mouth","borough","bury","burgh","caster","chester","thorpe","thwaite","wick","worth"],britishPlaceFinisher:["-on- | $britishPlaceBase","-under- | $britishPlaceBase","-upon- | $britishPlaceBase","shire"],greekPlaceStarter:["Ab","Ach","Act","Aeg","Apoll","Arg","Herm","Her","Kall","Kam","Lam","Liss","Mant","Meg","Myk","Nax","Olymp","Pand","Sest","Strat","Thass","Therm","Zak"],greekPlaceFinisher:["ila","ydos","anthus","amae","ium","ae","onia","os","onassa","aclea","aptera","imera","ia","istria","astria","ipolis","opolis","eiros","annia","ascus","icea","ara","aria","apactus","eapoli","osia","ynthos"],timeAdjective:["Last","First"],firstName:["$scr | $u | $ngo | $s?"],scr:["Scr","Skr","Tr","Str","Gr","Gl","St","R","T","M","K","G","Y","Dr"],u:["u","oo","o","ee","i","ou","oa","u","a","oo","o","u","o'a","ø","ü"],ngo:["lgo","to","gu","po","mpo","ngu","ngo","lgo","lgo","mbe","mbu","g","t","d","st","sk","b","bu","cco"],s:["s","z"],accomplishment:["Who $mocks $powerfulThing","Who $conquered $placeName","$scourge of $placeName"],mocks:["Mocks","Laughs at","Refuses","Taunts","Harrasses","Provokes","Teases","Enrages","Incites","Offends","Derides","Scoffs at","Spits at","Betrays"],powerfulThing:["Hell","Death","God","Heaven","the Earth","Poseidon","Zeus","Athena","The Gods","Kings","Fate","Destiny","the Oracle","the Fates","Gaia","Hestia","Hades","Odin","Thor","Freyja","the internet","the economy","Reason itself"],conquered:["Conquered","Devastated","Annexed","Seized","Captured","Flattened","Quelled"],scourge:["Scourge","Terror","Bane","Torment","Hero","Voice","Heart","Savior","Salvation","Protector","Champion","Horror","Blight"]},i=(e,t)=>{if("$"!==e[0])return e;{let r=e.slice(1),a=r.match(/([^?]+)(\?+)$/);if(a&&a[2].length){if(Math.random()>=1/(a[2].length+1))return"";r=a[1]}return r.match(/\d+$/)?l(r,t):c(r)}},l=(e,t)=>{if(t[e])return t[e];let r=c(e.replace(/\d+$/,""));return t[e]=r,r},c=e=>{if(n[e])return d(n[e]);throw"Unknown key: "+e},d=e=>e[Math.floor(Math.random()*e.length)],h=e=>e.replace(/\s*\|\s*/g,""),u=e=>{let t={},r=e.split(" ").map(e=>i(e,t)).filter(e=>e&&e.length).join(" ");return r.match(/\$/)?u(r):h(r)},m=()=>u(d(o)),g="EXTREME_HORSE_ZONE",p=1e3,b=1.2,f=50,v=2,y=.03,x=8,w=4,T=()=>({name:m(),age:0,isAlive:!0}),j={hearts:[],currentHorse:T(),poos:[],horseComfortLevel:100,cemetery:[],tick:-1,horseDesiredX:null,horseDesiredY:null,horseX:s.horseFriendCanvasWidth/2-s.horseFriendHorseWidth/2,horseY:s.horseFriendCanvasHeight-s.horseFriendHorseHeight,horseFacingLeft:!0,poosRemoved:0,shouldShowCemetery:!1,isMinimized:!0},S=e=>(e.hearts||(e.hearts=[]),void 0===e.isMinimized&&(e.isMinimized=!0),e),A=e=>e.currentHorse.isAlive?e.cemetery.length+1:e.cemetery.length,C=e=>{let t=e.currentHorse.isAlive?e.poosRemoved:0;return e.cemetery.reduce((e,t)=>e+t.poosRemoved,t)},k=(e,t)=>{switch(t.type){case"loadStateFromStorage":return S(t.gameState);case"tick":return{...e,...t.gameState};case"setHorseX":return{...e,horseX:t.x};case"setHorseY":return{...e,horseY:t.y};case"setHorseDesiredX":return{...e,horseDesiredX:t.x};case"setHorseDesiredY":return{...e,horseDesiredY:t.y};case"setHorseFacingLeft":return{...e,horseFacingLeft:t.facingLeft};case"setPoos":return{...e,poos:t.poos};case"addHeart":return{...e,hearts:e.hearts.concat([t.heart])};case"updateHeart":return{...e,hearts:e.hearts.map(e=>e.id===t.heart.id?t.heart:e)};case"removeHeart":return{...e,hearts:e.hearts.filter(e=>e.id!==t.heart.id)};case"setPoosRemoved":return{...e,poosRemoved:t.poosRemoved};case"setShouldShowCemetery":return{...e,shouldShowCemetery:t.shouldShowCemetery};case"hatchNewHorse":return{...j,currentHorse:T(),horseDesiredY:s.horseFriendCanvasHeight-s.horseFriendHorseHeight,horseDesiredX:Math.floor(s.horseFriendCanvasWidth-2*s.horseFriendHorseWidth),horseX:e.horseX,horseY:e.horseY,cemetery:e.cemetery,isMinimized:!1};case"setIsMinimized":return{...e,isMinimized:t.isMinimized};default:return e}},F=/*#__PURE__*/(0,a.createContext)({state:j,dispatch:()=>null}),N=()=>(0,a.useContext)(F),M=(e,t,r)=>Math.max(Math.min(e,r),t)},9814:(e,t,r)=>{"use strict";r.d(t,{b:()=>n});var a=r(66910),s=r(84007);let o="https://tumblr.com/tumblrmart";function n(e){return[{description:(0,s.X)(e),displayUrl:o,type:a._B.Link,url:o}]}},38004:(e,t,r)=>{"use strict";r.d(t,{M:()=>s,X:()=>o});var a=r(36665);let s=/*#__PURE__*/(0,a.createContext)(null),o=(e,{enabled:t}={enabled:!0})=>{let r=(0,a.useContext)(s);return t&&r?{"data-wall-action":e,"data-wall-context":r}:null}},98589:(e,t,r)=>{"use strict";r.d(t,{x:()=>n});var a=r(38004),s=r(36665),o=r(60397);let n=/*#__PURE__*/(0,s.forwardRef)(({action:e,children:t,...r},s)=>{let n=(0,a.X)(e);return/*#__PURE__*/(0,o.jsx)("a",{...r,...n,ref:s,children:t})})},27162:(e,t,r)=>{"use strict";r.d(t,{f:()=>s});var a=r(28304);let s=()=>{let{data:e}=(0,a.Py)();if(e?.user)return e.user.blogs[0].tumblrmartOrders??[]}},61221:(e,t,r)=>{"use strict";r.d(t,{I1:()=>h,wM:()=>d});var a=r(49315),s=r(96894),o=r(90789),n=r(87800),i=r(4613),l=r(373);let c=(0,o.h)(l.z.object({unseenItems:l.z.array(n.fB).optional()})),d=e=>["unseen-items",e];function h(){let{apiFetchWithSchema:e,isLoggedIn:t}=(0,i.Us)();return(0,a.I)({queryKey:d(t),queryFn:async()=>{if(!t)return null;let{response:r}=await e("/v2/tumblrmart/unseen_items",c,{method:"GET",schemaErrorPrintFullResponse:!0});return r?.unseenItems?.map(({backgroundColors:e,deeplink:t,imageUrl:r,productGroup:a,tumblelogUuid:o,type:n})=>({backgroundColor:s.U$(e),deeplink:t,imageUrl:r,productGroup:a,tumblelogUuid:o,type:n}))||[]},refetchInterval:3e4,refetchIntervalInBackground:!0,staleTime:6e4})}},12733:(e,t,r)=>{"use strict";r.d(t,{h:()=>o,y:()=>s});var a=r(36665);let s=/*#__PURE__*/(0,a.createContext)(void 0),o=()=>(0,a.useContext)(s)},84160:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(74059),s=/*#__PURE__*/r.n(a),o=r(4613);let n={container:"uzQXY",icon:"QLnDj",active:"OnwDa",available:"nyE9Y",expired:"IBxfI",pending:"QeG5E",redeemed:"dCSsv",redeemedValid:"gMHJB"};var i=r(60397);let l=({status:e})=>{let t;let{_c:r}=(0,o.Us)();switch(e){case"redeemed":case"redeemedValid":t=r("Label for a tumblrmart order that has been redeemed","Redeemed");break;case"active":t=r("Label for a tumblrmart order that is currently active","Active");break;case"available":t=r("Label for a tumblrmart order that is ready to be activated","Available");break;case"expired":t=r("Label for a tumblrmart order that is expired","Expired");break;case"pending":t=r("Label for a tumblrmart order that is still being processed","Pending");break;default:t=r("Label for an unknown order status for Tumblrmart","Unknown")}return/*#__PURE__*/(0,i.jsxs)("div",{className:n.container,children:[/*#__PURE__*/(0,i.jsx)("span",{className:s()(n.icon,n[e]),"data-testid":"status-icon"}),t]})}},41162:(e,t,r)=>{"use strict";r.d(t,{Ou:()=>a,pr:()=>c});let a="Settings",{email:s,tfaSmsEnabled:o,tfaSmsPhoneNo:n,tfaAuthenticatorEnabled:i,connectedApps:l,...c}={accountActivityEmails:!0,asksSubmissionsHeaderBadges:!0,autoTruncatingPosts:!1,viewWithBlogTheme:!0,colorizedTags:!0,conversationalNotifications:!0,dashboardBestStuffFirst:!0,dashboardFollowedTagsPosts:!0,dashboardInYourOrbit:!0,dashboardBasedOnYourLikes:!0,defaultPostFormat:0,email:"test@example.com",endlessScrolling:!0,filteredContent:[],filteredTags:[],improvedSearch:!0,language:"en_US",messagingSounds:!0,onlineStatusIndicator:!0,ccpaOptedOut:!1,permitMarketingEmails:!0,tfaAuthenticatorEnabled:!1,tfaSmsEnabled:!1,tfaSmsPhoneNo:"",timestamps:!1,hideSensitiveContent:!0,communityLabelVisibilitySetting:"warn",communityLabelCategories:{drugUse:"warn",violence:"warn",sexualThemes:"warn"},labsEnabled:!0,labsExperiments:[],connectedApps:{},disableAdminOnlyFeatures:!1,disableAdminTagButtons:!1,adminEnableDevboxRedpop:!1,tumblrPremium:!1,showAdsAnyway:!1,showBlazeAds:!1}},76438:(e,t,r)=>{"use strict";r.d(t,{A:()=>h});var a=r(32063),s=r(36665),o=r(94048),n=r(4613),i=r(25833),l=r(18618),c=r(38189),d=r(60397);let h=({disableRefresh:e,disabled:t,onUpdate:r,name:h})=>{let{logEvent:u,_t:m}=(0,n.Us)(),{settings:g,set:p}=(0,i.t0)(),b=0;g.showBlazeAds&&(b=c.A.findIndex(e=>"showBlazeAds"===e.value)),(g.showAdsAnyway||t)&&(b=c.A.findIndex(e=>"showAdsAnyway"===e.value));let[f,v]=(0,s.useState)(b);return/*#__PURE__*/(0,d.jsx)(a.A,{className:l.A.radioGroup,disabled:t,groupLabel:m("Ad Visibility"),name:h,onChange:t=>{let a=o.R.AdFreeBrowsingSettingsShowNone,s=c.A[t].value;"showBlazeAds"===s?(a=o.R.AdFreeBrowsingSettingsShowBlaze,p("showAdsAnyway",!1,!1,()=>p("showBlazeAds",!0,!e,()=>r?.("showBlazeAds")))):"showAdsAnyway"===s?(a=o.R.AdFreeBrowsingSettingsShowAll,p("showBlazeAds",!1,!1,()=>p("showAdsAnyway",!0,!e,()=>r?.("showAdsAnyway")))):p("showAdsAnyway",!1,!1,()=>p("showBlazeAds",!1,!e,()=>r?.("showNone"))),v(t),u({eventName:a})},optionClassName:l.A.option,options:c.A,selectedOptionIndex:f})}},38189:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(85191),s=r(18618),o=r(60397);let n=[{value:"showNone",children:/*#__PURE__*/(0,o.jsx)("span",{children:/*#__PURE__*/(0,o.jsx)(a.Ay,{components:{emoji:/*#__PURE__*/(0,o.jsx)("span",{"aria-label":"",className:s.A.emoji,role:"img"})},children:"Hide all ads [emoji]\uD83D\uDE48[/emoji]"})})},{value:"showBlazeAds",children:/*#__PURE__*/(0,o.jsx)("span",{children:/*#__PURE__*/(0,o.jsx)(a.Ay,{components:{emoji:/*#__PURE__*/(0,o.jsx)("span",{"aria-label":"",className:s.A.emoji,role:"img"})},children:"Only show user Blaze ads [emoji]\uD83D\uDE0E[/emoji]"})})},{value:"showAdsAnyway",children:/*#__PURE__*/(0,o.jsx)("span",{children:/*#__PURE__*/(0,o.jsx)(a.Ay,{components:{emoji:/*#__PURE__*/(0,o.jsx)("span",{"aria-label":"",className:s.A.emoji,role:"img"})},children:"Show all ads [emoji]\uD83E\uDD11[/emoji]"})})}]},80933:(e,t,r)=>{"use strict";r.d(t,{M:()=>a});let a=Object.freeze({following:"following",stuff_for_you:"stuff_for_you",hubs:"hubs",wym:"wym",blog_subs:"blog_subs",tumblr_tv:"tumblr_tv",crushes:"crushes",popular_reblogs:"popular_reblogs",blazed_posts:"blazed_posts",trending:"trending"})},91514:(e,t,r)=>{"use strict";r.d(t,{Nw:()=>a,Q5:()=>o,Yb:()=>s});let a=/*#__PURE__*/function(e){return e.Youtube="youtube",e.Tumblr="tumblr",e.Flickr="flickr",e.Instagram="instagram",e}({}),s=/*#__PURE__*/function(e){return e.Mov="video/quicktime",e.Mp4="video/mp4",e.AppleM4v="video/x-m4v",e}({}),o=/*#__PURE__*/function(e){return e.User="User",e.Glass="Glass",e.DocumentVisibility="DocumentVisibility",e}({})},59454:(e,t,r)=>{"use strict";r.d(t,{MS:()=>i,U1:()=>n,Vp:()=>d,qX:()=>c,wg:()=>l});var a=r(66910),s=r(25175),o=r(12673);function n(e,t="",r){return new o._(e,`/v2/typeahead${t&&`/${encodeURIComponent(t)}`}`,{method:"GET",queryParams:{...(0,s.k9)(["avatar","name","url","blogViewUrl","title","followed","theme"]),...r}})}function i(e,t){return new o._(e,`/v2/search/${encodeURIComponent(t)}/tags/typeahead`,{method:"GET",queryParams:{limit:"20",include_query:!0}})}function l(e,{searchKeyword:t,timelineType:r,postType:n,postTypes:i,requestMode:l,skipComponent:c,limit:d,days:h,reblogInfo:u=!0,cursor:m,querySource:g,postRole:p}){return new o._(e,"/v2/timeline/search",{queryParams:{limit:d,days:h,cursor:m,query:t,mode:l,timeline_type:r,skip_component:c,reblog_info:u,post_type_filter:i?.length?void 0:(0,a.kb)(n),post_type_filters:i?.length?i.map(a.kb).join(","):void 0,query_source:g,post_role:p,...(0,s.oS)(["followed","shareFollowing","shareLikes","ask","theme"])}})}function c(e,t,r={}){return new o._(e,`/v2/search/${encodeURIComponent(t)}/tags/all`,{queryParams:r})}function d(e,t){return new o._(e,"/v2/audio",{queryParams:{query:t}})}},25833:(e,t,r)=>{"use strict";r.d(t,{Z6:()=>u,mF:()=>h,t0:()=>m});var a=r(36665),s=r(41162),o=r(66869),n=r(39705),i=r(79409),l=r(4613),c=r(60397);let d=/*#__PURE__*/(0,a.createContext)(void 0);function h(e,t,r){let a=(0,o.Ay)(e.apiFetch).getUserSettings().fetch();return t?Promise.all([a,t(e,r)]).then(([{response:e},t])=>({settings:e,extraData:t})):a.then(({response:e})=>({settings:e}))}function u({children:e,additionalDataFetcher:t}){let{getBootstrap:r,apiFetch:u,apiFetchWithSchema:m,features:g}=(0,l.Us)(),[p,b]=(0,a.useState)(!1),[f,v]=(0,a.useState)(!1),[y,x]=(0,a.useState)(r?.(s.Ou));(0,a.useEffect)(()=>{(async()=>{Object.keys(y).length>0||(v(!0),x(await h({apiFetch:u,apiFetchWithSchema:m},t,g)),v(!1))})()},[]);let w=(e,t,r)=>{let{extraData:a,settings:l}=y,c=Object.keys(s.pr);x({settings:{...l,...e},extraData:a});let d=(0,n.q)(e,(e,t)=>c.includes(e));(0,i.R)(d)||(0,o.Ay)(u).updateUserSettings(d).fetch().then(()=>{t&&(b(!0),window.location.reload()),r?.()})},T=(e,t,r,a)=>{let{extraData:s,settings:o}=y;x({extraData:{...s,...e},settings:o}),(0,i.R)(e)||t?.fetch().then(()=>{r&&window.location.reload(),a?.()})},j={settings:y.settings,extraData:y.extraData,isFetching:f,isForceReloading:p,merge:(e,t=!1,r)=>w(e,t,r),mergeExtraData:(e,t,r=!1,a)=>T(e,t,r,a),set:(e,t,r=!1,a)=>w({[e]:t},r,a),setExtraData:(e,t,r,a=!1,s)=>T({[e]:t},r,a,s),toggle:(e,t=!1,r)=>()=>w({[e]:!y.settings[e]},t,r),select:({target:{id:e,value:t}},r=!1,a)=>w({[e]:t},r,a),refetch:()=>{(async()=>{x(await h({apiFetch:u,apiFetchWithSchema:m},t,g))})()}};return/*#__PURE__*/(0,c.jsx)(d.Provider,{value:j,children:e})}function m(){let e=(0,a.useContext)(d);if(void 0===e)throw Error("useSettings must be used within a SettingsProvider");return e}},47738:(e,t,r)=>{"use strict";r.d(t,{w:()=>n});var a=r(12044),s=r(49702),o=r(80933);let n=e=>{let t=e(s.Z_.DASHBOARD_LAST_SELECTED_TAB);return o.M[t]?`/dashboard/${t}`:a.ry.dashboard}},78774:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(e,t)=>Math.floor(Math.random()*(t-e+1))+e},14899:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=e=>new Promise(t=>{let{currentTarget:r}=e;setTimeout(()=>t(r.contains(document.activeElement)),0)})},62391:(e,t,r)=>{"use strict";r.d(t,{Jd:()=>l,uL:()=>c,wH:()=>n});var a=r(68484);let s="recenSearches",o=5,n=()=>{let e=JSON.parse(a.A.getItem(s)||"[]");return Array.isArray(e)?e:[]},i=e=>{a.A.setItem(s,JSON.stringify(e))},l=(e,t=o)=>{let r=n();if(r[0]!==e){if(r.includes(e)){let t=r.indexOf(e);r.splice(t,1),r.unshift(e)}else r.unshift(e),r.splice(Math.min(r.length,t));i(r)}},c=e=>{i(n().filter(t=>t!==e))}},47741:e=>{e.exports={colorAccent:"var(--accent)",colorAccentFg:"var(--accent-fg)",colorAccentFgLight:"var(--accent-fg-light)",colorAccentHover:"var(--accent-hover)",colorAccentPressed:"var(--accent-pressed)",colorAccentTint:"var(--accent-tint)",colorAccentTintStrong:"var(--accent-tint-strong)",colorAccentTintHeavy:"var(--accent-tint-heavy)",colorChrome:"var(--chrome)",colorChromePanel:"var(--chrome-panel)",colorChromePanelBorder:"var(--chrome-panel-border)",colorChromeTint:"var(--chrome-tint)",colorChromeTintStrong:"var(--chrome-tint-strong)",colorChromeTintHeavy:"var(--chrome-tint-heavy)",colorChromeMobile:"var(--chrome-mobile)",colorChromeFg:"var(--chrome-fg)",colorChromeFgSecondary:"var(--chrome-fg-secondary)",colorChromeFgTertiary:"var(--chrome-fg-tertiary)",colorContentPanel:"var(--content-panel)",colorContentPanelBorder:"var(--content-panel-border)",colorContentTint:"var(--content-tint)",colorContentTintStrong:"var(--content-tint-strong)",colorContentTintHeavy:"var(--content-tint-heavy)",colorContentMobileContainer:"var(--content-mobile-container)",colorContentFg:"var(--content-fg)",colorContentFgSecondary:"var(--content-fg-secondary)",colorContentFgTertiary:"var(--content-fg-tertiary)",colorPanelBorder:"var(--color-panel-border)",colorTint:"var(--color-tint)",colorTintStrong:"var(--color-tint-strong)",colorTintHeavy:"var(--color-tint-heavy)",colorFg:"var(--color-fg)",colorFgSecondary:"var(--color-fg-secondary)",colorFgTertiary:"var(--color-fg-tertiary)",colorFgLight:"var(--color-fg-light)",colorFgLightSecondary:"var(--color-fg-light-secondary)",colorFgLightTertiary:"var(--color-fg-light-tertiary)",colorImageBg:"var(--image-bg)",colorImagePanelBorder:"var(--image-panel-border)",colorImageTint:"var(--image-tint)",colorImageTintStrong:"var(--image-tint-strong)",colorImageTintHeavy:"var(--image-tint-heavy)",colorImageFg:"var(--image-fg)",colorImageFgSecondary:"var(--image-fg-secondary)",colorImageFgTertiary:"var(--image-fg-tertiary)",colorSideMenu:"var(--side-menu)",colorSideMenuShadow:"var(--side-menu-shadow)",colorTopMenu:"var(--top-menu)",colorTopMenuShadow:"var(--top-menu-shadow)",colorModal:"var(--modal)",colorModalBorder:"var(--modal-border)",colorToolTip:"var(--tool-tip)",colorToolTipText:"var(--tool-tip-text)",colorOverlayTint:"var(--overlay-tint)",colorOverlayTintStrong:"var(--overlay-tint-strong)",colorOverlayTintHeavy:"var(--overlay-tint-heavy)",colorUnreadTint:"var(--unread-tint)",colorUnreadTintHover:"var(--unread-tint-hover)",colorBadgeIcon:"var(--badge-icon)",colorBadgeText:"var(--badge-text)",colorChromeUi:"var(--chrome-ui)",colorChromeUiHover:"var(--chrome-ui-hover)",colorChromeUiPressed:"var(--chrome-ui-pressed)",colorChromeUiFocus:"var(--chrome-ui-focus)",colorChromeUiFg:"var(--chrome-ui-fg)",colorChromeUiFgSecondary:"var(--chrome-ui-fg-secondary)",colorChromeUiFgTertiary:"var(--chrome-ui-fg-tertiary)",colorChromeUiToggle:"var(--chrome-ui-toggle)",colorChromeDanger:"var(--chrome-danger)",colorChromeSuccess:"var(--chrome-success)",colorChromeEducation:"var(--chrome-education)",colorChromeBlue:"var(--chrome-blue)",colorChromePurple:"var(--chrome-purple)",colorChromePink:"var(--chrome-pink)",colorChromeRed:"var(--chrome-red)",colorChromeOrange:"var(--chrome-orange)",colorChromeYellow:"var(--chrome-yellow)",colorChromeGreen:"var(--chrome-green)",colorContentUi:"var(--content-ui)",colorContentUiHover:"var(--content-ui-hover)",colorContentUiPressed:"var(--content-ui-pressed)",colorContentUiFocus:"var(--content-ui-focus)",colorContentUiFg:"var(--content-ui-fg)",colorContentUiFgSecondary:"var(--content-ui-fg-secondary)",colorContentUiFgTertiary:"var(--content-ui-fg-tertiary)",colorContentUiToggle:"var(--content-ui-toggle)",colorContentDanger:"var(--content-danger)",colorContentSuccess:"var(--content-success)",colorContentEducation:"var(--content-education)",colorContentBlue:"var(--content-blue)",colorContentPurple:"var(--content-purple)",colorContentPink:"var(--content-pink)",colorContentRed:"var(--content-red)",colorContentOrange:"var(--content-orange)",colorContentYellow:"var(--content-yellow)",colorContentGreen:"var(--content-green)",colorUi:"var(--color-ui)",colorUiHover:"var(--color-ui-hover)",colorUiPressed:"var(--color-ui-pressed)",colorUiFocus:"var(--color-ui-focus)",colorUiFg:"var(--color-ui-fg)",colorUiFgSecondary:"var(--color-ui-fg-secondary)",colorUiFgTertiary:"var(--color-ui-fg-tertiary)",colorUiToggle:"var(--color-ui-toggle)",colorImageUi:"var(--image-ui)",colorImageUiHover:"var(--image-ui-hover)",colorImageUiPressed:"var(--image-ui-pressed)",colorImageUiAccent:"var(--image-ui-accent)",colorImageUiFg:"var(--image-ui-fg)",colorImageUiFgSecondary:"var(--image-ui-fg-secondary)",colorImageUiFgTertiary:"var(--image-ui-fg-tertiary)",colorImageUiToggle:"var(--image-ui-toggle)",colorDanger:"var(--danger)",colorDangerHover:"var(--danger-hover)",colorDangerPressed:"var(--danger-pressed)",colorDangerTint:"var(--danger-tint)",colorDangerTintStrong:"var(--danger-tint-strong)",colorDangerTintHeavy:"var(--danger-tint-heavy)",colorSuccess:"var(--success)",colorSuccessHover:"var(--success-hover)",colorSuccessPressed:"var(--success-pressed)",colorSuccessTint:"var(--success-tint)",colorSuccessTintStrong:"var(--success-tint-strong)",colorSuccessTintHeavy:"var(--success-tint-heavy)",colorEducation:"var(--education)",colorEducationHover:"var(--education-hover)",colorEducationPressed:"var(--education-pressed)",colorEducationTint:"var(--education-tint)",colorEducationTintStrong:"var(--education-tint-strong)",colorEducationTintHeavy:"var(--education-tint-heavy)",colorBrandBlue:"var(--brand-blue)",colorBrandBlueHover:"var(--brand-blue-hover)",colorBrandBluePressed:"var(--brand-blue-pressed)",colorBrandBlueTint:"var(--brand-blue-tint)",colorBrandBlueTintStrong:"var(--brand-blue-tint-strong)",colorBrandBlueTintHeavy:"var(--brand-blue-tint-heavy)",colorBrandPurple:"var(--brand-purple)",colorBrandPurpleHover:"var(--brand-purple-hover)",colorBrandPurplePressed:"var(--brand-purple-pressed)",colorBrandPurpleTint:"var(--brand-purple-tint)",colorBrandPurpleTintStrong:"var(--brand-purple-tint-strong)",colorBrandPurpleTintHeavy:"var(--brand-purple-tint-heavy)",colorBrandPink:"var(--brand-pink)",colorBrandPinkHover:"var(--brand-pink-hover)",colorBrandPinkPressed:"var(--brand-pink-pressed)",colorBrandPinkTint:"var(--brand-pink-tint)",colorBrandPinkTintStrong:"var(--brand-pink-tint-strong)",colorBrandPinkTintHeavy:"var(--brand-pink-tint-heavy)",colorBrandRed:"var(--brand-red)",colorBrandRedHover:"var(--brand-red-hover)",colorBrandRedPressed:"var(--brand-red-pressed)",colorBrandRedTint:"var(--brand-red-tint)",colorBrandRedTintStrong:"var(--brand-red-tint-strong)",colorBrandRedTintHeavy:"var(--brand-red-tint-heavy)",colorBrandOrange:"var(--brand-orange)",colorBrandOrangeHover:"var(--brand-orange-hover)",colorBrandOrangePressed:"var(--brand-orange-pressed)",colorBrandOrangeTint:"var(--brand-orange-tint)",colorBrandOrangeTintStrong:"var(--brand-orange-tint-strong)",colorBrandOrangeTintHeavy:"var(--brand-orange-tint-heavy)",colorBrandYellow:"var(--brand-yellow)",colorBrandYellowHover:"var(--brand-yellow-hover)",colorBrandYellowPressed:"var(--brand-yellow-pressed)",colorBrandYellowTint:"var(--brand-yellow-tint)",colorBrandYellowTintStrong:"var(--brand-yellow-tint-strong)",colorBrandYellowTintHeavy:"var(--brand-yellow-tint-heavy)",colorBrandGreen:"var(--brand-green)",colorBrandGreenHover:"var(--brand-green-hover)",colorBrandGreenPressed:"var(--brand-green-pressed)",colorBrandGreenTint:"var(--brand-green-tint)",colorBrandGreenTintStrong:"var(--brand-green-tint-strong)",colorBrandGreenTintHeavy:"var(--brand-green-tint-heavy)"}},21098:(e,t,r)=>{"use strict";r.d(t,{n:()=>s});var a=r(72571);function s(e){return(0,a.ke)(e)&&e.extraAttributes?e.extraAttributes.searchTerm:(0,a.GL)(e)&&e.extraAttributes?`#${e?.extraAttributes.tagName}`:""}},10325:(e,t,r)=>{"use strict";function a(e){return Object.fromEntries(Object.entries(e).filter(([,e])=>null!=e))}r.d(t,{N:()=>a})}}]);