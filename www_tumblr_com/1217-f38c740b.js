!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="004e6079-3d40-41c9-b231-6331deed4848",e._sentryDebugIdIdentifier="sentry-dbid-004e6079-3d40-41c9-b231-6331deed4848")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"redpop@ce094590bd2291e3264b21d2f92bffc273e4a131"};"use strict";(self.webpackChunk_tumblr_redpop=self.webpackChunk_tumblr_redpop||[]).push([[1217],{92496:(e,t,n)=>{n.d(t,{A:()=>eo});var a=n(74059),s=/*#__PURE__*/n.n(a),r=n(21540),o=n(11100),i=n(69010),l=n(17886),d=n(12044),u=n(36665),c=n(53986),m=n(94048),h=n(39460),p=n(86115),g=n(4613),b=n(68484),f=n(56040),k=/*#__PURE__*/n.n(f);let x={adFreeCtaBanner:"I6Lwl",bannerContent:"JAYfv",bannerText:"NoQSe",close:"ye7wo"};var C=n(60397);let w="ad-free-cta-dismiss",y=()=>{let e=(0,c.Zp)(),{_c:t,setCookie:n,getCookie:a,logEvent:s,getUserInfo:f,isLoggedIn:y,features:_}=(0,g.Us)(),[v,j]=(0,u.useState)(!1),[I,D]=(0,u.useState)(!1),[E,A]=(0,u.useState)(!1),[M,T]=(0,u.useState)(!0);(0,u.useEffect)(()=>{let e=setTimeout(N,3e3);return()=>{clearTimeout(e)}},[]);let N=()=>{!_.enableTumblrPremium&&y&&!P()&&_.adFreeCtaBanner?f().then(({hasTumblrPremium:e,usedToHaveTumblrPremium:t})=>{D(e||!1),A(t||!1),!e&&z()&&s({eventName:m.R.AdFreeAdBlockCtaImpression,eventDetails:{usedToHaveTumblrPremium:t,hasTumblrPremium:e,adBlockEnabled:z()}}),T(!1)}):T(!1)},P=()=>v||a(w),z=(0,u.useCallback)(()=>"true"===b.R.getItem(r.E9),[]),S=()=>{let e=Math.random()*p.g.Week;n(w,"1",{expires:new Date(Date.now()+p.g.Week+e)}),j(!0)},W=(0,u.useCallback)(e=>{s({eventName:e,eventDetails:{usedToHaveTumblrPremium:E,adBlockEnabled:z()}})},[z,s,E]);if(M||!y||!_.adFreeCtaBanner||_.enableTumblrPremium||P()||I||!z())return null;let R=t("[Tumblrmart] Banner text that will be accompanied by a button to purchase ad-free browsing subscription","Hey! Hello! Down here! ðŸ¸ We see you are using an ad-blocker. Nobody likes ads. We get it. But they are a means to an end in keeping this hellsite we all love going. Did you know you can stop seeing ads while helping the world stay weird with Tumblr? Go Ad-Free. It's a win-win, really. â¤ï¸ Tumblr Staff"),V=t("[Tumblrmart] Text on a button that will purchase a subscription to ad-free browsing","Go Ad-Free âœ¨");return/*#__PURE__*/(0,C.jsx)("div",{className:x.adFreeCtaBanner,children:/*#__PURE__*/(0,C.jsxs)("div",{className:x.bannerContent,children:[/*#__PURE__*/(0,C.jsx)("p",{className:x.bannerText,children:R}),/*#__PURE__*/(0,C.jsx)(l.A,{backgroundColor:k().sidekickPink,isRounded:!0,onClick:()=>{W(m.R.AdFreeCtaActionClick),S(),e(`${(0,d.yK)({page:h.e.AdFreeBrowsing})}?source=cta`)},textColor:k().black,children:V}),/*#__PURE__*/(0,C.jsx)(o.A,{className:x.close,label:t("label on a button that will dismiss a banner","Close"),onClick:()=>{W(m.R.AdFreeCtaDismissClick),S()},children:/*#__PURE__*/(0,C.jsx)(i.A,{})})]})})};var _=n(84887),v=n(83087),j=n(28304),I=n(56281);let D=()=>{let{isLoggedIn:e,_c:t,logEvent:n}=(0,g.Us)(),{toggleToast:a}=(0,I.Y)(),{data:s,isPending:r}=(0,j.Py)(),o=s?.user,i=e=>`FreePremiumExpiryNotification_${e}`,c=()=>{n({eventName:m.R.RewardedAdPushNotificationClick})},p=()=>{if(!o?.tumblrFreePremiumExpiration)return;let e=Date.now(),n=1e3*o.tumblrFreePremiumExpiration;n-e>1e3||e-n>6048e5||(a(/*#__PURE__*/(0,C.jsx)(l.A,{href:(0,d.yK)({page:h.e.AdFreeBrowsing}),onClick:c,size:"small",textColor:k().white,theme:"default",children:t("Rewarded Ad reward ended.","Your ad-free browsing just ended. Want some more?")}),"info","rewarded-ad-ended"),b.A.setItem(i(o.userUuid||o.name),n.toString()))};return(0,u.useEffect)(()=>{if(!e||!o?.tumblrFreePremiumExpiration)return;let t=Date.now(),n=1e3*o.tumblrFreePremiumExpiration;if(t-n>6048e5)return;let a=b.A.getItem(i(o.userUuid||o.name));if(a&&parseInt(a,10)===n)return;let s=setTimeout(p,Math.max(n-t-1e3,2e3));return()=>{s&&clearTimeout(s)}},[o?.tumblrFreePremiumExpiration]),r};var E=n(72571),A=n(57620),M=n(19884),T=n(43024),N=n(20970),P=n(13718),z=n(68539),S=n(70871);function W(e){return(0,E.pO)(e)&&e.extraAttributes?.blogName||void 0}function R(e){return"login_register_header"+(e?`_${e.name}`:"")}let V=({activePage:e,headerRightControl:t,headerTheme:n,withMobileHeaderSearchInput:a=!1})=>{let{configRef:s}=(0,g.Us)(),{inboxCount:r,unseenPosts:o,notificationCount:i,privateGroupBlogUnreadPostCounts:l,unreadCommunityCounts:d}=(0,M.T)(),{unreadMessages:u}=(0,A.Z)(),c=u?.unreadMessagesCount,m=(0,T._)(l),h=s?.takeoverLogoUrl??"",p=(0,P.A)(R(e));D();let b=W(e),f={activePage:e,blogName:b,unreadMessagesCount:c,registrationSource:p,privateGroupBlogUnreadPostTotal:m,inboxCount:r,logoUrl:h,notificationCount:i,headerTheme:n||"light",unseenPostCount:o,unreadCommunityPostTotal:d};return(0,N.s)()?null:/*#__PURE__*/(0,C.jsx)(v.Ay,{children:({isMobile:e})=>e?/*#__PURE__*/(0,C.jsx)(S.A,{...f,headerRightControl:t,withMobileHeaderSearchInput:a}):/*#__PURE__*/(0,C.jsx)(z.A,{...f})})};var B=n(96078),F=n(58052),O=n(90657),L=n(373),U=n(78895);let G=L.z.object({payload:L.z.object({actions:L.z.array(L.z.discriminatedUnion("type",[L.z.object({type:L.z.literal("VIEW_BLOG"),params:L.z.object({tumblelog_id:L.z.number(),tumblelog_name:U.s})}),L.z.object({type:L.z.literal("VIEW_CONVERSATION"),params:L.z.object({conversation_id:L.z.number(),from_tumblelog_name:U.s,to_tumblelog_name:U.s})}),L.z.object({type:L.z.literal("VIEW_POST"),params:L.z.object({tumblelog_id:L.z.number(),tumblelog_name:U.s,post_id:L.z.string()})}),L.z.object({type:L.z.literal("VIEW_PREMIUM")}),L.z.object({type:L.z.literal("NOOP")})])).nonempty()})});L.z.object({notification:L.z.object({title:U.s,body:U.s}),data:G});let Y=()=>{let e=(0,c.Zp)(),{openConversationWindow:t}=(0,A.Z)(),n="undefined"!=typeof navigator&&"serviceWorker"in navigator,a=(0,u.useCallback)(n=>{let{type:a,data:s}=n.data;if("PUSH_NOTIFICATION_CLICK"===a){let n=G.parse(s).payload.actions[0];if("VIEW_CONVERSATION"===n.type)return t({selectedBlogName:n.params.to_tumblelog_name,otherParticipantName:n.params.from_tumblelog_name});let a=function(e){switch(e.type){case"VIEW_BLOG":return`/${e.params.tumblelog_name}`;case"VIEW_CONVERSATION":return`/?messagingFrom=${e.params.to_tumblelog_name}&messagingTo=${e.params.from_tumblelog_name}`;case"VIEW_POST":return`/${e.params.tumblelog_name}/${e.params.post_id}`;case"VIEW_PREMIUM":return"/settings/ad-free-browsing";default:return null}}(n);a&&e(a)}},[e,t]);return(0,u.useEffect)(()=>{if(n)return navigator.serviceWorker.addEventListener("message",a),()=>navigator.serviceWorker.removeEventListener("message",a)},[a,n]),null};var $=n(88346),Z=/*#__PURE__*/n.n($),q=n(55618),H=n(85191),K=n(49702),Q=n(98323);let J={unsupportedBrowserMessage:"s0qqG",dismissButton:"WGFYZ",messageParagraph:"_h_yT"},X="https://www.google.com/chrome",ee="https://www.mozilla.org/firefox",et="unsupported-browser-message-dismiss";class en extends u.Component{constructor(...e){super(...e),Z()(this,"state",{isVisible:this.shouldShowMessage()}),Z()(this,"onDismissClick",()=>{let{setCookie:e}=this.props.appContext,t=new Date(Date.now()+6048e5);this.setState({isVisible:!1}),e(et,"1",{expires:t}),this.logViewEvent(m.R.UnsupportedBrowserMessageDismiss)})}render(){let{isVisible:e}=this.state;if(!e)return null;let{_t:t}=this.props.appContext,n=this.getMessage();return/*#__PURE__*/(0,C.jsxs)("div",{className:J.unsupportedBrowserMessage,children:[n,/*#__PURE__*/(0,C.jsx)(o.A,{className:J.dismissButton,label:t("Dismiss"),onClick:this.onDismissClick,children:/*#__PURE__*/(0,C.jsx)(q.h,{size:{width:12,height:12}})})]})}componentDidMount(){let{isVisible:e}=this.state;e&&this.logViewEvent(m.R.UnsupportedBrowserMessageView)}logViewEvent(e){let{logEvent:t,getBrowserInfo:n}=this.props.appContext,{userAgent:a}=n(),{ua:s}=a;t({eventName:e,eventDetails:{ua:s}})}shouldShowMessage(){let{getCookie:e}=this.props.appContext;if("1"===e(et)||K.ao.includes(e(K.Z_.NATIVE_APP_WEBVIEW)))return!1;let{isSupported:t,isCrawler:n}=this.props.appContext.getBrowserInfo();return!t&&!n}getMessage(){let{getBrowserInfo:e}=this.props.appContext,{deviceType:t}=e();return t===Q.Ay.Desktop?this.getDesktopMessage():this.getDefaultMessage()}getDesktopMessage(){return/*#__PURE__*/(0,C.jsx)("div",{className:J.messageParagraph,children:/*#__PURE__*/(0,C.jsx)(H.Ay,{comment:"Placeholders here are link tags - links are to each browser's page",components:{chrome:/*#__PURE__*/(0,C.jsx)("a",{href:X,rel:"noopener",target:"_blank",children:"Chrome"}),firefox:/*#__PURE__*/(0,C.jsx)("a",{href:ee,rel:"noopener",target:"_blank",children:"Firefox"}),safari:/*#__PURE__*/(0,C.jsx)("a",{href:"https://support.apple.com/downloads/safari",rel:"noopener",target:"_blank",children:"Safari"}),edge:/*#__PURE__*/(0,C.jsx)("a",{href:"https://www.microsoft.com/windows/microsoft-edge",rel:"noopener",target:"_blank",children:"Edge"})},children:"You are using an unsupported browser and things might not work as intended. Please make sure you're using the latest version of [chrome/], [firefox/], [safari/], or [edge/]."})})}getDefaultMessage(){return/*#__PURE__*/(0,C.jsx)("div",{className:J.messageParagraph,children:/*#__PURE__*/(0,C.jsx)(H.Ay,{comment:"Placeholders here are link tags - links are to each browser's page",components:{chrome:/*#__PURE__*/(0,C.jsx)("a",{href:X,rel:"noopener",target:"_blank",children:"Chrome"}),firefox:/*#__PURE__*/(0,C.jsx)("a",{href:ee,rel:"noopener",target:"_blank",children:"Firefox"})},children:"You are using an unsupported browser and things might not work as intended. Please make sure you're using the latest version of [chrome/] or [firefox/]."})})}}let ea=(0,g.Lk)(en);var es=n(50902);let er={bluespaceLayout:"D5eCV",loggedOutLayout:"Mpbf7",mobileLayout:"ZYef7",desktopLayout:"c9lq9",navigationWrapper:"h_Erh",mainContentWrapper:"_3xgk",mainContentIsNarrow:"Ril26",mainContentIsFullWidth:"jB5sp",mainContentIsMasonry:"VsR8V",mainContentIs2ColumnMasonry:"QDysN",mainContentIs3ColumnMasonry:"au16g",mainContentIs4ColumnMasonry:"f_ziq"},eo=function({activePage:e,children:t,headerRightControl:n,headerTheme:a,mainContentIsMasonry:r,mainContentIsNarrow:o=!0,mainContentIsFullWidth:i=!1,maxMasonryColumns:l=4,withMobileHeaderSearchInput:d=!1}){let{isLoggedIn:u}=(0,g.Us)(),{isMobile:c}=(0,v.Ri)();return/*#__PURE__*/(0,C.jsx)("div",{className:s()(er.bluespaceLayout,{[er.loggedOutLayout]:!u}),children:/*#__PURE__*/(0,C.jsx)(es.q.Provider,{value:e,children:/*#__PURE__*/(0,C.jsxs)(_.A,{children:[!u&&/*#__PURE__*/(0,C.jsx)(O.Ay,{disable:O.Uy}),/*#__PURE__*/(0,C.jsxs)("div",{className:c?er.mobileLayout:er.desktopLayout,children:[c?/*#__PURE__*/(0,C.jsx)(V,{activePage:e,headerRightControl:n,headerTheme:a,withMobileHeaderSearchInput:d}):/*#__PURE__*/(0,C.jsx)("div",{className:er.navigationWrapper,children:u?/*#__PURE__*/(0,C.jsx)(B.default,{activePage:e,blogName:W(e),mainContentIsMasonry:r}):/*#__PURE__*/(0,C.jsx)(F.G,{hideLoginButton:!0,mainContentIsMasonry:r,registrationSource:R(e)})}),/*#__PURE__*/(0,C.jsx)("div",{className:s()(er.mainContentWrapper,{[er.mainContentIsFullWidth]:i,[er.mainContentIsMasonry]:r,[er.mainContentIs2ColumnMasonry]:r&&2===l,[er.mainContentIs3ColumnMasonry]:r&&3===l,[er.mainContentIs4ColumnMasonry]:r&&4===l,[er.mainContentIsNarrow]:o}),children:t})]}),/*#__PURE__*/(0,C.jsx)(ea,{}),/*#__PURE__*/(0,C.jsx)(y,{}),/*#__PURE__*/(0,C.jsx)(Y,{})]})})})}},84887:(e,t,n)=>{n.d(t,{A:()=>p});var a=n(88346),s=/*#__PURE__*/n.n(a),r=n(75185),o=n(36665),i=n(94048),l=n(54934),d=n(79512),u=n(40176),c=n(93972),m=n(60397);class h extends o.Component{constructor(...e){super(...e),s()(this,"getTimelineContext",()=>this.timelineContext),s()(this,"state",{isMediaDocked:!1,dockedTimelineObject:null,reparentableMediaManager:null,canAutoDock:!1,getTimelineContext:this.getTimelineContext}),s()(this,"idGen",new d.A),s()(this,"getDockableContextValue",(0,r.A)(({isMediaDocked:e,dockedTimelineObject:t,reparentableMediaManager:n,canAutoDock:a})=>({isMediaDocked:e,dockedTimelineObject:t,reparentableMediaManager:n,canAutoDock:a,getTimelineContext:this.getTimelineContext,dock:this.dock,undock:this.undock,clearDockedInfo:this.clearDockedInfo,setDockedTimelineObject:this.setDockedTimelineObject,getId:this.getId}),{maxSize:1})),s()(this,"dock",({dockedTimelineObject:e,reparentableMediaManager:t,isAutoDock:n,canAutoDock:a,timelineContext:s})=>{this.timelineContext=s,this.setState(({isMediaDocked:s,dockedTimelineObject:r,canAutoDock:o})=>(this.logDockEvent(i.R.DockElement,e,n,a),s&&r&&this.logDockEvent(i.R.UndockElement,r,!0,o),{isMediaDocked:!0,dockedTimelineObject:e,reparentableMediaManager:t,canAutoDock:a}))}),s()(this,"undock",()=>{this.setState(({isMediaDocked:e,dockedTimelineObject:t,canAutoDock:n})=>(e&&t&&this.logDockEvent(i.R.UndockElement,t,!1,n),{isMediaDocked:!1}))}),s()(this,"clearDockedInfo",()=>this.setState({dockedTimelineObject:null,reparentableMediaManager:null,canAutoDock:!1})),s()(this,"setDockedTimelineObject",e=>this.setState({dockedTimelineObject:e})),s()(this,"getId",()=>this.idGen.next()),s()(this,"logDockEvent",(e,t,n,a)=>{let{appContext:{logEvent:s},adContext:{adPlacementConfiguration:r,hydraConfigInstanceId:o}}=this.props;s({eventName:e,eventDetails:{is_auto_dock_event:n,can_auto_dock:a,...t.placementId&&{placement_id:t.placementId},...(0,u._)({adPlacementConfiguration:r,hydraConfigInstanceId:o,timelineObject:t})}})})}render(){return/*#__PURE__*/(0,m.jsx)(c.bx.Provider,{value:this.getDockableContextValue(this.state),children:this.props.children})}}let p=(0,l.bb)(h,{appContext:!0,adContext:!0})}}]);