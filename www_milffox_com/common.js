/* Suggest */
if(typeof bsn=="undefined")_b=bsn={};if(typeof _b.Autosuggest=="undefined")_b.Autosuggest={};_b.AutoSuggest=function(e,t){if(!document.getElementById)return 0;this.fld=_b.DOM.gE(e);if(!this.fld)return 0;this.sInp="";this.nInpC=0;this.aSug=[];this.iHigh=0;this.oP=t?t:{};var n,r={minchars:1,meth:"get",script:"/show_suggest.php?json=true&",varname:"q",className:"autosuggest",timeout:2500,delay:200,offsety:-5,shownoresults:false,noresults:"",maxheight:250,cache:true,json:true,maxentries:10};for(n in r){if(typeof this.oP[n]!=typeof r[n])this.oP[n]=r[n]}var i=this;this.fld.onkeypress=function(e){return i.onKeyPress(e)};this.fld.onkeyup=function(e){return i.onKeyUp(e)};this.fld.setAttribute("autocomplete","off")};_b.AutoSuggest.prototype.onKeyPress=function(e){var t=window.event?window.event.keyCode:e.keyCode;var n=13;var r=9;var i=27;var s=1;switch(t){case n:this.setHighlightedValue();s=0;break;case i:this.clearSuggestions();break}return s};_b.AutoSuggest.prototype.onKeyUp=function(e){var t=window.event?window.event.keyCode:e.keyCode;var n=38;var r=40;var i=27;var s=1;switch(t){case n:this.changeHighlight(t);s=0;break;case r:this.changeHighlight(t);s=0;break;case i:this.clearSuggestions();break;default:this.getSuggestions(this.fld.value)}return s};_b.AutoSuggest.prototype.getSuggestions=function(e){if(e==this.sInp)return 0;_b.DOM.remE(this.idAs);this.sInp=e;if(e.length<this.oP.minchars){this.aSug=[];this.nInpC=e.length;return 0}var t=this.nInpC;this.nInpC=e.length?e.length:0;var n=this.aSug.length;if(this.nInpC>t&&n&&n<this.oP.maxentries&&this.oP.cache){var r=[];for(var i=0;i<n;i++){if(this.aSug[i].value.substr(0,e.length).toLowerCase()==e.toLowerCase())r.push(this.aSug[i])}this.aSug=r;this.createList(this.aSug);return false}else{var s=this;var o=this.sInp;clearTimeout(this.ajID);this.ajID=setTimeout(function(){s.doAjaxRequest(o)},this.oP.delay)}return false};_b.AutoSuggest.prototype.doAjaxRequest=function(e){if(e!=this.fld.value)return false;var t=this;if(typeof this.oP.script=="function")var n=this.oP.script(encodeURIComponent(this.sInp));else var n=this.oP.script+this.oP.varname+"="+encodeURIComponent(this.sInp);if(!n)return false;var r=this.oP.meth;var e=this.sInp;var i=function(n){t.setSuggestions(n,e)};var s=function(e){};var o=new _b.Ajax;o.makeRequest(n,r,i,s)};_b.AutoSuggest.prototype.setSuggestions=function(req,input){if(input!=this.fld.value)return false;this.aSug=[];if(this.oP.json){var jsondata=eval("("+req.responseText+")");for(var i=0;i<jsondata.results.length;i++){this.aSug.push({id:jsondata.results[i].id,value:jsondata.results[i].value,info:jsondata.results[i].info})}}else{var xml=req.responseXML;var results=xml.getElementsByTagName("results")[0].childNodes;for(var i=0;i<results.length;i++){if(results[i].hasChildNodes())this.aSug.push({id:results[i].getAttribute("id"),value:results[i].childNodes[0].nodeValue,info:results[i].getAttribute("info")})}}this.idAs="as_"+this.fld.id;this.createList(this.aSug)};_b.AutoSuggest.prototype.createList=function(e){var t=this;_b.DOM.remE(this.idAs);this.killTimeout();if(e.length==0&&!this.oP.shownoresults)return false;var n=_b.DOM.cE("div",{id:this.idAs,className:this.oP.className});var r=_b.DOM.cE("div",{className:"as_header"});n.appendChild(r);var i=_b.DOM.cE("ul",{id:"as_ul"});var s=this.sInp.toLowerCase().split(/\W+/);var o=s.length;for(var u=0;u<e.length;u++){var a=e[u].value;var f=a;for(var l=0;l<o;l++){var c=f.toLowerCase().indexOf(s[l]);if(c!==-1){f=f.substring(0,c)+"<em>"+f.substring(c,c+s[l].length)+"</em>"+f.substring(c+s[l].length)}}var h=_b.DOM.cE("span",{},f,true);var p=_b.DOM.cE("a",{href:"#"});p.appendChild(h);p.name=u+1;p.onclick=function(){t.setHighlightedValue();return false};p.onmouseover=function(){t.setHighlight(this.name)};var d=_b.DOM.cE("li",{},p);i.appendChild(d)}n.appendChild(i);var v=_b.DOM.cE("div",{className:"as_footer"});n.appendChild(v);var m=_b.DOM.getPos(this.fld);n.style.left=m.x+"px";n.style.top=m.y+this.fld.offsetHeight+this.oP.offsety+"px";n.style.width=this.fld.offsetWidth+"px";n.onmouseover=function(){t.killTimeout()};n.onmouseout=function(){t.resetTimeout()};document.getElementsByTagName("body")[0].appendChild(n);this.iHigh=0;var t=this;this.toID=setTimeout(function(){t.clearSuggestions()},this.oP.timeout)};_b.AutoSuggest.prototype.changeHighlight=function(e){var t=_b.DOM.gE("as_ul");if(!t)return false;var n;if(e==40)n=this.iHigh+1;else if(e==38)n=this.iHigh-1;if(n>t.childNodes.length)n=1;if(n<1)n=t.childNodes.length;this.setHighlight(n);this.sInp=this.fld.value=this.aSug[this.iHigh-1].value;this.fld.focus();if(this.fld.selectionStart)this.fld.setSelectionRange(this.sInp.length,this.sInp.length)};_b.AutoSuggest.prototype.setHighlight=function(e){var t=_b.DOM.gE("as_ul");if(!t)return false;if(this.iHigh>0)this.clearHighlight();this.iHigh=Number(e);t.childNodes[this.iHigh-1].className="as_highlight";this.killTimeout()};_b.AutoSuggest.prototype.clearHighlight=function(){var e=_b.DOM.gE("as_ul");if(!e)return false;if(this.iHigh>0){e.childNodes[this.iHigh-1].className="";this.iHigh=0}};_b.AutoSuggest.prototype.setHighlightedValue=function(){if(this.iHigh){this.sInp=this.fld.value=this.aSug[this.iHigh-1].value;this.fld.focus();if(this.fld.selectionStart)this.fld.setSelectionRange(this.sInp.length,this.sInp.length);this.clearSuggestions();if(typeof this.oP.callback=="function")this.oP.callback(this.aSug[this.iHigh-1])}};_b.AutoSuggest.prototype.killTimeout=function(){clearTimeout(this.toID)};_b.AutoSuggest.prototype.resetTimeout=function(){clearTimeout(this.toID);var e=this;this.toID=setTimeout(function(){e.clearSuggestions()},1e3)};_b.AutoSuggest.prototype.clearSuggestions=function(){this.killTimeout();var e=_b.DOM.gE(this.idAs);var t=this;if(e){var n=new _b.Fader(e,1,0,100,function(){_b.DOM.remE(t.idAs)})}};if(typeof _b.Ajax=="undefined")_b.Ajax={};_b.Ajax=function(){this.req={};this.isIE=false};_b.Ajax.prototype.makeRequest=function(e,t,n,r){if(t!="POST")t="GET";this.onComplete=n;this.onError=r;var i=this;if(window.XMLHttpRequest){this.req=new XMLHttpRequest;this.req.onreadystatechange=function(){i.processReqChange()};this.req.open("GET",e,true);this.req.send(null)}else if(window.ActiveXObject){this.req=new ActiveXObject("Microsoft.XMLHTTP");if(this.req){this.req.onreadystatechange=function(){i.processReqChange()};this.req.open(t,e,true);this.req.send()}}};_b.Ajax.prototype.processReqChange=function(){if(this.req.readyState==4){if(this.req.status==200){this.onComplete(this.req)}else{this.onError(this.req.status)}}};if(typeof _b.DOM=="undefined")_b.DOM={};_b.DOM.cE=function(e,t,n,r){var i=document.createElement(e);if(!i)return 0;for(var s in t)i[s]=t[s];var o=typeof n;if(o=="string"&&!r)i.appendChild(document.createTextNode(n));else if(o=="string"&&r)i.innerHTML=n;else if(o=="object")i.appendChild(n);return i};_b.DOM.gE=function(e){var t=typeof e;if(t=="undefined")return 0;else if(t=="string"){var n=document.getElementById(e);if(!n)return 0;else if(typeof n.appendChild!="undefined")return n;else return 0}else if(typeof e.appendChild!="undefined")return e;else return 0};_b.DOM.remE=function(e){var t=this.gE(e);if(!t)return 0;else if(t.parentNode.removeChild(t))return true;else return 0};_b.DOM.getPos=function(e){var e=this.gE(e);var t=e;var n=0;if(t.offsetParent){while(t.offsetParent){n+=t.offsetLeft;t=t.offsetParent}}else if(t.x)n+=t.x;var t=e;var r=0;if(t.offsetParent){while(t.offsetParent){r+=t.offsetTop;t=t.offsetParent}}else if(t.y)r+=t.y;return{x:n,y:r}};if(typeof _b.Fader=="undefined")_b.Fader={};_b.Fader=function(e,t,n,r,i){if(!e)return 0;this.e=e;this.from=t;this.to=n;this.cb=i;this.nDur=r;this.nInt=50;this.nTime=0;var s=this;this.nID=setInterval(function(){s._fade()},this.nInt)};_b.Fader.prototype._fade=function(){this.nTime+=this.nInt;var e=Math.round(this._tween(this.nTime,this.from,this.to,this.nDur)*100);var t=e/100;if(this.e.filters){try{this.e.filters.item("DXImageTransform.Microsoft.Alpha").opacity=e}catch(n){this.e.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+e+")"}}else{this.e.style.opacity=t}if(this.nTime==this.nDur){clearInterval(this.nID);if(this.cb!=undefined)this.cb()}};_b.Fader.prototype._tween=function(e,t,n,r){return t+(n-t)*(e/r)}
