"use strict";(self.webpackChunk_spotim_launcher=self.webpackChunk_spotim_launcher||[]).push([[985],{29759:(e,o,n)=>{n.d(o,{l:()=>a});var t=n(46897),i=n.n(t);let r=[];const a=e=>{r.push(e),l()},l=()=>{r.length>0&&(window.Y.SandBox.vendor.msg(JSON.stringify({type:"spotim",messages:r}),i().safeframe.regKey)?r=[]:setTimeout((()=>{l()}),210))}},41708:(e,o,n)=>{n.r(o),n.d(o,{getHostUrl:()=>Z,getSafeframeSizes:()=>j,initSafeFrameSupport:()=>C,isFullScreen:()=>F,observeFrameSize:()=>k});var t=n(96682),i=n(91033),r=n(46897),a=n.n(r),l=n(70655),s=n(29759);const d={expandInProgress:!1,expandFailedSynchronously:!1},c=new Map,v="ow-safeframe-expanded",u="ow-safeframe-collapsed";function f({isFullScreenMode:e=!1,contentToObserve:o,data:n}){var t,i,r,l,s,d;const c=null==o?void 0:o.getBoundingClientRect().height,v=a().safeframe.prevScrollHeight||0;!e&&(c>v+15||c<v-15)&&"expanded"!==(null===(i=null===(t=null===window||void 0===window?void 0:window.$sf)||void 0===t?void 0:t.ext)||void 0===i?void 0:i.status())&&window.$sf.ext.resizeTo({h:c,key:a().safeframe.regKey});const u=null===(l=null===(r=null==n?void 0:n.info)||void 0===r?void 0:r.win)||void 0===l?void 0:l.h,f=null===(d=null===(s=null==n?void 0:n.info)||void 0===s?void 0:s.win)||void 0===d?void 0:d.w;e&&u===a().safeframe.prevWinWidth&&f===a().safeframe.prevWinHeight&&(window.$sf.ext.resizeTo({h:u-(a().safeframe.closeBarHeight||0),w:f,key:a().safeframe.regKey}),window.spotimSafeframe.prevWinHeight=u,window.spotimSafeframe.prevWinWidth=f,a().safeframe.prevWinHeight=u,a().safeframe.prevWinWidth=f)}const g=e=>{var o,n,t,i,r;e.forceExpand&&0===e.b&&0===e.t&&(e.b=350,e.t=350);const a=null===(n=null===(o=null===window||void 0===window?void 0:window.$sf)||void 0===o?void 0:o.ext)||void 0===n?void 0:n.status();if("expanding"!==a&&"expanded"!==a&&"collapsing"!==a){if(d.expandInProgress=!0,null===(r=null===(i=null===(t=window.$sf)||void 0===t?void 0:t.ext)||void 0===i?void 0:i.expand)||void 0===r||r.call(i,e),d.expandInProgress=!1,!d.expandFailedSynchronously&&e.t&&e.b){const o=document.getElementById("fc_align");o&&(o.style.top=`${e.t}px`)}return new Promise((e=>{const o=()=>{e(!0),document.removeEventListener(v,o)};d.expandFailedSynchronously&&(d.expandFailedSynchronously=!1,o()),d.expandFailedSynchronously?(d.expandFailedSynchronously=!1,o()):document.addEventListener(v,o)}))}return Promise.resolve()},m=()=>{var e,o,n,t,i;const r=null===(o=null===(e=null===window||void 0===window?void 0:window.$sf)||void 0===e?void 0:e.ext)||void 0===o?void 0:o.status();return"collapsed"!==r&&"collapsing"!==r?(null===(i=null===(t=null===(n=window.$sf)||void 0===n?void 0:n.ext)||void 0===t?void 0:t.collapse)||void 0===i||i.call(t),new Promise((e=>{const o=()=>{e(!0),document.removeEventListener(u,o)};document.addEventListener(u,o),setTimeout((()=>{o()}),2500)}))):Promise.resolve()},p=e=>{e?(0,s.l)({action:"scroll-lock"}):(0,s.l)({action:"scroll-release"})},w="geom-update";let S=!1;const _=()=>(0,l.mG)(void 0,void 0,void 0,(function*(){return new Promise((e=>{if(!S)return e(!0);{const o=()=>{S=!1,document.removeEventListener(w,o),e(!0)};document.addEventListener(w,o),setTimeout(o,2e3)}}))})),h=()=>{S=!0;const e=()=>{S=!1,document.removeEventListener(w,e)};document.addEventListener(w,e)},y=e=>{const o=()=>{window.SPOTIM.startSSO(Object.assign({callback:(e,o)=>{const n={action:"sso_code_a",args:{code_a:e}};(0,s.l)(n),window.SPOTIM.completeSSOCallback=e=>o(e)}},e)).then((e=>{(0,s.l)({action:"sso_login_success",args:{userData:e}})})).catch((e=>{(0,s.l)({action:"sso_login_error",args:{reason:e}})}))};window.SPOTIM&&window.SPOTIM.startSSO?o():document.addEventListener("spot-im-api-ready",o,!1)};var O=n(85721);const b=(()=>{const e=navigator.userAgent;let o,n=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1]||"")?(o=/\brv[ :]+(\d+)/g.exec(e)||[],{name:"IE",version:o[1]||""}):"Chrome"===n[1]&&(o=e.match(/\bOPR|Edge\/(\d+)/),null!=o)?{name:"Opera",version:o[1]}:(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(o=e.match(/version\/(\d+)/i))&&n.splice(1,1,o[1]||""),{name:n[0],version:n[1]})})(),T=(e,o)=>{var n;const t=localStorage.getItem,i=localStorage.setItem,r=localStorage.removeItem;function a(){const o=E();localStorage.length<1&&o.length>0&&(o.forEach((([e,o])=>{i.apply(localStorage,[String(e),String(o)])})),e.error("restoreLocalStorage","local storage deleted during runtime",{safe_frame:"true",browser_type:`${b.name}-${b.version}`}))}window.__SPOTIM__.tempStorage=null!==(n=window.__SPOTIM__.tempStorage)&&void 0!==n?n:{};try{localStorage.__proto__=Object.assign(Object.create(localStorage.__proto__),{getItem(...e){const[n]=e;if(P(o).includes(n)){const e=window.__SPOTIM__.tempStorage[n];return void 0===e?null:e}return a(),t.apply(this,e)},setItem(...e){const[n,t]=e;if(P(o).includes(n))return void(window.__SPOTIM__.tempStorage[n]=t);a(),i.apply(this,e),window.__SPOTIM__.localStorageCopy=Object.assign({},localStorage);const r=I(localStorage,o);(0,s.l)({action:"storage_update",args:{storage:r}})},removeItem(...e){a(),r.apply(this,e),window.__SPOTIM__.localStorageCopy=Object.assign({},localStorage);const n=I(localStorage,o);(0,s.l)({action:"storage_update",args:{storage:n}})}})}catch(o){e.error("SAFEFRAME - sync local storage",o)}};function E(){return Object.entries(window.__SPOTIM__.localStorageCopy||{})}function I(e,o){var n,t,i;const r=null!==(i=null===(t=null===(n=o.tenant_config)||void 0===n?void 0:n.safe_frame)||void 0===t?void 0:t.whitelist_local_storage_keys)&&void 0!==i?i:["SPOTIM_DEVICE_UUID_V2","SPOTIM_DEVICE_V2"];return Object.entries(e).filter((([e])=>r.includes(e))).reduce(((e,[o,n])=>Object.assign(Object.assign({},e),{[o]:n})),{})}function P(e){var o,n,t,i;return null!==(i=null===(t=null===(n=null===(o=null==e?void 0:e._data)||void 0===o?void 0:o.tenant_config)||void 0===n?void 0:n.safe_frame)||void 0===t?void 0:t.window_storage_keys)&&void 0!==i?i:["SPOTIM_ACCESS_TOKEN"]}var M=n(87204),x=n(39423);const j=e=>{var o,n;return{height:null===(o=null==e?void 0:e.dataset)||void 0===o?void 0:o.safeframeHeight,width:null===(n=null==e?void 0:e.dataset)||void 0===n?void 0:n.safeframeWidth}},F=e=>{var o;return"true"===(null===(o=null==e?void 0:e.dataset)||void 0===o?void 0:o.isFullScreen)},Z=()=>{const e=new URL(window.$sf.ext.meta("hostUrl","OpenWeb")||document.referrer||location.href);if(document.referrer&&e.href!==document.referrer)for(const[o,n]of new URL(document.referrer).searchParams)e.searchParams.has(o)||e.searchParams.set(o,n);return e.toString()},k=(e,o)=>{const n=F(e),r=(0,t.Z)(f,700);new i.Z((()=>{r({isFullScreenMode:n,contentToObserve:o})})).observe(o),document.addEventListener("click",(function(){setTimeout((()=>f({isFullScreenMode:n,contentToObserve:o})),500)}))},C=(e,o)=>{var n,t,i,r,S;let b=!1;((e,o)=>{const n=new O.y(e,"launcher_safeframe",{version:"v3.28.0",apm:{threshold:100}});(e=>{const o=window.$sf.ext.meta("localStorage","OpenWeb");if(o)try{const e=JSON.parse(o);window.__SPOTIM__.localStorageCopy=Object.assign({},localStorage),Object.entries(e).forEach((([e,o])=>{var n;const t=E();if(!localStorage.length&&t.length&&t.forEach((([e,o])=>{localStorage.setItem(e,String(o))})),"SPOTIM_REPORTED_COMMENTS"===e){const t=null===(n=window.__SPOTIM__.localStorageCopy)||void 0===n?void 0:n.SPOTIM_REPORTED_COMMENTS,i=Object.assign(Object.assign({},JSON.parse(String(o))),JSON.parse(String(t)));localStorage.setItem(e,JSON.stringify(i)),window.__SPOTIM__.localStorageCopy[e]=JSON.stringify(i)}else localStorage.setItem(e,String(o)),window.__SPOTIM__.localStorageCopy[e]=String(o)}))}catch(o){e.error("SAFEFRAME - parse host local storage",o)}})(n),T(n,o)})((0,M.B)(o),o),window.SPOTIM=Object.assign(Object.assign({},window.SPOTIM),{startSafeframeSso:y});const I=F(e),P=document.getElementById("fc_align")||document.querySelector("[data-spotim-default-areas]")||(null==e?void 0:e.parentElement)||document.body;I||(k(e,P),document.body.ontouchmove=h);const C={prevScrollHeight:P.getBoundingClientRect().height,regKey:void 0,sendMessageToHost:s.l,hostUrl:Z(),isFullScreen:I,modalMarginCompensationDesktop:150,modalMarginCompensationMobile:0,expand:g,collapse:m,isGeomUpdated:_,lockBodyScroll:p};window.spotimSafeframe=C,a().safeframe=C,(0,x.Z)(e);const W=j(e),$=parseInt(W.height||"0");window.spotimSafeframe.prevScrollHeight=$,a().safeframe.prevScrollHeight=$,window.$sf.ext.register(W.width,W.height,(function(e,o){var n,t,i,r;switch(e){case"register":case"register-update":{const e=null==o?void 0:o.key;window.spotimSafeframe.regKey=e,a().safeframe.regKey=e,b||(document.addEventListener("spot-im-api-ready",(()=>{(0,s.l)({action:"sso_api_ready"})})),document.addEventListener("spot-im-renew-sso",(()=>{(0,s.l)({action:"spot-im-renew-sso"})})),b=!0);break}case"geom-update":document.dispatchEvent(new Event(w,o)),f({isFullScreenMode:I,contentToObserve:P,data:o});break;case"resize-to":!function(e){var o;const n=parseInt(null===(o=null==e?void 0:e.info)||void 0===o?void 0:o.h);window.spotimSafeframe.prevScrollHeight=n,a().safeframe.prevScrollHeight=n,(0,s.l)({action:"spotim_event",args:{type:"safeframe-resize",params:null==e?void 0:e.info}})}(o);break;case"cmsg":case"meta-update":!function(e){var o,n,t,i,r,a;(0,l.mG)(this,void 0,void 0,(function*(){const l=(null===(n=null===(o=null==e?void 0:e.info)||void 0===o?void 0:o.shared)||void 0===n?void 0:n.openWeb)||(null==e?void 0:e.value);if(!l)return;const d=JSON.parse(l),{id:v,type:u,action:f,args:g}=d;var m;if(m=v||"",!c.get(m)&&(c.set(m,!0),1)&&"string"==typeof u&&"string"==typeof f)try{"SPOTIM"===u?"resizeSafeframeWidth"===f?window.$sf.ext.resizeTo({w:g}):yield null===(i=null===(t=null===window||void 0===window?void 0:window.SPOTIM)||void 0===t?void 0:t[f])||void 0===i?void 0:i.call(t,g):yield null===(a=null===(r=null===window||void 0===window?void 0:window.__SPOTIM__)||void 0===r?void 0:r[f])||void 0===a?void 0:a.call(r,g)}catch(e){(0,s.l)({action:"spotim_error",args:{type:`${u}-${f}`,error:`${e}`}})}}))}(o);break;case"focus-change":!function(e){var o,n;(null==e?void 0:e.info)&&(null===(n=null===(o=document.elementFromPoint(1,1))||void 0===o?void 0:o.click)||void 0===n||n.call(o))}(o);break;case"expanded":document.dispatchEvent(new Event(v));break;case"collapsed":document.dispatchEvent(new Event(u)),(null===(t=null===(n=window.__OPEN_WEB__)||void 0===n?void 0:n.safeFramePopoverList)||void 0===t?void 0:t.length)&&g(null===(r=null===(i=null===window||void 0===window?void 0:window.__OPEN_WEB__)||void 0===i?void 0:i.safeFramePopoverList[0])||void 0===r?void 0:r.expandData);break;case"failed":d.expandInProgress&&(d.expandFailedSynchronously=!0)}}));const N=null===(t=null===(n=null===window||void 0===window?void 0:window.$sf)||void 0===n?void 0:n.ext)||void 0===t?void 0:t.geom(),L={prevWinHeight:null===(i=null==N?void 0:N.win)||void 0===i?void 0:i.h,prevWinWidth:null===(r=null==N?void 0:N.win)||void 0===r?void 0:r.w,closeBarHeight:(null===(S=null==N?void 0:N.win)||void 0===S?void 0:S.h)-parseInt(W.height||"0")};window.spotimSafeframe=Object.assign(Object.assign({},window.spotimSafeframe),L),a().safeframe=Object.assign(Object.assign({},a().safeframe),L)}},17685:(e,o,n)=>{n.d(o,{Z:()=>t});const t=n(66092).Z.Symbol},13243:(e,o,n)=>{n.d(o,{Z:()=>c});var t=n(17685),i=Object.prototype,r=i.hasOwnProperty,a=i.toString,l=t.Z?t.Z.toStringTag:void 0;var s=Object.prototype.toString;var d=t.Z?t.Z.toStringTag:void 0;const c=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":d&&d in Object(e)?function(e){var o=r.call(e,l),n=e[l];try{e[l]=void 0;var t=!0}catch(e){}var i=a.call(e);return t&&(o?e[l]=n:delete e[l]),i}(e):function(e){return s.call(e)}(e)}},13413:(e,o,n)=>{n.d(o,{Z:()=>t});const t="object"==typeof global&&global&&global.Object===Object&&global},66092:(e,o,n)=>{n.d(o,{Z:()=>r});var t=n(13413),i="object"==typeof self&&self&&self.Object===Object&&self;const r=t.Z||i||Function("return this")()},96682:(e,o,n)=>{n.d(o,{Z:()=>w});var t=n(77226),i=n(66092);const r=function(){return i.Z.Date.now()};var a=/\s/;var l=/^\s+/;const s=function(e){return e?e.slice(0,function(e){for(var o=e.length;o--&&a.test(e.charAt(o)););return o}(e)+1).replace(l,""):e};var d=n(72714),c=/^[-+]0x[0-9a-f]+$/i,v=/^0b[01]+$/i,u=/^0o[0-7]+$/i,f=parseInt;const g=function(e){if("number"==typeof e)return e;if((0,d.Z)(e))return NaN;if((0,t.Z)(e)){var o="function"==typeof e.valueOf?e.valueOf():e;e=(0,t.Z)(o)?o+"":o}if("string"!=typeof e)return 0===e?e:+e;e=s(e);var n=v.test(e);return n||u.test(e)?f(e.slice(2),n?2:8):c.test(e)?NaN:+e};var m=Math.max,p=Math.min;const w=function(e,o,n){var i,a,l,s,d,c,v=0,u=!1,f=!1,w=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function S(o){var n=i,t=a;return i=a=void 0,v=o,s=e.apply(t,n)}function _(e){var n=e-c;return void 0===c||n>=o||n<0||f&&e-v>=l}function h(){var e=r();if(_(e))return y(e);d=setTimeout(h,function(e){var n=o-(e-c);return f?p(n,l-(e-v)):n}(e))}function y(e){return d=void 0,w&&i?S(e):(i=a=void 0,s)}function O(){var e=r(),n=_(e);if(i=arguments,a=this,c=e,n){if(void 0===d)return function(e){return v=e,d=setTimeout(h,o),u?S(e):s}(c);if(f)return clearTimeout(d),d=setTimeout(h,o),S(c)}return void 0===d&&(d=setTimeout(h,o)),s}return o=g(o)||0,(0,t.Z)(n)&&(u=!!n.leading,l=(f="maxWait"in n)?m(g(n.maxWait)||0,o):l,w="trailing"in n?!!n.trailing:w),O.cancel=function(){void 0!==d&&clearTimeout(d),v=0,i=c=a=d=void 0},O.flush=function(){return void 0===d?s:y(r())},O}},77226:(e,o,n)=>{n.d(o,{Z:()=>t});const t=function(e){var o=typeof e;return null!=e&&("object"==o||"function"==o)}},18533:(e,o,n)=>{n.d(o,{Z:()=>t});const t=function(e){return null!=e&&"object"==typeof e}},72714:(e,o,n)=>{n.d(o,{Z:()=>r});var t=n(13243),i=n(18533);const r=function(e){return"symbol"==typeof e||(0,i.Z)(e)&&"[object Symbol]"==(0,t.Z)(e)}}}]);