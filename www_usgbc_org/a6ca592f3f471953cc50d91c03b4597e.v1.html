<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>a6ca592f3f471953cc50d91c03b4597e.v1.html</title>
</head>
<body>

<script>
const platformApi={apiVersion:"v2",baseDomain:document.currentScript.src.split("/OAuthClient")[0],callerId:"a6ca592f3f471953cc50d91c03b4597e",origin:"https://www.usgbc.org",deviceId:localStorage.getItem("__platformApi_di"),redirectUrl:document.location.href,monitorInterval:1e4,monitorKey:localStorage.getItem("__platformApi_mk"),tokenChecked:null,noAuthUrl:!1,params:{},onReady:{cb:null,payload:{}},profileUpdate:{on:localStorage.getItem("__platformApi_pu"),ack:!1},_silentChecked:null,request(a,b){return new Request(this.baseDomain+"/"+this.apiVersion+"/json"+b,{method:a,mode:"cors",cache:"no-store",referrerPolicy:"strict-origin-when-cross-origin",credentials:"include",headers:{Authorization:"Basic "+this.authInfo().token,"X-Caller-Id":this.callerId}})},makeCall(a,b){fetch(a).then(a=>{a.json().then(c=>{const d={status:a.status,headers:{},data:c};for(const b of a.headers.entries())/^x-api/.test(b[0])&&(d.headers[b[0]]=b[1]);b(d)})})},setDeviceId(a){a.deviceId&&this.deviceId!=a.deviceId&&(this.deviceId=a.deviceId,localStorage.setItem("__platformApi_di",a.deviceId))},authInfo:(()=>{let a=null;return function(){return arguments&&"object"==typeof arguments[0]&&(a=arguments[0]),a}})(),_oAuthClientRequest(a){const b=new Request(this.baseDomain+"/OAuthClient"+a,{method:"GET",mode:"cors",cache:"no-store",referrerPolicy:"strict-origin-when-cross-origin",credentials:"include",redirect:"follow"});this.makeCall(b,a=>{const b=a.data;if(b.status&&"undefined"!=typeof b[b.status]&&platformApi.setDeviceId(b[b.status]),"logged"==b.status){platformApi.tokenChecked=new Date().getTime();let a={token:b.logged.token};b.logged.clientKey&&(a.clientKey=b.logged.clientKey),platformApi.authInfo(a),platformApi.monitorKey=b.logged.monitorKey,localStorage.setItem("__platformApi_mk",b.logged.monitorKey),platformApi.onLogged(a),platformApi._checkSession(!0)}else if("redirect"==b.status)b.redirect.silent?"fetch"==b.redirect.silent?fetch(b.redirect.url,{method:"GET",mode:"no-cors",cache:"no-store",referrerPolicy:"strict-origin-when-cross-origin",credentials:"include",redirect:"follow"}).then(()=>{platformApi._silentChecked="fetch",platformApi._oAuthClientRequest("/status?sdkVersion=v1&accessMode=ajax&callerId="+platformApi.callerId+"&deviceId="+platformApi.deviceId+"&noSilent=1&noAuthUrl="+(platformApi.noAuthUrl?1:0)+"&redirectUrl="+encodeURIComponent(platformApi.redirectUrl))}):document.location.href=b.redirect.url:platformApi.onRedirect({url:b.redirect.url});else if("error"==b.status)platformApi.onError({code:b.error.code,message:b.error.message});else if("tokenStatus"==b.status)if("dead"==b.tokenStatus){var c=!!platformApi.monitorKey;platformApi.monitorKey=null,localStorage.removeItem("__platformApi_mk"),c&&platformApi.onExternalLogout()}else b.authInfo&&platformApi.authInfo(b.authInfo),platformApi.tokenChecked||platformApi.onTokenChecked(platformApi.authInfo()),b.monitorKey&&(platformApi.monitorKey=b.monitorKey,localStorage.setItem("__platformApi_mk",b.monitorKey)),b.profileUpdate?((!platformApi.profileUpdate.on||platformApi.profileUpdate.on!==b.profileUpdate)&&(localStorage.setItem("__platformApi_pu",b.profileUpdate),platformApi.profileUpdate.on=b.profileUpdate,platformApi.profileUpdate.ack=!1),platformApi.onProfileUpdated(platformApi.profileUpdate)):platformApi.profileUpdate.on&&platformApi.profileUpdate.ack&&(localStorage.removeItem("__platformApi_pu"),platformApi.profileUpdate.on=null,platformApi.profileUpdate.ack=!1),platformApi.tokenChecked=new Date().getTime(),platformApi._checkSession(!0)})},boot:(()=>{let a=!1;return()=>{if(a)return!1;if(window.addEventListener("beforeunload",()=>{platformApi.monitorKey=null},!1),window.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,(a,b,c)=>{platformApi.params[b]=decodeURIComponent(c.replace(/\+/g,"%20"))}),"undefined"!=typeof platformApi.params.status){platformApi.setDeviceId(platformApi.params);let a=[];"logged"===platformApi.params.status?(platformApi.tokenChecked=new Date().getTime(),platformApi.monitorKey=platformApi.params.monitorKey,localStorage.setItem("__platformApi_mk",platformApi.params.monitorKey),platformApi.onReady.cb="onLogged",a=["token","clientKey"]):"redirect"===platformApi.params.status?(platformApi.onReady.cb="onRedirect",a=["url"],platformApi._silentChecked=platformApi.params.silent||"redirect"):"error"===platformApi.params.status?(platformApi.onReady.cb="onError",a=["code","message"]):"logoutCompleted"===platformApi.params.status&&(platformApi._silentChecked="logout"),a.forEach(a=>{"undefined"!=typeof platformApi.params[a]&&(platformApi.onReady.payload[a]=platformApi.params[a])}),["status","token","clientKey","monitorKey","url","silent","deviceId","machineId","code","message","responseFor"].forEach(a=>{"undefined"!=typeof platformApi.params[a]&&delete platformApi.params[a]});let b=platformApi.redirectUrl.split("?")[0];b=b.split("/"),platformApi.redirectUrl=b[0]+"//"+b[2],b.splice(0,3),b="/"+b.join("/");let c=[];for(const a in platformApi.params)c.push(a+"="+encodeURIComponent(platformApi.params[a]));c.length&&(b+="?"+c.join("&")),platformApi.redirectUrl+=b,window.history.replaceState(null,null,b)}return platformApi.deviceId?a=!0:void("undefined"==typeof platformApi.params.status&&(document.location.href=platformApi.baseDomain+"/OAuthClient/status?accessMode=check&callerId="+platformApi.callerId+"&noAuthUrl="+(platformApi.noAuthUrl?1:0)+"&redirectUrl="+encodeURIComponent(platformApi.redirectUrl)))}})(),_checkSessionMonitor:(()=>{let a=!1;return()=>!a&&(setInterval(()=>{if(platformApi.monitorKey){const a=new Date().getTime();platformApi.tokenChecked&&6e4<a-platformApi.tokenChecked&&platformApi._checkSession()}},5e3),a=!0)})(),_checkSession(a){if(this._checkSessionMonitor(),!0===a)return void setTimeout(()=>{this._checkSession()},this.monitorInterval);if(!this.monitorKey)return;1e4>this.monitorInterval&&(this.monitorInterval=1e4);const b=new Date().getTime();if(this.tokenChecked&&b-this.tokenChecked<this.monitorInterval)return this._checkSession(!0);let c="/checkToken?accessMode=ajax&monitorKey="+this.monitorKey;this.tokenChecked||(c+="&authInfo=1"),this.profileUpdate.on&&this.profileUpdate.ack&&(c+="&profileUpdate="+this.profileUpdate.on),this._oAuthClientRequest(c)},start:(()=>{let a=!1;return()=>{if(a)return!1;let b=!1;if(platformApi.onReady.cb){let a=!0;"onLogged"==platformApi.onReady.cb?(platformApi.authInfo(platformApi.onReady.payload),b=!0):"onRedirect"==platformApi.onReady.cb&&(platformApi._silentChecked?b=!0:a=!1),a&&platformApi[platformApi.onReady.cb](platformApi.onReady.payload),platformApi.onReady.cb=null,platformApi.onReady.payload={}}return platformApi.monitorKey?platformApi._checkSession():!b&&platformApi.deviceId&&(platformApi.onStatusCheck(),platformApi._oAuthClientRequest("/status?sdkVersion=v1&accessMode=ajax&callerId="+platformApi.callerId+"&deviceId="+platformApi.deviceId+"&noSilent="+(platformApi._silentChecked&&"logout"!==platformApi._silentChecked?1:0)+"&noAuthUrl="+(platformApi.noAuthUrl?1:0)+"&redirectUrl="+encodeURIComponent(platformApi.redirectUrl))),a=!0}})(),initialize:(()=>{let a=!1;return()=>!a&&(platformApi.start(),a=!0)})(),doLogout(a,b,c){this.monitorKey=null,localStorage.removeItem("__platformApi_mk");const d=this.request("GET","/invalidateToken");if(c)for(const a in c)d.headers.set(a,c[a]);this.makeCall(d,c=>{if("function"==typeof b)if(c.data&&c.data.redirect){let d=c.data.redirect;d+=/^https?:/.test(a)?encodeURIComponent(a):encodeURIComponent(document.location.protocol+"//"+document.location.host+a),b(d)}else b()})}};["onStatusCheck","onRedirect","onLogged","onError","onTokenChecked","onExternalLogout","onProfileUpdated"].forEach(a=>{platformApi[a]=(()=>{let a=null;return b=>"function"==typeof b?(a=b,!0):null===a?a:a(b)})()}),platformApi.boot();

</script>

</body>
</html>
