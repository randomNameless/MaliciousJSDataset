<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>venue-detail2-a609566cadd6bf373dc95550f2e5af7a.html</title>
</head>
<body>

<script>
fourSq.venue.util.TipImpressionLogger=function(a){};
fourSq.venue.util.TipImpressionLogger=fourSq.Class.extend({initialize:function(a){this.contentIdFunc_=a.contentIdFunc||function(a){return a.data("id")||null};this.contentImpressionLogger_=new fourSq.impressions.ContentImpressionLogger({section:fourSq.stats.action.Section.TIPS_SECTION});this.impressionMonitor_=new fourSq.ui.ImpressionMonitor(a.$el,a.selector,{revealPercent:50});this.impressionMonitor_.on(fourSq.ui.ImpressionMonitor.Events.FIRST_IMPRESSION,fourSq.bind(function(a){a=this.contentIdFunc_(a);
null!==a&&this.contentImpressionLogger_.log(a,"tip")},this));this.update()},update:function(){this.impressionMonitor_.update()}});
fourSq.ui.PaginationControl=function(a){};
fourSq.ui.PaginationControl=fourSq.ui.View.extend({initialize:function(a){fourSq.ui.PaginationControl.__super__.initialize.call(this,a);this.maxPages_=a.maxPages;this.currentPage_=1;this.pageRangePadding_=2;fourSq.isDefinedAndNotNull(a.pageRangePadding)&&(this.pageRangePadding_=a.pageRangePadding);this.$pagesEl_=this.$nextButtonEl_=this.$prevButtonEl_=null},decorate:function(){this.$pagesEl_=this.$el.find(".pages");this.$prevButtonEl_=this.$el.find(".prev");this.$prevButtonEl_.click(fourSq.bind(function(){this.setPage(this.currentPage_-
1)},this));this.$nextButtonEl_=this.$el.find(".next");this.$nextButtonEl_.click(fourSq.bind(function(){this.setPage(this.currentPage_+1)},this));this.updateButtons_();return this},show:function(){this.$el.show()},hide:function(){this.$el.hide()},reset:function(){this.currentPage_=1;this.updateButtons_()},setPage:function(a,b){1>a?a=1:a>this.maxPages_&&(a=this.maxPages_);this.currentPage_=a;this.updateButtons_();b||this.trigger(fourSq.ui.PaginationControl.Events.JUMP_TO_PAGE,a)},getPage:function(){return this.currentPage_},
setMaxPages:function(a){this.maxPages_=a;this.updateButtons_()},showNextButton_:function(){this.$nextButtonEl_.show()},hideNextButton_:function(){this.$nextButtonEl_.hide()},showPrevButton_:function(){this.$prevButtonEl_.show()},hidePrevButton_:function(){this.$prevButtonEl_.hide()},updateButtons_:function(){this.$pagesEl_.empty();var a=Math.max(this.currentPage_-this.pageRangePadding_,1),b=Math.min(this.currentPage_+this.pageRangePadding_,this.maxPages_);this.renderFirstPageButtonAndEllipsis_(a);
this.renderMainPageRange_(a,b);this.renderLastPageButtonAndEllipsis_(b);this.updatePreviousAndNextButtonVisibility_();this.$el.find(".page.page"+this.currentPage_).addClass("active");1>=this.maxPages_?this.hide():this.show()},renderFirstPageButtonAndEllipsis_:function(a){1<a&&(this.renderPaginationPageButton_(1),2<a&&this.renderPaginationEllipsis_())},renderMainPageRange_:function(a,b){for(var c=a;c<=b;c++)this.renderPaginationPageButton_(c)},renderLastPageButtonAndEllipsis_:function(a){a<this.maxPages_&&
(a<this.maxPages_-1&&this.renderPaginationEllipsis_(),this.renderPaginationPageButton_(this.maxPages_))},updatePreviousAndNextButtonVisibility_:function(){1===this.currentPage_?this.hidePrevButton_():this.showPrevButton_();this.currentPage_===this.maxPages_?this.hideNextButton_():this.showNextButton_()},renderPaginationPageButton_:function(a){var b=$(templates.fourSq.ui.pagination.paginationNumber({num:a}));b.click(fourSq.curry(this.setPage,this,a,!1));this.$pagesEl_.append(b)},renderPaginationEllipsis_:function(){this.$pagesEl_.append(templates.fourSq.ui.pagination.paginationEllipsis())}});
fourSq.ui.PaginationControl.Events={JUMP_TO_PAGE:"PaginationControl:JUMP_TO_PAGE"};fourSq.ui.PaginationControl.CalculateMaxPages=function(a,b){return Math.ceil(a/b)};"undefined"==typeof templates.fourSq&&(templates.fourSq={});"undefined"==typeof templates.fourSq.ui&&(templates.fourSq.ui={});"undefined"==typeof templates.fourSq.ui.pagination&&(templates.fourSq.ui.pagination={});
templates.fourSq.ui.pagination.paginationControl=function(a,b){a=a||{};var c='\x3cdiv class\x3d"paginationContainer"\x3e\x3cul class\x3d"pages"\x3e';if(a.maxPage&&a.currentPage)for(var d=a.maxPage+1,e=1;e<d;e++)c+=templates.fourSq.ui.pagination.paginationNumber({num:e,isActive:e==a.currentPage,path:a.path,queryString:a.queryString});return c+"\x3c/ul\x3e\x3c/div\x3e"};
templates.fourSq.ui.pagination.paginationNumber=function(a,b){return'\x3cli class\x3d"paginationComponent page page'+soy.$$escapeHtml(a.num)+" "+(a.isActive?"active":"")+'"\x3e'+(a.path?1==a.num?'\x3ca href\x3d"'+soy.$$escapeHtml(a.path)+soy.$$escapeHtml(null!=a.queryString?a.queryString:"")+'"\x3e'+soy.$$escapeHtml(a.num)+"\x3c/a\x3e":'\x3ca href\x3d"'+soy.$$escapeHtml(a.path)+"?page\x3d"+soy.$$escapeHtml(a.num)+soy.$$escapeHtml(null!=a.queryString?a.queryString:"")+'"\x3e'+soy.$$escapeHtml(a.num)+
"\x3c/a\x3e":soy.$$escapeHtml(a.num))+"\x3c/li\x3e"};templates.fourSq.ui.pagination.paginationEllipsis=function(a,b){return'\x3cli class\x3d"paginationComponent"\x3e...\x3c/li\x3e'};
fourSq.ui.dialog.DialogFrequencyCapper=function(a){};
fourSq.ui.dialog.DialogFrequencyCapper=fourSq.Class.extend({initialize:function(a){this.modal_=a.modal;this.name_=a.name;this.cap_=a.cap},show:function(){var a=this.shouldShow_(),b=!1;a&&(b=this.modal_.maybeShow())&&this.incrementShownCount_();return a&&b},incrementShownCount_:function(){var a=(this.getShownCount_()+1).toString();$.cookie(this.name_,a,{path:"/",expires:fourSq.ui.dialog.DialogFrequencyCapper.COOKIE_EXPIRATION_DAYS})},getShownCount_:function(){return parseInt($.cookie(this.name_),10)||
0},shouldShow_:function(){return"1"===fourSq.util.parseParams().ignoreFrequencyCap||this.getShownCount_()<this.cap_}},{COOKIE_EXPIRATION_DAYS:30,ModalNames:{IPAD_DOWNLOAD_MODAL:"dfc-ipd",MOBILE_VENUE_PAGE_MODAL_EXPERIMENT:"dfc-mwvpdme"}});fourSq.ui.dialog.IPadDownloadModal=function(a){};
fourSq.ui.dialog.IPadDownloadModal=fourSq.ui.dialog.Dialog.extend({initialize:function(a){fourSq.ui.dialog.IPadDownloadModal.__super__.initialize.call(this,{className:"largeModal richDownloadModal iPadDownloadModal".trim()});this.venue_=a.venue;this.tips_=a.tips},maybeShow:function(){return this.tips_.count>fourSq.ui.dialog.IPadDownloadModal.MIN_TIPS?(this.show(),this.logHelper_(fourSq.stats.action.Action.SHOW),!0):!1},baseLoggingInfo_:function(){var a=fourSq.api.models.companion.log.Oids.build({venueId:this.venue_.id});
return{section:fourSq.stats.action.Section.IPAD_DOWNLOAD_MODAL,ids:a}},logHelper_:function(a,b){var c=_.extend(this.baseLoggingInfo_(),b||{});fourSq.stats.logActions(fourSq.stats.Action.build(a,c))},renderContent:function(){var a=$(templates.fourSq.ui.downloadDialog.desktopDownloadModal({venue:this.venue_,tips:_.first(this.tips_.items,fourSq.ui.dialog.IPadDownloadModal.TIPS_TO_SHOW),tipCount:this.tips_.count}));this.container_.empty().append(a)},decorate:function(){fourSq.ui.dialog.IPadDownloadModal.__super__.decorate.call(this);
(new fourSq.util.mobile.NativeAppLinkWithFallback({el:this.$el.find(".downloadAppButton"),urlFactory:new fourSq.util.mobile.urlfactory.VenueUrlFactory({venueId:this.venue_.id}),loggingContext:_.extend(this.baseLoggingInfo_(),{element:fourSq.stats.action.Element.CONTINUE})})).decorate();this.$el.find(".noThanksButton").click(fourSq.bind(function(){this.close();this.logHelper_(fourSq.stats.action.Action.CLICK,{element:fourSq.stats.action.Element.NO_THANKS})},this))}},{TIPS_TO_SHOW:3,MIN_TIPS:5});fourSq.util.mobile.NativeAppLinkWithFallback=function(a){};
fourSq.util.mobile.NativeAppLinkWithFallback=fourSq.ui.View.extend({initialize:function(a){this.urlFactory_=a.urlFactory;this.linkMethod_=this.determineLinkMethod_(!!a.requireFallbackCapability);this.isNativeLinkCapable=this.linkMethod_!==fourSq.util.mobile.NativeAppLinkWithFallback.LinkMethod.FALLBACK;this.isRedirecting_=!1;this.loggingContext_=a.loggingContext;this.redirectFunction_=a.redirect||fourSq.util.redirect;this.customFallbackUrl_=a.customFallbackUrl;this.customCallback_=a.customCallback;
this.callbackName_=a.callbackName},decorate:function(){this.$el.click(fourSq.bind(this.attemptRedirect,this));return this},determineLinkMethod_:function(a){var b=fourSq.util.mobile.NativeAppLinkWithFallback.LinkMethod;return this.urlFactory_.supportedOnDevice()?fourSq.util.devices.isIPhone()||fourSq.util.devices.isIPad()||fourSq.util.devices.isWindowsPhone()?b.SCHEME_WITH_TIMEOUT:fourSq.util.devices.isAndroid()?!fourSq.util.devices.isChromeAndroidGte25()||fourSq.util.devices.isTwitterEmbed()||a?b.ANDROID_SCHEME:
b.ANDROID_INTENT:b.FALLBACK:b.FALLBACK},attemptRedirect:function(){var a=fourSq.util.mobile.NativeAppLinkWithFallback.LinkMethod;this.isRedirecting_||this.linkMethod_===a.FALLBACK?this.openFallback_():this.linkMethod_===a.ANDROID_SCHEME?this.attemptAndroidSchemeRedirect_():this.linkMethod_===a.ANDROID_INTENT?this.attemptAndroidIntentRedirect_():this.linkMethod_===a.SCHEME_WITH_TIMEOUT&&this.attemptTimeoutBasedSchemeRedirect_()},attemptAndroidSchemeRedirect_:function(){var a=!fourSq.util.devices.isTwitterEmbed()&&
!fourSq.util.devices.isChromeAndroidGte25();this.openNativeUrl_(this.urlFactory_.createNativeSchemeUrl(),a);_.delay(fourSq.bind(function(){!0===this.nativeOpenWasSuccessful_()||!fourSq.isUndefinedOrNull(document.webkitHidden)&&document.webkitHidden||this.openFallback_();this.reset_()},this),fourSq.util.mobile.NativeAppLinkWithFallback.ANDROID_SCHEME_REDIRECT_TIMEOUT)},attemptTimeoutBasedSchemeRedirect_:function(){var a,b=fourSq.bind(function(){fourSq.isDefinedAndNotNull(a)&&clearTimeout(a);this.$el.removeClass("opening");
this.reset_()},this);$(window).on("pagehide",b);var c=fourSq.util.devices.isIPhoneEmbedded()?fourSq.util.mobile.NativeAppLinkWithFallback.IOS_EMBEDDED_TIMEOUT:fourSq.util.devices.isChromeIos()?fourSq.util.mobile.NativeAppLinkWithFallback.IOS_CHROME_TIMEOUT:fourSq.util.mobile.NativeAppLinkWithFallback.SAFARI_TIMEOUT,d=+new Date+c+fourSq.util.mobile.NativeAppLinkWithFallback.TIMEOUT_CLOCKSYNC_ERROR_MARGIN,e=!0;fourSq.util.devices.isIos9()&&(e=!1);this.openNativeUrl_(this.urlFactory_.createNativeSchemeUrl(),
e);a=setTimeout(fourSq.bind(function(){!0!==this.nativeOpenWasSuccessful_()&&+new Date<=d?(this.openFallback_(),_.delay(b,300)):b()},this),c);this.$el.addClass("opening")},attemptAndroidIntentRedirect_:function(){this.openNativeUrl_(this.urlFactory_.createAndroidIntentUrl());this.reset_()},reset_:function(){this.isRedirecting_=!1;this.trigger(fourSq.util.mobile.NativeAppLinkWithFallback.Events.SUCCESS)},openNativeUrl_:function(a,b){this.openNativeUrlNoLogging_(a);this.isRedirecting_=!0;var c=fourSq.stats.Action.buildWithDefaults(fourSq.stats.action.Action.ATTEMPT_REDIRECT,
{element:fourSq.stats.action.Element.NATIVE_URL,details:{nativeUrl:a,referrerUrl:fourSq.signup.Logging.getRefSource()}},this.loggingContext_);b?fourSq.stats.logActionWithDelay(c,fourSq.curry(this.openInIframe_,this,a)):fourSq.stats.logActionWithDelay(c,fourSq.curry(this.redirectFunction_,this,a))},openInIframe_:function(a){var b=document.createElement("iframe");b.style.border="none";b.style.width="1px";b.style.height="1px";b.onload=fourSq.bind(this.reset_,this);b.src=a;document.body.appendChild(b)},
openFallback_:function(){this.reset_();var a=this.customFallbackUrl_||this.urlFactory_.createFallbackUrl(this.loggingContext_);try{a=fourSq.util.mobile.NativeAppLinkWithFallback.appendWsidToUrl(a)}catch(b){console.log(b)}var c,d;c=this.callbackName_?this.callbackName_:"";this.customCallback_?(d=fourSq.stats.action.Element.NATIVE_FALLBACK_CALLBACK,c={nativeLinkCapable:this.isNativeLinkCapable,fallback:"customCallback "+c,referrerUrl:fourSq.signup.Logging.getRefSource()}):(d=fourSq.stats.action.Element.NATIVE_FALLBACK_URL,
c={nativeLinkCapable:this.isNativeLinkCapable,fallbackUrl:a,referrerUrl:fourSq.signup.Logging.getRefSource()});d=fourSq.stats.Action.buildWithDefaults(fourSq.stats.action.Action.REDIRECT,{element:d,details:c},this.loggingContext_);c=this.customCallback_?this.customCallback_:fourSq.bind(function(){window.location.href=a},this);fourSq.stats.logActionWithDelay(d,c)},openNativeUrlNoLogging_:function(a){try{fourSq.util.mobile.NativeAppLinkWithFallback.appendWsidToUrl(a)}catch(b){console.log(b)}},nativeOpenWasSuccessful_:fourSq.emptyFunction},
{appendWsidToUrl:function(a){var b=fourSq.api.getSessionIdToken();a=a.split("#");var c=a[0].split("?"),b=(c[1]?"\x26":"")+"wsid\x3d"+b,d=function(a,b){return a?(b||"")+a:""};return d(c[0])+d(d(c[1])+d(b),"?")+d(a[1],"#")},ANDROID_SCHEME_REDIRECT_TIMEOUT:1E3,IOS_EMBEDDED_TIMEOUT:7500,IOS_CHROME_TIMEOUT:1E3,SAFARI_TIMEOUT:1E3,TIMEOUT_CLOCKSYNC_ERROR_MARGIN:50,Events:{SUCCESS:"success"}});
fourSq.util.mobile.NativeAppLinkWithFallback.LinkMethod={ANDROID_SCHEME:"android-scheme",ANDROID_INTENT:"android-intent",SCHEME_WITH_TIMEOUT:"scheme-with-timeout",FALLBACK:"fallback"};fourSq.util.mobile.urlfactory.VenueUrlFactory=function(a){};fourSq.util.mobile.urlfactory.VenueUrlFactory=fourSq.util.mobile.urlfactory.UrlFactory.extend({initialize:function(a){fourSq.util.mobile.urlfactory.VenueUrlFactory.__super__.initialize.call(this,a);this.venueId_=a.venueId},getModelType_:function(){return"venues"},getModelId_:function(){return this.venueId_}});
fourSq.opinionator.RateToast=function(a){};
fourSq.opinionator.RateToast=fourSq.ui.View.extend({scrollDelta_:10,initialize:function(a){this.appended_=!1;this.recentVenues_=a.recentVenues;this.venues_=_.map(a.recentVenues,function(a){return a.venue});this.permanentHide_=!1;this.lastScrollTop_=0;this.scrolled_=!1;this.intervalId_=null},render:function(){var a=templates.fourSq.opinionator.rateprompt.toast({venues:this.venues_});this.setEl_($(a));return this.decorate()},decorate:function(){$(window).scroll(fourSq.bind(function(a){this.scrolled_=!0},
this));this.intervalId_=setInterval(fourSq.bind(function(){this.scrolled_&&(10>$(window).scrollTop()?this.show($("body")):this.hide(!1),this.scrolled_=!1)},this),350);this.$el.find(".rate").click(fourSq.bind(function(a){a.preventDefault();a=new fourSq.opinionator.TipAfterRateDialog({opacity:.4,recentVenues:this.recentVenues_,className:"rateModal",isModal:!0,includeSkipOptions:!0});a.on(fourSq.ui.dialog.Dialog.Events.DIALOG_OPEN,fourSq.bind(function(){this.hide(!0)},this));a.show()},this));return this},
show:function(a){this.appended_||(this.appended_=!0,a.append(this.$el));this.permanentHide_||this.$el.animate({bottom:0})},hide:function(a){this.$el.animate({bottom:-(this.$el.height()+this.$el.innerHeight())});if(this.permanentHide_=a)this.$el.hide(),this.intervalId_&&window.clearInterval(this.intervalId_)}});fourSq.opinionator.LIKE="like";fourSq.opinionator.OK="ok";fourSq.opinionator.DISLIKE="dislike";fourSq.opinionator.RateDialog=function(a){};
fourSq.opinionator.RateDialog=fourSq.ui.dialog.Dialog.extend({initialize:function(a){fourSq.opinionator.RateDialog.__super__.initialize.apply(this,[a]);this.hasCloseButton_=!1;this.recentVenues_=a.recentVenues;this.venues_=_.map(this.recentVenues_,function(a){return a.venue});this.numVenues_=_.size(this.recentVenues_);this.venueIndex_=-1},decorate:function(){fourSq.opinionator.RateDialog.__super__.decorate.apply(this,[]);this.$el.find(".rateOptions .option").click(fourSq.bind(function(a){a=$(a.currentTarget);
var b=this.getCurrentVenue(),c=a.data("value"),d=!0;a.hasClass("clicked")?(a.removeClass("clicked"),d=!1):(a.parent().find(".clicked").removeClass("clicked"),a.addClass("clicked"));this.onRateClick(a,b,c,d)},this));this.$el.find(".skipOptions .option.notHere").click(fourSq.bind(function(a){a=$(a.target);var b=this.getCurrentRecentVenue();b.pcheckin&&b.pcheckin.id&&fourSq.api.services.Opinionator.denyRecent(b.pcheckin.id,fourSq.emptyFunction,fourSq.bind(this.onError,this));this.onNotHere(a,b.venue)},
this));this.$el.find(".skipOptions .option.skip").click(fourSq.bind(function(a){a=$(a.target);var b=this.getCurrentVenue();fourSq.api.services.Venue.noRate(b.id,fourSq.emptyFunction,fourSq.bind(this.onError,this));this.onSkip(a,b)},this))},getCurrentVenueIndex:function(){return this.venueIndex_},getCurrentVenue:function(){return this.venues_[this.getCurrentVenueIndex()]},getCurrentRecentVenue:function(){return this.recentVenues_[this.getCurrentVenueIndex()]},getCurrentVenueEl:function(){var a=this.getCurrentVenue();
return this.$el.find('.venueContent[data-id\x3d"'+a.id+'"]')},show:function(){fourSq.opinionator.RateDialog.__super__.show.apply(this,[]);this.showInitialVenue()},showInitialVenue:function(){this.venueIndex_=-1;this.showNextVenue(!1);this.resetUiState()},showNextVenue:function(a){var b=this.numVenues_-1;if(this.getCurrentVenueIndex()===b)this.showFinishMessage();else{var b=++this.venueIndex_,c=this.venues_[b];this.showVenue(c,a);a=fourSq.api.models.companion.log.Oids.build({venueId:c.id});a=fourSq.stats.Action.build(fourSq.stats.action.Action.IMPRESSION,
{view:fourSq.stats.action.View.NEW_LOGGED_IN_HOMEPAGE,component:fourSq.stats.action.Component.RATING_PROMPT,componentIndex:b,ids:a});fourSq.stats.logActions(a)}this.resetUiState()},resetUiState:function(){var a=this.getCurrentVenue();this.setVenueRateOption(a)},setVenueRateOption:function(a){a.like?this.$el.find(".rateSection .option.like").addClass("clicked"):a.ok?this.$el.find(".rateSection .option.okay").addClass("clicked"):a.dislike&&this.$el.find(".rateSection .option.dislike").addClass("clicked")},
onRateClick:function(a,b,c,d){a=null;c===fourSq.opinionator.LIKE?(a=fourSq.stats.action.Element.LIKE,fourSq.api.services.Venue.like(b.id,d,fourSq.bind(function(){this.clearVenueRating_(b);b.like=d;this.trigger(fourSq.opinionator.RateDialog.Events.RATED_LIKE,d)},this),fourSq.bind(this.onError,this))):c===fourSq.opinionator.OK?(a=fourSq.stats.action.Element.OK,fourSq.api.services.Venue.ok(b.id,d,fourSq.bind(function(){this.clearVenueRating_(b);b.ok=d;this.trigger(fourSq.opinionator.RateDialog.Events.RATED_OK,
d)},this),fourSq.bind(this.onError,this))):c===fourSq.opinionator.DISLIKE&&(a=fourSq.stats.action.Element.DISLIKE,fourSq.api.services.Venue.dislike(b.id,d,fourSq.bind(function(){this.clearVenueRating_(b);b.dislike=d;this.trigger(fourSq.opinionator.RateDialog.Events.RATED_DISLIKE,d)},this),fourSq.bind(this.onError,this)));a&&(c=fourSq.api.models.companion.log.Oids.build({venueId:this.getCurrentVenue().id}),c=fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,{view:fourSq.stats.action.View.NEW_LOGGED_IN_HOMEPAGE,
component:fourSq.stats.action.Component.RATING_PROMPT,componentIndex:this.getCurrentVenueIndex(),element:a,ids:c}),fourSq.stats.logActions(c))},clearVenueRating_:function(a){a.like=!1;a.ok=!1;a.dislike=!1},onSkip:function(a,b){fourSq.api.services.Venue.noRate(b.id,fourSq.emptyFunction,fourSq.emptyFunction);var c=fourSq.api.models.companion.log.Oids.build({venueId:this.getCurrentVenue().id}),c=fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,{view:fourSq.stats.action.View.NEW_LOGGED_IN_HOMEPAGE,
component:fourSq.stats.action.Component.RATING_PROMPT,componentIndex:this.getCurrentVenueIndex(),element:fourSq.stats.action.Element.IGNORE,ids:c});fourSq.stats.logActions(c)},onNotHere:function(a,b){fourSq.api.services.Opinionator.denyRecent(b.id,fourSq.emptyFunction,fourSq.emptyFunction);var c=fourSq.api.models.companion.log.Oids.build({venueId:this.getCurrentVenue().id}),c=fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,{view:fourSq.stats.action.View.NEW_LOGGED_IN_HOMEPAGE,component:fourSq.stats.action.Component.RATING_PROMPT,
componentIndex:this.getCurrentVenueIndex(),element:fourSq.stats.action.Element.SKIP,ids:c});fourSq.stats.logActions(c)},showVenue:function(a,b){if(a){this.$el.find(".venueContent").hide();var c=this.$el.find('.venueContent[data-id\x3d"'+a.id+'"]');b?c.fadeIn():c.show()}},showFinishMessage:function(){var a=templates.fourSq.opinionator.rateprompt.dialogFinish(),b=this,c=this.$el.find(".rateDialogContent");c.fadeOut("fast",function(){c.empty().append(a).fadeIn("fast").find(".finishButton").click(fourSq.bind(function(){b.close()},
this))})},close:function(){fourSq.opinionator.RateDialog.__super__.close.apply(this,[]);var a=fourSq.api.models.companion.log.Oids.build({venueId:this.getCurrentVenue().id}),a=fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,{view:fourSq.stats.action.View.NEW_LOGGED_IN_HOMEPAGE,component:fourSq.stats.action.Component.RATING_PROMPT,componentIndex:this.getCurrentVenueIndex(),element:fourSq.stats.action.Element.CANCEL,ids:a});fourSq.stats.logActions(a)},onError:function(){fourSq.ui.Notifier.getInstance().error({title:templates.fourSq.opinionator.rateprompt.errorRatingMessage()})}},
{Events:{RATED_LIKE:"rated_like",RATED_OK:"rated_ok",RATED_DISLIKE:"rated_dislike"}});fourSq.opinionator.RateDialogTipCompose=function(a){};
fourSq.opinionator.RateDialogTipCompose=fourSq.ui.View.extend({charMin_:10,charLimit_:200,charRedLimit_:130,initialize:function(a){this.$el=a.el;this.$formEl=a.formEl;this.$submitEl=this.$formEl.find('input[type\x3d"submit"]');this.canSkip_=(this.$skipEl=a.skipEl)?!0:!1;this.$charEl=this.$el.find(".charCount");this.$textArea=this.$el.find("textarea");this.optionalTip_=a.optionalTip},render:function(){return this.decorate()},decorate:function(){this.$textArea.keyup(fourSq.bind(function(a){a=$(a.currentTarget);
var b=a.val();this.onType(a,b)},this));this.$textArea.focus(fourSq.bind(function(a){$(a.currentTarget);this.trigger(fourSq.opinionator.RateDialogTipCompose.Events.TIP_COMPOSE_FOCUS)},this));this.$formEl.submit(fourSq.bind(function(a){a.preventDefault();this.isValid()?this.trigger(fourSq.opinionator.RateDialogTipCompose.Events.TIP_SUBMITTED_VALID):this.trigger(fourSq.opinionator.RateDialogTipCompose.Events.TIP_SUBMITTED_INVALID)},this));this.canSkip_&&this.$skipEl.click(fourSq.bind(function(a){this.trigger(fourSq.opinionator.RateDialogTipCompose.Events.TIP_SKIP)},
this));this.$charEl.text(this.charLimit_.toString());this.optionalTip_?this.togglePublishSkipButtons(!0,!0,!1):this.togglePublishSkipButtons(!1,!0,!0);return this},setVenue:function(a){this.currentVenue_=a;this.$textArea.attr("placeholder",a.tipHint)},getText:function(){return this.$textArea.val()},setText:function(a){this.$charEl.text(this.charLimit_);this.$textArea.val(a);this.onType(this.$textArea,a)},onType:function(a,b){b.length>=this.charMin_?this.togglePublishSkipButtons(!0,!1,!1):0<b.length?
this.togglePublishSkipButtons(!0,!1,!0):this.optionalTip_?this.togglePublishSkipButtons(!0,!0,!1):this.togglePublishSkipButtons(!1,!0,!1);this.$charEl.text((this.charLimit_-b.length).toString());b.length>=this.charRedLimit_?this.$charEl.addClass("redCharLimit"):this.$charEl.removeClass("redCharLimit")},togglePublishSkipButtons:function(a,b,c){a?this.$submitEl.show():this.$submitEl.hide();(this.publishDisabled_=c)?this.$submitEl.addClass("disabledByTip"):this.$submitEl.removeClass("disabledByTip");
this.canSkip_&&(b?this.$skipEl.show():this.$skipEl.hide())},isValid:function(){var a=this.$textArea.val(),b=a.length<=this.charLimit_,c=0===a.length;return a.length>=this.charMin_&&b||c&&this.optionalTip_}},{Events:{TIP_COMPOSE_FOCUS:"tcomposefocus",TIP_SUBMITTED_VALID:"tsubmitvalid",TIP_SUBMITTED_INVALID:"tsubmitinvalid",TIP_SKIP:"tskip"}});fourSq.opinionator.TipAfterRateDialog=function(a){};
fourSq.opinionator.TipAfterRateDialog=fourSq.opinionator.RateDialog.extend({initialize:function(a){fourSq.opinionator.TipAfterRateDialog.__super__.initialize.apply(this,[a]);this.contentElement_=$(templates.fourSq.opinionator.rateprompt.dialog({venues:this.venues_,includeSkipOptions:!!a.includeSkipOptions}))},decorate:function(){fourSq.opinionator.TipAfterRateDialog.__super__.decorate.apply(this,[]);this.$el.find(".preloadedImage").load(function(a){var c=$(a.currentTarget).attr("src");$(a.currentTarget).parent(".venueImageBackground").css("background-image",
'url("'+c+'")')});var a=$("#tipCompose");this.tipCompose_=(new fourSq.opinionator.RateDialogTipCompose({el:a,formEl:a,skipEl:$(".tipComposeSection .skipTip"),optionalTip:!1})).render();this.tipCompose_.on(fourSq.opinionator.RateDialogTipCompose.Events.TIP_SKIP,fourSq.bind(function(){this.onTipSkip()},this));this.tipCompose_.on(fourSq.opinionator.RateDialogTipCompose.Events.TIP_SUBMITTED_VALID,fourSq.bind(function(){this.submitTip()},this));this.tipCompose_.on(fourSq.opinionator.RateDialogTipCompose.Events.TIP_COMPOSE_FOCUS,
fourSq.bind(function(){if(!this.tipComposeStarted_){var a=fourSq.api.models.companion.log.Oids.build({venueId:this.getCurrentVenue().id}),a=fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,{view:fourSq.stats.action.View.NEW_LOGGED_IN_HOMEPAGE,component:fourSq.stats.action.Component.RATING_PROMPT,componentIndex:this.venueIndex_,element:fourSq.stats.action.Element.TIP_ADD,ids:a});fourSq.stats.logActions(a)}this.tipComposeStarted_=!0},this));return this},onRateClick:function(a,b,c,d){fourSq.opinionator.TipAfterRateDialog.__super__.onRateClick.apply(this,
[a,b,c,d]);this.toggleTipCompose_(b,!0,!0)},submitTip:function(){var a=fourSq.api.models.companion.log.Oids.build({venueId:this.getCurrentVenue().id}),a=fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,{view:fourSq.stats.action.View.NEW_LOGGED_IN_HOMEPAGE,component:fourSq.stats.action.Component.RATING_PROMPT,componentIndex:this.getCurrentVenueIndex(),element:fourSq.stats.action.Element.POST,ids:a,details:{source:"web-prompt"}});fourSq.stats.logActions(a);fourSq.api.services.Tip.add(this.getCurrentVenue().id,
this.tipCompose_.getText(),fourSq.emptyFunction,fourSq.emptyFunction);this.toggleTipComposePublishButton_(!0);this.showNextVenue(!0)},onSkip:function(a,b){fourSq.opinionator.TipAfterRateDialog.__super__.onSkip.apply(this,[a,b]);this.showNextVenue(!0)},onNotHere:function(a,b){fourSq.opinionator.TipAfterRateDialog.__super__.onNotHere.apply(this,[a,b]);this.showNextVenue(!0)},onTipSkip:function(){var a=fourSq.api.models.companion.log.Oids.build({venueId:this.getCurrentVenue().id}),a=fourSq.stats.Action.build(fourSq.stats.action.Action.CLOSE,
{view:fourSq.stats.action.View.NEW_LOGGED_IN_HOMEPAGE,component:fourSq.stats.action.Component.RATING_PROMPT,componentIndex:this.venueIndex_,element:fourSq.stats.action.Element.TIP_ADD,ids:a});fourSq.stats.logActions(a);this.showNextVenue(!0)},showVenue:function(a,b){fourSq.opinionator.TipAfterRateDialog.__super__.showVenue.apply(this,[a,b]);a&&this.toggleTipCompose_(a,!1,b)},toggleTipCompose_:function(a,b,c){a&&(b?(this.tipCompose_.setVenue(a),this.toggleTipComposePublishButton_(!1),c?this.$el.find(".rateSection").fadeOut(fourSq.bind(function(){this.$el.find(".tipComposeSection").fadeIn()},
this)):this.$el.find(".rateSection").hide().end().find(".tipComposeSection").show().end()):c?this.$el.find(".tipComposeSection").fadeOut(fourSq.bind(function(){this.$el.find(".rateSection").fadeIn()},this)):this.$el.find(".rateSection").show().end().find(".tipComposeSection").hide().end())},toggleTipComposePublishButton_:function(a){var b=$(this).find("input[type\x3dsubmit]");a?(a=b.data("submitted"),b.val(a).addClass("submitted")):(a=b.data("submit"),b.val(a).removeClass("submitted"))},setVenueRateText:function(a){a=
templates.fourSq.opinionator.rateprompt.dialogNoTipRateTitle({venue:a});this.$el.find("h3.rateText").empty().append(a)},resetUiState:function(){this.$el.find(".rateSection .option.clicked").removeClass("clicked");this.tipCompose_.setText("");var a=this.getCurrentVenue();this.setVenueRateText(a);fourSq.opinionator.TipAfterRateDialog.__super__.resetUiState.apply(this,[])},showFinishMessage:function(){fourSq.opinionator.TipAfterRateDialog.__super__.showFinishMessage.apply(this,[]);this.$el.find(".rateIcon").hide()},
delayedRateClick:function(a,b){setTimeout(fourSq.bind(function(){this.$el.find(".rateOptions ."+a).click()},this),b)}});"undefined"==typeof templates.fourSq&&(templates.fourSq={});"undefined"==typeof templates.fourSq.opinionator&&(templates.fourSq.opinionator={});"undefined"==typeof templates.fourSq.opinionator.rateprompt&&(templates.fourSq.opinionator.rateprompt={});
templates.fourSq.opinionator.rateprompt.dialog=function(a,b){return'\x3cdiv class\x3d"rateDialog"\x3e\x3cdiv id\x3d"xButton" class\x3d"header"\x3e\x3cspan class\x3d"close link"\x3e\x3cimg alt\x3d"close" src\x3d"'+soy.$$escapeHtml("https://ss1.4sqi.net/img/opinionator/rate_prompt/Popup_Close-665c015c100e3c7ced5ef59efe51c95b.png")+'" /\x3e\x3c/span\x3e\x3c/div\x3e'+templates.fourSq.opinionator.rateprompt.dialogNoTip_(a)+"\x3c/div\x3e"};
templates.fourSq.opinionator.rateprompt.dialogNoTip_=function(a,b){var c;c=""+('\x3cdiv class\x3d"rateIcon"\x3e\x3cimg src\x3d"'+soy.$$escapeHtml("https://ss0.4sqi.net/img/opinionator/rate_prompt/Rating_Grey-d289c54d3930fa45a4ba6c7b8b3478ea.png")+'" /\x3e\x3c/div\x3e\x3cdiv class\x3d"rateDialogContent noInlineTip"\x3e\x3ch2 class\x3d"dialogText"\x3eAfter you tell us what you like, we\'ll be able to find new places you\'ll love!\x3c/h2\x3e');for(var d=a.venues,e=d.length,f=0;f<e;f++){var g=d[f];c+=
'\x3cdiv class\x3d"venueContent" data-id\x3d"'+soy.$$escapeHtml(g.id)+'"\x3e'+templates.fourSq.opinionator.rateprompt.dialogVenue_({venue:g})+"\x3c/div\x3e"}return c=c+'\x3cdiv class\x3d"graySection"\x3e'+(templates.fourSq.opinionator.rateprompt.rateOptions_({title:"How did you like this place?",includeSkipOptions:a.includeSkipOptions})+templates.fourSq.opinionator.rateprompt.tipCompose_(null)+"\x3c/div\x3e\x3c/div\x3e")};
templates.fourSq.opinionator.rateprompt.visitTime=function(a,b){a=a||{};return'\x3cdiv class\x3d"venueVisit"\x3e'+(a.visitTime?helpers.util.smartDate({then:a.visitTime}):"")+"\x3c/div\x3e"};templates.fourSq.opinionator.rateprompt.dialogNoTipRateTitle=function(a,b){return"\x3cspan\x3eHow did you like "+soy.$$escapeHtml(a.venue.name)+"?\x3c/span\x3e"};
templates.fourSq.opinionator.rateprompt.dialogVenue_=function(a,b){var c='\x3cdiv class\x3d"venueImageBackground"\x3e';if(0<(null!=(null==a.venue?null:null==a.venue.photos?null:a.venue.photos.groups)?null==a.venue?null:null==a.venue.photos?null:a.venue.photos.groups:[]).length)var d=helpers.photo.nearestBigger(soy.$$augmentMap(a.venue.photos.groups[0].items[0],{targetWidth:400})),c=c+('\x3cimg class\x3d"preloadedImage" src\x3d"'+soy.$$escapeHtml(d)+'" alt\x3d"'+soy.$$escapeHtml(a.venue.name)+'" /\x3e');
else c+='\x3cimg class\x3d"preloadedImage empty" src\x3d"'+soy.$$escapeHtml("https://ss1.4sqi.net/img/venuepage/blank-photo-d7f560004201c3d6efa7a79f56b22724.jpg")+'" alt\x3d"'+soy.$$escapeHtml(a.venue.name)+'" /\x3e';return c+='\x3cdiv class\x3d"overlay"\x3e\x3cdiv class\x3d"venueCategory"\x3e'+helpers.venue.primaryCategoryIcon(soy.$$augmentMap(a.venue,{size:50,transparent:!0}))+'\x3c/div\x3e\x3ch3 class\x3d"venueName"\x3e\x3ca href\x3d"'+soy.$$escapeHtml(a.venue.canonicalPath)+'" target\x3d"_blank"\x3e'+
soy.$$escapeHtml(a.venue.name)+"\x3c/a\x3e\x3c/h3\x3e"+(a.venue.canonicalName?'\x3cspan class\x3d"venueCanonicalName"\x3e'+soy.$$escapeHtml(a.venue.canonicalName)+"\x3c/span\x3e":"")+'\x3cdiv class\x3d"venueAddress"\x3e'+(a.venue.location.address?soy.$$escapeHtml(a.venue.location.address):"")+"\x3c/div\x3e"+templates.fourSq.opinionator.rateprompt.visitTime({visitTime:null==a.venue?null:null==a.venue.beenHere?null:a.venue.beenHere.lastVisitedAt})+"\x3c/div\x3e\x3c/div\x3e"};
templates.fourSq.opinionator.rateprompt.rateOptions_=function(a,b){return'\x3cdiv class\x3d"rateSection '+(a.includeSkipOptions?"":"excludeSkipOptions")+'"\x3e'+(a.title?'\x3ch3 class\x3d"rateText"\x3e'+soy.$$escapeHtml(a.title)+"\x3c/h3\x3e":"")+'\x3cdiv class\x3d"rateOptions"\x3e\x3cspan class\x3d"option like" data-value\x3d"like"\x3eLike\x3c/span\x3e\x3cspan class\x3d"option okay" data-value\x3d"ok"\x3eIt\'s OK\x3c/span\x3e\x3cspan class\x3d"option dislike" data-value\x3d"dislike"\x3eDislike\x3c/span\x3e\x3c/div\x3e'+
(a.includeSkipOptions?templates.fourSq.opinionator.rateprompt.rateSkipOptions(null):"")+"\x3c/div\x3e"};templates.fourSq.opinionator.rateprompt.rateSkipOptions=function(a,b){return'\x3cdiv class\x3d"skipOptions"\x3e\x3cspan class\x3d"link option notHere"\x3eI wasn\'t here\x3c/span\x3e\x3cspan class\x3d"link option skip"\x3eSkip\x3c/span\x3e\x3c/div\x3e'};
templates.fourSq.opinionator.rateprompt.tipCompose_=function(a,b){var c;return c=""+('\x3cdiv class\x3d"tipComposeSection"\x3e\x3ch3 class\x3d"tipText"\x3eAwesome! Want to leave a tip for the next person?\x3c/h3\x3e\x3cform id\x3d"tipCompose"\x3e\x3cdiv class\x3d"textAreaWrapper"\x3e\x3ctextarea class\x3d"formStyle" form\x3d"tipCompose" maxlength\x3d"200" name\x3d"tipContent" rows\x3d"7" /\x3e\x3cspan class\x3d"charCount"\x3e\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"inputMethod"\x3e\x3cinput type\x3d"submit" value\x3d"'+soy.$$escapeHtml("Publish")+
'" data-submit\x3d"'+soy.$$escapeHtml("Publish")+'" data-submitted\x3d"'+soy.$$escapeHtml("Published")+'" /\x3e\x3cdiv class\x3d"skipOptions"\x3e\x3cspan class\x3d"link option skipTip"\x3eNo thanks, maybe later\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3c/form\x3e\x3c/div\x3e')};
templates.fourSq.opinionator.rateprompt.dialogFinish=function(a,b){return'\x3cdiv class\x3d"rateFinishDialog"\x3e\x3cimg class\x3d"thumbsUp" src\x3d"'+soy.$$escapeHtml("https://ss1.4sqi.net/img/opinionator/rate_prompt/ThumbsUp-3056ea7cdb768fbfa078c83a2327dbbc.png")+'" /\x3e\x3ch3 class\x3d"finishHeader"\x3eThanks!\x3c/h3\x3e\x3ch3 class\x3d"finishText"\x3eNow that we\'ve learned what you like, we\'ll be able to find new places you\'ll love!\x3c/h3\x3e\x3cdiv class\x3d"finishButtonContainer"\x3e\x3cspan class\x3d"finishButton"\x3eDone\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e'};
templates.fourSq.opinionator.rateprompt.toast=function(a,b){var c;c=a.venues.length;return c=""+('\x3cdiv class\x3d"rateToast"\x3e\x3cdiv class\x3d"rateBody"\x3e\x3cdiv class\x3d"rateIcon"\x3e\x3cimg width\x3d"32" height\x3d"32" src\x3d"'+soy.$$escapeHtml("https://ss1.4sqi.net/img/opinionator/rate_prompt/Rating_White-e8f4cedc18952dd0eb1753bd8587634b.png")+'" alt\x3d"Rating icon" /\x3e\x3c/div\x3e\x3cdiv class\x3d"rateMessageWrapper"\x3e\x3cdiv class\x3d"rateMessage"\x3e\x3cdiv class\x3d"'+soy.$$escapeHtml(2>
c?"singleVenue":"multiVenue")+'"\x3e'+(0==c?"Looks like you've been to some new places! Have a second to tell us what you thought?":1==c?"How did you like \x3cstrong\x3e"+soy.$$escapeHtml(a.venues[0].name)+"\x3c/strong\x3e? Have a second to tell us what you thought?":2==c?"How did you like \x3cstrong\x3e"+soy.$$escapeHtml(a.venues[0].name)+"\x3c/strong\x3e and \x3cstrong\x3e"+soy.$$escapeHtml(a.venues[1].name)+"\x3c/strong\x3e? Have a second to tell us what you thought?":"How did you like \x3cstrong\x3e"+
soy.$$escapeHtml(a.venues[0].name)+"\x3c/strong\x3e, \x3cstrong\x3e"+soy.$$escapeHtml(a.venues[1].name)+"\x3c/strong\x3e, and \x3cstrong\x3e"+soy.$$escapeHtml(a.venues[2].name)+"\x3c/strong\x3e? Have a second to tell us what you thought?")+'\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"rateWrapper"\x3e\x3cdiv class\x3d"rate"\x3eRate\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"clear"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e')};
templates.fourSq.opinionator.rateprompt.errorRatingMessage=function(a,b){return"There was an error rating the venue, please try again."};
fourSq.views.MenuView=function(a){};
fourSq.views.MenuView=fourSq.ui.View.extend({initialize:function(a){fourSq.views.MenuView.__super__.initialize.call(this,a);this.venue_=a.venue},setupMenuFlag:function(){if(fourSq.isDefinedAndNotNull(fourSq.api.models.companion.user.UserUtil.currentUser())){var a=this.$el.find(".flagLink"),b=$(templates.fourSq.newdrag.page.venuemenu.web.flag());this.comment_=b.find(".comment");$(a).click(fourSq.bind(function(){b.addClass("unknown");b.removeClass("success failure noProblem");var a=(new fourSq.ui.dialog.Dialog({className:"flagMenuDialog",
contentElement:b,isModal:!0,hasCloseButton:!0})).show();$(b).find(".submitFlag").click(fourSq.bind(function(){var d=$(b).find("input[name\x3dreason]:checked"),e=d.val();fourSq.isDefinedAndNotNull(e)?(b.removeClass("noReason"),fourSq.api.services.Venue.flag(this.venue_.id,{problem:e,creatingView:"web-menu-page",comment:this.comment_.val()},fourSq.bind(function(){d.removeAttr("checked");b.toggleClass("success unknown");window.setTimeout(function(){a.close()},1E3)},this))):b.addClass("noReason")},this))},
this))}else this.$el.find(".flagMenu").hide()}});"undefined"==typeof templates.fourSq&&(templates.fourSq={});"undefined"==typeof templates.fourSq.newdrag&&(templates.fourSq.newdrag={});"undefined"==typeof templates.fourSq.newdrag.page&&(templates.fourSq.newdrag.page={});"undefined"==typeof templates.fourSq.newdrag.page.venuemenu&&(templates.fourSq.newdrag.page.venuemenu={});"undefined"==typeof templates.fourSq.newdrag.page.venuemenu.web&&(templates.fourSq.newdrag.page.venuemenu.web={});
templates.fourSq.newdrag.page.venuemenu.web.flag=function(a,b){return'\x3cdiv class\x3d"menuflagFrame unknown"\x3e\x3ch3\x3eFlag this Menu\x3c/h3\x3e\x3cdiv class\x3d"flagForm"\x3e\x3cul\x3e\x3cli\x3e\x3clabel\x3e\x3cinput name\x3d"reason" type\x3d"radio" value\x3d"wrong_menu"/\x3eWrong menu\x3c/label\x3e\x3c/li\x3e\x3cli\x3e\x3clabel\x3e\x3cinput name\x3d"reason" type\x3d"radio" value\x3d"incorrect_items"/\x3eIncorrect items\x3c/label\x3e\x3c/li\x3e\x3cli\x3e\x3clabel\x3e\x3cinput name\x3d"reason" type\x3d"radio" value\x3d"other"/\x3eOther\x3c/label\x3e\x3c/li\x3e\x3c/ul\x3e\x3ctextarea class\x3d"comment" placeholder\x3d"Comments ..."\x3e\x3c/textarea\x3e\x3cp class\x3d"noReasonMessage"\x3ePlease select a reason.\x3c/p\x3e\x3cp\x3e\x3cinput name\x3d"reason" type\x3d"button" name\x3d"submitFlag" value\x3d"Submit Flag" class\x3d"submitFlag greenButton"/\x3e\x3c/p\x3e\x3c/div\x3e\x3cdiv class\x3d"flagStatus"\x3e\x3cdiv class\x3d"status success"\x3e\x3cp\x3eYour flag was submitted successfully.\x3c/p\x3e\x3c/div\x3e\x3cdiv class\x3d"status failure"\x3e\x3cp\x3eYour flag did not submit. Please try again later.\x3c/p\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'};fourSq.venue2.common.BaseTipModal=function(a){};
fourSq.venue2.common.BaseTipModal=fourSq.ui.View.extend({initialize:function(a){a.venue&&(this.venue=a.venue);this.history_=a.history;this.oldURL=this.currentTip_=null;this.currentUser_=fourSq.config.user.USER_PROFILE;this.initializeTips(a.tips)},showTipModalByTipId:function(a){this.addReferrer=!0;a&&fourSq.api.services.Tip.detail(a,fourSq.bind(function(a){this.venue.id===a.venue.id?(this.currentTip_=a,this.renderAndDecorateModal_(a)):fourSq.debug.error("Tip doesn't belong to venue.")},this),function(){fourSq.debug.error("Unable to retrieve tips")})},
showTipModalByTip:function(a,b){this.renderAndDecorateModal_(a,b)},parseUrlToTipId:function(){return fourSq.util.parseParams().tipId},renderAndDecorateModal_:fourSq.emptyFunction,setUrl_:function(){var a;this.oldURL=fourSq.location.href;a=(a=window.location.hash)?fourSq.util.appendParams(window.location.pathname,{tipId:this.currentTip_.id})+a:fourSq.util.appendParams(this.oldURL,{tipId:this.currentTip_.id});this.history_.replace(a)},revertUrl_:function(){this.oldURL?this.history_.replace(this.oldURL):
this.history_.replace(window.location.pathname)},show:function(a,b){var c=this.tipCache_[a];c?this.showTipModalByTip(c,b):fourSq.debug.error("Could not find tip.")},updateTips:function(a){fourSq.emptyFunction()},readUrlAndRenderModal_:function(){var a=this.parseUrlToTipId();a&&this.showTipModalByTipId(a)},initializeTips:function(a){this.tipCache_={};_.each(a,function(a){this.tipCache_[a.id]=a},this)},currentUserOwnsTip:function(){return this.currentUser_?this.currentUser_.id===this.currentTip_.user.id:
!1},updateTipInTipCache:function(a){this.tipCache_[a.id]=a},baseLoggingInfo_:function(){return this.addReferrer?{section:fourSq.stats.action.Section.TIP_MODAL,details:{tipId:this.currentTip_.id,referrer:document.referrer}}:{section:fourSq.stats.action.Section.TIP_MODAL,details:{tipId:this.currentTip_.id,referrer:window.location.pathname}}},closeActionLogging:function(){var a=fourSq.stats.Action.build(fourSq.stats.action.Action.CLOSE,this.baseLoggingInfo_());fourSq.stats.logActions(a)},openActionLogging:function(){var a=
fourSq.stats.Action.build(fourSq.stats.action.Action.SHOW,this.baseLoggingInfo_());fourSq.stats.logActions(a)}});fourSq.venue2.common.BaseTipModal.Events={OPEN:"open",CLOSE:"close",DELETE:"delete",UPDATE:"update",UPDATE_AND_RENDER:"update-and-render",DELETE_PHOTO:"delete-photo",REMOVE_URL:"remove-url"};fourSq.venue2.desktop.AdminFlyout=function(a){};
fourSq.venue2.desktop.AdminFlyout=fourSq.views.GenericFlyout.extend({initialize:function(a){a=a||{};a.direction=fourSq.ui.Flyout.Directions.BELOWLEFT;this.venue_=a.venue;this.noFollowTombstones_=a.noFollowTombstones;this.editModalMaker_=a.editModalMaker;fourSq.venue2.desktop.AdminFlyout.__super__.initialize.call(this,a);this.$anchor_.attr("tabindex",-1);this.$anchor_.click(fourSq.bind(function(){this.open_?this.close():(this.$anchor_.focus(),this.open())},this));this.$anchor_.focusout(fourSq.bind(this.close,
this))},decorate:function(){this.$el.mousedown(function(a){a.preventDefault()});this.initVenueEditor_()},handleIn_:fourSq.emptyFunction,handleOut_:fourSq.emptyFunction,getRenderedContentsHtml:function(){return templates.fourSq.page.venuedetail2.desktop.venueinfosection.adminFlyout({venue:this.venue_,noFollowTombstones:this.noFollowTombstones_})},initVenueEditor_:function(){this.$el.find(".venueEditLink").click(fourSq.bind(function(){this.editModalMaker_("venue-desktop-page");this.close()},this));
this.$el.find(".venueIdLink").click(fourSq.bind(function(){var a=this.venue_.id,b=document.createElement("textarea");b.value=a;document.body.appendChild(b);b.select();document.execCommand("copy");document.body.removeChild(b);alert("\ud83e\udeaa\u2192\ud83d\udccb!");return!1},this))}});fourSq.venue2.desktop.VenueDetailPage=function(a){};
fourSq.venue2.desktop.VenueDetailPage=fourSq.views.Page.extend({initialize:function(a){a.tips?this.currentPage_=fourSq.venue2.desktop.VenueDetailPage.Page.TIPS:a.photos?this.currentPage_=fourSq.venue2.desktop.VenueDetailPage.Page.PHOTOS:a.onMenuPage&&(this.currentPage_=fourSq.venue2.desktop.VenueDetailPage.Page.MENU);fourSq.venue2.desktop.VenueDetailPage.__super__.initialize.call(this,_.extend(a,{idsForLogging:fourSq.api.models.companion.log.Oids.build({venueId:a.venue.id})}));this.venue_=a.venue;
this.totalPhotosCount_=a.topPhotos.count;this.photos_=a.photos;this.topPhotos_=a.topPhotos.items;this.history_=new fourSq.util.History;this.listServiceProxy_=new fourSq.ui.save.ListServiceProxy;this.checkinLocations_=a.checkinLocations;this.showMap_=a.showMap;this.vectorMap_=a.vectorMap;this.venueFlagConfig_=a.venueFlagConfig;this.showInviteSignupPrompt_=a.showInviteSignupPrompt;this.enableLeaveTip_=a.enableLeaveTip;this.showTips_=a.showTips;this.showCheckins_=a.showCheckins;this.showVoting_=a.showVoting;
this.showBulkEdit_=a.showBulkEdit;this.useTipUpvotes_=a.useTipUpvotes;this.photosToFetch_=a.photosToFetch;this.$ownerSection_=this.$el.find(".ownerSection");this.renderNewEditActionControls_=a.renderNewEditActionControls;this.urlEditEnabled_=a.urlEditEnabled;this.enablePhotoBoosters_=a.enablePhotoBoosters;this.venueInfoSection_=(new fourSq.venue2.desktop.VenueInfoSection({el:this.$el.find(".venueInfoSection"),venue:this.venue_,editModalMaker:fourSq.bind(this.editModalMaker,this),listServiceProxy:this.listServiceProxy_,
noFollowTombstones:a.noFollowTombstones})).decorate();this.sidebarView_=(new fourSq.venue2.desktop.Sidebar({el:this.$el.find(".sidebar"),venue:this.venue_,checkinLocations:this.checkinLocations_||[],editModalMaker:fourSq.bind(this.editModalMaker,this),showMap:this.showMap_,vectorMap:this.vectorMap_})).decorate();this.pivotVenuesLogger_=new fourSq.venue2.desktop.PivotVenuesLogger({$el:this.$el,$relatedBlock:".relatedVenuesBlock",$impressionableBlock:"a.relatedVenueLink.promoted",$relatedVenueLink:"a.relatedVenueLink, a.miniRelatedVenueLink",
$relatedType:"listtype",venueId:a.venue.id});_.defer(fourSq.bind(this.pivotVenuesLogger_.initLogging,this.pivotVenuesLogger_));this.venuePBALogger_=new fourSq.venue2.desktop.VenuePBALogger({el:this.$el,venueId:a.venue.id});_.defer(fourSq.bind(this.venuePBALogger_.initLogging,this.venuePBALogger_));this.$sectionsBar_=this.$el.find(".sectionsBar");this.initRetinaFairy_();this.setupSignupCallout_(a.hasPhoto);this.setUpPlanningATripBanner_(a.planningATripBannerInfo);this.setupCurrentPage_(a);this.setupPhotoBanner_(a);
this.setupStickySections_();this.setupHistory_();this.initChildrenPivotDialogs_(a.subvenueGroupingOnServer,a.enableSubvenueAddressEditing);this.attachEvents_();a.showIPadModal&&a.tips&&this.showIPadModal_(a.tips)},initRetinaFairy_:function(){fourSq.retina.isRetina()&&(new fourSq.ui.RetinaFairy({el:$("body").get(0)})).resprinkle()},attachEvents_:function(){this.$sectionsBar_.find(".tipsBtn").click(fourSq.curry(this.showTipsSection_,this,null));this.$sectionsBar_.find(".photosBtn").click(fourSq.curry(this.showPhotosSection_,
this,null));this.$sectionsBar_.find(".menuBtn").click(fourSq.curry(this.showMenuSection_,this,null))},setupCurrentPage_:function(a){var b=fourSq.util.parseHashParams(),c=fourSq.venue2.desktop.StateManager.makeStateFromUrl();fourSq.venue2.desktop.StateManager.updateHistory(this.venue_,this.history_,c,fourSq.venue2.desktop.StateManager.HistoryMode.REPLACE);switch(this.currentPage_){case fourSq.venue2.desktop.VenueDetailPage.Page.PHOTOS:this.initPhotosSection_();break;case fourSq.venue2.desktop.VenueDetailPage.Page.MENU:this.initMenuSection_();
break;default:this.initTipsSection_(_.extend({},a,{scrollToTipsCompose:!!b.tipCompose,scrollToTipsView:!!b.tipsView}))}},setupStickySections_:function(){fourSq.ui.util.pin(this.$sectionsBar_,null,"sectionsBar")},setupPhotoBanner_:function(a){var b=this.$el.find(".photosSection");b.length&&(this.photosBanner_=(new fourSq.venue2.desktop.VenuePhotosBanner({el:b,photos:a.topPhotos,venue:a.venue,initialPhoto:a.initialPhoto,showTips:a.showTips,showCheckins:a.showCheckins,showVoting:a.showVoting,showBulkEdit:a.showBulkEdit,
history:this.history_,enablePhotoBoosters:a.enablePhotoBoosters})).decorate(),this.photosBanner_.on(fourSq.venue2.desktop.VenuePhotosBanner.Events.SEE_ALL_PHOTOS,fourSq.curry(this.showPhotosSection_,this,void 0,void 0,!0)))},setupHistory_:function(){var a=new fourSq.views.PhotoViewer({enableLeaveTip:this.enableLeaveTip_,showVoting:this.showVoting_,enablePhotoBoosters:this.enablePhotoBoosters_});this.history_.onChange(fourSq.bind(function(b){if(b){if(!b.closePhoto||b.tips||b.photos||b.menu)b.openPhotoId?
(a.addPhotos([b.openPhotoId]),a.open(0)):b.tips?this.showTipsSection_(b):b.photos?this.showPhotosSection_(b):b.menu&&this.showMenuSection_(b);b.openPhotoId||(a.close(),a.clearPhotos())}},this))},setupSignupCallout_:function(a){if(!fourSq.api.models.companion.user.UserUtil.isLoggedIn()){var b=this.$el.find(".signupPromptContainer");this.showInviteSignupPrompt_?fourSq.signup.InviteSignupPrompt.createWithInvitingUser({el:b,withTopMargin:!a,signupModal:!0}):(new fourSq.signup.VenuePageSignupPrompt({el:b,
venue:this.venue_,signupModal:!0})).render()}},setUpPlanningATripBanner_:function(a){var b=this.$el.find(".planningATripBanner");a&&b&&(this.planningATripBanner_=(new fourSq.venue2.desktop.PlanningATripBanner({el:b,cityName:a.cityName,geoId:a.geoId,group:a.group,isSocial:a.isSocial})).decorate())},initTipsSection_:function(a){var b=this.$el.find(".allTipsSection .tipsSection").length,c={items:[]};if(!b){var d=templates.fourSq.page.venuedetail2.desktop.tips.tipsSection({venue:this.venue_,tipSort:"popular",
showTipUrlInput:a.showTipUrlInput,pageSize:50,tipCount:this.venue_.stats.tipCount,searchableTips:!0,showInviteSignupPrompt:this.showInviteSignupPrompt_,currentTipPageIndex:0,tips:c,currentUser:fourSq.api.models.companion.user.UserUtil.currentUser(),useTipUpvotes:this.useTipUpvotes_});this.$el.find(".allTipsSection").append($(d))}this.tipsSection_=(new fourSq.venue2.desktop.tips.TipsSection({el:this.$el.find(".allTipsSection"),venue:this.venue_,tips:a.tips||c,pageSize:a.tipPageSize||50,listServiceProxy:this.listServiceProxy_,
currentPageIndex:a.currentTipPageIndex,tipSort:a.tipSort,tipCount:this.venue_.stats.tipCount,showVoting:this.showVoting_,history:this.history_,useTipUpvotes:this.useTipUpvotes_,renderNewEditActionControls:this.renderNewEditActionControls_,scrollToTipsCompose:a.scrollToTipsCompose,scrollToTipsView:a.scrollToTipsView,urlEditEnabled:this.urlEditEnabled_,topPhotos:this.topPhotos_})).decorate();this.tipsSection_.on(fourSq.venue2.desktop.tips.TipsSection.Events.CLICK_MENU_LINK,fourSq.bind(this.showMenuSection_,
this));b||this.tipsSection_.updateTips(this.tipsSection_.makeHistoryState_(0),fourSq.venue2.desktop.StateManager.HistoryMode.PUSH)},initPhotosSection_:function(){this.photosSection_=(new fourSq.venue2.desktop.PhotosSection({el:this.$el.find(".allPhotosSection"),venue:this.venue_,totalPhotosCount:this.totalPhotosCount_,history:this.history_,photos:this.photos_,enableLeaveTip:this.enableLeaveTip_,showTips:this.showTips_,showCheckins:this.showCheckins_,showVoting:this.showVoting_,showBulkEdit:this.showBulkEdit_,
photosToFetch:this.photosToFetch_,enablePhotoBoosters:this.enablePhotoBoosters_})).decorate()},initMenuSection_:function(){this.menuSection_=(new fourSq.venue2.desktop.MenuSection({el:this.$el.find(".menuSection"),venue:this.venue_})).decorate()},initChildrenPivotDialogs_:function(a,b){var c={subvenueGroupingOnServer:a,enableAddressEditing:b},d=this.$el.find(".childVenuesSection .seeMore");if(d.length){var e=new fourSq.venue2.desktop.VenueChildrenDialog(_.extend({currentVenue:this.venue_,forSiblings:!1},
c));d.click(fourSq.bind(e.show,e))}d=this.$el.find(".siblingVenuesSection .seeMore");d.length&&this.venue_.parent&&(c=new fourSq.venue2.desktop.VenueChildrenDialog(_.extend({currentVenue:this.venue_.parent,forSiblings:!0},c)),d.click(fourSq.bind(c.show,c)))},showTipsSection_:function(a,b){b&&b.preventDefault();this.$el.find(".subVenueSection, .sectionBtn").removeClass("active");this.$el.find(".allTipsSection, .tipsBtn").addClass("active");this.tipsSection_?a?this.tipsSection_.updateTips(a,fourSq.venue2.desktop.StateManager.HistoryMode.SKIP_PERSIST):
this.tipsSection_.updateHistory():this.initTipsSection_(this.options);this.currentPage_!==fourSq.venue2.desktop.VenueDetailPage.Page.TIPS&&(this.scrollTop_(),this.logTabSwitch_(fourSq.venue2.desktop.VenueDetailPage.Page.TIPS))},showPhotosSection_:function(a,b,c){b&&b.preventDefault();this.$el.find(".subVenueSection, .sectionBtn").removeClass("active");this.$el.find(".allPhotosSection, .photosBtn").addClass("active");this.photosSection_?a?fourSq.venue2.desktop.StateManager.updateHistory(this.venue_,
this.history_,a,fourSq.venue2.desktop.StateManager.HistoryMode.SKIP_PERSIST):this.photosSection_.updateHistory():(a=fourSq.venue2.desktop.StateManager.makePhotosState(),this.initPhotosSection_(),this.photosSection_.fetchPhotos(a,fourSq.venue2.desktop.StateManager.HistoryMode.PUSH));this.currentPage_!==fourSq.venue2.desktop.VenueDetailPage.Page.PHOTOS&&this.logTabSwitch_(fourSq.venue2.desktop.VenueDetailPage.Page.PHOTOS,c);this.scrollTop_()},showMenuSection_:function(a,b){b&&b.preventDefault();this.$el.find(".subVenueSection, .sectionBtn").removeClass("active");
this.$el.find(".menuSection, .menuBtn").addClass("active");this.menuSection_?a?fourSq.venue2.desktop.StateManager.updateHistory(this.venue_,this.history_,a,fourSq.venue2.desktop.StateManager.HistoryMode.SKIP_PERSIST):(a=fourSq.venue2.desktop.StateManager.makeMenuState(),fourSq.venue2.desktop.StateManager.updateHistory(this.venue_,this.history_,a,fourSq.venue2.desktop.StateManager.HistoryMode.PUSH)):(this.initMenuSection_(),a=fourSq.venue2.desktop.StateManager.makeMenuState(),fourSq.venue2.desktop.StateManager.updateHistory(this.venue_,
this.history_,a,fourSq.venue2.desktop.StateManager.HistoryMode.PUSH));this.currentPage_!==fourSq.venue2.desktop.VenueDetailPage.Page.MENU&&(this.scrollTop_(),this.logTabSwitch_(fourSq.venue2.desktop.VenueDetailPage.Page.MENU))},scrollTop_:function(){var a=this.$el.find(".sectionsBar:not(.pinned)");a.length?fourSq.ui.util.scrollTo(a,{animate:!0}):fourSq.ui.util.scrollTo(this.$el.find("#sectionsBarPlaceholder"),{animate:!0})},editModalMaker:function(a,b){(new fourSq.venueflag.views.DialogWizard({model:this.venue_,
venues:null,expandedPanes:b,checkinLocations:this.checkinLocations_,config:this.venueFlagConfig_,creatingView:a})).render()},showIPadModal_:function(a){(new fourSq.ui.dialog.DialogFrequencyCapper({name:fourSq.ui.dialog.DialogFrequencyCapper.ModalNames.IPAD_DOWNLOAD_MODAL,cap:1,modal:new fourSq.ui.dialog.IPadDownloadModal({tips:a,venue:this.venue_})})).show()},logTabSwitch_:function(a,b){var c;if(!b){switch(a){case fourSq.venue2.desktop.VenueDetailPage.Page.PHOTOS:c=fourSq.stats.action.Element.PHOTOS_TAB;
break;case fourSq.venue2.desktop.VenueDetailPage.Page.MENU:c=fourSq.stats.action.Element.MENU_TAB;break;default:c=fourSq.stats.action.Element.TIPS_TAB}fourSq.stats.logActions(fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,{section:fourSq.stats.action.Section.TOP_VENUE_INFO,component:fourSq.stats.action.Component.VENUE_SECTION_TABS,element:c,ids:fourSq.api.models.companion.log.Oids.build({venueId:this.venue_.id})}))}this.currentPage_=a;fourSq.stats.Util.logPageLoad()},pageViewName:function(){switch(this.currentPage_){case fourSq.venue2.desktop.VenueDetailPage.Page.PHOTOS:return fourSq.stats.action.View.VENUE_PHOTOS;
case fourSq.venue2.desktop.VenueDetailPage.Page.MENU:return fourSq.stats.action.View.VENUE_MENU;default:return fourSq.stats.action.View.VENUE_DETAIL}}},{Page:{TIPS:"tips",PHOTOS:"photos",MENU:"menu"}});fourSq.venue2.desktop.MenuSection=function(a){};
fourSq.venue2.desktop.MenuSection=fourSq.ui.View.extend({initialize:function(a){fourSq.venue2.desktop.MenuSection.__super__.initialize.call(this,a);this.venue_=a.venue},decorate:function(){this.$el.children().length?this.$el.find(".menuCategoryName").click(fourSq.bind(function(a){a=$(a.target).closest(".quickLink").attr("data-menu-id");a=this.$el.find("#"+a);fourSq.ui.util.scrollTo(a,{animate:!0,buffer:70})},this)):this.fetchAndRenderMenu_();this.setupMenuFlag_();return this},fetchAndRenderMenu_:function(){if(!this.$el.children().length){var a=
fourSq.bind(function(a){a=templates.fourSq.page.venuedetail2.desktop.menu.contents({displayMenu:a});this.$el.append($(a));this.decorate();this.$el.removeClass("loading")},this),b=fourSq.bind(function(){this.$el.removeClass("loading");fourSq.debug.error("Failed to load photos page ")},this);this.$el.addClass("loading");fourSq.api.services.Venue.menu(this.venue_.id,a,b)}},setupMenuFlag_:function(){if(fourSq.api.models.companion.user.UserUtil.currentUser()){var a=this.$el.find(".flagLink"),b=$(templates.fourSq.newdrag.page.venuemenu.web.flag()),
c=b.find(".comment");$(a).click(fourSq.bind(function(){b.addClass("unknown").removeClass("success failure noProblem");var a=(new fourSq.ui.dialog.Dialog({className:"flagMenuDialog",contentElement:b,isModal:!0,hasCloseButton:!0})).show();$(b).find(".submitFlag").click(fourSq.bind(function(){var e=b.find("input[name\x3dreason]:checked"),f=e.val();f?(b.removeClass("noReason"),fourSq.api.services.Venue.flag(this.venue_.id,{problem:f,creatingView:"web-menu-page",comment:c.val()},fourSq.bind(function(){e.removeAttr("checked");
b.toggleClass("success unknown");window.setTimeout(function(){a.close()},1E3)},this))):b.addClass("noReason")},this))},this))}else this.$el.find(".flagMenu").hide()},scrollTop:function(){fourSq.ui.util.scrollTo(this.$el,{animate:!0})}});fourSq.venue2.desktop.PhotosSection=function(a){};
fourSq.venue2.desktop.PhotosSection=fourSq.ui.View.extend({initialize:function(a){fourSq.venue2.desktop.PhotosSection.__super__.initialize.call(this,a);this.venue_=a.venue;this.enableLeaveTip_=a.enableLeaveTip;this.showTips_=a.showTips;this.showCheckins_=a.showCheckins;this.showVoting_=a.showVoting;this.showBulkEdit_=a.showBulkEdit;this.photosToFetch_=a.photosToFetch;this.totalPhotosCount_=a.totalPhotosCount;this.history_=a.history;this.$photosBlock_=this.$el.find(".photosBlock");this.$editPhotosLink_=
this.$el.find(".editPhotosLink");this.selectedPhotos_=[];this.inBulkEditMode_=!1;this.enablePhotoBoosters_=a.enablePhotoBoosters;a.photos&&this.setupPhotoViewer_(a.photos);this.venue_&&this.$el.find(".rankPhotosLink").length&&(this.photoRanker_=new fourSq.views.PhotoRanker({el:$("#wrapper"),venueId:this.venue_.id}))},decorate:function(){this.currentState_=fourSq.venue2.desktop.StateManager.makeStateFromUrl();this.$editPhotosLink_.click(fourSq.bind(this.openBulkEditMode_,this));this.setupAutoLoad_();
return this},fetchPhotos:function(a,b){var c={id:this.venue_.id,limit:this.photosToFetch_,offset:0};this.$photosBlock_.addClass("loading");var d=fourSq.bind(function(c){var d=templates.fourSq.page.venuedetail2.desktop.photos.photosBlock({photos:c.groups[0],venue:this.venue_,showTips:this.showTips_,showCheckins:this.showCheckins_,showVoting:this.showVoting_,showBulkEdit:this.showBulkEdit_});this.$photosBlock_.empty().append($(d));this.updateHistory(a,b);this.setupPhotoViewer_(c.groups[0]);this.$photosBlock_.removeClass("loading");
this.setupAutoLoad_()},this),e=fourSq.bind(function(){fourSq.debug.error("Failed to load photos page ");this.$photosBlock_.removeClass("loading")},this);fourSq.api.services.Venue.photos(c,d,e)},updateHistory:function(a,b){this.currentState_=a=a||this.currentState_;fourSq.venue2.desktop.StateManager.updateHistory(this.venue_,this.history_,a,b)},scrollTop:function(){fourSq.ui.util.scrollTo(this.$el,{animate:!0})},setupPhotoViewer_:function(a){this.photoGalleryView_=new fourSq.venue2.desktop.PhotoGalleryView({el:this.$photosBlock_,
venue:this.venue_,photos:a,disableAutoLoad:!1,showTips:this.showTips_,showCheckins:this.showCheckins_,showPhotoFunction:fourSq.bind(this.showPhotoViewer_,this),pageSize:this.photosToFetch_});this.viewer_=new fourSq.views.PhotoViewer({photos:this.photoGalleryView_.getPhotos(),enableLeaveTip:this.enableLeaveTip_,showVoting:this.showVoting_,enablePhotoBoosters:this.enablePhotoBoosters_});this.viewer_.on(fourSq.views.PhotoViewer.Events.CLOSE,this.clearPushState_,this);this.photoGalleryView_.on(fourSq.venue2.desktop.PhotoGalleryView.Events.LOADED_MORE,
fourSq.bind(function(a){this.viewer_.addPhotos(a)},this))},setupAutoLoad_:function(){var a=this.$el.find(".startAutoLoad");a.length&&a.click(fourSq.bind(function(){fourSq.stats.logActions(fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,{section:fourSq.stats.action.Section.VENUE_DETAIL_PHOTOS,element:fourSq.stats.action.Element.MORE,ids:fourSq.api.models.companion.log.Oids.build({venueId:this.venue_.id})}));a.remove();this.photoGalleryView_.loadMore();this.infiniteScroll_=new fourSq.ui.util.ScrollPolicy({bottomthreshold:1200});
this.infiniteScroll_.on(fourSq.ui.util.ScrollPolicy.Events.NEAR_BOTTOM,this.photoGalleryView_.loadMore,this.photoGalleryView_)},this))},showPhotoViewer_:function(a,b){if(!this.inBulkEditMode_)if(fourSq.venue2.desktop.StateManager.setPhotoViewerHistory(this.venue_,this.history_,a),fourSq.isDefinedAndNotNull(b))this.viewer_.open(this.$el.find(".photo").index($(b.target).parents(".photo")));else{var c=new fourSq.views.PhotoViewer({photos:[a],showVoting:this.showVoting_,enablePhotoBoosters:this.enablePhotoBoosters_});
c.open(0);c.on(fourSq.views.PhotoViewer.Events.CLOSE,this.clearPushState_,this)}},setupBulkEdit_:function(){var a=this.$bulkEditBar_.find(".photoEditButtons .button"),b=new fourSq.ui.Notifier({position:fourSq.ui.Notifier.Position.TOP_RIGHT}),c=this.$bulkEditBar_.find(".instructions"),d=this.$bulkEditBar_.find(".selectedInstructions");this.$el.on("click",".photo",fourSq.bind(function(b){if(this.inBulkEditMode_){b=$(b.target);var f=b.closest(".photo"),g=f.attr("id"),h=f.find(".bulkEditCheckbox");b.hasClass("bulkEditCheckbox")||
h.prop("checked",!h.prop("checked"));h.prop("checked")?(f.addClass("photoSelect"),this.selectedPhotos_.push(g)):(f.removeClass("photoSelect"),this.selectedPhotos_=_.filter(this.selectedPhotos_,function(a){return a!==g}));this.selectedPhotos_.length?(a.removeAttr("disabled"),c.hide(),d.empty().append($(templates.fourSq.page.venuedetail2.desktop.photos.numPhotosSelected({numPhotos:this.selectedPhotos_.length}))).show()):this.resetBulkEditor_()}},this));a.click(fourSq.bind(function(a){a=$(a.target).attr("data-action");
this.selectedPhotos_.length&&(fourSq.api.services.Photo.bulkEdit(this.selectedPhotos_,a,function(){b.info({title:"Thanks for your edits!",text:"You may not see your changes right away.",sticky:!1})},function(){b.info({title:"Something has gone wrong",text:"Please try again in a few minutes.",sticky:!1})}),this.resetBulkEditor_())},this))},resetBulkEditor_:function(){var a=this.$bulkEditBar_.find(".photoEditButtons .button"),b=this.$bulkEditBar_.find(".instructions"),c=this.$bulkEditBar_.find(".selectedInstructions");
this.selectedPhotos_=[];this.$el.find(".bulkEditCheckbox").prop("checked",!1);this.$el.find(".photo").removeClass("photoSelect");c.hide();b.show();a.attr("disabled",!0)},openBulkEditMode_:function(){this.$el.addClass("photosEditing");this.inBulkEditMode_=!0;this.$bulkEditBar_?this.$bulkEditBar_.show():(this.$bulkEditBar_=$(templates.fourSq.page.venuedetail2.desktop.photos.bulkEditTools()),this.$bulkEditBar_.find(".closeBulkEdit").click(fourSq.bind(this.closeBulkEditMode_,this)),$("#container").append(this.$bulkEditBar_),
this.setupBulkEdit_());this.$editPhotosLink_.click(fourSq.bind(this.closeBulkEditMode_,this));this.$editPhotosLink_.text("Disable edit mode")},closeBulkEditMode_:function(){this.inBulkEditMode_=!1;this.$bulkEditBar_.hide();this.$el.removeClass("photosEditing");this.resetBulkEditor_();this.$editPhotosLink_.click(fourSq.bind(this.openBulkEditMode_,this));this.$editPhotosLink_.text("Edit photos")},clearPushState_:function(){fourSq.venue2.desktop.StateManager.clearPhotoViewerHistory(this.venue_,this.history_)}});fourSq.venue2.desktop.VenuePhotosBanner=function(a){};
fourSq.venue2.desktop.VenuePhotosBanner=fourSq.ui.View.extend({initialize:function(a){fourSq.venue2.desktop.VenuePhotosBanner.__super__.initialize.call(this,a);this.venue_=a.venue;this.venueId_=this.venue_.id;this.photos_=a.photos;this.initialPhoto_=a.initialPhoto;this.showVoting_=a.showVoting;this.history_=a.history;this.enablePhotoBoosters_=a.enablePhotoBoosters;this.rightmostScrollPosition_=void 0;this.hasLoggedArrowClick_=this.hasLoggedScroll_=!1},decorate:function(){var a=this.photos_.count===
this.photos_.items.length;this.initialPhoto_&&(fourSq.isDefined(_.find(this.photos_.items,function(a){return a.id===this.initialPhoto_.id},this))||this.photos_.items.unshift(this.initialPhoto_));this.photoViewer_=new fourSq.ui.VenuePhotoViewer({isAllPhotos:a,photos:this.photos_.items,venueId:this.venueId_,showVoting:!!this.showVoting_,enablePhotoBoosters:this.enablePhotoBoosters_});this.photoViewer_.on(fourSq.views.PhotoViewer.Events.SHOW,fourSq.bind(function(a){fourSq.venue2.desktop.StateManager.setPhotoViewerHistory(this.venue_,
this.history_,a)},this));this.photoViewer_.on(fourSq.views.PhotoViewer.Events.CLOSE,fourSq.bind(function(){fourSq.venue2.desktop.StateManager.clearPhotoViewerHistory(this.venue_,this.history_)},this));this.$el.find(".allPhotosLink").click(fourSq.bind(function(a){a.preventDefault();fourSq.stats.logActions(this.getLoggingAction_(fourSq.stats.action.Element.ALL_PHOTOS_LINK));this.trigger(fourSq.venue2.desktop.VenuePhotosBanner.Events.SEE_ALL_PHOTOS)},this));this.$el.find(".photoWithContent").click(fourSq.bind(function(a){a=
$(a.currentTarget).data("photoid");this.photoViewer_.openById(a);fourSq.stats.logActions(this.getLoggingAction_(fourSq.stats.action.Element.PHOTO))},this));this.initialPhoto_&&this.photoViewer_.openById(this.initialPhoto_.id);this.$el.hasClass("hasArrows")&&(this.computeRightmostScrollPosition_(),this.$el.find("ul.photos").scroll(_.debounce(fourSq.bind(function(){this.setScrollArrowVisibility_();this.hasLoggedScroll_||(this.hasLoggedScroll_=!0,fourSq.stats.logActions(this.getLoggingAction_(fourSq.stats.action.Element.PHOTO,
fourSq.stats.action.Action.SCROLL)))},this),50)),this.setScrollArrowVisibility_(),this.$el.find(".leftArrow").click(fourSq.curry(this.onArrowClick_,this,fourSq.venue2.desktop.VenuePhotosBanner.Directions.LEFT)),this.$el.find(".rightArrow").click(fourSq.curry(this.onArrowClick_,this,fourSq.venue2.desktop.VenuePhotosBanner.Directions.RIGHT)));return this},onArrowClick_:function(a){var b=this.$el.find("ul.photos");a*=fourSq.venue2.desktop.VenuePhotosBanner.SCROLL_AMOUNT;b.animate({scrollLeft:b.scrollLeft()+
a});this.hasLoggedArrowClick_||(this.hasLoggedArrowClick_=!0,fourSq.stats.logActions(this.getLoggingAction_(fourSq.stats.action.Element.ARROW)))},computeRightmostScrollPosition_:function(){var a=_.map(this.$el.find("ul.photos li").toArray(),function(a){return $(a).outerWidth(!0)});this.rightmostScrollPosition_=_.reduce(a,function(a,c){return a+c},0)-this.$el.find("ul.photos").outerWidth(!0)},setScrollArrowVisibility_:function(){var a=this.$el.find("ul.photos").scrollLeft();0<a?this.$el.addClass("withLeftArrow"):
this.$el.removeClass("withLeftArrow");a<this.rightmostScrollPosition_?this.$el.addClass("withRightArrow"):this.$el.removeClass("withRightArrow")},getLoggingAction_:function(a,b){b=b||fourSq.stats.action.Action.CLICK;return fourSq.stats.Action.build(b,{element:a,section:fourSq.stats.action.Section.VENUE_DETAIL_PHOTOS})}},{Events:{SEE_ALL_PHOTOS:"see_all_photos"},SCROLL_AMOUNT:615,Directions:{LEFT:-1,RIGHT:1}});fourSq.venue2.desktop.VenueChildrenDialog=function(a){};
fourSq.venue2.desktop.VenueChildrenDialog=fourSq.ui.dialog.Dialog.extend({initialize:function(a){fourSq.venue2.desktop.VenueChildrenDialog.__super__.initialize.call(this,{className:"venueChildrenModal",newScrollingBehaviour:!0});this.currentVenue_=a.currentVenue;this.forSiblings_=a.forSiblings;this.subvenueGroupingOnServer_=!!a.subvenueGroupingOnServer;this.enableAddressEditing_=!!a.enableAddressEditing;this.fetchComplete_=!1},fetch_:function(){fourSq.api.services.Venue.children(this.currentVenue_.id,fourSq.bind(function(a){this.subvenueGroupingOnServer_?
this.venueGroups_=a.children.groups:this.venues_=a.children.items||[];this.fetchComplete_=!0;this.renderContent()},this))},renderContent:function(){this.fetchComplete_?(this.venueGroups_?this.container_.empty().append(templates.fourSq.page.venuedetail2.desktop.childrendialog.partitionedBody({venueName:this.currentVenue_.name,forSiblings:this.forSiblings_,groups:this.venueGroups_,enableAddressEditing:this.enableAddressEditing_})):this.container_.empty().append(templates.fourSq.page.venuedetail2.desktop.childrendialog.unpartitionedBody({venueName:this.currentVenue_.name,
forSiblings:this.forSiblings_,venues:this.venues_,enableAddressEditing:this.enableAddressEditing_})),this.setLoading(!1),this.addDecorations_()):(this.setLoading(!0),this.fetch_())},addDecorations_:function(){this.container_.find(".editAddresses").click(fourSq.bind(this.switchToEditing_,this))},switchToEditing_:function(){var a=_(this.venueGroups_).chain().map(function(a){return a.items}).flatten(!0).value();this.container_.empty().append(templates.fourSq.page.venuedetail2.desktop.childrendialog.addressEditor({venues:a}));
this.container_.scrollTop(0);this.container_.find(".editableField").change(fourSq.bind(function(a){a=$(a.target);a.toggleClass("changed",a.val()!==a.data("original-value"));this.container_.find(".submit").removeClass("disabledButton")},this));this.container_.find(".submit").click(fourSq.bind(function(a){$(a.target).hasClass("disabledButton")||this.submitAddressEdits_()},this));this.container_.find(".cancel").click(fourSq.bind(this.renderContent,this))},submitAddressEdits_:function(){var a=[];_.each(this.container_.find(".venueRow").toArray(),
function(b){var d=$(b);b=_(d.find(".editableField").toArray()).chain().map(function(a){return $(a)}).filter(function(a){return a.val()!==a.data("original-value")}).value();if(0<b.length){var d=d.data("venueid"),e={};_.each(b,function(a){var b=a.data("param");a=a.val();e[b]=a});a.push({venueId:d,params:e})}});if(0<a.length){var b=templates.fourSq.page.venuedetail2.desktop.childrendialog.editConfirm({numVenues:a.length});window.confirm(b)&&(this.container_.find(".submit").addClass("disabledButton"),
fourSq.api.services.Venue.massEdit(a,fourSq.bind(function(){fourSq.ui.Notifier.getInstance().info(templates.fourSq.page.venuedetail2.desktop.childrendialog.editSuccess());this.close()},this),fourSq.bind(function(){fourSq.ui.Notifier.getInstance().error(templates.fourSq.page.venuedetail2.desktop.childrendialog.editFailed());this.close()},this)))}}});fourSq.venue2.desktop.VenueShareDialog=function(a){};
fourSq.venue2.desktop.VenueShareDialog=fourSq.ui.dialog.Dialog.extend({initialize:function(a){this.url_=a.url;fourSq.venue2.desktop.VenueShareDialog.__super__.initialize.call(this,{className:"venueShareDialogContainer",contentElement:$(templates.fourSq.page.venuedetail2.desktop.sharedialog.content({name:a.name,url:this.url_}))})},decorate:function(){fourSq.ui.dialog.Dialog.prototype.decorate.apply(this,arguments);if(!this.decorated){var a=this.$el.find(".facebook-share-button"),b=this.$el.find(".twitter-tweet-button"),
c=this.$el.find(".shareURLInput");a.click(fourSq.bind(this.onShare,this));b.click(fourSq.bind(this.onShare,this));c.click(function(){c.select()});this.facebookShareButton=new fourSq.ui.share.FacebookShareButton({el:a,url:this.url_});this.twitterTweetButton=new fourSq.ui.share.TwitterTweetButton({el:b,url:this.url_});this.decorated=!0}},onShare:function(){this.trigger(fourSq.venue2.desktop.VenueShareDialog.Events.SOCIAL_SHARE);this.close()}},{Events:{SOCIAL_SHARE:"social-share"}});fourSq.venue2.desktop.Sidebar=function(a){};
fourSq.venue2.desktop.Sidebar=fourSq.ui.View.extend({initialize:function(a){fourSq.venue2.desktop.Sidebar.__super__.initialize.call(this,a);this.venue_=a.venue;this.checkinLocations_=a.checkinLocations;this.editModalMaker_=a.editModalMaker;this.showMap_=a.showMap||!1;this.vectorMap_=a.vectorMap||!1},decorate:function(){this.venue_.location.lat&&this.venue_.location.lng&&this.showMap_&&this.setupMap_(this.vectorMap_);this.$el.find(".staffSection .avatar").tooltip();this.truncateDescription_();this.initAttributePrompt_();
this.initLogging_();this.initHoursShowAllLink_();this.initFeaturesShowAllLink_();this.initVenueEditor_();return this},truncateDescription_:function(){this.$el.find(".descriptionBlock .venueRowContent").jTruncate({length:60,moreText:templates.fourSq.page.venuedetail2.desktop.messages.showMoreText(),lessText:templates.fourSq.page.venuedetail2.desktop.messages.showLessText()})},initAttributePrompt_:function(){var a=this.$el.find(".venuePrompt");a.length&&(this.attributePrompt_=(new fourSq.venue2.desktop.AttributePrompt({el:a,
venue:this.venue_})).decorate())},setupMap_:function(a){a?(new fourSq.venue2.desktop.map.SmallMapboxMap({el:this.$el.find(".mapSection"),primaryVenue:this.venue_,checkinLocations:this.checkinLocations_})).decorate():(a=(new fourSq.venue2.desktop.map.OverlayMap({primaryVenue:this.venue_,checkinLocations:this.checkinLocations_||[]})).render(),(new fourSq.venue2.desktop.map.SmallMap({el:this.$el.find(".mapSection"),primaryVenue:this.venue_,overlayMap:a,checkinLocations:this.checkinLocations_})).decorate())},
initHoursShowAllLink_:function(){var a=this.$el.find(".toggleAllHoursLink"),b=!1;a.click(fourSq.bind(function(){var c=this.$el.find(".allHours");c.slideToggle("fast",fourSq.bind(function(){c.is(":visible")?a.text(templates.fourSq.page.venuedetail2.desktop.messages.hideHoursText()):this.venue_.hours?a.text(templates.fourSq.page.venuedetail2.desktop.messages.showHoursText()):a.text(templates.fourSq.page.venuedetail2.desktop.messages.showPopularHoursText())},this));b||(this.logClick_(fourSq.stats.action.Element.FULL_HOURS),
b=!0)},this))},initFeaturesShowAllLink_:function(){var a=this.$el.find(".venueAttributes"),b=a.find(".sideVenueBlockMore"),c=a.find(".sideVenueBlockRow.sideVenueAttributeRow, .foodDrinkTitle, .sideVenueRecentEdit");a.find(".featuresTitle").length||a.find(".foodDrinkTitle").show();b.is(":visible")&&fourSq.stats.logActions(fourSq.stats.Action.build(fourSq.stats.action.Action.IMPRESSION,{section:fourSq.stats.action.Section.SIDEBAR,element:fourSq.stats.action.Element.MORE,ids:fourSq.api.models.companion.log.Oids.build({venueId:this.venue_.id})}));
b.click(fourSq.bind(function(){fourSq.stats.logActions(fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,{section:fourSq.stats.action.Section.SIDEBAR,element:fourSq.stats.action.Element.MORE,ids:fourSq.api.models.companion.log.Oids.build({venueId:this.venue_.id})}));b.hasClass("seeLess")?(c.slice(2).slideUp("fast"),b.removeClass("seeLess"),b.text(templates.fourSq.page.venuedetail2.desktop.messages.showFeaturesText())):(c.slideDown("fast"),b.addClass("seeLess"),b.text(templates.fourSq.page.venuedetail2.desktop.messages.hideFeaturesText()))},
this))},initVenueEditor_:function(){this.$el.find(".hoursEditorLink").click(fourSq.bind(function(){this.editModalMaker_("venue-page-add-hours",["hours"])},this));this.$el.find(".venueEditLink").click(fourSq.bind(function(){this.editModalMaker_("venue-desktop-page")},this))},initLogging_:function(){this.logLinkClick_(this.$el.find(".claimSection a"),fourSq.stats.action.Element.CLAIM);this.logLinkClick_(this.$el.find(".locationSection a"),fourSq.stats.action.Element.LOCATION_BREADCRUMB);this.logLinkClick_(this.$el.find(".staffSection a"),
fourSq.stats.action.Element.FACE,{component:fourSq.stats.action.Component.STAFF});_.each(this.$el.find(".exploreLinksSection a").toArray(),fourSq.bind(function(a){a=$(a);this.logLinkClick_(a,fourSq.stats.action.Element.EXPLORE_LINK,{component:fourSq.stats.action.Component.EXPLORE_LINKS,details:{section:a.data("section")}})},this));this.logLinkClick_(this.$el.find(".venueQueriesSection .exploreLink"),fourSq.stats.action.Element.EXPLORE_LINK,{component:fourSq.stats.action.Component.POPULAR_QUERIES});
this.logLinkClick_(this.$el.find(".venueListsSection ul.listOfLists li a.venuePhoto"),fourSq.stats.action.Element.PHOTO,{component:fourSq.stats.action.Component.LISTS});this.logLinkClick_(this.$el.find(".venueListsSection ul.listOfLists li .listName a"),fourSq.stats.action.Element.LIST_NAME,{component:fourSq.stats.action.Component.LISTS});this.logLinkClick_(this.$el.find(".venueListsSection a.seeAllLists"),fourSq.stats.action.Element.SEE_ALL_LISTS,{component:fourSq.stats.action.Component.LISTS});
var a=this.$el.find("ul.localQueryList a.localQueryLink");if(0<a.length){var b=fourSq.stats.Action.build(fourSq.stats.action.Action.IMPRESSION,{element:fourSq.stats.action.Element.LOCAL_QUERY_DETAIL_LINK,section:fourSq.stats.action.Section.SIDEBAR});fourSq.stats.logActions(b);this.logLinkClick_(a,fourSq.stats.action.Element.LOCAL_QUERY_DETAIL_LINK)}},logLinkClick_:function(a,b,c){_.each(a.toArray(),function(a){fourSq.stats.Util.logActionOnLinkClick($(a),function(){var a=_.extend({element:b,section:fourSq.stats.action.Section.SIDEBAR},
c||{});return fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,a)})})},buildLoggingAction_:function(a){return fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,{element:a,section:fourSq.stats.action.Section.VENUE_DETAIL_INFO})},logClick_:function(a){fourSq.stats.logActions(this.buildLoggingAction_(a))}});fourSq.venue2.desktop.StateManager={lastState_:null,updateHistory:function(a,b,c,d){d=d||fourSq.venue2.desktop.StateManager.HistoryMode.PUSH;var e=fourSq.venue2.desktop.StateManager.makeHistoryString(c),e=a.canonicalPath+(c.photos?"/photos":c.menu?"/menu":"")+e;switch(d){case fourSq.venue2.desktop.StateManager.HistoryMode.PUSH:b.push(e,c);break;case fourSq.venue2.desktop.StateManager.HistoryMode.REPLACE:b.replace(e,c)}},setPhotoViewerHistory:function(a,b,c){fourSq.venue2.desktop.StateManager.lastState_=
this.makeStateFromUrl();this.updateHistory(a,b,this.makePhotoViewerState(c),fourSq.venue2.desktop.StateManager.HistoryMode.PUSH)},clearPhotoViewerHistory:function(a,b){this.lastState_.closePhoto=!0;this.updateHistory(a,b,this.lastState_,fourSq.venue2.desktop.StateManager.HistoryMode.PUSH)},makeHistoryString:function(a){var b=new fourSq.net.QueryString;a.openPhotoId?b.set("openPhotoId",a.openPhotoId.id):a.tips&&(0!==a.tipsPage&&b.set("tipsPage",(a.tipsPage+1).toString()),""!==a.tasteId&&b.set("tasteId",
a.tasteId),""!==a.query&&b.set("tipsQuery",a.query),""!==a.sort&&""===a.query&&""===a.tasteId&&b.set("tipsSort",a.sort),""!==a.tipId&&b.set("tipId",a.tipId),a.followTombstones||b.set("followTombstones","false"));return(a=b.toDisplayString())?"?"+a:""},makeTipsState:function(a,b,c,d,e,f){return{tips:!0,photos:!1,menu:!1,tipsPage:a,sort:c?"":b,query:c,tasteId:d,tipId:e,openPhotoId:null,closePhoto:!1,followTombstones:f}},makePhotosState:function(){return{photos:!0,tips:!1,menu:!1,tipsPage:0,sort:"",
query:"",tasteId:"",tipId:"",openPhotoId:null,closePhoto:!1,followTombstones:!0}},makeMenuState:function(){return{menu:!0,photos:!1,tips:!1,tipsPage:0,sort:"",query:"",tasteId:"",tipId:"",openPhotoId:null,closePhoto:!1,followTombstones:!0}},makePhotoViewerState:function(a){return{menu:!1,photos:!1,tips:!1,tipsPage:0,sort:"",query:"",tasteId:"",tipId:"",openPhotoId:a,closePhoto:!1,followTombstones:!0}},makeStateFromUrl:function(){var a=fourSq.util.parseParams(),b=fourSq.util.parseHashParams();if(/\/photos$/.test(window.location.pathname))return this.makePhotosState();
if(/\/menu$/.test(window.location.pathname))return this.makeMenuState();var c=parseInt(b.tipsPage||a.tipsPage||"1",10)-1;return this.makeTipsState(c,b.tipsSort||a.tipsSort||"",b.tipsQuery||a.tipsQuery||"",b.tasteId||a.tasteId||"",b.tipId||a.tipId||"","false"!==b.followTombstones&&"false"!==a.followTombstones)}};fourSq.venue2.desktop.StateManager.HistoryMode={PUSH:"push",REPLACE:"replace",SKIP_PERSIST:"skip_persist"};fourSq.venue2.desktop.VenueInfoSection=function(a){};
fourSq.venue2.desktop.VenueInfoSection=fourSq.ui.View.extend({initialize:function(a){fourSq.venue2.desktop.VenueInfoSection.__super__.initialize.call(this,a);this.venue_=a.venue;this.listServiceProxy_=a.listServiceProxy;this.venueController_=new fourSq.api.controllers.VenueFeedbackController(this.venue_.id);this.editModalMaker_=a.editModalMaker;this.$el.find(".superuserLinks.hasFlyout").length&&(this.adminFlyout_=new fourSq.venue2.desktop.AdminFlyout({anchor:this.$el.find(".superuserLinks"),venue:this.venue_,
noFollowTombstones:a.noFollowTombstones,editModalMaker:this.editModalMaker_}));(this.venue_.like||this.venue_.ok||this.venue_.dislike)&&this.updateRating_(!0)},decorate:function(){this.initSaveButton_();this.initRateButton_();this.initShareButton_();this.initVenueEditor_();this.initVenueNameLink_();return this},initSaveButton_:function(){this.saveButton_=new fourSq.ui.save.SaveButton({venue:this.venue_,el:this.$el.find(".saveButton"),listService:this.listServiceProxy_});this.saveButton_.decorate()},
initRateButton_:function(){this.likeButton=(new fourSq.ui.liking.LikeDislikeButton({el:this.$el.find(".comboRatingButton"),isLiked:this.venue_.like,isDisliked:this.venue_.dislike,isOkayed:this.venue_.ok,controller:this.venueController_})).decorate();this.venue_.ratingSignals&&(this.venueController_.on(fourSq.api.controllers.FeedbackController.Events.LIKE_SET,this.updateRating_,this),this.venueController_.on(fourSq.api.controllers.FeedbackController.Events.OK_SET,this.updateRating_,this),this.venueController_.on(fourSq.api.controllers.FeedbackController.Events.DISLIKE_SET,
this.updateRating_,this))},initShareButton_:function(){this.$el.find(".doubleShareButton").click(fourSq.bind(function(){this.shareVenueDialog_||(this.shareVenueDialog_=new fourSq.venue2.desktop.VenueShareDialog({name:this.venue_.name,url:this.venue_.shortUrl}));fourSq.stats.logActions(fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,{section:fourSq.stats.action.Section.TOP_VENUE_INFO,element:fourSq.stats.action.Element.SHARE,ids:fourSq.api.models.companion.log.Oids.build({venueId:this.venue_.id})}));
this.shareVenueDialog_.show()},this))},initVenueEditor_:function(){this.$el.find(".venueEditLink").click(fourSq.bind(function(){this.editModalMaker_("venue-desktop-page")},this))},initVenueNameLink_:function(){this.$el.find(".sectionInfoName").click(function(){fourSq.ui.util.scrollTo($("body"),{animate:!0})})},updateRating_:function(a){var b=this.$el.find(".numRatingsBlock");b.length&&(a=templates.fourSq.page.venuedetail2.desktop.venueinfosection.numRatings({count:a?this.venue_.ratingSignals+1:this.venue_.ratingSignals}),
b.replaceWith($(a)))}});fourSq.venue2.desktop.AttributePrompt=function(a){};
fourSq.venue2.desktop.AttributePrompt=fourSq.ui.View.extend({initialize:function(a){fourSq.venue2.desktop.AttributePrompt.__super__.initialize.call(this,a);this.venueId_=a.venue.id;this.prompts_=a.venue.prompts;this.lastPrompt_=null;this.answeredPromptCount_=0;this.logAction_(fourSq.stats.action.Action.SHOW)},decorate:function(){this.decoratePromptButtons_();return this},decorateVoteButtons_:function(){var a=fourSq.bind(function(){this.logAction_(fourSq.stats.action.Action.SUCCESS);this.answeredPromptCount_++;
this.loadNextPrompt_()},this),b=fourSq.bind(function(){fourSq.ui.Notifier.getInstance().error($(templates.fourSq.page.venuedetail2.desktop.messages.venuePromptError()));this.logAction_(fourSq.stats.action.Action.FAILURE)},this);this.$el.find(".promptButton").click(fourSq.bind(function(c){var d=$(c.currentTarget);c=d.data("key");var d=d.data("value"),e={};e[c]=d;e.creatingView="desktop-venue-prompt";this.logAction_(fourSq.stats.action.Action.SUBMIT,{promptValue:d});fourSq.api.services.Venue.proposeEdit(this.venueId_,
e,void 0,a,b)},this))},decoratePromptButtons_:function(){this.decorateVoteButtons_();this.$el.find(".hidePromptButton").click(fourSq.bind(function(){this.logAction_(fourSq.stats.action.Action.CLOSE);this.$el.slideUp()},this))},loadNextPrompt_:function(){this.lastPrompt_=this.prompts_.items.shift();if(this.hasPrompt_()){var a=templates.fourSq.page.venuedetail2.desktop.sidevenueinfo.promptContent({prompt:this.currentPrompt_()});this.$el.empty().append(a);this.decoratePromptButtons_();this.logAction_(fourSq.stats.action.Action.SHOW)}else this.completeAllPrompts_()},
completeAllPrompts_:function(){var a=templates.fourSq.page.venuedetail2.desktop.messages.completedVenuePromptBody({afterText:this.lastPrompt_.afterText});this.$el.empty().append(a);_.delay(fourSq.bind(this.$el.slideUp,this.$el),3E3)},currentPrompt_:function(){return this.prompts_.items[0]},hasPrompt_:function(){return!!this.currentPrompt_()},logAction_:function(a,b){var c=_.extend({previouslyAnsweredPrompts:this.answeredPromptCount_,promptKey:this.currentPrompt_().options[0].key},b||{});fourSq.stats.logActions(fourSq.stats.Action.build(a,
{section:fourSq.stats.action.Section.ATTRIBUTE_PROMPT,details:c}))}});fourSq.venue2.desktop.PivotVenuesLogger=function(a){};
fourSq.venue2.desktop.PivotVenuesLogger=fourSq.Class.extend({initialize:function(a){fourSq.venue2.desktop.PivotVenuesLogger.__super__.initialize.call(this,a);this.$el=a.$el;this.$relatedBlock=a.$relatedBlock;this.$impressionableBlock=a.$impressionableBlock;this.$relatedVenueLink=a.$relatedVenueLink;this.$relatedType=a.$relatedType;this.venueId_=a.venueId},initLogging:function(){var a=this,b=[];_.each(a.$el.find(a.$relatedBlock).toArray(),function(c,d){var e=$(c),f=a.getBaseParamsFromEl_(a.$relatedType,
e,d);b.push(fourSq.stats.Action.build(fourSq.stats.action.Action.IMPRESSION,f));(new fourSq.ui.ImpressionMonitor(e,a.$impressionableBlock,{revealPercent:75})).on(fourSq.ui.ImpressionMonitor.Events.FIRST_IMPRESSION,fourSq.bind(function(a){a=a.data("promotionid");a=_.extend({},f,{ids:fourSq.api.models.companion.log.Oids.build({promotionId:a})});fourSq.stats.logActions(fourSq.stats.Action.build(fourSq.stats.action.Action.IMPRESSION,a))},this)).update();_.each(e.find(a.$relatedVenueLink).toArray(),function(b,
c){var d=$(b);fourSq.stats.Util.logActionOnLinkClick(d,function(){var b=d.data("venueid"),e=d.data("promotionid"),b=_.extend({},f,{ids:fourSq.api.models.companion.log.Oids.build({venueId:b,promotionId:e}),element:fourSq.stats.action.Element.LINK});b.details=b.details||{};b.details.sourceVenueId=a.venueId_;b.details.venueIndex=c;return fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,b)})})});fourSq.stats.logActions.apply(fourSq.stats,b)},getBaseParamsFromEl_:function(a,b,c){a=b.data(a).toString();
return{component:this.getComponent_(a),componentIndex:c}},getComponent_:function(a){switch(a){case "similar_venues":return fourSq.stats.action.Component.SIMILAR_VENUES;case "similar_taste_venues":return fourSq.stats.action.Component.SIMILAR_TASTE_VENUES;case "same_geo_category_venues":return fourSq.stats.action.Component.SAME_GEO_CATEGORY_VENUES;case "same_geo_restaurants":return fourSq.stats.action.Component.SAME_GEO_RESTAURANTS;case "subsequent_venues":return fourSq.stats.action.Component.SUBSEQUENT_VENUES;
case "child_venues":return fourSq.stats.action.Component.CHILD_VENUES;case "sibling_venues":return fourSq.stats.action.Component.SIBLING_VENUES;case "chain_venues":return fourSq.stats.action.Component.CHAIN_VENUES}}});fourSq.venue2.desktop.VenuePBALogger=function(a){};
fourSq.venue2.desktop.VenuePBALogger=fourSq.ui.View.extend({initialize:function(a){fourSq.venue2.desktop.VenuePBALogger.__super__.initialize.call(this,a);this.baseSelector_=".venueInfoSection";this.impressionableSelector_=".adsPBA";this.clickthroughSelector_="a.adsPBAClickthrough";this.venueId_=a.venueId},initLogging:function(){var a=[];_.each(this.$el.find(this.baseSelector_).toArray(),fourSq.bind(function(b,c){var d=$(b),e=this.getBaseParamsFromEl_(c);a.push(fourSq.stats.Action.build(fourSq.stats.action.Action.IMPRESSION,
e));(new fourSq.ui.ImpressionMonitor(d,this.impressionableSelector_,{revealPercent:75})).on(fourSq.ui.ImpressionMonitor.Events.FIRST_IMPRESSION,fourSq.bind(function(a){a=d.find(this.clickthroughSelector_).data("promotionid");a=_.extend({},e,{ids:fourSq.api.models.companion.log.Oids.build({promotionId:a})});fourSq.stats.logActions(fourSq.stats.Action.build(fourSq.stats.action.Action.IMPRESSION,a))},this)).update();_.each(d.find(this.clickthroughSelector_),fourSq.bind(function(a,b){var c=$(a);fourSq.stats.Util.logActionOnLinkClick(c,
function(){var a=c.data("promotionid"),a=_.extend({},e,{ids:fourSq.api.models.companion.log.Oids.build({promotionId:a}),element:fourSq.stats.action.Element.LINK});a.details=a.details||{};a.details.sourceVenueId=this.venueId_;a.details.venueIndex=b;return fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,a)})},this))},this));fourSq.stats.logActions.apply(fourSq.stats,a)},getBaseParamsFromEl_:function(a){return{component:fourSq.stats.action.Component.VENUE,componentIndex:a}}});fourSq.venue2.desktop.PlanningATripBanner=function(a){};
fourSq.venue2.desktop.PlanningATripBanner=fourSq.ui.View.extend({initialize:function(a){fourSq.venue2.desktop.PlanningATripBanner.__super__.initialize.call(this,a);this.cityName_=a.cityName;this.geoId_=a.geoId;this.group_=a.group;this.isSocial_=a.isSocial},decorate:function(){this.$el.find(".findThingsToDoButton").click(fourSq.withoutPropagationAndDefault(this.handleButtonClick_,this));this.$el.click(fourSq.withoutPropagationAndDefault(this.handleNonButtonClick_,this));this.logImpression_();return this},
handleButtonClick_:function(){this.logAndRedirect_(fourSq.stats.action.Element.EXPLORE_LINK)},handleNonButtonClick_:function(){this.logAndRedirect_()},logAndRedirect_:function(a){a=this.buildActionForLogging_(fourSq.stats.action.Action.CLICK,a);var b=this.isSocial_?"/trip-tips?geoId\x3d"+this.geoId_:"/explore?near\x3d"+encodeURIComponent(this.cityName_)+"\x26nearGeoId\x3d"+this.geoId_;fourSq.stats.logActionWithDelay(a,function(){fourSq.util.redirect(b)})},logImpression_:function(){var a=this.buildActionForLogging_(fourSq.stats.action.Action.IMPRESSION);
fourSq.stats.logActions(a)},buildActionForLogging_:function(a,b){var c={component:this.isSocial_?fourSq.stats.action.Component.SOCIAL_TRAVEL_BANNER:fourSq.stats.action.Component.PLANNING_A_TRIP_BANNER,details:{geoId:this.geoId_}},d=this.determineSection_();d&&(c.section=d);b&&(c.element=b);return fourSq.stats.Action.build(a,c)},determineSection_:function(){if(this.isSocial_||"TopBar"==this.group_)return fourSq.stats.action.Section.TOP;if("MainBar"==this.group_)return fourSq.stats.action.Section.MAIN;
if("SideBar"==this.group_)return fourSq.stats.action.Section.SIDEBAR}});fourSq.venue2.desktop.JustificationsView=function(a){};
fourSq.venue2.desktop.JustificationsView=fourSq.ui.View.extend({initialize:function(a){fourSq.venue2.desktop.JustificationsView.__super__.initialize.call(this,a);this.venue_=a.venue},decorate:function(){this.decorateBestXInGeo_();this.decorateTippets_();return this},decorateBestXInGeo_:function(){var a=this.$el.find(".justification a.localQueryDetailLink"),b=a.attr("href");if(b){var c={section:fourSq.stats.action.Section.JUSTIFICATIONS,component:fourSq.stats.action.Component.LOCAL_QUERY_DETAIL_LINK,details:{href:b},
ids:fourSq.stats.Oids.build({venueId:this.venue_.id})};fourSq.stats.logActions(fourSq.stats.Action.build(fourSq.stats.action.Action.IMPRESSION,c));fourSq.stats.Util.logActionOnLinkClick(a,function(){return fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,c)})}},decorateTippets_:function(){var a=this.$el.find(".tippet");a.length&&fourSq.stats.logActions(fourSq.stats.Action.build(fourSq.stats.action.Action.IMPRESSION,{section:fourSq.stats.action.Section.TIPPETS,ids:fourSq.stats.Oids.build({venueId:this.venue_.id}),
details:{size:a.length}}));a.click(fourSq.bind(function(a){a=$(a.currentTarget);var c=a.attr("data-taste-id"),d=a.attr("data-tip-id"),e=a.attr("data-taste-text");this.trigger(fourSq.venue2.desktop.JustificationsView.Events.CLICK,c,e);fourSq.stats.logActions(fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,{section:fourSq.stats.action.Section.TIPPETS,componentIndex:a.index(".tippet"),ids:fourSq.stats.Oids.build({venueId:this.venue_.id,tasteId:c,tipId:d})}))},this))}},{Events:{CLICK:"fourSq.venue2.desktop.JustificationsView:CLICK"}});fourSq.venue2.desktop.PhotoGalleryView=function(a){};
fourSq.venue2.desktop.PhotoGalleryView=fourSq.ui.View.extend({initialize:function(a){fourSq.venue2.desktop.PhotoGalleryView.__super__.initialize.call(this,a);var b,c;fourSq.isDefinedAndNotNull(a.venue)?(b=fourSq.api.services.Venue.photos,c=a.venue.id):fourSq.isDefinedAndNotNull(a.user)&&(b=fourSq.api.services.User.photos,c=a.user.id);c&&(this.photoLoader_=new fourSq.ui.PhotoLoader({apiCall:b,objectId:c,pageSize:a.pageSize||fourSq.venue2.desktop.PhotoGalleryView.PAGE_SIZE,preloadedPages:1,user:a.user,
loadCallback:a.disableAutoLoad?fourSq.emptyFunction:fourSq.bind(this.loadCallback_,this),loadErrorCallback:fourSq.emptyFunction,sort:a.sort,containsFace:a.containsFace}));this.venue_=a.venue;this.user_=a.user;this.photos_=this.$el.find(".photo");this.initialPhoto_=a.initialPhoto;this.show_=a.showPhotoFunction;this.showTips_=a.showTips;this.showCheckins_=a.showCheckins;this.showVoting_=fourSq.config.user.CANVOTEONPHOTOS;this.showBulkEdit_=fourSq.config.user.CANBULKEDITPHOTOS;this.model_=a.photos;fourSq.isDefinedAndNotNull(this.model_.items)&&
(this.model_.items=this.formatPhotos_(this.model_.items),_.each(this.model_.items,fourSq.bind(this.setupSinglePhoto_,this)));this.tipImpressionLogger_=new fourSq.venue.util.TipImpressionLogger({$el:this.$el,selector:".photo",contentIdFunc:function(a){return a.data("tipid")}})},getPhotoCheckboxes:function(){return this.$el.find(".bulkEditCheckbox")},decorate:function(){fourSq.isDefinedAndNotNull(this.initialPhoto_)&&this.show_(this.formatPhotos_([this.initialPhoto_])[0]);this.tipImpressionLogger_.update();
return this},getPhotos:function(){return this.model_.items},getLoader:function(){return this.photoLoader_},loadMore:function(){this.photoLoader_.hasMore()?this.photoLoader_.load():this.trigger(fourSq.venue2.desktop.PhotoGalleryView.Events.ALL_LOADED)},formatPhotos_:function(a){return this.photoLoader_.attachUser(a)},setupSinglePhoto_:function(a){var b=$("#"+a.id);this.setupSinglePhotoEl_(b,a)},setupSinglePhotoEl_:function(a,b){b.tip&&b.tip.logView&&a.data("tipid",b.tip.id);a.click(fourSq.curry(this.show_,
this,b));var c=a.find(".meta .nameDate .date"),d=a.find(".meta .nameDate .name"),e=a.find(".meta .userPic"),f=a.find(".likeDislikeControls"),g=a.find(".comboRatingButtonLike"),h=a.find(".comboRatingButtonDislike");a.find(".bulkEditCheckbox");var l=fourSq.bind(function(a,b,c,d){var e=$(b.currentTarget);this.logClickWithDelay_(c,function(){fourSq.util.clickOpensInNewTab(b,e)?window.open(a):fourSq.util.redirect(a)},d)},this);e.click(fourSq.bind(function(a){l(b.user.canonicalPath,a,fourSq.stats.action.Element.AVATAR,
{});return!1},this));d.click(fourSq.bind(function(a){l(b.user.canonicalPath,a,fourSq.stats.action.Element.USER_NAME,{});return!1},this));c.click(fourSq.bind(function(a){var c=null;if(this.showTips_&&b.tip)c=b.tip.canonicalPath;else if(this.showCheckins_&&b.checkin)c=b.checkin.canonicalPath;else return!0;l(c,a,fourSq.stats.action.Element.DATE,{});return!1},this));d.addClass("link");(this.showTips_&&b.tip||this.showCheckins_&&b.checkin)&&c.addClass("link");this.showVoting_&&(g.click(fourSq.bind(function(a){a.stopPropagation();
f.addClass("hasRating");h.removeClass("active");g.addClass("active");fourSq.api.services.Photo.upvote(b.id)},this)),h.click(fourSq.bind(function(a){a.stopPropagation();f.addClass("hasRating");g.removeClass("active");h.addClass("active");fourSq.api.services.Photo.downvote({photoId:b.id})},this)))},logClickWithDelay_:function(a,b,c){fourSq.stats.logActionWithDelay(this.buildLoggingAction_(a,c),b)},buildLoggingAction_:function(a,b){var c=_.extend({element:a},b||{});return fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,
c)},loadCallback_:function(a){fourSq.isDefinedAndNotNull(a)&&(a=this.formatPhotos_(a),_.each(a,function(a){var c=$(templates.fourSq.photos.galleryPhoto({photo:a,showTips:this.showTips_,showCheckins:this.showCheckins_,showVoting:this.showVoting_,showBulkEdit:this.showBulkEdit_}));this.setupSinglePhotoEl_(c,a);this.$el.append(c)},this),this.tipImpressionLogger_.update(),this.trigger(fourSq.venue2.desktop.PhotoGalleryView.Events.LOADED_MORE,a),this.photoLoader_.hasMore()||this.trigger(fourSq.venue2.desktop.PhotoGalleryView.Events.ALL_LOADED));
return a}},{PAGE_SIZE:30,Events:{LOADED_MORE:"loaded-more",ALL_LOADED:"all-loaded"}});fourSq.venue2.desktop.map.BaseMapControl=function(a,b){};fourSq.venue2.desktop.map.BaseMapControl=fourSq.map.EventedControl.extend({options:{position:"topright"},onAdd:function(a){this.$container_=$(this.getButtonHtml());this.$container_.click(fourSq.bind(function(){this.trigger(this.getClickEvent())},this));return this.getContainer()},getClickEvent:fourSq.abstractMethod,getButtonHtml:fourSq.abstractMethod,getContainer:function(){return this.$container_.get(0)}});fourSq.venue2.desktop.map.CenterMapControl=function(a,b){};fourSq.venue2.desktop.map.CenterMapControl=fourSq.venue2.desktop.map.BaseMapControl.extend({getButtonHtml:function(){return templates.fourSq.page.venuedetail2.desktop.maps.centerMapButton()},getClickEvent:function(){return fourSq.venue2.desktop.map.CenterMapControl.Events.CLICK},hide:function(){$(this.getContainer()).hide()},show:function(){$(this.getContainer()).show()}});fourSq.venue2.desktop.map.CenterMapControl.Events={CLICK:"CLICK"};fourSq.venue2.desktop.map.VenueMap=function(a){};
fourSq.venue2.desktop.map.VenueMap=fourSq.ui.View.extend({initialize:function(a){fourSq.venue2.desktop.map.VenueMap.__super__.initialize.call(this,a);this.primaryVenue=a.primaryVenue;this.overlayMap_=a.overlayMap;this.pins_={};this.map_=null;this.fuzzyLocation_=!!this.primaryVenue.location.isFuzzed;this.initialZoom_=null;this.checkinLocations_=a.checkinLocations},initMap:function(){this.primaryVenue.location.planet!==fourSq.api.models.companion.venue.Planets.MARS?this.initEarthMap_():this.initMarsMap_();
_.each(this.checkinLocations_,fourSq.bind(function(a){a=new L.Marker(new L.LatLng(a.lat,a.lng),{icon:new fourSq.map.icon.BlueDotIcon,alt:"Blue dot icon"});this.map_.addLayer(a)},this));var a=!1;this.$el.find("#"+this.getMapId()).click(fourSq.bind(function(){if(!a){var b=fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,{section:this.getSection(),element:fourSq.stats.action.Element.MAP});fourSq.stats.logActions(b);a=!0}},this))},initEarthMap_:function(){this.initialZoom_=this.fuzzyLocation_?
13:15;this.map_=fourSq.map.MapGenerator.generate(this.getMapId(),{center:fourSq.api.models.companion.geo.LatLngUtil.toLeaflet(this.primaryVenue.location),scrollWheelZoom:!1,zoom:this.initialZoom_});if(!this.fuzzyLocation_){var a=fourSq.newpin.PinIconProviderFactory.categoryForVenue(this.primaryVenue);this.addVenue_(this.primaryVenue,this.map_,a)}},initMarsMap_:function(){this.initialZoom_=fourSq.map.MapGenerator.marsDefaultZoom();this.map_=fourSq.map.MapGenerator.generateForVenue(this.primaryVenue,
this.getMapId(),{zoom:this.initialZoom_},{scrollWheelZoom:!1})},initCenterMapControl:function(){var a=new fourSq.venue2.desktop.map.CenterMapControl;this.map_.addControl(a);a.hide();this.map_.on("dragstart zoomstart",fourSq.bind(a.show,a));a.on(fourSq.venue2.desktop.map.CenterMapControl.Events.CLICK,fourSq.bind(function(){this.onCenterButtonClick_(a)},this))},onCenterButtonClick_:function(a){this.resetView_();a.hide();a=fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,{element:fourSq.stats.action.Element.CENTER_MAP,
component:fourSq.stats.action.Component.MAP,section:this.getSection()});fourSq.stats.logActions(a)},resetView_:function(){var a=this.pins_[this.primaryVenue.id];a&&this.initialZoom_&&this.map_.setView(a.getLatLng(),this.initialZoom_)},getTooltip_:function(a,b,c){var d=$(templates.fourSq.map.tooltip.venue({showCarat:this.showTooltipCarat(),venue:a}));c=this.getTooltipPositioner(b,fourSq.api.models.companion.geo.LatLngUtil.toLeaflet(a.location),c.size());return new fourSq.newpin.Tooltip({map:b,latLng:a.location,
contents:d.eq(0),positioner:c,options:{autoPan:!1,closeButton:!1}})},addVenue_:function(a,b,c){b=new fourSq.newpin.Pin({iconProvider:c,id:a.id,latLng:a.location,map:b,tooltip:this.getTooltip_(a,b,c)});return this.pins_[a.id]=b},getMapId:fourSq.abstractMethod,getTooltipPositioner:fourSq.abstractMethod,showTooltipCarat:fourSq.abstractMethod,getSection:fourSq.abstractMethod});fourSq.venue2.desktop.map.OverlayMap=function(a){};
fourSq.venue2.desktop.map.OverlayMap=fourSq.venue2.desktop.map.VenueMap.extend({initialize:function(a){fourSq.venue2.desktop.map.OverlayMap.__super__.initialize.call(this,a);this.hasInitializedMap_=!1;this.dialog_=null},render:function(){var a=templates.fourSq.page.venuedetail2.desktop.maps.overlayMap({location:this.primaryVenue.location});this.$el.empty().append(a);this.decorate();return this},show:function(){this.dialog_=(new fourSq.ui.dialog.Dialog({contentElement:this.$el,className:"mapOverlay",
hasCloseButton:!1,opacity:.88,positionTop:!1})).show();if(!this.hasInitializedMap_){var a=Math.floor($(window).height()-2*Math.max(this.dialog_.$el.offset().top,this.$el.find(".footer").outerHeight(!0)));this.$el.find("#overlayMap").height(a);this.initMap();this.initPopInMapButton_();this.initDirectionsClickTracking_();this.initCenterMapControl();this.hasInitializedMap_=!0}return this},getMapId:function(){return"overlayMap"},getTooltipPositioner:function(a,b,c){return new fourSq.newpin.CenteredAboveBelowTooltipPositioner({map:a,
latLng:b,buffer:0,pinSize:c})},showTooltipCarat:function(){return!0},getSection:function(){return fourSq.stats.action.Section.VENUE_DETAIL_OVERLAY_MAP},initPopInMapButton_:function(){var a=new fourSq.venue2.desktop.map.PopInMapControl;a.on(fourSq.venue2.desktop.map.PopInMapControl.Events.CLICK,fourSq.bind(function(){this.dialog_.close();var a=fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,{element:fourSq.stats.action.Element.POP_IN_MAP,section:fourSq.stats.action.Section.VENUE_DETAIL_OVERLAY_MAP});
fourSq.stats.logActions(a)},this));this.map_.addControl(a)},initDirectionsClickTracking_:function(){this.$el.find(".directionsLink").click(fourSq.bind(function(){var a=fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,{element:fourSq.stats.action.Element.VENUE_DIRECTIONS,component:fourSq.stats.action.Component.MAP,section:this.getSection()});fourSq.stats.logActions(a)},this))}});fourSq.venue2.desktop.map.PopInMapControl=function(a,b){};fourSq.venue2.desktop.map.PopInMapControl=fourSq.venue2.desktop.map.BaseMapControl.extend({getButtonHtml:function(){return templates.fourSq.page.venuedetail2.desktop.maps.popInMapButton()},getClickEvent:function(){return fourSq.venue2.desktop.map.PopInMapControl.Events.CLICK}});fourSq.venue2.desktop.map.PopInMapControl.Events={CLICK:"CLICK"};fourSq.venue2.desktop.map.PopOutMapControl=function(a,b){};fourSq.venue2.desktop.map.PopOutMapControl=fourSq.venue2.desktop.map.BaseMapControl.extend({getButtonHtml:function(){return templates.fourSq.page.venuedetail2.desktop.maps.popOutMapButton()},getClickEvent:function(){return fourSq.venue2.desktop.map.PopOutMapControl.Events.CLICK}});fourSq.venue2.desktop.map.PopOutMapControl.Events={CLICK:"CLICK"};fourSq.venue2.desktop.map.SmallMap=function(a){};
fourSq.venue2.desktop.map.SmallMap=fourSq.venue2.desktop.map.VenueMap.extend({initialize:function(a){var b=(new fourSq.venue2.desktop.map.OverlayMap({primaryVenue:a.primaryVenue,checkinLocations:a.checkinLocations_||[]})).render();fourSq.venue2.desktop.map.SmallMap.__super__.initialize.call(this,_.extend({},a,{overlayMap:b}))},decorate:function(){fourSq.venue2.desktop.map.SmallMap.__super__.decorate.call(this);this.initMap();this.initPopOutMapButton_();this.initCenterMapControl();return this},getTooltipPositioner:function(a,
b,c){return new fourSq.newpin.SmallMapTooltipPositioner({map:a,latLng:b,pinSize:c})},getMapId:function(){return"vmap"},showTooltipCarat:function(){return!1},getSection:function(){return fourSq.stats.action.Section.SIDEBAR},initPopOutMapButton_:function(){var a=new fourSq.venue2.desktop.map.PopOutMapControl;a.on(fourSq.venue2.desktop.map.PopOutMapControl.Events.CLICK,fourSq.bind(function(){this.overlayMap_.show();var a=fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,{element:fourSq.stats.action.Element.POP_OUT_MAP,
component:fourSq.stats.action.Component.MAP,section:this.getSection()});fourSq.stats.logActions(a)},this));this.map_.addControl(a)}});fourSq.venue2.desktop.map.SmallMapboxMap=function(a){};
fourSq.venue2.desktop.map.SmallMapboxMap=fourSq.ui.View.extend({initialize:function(a){fourSq.venue2.desktop.map.SmallMapboxMap.__super__.initialize.call(this,_.extend({},a,{}));this.primaryVenue=a.primaryVenue;this.map_=null;this.fuzzyLocation_=!!this.primaryVenue.location.isFuzzed;this.initialZoom_=null;this.checkinLocations_=a.checkinLocations},initMap:function(){this.initialZoom_=this.fuzzyLocation_?13:15;mapboxgl.accessToken="pk.eyJ1IjoiZm91cnNxdWFyZSIsImEiOiJjRGRqOVZZIn0.rMLhJeqI_4VnU2YdIJvD3Q";this.map_=
new mapboxgl.Map({container:this.getMapId(),style:"mapbox://styles/mapbox/streets-v11",center:[this.primaryVenue.location.lng,this.primaryVenue.location.lat],zoom:this.initialZoom_});if(!this.fuzzyLocation_){var a=$("\x3cdiv class\x3d'categoryMapMarker'\x3e"+helpers.pin.categoryPin({venue:this.primaryVenue,orange:!1})+"\x3c/div\x3e")[0];(new mapboxgl.Marker(a,{anchor:"bottom"})).setLngLat([this.primaryVenue.location.lng,this.primaryVenue.location.lat]).addTo(this.map_)}_.each(this.checkinLocations_,
fourSq.bind(function(a){var c=document.createElement("div");c.className="marker";c.style.backgroundImage="url(https://ss0.4sqi.net/img/map/blue-dot1-0ff549cde99f37c162b3404c7ff8eb6f.png)";c.style.width="10px";c.style.height="10px";c.style.backgroundSize="100%";(new mapboxgl.Marker(c,{anchor:"bottom"})).setLngLat([a.lng,a.lat]).addTo(this.map_)},this))},decorate:function(){fourSq.venue2.desktop.map.SmallMapboxMap.__super__.decorate.call(this);this.initMap();return this},getMapId:function(){return"vmap"}});fourSq.venue2.desktop.tips.TastePileView=function(a){};
fourSq.venue2.desktop.tips.TastePileView=fourSq.ui.View.extend({initialize:function(a){fourSq.venue2.desktop.tips.TastePileView.__super__.initialize.call(this,a);this.venue_=a.venue;this.currentTasteName_=this.currentTasteId_=null;this.$tipCount_=a.tipCountEl},decorate:function(){var a=this.$el.find(".tastePile").find(".taste");a.click(fourSq.bind(function(b){var c=$(b.currentTarget);if(c.hasClass("seeAllTasteLink"))c.remove(),a.removeClass("hidden");else{b=c.data("id")||null;var d=c.data("name")||
null,c=c.data("index")||void 0;this.selectTaste(b,d,!0);b=fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,{section:fourSq.stats.action.Section.TASTES,component:fourSq.stats.action.Component.TASTE,componentIndex:c,ids:fourSq.stats.Oids.build({venueId:this.venue_.id,tasteId:b||void 0})});fourSq.stats.logActions(b)}},this));this.$tipCount_.on("click",".clearFilterLink",fourSq.bind(function(){this.selectTaste(null,null,!0)},this));return this},selectTaste:function(a,b,c){this.currentTasteId_=
a;this.currentTasteName_=b;var d=this.$el.find(".tastePile");d.find(".taste").removeClass("selected");a?(d=d.find(".taste[data-id\x3d"+a+"]").addClass("selected"),this.currentTasteName_||(this.currentTasteName_=d.attr("data-name"))):d.find(".all").addClass("selected");c&&this.trigger(fourSq.venue2.desktop.tips.TastePileView.Events.SELECTED,a,b)},getCurrentTasteId:function(){return this.currentTasteId_},getCurrentTasteName:function(){return this.currentTasteName_}},{Events:{SELECTED:"fourSq.venue2.desktop.tips.TastePileView:SELECTED"}});fourSq.venue2.desktop.tips.TipImpressionLogger=function(a){};
fourSq.venue2.desktop.tips.TipImpressionLogger=fourSq.Class.extend({initialize:function(a){this.contentIdFunc_=a.contentIdFunc||function(a){return a.data("id")||null};this.contentImpressionLogger_=new fourSq.impressions.ContentImpressionLogger({section:fourSq.stats.action.Section.TIPS_SECTION});this.impressionMonitor_=new fourSq.ui.ImpressionMonitor(a.$el,a.selector,{revealPercent:50});this.impressionMonitor_.on(fourSq.ui.ImpressionMonitor.Events.FIRST_IMPRESSION,fourSq.bind(function(a){a=this.contentIdFunc_(a);
null!==a&&this.contentImpressionLogger_.log(a,"tip")},this));this.update()},update:function(){this.impressionMonitor_.update()}});fourSq.venue2.desktop.tips.TipModalEditView=function(a){};
fourSq.venue2.desktop.tips.TipModalEditView=fourSq.ui.View.extend({initialize:function(a){this.tip_=a.tip;this.originalText_=this.tip_.text;this.isCountError_=this.isSaving_=this.isEditing_=!1;this.$text_=this.$el.find(".text");this.originalUrl_=this.tip_.url;this.$textWrapper=this.$el.find(".textWrapper");this.$editUrl=this.$el.find(".addLink");this.$tipLink=this.$el.find("#tipLink");this.renderNewEditActionControls=a.renderNewEditActionControls;this.urlEditEnabled_=a.urlEditEnabled},decorate:function(){this.$el.on("click",
".saveAction",fourSq.bind(function(a){a.stopPropagation();this.maybeSave_()},this));this.$el.on("click",".cancelAction",fourSq.bind(function(a){a.stopPropagation();this.cancel_()},this));this.maybeDecorateText_()},maybeDecorateText_:function(){this.$text_=this.$el.find(".text");this.$text_.data("tipEditDecorated")||(this.$text_.data("tipEditDecorated",!0),this.$text_.keyup(fourSq.bind(this.updateCounter_,this)),this.$text_.noLinebreaks())},edit:function(){this.setEditState_(!0);this.focusTipText_()},
cancel_:function(){!this.isSaving_&&this.isEditing_&&(this.setEditState_(!1),this.$text_.text(this.originalText_),this.removeEditButtons())},maybeSave_:function(){var a=this.$text_.text(),b=this.$tipLink.contents().val(),c=this.urlRemoved(b),d=fourSq.isDefinedAndNotNull(this.originalUrl_)&&!!b&&b!==this.originalUrl_||c,e=""===fourSq.util.trim(b),f=b&&d||d?this.urlSaveSuccess_:this.saveSuccess_,g=a!==this.originalText_,h;this.urlEditEnabled_&&(c?h={unsetUrl:!0}:!b&&!d||e||(h={url:b}));this.isSaving_||
!this.isEditing_||this.isCountError_||((b||d)&&!g&&this.urlEditEnabled_?(this.setSavingState_(!0),fourSq.api.services.Tip.edit(this.tip_.id,void 0,fourSq.bind(this.urlSaveSuccess_,this),fourSq.bind(this.saveError_,this),h)):g?(this.setSavingState_(!0),fourSq.api.services.Tip.edit(this.tip_.id,a,fourSq.bind(f,this),fourSq.bind(this.saveError_,this),h)):this.setEditState_(!1),this.removeEditButtons())},saveSuccess_:function(a){this.originalText_=a.text;this.$text_.text(this.originalText_);this.setEditState_(!1);
this.trigger(fourSq.venue2.desktop.tips.TipModalEditView.Events.SAVED)},urlSaveSuccess_:function(a){this.originalText_=a.text;this.$text_.text(this.originalText_);this.setEditState_(!1);this.trigger(fourSq.venue2.desktop.tips.TipModalEditView.Events.SAVED_URL,a.id)},saveError_:function(){var a=templates.fourSq.page.venuedetail2.common.tipModal.editTipFailed();fourSq.ui.Notifier.getInstance().warning(a);this.setSavingState_(!1)},setCountErrorState_:function(a){this.$el.removeClass("countError isOver isUnder");
a===fourSq.venue2.desktop.tips.EditCountError.TEXT_OVER?(this.$el.addClass("countError isOver"),this.isCountError_=!0):a===fourSq.venue2.desktop.tips.EditCountError.TEXT_UNDER?(this.$el.addClass("countError isUnder"),this.isCountError_=!0):a===fourSq.venue2.desktop.tips.EditCountError.NONE&&(this.isCountError_=!1)},setSavingState_:function(a){a?(this.$el.addClass("saving"),this.isSaving_=!0):(this.$el.removeClass("saving"),this.isSaving_=!1)},setEditState_:function(a){a?(this.$el.addClass("edit"),
this.$textWrapper.addClass("edit"),this.$text_.prop("contentEditable",!0),this.updateCounter_(),this.isEditing_=!0,this.$tipLink=this.$el.find("#tipLink")):(this.$el.removeClass("edit"),this.$textWrapper.removeClass("edit"),this.$text_.prop("contentEditable",!1),this.isEditing_=!1,this.setSavingState_(!1),this.trigger(fourSq.venue2.desktop.tips.TipModalEditView.Events.FINISHED_EDITING,this.$text_.text()))},focusTipText_:function(){var a=this.$text_.get(0),b=document.createRange();b.selectNodeContents(a);
b.collapse(!1);a=window.getSelection();a.removeAllRanges();a.addRange(b)},updateCounter_:function(){var a=this.$text_.text().length,b=fourSq.venue2.desktop.tips.TipModalEditView.MAX_TEXT-a;this.$el.find(".tipEditControls .textRemaining").empty().append(""+b);a>fourSq.venue2.desktop.tips.TipModalEditView.MAX_TEXT?this.setCountErrorState_(fourSq.venue2.desktop.tips.EditCountError.TEXT_OVER):a<fourSq.venue2.desktop.tips.TipModalEditView.MIN_TEXT?this.setCountErrorState_(fourSq.venue2.desktop.tips.EditCountError.TEXT_UNDER):
this.setCountErrorState_(fourSq.venue2.desktop.tips.EditCountError.NONE)},saveToMementoAndCancel:function(){var a={isEditing_:this.isEditing_,editText_:this.$text_.text()};this.cancel_();return a},restoreFromMemento:function(a){this.maybeDecorateText_();a.isEditing_&&(this.setEditState_(!0),this.$text_.text(a.editText_),this.urlEditEnabled_&&(this.urlEditView=(new fourSq.venue2.desktop.tips.TipUrlEditView({url:this.tip_.url,editLink:this.$editUrl,addLink:this.$el.find(".addLink"),tipLink:this.$el.find("#tipLink"),
urlEditEnabled:this.urlEditEnabled_})).decorate()))},removeEditButtons:function(){this.$el.find(".tipEditControls").remove();this.$el.find("#tipLink").remove();this.$el.find(".addLink").remove()},urlRemoved:function(a){return fourSq.isDefinedAndNotNull(a)?!!this.originalUrl_&&""===fourSq.util.trim(a):!1}},{MAX_TEXT:200,MIN_TEXT:10,Events:{SAVED:"SAVED",SAVED_URL:"SAVED_URL",FINISHED_EDITING:"FINISHED_EDITING"}});
fourSq.venue2.desktop.tips.EditCountError={TEXT_OVER:"TEXT_OVER",TEXT_UNDER:"TEXT_UNDER",NONE:"NONE"};fourSq.venue2.desktop.tips.TipUrlEditView=function(a){};
fourSq.venue2.desktop.tips.TipUrlEditView=fourSq.ui.View.extend({initialize:function(a){this.url=a.url;this.editLink_=a.editLink;this.addLink=a.addLink;this.tipLink=a.tipLink;this.urlEditEnabled=a.urlEditEnabled},decorate:function(){this.checkClick();this.renderUrlEditInput();return this},renderUrlEditInput:function(){this.url&&this.urlEditEnabled?(this.addLink.hide(),this.tipLink.contents().val(this.url)):this.tipLink.hide()},setUrl:function(a){this.url=a},checkClick:function(){this.addLink.click(fourSq.bind(function(){this.tipLink.show();
this.addLink.hide()},this))}});fourSq.venue2.desktop.tips.TipModal=function(a){};
fourSq.venue2.desktop.tips.TipModal=fourSq.venue2.common.BaseTipModal.extend({initialize:function(a){fourSq.venue2.desktop.tips.TipModal.__super__.initialize.call(this,a);this.listServiceProxy_=a.listServiceProxy;this.tipFeedBackCache_=a.tipfeedbackcache;this.useTipUpvotes_=a.useTipUpvotes;this.renderNewEditActionControls=a.renderNewEditActionControls;this.urlEditEnabled=a.urlEditEnabled;this.photos=a.photos},decorate:function(){this.readUrlAndRenderModal_();return this},updateTips:function(a){this.tipCache_=
{};_.each(a.items,function(a){this.tipCache_[a.id]=a},this)},addVenueToTip_:function(){this.currentTip_.venue=this.venue},decorateActionButtons:function(a){var b={section:fourSq.stats.action.Section.TIP_MODAL,component:void 0,componentIndex:void 0,ids:fourSq.api.models.companion.log.Oids.build({tipId:this.currentTip_.id})};(new fourSq.ui.save.SaveButton({el:$(".tipModalDialog .save-button, .tipModalDialog .saveButton"),listService:this.listServiceProxy_,savedStateIsOnTip:!0,tip:this.currentTip_,venue:this.venue})).decorate();
this.useTipUpvotes_?(this.tipUpvoteDownvoteButton_=new fourSq.ui.liking.TipUpvoteDownvoteButton({tip:this.currentTip_,lastVoteEl:$(".tipModalDialog .lastVoteTime")}),$(".tipModalDialog .upvoteContainer").prepend(this.tipUpvoteDownvoteButton_.$el)):this.likeButton=(new fourSq.ui.liking.LikeButtonWithFallback({el:$(".tipModalDialog .likeButtonContainer"),isLiked:this.currentTip_.like,likes:this.currentTip_.likes,controller:a,template:templates.fourSq.ui.liking.basicLikeLink,includeCount:!0,excludeSummary:!0,
actionOptions:b})).render();this.editButton=new fourSq.venue2.desktop.tips.TipModalEditView({tip:this.currentTip_,el:$(".tipModalDialog").get(0),renderNewEditActionControls:this.renderNewEditActionControls,urlEditEnabled:this.urlEditEnabled});a=templates.fourSq.page.venuedetail2.common.tipModal.tipPhotoUploadControl({id:this.currentTip_.id});$(".tipAddPhotoContainer").empty().append(a);this.picker=new fourSq.ui.PhotoPicker({el:$(".tipModalDialog .tipAddPhotoContainer"),onChosenCallback:fourSq.bind(this.trySavePhoto_,
this)});$(".tipModalDialog .shareTipLink, .tipModalDialog .doubleShareButton").click(fourSq.bind(function(){this.shareDialog||(this.shareDialog=new fourSq.venue2.desktop.VenueShareDialog({name:this.venue.name,url:this.currentTip_.canonicalUrl}),this.shareDialog.on(fourSq.venue2.desktop.VenueShareDialog.Events.SOCIAL_SHARE,function(){this.dialog.close()},this));this.shareDialog.show();this.shareActionLogging_()},this));a=$(".deleteTip");0<a.length&&a.click(fourSq.bind(function(){window.confirm(helpers.tip.deleteConfirmMsg())&&
(this.trigger(fourSq.venue2.common.BaseTipModal.Events.DELETE,[{tipId:this.currentTip_.id}]),this.dialog.close())},this));a=$(".removeUrl");0<a.length&&a.click(fourSq.bind(function(){this.trigger(fourSq.venue2.common.BaseTipModal.Events.REMOVE_URL,{tipId:this.currentTip_.id})},this));a=$(".deletePhoto");0<a.length&&a.click(fourSq.bind(function(){this.trigger(fourSq.venue2.common.BaseTipModal.Events.DELETE_PHOTO,{tipId:this.currentTip_.id})},this));a=$(".tipModalDialog .reportTip");0<a.length&&(b=
new fourSq.views.TipFlagMenu({anchor:a.eq(0),tipId:this.currentTip_.id}),a.click(fourSq.bind(b.open,b)));$(".tipModalDialog .editTip").click(fourSq.bind(function(){this.editAction()},this));$(".tipModalDialog .uploadPhoto").click(fourSq.bind(function(){this.addPhoto_()},this));$(".tipModalDialog .save-button").click(fourSq.bind(function(){this.saveActionLogging_()},this));this.editButton.on(fourSq.venue2.desktop.tips.TipModalEditView.Events.SAVED,fourSq.bind(function(){this.trigger(fourSq.venue2.common.BaseTipModal.Events.UPDATE)},
this));this.editButton.on(fourSq.venue2.desktop.tips.TipModalEditView.Events.SAVED_URL,fourSq.bind(function(a){this.trigger(fourSq.venue2.common.BaseTipModal.Events.UPDATE_AND_RENDER,a)},this));return this},readUrlAndRenderModal_:function(){var a=this.parseUrlToTipId();a&&this.showTipModalByTipId(a,this.tipFeedBackCache_.getOrCreate(a))},showTipModalByTipId:function(a,b){this.addReferrer=!0;a&&fourSq.api.services.Tip.detail(a,fourSq.bind(function(a){this.venue.id===a.venue.id?(this.currentTip_=a,
this.renderAndDecorateModal_(a,b)):fourSq.debug.error("Tip doesn't belong to venue.")},this),function(){fourSq.debug.error("Unable to retrieve tips")})},rerenderTipPhotoContents_:function(){var a=this.editButton.saveToMementoAndCancel(),b=$(".tipModalDialog .tipText");this.currentTip_.photo?b.addClass("withPhoto"):b.removeClass("withPhoto");var c=templates.fourSq.page.venuedetail2.common.tipModal.tipPhotoTextContents({tip:this.currentTip_,useTipUpvotes:this.useTipUpvotes_,renderNewEditActionControls:this.renderNewEditActionControls,
urlEditEnabled:this.urlEditEnabled});b.find(".textWrapper").append(c);this.editButton.restoreFromMemento(a)},addPhoto_:function(){$(".tipModalDialog .uploadPhoto input")[0].click()},trySavePhoto_:function(){this.picker.save(fourSq.bind(this.onSaveSuccess,this),fourSq.bind(this.onSaveFailure,this))},onSaveSuccess:function(){this.trigger(fourSq.venue2.common.BaseTipModal.Events.UPDATE);var a=this.tipFeedBackCache_.getOrCreate(this.currentTip_.id);this.dialog.close();this.showTipModalByTipId(this.currentTip_.id,
a)},onSaveFailure:function(){fourSq.emptyFunction()},editAction:function(){this.editButton.edit();this.rerenderTipPhotoContents_();this.editButton.decorate()},renderAndDecorateModal_:function(a,b){this.currentTip_=a;var c=a.photo?!1:!0,d=c?"noTipPhoto":"",e=void 0!==a.url;this.currentTip_.venue||this.addVenueToTip_();var f=this.currentUserOwnsTip(),c=$(templates.fourSq.page.venuedetail2.common.tipModal.tipModal({tip:a,venue:this.venue,isCurrentUser:f,canDeleteTip:f||fourSq.config.user.IS_CONTENT_MODERATOR,
canUploadPhoto:c,isMobile:!1,useTipUpvotes:this.useTipUpvotes_,renderNewEditActionControls:this.renderNewEditActionControls,urlEditEnabled:this.urlEditEnabled,hasUrl:e,photos:this.photos}));this.dialog=(new fourSq.ui.dialog.Dialog({contentElement:c,className:"tipModalDialog",overlayClass:"tipModalOverlay",contentClassName:d})).show();this.openActionLogging();this.decorateActionButtons(b);fourSq.util.parseParams().tipId||this.setUrl_();this.dialog.on(fourSq.ui.dialog.Dialog.Events.DIALOG_CLOSE,function(){this.closeActionLogging();
this.revertUrl_()},this)},shareActionLogging_:function(){var a=fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK),a=_.extend(a,{action:fourSq.stats.action.Element.SHARE},this.baseLoggingInfo_());fourSq.stats.logActions(a)},saveActionLogging_:function(){var a=fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK),a=_.extend(a,{action:fourSq.stats.action.Element.SAVE},this.baseLoggingInfo_());fourSq.stats.logActions(a)},closeAndReRenderModal:function(a){var b=this.tipFeedBackCache_.getOrCreate(a);
this.dialog.close();this.showTipModalByTipId(a,b)}});fourSq.venue2.desktop.tips.TipsSection=function(a){};
fourSq.venue2.desktop.tips.TipsSection=fourSq.ui.View.extend({initialize:function(a){fourSq.venue2.desktop.tips.TipsSection.__super__.initialize.call(this,a);this.venue_=a.venue;this.tips_=a.tips;this.nonTipJustifications_=null;this.listServiceProxy_=a.listServiceProxy;this.$searchInput_=this.$el.find("input.searchInput");this.tastePileView_=null;this.pageSize_=a.pageSize;this.currentPageIndex_=a.currentPageIndex;this.requestNumber_=0;this.history_=a.history;this.$sortOptionsList_=this.$el.find(".sortControls ul.sortOptions");
this.$tipsSection_=this.$el.find(".tipsSection");this.$tipsListSection_=this.$el.find(".tipsListSection");this.$sectionTitle_=this.$el.find(".sectionTitle");this.sort_=a.tipSort;this.totalTipCount_=a.tipCount||this.tips_.count;this.renderNewEditActionControls_=a.renderNewEditActionControls;this.urlEditEnabled_=a.urlEditEnabled;this.topPhotos_=a.topPhotos;this.tipfeedbackcache_=new fourSq.ui.save.TipFeedbackControllerCache;this.showVoting_=a.showVoting;this.useTipUpvotes_=a.useTipUpvotes;this.scrollToTipsCompose_=
a.scrollToTipsCompose;this.scrollToTipsView_=a.scrollToTipsView;this.tipImpressionLogger_=new fourSq.venue2.desktop.tips.TipImpressionLogger({$el:this.$el,selector:"li.tipWithLogging"});this.$searchControls_=this.$el.find(".searchControls");this.tipModal_=(new fourSq.venue2.desktop.tips.TipModal({venue:this.venue_,history:this.history_,tips:this.tips_.items,listServiceProxy:this.listServiceProxy_,tipfeedbackcache:this.tipfeedbackcache_,useTipUpvotes:this.useTipUpvotes_,renderNewEditActionControls:this.renderNewEditActionControls_,
urlEditEnabled:this.urlEditEnabled_,photos:this.topPhotos_})).decorate();this.tipModal_.on(fourSq.venue2.common.BaseTipModal.Events.DELETE,fourSq.bind(function(a){(a=a[0].tipId)&&this.deleteTip_(a)},this));this.tipModal_.on(fourSq.venue2.common.BaseTipModal.Events.DELETE_PHOTO,fourSq.bind(function(a){(a=a.tipId)&&this.deleteTipPhoto_(a)},this));this.tipModal_.on(fourSq.venue2.common.BaseTipModal.Events.REMOVE_URL,fourSq.bind(function(a){(a=a.tipId)&&this.removeTipUrl_(a)},this));this.tipModal_.on(fourSq.venue2.common.BaseTipModal.Events.UPDATE,
fourSq.bind(function(){this.updateTips(this.makeHistoryState_(0),fourSq.venue2.desktop.StateManager.HistoryMode.PUSH)},this));this.tipModal_.on(fourSq.venue2.common.BaseTipModal.Events.UPDATE_AND_RENDER,fourSq.bind(function(a){this.updateTips(this.makeHistoryState_(0),fourSq.venue2.desktop.StateManager.HistoryMode.PUSH);this.tipModal_.closeAndReRenderModal(a)},this));this.justificationsView_=(new fourSq.venue2.desktop.JustificationsView({el:this.$el.find(".justificationsSection"),venue:this.venue_})).decorate().on(fourSq.venue2.desktop.JustificationsView.Events.CLICK,
fourSq.bind(this.filterOnTaste,this))},decorate:function(){this.loadInitialTips_().decorateSortOptions_().decorateSearchControls_().decorateCancelQuery_().decorateTips_(this.tips_.items).tipDateLinks_().tipLogging_().decoratePagination_().decorateTipAddForm_().decorateTastePile_().decorateMenuLink_();return this},loadInitialTips_:function(){var a=fourSq.venue2.desktop.StateManager.makeStateFromUrl();this.currentState_=a;if(a.query||a.tipsPage||a.sort||a.tasteId){if(a.sort){var b=this.$sortOptionsList_.find('li[data-sort\x3d"'+
a.sort+'"]');this.selectSortOption_(b)}this.updateTips(a,fourSq.venue2.desktop.StateManager.HistoryMode.SKIP_PERSIST)}return this},decorateSortOptions_:function(){this.$sortOptionsList_.find("li").click(fourSq.bind(function(a){a=$(a.currentTarget);this.sort_=a.data("sort");this.selectSortOption_(a);this.updateTipsAndLog_(this.makeHistoryState_(0),fourSq.stats.action.Element.TIP_SORT_LINK)},this));return this},selectSortOption_:function(a){this.$sortOptionsList_.find("li").removeClass("selected");
a.addClass("selected");return this},decorateSearchControls_:function(){this.$searchInput_.keypress(fourSq.bind(function(a){13===a.which&&(this.setQuery_(this.getQuery_()),this.resetTasteFilter_(),this.updateTipsAndLog_(this.makeHistoryState_(0),fourSq.stats.action.Element.TIP_FILTER_INPUT))},this));return this},decorateCancelQuery_:function(){this.$el.find(".clearQuery").click(fourSq.bind(function(){this.setQuery_("");this.resetTasteFilter_();this.updateTipsAndLog_(this.makeHistoryState_(0),fourSq.stats.action.Element.TIP_FILTER_CANCEL)},
this));return this},decorateTips_:function(a){_.each(this.$el.find("#tipsContainer ul#tipsList li.tip").toArray(),fourSq.bind(function(b,c){var d=$(b),e=a[c],f;if(this.useTipUpvotes_)f=new fourSq.ui.liking.TipUpvoteDownvoteButton({tip:e,lastVoteEl:d.find(".lastVoteTime")}),d.find(".actionButtons").prepend(f.$el),f.on(fourSq.ui.liking.TipUpvoteDownvoteButton.Events.VOTE,function(a){d.toggleClass("downvotedTip",!!a.disagreed)}),f=d.find(".tipMoreFlyout"),f.length&&(f=new fourSq.ui.tip.MoreMenu({anchor:f,
tip:e,venue:this.venue_}),f.on(fourSq.ui.tip.MoreMenu.Events.DELETE,function(a){window.confirm(helpers.tip.deleteConfirmMsg())&&(this.logClick_(fourSq.stats.action.Element.TIP_DELETE),this.deleteTip_(a.id))},this),f.on(fourSq.ui.tip.MoreMenu.Events.EDIT,function(a){this.tipModal_.showTipModalByTip(a,this.tipfeedbackcache_.getOrCreate(a.id));this.tipModal_.editAction()},this));else{this.tipfeedbackcache_.inCache(e.id)?f=this.tipfeedbackcache_.get(e.id):(f=new fourSq.api.controllers.TipFeedbackController(e.id),
this.tipfeedbackcache_.prime(e.id,f));var g=d.find(".save-button");g.length&&(new fourSq.ui.save.SaveButton({el:g,listService:this.listServiceProxy_,savedStateIsOnTip:!0,tip:e,venue:this.venue_})).decorate();g=d.find(".likeButtonContainer");g.length&&(new fourSq.ui.liking.LikeButtonWithFallback({el:g,isLiked:e.like,likes:e.likes,controller:f,template:templates.fourSq.ui.liking.basicLikeLink,includeCount:!0,excludeSummary:!0})).render();f=d.find(".flagTipLink");f.length&&(g=new fourSq.views.TipFlagMenu({anchor:f.eq(0),
tipId:e.id}),f.click(fourSq.bind(g.open,g)));f=d.find(".deleteTipLink");if(0<f.length){var h=this;f.click(function(){window.confirm(helpers.tip.deleteConfirmMsg())&&(h.logClick_(fourSq.stats.action.Element.TIP_DELETE),h.deleteTip_(e.id))})}d.find(".editTipLink").click(fourSq.bind(function(a){a.preventDefault();this.tipModal_.showTipModalByTip(e,this.tipfeedbackcache_.getOrCreate(e.id));this.tipModal_.editAction()},this))}d.find(".tipPhoto").click(fourSq.bind(function(){e.photo&&(e.photo.user=e.user,
fourSq.views.PhotoViewer.openSinglePhoto(e.photo,this.showVoting_,!1))},this))},this));return this},decoratePagination_:function(){this.$el.find(".paginationContainer a.pageLink").click(fourSq.bind(function(a){a=$(a.currentTarget);a=parseInt(a.data("index"),10);this.updateTipsAndLog_(this.makeHistoryState_(a),fourSq.stats.action.Element.TIP_PAGINATION_LINK);this.scrollTop();return!1},this));return this},decorateTastePile_:function(){this.venue_.tastes&&(this.tastePileView_=(new fourSq.venue2.desktop.tips.TastePileView({el:this.$el.find(".tastes"),
venue:this.venue_,tipCountEl:this.$el.find(".tipCount")})).decorate(),this.tastePileView_.on(fourSq.venue2.desktop.tips.TastePileView.Events.SELECTED,fourSq.bind(function(a,b){this.setQuery_("");this.updateTips(this.makeHistoryState_(0),fourSq.venue2.desktop.StateManager.HistoryMode.PUSH,b)},this)));return this},filterOnTaste:function(a,b){this.tastePileView_&&(this.tastePileView_.selectTaste(a,b,!0),this.scrollTop())},decorateTipAddForm_:function(){var a=this.$el.find(".addTipBlock"),b=a.find("textarea"),
c=(new fourSq.views.TipAddForm({el:a,venueId:this.venue_.id,metrics:"",noPhotoResizing:!0})).decorate();c.on(fourSq.views.TipAddForm.Events.PHOTO_ADDED,function(){b.addClass("selected")});c.setNewTipCallback(fourSq.bind(function(a){var c=this.tips_.items.slice(0,this.pageSize_-1);c.unshift(a);this.tips_={count:this.tips_.count+1,items:c};this.totalTipCount_++;this.tipModal_.updateTipInTipCache(a);this.renderTips_(!1);b.removeClass("selected")},this));this.$el.find(".addTipBlock textarea, .input-default").click(function(){b.addClass("selected")}).noLinebreaks();
(this.scrollToTipsCompose_||this.scrollToTipsView_)&&_.defer(fourSq.bind(function(){this.scrollToTipsCompose_?(fourSq.ui.util.scrollTo(a,{animate:!0,buffer:70}),_.defer(function(){b.click().focus()},1E3)):this.scrollToTipsView_&&this.scrollTop()},this),2E3);b.on("focusout",function(){b.val().length||c.hasTipPhoto()||b.removeClass("selected")});return this},decorateMenuLink_:function(){this.$el.on("click","li.nonTipJustification.menu",fourSq.bind(function(){this.trigger(fourSq.venue2.desktop.tips.TipsSection.Events.CLICK_MENU_LINK)},
this));return this},renderTips_:function(a){a=templates.fourSq.page.venuedetail2.desktop.tips.tipList({tips:this.tips_,nonTipJustifications:this.nonTipJustifications_,pageSize:this.pageSize_,currentPage:this.currentPageIndex_,fromQuery:a,venue:this.venue_,currentUser:fourSq.api.models.companion.user.UserUtil.currentUser(),tipCount:this.totalTipCount_,useTipUpvotes:this.useTipUpvotes_});this.$el.find("#tipsContainer").empty().append(a);a=this.tastePileView_&&this.tastePileView_.getCurrentTasteName();
var b=this.$el.find(".tipCount").empty().hide();a&&b.append(templates.fourSq.page.venuedetail2.common.tips.tipCount({count:this.tips_.count,totalCount:this.totalTipCount_,hasTasteFilters:!!(this.venue_.tastes&&this.venue_.tastes.items&&0<this.venue_.tastes.items.length),selectedTaste:a})).show();this.decorateTips_(this.tips_.items);this.tipDateLinks_();this.tipLogging_();this.decoratePagination_()},setQuery_:function(a){this.$searchInput_.val(a)},getQuery_:function(){return this.$searchInput_.val()},
getTasteId_:function(){return this.tastePileView_?this.tastePileView_.getCurrentTasteId()||"":""},resetTasteFilter_:function(){this.tastePileView_&&this.tastePileView_.selectTaste(null,null)},updateTipsAndLog_:function(a,b,c){this.updateTips(a,c);this.logClick_(b,{details:a})},updateTips:function(a,b,c){this.requestNumber_++;var d=this.requestNumber_,e={offset:a.tipsPage*this.pageSize_,limit:this.pageSize_};a.tasteId?e.tasteId=a.tasteId:a.query?e.query=a.query:a.sort&&(e.sort=a.sort);this.$tipsListSection_.addClass("loading");
this.updateHistory(a,b);b=fourSq.bind(function(){this.$tipsListSection_.removeClass("loading")},this);fourSq.api.services.Venue.tips(this.venue_.id,e,fourSq.bind(function(b){var e=b.tips;this.tipModal_.updateTips(b.tips);d===this.requestNumber_&&(this.currentPageIndex_=a.tipsPage,this.tips_=e,this.nonTipJustifications_=b.justifications,a.query||a.tasteId||(this.totalTipCount_=this.tips_.count),this.tastePileView_&&this.tastePileView_.selectTaste(a.tasteId,c),this.renderTips_(!!a.query),this.$el.find(".searchControls").toggleClass("cancelable",
!!a.query),this.$tipsListSection_.removeClass("loading"),this.$el.find(".sortControls").toggle(!a.query&&!a.tasteId))},this),b)},makeHistoryState_:function(a){return fourSq.venue2.desktop.StateManager.makeTipsState(a,this.sort_,this.getQuery_(),this.getTasteId_(),"",!0)},updateHistory:function(a,b){this.currentState_=a=a||this.currentState_;fourSq.venue2.desktop.StateManager.updateHistory(this.venue_,this.history_,a,b)},tipDateLinks_:function(){this.$el.find(".tipDate").click(fourSq.bind(function(a){a=
$(a.currentTarget).parents(".tip").data("id");this.tipModal_.show(a,this.tipfeedbackcache_.get(a))},this));return this},tipLogging_:function(){this.logLinkClick_(this.$el.find(".addTipTeaser a"),fourSq.stats.action.Element.LOGIN);this.logTipLinkClick_(this.$el.find(".authorImage a"),fourSq.stats.action.Element.FACE);this.logTipLinkClick_(this.$el.find(".userName a"),fourSq.stats.action.Element.USER_NAME);this.$el.find(".tipPhoto").click(fourSq.bind(function(){this.logClick_(fourSq.stats.action.Element.PHOTO,
{component:fourSq.stats.action.Component.TIP})},this));this.$el.find(".tipText a").click(fourSq.bind(function(){this.logTipClick_(fourSq.stats.action.Element.TIP_LINK)},this));this.tipImpressionLogger_.update();return this},buildLoggingAction_:function(a,b){var c=_.extend({element:a,section:fourSq.stats.action.Section.TIPS_SECTION},b||{});return fourSq.stats.Action.build(fourSq.stats.action.Action.CLICK,c)},logClick_:function(a,b){fourSq.stats.logActions(this.buildLoggingAction_(a,b))},logClickWithDelay_:function(a,
b,c){fourSq.stats.logActionWithDelay(this.buildLoggingAction_(a,c),b)},logTipClick_:function(a){this.logClick_(a,{component:fourSq.stats.action.Component.TIP})},logLinkClick_:function(a,b,c){var d=this;_.each(a.toArray(),function(a){fourSq.stats.Util.logActionOnLinkClick($(a),function(){return d.buildLoggingAction_(b,c)})})},logTipLinkClick_:function(a,b){this.logLinkClick_(a,b,{component:fourSq.stats.action.Component.TIP})},deleteTip_:function(a){var b=this;fourSq.api.services.Tip.deletetip({id:a},
function(){fourSq.ui.Notifier.getInstance().info(templates.fourSq.page.venuedetail2.desktop.messages.tipDeleteMessage());var c=_.filter(b.tips_.items,function(b){return a!==b.id});b.tips_={count:b.tips_.count-1,items:c};b.tipModal_.updateTips(b.tips_);b.totalTipCount_--;b.renderTips_(!1)},function(){fourSq.ui.Notifier.getInstance().genericServerError()})},scrollTop:function(){fourSq.ui.util.scrollTo(this.$sectionTitle_,{animate:!0,buffer:70})},deleteTipPhoto_:function(a){fourSq.api.services.Tip.edit(a,
void 0,fourSq.bind(function(){fourSq.ui.Notifier.getInstance().info(templates.fourSq.page.venuedetail2.desktop.messages.tipPhotoDeleteMessage());this.updateTips(this.makeHistoryState_(0),fourSq.venue2.desktop.StateManager.HistoryMode.PUSH);this.tipModal_.closeAndReRenderModal(a)},this),fourSq.bind(function(){fourSq.ui.Notifier.getInstance().genericServerError()},this),{unsetPhoto:!0})},removeTipUrl_:function(a){fourSq.api.services.Tip.edit(a,void 0,fourSq.bind(function(){fourSq.ui.Notifier.getInstance().info(templates.fourSq.page.venuedetail2.desktop.messages.tipUrlRemoveMessage());
this.updateTips(this.makeHistoryState_(0),fourSq.venue2.desktop.StateManager.HistoryMode.PUSH);this.tipModal_.closeAndReRenderModal(a)},this),fourSq.bind(function(){fourSq.ui.Notifier.getInstance().genericServerError()},this),{unsetUrl:!0})}},{Events:{CLICK_MENU_LINK:"click-menu-link"}});"undefined"==typeof templates.fourSq&&(templates.fourSq={});"undefined"==typeof templates.fourSq.page&&(templates.fourSq.page={});"undefined"==typeof templates.fourSq.page.venuedetail2&&(templates.fourSq.page.venuedetail2={});"undefined"==typeof templates.fourSq.page.venuedetail2.common&&(templates.fourSq.page.venuedetail2.common={});"undefined"==typeof templates.fourSq.page.venuedetail2.common.related&&(templates.fourSq.page.venuedetail2.common.related={});
templates.fourSq.page.venuedetail2.common.related.relatedVenueListItem=function(a,b){var c='\x3cli class\x3d"sidebarVenue '+(a.promoted?"promotedSidebarVenue":"")+'" data-venueid\x3d"'+soy.$$escapeHtml(a.relatedVenue.id)+'"\x3e\x3ca href\x3d"'+helpers.venue.href(a.relatedVenue)+'" class\x3d"relatedVenueLink" data-venueid\x3d"'+soy.$$escapeHtml(a.relatedVenue.id)+'"'+(a.promoted?'data-promotionId\x3d"'+soy.$$escapeHtml(a.promoted.id)+'"':"")+"\x3e",d=null==a.relatedVenue?null:null==a.relatedVenue.photos?
null:null==a.relatedVenue.photos.groups?null:null==a.relatedVenue.photos.groups[0]?null:null==a.relatedVenue.photos.groups[0].items?null:a.relatedVenue.photos.groups[0].items[0];return c+='\x3cdiv class\x3d"venuePhotoWrapper"\x3e'+(d?helpers.photo.squareImage(soy.$$augmentMap(d,{size:60})):helpers.venue.primaryCategoryIcon({categories:a.relatedVenue.categories,size:60,transparent:!1}))+'\x3c/div\x3e\x3cdiv class\x3d"sidebarVenueInfo"\x3e\x3cp class\x3d"venueName"\x3e'+soy.$$escapeHtml(a.relatedVenue.name)+
'\x3c/p\x3e\x3cdiv class\x3d"venueCategoryAndPrice"\x3e'+(a.relatedVenue.categories[0]?'\x3cspan class\x3d"category"\x3e'+helpers.venue.venueCategory({venue:a.relatedVenue})+"\x3c/span\x3e":"")+((null==a.relatedVenue.price?0:a.relatedVenue.price.tier)?helpers.venue.price(a.relatedVenue.price):"")+'\x3c/div\x3e\x3cp class\x3d"venueMetaData"\x3e'+(a.relatedVenue.rating?helpers.venue.compactRating(soy.$$augmentMap(a.relatedVenue,{hideDenom:!0})):"")+(a.promoted?"":'\x3cspan class\x3d"address"\x3e'+helpers.venue.addressWithCross(a.relatedVenue)+
"\x3c/span\x3e")+(a.tip&&a.promoted?'\x3cdiv\x3e\x3cspan class\x3d"tipText"\x3e'+soy.$$escapeHtml(a.tip.text)+'\x3c/span\x3e\x3cdiv class\x3d"adsPPPromoted"\x3e\x3cimg class\x3d"adsPPPromotedIcon" alt\x3d"promoted content icon" src\x3d"'+soy.$$escapeHtml("https://ss1.4sqi.net/img/explore/promotedbolt-2174e590436adf67e941bcdbdc5463b8.png")+'"\x3e\x3cspan class\x3d"adsPPPromotedText"\x3eAd\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e':"")+"\x3c/p\x3e\x3c/div\x3e\x3c/a\x3e\x3c/li\x3e"};"undefined"==typeof templates.fourSq&&(templates.fourSq={});"undefined"==typeof templates.fourSq.page&&(templates.fourSq.page={});"undefined"==typeof templates.fourSq.page.venuedetail2&&(templates.fourSq.page.venuedetail2={});"undefined"==typeof templates.fourSq.page.venuedetail2.common&&(templates.fourSq.page.venuedetail2.common={});"undefined"==typeof templates.fourSq.page.venuedetail2.common.tips&&(templates.fourSq.page.venuedetail2.common.tips={});
templates.fourSq.page.venuedetail2.common.tips.tipCount=function(a,b){return a.selectedTaste?(0==a.count?"No tips match '"+soy.$$escapeHtml(a.selectedTaste)+"'":1==a.count?"1 tip matches '"+soy.$$escapeHtml(a.selectedTaste)+"'":soy.$$escapeHtml(a.count)+" tips match '"+soy.$$escapeHtml(a.selectedTaste)+"'")+'\x3cspan class\x3d"clearFilterLink"\x3eclear filter\x3c/span\x3e':a.count<a.totalCount?soy.$$escapeHtml(a.count)+" of "+soy.$$escapeHtml(a.totalCount)+" Tips":a.hasTasteFilters?helpers.tip.count({count:a.totalCount,
capitalize:!1})+". ":helpers.tip.count({count:a.totalCount,capitalize:!a.noCapitalization})};
templates.fourSq.page.venuedetail2.common.tips.nonTipJustifications=function(a,b){a=a||{};for(var c="",d=a.beforeNonTipJustifications,e=d.length,f=0;f<e;f++)var g=d[f],c=c+('\x3cli class\x3d"nonTipJustification'+((null==g?0:null==g.target?0:null==g.target.object?0:0<g.target.object.url.indexOf("menu"))?" menu":"")+'"\x3e'+helpers.entities.textWithEntities(g)+" "+("path"==(null==g?null:null==g.target?null:g.target.type)&&(null==g?0:null==g.target?0:null==g.target.object?0:g.target.object.url)?'\x3cimg src\x3d"'+
soy.$$escapeHtml("https://ss1.4sqi.net/img/venuepage/arrow-22cb415d8306eff9150ae2a31a96c96f.png")+'" alt\x3d"" class\x3d"gotoMenu" height\x3d"10" width\x3d"6" /\x3e':"")+"\x3c/li\x3e");return c};"undefined"==typeof templates.fourSq&&(templates.fourSq={});"undefined"==typeof templates.fourSq.page&&(templates.fourSq.page={});"undefined"==typeof templates.fourSq.page.venuedetail2&&(templates.fourSq.page.venuedetail2={});"undefined"==typeof templates.fourSq.page.venuedetail2.common&&(templates.fourSq.page.venuedetail2.common={});"undefined"==typeof templates.fourSq.page.venuedetail2.common.justifications&&(templates.fourSq.page.venuedetail2.common.justifications={});
templates.fourSq.page.venuedetail2.common.justifications.justifications=function(a,b){var c="",d=a.venue.tippets&&0<(null!=(null==a.venue?null:null==a.venue.tippets?null:a.venue.tippets.groups)?null==a.venue?null:null==a.venue.tippets?null:a.venue.tippets.groups:[]).length&&0<(null!=(null==a.venue?null:null==a.venue.tippets?null:null==a.venue.tippets.groups[0]?null:a.venue.tippets.groups[0].items)?null==a.venue?null:null==a.venue.tippets?null:null==a.venue.tippets.groups[0]?null:a.venue.tippets.groups[0].items:
[]).length,e=0<(null!=(null==a.venue?null:a.venue.justifications)?null==a.venue?null:a.venue.justifications:[]).length;if(e||d){c+='\x3cdiv class\x3d"justificationsSection"\x3e\x3cul class\x3d"justificationList"\x3e';if(e)for(var e=null!=a.maxFaces?a.maxFaces:100,f=a.venue.justifications,g=f.length,h=0;h<g;h++){var l=f[h],c=c+('\x3cli class\x3d"justification"\x3e\x3cdiv class\x3d"left"\x3e'+(l.icon?'\x3cimg src\x3d"'+helpers.image.nearestBigger(soy.$$augmentMap(l.icon,{desiredSize:30}))+'" alt\x3d"Stars"/\x3e':
"")+'\x3c/div\x3e\x3cdiv class\x3d"right"\x3e'+("path"==(null==l?null:null==l.target?null:l.target.type)?'\x3ca class\x3d"text'+((null==l?0:null==l.target?0:null==l.target.object?0:0==l.target.object.url.indexOf("/top-places"))?" localQueryDetailLink":"")+'" href\x3d"'+soy.$$escapeHtml(null==l?null:null==l.target?null:null==l.target.object?null:l.target.object.url)+'"\x3e'+helpers.entities.textWithEntities(l)+"\x3c/a\x3e":"navigation"==(null==l?null:null==l.target?null:l.target.type)?"OfflineRecSimilarVenue"==
(null==l?null:l.type)||"OnlineSimilarVenue"==(null==l?null:l.type)?'\x3cdiv class\x3d"text"\x3e'+helpers.entities.textWithEntitiesLinks(l)+"\x3c/div\x3e":'\x3ca class\x3d"text" href\x3d"'+soy.$$escapeHtml(null==l?null:null==l.target?null:null==l.target.object?null:null==l.target.object.target?null:l.target.object.target.url)+'"'+((null==l?0:null==l.target?0:null==l.target.object?0:null==l.target.object.target?0:0!=l.target.object.target.url.indexOf("/"))?' target\x3d"_blank" rel\x3d"nofollow"':"")+
"\x3e"+helpers.entities.textWithEntities(l)+"\x3c/a\x3e":'\x3cdiv class\x3d"text"\x3e'+helpers.entities.textWithEntities(l)+"\x3c/div\x3e"));if(0<(null!=(null==l?null:null==l.users?null:l.users.items)?null==l?null:null==l.users?null:l.users.items:[]).length){for(var c=c+'\x3cdiv class\x3d"facepile"\x3e\x3cul class\x3d"faces"\x3e',l=_.first(l.users.items,e),p=l.length,q=0;q<p;q++)c+='\x3cli class\x3d"face"\x3e\x3cdiv class\x3d"visitorAvatar"\x3e'+helpers.user.xsmallImageWLink(l[q].user)+"\x3c/div\x3e\x3c/li\x3e";
c+="\x3c/ul\x3e\x3c/div\x3e"}c+="\x3c/div\x3e\x3c/li\x3e"}d&&(c+='\x3cli class\x3d"tippets justification"\x3e\x3cdiv\x3e\x3cdiv class\x3d"left"\x3e\x3cimg src\x3d"'+soy.$$escapeHtml("https://ss0.4sqi.net/img/justifications/tip_30-38f61f686589b781e2446ebe0f00bfc6.png")+'" alt\x3d"Tips"/\x3e\x3c/div\x3e\x3cdiv class\x3d"right"\x3e',d=a.venue.tippets.groups[0].items[1],e=a.venue.tippets.groups[0].items[2],f=a.venue.tippets.groups[0].items[3],c+='\x3cdiv class\x3d"rowEl"\x3e'+templates.fourSq.page.venuedetail2.common.justifications.tippet({tippet:a.venue.tippets.groups[0].items[0],
even:!0})+templates.fourSq.page.venuedetail2.common.justifications.tippet({tippet:d,even:!1})+"\x3c/div\x3e"+(f?'\x3cdiv class\x3d"rowEl"\x3e'+templates.fourSq.page.venuedetail2.common.justifications.tippet({tippet:e,even:!0})+templates.fourSq.page.venuedetail2.common.justifications.tippet({tippet:f,even:!1})+"\x3c/div\x3e":"")+"\x3c/div\x3e\x3c/div\x3e\x3c/li\x3e");c+="\x3c/ul\x3e\x3c/div\x3e"}return c};
templates.fourSq.page.venuedetail2.common.justifications.tippet=function(a,b){return a.tippet?'\x3cdiv class\x3d"tippet" data-taste-text\x3d"'+soy.$$escapeHtml(null==a.tippet?null:null==a.tippet.taste?null:a.tippet.taste.text)+'" data-taste-id\x3d"'+soy.$$escapeHtml(a.tippet.tasteId)+'" data-tip-id\x3d"'+soy.$$escapeHtml(a.tippet.tipId)+'"\x3e\x3cdiv class\x3d"tippetAvatar"\x3e'+(a.tippet.user?helpers.user.xsmallImageWLink(a.tippet.user):"")+'\x3c/div\x3e\x3cdiv class\x3d"tippetText '+(a.even?"even":
"")+'"\x3e"'+helpers.entities.textWithEntities(a.tippet)+'"\x3cspan class\x3d"tippetNumber link"\x3e('+(0==a.tippet.tipCount?"0 Tips":1==a.tippet.tipCount?"1 Tip":soy.$$escapeHtml(a.tippet.tipCount)+" Tips")+")\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e":""};"undefined"==typeof templates.fourSq&&(templates.fourSq={});"undefined"==typeof templates.fourSq.page&&(templates.fourSq.page={});"undefined"==typeof templates.fourSq.page.venuedetail2&&(templates.fourSq.page.venuedetail2={});"undefined"==typeof templates.fourSq.page.venuedetail2.common&&(templates.fourSq.page.venuedetail2.common={});"undefined"==typeof templates.fourSq.page.venuedetail2.common.tipModal&&(templates.fourSq.page.venuedetail2.common.tipModal={});
templates.fourSq.page.venuedetail2.common.tipModal.tipModal=function(a,b){return'\x3cdiv class\x3d"topBlock"\x3e'+(a.tip.photo?"":templates.fourSq.page.venuedetail2.common.tipModal.venueBlockPhotos({venuePhotos:a.photos}))+templates.fourSq.page.venuedetail2.common.tipModal.tipPhoto(a)+templates.fourSq.page.venuedetail2.common.tipModal.tipMeta(a)+(!a.isMobile&&a.useTipUpvotes?'\x3cdiv class\x3d"tipHeaderButtons"\x3e'+templates.fourSq.ui.save.doubleSaveButton(null)+templates.fourSq.helpers.share.doubleShareButton(null)+
"\x3c/div\x3e":"")+"\x3c/div\x3e"+templates.fourSq.page.venuedetail2.common.tipModal.tipText(a)+(a.isMobile?"":templates.fourSq.page.venuedetail2.common.tipModal.negativeControls(a))};templates.fourSq.page.venuedetail2.common.tipModal.tipPhoto=function(a,b){return'\x3cdiv class\x3d"tipPhoto"\x3e'+templates.fourSq.page.venuedetail2.common.tipModal.tipImage({width:610,height:610,tip:a.tip})+"\x3c/div\x3e"};
templates.fourSq.page.venuedetail2.common.tipModal.tipImage=function(a,b){return a.tip.photo?'\x3cimg src\x3d"'+helpers.photo.nearestBigger(soy.$$augmentMap(a.tip.photo,{targetWidth:a.width,targetHeight:a.height}))+'"/\x3e':""};
templates.fourSq.page.venuedetail2.common.tipModal.venueBlockPhotos=function(a,b){for(var c="",d=0<a.venuePhotos.length?a.venuePhotos:[1,2,3,4],e=d.length,f=0;f<e;f++)var g=d[f],c=c+(4>f?'\x3cspan class\x3d"photoThumb"\x3e'+helpers.photo.squareImage(soy.$$augmentMap(g,{size:145}))+"\x3c/span\x3e":"");return c};
templates.fourSq.page.venuedetail2.common.tipModal.tipMeta=function(a,b){var c='\x3cdiv class\x3d"gradient"\x3e\x3c/div\x3e';if(a.venue){c+='\x3cdiv class\x3d"venueBlock"\x3e\x3cdiv class\x3d"venueDetails"\x3e\x3cspan class\x3d"venueName"\x3e'+helpers.venue.nameWithLink(a)+'\x3c/span\x3e\x3cdiv class\x3d"venueMeta"\x3e';if(a.venue.rating)var d=helpers.venue.ratingRounded(a.venue)+"/10 - "+helpers.venue.ratingDescription(a.venue),c=c+('\x3cdiv class\x3d"venueScore tooltip score '+helpers.venue.ratingClass(a.venue)+
'" title\x3d"'+soy.$$escapeHtml(d)+'"'+((null==a.venue?0:a.venue.ratingColor)?' style\x3d"background-color: #'+soy.$$escapeHtml(a.venue.ratingColor)+';"':"")+"\x3e"+helpers.venue.ratingRounded(a.venue)+"\x3c/div\x3e");c+='\x3cdiv class\x3d"venueAddr"\x3e'+helpers.venue.globalLocalAddress(a.venue)+'\x3c/div\x3e\x3cdiv class\x3d"venueCat"\x3e'+(0<a.venue.categories.length?"\x3cspan\x3e"+soy.$$escapeHtml(a.venue.categories[0].name)+"\x3c/span\x3e":"")+'\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"venuePhotoContainer"\x3e\x3c/div\x3e\x3c/div\x3e'}return c};
templates.fourSq.page.venuedetail2.common.tipModal.tipText=function(a,b){return'\x3cdiv class\x3d"tipText"\x3e\x3cdiv class\x3d"textWrapper"\x3e\x3cspan class\x3d"text"\x3e'+soy.$$escapeHtml(a.tip.text)+'\x3c/span\x3e \x3cspan class\x3d"readMore"\x3e'+helpers.tip.readMoreLink(a.tip)+'\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"tipInfo"\x3e\x3cdiv class\x3d"author"\x3e\x3cdiv class\x3d"authorImage"\x3e'+helpers.user.xsmallImageWLink(a.tip.user)+'\x3c/div\x3e\x3cdiv class\x3d"authorMeta"\x3e\x3cspan class\x3d"userName"\x3e'+
helpers.user.fullNameWLink(a.tip.user)+'\x3c/span\x3e \x3cspan class\x3d"dot"\x3e\x26middot;\x3c/span\x3e \x3cspan class\x3d"tipDate"\x3e'+helpers.util.createdAtSmartDate(a.tip)+"\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e"+(a.isMobile?"":'\x3cdiv class\x3d"editControls"\x3e\x3cul class\x3d"actions"\x3e'+(a.useTipUpvotes?'\x3cli class\x3d"upvoteContainer"\x3e\x3cspan class\x3d"lastVoteTime"\x3e\x3c/span\x3e\x3c/li\x3e':'\x3cli class\x3d"save-button"\x3e\x3cspan class\x3d"icon"\x3e\x3c/span\x3e\x3cspan class\x3d"label"\x3eSave\x3c/span\x3e\x3c/li\x3e\x3cli class\x3d"likeButtonContainer"\x3e\x3cspan class\x3d"like"\x3e\x3cspan class\x3d"link"\x3e\x3c/span\x3e\x3c/span\x3e\x3c/li\x3e\x3cli class\x3d"shareTipLink"\x3e\x3cspan class\x3d"icon"\x3e\x3c/span\x3e\x3cspan class\x3d"label"\x3eShare\x3c/span\x3e\x3c/li\x3e')+
"\x3c/ul\x3e\x3c/div\x3e")+"\x3c/div\x3e\x3c/div\x3e"};
templates.fourSq.page.venuedetail2.common.tipModal.negativeControls=function(a,b){return'\x3cdiv class\x3d"editControls"\x3e\x3cul class\x3d"actions"\x3e\x3cli class\x3d"reportTip"\x3e\x3cspan\x3eReport\x3c/span\x3e\x3c/li\x3e'+(a.canDeleteTip?(a.isCurrentUser?'\x3cli class\x3d"editTip"\x3e\x3cspan\x3eEdit\x3c/span\x3e\x3c/li\x3e':"")+'\x3cli class\x3d"deleteTip"\x3e\x3cspan\x3eDelete\x3c/span\x3e\x3c/li\x3e'+(a.renderNewEditActionControls?a.hasUrl&&a.urlEditEnabled?'\x3cli class\x3d"removeUrl"\x3e\x3cspan\x3e Remove Url \x3c/span\x3e\x3c/li\x3e':
"":"")+(a.canUploadPhoto?'\x3cli class\x3d"uploadPhoto"\x3e\x3cspan\x3eUpload Photo\x3cspan class\x3d"tipAddPhotoContainer"\x3e\x3c/span\x3e\x3c/span\x3e\x3c/li\x3e':a.renderNewEditActionControls?'\x3cli class\x3d"deletePhoto"\x3e\x3cspan\x3e Delete Photo \x3c/span\x3e\x3c/li\x3e':""):"")+"\x3c/ul\x3e\x3c/div\x3e"};
templates.fourSq.page.venuedetail2.common.tipModal.tipPhotoUploadControl=function(a,b){return helpers.photoupload.genericPhotoUploadControl_({inputName:"tipPhoto",action:"/__uploadtipphoto",addButtonHolderClass:a.addButtonHolderClass,text:a.text,additionalHiddenInputName:"tipId",additionalHiddenInputValue:a.id})};
templates.fourSq.page.venuedetail2.common.tipModal.tipPhotoTextContents=function(a,b){return(a.renderNewEditActionControls&&a.urlEditEnabled?'\x3cdiv class\x3d"addTipLink"\x3e\x3cspan title class\x3d"addLink"\x3eAdd "read more" link\x3c/span\x3e\x3cdiv id\x3d"tipLink"\x3e\x3cinput class\x3d"formStyle" type\x3d"text" maxlength\x3d"255" value\x3d"" /\x3e\x3c/div\x3e\x3c/div\x3e':"")+'\x3cdiv class\x3d"tipEditControls"\x3e\x3cbutton class\x3d"greenButton saveAction"\x3eSave\x3c/button\x3e\x3cspan class\x3d"cancelAction link"\x3eCancel\x3c/span\x3e\x3cspan class\x3d"textRemaining"\x3e\x3c/span\x3e\x3c/div\x3e'};
templates.fourSq.page.venuedetail2.common.tipModal.deleteTipFailed=function(a,b){return"There was a problem deleting the tip. Please try again later."};templates.fourSq.page.venuedetail2.common.tipModal.editTipFailed=function(a,b){return"There was a problem editing the tip. Please try again later."};"undefined"==typeof templates.fourSq&&(templates.fourSq={});"undefined"==typeof templates.fourSq.page&&(templates.fourSq.page={});"undefined"==typeof templates.fourSq.page.venuedetail2&&(templates.fourSq.page.venuedetail2={});"undefined"==typeof templates.fourSq.page.venuedetail2.desktop&&(templates.fourSq.page.venuedetail2.desktop={});"undefined"==typeof templates.fourSq.page.venuedetail2.desktop.childrendialog&&(templates.fourSq.page.venuedetail2.desktop.childrendialog={});
templates.fourSq.page.venuedetail2.desktop.childrendialog.childrenHeaderText=function(a,b){return"Places inside "+soy.$$escapeHtml(a.venueName)};templates.fourSq.page.venuedetail2.desktop.childrendialog.siblingsHeaderText=function(a,b){return templates.fourSq.page.venuedetail2.desktop.childrendialog.otherPlaces(a)};
templates.fourSq.page.venuedetail2.desktop.childrendialog.dialogHeader=function(a,b){return'\x3ch3 class\x3d"mainHeader"\x3e'+(a.forSiblings?templates.fourSq.page.venuedetail2.desktop.childrendialog.siblingsHeaderText(a):templates.fourSq.page.venuedetail2.desktop.childrendialog.childrenHeaderText(a))+"\x3c/h3\x3e"};
templates.fourSq.page.venuedetail2.desktop.childrendialog.unpartitionedBody=function(a,b){return templates.fourSq.page.venuedetail2.desktop.childrendialog.dialogHeader(a)+templates.fourSq.page.venuedetail2.desktop.childrendialog.sortedVenueList(a)+templates.fourSq.page.venuedetail2.desktop.childrendialog.dialogFooter(a)};
templates.fourSq.page.venuedetail2.desktop.childrendialog.sortedVenueList=function(a,b){return function(){for(var b='\x3cul class\x3d"venueList"\x3e',d=_.sortBy(a.venues,function(a){return a.name}),e=d.length,f=0;f<e;f++)b+=templates.fourSq.page.venuedetail2.common.related.relatedVenueListItem({relatedVenue:d[f]});return b+"\x3c/ul\x3e"}()};templates.fourSq.page.venuedetail2.desktop.childrendialog.otherPlaces=function(a,b){return"Other places in "+soy.$$escapeHtml(a.venueName)};
templates.fourSq.page.venuedetail2.desktop.childrendialog.countPlaces=function(a,b){return'\x3cspan class\x3d"placesCount"\x3e'+(1==a.count?"("+soy.$$escapeHtml(a.count)+" place)":"("+soy.$$escapeHtml(a.count)+" places)")+"\x3c/span\x3e"};
templates.fourSq.page.venuedetail2.desktop.childrendialog.dialogFooter=function(a,b){a=a||{};return a.enableAddressEditing?'\x3cdiv class\x3d"footerActions"\x3e\x3cspan class\x3d"link editAddresses"\x3eEdit the addresses for these places\x3c/span\x3e\x3c/div\x3e':""};templates.fourSq.page.venuedetail2.desktop.childrendialog.editFailed=function(a,b){return"Something went wrong submitting your suggestions. You can still go in to venues individually and edit their information."};
templates.fourSq.page.venuedetail2.desktop.childrendialog.editSuccess=function(a,b){return"Thanks for your suggestions!"};templates.fourSq.page.venuedetail2.desktop.childrendialog.editConfirm=function(a,b){return 1==a.numVenues?"This will submit edits for 1 venue. Are you sure?":"This will submit edits for "+soy.$$escapeHtml(a.numVenues)+" venues. Are you sure?"};
templates.fourSq.page.venuedetail2.desktop.childrendialog.addressEditor=function(a,b){for(var c='\x3cdiv class\x3d"addressEditor"\x3e\x3ctable\x3e\x3ctr\x3e\x3cth\x3ePlace\x3c/th\x3e\x3cth\x3eAddress\x3c/th\x3e\x3cth\x3eCross street\x3c/th\x3e\x3c/tr\x3e',d=a.venues,e=d.length,f=0;f<e;f++)var g=d[f],c=c+('\x3ctr class\x3d"venueRow" data-venueid\x3d"'+soy.$$escapeHtml(g.id)+'"\x3e\x3ctd\x3e'+helpers.venue.nameWithLink({venue:g,target:"_blank"})+"\x3c/td\x3e\x3ctd\x3e"),h=null!=(null==g?null:null==
g.location?null:g.location.address)?null==g?null:null==g.location?null:g.location.address:"",c=c+('\x3cinput type\x3d"text" class\x3d"editableField formStyle" value\x3d"'+soy.$$escapeHtml(h)+'" data-param\x3d"address" data-original-value\x3d"'+soy.$$escapeHtml(h)+'" tabindex\x3d"'+soy.$$escapeHtml(2*f+99)+'"\x3e\x3c/td\x3e\x3ctd\x3e'),h=null!=(null==g?null:null==g.location?null:g.location.crossStreet)?null==g?null:null==g.location?null:g.location.crossStreet:"",c=c+('\x3cinput type\x3d"text" class\x3d"editableField formStyle" value\x3d"'+
soy.$$escapeHtml(null!=(null==g?null:null==g.location?null:g.location.crossStreet)?null==g?null:null==g.location?null:g.location.crossStreet:"")+'" data-param\x3d"crossStreet" data-original-value\x3d"'+soy.$$escapeHtml(h)+'" tabindex\x3d"'+soy.$$escapeHtml(2*f+100)+'"\x3e\x3c/td\x3e\x3c/tr\x3e');return c+'\x3c/table\x3e\x3cdiv class\x3d"editingActions"\x3e\x3cspan class\x3d"button greyButton cancel"\x3eCancel\x3c/span\x3e\x3cspan class\x3d"button greenButton disabledButton submit"\x3eSubmit\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e'};
templates.fourSq.page.venuedetail2.desktop.childrendialog.partitionedBody=function(a,b){for(var c=templates.fourSq.page.venuedetail2.desktop.childrendialog.dialogHeader(a),d=a.groups,e=d.length,f=0;f<e;f++)var g=d[f],c=c+('\x3ch4 class\x3d"subHeader"\x3e'+soy.$$escapeHtml(g.name)+" "+templates.fourSq.page.venuedetail2.desktop.childrendialog.countPlaces({count:g.count})+"\x3c/h4\x3e"+templates.fourSq.page.venuedetail2.desktop.childrendialog.sortedVenueList({venues:g.items}));return c+=templates.fourSq.page.venuedetail2.desktop.childrendialog.dialogFooter(a)};"undefined"==typeof templates.fourSq&&(templates.fourSq={});"undefined"==typeof templates.fourSq.page&&(templates.fourSq.page={});"undefined"==typeof templates.fourSq.page.venuedetail2&&(templates.fourSq.page.venuedetail2={});"undefined"==typeof templates.fourSq.page.venuedetail2.desktop&&(templates.fourSq.page.venuedetail2.desktop={});"undefined"==typeof templates.fourSq.page.venuedetail2.desktop.sharedialog&&(templates.fourSq.page.venuedetail2.desktop.sharedialog={});
templates.fourSq.page.venuedetail2.desktop.sharedialog.content=function(a,b){return'\x3cdiv class\x3d"venueShareDialog"\x3e\x3cdiv class\x3d"venueShareName"\x3e'+soy.$$escapeHtml(a.name)+'\x3c/div\x3e\x3cdiv class\x3d"shareURLContainer"\x3e\x3cinput class\x3d"shareURLInput" type\x3d"text" value\x3d"'+soy.$$escapeHtml(a.url)+'" /\x3e\x3c/div\x3e\x3cdiv class\x3d"socialShareButtons"\x3e'+templates.fourSq.newdrag.ui.share.facebookShareButton({longText:!0})+templates.fourSq.newdrag.ui.share.twitterTweetButton({longText:!0})+
"\x3c/div/\x3e\x3c/div\x3e"};"undefined"==typeof templates.fourSq&&(templates.fourSq={});"undefined"==typeof templates.fourSq.page&&(templates.fourSq.page={});"undefined"==typeof templates.fourSq.page.venuedetail2&&(templates.fourSq.page.venuedetail2={});"undefined"==typeof templates.fourSq.page.venuedetail2.desktop&&(templates.fourSq.page.venuedetail2.desktop={});"undefined"==typeof templates.fourSq.page.venuedetail2.desktop.maps&&(templates.fourSq.page.venuedetail2.desktop.maps={});
templates.fourSq.page.venuedetail2.desktop.maps.overlayMap=function(a,b){return'\x3cdiv class\x3d"overlayMapSection"\x3e\x3cdiv id\x3d"overlayMap"\x3e\x3c/div\x3e'+("mars"==a.location.planet||a.location.isFuzzed?"":'\x3cdiv class\x3d"footer"\x3e'+helpers.venue.postalAddress(a)+(a.location.lat&&a.location.lng?'\x3ca class\x3d"directionsLink" href\x3d"'+helpers.venue.directionsHref(a)+'" target\x3d"_blank"\x3eGet directions to this place\x3c/a\x3e':"")+"\x3c/div\x3e")+"\x3c/div\x3e"};
templates.fourSq.page.venuedetail2.desktop.maps.popOutMapButton=function(a,b){return'\x3cdiv class\x3d"popOutMapButton"\x3e\x3c/div\x3e'};templates.fourSq.page.venuedetail2.desktop.maps.centerMapButton=function(a,b){return'\x3cdiv class\x3d"centerMapButton"\x3e\x3c/div\x3e'};templates.fourSq.page.venuedetail2.desktop.maps.popInMapButton=function(a,b){return'\x3cdiv class\x3d"popInMapButton"\x3e\x3c/div\x3e'};"undefined"==typeof templates.fourSq&&(templates.fourSq={});"undefined"==typeof templates.fourSq.page&&(templates.fourSq.page={});"undefined"==typeof templates.fourSq.page.venuedetail2&&(templates.fourSq.page.venuedetail2={});"undefined"==typeof templates.fourSq.page.venuedetail2.desktop&&(templates.fourSq.page.venuedetail2.desktop={});"undefined"==typeof templates.fourSq.page.venuedetail2.desktop.tips&&(templates.fourSq.page.venuedetail2.desktop.tips={});
templates.fourSq.page.venuedetail2.desktop.tips.tipsSection=function(a,b){return templates.fourSq.page.venuedetail2.common.justifications.justifications(a)+(a.currentUser||a.showInviteSignupPrompt?"":'\x3cdiv class\x3d"signupPromptContainer" data-style\x3d"manual"\x3e\x3c/div\x3e')+templates.fourSq.page.venuedetail2.desktop.tips.tipsBlock({currentUser:a.currentUser,venue:a.venue,pageSize:a.pageSize,searchableTips:a.searchableTips,tips:a.tips,currentTipPageIndex:a.currentTipPageIndex,tipSort:a.tipSort,
showUrlInput:a.showTipUrlInput,tipCount:a.tipCount,useTipUpvotes:a.useTipUpvotes})};
templates.fourSq.page.venuedetail2.desktop.tips.tipsBlock=function(a,b){return'\x3cdiv class\x3d"tipsSection"\x3e\x3cdiv class\x3d"sectionTitle"\x3e\x3cimg class\x3d"sectionIcon" src\x3d"'+soy.$$escapeHtml(fourSq.retina.isRetina()?"https://ss1.4sqi.net/img/venuepage/v2/section_title_tips@2x-6449ea09a26b1d885184e709e2c8f693.png":"https://ss1.4sqi.net/img/venuepage/v2/section_title_tips-cf2a6004e780a9518fe37521968b56d0.png")+'" height\x3d"25" width\x3d"25" alt\x3d"Tips and Reviews icon"/\x3e'+(0==a.tips.count?
'\x3cspan class\x3d"tipsText sectionText"\x3eNo tips and reviews\x3c/span\x3e':1==a.tips.count?'\x3cspan class\x3d"tipsCount sectionCount"\x3e1\x3c/span\x3e \x3cspan class\x3d"tipsText sectionText"\x3eTip and review\x3c/span\x3e':'\x3cspan class\x3d"tipsCount sectionCount"\x3e'+fourSq.i18n.formatNumber(a.tips.count,"decimal",void 0,"")+'\x3c/span\x3e \x3cspan class\x3d"tipsText sectionText"\x3eTips and reviews\x3c/span\x3e')+(a.searchableTips&&1<a.tipCount?'\x3cdiv class\x3d"searchControls"\x3e\x3cinput class\x3d"searchInput formStyle" tabindex\x3d"3" placeholder\x3d"Search tips..." type\x3d"text" aria-label\x3d"text"/\x3e\x3cdiv class\x3d"buttons"\x3e\x3cspan class\x3d"clearQuery"\x3e\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e':
"")+"\x3c/div\x3e"+(a.venue.tastes?templates.fourSq.page.venuedetail2.desktop.tips.tastes_(a):"")+'\x3cdiv class\x3d"addTipsSection"\x3e'+templates.fourSq.page.venuedetail2.desktop.tips.maybeAddTipBlock_({currentUser:a.currentUser,canAddTips:a.venue.permissions.addTips,venue:a.venue,showUrlInput:a.showUrlInput})+'\x3c/div\x3e\x3cdiv class\x3d"tipsListSection"\x3e'+templates.fourSq.page.venuedetail2.desktop.tips.tipsHeader_(a)+'\x3cdiv class\x3d"tipsSectionBody"\x3e\x3cdiv id\x3d"tipsContainer"\x3e'+
templates.fourSq.page.venuedetail2.desktop.tips.tipList({currentUser:a.currentUser,tips:a.tips,pageSize:a.pageSize,currentPage:a.currentTipPageIndex,fromQuery:!1,venue:a.venue,useTipUpvotes:a.useTipUpvotes})+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"};
templates.fourSq.page.venuedetail2.desktop.tips.tipsHeader_=function(a,b){return'\x3ch3 class\x3d"tipCount"\x3e\x3c/h3\x3e\x3cdiv class\x3d"tipsSectionHeader"\x3e\x3cdiv class\x3d"filterArea"\x3e'+(1<a.tipCount?'\x3cdiv class\x3d"sortControls"\x3eSort: \x3cul class\x3d"sortOptions"\x3e'+("popular"==a.tipSort?templates.fourSq.page.venuedetail2.desktop.tips.popularTipSortButton_({selected:!0})+templates.fourSq.page.venuedetail2.desktop.tips.recentTipSortButton_({selected:!1}):templates.fourSq.page.venuedetail2.desktop.tips.recentTipSortButton_({selected:!0})+
templates.fourSq.page.venuedetail2.desktop.tips.popularTipSortButton_({selected:!1}))+"\x3c/ul\x3e\x3c/div\x3e":"")+"\x3c/div\x3e\x3c/div\x3e"};templates.fourSq.page.venuedetail2.desktop.tips.recentTipSortButton_=function(a,b){return templates.fourSq.page.venuedetail2.desktop.tips.tipSortButton_({selected:a.selected,sort:"recent",copy:"Recent"})};
templates.fourSq.page.venuedetail2.desktop.tips.popularTipSortButton_=function(a,b){return templates.fourSq.page.venuedetail2.desktop.tips.tipSortButton_({selected:a.selected,sort:"popular",copy:"Popular"})};templates.fourSq.page.venuedetail2.desktop.tips.tipSortButton_=function(a,b){return'\x3cli data-sort\x3d"'+soy.$$escapeHtml(a.sort)+'" '+(a.selected?' class\x3d"selected"':"")+'\x3e\x3cspan class\x3d"sortLink"\x3e'+soy.$$escapeHtml(a.copy)+"\x3c/span\x3e\x3c/li\x3e"};
templates.fourSq.page.venuedetail2.desktop.tips.tastes_=function(a,b){var c="",d=_.first(null!=(null==a.venue?null:null==a.venue.tastes?null:a.venue.tastes.items)?null==a.venue?null:null==a.venue.tastes?null:a.venue.tastes.items:[],20);if(0<d.length){for(var c=c+'\x3cdiv class\x3d"tastes"\x3e\x3cspan class\x3d"filterText"\x3eFilter:\x3c/span\x3e\x3cul class\x3d"tastePile"\x3e',e=d.length,f=0;f<e;f++)var g=d[f],c=c+('\x3cli class\x3d"taste '+(4<f?"hidden":"")+'" data-index\x3d"'+soy.$$escapeHtml(f+
1)+'" data-id\x3d"'+soy.$$escapeHtml(g.id)+'" data-name\x3d"'+soy.$$escapeHtml(g.text)+'"\x3e\x3cspan class\x3d"pill'+soy.$$escapeHtml(g.onUser?" onUser":"")+'"\x3e'+soy.$$escapeHtml(g.text)+"\x3c/span\x3e\x3c/li\x3e");d=d.length-5;c+=(0<d?'\x3cli class\x3d"taste seeAllTasteLink"\x3e\x3cspan class\x3d"pill"\x3e('+fourSq.i18n.formatNumber(d,"decimal",void 0,"")+" more)\x3c/span\x3e\x3c/li\x3e":"")+"\x3c/ul\x3e\x3c/div\x3e"}return c};
templates.fourSq.page.venuedetail2.desktop.tips.maybeAddTipBlock_=function(a,b){return a.currentUser&&a.canAddTips?templates.fourSq.page.venuedetail2.desktop.tips.addTipBlock_(a):'\x3cdiv class\x3d"addTipTeaser"\x3e'+(a.currentUser?"You can't leave tips at this venue.":'\x3cdiv class\x3d"addTipBlock"\x3e\x3cdiv class\x3d"userImage"\x3e\x3cimg src\x3d"'+soy.$$escapeHtml(fourSq.retina.isRetina()?"https://ss0.4sqi.net/img/venuepage/v2/add_tip_blank_avatar@2x-4321684c656168f26ae9208901a9d83e.png":"https://ss1.4sqi.net/img/venuepage/v2/add_tip_blank_avatar-92b48188df42db391a669d992defe0b8.png")+
'" height\x3d"32" width\x3d"32" alt\x3d"User icon"/\x3e\x3c/div\x3e\x3cdiv class\x3d"addTipArea"\x3e\x3ca href\x3d"/login?continue\x3d'+soy.$$escapeHtml(a.venue.canonicalPath)+'"\x3eLog in\x3c/a\x3e to leave a tip here.\x3c/div\x3e\x3cdiv class\x3d"buttonArea"\x3e\x3cbutton class\x3d"greyButton"\x3ePost\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e')+"\x3c/div\x3e"};
templates.fourSq.page.venuedetail2.desktop.tips.addTipBlock_=function(a,b){return'\x3cdiv class\x3d"addTipBlock"\x3e'+helpers.user.xsmallImageWLink(soy.$$augmentMap(a.currentUser,{linkClass:"userImage"}))+templates.fourSq.ui.richform.inputArea({className:"addTipArea",placeholder:"Leave a tip for others...",inputName:"tipPhoto",action:"/__uploadtipphoto",includeLink:a.showUrlInput})+'\x3cdiv class\x3d"buttonArea"\x3e\x3cbutton class\x3d"shareTipButton greenButton" tabindex\x3d"2"\x3ePost\x3c/button\x3e\x3c/div\x3e\x3cdiv id\x3d"tipLink"\x3e\x3cinput class\x3d"formStyle" type\x3d"text" maxlength\x3d"255" value\x3d"" /\x3e\x3c/div\x3e\x3cdiv class\x3d"photoPreview"\x3e\x3c/div\x3e\x3c/div\x3e'};
templates.fourSq.page.venuedetail2.desktop.tips.tipList=function(a,b){return function(){for(var b='\x3cul id\x3d"tipsList"\x3e',d=_.filter(null!=a.nonTipJustifications?a.nonTipJustifications:[],function(a){return!0===a.firstPosition}),b=b+templates.fourSq.page.venuedetail2.common.tips.nonTipJustifications({beforeNonTipJustifications:d}),d=a.tips.items,e=d.length,f=0;f<e;f++)var g=d[f],b=b+('\x3cli class\x3d"tip'+(g.logView?" tipWithLogging":"")+" "+(a.useTipUpvotes?"useTipUpvotes":"")+" "+(g.disagreed?
"downvotedTip":"")+'" data-id\x3d"'+soy.$$escapeHtml(g.id)+'"\x3e'+(a.useTipUpvotes?templates.fourSq.ui.tip.renderTipUpvotes({tip:g,venue:a.venue}):templates.fourSq.ui.tip.renderTip({currentUser:a.currentUser,tip:g,venue:a.venue}))+"\x3c/li\x3e");d=_.filter(null!=a.nonTipJustifications?a.nonTipJustifications:[],function(a){return 1!=a.firstPosition});if(0<d.length)for(e=d.length,f=0;f<e;f++)b+='\x3cli class\x3d"nonTipJustification"\x3e'+helpers.entities.textWithEntities(d[f])+"\x3c/li\x3e";return b+=
(0==(null!=(null==a.tips?null:a.tips.items)?null==a.tips?null:a.tips.items:[]).length?'\x3cli class\x3d"noTips"\x3e'+(a.fromQuery?"No tips matched your search":'\x3cdiv class\x3d"emptyIcon"\x3e\x3cimg src\x3d"'+soy.$$escapeHtml(fourSq.retina.isRetina()?"https://ss1.4sqi.net/img/venuepage/v2/section_title_tips@2x-6449ea09a26b1d885184e709e2c8f693.png":"https://ss1.4sqi.net/img/venuepage/v2/section_title_tips-cf2a6004e780a9518fe37521968b56d0.png")+'" height\x3d"25" width\x3d"25" alt\x3d"Tips icon" /\x3e\x3c/div\x3e\x3cdiv class\x3d"emptyHeadingText"\x3eNo tips yet\x3c/div\x3e\x3cspan class\x3d"emptySubText"\x3eWrite a short note about what you liked, what to order, or other helpful advice for visitors.\x3c/span\x3e')+
"\x3c/li\x3e":"")+"\x3c/ul\x3e"+templates.fourSq.page.venuedetail2.desktop.tips.pageLinks_({totalPages:Math.ceil(a.tips.count/a.pageSize),currentPage:a.currentPage,venueCanonicalUrl:a.venue.canonicalPath})}()};
templates.fourSq.page.venuedetail2.desktop.tips.pageLinks_=function(a,b){var c="";if(1<a.totalPages){for(var d=Math.max(0,a.currentPage-5),e=Math.min(a.currentPage+6,a.totalPages),c=c+('\x3cdiv class\x3d"paginationContainer"\x3e\x3cdiv class\x3d"pages"\x3e'+(0<d?'\x3ca data-index\x3d"0" class\x3d"pageLink" href\x3d"'+soy.$$escapeHtml(a.venueCanonicalUrl)+'"\x3e\x3cspan class\x3d"paginationComponent page page1"\x3e1\x3c/span\x3e\x3c/a\x3e\x3cspan class\x3d"paginationComponent"\x3e...\x3c/span\x3e':
""));d<e;d++)c+='\x3ca class\x3d"pageLink" data-index\x3d"'+soy.$$escapeHtml(d)+'" '+(0<d?'href\x3d"'+soy.$$escapeHtml(a.venueCanonicalUrl)+"?tipsPage\x3d"+soy.$$escapeHtml(d+1)+'"':'href\x3d"'+soy.$$escapeHtml(a.venueCanonicalUrl)+'"')+'\x3e\x3cspan class\x3d"paginationComponent page page'+soy.$$escapeHtml(d)+" "+(d==a.currentPage?"active":"")+'" class\x3d"'+(d==a.currentPage?" currentPage":"")+'"\x3e'+soy.$$escapeHtml(d+1)+"\x3c/span\x3e\x3c/a\x3e";c+=(e<a.totalPages-1?'\x3cspan class\x3d"paginationComponent"\x3e...\x3c/span\x3e\x3ca data-index\x3d"'+
soy.$$escapeHtml(a.totalPages-1)+'" class\x3d"pageLink" href\x3d"'+soy.$$escapeHtml(a.venueCanonicalUrl)+"?tipsPage\x3d"+soy.$$escapeHtml(a.totalPages)+'"\x3e\x3cspan class\x3d"paginationComponent page page'+soy.$$escapeHtml(a.totalPages)+'"\x3e'+soy.$$escapeHtml(a.totalPages)+"\x3c/span\x3e\x3c/a\x3e":"")+"\x3c/div\x3e\x3c/div\x3e"}return c};"undefined"==typeof templates.fourSq&&(templates.fourSq={});"undefined"==typeof templates.fourSq.page&&(templates.fourSq.page={});"undefined"==typeof templates.fourSq.page.venuedetail2&&(templates.fourSq.page.venuedetail2={});"undefined"==typeof templates.fourSq.page.venuedetail2.desktop&&(templates.fourSq.page.venuedetail2.desktop={});"undefined"==typeof templates.fourSq.page.venuedetail2.desktop.messages&&(templates.fourSq.page.venuedetail2.desktop.messages={});
templates.fourSq.page.venuedetail2.desktop.messages.showHoursText=function(a,b){return"(Show more)"};templates.fourSq.page.venuedetail2.desktop.messages.hideHoursText=function(a,b){return"(Show less)"};templates.fourSq.page.venuedetail2.desktop.messages.showFeaturesText=function(a,b){return"See More"};templates.fourSq.page.venuedetail2.desktop.messages.hideFeaturesText=function(a,b){return"See Less"};templates.fourSq.page.venuedetail2.desktop.messages.showPopularHoursText=function(a,b){return"(See when people check in)"};
templates.fourSq.page.venuedetail2.desktop.messages.tipDeleteMessage=function(a,b){return"Tip deleted successfully"};templates.fourSq.page.venuedetail2.desktop.messages.saveVenueActionReferralMessage=function(a,b){return"\x3cspan\x3eOkay, "+soy.$$escapeHtml(a.user.firstName)+", "+soy.$$escapeHtml(a.venue.name)+' has been saved to \x3ca href\x3d"/user/'+soy.$$escapeHtml(a.user.id)+'/list/todos" target\x3d"_blank"\x3eyour to-do list\x3c/a\x3e!\x3c/span\x3e'};
templates.fourSq.page.venuedetail2.desktop.messages.addVenueReferralMessage=function(a,b){return"Thanks for making Foursquare better!"};templates.fourSq.page.venuedetail2.desktop.messages.managerEditPlaceReferralMessage=function(a,b){return'\x3cdiv\x3eThanks! If you\'d like to add more information, like which credit cards your venue takes or whether it has outdoor seating, you can always click \x3cspan class\x3d"link editMore"\x3e"Suggest an Edit"\x3c/span\x3e.\x3c/div\x3e'};
templates.fourSq.page.venuedetail2.desktop.messages.completedVenuePromptBody=function(a,b){return'\x3cdiv class\x3d"venuePromptContent"\x3e\x3cdiv class\x3d"promptText"\x3e'+soy.$$escapeHtml(a.afterText)+"\x3c/div\x3e\x3c/div\x3e"};templates.fourSq.page.venuedetail2.desktop.messages.venuePromptError=function(a,b){return"\x3cdiv\x3eThere was an error submitting your response. Please try again later.\x3c/div\x3e"};templates.fourSq.page.venuedetail2.desktop.messages.showMoreText=function(a,b){return"(Show more)"};
templates.fourSq.page.venuedetail2.desktop.messages.showLessText=function(a,b){return"(Show less)"};templates.fourSq.page.venuedetail2.desktop.messages.tipPhotoDeleteMessage=function(a,b){return"Tip Photo successfully deleted"};templates.fourSq.page.venuedetail2.desktop.messages.tipUrlRemoveMessage=function(a,b){return"Tip Link Successfully removed"};"undefined"==typeof templates.fourSq&&(templates.fourSq={});"undefined"==typeof templates.fourSq.page&&(templates.fourSq.page={});"undefined"==typeof templates.fourSq.page.venuedetail2&&(templates.fourSq.page.venuedetail2={});"undefined"==typeof templates.fourSq.page.venuedetail2.desktop&&(templates.fourSq.page.venuedetail2.desktop={});"undefined"==typeof templates.fourSq.page.venuedetail2.desktop.photos&&(templates.fourSq.page.venuedetail2.desktop.photos={});
templates.fourSq.page.venuedetail2.desktop.photos.photosBlock=function(a,b){for(var c="",d=a.photos.items,e=d.length,f=0;f<e;f++)c+=templates.fourSq.photos.galleryPhoto({photo:d[f],venue:a.venue,showTips:a.showTips,showCheckins:a.showCheckins,showVoting:a.showVoting,showBulkEdit:a.showBulkEdit});return c+=a.photos.items.length<a.venue.photos.count?'\x3cdiv class\x3d"startAutoLoad"\x3eShow more photos\x3c/div\x3e':""};templates.fourSq.page.venuedetail2.desktop.photos.bulkEditTools=function(a,b){return'\x3cdiv class\x3d"bulkEditTools"\x3e\x3cdiv class\x3d"instructions"\x3eClick checkboxes to select photos, then choose an action:\x3c/div\x3e\x3cdiv class\x3d"selectedInstructions"\x3e\x3c/div\x3e\x3cdiv class\x3d"photoEditButtons"\x3e\x3cbutton class\x3d"goodPhoto greenButton button" disabled data-action\x3d"upvote"\x3eGood\x3c/button\x3e\x3cbutton class\x3d"badPhoto blueButton button" disabled data-action\x3d"downvote"\x3eLow Quality\x3c/button\x3e\x3cbutton class\x3d"hasFace blueButton button" disabled data-action\x3d"hasFace"\x3eHas Face\x3c/button\x3e\x3cbutton class\x3d"blurry blueButton button" disabled data-action\x3d"blurry"\x3eBlurry\x3c/button\x3e\x3cbutton class\x3d"unrelated blueButton button" disabled data-action\x3d"unrelated"\x3eUnrelated\x3c/button\x3e\x3cbutton class\x3d"inappropriate redButton button" disabled data-action\x3d"inappropriate"\x3eInappropriate / Illegal\x3c/button\x3e\x3c/div\x3e\x3cspan class\x3d"closeBulkEdit"\x3e\x3c/span\x3e\x3c/div\x3e'};
templates.fourSq.page.venuedetail2.desktop.photos.numPhotosSelected=function(a,b){return"\x3cdiv\x3e"+(1==a.numPhotos?'\x3cspan class\x3d"numSelected"\x3e1\x3c/span\x3e photo selected. Flag selected photo as:':'\x3cspan class\x3d"numSelected"\x3e'+fourSq.i18n.formatNumber(a.numPhotos,"decimal",void 0,"")+"\x3c/span\x3e photos selected. Flag all selected photos as:")+"\x3c/div\x3e"};"undefined"==typeof templates.fourSq&&(templates.fourSq={});"undefined"==typeof templates.fourSq.page&&(templates.fourSq.page={});"undefined"==typeof templates.fourSq.page.venuedetail2&&(templates.fourSq.page.venuedetail2={});"undefined"==typeof templates.fourSq.page.venuedetail2.desktop&&(templates.fourSq.page.venuedetail2.desktop={});"undefined"==typeof templates.fourSq.page.venuedetail2.desktop.menu&&(templates.fourSq.page.venuedetail2.desktop.menu={});
templates.fourSq.page.venuedetail2.desktop.menu.contents=function(a,b){for(var c='\x3cdiv class\x3d"menuTitle sectionTitle"\x3e\x3cimg class\x3d"sectionIcon" src\x3d"'+soy.$$escapeHtml(fourSq.retina.isRetina()?"https://ss1.4sqi.net/img/venuepage/v2/section_title_menu@2x-25aa4c40b8aeb737be65d6119f83b84d.png":"https://ss1.4sqi.net/img/venuepage/v2/section_title_menu-4b2206affaefeda86e6f2156d65fea95.png")+'" height\x3d"25" width\x3d"25" alt\x3d"Menu"/\x3e\x3cspan class\x3d"menuText sectionText"\x3eMenu\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"menuQuickLinks"\x3e',
d=a.displayMenu.menus.items,e=d.length,f=0;f<e;f++)var g=d[f],c=c+('\x3cspan class\x3d"quickLink" data-menu-id\x3d"'+soy.$$escapeHtml(g.menuId)+'"\x3e\x3cspan class\x3d"menuCategoryName"\x3e'+soy.$$escapeHtml(g.name)+'\x3c/span\x3e \x3cspan class\x3d"menuSectionCount"\x3e'+fourSq.i18n.formatNumber(null!=(null==g.entries?null:g.entries.count)?null==g.entries?null:g.entries.count:0,"decimal",void 0,"")+"\x3c/span\x3e\x3c/span\x3e");c+='\x3c/div\x3e\x3cdiv class\x3d"venueMenu"\x3e';d=a.displayMenu.menus.items;
e=d.length;for(f=0;f<e;f++)c+='\x3cdiv class\x3d"menu"\x3e'+templates.fourSq.page.venuedetail2.desktop.menu.singleMenu({menu:d[f]})+"\x3c/div\x3e";return c+="\x3c/div\x3e"+templates.fourSq.page.venuedetail2.desktop.menu.menuDisclaimer_({partnerInfo:a.displayMenu.provider})};
templates.fourSq.page.venuedetail2.desktop.menu.singleMenu=function(a,b){for(var c='\x3cdiv class\x3d"menuInfo" id\x3d"'+soy.$$escapeHtml(a.menu.menuId)+'"\x3e\x3ch2 class\x3d"categoryName"\x3e'+soy.$$escapeHtml(a.menu.name)+"\x3c/h2\x3e"+(a.menu.description?'\x3cp class\x3d"description"\x3e'+soy.$$escapeHtml(a.menu.description)+"\x3c/p\x3e":"")+'\x3c/div\x3e\x3cdiv class\x3d"menuItems"\x3e',d=a.menu.entries.items,e=d.length,f=0;f<e;f++)c+=templates.fourSq.page.venuedetail2.desktop.menu.menuSection_({section:d[f]});
return c+"\x3c/div\x3e"};
templates.fourSq.page.venuedetail2.desktop.menu.menuSection_=function(a,b){for(var c='\x3cdiv class\x3d"section" '+(a.section.sectionId?'id\x3d"'+soy.$$escapeHtml(a.section.sectionId)+'"':"")+"\x3e"+(a.section.name?'\x3cdiv class\x3d"sectionHeader"\x3e\x3cdiv class\x3d"sectionName"\x3e'+soy.$$escapeHtml(a.section.name)+"\x3c/div\x3e\x3c/div\x3e":"")+(a.section.description?'\x3cdiv class\x3d"sectionDescriptionText"\x3e'+soy.$$escapeHtml(a.section.description)+"\x3c/div\x3e":""),d=a.section.entries.items,
e=d.length,f=0;f<e;f++)var g=d[f],c=c+(g.text?'\x3cdiv class\x3d"sectionDescriptionText"\x3e'+soy.$$escapeHtml(g.text)+"\x3c/div\x3e":"");c+='\x3cdiv class\x3d"entryContainer"\x3e\x3cdiv class\x3d"leftColumn"\x3e';d=a.section.entries.items;e=d.length;for(f=0;f<e;f++)g=d[f],c+=0!=f%2||g.text?"":templates.fourSq.page.venuedetail2.desktop.menu.menuEntry_({entry:g});c+='\x3c/div\x3e\x3cdiv class\x3d"rightColumn"\x3e';d=a.section.entries.items;e=d.length;for(f=0;f<e;f++)g=d[f],c+=1!=f%2||g.text?"":templates.fourSq.page.venuedetail2.desktop.menu.menuEntry_({entry:g});
return c+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"};
templates.fourSq.page.venuedetail2.desktop.menu.menuEntry_=function(a,b){return a.entry.text?'\x3cdiv class\x3d"entryDescriptionText"\x3e'+soy.$$escapeHtml(a.entry.text)+"\x3c/div\x3e":a.entry.name?'\x3cdiv class\x3d"entry"\x3e\x3cdiv class\x3d"entryItem"\x3e\x3cdiv class\x3d"menuHeader"\x3e\x3cspan class\x3d"title"\x3e'+soy.$$escapeHtml(a.entry.name)+'\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"entryPrice"\x3e'+(a.entry.price?soy.$$escapeHtml(a.entry.price):a.entry.prices&&0<a.entry.prices.length?
soy.$$escapeHtml(a.entry.prices[0]):"")+"\x3c/div\x3e"+(a.entry.description?'\x3cdiv class\x3d"entryDescription"\x3e'+soy.$$escapeHtml(a.entry.description)+"\x3c/div\x3e":"")+"\x3c/div\x3e":""};
templates.fourSq.page.venuedetail2.desktop.menu.menuDisclaimer_=function(a,b){return'\x3cdiv class\x3d"disclaimer"\x3e\x3cdiv class\x3d"attribution"\x3e'+(a.partnerInfo.attributionImage?'\x3ca href\x3d"'+soy.$$escapeHtml(null!=a.partnerInfo.attributionLink?a.partnerInfo.attributionLink:"#")+'"\x3e\x3cimg src\x3d"'+soy.$$escapeHtml(a.partnerInfo.attributionImage)+'" alt\x3d"The logo for our menu provider" /\x3e\x3c/a\x3e':"")+'\x3c/div\x3e\x3cp class\x3d"attributionText"\x3e'+(a.partnerInfo.attributionText?
soy.$$escapeHtml(a.partnerInfo.attributionText):"")+'\x3c/p\x3e\x3cdiv class\x3d"flagMenu"\x3e\x3cspan class\x3d"link flagLink"\x3eProblem with this menu?\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e'};"undefined"==typeof templates.fourSq&&(templates.fourSq={});"undefined"==typeof templates.fourSq.page&&(templates.fourSq.page={});"undefined"==typeof templates.fourSq.page.venuedetail2&&(templates.fourSq.page.venuedetail2={});"undefined"==typeof templates.fourSq.page.venuedetail2.desktop&&(templates.fourSq.page.venuedetail2.desktop={});"undefined"==typeof templates.fourSq.page.venuedetail2.desktop.venueinfosection&&(templates.fourSq.page.venuedetail2.desktop.venueinfosection={});
templates.fourSq.page.venuedetail2.desktop.venueinfosection.numRatings=function(a,b){return'\x3cdiv class\x3d"numRatingsBlock"\x3e\x3cdiv class\x3d"numRatings" itemprop\x3d"ratingCount"\x3e'+fourSq.i18n.formatNumber(a.count,"decimal",void 0,"")+'\x3c/div\x3e\x3cdiv class\x3d"numRatingsLabel"\x3e'+(0==a.count?"rating":1==a.count?"rating":"ratings")+"\x3c/div\x3e\x3c/div\x3e"};templates.fourSq.page.venuedetail2.desktop.venueinfosection.holdOnMessage=function(a,b){return"Please Hold On"};
templates.fourSq.page.venuedetail2.desktop.venueinfosection.adminFlyout=function(a,b){var c='\x3cdiv class\x3d"listsMenu"\x3e\x3cdiv class\x3d"myListsContainer adminLinksContainer"\x3e'+(a.venue.permissions.flagVenue?'\x3cdiv class\x3d"listMenuItem venueEditLink"\x3eSuggest an edit\x3c/div\x3e':"")+'\x3cdiv class\x3d"listMenuItem venueIdLink"\x3eCopy Venue Id\x3c/div\x3e\x3chr class\x3d"menuSeparator"\x3e'+(a.venue.permissions.editVenue?'\x3ca class\x3d"listMenuItem editLink" href\x3d"'+soy.$$escapeHtml(a.venue.canonicalPath)+
'/edit"\x3eEdit\x3c/a\x3e':"");if(a.venue.permissions.viewEditHistory)var d="/v/"+soy.$$escapeHtml(a.venue.id)+"/history"+(a.noFollowTombstones?"?followTombstones\x3dfalse":""),c=c+('\x3ca class\x3d"listMenuItem editHistoryLink" href\x3d"'+soy.$$escapeHtml(d)+'"\x3eHistory\x3c/a\x3e');return c+=(a.venue.permissions.viewFlags?'\x3ca class\x3d"listMenuItem viewFlagsLink" href\x3d"'+soy.$$escapeHtml(a.venue.canonicalPath)+'/woes"\x3eView Flags\x3c/a\x3e':"")+(a.venue.permissions.viewGeoAdminPage?'\x3ca class\x3d"listMenuItem viewGeoLink" href\x3d"'+
soy.$$escapeHtml(a.venue.canonicalPath)+'/geo"\x3eGeo\x3c/a\x3e':"")+(a.venue.permissions.viewShapesAdminPage?'\x3ca class\x3d"listMenuItem viewShapesLink" href\x3d"'+soy.$$escapeHtml(a.venue.canonicalPath)+'/shapes"\x3eShapes\x3c/a\x3e':"")+(a.venue.permissions.viewSubvenueEditorAdminPage?'\x3ca class\x3d"listMenuItem viewSubvenueEditorLink" href\x3d"'+soy.$$escapeHtml(a.venue.canonicalPath)+'/subVenueEditor"\x3eManage Subvenues\x3c/a\x3e':"")+(a.venue.permissions.canManageEvents?'\x3ca class\x3d"listMenuItem viewEventsLink" href\x3d"'+
soy.$$escapeHtml(a.venue.canonicalPath)+'/events"\x3eManage Events\x3c/a\x3e':"")+"\x3c/div\x3e\x3c/div\x3e"};"undefined"==typeof templates.fourSq&&(templates.fourSq={});"undefined"==typeof templates.fourSq.page&&(templates.fourSq.page={});"undefined"==typeof templates.fourSq.page.venuedetail2&&(templates.fourSq.page.venuedetail2={});"undefined"==typeof templates.fourSq.page.venuedetail2.desktop&&(templates.fourSq.page.venuedetail2.desktop={});"undefined"==typeof templates.fourSq.page.venuedetail2.desktop.sidevenueinfo&&(templates.fourSq.page.venuedetail2.desktop.sidevenueinfo={});
templates.fourSq.page.venuedetail2.desktop.sidevenueinfo.promptContent=function(a,b){for(var c='\x3cdiv class\x3d"venuePromptContent"\x3e\x3cdiv class\x3d"promptHeading"\x3eRate this place\x3cspan class\x3d"hidePromptButton"\x3e\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"promptText"\x3e'+soy.$$escapeHtml(a.prompt.prompt)+'\x3c/div\x3e\x3cul class\x3d"promptButtons"\x3e',d=a.prompt.options,e=d.length,f=0;f<e;f++)var g=d[f],c=c+('\x3cli class\x3d"promptButton" data-value\x3d"'+soy.$$escapeHtml(g.value)+
'" data-key\x3d"'+soy.$$escapeHtml(g.key)+'"\x3e'+("thumbs"==a.prompt.iconFamily&&3==a.prompt.options.length?0==f?'\x3cdiv\x3e\x3cimg height\x3d"22" width\x3d"22" src\x3d"'+soy.$$escapeHtml(fourSq.retina.isRetina()?"https://ss1.4sqi.net/img/venuepage/v2/venue_prompt_yes@2x-2e72b423330de2ed0c40890a294e2328.png":"https://ss1.4sqi.net/img/venuepage/v2/venue_prompt_yes-43d0d393132d4b17b62a98bd141ab235.png")+'" alt\x3d"Yes icon"/\x3e\x3c/div\x3e':1==f?'\x3cdiv\x3e\x3cimg height\x3d"22" width\x3d"22" src\x3d"'+
soy.$$escapeHtml(fourSq.retina.isRetina()?"https://ss1.4sqi.net/img/venuepage/v2/venue_prompt_okay@2x-ffd4448444726e12822fa66fad0c9851.png":"https://ss0.4sqi.net/img/venuepage/v2/venue_prompt_okay-76f65e01b33eeafdd9408930205a0e52.png")+'" alt\x3d"Okay icon"/\x3e\x3c/div\x3e':2==f?'\x3cdiv\x3e\x3cimg height\x3d"22" width\x3d"22" src\x3d"'+soy.$$escapeHtml(fourSq.retina.isRetina()?"https://ss0.4sqi.net/img/venuepage/v2/venue_prompt_no@2x-33ff2910dee5a04debc672231a9408c0.png":"https://ss0.4sqi.net/img/venuepage/v2/venue_prompt_no-a31e38a82891233c70729920cbb9d0eb.png")+
'" alt\x3d"No icon"/\x3e\x3c/div\x3e':"":"")+'\x3cspan class\x3d"optionText"\x3e'+soy.$$escapeHtml(g.displayName)+"\x3c/span\x3e\x3c/li\x3e");return c+"\x3c/ul\x3e\x3c/div\x3e"};
templates.fourSq.page.venuedetail2.desktop.sidevenueinfo.attributeAttr_=function(a,b){return function(){var b="";if(a.venue.attributes&&a.venue.attributes.groups)for(var d=a.venue.attributes.groups,e=d.length,f=0;f<e;f++){var g=d[f];if(g.type==a.groupType){for(var h="",l=g.items,p=l.length,q=0;q<p;q++)h+=soy.$$escapeHtml(l[q].displayValue)+(q!=p-1?", ":"");b+='\x3cdiv class\x3d"sideVenueBlockRow sideVenueAttributeRow"\x3e\x3cdiv class\x3d"venueRowKey"\x3e'+soy.$$escapeHtml(function(a){return a&&a.contentKind&&
a.contentKind==goog.soy.data.SanitizedContentKind.HTML?a:soydata.VERY_UNSAFE.ordainSanitizedHtml(a)}(g.name))+'\x3c/div\x3e\x3cdiv class\x3d"venueRowValue"\x3e'+soy.$$escapeHtml(h&&h.contentKind&&h.contentKind==goog.soy.data.SanitizedContentKind.HTML?h:soydata.VERY_UNSAFE.ordainSanitizedHtml(h))+"\x3c/div\x3e\x3c/div\x3e"}}return b}()};
templates.fourSq.page.venuedetail2.desktop.sidevenueinfo.mostRecentEdit_=function(a,b){return'\x3cdiv class\x3d"sideVenueBlockRow sideVenueAttributeRow sideVenueRecentEdit"\x3ePlace Information last updated\x3cdiv class\x3d""\x3e'+helpers.util.shortDate({when:a.venue.lastEdit.createdAt})+" by "+((null==a.venue?0:null==a.venue.lastEdit?0:null==a.venue.lastEdit.reportingUsers?0:a.venue.lastEdit.reportingUsers.items[0])?helpers.user.fullNameWLink(a.venue.lastEdit.reportingUsers.items[0]):"")+"\x3c/div\x3e\x3c/div\x3e"};
</script>

</body>
</html>
