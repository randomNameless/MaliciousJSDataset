<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>widget.html</title>
</head>
<body>

<script>
function e(e){return JSON.parse(JSON.stringify(e,((e,t)=>void 0===t?null:t)))}function t(){return document.body.offsetTop}async function s(e,t){const s=document.createElement(e);return new Promise(((r,n)=>{switch(e){case"img":s.addEventListener("load",(()=>{r(t)}));break;case"video":s.addEventListener("loadeddata",(()=>r(t)))}s.addEventListener("error",(e=>{n(e)})),s.src=t}))}function r({text:e,maxLines:t=2,maxChars:s=50}){if(!e)return;const r=e.match(/.*/g).filter((e=>e.length>0)).slice(0,t).join("").length,n=Math.min(r,s);return e.slice(0,n)}function n(e,t){return`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' x='0px' y='0px' width='${e}' height='${t}'%3E%3C/svg%3E%0A`}function i(e){return new Promise((t=>{let s=new IntersectionObserver((e=>{let r=e.reduce(((e,t,s)=>t.intersectionRatio>e.intersectionRatio?{index:s,intersectionRatio:t.intersectionRatio}:e),{intersectionRatio:0,index:null});s.disconnect(),s=null,t(r.index)}));e.forEach((e=>s.observe(e)))}))}function o(e,t){let s=!1,r=new IntersectionObserver((e=>{s||(r.disconnect(),r=null,t(e[0].boundingClientRect))}));return r.observe(e),function(){s||(s=!0,r&&(r.disconnect(),r=null))}}function a(e){return e.isConnected?"#document"===e.nodeName||e instanceof ShadowRoot?e:a(e.parentNode):document}function d(e,t,s=null,r=!1){let n=r?performance.now():0,i=null;return(...r)=>{let o=performance.now();clearTimeout(i),i=setTimeout((()=>e.apply(s,r)),t),o-n>t&&(clearTimeout(i),n=o,e.apply(s,r))}}function l(e,t){Object.entries(t).forEach((([t,s])=>{s?e.classList.add(t):e.classList.remove(t)}))}function c(e,t){Object.keys(t).forEach((s=>{e.style.setProperty(s,t[s])}))}function h(e,t,s,r=0){if("string"==typeof s&&(s=[s]),r>0){let r=!1;return Object.keys(e).length!==Object.keys(t).length||(Object.keys(e).forEach((n=>{h(e[n],t[n],s)&&(r=!0)})),r)}return s.reduce(((s,r)=>!u(e?.[r],t?.[r])||s),!1)}function u(e,t,s=!1,r=!1){if(r&&(Array.isArray(e)&&(e=e.sort()),Array.isArray(t)&&(t=t.sort())),s&&("number"==typeof e&&(e=e.toString()),"number"==typeof t&&(t=t.toString())),typeof e!=typeof t)return!1;if(null===e&&null===t)return!0;if(null===e&&null!==t)return!1;if(null!==e&&null===t)return!1;if(void 0===e&&void 0===t)return!0;if(void 0===e&&void 0!==t)return!1;if(void 0!==e&&void 0===t)return!1;if("object"==typeof e)return Object.keys(e).length===Object.keys(t).length&&Object.entries(e).reduce(((e,[n,i])=>!!u(i,t[n],s,r)&&e),!0);if(Array.isArray(e)){let n=!0;return e.forEach(((e,i)=>{u(e,t[i],s,r)||(n=!1)})),n}return e===t}function p(e,t="assertive"){const s=document.createElement("div");s.innerHTML=e,s.setAttribute("aria-live",t),s.setAttribute("aria-atomic","true"),s.style.cssText="\n    position: absolute;\n    position: absolute !important;\n    width: 1px !important;\n    height: 1px !important;\n    padding: 0 !important;\n    margin: -1px !important;\n    overflow: hidden !important;\n    clip: rect(0,0,0,0) !important;\n    white-space: nowrap !important;\n    border: 0 !important;\n  ",requestAnimationFrame((()=>{document.body.appendChild(s),setTimeout((()=>{s.remove()}),500)}))}function g(e,t,s){e.length===s&&e.shift(),e.push(t)}let f={isMuted:!0,keyboardNavEnabled:!1,popoverOverlayHslArray:[0,0,0],popoverOverlayOpacity:.6},m=!1,b=null,w=null;const y=new Map,v=new Map,E=new Map,C=new Set;!function e(){E.forEach((e=>{const t=performance.now(),{minWait:s,lastInvocation:r,callback:n}=e,i=t-r;i>s&&(n(i),E.set(n,{...e,lastInvocation:t}))})),requestAnimationFrame(e)}();class P extends HTMLElement{label="BaseElement";storedProperties=new Map;requiredProperties=[];hasRequiredProps=!1;propChangeHandlers=new Map;delayedPropChangeHandlers=new Map;queuedPropUpdates=new Set;localState=Object.freeze({});localStateChangeHandlers=new Set;connectHandlers=new Set;disconnectHandlers=new Set;rafs=new Map;timeouts=new Map;constructor(){if(super(),this.t=this.t.bind(this),this.i=this.i.bind(this),this.o=this.o.bind(this),!b){let e=window.ResizeObserver;"ResizeObserver"in window==0&&(e=window.BeholdResizeObserver),b=new e((e=>{e.forEach((e=>{const t=y.get(e.target);t&&t(e)}))}))}w||(w=new IntersectionObserver((e=>{e.forEach((e=>{const t=v.get(e.target);t&&t(e)}))}))),m||(m=!0,document.addEventListener("keydown",this.t),document.addEventListener("mousedown",this.i),document.addEventListener("mousemove",this.o,{passive:!0}))}connectedCallback(){this.connectHandlers.forEach((e=>e()))}disconnectedCallback(){this.rafs.forEach((e=>cancelAnimationFrame(e))),this.rafs.clear(),this.timeouts.forEach((e=>clearTimeout(e))),this.timeouts.clear(),this.disconnectHandlers.forEach((e=>e()))}onConnect(e){this.connectHandlers.add(e)}onDisconnect(e){this.disconnectHandlers.add(e)}onResize(e,t,s){y.set(t,s.bind(e)),b.observe(t),this.disconnectHandlers.add((()=>{y.delete(t),b.unobserve(t)}))}onIntersection(e,t){v.set(e,t),w.observe(e),this.disconnectHandlers.add((()=>{v.delete(e),w.unobserve(e)}))}onLoop(e,t=50){E.set(e,{minWait:t,lastInvocation:0,callback:e}),this.disconnectHandlers.add((()=>{E.delete(e)}))}onPropChange(t,s,r=null,n=null){r?this.requiredProperties.push(...r):this.requiredProperties.push(...s),s.forEach((s=>{void 0!==this[s]&&this.storedProperties.set(s,this[s]),this.propChangeHandlers.get(s)||(this.propChangeHandlers.set(s,[]),this.delayedPropChangeHandlers.set(s,[])),n?this.delayedPropChangeHandlers.get(s).push(t):this.propChangeHandlers.get(s).push(t),Object.defineProperty(this,s,{set(t){void 0===t&&(t=null,console.warn(`Attempted to set value of ${s} as "undefined" on ${this.label}. ${s} was coerced to null instead.`)),t=e(t);const r=this.storedProperties.has(s)?e(this.storedProperties.get(s)):null;this.storedProperties.set(s,t),this.hasRequiredProps=this.requiredProperties.every((e=>this.storedProperties.has(e))),this.queueHandlers({prop:s,oldValue:r,newValue:t})},get(){return this.storedProperties.get(s)}})})),n&&(n=n.bind(this),queueMicrotask((()=>{this.hasRequiredProps&&(n(),this.delayedPropChangeHandlers.forEach(((e,t)=>{this.propChangeHandlers.set(t,[...this.propChangeHandlers.get(t),...e])})))}))),this.queueMissingPropsCheck()}queueHandlers({prop:e,oldValue:t,newValue:s}){this.hasRequiredProps?(this.queuedPropUpdates.size&&(this.queuedPropUpdates.delete(e),this.runQueuedPropHandlers()),this.propChangeHandlers.get(e).forEach((r=>{r.call(this,{changedProp:e,oldValue:t,newValue:s})}))):this.queuedPropUpdates.add(e)}runQueuedPropHandlers(){this.queuedPropUpdates.forEach((e=>{this.propChangeHandlers.get(e).forEach((t=>{t.call(this,{changedProp:e,oldValue:null,newValue:this[e]})}))})),this.queuedPropUpdates.clear()}updateLocalState(t){const s=Object.freeze(e(this.localState));this.localState=Object.freeze({...this.localState,...t}),this.localStateChangeHandlers.forEach((e=>e({changedProps:Object.keys(t),oldState:s,newState:this.localState})))}onLocalStateChange(e,t){this.localState={...this.localState,...t};const s=e.bind(this);this.localStateChangeHandlers.add(s)}updateGlobalState(t){const s=e(f);f={...f,...t},C.forEach((e=>e({changedProps:Object.keys(t),oldState:s,newState:f})))}onGlobalStateChange(e){this.connectHandlers.add((()=>{const t=e.bind(this);C.add(t),this.disconnectHandlers.add((()=>C.delete(t)))}))}t(e){"Tab"===e.key&&this.updateGlobalState({keyboardNavEnabled:!0})}i(e){0===e.clientX&&0===e.clientY||this.updateGlobalState({keyboardNavEnabled:!1})}o(e){e.ctrlKey||e.altKey||e.shiftKey||e.metaKey||0===e.movementX||0===e.movementY||this.updateGlobalState({keyboardNavEnabled:!1})}get globalState(){return f}set globalState(e){throw new Error("Shared state cannot be set directly. Use this.updateGlobalState() instead.")}raf(e,t,s=!0){s&&cancelAnimationFrame(this.rafs.get(t));const r=requestAnimationFrame((()=>{e(),this.rafs.delete(t)}));return this.rafs.set(t,r),r}cancelRaf(e){cancelAnimationFrame(this.rafs.get(e)),this.rafs.delete(e)}to(e,t,s){const r=setTimeout((()=>{e(),this.timeouts.delete(s)}),t);return this.timeouts.set(s,r),r}cancelTo(e){clearTimeout(this.timeouts.get(e)),this.timeouts.delete(e)}queueMissingPropsCheck(){queueMicrotask((()=>{if(this.requiredProperties.length&&!this.hasRequiredProps){const e=this.requiredProperties.filter((e=>!this.storedProperties.has(e)));console.error(`${this.label||this.tagName} is missing required props: ${e.join(", ")}`)}}))}}function S(e){let{type:t="div",classes:s=[],contents:r=[],attributes:n={},props:i={},style:o={},listeners:a={}}=e;s=Array.isArray(s)?s:[s];const d=document.createElement(t);return Array.isArray(r)||(r=[r]),r=r.filter((e=>null!=e)).map((e=>{if("string"==typeof e&&e.includes("</svg>")){const t=document.createElement("template");return t.innerHTML=e,t.content}return e})),d.beholdReplaceChildren(...r),s.length&&(d.className=s.join(" ")),Object.keys(n).forEach((e=>{null!==n[e]&&void 0!==n[e]?d.setAttribute(e,n[e]):d.removeAttribute(e)})),Object.assign(d,i),Object.keys(o).forEach((e=>{"--"===e.substring(0,2)?d.style.setProperty(e,o[e]):d.style[e]=o[e]})),Object.keys(a).forEach((e=>{d.addEventListener(e,a[e])})),d}class H extends P{label="BeholdWidget";shadow;abortController;loadedWidget;static get observedAttributes(){return["feed-id"]}constructor(){super(),this.shadow=this.attachShadow({mode:"open"}),this.abortController=null,this.onPropChange(this.l,["widgetSettings","feedMetadata","posts","previewLoadingColors","errorMessage"],[])}attributeChangedCallback(e,t,s){"feed-id"===e&&s!==t&&this.getFeed(s)}l({changedProp:e,oldValue:t,newValue:s}){"errorMessage"!==e||t||!s?"widgetSettings"===e&&h(s,t,"type")&&s?.type?this.loadWidget(s.type):this.loadedWidget&&!u(s,t)&&(this.loadedWidget[e]=s):this.loadWidget("ErrorMessage")}async loadWidget(e){if(await import("./replaceChildren-4H1qCpyP-Byt1OSKK.js"),"ResizeObserver"in window==0){const{ResizeObserver:e}=await import("./resizeObserver--rsjm-GV-BrKV6oIH.js");window.BeholdResizeObserver=e}const t=(await this.importWidget(e.replace(/.?/,(e=>e.toUpperCase())))).register(),s=S({type:t}),r=S({type:"style",contents:":host{align-items:center;box-sizing:border-box;display:flex;flex-wrap:wrap;justify-content:center;margin:0;min-width:50px;overflow:hidden;position:relative;width:100%}:host *{box-sizing:border-box}:host([hidden]){display:none}".toString()});this.shadow.beholdReplaceChildren(s,r),this.loadedWidget=this.shadow.querySelector(t),this.widgetSettings&&(this.loadedWidget.widgetSettings=this.widgetSettings),this.feedMetadata&&(this.loadedWidget.feedMetadata=this.feedMetadata),this.posts&&(this.loadedWidget.posts=this.posts),this.loadedWidget.errorMessage=this.errorMessage||null,this.dispatchEvent(new Event("load")),window.dispatchEvent(new CustomEvent("behold:widget-loaded",{detail:{id:this["feed-id"]}}))}async getFeed(e){if(e){this.abortController&&this.abortController.abort(),this.abortController=new AbortController;try{const t=await fetch(`https://feeds.behold.so/${e}`,{mode:"cors",signal:this.abortController.signal});if(t.ok){const e=await t.json();if(!e.widgetSettings)throw new Error("JSON feeds cannot be used as a widget");if(e.widgetSettings.klaviyoWebFeedId)throw new Error("Klaviyo feeds cannot be used as an embedded widget");this.widgetSettings=e.widgetSettings,this.feedMetadata={username:e.username,profilePictureUrl:e.profilePictureUrl,website:e.website,followersCount:e.followersCount,hashtags:e.hashtags},this.posts=e.posts||e.media}else{const e=await t.text();this.errorMessage=e}}catch(e){"The user aborted a request."!==e.message&&(this.errorMessage=e.message)}}else this.errorMessage="No feed ID provided"}async importWidget(e){const{default:t}=await function(e){switch(e){case"./widgets/ElasticCarousel.ts":return import("./ElasticCarousel-yMgX7-gI-XPgnu9A1.js");case"./widgets/ErrorMessage.ts":return import("./ErrorMessage-DGlXu6GU-BLSaRcbe.js");case"./widgets/GalleryWall.ts":return import("./GalleryWall-dPLHh1jp-x85ep5B-.js");case"./widgets/Grid.ts":return import("./Grid-dMGRAm26-CbrrVYNk.js");default:return new Promise((function(t,s){("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(s.bind(null,new Error("Unknown variable dynamic import: "+e)))}))}}(`./widgets/${e}.ts`);return t}}var M=(e="behold-widget")=>{customElements.get(e)||customElements.define(e,class extends H{})};M(),function e(){document.querySelectorAll("[data-behold-id]").forEach((e=>{const t=e.getAttribute("data-behold-id"),s=document.createElement("behold-widget");s.setAttribute("feed-id",t),e.replaceWith(s)})),setTimeout(e,100)}();export{P as S,a,l as c,h as d,t as e,c as h,n as i,d as l,r as n,i as o,p,o as r,s,u,g as w,S as x};

</script>

</body>
</html>
