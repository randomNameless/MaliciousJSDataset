!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("SmartSearch",[],(function(){return n()})):"object"==typeof exports?exports.SmartSearch=n():t.SmartSearch=n().SmartSearch}(this,(function(){return function(t){var n={};function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(r,i,function(n){return t[n]}.bind(null,i));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=1)}([function(t,n,e){!function(t){"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,e)};function e(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function r(){}var i=Array.isArray||function(t){return t instanceof Array};function o(t){return t&&t._isObservable}function u(t,n){for(var e=0;e<t.length;e++)if(!n(t[e]))return!1;return!0}function s(t,n){for(var e=0;e<t.length;e++)if(n(t[e]))return!0;return!1}function a(t,n){return-1!==l(t,n)}function c(t,n){for(var e,r=[],i=0;i<n.length;i++)t(e=n[i])&&r.push(e);return r}function f(t){return function(n,e){return t(e,n)}}function h(t,n,e){for(var r=0;r<t.length;r++)n=e(n,t[r]);return n}function p(t){return t[0]}var l=Array.prototype.indexOf?function(t,n){return t.indexOf(n)}:function(t,n){for(var e=0;e<t.length;e++)if(n===t[e])return e;return-1};function v(t){return"function"==typeof t}function d(t,n){for(var e,r=[],i=0;i<n.length;i++)e=n[i],r.push(t(e));return r}function y(t){return t.slice(1,t.length)}function _(t){return i(t)?t:[t]}function m(t){return"function"==typeof t?t:function(n){return t}}var g={indexOf:l,indexWhere:function(t,n){for(var e=0;e<t.length;e++)if(n(t[e]))return e;return-1},head:p,always:function(t){return function(){return t}},negate:function(t){return function(n){return!t(n)}},empty:function(t){return 0===t.length},tail:y,filter:c,map:d,each:function(t,n){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&n(e,t[e])},toArray:_,contains:a,id:function(t){return t},last:function(t){return t[t.length-1]},all:u,any:s,without:function(t,n){return c((function(n){return n!==t}),n)},remove:function(t,n){var e=l(n,t);if(e>=0)return n.splice(e,1)},fold:h,flatMap:function(t,n){return h(n,[],(function(n,e){return n.concat(t(e))}))},bind:function(t,n){return function(){return t.apply(n,arguments)}},isFunction:v,toFunction:m,toString:function t(n){var e={}.hasOwnProperty;try{if(w++,null==n)return"undefined";if(v(n))return"function";if(i(n))return w>5?"[..]":"["+d(t,n).toString()+"]";if(null!=(null!=n?n.toString:void 0)&&n.toString!==Object.prototype.toString)return n.toString();if("object"==typeof n){if(w>5)return"{..}";var r=[];for(var o in n)if(e.call(n,o)){var u=function(){try{return n[o]}catch(t){return t}}();r.push(t(o)+":"+t(u))}return"{"+r+"}"}return n}finally{w--}}},w=0,b=void 0,S="<no-more>";function E(t,n){if(!n)throw new Error(t)}function P(t){return E("not a function : "+t,g.isFunction(t))}function I(t){return E("no arguments supported",0===t.length)}var O={scheduler:{setTimeout:function(t,n){return setTimeout(t,n)},setInterval:function(t,n){return setInterval(t,n)},clearInterval:function(t){return clearInterval(t)},clearTimeout:function(t){return clearTimeout(t)},now:function(){return(new Date).getTime()}}},D=void 0,x=[],M={},z=[],A=0,k={},T=!1;function C(t){t<=A||(z[t-1]||(z[t-1]=[[],0]),A=t)}function L(t,n){if(!D&&!T)return n();C(1);for(var e=0;e<A-1&&!j(t,z[e][0]);)e++;z[e][0].push([t,n]),D||q()}function j(t,n){for(var e=0;e<n.length;e++)if(n[e][0].id==t.id)return!0;return!1}function q(){var t=A;if(t){var n=!T;T=!0;try{for(;A>=t;){var e=z[A-1];if(!e)throw new Error("Unexpected stack top: "+e);var r=e[0],i=e[1];if(!(i<r.length)){e[0]=[],e[1]=0;break}var o=r[i][1];e[1]++,C(A+1);var u=!1;try{for(o(),u=!0;A>t&&0==z[A-1][0].length;)A--}finally{u||(z=[],A=0)}}}finally{n&&(T=!1)}}}function B(t,n){if(D){var e=M[t.id];return void 0===e?(e=M[t.id]=[n],x.push(t)):e.push(n)}return n()}function N(t,n){var e=x[t],r=e.id,i=M[r];x.splice(t,1),delete M[r],n&&x.length>0&&function t(n){if(!k[n.id]){for(var e,r=n.internalDeps(),i=0;i<r.length;i++)e=r[i],t(e),M[e.id]&&N(g.indexOf(x,e),!1);k[n.id]=!0}}(e);for(var o=0;o<i.length;o++)(0,i[o])()}var U={toString:function(){return g.toString({rootEvent:D,processingAfters:T,waiterObs:x,waiters:M,aftersStack:z,aftersStackHeight:A,flushed:k})},whenDoneWith:B,hasWaiters:function(){return x.length>0},inTransaction:function(t,n,e,r){if(D)return e.apply(n,r);D=t;try{var i=e.apply(n,r);!function(){for(;x.length>0;)N(0,!0);k={}}()}finally{D=void 0,q()}return i},currentEventId:function(){return D?D.id:void 0},wrappedSubscribe:function(t,n,e){P(e);var r=!1,i=!1,o=function(){i=!0},u=function(){r=!0,o()};return o=n((function(n){return L(t,(function(){r||e(n)===S&&u()})),b})),i&&o(),u},afterTransaction:L,soonButNotYet:function(t,n){D?B(t,n):O.scheduler.setTimeout(n,0)},isInTransaction:function(){return void 0!==D}},R=function(){function t(t,n,e){void 0===e&&(e=[]),this._isDesc=!0,this.context=t,this.method=n,this.args=e}return t.prototype.deps=function(){return this.cachedDeps||(this.cachedDeps=F([this.context].concat(this.args))),this.cachedDeps},t.prototype.toString=function(){var t=g.map(g.toString,this.args);return g.toString(this.context)+"."+g.toString(this.method)+"("+t+")"},t}();function W(t,n){for(var e=[],r=2;r<arguments.length;r++)e[r-2]=arguments[r];var i=t||n;return i&&i._isDesc?t||n:new R(t,n,e)}function F(t){return i(t)?g.flatMap(F,t):o(t)?[t]:(null!=t?t._isSource:void 0)?[t.obs]:[]}var V=function(){return b},K=function(){return b};function H(t,n,e){return e.transform(function(t,n){var e=t;return function(t,r){var i=n(e,t),o=i[0],u=i[1];e=o;for(var s=b,a=0;a<u.length;a++)if((s=r(u[a]))===S)return s;return s}}(t,n),new R(e,"withStateMachine",[t,n]))}var Y=function(){function t(t){this._isSome=!0,this.isDefined=!0,this.value=t}return t.prototype.getOrElse=function(t){return this.value},t.prototype.get=function(){return this.value},t.prototype.filter=function(n){return n(this.value)?new t(this.value):Q},t.prototype.map=function(n){return new t(n(this.value))},t.prototype.forEach=function(t){t(this.value)},t.prototype.toArray=function(){return[this.value]},t.prototype.inspect=function(){return"Some("+this.value+")"},t.prototype.toString=function(){return this.inspect()},t}(),Q={_isNone:!0,getOrElse:function(t){return t},get:function(){throw new Error("None.get()")},filter:function(){return Q},map:function(){return Q},forEach:function(){},isDefined:!1,toArray:function(){return[]},inspect:function(){return"None"},toString:function(){return this.inspect()}};function J(){return Q}function G(t){return t&&(t._isSome||t._isNone)?t:new Y(t)}var X=0,$=function(){function t(){this.id=++X,this.isEvent=!0,this._isEvent=!0,this.isEnd=!1,this.isInitial=!1,this.isNext=!1,this.isError=!1,this.hasValue=!1}return t.prototype.filter=function(t){return!0},t.prototype.inspect=function(){return this.toString()},t.prototype.log=function(){return this.toString()},t.prototype.toNext=function(){return this},t}(),Z=function(t){function n(n){var e=t.call(this)||this;if(e.hasValue=!0,n instanceof $)throw new it("Wrapping an event inside other event");return e.value=n,e}return e(n,t),n.prototype.fmap=function(t){return this.apply(t(this.value))},n.prototype.filter=function(t){return t(this.value)},n.prototype.toString=function(){return g.toString(this.value)},n.prototype.log=function(){return this.value},n}($),tt=function(t){function n(n){var e=t.call(this,n)||this;return e.isNext=!0,e._isNext=!0,e}return e(n,t),n.prototype.apply=function(t){return new n(t)},n}(Z),nt=function(t){function n(n){var e=t.call(this,n)||this;return e.isInitial=!0,e._isInitial=!0,e}return e(n,t),n.prototype.apply=function(t){return new n(t)},n.prototype.toNext=function(){return new tt(this.value)},n}(Z),et=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.hasValue=!1,n}return e(n,t),n.prototype.fmap=function(t){return this},n}($),rt=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.isEnd=!0,n}return e(n,t),n.prototype.toString=function(){return"<end>"},n}(et),it=function(t){function n(n){var e=t.call(this)||this;return e.isError=!0,e.error=n,e}return e(n,t),n.prototype.toString=function(){return"<error> "+g.toString(this.error)},n}(et);function ot(t){return new nt(t)}function ut(t){return new tt(t)}function st(){return new rt}function at(t){return t&&t._isEvent?t:ut(t)}function ct(t){return t&&t._isEvent}function ft(t){return t&&t._isInitial}function ht(t){return t.isError}function pt(t){return t.hasValue}function lt(t){return t.isEnd}function vt(t,n){return t===n}function dt(t,n,e){return n.transform(yt(t),e||new R(n,"take",[t]))}function yt(t){return function(n,e){return n.hasValue?--t>0?e(n):(0===t&&e(n),e(st()),S):e(n)}}function _t(t,n){n.subscribe((function(n){return"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,t.concat([n.log()])),b}))}function mt(t){return function(n,e){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log&&console.log.apply(console,t.concat([n.log()])),e(n)}}function gt(t,n,e){var i,o=n,u=!1;return i=new Wn(new R(t,"scan",[n,e]),(function(n){var s=!1,a=r,c=b,f=function(){return s||(s=u=!0,(c=n(new nt(o)))===S&&(a(),a=r)),c};return a=t.subscribeInternal((function(t){if(pt(t)){if(u&&t.isInitial)return b;t.isInitial||f(),s=u=!0;var r=e(o,t.value);return o=r,n(t.apply(r))}return t.isEnd&&(c=f()),c!==S?n(t):c})),U.whenDoneWith(i,f),a}))}var wt=function(){function t(t){void 0===t&&(t=[]),this.unsubscribed=!1,this.unsubscribe=g.bind(this.unsubscribe,this),this.unsubscribed=!1,this.subscriptions=[],this.starting=[];for(var n,e=0;e<t.length;e++)n=t[e],this.add(n)}return t.prototype.add=function(t){var n=this;if(!this.unsubscribed){var e=!1,i=r;this.starting.push(t),i=t(this.unsubscribe,(function(){n.unsubscribed||(e=!0,n.remove(i),g.remove(t,n.starting))})),this.unsubscribed||e?i():this.subscriptions.push(i),g.remove(t,this.starting)}},t.prototype.remove=function(t){if(!this.unsubscribed)return void 0!==g.remove(t,this.subscriptions)?t():void 0},t.prototype.unsubscribe=function(){if(!this.unsubscribed){this.unsubscribed=!0;for(var t=this.subscriptions,n=0;n<t.length;n++)t[n]();this.subscriptions=[],this.starting=[]}},t.prototype.count=function(){return this.unsubscribed?0:this.subscriptions.length+this.starting.length},t.prototype.empty=function(){return 0===this.count()},t}();function bt(t,n){return function(e){var i=!1,o=!1,u=r,s=b,a=function(){if(!i)return t.forEach((function(t){if(i=!0,(s=e(new nt(t)))===S)return u(),u=r,r}))};return u=n((function(n){return n instanceof Z?n.isInitial&&!o?(t=new Y(n.value),b):(n.isInitial||a(),i=!0,t=new Y(n.value),e(n)):(n.isEnd&&(s=a()),s!==S?e(n):s)})),o=!0,a(),u}}function St(t,n){return P(n),new Wn(t,bt(J(),n))}function Et(t){var n=new Kn(new R("Bacon","once",[t]),(function(e){return U.soonButNotYet(n,(function(){e(at(t)),e(st())})),r}));return n}function Pt(t,n,e){void 0===e&&(e={});var r=n,i=[r],o=[],u=n._isProperty,s=!1,a=(u?St:Yn)(e.desc||new R(n,"flatMap_",[t]),(function(n){var i=new wt,a=[];function c(e){if(u&&e.isInitial){if(s)return b;s=!0}var r=Ot(t(e));return o.push(r),i.add((function(t,e){return r.subscribeInternal((function(i){if(i.isEnd)return g.remove(r,o),function(){var t=a.shift();t&&c(t)}(),f(e),S;i=i.toNext();var u=n(i);return u===S&&t(),u}))}))}function f(t){return t(),i.empty()?n(st()):b}return i.add((function(t,o){return r.subscribeInternal((function(t){return t.isEnd?f(o):t.isError&&!e.mapError?n(t):e.firstOnly&&i.count()>1?b:i.unsubscribed?S:(e.limit&&i.count()>e.limit?a.push(t):c(t),b)}))})),i.unsubscribe}));return a.internalDeps=function(){return o.length?i.concat(o):i},a}function It(t){return"function"==typeof t?function(n){return pt(n)?t(n.value):n}:function(n){return t}}function Ot(t){return o(t)?t:Et(t)}function Dt(t,n){return Pt(n,t,{mapError:!0,desc:new R(t,"flatMapEvent",[n])})}var xt=function(){function t(t,n){this._isSource=!0,this.flatten=!0,this.ended=!1,this.obs=t,this.sync=n}return t.prototype.subscribe=function(t){return this.obs.subscribeInternal(t)},t.prototype.toString=function(){return this.obs.toString()},t.prototype.markEnded=function(){this.ended=!0},t.prototype.mayHave=function(t){return!0},t}(),Mt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e(n,t),n.prototype.consume=function(){return this.value},n.prototype.push=function(t){this.value=t},n.prototype.hasAtLeast=function(t){return!!this.value},n}(xt),zt=function(t){function n(n,e){var r=t.call(this,n,e)||this;return r.flatten=!1,r.queue=[],r}return e(n,t),n.prototype.consume=function(){return this.queue.shift()},n.prototype.push=function(t){this.queue.push(t)},n.prototype.mayHave=function(t){return!this.ended||this.queue.length>=t},n.prototype.hasAtLeast=function(t){return this.queue.length>=t},n}(xt),At=function(t){function n(n){var e=t.call(this,n,!0)||this;return e.queue=[],e}return e(n,t),n.prototype.consume=function(){var t=this.queue;return this.queue=[],{value:t}},n.prototype.push=function(t){return this.queue.push(t.value)},n.prototype.hasAtLeast=function(t){return!0},n}(xt);function kt(t){return null!=t&&(t._isSource?t.sync:t._isEventStream)}function Tt(t){return null!=t&&t._isSource?t:null!=t&&t._isProperty?new Mt(t,!1):new zt(t,!0)}function Ct(){return new Kn(W("Bacon","never"),(function(t){return t(st()),r}))}function Lt(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return qt(Hn,t)}function jt(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return qt(St,t)}function qt(t,n){if(0===n.length)return Ct();var e=function(t){for(var n=[],e=[],r=0;r<t.length;r++){for(var i,o=t[r],u=o[0],s={f:o[1],ixs:[]},a=!1,c=0;c<u.length;c++){i=u[c];var f=l(n,i);a||(a=kt(i)),f<0&&(n.push(i),f=n.length-1);for(var h=0;h<s.ixs.length;h++){var p=s.ixs[h];p.index===f&&p.count++}s.ixs.push({index:f,count:1})}if(u.length>0&&!a)throw new Error("At least one EventStream required, none found in "+u);u.length>0&&e.push(s)}return[d(Tt,n),e]}(Rt(n)),r=e[0],i=e[1];if(!r.length)return Ct();var o,f,h=s(r,(function(t){return t.flatten}))&&(o=d((function(t){return t.obs}),r),void 0===f&&(f=[]),s(o,(function t(n){if(a(f,n))return!0;var e=n.internalDeps();return e.length?(f.push(n),s(e,t)):(f.push(n),!1)}))),p=t(new R("Bacon","when",Array.prototype.slice.call(n)),(function(t){var n=[],e=!1;function o(t){for(var n=0;n<t.ixs.length;n++){var e=t.ixs[n];if(!r[e.index].hasAtLeast(e.count))return!1}return!0}function s(t){for(var n=0;n<t.ixs.length;n++){var e=t.ixs[n];if(!r[e.index].mayHave(e.count))return!0}return!1}function a(t){return!t.source.flatten}return new wt(d((function(f){return function(l){function v(){return U.whenDoneWith(p,d)}function d(){var f=function e(){var u;if(void 0!==(u=n.pop()))for(var s,f=b,h=0;h<i.length;h++)if(o(s=i[h])){for(var p=[],l=0;l<s.ixs.length;l++){var v=r[s.ixs[l].index].consume();if(!v)throw new Error("Event was undefined");p.push(v.value)}var d=s.f.apply(null,p);return f=t(u.e.apply(d)),n.length&&(n=c(a,n)),f===S?f:e()}return b}();e&&(u(r,Wt)||u(i,s))&&(f=S,t(st())),f===S&&l()}return f.subscribe((function(r){var i=b;if(r.isEnd)e=!0,f.markEnded(),v();else if(r.isError)i=t(r);else{var o=r;f.push(o),f.sync&&(n.push({source:f,e:o}),h||U.hasWaiters()?v():d())}return i===S&&l(),i}))}}),r)).unsubscribe}));return p}function Bt(t){for(var n=0,e=t.length,r=[];n<e;){var i=_(t[n++]),o=m(t[n++]);r.push([i,o])}return E("when: expecting arguments in the form (Observable+,function)+",e%2==0),r}function Nt(t){return t instanceof Array&&!o(t[t.length-1])}function Ut(t){return t[0]instanceof Array}function Rt(t){for(var n=[],e=0;e<t.length;e++){var r=t[e];if(!Nt(r))return Bt(t);if(Ut(r))n.push([r[0],m(r[1])]);else{var i=r.slice(0,r.length-1),o=m(r[r.length-1]);n.push([i,o])}}return n}function Wt(t){return!t.sync||t.ended}function Ft(t,n,e){return Lt([new Mt(n.toProperty(),!1),new Mt(t,!0),f(e)]).withDesc(new R(t,"withLatestFrom",[n,e]))}function Vt(t,n,e){return jt([new Mt(n.toProperty(),!1),new Mt(t,!0),f(e)]).withDesc(new R(t,"withLatestFrom",[n,e]))}function Kt(t,n,e){if(t instanceof Wn)return Vt(t,n,e);if(t instanceof Kn)return Ft(t,n,e);throw new Error("Unknown observable: "+t)}function Ht(t,n){return n instanceof Wn?Kt(t,n,(function(t,n){return n})):t.transform(Yt(n),new R(t,"map",[n]))}function Yt(t){var n=g.toFunction(t);return function(t,e){return e(t.fmap(n))}}function Qt(t){return new Wn(new R("Bacon","constant",[t]),(function(n){return n(ot(t)),n(st()),r}))}function Jt(t){return t=Array.prototype.slice.call(t),g.flatMap(Gt,t)}function Gt(t){return o(t)?[t]:i(t)?Jt(t):[Qt(t)]}function Xt(t){return g.isFunction(t[0])?[Jt(Array.prototype.slice.call(t,1)),t[0]]:[Jt(Array.prototype.slice.call(t,0,t.length-1)),g.last(t)]}function $t(t,n){return qt((function(t,e){return new Kn(t,e,void 0,n)}),[g.map((function(t){return new At(t)}),t),function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t}]).withDesc(new R("Bacon","groupSimultaneous",t))}function Zt(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if((t=Jt(t)).length){for(var e=[],r=0;r<t.length;r++){var i=o(t[r])?t[r]:Qt(t[r]);e.push(nn(i))}return jt([e,function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t}]).withDesc(new R("Bacon","combineAsArray",t))}return Qt([])}function tn(t,n,e){return jt([[nn(t),nn(n)],e]).withDesc(new R(t,"combine",[n,e]))}function nn(t){return new Mt(t,!0)}function en(t,n){return Pt(It(n),t,{desc:new R(t,"flatMapConcat",[n]),limit:1})}function rn(t,n){void 0===n&&(n=g.id);var e=new R("Bacon","fromBinder",[t,n]);return new Kn(e,(function(e){var r=!1,o=!1,u=function(){if(!r)return null!=s?(s(),r=!0):o=!0},s=t((function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var o=n.apply(void 0,t),s=i(o)&&ct(g.last(o))?o:[o],a=b,c=0;c<s.length;c++){var f=at(s[c]);if((a=e(f))===S||f.isEnd)return u(),a}return a}));return o&&u(),u}))}function on(t,n){var e=new R("Bacon","fromPoll",[t,n]);return rn((function(n){var e=O.scheduler.setInterval(n,t);return function(){return O.scheduler.clearInterval(e)}}),n).withDesc(e)}function un(t,n){return on(t,(function(){return ut(n)})).withDesc(new R("Bacon","interval",[t,n]))}function sn(t,n,e){return t instanceof Kn?function(t,n,e){return an(t.toProperty(),n,e).withDesc(new R(t,"sampledBy",[n]))}(t,n,e):an(t,n,e)}function an(t,n,e){return Kt(n,t,f(function(t){return"function"==typeof t?t:g.id}(e))).withDesc(new R(t,"sampledBy",[n]))}function cn(t,n){return an(t,un(n,{}),(function(t,n){return t})).withDesc(new R(t,"sample",[n]))}function fn(t,n,e){return new Wn(new R(t,"transform",[n]),(function(e){return t.subscribeInternal((function(t){return n(t,e)}))})).withDesc(e)}function hn(t,n,e){return new Kn(new R(t,"transform",[n]),(function(e){return t.subscribeInternal((function(t){return n(t,e)}))}),void 0,Vn).withDesc(e)}function pn(t,n){var e,r=function(t){return n(t,e)};return function(n,i){return e=i,t(n,r)}}function ln(t,n,e,r){return n instanceof Wn?Kt(t,n,(function(t,n){return[t,n]})).transform(pn(e((function(t){return t[1]})),Yt((function(t){return t[0]}))),r):t.transform(e(function(t){if("boolean"==typeof t)return g.always(t);if("function"!=typeof t)throw new Error("Not a function: "+t);return t}(n)),r)}function vn(t){return function(n,e){return n.filter(t)?e(n):b}}function dn(t){return t.map((function(t){return!t})).withDesc(new R(t,"not",[]))}function yn(t){return Fn(t)?t:Qt(t)}function _n(t,n){return Pt(It(n),t,{firstOnly:!0,desc:new R(t,"flatMapFirst",[n])})}function mn(t,n,e){return new Kn(new R(t,"concat",[n]),(function(e){var i=r,o=t.dispatcher.subscribe((function(t){return t.isEnd?(i=n.toEventStream().dispatcher.subscribe(e),b):e(t)}));return function(){return o(),i()}}),void 0,e)}function gn(t,n,e){return t.scan(n,e).last().withDesc(new R(t,"fold",[n,e]))}var wn={};function bn(t,n){return Pt(It(n),t,{desc:new R(t,"flatMap",[n])})}function Sn(t,n){return Pt((function(t){if(t instanceof it){var e=t.error;return n(e)}return t}),t,{mapError:!0,desc:new R(t,"flatMapError",[n])})}var En=[],Pn=!1;function In(t){if(En.length&&!Pn)try{Pn=!0,En.forEach((function(n){n(t)}))}finally{Pn=!1}}function On(t,n){var e=g.toFunction(n),r=Fn(t)?t.toEventStream(Vn):t,i=bn(r,(function(t){return Ot(e(t)).takeUntil(r)}));return Fn(t)&&(i=i.toProperty()),i.withDesc(new R(t,"flatMapLatest",[e]))}var Dn=function(){function t(t,n,e){this.pushing=!1,this.ended=!1,this.prevError=void 0,this.unsubSrc=void 0,this._subscribe=n,this._handleEvent=e,this.subscribe=g.bind(this.subscribe,this),this.handleEvent=g.bind(this.handleEvent,this),this.subscriptions=[],this.observable=t,this.queue=[]}return t.prototype.hasSubscribers=function(){return this.subscriptions.length>0},t.prototype.removeSub=function(t){return this.subscriptions=g.without(t,this.subscriptions),this.subscriptions},t.prototype.push=function(t){return t.isEnd&&(this.ended=!0),U.inTransaction(t,this,this.pushIt,[t])},t.prototype.pushToSubscriptions=function(t){try{for(var n=this.subscriptions,e=n.length,r=0;r<e;r++){var i=n[r];(i.sink(t)===S||t.isEnd)&&this.removeSub(i)}return!0}catch(t){throw this.pushing=!1,this.queue=[],t}},t.prototype.pushIt=function(t){if(this.pushing)return this.queue.push(t),b;if(t!==this.prevError){for(t.isError&&(this.prevError=t),this.pushing=!0,this.pushToSubscriptions(t),this.pushing=!1;;){var n=this.queue.shift();if(!n)break;this.push(n)}return this.hasSubscribers()?b:(this.unsubscribeFromSource(),S)}},t.prototype.handleEvent=function(t){return this._handleEvent?this._handleEvent(t):this.push(t)},t.prototype.unsubscribeFromSource=function(){this.unsubSrc&&this.unsubSrc(),this.unsubSrc=void 0},t.prototype.subscribe=function(t){var n=this;if(this.ended)return t(st()),r;P(t);var e={sink:t};return this.subscriptions.push(e),1===this.subscriptions.length&&(this.unsubSrc=this._subscribe(this.handleEvent),P(this.unsubSrc)),function(){if(n.removeSub(e),!n.hasSubscribers())return n.unsubscribeFromSource()}},t.prototype.inspect=function(){return this.observable.toString()},t}(),xn=function(t){function n(n,e,r){var i=t.call(this,n,e,r)||this;return i.current=J(),i.propertyEnded=!1,i.subscribe=g.bind(i.subscribe,i),i}return e(n,t),n.prototype.push=function(n){return n.isEnd&&(this.propertyEnded=!0),n instanceof Z?(this.current=new Y(n),this.currentValueRootId=U.currentEventId()):n.hasValue&&console.error("Unknown event, two Bacons loaded?",n.constructor),t.prototype.push.call(this,n)},n.prototype.maybeSubSource=function(n,e){return e===S?r:this.propertyEnded?(n(st()),r):t.prototype.subscribe.call(this,n)},n.prototype.subscribe=function(t){var n=this,e=b;if(this.current.isDefined&&(this.hasSubscribers()||this.propertyEnded)){var r=U.currentEventId(),i=this.currentValueRootId;return!this.propertyEnded&&i&&r&&r!==i?(U.whenDoneWith(this.observable,(function(){if(n.currentValueRootId===i)return t(ot(n.current.get().value))})),this.maybeSubSource(t,e)):(U.inTransaction(void 0,this,(function(){return e=t(ot(n.current.get().value))}),[]),this.maybeSubSource(t,e))}return this.maybeSubSource(t,e)},n.prototype.inspect=function(){return this.observable+" current= "+this.current},n}(Dn);function Mn(t,n,e){return Pt(It(e),t,{desc:new R(t,"flatMapWithConcurrencyLimit",[n,e]),limit:n})}function zn(t,n,e){var i=function(t){if(void 0!==t){if("number"==typeof t){var n=t;return function(t){return O.scheduler.setTimeout(t,n)}}return t}}(n);function o(t){return t.values.length===e?t.flush():void 0!==i?t.schedule(i):void 0}var u=new R(t,"bufferWithTimeOrCount",[n,e]);return function(t,n,e){void 0===n&&(n=r),void 0===e&&(e=r);var i=b,o=new An(e,n);return t.transform((function(t,e){return o.push=e,pt(t)?(o.values.push(t.value),n(o)):ht(t)?i=e(t):lt(t)&&(o.end=t,o.scheduled||o.flush()),i})).withDesc(new R(t,"buffer",[]))}(t,o,o).withDesc(u)}var An=function(){function t(t,n){this.push=function(t){return b},this.scheduled=null,this.end=void 0,this.values=[],this.onFlush=t,this.onInput=n}return t.prototype.flush=function(){if(this.scheduled&&(O.scheduler.clearTimeout(this.scheduled),this.scheduled=null),this.values.length>0){var t=this.values;this.values=[];var n=this.push(ut(t));if(null!=this.end)return this.push(this.end);if(n!==S)return this.onFlush(this)}else if(null!=this.end)return this.push(this.end)},t.prototype.schedule=function(t){var n=this;if(!this.scheduled)return this.scheduled=t((function(){return n.flush()}))},t}();function kn(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=Jt(t);return e.length?new Kn(new R("Bacon","mergeAll",e),(function(t){var n=0,r=d((function(r){return function(i){return r.subscribeInternal((function(r){if(r.isEnd)return++n===e.length?t(st()):b;r=r.toNext();var o=t(r);return o===S&&i(),o}))}}),e);return new wt(r).unsubscribe})):Ct()}function Tn(t,n){return rn((function(e){var r=O.scheduler.setTimeout((function(){return e([at(n),st()])}),t);return function(){return O.scheduler.clearTimeout(r)}})).withDesc(new R("Bacon","later",[t,n]))}function Cn(t){return function(n,e){return n.filter(t)?e(n):(e(st()),S)}}function Ln(t){var n=!1;return function(e,r){return!n&&pt(e)&&t(e.value)?b:(e.hasValue&&(n=!0),r(e))}}function jn(t,n,e){void 0===e&&(e=g.id);var r={};return t.transform(pn(vn((function(t){return!r[n(t)]})),Yt((function(i){var o=n(i),u=t.changes().filter((function(t){return n(t)===o})),s=Et(i).concat(u),a=e(s,i).toEventStream().transform((function(t,n){var e=n(t);return t.isEnd&&delete r[o],e}));return r[o]=a,a}))))}var qn={};function Bn(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];var r=Xt(arguments);return n=r[0],t=r[1],Lt([n=g.map((function(t){return t.toEventStream()}),n),t]).withDesc(new R("Bacon","zipWith",[t].concat(n)))}function Nn(t){function n(t,n,e){return(function(t){return t[t.length-1]}(t))[n]=e,e}function e(t){return i(t)?[]:{}}function r(t){if(o(t))return!0;if(t&&(t.constructor==Object||t.constructor==Array))for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&r(t[n]))return!0}function u(t,i){o(i)?(c.push(i),a.push(function(t,e){return function(r,i){n(r,t,i[e])}}(t,c.length-1))):r(i)?(a.push(function(t,r){return function(i){var o=e(r);n(i,t,o),i.push(o)}}(t,i)),s(i),a.push((function(t){t.pop()}))):a.push(function(t,e){return function(r){n(r,t,e)}}(t,i))}function s(t){g.each(t,u)}var a=[],c=[];return(r(t)?(s(t),Zt(c).map((function(n){for(var r=e(t),i=[r],o=0;o<a.length;o++)(0,a[o])(i,n);return r}))):Qt(t)).withDesc(new R("Bacon","combineTemplate",[t]))}var Un=0,Rn=function(){function t(t){this.id=++Un,this._isObservable=!0,this.desc=t,this.initialDesc=t}return t.prototype.awaiting=function(t){return function(t,n){return $t([t,n],Vn).map((function(t){return 0===t[1].length})).toProperty(!1).skipDuplicates().withDesc(new R(t,"awaiting",[n]))}(this,t)},t.prototype.bufferingThrottle=function(t){return function(t,n){var e=new R(t,"bufferingThrottle",[n]);return t.transformChanges(e,(function(t){return t.flatMapConcat((function(t){return Et(t).concat(Tn(n,t).errors())}))}))}(this,t)},t.prototype.combine=function(t,n){return tn(this,t,n)},t.prototype.debounce=function(t){return function(t,n){return t.transformChanges(new R(t,"debounce",[n]),(function(t){return t.flatMapLatest((function(t){return Tn(n,t)}))}))}(this,t)},t.prototype.debounceImmediate=function(t){return function(t,n){return t.transformChanges(new R(t,"debounceImmediate",[n]),(function(t){return t.flatMapFirst((function(t){return Et(t).concat(Tn(n,t).errors())}))}))}(this,t)},t.prototype.decode=function(t){return function(t,n){return t.combine(Nn(n),(function(t,n){return n[t]})).withDesc(new R(t,"decode",[n]))}(this,t)},t.prototype.delay=function(t){return function(t,n){return t.transformChanges(new R(t,"delay",[n]),(function(t){return t.flatMap((function(t){return Tn(n,t)}))}))}(this,t)},t.prototype.deps=function(){return this.desc.deps()},t.prototype.diff=function(t,n){return function(t,n,e){return fn(gt(t,[n,qn],(function(t,n){return[n,e(t[0],n)]})),pn(vn((function(t){return t[1]!==qn})),Yt((function(t){return t[1]}))),new R(t,"diff",[n,e]))}(this,t,n)},t.prototype.doAction=function(t){return this.transform(function(t){return function(n,e){return pt(n)&&t(n.value),e(n)}}(t),new R(this,"doAction",[t]))},t.prototype.doEnd=function(t){return this.transform(function(t){return function(n,e){return lt(n)&&t(),e(n)}}(t),new R(this,"doEnd",[t]))},t.prototype.doError=function(t){return this.transform(function(t){return function(n,e){return ht(n)&&t(n.error),e(n)}}(t),new R(this,"doError",[t]))},t.prototype.doLog=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this.transform(mt(t),new R(this,"doLog",t))},t.prototype.endAsValue=function(){return this.transform((function(t,n){return lt(t)?(n(ut({})),n(st()),S):b}))},t.prototype.endOnError=function(t){return void 0===t&&(t=function(t){return!0}),function(t,n){return void 0===n&&(n=function(t){return!0}),t.transform((function(t,e){return ht(t)&&n(t.error)?(e(t),e(st())):e(t)}),new R(t,"endOnError",[]))}(this,t)},t.prototype.errors=function(){return this.filter((function(t){return!1})).withDesc(new R(this,"errors"))},t.prototype.filter=function(t){return function(t,n){return ln(t,n,vn,new R(t,"filter",[n]))}(this,t)},t.prototype.first=function(){return dt(1,this,new R(this,"first"))},t.prototype.firstToPromise=function(t){return function(t,n){if("function"!=typeof n){if("function"!=typeof Promise)throw new Error("There isn't default Promise, use shim or parameter");n=function(t){return new Promise(t)}}return new n((function(n,e){return t.subscribe((function(t){return pt(t)&&n(t.value),ht(t)&&e(t.error),S}))}))}(this,t)},t.prototype.fold=function(t,n){return gn(this,t,n)},t.prototype.forEach=function(t){return void 0===t&&(t=V),this.onValue(t)},t.prototype.holdWhen=function(t){return function(t,n){var e=!1,r=[],i=!1;return new Kn(new R(t,"holdWhen",[n]),(function(o){var u=new wt,s=!1,a=function(t){return t&&t(),u.empty()&&s?o(st()):b};return u.add((function(t,u){return n.subscribeInternal((function(t){if(pt(t)){e=t.value;var n=b;if(!e){var s=r;r=[];for(var c=0;c<s.length;c++)n=o(ut(s[c]));i&&(o(st()),u(),n=S)}return n}return t.isEnd?a(u):o(t)}))})),u.add((function(n,u){return t.subscribeInternal((function(t){return e&&pt(t)?(r.push(t.value),b):t.isEnd&&r.length?(i=!0,a(u)):o(t)}))})),s=!0,a(),u.unsubscribe}))}(this,t)},t.prototype.inspect=function(){return this.toString()},t.prototype.internalDeps=function(){return this.initialDesc.deps()},t.prototype.last=function(){return(t=this).transform((function(t,e){return lt(t)?(n&&e(n),e(st()),S):pt(t)?(n=t,b):e(t)})).withDesc(new R(t,"last",[]));var t,n},t.prototype.log=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return _t(t,this),this},t.prototype.mapEnd=function(t){return this.transform(function(t){var n=g.toFunction(t);return function(t,e){return lt(t)?(e(ut(n(t))),e(st()),S):e(t)}}(t),new R(this,"mapEnd",[t]))},t.prototype.mapError=function(t){return this.transform(function(t){var n=g.toFunction(t);return function(t,e){return ht(t)?e(ut(n(t.error))):e(t)}}(t),new R(this,"mapError",[t]))},t.prototype.name=function(t){return this._name=t,this},t.prototype.onEnd=function(t){return void 0===t&&(t=K),this.subscribe((function(n){return n.isEnd?t():b}))},t.prototype.onError=function(t){return void 0===t&&(t=V),this.subscribe((function(n){return ht(n)?t(n.error):b}))},t.prototype.onValue=function(t){return void 0===t&&(t=V),this.subscribe((function(n){return pt(n)?t(n.value):b}))},t.prototype.onValues=function(t){return this.onValue((function(n){return t.apply(void 0,n)}))},t.prototype.reduce=function(t,n){return gn(this,t,n)},t.prototype.sampledBy=function(t){return sn(this,t,arguments[1])},t.prototype.scan=function(t,n){return gt(this,t,n)},t.prototype.skip=function(t){return function(t,n){return t.transform((function(t,e){return t.hasValue&&n>0?(n--,b):e(t)}),new R(t,"skip",[n]))}(this,t)},t.prototype.skipDuplicates=function(t){return function(t,n){void 0===n&&(n=vt);var e=new R(t,"skipDuplicates",[]);return H(J(),(function(t,e){return pt(e)?e.isInitial||null!=(r=t)&&r._isNone||!n(t.get(),e.value)?[new Y(e.value),[e]]:[t,[]]:[t,[e]];var r}),t).withDesc(e)}(this,t)},t.prototype.skipErrors=function(){return(t=this).transform((function(t,n){return ht(t)?b:n(t)}),new R(t,"skipErrors",[]));var t},t.prototype.skipUntil=function(t){return function(t,n){var e=n.transform(pn(yt(1),Yt(!0))).toProperty().startWith(!1);return t.filter(e).withDesc(new R(t,"skipUntil",[n]))}(this,t)},t.prototype.skipWhile=function(t){return function(t,n){return ln(t,n,Ln,new R(t,"skipWhile",[n]))}(this,t)},t.prototype.slidingWindow=function(t,n){return void 0===n&&(n=0),function(t,n,e){return void 0===e&&(e=0),t.scan([],(function(t,e){return t.concat([e]).slice(-n)})).filter((function(t){return t.length>=e})).withDesc(new R(t,"slidingWindow",[n,e]))}(this,t,n)},t.prototype.subscribe=function(t){var n=this;return void 0===t&&(t=V),U.wrappedSubscribe(this,(function(t){return n.subscribeInternal(t)}),t)},t.prototype.take=function(t){return dt(t,this)},t.prototype.takeUntil=function(t){return function(t,n){var e=$t([t.mapEnd(wn),n.skipErrors()],Vn);return t instanceof Wn&&(e=e.toProperty()),e.transform((function(t,n){if(pt(t)){var e=t.value,r=e[0];if(e[1].length)return n(st());for(var i=b,o=0;o<r.length;o++){var u=r[o];if(u===wn)return n(st());i=n(ut(u))}return i}return n(t)}),new R(t,"takeUntil",[n]))}(this,t)},t.prototype.takeWhile=function(t){return function(t,n){return ln(t,n,Cn,new R(t,"takeWhile",[n]))}(this,t)},t.prototype.throttle=function(t){return function(t,n){return t.transformChanges(new R(t,"throttle",[n]),(function(t){return t.bufferWithTime(n).map((function(t){return t[t.length-1]}))}))}(this,t)},t.prototype.toPromise=function(t){return function(t,n){return t.last().firstToPromise(n)}(this,t)},t.prototype.toString=function(){return this._name?this._name:this.desc.toString()},t.prototype.withDesc=function(t){return t&&(this.desc=t),this},t.prototype.withDescription=function(t,n){for(var e=[],r=2;r<arguments.length;r++)e[r-2]=arguments[r];return this.desc=W.apply(void 0,[t,n].concat(e)),this},t.prototype.zip=function(t,n){return function(t,n,e){return Bn(e||Array,t,n).withDesc(new R(t,"zip",[n]))}(this,t,n)},t}(),Wn=function(t){function n(n,e,r){var i=t.call(this,n)||this;return i._isProperty=!0,P(e),i.dispatcher=new xn(i,e,r),In(i),i}return e(n,t),n.prototype.and=function(t){return e=t,(n=this).combine(yn(e),(function(t,n){return!(!t||!n)})).withDesc(new R(n,"and",[e]));var n,e},n.prototype.changes=function(){var t=this;return new Kn(new R(this,"changes",[]),(function(n){return t.dispatcher.subscribe((function(t){return t.isInitial?b:n(t)}))}))},n.prototype.concat=function(t){return this.transformChanges(W(this,"concat",t),(function(n){return n.concat(t)}))},n.prototype.transformChanges=function(t,n){return function(t,n,e){var r,i,o=n(new Kn(W(t,"changes",[]),(function(n){return t.dispatcher.subscribe((function(t){return!r&&ft(t)&&(r=t,U.whenDoneWith(u,(function(){if(!i)throw new Error("Init sequence fail");i(r)}))),t.isInitial?b:n(t)}))}),void 0,Vn)),u=St(e,(function(t){return i=t,o.dispatcher.subscribe((function(n){t(n)}))}));return u}(this,n,t)},n.prototype.flatMap=function(t){return bn(this,t)},n.prototype.flatMapConcat=function(t){return en(this,t)},n.prototype.flatMapError=function(t){return Sn(this,t)},n.prototype.flatMapEvent=function(t){return Dt(this,t)},n.prototype.flatMapFirst=function(t){return _n(this,t)},n.prototype.flatMapLatest=function(t){return On(this,t)},n.prototype.flatMapWithConcurrencyLimit=function(t,n){return Mn(this,t,n)},n.prototype.groupBy=function(t,n){return jn(this,t,n)},n.prototype.map=function(t){return Ht(this,t)},n.prototype.not=function(){return dn(this)},n.prototype.or=function(t){return e=t,(n=this).combine(yn(e),(function(t,n){return t||n})).withDesc(new R(n,"or",[e]));var n,e},n.prototype.sample=function(t){return cn(this,t)},n.prototype.startWith=function(t){return function(t,n){return t.scan(n,(function(t,n){return n})).withDesc(new R(t,"startWith",[n]))}(this,t)},n.prototype.subscribeInternal=function(t){return void 0===t&&(t=V),this.dispatcher.subscribe(t)},n.prototype.toEventStream=function(t){var n=this;return new Kn(new R(this,"toEventStream",[]),(function(t){return n.subscribeInternal((function(n){return t(n.toNext())}))}),void 0,t)},n.prototype.toProperty=function(){return I(arguments),this},n.prototype.transform=function(t,n){return fn(this,t,n)},n.prototype.withLatestFrom=function(t,n){return Vt(this,t,n)},n.prototype.withStateMachine=function(t,n){return H(t,n,this)},n}(Rn);function Fn(t){return!!t._isProperty}var Vn={forceAsync:!1},Kn=function(t){function n(n,e,r,i){var o=t.call(this,n)||this;return o._isEventStream=!0,i!==Vn&&(e=function(t,n){var e=!1;return function(r){var i,o=U.isInTransaction();function u(){var t=i||[];i=void 0;for(var n=0;n<t.length;n++){var e=t[n];r(e)}}e=!0;try{return n((function(n){return e||i?(i?i.push(n):(i=[n],o?U.soonButNotYet(t,u):O.scheduler.setTimeout(u,0)),b):r(n)}))}finally{e=!1}}}(o,e)),o.dispatcher=new Dn(o,e,r),In(o),o}return e(n,t),n.prototype.bufferWithTime=function(t){return function(t,n){return zn(t,n,Number.MAX_VALUE).withDesc(new R(t,"bufferWithTime",[n]))}(this,t)},n.prototype.bufferWithCount=function(t){return function(t,n){return zn(t,void 0,n).withDesc(new R(t,"bufferWithCount",[n]))}(this,t)},n.prototype.bufferWithTimeOrCount=function(t,n){return zn(this,t,n)},n.prototype.changes=function(){return this},n.prototype.concat=function(t,n){return mn(this,t,n)},n.prototype.transformChanges=function(t,n){return n(this).withDesc(t)},n.prototype.flatMap=function(t){return bn(this,t)},n.prototype.flatMapConcat=function(t){return en(this,t)},n.prototype.flatMapError=function(t){return Sn(this,t)},n.prototype.flatMapFirst=function(t){return _n(this,t)},n.prototype.flatMapLatest=function(t){return On(this,t)},n.prototype.flatMapWithConcurrencyLimit=function(t,n){return Mn(this,t,n)},n.prototype.flatMapEvent=function(t){return Dt(this,t)},n.prototype.flatScan=function(t,n){return function(t,n,e){var r=n;return t.flatMapConcat((function(t){return Ot(e(r,t)).doAction((function(t){return r=t}))})).toProperty().startWith(n).withDesc(new R(t,"flatScan",[n,e]))}(this,t,n)},n.prototype.groupBy=function(t,n){return jn(this,t,n)},n.prototype.map=function(t){return Ht(this,t)},n.prototype.merge=function(t){return function(t){if(!(null!=t?t._isEventStream:void 0))throw new Error("not an EventStream : "+t)}(t),kn(this,t).withDesc(new R(this,"merge",[t]))},n.prototype.not=function(){return dn(this)},n.prototype.startWith=function(t){return function(t,n){return Et(n).concat(t).withDesc(new R(t,"startWith",[n]))}(this,t)},n.prototype.subscribeInternal=function(t){return void 0===t&&(t=V),this.dispatcher.subscribe(t)},n.prototype.toEventStream=function(){return this},n.prototype.toProperty=function(t){var n=arguments.length?G(t):J(),e=this.dispatcher,r=new R(this,"toProperty",Array.prototype.slice.apply(arguments)),i=e.subscribe;return new Wn(r,bt(n,i))},n.prototype.transform=function(t,n){return hn(this,t,n)},n.prototype.withLatestFrom=function(t,n){return Ft(this,t,n)},n.prototype.withStateMachine=function(t,n){return H(t,n,this)},n}(Rn);function Hn(t,n){return new Kn(t,n)}function Yn(t,n){return new Kn(t,n,void 0,Vn)}function Qn(t){return"undefined"!=typeof Symbol&&Symbol[t]?Symbol[t]:"undefined"!=typeof Symbol&&"function"==typeof Symbol.for?Symbol[t]=Symbol.for(t):"@@"+t}var Jn=function(){function t(t){this.observable=t}return t.prototype.subscribe=function(t,n,e){var r="function"==typeof t?{next:t,error:n,complete:e}:t,i={closed:!1,unsubscribe:function(){i.closed=!0,o()}},o=this.observable.subscribe((function(t){pt(t)&&r.next?r.next(t.value):ht(t)?(r.error&&r.error(t.error),i.unsubscribe()):t.isEnd&&(i.closed=!0,r.complete&&r.complete())}));return i},t}();function Gn(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return function(e){return t.apply(void 0,[e].concat(n))}}}Jn.prototype[Qn("observable")]=function(){return this},Rn.prototype.toESObservable=function(){return new Jn(this)},Rn.prototype[Qn("observable")]=Rn.prototype.toESObservable;var Xn=[["addEventListener","removeEventListener"],["addListener","removeListener"],["on","off"],["bind","unbind"]];function $n(t,n,e){var r=function(t){for(var n,e=0;e<Xn.length;e++){var r=[t[(n=Xn[e])[0]],t[n[1]]];if(r[0]&&r[1])return r}for(var i=0;i<Xn.length;i++){var o=t[(n=Xn[i])[0]];if(o)return[o,function(){}]}throw new Error("No suitable event methods in "+t)}(t),i=r[0],o=r[1],u=new R("Bacon","fromEvent",[t,n]);return rn((function(e){return r=n,g.isFunction(r)?(n(i.bind(t),e),function(){return n(o.bind(t),e)}):(i.call(t,n,e),function(){return o.call(t,n,e)});var r}),e).withDesc(u)}function Zn(t){var n=0;return rn((function(e){var r=!1,i=b,o=function(){};function u(t){return t.isEnd?(r?s():r=!0,b):i=e(t)}function s(){var s;for(r=!0;r&&i!==S;)s=t(n++),r=!1,s?o=s.subscribeInternal(u):e(st());r=!0}return s(),function(){return o()}})).withDesc(new R("Bacon","repeat",[t]))}function te(t){return Tn(t,"").filter(!1).withDesc(new R("Bacon","silence",[t]))}function ne(t){return[at(t),st()]}function ee(t,n){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.apply(void 0,n.concat(e))}}var re,ie=(re=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return g.isFunction(t)?n.length?ee(t,n):t:g.always(t)},function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];if("object"==typeof t&&n.length){var r=t,i=n[0];t=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return r[i].apply(r,t)},n=n.slice(1)}return re.apply(void 0,[t].concat(n))});function oe(t,n){return ie.apply(void 0,[t].concat(n))}var ue=function(t){function n(){var n=t.call(this,new R("Bacon","Bus",[]),(function(t){return n.subscribeAll(t)}))||this;return n.pushing=!1,n.pushQueue=void 0,n.ended=!1,n.subscriptions=[],n.unsubAll=g.bind(n.unsubAll,n),n.subscriptions=[],n.ended=!1,n}return e(n,t),n.prototype.plug=function(t){var n=this;if(function(t){if(!(null!=t?t._isObservable:void 0))throw new Error("not an Observable : "+t)}(t),!this.ended){var e={input:t,unsub:void 0};return this.subscriptions.push(e),void 0!==this.sink&&this.subscribeInput(e),function(){return n.unsubscribeInput(t)}}},n.prototype.end=function(){if(this.ended=!0,this.unsubAll(),"function"==typeof this.sink)return this.sink(st())},n.prototype.push=function(t){if(!this.ended&&"function"==typeof this.sink){var n=!this.pushing;if(!n)return this.pushQueue||(this.pushQueue=[]),void this.pushQueue.push(t);this.pushing=!0;try{return this.sink(ut(t))}finally{if(n&&this.pushQueue){for(var e=0;e<this.pushQueue.length;){var r=this.pushQueue[e];this.sink(ut(r)),e++}this.pushQueue=void 0}this.pushing=!1}}},n.prototype.error=function(t){if("function"==typeof this.sink)return this.sink(new it(t))},n.prototype.unsubAll=function(){for(var t,n=this.subscriptions,e=0;e<n.length;e++)"function"==typeof(t=n[e]).unsub&&t.unsub()},n.prototype.subscribeAll=function(t){if(this.ended)t(st());else{this.sink=t;for(var n,e=this.subscriptions.slice(),r=0;r<e.length;r++)n=e[r],this.subscribeInput(n)}return this.unsubAll},n.prototype.guardedSink=function(t){var n=this;return function(e){return e.isEnd?(n.unsubscribeInput(t),S):n.sink?n.sink(e):b}},n.prototype.subscribeInput=function(t){return t.unsub=t.input.subscribeInternal(this.guardedSink(t.input)),t.unsub},n.prototype.unsubscribeInput=function(t){for(var n,e=this.subscriptions,r=0;r<e.length;r++)if((n=e[r]).input===t)return"function"==typeof n.unsub&&n.unsub(),void this.subscriptions.splice(r,1)},n}(Kn),se={asEventStream:function(t,n,e){var r=this;return g.isFunction(n)&&(e=n,n=void 0),rn((function(e){return r.on(t,n,e),function(){return r.off(t,n,e)}}),e).withDesc(new R(this.selector||this,"asEventStream",[t]))},init:function(t){t.fn.asEventStream=se.asEventStream}};t.$=se,t.Bus=ue,t.CompositeUnsubscribe=wt,t.Desc=R,t.End=rt,t.Error=it,t.Event=$,t.EventStream=Kn,t.Initial=nt,t.Next=tt,t.Observable=Rn,t.Property=Wn,t.Value=Z,t._=g,t.combine=tn,t.combineAsArray=Zt,t.combineTemplate=Nn,t.combineWith=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];var r=Xt(arguments),i=(n=r[0],t=r[1],new R("Bacon","combineWith",[t].concat(n)));return Zt(n).map((function(n){return t.apply(void 0,n)})).withDesc(i)},t.concatAll=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=Jt(t);return(e.length?h(y(e),p(e).toEventStream(),(function(t,n){return t.concat(n)})):Ct()).withDesc(new R("Bacon","concatAll",e))},t.constant=Qt,t.fromArray=function(t){if(function(t){if(!i(t))throw new Error("not an array : "+t)}(t),t.length){var n=0,e=new Kn(new R("Bacon","fromArray",[t]),(function(r){var i=!1,o=b,u=!1,s=!1;return U.soonButNotYet(e,(function a(){if(s=!0,!u){if(n===t.length)return r(st()),!1;for(u=!0;s;)if(s=!1,o!==S&&!i){var c=t[n++];(o=r(at(c)))!==S&&(n===t.length?r(st()):U.afterTransaction(e,a))}return u=!1}})),function(){return i=!0}}));return e}return Ct().withDesc(new R("Bacon","fromArray",t))},t.fromBinder=rn,t.fromCallback=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return rn((function(e){return oe(t,n)(e),r}),(function(t){return[t,st()]})).withDesc(new R("Bacon","fromCallback",[t].concat(n)))},t.fromESObservable=function(t){var n;n=t[Qn("observable")]?t[Qn("observable")]():t;var e=new R("Bacon","fromESObservable",[n]);return new Kn(e,(function(t){var e=n.subscribe({error:function(n){t(new it(n)),t(new rt)},next:function(n){t(new tt(n))},complete:function(){t(new rt)}});return e.unsubscribe?function(){e.unsubscribe()}:e}))},t.fromEvent=$n,t.fromEventTarget=$n,t.fromNodeCallback=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return rn((function(e){return oe(t,n)(e),r}),(function(t,n){return t?[new it(t),st()]:[n,st()]})).withDesc(new R("Bacon","fromNodeCallback",[t].concat(n)))},t.fromPoll=on,t.fromPromise=function(t,n,e){return void 0===e&&(e=ne),rn((function(e){var r=t.then(e,(function(t){return e(new it(t))}));return r&&"function"==typeof r.done&&r.done(),n?function(){if("function"==typeof t.abort)return t.abort()}:function(){}}),e).withDesc(new R("Bacon","fromPromise",[t]))},t.getScheduler=function(){return O.scheduler},t.groupSimultaneous=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return $t(Jt(t))},t.hasValue=pt,t.interval=un,t.isEnd=lt,t.isError=ht,t.isEvent=ct,t.isInitial=ft,t.isNext=function(t){return t.isNext},t.later=Tn,t.mergeAll=kn,t.more=b,t.never=Ct,t.noMore=S,t.nullSink=V,t.nullVoidSink=K,t.onValues=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Zt(t.slice(0,t.length-1)).onValues(t[arguments.length-1])},t.once=Et,t.repeat=Zn,t.repeatedly=function(t,n){var e=0;return on(t,(function(){return n[e++%n.length]})).withDesc(new R("Bacon","repeatedly",[t,n]))},t.retry=function(t){if(!g.isFunction(t.source))throw new Error("'source' option has to be a function");var n=t.source,e=t.retries||0,r=0,i=t.delay||function(){return 0},o=t.isRetryable||function(){return!0},u=!1,s=null;return Zn((function(t){function a(){return n(t).endOnError().transform((function(t,n){return ht(t)?o((s=t).error)&&(0===e||r<e)?b:(u=!0,n(t)):(pt(t)&&(s=null,u=!0),n(t))}))}if(!u){if(s){var c={error:s.error,retriesDone:r},f=te(i(c));return r++,f.concat(Et(null).flatMap(a))}return a()}})).withDesc(new R("Bacon","retry",[t]))},t.sequentially=function(t,n){var e=0;return on(t,(function(){var t=n[e++];return e<n.length?t:e===n.length?[at(t),st()]:st()})).withDesc(new R("Bacon","sequentially",[t,n]))},t.setScheduler=function(t){O.scheduler=t},t.silence=te,t.spy=function(t){return En.push(t)},t.try=function(t){return function(n){try{return Et(t(n))}catch(t){return Et(new it(t))}}},t.update=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];for(var r=Rt(n),i=0;i<r.length;i++){var o=r[i];o[1]=Gn(o[1])}return Lt.apply(void 0,r).scan(t,(function(t,n){return n(t)})).withDesc(new R("Bacon","update",[t].concat(n)))},t.version="3.0.12",t.when=Lt,t.zipAsArray=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=g.map((function(t){return t.toEventStream()}),Jt(t));return Lt([e,function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t}]).withDesc(new R("Bacon","zipAsArray",t))},t.zipWith=Bn,Object.defineProperty(t,"__esModule",{value:!0})}(n)},function(t,n,e){"use strict";e.r(n);var r=function(){function t(t,n){this.result=t,this.highlights=n[t.id]}return t.prototype.render=function(t){return t(this.result,this.highlights)},t}(),i=function(t,n,e,r){return new(e||(e=Promise))((function(i,o){function u(t){try{a(r.next(t))}catch(t){o(t)}}function s(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(u,s)}a((r=r.apply(t,n||[])).next())}))},o=function(t,n){var e,r,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;u;)try{if(e=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=u.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=n.call(t,u)}catch(t){o=[6,t],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},u=function(){function t(t,n,e){var r=this;this.data=n,this.config=e,this._filterClient=t,this._name=e.baseName,this._type=n.name.split("_").pop(),this._counts=this.data.counts.map((function(t){return t.filterQuery=r.getFilterParamName(),t}))}return Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"counts",{get:function(){return this._counts},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filterClient",{get:function(){return this._filterClient},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayName",{get:function(){return this._displayName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedValues",{get:function(){return this._selectedValues},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),t.prototype.getQueryParam=function(t){var n={};return n[this.getFilterParamName()]='"'+t+'"',n},t.prototype.getFilterParamName=function(){return"facet.filter."+this.config.baseName},t.prototype.getSelectedParameters=function(){var t,n=this;return(null===(t=this.selectedValues)||void 0===t?void 0:t.map((function(t){return n.getQueryParam(t)})))||[]},t.prototype.isValueAllowed=function(t){return this.counts.map((function(t){return t.value})).includes(t)},t.prototype.setSelectedValues=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this._selectedValues=t,this},t.prototype.setDisplayName=function(t){return this._displayName=t,this},t.prototype.reset=function(){var t=this.filterClient.parameterList.deleteAll(this.getFilterParamName());return this.filterClient.parameterList=t,this.setSelectedValues.apply(this,[]),this},t.prototype.customFilter=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return i(this,void 0,void 0,(function(){var e,r,i;return o(this,(function(o){switch(o.label){case 0:return this.filterClient.parameterList=(r=this.filterClient.parameterList).addOrUpdate.apply(r,n),[4,this.filter.apply(this,t)];case 1:return e=o.sent(),this.filterClient.parameterList=(i=this.filterClient.parameterList).delete.apply(i,n),[2,e]}}))}))},t.prototype.filter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return i(this,void 0,void 0,(function(){var n,e,r,i=this;return o(this,(function(o){if(!this.config.multiSelect&&t.length>1)throw new Error("This is not a multi value facet. You can only pass one value to filter().");return t.forEach((function(t){if(i.type!==typeof t)throw new Error("The facet "+i.config.baseName+" is of type "+i.type+", but the value that was passed ("+t+") is of type "+typeof t);if(!i.isValueAllowed(t))throw new Error("The passed value "+t+" is not allowed in this facette")})),n=t.map((function(t){return i.getQueryParam(t)})),e=(r=this.filterClient.parameterList.deleteAll(this.getFilterParamName())).add.apply(r,n),this.filterClient.parameterList=e.updateFirst({haupia_start:"0"}).updateFirst({haupia_pageNumber:"0"}),[2,this.search()]}))}))},t.prototype.search=function(){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.filterClient.fetch()];case 1:return t=e.sent(),[2,new ir(this.filterClient,t)];case 2:throw n=e.sent(),new Error(n);case 3:return[2]}}))}))},t}(),s={};function a(t){t&&(t.value=!0)}function c(){}function f(t){return void 0===t.size&&(t.size=t.__iterate(p)),t.size}function h(t,n){if("number"!=typeof n){var e=n>>>0;if(""+e!==n||4294967295===e)return NaN;n=e}return n<0?f(t)+n:n}function p(){return!0}function l(t,n,e){return(0===t&&!_(t)||void 0!==e&&t<=-e)&&(void 0===n||void 0!==e&&n>=e)}function v(t,n){return y(t,n,0)}function d(t,n){return y(t,n,n)}function y(t,n,e){return void 0===t?e:_(t)?n===1/0?n:0|Math.max(0,n+t):void 0===n||n===t?t:0|Math.min(n,t)}function _(t){return t<0||0===t&&1/t==-1/0}function m(t){return Boolean(t&&t["@@__IMMUTABLE_ITERABLE__@@"])}function g(t){return Boolean(t&&t["@@__IMMUTABLE_KEYED__@@"])}function w(t){return Boolean(t&&t["@@__IMMUTABLE_INDEXED__@@"])}function b(t){return g(t)||w(t)}var S=function(t){return m(t)?t:W(t)},E=function(t){function n(t){return g(t)?t:F(t)}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n}(S),P=function(t){function n(t){return w(t)?t:V(t)}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n}(S),I=function(t){function n(t){return m(t)&&!b(t)?t:K(t)}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n}(S);S.Keyed=E,S.Indexed=P,S.Set=I;function O(t){return Boolean(t&&t["@@__IMMUTABLE_SEQ__@@"])}function D(t){return Boolean(t&&t["@@__IMMUTABLE_RECORD__@@"])}function x(t){return m(t)||D(t)}var M="@@__IMMUTABLE_ORDERED__@@";function z(t){return Boolean(t&&t[M])}var A="function"==typeof Symbol&&Symbol.iterator,k=A||"@@iterator",T=function(t){this.next=t};function C(t,n,e,r){var i=0===t?n:1===t?e:[n,e];return r?r.value=i:r={value:i,done:!1},r}function L(){return{value:void 0,done:!0}}function j(t){return!!N(t)}function q(t){return t&&"function"==typeof t.next}function B(t){var n=N(t);return n&&n.call(t)}function N(t){var n=t&&(A&&t[A]||t["@@iterator"]);if("function"==typeof n)return n}T.prototype.toString=function(){return"[Iterator]"},T.KEYS=0,T.VALUES=1,T.ENTRIES=2,T.prototype.inspect=T.prototype.toSource=function(){return this.toString()},T.prototype[k]=function(){return this};var U=Object.prototype.hasOwnProperty;function R(t){return!(!Array.isArray(t)&&"string"!=typeof t)||t&&"object"==typeof t&&Number.isInteger(t.length)&&t.length>=0&&(0===t.length?1===Object.keys(t).length:t.hasOwnProperty(t.length-1))}var W=function(t){function n(t){return null==t?G():x(t)?t.toSeq():function(t){var n=Z(t);if(n)return n;if("object"==typeof t)return new Y(t);throw new TypeError("Expected Array or collection object of values, or keyed object: "+t)}(t)}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.toSeq=function(){return this},n.prototype.toString=function(){return this.__toString("Seq {","}")},n.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},n.prototype.__iterate=function(t,n){var e=this._cache;if(e){for(var r=e.length,i=0;i!==r;){var o=e[n?r-++i:i++];if(!1===t(o[1],o[0],this))break}return i}return this.__iterateUncached(t,n)},n.prototype.__iterator=function(t,n){var e=this._cache;if(e){var r=e.length,i=0;return new T((function(){if(i===r)return{value:void 0,done:!0};var o=e[n?r-++i:i++];return C(t,o[0],o[1])}))}return this.__iteratorUncached(t,n)},n}(S),F=function(t){function n(t){return null==t?G().toKeyedSeq():m(t)?g(t)?t.toSeq():t.fromEntrySeq():D(t)?t.toSeq():X(t)}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.toKeyedSeq=function(){return this},n}(W),V=function(t){function n(t){return null==t?G():m(t)?g(t)?t.entrySeq():t.toIndexedSeq():D(t)?t.toSeq().entrySeq():$(t)}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.of=function(){return n(arguments)},n.prototype.toIndexedSeq=function(){return this},n.prototype.toString=function(){return this.__toString("Seq [","]")},n}(W),K=function(t){function n(t){return(m(t)&&!b(t)?t:V(t)).toSetSeq()}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.of=function(){return n(arguments)},n.prototype.toSetSeq=function(){return this},n}(W);W.isSeq=O,W.Keyed=F,W.Set=K,W.Indexed=V,W.prototype["@@__IMMUTABLE_SEQ__@@"]=!0;var H=function(t){function n(t){this._array=t,this.size=t.length}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.get=function(t,n){return this.has(t)?this._array[h(this,t)]:n},n.prototype.__iterate=function(t,n){for(var e=this._array,r=e.length,i=0;i!==r;){var o=n?r-++i:i++;if(!1===t(e[o],o,this))break}return i},n.prototype.__iterator=function(t,n){var e=this._array,r=e.length,i=0;return new T((function(){if(i===r)return{value:void 0,done:!0};var o=n?r-++i:i++;return C(t,o,e[o])}))},n}(V),Y=function(t){function n(t){var n=Object.keys(t);this._object=t,this._keys=n,this.size=n.length}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.get=function(t,n){return void 0===n||this.has(t)?this._object[t]:n},n.prototype.has=function(t){return U.call(this._object,t)},n.prototype.__iterate=function(t,n){for(var e=this._object,r=this._keys,i=r.length,o=0;o!==i;){var u=r[n?i-++o:o++];if(!1===t(e[u],u,this))break}return o},n.prototype.__iterator=function(t,n){var e=this._object,r=this._keys,i=r.length,o=0;return new T((function(){if(o===i)return{value:void 0,done:!0};var u=r[n?i-++o:o++];return C(t,u,e[u])}))},n}(F);Y.prototype[M]=!0;var Q,J=function(t){function n(t){this._collection=t,this.size=t.length||t.size}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.__iterateUncached=function(t,n){if(n)return this.cacheResult().__iterate(t,n);var e=B(this._collection),r=0;if(q(e))for(var i;!(i=e.next()).done&&!1!==t(i.value,r++,this););return r},n.prototype.__iteratorUncached=function(t,n){if(n)return this.cacheResult().__iterator(t,n);var e=B(this._collection);if(!q(e))return new T(L);var r=0;return new T((function(){var n=e.next();return n.done?n:C(t,r++,n.value)}))},n}(V);function G(){return Q||(Q=new H([]))}function X(t){var n=Array.isArray(t)?new H(t):j(t)?new J(t):void 0;if(n)return n.fromEntrySeq();if("object"==typeof t)return new Y(t);throw new TypeError("Expected Array or collection object of [k, v] entries, or keyed object: "+t)}function $(t){var n=Z(t);if(n)return n;throw new TypeError("Expected Array or collection object of values: "+t)}function Z(t){return R(t)?new H(t):j(t)?new J(t):void 0}function tt(t){return Boolean(t&&t["@@__IMMUTABLE_MAP__@@"])}function nt(t){return tt(t)&&z(t)}function et(t){return Boolean(t&&"function"==typeof t.equals&&"function"==typeof t.hashCode)}function rt(t,n){if(t===n||t!=t&&n!=n)return!0;if(!t||!n)return!1;if("function"==typeof t.valueOf&&"function"==typeof n.valueOf){if((t=t.valueOf())===(n=n.valueOf())||t!=t&&n!=n)return!0;if(!t||!n)return!1}return!!(et(t)&&et(n)&&t.equals(n))}var it="function"==typeof Math.imul&&-2===Math.imul(4294967295,2)?Math.imul:function(t,n){var e=65535&(t|=0),r=65535&(n|=0);return e*r+((t>>>16)*r+e*(n>>>16)<<16>>>0)|0};function ot(t){return t>>>1&1073741824|3221225471&t}var ut=Object.prototype.valueOf;function st(t){switch(typeof t){case"boolean":return t?1108378657:1108378656;case"number":return function(t){if(t!=t||t===1/0)return 0;var n=0|t;n!==t&&(n^=4294967295*t);for(;t>4294967295;)n^=t/=4294967295;return ot(n)}(t);case"string":return t.length>dt?function(t){var n=mt[t];void 0===n&&(n=at(t),_t===yt&&(_t=0,mt={}),_t++,mt[t]=n);return n}(t):at(t);case"object":case"function":return null===t?1108378658:"function"==typeof t.hashCode?ot(t.hashCode(t)):(t.valueOf!==ut&&"function"==typeof t.valueOf&&(t=t.valueOf(t)),function(t){var n;if(pt&&void 0!==(n=ht.get(t)))return n;if(void 0!==(n=t[vt]))return n;if(!ft){if(void 0!==(n=t.propertyIsEnumerable&&t.propertyIsEnumerable[vt]))return n;if(void 0!==(n=function(t){if(t&&t.nodeType>0)switch(t.nodeType){case 1:return t.uniqueID;case 9:return t.documentElement&&t.documentElement.uniqueID}}(t)))return n}n=++lt,1073741824&lt&&(lt=0);if(pt)ht.set(t,n);else{if(void 0!==ct&&!1===ct(t))throw new Error("Non-extensible objects are not allowed as keys.");if(ft)Object.defineProperty(t,vt,{enumerable:!1,configurable:!1,writable:!1,value:n});else if(void 0!==t.propertyIsEnumerable&&t.propertyIsEnumerable===t.constructor.prototype.propertyIsEnumerable)t.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},t.propertyIsEnumerable[vt]=n;else{if(void 0===t.nodeType)throw new Error("Unable to set a non-enumerable property on object.");t[vt]=n}}return n}(t));case"undefined":return 1108378659;default:if("function"==typeof t.toString)return at(t.toString());throw new Error("Value type "+typeof t+" cannot be hashed.")}}function at(t){for(var n=0,e=0;e<t.length;e++)n=31*n+t.charCodeAt(e)|0;return ot(n)}var ct=Object.isExtensible,ft=function(){try{return Object.defineProperty({},"@",{}),!0}catch(t){return!1}}();var ht,pt="function"==typeof WeakMap;pt&&(ht=new WeakMap);var lt=0,vt="__immutablehash__";"function"==typeof Symbol&&(vt=Symbol(vt));var dt=16,yt=255,_t=0,mt={},gt=function(t){function n(t,n){this._iter=t,this._useKeys=n,this.size=t.size}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.get=function(t,n){return this._iter.get(t,n)},n.prototype.has=function(t){return this._iter.has(t)},n.prototype.valueSeq=function(){return this._iter.valueSeq()},n.prototype.reverse=function(){var t=this,n=It(this,!0);return this._useKeys||(n.valueSeq=function(){return t._iter.toSeq().reverse()}),n},n.prototype.map=function(t,n){var e=this,r=Pt(this,t,n);return this._useKeys||(r.valueSeq=function(){return e._iter.toSeq().map(t,n)}),r},n.prototype.__iterate=function(t,n){var e=this;return this._iter.__iterate((function(n,r){return t(n,r,e)}),n)},n.prototype.__iterator=function(t,n){return this._iter.__iterator(t,n)},n}(F);gt.prototype[M]=!0;var wt=function(t){function n(t){this._iter=t,this.size=t.size}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.includes=function(t){return this._iter.includes(t)},n.prototype.__iterate=function(t,n){var e=this,r=0;return n&&f(this),this._iter.__iterate((function(i){return t(i,n?e.size-++r:r++,e)}),n)},n.prototype.__iterator=function(t,n){var e=this,r=this._iter.__iterator(1,n),i=0;return n&&f(this),new T((function(){var o=r.next();return o.done?o:C(t,n?e.size-++i:i++,o.value,o)}))},n}(V),bt=function(t){function n(t){this._iter=t,this.size=t.size}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.has=function(t){return this._iter.includes(t)},n.prototype.__iterate=function(t,n){var e=this;return this._iter.__iterate((function(n){return t(n,n,e)}),n)},n.prototype.__iterator=function(t,n){var e=this._iter.__iterator(1,n);return new T((function(){var n=e.next();return n.done?n:C(t,n.value,n.value,n)}))},n}(K),St=function(t){function n(t){this._iter=t,this.size=t.size}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.entrySeq=function(){return this._iter.toSeq()},n.prototype.__iterate=function(t,n){var e=this;return this._iter.__iterate((function(n){if(n){jt(n);var r=m(n);return t(r?n.get(1):n[1],r?n.get(0):n[0],e)}}),n)},n.prototype.__iterator=function(t,n){var e=this._iter.__iterator(1,n);return new T((function(){for(;;){var n=e.next();if(n.done)return n;var r=n.value;if(r){jt(r);var i=m(r);return C(t,i?r.get(0):r[0],i?r.get(1):r[1],n)}}}))},n}(F);function Et(t){var n=Bt(t);return n._iter=t,n.size=t.size,n.flip=function(){return t},n.reverse=function(){var n=t.reverse.apply(this);return n.flip=function(){return t.reverse()},n},n.has=function(n){return t.includes(n)},n.includes=function(n){return t.has(n)},n.cacheResult=Nt,n.__iterateUncached=function(n,e){var r=this;return t.__iterate((function(t,e){return!1!==n(e,t,r)}),e)},n.__iteratorUncached=function(n,e){if(2===n){var r=t.__iterator(n,e);return new T((function(){var t=r.next();if(!t.done){var n=t.value[0];t.value[0]=t.value[1],t.value[1]=n}return t}))}return t.__iterator(1===n?0:1,e)},n}function Pt(t,n,e){var r=Bt(t);return r.size=t.size,r.has=function(n){return t.has(n)},r.get=function(r,i){var o=t.get(r,s);return o===s?i:n.call(e,o,r,t)},r.__iterateUncached=function(r,i){var o=this;return t.__iterate((function(t,i,u){return!1!==r(n.call(e,t,i,u),i,o)}),i)},r.__iteratorUncached=function(r,i){var o=t.__iterator(2,i);return new T((function(){var i=o.next();if(i.done)return i;var u=i.value,s=u[0];return C(r,s,n.call(e,u[1],s,t),i)}))},r}function It(t,n){var e=this,r=Bt(t);return r._iter=t,r.size=t.size,r.reverse=function(){return t},t.flip&&(r.flip=function(){var n=Et(t);return n.reverse=function(){return t.flip()},n}),r.get=function(e,r){return t.get(n?e:-1-e,r)},r.has=function(e){return t.has(n?e:-1-e)},r.includes=function(n){return t.includes(n)},r.cacheResult=Nt,r.__iterate=function(e,r){var i=this,o=0;return r&&f(t),t.__iterate((function(t,u){return e(t,n?u:r?i.size-++o:o++,i)}),!r)},r.__iterator=function(r,i){var o=0;i&&f(t);var u=t.__iterator(2,!i);return new T((function(){var t=u.next();if(t.done)return t;var s=t.value;return C(r,n?s[0]:i?e.size-++o:o++,s[1],t)}))},r}function Ot(t,n,e,r){var i=Bt(t);return r&&(i.has=function(r){var i=t.get(r,s);return i!==s&&!!n.call(e,i,r,t)},i.get=function(r,i){var o=t.get(r,s);return o!==s&&n.call(e,o,r,t)?o:i}),i.__iterateUncached=function(i,o){var u=this,s=0;return t.__iterate((function(t,o,a){if(n.call(e,t,o,a))return s++,i(t,r?o:s-1,u)}),o),s},i.__iteratorUncached=function(i,o){var u=t.__iterator(2,o),s=0;return new T((function(){for(;;){var o=u.next();if(o.done)return o;var a=o.value,c=a[0],f=a[1];if(n.call(e,f,c,t))return C(i,r?c:s++,f,o)}}))},i}function Dt(t,n,e,r){var i=t.size;if(l(n,e,i))return t;var o=v(n,i),u=d(e,i);if(o!=o||u!=u)return Dt(t.toSeq().cacheResult(),n,e,r);var s,a=u-o;a==a&&(s=a<0?0:a);var c=Bt(t);return c.size=0===s?s:t.size&&s||void 0,!r&&O(t)&&s>=0&&(c.get=function(n,e){return(n=h(this,n))>=0&&n<s?t.get(n+o,e):e}),c.__iterateUncached=function(n,e){var i=this;if(0===s)return 0;if(e)return this.cacheResult().__iterate(n,e);var u=0,a=!0,c=0;return t.__iterate((function(t,e){if(!a||!(a=u++<o))return c++,!1!==n(t,r?e:c-1,i)&&c!==s})),c},c.__iteratorUncached=function(n,e){if(0!==s&&e)return this.cacheResult().__iterator(n,e);if(0===s)return new T(L);var i=t.__iterator(n,e),u=0,a=0;return new T((function(){for(;u++<o;)i.next();if(++a>s)return{value:void 0,done:!0};var t=i.next();return r||1===n||t.done?t:C(n,a-1,0===n?void 0:t.value[1],t)}))},c}function xt(t,n,e,r){var i=Bt(t);return i.__iterateUncached=function(i,o){var u=this;if(o)return this.cacheResult().__iterate(i,o);var s=!0,a=0;return t.__iterate((function(t,o,c){if(!s||!(s=n.call(e,t,o,c)))return a++,i(t,r?o:a-1,u)})),a},i.__iteratorUncached=function(i,o){var u=this;if(o)return this.cacheResult().__iterator(i,o);var s=t.__iterator(2,o),a=!0,c=0;return new T((function(){var t,o,f;do{if((t=s.next()).done)return r||1===i?t:C(i,c++,0===i?void 0:t.value[1],t);var h=t.value;o=h[0],f=h[1],a&&(a=n.call(e,f,o,u))}while(a);return 2===i?t:C(i,o,f,t)}))},i}function Mt(t,n){var e=g(t),r=[t].concat(n).map((function(t){return m(t)?e&&(t=E(t)):t=e?X(t):$(Array.isArray(t)?t:[t]),t})).filter((function(t){return 0!==t.size}));if(0===r.length)return t;if(1===r.length){var i=r[0];if(i===t||e&&g(i)||w(t)&&w(i))return i}var o=new H(r);return e?o=o.toKeyedSeq():w(t)||(o=o.toSetSeq()),(o=o.flatten(!0)).size=r.reduce((function(t,n){if(void 0!==t){var e=n.size;if(void 0!==e)return t+e}}),0),o}function zt(t,n,e){var r=Bt(t);return r.__iterateUncached=function(i,o){if(o)return this.cacheResult().__iterate(i,o);var u=0,s=!1;return function t(a,c){a.__iterate((function(o,a){return(!n||c<n)&&m(o)?t(o,c+1):(u++,!1===i(o,e?a:u-1,r)&&(s=!0)),!s}),o)}(t,0),u},r.__iteratorUncached=function(r,i){if(i)return this.cacheResult().__iterator(r,i);var o=t.__iterator(r,i),u=[],s=0;return new T((function(){for(;o;){var t=o.next();if(!1===t.done){var a=t.value;if(2===r&&(a=a[1]),n&&!(u.length<n)||!m(a))return e?t:C(r,s++,a,t);u.push(o),o=a.__iterator(r,i)}else o=u.pop()}return{value:void 0,done:!0}}))},r}function At(t,n,e){n||(n=Ut);var r=g(t),i=0,o=t.toSeq().map((function(n,r){return[r,n,i++,e?e(n,r,t):n]})).valueSeq().toArray();return o.sort((function(t,e){return n(t[3],e[3])||t[2]-e[2]})).forEach(r?function(t,n){o[n].length=2}:function(t,n){o[n]=t[1]}),r?F(o):w(t)?V(o):K(o)}function kt(t,n,e){if(n||(n=Ut),e){var r=t.toSeq().map((function(n,r){return[n,e(n,r,t)]})).reduce((function(t,e){return Tt(n,t[1],e[1])?e:t}));return r&&r[0]}return t.reduce((function(t,e){return Tt(n,t,e)?e:t}))}function Tt(t,n,e){var r=t(e,n);return 0===r&&e!==n&&(null==e||e!=e)||r>0}function Ct(t,n,e,r){var i=Bt(t),o=new H(e).map((function(t){return t.size}));return i.size=r?o.max():o.min(),i.__iterate=function(t,n){for(var e,r=this.__iterator(1,n),i=0;!(e=r.next()).done&&!1!==t(e.value,i++,this););return i},i.__iteratorUncached=function(t,i){var o=e.map((function(t){return t=S(t),B(i?t.reverse():t)})),u=0,s=!1;return new T((function(){var e;return s||(e=o.map((function(t){return t.next()})),s=r?e.every((function(t){return t.done})):e.some((function(t){return t.done}))),s?{value:void 0,done:!0}:C(t,u++,n.apply(null,e.map((function(t){return t.value}))))}))},i}function Lt(t,n){return t===n?t:O(t)?n:t.constructor(n)}function jt(t){if(t!==Object(t))throw new TypeError("Expected [K, V] tuple: "+t)}function qt(t){return g(t)?E:w(t)?P:I}function Bt(t){return Object.create((g(t)?F:w(t)?V:K).prototype)}function Nt(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):W.prototype.cacheResult.call(this)}function Ut(t,n){return void 0===t&&void 0===n?0:void 0===t?1:void 0===n?-1:t>n?1:t<n?-1:0}function Rt(t,n){n=n||0;for(var e=Math.max(0,t.length-n),r=new Array(e),i=0;i<e;i++)r[i]=t[i+n];return r}function Wt(t,n){if(!t)throw new Error(n)}function Ft(t){Wt(t!==1/0,"Cannot perform this action with an infinite size.")}function Vt(t){if(R(t)&&"string"!=typeof t)return t;if(z(t))return t.toArray();throw new TypeError("Invalid keyPath: expected Ordered Collection or Array: "+t)}function Kt(t){return t&&("function"!=typeof t.constructor||"Object"===t.constructor.name)}function Ht(t){return"object"==typeof t&&(x(t)||Array.isArray(t)||Kt(t))}function Yt(t){try{return"string"==typeof t?JSON.stringify(t):String(t)}catch(n){return JSON.stringify(t)}}function Qt(t,n){return x(t)?t.has(n):Ht(t)&&U.call(t,n)}function Jt(t,n,e){return x(t)?t.get(n,e):Qt(t,n)?"function"==typeof t.get?t.get(n):t[n]:e}function Gt(t){if(Array.isArray(t))return Rt(t);var n={};for(var e in t)U.call(t,e)&&(n[e]=t[e]);return n}function Xt(t,n){if(!Ht(t))throw new TypeError("Cannot update non-data-structure value: "+t);if(x(t)){if(!t.remove)throw new TypeError("Cannot update immutable value without .remove() method: "+t);return t.remove(n)}if(!U.call(t,n))return t;var e=Gt(t);return Array.isArray(e)?e.splice(n,1):delete e[n],e}function $t(t,n,e){if(!Ht(t))throw new TypeError("Cannot update non-data-structure value: "+t);if(x(t)){if(!t.set)throw new TypeError("Cannot update immutable value without .set() method: "+t);return t.set(n,e)}if(U.call(t,n)&&e===t[n])return t;var r=Gt(t);return r[n]=e,r}function Zt(t,n,e,r){r||(r=e,e=void 0);var i=function t(n,e,r,i,o,u){var a=e===s;if(i===r.length){var c=a?o:e,f=u(c);return f===c?e:f}if(!a&&!Ht(e))throw new TypeError("Cannot update within non-data-structure value in path ["+r.slice(0,i).map(Yt)+"]: "+e);var h=r[i],p=a?s:Jt(e,h,s),l=t(p===s?n:x(p),p,r,i+1,o,u);return l===p?e:l===s?Xt(e,h):$t(a?n?Tn():{}:e,h,l)}(x(t),t,Vt(n),0,e,r);return i===s?e:i}function tn(t,n,e){return Zt(t,n,s,(function(){return e}))}function nn(t,n){return tn(this,t,n)}function en(t,n){return Zt(t,n,(function(){return s}))}function rn(t){return en(this,t)}function on(t,n,e,r){return Zt(t,[n],e,r)}function un(t,n,e){return 1===arguments.length?t(this):on(this,t,n,e)}function sn(t,n,e){return Zt(this,t,n,e)}function an(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return fn(this,t)}function cn(t){for(var n=[],e=arguments.length-1;e-- >0;)n[e]=arguments[e+1];if("function"!=typeof t)throw new TypeError("Invalid merger function: "+t);return fn(this,n,t)}function fn(t,n,e){for(var r=[],i=0;i<n.length;i++){var o=E(n[i]);0!==o.size&&r.push(o)}return 0===r.length?t:0!==t.toSeq().size||t.__ownerID||1!==r.length?t.withMutations((function(t){for(var n=e?function(n,r){on(t,r,s,(function(t){return t===s?n:e(t,n,r)}))}:function(n,e){t.set(e,n)},i=0;i<r.length;i++)r[i].forEach(n)})):t.constructor(r[0])}function hn(t,n,e){return pn(t,n,function(t){return function n(e,r,i){return Ht(e)&&Ht(r)?pn(e,[r],n):t?t(e,r,i):r}}(e))}function pn(t,n,e){if(!Ht(t))throw new TypeError("Cannot merge into non-data-structure value: "+t);if(x(t))return"function"==typeof e&&t.mergeWith?t.mergeWith.apply(t,[e].concat(n)):t.merge?t.merge.apply(t,n):t.concat.apply(t,n);for(var r=Array.isArray(t),i=t,o=r?P:E,u=r?function(n){i===t&&(i=Gt(i)),i.push(n)}:function(n,r){var o=U.call(i,r),u=o&&e?e(i[r],n,r):n;o&&u===i[r]||(i===t&&(i=Gt(i)),i[r]=u)},s=0;s<n.length;s++)o(n[s]).forEach(u);return i}function ln(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return hn(this,t)}function vn(t){for(var n=[],e=arguments.length-1;e-- >0;)n[e]=arguments[e+1];return hn(this,n,t)}function dn(t){for(var n=[],e=arguments.length-1;e-- >0;)n[e]=arguments[e+1];return Zt(this,t,Tn(),(function(t){return pn(t,n)}))}function yn(t){for(var n=[],e=arguments.length-1;e-- >0;)n[e]=arguments[e+1];return Zt(this,t,Tn(),(function(t){return hn(t,n)}))}function _n(t){var n=this.asMutable();return t(n),n.wasAltered()?n.__ensureOwner(this.__ownerID):this}function mn(){return this.__ownerID?this:this.__ensureOwner(new c)}function gn(){return this.__ensureOwner()}function wn(){return this.__altered}wt.prototype.cacheResult=gt.prototype.cacheResult=bt.prototype.cacheResult=St.prototype.cacheResult=Nt;var bn=function(t){function n(n){return null==n?Tn():tt(n)&&!z(n)?n:Tn().withMutations((function(e){var r=t(n);Ft(r.size),r.forEach((function(t,n){return e.set(n,t)}))}))}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.of=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return Tn().withMutations((function(n){for(var e=0;e<t.length;e+=2){if(e+1>=t.length)throw new Error("Missing value for key: "+t[e]);n.set(t[e],t[e+1])}}))},n.prototype.toString=function(){return this.__toString("Map {","}")},n.prototype.get=function(t,n){return this._root?this._root.get(0,void 0,t,n):n},n.prototype.set=function(t,n){return Cn(this,t,n)},n.prototype.remove=function(t){return Cn(this,t,s)},n.prototype.deleteAll=function(t){var n=S(t);return 0===n.size?this:this.withMutations((function(t){n.forEach((function(n){return t.remove(n)}))}))},n.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):Tn()},n.prototype.sort=function(t){return ie(At(this,t))},n.prototype.sortBy=function(t,n){return ie(At(this,n,t))},n.prototype.map=function(t,n){return this.withMutations((function(e){e.forEach((function(r,i){e.set(i,t.call(n,r,i,e))}))}))},n.prototype.__iterator=function(t,n){return new Mn(this,t,n)},n.prototype.__iterate=function(t,n){var e=this,r=0;return this._root&&this._root.iterate((function(n){return r++,t(n[1],n[0],e)}),n),r},n.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?kn(this.size,this._root,t,this.__hash):0===this.size?Tn():(this.__ownerID=t,this.__altered=!1,this)},n}(E);bn.isMap=tt;var Sn=bn.prototype;Sn["@@__IMMUTABLE_MAP__@@"]=!0,Sn.delete=Sn.remove,Sn.removeAll=Sn.deleteAll,Sn.setIn=nn,Sn.removeIn=Sn.deleteIn=rn,Sn.update=un,Sn.updateIn=sn,Sn.merge=Sn.concat=an,Sn.mergeWith=cn,Sn.mergeDeep=ln,Sn.mergeDeepWith=vn,Sn.mergeIn=dn,Sn.mergeDeepIn=yn,Sn.withMutations=_n,Sn.wasAltered=wn,Sn.asImmutable=gn,Sn["@@transducer/init"]=Sn.asMutable=mn,Sn["@@transducer/step"]=function(t,n){return t.set(n[0],n[1])},Sn["@@transducer/result"]=function(t){return t.asImmutable()};var En=function(t,n){this.ownerID=t,this.entries=n};En.prototype.get=function(t,n,e,r){for(var i=this.entries,o=0,u=i.length;o<u;o++)if(rt(e,i[o][0]))return i[o][1];return r},En.prototype.update=function(t,n,e,r,i,o,u){for(var f=i===s,h=this.entries,p=0,l=h.length;p<l&&!rt(r,h[p][0]);p++);var v=p<l;if(v?h[p][1]===i:f)return this;if(a(u),(f||!v)&&a(o),!f||1!==h.length){if(!v&&!f&&h.length>=Un)return function(t,n,e,r){t||(t=new c);for(var i=new Dn(t,st(e),[e,r]),o=0;o<n.length;o++){var u=n[o];i=i.update(t,0,void 0,u[0],u[1])}return i}(t,h,r,i);var d=t&&t===this.ownerID,y=d?h:Rt(h);return v?f?p===l-1?y.pop():y[p]=y.pop():y[p]=[r,i]:y.push([r,i]),d?(this.entries=y,this):new En(t,y)}};var Pn=function(t,n,e){this.ownerID=t,this.bitmap=n,this.nodes=e};Pn.prototype.get=function(t,n,e,r){void 0===n&&(n=st(e));var i=1<<(31&(0===t?n:n>>>t)),o=this.bitmap;return 0==(o&i)?r:this.nodes[Bn(o&i-1)].get(t+5,n,e,r)},Pn.prototype.update=function(t,n,e,r,i,o,u){void 0===e&&(e=st(r));var a=31&(0===n?e:e>>>n),c=1<<a,f=this.bitmap,h=0!=(f&c);if(!h&&i===s)return this;var p=Bn(f&c-1),l=this.nodes,v=h?l[p]:void 0,d=Ln(v,t,n+5,e,r,i,o,u);if(d===v)return this;if(!h&&d&&l.length>=Rn)return function(t,n,e,r,i){for(var o=0,u=new Array(32),s=0;0!==e;s++,e>>>=1)u[s]=1&e?n[o++]:void 0;return u[r]=i,new In(t,o+1,u)}(t,l,f,a,d);if(h&&!d&&2===l.length&&jn(l[1^p]))return l[1^p];if(h&&d&&1===l.length&&jn(d))return d;var y=t&&t===this.ownerID,_=h?d?f:f^c:f|c,m=h?d?Nn(l,p,d,y):function(t,n,e){var r=t.length-1;if(e&&n===r)return t.pop(),t;for(var i=new Array(r),o=0,u=0;u<r;u++)u===n&&(o=1),i[u]=t[u+o];return i}(l,p,y):function(t,n,e,r){var i=t.length+1;if(r&&n+1===i)return t[n]=e,t;for(var o=new Array(i),u=0,s=0;s<i;s++)s===n?(o[s]=e,u=-1):o[s]=t[s+u];return o}(l,p,d,y);return y?(this.bitmap=_,this.nodes=m,this):new Pn(t,_,m)};var In=function(t,n,e){this.ownerID=t,this.count=n,this.nodes=e};In.prototype.get=function(t,n,e,r){void 0===n&&(n=st(e));var i=31&(0===t?n:n>>>t),o=this.nodes[i];return o?o.get(t+5,n,e,r):r},In.prototype.update=function(t,n,e,r,i,o,u){void 0===e&&(e=st(r));var a=31&(0===n?e:e>>>n),c=i===s,f=this.nodes,h=f[a];if(c&&!h)return this;var p=Ln(h,t,n+5,e,r,i,o,u);if(p===h)return this;var l=this.count;if(h){if(!p&&--l<Wn)return function(t,n,e,r){for(var i=0,o=0,u=new Array(e),s=0,a=1,c=n.length;s<c;s++,a<<=1){var f=n[s];void 0!==f&&s!==r&&(i|=a,u[o++]=f)}return new Pn(t,i,u)}(t,f,l,a)}else l++;var v=t&&t===this.ownerID,d=Nn(f,a,p,v);return v?(this.count=l,this.nodes=d,this):new In(t,l,d)};var On=function(t,n,e){this.ownerID=t,this.keyHash=n,this.entries=e};On.prototype.get=function(t,n,e,r){for(var i=this.entries,o=0,u=i.length;o<u;o++)if(rt(e,i[o][0]))return i[o][1];return r},On.prototype.update=function(t,n,e,r,i,o,u){void 0===e&&(e=st(r));var c=i===s;if(e!==this.keyHash)return c?this:(a(u),a(o),qn(this,t,n,e,[r,i]));for(var f=this.entries,h=0,p=f.length;h<p&&!rt(r,f[h][0]);h++);var l=h<p;if(l?f[h][1]===i:c)return this;if(a(u),(c||!l)&&a(o),c&&2===p)return new Dn(t,this.keyHash,f[1^h]);var v=t&&t===this.ownerID,d=v?f:Rt(f);return l?c?h===p-1?d.pop():d[h]=d.pop():d[h]=[r,i]:d.push([r,i]),v?(this.entries=d,this):new On(t,this.keyHash,d)};var Dn=function(t,n,e){this.ownerID=t,this.keyHash=n,this.entry=e};Dn.prototype.get=function(t,n,e,r){return rt(e,this.entry[0])?this.entry[1]:r},Dn.prototype.update=function(t,n,e,r,i,o,u){var c=i===s,f=rt(r,this.entry[0]);return(f?i===this.entry[1]:c)?this:(a(u),c?void a(o):f?t&&t===this.ownerID?(this.entry[1]=i,this):new Dn(t,this.keyHash,[r,i]):(a(o),qn(this,t,n,st(r),[r,i])))},En.prototype.iterate=On.prototype.iterate=function(t,n){for(var e=this.entries,r=0,i=e.length-1;r<=i;r++)if(!1===t(e[n?i-r:r]))return!1},Pn.prototype.iterate=In.prototype.iterate=function(t,n){for(var e=this.nodes,r=0,i=e.length-1;r<=i;r++){var o=e[n?i-r:r];if(o&&!1===o.iterate(t,n))return!1}},Dn.prototype.iterate=function(t,n){return t(this.entry)};var xn,Mn=function(t){function n(t,n,e){this._type=n,this._reverse=e,this._stack=t._root&&An(t._root)}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.next=function(){for(var t=this._type,n=this._stack;n;){var e=n.node,r=n.index++,i=void 0;if(e.entry){if(0===r)return zn(t,e.entry)}else if(e.entries){if(r<=(i=e.entries.length-1))return zn(t,e.entries[this._reverse?i-r:r])}else if(r<=(i=e.nodes.length-1)){var o=e.nodes[this._reverse?i-r:r];if(o){if(o.entry)return zn(t,o.entry);n=this._stack=An(o,n)}continue}n=this._stack=this._stack.__prev}return{value:void 0,done:!0}},n}(T);function zn(t,n){return C(t,n[0],n[1])}function An(t,n){return{node:t,index:0,__prev:n}}function kn(t,n,e,r){var i=Object.create(Sn);return i.size=t,i._root=n,i.__ownerID=e,i.__hash=r,i.__altered=!1,i}function Tn(){return xn||(xn=kn(0))}function Cn(t,n,e){var r,i;if(t._root){var o={value:!1},u={value:!1};if(r=Ln(t._root,t.__ownerID,0,void 0,n,e,o,u),!u.value)return t;i=t.size+(o.value?e===s?-1:1:0)}else{if(e===s)return t;i=1,r=new En(t.__ownerID,[[n,e]])}return t.__ownerID?(t.size=i,t._root=r,t.__hash=void 0,t.__altered=!0,t):r?kn(i,r):Tn()}function Ln(t,n,e,r,i,o,u,c){return t?t.update(n,e,r,i,o,u,c):o===s?t:(a(c),a(u),new Dn(n,r,[i,o]))}function jn(t){return t.constructor===Dn||t.constructor===On}function qn(t,n,e,r,i){if(t.keyHash===r)return new On(n,r,[t.entry,i]);var o,u=31&(0===e?t.keyHash:t.keyHash>>>e),s=31&(0===e?r:r>>>e),a=u===s?[qn(t,n,e+5,r,i)]:(o=new Dn(n,r,i),u<s?[t,o]:[o,t]);return new Pn(n,1<<u|1<<s,a)}function Bn(t){return t=(t=(858993459&(t-=t>>1&1431655765))+(t>>2&858993459))+(t>>4)&252645135,t+=t>>8,127&(t+=t>>16)}function Nn(t,n,e,r){var i=r?t:Rt(t);return i[n]=e,i}var Un=8,Rn=16,Wn=8;function Fn(t){return Boolean(t&&t["@@__IMMUTABLE_LIST__@@"])}var Vn=function(t){function n(n){var e=Xn();if(null==n)return e;if(Fn(n))return n;var r=t(n),i=r.size;return 0===i?e:(Ft(i),i>0&&i<32?Gn(0,i,5,null,new Hn(r.toArray())):e.withMutations((function(t){t.setSize(i),r.forEach((function(n,e){return t.set(e,n)}))})))}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.of=function(){return this(arguments)},n.prototype.toString=function(){return this.__toString("List [","]")},n.prototype.get=function(t,n){if((t=h(this,t))>=0&&t<this.size){var e=te(this,t+=this._origin);return e&&e.array[31&t]}return n},n.prototype.set=function(t,n){return function(t,n,e){if((n=h(t,n))!=n)return t;if(n>=t.size||n<0)return t.withMutations((function(t){n<0?ne(t,n).set(0,e):ne(t,0,n+1).set(n,e)}));n+=t._origin;var r=t._tail,i=t._root,o={value:!1};n>=ee(t._capacity)?r=$n(r,t.__ownerID,0,n,e,o):i=$n(i,t.__ownerID,t._level,n,e,o);if(!o.value)return t;if(t.__ownerID)return t._root=i,t._tail=r,t.__hash=void 0,t.__altered=!0,t;return Gn(t._origin,t._capacity,t._level,i,r)}(this,t,n)},n.prototype.remove=function(t){return this.has(t)?0===t?this.shift():t===this.size-1?this.pop():this.splice(t,1):this},n.prototype.insert=function(t,n){return this.splice(t,0,n)},n.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=5,this._root=this._tail=null,this.__hash=void 0,this.__altered=!0,this):Xn()},n.prototype.push=function(){var t=arguments,n=this.size;return this.withMutations((function(e){ne(e,0,n+t.length);for(var r=0;r<t.length;r++)e.set(n+r,t[r])}))},n.prototype.pop=function(){return ne(this,0,-1)},n.prototype.unshift=function(){var t=arguments;return this.withMutations((function(n){ne(n,-t.length);for(var e=0;e<t.length;e++)n.set(e,t[e])}))},n.prototype.shift=function(){return ne(this,1)},n.prototype.concat=function(){for(var n=arguments,e=[],r=0;r<arguments.length;r++){var i=n[r],o=t("string"!=typeof i&&j(i)?i:[i]);0!==o.size&&e.push(o)}return 0===e.length?this:0!==this.size||this.__ownerID||1!==e.length?this.withMutations((function(t){e.forEach((function(n){return n.forEach((function(n){return t.push(n)}))}))})):this.constructor(e[0])},n.prototype.setSize=function(t){return ne(this,0,t)},n.prototype.map=function(t,n){var e=this;return this.withMutations((function(r){for(var i=0;i<e.size;i++)r.set(i,t.call(n,r.get(i),i,r))}))},n.prototype.slice=function(t,n){var e=this.size;return l(t,n,e)?this:ne(this,v(t,e),d(n,e))},n.prototype.__iterator=function(t,n){var e=n?this.size:0,r=Jn(this,n);return new T((function(){var i=r();return i===Qn?{value:void 0,done:!0}:C(t,n?--e:e++,i)}))},n.prototype.__iterate=function(t,n){for(var e,r=n?this.size:0,i=Jn(this,n);(e=i())!==Qn&&!1!==t(e,n?--r:r++,this););return r},n.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?Gn(this._origin,this._capacity,this._level,this._root,this._tail,t,this.__hash):0===this.size?Xn():(this.__ownerID=t,this.__altered=!1,this)},n}(P);Vn.isList=Fn;var Kn=Vn.prototype;Kn["@@__IMMUTABLE_LIST__@@"]=!0,Kn.delete=Kn.remove,Kn.merge=Kn.concat,Kn.setIn=nn,Kn.deleteIn=Kn.removeIn=rn,Kn.update=un,Kn.updateIn=sn,Kn.mergeIn=dn,Kn.mergeDeepIn=yn,Kn.withMutations=_n,Kn.wasAltered=wn,Kn.asImmutable=gn,Kn["@@transducer/init"]=Kn.asMutable=mn,Kn["@@transducer/step"]=function(t,n){return t.push(n)},Kn["@@transducer/result"]=function(t){return t.asImmutable()};var Hn=function(t,n){this.array=t,this.ownerID=n};Hn.prototype.removeBefore=function(t,n,e){if(e===n?1<<n:0===this.array.length)return this;var r=e>>>n&31;if(r>=this.array.length)return new Hn([],t);var i,o=0===r;if(n>0){var u=this.array[r];if((i=u&&u.removeBefore(t,n-5,e))===u&&o)return this}if(o&&!i)return this;var s=Zn(this,t);if(!o)for(var a=0;a<r;a++)s.array[a]=void 0;return i&&(s.array[r]=i),s},Hn.prototype.removeAfter=function(t,n,e){if(e===(n?1<<n:0)||0===this.array.length)return this;var r,i=e-1>>>n&31;if(i>=this.array.length)return this;if(n>0){var o=this.array[i];if((r=o&&o.removeAfter(t,n-5,e))===o&&i===this.array.length-1)return this}var u=Zn(this,t);return u.array.splice(i+1),r&&(u.array[i]=r),u};var Yn,Qn={};function Jn(t,n){var e=t._origin,r=t._capacity,i=ee(r),o=t._tail;return u(t._root,t._level,0);function u(t,s,a){return 0===s?function(t,u){var s=u===i?o&&o.array:t&&t.array,a=u>e?0:e-u,c=r-u;c>32&&(c=32);return function(){if(a===c)return Qn;var t=n?--c:a++;return s&&s[t]}}(t,a):function(t,i,o){var s,a=t&&t.array,c=o>e?0:e-o>>i,f=1+(r-o>>i);f>32&&(f=32);return function(){for(;;){if(s){var t=s();if(t!==Qn)return t;s=null}if(c===f)return Qn;var e=n?--f:c++;s=u(a&&a[e],i-5,o+(e<<i))}}}(t,s,a)}}function Gn(t,n,e,r,i,o,u){var s=Object.create(Kn);return s.size=n-t,s._origin=t,s._capacity=n,s._level=e,s._root=r,s._tail=i,s.__ownerID=o,s.__hash=u,s.__altered=!1,s}function Xn(){return Yn||(Yn=Gn(0,0,5))}function $n(t,n,e,r,i,o){var u,s=r>>>e&31,c=t&&s<t.array.length;if(!c&&void 0===i)return t;if(e>0){var f=t&&t.array[s],h=$n(f,n,e-5,r,i,o);return h===f?t:((u=Zn(t,n)).array[s]=h,u)}return c&&t.array[s]===i?t:(o&&a(o),u=Zn(t,n),void 0===i&&s===u.array.length-1?u.array.pop():u.array[s]=i,u)}function Zn(t,n){return n&&t&&n===t.ownerID?t:new Hn(t?t.array.slice():[],n)}function te(t,n){if(n>=ee(t._capacity))return t._tail;if(n<1<<t._level+5){for(var e=t._root,r=t._level;e&&r>0;)e=e.array[n>>>r&31],r-=5;return e}}function ne(t,n,e){void 0!==n&&(n|=0),void 0!==e&&(e|=0);var r=t.__ownerID||new c,i=t._origin,o=t._capacity,u=i+n,s=void 0===e?o:e<0?o+e:i+e;if(u===i&&s===o)return t;if(u>=s)return t.clear();for(var a=t._level,f=t._root,h=0;u+h<0;)f=new Hn(f&&f.array.length?[void 0,f]:[],r),h+=1<<(a+=5);h&&(u+=h,i+=h,s+=h,o+=h);for(var p=ee(o),l=ee(s);l>=1<<a+5;)f=new Hn(f&&f.array.length?[f]:[],r),a+=5;var v=t._tail,d=l<p?te(t,s-1):l>p?new Hn([],r):v;if(v&&l>p&&u<o&&v.array.length){for(var y=f=Zn(f,r),_=a;_>5;_-=5){var m=p>>>_&31;y=y.array[m]=Zn(y.array[m],r)}y.array[p>>>5&31]=v}if(s<o&&(d=d&&d.removeAfter(r,0,s)),u>=l)u-=l,s-=l,a=5,f=null,d=d&&d.removeBefore(r,0,u);else if(u>i||l<p){for(h=0;f;){var g=u>>>a&31;if(g!==l>>>a&31)break;g&&(h+=(1<<a)*g),a-=5,f=f.array[g]}f&&u>i&&(f=f.removeBefore(r,a,u-h)),f&&l<p&&(f=f.removeAfter(r,a,l-h)),h&&(u-=h,s-=h)}return t.__ownerID?(t.size=s-u,t._origin=u,t._capacity=s,t._level=a,t._root=f,t._tail=d,t.__hash=void 0,t.__altered=!0,t):Gn(u,s,a,f,d)}function ee(t){return t<32?0:t-1>>>5<<5}var re,ie=function(t){function n(t){return null==t?ue():nt(t)?t:ue().withMutations((function(n){var e=E(t);Ft(e.size),e.forEach((function(t,e){return n.set(e,t)}))}))}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.of=function(){return this(arguments)},n.prototype.toString=function(){return this.__toString("OrderedMap {","}")},n.prototype.get=function(t,n){var e=this._map.get(t);return void 0!==e?this._list.get(e)[1]:n},n.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this):ue()},n.prototype.set=function(t,n){return se(this,t,n)},n.prototype.remove=function(t){return se(this,t,s)},n.prototype.wasAltered=function(){return this._map.wasAltered()||this._list.wasAltered()},n.prototype.__iterate=function(t,n){var e=this;return this._list.__iterate((function(n){return n&&t(n[1],n[0],e)}),n)},n.prototype.__iterator=function(t,n){return this._list.fromEntrySeq().__iterator(t,n)},n.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var n=this._map.__ensureOwner(t),e=this._list.__ensureOwner(t);return t?oe(n,e,t,this.__hash):0===this.size?ue():(this.__ownerID=t,this._map=n,this._list=e,this)},n}(bn);function oe(t,n,e,r){var i=Object.create(ie.prototype);return i.size=t?t.size:0,i._map=t,i._list=n,i.__ownerID=e,i.__hash=r,i}function ue(){return re||(re=oe(Tn(),Xn()))}function se(t,n,e){var r,i,o=t._map,u=t._list,a=o.get(n),c=void 0!==a;if(e===s){if(!c)return t;u.size>=32&&u.size>=2*o.size?(r=(i=u.filter((function(t,n){return void 0!==t&&a!==n}))).toKeyedSeq().map((function(t){return t[0]})).flip().toMap(),t.__ownerID&&(r.__ownerID=i.__ownerID=t.__ownerID)):(r=o.remove(n),i=a===u.size-1?u.pop():u.set(a,void 0))}else if(c){if(e===u.get(a)[1])return t;r=o,i=u.set(a,[n,e])}else r=o.set(n,u.size),i=u.set(u.size,[n,e]);return t.__ownerID?(t.size=r.size,t._map=r,t._list=i,t.__hash=void 0,t):oe(r,i)}ie.isOrderedMap=nt,ie.prototype[M]=!0,ie.prototype.delete=ie.prototype.remove;function ae(t){return Boolean(t&&t["@@__IMMUTABLE_STACK__@@"])}var ce=function(t){function n(t){return null==t?le():ae(t)?t:le().pushAll(t)}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.of=function(){return this(arguments)},n.prototype.toString=function(){return this.__toString("Stack [","]")},n.prototype.get=function(t,n){var e=this._head;for(t=h(this,t);e&&t--;)e=e.next;return e?e.value:n},n.prototype.peek=function(){return this._head&&this._head.value},n.prototype.push=function(){var t=arguments;if(0===arguments.length)return this;for(var n=this.size+arguments.length,e=this._head,r=arguments.length-1;r>=0;r--)e={value:t[r],next:e};return this.__ownerID?(this.size=n,this._head=e,this.__hash=void 0,this.__altered=!0,this):pe(n,e)},n.prototype.pushAll=function(n){if(0===(n=t(n)).size)return this;if(0===this.size&&ae(n))return n;Ft(n.size);var e=this.size,r=this._head;return n.__iterate((function(t){e++,r={value:t,next:r}}),!0),this.__ownerID?(this.size=e,this._head=r,this.__hash=void 0,this.__altered=!0,this):pe(e,r)},n.prototype.pop=function(){return this.slice(1)},n.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):le()},n.prototype.slice=function(n,e){if(l(n,e,this.size))return this;var r=v(n,this.size);if(d(e,this.size)!==this.size)return t.prototype.slice.call(this,n,e);for(var i=this.size-r,o=this._head;r--;)o=o.next;return this.__ownerID?(this.size=i,this._head=o,this.__hash=void 0,this.__altered=!0,this):pe(i,o)},n.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?pe(this.size,this._head,t,this.__hash):0===this.size?le():(this.__ownerID=t,this.__altered=!1,this)},n.prototype.__iterate=function(t,n){var e=this;if(n)return new H(this.toArray()).__iterate((function(n,r){return t(n,r,e)}),n);for(var r=0,i=this._head;i&&!1!==t(i.value,r++,this);)i=i.next;return r},n.prototype.__iterator=function(t,n){if(n)return new H(this.toArray()).__iterator(t,n);var e=0,r=this._head;return new T((function(){if(r){var n=r.value;return r=r.next,C(t,e++,n)}return{value:void 0,done:!0}}))},n}(P);ce.isStack=ae;var fe,he=ce.prototype;function pe(t,n,e,r){var i=Object.create(he);return i.size=t,i._head=n,i.__ownerID=e,i.__hash=r,i.__altered=!1,i}function le(){return fe||(fe=pe(0))}he["@@__IMMUTABLE_STACK__@@"]=!0,he.shift=he.pop,he.unshift=he.push,he.unshiftAll=he.pushAll,he.withMutations=_n,he.wasAltered=wn,he.asImmutable=gn,he["@@transducer/init"]=he.asMutable=mn,he["@@transducer/step"]=function(t,n){return t.unshift(n)},he["@@transducer/result"]=function(t){return t.asImmutable()};function ve(t){return Boolean(t&&t["@@__IMMUTABLE_SET__@@"])}function de(t){return ve(t)&&z(t)}function ye(t,n){if(t===n)return!0;if(!m(n)||void 0!==t.size&&void 0!==n.size&&t.size!==n.size||void 0!==t.__hash&&void 0!==n.__hash&&t.__hash!==n.__hash||g(t)!==g(n)||w(t)!==w(n)||z(t)!==z(n))return!1;if(0===t.size&&0===n.size)return!0;var e=!b(t);if(z(t)){var r=t.entries();return n.every((function(t,n){var i=r.next().value;return i&&rt(i[1],t)&&(e||rt(i[0],n))}))&&r.next().done}var i=!1;if(void 0===t.size)if(void 0===n.size)"function"==typeof t.cacheResult&&t.cacheResult();else{i=!0;var o=t;t=n,n=o}var u=!0,a=n.__iterate((function(n,r){if(e?!t.has(n):i?!rt(n,t.get(r,s)):!rt(t.get(r,s),n))return u=!1,!1}));return u&&t.size===a}function _e(t,n){var e=function(e){t.prototype[e]=n[e]};return Object.keys(n).forEach(e),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(n).forEach(e),t}function me(t){if(!t||"object"!=typeof t)return t;if(!m(t)){if(!Ht(t))return t;t=W(t)}if(g(t)){var n={};return t.__iterate((function(t,e){n[e]=me(t)})),n}var e=[];return t.__iterate((function(t){e.push(me(t))})),e}var ge=function(t){function n(n){return null==n?Pe():ve(n)&&!z(n)?n:Pe().withMutations((function(e){var r=t(n);Ft(r.size),r.forEach((function(t){return e.add(t)}))}))}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.of=function(){return this(arguments)},n.fromKeys=function(t){return this(E(t).keySeq())},n.intersect=function(t){return(t=S(t).toArray()).length?be.intersect.apply(n(t.pop()),t):Pe()},n.union=function(t){return(t=S(t).toArray()).length?be.union.apply(n(t.pop()),t):Pe()},n.prototype.toString=function(){return this.__toString("Set {","}")},n.prototype.has=function(t){return this._map.has(t)},n.prototype.add=function(t){return Se(this,this._map.set(t,t))},n.prototype.remove=function(t){return Se(this,this._map.remove(t))},n.prototype.clear=function(){return Se(this,this._map.clear())},n.prototype.map=function(t,n){var e=this,r=[],i=[];return this.forEach((function(o){var u=t.call(n,o,o,e);u!==o&&(r.push(o),i.push(u))})),this.withMutations((function(t){r.forEach((function(n){return t.remove(n)})),i.forEach((function(n){return t.add(n)}))}))},n.prototype.union=function(){for(var n=[],e=arguments.length;e--;)n[e]=arguments[e];return 0===(n=n.filter((function(t){return 0!==t.size}))).length?this:0!==this.size||this.__ownerID||1!==n.length?this.withMutations((function(e){for(var r=0;r<n.length;r++)t(n[r]).forEach((function(t){return e.add(t)}))})):this.constructor(n[0])},n.prototype.intersect=function(){for(var n=[],e=arguments.length;e--;)n[e]=arguments[e];if(0===n.length)return this;n=n.map((function(n){return t(n)}));var r=[];return this.forEach((function(t){n.every((function(n){return n.includes(t)}))||r.push(t)})),this.withMutations((function(t){r.forEach((function(n){t.remove(n)}))}))},n.prototype.subtract=function(){for(var n=[],e=arguments.length;e--;)n[e]=arguments[e];if(0===n.length)return this;n=n.map((function(n){return t(n)}));var r=[];return this.forEach((function(t){n.some((function(n){return n.includes(t)}))&&r.push(t)})),this.withMutations((function(t){r.forEach((function(n){t.remove(n)}))}))},n.prototype.sort=function(t){return We(At(this,t))},n.prototype.sortBy=function(t,n){return We(At(this,n,t))},n.prototype.wasAltered=function(){return this._map.wasAltered()},n.prototype.__iterate=function(t,n){var e=this;return this._map.__iterate((function(n){return t(n,n,e)}),n)},n.prototype.__iterator=function(t,n){return this._map.__iterator(t,n)},n.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var n=this._map.__ensureOwner(t);return t?this.__make(n,t):0===this.size?this.__empty():(this.__ownerID=t,this._map=n,this)},n}(I);ge.isSet=ve;var we,be=ge.prototype;function Se(t,n){return t.__ownerID?(t.size=n.size,t._map=n,t):n===t._map?t:0===n.size?t.__empty():t.__make(n)}function Ee(t,n){var e=Object.create(be);return e.size=t?t.size:0,e._map=t,e.__ownerID=n,e}function Pe(){return we||(we=Ee(Tn()))}be["@@__IMMUTABLE_SET__@@"]=!0,be.delete=be.remove,be.merge=be.concat=be.union,be.withMutations=_n,be.asImmutable=gn,be["@@transducer/init"]=be.asMutable=mn,be["@@transducer/step"]=function(t,n){return t.add(n)},be["@@transducer/result"]=function(t){return t.asImmutable()},be.__empty=Pe,be.__make=Ee;var Ie,Oe=function(t){function n(t,e,r){if(!(this instanceof n))return new n(t,e,r);if(Wt(0!==r,"Cannot step a Range by 0"),t=t||0,void 0===e&&(e=1/0),r=void 0===r?1:Math.abs(r),e<t&&(r=-r),this._start=t,this._end=e,this._step=r,this.size=Math.max(0,Math.ceil((e-t)/r-1)+1),0===this.size){if(Ie)return Ie;Ie=this}}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(1!==this._step?" by "+this._step:"")+" ]"},n.prototype.get=function(t,n){return this.has(t)?this._start+h(this,t)*this._step:n},n.prototype.includes=function(t){var n=(t-this._start)/this._step;return n>=0&&n<this.size&&n===Math.floor(n)},n.prototype.slice=function(t,e){return l(t,e,this.size)?this:(t=v(t,this.size),(e=d(e,this.size))<=t?new n(0,0):new n(this.get(t,this._end),this.get(e,this._end),this._step))},n.prototype.indexOf=function(t){var n=t-this._start;if(n%this._step==0){var e=n/this._step;if(e>=0&&e<this.size)return e}return-1},n.prototype.lastIndexOf=function(t){return this.indexOf(t)},n.prototype.__iterate=function(t,n){for(var e=this.size,r=this._step,i=n?this._start+(e-1)*r:this._start,o=0;o!==e&&!1!==t(i,n?e-++o:o++,this);)i+=n?-r:r;return o},n.prototype.__iterator=function(t,n){var e=this.size,r=this._step,i=n?this._start+(e-1)*r:this._start,o=0;return new T((function(){if(o===e)return{value:void 0,done:!0};var u=i;return i+=n?-r:r,C(t,n?e-++o:o++,u)}))},n.prototype.equals=function(t){return t instanceof n?this._start===t._start&&this._end===t._end&&this._step===t._step:ye(this,t)},n}(V);function De(t,n,e){for(var r=Vt(n),i=0;i!==r.length;)if((t=Jt(t,r[i++],s))===s)return e;return t}function xe(t,n){return De(this,t,n)}function Me(t,n){return De(t,n,s)!==s}function ze(){Ft(this.size);var t={};return this.__iterate((function(n,e){t[e]=n})),t}S.isIterable=m,S.isKeyed=g,S.isIndexed=w,S.isAssociative=b,S.isOrdered=z,S.Iterator=T,_e(S,{toArray:function(){Ft(this.size);var t=new Array(this.size||0),n=g(this),e=0;return this.__iterate((function(r,i){t[e++]=n?[i,r]:r})),t},toIndexedSeq:function(){return new wt(this)},toJS:function(){return me(this)},toKeyedSeq:function(){return new gt(this,!0)},toMap:function(){return bn(this.toKeyedSeq())},toObject:ze,toOrderedMap:function(){return ie(this.toKeyedSeq())},toOrderedSet:function(){return We(g(this)?this.valueSeq():this)},toSet:function(){return ge(g(this)?this.valueSeq():this)},toSetSeq:function(){return new bt(this)},toSeq:function(){return w(this)?this.toIndexedSeq():g(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return ce(g(this)?this.valueSeq():this)},toList:function(){return Vn(g(this)?this.valueSeq():this)},toString:function(){return"[Collection]"},__toString:function(t,n){return 0===this.size?t+n:t+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+n},concat:function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return Lt(this,Mt(this,t))},includes:function(t){return this.some((function(n){return rt(n,t)}))},entries:function(){return this.__iterator(2)},every:function(t,n){Ft(this.size);var e=!0;return this.__iterate((function(r,i,o){if(!t.call(n,r,i,o))return e=!1,!1})),e},filter:function(t,n){return Lt(this,Ot(this,t,n,!0))},find:function(t,n,e){var r=this.findEntry(t,n);return r?r[1]:e},forEach:function(t,n){return Ft(this.size),this.__iterate(n?t.bind(n):t)},join:function(t){Ft(this.size),t=void 0!==t?""+t:",";var n="",e=!0;return this.__iterate((function(r){e?e=!1:n+=t,n+=null!=r?r.toString():""})),n},keys:function(){return this.__iterator(0)},map:function(t,n){return Lt(this,Pt(this,t,n))},reduce:function(t,n,e){return Ce(this,t,n,e,arguments.length<2,!1)},reduceRight:function(t,n,e){return Ce(this,t,n,e,arguments.length<2,!0)},reverse:function(){return Lt(this,It(this,!0))},slice:function(t,n){return Lt(this,Dt(this,t,n,!0))},some:function(t,n){return!this.every(qe(t),n)},sort:function(t){return Lt(this,At(this,t))},values:function(){return this.__iterator(1)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return void 0!==this.size?0===this.size:!this.some((function(){return!0}))},count:function(t,n){return f(t?this.toSeq().filter(t,n):this)},countBy:function(t,n){return function(t,n,e){var r=bn().asMutable();return t.__iterate((function(i,o){r.update(n.call(e,i,o,t),0,(function(t){return t+1}))})),r.asImmutable()}(this,t,n)},equals:function(t){return ye(this,t)},entrySeq:function(){var t=this;if(t._cache)return new H(t._cache);var n=t.toSeq().map(je).toIndexedSeq();return n.fromEntrySeq=function(){return t.toSeq()},n},filterNot:function(t,n){return this.filter(qe(t),n)},findEntry:function(t,n,e){var r=e;return this.__iterate((function(e,i,o){if(t.call(n,e,i,o))return r=[i,e],!1})),r},findKey:function(t,n){var e=this.findEntry(t,n);return e&&e[0]},findLast:function(t,n,e){return this.toKeyedSeq().reverse().find(t,n,e)},findLastEntry:function(t,n,e){return this.toKeyedSeq().reverse().findEntry(t,n,e)},findLastKey:function(t,n){return this.toKeyedSeq().reverse().findKey(t,n)},first:function(t){return this.find(p,null,t)},flatMap:function(t,n){return Lt(this,function(t,n,e){var r=qt(t);return t.toSeq().map((function(i,o){return r(n.call(e,i,o,t))})).flatten(!0)}(this,t,n))},flatten:function(t){return Lt(this,zt(this,t,!0))},fromEntrySeq:function(){return new St(this)},get:function(t,n){return this.find((function(n,e){return rt(e,t)}),void 0,n)},getIn:xe,groupBy:function(t,n){return function(t,n,e){var r=g(t),i=(z(t)?ie():bn()).asMutable();t.__iterate((function(o,u){i.update(n.call(e,o,u,t),(function(t){return(t=t||[]).push(r?[u,o]:o),t}))}));var o=qt(t);return i.map((function(n){return Lt(t,o(n))})).asImmutable()}(this,t,n)},has:function(t){return this.get(t,s)!==s},hasIn:function(t){return Me(this,t)},isSubset:function(t){return t="function"==typeof t.includes?t:S(t),this.every((function(n){return t.includes(n)}))},isSuperset:function(t){return(t="function"==typeof t.isSubset?t:S(t)).isSubset(this)},keyOf:function(t){return this.findKey((function(n){return rt(n,t)}))},keySeq:function(){return this.toSeq().map(Le).toIndexedSeq()},last:function(t){return this.toSeq().reverse().first(t)},lastKeyOf:function(t){return this.toKeyedSeq().reverse().keyOf(t)},max:function(t){return kt(this,t)},maxBy:function(t,n){return kt(this,n,t)},min:function(t){return kt(this,t?Be(t):Ue)},minBy:function(t,n){return kt(this,n?Be(n):Ue,t)},rest:function(){return this.slice(1)},skip:function(t){return 0===t?this:this.slice(Math.max(0,t))},skipLast:function(t){return 0===t?this:this.slice(0,-Math.max(0,t))},skipWhile:function(t,n){return Lt(this,xt(this,t,n,!0))},skipUntil:function(t,n){return this.skipWhile(qe(t),n)},sortBy:function(t,n){return Lt(this,At(this,n,t))},take:function(t){return this.slice(0,Math.max(0,t))},takeLast:function(t){return this.slice(-Math.max(0,t))},takeWhile:function(t,n){return Lt(this,function(t,n,e){var r=Bt(t);return r.__iterateUncached=function(r,i){var o=this;if(i)return this.cacheResult().__iterate(r,i);var u=0;return t.__iterate((function(t,i,s){return n.call(e,t,i,s)&&++u&&r(t,i,o)})),u},r.__iteratorUncached=function(r,i){var o=this;if(i)return this.cacheResult().__iterator(r,i);var u=t.__iterator(2,i),s=!0;return new T((function(){if(!s)return{value:void 0,done:!0};var t=u.next();if(t.done)return t;var i=t.value,a=i[0],c=i[1];return n.call(e,c,a,o)?2===r?t:C(r,a,c,t):(s=!1,{value:void 0,done:!0})}))},r}(this,t,n))},takeUntil:function(t,n){return this.takeWhile(qe(t),n)},update:function(t){return t(this)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=function(t){if(t.size===1/0)return 0;var n=z(t),e=g(t),r=n?1:0;return function(t,n){return n=it(n,3432918353),n=it(n<<15|n>>>-15,461845907),n=it(n<<13|n>>>-13,5),n=it((n=(n+3864292196|0)^t)^n>>>16,2246822507),n=ot((n=it(n^n>>>13,3266489909))^n>>>16)}(t.__iterate(e?n?function(t,n){r=31*r+Re(st(t),st(n))|0}:function(t,n){r=r+Re(st(t),st(n))|0}:n?function(t){r=31*r+st(t)|0}:function(t){r=r+st(t)|0}),r)}(this))}});var Ae=S.prototype;Ae["@@__IMMUTABLE_ITERABLE__@@"]=!0,Ae[k]=Ae.values,Ae.toJSON=Ae.toArray,Ae.__toStringMapper=Yt,Ae.inspect=Ae.toSource=function(){return this.toString()},Ae.chain=Ae.flatMap,Ae.contains=Ae.includes,_e(E,{flip:function(){return Lt(this,Et(this))},mapEntries:function(t,n){var e=this,r=0;return Lt(this,this.toSeq().map((function(i,o){return t.call(n,[o,i],r++,e)})).fromEntrySeq())},mapKeys:function(t,n){var e=this;return Lt(this,this.toSeq().flip().map((function(r,i){return t.call(n,r,i,e)})).flip())}});var ke=E.prototype;ke["@@__IMMUTABLE_KEYED__@@"]=!0,ke[k]=Ae.entries,ke.toJSON=ze,ke.__toStringMapper=function(t,n){return Yt(n)+": "+Yt(t)},_e(P,{toKeyedSeq:function(){return new gt(this,!1)},filter:function(t,n){return Lt(this,Ot(this,t,n,!1))},findIndex:function(t,n){var e=this.findEntry(t,n);return e?e[0]:-1},indexOf:function(t){var n=this.keyOf(t);return void 0===n?-1:n},lastIndexOf:function(t){var n=this.lastKeyOf(t);return void 0===n?-1:n},reverse:function(){return Lt(this,It(this,!1))},slice:function(t,n){return Lt(this,Dt(this,t,n,!1))},splice:function(t,n){var e=arguments.length;if(n=Math.max(n||0,0),0===e||2===e&&!n)return this;t=v(t,t<0?this.count():this.size);var r=this.slice(0,t);return Lt(this,1===e?r:r.concat(Rt(arguments,2),this.slice(t+n)))},findLastIndex:function(t,n){var e=this.findLastEntry(t,n);return e?e[0]:-1},first:function(t){return this.get(0,t)},flatten:function(t){return Lt(this,zt(this,t,!1))},get:function(t,n){return(t=h(this,t))<0||this.size===1/0||void 0!==this.size&&t>this.size?n:this.find((function(n,e){return e===t}),void 0,n)},has:function(t){return(t=h(this,t))>=0&&(void 0!==this.size?this.size===1/0||t<this.size:-1!==this.indexOf(t))},interpose:function(t){return Lt(this,function(t,n){var e=Bt(t);return e.size=t.size&&2*t.size-1,e.__iterateUncached=function(e,r){var i=this,o=0;return t.__iterate((function(t){return(!o||!1!==e(n,o++,i))&&!1!==e(t,o++,i)}),r),o},e.__iteratorUncached=function(e,r){var i,o=t.__iterator(1,r),u=0;return new T((function(){return(!i||u%2)&&(i=o.next()).done?i:u%2?C(e,u++,n):C(e,u++,i.value,i)}))},e}(this,t))},interleave:function(){var t=[this].concat(Rt(arguments)),n=Ct(this.toSeq(),V.of,t),e=n.flatten(!0);return n.size&&(e.size=n.size*t.length),Lt(this,e)},keySeq:function(){return Oe(0,this.size)},last:function(t){return this.get(-1,t)},skipWhile:function(t,n){return Lt(this,xt(this,t,n,!1))},zip:function(){var t=[this].concat(Rt(arguments));return Lt(this,Ct(this,Ne,t))},zipAll:function(){var t=[this].concat(Rt(arguments));return Lt(this,Ct(this,Ne,t,!0))},zipWith:function(t){var n=Rt(arguments);return n[0]=this,Lt(this,Ct(this,t,n))}});var Te=P.prototype;function Ce(t,n,e,r,i,o){return Ft(t.size),t.__iterate((function(t,o,u){i?(i=!1,e=t):e=n.call(r,e,t,o,u)}),o),e}function Le(t,n){return n}function je(t,n){return[n,t]}function qe(t){return function(){return!t.apply(this,arguments)}}function Be(t){return function(){return-t.apply(this,arguments)}}function Ne(){return Rt(arguments)}function Ue(t,n){return t<n?1:t>n?-1:0}function Re(t,n){return t^n+2654435769+(t<<6)+(t>>2)|0}Te["@@__IMMUTABLE_INDEXED__@@"]=!0,Te[M]=!0,_e(I,{get:function(t,n){return this.has(t)?t:n},includes:function(t){return this.has(t)},keySeq:function(){return this.valueSeq()}}),I.prototype.has=Ae.includes,I.prototype.contains=I.prototype.includes,_e(F,E.prototype),_e(V,P.prototype),_e(K,I.prototype);var We=function(t){function n(t){return null==t?He():de(t)?t:He().withMutations((function(n){var e=I(t);Ft(e.size),e.forEach((function(t){return n.add(t)}))}))}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.of=function(){return this(arguments)},n.fromKeys=function(t){return this(E(t).keySeq())},n.prototype.toString=function(){return this.__toString("OrderedSet {","}")},n}(ge);We.isOrderedSet=de;var Fe,Ve=We.prototype;function Ke(t,n){var e=Object.create(Ve);return e.size=t?t.size:0,e._map=t,e.__ownerID=n,e}function He(){return Fe||(Fe=Ke(ue()))}Ve[M]=!0,Ve.zip=Te.zip,Ve.zipWith=Te.zipWith,Ve.__empty=He,Ve.__make=Ke;var Ye=function(t,n){var e,r=function(o){var u=this;if(o instanceof r)return o;if(!(this instanceof r))return new r(o);if(!e){e=!0;var s=Object.keys(t),a=i._indices={};i._name=n,i._keys=s,i._defaultValues=t;for(var c=0;c<s.length;c++){var f=s[c];a[f]=c,i[f]?"object"==typeof console&&console.warn&&console.warn("Cannot define "+Ge(this)+' with property "'+f+'" since that property name is part of the Record API.'):$e(i,f)}}this.__ownerID=void 0,this._values=Vn().withMutations((function(t){t.setSize(u._keys.length),E(o).forEach((function(n,e){t.set(u._indices[e],n===u._defaultValues[e]?void 0:n)}))}))},i=r.prototype=Object.create(Qe);return i.constructor=r,n&&(r.displayName=n),r};Ye.prototype.toString=function(){for(var t,n=Ge(this)+" { ",e=this._keys,r=0,i=e.length;r!==i;r++)n+=(r?", ":"")+(t=e[r])+": "+Yt(this.get(t));return n+" }"},Ye.prototype.equals=function(t){return this===t||t&&this._keys===t._keys&&Xe(this).equals(Xe(t))},Ye.prototype.hashCode=function(){return Xe(this).hashCode()},Ye.prototype.has=function(t){return this._indices.hasOwnProperty(t)},Ye.prototype.get=function(t,n){if(!this.has(t))return n;var e=this._indices[t],r=this._values.get(e);return void 0===r?this._defaultValues[t]:r},Ye.prototype.set=function(t,n){if(this.has(t)){var e=this._values.set(this._indices[t],n===this._defaultValues[t]?void 0:n);if(e!==this._values&&!this.__ownerID)return Je(this,e)}return this},Ye.prototype.remove=function(t){return this.set(t)},Ye.prototype.clear=function(){var t=this._values.clear().setSize(this._keys.length);return this.__ownerID?this:Je(this,t)},Ye.prototype.wasAltered=function(){return this._values.wasAltered()},Ye.prototype.toSeq=function(){return Xe(this)},Ye.prototype.toJS=function(){return me(this)},Ye.prototype.entries=function(){return this.__iterator(2)},Ye.prototype.__iterator=function(t,n){return Xe(this).__iterator(t,n)},Ye.prototype.__iterate=function(t,n){return Xe(this).__iterate(t,n)},Ye.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var n=this._values.__ensureOwner(t);return t?Je(this,n,t):(this.__ownerID=t,this._values=n,this)},Ye.isRecord=D,Ye.getDescriptiveName=Ge;var Qe=Ye.prototype;function Je(t,n,e){var r=Object.create(Object.getPrototypeOf(t));return r._values=n,r.__ownerID=e,r}function Ge(t){return t.constructor.displayName||t.constructor.name||"Record"}function Xe(t){return X(t._keys.map((function(n){return[n,t.get(n)]})))}function $e(t,n){try{Object.defineProperty(t,n,{get:function(){return this.get(n)},set:function(t){Wt(this.__ownerID,"Cannot set on an immutable record."),this.set(n,t)}})}catch(t){}}Qe["@@__IMMUTABLE_RECORD__@@"]=!0,Qe.delete=Qe.remove,Qe.deleteIn=Qe.removeIn=rn,Qe.getIn=xe,Qe.hasIn=Ae.hasIn,Qe.merge=an,Qe.mergeWith=cn,Qe.mergeIn=dn,Qe.mergeDeep=ln,Qe.mergeDeepWith=vn,Qe.mergeDeepIn=yn,Qe.setIn=nn,Qe.update=un,Qe.updateIn=sn,Qe.withMutations=_n,Qe.asMutable=mn,Qe.asImmutable=gn,Qe[k]=Qe.entries,Qe.toJSON=Qe.toObject=Ae.toObject,Qe.inspect=Qe.toSource=function(){return this.toString()};var Ze=function(){function t(t){this._list=Vn([]).concat(t||[])}return Object.defineProperty(t.prototype,"list",{get:function(){return this._list},enumerable:!0,configurable:!0}),t.prototype.addOrUpdate=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(var r=new t(this.list),i=0,o=n;i<o.length;i++){var u=o[i],s=this.convert(u)[0],a=r.getIndexForKey(s);r=-1!==a?new t(r.list.set(a,u)):r.add(u)}return r},t.prototype.addOrUpdateSearchTerm=function(n){var e=this.list;return n?this.addOrUpdate({query:n}):new t(e)},t.prototype.add=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var r=this.list.concat(n);return new t(r)},t.prototype.convert=function(t){var n=Object.keys(t)[0];return[n,t[n]]},t.prototype.getOne=function(t){return this.list.find((function(n){return Object.keys(n)[0]===t}))||null},t.prototype.getMany=function(t){var n=this;return this.list.filter((function(e){var r=n.convert(e)[0];return t===r}))},t.prototype.deleteAll=function(n){return new t(this.list.filter((function(t){return Object.keys(t)[0]!==n})))},t.prototype.delete=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var r=new t(this.list);return n.forEach((function(n){var e=r.getIndexForParameter(n);r=new t(r.list.delete(e))})),r},t.prototype.toString=function(){var t=this,n=new URLSearchParams;return this.list.forEach((function(e){var r=t.convert(e)[0];n.append(r,e[r])})),n.toString()},t.prototype.toArray=function(){return this.list.toArray()},t.prototype.updateFirst=function(n){var e=this.list,r=this.convert(n)[0],i=this.getIndexForKey(r);return new t(-1!==i?e.set(i,n):e)},t.prototype.update=function(n,e){var r=this.list,i=this.getIndexForParameter(n);return new t(r.set(i,e))},t.prototype.getIndexForKey=function(t){return this.list.findIndex((function(n){return Object.keys(n)[0]===t}))},t.prototype.getIndexForParameter=function(t){var n=this;return this.list.findIndex((function(e){var r=n.convert(e),i=r[0],o=r[1],u=n.convert(t),s=u[0],a=u[1];return i===s&&o===a}))},t}(),tr=function(){return(tr=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},nr=function(t,n,e,r){return new(e||(e=Promise))((function(i,o){function u(t){try{a(r.next(t))}catch(t){o(t)}}function s(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(u,s)}a((r=r.apply(t,n||[])).next())}))},er=function(t,n){var e,r,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;u;)try{if(e=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=u.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=n.call(t,u)}catch(t){o=[6,t],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},rr="Invalid pagination parameters defined. Static pagination parameters are required.",ir=function(){function t(t,n){var e=this;this.responseData=n,this._fetchClient=t,this.responseData=n,this.searchResults=n.results.map((function(t){var n=e.responseData.highlighting;return new r(t,n)})),this.paginationParams=this.extractPaginationParams(this.responseData),this.facets=this.hasFacets(n)?this.extractFacets(n,t):[]}return Object.defineProperty(t.prototype,"numberOfResults",{get:function(){return this.responseData.numRows},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"didYouMean",{get:function(){return this.responseData.didYouMean},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fetchClient",{get:function(){return this._fetchClient},enumerable:!0,configurable:!0}),t.prototype.hasFacets=function(t){return t.facets.length>0&&t.facetConfigs.length>0},t.prototype.extractFacets=function(t,n){return t.facets.map((function(e,r){var i=t.facetConfigs[r].baseName,o=Object.keys(t.requestParameters).find((function(t){return t.includes(i)})),s=new u(n,e,t.facetConfigs[r]);if(o){var a=t.requestParameters[o].map((function(t){return t.replace(/"/g,"")}));return s.setSelectedValues.apply(s,a)}return s}))},t.prototype.extractPaginationParams=function(t){var n=t.requestParameters;return this.hasDynamicPaginationParams(n)?this.extractDynamicPaginationParams(n):this.hasStaticPaginationParams(n)?this.extractStaticPaginationParams(n):this.setDefaultStaticPaginationParams(t.rows)},t.prototype.hasDynamicPaginationParams=function(t){var n=Object.prototype.hasOwnProperty.call(t,"haupia_rows"),e=Object.prototype.hasOwnProperty.call(t,"haupia_start");return n&&e},t.prototype.extractDynamicPaginationParams=function(t){var n=Number(t.haupia_rows),e=Number(t.haupia_start);if(isNaN(n)||isNaN(e))throw Error("Invalid pagination parameters.");return{rows:n,start:e}},t.prototype.hasStaticPaginationParams=function(t){var n=Object.prototype.hasOwnProperty.call(t,"haupia_pageNumber"),e=Object.prototype.hasOwnProperty.call(t,"haupia_pageSize");return n&&e},t.prototype.extractStaticPaginationParams=function(t){var n=Number(t.haupia_pageNumber),e=Number(t.haupia_pageSize);if(isNaN(n)||isNaN(e))throw Error("Invalid pagination parameters.");return{pageNumber:n,pageSize:e}},t.prototype.setDefaultStaticPaginationParams=function(t){return{pageNumber:0,pageSize:t}},t.prototype.getNumberOfPages=function(){if(!this.isStaticPagination(this.paginationParams))throw Error(rr);return Math.ceil(this.responseData.numRows/this.paginationParams.pageSize)},t.prototype.getFacet=function(t){return this.facets.find((function(n){return n.name===t}))||null},t.prototype.resetFacets=function(t){return nr(this,void 0,void 0,(function(){return er(this,(function(n){return this.facets=this.facets.map((function(n){var e;return t?(null===(e=t)||void 0===e?void 0:e.includes(n.name))?n.reset():n:n.reset()})),this.isDynamicPagination(this.paginationParams)?[2,this.search({start:0,rows:this.paginationParams.rows})]:[2,this.getFirstPage()]}))}))},t.prototype.getFirstPage=function(){if(!this.isStaticPagination(this.paginationParams))throw Error(rr);return this.getPage(0)},t.prototype.getLastPage=function(){var t=this.getNumberOfPages()-1;return this.getPage(t)},t.prototype.getPage=function(t){return nr(this,void 0,void 0,(function(){var n;return er(this,(function(e){if(!this.isStaticPagination(this.paginationParams))throw Error(rr);if((n=this.paginationParams).pageNumber=t,!this.hasPage(t))throw Error("There is no page number: "+t);return[2,this.search(n)]}))}))},t.prototype.hasPage=function(t){var n=this.paginationParams;return Math.ceil(this.responseData.numRows/n.pageSize)>t&&t>=0},t.prototype.hasNext=function(){return!!(this.isDynamicPagination(this.paginationParams)&&this.paginationParams.start+this.paginationParams.rows<this.responseData.numRows)||!!(this.isStaticPagination(this.paginationParams)&&this.paginationParams.pageSize*(this.paginationParams.pageNumber+1)<this.responseData.numRows)},t.prototype.hasPrev=function(){return!!(this.isStaticPagination(this.paginationParams)&&this.paginationParams.pageNumber>0)||!!(this.isDynamicPagination(this.paginationParams)&&this.paginationParams.start>=this.paginationParams.rows)},t.prototype.next=function(){return nr(this,void 0,void 0,(function(){var t;return er(this,(function(n){if(!this.hasNext())throw Error("There is no next page.");return t={},this.isDynamicPagination(this.paginationParams)&&((t=tr({},this.paginationParams)).start+=this.paginationParams.rows),this.isStaticPagination(this.paginationParams)&&(t=this.paginationParams).pageNumber++,[2,this.search(t)]}))}))},t.prototype.prev=function(){return nr(this,void 0,void 0,(function(){var t;return er(this,(function(n){if(!this.hasPrev())throw Error("There is no previous page.");return t={},this.isStaticPagination(this.paginationParams)&&(t=this.paginationParams).pageNumber--,this.isDynamicPagination(this.paginationParams)&&((t=this.paginationParams).start-=t.rows),[2,this.search(t)]}))}))},t.prototype.addOrUpdateFacetParams=function(t){var n=new Ze(t.list);return this.facets.forEach((function(t){var e,r=t.getSelectedParameters();n=(e=n.deleteAll(t.getFilterParamName())).add.apply(e,r)})),n},t.prototype.search=function(n){return nr(this,void 0,void 0,(function(){var e,r,i,o,u;return er(this,(function(s){switch(s.label){case 0:e=this.buildFetchParams(n),r=(u=this.fetchClient.parameterList).addOrUpdate.apply(u,e),this.fetchClient.parameterList=this.addOrUpdateFacetParams(r),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.fetchClient.fetch()];case 2:return i=s.sent(),[2,new t(this.fetchClient,i)];case 3:throw o=s.sent(),new Error(o);case 4:return[2]}}))}))},t.prototype.buildFetchParams=function(t){var n=[],e=this.transformPaginationParamsToFetchParams(t);return n=n.concat(e)},t.prototype.transformPaginationParamsToFetchParams=function(t){var n=[];return this.isDynamicPagination(t)&&(n=this.buildDynamicPaginationParams(t)),this.isStaticPagination(t)&&(n=this.buildStaticPaginationParams(t)),n},t.prototype.buildDynamicPaginationParams=function(t){var n=[];return n.push({haupia_rows:t.rows.toString()}),n.push({haupia_start:t.start.toString()}),n},t.prototype.buildStaticPaginationParams=function(t){var n=[];return n.push({haupia_pageNumber:t.pageNumber.toString()}),n.push({haupia_pageSize:t.pageSize.toString()}),n},t.prototype.isDynamicPagination=function(t){return void 0!==t.rows},t.prototype.isStaticPagination=function(t){return void 0!==t.pageNumber},t}(),or=e(0),ur=function(t){return t},sr=function(t,n){return'<a href="'+t.link+'"><h1>'+t.title+"</h1><p>"+n.content+"</p></a>"},ar=function(t){return"<span>"+t+"</span>"},cr=function(t,n,e,r){return new(e||(e=Promise))((function(i,o){function u(t){try{a(r.next(t))}catch(t){o(t)}}function s(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(u,s)}a((r=r.apply(t,n||[])).next())}))},fr=function(t,n){var e,r,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;u;)try{if(e=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=u.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=n.call(t,u)}catch(t){o=[6,t],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},hr=["Enter","ArrowUp","ArrowDown"],pr=new CustomEvent("smart-search-widget-appeared",{bubbles:!0,cancelable:!0}),lr=new CustomEvent("smart-search-widget-hidden",{bubbles:!0,cancelable:!0}),vr=new CustomEvent("smart-search-input-empty",{bubbles:!0,cancelable:!0}),dr=function(){function t(t,n){this.autocompleteClient=t,this.options=n}return t.prototype.getAutocompleteList=function(t,n){var e,r;return cr(this,void 0,void 0,(function(){var i,o,u,s,a=this;return fr(this,(function(c){switch(c.label){case 0:n||(n=this.options),c.label=1;case 1:return c.trys.push([1,3,,4]),i=[{prefix:t.toLowerCase()}],(null===(e=n)||void 0===e?void 0:e.language)&&i.push({language:n.language}),this.autocompleteClient.parameterList=(s=this.autocompleteClient.parameterList).addOrUpdate.apply(s,i),[4,this.autocompleteClient.fetch()];case 2:return o=c.sent(),(null===(r=n)||void 0===r?void 0:r.highlight)?[2,o.map((function(n){return a.highlightPrefix(n,t)}))]:[2,o];case 3:return u=c.sent(),console.error("Error fetching autocomplete suggestions",u),[3,4];case 4:return[2,[""]]}}))}))},t.prototype.highlightPrefix=function(t,n){var e=t.substr(t.indexOf(n.toLowerCase())+n.length);return"<strong>"+n+"</strong>"+e},t.prototype.showBox=function(t){"hidden"===t.style.visibility&&(t.style.visibility="visible",t.dispatchEvent(pr))},t.prototype.hideBox=function(t){t.style.visibility="hidden",t.dispatchEvent(lr)},t.prototype.clearAutocompleteBox=function(t){this.hideBox(t),t.querySelectorAll(".smart-search-autocomplete-item").forEach((function(t){return t.remove()}))},t.prototype.createAutocompleteBox=function(t){var n=document.createElement("div");return n.setAttribute("id",t+" autocomplete-widget"),n.setAttribute("class","smart-search-autocomplete-widget"),n},t.prototype.removeHighlights=function(t){var n=document.createElement("div");return n.innerHTML=t,n.textContent||""},t.prototype.markActiveItem=function(t,n){var e=Array.from(t.querySelectorAll(".smart-search-autocomplete-item")),r=e.filter((function(t,e){return e===n})).map((function(t){return t.classList.add("smart-search-autocomplete-active"),t})).pop();return e.filter((function(t,e){return e!==n})).forEach((function(t){return t.classList.remove("smart-search-autocomplete-active")})),r},t.prototype.renderItem=function(t){var n=document.createElement("div");return n.setAttribute("class","smart-search-autocomplete-item"),n.innerHTML=t,n},t.prototype.initializeAndAttach=function(t,n){var e=this,r=this.createAutocompleteBox(t.id);if(n)n.appendChild(r);else{if(!t.parentNode)throw new Error("Given input element has no parent. Please attach it to an element in the DOM tree.");t.parentNode.appendChild(r)}this.hideBox(r),or.fromEvent(t,"keydown").debounce(300).filter((function(t){return!hr.includes(t.key)})).map((function(t){return t.target.value})).skipDuplicates().flatMapLatest((function(n){var i;t.addEventListener("smart-search-input-empty",(function(){return e.clearAutocompleteBox(r)}),{once:!0});var o=(null===(i=e.options)||void 0===i?void 0:i.prefixThreshold)||0;if(0===n.length)dispatchEvent(vr);else if(n.length>o)return or.fromPromise(e.getAutocompleteList(n));return[]})).onValue((function(n){e.clearAutocompleteBox(r),n.forEach((function(n){e.showBox(r);var i=e.renderItem(n);i.addEventListener("click",(function(){t.value=e.removeHighlights(n),t.focus(),e.clearAutocompleteBox(r)})),r.appendChild(i)}))}));var i=or.fromEvent(t,"keydown").filter((function(t){return"ArrowUp"===t.key})),o=or.fromEvent(t,"keydown").filter((function(t){return"ArrowDown"===t.key})),u=or.fromEvent(t,"keydown").filter((function(t){return"Enter"===t.key})),s=or.fromEvent(r,"smart-search-widget-appeared");or.update(-1,[o,function(t){return Math.min(t+1,4)}],[i,function(t){return Math.max(t-1,-1)}],[s,function(){return-1}],[u,function(){return-1}]).onValue((function(n){var i=e.markActiveItem(r,n);t.addEventListener("keydown",(function(t){var n;"Enter"===t.key&&(null===(n=i)||void 0===n||n.click())}))}))},t}(),yr=function(t,n,e,r){return new(e||(e=Promise))((function(i,o){function u(t){try{a(r.next(t))}catch(t){o(t)}}function s(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(u,s)}a((r=r.apply(t,n||[])).next())}))},_r=function(t,n){var e,r,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;u;)try{if(e=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=u.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=n.call(t,u)}catch(t){o=[6,t],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},mr={cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},method:"GET",mode:"cors",redirect:"follow",referrerPolicy:"no-referrer"},gr=function(){function t(t,n){var e,r;this.url=t,this._parameterList=new Ze,this._autocomplete=(null===(r=n)||void 0===r?void 0:r.autocomplete)||!1,n&&(this.parameterList=(e=this.parameterList.addOrUpdateSearchTerm(n.searchTerm||"")).add.apply(e,n.customParams||[]))}return Object.defineProperty(t.prototype,"autocomplete",{get:function(){return this._autocomplete},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parameterList",{get:function(){return this._parameterList},set:function(t){this._parameterList=t},enumerable:!0,configurable:!0}),t.prototype.getUrlWithPath=function(t){var n=t;return n.endsWith("/")||(n+="/"),this.autocomplete?n+"autocomplete":n+"execute"},t.prototype.buildRequest=function(t){if(t!==this.url)return new Request(t,mr);var n,e=this.getUrlWithPath(t),r=this.parameterList.toString();try{var i=new URL(e+"/?"+r).toString();n=new Request(i,mr)}catch(t){throw new Error(t.message+": "+e+"/?"+r)}return n},t.prototype.handleStatus=function(t){if(!t.ok)throw new Error(t.statusText);return t},t.prototype.fetch=function(t){return void 0===t&&(t=this.url),yr(this,void 0,void 0,(function(){var n,e,r;return _r(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),n=this.buildRequest(t),[4,fetch(n)];case 1:return e=i.sent(),[4,this.handleStatus(e).json()];case 2:return[2,i.sent()];case 3:throw r=i.sent(),new Error(r);case 4:return[2]}}))}))},t}(),wr=function(){function t(){this.cssClasses=this.initDefaultClasses(),this.renderDidYouMean=ar}return t.prototype.initDefaultClasses=function(){return{wrapper:["smart-search-did-you-mean-wrapper"],element:["smart-search-did-you-mean-element"]}},t}(),br=function(){function t(){this.cssClasses=this.initDefaultClasses(),this.renderNext=ur,this.renderPage=ur,this.renderPrev=ur}return t.prototype.initDefaultClasses=function(){return{pagination:["smart-search-pagination"],nextButton:["smart-search-pagination-next"],prevButton:["smart-search-pagination-prev"],pageButton:["smart-search-pagination-page"],currentPage:["smart-search-pagination-current"]}},t}(),Sr=function(){function t(){this.cssClasses=this.initDefaultClasses(),this.templateFunction=sr}return t.prototype.initDefaultClasses=function(){return{wrapper:["smart-search-search-results"],element:["smart-search-search-result"]}},t}(),Er=function(){function t(t){this.page=t,this._didYouMeanTemplate=new wr,this._paginationTemplate=new br,this._searchResultTemplate=new Sr}return Object.defineProperty(t.prototype,"didYouMeanTemplate",{get:function(){return this._didYouMeanTemplate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paginationTemplate",{get:function(){return this._paginationTemplate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"searchResultTemplate",{get:function(){return this._searchResultTemplate},enumerable:!0,configurable:!0}),t.prototype.renderNextButton=function(t){if(void 0===t&&(t="Next"),!this.page.isStaticPagination(this.page.paginationParams))throw Error("Static pagination parameters are expected.");if(this.page.hasNext()){var n=this.page.paginationParams.pageNumber+1;return this.renderPaginationElement(this._paginationTemplate.cssClasses.nextButton,n,this._paginationTemplate.renderNext,t)}},t.prototype.renderNextButtonToHTMLElement=function(t,n){void 0===n&&(n="Next");var e=this.renderNextButton(n);e&&t.append(e)},t.prototype.renderPrevButton=function(t){if(void 0===t&&(t="Prev"),!this.page.isStaticPagination(this.page.paginationParams))throw Error("Static pagination parameters are expected.");if(this.page.hasPrev()){var n=this.page.paginationParams.pageNumber-1;return this.renderPaginationElement(this._paginationTemplate.cssClasses.prevButton,n,this._paginationTemplate.renderPrev,t)}},t.prototype.renderPrevButtonToHTMLElement=function(t,n){void 0===n&&(n="Prev");var e=this.renderPrevButton(n);e&&t.append(e)},t.prototype.renderPageButtons=function(t){if(!this.page.isStaticPagination(this.page.paginationParams))throw Error("Static pagination parameters are expected.");for(var n=this.page.paginationParams,e=Math.ceil(this.page.numberOfResults/n.pageSize),r=this.calculateFirstPageNumber(t,e),i=[],o=0;o<t;o++){var u=r+o,s=this.renderPaginationElement(this._paginationTemplate.cssClasses.pageButton,u,this._paginationTemplate.renderPage);if(i.push(s),r+o+1===e)break}var a=n.pageNumber;return this.highlightCurrentPage(i,a),i},t.prototype.calculateFirstPageNumber=function(t,n){var e=this.page.paginationParams.pageNumber,r=e-Math.floor(t/2);return Math.ceil(t/2)>n-e&&(r-=Math.ceil(t/2)-(n-e)),Math.max(0,r)},t.prototype.highlightCurrentPage=function(t,n){var e=this;t.filter((function(t){return t.getAttribute("smart-search-page-value")===n.toString()})).forEach((function(t){var n;return(n=t.classList).add.apply(n,e._paginationTemplate.cssClasses.currentPage)}))},t.prototype.renderPageButtonsToHTMLElement=function(t,n){t.append.apply(t,this.renderPageButtons(n))},t.prototype.renderPagination=function(t){var n,e=document.createElement("ul");return this.renderPrevButtonToHTMLElement(e),this.renderPageButtonsToHTMLElement(e,t),this.renderNextButtonToHTMLElement(e),(n=e.classList).add.apply(n,this._paginationTemplate.cssClasses.pagination),e},t.prototype.renderPaginationToHTMLElement=function(t,n){t.append(this.renderPagination(n))},t.prototype.renderPaginationElement=function(t,n,e,r){var i,o=document.createElement("li");return(i=o.classList).add.apply(i,t),o.setAttribute("smart-search-page-value",n.toString()),o.innerHTML=e(r||(n+1).toString()),o},t.prototype.renderSearchResults=function(){var t,n=this,e=this.page.searchResults.map((function(t){var e,r=document.createElement("div");return r.innerHTML=t.render(n._searchResultTemplate.templateFunction),(e=r.classList).add.apply(e,n._searchResultTemplate.cssClasses.element),r})),r=document.createElement("div");return(t=r.classList).add.apply(t,this._searchResultTemplate.cssClasses.wrapper),r.append.apply(r,e),r},t.prototype.renderSearchResultsToHTMLElement=function(t){t.appendChild(this.renderSearchResults())},t.prototype.renderDidYouMean=function(){var t,n=this;if(0===this.page.didYouMean.length)throw Error("There are no search query suggestions.");var e=this.page.didYouMean.map((function(t){return n._didYouMeanTemplate.renderDidYouMean(t)})),r=document.createElement("div");return(t=r.classList).add.apply(t,this._didYouMeanTemplate.cssClasses.wrapper),r.insertAdjacentHTML("afterbegin",e.join("")),Array.from(r.children).forEach((function(t){var e;return(e=t.classList).add.apply(e,n._didYouMeanTemplate.cssClasses.element)})),r},t.prototype.renderDidYouMeanToHTMLElement=function(t){t.appendChild(this.renderDidYouMean())},t}(),Pr=function(t,n,e,r){return new(e||(e=Promise))((function(i,o){function u(t){try{a(r.next(t))}catch(t){o(t)}}function s(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){var n;t.done?i(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(u,s)}a((r=r.apply(t,n||[])).next())}))},Ir=function(t,n){var e,r,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;u;)try{if(e=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=u.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=n.call(t,u)}catch(t){o=[6,t],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Or=function(){function t(t,n,e){var r,i,o;this.host=t,this.preparedSearch=n,this.options=e,this.apiEndpoint=(null===(r=e)||void 0===r?void 0:r.apiEndpoint)||"/v1/prepared_search";var u=""+this.host+this.apiEndpoint+"/"+this.preparedSearch+"/",s={};if(null===(i=e)||void 0===i?void 0:i.customParams){if(!Array.isArray(e.customParams))throw new Error("The customParams property must be an Array");s.customParams=e.customParams,this.customParameterList=e.customParams}this._searchClient=new gr(u,s);var a=null===(o=e)||void 0===o?void 0:o.autocompleteOptions,c=s;c.autocomplete=!0;var f=new gr(u,c);this._autocompleteWidget=new dr(f,a)}return Object.defineProperty(t.prototype,"searchClient",{get:function(){return this._searchClient},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autocompleteWidget",{get:function(){return this._autocompleteWidget},enumerable:!0,configurable:!0}),t.version=function(){return"1.4.1"},t.prototype.search=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return Pr(this,void 0,void 0,(function(){var e,r,i,o;return Ir(this,(function(u){switch(u.label){case 0:e=(o=this.searchClient.parameterList.addOrUpdateSearchTerm(t)).add.apply(o,n),this.searchClient.parameterList=e,u.label=1;case 1:return u.trys.push([1,3,,4]),[4,this.searchClient.fetch()];case 2:return r=u.sent(),this.searchClient.parameterList=e.delete.apply(e,n),[2,new ir(this.searchClient,r)];case 3:throw i=u.sent(),this.searchClient.parameterList=e.delete.apply(e,n),new Error(i);case 4:return[2]}}))}))},t.prototype.setCustomParams=function(){for(var t,n,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.searchClient.parameterList=(t=(n=this.searchClient.parameterList).delete.apply(n,this.customParameterList||[])).add.apply(t,e),this.customParameterList=e},t.prototype.deleteCustomParams=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=this.searchClient.parameterList.list.filter((function(n){return!t.includes(Object.keys(n)[0])}));this.searchClient.parameterList=new Ze(Vn(e))},t.prototype.mapPages=function(t,n,e){var r=t.groups.find((function(t){return t.name===n}));if(void 0===r)throw Error("Searched group not found!");var i=new Map,o=this.searchClient.parameterList.addOrUpdateSearchTerm(e);this.searchClient.parameterList=o;for(var u=0,s=r.groups;u<s.length;u++){var a=s[u],c=JSON.parse(JSON.stringify(t));c.results=a.results,c.numRows=a.numRows;var f=new ir(this.searchClient,c);i.set(a.value,f)}return i},t.prototype.searchWithGroup=function(t,n,e){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return Pr(this,void 0,void 0,(function(){var i,o,u,s,a,c;return Ir(this,(function(f){switch(f.label){case 0:i=[{query:t},{grouping:"on"},{groupField:n},{groupLimit:e.toString()}],o=(a=(c=this.searchClient.parameterList).addOrUpdate.apply(c,i)).add.apply(a,r),this.searchClient.parameterList=o,f.label=1;case 1:return f.trys.push([1,3,,4]),[4,this.searchClient.fetch()];case 2:return u=f.sent(),this.searchClient.parameterList=o.delete.apply(o,r),[2,this.mapPages(u,n,t)];case 3:throw s=f.sent(),this.searchClient.parameterList=o.delete.apply(o,r),new Error(s);case 4:return[2]}}))}))},t.prototype.fetchAutocompleteList=function(t,n){return this.autocompleteWidget.getAutocompleteList(t,n)},t.prototype.attachAutocompleteWidget=function(t,n){this.autocompleteWidget.initializeAndAttach(t,n)},t.prototype.getPageRenderer=function(t){return new Er(t)},t}();e.d(n,"SmartSearch",(function(){return Or})),e.d(n,"Page",(function(){return ir})),e.d(n,"Facet",(function(){return u})),e.d(n,"SearchResult",(function(){return r})),e.d(n,"PageRenderer",(function(){return Er}))}])}));