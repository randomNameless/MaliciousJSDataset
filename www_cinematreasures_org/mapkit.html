<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mapkit.html</title>
</head>
<body>

<script>
/*! Copyright Â© Apple Inc. All rights reserved. See LICENSE for additional license information. */
(()=>{"use strict";var t={d:(e,i)=>{for(var n in i)t.o(i,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:i[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{APPLICATION_IDENTIFIER:()=>Nt,BROWSER_INFO:()=>zt,BROWSER_WINDOW_SIZE:()=>Ft,DEVICE_IDENTIFIER:()=>Rt,MAP_VIEW:()=>Gt,SCREEN_SIZE:()=>It,TILES:()=>Zt,URL:()=>Ut,USER_SESSION:()=>Bt});const i={version:"5.78.158",build:"24.45-703",cdnBase:"//cdn.apple-mapkit.com",cdnVersion:"5.78.158"},n=27,o=32,s=37,a=38,r=39,l=40,h=()=>{},c=(t,e)=>t-e*Math.floor(t/e),d=t=>Math.log2(t),u=(t,e,i)=>Math.max(e,Math.min(t,i)),p=(t,e,i)=>{const n={constructor:{enumerable:!0,value:e}};return Object.keys(i).forEach((function(t){const e=Object.getOwnPropertyDescriptor(i,t);e&&(n[t]=e)})),Object.create(t.prototype,n)},m=(t,e)=>Object.keys(e).some((i=>e[i]===t)),g=(t,e,i)=>{if(void 0===t||(i?.checkNull??!0)&&null===t)throw new Error(e||"Missing parameter")},_=(t,e,i)=>{if(typeof t!==e)throw new TypeError(i||`Expected \`${e}\` but got \`${typeof t}\``);if("number"===e&&isNaN(t))throw new TypeError(i||`Expected \`${e}\` but got \`NaN\``);if("object"===e&&t instanceof Array)throw new TypeError(i||"Expected a non-array object but got an array")},f=(t,e,i)=>{if(!(t instanceof e))throw new Error(i||"Unexpected object instance")},y=(t,e)=>{if(!Array.isArray(t))throw new Error(e||"Expected an array")},v=(t,e)=>null==t?{}:(_(t,"object",e||"[MapKit] The `options` parameter is not a valid object."),t),w=(t,e,i)=>t.replace(/{{(.*?)}}/g,((t,n)=>{const o=e[n];if(i&&null==o)throw new Error("fillTemplate: Missing value for parameter: "+n);return o??""})),b=(t,e)=>{if(null===t||"object"!=typeof t)return"";const i=[];for(const n of e||Object.keys(t)){const e=t[n];e&&i.push(`${encodeURIComponent(n)}=${encodeURIComponent(e)}`)}return i.join("&")},C=()=>Math.floor(1e15*(9*Math.random()+1));class k{constructor(t,e,i){var n;this.language=t.toLowerCase(),this.region=e?e.toUpperCase():null,this.script=i?(n=i)?n[0].toUpperCase()+n.substr(1).toLowerCase():n:null}get tag(){return this.region?`${this.language}-${this.region}`:this.script?`${this.language}-${this.script}`:this.language}toString(){return`{ ${`language: ${this.language}`}${this.region?`, region: ${this.region}`:""}${this.script?`, script: ${this.script}`:""} }`}static parse(t){let e,i;if(t&&"string"==typeof t){if(-1!==t.indexOf("_"))return console.warn("Invalid character: '_'"),null;const n=t.split("-"),o=n[0];if(o.length<2||o.length>4)return console.warn("Invalid language:",t),null;if(!(n.length<4))return console.warn("Don't know how to parse language tags with more than 3 parts:",t),null;for(let o=1;o<n.length;o+=1){const s=n[o];if(4===s.length)i=s;else{if(!(s.length>1&&s.length<4))return console.warn("Don't know how to parse:",t),null;e=s}}return new k(o,e,i)}return null}}const M=(t,e)=>{if(!t)return;const{language:i,region:n,script:o}=t;e[i]=e[i]||{regions:[],scripts:[]},n&&e[i].regions.push(n),o&&e[i].scripts.push(o)};const S={zh:{CN:"Hans",HK:"Hant",TW:"Hant"}},L={"en-AU":"en-GB","en-IE":"en-GB","en-IN":"en-GB","en-NZ":"en-GB","en-SG":"en-GB","en-ZA":"en-GB","es-LA":"es-MX","es-XL":"es-MX","nn-NO":"nb-NO","no-NO":"nb-NO","vi-VI":"vi-VN",iw:"he-IL"},A=new class{constructor(t){this.supportMap={},this.delegate=t;for(const t of this.delegate.supportedLocales)M(k.parse(t),this.supportMap)}bestMatch(t,e){let i=k.parse(t),n=null;if(i&&this.delegate.localesMap){const t=this.delegate.localesMap;t[i.tag]?i=k.parse(t[i.tag]):t[i.language]&&(i=k.parse(t[i.language]))}return e=e||null,i&&(n=((t,e,i)=>{const{language:n,region:o,script:s}=t;let a=s;const r=i[n];if(!r)return null;if(o){const i=r.regions.find((e=>e.toUpperCase()===t.region?.toUpperCase()));if(i)return new k(n,i);const s=e[n];s&&s[o.toUpperCase()]&&(t.script=a=s[o.toUpperCase()])}if(a){const e=r.scripts.find((e=>e.toUpperCase()===t.script?.toUpperCase()));return new k(n,null,e)}return new k(n)})(i,this.delegate.regionToScriptMap,this.supportMap)),n?n.tag:e}}({supportedLocales:["ar","ca","cs","da","de","el","en","en-AU","en-GB","es","es-MX","es-US","fi","fr","fr-CA","he","hi","hr","hu","id","it","ja","ko","ms","nb","nl","pl","pt","pt-PT","ro","ru","sk","sl","sv","th","tr","uk","vi","zh-Hans","zh-Hant","zh-HK"],regionToScriptMap:S,localesMap:L});function E(t){if(t)return t.addEventListener=E.prototype.addEventListener,t.removeEventListener=E.prototype.removeEventListener,t.dispatchEvent=E.prototype.dispatchEvent,t}E.prototype._listeners=void 0,E.prototype.addEventListener=function(t,e,i){i=i??null,this._listeners||(this._listeners={});const n=this._listeners[t]??[];this._listeners[t]=n;for(const{listener:t,thisObject:o}of n)if(t===e&&o===i)return!1;return n.push({thisObject:i,listener:e}),!0},E.prototype.removeEventListener=function(t,e,i){if(i=i??null,!this._listeners)return!1;if("string"!=typeof t){for(const t in this._listeners)this.removeEventListener(t,e,i);return!1}const n=this._listeners[t];if(!n)return!1;const o=n.findIndex((({listener:t,thisObject:n})=>e===t&&i===n||!e&&i&&i===n));return o>-1&&n.splice(o,1),0===n.length&&delete this._listeners[t],o>-1},E.prototype.dispatchEvent=function(t){if(t.target=this,!this._listeners)return!0;const e=this._listeners[t.type];if(!e||t._stoppedPropagation)return!0;const i=e.slice(0);for(const{listener:e,thisObject:n}of i)if("function"==typeof e?e.call(n,t):n||e.handleEvent.call(e,t),t._stoppedPropagation)break;return!t.defaultPrevented};const x={EventTarget:E,Event:class{constructor(t){this.target=null,this.type=t,this.defaultPrevented=!1,this._stoppedPropagation=!1}stopPropagation(){this._stoppedPropagation=!0}preventDefault(){this.defaultPrevented=!0}}},T={EventTarget:x.EventTarget,Event:x.Event},I={Libraries:[],Events:{LOAD:"load",LOADEND:"loadend",LOAD_ERROR:"load-error"},jsModules:{mapkit:{}},_chunkLoaded:function(t,e){Object.keys(t).forEach((e=>{"mapkit"!==e?this.jsModules[e]=t[e]:Object.keys(t.mapkit).forEach((e=>{this.jsModules.mapkit[e]=t.mapkit[e]}))}));const i=new T.Event(this.Events.LOAD);i.jsModules=t,this.dispatchEvent(i),e&&e()},_dispatchLoadEndEvent:function(t){const e=new T.Event(this.Events.LOADEND);e.libraryNames=t,this.dispatchEvent(e)}};T.EventTarget(I);const R=I;class O{constructor(){this.loggers=[]}appendLogger(t){this.loggers.push(t)}_invoke(t,e){if(this.loggers.length)for(const i of this.loggers)i[t]&&i[t].apply(i,e);else"error"!==t&&"warn"!==t||console[t].apply(console,e)}error(){this._invoke("error",Array.from(arguments))}warn(){this._invoke("warn",Array.from(arguments))}log(){this._invoke("log",Array.from(arguments))}info(){this._invoke("info",Array.from(arguments))}debug(){this._invoke("debug",Array.from(arguments))}}const P=new O;O.sharedLogger=P;const D=function(t){return String.fromCharCode.apply(String,t.split("").map((t=>(t.codePointAt(0)+242)%255)))},z=Symbol(),N=Object.freeze({Highest:0,High:1,Medium:2,Low:3}),F={[N.Highest]:12,[N.High]:12,[N.Medium]:4,[N.Low]:1},U={[N.Highest]:[],[N.High]:[],[N.Medium]:[],[N.Low]:[]},G={[N.Highest]:0,[N.High]:0,[N.Medium]:0,[N.Low]:0},B=()=>{for(const t of Object.values(N)){if(U[t].length>0){const e=F[t];return G[t]===e?null:U[t][0]}if(G[t]>0)return null}return null},Z=()=>{for(const t of Object.values(N))if(U[t].length>0)return U[t].shift(),!0;return!1},W=t=>{for(const e of Object.values(N)){const i=U[e].indexOf(t);if(-1!==i)return U[e].splice(i,1),!0}return!1},K=()=>{let t=B();for(;t;)G[t.priority]+=1,Z(),t._loaderWillStart.call(t),t=B()},H=t=>{U[t.priority].push(t),K()},j=t=>W(t),V=t=>{G[t.priority]-=1,K()},q=((()=>{if(/iP(hone|od|ad)/.test(navigator.platform)){const t=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(t?.[1]??"0",10),parseInt(t?.[2]??"0",10),parseInt(t?.[3]??"0",10)]}})(),(t,e)=>{if(!Y(t))throw new Error(e||"Expected an Element")}),Y=t=>t instanceof window.Node&&t.nodeType===window.Node.ELEMENT_NODE,X=(window.XMLHttpRequest,t=>{const e=new window.XMLHttpRequest;return e.addEventListener("load",t),e.addEventListener("error",t),e.addEventListener("timeout",t),e}),$=()=>document.createElement("canvas"),J=Object.freeze({Unscheduled:0,Waiting:1,Loading:2,Canceled:3,Succeeded:4,Failed:5});Object.freeze(Object.values(J));const Q=class{constructor(t,e){this._state=J.Unscheduled,this._retries=0,this._unscheduled=!1,this._delay=null,this._timeoutId=void 0,this.priority=t,this._delegate=e,this._init(t,e)}_getDelegate(){return this._delegate}_isUnscheduled(){return this._unscheduled}get state(){return this._state}schedule(){this._state===J.Unscheduled&&(this._state=J.Waiting,H(this))}unschedule(){let t=!1;if(this._state===J.Waiting)t=j(this);else{if(this._state!==J.Loading)return!1;V(this),t=!0}return this._unscheduled=t,this._state=J.Canceled,"function"==typeof this._delegate.loaderDidCancel&&this._delegate.loaderDidCancel(this),this._reset(),t}_loaderWillStart(){this._state=J.Loading,"function"==typeof this._delegate.loaderWillStart&&this._delegate.loaderWillStart(this)}_loaderDidSucceed(t){this._state=J.Succeeded,V(this),"function"==typeof this._delegate.loaderDidSucceed&&this._delegate.loaderDidSucceed(this,t),this._reset()}_loaderDidFail(t){this._state=J.Failed,V(this),"function"==typeof this._delegate.loaderDidFail&&this._delegate.loaderDidFail(this,t),this._reset()}_init(t,e){this.priority=t,this._state=J.Unscheduled,this._delegate=e,this._retries=0,this._timeoutId=void 0,this._delay=null,this._unscheduled=!1}_reload(t){if(this._retries++,this._retries<3){const t=this._delay??1e4;this._timeoutId=setTimeout((()=>this._loaderWillStart()),t)}else this._loaderDidFail(t)}_reset(){clearTimeout(this._timeoutId)}};const tt=class extends Q{constructor(t,e,i){super(i?.priority??N.Highest,e),this._origin=null,this._headers=i?.headers??null,this._xhr=null,this._xhrData=void 0,this._method=i?.method??"GET",this._retry=i?.retry??!1,this._timeout=i?.timeout??0,this._withCredentials=i?.withCredentials??!1,this._url=t,this._delay=i?.delay??null}get xhr(){return this._xhr}get url(){return this._url}get xhrData(){return this._xhrData}unschedule(){return this._xhr?.abort(),super.unschedule()}_loaderWillStart(){if(super._loaderWillStart(),this._xhr=X(this),this._xhr.open(this._method,this.url,!0),this._xhr.timeout=this._timeout,this._xhr.withCredentials=this._withCredentials,this._origin&&(this._xhr.setDisableHeaderCheck(!0),this._xhr.setRequestHeader("Origin",this._origin)),this._headers)for(const[t,e]of Object.entries(this._headers))this._xhr.setRequestHeader(t,e);if("POST"===this._method&&!this._xhrData){const t=this._getDelegate();if(this._xhrData=t.getDataToSend?.(this._xhr),!this._xhrData)return}this._xhr.send(this._xhrData)}handleEvent(t){const e=t.target,i=t.type;if("error"===i||"timeout"===i||200!==e.status)this._retry?this._reload(e):this._loaderDidFail(e);else if("load"===i)this._loaderDidSucceed(e);else{const t=e.status??-1;console.log(`Unhandled XHR event type: ${i} status: ${t}`)}}},et="function"==typeof ErrorEvent,it=function(t,e,i,n){if(!et)return t.apply(e,i);try{return t.apply(e,i)}catch(t){console.error(t);const e=new ErrorEvent("error",{message:t instanceof Error?t.message:t instanceof Object?t.toString():"(Unknown error)",filename:t instanceof Error?t.fileName||t.stack:"(Unknown filename)",lineno:t instanceof Error?t.lineNumber:void 0,colno:t instanceof Error?t.columnNumber:void 0,error:t});return window.dispatchEvent(e),n}},nt=t=>Promise.all(t.map((t=>fetch(t,{mode:"no-cors",credentials:"include"})))).then((()=>{}));F[N.Highest]*=10,F[N.High]*=10,F[N.Medium]*=10,F[N.Low]*=10;const ot="https:",st="https://cdn.apple-mapkit.com/ma/bootstrap",at="2",rt=3e4,lt={OK:200,MULTIPLE_CHOICES:300,BAD_REQUEST:400,UNAUTHORIZED:401,TOO_MANY_REQUESTS:429},ht=["language","countryCode","madabaBaseUrl","authorizationCallback","libraries","logger","_showMapsLogo","_showLegalLink","bootstrapTimeout","_shadowDOMMode","_showsTileInfo","_distUrl","_syrupUrl","_uiBaseUrl","_teamId","_previewLoCSR","_forcedRenderingMode","_proxyPrefixes","_shouldLogin","_disableWebGLCheck"],ct="R`ha\\aHe_";ht.push(ct);const dt={READY:0,PENDING:1,ERROR:2,UNINITIALIZED:3},ut={Initialized:"Initialized",Refreshed:"Refreshed"},pt=Object.freeze({BadRequest:"Bad Request",Unauthorized:"Unauthorized",TooManyRequests:"Too Many Requests",MalformedResponse:"Malformed Response",Timeout:"Timeout",NetworkError:"Network Error",Unknown:"Unknown"}),mt="Bearer {{token}}",gt={Apple:"Apple",AutoNavi:"AutoNavi"};let _t=!1;const ft=new WeakMap,yt=window.location.hostname;class vt{constructor(t){this.bootstrap=t,this.countryCode=null}setForcedCountryCode(t){return!t||yt.endsWith(".apple.com")||yt.endsWith(".autonavi.com")||console.error("[MapKit] Not allowed."),this.setForcedCountryCodeUnrestricted(t)}setForcedCountryCodeUnrestricted(t){t!==this.countryCode&&(t&&(_(t,"string","[MapKit] `countryCode` must be a string or `null`."),t=t.toUpperCase()),this.countryCode=t,t&&this.bootstrap._setLocaleWithCountryCode&&(delete this.bootstrap._setLocaleWithCountryCode,this.bootstrap.language="zh-"+this.countryCode),this.bootstrap.ready&&this.bootstrap._loadFromServer())}}function wt(){this._jwtTokensToCheck=[],this.componentVersions={},this.performanceMarkers={},this.language=null,ft.set(this,new vt(this))}wt.ChangeStatus=ut,wt.PROTOCOL=ot,wt.TileProviders=gt,wt.prototype=p(T.EventTarget,wt,{_c(t){if(t!==z)throw new Error("Invalid key.");return ft.get(this)},HTTP:lt,ErrorStatus:pt,TileProviders:gt,Events:{Initialized:"configuration-init",Changed:"configuration-change",Error:"error"},States:dt,state:dt.UNINITIALIZED,enableSourceMap:!1,authorizationCallback:null,tileProvider:null,_showMapsLogo:!0,_showLegalLink:!0,shadowDOMMode:void 0,_madabaBaseUrl:null,customMadabaUrl:!1,_madabaDomains:null,_accessKey:null,_accessToken:null,_distUrl:null,_syrupUrl:null,apiBaseUrl:null,apiBaseUrlOverride:null,types:{},_bootstrapRequestParams:null,_showsTileInfo:!1,_messagePrefix:"[MapKit] ",nonce:"",scriptBaseUrl:null,get distUrl(){return this._distUrl},isDistUrlTrusted(){if(!this._distUrl)return!1;const t=new URL(this._distUrl,window.location.href);if(window.location.origin&&t.origin===window.location.origin)return!0;if(this.scriptBaseUrl){const e=new URL(this.scriptBaseUrl,window.location.href);if(e.origin&&t.origin===e.origin)return!0}return!1},get buildTags(){let t="";return Object.keys(this.componentVersions).forEach((e=>t+=" ("+e+": "+this.componentVersions[e]+")")),t},get _initMessagePrefix(){return this._messagePrefix+"mapkit.init(): "},get proxyPrefixes(){return this._proxyPrefixes},isProxyPrefixTrusted(){if(!this._proxyPrefixes)return!1;const t=new URL(this._proxyPrefixes[0],window.location.href);if(window.location.origin&&t.origin===window.location.origin)return!0;if(this.scriptBaseUrl){const e=new URL(this.scriptBaseUrl,window.location.href);if(e.origin&&t.origin===e.origin)return!0}return!1},get withCredentials(){return this.proxyPrefixes&&this.urlWithCredentials(this.proxyPrefixes[0])},get distUrlWithCredentials(){return this._distUrl?this.urlWithCredentials(this._distUrl):!i.useLocalResources&&this.withCredentials},urlWithCredentials:function(t){return/\bproxy\b.*\.geo\.apple\.com\b/.test(t)},get loginPromise(){return this._loginPromise||(this.withCredentials&&this._shouldLogin?this._loginPromise=nt(this.proxyPrefixes):this._loginPromise=Promise.resolve()),this._loginPromise},init:function(t,e){_t&&performance.mark("mapkit-init-start"),g(t,this._initMessagePrefix+"`options` object is required.",{checkNull:!0}),_(t,"object",this._initMessagePrefix+"`options` object is invalid.");const i={};if(t.logger&&P.appendLogger(t.logger),Object.keys(t).forEach((t=>{const e=-1!==ht.indexOf(D(t));e||-1!==ht.indexOf(t)||console.warn(this._initMessagePrefix+"ignoring invalid option: `"+t+"`."),e&&(i[D(t)]=t)})),e||this.authorizationCallback&&void 0===t.authorizationCallback||(g(t.authorizationCallback,this._initMessagePrefix+"`options` is missing `authorizationCallback`.",{checkNull:!0}),_(t.authorizationCallback,"function",this._initMessagePrefix+"`authorizationCallback` in `options` must be a function.")),t.language&&_(t.language,"string",this._initMessagePrefix+"`language` in `options` must be a string."),this._userInitializedInit)return void console.warn(this._initMessagePrefix+"already initialized; ignoring.");e||(this._userInitializedInit=!0),void 0!==t._previewLoCSR&&t._previewLoCSR&&(this._forcedRenderingMode="HYBRID"),void 0!==t._forcedRenderingMode&&(this._forcedRenderingMode=t._forcedRenderingMode),void 0!==t._proxyPrefixes&&Array.isArray(t._proxyPrefixes)&&(this._proxyPrefixes=t._proxyPrefixes),void 0!==t._distUrl&&(this._distUrl=t._distUrl),void 0!==t._syrupUrl&&(this._syrupUrl=t._syrupUrl),this._shouldLogin=this.withCredentials,void 0===t._shouldLogin||t._shouldLogin||(this._shouldLogin=!!t._shouldLogin),i[ct]&&void 0!==t[i[ct]]&&(this[ct]=t[i[ct]]);const n=(this.state===dt.UNINITIALIZED||this.state===dt.ERROR)&&t.authorizationCallback;n&&(this.state=dt.PENDING),t.authorizationCallback&&(this.authorizationCallback=t.authorizationCallback),void 0!==t.countryCode&&null===ft.get(this).countryCode&&ft.get(this).setForcedCountryCodeUnrestricted(t.countryCode),void 0!==t.language?this.language=t.language:this._l10n&&(this._l10n.localeId=this.language),void 0!==t._showMapsLogo&&(this._showMapsLogo=!!t._showMapsLogo),void 0!==t._showLegalLink&&(this._showLegalLink=!!t._showLegalLink),void 0!==t._shadowDOMMode&&(this.shadowDOMMode=t._shadowDOMMode),t.bootstrapTimeout&&(this._bootstrapTimeout=t.bootstrapTimeout),t.madabaBaseUrl&&(this._madabaBaseUrl=t.madabaBaseUrl,this.customMadabaUrl=!0),t._uiBaseUrl&&(this.uiBaseUrl=t._uiBaseUrl,this.customUiBaseUrl=!0),t._showsTileInfo&&(this._showsTileInfo=t._showsTileInfo),t._teamId&&(this.analyticsTeamId=t._teamId),void 0!==t._disableWebGLCheck&&(this._disableWebGLCheck=t._disableWebGLCheck),n&&(this.withCredentials&&this._shouldLogin?this.loginPromise.then((()=>{this._loadFromServer()}),(()=>{this._loadFailed(pt.NetworkError,"Initialization failed because of network error connecting to proxy.")})):this._loadFromServer()),t.libraries;const o=new T.Event(this.Events.Initialized);this.dispatchEvent(o)},login(){this.withCredentials&&(t=>{if(0===t.length)return Promise.resolve();const e=window.open(t[0].replace(/\/proxy\?$/,"/login"),"_blank","popup=yes,width=700,height=700");return new Promise(((t,i)=>{e||i();const n=o=>{o.source===e&&(window.removeEventListener("message",n),o.data&&o.data.login?t(void 0):i())};window.addEventListener("message",n)})).then((()=>{if(1===t.length)return;const e=[].concat(t);return e.shift(),nt(e)}))})(this.proxyPrefixes).then((()=>{this.reloadFromServer()}),(()=>console.error("[MapKit] There is a problem triggering login popup.")))},reloadFromServer:function(){this._loadFromServer()},get accessKey(){return this._accessKey},get accessToken(){return this._accessToken},accessKeyMayBeExpired(){Date.now()>this.expiresAt&&this.accessKeyHasExpired()},accessKeyHasExpired:function(){this._loadFromServer(N.Highest)},get ready(){return this.state===dt.READY},get error(){return this.state===dt.ERROR},_language:void 0,get language(){return this._language},set language(t){t!==this._language&&(delete this._setLocaleWithCountryCode,t?(_(t,"string","[MapKit] `language` must be a string or `null`."),"zh"===t.toLowerCase()&&(console.warn("[MapKit] `zh` is an ambiguous language ID. Please specify a script or reginal variant: `zh-Hans`, `zh-Hant`, or `zh-HK`."),ft.get(this).countryCode?t="zh-"+ft.get(this).countryCode:this._setLocaleWithCountryCode=!0)):t=this._getClientLanguage(),this._language=A.bestMatch(t,"en"),this.state!==dt.UNINITIALIZED&&this._l10n&&(this._l10n.localeId=t))},get countryCode(){return ft.get(this).countryCode},get isAutoNavi(){return this.tileProvider===gt.AutoNavi||this.state===dt.PENDING&&"CN"===ft.get(this).countryCode},appendAuthOptions:function(t,e){return(e||this.accessToken&&!this.isAutoNavi)&&(t.headers=t.headers||{},t.headers.Authorization=w(mt,{token:e||this.accessToken})),t},setL10n:function(t){this._l10n=t,this.state!==dt.UNINITIALIZED&&(this._l10n.localeId=this.language)},setPerformanceMarkers(t){if(!t)return;const e=t.split(",").map((t=>t.trim()));for(const t of e)this.performanceMarkers[t]=!0;_t=this.performanceMarkers.loading},handleEvent(t){switch(t.type){case"visibilitychange":"visible"===document.visibilityState&&this.ready&&this.accessKeyMayBeExpired();break;case"online":this.ready?this.accessKeyMayBeExpired():this.error&&this.reloadFromServer()}},loaderWillStart:function(t){this._xhrLoader===t&&(this.state=dt.PENDING)},loaderDidSucceed:function(t,e){this._xhrLoader===t&&(this._requestDidLoad(e),_t&&this.state===dt.PENDING&&performance.measure("mapkit-init","mapkit-init-start"),this._xhrLoader=void 0)},loaderDidFail:function(t,e){this._xhrLoader===t&&(this._parseError(t._xhr),this._xhrLoader=void 0)},_loadFromServer:function(t){this._bootstrapRequestParams={apiVersion:at,countryCode:ft.get(this).countryCode,mkjsVersion:i.version,poi:"1"};let e=st+"?"+b(this._bootstrapRequestParams);this.proxyPrefixes&&(e=this.proxyPrefixes[0]+e);const n={retry:!0,delay:0,priority:t,timeout:this._bootstrapTimeout,withCredentials:this.withCredentials};this.withCredentials&&/\bapple\.com\b/.test(this.proxyPrefixes[0])&&!/\bapple\.com$/.test(window.location.hostname)&&console.warn("[MapKit] Request with credentials may fail if the page is not hosted on the same domain as the proxy."),it(this.authorizationCallback,null,[t=>{t&&(this._checkJwtToken?this._checkJwtToken(t):this._jwtTokensToCheck.push(t)),this.appendAuthOptions(n,t),this.accessToken&&(n.headers["X-Maps-Access-Token"]=w(mt,{token:this.accessToken}));const i=new tt(e,this,n);this._xhrLoader&&this._xhrLoader.unschedule(),i.schedule(),this._xhrLoader=i}])},_requestDidLoad:function(t){const e=t.getResponseHeader("x-rid");if(!this._parseError(t,e))try{const i=JSON.parse(t.responseText);this._processLoadedData(i,e)}catch(t){if("SyntaxError"!==t.name)throw t;this._loadFailed(pt.MalformedResponse,"Initialization failed because of incorrect server response.")}},_resetReloadTimer:function(t){clearTimeout(this._reloadTimerId),this._reloadTimerId=setTimeout((()=>{delete this._reloadTimerId,this.accessKeyHasExpired()}),t)},_loadSucceeded:function(t,e){setTimeout((()=>{this.state=dt.READY;const i=new T.Event(this.Events.Changed);i.status=t?ut.Refreshed:ut.Initialized,i.responseIdentifier=e,this.dispatchEvent(i)}),0)},_loadFailed:function(t,e,i){console.error(this._messagePrefix+e),setTimeout((()=>{this.state=dt.ERROR,clearTimeout(this._reloadTimerId),delete this._reloadTimerId,this.expiresInSeconds=void 0,this.expiresAt=void 0,this.expiresIn=void 0;const n=new T.Event(this.Events.Error);n.status=t,n.message=this._messagePrefix+e,n.responseIdentifier=i,this.dispatchEvent(n)}),0)},_processLoadedData:function(t,e){const i=!!this._accessToken;this._parseData(t),this.expiresInSeconds&&this._resetReloadTimer(this.expiresIn),ft.get(this).countryCode&&this._setLocaleWithCountryCode&&(delete this._setLocaleWithCountryCode,this.language="zh-"+ft.get(this).countryCode),document.addEventListener("visibilitychange",this),window.addEventListener("online",this),this._loadSucceeded(i,e)},_parseData:function(t){let e;if(t.apiBaseUrl,ft.get(this).countryCode="unknown"!==t.countryCode?t.countryCode:null,ft.get(this).countryCode&&"zh"===this.language&&(this.language="zh-"+ft.get(this).countryCode),this.environment=t.environment,this.apiBaseUrl=this.apiBaseUrlOverride||t.apiBaseUrl,this.proxyPrefixes&&(e=this.proxyPrefixes[this.proxyPrefixes.length-1],this.apiBaseUrl=e+this.apiBaseUrl),t.analytics){const i=t.analytics;this.proxyPrefixes&&(i.analyticsUrl=e+i.analyticsUrl,i.errorUrl=e+i.errorUrl),this.analytics=i}t.authInfo&&t.authInfo.team_id&&(this.teamId=t.authInfo.team_id),t.locationShiftUrl&&(this.proxyPrefixes?this.locationShiftUrl=e+t.locationShiftUrl:this.locationShiftUrl=t.locationShiftUrl),this.expiresInSeconds=t.expiresInSeconds,this.expiresIn=1e3*this.expiresInSeconds-rt,this.expiresAt=Date.now()+this.expiresIn;const i=t.tileSources.some((t=>t.needsLocationShift));t.accessKey&&(this._accessKey=t.accessKey),t.authInfo&&t.authInfo.access_token&&(this._accessToken=t.authInfo.access_token),this.tileProvider=i?wt.TileProviders.AutoNavi:wt.TileProviders.Apple,this._data=t,this.customUiBaseUrl||(this.uiBaseUrl=t.uiBaseUrl),this._parseMapData&&this._parseMapData()},_parseError:function(t,e){const i=t.status;let n,o;if(i>=lt.OK&&i<lt.MULTIPLE_CHOICES)return!1;if(this._userInitializedInit=!1,t.readyState!==t.DONE)o=pt.Timeout,n="Initialization failed because the request timed out after "+this._bootstrapTimeout+" ms.";else if(i===lt.UNAUTHORIZED){o=pt.Unauthorized,n="Initialization failed because the authorization token is invalid.";try{const e=JSON.parse(t.responseText);e.error&&e.error.details&&Array.isArray(e.error.details)&&e.error.details.forEach((function(t){t&&"ORIGIN_CHECK_FAILURE"===t.errorType&&t.message&&(n+=" "+t.message)}))}catch(t){if("SyntaxError"!==t.name)throw t}}else i===lt.TOO_MANY_REQUESTS?(o=pt.TooManyRequests,n="Initialization failed because the daily usage limit has exceeded."):0===i?(o=pt.NetworkError,n="Initialization failed because of network error."):(o=pt.Unknown,n="Initialization failed because the server returned error "+i+" ("+t.statusText+").");return this._loadFailed(o,n,e),!0},_getClientLanguage:function(){return window.navigator.languages?window.navigator.languages[0]:window.navigator.language},_restore:function(){this._syrupUrl&&console.warn("[MapKit] mapkit.restore() cannot unset _syrupUrl."),this[ct]&&console.warn("[MapKit] mapkit.restore() cannot unset R`ha\\aHe_"),delete this._proxyPrefixes,delete this._forcedRenderingMode,delete this._userInitializedInit,delete this._loginPromise,delete this._readyPromise,delete this._readyPromiseResolve,this._distUrl=null,this.authorizationCallback=null,this.apiBaseUrl=null,this.apiBaseUrlOverride=null,this.state=dt.UNINITIALIZED,this._listeners={},clearTimeout(this._reloadTimerId),delete this._reloadTimerId,document.removeEventListener("visibilitychange",this),window.removeEventListener("online",this)},_debugInfo:function(){const t={};return["ready","state","_countryCode","tileProvider","apiBaseUrl","language","_getClientLanguage","types"].forEach((function(e){t[e]="function"==typeof this[e]?this[e]():this[e]}),this),t}});const bt=wt;function Ct(){bt.call(this)}Ct.prototype=Object.create(bt.prototype),Object.defineProperty(Ct.prototype,"constructor",{enumerable:!0,writable:!0,value:Ct});const kt=new Ct;function Mt(){}Mt.prototype=Object.create(x.EventTarget.prototype),Mt.prototype.dispatchEvent=function(t){return it(x.EventTarget.prototype.dispatchEvent,this,[t],!0)};const St={EventTarget:Mt,Event:x.Event},Lt={Airport:"Airport",AirportGate:"AirportGate",AirportTerminal:"AirportTerminal",AmusementPark:"AmusementPark",AnimalService:"AnimalService",Aquarium:"Aquarium",ATM:"ATM",AutomotiveRepair:"AutomotiveRepair",Bakery:"Bakery",Bank:"Bank",Baseball:"Baseball",Basketball:"Basketball",Beach:"Beach",Beauty:"Beauty",Bowling:"Bowling",Brewery:"Brewery",Cafe:"Cafe",Campground:"Campground",CarRental:"CarRental",Castle:"Castle",ConventionCenter:"ConventionCenter",Distillery:"Distillery",EVCharger:"EVCharger",Fairground:"Fairground",FireStation:"FireStation",Fishing:"Fishing",FitnessCenter:"FitnessCenter",FoodMarket:"FoodMarket",Fortress:"Fortress",GasStation:"GasStation",GoKart:"GoKart",Golf:"Golf",Hiking:"Hiking",Hospital:"Hospital",Hotel:"Hotel",Kayaking:"Kayaking",Landmark:"Landmark",Laundry:"Laundry",Library:"Library",Mailbox:"Mailbox",Marina:"Marina",MiniGolf:"MiniGolf",MovieTheater:"MovieTheater",Museum:"Museum",MusicVenue:"MusicVenue",NationalMonument:"NationalMonument",NationalPark:"NationalPark",Nightlife:"Nightlife",Park:"Park",Parking:"Parking",Pharmacy:"Pharmacy",Planetarium:"Planetarium",Playground:"Playground",Police:"Police",PostOffice:"PostOffice",PublicTransport:"PublicTransport",ReligiousSite:"ReligiousSite",Restaurant:"Restaurant",Restroom:"Restroom",RockClimbing:"RockClimbing",RVPark:"RVPark",School:"School",SkatePark:"SkatePark",Skating:"Skating",Skiing:"Skiing",Soccer:"Soccer",Spa:"Spa",Stadium:"Stadium",Store:"Store",Surfing:"Surfing",Swimming:"Swimming",Tennis:"Tennis",Theater:"Theater",University:"University",Volleyball:"Volleyball",Winery:"Winery",Zoo:"Zoo"};function At(t){return t.map((function(t){if(!m(t,Lt))throw new Error("[MapKit] Unknown category `"+t+"`. Choose from mapkit.PointOfInterestCategory.");return t}))}function Et(t){if(void 0!==(t=v(t)).includes&&void 0!==t.excludes)throw new Error("[MapKit] `includes` and `excludes` may not be specified at the same time.");if(void 0===t.includes&&void 0===t.excludes)throw new Error("[MapKit] Either `includes` or `excludes` should be specified.");void 0!==t.includes&&(this._includes=At(t.includes)),void 0!==t.excludes&&(this._excludes=At(t.excludes))}const xt=function(){throw new Error("[MapKit] `PointOfInterestFilter` may not be constructed directly. Use the mapkit.PointOfInterestFilter.including or the mapkit.PointOfInterestFilter.excluding methods.")};Et.prototype=xt.prototype={constructor:xt,_includes:null,_excludes:null,includesCategory:function(t){if(!m(t,Lt))throw new Error("[MapKit] Unknown category `"+t+"`. Choose from mapkit.PointOfInterestCategory.");return this._includes?-1!==this._includes.indexOf(t):this._excludes?-1===this._excludes.indexOf(t):void 0},excludesCategory:function(t){if(!m(t,Lt))throw new Error("[MapKit] Unknown category `"+t+"`. Choose from mapkit.PointOfInterestCategory.");return this._includes?-1===this._includes.indexOf(t):this._excludes?-1!==this._excludes.indexOf(t):void 0}},Et.including=function(t){return y(t,"[MapKit] PointOfInterestFilter.including expected an array of categories."),new Et({includes:t})},Et.excluding=function(t){return y(t,"[MapKit] PointOfInterestFilter.excluding expected an array of categories."),new Et({excludes:t})},Et.exposedConstructor=xt,Object.defineProperties(Et,{filterIncludingAllCategories:{get:function(){const t=this.excluding([]);return Object.defineProperty(this,"filterIncludingAllCategories",{value:t,configurable:!0}),t},configurable:!0},filterExcludingAllCategories:{get:function(){const t=this.including([]);return Object.defineProperty(this,"filterExcludingAllCategories",{value:t,configurable:!0}),t},configurable:!0}}),Object.defineProperties(xt,{including:{get:function(){return Et.including},configurable:!0},excluding:{get:function(){return Et.excluding},configurable:!0},includingAllCategories:{get:()=>Et.filterIncludingAllCategories},excludingAllCategories:{get:()=>Et.filterExcludingAllCategories}});const Tt=Et;function It(t){const e={device_pixel_ratio:window.devicePixelRatio};return t._isInternalClient?(e.width=screen.width,e.height=screen.height,e):e}function Rt(t,e){const i={device_platform:e.uaParserInfo.deviceInfo.platform,device_os_version:e.uaParserInfo.deviceInfo.os};return void 0!==t._isInternalServer&&(i.is_internal_server=t._isInternalServer),i}const Ot=Object.freeze({Dark:"dark",Light:"light",Adaptive:"adaptive"});class Pt extends T.EventTarget{}const Dt=new class{constructor(){this._queryList=window.matchMedia("(prefers-color-scheme: dark)"),this._handles=new Set,this._boundQueryListDidChange=()=>this._queryListDidChange()}addHandle(){const t=new Pt;return this._handles.add(t),1===this._handles.size&&this._addListener(),t}removeHandle(t){this._handles.delete(t),0===this._handles.size&&this._removeListener()}get currentColorScheme(){return this._queryList.matches?Ot.Dark:Ot.Light}get isDarkMode(){return this._queryList.matches}_addListener(){this._queryList.addListener(this._boundQueryListDidChange)}_removeListener(){this._queryList.removeListener(this._boundQueryListDidChange)}_queryListDidChange(){for(const t of this._handles.values()){const e=new T.Event("change");t.dispatchEvent(e)}}};function zt(t,e){let i;return i={browser_language:navigator.language,prefers_color_scheme:Dt.isDarkMode?"DARK":"LIGHT"},location.host.match(/duckduckgo.com$/)||location.host.match(/apple-mapkit.com$/)||(i.browser_name=e.uaParserInfo.browserInfo.name,i.browser_version=e.uaParserInfo.browserInfo.version),t._isInternalClient?i.browser_origin=location.protocol+"//"+location.host:i.browser_origin=t.getReduceHostPlaceholder("ProtocolPlusHost"),t._isInternalClient&&(i.browser_referer=t.getReduceHostPlaceholder("ReferrerHost")),e.browserDefaultFontSize&&(i.browser_default_font_size=e.browserDefaultFontSize),e.browserInfoValues&&Object.assign(i,e.browserInfoValues),i}function Nt(t){const e={mkjs_version:i.version};return t._isInternalClient&&window.placecard&&window.placecard.version&&(e.placecard_version=window.placecard.version),t._teamId&&(e.team_id=t._teamId),t._isInternalClient?e.host=location.host:e.host=t.getReduceHostPlaceholder("Host"),null!==t._serverEnvironment&&(e.server_environment=t._serverEnvironment),e}function Ft(t){if(t._isInternalClient)return{width:window.innerWidth,height:window.innerHeight}}function Ut(t){const e={};return t._isInternalClient&&(e.path=location.pathname),e}function Gt(t,e){const i=e.map.region.toBoundingRegion(),n=e.map.ensureRenderingFrame().size;return{display_map_region:{eastLng:Math.round(i.eastLongitude),northLat:Math.round(i.northLatitude),southLat:Math.round(i.southLatitude),westLng:Math.round(i.westLongitude)},zoom_level:e.map.zoomLevel,map_type:"MAP_TYPE_"+e.map.mapType.toUpperCase(),size:{width:n.width,height:n.height},color_scheme:e.map.colorScheme.toUpperCase()}}function Bt(t){return{session_id:t._sessionId,sequence_number:t._sequenceNumber,relative_timestamp:t._relativeTimestamp}}function Zt(t,e){return{rendering:e.map._mapNodeController&&e.map._mapNodeController.renderingMode}}const Wt=location.host.match(/duckduckgo.com$/),Kt="other";function Ht(t){t=t.toLowerCase();const e={name:Kt,version:Kt};try{if(t.includes("edg")&&!t.includes("edgios")){e.name="Edge";const i=/edg(?:e|ios|a|i)?\/(\d+\.?\d*)/gi;e.version=i.exec(t)[1]}else!t.includes("safari")||t.includes("chrome")||t.includes("crios")||t.includes("gsa")||t.includes("fxios")||t.includes("duckduckgo")||t.includes("edg")?!t.includes("chrome")&&!t.includes("crios")||t.includes("chromium")||t.includes("edg")||t.includes("samsungbrowser")?!t.includes("firefox")&&!t.includes("fxios")||t.includes("seamonkey")?t.includes("msie")||t.includes("trident")&&t.includes("rv")?(e.name="Internet Explorer",e.version=t.includes("msie")?/msie\s(\d+\.?\d*)/gi.exec(t)[1]:/rv:(\d+\.?\d*)/gi.exec(t)[1]):t.includes("gsa")&&(e.name="Google Search App",e.version=/gsa\/(\d+\.?\d*)/i.exec(t)[1]):(e.name="Firefox",e.version=t.includes("firefox")?/firefox\/(\d+\.?\d*)/gi.exec(t)[1]:/fxios\/(\d+\.?\d*)/gi.exec(t)[1]):(e.name="Chrome",e.version=t.includes("chrome")?/chrome\/([\d.]+)/gi.exec(t)[1]:/crios\/([\d.]+)/gi.exec(t)[1]):(e.name="Safari",e.version=/version\/(\d+(\.\d+)*)/i.exec(t)[1]);return e}catch(t){return e}}function jt(t){let e,i;t=t.toLowerCase();try{return t.includes("ipad")?(e="iPad",i="iOS "+/os\s+(.*?)[^_.\d]/i.exec(t)[1]):t.includes("iphone")&&!t.includes("ipad")?(e="iPhone",i="iOS "+/os\s+(.*?)[^_.\d]+/i.exec(t)[1]):t.includes("macintosh")?(e="Macintosh",i="Mac OS X "+/mac os x (.*?)[^_.\d]/.exec(t)[1]):t.includes("windows")?(e="Windows",i="Windows NT "+/windows nt (.*?)[^._\d]/.exec(t)[1]):t.includes("android")?(e="Android",i="Android "+/android (.*?)[^._\d]/.exec(t)[1]):t.includes("linux")&&!t.includes("android")?(e="Linux",i="Linux"):t.includes("cros")?(e="Chrome OS",i="Chrome OS"):(e=Kt,i=Kt),{platform:e,os:i}}catch(t){return{platform:Kt,os:Kt}}}function Vt(){this._startTime=Date.now()}Vt.prototype={_budget:10,didTimeout:!1,timeRemaining:function(){return Math.max(0,this._budget-(Date.now()-this._startTime))}};const qt=function(t,e){return"undefined"!=typeof requestIdleCallback?requestIdleCallback(t,e):function(t){return setTimeout((function(){const e=new Vt;t(e)}))}(t)},Yt=function(t){return"undefined"!=typeof cancelIdleCallback?cancelIdleCallback(t):clearTimeout(t)},Xt=Object.freeze({Highest:0,High:1,Medium:2,Low:3}),$t=Object.freeze([{timeout:600},{timeout:1e3},{timeout:3e3},{}]),Jt=[function(t){ee(t,Xt.Highest)},function(t){ee(t,Xt.High)},function(t){ee(t,Xt.Medium)},function(t){ee(t,Xt.Low)}],Qt=[-1,-1,-1,-1],te=[];for(const t of Object.values(Xt))te[t]=[];function ee(t,e){for(;(t.timeRemaining()>0||t.didTimeout)&&te[e].length;){const t=te[e].shift();"function"==typeof t?t():t&&"object"==typeof t&&"function"==typeof t.performScheduledTask&&t.performScheduledTask()}te[e].length?Qt[e]=qt(Jt[e],$t[e]):-1!==Qt[e]&&(Yt(Qt[e]),Qt[e]=-1)}const ie={schedule:function(t,e){te[e].push(t),-1===Qt[e]&&(Qt[e]=qt(Jt[e],$t[e]))}};let ne=-1,oe=[],se=[],ae=[];const re=Object.freeze({Idle:0,Updating:1,Drawing:2,Flushing:3});let le=re.Idle;function he(t){-1!==ne&&(le===re.Flushing&&("undefined"!=typeof cancelAnimationFrame?cancelAnimationFrame(ne):clearTimeout(ne)),ne=-1),function(t){le=re.Updating;for(;oe.length>0;){const e=oe;oe=[];for(let i=0,n=e.length;i<n;++i){const n=e[i];"function"==typeof n?n():n&&"object"==typeof n&&"function"==typeof n.performScheduledUpdate&&n.performScheduledUpdate(t)}}oe=se,se=[]}(t),function(t){le=re.Drawing;const e=ae;ae=[];for(let i=0,n=e.length;i<n;++i){const n=e[i];"function"==typeof n?n():n&&"object"==typeof n&&"function"==typeof n.performScheduledDraw&&n.performScheduledDraw(t)}}(t),le=re.Idle}function ce(t,e){return-1===t.indexOf(e)&&(t.push(e),!0)}function de(){ne="undefined"!=typeof requestAnimationFrame?requestAnimationFrame(he):setTimeout(he)}const ue={scheduleASAP:function(t){ce(oe,t)&&-1===ne&&le!==re.Updating&&de()},scheduleOnNextFrame:function(t){ce(le===re.Updating?se:oe,t)&&-1===ne&&de()},scheduleDraw:function(t){ce(ae,t)&&-1===ne&&de()},flush:function(){le>re.Idle||(le=re.Flushing,he())},Priority:Xt,scheduleInBackground:function(t,e){ie.schedule(t,e||Xt.Low)}};const pe=function(t,e,i){let n;return function(...o){const s=o;n&&clearTimeout(n),n=setTimeout((function(){n=null,t.apply(i,s)}),e||0)}},me=/^.*(?=\/mapkit([.a-z-]*)\.js)/;function ge(t){const e=me.exec(t.src);return e?e[0]:null}const _e={_baseUrl:void 0,_versionSuffix:"",scriptBaseUrl:void 0,createUrl:function(t,e){if(void 0===this._baseUrl){if(kt.state===kt.States.UNINITIALIZED&&!e)return void 0;kt.distUrl?(this._baseUrl=kt.distUrl,this._versionSuffix="?mkjsVersion="+i.cdnVersion):i.useLocalResources?(void 0===this.scriptBaseUrl&&this.findScriptAndSetBasePath(),this._baseUrl=this.scriptBaseUrl,this._versionSuffix="?mkjsVersion="+i.cdnVersion):kt.proxyPrefixes?this._baseUrl=kt.proxyPrefixes[0]+[i.cdnBase,"mk",i.cdnVersion].join("/"):this._baseUrl=["https:"+i.cdnBase,"mk",i.cdnVersion].join("/")}t=t&&t.replace(/^\//,"")||"";let n=this._versionSuffix;return("__mapkitSourceMap"in window||kt.enableSourceMap)&&(n+=(n?"&":"?")+"sourcemap=1"),[this._baseUrl,t].join("/")+n},isUrlTrusted:()=>kt.distUrl?kt.isDistUrlTrusted():!!i.useLocalResources||(!kt.proxyPrefixes||kt.isProxyPrefixTrusted()),createImageUrl:function(t){return this.createUrl("images/"+t)},findScriptAndSetBasePath:function(){if(document.currentScript){const t=ge(document.currentScript);if(t)return _e.scriptBaseUrl=t,document.currentScript}for(let t=document.scripts,e=0,i=t.length;e<i;++e){const i=ge(t[e]);if(null!==i)return this.scriptBaseUrl=i,t[e]}return null}};i.useLocalResources&&"undefined"!=typeof window&&void 0!==window.document&&_e.findScriptAndSetBasePath(),kt.addEventListener(kt.Events.Initialized,(function(){_e._baseUrl=void 0,_e._versionSuffix=""}));const fe=_e,ye=["ac.com","aws.sagemaker","biz.orx","cloud.jele","com.amazonaws","com.amazoncognito","com.est-a-la-masion","com.onthewifi","dev.curv","host.freesite","it.barletta-trani-andria","it.trento","jp.chiba","jp.fukushima","jp.hokkaido","jp.hyogo","jp.kanagawa","jp.miyazaki","jp.niigata","jp.saga","jp.tochigi","jp.xn--7t0a264c","lv.mil","net.homeunix","no.fuossko","no.smola","no.xn--sandy-yua","pa.ac","py.org","tj.ac","us.mi","zm.edu"],ve=tt,we=N,be=["alt","arpa","example","invalid","local","localhost","onion","test"],Ce=[];function ke(t,e){const i=e.length,n=t.length;if(i>n)return!1;for(let o=0;o<i;o++)if("*"!==e[i-1-o]&&e[i-1-o]!==t[n-1-o])return!1;return!0}function Me(t){let e=t[0];for(let i=1;i<t.length;i++){const n=t[i];n.length>e.length&&(e=n)}return e}const Se={getRegisterableDomain:function(t){if(!t||t.includes(":")||/^[\d.]+$/.test(t))return Promise.resolve(null);const e=t.endsWith(".")?".":"";e&&(t=t.substring(0,t.length-1));const i=t.split("."),n=i.slice(-1)[0],o=1===i.length?null:i.slice(-2)[0];if(!o||be.includes(n))return Promise.resolve(null);const s=[].concat(ye),a=`${n}.${o}`;s.push(a),s.sort();const r=s.lastIndexOf(a);return 0===r?Promise.resolve(`${o}.${n}${e}`):(l=r-1,Ce[l]||(Ce[l]=new Promise((t=>{const e=new ve(fe.createUrl("psl/"+l+".txt"),{loaderDidSucceed(e,i){if(i.status<200||i.status>=300)return void t(null);const n=i.responseText.split("\n").map((t=>t.trim())).filter((t=>!!t));t(n)},loaderDidFail(){t(null)}},{priority:we.Low,withCredentials:kt.distUrlWithCredentials});e.schedule()}))),Ce[l]).then((t=>t?function(t,e){let i="";const n=[],o=[];for(const i of e)if(i.startsWith("!")){const e=i.substring(1).split(".");ke(t,e)&&o.push(e)}else{const e=i.split(".");ke(t,e)&&n.push(e)}let s=["*"];0!==o.length?(s=Me(o),s=s.slice(1)):0!==n.length&&(s=Me(n));return i=t.slice(-s.length-1).join("."),i}(i,t)+e:`${o}.${n}${e}`));var l}},Le=Se,Ae=tt,Ee=N,xe={ScreenSize:"SCREEN_SIZE",DeviceIdentifier:"DEVICE_IDENTIFIER",BrowserInfo:"BROWSER_INFO",ApplicationIdentifier:"APPLICATION_IDENTIFIER",BrowserWindowSize:"BROWSER_WINDOW_SIZE",Url:"URL",MapView:"MAP_VIEW",UserSession:"USER_SESSION",Tiles:"TILES"},Te={MapUserActionStates:[xe.ScreenSize,xe.DeviceIdentifier,xe.BrowserInfo,xe.ApplicationIdentifier,xe.BrowserWindowSize,xe.Url,xe.MapView,xe.UserSession,xe.Tiles],SessionLessMapUserActionStates:[xe.ScreenSize,xe.DeviceIdentifier,xe.BrowserInfo,xe.ApplicationIdentifier,xe.BrowserWindowSize,xe.Url,xe.MapView,xe.Tiles],GeneralUserActionStates:[xe.ScreenSize,xe.DeviceIdentifier,xe.BrowserInfo,xe.ApplicationIdentifier,xe.BrowserWindowSize,xe.Url,xe.UserSession],SessionLessGeneralUserActionStates:[xe.ScreenSize,xe.DeviceIdentifier,xe.BrowserInfo,xe.ApplicationIdentifier,xe.BrowserWindowSize,xe.Url],NetworkStates:[xe.DeviceIdentifier,xe.BrowserInfo,xe.ApplicationIdentifier,xe.UserSession]},Ie="USER_ACTION",Re="NETWORK",Oe=["OPEN_APPLE_MAPS"],Pe={Zoom:{name:"ZOOM",states:Te.MapUserActionStates,type:Ie},MapsLoad:{name:"MAPS_LOAD",states:Te.MapUserActionStates,type:Ie},AnnotationClick:{name:"ANNOTATION_CLICK",states:Te.MapUserActionStates,type:Ie},MapFeatureSelect:{name:"TAP_POI",states:Te.MapUserActionStates,type:Ie,valueMap:{Poi:"POINT_OF_INTEREST",Territory:"TERRITORY",PhysicalFeature:"PHYSICAL_FEATURE"}},MapTypeChange:{name:"MAP_TYPE_CHANGE",states:Te.MapUserActionStates,type:Ie},MapNodeReady:{name:"MAP_NODE_READY",states:Te.MapUserActionStates,type:Ie},Pan:{name:"PAN",states:Te.MapUserActionStates,type:Ie},PlaceAccessoryReveal:{name:"REVEAL",states:Te.MapUserActionStates,type:Ie},PlaceAccessoryOpenAppleMaps:{name:"OPEN_APPLE_MAPS",states:Te.SessionLessMapUserActionStates,type:Ie},PlaceDetailReveal:{name:"REVEAL",states:Te.GeneralUserActionStates,type:Ie},PlaceDetailOpenAppleMaps:{name:"OPEN_APPLE_MAPS",states:Te.SessionLessGeneralUserActionStates,type:Ie},Search:{name:"SEARCH",states:Te.NetworkStates,type:Re},SearchAC:{name:"SEARCH_AC",states:Te.NetworkStates,type:Re},PlaceLookup:{name:"PLACE_LOOKUP",states:Te.NetworkStates,type:Re},ForwardGeocoder:{name:"FORWARD_GEOCODER",states:Te.NetworkStates,type:Re},ReverseGeocoder:{name:"REVERSE_GEOCODER",states:Te.NetworkStates,type:Re},Directions:{name:"DIRECTIONS",states:Te.NetworkStates,type:Re},PointsOfInterestSearch:{name:"POINTS_OF_INTEREST_SEARCH",states:Te.NetworkStates,type:Re}};function De(){var t;this._isInternalClient=/\.apple\.com$/.test(window.origin)||/\.icloud\.com$/.test(window.origin)||/\.filemaker\.com$/.test(window.origin)||/\.apple-mapkit\.com$/.test(window.origin)||/\.tryrating\.com$/.test(window.origin),kt.addEventListener(kt.Events.Changed,this),kt.ready&&this._configurationBecameAvailable(),this.uaParserInfo=(t=navigator.userAgent,{browserInfo:Wt?{}:Ht(t),deviceInfo:Wt?{}:jt(t)}),this._debouncedQueueAsBackgroundTask=pe(this._queueAsBackgroundTask,1e4,this),window.addEventListener("pagehide",this),document.addEventListener("visibilitychange",this),this._queuedMessages=[],this._queuedSessionLessMessages=[]}De.prototype={_shortSessionLoader:null,_sessionLessLoader:null,_analyticsUrl:null,_errorUrl:null,_sessionId:null,_sessionTimerStart:null,_sessionTimeToExpire:null,_sequenceNumber:null,_relativeTimestamp:null,_isCustomSession:!1,_refreshCustomSession:null,_enableServerAnalytics:!1,_serverEnvironment:null,_isInternalServer:void 0,_trackPanEvent:!1,_handleAnalyticsTrackingResponse:null,_registerableHostDomain:"",_registerableReferrerDomain:"",_reducedHostPlaceholders:{ProtocolPlusHost:null,Host:null,ReferrerHost:null},States:xe,Events:Pe,EventTarget:"UI_TARGET_UNKNOWN",log:function(t,e={}){this._enableServerAnalytics;const i=(new Date).getTime();(!this._sessionId||i>this._sessionTimeToExpire)&&(this._isCustomSession&&this._refreshCustomSession?this._refreshCustomSession():this._initSession()),this._relativeTimestamp=((new Date).getTime()-this._sessionTimerStart)/1e3,this._sequenceNumber=Math.ceil(1e4*this._relativeTimestamp),this.uaParserInfo&&(e.uaParserInfo=this.uaParserInfo),Oe.includes(t.name)||e?.isEventSessionLess?this._queuedSessionLessMessages.push(this._createMessage(t,e)):this._queuedMessages.push(this._createMessage(t,e)),kt.analytics&&this._debouncedQueueAsBackgroundTask()},initCustomSession:function(t){this._isCustomSession=!0,this._sessionId=t.sessionId,this._sessionTimerStart=t.sessionStartTime,this._sessionTimeToExpire=this._sessionTimerStart+t.sessionDurationMs},manageAnalyticsTrackingResponse:function(t,e,i=!1){if(!this._handleAnalyticsTrackingResponse)return;let n;if(i)n={eventCount:e,sentViaSendBeacon:i};else{const e=t._xhr.status,o=(t._xhrData?JSON.parse(t._xhrData):{}).analytics_event;n={eventCount:o&&Array.isArray(o)?o.length:0,responseCode:e,sentViaSendBeacon:i}}this._handleAnalyticsTrackingResponse(n),i&&(0!==this._queuedMessages.length&&this._queuedMessages.forEach((t=>{t.sent_via_send_beacon=!0})),0!==this._queuedSessionLessMessages.length&&this._queuedSessionLessMessages.forEach((t=>{t.sent_via_send_beacon=!0})))},setEventTarget:function(t){this.EventTarget=t},getDataToSend:function(t){return 0===this._queuedMessages.length?(this._shortSessionLoader.unschedule(),!1):(t.setRequestHeader("Content-Type","text/plain"),t.responseType="text",this._createShortSessionJson())},loaderDidSucceed:function(t){this.manageAnalyticsTrackingResponse(t),delete this._shortSessionLoader},loaderDidFail:function(t){this._queuedMessages=this._queuedMessages.concat(JSON.parse(t.xhrData).analytics_event),this.manageAnalyticsTrackingResponse(t),delete this._shortSessionLoader},getSessionLessDataToSend:function(t){return 0===this._queuedSessionLessMessages.length?(this._sessionLessLoader.unschedule(),!1):(t.setRequestHeader("Content-Type","text/plain"),t.responseType="text",this._createSessionLessJson())},sessionLessloaderDidSucceed:function(t){this.manageAnalyticsTrackingResponse(t),delete this._sessionLessLoader},sessionLessLoaderDidFail:function(t){this._queuedSessionLessMessages=this._queuedSessionLessMessages.concat(JSON.parse(t.xhrData).analytics_event),this.manageAnalyticsTrackingResponse(t),delete this._sessionLessLoader},handleEvent:function(t){switch(t.type){case kt.Events.Changed:this._configurationBecameAvailable();break;case"pagehide":this._sendPendingData();break;case"visibilitychange":"hidden"===document.visibilityState&&this._sendPendingData()}},getReduceHostPlaceholder:function(t){return this._reducedHostPlaceholders[t]||(this._reducedHostPlaceholders[t]=Symbol()),this._reducedHostPlaceholders[t]},_createMessage:function(t,e){let i;switch(t.type){case Ie:i=this._createUserActionMessage(t,e);break;case Re:i=this._createNetworkMessage(t,e);break;default:i={}}const n=[].concat(t.states?t.states:[],e.states?Object.keys(e.states):[]);return i.analytics_state=this._createStateMessages(n,e),i.sent_via_send_beacon=!1,i},_createUserActionMessage:function(t,e){const i={event_type:Ie,user_action_event:{user_action_event_key:t.name}};return(e.eventValue||0===e.eventValue)&&(i.user_action_event.user_action_event_value=t.valueMap?t.valueMap[e.eventValue]:e.eventValue),e.eventTarget&&(i.user_action_event.user_action_event_target=e.eventTarget),e.eventModule&&(i.user_action_event.user_action_event_module=e.eventModule),i},_createNetworkMessage:function(t,e){const i={event_type:Re,network_event:{network_service:t.name}},n=parseInt(e.responseCode);return e.responseCode&&!isNaN(n)&&(i.network_event.http_response_code=n),i},_initSession:function(){this._isCustomSession=!1,this._sessionId={high:C(),low:C()},this._sessionTimerStart=(new Date).getTime(),this._sessionTimeToExpire=this._sessionTimerStart+9e5},_createStateMessages:function(t,i){return t.map((function(t){const n={state_type:t};return e[t]?n[t.toLowerCase()]=e[t](this,i):i.states[t]&&(n[t.toLowerCase()]=i.states[t](i)),n}),this)},_createShortSessionJson:function(){const t=this._createJson({analytics_message_type:"SHORT_SESSION_USAGE",analytics_event:this._queuedMessages});return this._queuedMessages=[],t},_createSessionLessJson(){const t=this._createJson({analytics_message_type:"SESSIONLESS_USAGE",analytics_event:this._queuedSessionLessMessages});return this._queuedSessionLessMessages=[],t},_createJson(t){return JSON.stringify(t,((t,e)=>{switch(e){case this._reducedHostPlaceholders.Host:return this._registerableHostDomain;case this._reducedHostPlaceholders.ProtocolPlusHost:return this._registerableHostDomain?window.location.protocol+"//"+this._registerableHostDomain:"";case this._reducedHostPlaceholders.ReferrerHost:return this._registerableReferrerDomain;default:return e}}))},_configurationBecameAvailable:function(){kt.analytics&&(this._analyticsUrl=kt.analytics.analyticsUrl,this._withCredentials=kt.withCredentials),kt.analyticsTeamId?this._teamId=kt.analyticsTeamId:kt.teamId&&(this._teamId=kt.teamId)},_scheduleLoaderRequest:function(){this._shortSessionLoader||0===this._queuedMessages.length||(this._shortSessionLoader=new Ae(this._analyticsUrl,this,{method:"POST",priority:Ee.Low,retry:!0,withCredentials:this._withCredentials}),this._shortSessionLoader.schedule()),this._sessionLessLoader||0===this._queuedSessionLessMessages.length||(this._sessionLessLoader=new Ae(this._analyticsUrl,{getDataToSend:t=>{this.getSessionLessDataToSend(t)},loaderDidSucceed:t=>{this.sessionLessloaderDidSucceed(t)},loaderDidFail:t=>{this.sessionLessLoaderDidFail(t)}},{method:"POST",priority:Ee.Low,retry:!0,withCredentials:this._withCredentials}),this._sessionLessLoader.schedule())},_scheduleLoader:function(){this._resolveRegisterableDomains().then((()=>{this._scheduleLoaderRequest()}))},_queueAsBackgroundTask:function(){ue.scheduleInBackground((()=>this._scheduleLoader()),ue.Priority.Low)},_resolveRegisterableDomains:function(){const t=!!this._reducedHostPlaceholders.ProtocolPlusHost||!!this._reducedHostPlaceholders.Host,e=!!this._reducedHostPlaceholders.ReferrerHost&&document.referrer?new URL(document.referrer):null,i=e?e.hostname:null;return Promise.all([t?Le.getRegisterableDomain(window.location.hostname):"",Le.getRegisterableDomain(i)]).then((([t,i])=>{this._registerableHostDomain=t?window.location.port?`${t}:${window.location.port}`:t:"",this._registerableReferrerDomain=i?e&&e.port?`${i}:${e.port}`:i:""}))},_sendPendingData:function(){if(0!==this._queuedMessages.length){const t=this._queuedMessages.length;if(this.manageAnalyticsTrackingResponse(null,t,!0),"function"==typeof navigator.sendBeacon)navigator.sendBeacon(this._analyticsUrl,this._createShortSessionJson());else{const t=new XMLHttpRequest;t.open("POST",this._analyticsUrl,!1),t.send(this._createShortSessionJson())}}if(0!==this._queuedSessionLessMessages.length){const t=this._queuedSessionLessMessages.length;if(this.manageAnalyticsTrackingResponse(null,t,!0),"function"==typeof navigator.sendBeacon)navigator.sendBeacon(this._analyticsUrl,this._createSessionLessJson());else{const t=new XMLHttpRequest;t.open("POST",this._analyticsUrl,!1),t.send(this._createSessionLessJson())}}}};const ze=new De,Ne=(t,e)=>t-e*Math.floor(t/e),Fe=Math.PI/180,Ue=Math.PI/4,Ge=2*Math.PI,Be=12,Ze=256,We=Math.PI/3,Ke=Math.tan(We/2);function He(t){const e=(i=t,n=1e-8-90,o=90-1e-8,Math.max(n,Math.min(i,o))*Fe);var i,n,o;return.5+Math.log(Math.tan(Ue-e/2))/Ge}function je(t){const e=Math.pow(Math.E,2*Math.PI*(t-.5));return-2*(Math.atan(e)-Math.PI/4)/Math.PI*180}function Ve(t){return Ne(t/360+.5,1)}function qe(t){return 360*(Ne(t,1)-.5)}function Ye(t){return Ne(180+t,360)-180}function Xe(t){const e=t*Fe,i=111132.92+-559.82*Math.cos(2*e)+1.175*Math.cos(4*e)+-.0023*Math.cos(6*e),n=He(t-.5),o=He(t+.5);return Math.abs(n-o)/i}const $e=1e-8,Je=je(0),Qe=je(1);function ti(t,e){const i=t.toCoordinate(),n=e.toCoordinate();return o=i.latitude,s=i.longitude,a=n.latitude,r=n.longitude,function(t,e,i,n,o){const s=(i-t)*Fe,a=(n-e)*Fe,r=Math.pow(Math.sin(s/2),2)+Math.cos(t*Fe)*Math.cos(i*Fe)*Math.pow(Math.sin(a/2),2),l=2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r));return o*l}(o,s,a,r,6378160-21e3*Math.sin(o*Fe));var o,s,a,r}class ei{constructor(t,e){if(void 0===t&&(t=new ni),void 0===e&&(e=new ii),!(t instanceof ni))throw Error("[MapKit] `center` is not a Coordinate.");if(!(e instanceof ii))throw Error("[MapKit] `span` is not a CoordinateSpan.");this.center=new ni(t.latitude,t.longitude),this.span=new ii(e.latitudeDelta,e.longitudeDelta)}copy(){return new ei(this.center.copy(),this.span.copy())}toString(){return["CoordinateRegion(","\tlatitude: "+this.center.latitude,"\tlongitude: "+this.center.longitude,"\tlatitudeDelta: "+this.span.latitudeDelta,"\tlongitudeDelta: "+this.span.longitudeDelta,")"].join("\n")}equals(t){return this.center.equals(t.center)&&this.span.equals(t.span)}toBoundingRegion(){const t=this.span.latitudeDelta/2,e=this.span.longitudeDelta/2;return new oi(this.center.latitude+t,Ye(this.center.longitude+e),this.center.latitude-t,Ye(this.center.longitude-e))}toMapRect(){if(this.span.latitudeDelta<0)this.span.latitudeDelta=0;else{const t=He(Math.abs(this.center.latitude)),e=Je-je(2*t);this.span.latitudeDelta>e&&(this.span.latitudeDelta=e)}const t=Ye(this.center.longitude),e=this.span.longitudeDelta/2;let i=t-e,n=t+e,o=!1;i<-180&&(i+=360,o=!0);let s=!1;n>180&&(n-=360,s=!0);const a=new ni(this.center.latitude,i),r=new ni(this.center.latitude,n),l=a.toMapPoint(),h=r.toMapPoint();o&&(l.x-=1),s&&(h.x+=1);const c=new ri;let d,u;if(0===this.center.latitude)return d=new ni(this.center.latitude+this.span.latitudeDelta/2,this.center.longitude),u=new ni(this.center.latitude-this.span.latitudeDelta/2,this.center.longitude),c.origin.x=l.x,c.size.width=h.x-c.origin.x,c.origin.y=d.toMapPoint().y,c.size.height=u.toMapPoint().y-c.origin.y,c;const p=this.copy();p.center.latitude=Qe+this.span.latitudeDelta/2;let m=10,g=new ni;const _=new si;d=new ni,u=new ni,d.longitude=this.center.longitude,u.longitude=this.center.longitude;let f=0;do{if(p.center.latitude>Je&&p.center.latitude>this.center.latitude||p.center.latitude<Qe&&p.center.latitude<this.center.latitude)p.center.latitude-=m,m*=.1;else if(p.center.latitude>Je||p.center.latitude<Qe)return new ri(0,0,1,1);if(f>500)return new ri(0,0,1,1);d.latitude=p.center.latitude+p.span.latitudeDelta/2,u.latitude=p.center.latitude-p.span.latitudeDelta/2,c.origin.x=l.x,c.size.width=h.x-c.origin.x,c.origin.y=d.toMapPoint().y,c.size.height=u.toMapPoint().y-c.origin.y,_.x=c.midX(),_.y=c.midY(),g=_.toCoordinate(),(m>0&&g.latitude>this.center.latitude||m<0&&g.latitude<this.center.latitude)&&(m*=-.1),p.center.latitude+=m,f++}while(Math.abs(g.latitude-this.center.latitude)>=$e);return c}get radius(){const t=this.toMapRect();let e,i;return t.size.width>t.size.height?(e=new si(t.minX(),t.midY()),i=new si(t.maxX(),t.midY())):(e=new si(t.midX(),t.minY()),i=new si(t.midX(),t.maxY())),ti(e,i)/2}}class ii{constructor(t,e){if(void 0===t&&(t=0),void 0===e&&(e=0),"number"!=typeof t||isNaN(t))throw new TypeError("[MapKit] `latitudeDelta` is not a number.");if("number"!=typeof e||isNaN(e))throw new TypeError("[MapKit] `longitudeDelta` is not a number.");this.latitudeDelta=Math.max(t,0),this.longitudeDelta=Math.max(e,0)}copy(){return new ii(this.latitudeDelta,this.longitudeDelta)}equals(t){return Math.abs(this.latitudeDelta-t.latitudeDelta)<$e&&Math.abs(this.longitudeDelta-t.longitudeDelta)<$e}toString(){return["CoordinateSpan(","\tlatitudeDelta: "+this.latitudeDelta,"\tlongitudeDelta: "+this.longitudeDelta,")"].join("\n")}}class ni{constructor(t,e){if(void 0===t&&(t=0),void 0===e&&(e=0),"number"!=typeof t||isNaN(t))throw new TypeError("[MapKit] `latitude` is not a number.");if("number"!=typeof e||isNaN(e))throw new TypeError("[MapKit] `longitude` is not a number.");this.latitude=t,this.longitude=e}copy(){return new ni(this.latitude,this.longitude)}equals(t){return Math.abs(this.latitude-t.latitude)<$e&&Math.abs(this.longitude-t.longitude)<$e}toMapPoint(){return new si(Ve(this.longitude),He(this.latitude))}toUnwrappedMapPoint(){return new si(this.longitude/360+.5,He(this.latitude))}toString(){return["Coordinate(","latitude:"+this.latitude.toFixed(Be),",longitude:"+this.longitude.toFixed(Be),")"].join("")}}class oi{constructor(t,e,i,n){if(arguments.length<4&&(n=0,arguments.length<3&&(i=0,arguments.length<2&&(e=0,arguments.length<1&&(t=0)))),"number"!=typeof t||isNaN(t))throw new TypeError("[MapKit] Expected a number for `northLatitude` in BoundingRegion constructor but got `"+t+"` instead.");if("number"!=typeof e||isNaN(e))throw new TypeError("[MapKit] Expected a number for `eastLongitude` in BoundingRegion constructor but got `"+e+"` instead.");if("number"!=typeof i||isNaN(i))throw new TypeError("[MapKit] Expected a number for `southLatitude` in BoundingRegion constructor but got `"+i+"` instead.");if("number"!=typeof n||isNaN(n))throw new TypeError("[MapKit] Expected a number for `westLongitude` in BoundingRegion constructor but got `"+n+"` instead.");this.northLatitude=t,this.eastLongitude=e,this.southLatitude=i,this.westLongitude=n}copy(){return new oi(this.northLatitude,this.eastLongitude,this.southLatitude,this.westLongitude)}toString(){return["BoundingRegion(","\tnorthLatitude: "+this.northLatitude,"\teastLongitude: "+this.eastLongitude,"\tsouthLatitude: "+this.southLatitude,"\twestLongitude: "+this.westLongitude,")"].join("\n")}toCoordinateRegion(){let t=Ye(this.eastLongitude);const e=Ye(this.westLongitude);t<e&&(t+=360);const i=this.northLatitude-this.southLatitude,n=t-e;return new ei(new ni(this.southLatitude+i/2,Ye(e+n/2)),new ii(i,n))}}class si{constructor(t,e){if(arguments.length<2&&(e=0,arguments.length<1&&(t=0)),"number"!=typeof t||isNaN(t))throw new TypeError("[MapKit] Expected a number for `x` in MapPoint constructor but got `"+t+"` instead.");if("number"!=typeof e||isNaN(e))throw new TypeError("[MapKit] Expected a number for `y` in MapPoint constructor but got `"+e+"` instead.");this.x=t,this.y=e,this.z=0,this.w=1}toString(){return"MapPoint("+this.x+", "+this.y+")"}copy(){return new si(this.x,this.y)}equals(t){return this.x===t.x&&this.y===t.y}toCoordinate(){return new ni(je(this.y),Ye(qe(this.x)))}}class ai{constructor(t,e){if(arguments.length<2&&(e=0,arguments.length<1&&(t=0)),"number"!=typeof t||isNaN(t))throw new TypeError("[MapKit] Expected a number for `width` in MapSize constructor but got `"+t+"` instead.");if("number"!=typeof e||isNaN(e))throw new TypeError("[MapKit] Expected a number for `height` in MapSize constructor but got `"+e+"` instead.");this.width=t,this.height=e}toString(){return"MapSize("+this.width+", "+this.height+")"}copy(){return new ai(this.width,this.height)}equals(t){return this.width===t.width&&this.height===t.height}}class ri{constructor(t,e,i,n){if(arguments.length<4&&(n=0,arguments.length<3&&(i=0,arguments.length<2&&(e=0,arguments.length<1&&(t=0)))),"number"!=typeof t||isNaN(t))throw new TypeError("[MapKit] Expected a number for `x` in MapRect constructor but got `"+t+"` instead.");if("number"!=typeof e||isNaN(e))throw new TypeError("[MapKit] Expected a number for `y` in MapRect constructor but got `"+e+"` instead.");if("number"!=typeof i||isNaN(i))throw new TypeError("[MapKit] Expected a number for `width` in MapRect constructor but got `"+i+"` instead.");if("number"!=typeof n||isNaN(n))throw new TypeError("[MapKit] Expected a number for `height` in MapRect constructor but got `"+n+"` instead.");this.origin=new si(t,e),this.size=new ai(i,n)}toString(){return"MapRect("+[this.origin.x.toFixed(Be),this.origin.y.toFixed(Be),this.size.width.toFixed(Be),this.size.height.toFixed(Be)].join(", ")+")"}copy(){return new ri(this.origin.x,this.origin.y,this.size.width,this.size.height)}equals(t){return this.origin.equals(t.origin)&&this.size.equals(t.size)}minX(){return this.origin.x}minY(){return this.origin.y}midX(){return this.origin.x+this.size.width/2}midY(){return this.origin.y+this.size.height/2}maxX(){return this.origin.x+this.size.width}maxY(){return this.origin.y+this.size.height}scale(t,e){if("number"!=typeof t||isNaN(t))throw new TypeError("[MapKit] The `scaleFactor` parameter passed to `MapRect.scale()` is not a number.");const i=this.size.width*t,n=this.size.height*t;if(!e)return new ri(this.midX()-i/2,this.midY()-n/2,i,n);if(!(e instanceof si))throw Error("[MapKit] The `scaleCenter` parameter passed to `MapRect.scale()` is not a MapPoint.");return new ri(e.x-t*(e.x-this.origin.x),e.y-t*(e.y-this.origin.y),i,n)}toCoordinateRegion(){const t=this.origin.toCoordinate(),e=new si(this.maxX(),this.maxY()).toCoordinate(),i=Math.abs(e.latitude-t.latitude);let n=e.longitude-t.longitude;return e.longitude<t.longitude&&(n+=360),new ei(new si(this.midX(),this.midY()).toCoordinate(),new ii(i,n))}}class li{constructor(t,e){if(null==e)if("number"==typeof t)e=1/0;else{const i=null==t?{}:t;t="minCameraDistance"in i?i.minCameraDistance:0,e="maxCameraDistance"in i?i.maxCameraDistance:1/0}if("number"!=typeof t||t<0)throw new Error("[MapKit] The `minCameraDistance` property of CameraZoomRange must be a number >= 0");if("number"!=typeof e||e<0)throw new Error("[MapKit] The `maxCameraDistance` property of CameraZoomRange must be a number >= 0");if(e<t)throw new Error("[MapKit] The `maxCameraDistance` property of CameraZoomRange must be greater than the `minCameraDistance` property.");this._minCameraDistance=t,this._maxCameraDistance=e}get minCameraDistance(){return this._minCameraDistance}get maxCameraDistance(){return this._maxCameraDistance}copy(){return new li(this._minCameraDistance,this._maxCameraDistance)}}const hi={tileSize:Ze,convertLatitudeToY:He,convertYToLatitude:je,convertLongitudeToX:Ve,convertXToLongitude:qe,wrapLongitude:Ye,wrapX:function(t,e){let i=1.5,n=t;for(let o=-1;o<=1;++o){const s=Math.abs(t+o-e);s<i&&(i=s,n=t+o)}return n},zoomLevelForMapRectInViewport:function(t,e,i){const n=e.width/(i*t.size.width),o=e.height/(i*t.size.height);return Math.log2(Math.min(n,o))},mapUnitsPerMeterAtLatitude:Xe,pointsPerAxis:function(t){return Math.pow(2,t)*Ze},zoomLevelForCameraDistanceAtLatitudeAndViewportWidth:function(t,e,i){const n=2*(Ke*t)*Xe(e);return Math.log2(i/n/Ze)},CameraZoomRange:li,CoordinateRegion:ei,CoordinateSpan:ii,Coordinate:ni,BoundingRegion:oi,MapPoint:si,MapRect:ri,MapSize:ai},ci=hi.BoundingRegion,di=hi.Coordinate;function ui(t){let e,i;t.id&&(this.id=t.id,this.alternateIds=t.alternateIds||[]),t.muid&&(this.muid=t.muid),t.placecardUrl&&(this._wpURL=t.placecardUrl),t.style&&t.style.attributes&&(this._styleAttributes=t.style.attributes.map((t=>t.key+":"+t.value)).join(","),t.poiCategory&&-1!==Object.keys(Lt).indexOf(t.poiCategory)&&(this.pointOfInterestCategory=Lt[t.poiCategory])),t.name&&(this.name=t.name),t.attribution&&(this._providerId=t.attribution.vendorId,this._providerItemId=t.attribution.externalItemId),t.displayMapRegion&&(e=t.displayMapRegion,i=new ci(e.northLat,e.eastLng,e.southLat,e.westLng),this.region=i.toCoordinateRegion(),this.coordinate=this.region.center),t.formattedAddressLines&&(this.formattedAddress=t.formattedAddressLines.join(", ")),t.center&&(this.coordinate=new di(t.center.lat,t.center.lng)),t.countryCode&&(this.countryCode=t.countryCode),this.telephone=t.telephone,this.urls=t.urls||[],this.country=t.country,this.administrativeArea=t.administrativeArea,this.administrativeAreaCode=t.administrativeAreaCode,this.locality=t.locality,this.postCode=t.postCode,this.subLocality=t.subLocality,this.thoroughfare=t.thoroughfare,this.subThoroughfare=t.subThoroughfare,this.fullThoroughfare=t.fullThoroughfare,this.areasOfInterest=t.areasOfInterest,this.dependentLocalities=t.dependentLocalities,this.timezone=t.timezone,this.timezoneSecondsFromGmt=t.timezoneSecondsFromGmt}ui.isConstructable=!1;const pi=function(t){if(ui.isConstructable)return ui.call(this,t);throw new TypeError("[MapKit] Place may not be constructed.")};ui.prototype=pi.prototype={constructor:pi};const mi=ui;class gi{constructor(t,e,i,n){this.localeId=t,this._dict=e||{},this.ready=!!e,this.delegate=i,this.rtl=i.rtlLocales.indexOf(t)>-1,this.dow=n}get(t,e){const i=this._dict[t];return i?w(i,e??{},!0):`[${t}]`}load(t){const e=this.localeId,i=this.delegate.localeUrl.replace(/{{(.*?)}}/,e),n=new tt(i,{loaderDidSucceed:(i,n)=>{if(n.status<200||n.status>=300){const i=new Error(`HTTP error ${n.status} loading strings for locale: ${e}`);t(i,this)}else{try{this._dict=JSON.parse(n.responseText??"")}catch(i){const n=new Error(`Failed to parse response for locale: ${e}`);return void t(n,this)}this.ready=!0,t(null,this)}},loaderDidFail:(i,n)=>{const o=new Error(`Network error loading strings for locale: ${e}`);t(o,this)}},{withCredentials:this.delegate.withCredentials});n.schedule()}}const _i=Object.freeze({"ar-SA":6,"ca-ES":1,"cs-CZ":1,"da-DK":1,"de-DE":1,"el-GR":1,"en-AU":1,"en-GB":1,"en-US":0,"en-ZA":0,"es-ES":1,"es-MX":1,"fi-FI":1,"fr-CA":0,"fr-FR":1,"he-IL":0,"hi-IN":0,"hr-HR":1,"hu-HU":1,"id-ID":1,"it-IT":1,"ja-JP":0,"ko-KR":0,"ms-MY":1,"nb-NO":1,"nl-NL":1,"pl-PL":1,"pt-BR":0,"pt-PT":1,"ro-RO":1,"ru-RU":1,"sk-SK":1,"sv-SE":1,"th-TH":0,"tr-TR":1,"uk-UA":1,"vi-VN":1,"zh-CN":1,"zh-HK":0,"zh-TW":0}),fi=["0","1","2","3","4","5","6","7","8","9"],yi={"ar-SA":["Ù ","Ù¡","Ù¢","Ù£","Ù¤","Ù¥","Ù¦","Ù§","Ù¨","Ù©"],"hi-IN":["à¥¦","à¥§","à¥¨","à¥©","à¥ª","à¥«","à¥¬","à¥­","à¥®","à¥¯"]},vi=",",wi={"ca-ES":vi,"ca-CZ":vi,"da-DK":vi,"da-DE":vi,"el-GR":vi,"en-ZA":vi,"es-ES":vi,"fi-FI":vi,"fr-CA":vi,"fr-FR":vi,"hr-HR":vi,"hu-HU":vi,"it-IT":vi,"nb-NO":vi,"nl-NL":vi,"pl-PL":vi,"pt-BR":vi,"pt-PT":vi,"ro-RO":vi,"ru-RU":vi,"sk-SK":vi,"sv-SE":vi,"tr-TR":vi,"uk-UA":vi};const bi="en-US",Ci=new WeakSet,ki=new WeakSet,Mi=(t,e)=>{const{language:i,region:n}=e;t.supportMap[i]=t.supportMap[i]||[],n&&-1!==t.delegate.primaryLocales.indexOf(e.tag)?t.supportMap[i].splice(0,0,n):n&&t.supportMap[i].push(n)},Si=(t,e,i)=>new gi(e,i??null,t.delegate,t.dowForBestMatch(e)),Li=(t,e)=>{t.locales[e.localeId]||(t.locales[e.localeId]=e),t.activeLocale=e,t.dispatchEvent(new Ei(e))},Ai=(t,e)=>-1!==t.delegate.supportedLocales.indexOf(e);class Ei extends x.Event{constructor(t){super(xi.Events.LocaleChanged),this.locale=t}}class xi extends x.EventTarget{constructor(t){super(),this.delegate=t,this._requestedLocaleId="",this.locales=t.localesCache||Object.create(null),this.supportMap=t.supportCache||Object.create(null),this.scriptMap=t.scriptCache||Object.create(null),this.Events=xi.Events,(t=>{if(!Ci.has(t.supportMap)){Ci.add(t.supportMap);for(const e of t.delegate.supportedLocales){const i=k.parse(e);i&&Mi(t,i)}}})(this);const e=this.locales[bi]||Si(this,bi,this.delegate.enUSDictionary);this.locales[e.localeId]||(this.locales[e.localeId]=e),this.activeLocale=e,(t=>{if(ki.has(t.scriptMap))return;ki.add(t.scriptMap);const e=t.delegate.regionToScriptMap;for(const[i,n]of Object.entries(e)){t.scriptMap[i]={};for(const[e,o]of Object.entries(n))t.scriptMap[i][o.toLowerCase()]=e}})(this)}get(t,e){return this.activeLocale.get(t,e)??`[${t}]`}get localeId(){return this.activeLocale.localeId??""}set localeId(t){this._requestedLocaleId!==t&&((t,e)=>{t._requestedLocaleId=e;let i=e;if(Ai(t,e)||(i=t.bestMatch(e,bi)),t.activeLocale.localeId===i)return;let n=i?t.locales[i]:null;n||!i||(n=Si(t,i),n.ready)?n&&Li(t,n):n.load(((i,n)=>{if(t._requestedLocaleId===e)return i?(t._requestedLocaleId=bi,void Li(t,t.locales[bi])):void Li(t,n)}))})(this,t)}get loaded(){return!!this._requestedLocaleId&&this.bestMatch(this._requestedLocaleId,bi)===this.localeId}get requestedLocaleId(){return this._requestedLocaleId}set requestedLocaleId(t){console.warn("l10n: requestedLocaleId can't be set, use localeId.")}get localeIds(){return Object.keys(this.locales)}get supportedLocaleIds(){return this.delegate.supportedLocales}bestMatch(t,e){let i="string"==typeof t?k.parse(t):null,n=null;if(i&&this.delegate.localesMap){const t=this.delegate.localesMap;t[i.tag]?i=k.parse(t[i.tag]):t[i.language]&&(i=k.parse(t[i.language]))}return e=e||null,i&&(n=((t,e)=>{const{language:i,region:n,script:o}=e;let s;const a=t.supportMap[i];if(!a)return null;if(n&&(s=a.find((t=>t.toUpperCase()===e.region?.toUpperCase()))),!s&&o){const e=t.scriptMap[i]?.[o.toLowerCase()];s=e??s}return s||(s=a[0]),new k(i,s)})(this,i)),n?n.tag:e}dowForBestMatch(t,e){const i=this.bestMatch(t,e);return i&&i in _i?_i[i]:0}digits(t){return function(t,e){const i=yi[e]||fi,n=wi[e]||".";let o="";const s=t.toString();for(let t=0,e=s.length;t<e;++t){const e=s.charAt(t);o+="."===e?n:i[parseInt(e,10)]||e}return o}(t,this.localeId)}}xi.Events=Object.freeze({LocaleChanged:"locale-changed"}),xi.Days=Object.freeze({Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6}),xi.LocaleChangedEvent=Ei;const Ti=["AS","BS","BZ","DM","FK","GB","GD","GU","KN","KY","LC","LR","MM","MP","SH","TC","US","VC","VG","VI","WS"],Ii=t=>{const e=t.region;return e?Ti.indexOf(e)<0:"en"!==t.language&&"my"!==t.language},Ri=new xi({supportedLocales:["ar-SA","ca-ES","cs-CZ","da-DK","de-DE","el-GR","en-GB","en-US","es-ES","es-MX","fi-FI","fr-CA","fr-FR","he-IL","hi-IN","hr-HR","hu-HU","id-ID","it-IT","ja-JP","ko-KR","ms-MY","nl-NL","nb-NO","pl-PL","pt-BR","pt-PT","ro-RO","ru-RU","sl-SI","sk-SK","sv-SE","th-TH","tr-TR","uk-UA","vi-VN","zh-CN","zh-HK","zh-TW"],primaryLocales:["en-US","fr-FR","pt-BR","zh-CN"],localesMap:L,regionToScriptMap:S,rtlLocales:["ar-SA","he-IL"],enUSDictionary:{"Annotation.Clustering.AccessibilityLabel":"{{n}} locations, {{title}}, {{subtitle}}","Annotation.Clustering.More":"+{{n}} more","Annotation.Clustering.More.Plural":"+{{n}} more","Annotation.Clustering.NoTitle.AccessibilityLabel":"{{n}} locations, {{subtitle}}","Annotation.Generic.AccessibilityLabel":"{{title}}, {{subtitle}}","Annotation.Marker.AccessibilityLabel":"Marker","Annotation.Pin.AccessibilityLabel":"Pin","Annotation.Pin.Green.AccessibilityLabel":"Green Pin","Annotation.Pin.Purple.AccessibilityLabel":"Purple Pin","Annotation.Pin.Red.AccessibilityLabel":"Red Pin","Compass.Degrees.Plural":"{{n}} degrees","Compass.Degrees.Single":"{{n}} degree","Compass.EastIndicator":"E","Compass.NorthIndicator":"N","Compass.SouthIndicator":"S","Compass.Tooltip":"Rotate the map","Compass.WestIndicator":"W","Legal.Apple.URL":"https://www.apple.com/legal/internet-services/maps/legal-en.html","Legal.Label":"Legal","Location.Error.Message":"Your location can only be shown when location services are enabled and you are connected to the Internet.","Location.Error.Support.Label":"Learn more","Location.Subtitle":"Unknown Address","Location.Title":"Current Location","Logo.Apple.Tooltip":"Apple Maps","Logo.AutoNavi.Tooltip":"AutoNavi Maps","MapType.Tooltip":"Change the map type","Mode.Hybrid":"Hybrid","Mode.Satellite":"Satellite","Mode.Standard":"Standard","OpenInAppleMaps.Label":"Open in Apple Maps","Place.Error.Message":"Could not load place details.","Place.Error.Title":"Place Unavailable","Scale.Feet.Short":"ft","Scale.Kilometer.Short":"km","Scale.Meter.Short":"m","Scale.Mile.Short":"mi","Track.User.Location.Tooltip":"Show your current location","Zoom.In.Tooltip":"Zoom In","Zoom.Out.Tooltip":"Zoom Out"},get localeUrl(){return fe.createUrl("locales/{{locale}}/strings.json")},get withCredentials(){return kt.distUrlWithCredentials}});Ri._useMetric=!1,Ri.addEventListener(xi.Events.LocaleChanged,(function(){const t=k.parse(Ri.requestedLocaleId);Ri._useMetric=Ii(t)})),Ri.useMetric=function(){return this._useMetric},kt.setL10n(Ri);const Oi=Ri,Pi=new WeakMap,Di=window.btoa("Copyright (c) Apple Inc. All rights reserved.");class zi{constructor(t,e){this._delegate=e,this._handleConfigChangedListener=()=>this._handleConfigChanged(),kt.addEventListener(kt.Events.Changed,this._handleConfigChangedListener),this._handleLocaleChangedListener=t=>this._handleLocaleChanged(t),Oi.addEventListener(Oi.Events.LocaleChanged,this._handleLocaleChangedListener),this._container=t}update(){this._delegate.place&&kt.ready?this._renderPlaceIframe():this._removeIframeElement()}destroy(){this._removeIframeElement(),kt.removeEventListener(kt.Events.Changed,this._handleConfigChangedListener),Oi.removeEventListener(Oi.Events.LocaleChanged,this._handleLocaleChangedListener)}_handleLocaleChanged(){this.update()}_handleConfigChanged(){this.update()}_getPlaceAsUrlParams(){const t=this._delegate.place,e=new URLSearchParams;return e.append("uiStyle",this._delegate.uiStyle),t.muid&&e.append("auid",t.muid),t.formattedAddress&&e.append("address",t.formattedAddress),t.coordinate&&e.append("ll",`${t.coordinate.latitude},${t.coordinate.longitude}`),t.name&&e.append("q",t.name),e.append("countryCode",kt.countryCode||""),e.append("lang",Oi.localeId),e.append("mapkitVersion",i.version),kt.enableSourceMap&&e.append("sourcemap","1"),`${kt.uiBaseUrl}/v1/place?${e.toString()}`}_renderPlaceIframe(){this._iframeElement||(this._iframeElement=document.createElement("iframe"),this._container.appendChild(this._iframeElement),this._handleMessageEventListener=t=>this._handleMessageEvent(t),window.addEventListener("message",this._handleMessageEventListener),this._iframeElement.style.display="block",this._iframeElement.style.width="100%",this._iframeElement.style.height="0",this._iframeElement.style.border="none","standalone"===this._delegate.uiStyle&&(this._iframeElement.style.maxWidth="380px",this._iframeElement.style.minWidth="240px",this._iframeElement.style.margin="0 auto",this._iframeElement.style.borderRadius="18px"),this._iframeContentWindowReady=!1);const t=this._getPlaceAsUrlParams();t!==this._iframeElement.src?(this._iframeElement.src=t,this._iframeLoadingTimeout=window.setTimeout((()=>this._frameLoadingDidFail()),3e4)):this._postMessage({action:"set-options",placeKey:Pi.get(this),mapkitVersion:i.version,colorScheme:this._delegate.colorScheme,displaysMap:this._delegate.displaysMap})}_postMessage(t){if(!this._iframeContentWindowReady)return;const e=this._iframeElement.contentWindow;e&&e.postMessage(t,new URL(this._iframeElement.src).origin)}_handleMessageEvent(t){if(t.source===this._iframeElement.contentWindow)switch(t.data.action&&(clearTimeout(this._iframeLoadingTimeout),this._iframeContentWindowReady=!0),t.data.action){case"ready":{const e=((t,e)=>{const i=new Uint8Array(window.atob(t).split("").map((t=>t.charCodeAt(0)))),n=new Uint8Array(window.atob(e).split("").map((t=>t.charCodeAt(0))));return window.btoa(String.fromCharCode(...i.map(((t,e)=>t^n[e%n.length]))))})(Di,t.data.key);Pi.set(this,e);const n={action:"render-place",placeKey:e,accessToken:kt.accessToken,mapkitVersion:i.version,colorScheme:this._delegate.colorScheme,displaysMap:this._delegate.displaysMap};kt._showMapsLogo||(n.showMapsLogo=!1),this._postMessage(n);break}case"update-size":{const e=t.data.width,i=t.data.height;this._iframeElement.style.height=`${i}px`,this._delegate.placeCardSizeDidChange&&this._delegate.placeCardSizeDidChange(e,i);break}case"place-card-did-reveal":this._delegate.placeCardDidReveal&&this._delegate.placeCardDidReveal(t.data.analyticsState);break;case"open-in-maps-clicked":this._delegate.placeCardOpenInMapsClicked&&this._delegate.placeCardOpenInMapsClicked(t.data.analyticsState)}}_frameLoadingDidFail(){this._delegate.loadingDidFail&&this._delegate.loadingDidFail()}_removeIframeElement(){this._iframeElement&&(this._container.removeChild(this._iframeElement),window.removeEventListener("message",this._handleMessageEventListener),clearTimeout(this._iframeLoadingTimeout),this._iframeElement=void 0)}}const Ni=[];class Fi{constructor(t,e=null,i={}){if(!t||!Y(t))throw new Error("[MapKit] `parent` must be a DOM element.");const n=this;this._impl={controllerDelegate:{get colorScheme(){return n._impl.colorScheme},get displaysMap(){return n._impl.displaysMap},get place(){return n._impl.place},uiStyle:"standalone",placeCardDidReveal(t){ze.log(ze.Events.PlaceDetailReveal,{eventValue:"LARGE",eventTarget:"PLACECARD_TRAY",states:{PLACE_CARD:()=>t}})},placeCardOpenInMapsClicked(t){ze.log(ze.Events.PlaceDetailOpenAppleMaps,{eventTarget:"PLACECARD_TRAY",states:{PLACE_CARD:()=>t}})}},element:t,shadowRoot:t.attachShadow({mode:kt.shadowDOMMode||"closed"}),controller:void 0,colorScheme:void 0,displaysMap:void 0,place:null,destroyed:!1},this._impl.controller=new zi(this._impl.shadowRoot,this._impl.controllerDelegate),void 0!==i.colorScheme?this.colorScheme=i.colorScheme:this.colorScheme=Ot.Light,void 0!==i.displaysMap?this.displaysMap=i.displaysMap:this.displaysMap=!0,this.place=e,Ni.push(this)}get element(){return this._impl.element}get place(){return this._impl.place}set place(t){if(!this._impl.destroyed&&t!==this._impl.place){if(null!==t&&(f(t,mi,"[MapKit] The `place` parameter must be a Place."),"CN"===kt.countryCode&&!kt.customUiBaseUrl))throw new Error("[MapKit] PlaceDetail is not supported in China yet.");this._impl.place=t,this._impl.controller.update()}}get colorScheme(){return this._impl.colorScheme}set colorScheme(t){if(!this._impl.destroyed&&t!==this._impl.colorScheme){if(!m(t,Ot))throw new Error("[MapKit] Unknown value for `colorScheme`. Choose from `PlaceDetail.ColorSchemes`.");this._impl.colorScheme=t,this._impl.controller.update()}}get displaysMap(){return this._impl.displaysMap}set displaysMap(t){this._impl.destroyed||t!==this._impl.displaysMap&&(this._impl.displaysMap=!!t,this._impl.controller.update())}destroy(){this._impl.destroyed||(this._impl.destroyed=!0,this._impl.controller.destroy(),Ni.splice(Ni.indexOf(this),1))}}Fi.ColorSchemes=Ot;class Ui{constructor(t,e){this.width=t??0,this.height=e??0}toString(){return`Size[${this.width}, ${this.height}]`}copy(){return new Ui(this.width,this.height)}equals(t){return this.width===t.width&&this.height===t.height}}Ui.Zero=new Ui;class Gi{constructor(t,e,i){this.x=t??0,this.y=e??0,this.z=i??0}toString(){return`Point[${this.x}, ${this.y}, ${this.z}]`}copy(){return new Gi(this.x,this.y,this.z)}equals(t){return this.x===t.x&&this.y===t.y&&this.z===t.z}distanceToPoint(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2)+Math.pow(this.z-t.z,2))}}Gi.Zero=new Gi;class Bi{constructor(t,e,i,n){this.origin=new Gi(t,e),this.size=new Ui(i,n)}static rectFromClientRect(t){const{left:e,top:i,width:n,height:o}=t;return new Bi(e,i,n,o)}static unionOfRects(t){return t.reduce(((t,e)=>t._updateToUnion(e)),t[0].copy())}_update(t,e,i,n){return this.origin.x=t,this.origin.y=e,this.size.width=i,this.size.height=n,this}_updateToIntersect(t){const e=Math.max(this.minX(),t.minX()),i=Math.min(this.maxX(),t.maxX());if(e>i)return this._update(0,0,0,0);const n=Math.max(this.minY(),t.minY()),o=Math.min(this.maxY(),t.maxY());return n>o?this._update(0,0,0,0):this._update(e,n,i-e,o-n)}_updateToUnion(t){const e=Math.min(this.minX(),t.minX()),i=Math.min(this.minY(),t.minY()),n=Math.max(this.maxX(),t.maxX())-e,o=Math.max(this.maxY(),t.maxY())-i;return this._update(e,i,n,o)}toString(){const{x:t,y:e}=this.origin,{width:i,height:n}=this.size;return`Rect[${t}, ${e}, ${i}, ${n}]`}copy(){return new Bi(this.origin.x,this.origin.y,this.size.width,this.size.height)}equals(t){return this.origin.equals(t.origin)&&this.size.equals(t.size)}inset(t,e,i,n){return new Bi(this.origin.x+t,this.origin.y+e,this.size.width-t-i,this.size.height-e-n)}pad(t){return new Bi(this.origin.x-t,this.origin.y-t,this.size.width+2*t,this.size.height+2*t)}minX(){return this.origin.x}minY(){return this.origin.y}midX(){return this.origin.x+this.size.width/2}midY(){return this.origin.y+this.size.height/2}maxX(){return this.origin.x+this.size.width}maxY(){return this.origin.y+this.size.height}intersectionWithRect(t){return this.copy()._updateToIntersect(t)}unionWithRect(t){return this.copy()._updateToUnion(t)}round(){return new Bi(Math.floor(this.origin.x),Math.floor(this.origin.y),Math.ceil(this.size.width),Math.ceil(this.size.height))}}Bi.Zero=new Bi;class Zi{constructor(t,e,i,n,o,s,a,r,l,h,c,d,u,p,m,g){this._data=Wi();const _="string"==typeof t,f=Array.isArray(t);if(_||f){const e="none"===t?[]:f?t:(t.match(/\bmatrix(?:3d)?\(([^)]+)\)/)?.[1]??"").split(",").map((t=>parseFloat(t)));16===e.length?(this.m11=e[0],this.m12=e[1],this.m13=e[2],this.m14=e[3],this.m21=e[4],this.m22=e[5],this.m23=e[6],this.m24=e[7],this.m31=e[8],this.m32=e[9],this.m33=e[10],this.m34=e[11],this.m41=e[12],this.m42=e[13],this.m43=e[14],this.m44=e[15]):6===e.length&&(this.a=e[0],this.b=e[1],this.c=e[2],this.d=e[3],this.e=e[4],this.f=e[5])}else{const _=void 0!==o&&void 0!==s,f=void 0!==t&&void 0!==e&&void 0!==i&&void 0!==n,y=_&&void 0!==a&&void 0!==r,v=void 0!==l&&void 0!==h&&void 0!==c&&void 0!==d,w=void 0!==u&&void 0!==p&&void 0!==m&&void 0!==g;f&&y&&v&&w?(this.m11=t,this.m12=e,this.m13=i,this.m14=n,this.m21=o,this.m22=s,this.m23=a,this.m24=r,this.m31=l,this.m32=h,this.m33=c,this.m34=d,this.m41=u,this.m42=p,this.m43=m,this.m44=g):f&&_&&(this.a=t,this.b=e,this.c=i,this.d=n,this.e=o,this.f=s)}}get a(){return this._data[0][0]}get b(){return this._data[0][1]}get c(){return this._data[1][0]}get d(){return this._data[1][1]}get e(){return this._data[3][0]}get f(){return this._data[3][1]}get m11(){return this._data[0][0]}get m12(){return this._data[0][1]}get m13(){return this._data[0][2]}get m14(){return this._data[0][3]}get m21(){return this._data[1][0]}get m22(){return this._data[1][1]}get m23(){return this._data[1][2]}get m24(){return this._data[1][3]}get m31(){return this._data[2][0]}get m32(){return this._data[2][1]}get m33(){return this._data[2][2]}get m34(){return this._data[2][3]}get m41(){return this._data[3][0]}get m42(){return this._data[3][1]}get m43(){return this._data[3][2]}get m44(){return this._data[3][3]}set a(t){this._data[0][0]=t}set b(t){this._data[0][1]=t}set c(t){this._data[1][0]=t}set d(t){this._data[1][1]=t}set e(t){this._data[3][0]=t}set f(t){this._data[3][1]=t}set m11(t){this._data[0][0]=t}set m12(t){this._data[0][1]=t}set m13(t){this._data[0][2]=t}set m14(t){this._data[0][3]=t}set m21(t){this._data[1][0]=t}set m22(t){this._data[1][1]=t}set m23(t){this._data[1][2]=t}set m24(t){this._data[1][3]=t}set m31(t){this._data[2][0]=t}set m32(t){this._data[2][1]=t}set m33(t){this._data[2][2]=t}set m34(t){this._data[2][3]=t}set m41(t){this._data[3][0]=t}set m42(t){this._data[3][1]=t}set m43(t){this._data[3][2]=t}set m44(t){this._data[3][3]=t}translate(t,e,i){t=t||0,e=e||0,i=i||0;const[n,o,s,a]=this._data[0],[r,l,h,c]=this._data[1],[d,u,p,m]=this._data[2];return this._data[3][0]+=t*n+e*r+i*d,this._data[3][1]+=t*o+e*l+i*u,this._data[3][2]+=t*s+e*h+i*p,this._data[3][3]+=t*a+e*c+i*m,this}scale(t,e,i){return t=t||1,e=e||t,i=i||1,this._data[0][0]*=t,this._data[0][1]*=t,this._data[0][2]*=t,this._data[0][3]*=t,this._data[1][0]*=e,this._data[1][1]*=e,this._data[1][2]*=e,this._data[1][3]*=e,this._data[2][0]*=i,this._data[2][1]*=i,this._data[2][2]*=i,this._data[2][3]*=i,this}rotate(t){return this.rotateAxisAngle(0,0,1,t)}rotateAxisAngle(t,e,i,n){0===t&&0===e&&0===i&&(i=1);const o=Math.sqrt(t*t+e*e+i*i);1!==o&&(t/=o,e/=o,i/=o),n=Ki(n);const s=Math.sin(n),a=Math.cos(n),r=new Zi;if(1===t&&0===e&&0===i)r._data[0][0]=1,r._data[0][1]=0,r._data[0][2]=0,r._data[1][0]=0,r._data[1][1]=a,r._data[1][2]=s,r._data[2][0]=0,r._data[2][1]=-s,r._data[2][2]=a,r._data[0][3]=r._data[1][3]=r._data[2][3]=0,r._data[3][0]=r._data[3][1]=r._data[3][2]=0,r._data[3][3]=1;else if(0===t&&1===e&&0===i)r._data[0][0]=a,r._data[0][1]=0,r._data[0][2]=-s,r._data[1][0]=0,r._data[1][1]=1,r._data[1][2]=0,r._data[2][0]=s,r._data[2][1]=0,r._data[2][2]=a,r._data[0][3]=r._data[1][3]=r._data[2][3]=0,r._data[3][0]=r._data[3][1]=r._data[3][2]=0,r._data[3][3]=1;else if(0===t&&0===e&&1===i)r._data[0][0]=a,r._data[0][1]=s,r._data[0][2]=0,r._data[1][0]=-s,r._data[1][1]=a,r._data[1][2]=0,r._data[2][0]=0,r._data[2][1]=0,r._data[2][2]=1,r._data[0][3]=r._data[1][3]=r._data[2][3]=0,r._data[3][0]=r._data[3][1]=r._data[3][2]=0,r._data[3][3]=1;else{const n=1-a;r._data[0][0]=a+t*t*n,r._data[0][1]=e*t*n+i*s,r._data[0][2]=i*t*n-e*s,r._data[1][0]=t*e*n-i*s,r._data[1][1]=a+e*e*n,r._data[1][2]=i*e*n+t*s,r._data[2][0]=t*i*n+e*s,r._data[2][1]=e*i*n-t*s,r._data[2][2]=a+i*i*n,r._data[0][3]=r._data[1][3]=r._data[2][3]=0,r._data[3][0]=r._data[3][1]=r._data[3][2]=0,r._data[3][3]=1}return this.multiply(r)}multiply(t){const[e,i,n,o]=t._data[0],[s,a,r,l]=t._data[1],[h,c,d,u]=t._data[2],[p,m,g,_]=t._data[3],[f,y,v,w]=this._data[0],[b,C,k,M]=this._data[1],[S,L,A,E]=this._data[2],[x,T,I,R]=this._data[3];return this._data[0][0]=e*f+i*b+n*S+o*x,this._data[0][1]=e*y+i*C+n*L+o*T,this._data[0][2]=e*v+i*k+n*A+o*I,this._data[0][3]=e*w+i*M+n*E+o*R,this._data[1][0]=s*f+a*b+r*S+l*x,this._data[1][1]=s*y+a*C+r*L+l*T,this._data[1][2]=s*v+a*k+r*A+l*I,this._data[1][3]=s*w+a*M+r*E+l*R,this._data[2][0]=h*f+c*b+d*S+u*x,this._data[2][1]=h*y+c*C+d*L+u*T,this._data[2][2]=h*v+c*k+d*A+u*I,this._data[2][3]=h*w+c*M+d*E+u*R,this._data[3][0]=p*f+m*b+g*S+_*x,this._data[3][1]=p*y+m*C+g*L+_*T,this._data[3][2]=p*v+m*k+g*A+_*I,this._data[3][3]=p*w+m*M+g*E+_*R,this}skewX(t){return this._skew(t,0)}skewY(t){return this._skew(0,t)}isAffine(){return 0===this._data[0][2]&&0===this._data[0][3]&&0===this._data[1][2]&&0===this._data[1][3]&&0===this._data[2][0]&&0===this._data[2][1]&&1===this._data[2][2]&&0===this._data[2][3]&&0===this._data[3][2]&&1===this._data[3][3]}inverse(){if(this._isIdentityOrTranslation())return 0===this._data[3][0]&&0===this._data[3][1]&&0===this._data[3][2]||(this._data[3][0]*=-1,this._data[3][1]*=-1,this._data[3][2]*=-1),this;const t=new Zi;return Zi._inverse(this,t)?t:new Zi}transformPoint(t){const[e,i,n]=this._data[0],[o,s,a]=this._data[1],[r,l,h]=this._data[2],[c,d,u]=this._data[3],{x:p,y:m,z:g}=t;return new Gi(e*p+o*m+r*g+c,i*p+s*m+l*g+d,n*p+a*m+h*g+u)}toString(){if(this.isAffine()){const[t,e]=this._data[0],[i,n]=this._data[1],[o,s]=this._data[3];return`matrix(${t}, ${e}, ${i}, ${n}, ${o}, ${s})`}return`matrix3d(${this._data.map((t=>t.join(", "))).join(", ")})`}_isIdentityOrTranslation(){return 1===this._data[0][0]&&0===this._data[0][1]&&0===this._data[0][2]&&0===this._data[0][3]&&0===this._data[1][0]&&1===this._data[1][1]&&0===this._data[1][2]&&0===this._data[1][3]&&0===this._data[2][0]&&0===this._data[2][1]&&1===this._data[2][2]&&0===this._data[2][3]&&1===this._data[3][3]}_skew(t,e){const i=new Zi;return i._data[0][1]=Math.tan(Ki(e)),i._data[1][0]=Math.tan(Ki(t)),this.multiply(i)}_determinant(){const[t,e,i,n]=this._data[0],[o,s,a,r]=this._data[1],[l,h,c,d]=this._data[2],[u,p,m,g]=this._data[3];return t*ji(s,h,p,a,c,m,r,d,g)-e*ji(o,l,u,a,c,m,r,d,g)+i*ji(o,l,u,s,h,p,r,d,g)-n*ji(o,l,u,s,h,p,a,c,m)}static _inverse(t,e){Zi._adjoint(t,e);const i=t._determinant();if(Math.abs(i)<1e-8)return!1;for(let t=0;t<4;t+=1)for(let n=0;n<4;n+=1)e._data[t][n]=e._data[t][n]/i;return!0}static _adjoint(t,e){const[i,n,o,s]=t._data[0],[a,r,l,h]=t._data[1],[c,d,u,p]=t._data[2],[m,g,_,f]=t._data[3];e._data[0][0]=+ji(r,d,g,l,u,_,h,p,f),e._data[1][0]=-ji(a,c,m,l,u,_,h,p,f),e._data[2][0]=+ji(a,c,m,r,d,g,h,p,f),e._data[3][0]=-ji(a,c,m,r,d,g,l,u,_),e._data[0][1]=-ji(n,d,g,o,u,_,s,p,f),e._data[1][1]=+ji(i,c,m,o,u,_,s,p,f),e._data[2][1]=-ji(i,c,m,n,d,g,s,p,f),e._data[3][1]=+ji(i,c,m,n,d,g,o,u,_),e._data[0][2]=+ji(n,r,g,o,l,_,s,h,f),e._data[1][2]=-ji(i,a,m,o,l,_,s,h,f),e._data[2][2]=+ji(i,a,m,n,r,g,s,h,f),e._data[3][2]=-ji(i,a,m,n,r,g,o,l,_),e._data[0][3]=-ji(n,r,d,o,l,u,s,h,p),e._data[1][3]=+ji(i,a,c,o,l,u,s,h,p),e._data[2][3]=-ji(i,a,c,n,r,d,s,h,p),e._data[3][3]=+ji(i,a,c,n,r,d,o,l,u)}}const Wi=()=>[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],Ki=t=>t/180*Math.PI,Hi=(t,e,i,n)=>t*n-e*i,ji=(t,e,i,n,o,s,a,r,l)=>t*Hi(o,s,r,l)-n*Hi(e,i,r,l)+a*Hi(e,i,o,s);function Vi(t){const e=t.getBoundingClientRect(),i=t.offsetWidth,n=t.offsetHeight,o=[new Gi(0,0),new Gi(i,0),new Gi(i,n),new Gi(0,n)];let s=new Zi;const a=t.ownerDocument.defaultView;let r,l=t;for(;l.nodeType===Node.ELEMENT_NODE&&(r=a.getComputedStyle(t),s=new Zi(r.transform).multiply(s),l.parentNode);)l=l.parentNode;let h=1/0,c=1/0;o.forEach((function(t){const e=s.transformPoint(t);h=Math.min(h,e.x),c=Math.min(c,e.y)}));const d=window.pageXOffset+e.left-h,u=window.pageYOffset+e.top-c;return(new Zi).translate(d,u).multiply(s)}const qi=function(t,e){return Vi(t).inverse().transformPoint(e)},Yi=function(t,e){return Vi(t).transformPoint(e)},Xi=qi;let $i=[],Ji=!1;function Qi(){const t=$i;$i=[];const e=[];for(let i=0,n=t.length;i<n;++i){const n=t[i].scene;if(n&&tn(e,n)){const t=n.performanceMeasureName?performance.now():void 0;n.renderer.update(),n.performanceMeasureName&&performance.measure(n.performanceMeasureName,{start:t}),n.sceneDidUpdate&&n.sceneDidUpdate(n,Ji)}}}function tn(t,e){return-1===t.indexOf(e)&&(t.push(e),!0)}const en={scheduleNode:function(t){tn($i,t)&&1===$i.length&&ue.scheduleDraw(Qi)},flush(t){Ji=!0;const e=$i;$i=[];const i=[];for(let n=0,o=e.length;n<o;++n)e[n].scene===t?$i.push(e[n]):i.push(e[n]);Qi(),Ji=!1,$i=i}},nn=(new Zi).toString();function on(){this._parent=null,this._children=[],this._renderer=null,this._opacity=1,this._size=new Ui,this._position=new Gi,this._transform=new Zi,this._frozen=!1,this._keyForFrozenLayer="",this._wantsLayerBacking=!1}function sn(t){t._parent=null;const e=[t];for(;e.length>0;){const t=e.pop();t.wasRemoved(),t._renderer&&"function"==typeof t._renderer.nodeWasRemoved&&t._renderer.nodeWasRemoved(),Array.prototype.push.apply(e,t.children)}}function an(t){let e=null,i=0,n=0;for(;t&&!e;){const o=t.transform.transformPoint(t.position);i-=o.x,n-=o.y,e=(t=t.parent).element}return{element:e,offsetX:i,offsetY:n}}function rn(t,e,i,n,o){let s="";if(s+=e,o&&(s+=function(t){return t<0?"":t+":"}(i)),s+=t.toString(),s+=function(t){return t.childCount<1?"":" â¤µï¸ "+t.childCount}(t),t.extraInfo&&"function"==typeof t.extraInfo&&t.extraInfo().forEach((t=>{s+="\n"+e+"| "+t})),0===n)return s;const a=t.children;for(let i=0,r=a.length;i<r;++i){const r=t.childCount<1?-1:i;s+="\n",s+=rn(a[i],e+"    ",r,n-1,o)}return s}on.prototype={constructor:on,isScene:!1,get scene(){for(let t=this;t;t=t._parent)if(t.isScene)return t},get renderer(){return this._renderer},get wantsLayerBacking(){return!!this.keyForFrozenLayer||this._frozen||this._wantsLayerBacking||this._needsLayerBacking()},set wantsLayerBacking(t){t!==this._wantsLayerBacking&&(this._wantsLayerBacking=t,this.needsDisplay=!0)},get frozen(){return!!this.keyForFrozenLayer||this._frozen},set frozen(t){t!==this._frozen&&(this._frozen=t,this.needsDisplay=!0)},get keyForFrozenLayer(){return this._keyForFrozenLayer},set keyForFrozenLayer(t){t!==this._keyForFrozenLayer&&(this._keyForFrozenLayer=t,this.needsDisplay=!0)},get opacity(){return this._opacity},set opacity(t){(t=Math.min(Math.max(0,t),1))!==this._opacity&&(this._opacity=t,this.needsDisplay=!0)},get position(){return this._position},set position(t){t.equals(this._position)||(this._position=t.copy(),this.needsDisplay=!0)},get transform(){return this._transform},set transform(t){this._transform=t,this.needsDisplay=!0},get size(){return this._size},set size(t){this._size=t||new Ui,this.needsDisplay=!0},get bounds(){return new Bi(this._position.x,this._position.y,this.size.width,this.size.height)},get layerBounds(){let t=new Bi(0,0,this.size.width,this.size.height);const e=this._children;for(let i=0,n=e.length;i<n;++i){const n=e[i],o=n.layerBounds;o.origin.x+=n._position.x,o.origin.y+=n._position.y;const s=n.transform,a=[s.transformPoint(new Gi(o.minX(),o.minY())),s.transformPoint(new Gi(o.maxX(),o.minY())),s.transformPoint(new Gi(o.maxX(),o.maxY())),s.transformPoint(new Gi(o.minX(),o.maxY()))];let r=a[0].x,l=a[0].y,h=a[0].x,c=a[0].y;for(let t=1;t<a.length;++t){const e=a[t];e.x<r&&(r=e.x),e.x>h&&(h=e.x),e.y<l&&(l=e.y),e.y>c&&(c=e.y)}t=t.unionWithRect(new Bi(r,l,h-r,c-l))}return t},set needsDisplay(t){t&&en.scheduleNode(this)},get parent(){return this._parent},get children(){return this._children},set children(t){let e=0,i=0;const n=[].concat(this._children);for(;e<t.length;)n[i]!==t[e]?n[i]&&-1===t.indexOf(n[i])?(this.removeChild(n[i]),i++):(t[e]._parent===this&&n.splice(n.indexOf(t[e]),1),this.addChild(t[e],e),e++):(e++,i++);for(;i<n.length;)this.removeChild(n[i]),i++},get childCount(){return this._children.length},get firstChild(){return this._children[0]||null},get lastChild(){return this._children[this._children.length-1]||null},get previousSibling(){if(!this._parent)return null;const t=this._parent._children,e=t.indexOf(this);return e>0?t[e-1]:null},get nextSibling(){if(!this._parent)return null;const t=this._parent._children,e=t.indexOf(this);return-1!==e&&e<t.length-1?t[e+1]:null},isTainted(){return this._children.some((t=>t.isTainted()))},toString:function(){let t="";return this.element&&(t+="ð· "),this.wantsLayerBacking&&(t+="ð "),this.frozen&&(t+="âï¸ ",this.keyForFrozenLayer&&(t+="<"+this.keyForFrozenLayer+">")),this.stringInfo&&"function"==typeof this.stringInfo?t+=this.stringInfo():t+="UnknownNode",0===this.position.x&&0===this.position.y||(t+=" ("+this.position.x+", "+this.position.y+")"),"number"==typeof this.repeatOffset&&(t+=(this.repeatOffset>0?"+":"")+this.repeatOffset+" "),0===this.size.width&&0===this.size.height||(t+=" "+this.size.width+"x"+this.size.height),1!==this.opacity&&(t+=" [opacity:"+this.opacity+"]"),this.transform.toString()!==nn&&(t+=" ["+this.transform.toString()+"]"),this.animators&&this.animators.forEach((e=>{t+=" "+e.stringInfo()})),t},dump:function(t,e){return void 0===t&&(t=1/0),rn(this,"",-1,t,!!e)},addChild:function(t,e){return t.remove(),(void 0===e||e<0||e>this._children.length)&&(e=this._children.length),this._children.splice(e,0,t),t._parent=this,this.needsDisplay=!0,t},insertBefore:function(t,e){return this.addChild(t,this._children.indexOf(e))},insertAfter:function(t,e){return this.addChild(t,this._children.indexOf(e)+1)},removeChild:function(t){if(t._parent!==this)return;const e=this._children.indexOf(t);return-1!==e?(this._children.splice(e,1),sn(t),this.needsDisplay=!0,t):void 0},replaceChild:function(t,e){if(!e||e._parent!==this)return;const i=this._children.indexOf(e);return t.remove(),this._children.splice(i,1,t),sn(e),t._parent=this,this.needsDisplay=!0,e},remove:function(){if(this._parent instanceof on)return this._parent.removeChild(this)},wasRemoved:function(){},convertPointFromPage:function(t){if(this.element)return qi(this.element,t);const e=an(this),i=qi(e.element,t);return new Gi(i.x+e.offsetX,i.y+e.offsetY)},convertPointToPage:function(t){if(this.element)return Yi(this.element,t);const e=an(this),i=Yi(e.element,t);return new Gi(i.x-e.offsetX,i.y-e.offsetY)},_needsLayerBacking:function(){return this.opacity<1&&(this._children.length>1||1===this._children.length&&this._children[0]._children.length>0)}};const ln=on,hn="dark",cn="light",dn="NETWORK_ERROR",un="BROWSER_SUPPORT_ERROR",pn="RENDERER_ERROR",mn="FEATURE_ERROR",gn="UNKNOWN_ERROR",_n="CONFIGURATION_CHANGE_FALLBACK",fn="CONFIGURATION_MISSING_FALLBACK",yn={blue:[0,122,255],green:[52,199,89],indigo:[88,86,214],orange:[255,149,0],pink:[255,45,85],purple:[175,82,222],red:[255,59,48],teal:[90,200,250],yellow:[255,204,0],gray:[142,142,147],gray2:[174,174,178],gray3:[199,199,204],gray4:[209,209,214],gray5:[229,229,234],gray6:[242,242,247]},vn={Satellite:"satellite",Hybrid:"hybrid",MutedStandard:"mutedStandard",Standard:"standard"},wn="46",bn="1",Cn={BaseMap:"basemap",Roads:"roads",Borders:"borders",Buildings:"buildings",Icons:"icons",Labels:"labels"},kn={Normal:"normal",Multiply:"multiply",HardLight:"hard-light",SoftLight:"soft-light"},Mn={Normal:"normal",Grayscale:"grayscale"},Sn={LandCover:"LandCover",PointsOfInterest:"PointsOfInterest",None:null},Ln="muted",An="standard",En={Adaptive:"adaptive",Hidden:"hidden",Visible:"visible"},xn={default:yn,light:yn,dark:{blue:[10,132,255],green:[48,209,88],indigo:[94,92,230],orange:[255,159,10],pink:[255,55,95],purple:[191,90,242],red:[255,69,58],teal:[100,210,255],yellow:[255,214,10],gray:[142,142,147],gray2:[99,99,102],gray3:[72,72,74],gray4:[58,58,60],gray5:[44,44,46],gray6:[28,28,30]}},Tn='"SFProRegular", "-apple-system", "BlinkMacSystemFont", "Helvetica Neue", Helvetica, Arial, sans-serif',In="BUTTON",Rn="SCROLL",On="DOUBLE_TAP",Pn="PINCH",Dn={minimumSizeToShowControls:new Ui(306,220),minimumSizeToShowLogo:new Ui(200,100),minimumSizeToShowLogoWithReducedMargin:new Ui(100,100),maximumSizeControlsNormal:new Ui(1024,0)};class zn{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.z=i}toString(){const{x:t,y:e,z:i}=this;return!t||e||i?!e||t||i?!i||t||e?i?`translate3d(${t}px, ${e}px, ${i}px)`:`translate(${t}px, ${e}px)`:`translateZ(${i}px)`:`translateY(${e}px)`:`translateX(${t}px)`}}class Nn{constructor(t=1,e=t,i=1){this.x=t,this.y=e,this.z=i}toString(){const{x:t,y:e,z:i}=this;return 1!==t&&1===e&&1===i?`scaleX(${t})`:1!==e&&1===t&&1===i?`scaleY(${e})`:1!==i&&1===t&&1===e?`scaleZ(${i})`:1===i&&t===e?`scale(${t})`:1===i?`scale(${t}, ${e})`:`scale3d(${t}, ${e}, ${i})`}}class Fn{constructor(t=0){this.angle=t}toString(){return`rotate(${this.angle}deg)`}}class Un{constructor(t=0,e=0){this.x=t,this.y=e}toString(){const{x:t,y:e}=this;return 0!==t&&0===e?`skewX(${t}deg)`:0!==e&&0===t?`skewY(${e}deg)`:`skew(${t}deg, ${e}deg)`}}class Gn{constructor(t=0,e=0,i=0,n=0){this.x=t,this.y=e,this.z=i,this.angle=n}toString(){return`rotate3d(${this.x}, ${this.y}, ${this.z}, ${this.angle}deg)`}}const Bn=class{constructor(){this._operations=[]}translate(t=0,e=0,i=0){return this._operations.push(new zn(t,e,i)),this}scale(t=1,e=t,i=1){return this._operations.push(new Nn(t,e,i)),this}rotate(t=0){return this._operations.push(new Fn(t)),this}rotate3d(t=0,e=0,i=0,n=0){return this._operations.push(new Gn(t,e,i,n)),this}skew(t=0,e=0){return this._operations.push(new Un(t,e)),this}transform(t){return Array.isArray(t)?this._operations.push(...t):this._operations.push(t),this}toString(){return this._operations.map((t=>t.toString())).join(" ")}};let Zn=[],Wn=[];const Kn=Object.freeze({None:0,Removal:1,Addition:2,AttachAsShadowRoot:3});let Hn;class jn{constructor(){this._parent=null,this._children=[],this._dirtyAttributes={},this._dirtyProperties=[],this._doNotNotifyParentChange=!1,this.domNode=null,this.nodeIsShadowRoot=!1}get parent(){return this._parent}get children(){return this._children}set children(t){const e=this._children;for(;e.length;)this.removeChild(e[0]);t.forEach((t=>{this.addChild(t)}))}get childCount(){return this._children.length}get firstChild(){return this._children[0]||null}get lastChild(){return this._children[this._children.length-1]||null}get previousSibling(){if(!this._parent)return null;const t=this._parent._children,e=t.indexOf(this);return e>0?t[e-1]:null}get nextSibling(){if(!this._parent)return null;const t=this._parent._children,e=t.indexOf(this);return-1!==e&&e<t.length-1?t[e+1]:null}addChild(t,e){if(0===e&&this._children[0]&&this._children[0].nodeIsShadowRoot)throw new TypeError("RenderTree.RenderNode.addChild: Node cannot insert before shadow root node.");return t.willMoveToParent(this),t._doNotNotifyParentChange=!0,t.remove(),delete t._doNotNotifyParentChange,(void 0===e||e<0||e>this._children.length)&&(e=this._children.length),this._children.splice(e,0,t),t._parent=this,t.didMoveToParent(this),this.didAddChild(t),t._markNodeManipulation(Kn.Addition),t}insertBefore(t,e){return this.addChild(t,e?this._children.indexOf(e):-1)}insertAfter(t,e){const i=e?this._children.indexOf(e):-1;return this.addChild(t,-1!==i?i+1:0)}removeChild(t){if(t._parent!==this)return;const e=this._children.indexOf(t);if(-1!==e){if(t.nodeIsShadowRoot)throw new TypeError("RenderTree.RenderNode: Not supported in ShadowRoot-backed RenderNode.");return this.willRemoveChild(t),t._doNotNotifyParentChange||t.willMoveToParent(null),this._children.splice(e,1),t._parent=null,t._doNotNotifyParentChange||t.didMoveToParent(null),t._markNodeManipulation(Kn.Removal),t}}remove(){if(this._parent instanceof jn)return this._parent.removeChild(this)}dump(t){return io(this,"",-1,t)}willRemoveChild(t){}didAddChild(t){}willMoveToParent(t){}didMoveToParent(t){}_markDirtyProperty(t,e){let i;i=void 0===e||e?to(this._dirtyProperties,t):eo(this._dirtyProperties,t),i&&this._updateNodeDirtiness()}_markNodeManipulation(t){this._pendingDOMManipulation=t,this._updateNodeDirtiness()}_updateNodeDirtiness(){var t;t=this,this._pendingDOMManipulation!==Kn.None||this._dirtyProperties.length>0||Object.getOwnPropertyNames(this._dirtyAttributes).length>0?(to(Zn,t),ue.scheduleDraw(Yn)):eo(Zn,t)}}class Vn extends jn{constructor(t){super(),this.shadowRootMode=t,this.nodeIsShadowRoot=!0}toString(){return this.stringInfo()+" ["+this.shadowRootMode+"]"}stringInfo(){return"#shadow-root"}}class qn extends jn{constructor(t){let e;var i;super(),e=(i=t)instanceof window.Node&&i.nodeType===window.Node.ELEMENT_NODE?t:"string"==typeof t?function(t){const e=document.createElement("div");e.innerHTML=t;const i=e.firstElementChild;if(!(i instanceof Text||i instanceof HTMLElement||i instanceof Text))throw new Error("");return i}(t):"object"==typeof t?Qn(t):document.createElement("div"),this.domNode=e,this._opacity=1,this._color="",this._size=new Ui,this._position=new Gi,this._transform=new Bn,this._backgroundImages=[],this._classList=new no(this),this._wantsHardwareCompositing=!1,this._pendingDOMManipulation=Kn.None}get element(){return this.domNode}set element(t){this.domNode=t}get classList(){return this._classList}get wantsHardwareCompositing(){return this._wantsHardwareCompositing}set wantsHardwareCompositing(t){t!==this._wantsHardwareCompositing&&(this._wantsHardwareCompositing=t,this._markDirtyProperty("will-change"))}get opacity(){return this._opacity}set opacity(t){(t=Math.min(Math.max(0,t),1))!==this._opacity&&(this._opacity=t,this._markDirtyProperty("opacity"))}get color(){return this._color}set color(t){t!==this._color&&(this._color=t,this._markDirtyProperty("color"))}get position(){return this._position}set position(t){this._position=t,this._markDirtyProperty("position")}get transform(){return this._transform}set transform(t){this._transform=t,this._markDirtyProperty("transform")}get backgroundImages(){return this._backgroundImages}set backgroundImages(t){this._backgroundImages=t||[],this._markDirtyProperty("backgroundImages")}get size(){return this._size}set size(t){this._size=t||new Ui,this._markDirtyProperty("size")}setAttribute(t,e){if(this.domNode instanceof Text)throw new Error("");this._dirtyAttributes[t]=e,this._updateNodeDirtiness()}removeAttribute(t){if(this.domNode instanceof Text)throw new Error("");this._dirtyAttributes[t]=null,this._updateNodeDirtiness()}createAndAddShadowRootChild(t){if(this.domNode instanceof Text||this.domNode instanceof SVGElement)throw new Error("");if(this._children[0]&&this._children[0].nodeIsShadowRoot)throw new Error("RenderTree.RenderNode.createAndAddShadowRootChild: Cannot add more than one shadow root.");const e=new Vn(t||"closed");return this._children.unshift(e),e._parent=this,this.didAddChild(e),e._markNodeManipulation(Kn.AttachAsShadowRoot),e}convertPointFromPage(t){if(!(this.domNode instanceof HTMLElement))throw new Error("");return qi(this.domNode,t)}convertPointToPage(t){if(!(this.domNode instanceof HTMLElement))throw new Error("");return Yi(this.domNode,t)}toString(){let t="";return this._wantsHardwareCompositing&&(t+="ð "),t+=this.stringInfo(),this.classList.toString()&&(t+=this.classList._classes().map((function(t){return"."+t})).join(", ")),0===this.position.x&&0===this.position.y||(t+=" ("+this.position.x+", "+this.position.y+")"),0===this.size.width&&0===this.size.height||(t+=" "+this.size.width+"x"+this.size.height),1!==this.opacity&&(t+=" [opacity:"+this.opacity+"]"),this.transform.toString()&&(t+=" ["+this.transform.toString()+"]"),t}stringInfo(){return this.domNode instanceof Element?"<"+this.domNode.tagName.toLowerCase()+">":"<#text>"}}function Yn(){const t=Hn?performance.now():void 0;Zn.forEach(Xn),Zn=[],Wn.forEach($n),Wn=[],qn.updates++,oo.dispatchEvent(new x.Event("update")),Hn&&performance.measure(Hn,{start:t})}function Xn(t){if(t._pendingDOMManipulation===Kn.Removal){const e=t.domNode?.parentNode;e&&t.domNode&&e.removeChild(t.domNode)}if(t._dirtyProperties){const e=t;e._dirtyProperties.forEach((function(t){!function(t,e){const i=t.domNode;if(!(i instanceof HTMLElement||i instanceof SVGElement))return;const n=i.style;switch(e){case"opacity":n.opacity=t._opacity.toString();break;case"color":n.color=t._color;break;case"size":n.width=t._size.width+"px",n.height=t._size.height+"px";break;case"will-change":n.willChange=t._wantsHardwareCompositing?"transform":"";break;case"position":case"transform":{const e=(new Bn).translate(Jn(t._position.x),Jn(t._position.y)).transform(t._transform.toString());n.transform=e.toString();break}case"backgroundImages":!function(t){if(!(t.domNode instanceof HTMLElement||t.domNode instanceof SVGElement))return;const e=t.domNode.style;if(!t._backgroundImages.length)return e.removeProperty("background-image"),e.removeProperty("background-position"),void e.removeProperty("background-size");const i=[],n=[],o=[],s=t._backgroundImages;for(let t=s.length-1;t>=0;--t){const e=s[t];i.push("url("+e.url+")"),n.push(e.position.x+"px "+e.position.y+"px"),o.push(e.size.width+"px "+e.size.height+"px")}e.backgroundImage=i.join(","),e.backgroundPosition=n.join(","),e.backgroundSize=o.join(",")}(t);break;case"classList":i.setAttribute("class",t._classList.toString()),t._classList.reset();break;default:;}}(e,t)})),e._dirtyProperties=[]}if(t._dirtyAttributes){const e=t.domNode;Object.getOwnPropertyNames(t._dirtyAttributes).forEach((function(i){const n=t._dirtyAttributes[i];null===n?e.removeAttribute(i):e.setAttribute(i,n)})),t._dirtyAttributes={}}t._pendingDOMManipulation!==Kn.Addition&&t._pendingDOMManipulation!==Kn.AttachAsShadowRoot||to(Wn,t.parent)}function $n(t){let e=null;const i=t.domNode;for(let n=t.children.length-1;n>=0;--n){const o=t.children[n],s=o.domNode;switch(o._pendingDOMManipulation){case Kn.Addition:i.insertBefore(s,e),o._pendingDOMManipulation=Kn.None;break;case Kn.AttachAsShadowRoot:{const t=i.attachShadow({mode:o.shadowRootMode});o.domNode=t,o._pendingDOMManipulation=Kn.None;break}}e=s}}function Jn(t){const e=Math.max(Math.round(window.devicePixelRatio),1);return Math.round(t*e)/e}function Qn(t){const e=t.name;if("#text"===e)return document.createTextNode(t.value??"");const i=document.createElement(e),n=t.attributes;for(const t in n)i.setAttribute(t,n[t]);return t.children instanceof Array&&t.children.forEach((function(t){i.appendChild(Qn(t))})),i}function to(t,e){return-1===t.indexOf(e)&&(t.push(e),!0)}function eo(t,e){const i=t.indexOf(e);return-1!==i&&(t.splice(i,1),!0)}function io(t,e,i,n){let o="";o+=e,n&&(o+=function(t){return t<0?"":t+":"}(i)),o+=t.toString(),o+=function(t){return t.childCount<1?"":" â¤µï¸ "+t.childCount}(t);const s=t.children;for(let i=0,a=s.length;i<a;++i){const a=t.childCount<1?-1:i;o+="\n",o+=io(s[i],e+"    ",a,n)}return o}qn.updates=0;class no{constructor(t){this._node=t,this._additions=[],this._removals=[],this.__classes=[],this._populateClasses=!0}add(t){this._add(t)}remove(t){this._remove(t)}contains(t){return-1!==this._classes().indexOf(t)}toggle(t,e){if(arguments.length>1)return e?this._add(t):this._remove(t),!!e;this._add(t)||this._remove(t)}toString(){return this._classes().join(" ")}_classes(){if(this._populateClasses){let t=this._node.domNode instanceof HTMLElement||this._node.domNode instanceof SVGElement?this._node.domNode.className:"";"string"==typeof t.baseVal&&(t=t.baseVal),this.__classes=t.split(/[ ]+/).filter(Boolean),delete this._populateClasses}return this.__classes}reset(){this._additions=[],this._removals=[],this.__classes=[],this._populateClasses=!0}_add(t){if(!t)return!1;const e=to(this._classes(),t);return e&&(eo(this._removals,t)||to(this._additions,t),this._updateNodeDirtiness()),e}_remove(t){if(!t)return!1;const e=eo(this._classes(),t);return e&&(eo(this._additions,t)||to(this._removals,t),this._updateNodeDirtiness()),e}_updateNodeDirtiness(){this._node._markDirtyProperty("classList",this._additions.length>0||this._removals.length>0)}}const oo=new class extends x.EventTarget{constructor(){super(),this.Node=qn,this.Point=Gi,this.Transform=Bn}setPerformanceMeasureName(t){Hn=t}},so=oo;class ao extends x.EventTarget{constructor(){super(),this.modifierKeys={alt:!1,ctrl:!1,meta:!1,shift:!1},this.useGestures=!1,this._targetTouches=[],this._lastKnownEventLocation=null,this._shouldHandleTrackingEvents=!1,this._domEvents=[],this.events=void 0,this._mode=void 0,this.mode=ao.Modes.Adaptive,this._enabled=!0,this._target=null,this.state=ao.States.Possible,this.delegate=null}get mode(){return this._mode}set mode(t){if(this._mode!==t){if(this._targetTouches.length)throw new Error("");switch(this._removeBaseListeners(),t){case ao.Modes.Adaptive:ao.SupportsPointerEvents?this.events=mo.Pointer:ao.SupportsTouches?this.events=mo.Touch:this.events=mo.Mouse;break;case ao.Modes.Pointer:this.events=mo.Pointer;break;case ao.Modes.Touch:this.events=mo.Touch;break;case ao.Modes.Mouse:this.events=mo.Mouse}this._mode=t,this._updateBaseListeners()}}get currentMode(){if(this._mode===ao.Modes.Adaptive)switch(this.events){case mo.Pointer:return ao.Modes.Pointer;case mo.Touch:return ao.Modes.Touch;case mo.Mouse:return ao.Modes.Mouse}return this._mode}get target(){return this._target}set target(t){this._target!==t&&(this._removeBaseListeners(),t&&(this._target=t,this._initRecognizer()))}get numberOfTouches(){return this._targetTouches.length}get enabled(){return this._enabled}set enabled(t){this._enabled!==t&&(this._enabled=t,t||(0===this.numberOfTouches?(this._removeTrackingListeners(),this.reset()):this.enterCancelledState()),this._updateBaseListeners())}get domEvents(){return this._domEvents}reset(){}preventDefault(t){"touchmove"!==t.type&&"pointer"!==t.type.substr(0,7)&&t.preventDefault()}locationInElement(t){const e=new Gi,i=this._targetTouches;if(this._lastKnownEventLocation)e.x=this._lastKnownEventLocation.pageX,e.y=this._lastKnownEventLocation.pageY;else{const t=i.length;for(let n=0;n<t;++n){const t=i[n];e.x+=t.pageX,e.y+=t.pageY}e.x/=t,e.y/=t}return t?Xi(t,e):e}locationInClient(){const t=new Gi,e=this._targetTouches;if(this._lastKnownEventLocation)t.x=this._lastKnownEventLocation.clientX,t.y=this._lastKnownEventLocation.clientY;else{const i=e.length;for(let n=0;n<i;++n){const i=e[n];t.x+=i.clientX,t.y+=i.clientY}t.x/=i,t.y/=i}return t}locationOfTouchInElement(t,e){const i=this._targetTouches[t];if(!i)return new Gi;const n=new Gi(i.pageX,i.pageY);return e?Xi(e,n):n}touchesBegan(t){t.currentTarget===this._target&&(this._shouldHandleTrackingEvents=!0,window.addEventListener(this.events.Move,this,!0),window.addEventListener(this.events.End,this,!0),this.events.Cancel&&window.addEventListener(this.events.Cancel,this,!0),this.enterPossibleState())}touchesMoved(t){}touchesEnded(t){}touchesCancelled(t){}gestureBegan(t){t.currentTarget===this._target&&(window.addEventListener(this.events.GestureChange,this,!0),window.addEventListener(this.events.GestureEnd,this,!0),this.enterPossibleState())}gestureChanged(t){}gestureEnded(t){}enterPossibleState(){this._setStateAndNotifyOfChange(ao.States.Possible)}enterBeganState(){!this.delegate||"function"!=typeof this.delegate.gestureRecognizerShouldBegin||this.delegate.gestureRecognizerShouldBegin(this)?this._setStateAndNotifyOfChange(ao.States.Began):this.enterFailedState()}enterEndedState(){this._setStateAndNotifyOfChange(ao.States.Ended),this._removeTrackingListeners(),this.reset()}enterCancelledState(){this._setStateAndNotifyOfChange(ao.States.Cancelled),this._removeTrackingListeners(),this.reset()}enterFailedState(){this._setStateAndNotifyOfChange(ao.States.Failed),this._removeTrackingListeners(),this.reset()}enterChangedState(){this._setStateAndNotifyOfChange(ao.States.Changed)}enterRecognizedState(){this._setStateAndNotifyOfChange(ao.States.Recognized)}handleEvent(t){this._shouldCountAndHandleTouch(t)&&(this.lastEventTimeStamp=t.timeStamp,this._updateTargetTouches(t),this._updateKeyboardModifiers(t),this._handleTouches(t))}_handleTouches(t){if(this._shouldHandleTouch(t))switch(t.type){case this.events.Start:this.touchesBegan(t);break;case this.events.Move:this.touchesMoved(t);break;case this.events.End:this.touchesEnded(t);break;case this.events.Cancel:this.touchesCancelled(t);break;case this.events.GestureStart:this.gestureBegan(t);break;case this.events.GestureChange:this.gestureChanged(t);break;case this.events.GestureEnd:this.gestureEnded(t)}}_shouldCountAndHandleTouch(t){if(this.events!==mo.Pointer)return!0;if(!(t instanceof PointerEvent))return!0;const e=this._targetTouches[0];return!(e&&e instanceof PointerEvent&&t.pointerType!==e.pointerType&&e.pointerId!==t.pointerId)}_shouldHandleTouch(t){return this.events!==mo.Pointer||(t.type===this.events.Start||t.type===this.events.GestureStart||t.type===this.events.GestureChange||t.type===this.events.GestureEnd||this._shouldHandleTrackingEvents)}_initRecognizer(){this.reset(),this.state=ao.States.Possible,this._updateBaseListeners()}_removeBaseListeners(){this._target&&(this._target.removeEventListener(this.events.Start,this),this.useGestures&&this._target.removeEventListener(this.events.GestureStart,this),this.events===mo.Pointer&&(this._targetTouches=[],window.removeEventListener(this.events.End,this,!0),window.removeEventListener(this.events.Cancel,this,!0)))}_updateBaseListeners(){this._target&&(this._enabled?(this._target.addEventListener(this.events.Start,this),this.useGestures&&this._target.addEventListener(this.events.GestureStart,this),this.events===mo.Pointer&&(window.addEventListener(this.events.End,this,!0),window.addEventListener(this.events.Cancel,this,!0))):this._removeBaseListeners())}_removeTrackingListeners(){this._shouldHandleTrackingEvents=!1,window.removeEventListener(this.events.Move,this,!0),this.events!==mo.Pointer&&(window.removeEventListener(this.events.End,this,!0),this.events.Cancel&&window.removeEventListener(this.events.Cancel,this,!0)),window.removeEventListener(this.events.GestureChange,this,!0),window.removeEventListener(this.events.GestureEnd,this,!0)}_setStateAndNotifyOfChange(t){this.state=t,this.dispatchEvent(new x.Event(this.events.StateChange))}_setLastKnownSinglePointLocation(t){this._lastKnownEventLocation={clientX:t.clientX,clientY:t.clientY,pageX:t.pageX,pageY:t.pageY}}_updateTargetTouches(t){if(t.type===this.events.GestureStart||t.type===this.events.GestureChange||t.type===this.events.GestureEnd){const e=t;return void this._setLastKnownSinglePointLocation(e)}if(this.events===mo.Mouse){const e=t;return void(t.type===this.events.End?(this._targetTouches=[],this._setLastKnownSinglePointLocation(e)):(this._targetTouches=[e],this._lastKnownEventLocation=null))}let e,i,n;if(this.events===mo.Touch){const o=t,s=this._targetTouches;if(o.type===this.events.Start){for(this._targetTouches=[],e=o.targetTouches,i=0,n=e.length;i<n;++i)this._targetTouches.push(e[i]);return void(this._lastKnownEventLocation=null)}if(o.type===this.events.Move){const t=s.map((t=>t.identifier));for(this._targetTouches=[],e=o.touches,i=0,n=e.length;i<n;++i){const n=e[i];-1!==t.indexOf(n.identifier)&&this._targetTouches.push(n)}return void(this._lastKnownEventLocation=null)}const a=o.touches,r=[];for(i=0,n=a.length;i<n;++i)r.push(a[i].identifier);return this._targetTouches=s.filter((t=>-1!==r.indexOf(t.identifier))),void(0===this._targetTouches.length?this._setLastKnownSinglePointLocation(a[0]):this._lastKnownEventLocation=null)}if(this.events===mo.Pointer){const e=t,i=this._targetTouches;return t.type===this.events.Start?(this._targetTouches.push(e),void(this._lastKnownEventLocation=null)):t.type===this.events.Move?(this._targetTouches=i.map((t=>t.pointerId!==e.pointerId?t:e)),void(this._lastKnownEventLocation=null)):(this._targetTouches=i.filter((t=>t.pointerId!==e.pointerId)),void(0===this._targetTouches.length?this._setLastKnownSinglePointLocation(e):this._lastKnownEventLocation=null))}throw new Error("")}_updateKeyboardModifiers(t){this.modifierKeys.alt=t.altKey,this.modifierKeys.ctrl=t.ctrlKey,this.modifierKeys.meta=t.metaKey,this.modifierKeys.shift=t.shiftKey}_distance(){if(2!==this.numberOfTouches)return 0;const t=this._targetTouches[0],e=new Gi(t.pageX,t.pageY),i=this._targetTouches[1],n=new Gi(i.pageX,i.pageY);return e.distanceToPoint(n)}}ao.Modes=Object.freeze({Adaptive:"adaptive",Pointer:"pointer",Touch:"touch",Mouse:"mouse"});const ro="PointerEvent"in window;ao.SupportsPointerEvents=ro;const lo="ontouchmove"in document;ao.SupportsTouches=lo;const ho=!!window.GestureEvent;let co,uo;ao.SupportsGestures=ho,ao.SupportsGestures?ao.SupportsPointerEvents?co=uo=!ao.SupportsTouches:(co=!ao.SupportsTouches,uo=!0):(co=!1,uo=!1),ao.UseGesturesForRotation=co,ao.UseGesturesForPinch=uo;const po=Object.freeze({Possible:"possible",Began:"began",Changed:"changed",Ended:"ended",Cancelled:"cancelled",Failed:"failed",Recognized:"ended"});ao.States=po;const mo=Object.freeze({Pointer:{Start:"pointerdown",Move:"pointermove",End:"pointerup",Cancel:"pointercancel",GestureStart:"gesturestart",GestureChange:"gesturechange",GestureEnd:"gestureend",StateChange:"statechange"},Touch:{Start:"touchstart",Move:"touchmove",End:"touchend",Cancel:"touchcancel",GestureStart:"gesturestart",GestureChange:"gesturechange",GestureEnd:"gestureend",StateChange:"statechange"},Mouse:{Start:"mousedown",Move:"mousemove",End:"mouseup",Cancel:void 0,GestureStart:"gesturestart",GestureChange:"gesturechange",GestureEnd:"gestureend",StateChange:"statechange"}}),go=ao,_o=go.SupportsTouches,fo=go.SupportsPointerEvents,yo=go.SupportsGestures,vo="ShadowRoot"in window;function wo(t,e,...i){const n=window.document.createElementNS(t,e);let o=0;if("object"==typeof i[0]&&null!=i[0]&&!(i[0]instanceof window.Node)){++o;for(const t in i[0])n.setAttribute(t,i[0][t])}for(let t=o,e=i.length;t<e;++t){const e=i[t];e instanceof window.Node?n.appendChild(e):"string"==typeof e&&n.appendChild(document.createTextNode(e))}return n}const bo={focusColor:"rgb(0, 122, 255)",get devicePixelRatio(){return Math.max(Math.round(window.devicePixelRatio),1)||1},roundToDevicePixel:function(t,e){const i=e||this.devicePixelRatio;return Math.round(t*i)/i},supportsTouches:_o,supportsPointerEvents:fo,supportsGestureEvents:yo,startEventType:fo?"pointerdown":_o?"touchstart":"mousedown",moveEventType:fo?"pointermove":_o?"touchmove":"mousemove",endEventType:fo?"pointerup":_o?"touchend":"mouseup",cancelEventType:fo?"pointercancel":_o?"touchcancel":void 0,supportsForceTouch:!_o&&"webkitForce"in MouseEvent.prototype,htmlElement:(t,...e)=>wo("http://www.w3.org/1999/xhtml",t,...e),svgElement:(t,...e)=>wo("http://www.w3.org/2000/svg",t,...e),supportsShadowDOM:vo,insideIframe:window.top!==window,getShadowDOMTargetFromEvent:function(t,e){const i=this.containingDocumentOrShadowRoot(t);if(i===document)return e.target;const n="changedTouches"in e?e.changedTouches[0]:e,o=i.elementFromPoint(n.clientX,n.clientY);return o||document.body},containingDocumentOrShadowRoot:function(t){return this.supportsShadowDOM?t.getRootNode():document},addShadowRootChild:function(t,e,i,n){let o;this.supportsShadowDOM?o=t.createAndAddShadowRootChild(e):(o=t.addChild(new qn),i=function(t){let e,i="";for(;e=t.match(/:host\(/);){i+=t.substr(0,e.index),t=t.substr(e.index+e[0].length);let n=1;for(;e=t.match(/^([^()]*)([()])?/);){if(t=t.substr(e[0].length),"("===e[2])n+=1;else if(")"===e[2]&&(n-=1,0===n)){i+=e[1];break}if(i+=e[0],!e[2])break}}return i+t}(i));const s=this.htmlElement("style",i);return n&&(s.nonce=n),o.addChild(new qn(s)),o},parentNodeForSvgTarget:function(t){return t.tagName&&"div"!==t.tagName.toLowerCase()?this.parentNodeForSvgTarget(t.parentNode):t},imagePathForDevice:function(t,e,i){const n=Math.floor(this.devicePixelRatio);let o;return o=-1!==t.indexOf(n)?n:n>t[t.length-1]?t[t.length-1]:t[0],e+(o>1?"_"+o+"x":"")+(i=i||".png")},parseQueryString:function(t){const e={};let i;const n=/\+/g,o=/([^&=]+)=?([^&]*)/g,s=function(t){return decodeURIComponent(t.replace(n," "))};if("string"==typeof t)for(;null!==(i=o.exec(t));)e[s(i[1])]=s(i[2]);return e},createSVGIcon:function(t,e){let i="mk-icon";e.class&&(i+=" "+e.class,delete e.class);const n=this.svgElement("svg",e);return n.setAttribute("class",i),n.setAttribute("focusable","false"),n.appendChild(this.svgElement("g")).appendChild(t),n},convertColorToRGB:function(t){const e=document.createElement("div");return e.style.setProperty("color",t),e.style.color},isValidCSSColor:function(t){return""!==this.convertColorToRGB(t)},updateLabel:function(t,e){t.setAttribute("title",e),t.setAttribute("aria-label",e)},easeInOut:function(t){const e=Math.pow(t,2);return e/(e+Math.pow(1-t,2))},lerp:function(t,e,i){return(1-t)*e+t*i},darkColorScheme:function(t){return t===hn},restrictRotation:function(t){return t<180?Math.min(t,30):Math.max(t,330)},getIntegralZoom:function(t){return Math.floor(t+1e-6)}},Co=bo;function ko(t){this._node=t,this._layer=null}let Mo={};ko.prototype={constructor:ko,get node(){return this._node},get shouldDraw(){const t=this._node.keyForFrozenLayer;return!(this._frozenLayer&&(!this._sharedLayer||this._sharedLayer.key===t)||t&&Mo[t])},get layer(){const t=this._node,e=t.frozen,i=t.keyForFrozenLayer;if(e){if(this._frozenLayer){if(!i||!this._sharedLayer||this._sharedLayer.key===i)return this._frozenLayer;this.releaseLayer()}if(i){const t=Mo[i];if(t&&t.key===i)return this._sharedLayer=t,this._layer=this._frozenLayer=t.canvas,++t.count,t.canvas}}delete this._frozenLayer,this._layer||(this._layer=this.createCanvas(),this._layer.hidden=!0,i&&(this._sharedLayer=Mo[i]={canvas:this._layer,count:1,key:i}));const n=Co.devicePixelRatio,o=t.layerBounds;this._layer.width=Math.ceil(o.size.width*n),this._layer.height=Math.ceil(o.size.height*n);const s=this._layer.getContext("2d");return s&&(s.scale(n,n),s.translate(-o.origin.x,-o.origin.y)),e&&(this._frozenLayer=this._layer),this._layer},releaseLayer:function(t){this._layer&&(this._sharedLayer?t||(--this._sharedLayer.count,0===this._sharedLayer.count&&(delete Mo[this._sharedLayer.key],this._layer.width=0,this._layer.parentNode&&this._layer.parentNode.removeChild(this._layer))):(this._layer.width=0,this._layer.parentNode&&this._layer.parentNode.removeChild(this._layer)),delete this._sharedLayer,delete this._frozenLayer,delete this._layer)},nodeWasRemoved:function(){this._layer&&function(t){0===So.length&&setTimeout((function(){So.forEach((function(t){t._node.scene||t.releaseLayer()})),So=[]}),0);So.push(t)}(this)},createCanvas:function(){return $()},draw:function(t){}};let So=[];ko.releaseSharedLayers=function(){Object.keys(Mo).forEach((function(t){const e=Mo[t];e.canvas.width=0,delete e.key,delete e.canvas})),Mo={}};const Lo=ko;function Ao(t){Lo.call(this,t),this._canvas=this.createCanvas(),this._ctx=this._canvas.getContext("2d")}function Eo(t,e,i,n,o,s){if(!e||0===t.opacity)return;const a=t.renderer;o&&a.releaseLayer(!0);const r=a.shouldDraw,l=t.wantsLayerBacking?a.layer:null;if(l||t.frozen||a.releaseLayer(),t.wantsLayerBacking&&!l)return;const h=function(a){if(e.save(),e.translate(a,d),e.transform(u.a,u.b,u.c,u.d,u.e,u.f),e.globalAlpha=s,r||!t.frozen){const a=l?l.getContext("2d"):e;l&&e.canvas&&"appendChild"in e.canvas&&e.canvas.appendChild(l),t.renderer.draw(a);const r=t.children;for(let t=0,e=r.length;t<e;++t)Eo(r[t],a,i,n,o,l?1:s)}l&&0!==l.width&&0!==l.height&&e.drawImage(l,t.layerBounds.origin.x,t.layerBounds.origin.y,l.width/n,l.height/n),e.restore()},c=t.position.x,d=t.position.y,u=t.transform;s*=t.opacity,h(c),t.repeatOffset&&h(c+t.repeatOffset)}Ao.prototype=p(Lo,Ao,{get ctx(){return this._ctx},get element(){return this._canvas},update:function(){if(!this._ctx)return;const t=this._node,e=t.size,i=Co.devicePixelRatio,n=!this._previousScale||this._previousScale!==i;n&&Lo.releaseSharedLayers(),!n&&this._previousSize&&this._previousSize.equals(e)?this._ctx.clearRect(0,0,e.width*i,e.height*i):(this._canvas.style.width=e.width+"px",this._canvas.style.height=e.height+"px",this._canvas.width=e.width*i,this._canvas.height=e.height*i,this._previousSize=e.copy(),this._previousScale=i),this._ctx.scale(i,i),Eo(this.node,this._ctx,new Bi(-t.position.x,-t.position.y,e.width,e.height),i,n,1),this._ctx.scale(1/i,1/i)}});const xo=Ao;function To(){ln.call(this),this._renderer=new xo(this)}To.prototype=p(ln,To,{isScene:!0,performanceMeasureName:void 0,get element(){return this._renderer.element},get contextForMeasurement(){return this._renderer.ctx},_isTainted:!1,isTainted(){if(this._isTainted)return this._isTainted;const t=ln.prototype.isTainted.call(this);return t&&(this._isTainted=!0),t},destroy:function(){this.children=[],this._renderer._ctx=null,this._renderer._canvas.width=this._renderer._canvas.height=0},flush(){en.flush(this)},stringInfo:function(){return"Scene"}});const Io=To;function Ro(){ln.call(this),this._renderer=new Lo(this)}Ro.prototype=p(ln,Ro,{stringInfo:function(){return"GroupNode"}});const Oo=Ro;function Po(t){Lo.call(this,t)}Po.prototype=p(Lo,Po,{_lastDrawnImage:null,draw:function(t){this._node.image&&(this._node.image.complete&&this._node.image.naturalWidth?(this._lastDrawnImage=this._node.image,t.drawImage(this._node.image,0,0,this._node.size.width,this._node.size.height)):this._node.image===this._lastDrawnImage&&(this._node.needsDisplay=!0))}});const Do=Po;function zo(){ln.call(this),this._image=null,this._renderer=new Do(this)}zo.prototype=p(ln,zo,{get image(){return this._image},set image(t){this._image!==t&&(this._image&&this._image.removeEventListener("load",this),this._image=t,this._imageDidLoad(),!t||t.src&&t.complete||t.addEventListener("load",this))},isTainted(){return!!this._image&&null===this._image.crossOrigin},stringInfo:function(){let t=this._image?this._image.src:null;return"ImageNode"+(t?"<src:"+t+">":"")},handleEvent:function(t){t.target===this._image&&this._image.complete&&(this._image.removeEventListener("load",this),this._imageDidLoad(),this.needsDisplay=!0)},_imageDidLoad:function(){this.size.equals(Ui.Zero)&&(this.size=new Ui(this._image.width,this._image.height)),this.needsDisplay=!0}});const No=zo;function Fo(t){this.node=t.node,this.node.animators||(this.node.animators=[]),this.node.animators.push(this),this.duration=t.duration,["from","to","done"].forEach((function(e){e in t&&null!=t[e]&&(this[e]=t[e])}),this)}function Uo(t){Fo.call(this,t)}function Go(t){t.pop&&(this.springSolver=new Wo(1,this.STIFFNESS,this.DAMPING,0)),Fo.call(this,t)}function Bo(t){Fo.call(this,t),t.center&&(this.center=t.center)}function Zo(t){this.popAnimationDone=t.done||h,delete t.done,t.duration*=this.FLOAT_DURATION_SCALE,Fo.call(this,t),t.center&&(this.center=t.center),t.floatCenter&&(this.floatCenter=t.floatCenter),this.popSpringSolver=new Wo(1,this.SCALE_STIFFNESS,this.SCALE_DAMPING,0),t.to>t.from&&(this.swayAmplitude=(Math.random()<.5?-1:1)*(3+3*Math.random()),this.rotateSpringSolver=new Wo(1,this.ROTATE_STIFFNESS,this.ROTATE_DAMPING,0))}Fo.prototype={from:0,to:1,done:h,begin:function(){return this.startTime=null,this._p=0,ue.scheduleASAP(this),this},end:function(){if(this.ended=!0,this.node.animators){const t=this.node.animators.indexOf(this);t>=0&&(this.node.animators.splice(t,1),0===this.node.animators.length&&delete this.node.animators)}this.done(this)},performScheduledUpdate:function(t){this.ended||(null!=t&&(this.beginDate||(this.beginDate=t),this._p=Math.min((t-this.beginDate)/this.duration,1),this.update(this._p)),this._p<1?ue.scheduleOnNextFrame(this):this.end())},valueAt:function(t){return this.from+t*(this.to-this.from)},stringInfo:function(t,e){let i="ð"+t+"<"+this.duration+"ms; "+this.from+"â"+this.to;return this._p>=0&&(i+="/"+Math.round(100*this._p)+"%"),Object.prototype.hasOwnProperty.call(this,"done")&&(i+="*"),i+(e||"")+">"}},Uo.prototype=p(Fo,Uo,{update:function(t){this.node.opacity=this.valueAt(t)},stringInfo:function(){return Fo.prototype.stringInfo.call(this,"opacity")}}),Go.prototype=p(Fo,Go,{from:new Gi(0,0),to:new Gi(0,0),STIFFNESS:100,DAMPING:10,update:function(t){this.springSolver&&(t=this.springSolver.solve(t)),this.node.transform=(new Zi).translate(this.from.x+t*(this.to.x-this.from.x),this.from.y+t*(this.to.y-this.from.y))},end:function(){this.node.transform=(new Zi).translate(this.to.x,this.to.y),Fo.prototype.end.call(this)},stringInfo:function(){return Fo.prototype.stringInfo.call(this,"translation")}}),Bo.prototype=p(Fo,Bo,{center:new Gi(0,0),scale:function(t){const e=this.center.x,i=this.center.y;this.node.transform=(new Zi).translate(e,i).scale(t).translate(-e,-i)},update:function(t){this.scale(this.valueAt(t))},stringInfo:function(){let t="";return 0===this.center.x&&0===this.center.y||(t+=" ("+this.center.x+", "+this.center.y+")"),Fo.prototype.stringInfo.call(this,"scale",t)}});function Wo(t,e,i,n){this.w0=Math.sqrt(e/t),this.zeta=i/(2*Math.sqrt(e*t)),this.zeta<1?(this.wd=this.w0*Math.sqrt(1-this.zeta*this.zeta),this.A=1,this.B=(this.zeta*this.w0-n)/this.wd):(this.wd=0,this.A=1,this.B=-n+this.w0)}Zo.prototype=p(Fo,Zo,{center:new Gi(0,0),SCALE_STIFFNESS:100,SCALE_DAMPING:10,FLOAT_DURATION_SCALE:4.2,ROTATE_DAMPING:5,ROTATE_STIFFNESS:127.15275,scaleAndRotate:function(t,e){const i=this.center.x,n=this.center.y;this.floatCenter?this.node.transform=(new Zi).translate(this.floatCenter.x,this.floatCenter.y).rotate(e).translate(-this.floatCenter.x,-this.floatCenter.y).translate(i,n).scale(t).translate(-i,-n):this.node.transform=(new Zi).translate(i,n).scale(t).rotate(e).translate(-i,-n)},update:function(t){const e=t*this.FLOAT_DURATION_SCALE,i=this.valueAt(this.popSpringSolver.solve(e));let n=0;this.rotateSpringSolver&&(n=(this.rotateSpringSolver.solve(t)-1)*this.swayAmplitude),this.scaleAndRotate(i,n),e>1&&!this.popAnimationDoneCalled&&(this.popAnimationDoneCalled=!0,this.popAnimationDone(this))},end:function(){this.scaleAndRotate(this.to,0),Fo.prototype.end.call(this),this.popAnimationDoneCalled||this.popAnimationDone(this)},stringInfo:function(){let t="";0===this.center.x&&0===this.center.y||(t+=" ("+this.center.x+", "+this.center.y+")");let e="float";return this.popAnimationDoneCalled&&(e+=" (swing)"),Fo.prototype.stringInfo.call(this,e,t)}}),Wo.prototype.solve=function(t){return 1-(t=this.zeta<1?Math.exp(-t*this.zeta*this.w0)*(this.A*Math.cos(this.wd*t)+this.B*Math.sin(this.wd*t)):(this.A+this.B*t)*Math.exp(-t*this.w0))};const Ko={Basic:Fo,Opacity:Uo,Translation:Go,Scale:Bo,Float:Zo},Ho=(hi.Coordinate,hi.CoordinateRegion,hi.CoordinateSpan,hi.MapRect),jo=function(t,e){_(e,"object","[MapKit] MapRect.pad expects a padding object with top, left, bottom, right but got `"+e+"` instead");const i=e.left||0,n=e.top||0;return new Ho(t.origin.x-i,t.origin.y-n,t.size.width+i+(e.right||0),t.size.height+n+(e.bottom||0))},Vo=function(t,e){const i=e.origin.x,n=e.origin.y,o=t.maxX(),s=t.maxY();return i>=t.origin.x&&i<=o&&n>=t.origin.y&&n<=s&&e.maxX()<=o&&e.maxY()<=s},qo=function(t){if(0===t.length)return new Ho;if(1===t.length){const e=t[0].minX();return e>=0&&e<1?t[0]:new Ho(c(e,1),t[0].minY(),t[0].size.width,t[0].size.height)}const e=[[t[0].minX(),t[0].maxX()]];let i=t[0].minY(),n=t[0].maxY();for(let o=1,s=t.length,a=0;o<s;++o){const s=e[a],r=t[o];i=Math.min(i,r.minY()),n=Math.max(n,r.maxY()),r.minX()<=s[1]?e[a]=[s[0],Math.max(s[1],r.maxX())]:(e.push([r.minX(),r.maxX()]),++a)}const o=e.length;if(1===o)return new Ho(e[0][0],i,Math.min(e[0][1]-e[0][0],1),n-i);let s=1+e[0][0]-e[o-1][1],a=e[0][0];for(let t=1;t<o;++t){const i=e[t][0]-e[t-1][1];i>s&&(s=i,a=e[t][0])}return new Ho(c(a,1),i,1-s,n-i)};const Yo=function(t,e){return t instanceof e||(console.warn("[MapKit] Unexpected object instance. Did you forget to `new`?"),"function"==typeof console.trace&&console.trace(),!1)};function Xo(){if(!Yo(this,Xo))return;const t=arguments.length;if(1===t&&"object"==typeof arguments[0]){this.top=0,this.right=0,this.bottom=0,this.left=0;const t=arguments[0];Object.keys(t).forEach((function(e){"top"===e||"right"===e||"bottom"===e||"left"===e?this[e]=t[e]:console.warn("[MapKit] Unknown property `"+e+"` for Padding constructor.")}),this)}else this.top=t>0?arguments[0]:0,this.right=t>1?arguments[1]:0,this.bottom=t>2?arguments[2]:0,this.left=t>3?arguments[3]:0;_(this.top,"number","[MapKit] Expected a number for `top` in Padding constructor but got `"+this.top+"` instead."),_(this.left,"number","[MapKit] Expected a number for `left` in Padding constructor but got `"+this.left+"` instead."),_(this.bottom,"number","[MapKit] Expected a number for `bottom` in Padding constructor but got `"+this.bottom+"` instead."),_(this.right,"number","[MapKit] Expected a number for `right` in Padding constructor but got `"+this.right+"` instead.")}Xo.Zero=new Xo,Xo.prototype={constructor:Xo,toString:function(){return"Padding("+[this.top,this.right,this.bottom,this.left].join(", ")+")"},copy:function(){return new Xo(this.top,this.right,this.bottom,this.left)},equals:function(t){return this.top===t.top&&this.right===t.right&&this.bottom===t.bottom&&this.left===t.left}};const $o=Xo;function Jo(t,e){this._delegate=e,this._snapsToIntegralZoomLevels=t}Jo.prototype={constructor:Jo,_speed:.03,_startTime:0,_shouldStop:!1,_animating:!1,start:function(t,e){const i=Date.now();return this._gasPedalValue=0,this._startTime=i,this._shouldStop&&this._cleanUp(),this._shouldStop=!1,this.zoomsIn=!!e,Co.supportsForceTouch&&window.addEventListener("webkitmouseforcechanged",this),!this._animating&&(this._animating=!0,this._zoomLevel=t,this._timeAtLastFrame=i,ue.scheduleOnNextFrame(this),!0)},stop:function(){this._shouldStop=!0,Co.supportsForceTouch&&(window.removeEventListener("webkitmouseforcechanged",this),delete this._speed)},set snapsToIntegralZoomLevels(t){this._snapsToIntegralZoomLevels=!!t},performScheduledUpdate:function(){let t=!0;const e=Date.now(),i=e-this._timeAtLastFrame,n=this._speed*(this.zoomsIn?1:-1);this._zoomLevel+=60*i*d(1+n)/1e3,this._timeAtLastFrame=e,this._shouldStop&&e-this._startTime>=250&&(this._zoomLevelAtWhichToStop?(t=this.zoomsIn&&this._zoomLevel<this._zoomLevelAtWhichToStop||!this.zoomsIn&&this._zoomLevel>this._zoomLevelAtWhichToStop,t||(this._zoomLevel=this._zoomLevelAtWhichToStop)):this._snapsToIntegralZoomLevels?this._zoomLevelAtWhichToStop=this.zoomsIn?Math.ceil(this._zoomLevel):Math.floor(this._zoomLevel):t=!1),this._delegate&&this._delegate.linearZoomControllerDidZoom(this._zoomLevel),t?ue.scheduleOnNextFrame(this):this._cleanUp()},handleEvent:function(t){this._handleForceChangedEvent(t)},_handleForceChangedEvent:function(t){const e=u(t.webkitForce,MouseEvent.WEBKIT_FORCE_AT_MOUSE_DOWN,MouseEvent.WEBKIT_FORCE_AT_FORCE_MOUSE_DOWN)-MouseEvent.WEBKIT_FORCE_AT_MOUSE_DOWN;Math.abs(e-this._gasPedalValue)>.01&&(this._gasPedalValue=e),this._speed=.01+this._gasPedalValue*(.06-.01)},_cleanUp:function(){this._animating=!1,this._shouldStop=!1,delete this._zoomLevelAtWhichToStop,this._delegate&&this._delegate.linearZoomControllerDidStop()}};const Qo=Jo;class ts extends ao{constructor(){super(),this.numberOfTapsRequired=1,this.numberOfTouchesRequired=1,this.allowsRightMouseButton=!1,this._taps=0}touchesBegan(t){t.currentTarget===this.target&&("button"in t&&2===t.button&&!this.allowsRightMouseButton||(super.touchesBegan(t),this.numberOfTouches===this.numberOfTouchesRequired?(this._domEvents.push(t),this._startPoint=super.locationInElement(),this._startClientPoint=super.locationInClient(),this._rewindTimer(750)):this.enterFailedState()))}touchesMoved(t){let e;switch(this.preventDefault(t),this.currentMode){case ao.Modes.Pointer:e="touch"===t.pointerType?40:2;break;case ao.Modes.Touch:e=40;break;case ao.Modes.Mouse:e=2}void 0!==e&&(!this._startPoint||this._startPoint.distanceToPoint(super.locationInElement())>e)&&this.enterFailedState()}touchesEnded(t){this._taps++,this._domEvents.push(t),this._taps===this.numberOfTapsRequired&&(this.preventDefault(t),this.enterRecognizedState(),this.reset()),this._rewindTimer(350)}reset(){this._taps=0,this._clearTimer(),this._domEvents=[]}locationInElement(t){const e=this._startPoint||new Gi;return t?Xi(t,e):e}locationInClient(){return this._startClientPoint||new Gi}_clearTimer(){window.clearTimeout(this._timerId),delete this._timerId}_rewindTimer(t){this._clearTimer(),this._timerId=window.setTimeout(this._timerFired.bind(this),t)}_timerFired(){this.enterFailedState()}}class es extends ao{constructor(){super(),this.allowableMovement=10,this.minimumPressDuration=500,this.numberOfTouchesRequired=1,this.allowsRightMouseButton=!1,this._startPoint=void 0}touchesBegan(t){t.currentTarget===this.target&&("button"in t&&2===t.button&&!this.allowsRightMouseButton||(super.touchesBegan(t),this.numberOfTouches===this.numberOfTouchesRequired?(this._startPoint=this.locationInElement(),this._timerId=window.setTimeout(this.enterRecognizedState.bind(this),this.minimumPressDuration)):this.enterFailedState()))}touchesMoved(t){this.preventDefault(t),void 0!==this._startPoint&&this._startPoint.distanceToPoint(this.locationInElement())>this.allowableMovement&&this.enterFailedState()}touchesCancelled(t){this.touchesEnded(t)}touchesEnded(t){this.state===ao.States.Recognized?(this.preventDefault(t),this.numberOfTouches!==this.numberOfTouchesRequired&&this.enterFailedState()):this.enterFailedState()}reset(){window.clearTimeout(this._timerId),delete this._timerId}}const is=class extends es{constructor(){super(),this.minimumPressDuration=500}touchesBegan(t){(/MSIE|Trident\//i.test(navigator.userAgent)||/Edge\//i.test(navigator.userAgent))&&document.getSelection().removeAllRanges(),es.prototype.touchesBegan.call(this,t),this._domEvents.push(t),this.translation=new Gi,this._translationOrigin=this._lastTouchLocation=this.locationInElement()}enterRecognizedState(){es.prototype.enterBeganState.call(this)}touchesMoved(t){this.preventDefault(t);const e=this.locationInElement();this.state===po.Possible?es.prototype.touchesMoved.call(this,t):this.state!==po.Began&&this.state!==po.Changed||(this.translation.x+=e.x-this._lastTouchLocation.x,this.translation.y+=e.y-this._lastTouchLocation.y,this.enterChangedState()),this._lastTouchLocation=e}touchesCanceled(t){this.interruptGesture()}touchesEnded(t){this.state===po.Changed?(this.preventDefault(t),this.enterEndedState()):this.enterFailedState()}interruptGesture(){this.state===po.Changed?this.enterEndedState():this.state===po.Began&&this.enterFailedState()}reset(){es.prototype.reset.call(this),delete this._translationOrigin,delete this._lastTouchLocation,this._domEvents=[]}},ns="mk-disable-all-gestures",os="mk-disable-pan-gestures",ss="mk-disable-pinch-gestures",as="mk-disable-zoom-gestures";function rs(t,e){this._target=t,this._delegate=e,this._touchCount=0,this.initialEventTargetForCurrentInteraction=null,this._doubleTapWithOneFingerRecognizer=this._addGestureRecognizer(ts),this._doubleTapWithOneFingerRecognizer.numberOfTouchesRequired=1,this._doubleTapWithOneFingerRecognizer.numberOfTapsRequired=2,this._singleTapWithOneFingerRecognizer=this._addGestureRecognizer(ts),this._longPressAndPanRecognizer=this._addGestureRecognizer(is),this._longPressAndPanRecognizer.delegate=this,t.addEventListener(Co.startEventType,this),t.addEventListener("dragstart",this),this.updateGestureEnableState()}rs.prototype={constructor:rs,handleEvent:function(t){switch(t.type){case"pointerdown":this._installEndListeners(),this._touchCount++,this.initialEventTargetForCurrentInteraction=this._delegate.getEventTargetFromSubShadowDOM(t),this._suppressDefaultBehavior(t);break;case"pointerup":case"pointercancel":this._touchCount--,0===this._touchCount&&(this._removeEndListeners(),document.removeEventListener("selectstart",this,!0),this.initialEventTargetForCurrentInteraction=null);break;case"dragstart":this._delegate.elementShouldPreventDragstart(t.target)&&t.preventDefault();break;case"mousedown":this._installEndListeners(),this.initialEventTargetForCurrentInteraction=this._delegate.getEventTargetFromSubShadowDOM(t),this._suppressDefaultBehavior(t);break;case"mouseup":this._removeEndListeners(),document.removeEventListener("selectstart",this,!0),this.initialEventTargetForCurrentInteraction=null;break;case"touchstart":t.touches.length===t.changedTouches.length&&(this._installEndListeners(),this.initialEventTargetForCurrentInteraction=this._delegate.getEventTargetFromSubShadowDOM(t),this._delegate.elementWantsDefaultBrowserBehavior(this.initialEventTargetForCurrentInteraction,t,t.touches.length)||t.preventDefault());break;case"touchend":case"touchcancel":0===t.touches.length&&(this._removeEndListeners(),this.initialEventTargetForCurrentInteraction=null);break;case"statechange":this._handleStatechange(t);break;case"selectstart":t.preventDefault()}},_handleStatechange:function(t){switch(t.target){case this._doubleTapWithOneFingerRecognizer:this._handleDoubleTapWithOneFingerChange(t);break;case this._singleTapWithOneFingerRecognizer:this._handleSingleTapWithOneFingerChange(t);break;case this._longPressAndPanRecognizer:this._handleLongPressAndPanChange(t)}},gestureRecognizerShouldBegin:function(t){return this._delegate.userDidLongPress(t)},updateGestureEnableState:function(){const t=(this._delegate.isScrollEnabled?1:0)|(this._delegate.isRotationEnabled?2:0)|(this._delegate.isZoomEnabled?4:0),e=[void 0,os,ss,ns,as,ns,ss,ns];this._delegate.rootNode.classList.remove(ns),this._delegate.rootNode.classList.remove(os),this._delegate.rootNode.classList.remove(ss),this._delegate.rootNode.classList.remove(as),e[t]&&this._delegate.rootNode.classList.add(e[t])},mapWasDestroyed:function(){this._removeEndListeners(),this._target.removeEventListener(Co.startEventType,this),this._target.removeEventListener("dragstart",this),this._doubleTapWithOneFingerRecognizer.removeEventListener("statechange",this),this._doubleTapWithOneFingerRecognizer.enabled=!1,this._doubleTapWithOneFingerRecognizer=null,this._singleTapWithOneFingerRecognizer.removeEventListener("statechange",this),this._singleTapWithOneFingerRecognizer.enabled=!1,this._singleTapWithOneFingerRecognizer=null,this._longPressAndPanRecognizer.removeEventListener("statechange",this),this._longPressAndPanRecognizer.enabled=!1,this._longPressAndPanRecognizer.delegate=null,this._longPressAndPanRecognizer=null,window.clearTimeout(this._delayedSingleTapRecognizerTimeoutID),delete this.initialEventTargetForCurrentInteraction,delete this._target,delete this._delegate},_addGestureRecognizer:function(t){const e=new t;return e.target=this._target,e.addEventListener("statechange",this),e},_handleDoubleTapWithOneFingerChange:function(t){const e=t.target;e.state===po.Recognized&&(this._delayedSingleTapRecognizerTimeoutID&&(this._delegate.userCanceledTap(),window.clearTimeout(this._delayedSingleTapRecognizerTimeoutID),delete this._delayedSingleTapRecognizerTimeoutID),this._singleTapWithOneFingerRecognizer.enabled=!1,this._delegate.userDidDoubleTap(e))},_handleSingleTapWithOneFingerChange:function(t){const e=t.target;if(this._singleTapWithOneFingerRecognizer.enabled&&e.state===po.Recognized){this._delegate.userWillTap(e);const t=this._delegate.shouldDelaySingleTap()?350:0;this._delayedSingleTapRecognizerTimeoutID=window.setTimeout((()=>{delete this._delayedSingleTapRecognizerTimeoutID,this._delegate.userDidTap()}),t)}},_handleLongPressAndPanChange:function(t){const e=t.target;switch(e.state){case po.Possible:this._delegate.userMayStartPanningAfterLongPress();break;case po.Began:this._singleTapWithOneFingerRecognizer.enabled=!1,this._doubleTapWithOneFingerRecognizer.enabled=!1,this._doubleTapWithOneFingerRecognizer.enabled=!0;break;case po.Changed:this._delegate.userDidPanAfterLongPress(e.translation);break;case po.Ended:case po.Failed:this._singleTapWithOneFingerRecognizer.enabled=!0,this._delegate.userDidStopPanningAfterLongPress(e.state!==po.Failed)}},_stopDraggingAnnotation:function(){this._longPressAndPanRecognizer.interruptGesture()},_suppressDefaultBehavior:function(t){if(this._delegate.elementWantsDefaultBrowserBehavior(this.initialEventTargetForCurrentInteraction,t,this._touchCount))return;(!("pointerType"in t)||"mouse"===t.pointerType)&&Co.insideIframe?(document.addEventListener("selectstart",this,!0),document.getSelection().removeAllRanges()):t.preventDefault()},_installEndListeners:function(){window.addEventListener(Co.endEventType,this),Co.cancelEventType&&window.addEventListener(Co.cancelEventType,this)},_removeEndListeners:function(){window.removeEventListener(Co.endEventType,this),Co.cancelEventType&&window.removeEventListener(Co.cancelEventType,this)}};const ls=rs,hs=100,cs=Math.log(10)/Math.log(2);function ds(t){Lo.call(this,t)}function us(t,e,i,n,o,s){i=c(i,e),n=c(n,e),o=Math.ceil(o),s=Math.ceil(s);const a=Math.ceil(o/e),r=Math.ceil(s/e);for(let n=0;n<a;++n)t.fillRect(i+n*e,0,1,s);for(let i=0;i<r;++i)t.fillRect(0,n+i*e,o,1)}function ps(t){return"rgb("+t.join(",")+")"}function ms(t,e,i){return Math.round(e*i+t*(1-i))}ds.prototype=p(Lo,ds,{draw:function(t,e){const i=this.node,n=i.zoom,o=Math.pow(2,n%cs),s=hs*o,a=s/10,r=Math.min(a,hs),l=a<10?0:(r-10)/90,h=i.origin,d=hi.pointsPerAxis(n),u=new Gi(-h.x*d,-h.y*d),p=c(u.x,s)-s,m=c(u.y,s)-s,g=this.node.theme;if(t.fillStyle=ps(g.fillColor),t.fillRect(0,0,i.size.width,i.size.height),i.initialRendering)return;const _=1-Math.pow(1-l,2);_>0&&(t.fillStyle=ps(function(t,e,i){if(0===i)return t;if(1===i)return e;return[ms(t[0],e[0],i),ms(t[1],e[1],i),ms(t[2],e[2],i)]}(g.fillColor,g.lineColor,_)),us(t,a,p,m,i.size.width,i.size.height)),t.fillStyle=ps(g.lineColor),us(t,s,p,m,i.size.width,i.size.height)}});const gs=ds,_s={light:{fillColor:[248,245,236],lineColor:[149,148,144]},dark:{fillColor:[44,45,47],lineColor:[56,64,66]}};function fs(){ln.call(this),this._renderer=new gs(this),this._theme=_s.light}fs.prototype=p(ln,fs,{initialRendering:!1,get size(){return this.parent.size},get zoom(){return this.parent.zoomLevel},get origin(){return this.parent.visibleMapRect.origin},get theme(){return this._theme},updateThemeFromTint:function(t){const e=_s[t];e!==this._theme&&(this._theme=e,this.needsDisplay=!0)},stringInfo:function(){return"BackgroundGridNode"+(this.initialRendering?"!":"")+(this._theme===_s.light?"":"<dark>")}});const ys=fs,vs=Symbol();function ws(){Oo.call(this)}ws.prototype=p(Oo,ws,{delegate:null,deactivate:function(){this._impl.deactivate()},destroy:function(t){this._impl.destroy(t)},get element(){return this._impl.element},get camera(){return this._impl.camera},get minZoomLevel(){return this._impl.currentMinZoomLevel},get maxZoomLevel(){return this._impl.currentMaxZoomLevel},get usesInteractionCenter(){return this._impl.usesInteractionCenter},set usesInteractionCenter(t){this._impl.usesInteractionCenter=t},get configuration(){return this._impl.configuration},set configuration(t){this._impl.configuration=t},get tint(){return this._impl.tint},get tileTint(){return this._impl.tileTint},get emphasis(){return this._impl.emphasis},get language(){return this._impl.language},set language(t){this._impl.language=t},get allowWheelToZoom(){return this._impl.allowWheelToZoom},set allowWheelToZoom(t){this._impl.allowWheelToZoom=t},get allowWheelToZoom2(){return this._impl.allowWheelToZoom2},set allowWheelToZoom2(t){this._impl.allowWheelToZoom2=t},get pointOfInterestFilter(){return this._impl.pointOfInterestFilter},set pointOfInterestFilter(t){this._impl.pointOfInterestFilter=t},setPoiFiltered:function(t,e){this._impl.setPoiFiltered&&this._impl.setPoiFiltered(t,e)},get backgroundGridTheme(){return this._impl.backgroundGridTheme},set backgroundGridTheme(t){this._impl.backgroundGridTheme=t},get size(){return this._impl.size},set size(t){this._impl.size=t},get rotation(){return this._impl.rotation},set rotation(t){this._impl.rotation=t},getRotation:function(){return this._impl.rotation},get isRotationEnabled(){return this._impl.isRotationEnabled},set isRotationEnabled(t){this._impl.isRotationEnabled=t},get isRotationLocked(){return this._impl.isRotationLocked},get cameraIsPanning(){return this._impl.cameraIsPanning},get pannable(){return this._impl.pannable},set pannable(t){this._impl.pannable=t},get cameraIsZooming(){return this._impl.cameraIsZooming},get zoomable(){return this._impl.zoomable},set zoomable(t){this._impl.zoomable=t},get cameraIsRotating(){return this._impl.cameraIsRotating},get cameraIsAnimating(){return!!this._impl.cameraAnimation},get zoomLevel(){return this._impl.zoomLevel},set zoomLevel(t){this._impl.setZoomLevelAnimated(t)},set fontSizeRatio(t){this._impl.fontSizeRatio=t},setZoomLevelAnimated:function(t,e){this._impl.setZoomLevelAnimated(t,e)},setCameraDistanceAnimated:function(t,e){this._impl.setCameraDistanceAnimated(t,e)},getCurrentCameraDistance:function(){return this._impl.getCurrentCameraDistance()},get cameraZoomRange(){return this._impl.cameraZoomRange},setCameraZoomRangeAnimated:function(t,e){this._impl.setCameraZoomRangeAnimated(t,e)},setCameraZoomLevelLimitAnimated:function(t,e){this._impl.setCameraZoomLevelLimitAnimated(t,e)},zoomLevelForCameraDistanceAtY:function(t,e){return this._impl.zoomLevelForCameraDistanceAtY(t,e)},get visibleMapRect(){return this._impl.visibleMapRect},set visibleMapRect(t){this._impl.setVisibleMapRectAnimated(t)},setVisibleMapRectAnimated:function(t,e){this._impl.setVisibleMapRectAnimated(t,e)},setCenterAnimated:function(t,e){this._impl.setCenterAnimated(t,e)},setCameraBoundaryAnimated:function(t,e){this._impl.setCameraBoundaryAnimated(t,e)},isMapPointWithinBounds:function(t){return this._impl.isMapPointWithinBounds(t)},get showsDefaultTiles(){return this._impl.showsDefaultTiles},set showsDefaultTiles(t){this._impl.showsDefaultTiles=t},get tileOverlays(){return this._impl.tileOverlays},set tileOverlays(t){this._impl.tileOverlays=t},addTileOverlay:function(t){return this._impl.addTileOverlay(t)},addTileOverlays:function(t){return this._impl.addTileOverlays(t)},removeTileOverlay:function(t){return this._impl.removeTileOverlay(t)},removeTileOverlays:function(t){return this._impl.removeTileOverlays(t)},adjustMapItemPoint:function(t){return this._impl.adjustMapItemPoint(t)},cameraWillStartZooming:function(t,e,i){return this._impl.cameraWillStartZooming(t,e,i)},cameraDidStopZooming:function(){this._impl.cameraDidStopZooming()},get fullyRendered(){return this._impl.fullyRendered},devicePixelRatioDidChange:function(){return this._impl.devicePixelRatioDidChange()},stringInfo:function(){return this._impl.stringInfo()},get snapsToIntegralZoomLevels(){return this._impl.snapsToIntegralZoomLevels},set snapsToIntegralZoomLevels(t){this._impl.snapsToIntegralZoomLevels=t},migrateStateTo:function(t){return this._impl.migrateStateTo(t)},needsReplacing:function(t){return this._impl.needsReplacing(t)},createLabelRegion:function(){return this._impl.createLabelRegion()},updatedLabelRegion:function(){this._impl.updatedLabelRegion()},unregisterLabelRegion:function(t){this._impl.unregisterLabelRegion(t)},setCameraAnimated:function(t,e,i){this._impl.setCameraAnimated(t,e,i)},setTintAndEmphasis:function(t,e,i){this._impl.setTintAndEmphasis(t,e,i)},compassRotationWillStart:function(){return this._impl.compassRotationWillStart()},compassRotationDidEnd:function(){this._impl.compassRotationDidEnd()},forceRerender(){},forceDraw(){},requireRender(){}}),Object.defineProperty(ws.prototype,vs,{get:function(){return this._impl[vs]},set:function(t){this._impl[vs]=t},configurable:!0}),T.EventTarget(ws.prototype);const bs=ws;function Cs(t,e,i,n){this.center=t||new hi.MapPoint(.5,.5),this.zoom=e||3,this.viewportSize=i||new Ui,this.rotation=n||0}Cs.prototype={constructor:Cs,get zoom(){return this._zoom},set zoom(t){this._zoom!==t&&(this._zoom=t||3,this._pointsPerAxis=hi.pointsPerAxis(this._zoom))},get worldSize(){return this._pointsPerAxis},get rotation(){return this._rotation},set rotation(t){const e=c(t,360);this._rotation=e},minX:function(){if(0===this._pointsPerAxis)return 0;const t=this.viewportSize.width/this._pointsPerAxis;return this.center.x-t/2},minY:function(){if(0===this._pointsPerAxis)return 0;const t=this.viewportSize.height/this._pointsPerAxis;return this.center.y-t/2},maxX:function(){if(0===this._pointsPerAxis)return 0;const t=this.viewportSize.width/this._pointsPerAxis;return this.center.x+t/2},maxY:function(){if(0===this._pointsPerAxis)return 0;const t=this.viewportSize.height/this._pointsPerAxis;return this.center.y+t/2},equals:function(t){return this.zoom===t.zoom&&this.center.equals(t.center)&&this.viewportSize.equals(t.viewportSize)&&this.rotation===t.rotation},copy:function(){return new Cs(this.center,this.zoom,this.viewportSize,this.rotation)},toString:function(){return"Camera("+["center: ["+this.center.x+", "+this.center.y+"]","zoom: "+this.zoom,"viewportSize: "+this.viewportSize.toString(),"rotation: "+this.rotation].join(", ")+")"},toMapRect:function(){if(0===this._pointsPerAxis)return new hi.MapRect(this.center.x,this.center.y,0,0);const t=this.viewportSize.width/this._pointsPerAxis,e=this.viewportSize.height/this._pointsPerAxis,i=Object.create(hi.MapPoint.prototype);i.x=this.center.x-t/2,i.y=this.center.y-e/2;const n=Object.create(hi.MapSize.prototype);n.width=t,n.height=e;const o=Object.create(hi.MapRect.prototype);return o.origin=i,o.size=n,o},toRenderingMapRect:function(){let t=[new Gi(this.minX(),this.minY()),new Gi(this.maxX(),this.minY()),new Gi(this.maxX(),this.maxY()),new Gi(this.minX(),this.maxY())];if(0!==this.rotation){const e=(new Zi).rotate(this.rotation);t=t.map((t=>e.transformPoint(t)))}let e=t[0].x,i=t[0].y,n=t[0].x,o=t[0].y;for(let s=1;s<t.length;++s){const a=t[s];a.x<e&&(e=a.x),a.x>n&&(n=a.x),a.y<i&&(i=a.y),a.y>o&&(o=a.y)}const s=n-e,a=o-i;return new hi.MapRect(this.center.x-s/2,this.center.y-a/2,s,a)},translate:function(t){if(0===this._pointsPerAxis)return this.copy();if(0!==this.rotation){t=(new Zi).rotate(-this.rotation).transformPoint(t)}const e=Math.round(t.x)/this._pointsPerAxis,i=Math.round(t.y)/this._pointsPerAxis,n=Object.create(hi.MapPoint.prototype);n.x=c(this.center.x-e,1),n.y=c(this.center.y-i,1);const o=Object.create(Cs.prototype);return o.center=n,o._zoom=this._zoom,o._pointsPerAxis=this._pointsPerAxis,o.viewportSize=this.viewportSize,o._rotation=this._rotation,o},transformMapPoint:function(t){const e=this.viewportSize.width,i=this.viewportSize.height,n=this._pointsPerAxis,o=(new Zi).translate(-this.minX()*n,-this.minY()*n).scale(n).transformPoint(t);return(new Zi).translate(e/2,i/2).rotate(this.rotation).translate(e/-2,i/-2).transformPoint(o)},transformGestureCenter:function(t){if(0===this.rotation)return t;const e=this.viewportSize.width,i=this.viewportSize.height;return(new Zi).translate(e/2,i/2).rotate(-this.rotation).translate(-e/2,-i/2).transformPoint(t)},rotateAroundCenter:function(t,e){const i=(new Zi).translate(t.x,t.y).rotate(-e).translate(-t.x,-t.y).transformPoint(new Gi(this.center.x,this.center.y));this.center=new hi.MapPoint(i.x,i.y),this.rotation+=e},withNewMapRect:function(t,e,i){i=i||this.viewportSize;const n=hi.zoomLevelForMapRectInViewport(t,i,hi.tileSize);return new Cs(new hi.MapPoint(t.midX(),t.midY()),e?Math.floor(n):n,i,this.rotation)}};const ks=Cs;function Ms(t,e,i,n){this.map=t,this._startCamera=e,this._endCamera=i,this._duration=250,this._rotationCenter=n,t.snapsToIntegralZoomLevels&&(i.zoom=Math.round(i.zoom)),this._updateAnimationRects(),this._startTime=null,this._schedule()}Ms.prototype={constructor:Ms,cancel:function(){this._canceled=!0},get zooming(){return this._startCamera.zoom!==this._endCamera.zoom},set additiveZoom(t){this._zoomIsAdditive=!0,this._endCamera.zoom=t,this._updateAnimationRects()},get zoomIsAdditive(){return this._zoomIsAdditive},get rotating(){return this._startCamera.rotation!==this._endCamera.rotation},adjustRotation:function(t,e){this._startCamera.rotateAroundCenter(t,e),this._endCamera.rotateAroundCenter(t,e),this._updateAnimationRects()},unconstrained:!1,updateViewportSize:function(t){this._startCamera=new ks(this._startCamera.center,this._startCamera.zoom,t,this._startCamera.rotation),this._endCamera=new ks(this._endCamera.center,this._endCamera.zoom,t,this._endCamera.rotation),this._updateAnimationRects()},performScheduledUpdate:function(t){this._canceled||(null==t?this._animationDidProgress(1):null==this._startTime?(this._startTime=t,this._schedule()):this._animationDidProgress(Math.min((t-this._startTime)/this._duration,1)))},_zoomIsAdditive:!1,_updateAnimationRects:function(){if(this._rotationDelta=this._endCamera.rotation-this._startCamera.rotation,Math.abs(this._rotationDelta)>180&&(this._rotationDelta=this._endCamera.rotation+360-this._startCamera.rotation),this._rotationCenter)return;this._startRect=this._startCamera.toMapRect(),this._animatedEndRect=this._endCamera.toMapRect();const t=this._startCamera.center.x-this._endCamera.center.x;Math.abs(t)>.5&&(t<0?this._startRect.origin.x+=1:this._animatedEndRect.origin.x+=1)},_schedule:function(){ue.scheduleOnNextFrame(this)},_animationDidProgress:function(t){if(1===t)return this.map.snapsToIntegralZoomLevels&&(this._endCamera.zoom=Math.round(this._endCamera.zoom)),this.map.cameraAnimationDidProgress(this._endCamera),void this.map.cameraAnimationDidEnd();this._rotationCenter?this._animateAroundCenter(t):this._animateRects(t),this._schedule()},_animateAroundCenter:function(t){const e=this._startCamera.copy();e.rotateAroundCenter(this._rotationCenter,t*this._rotationDelta),this.map.cameraAnimationDidProgress(e)},_animateRects:function(t){const e=this._startRect,i=this._animatedEndRect,n=e.origin.x,o=e.origin.y,s=e.size.width,a=e.size.height,r=i.origin.x-e.origin.x,l=i.origin.y-e.origin.y,h=i.size.width-e.size.width,c=i.size.height-e.size.height;let d=this._endCamera.rotation-this._startCamera.rotation;Math.abs(d)>180&&(d=this._endCamera.rotation+360-this._startCamera.rotation);const u=new hi.MapRect(n+r*t,o+l*t,s+h*t,a+c*t),p=this._startCamera.withNewMapRect(u);this.map.cameraAnimationDidProgress(p,this.unconstrained),this.map.rotation=this._startCamera.rotation+this._rotationDelta*t}};const Ss=Ms;function Ls(t,e){this._map=t,this._startEventType=ro?"pointerdown":lo?"touchstart":"mousedown",this._map.element.addEventListener(this._startEventType,this)}Ls.prototype={constructor:Ls,handleEvent:function(t){("mousedown"===t.type||"touchstart"===t.type&&t.touches.length===t.changedTouches.length||"pointerdown"===t.type&&t.isPrimary)&&this._map.interactionDidStart()},destroy:function(){this._map.element.removeEventListener(this._startEventType,this)}};const As=Ls;class Es extends ao{constructor(){super(),this.scaleThreshold=0,this.useGestures=ao.UseGesturesForPinch,this._scaledMinimumAmount=!1,this.scale=1,this._velocity=0,this._gestures=[],this._startDistance=0}get velocity(){const t=this._gestures[this._gestures.length-1];if(!t)return this._velocity;const e=performance.now()-(t.timeStamp+100);if(e<=0)return this._velocity;const i=Math.max((500-e)/500,0);return this._velocity*i}touchesBegan(t){if(t.currentTarget===this.target){if(this.useGestures){if(2!==this.numberOfTouches)return}else{if(this.numberOfTouches>2)return void this.enterFailedState();if(2!==this.numberOfTouches)return;this._startDistance=this._distance(),this._recordGesture(t.timeStamp,1),this._scaledMinimumAmount=!1,this._updateStateWithEvent(t)}super.touchesBegan(t)}}touchesMoved(t){this.useGestures||2===this.numberOfTouches&&this._updateStateWithEvent(t)}touchesEnded(t){this.useGestures||this.numberOfTouches>=2||!this._startDistance||(this._scaledMinimumAmount?this.enterEndedState():this.enterFailedState())}gestureBegan(t){super.gestureBegan(t),this._recordGesture(t.timeStamp,t.scale),this._scaledMinimumAmount=!1,this._updateStateWithEvent(t),this.preventDefault(t)}gestureChanged(t){this.preventDefault(t),this._updateStateWithEvent(t)}gestureEnded(t){this._scaledMinimumAmount?this.enterEndedState():this.enterFailedState()}reset(){this.scale=1,this._velocity=0,this._gestures=[],this._startDistance=0}_recordGesture(t,e){const i=t,n=this._gestures.push({scale:e,timeStamp:i});if(n<=2)return;const o=this._gestures[n-1].scale>=this._gestures[n-2].scale;let s;for(s=n-3;s>=0;--s){const t=this._gestures[s];if(i-t.timeStamp>100||this._gestures[s+1].scale>=t.scale!==o)break}s>0&&(this._gestures=this._gestures.slice(s+1))}_updateStateWithEvent(t){const e=this.useGestures?t.scale:0!==this._startDistance?this._distance()/this._startDistance:1;if(!this._scaledMinimumAmount)return void(Math.abs(1-e)>=this.scaleThreshold&&(this._scaledMinimumAmount=!0,this.scale=1,this.enterBeganState()));this._recordGesture(t.timeStamp,e);const i=this._gestures[0],n=e-i.scale,o=t.timeStamp-i.timeStamp;this._velocity=0===o?0:n/o*1e3,this.scale*=e/this._gestures[this._gestures.length-2].scale,this.enterChangedState()}}function xs(t){this._map=t,this._recognizers=[]}xs.prototype={constructor:xs,get map(){return this._map},canTrustGestureCenter:function(t){return 1===t.numberOfTouchesRequired||!(Co.supportsGestureEvents&&!Co.supportsTouches&&Co.insideIframe)},addRecognizer:function(t){return this._recognizers.push(t),t.target=this.map.node.element,t.addEventListener("statechange",this),t},interrupt:function(){this._recognizers.forEach((function(t){t.enabled=!1,t.enabled=!0}))},centerForGesture:function(t){const e=this.map;return e.usesInteractionCenter||!this.canTrustGestureCenter(t)?e.interactionCenter:this._centerWithRecognizer(t)},destroy:function(){for(;this._recognizers.length;){const t=this._recognizers.pop();t.enabled=!1,t.target=null,t.removeEventListener("statechange",this)}}};const Ts=xs,Is=kt.performanceMarkers.interactions,Rs=Math.pow(1e-4,2.5);function Os(t){Ts.call(this,t),this._pinchRecognizer=this.addRecognizer(new Es),this._pinchRecognizer.scaleThreshold=.1,this._doubleTapWithOneFingerRecognizer=this.addRecognizer(new ts),this._doubleTapWithOneFingerRecognizer.numberOfTouchesRequired=1,this._doubleTapWithOneFingerRecognizer.numberOfTapsRequired=2,this._singleTapWithTwoFingersRecognizer=this.addRecognizer(new ts),this._singleTapWithTwoFingersRecognizer.numberOfTouchesRequired=2,this._singleTapWithTwoFingersRecognizer.numberOfTapsRequired=1}function Ps(t){return t.state===po.Began||t.state===po.Changed}Os.prototype=p(Ts,Os,{decelerating:!1,stopDecelerating:function(){this.decelerating&&this._decelerationEnded()},destroy:function(){Ts.prototype.destroy.call(this),delete this._pinchRecognizer,delete this._doubleTapWithOneFingerRecognizer,delete this._singleTapWithTwoFingersRecognizer,this.stopDecelerating()},get active(){return Ps(this._pinchRecognizer)||Ps(this._doubleTapWithOneFingerRecognizer)||Ps(this._singleTapWithTwoFingersRecognizer)},handleEvent:function(t){const e=t.target;switch(e){case this._pinchRecognizer:this._handlePinchChange(e);break;case this._doubleTapWithOneFingerRecognizer:this._handleDoubleTapWithOneFingerChange(e);break;case this._singleTapWithTwoFingersRecognizer:this._handleSingleTapWithTwoFingersChange(e)}Is&&performance.measure("mapkit-map-zoom-interaction",{start:e.lastEventTimeStamp,detail:e.state})},performScheduledUpdate:function(t){const e=Is?performance.now():void 0;if(!this.decelerating)return;if(null==t)return void this._decelerationEnded();const i=this.map,n=t-this._startTime;if(n>=this._decelerationDuration)return i.scaleCameraAroundMapPoint(this._adjustedScaleAtDecelerationEnd/this._scale,this._lastScaleCenter),this._decelerationEnded(),void(Is&&performance.measure("mapkit-map-zoom-deceleration",{start:e}));let o=this._scaleAtTime(n);const s=(o-this._initialScale)/(this._scaleAtDecelerationEnd-this._initialScale);o+=this._scaleAdjustment*s,i.scaleCameraAroundMapPoint(o/this._scale,this._lastScaleCenter);const a=i.camera.zoom;a===i.currentMinZoomLevel||a===this.currentMaxZoomLevel?this.stopDecelerating():(this._scale=o,this._schedule()),Is&&performance.measure("mapkit-map-zoom-deceleration",{start:e})},_centerWithRecognizer:function(t){const e=this.map,i=t.locationInElement();let n=e.node.convertPointFromPage(i);n=e.camera.transformGestureCenter(n);const o=e.visibleMapRect,s=e.camera.viewportSize;return new hi.MapPoint(o.minX()+n.x/s.width*o.size.width,o.minY()+n.y/s.height*o.size.height)},_handlePinchChange:function(t){const e=this.map,i=e.camera,n=i.zoom;if(t.state===po.Began)this._singleTapWithTwoFingersRecognizer.enabled=!1,e.cameraWillStartZooming(Pn);else if(t.state===po.Ended||t.state===po.Changed){const i=t.scale;this._lastScaleCenter=this.centerForGesture(t),(i>1&&n!==e.currentMaxZoomLevel||i<1&&n!==e.currentMinZoomLevel)&&(e.scaleCameraAroundMapPoint(i,this._lastScaleCenter),t.scale=1)}if((t.state===po.Ended||t.state===po.Failed)&&(this._singleTapWithTwoFingersRecognizer.enabled=!0,this._startDeceleratingWithVelocity(t),!this.decelerating)){const t=e.snapsToIntegralZoomLevels?Math.round(n):n,o=u(t,e.currentMinZoomLevel,e.currentMaxZoomLevel);n===o?e.cameraDidStopZooming():this._lastScaleCenter?e.scaleCameraAroundMapPoint(Math.pow(2,o-n),this._lastScaleCenter,!0):e.setCameraAnimated(new ks(i.center,o,i.viewportSize,i.rotation),!0)}},_handleDoubleTapWithOneFingerChange:function(t){t.state===po.Recognized&&this._zoomWithTapRecognizer(t,t.modifierKeys.alt)},_handleSingleTapWithTwoFingersChange:function(t){t.state===po.Recognized&&this._zoomWithTapRecognizer(t,!0)},_zoomWithTapRecognizer:function(t,e){const i=this.map,n=i.camera.zoom,o=e?-1:1,s=(e?Math.floor(n+.5):Math.ceil(n-.5))+o,a=n-u(s,i.currentMinZoomLevel,i.currentMaxZoomLevel);Math.abs(a)<.5||!i.cameraWillStartZooming(On,!0,!0)||(i.setCameraAnimated(i.camera.withNewMapRect(i.visibleMapRect.scale(Math.pow(2,a),this.centerForGesture(t))),!0),Is&&performance.measure("mapkit-map-zoom-interaction",{start:t.lastEventTimeStamp,detail:t.state}))},_startDeceleratingWithVelocity:function(t){let e=t.velocity;Math.abs(e)<1||(8<e&&(e=8),e<-8&&(e=-8),this.decelerating=!0,this._startTime=t.lastEventTimeStamp,this._initialScale=this._scale=1,this._initialVelocity=e/1e3,this._decelerationFactor=.98875,this._decelerationDuration=Math.log(Rs/Math.pow(this._initialVelocity,2))/(2*Math.log(this._decelerationFactor)),this._scaleAtDecelerationEnd=this._scaleAtTime(this._decelerationDuration),this._adjustedScaleAtDecelerationEnd=this._adjustScaleAtDecelerationEnd(this._scaleAtDecelerationEnd/this._scale),this._scaleAdjustment=this._adjustedScaleAtDecelerationEnd-this._scaleAtDecelerationEnd,this._schedule())},_adjustScaleAtDecelerationEnd:function(t){const e=this.map,i=e.camera.zoom;let n=i+d(t);if(e.snapsToIntegralZoomLevels){let t=Math.round(n);n>i&&t<=i?t=Math.ceil(n):n<i&&t>=i&&(t=Math.floor(n)),n=t}const o=u(n,e.currentMinZoomLevel,e.currentMaxZoomLevel);return Math.pow(2,o-i)},_schedule:function(){ue.scheduleOnNextFrame(this)},_scaleAtTime:function(t){return Math.max(this._initialScale+this._decelerationFactor*this._initialVelocity*(Math.pow(this._decelerationFactor,t)-1)/(this._decelerationFactor-1),0)},_decelerationEnded:function(){this.decelerating=!1;const t=this.map;if(t.snapsToIntegralZoomLevels){const e=t.camera,i=t.snapsToIntegralZoomLevels?Math.round(e.zoom):e.zoom;t.setCameraAnimated(new ks(e.center,i,e.viewportSize,e.rotation))}t.cameraDidStopZooming()}});const Ds=Os,zs=.75;function Ns(){return{start:new Gi,end:new Gi,dt:0}}function Fs(t){return t.dt<1?new Gi:new Gi((t.end.x-t.start.x)/t.dt*1e3,(t.end.y-t.start.y)/t.dt*1e3)}class Us extends ao{constructor(){super(),this.minimumNumberOfTouches=1,this.maximumNumberOfTouches=1e5,this.translationThreshold=10,this._traveledMinimumDistance=!1,this._previousVelocitySample=Ns(),this._velocitySample=Ns(),this.translation=new Gi}get velocity(){if(void 0===this._lastTouchTime)return new Gi;if(performance.now()-this._lastTouchTime>100)return new Gi;const t=Fs(this._velocitySample);if(ao.SupportsTouches&&this._previousVelocitySample.dt>0){const e=Fs(this._previousVelocitySample);t.x=.25*t.x+zs*e.x,t.y=.25*t.y+zs*e.y}return t}touchesBegan(t){t.currentTarget===this.target&&(t instanceof MouseEvent&&0!==t.button||(super.touchesBegan(t),this._numberOfTouchesIsAllowed()?(this._lastTouchTime=t.timeStamp,this._resetTrackedLocations(),1===this.numberOfTouches&&(this._traveledMinimumDistance=!1)):this.enterFailedState()))}touchesMoved(t){this.preventDefault(t);const e=t.timeStamp,i=this.locationInElement();if(void 0===this._lastTouchTime||void 0===this._lastTouchLocation||void 0===this._translationOrigin)return;const n=e-this._lastTouchTime;n>8&&(this._previousVelocitySample.start=this._velocitySample.start.copy(),this._previousVelocitySample.end=this._velocitySample.end.copy(),this._previousVelocitySample.dt=this._velocitySample.dt,this._velocitySample.start=this._lastTouchLocation.copy(),this._velocitySample.end=i,this._velocitySample.dt=n),this._traveledMinimumDistance?(this.translation.x+=i.x-this._lastTouchLocation.x,this.translation.y+=i.y-this._lastTouchLocation.y,this.enterChangedState()):this._canBeginWithTraveledDistance(new Gi(i.x-this._translationOrigin.x,i.y-this._translationOrigin.y))&&(this._traveledMinimumDistance=!0,this.enterBeganState()),this._lastTouchTime=e,this._lastTouchLocation=i}touchesEnded(t){this._numberOfTouchesIsAllowed()?this._resetTrackedLocations():this._traveledMinimumDistance?this.enterEndedState():this.enterFailedState()}reset(){this._velocitySample=Ns(),this._previousVelocitySample=Ns(),this.translation=new Gi,this._traveledMinimumDistance=!1}_canBeginWithTraveledDistance(t){return Math.abs(t.x)>=this.translationThreshold||Math.abs(t.y)>=this.translationThreshold}_numberOfTouchesIsAllowed(){return this.numberOfTouches>=this.minimumNumberOfTouches&&this.numberOfTouches<=this.maximumNumberOfTouches}_resetTrackedLocations(){const t=this.locationInElement();this._lastTouchLocation=t,this._translationOrigin=t}}const Gs=1e8,Bs=.995,Zs=kt.performanceMarkers.interactions;function Ws(t){Ts.call(this,t);this.addRecognizer(new Us).maximumNumberOfTouches=2}Ws.prototype=p(Ts,Ws,{decelerating:!1,stopDecelerating:function(){this.decelerating&&this._decelerationEnded()},destroy:function(){Ts.prototype.destroy.call(this),this.stopDecelerating()},handleEvent:function(t){const e=t.target,i=this.map;i.usesInteractionCenter&&i.cameraIsZooming||(e.state===po.Began?i.cameraWillStartPanning():e.state!==po.Ended&&e.state!==po.Changed||(this._panMapCameraBy(e.translation),e.translation=new Gi),e.state===po.Ended&&(this._startDeceleratingWithVelocity(e),this.decelerating||i.cameraDidStopPanning()),Zs&&performance.measure("mapkit-map-pan-interaction",{start:e.lastEventTimeStamp,detail:e.state}))},performScheduledUpdate:function(t){const e=Zs?performance.now():void 0;if(!this.decelerating)return;if(null==t)return void this._decelerationEnded();const i=t-this._timeAtPreviousFrame;if(i>300)return void this._decelerationEnded();const n=Math.exp(Math.log(Bs)*i),o=Bs*((1-n)/.0050000000000000044);if(this._panMapCameraBy(new Gi(this._velocity.x/1e3*o,this._velocity.y/1e3*o)),this._velocity.x*=n,this._velocity.y*=n,Math.abs(this._velocity.x)<=10&&Math.abs(this._velocity.y)<=10)return this._decelerationEnded(),void(Zs&&performance.measure("mapkit-map-pan-deceleration",{start:e}));this._timeAtPreviousFrame=t,this._schedule(),Zs&&performance.measure("mapkit-map-pan-deceleration",{start:e})},_panMapCameraBy:function(t){const e=this.map;e.setCameraAnimated(e.camera.translate(t))},_startDeceleratingWithVelocity:function(t){const e=t.velocity;this._velocity=e,this.map.cameraWillStopPanning();const i=Math.pow(e.x,2)+Math.pow(e.y,2);if(!(i<62500)){if(i>Gs){const t=Math.sqrt(Gs/i);this._velocity={x:e.x*t,y:e.y*t}}this.decelerating=!0,this._timeAtPreviousFrame=t.lastEventTimeStamp,this._schedule()}},_schedule:function(){ue.scheduleOnNextFrame(this)},_decelerationEnded:function(){this.decelerating=!1,this.map.cameraDidStopPanning()}});const Ks=Ws;const Hs={getCorsAttribute:function(t){return t?"use-credentials":"anonymous"}};const js=class extends Q{constructor(t,e){super(t,e),this._image=null,this.crossOrigin=null}get image(){return this._image}get url(){return this._image?.src??null}reuse(t,e){this._init(t,e)}_loaderWillStart(){super._loaderWillStart(),this._image||(this._image=document.createElement("img"));const t=this._getDelegate().urlForImageLoader;this._image.crossOrigin=this.crossOrigin,this._image.src=t,this._image.addEventListener("load",this),this._image.addEventListener("error",this)}handleEvent(t){switch(t.type){case"error":this._loaderDidFail(this._image);break;case"load":this._loaderDidSucceed(null)}}_reset(){this._image&&(this._image.removeEventListener("load",this),this._image.removeEventListener("error",this)),super._reset()}},Vs={},qs=[];function Ys(t,e,i,n,o,s,a,r,l,h,c){this.x=t,this.y=e,this.z=i,this.tileSource=n,this.tint=o,this.emphasis=s,this.language=a,this.poi=r?1:0,this.labels=l?1:0,this.resolution=h,this._priority=c,this._loader=Xs(c,this),this._setLoaderCrossOriginMode()}function Xs(t,e){let i;return qs.length>0?(i=qs.shift(),i.reuse(t,e)):i=new js(t,e),i}Ys.prototype={constructor:Ys,get preferredOpacity(){return"number"==typeof this.tileSource.opacity?this.tileSource.opacity:1},get loaderState(){return this._loader?this._loader.state:J.Unscheduled},schedule:function(){this._loader||(this._loader=Xs(this._priority,this),this._setLoaderCrossOriginMode()),this._loader.state>J.Unscheduled||this._loader.schedule()},unschedule:function(){if(!this._loader)return;this._loader.unschedule()&&(qs.push(this._loader),this._loader=null)},whenDoneLoading:function(t){this._doneLoadingCallback=t},get urlForImageLoader(){const t=this.tileSource;if("function"==typeof t.urlForImageLoader)return t.urlForImageLoader(this.x,this.y,this.z,this.resolution);const e=t.domains,i=t.proxyPrefixes,n=t.protocol,o=t.supportedResolutions[0],s=t.supportedResolutions[t.supportedResolutions.length-1],a=u(this.resolution,o,s);let r=1;if("satellite"===t.name){const e=t.supportedSizes.length-1,i=t.supportedSizes[0],n=t.supportedSizes[e];r=u(this.resolution,i,n)}let l=w(t.path,{x:this.x,y:this.y,z:this.z,resolution:a,tileSizeIndex:r,lang:this.language,poi:this.poi});"satellite"!==t.name&&(0===this.labels?l+="&labels=0&tint="+this.tint+"&emphasis="+this.emphasis:l+="&emphasis="+this.emphasis+"&tint="+this.tint);let h=Vs[l];if(h)return h;const c=Math.floor(76731.36742*(this.x+this.y))%e.length;if(h=n+"//"+e[c]+l,i){h=i[c%i.length]+h}return Vs[l]=h,h},loaderDidSucceed:function(t){this._loaderDidComplete()},loaderDidFail:function(t){this._loaderDidComplete()},_setLoaderCrossOriginMode:function(){this.tileSource.crossOrigin&&(this._loader.crossOrigin=Hs.getCorsAttribute(this.tileSource.withCredentials))},_loaderDidComplete:function(){this.image=this._loader.image,"function"==typeof this._doneLoadingCallback&&(this._doneLoadingCallback(this),delete this._doneLoadingCallback)}};const $s=Ys;function Js(t,e,i,n,o,s,a){this.key=t,this.x=e,this.y=i,this.z=n,this.settings=o,this.resolution=s,this.priority=a,this.tileImages=[]}Js.Events={LoadSuccess:"tile-load-success",LoadFail:"tile-load-fail"},Js.prototype=p(T.EventTarget,Js,{loading:!1,loaded:!1,get tileSources(){return(this.settings.showsDefaultTiles?this.settings.configuration.tileSources:[]).concat(this.settings.tileOverlays.map((t=>t._impl)).filter((function(t){return!!t.urlForImageLoader(this.x,this.y,this.z,this.resolution)}),this)).filter((function(t){return(this.z>=t.minZoomLevel||"number"!=typeof t.minZoomLevel)&&(this.z<=t.maxZoomLevel||"number"!=typeof t.maxZoomLevel)}),this)},schedule:function(){this.loaded||(this.tileImages.forEach((t=>{t.schedule()})),this.loading=!0)},unschedule:function(){this.tileImages.forEach((t=>{t.unschedule()})),this.loading=!1},_loadTileImages:function(){if(this.loading)return;if(this.loaded){if(!this._containsCanceledTileImages())return;this.tileImages=[],this.loaded=!1}this.loading=!0;const t=this.tileSources;0!==t.length?(this._pendingTileImageLoads=t.length,t.forEach(this._loadTileImage,this)):this._allTileImagesDoneLoading()},_loadTileImage:function(t){const e=this.settings,i=new $s(this.x,this.y,this.z,t,e.tint,e.emphasis,e.language,e.showsPOI,e.showsLabels,this.resolution,this.priority);i.schedule(),this.tileImages.push(i),i.whenDoneLoading((()=>this._tileImageDoneLoading(t,i)))},_requestTileImageLoadStatus:function(t,e){const i=X(e,t.image.src);i.open("GET",t.image.src,!0),i.send()},_tileImageDoneLoading:function(t,e){if(e._loader.state===J.Failed)if("function"==typeof t.dispatchErrorForURL)t.dispatchErrorForURL(e._loader.url);else{const t=new T.Event(Js.Events.LoadFail);t.tileImage=e,this.dispatchEvent(t)}this._pendingTileImageLoads--,0===this._pendingTileImageLoads&&this._allTileImagesDoneLoading()},_allTileImagesDoneLoading:function(){delete this._pendingTileImageLoads,this.loading=!1,this.loaded=!0,this._containsCanceledTileImages()||this.dispatchEvent(new T.Event(Js.Events.LoadSuccess))},_containsCanceledTileImages:function(){return this.tileImages.some((t=>t.loaderState===J.Canceled))}});const Qs=Js,ta={};function ea(t,e,i,n){return n.settings.configuration.provider+n.settings.configuration.countryCode+n.settings.configuration.name+t+"-"+e+"-"+i+n.settings.tint+n.settings.emphasis+n.settings.language+n.settings.showsPOI+n.settings.showsLabels+n.settings.showsDefaultTiles+n.settings.showsTileInfo+n.resolution+n.settings.tileOverlays.map((n=>n._impl.keyForTile(t,e,i))).join("-")}function ia(t){const e=t.target;e.removeEventListener(Qs.Events.LoadSuccess,ia),e.removeEventListener(Qs.Events.LoadFail,na)}function na(t){const e=t.target;delete ta[e.key],e.removeEventListener(Qs.Events.LoadSuccess,ia),e.removeEventListener(Qs.Events.LoadFail,na)}const oa={tilesForTileData:function(t){const e=t.range,i=e.min.z,n=Math.pow(2,i),o=e.min,s=e.denormalize().max,a=new Gi((o.x+s.x)/2,(o.y+s.y)/2),r=[],l=Math.min(s.x,o.x+n-1);for(let t=o.x;t<=l;++t)for(let e=o.y;e<=s.y;++e)r.push(new Gi(t,e));return r.sort((function(t,e){const i=t.distanceToPoint(a)-e.distanceToPoint(a);return 0===i?t.x-e.x==0?t.y-e.y:t.x-e.x:i})),r.map((function(e){return function(t,e,i,n,o){const s=ea(t,e,i,n);let a=ta[s];a?a.schedule():(a=new Qs(s,t,e,i,n.settings,n.resolution,o),a.addEventListener(Qs.Events.LoadSuccess,ia),a.addEventListener(Qs.Events.LoadFail,na),ta[s]=a,a._refCount=0,a._loadTileImages());return a._refCount++,a}(c(e.x,n),e.y,i,t,N.High)}))},releaseTile:function(t,e){if(t._refCount--,0===t._refCount){t.unschedule();const i=ea(t.x,t.y,t.z,e);delete ta[i]}}};function sa(t,e){this.min=t,this.max=e}sa.prototype={constructor:sa,denormalize:function(){const t=this.min.copy(),e=this.max.copy();return e.x<t.x&&(e.x+=Math.pow(2,t.z)),new sa(t,e)},toString:function(){return this.min.toString()+" -> "+this.max.toString()},equals:function(t){const e=this.denormalize(),i=t.denormalize();return i.min.x===e.min.x&&i.min.y===e.min.y&&i.max.x===e.max.x&&i.max.y===e.max.y&&i.min.z===e.min.z&&i.max.z===e.max.z}};const aa=sa;function ra(t,e){const i=Co.getIntegralZoom(t.zoom),n=Math.pow(2,i),o=Math.pow(2,t.zoom)*hi.tileSize,s=t.viewportSize.width/o/2,a=t.viewportSize.height/o/2,r=new hi.MapPoint(t.center.x-s,t.center.y-a),l=new hi.MapPoint(t.center.x+s,t.center.y+a),h=n-1,c=Math.floor(r.x*n),d=Math.floor(l.x*n),p=u(Math.floor(r.y*n),0,h),m=u(Math.floor(l.y*n),0,h);this.range=new aa(new Gi(c,p,i),new Gi(d,m,i)),this.settings=e,this.resolution=Co.devicePixelRatio,this.zoom=i,this.mapRect=new hi.MapRect(c/n,p/n,(d-c)/n,(m-p)/n),this.mapRect.size.width<0&&this.mapRect.size.width++}ra.prototype={constructor:ra,equals:function(t){return this.sameSettings(t)&&this.resolution===t.resolution&&this.range.equals(t.range)},sameSettings:function(t){const e=this.settings,i=t.settings;return e.configuration===i.configuration&&e.tint===i.tint&&e.emphasis===i.emphasis&&e.showsPOI===i.showsPOI&&e.showsLabels===i.showsLabels&&e.language===i.language&&e.showsDefaultTiles===i.showsDefaultTiles&&e.showsTileInfo===i.showsTileInfo&&this.sameTileOverlays(t)},sameTileOverlays:function(t){return this.settings.tileOverlays.length===t.settings.tileOverlays.length&&this.settings.tileOverlays.every((function(e,i){return e===t.settings.tileOverlays[i]&!e._impl.stale}),this)},sharesTileSourcesWithTileData:function(t){if(this.settings.tint!==t.settings.tint||this.settings.emphasis!==t.settings.emphasis)return!1;const e=this.settings.configuration.tileSources,i=t.settings.configuration.tileSources;return!("AutoNavi"!==this.settings.configuration.provider||"AutoNavi"!==t.settings.configuration.provider||1!==e.length||1!==i.length||"satellite"!==e[0].name&&"hybrid"!==e[0].name||"satellite"!==i[0].name&&"hybrid"!==i[0].name)||i.some((t=>-1!==e.indexOf(t)))},load:function(){this._tiles||(this._tiles=oa.tilesForTileData(this))},cancel:function(){if(!this._canceled&&(this._canceled=!0,this._tiles))for(let t=0,e=this._tiles,i=e.length;t<i;++t)e[t].unschedule()},releaseTiles:function(){if(this._tiles)for(let t=0,e=this._tiles,i=e.length;t<i;++t)oa.releaseTile(e[t],this)},get tiles(){return this.load(),this._tiles}};const la=ra,ha=["minimumZ","maximumZ","opacity","data"];function ca(t,e,i){this._public=t,i=v(i),ha.forEach((function(t){void 0!==i[t]&&(this[t]=i[t])}),this),Object.keys(i).forEach((function(t){ha.indexOf(t)<0&&console.warn("[MapKit] Unknown option: "+t+". Use the data property to store custom data.")})),this.urlTemplate=e,void 0===this.opacity&&(this.opacity=1),this.stale=!1}ca.RELOAD_EVENT="tile-overlay-reload",ca.OPACITY_EVENT="tile-overlay-opacity-changed",ca.ERROR_EVENT="tile-error",ca.prototype={constructor:ca,_minimumZ:null,_maximumZ:null,get urlTemplate(){return this._urlTemplate},set urlTemplate(t){const e=typeof t;if("function"!==e&&"string"!==e){throw new TypeError("[MapKit] TileOverlay.urlTemplate expected a function or a string, but got `"+t+"` instead.")}this._urlTemplate=t},keyForTile:function(t,e,i){return this._minimumZ+"-"+this._maximumZ+"-"+this.urlForImageLoader(t,e,i,1)},get minimumZ(){return this._minimumZ},get minZoomLevel(){return this._minimumZ},set minimumZ(t){_(t,"number","[MapKit] TileOverlay.minimumZ expected a number, but got `"+t+"` instead."),this._minimumZ=Math.floor(t)},get maximumZ(){return this._maximumZ},get maxZoomLevel(){return this._maximumZ},set maximumZ(t){_(t,"number","[MapKit] TileOverlay.maximumZ expected a number, but got `"+t+"` instead."),this._maximumZ=Math.ceil(t)},get opacity(){return this._opacity},set opacity(t){_(t,"number","[MapKit] TileOverlay.opacity expected a number, but got `"+t+"` instead."),this._opacity=u(t,0,1);const e=new St.Event(ca.OPACITY_EVENT);e.tileOverlay=this,e.opacity=this._opacity,this._public.dispatchEvent(e)},get data(){return Object.prototype.hasOwnProperty.call(this,"_data")||(this._data={}),this._data},set data(t){_(t,"object","[MapKit] TileOverlay.data expected an Object, but got `"+t+"` instead."),this._data=t},reload:function(){this.stale=!0;const t=new St.Event(ca.RELOAD_EVENT);t.tileOverlay=this,this._public.dispatchEvent(t)},reloadComplete:function(){this.stale=!1},urlForImageLoader:function(t,e,i,n){if(!this._urlTemplate)return;if("function"==typeof this._urlTemplate)return it(this._urlTemplate,null,[t,e,i,n,this._data]);const o=this._urlTemplate.replace(/\{/g,"{{").replace(/\}/g,"}}");const s={};return this._data&&Object.keys(this._data).forEach((t=>{s[t]=this._data[t]})),s.x=t,s.y=e,s.z=i,s.scale=n,w(o,s)},withCredentials:!1,crossOrigin:!1,dispatchErrorForURL:function(t){const e=new St.Event(ca.ERROR_EVENT);e.tileOverlay=this._public,e.tileUrl=t,this._public.dispatchEvent(e)}};const da=ca;function ua(t,e){Yo(this,ua)&&Object.defineProperty(this,"_impl",{value:new da(this,t,e)})}ua.prototype=p(St.EventTarget,ua,{get urlTemplate(){return this._impl.urlTemplate},set urlTemplate(t){this._impl.urlTemplate=t},get minimumZ(){return this._impl.minimumZ},set minimumZ(t){this._impl.minimumZ=t},get maximumZ(){return this._impl.maximumZ},set maximumZ(t){this._impl.maximumZ=t},get opacity(){return this._impl.opacity},set opacity(t){this._impl.opacity=t},get data(){return this._impl.data},set data(t){this._impl.data=t},reload:function(){this._impl.reload()}});const pa=ua,ma=.0075;function ga(t,e){switch(e){case WheelEvent.DOM_DELTA_LINE:t*=100/3*window.devicePixelRatio;break;case WheelEvent.DOM_DELTA_PAGE:t*=100*window.devicePixelRatio}return t}function _a(t){return t.ctrlKey}function fa(t){const e=t.shiftKey&&!!t.deltaX&&!t.deltaY;let i=e?t.deltaX:t.deltaY;i=ga(i,t.deltaMode),(t.ctrlKey||!t.shiftKey||e)&&(i*=-1),t.ctrlKey&&t.deltaMode===t.DOM_DELTA_PIXEL&&(i*=10);return 1+(i>0?Math.sqrt(i):-Math.sqrt(-i))*ma}const ya=(t,e)=>{let i=t;for(;i.parentNode!==document.body;){i=i.parentNode,window.ShadowRoot&&i instanceof window.ShadowRoot&&(i=i.host);const t=window.getComputedStyle(i);switch(e){case"x":if(["auto","scroll"].includes(t.overflowX)&&i.scrollWidth>i.clientWidth)return!0;break;case"y":if(["auto","scroll"].includes(t.overflowY)&&i.scrollHeight>i.clientHeight)return!0}if("fixed"===t.position)return!1}switch(e){case"x":{const t=window.getComputedStyle(document.body).overflowX,e=window.getComputedStyle(document.documentElement).overflowX;if(["auto","scroll","visible"].includes(t)&&["auto","scroll","visible"].includes(e)&&("CSS1Compat"===document.compatMode?document.documentElement.scrollWidth>document.documentElement.clientWidth:document.body.scrollWidth>document.body.clientWidth))return!0;break}case"y":{const t=window.getComputedStyle(document.body).overflowY,e=window.getComputedStyle(document.documentElement).overflowY;if(["auto","scroll","visible"].includes(t)&&["auto","scroll","visible"].includes(e)&&("CSS1Compat"===document.compatMode?document.documentElement.scrollHeight>document.documentElement.clientHeight:document.body.scrollHeight>document.body.clientHeight))return!0;break}}return!1},va=kt.performanceMarkers.interactions,wa=Math.log2(1.03)/(1e3/60),ba=Math.log2(.97)/(1e3/60),Ca=Math.log2(1.06)/(1e3/60),ka=Math.log2(.94)/(1e3/60),Ma=100,Sa=Math.log2(1.0075),La=Math.log2(.9925);function Aa(t){this.map=t,this.map.node.element.addEventListener("wheel",this),this._previousZoomLevelDelta=[],this._nextEventIsPan=!1,this._nextEventIsZoom=!1,this.pannable=!1,this.zoomable=!1}Aa.prototype={constructor:Aa,_animating:!1,destroy:function(){this.map.node.element.removeEventListener("wheel",this),clearTimeout(this._wheelEndTimeoutId),this.map=null,this._animationEndingTimeoutId&&clearTimeout(this._animationEndingTimeoutId)},handleEvent(t){this._handleWheelZoom(t)},performScheduledUpdate:function(t){if(!this.map)return;const e=this.zoomsIn?Math.ceil(this._accumulatedDesiredZoomLevelDelta):Math.floor(this._accumulatedDesiredZoomLevelDelta),i=t-this._timeAtLastFrame,n=this._getEstimatedSpeedPerMS()*i;this._accumulatedZoomLevelDelta+=n,this._timeAtLastFrame=t;if(!(this.zoomsIn&&this._accumulatedZoomLevelDelta<e||!this.zoomsIn&&this._accumulatedZoomLevelDelta>e)){const t=this.map.zoomLevel,e=Math.round(this.map.zoomLevel);return this.map.scaleCameraAroundMapPoint(Math.pow(2,e-t),this._lastScaleCenter),this._animating=!1,this._previousEstimatedSpeedPerMS=void 0,void(this._animationEndingTimeoutId=setTimeout((()=>{this._animationEndingTimeoutId=void 0,this.map.cameraDidStopZooming()}),Ma))}this.map.scaleCameraAroundMapPoint(Math.pow(2,n),this._lastScaleCenter),ue.scheduleOnNextFrame(this)},_handleWheelZoom(t){if(!this._nextEventIsPan&&!this._nextEventIsZoom&&!t.ctrlKey&&!t.shiftKey&&this.map.allowWheelToZoom2){const e=this.map.node.element;if(t.deltaX&&ya(e,"x"))return;if(t.deltaY&&ya(e,"y"))return}const e=_a(t),i=this.map.allowWheelToZoom||this.map.allowWheelToZoom2;if(!e&&!t.shiftKey&&!i)return;const n=fa(t),o=3*Math.abs(t.deltaX)>2*Math.abs(t.deltaY),s=this.map.allowWheelToZoom2&&!this._nextEventIsZoom&&(this._nextEventIsPan||1===n||!t.shiftKey&&o);if(s&&!this.pannable)return;if(!s&&!this.zoomable)return;if(s?(clearTimeout(this._nextEventIsPanTimer),this._nextEventIsPanTimer=setTimeout((()=>{this._nextEventIsPan=!1}),Ma),this._nextEventIsPan=!0):(clearTimeout(this._nextEventIsZoomTimer),this._nextEventIsZoomTimer=setTimeout((()=>{this._nextEventIsZoom=!1}),Ma),this._nextEventIsZoom=!0),t.preventDefault(),s)return void this.map.setCameraAnimated(this.map.camera.translate(new Gi(-ga(t.deltaX),-ga(t.deltaY))));const a=this.map;if(n>1&&a.camera.zoom===a.currentMaxZoomLevel||n<1&&a.camera.zoom===a.currentMinZoomLevel)return;const r=new Gi(t.pageX,t.pageY);this._lastScaleCenter=a.usesInteractionCenter?a.interactionCenter:this._mapPointFromCentroid(r),a.snapsToIntegralZoomLevels?this._integralZoomToScale(n,this._lastScaleCenter,t.timeStamp):this._wheelZoomToScale(n),va&&performance.measure("mapkit-map-zoom-interaction",{start:t.timeStamp,detail:"changed"})},_mapPointFromCentroid(t){const e=this.map;let i=e.node.convertPointFromPage(t);i=e.camera.transformGestureCenter(i);const n=e.visibleMapRect,o=e.camera.viewportSize;return new hi.MapPoint(n.minX()+i.x/o.width*n.size.width,n.minY()+i.y/o.height*n.size.height)},_integralZoomToScale:function(t,e,i){this._lastUpdateTime=i;const n=Math.log2(t);this.zoomsIn=n>0,this._lastScaleCenter=e,this._previousZoomLevelDelta.push({delta:n,timestamp:i}),this._animating?this._accumulatedDesiredZoomLevelDelta+=n:(this._cleanupPreviousZoomLevelDelta(),La<=n&&n<=Sa&&this._previousZoomLevelDelta.length<=1||(this._animating=!0,this._accumulatedZoomLevelDelta=0,this._accumulatedDesiredZoomLevelDelta=n,this._timeAtLastFrame=i,this._animationEndingTimeoutId?(clearTimeout(this._animationEndingTimeoutId),this._animationEndingTimeoutId=void 0):this.map.cameraWillStartZooming(Rn),ue.scheduleOnNextFrame(this)))},_cleanupPreviousZoomLevelDelta:function(){const t=performance.now()-100,e=this.zoomsIn?1:-1;for(let i=0;i<this._previousZoomLevelDelta.length;i++)(this._previousZoomLevelDelta[i].timestamp<t||this._previousZoomLevelDelta[i].delta*e<0)&&this._previousZoomLevelDelta.splice(i,1)},_getEstimatedSpeedPerMS:function(){if(this._cleanupPreviousZoomLevelDelta(),this._previousZoomLevelDelta.length<=1)return this._previousEstimatedSpeedPerMS?this._previousEstimatedSpeedPerMS:this.zoomsIn?Ca:ka;let t=this._previousZoomLevelDelta.reduce((function(t,e){return t+e.delta}),0)/100;return ba<t&&t<wa&&(t=this.zoomsIn?wa:ba),this._previousEstimatedSpeedPerMS=t,t},_wheelZoomToScale:function(t){const e=this.map;this._wheelZooming||(e.cameraWillStartZooming(Rn),this._wheelZooming=!0),e.scaleCameraAroundMapPoint(t,this._lastScaleCenter),this._wheelEndTimeoutId&&(clearTimeout(this._wheelEndTimeoutId),this._wheelEndTimeoutId=null),this._wheelEndTimeoutId=setTimeout((()=>{this._wheelEndTimeoutId=null,this._wheelZooming=!1,e.cameraDidStopZooming()}),Ma)}};const Ea=Aa,xa=1-Math.pow(2,-52),Ta=Math.PI/3,Ia=Math.tan(Ta/2);function Ra(t){this.node=t,this._configuration=null,this._debug=!1,this._language=null,this.allowWheelToZoom=!1,this.allowWheelToZoom2=!1,this._pointOfInterestFilter=null,this._showsDefaultTiles=!0,this._tileOverlays=[],this._filteredPois=new Set,this._={},this._[vs]=!1,this.camera=new ks,this._element=document.createElement("div"),this.currentMinZoomLevel=this.minZoomLevel,this.currentMaxZoomLevel=this.maxZoomLevel}Ra.prototype={constructor:Ra,get element(){return this._element},deactivate:function(){this.pannable=!1,this.zoomable=!1,this.node.delegate=null},destroy:function(t){!t&&this.cameraAnimation&&this.cameraAnimation.cancel(),this._tileOverlays.forEach((t=>{t.removeEventListener(da.RELOAD_EVENT,this)})),this._initialInteractionController&&(this._initialInteractionController.destroy(),this._initialInteractionController=null),this._panController&&(this._panController.destroy(),this._panController=null),this._wheelEventHandler&&(this._wheelEventHandler.destroy(),delete this._wheelEventHandler),this._zoomController&&(this._zoomController.destroy(),this._zoomController=null),this._rotationController&&(this._rotationController.destroy(),this._rotationController=null),delete this.node.delegate},minZoomLevel:-1/0,maxZoomLevel:1/0,usesInteractionCenter:!1,cameraAnimation:null,isRotationEnabled:!1,isRotationLocked:!0,snapsToIntegralZoomLevels:!1,get configuration(){return this._configuration},set configuration(t){this._configuration!==t&&this.updateConfiguration(t)},get tint(){return this._tint},get tileTint(){return this._tileTint},get emphasis(){return this._emphasis},setTintAndEmphasis:function(t,e,i){t===this._tint&&e===this._tileTint&&i===this._emphasis||(this._tint=t,this._tileTint=e,this._emphasis=i,this.updateTintAndEmphasis(t,e,i))},get language(){return this._language},set language(t){this._language!==t&&(this._language=t,this.refresh())},get pointOfInterestFilter(){return this._pointOfInterestFilter},set pointOfInterestFilter(t){this._pointOfInterestFilter!==t&&(this._pointOfInterestFilter=t,this.updatePointOfInterestFilter())},get size(){return this.camera.viewportSize.copy()},set size(t){this.adjustForSize(t.copy()),t.width>0&&t.height>0&&this._updateZoom(!1)},adjustForSize:function(t){if(this._visibleMapRect&&this._visibleMapRect.size.width>0&&this._visibleMapRect.size.height>0&&t.width>0&&t.height>0){const e=this._visibleMapRect;delete this._visibleMapRect,this.setCameraAnimated(this.camera.withNewMapRect(e,this.snapsToIntegralZoomLevels,t))}else{let e=null;Object.prototype.hasOwnProperty.call(this,"_pendingCameraDistance")&&(e=this._pendingCameraDistance);const i=this.camera;this.setCameraAnimated(new ks(i.center,i.zoom,t,i.rotation)),null!==e&&this.setCameraDistanceAnimated(e,!1)}},get cameraIsPanning(){return!!this._panning},get pannable(){return!!this._panController},set pannable(t){if(!t&&this._panController?(this._panController.destroy(),delete this._panController):t&&!this._panController&&(this._initialInteractionController||(this._initialInteractionController=new As(this)),this._panController=new Ks(this)),!t&&!this.zoomable&&this._wheelEventHandler)return this._wheelEventHandler.destroy(),void delete this._wheelEventHandler;this._wheelEventHandler||(this._wheelEventHandler=new Ea(this)),this._wheelEventHandler.zoomable=this.zoomable,this._wheelEventHandler.pannable=t},get cameraIsZooming(){return!!this._zooming||!!this._suspendedZoom},get zoomable(){return!!this._zoomController},set zoomable(t){if(!t&&this._zoomController?(this._zoomController.destroy(),delete this._zoomController):t&&!this._zoomController&&(this._initialInteractionController||(this._initialInteractionController=new As(this)),this._zoomController=new Ds(this)),!t&&!this.pannable&&this._wheelEventHandler)return this._wheelEventHandler.destroy(),void delete this._wheelEventHandler;this._wheelEventHandler||(this._wheelEventHandler=new Ea(this)),this._wheelEventHandler.zoomable=t,this._wheelEventHandler.pannable=this.pannable},get cameraIsRotating(){return!!this._rotating},get visibleMapRect(){return this._visibleMapRect||this.camera.toMapRect()},set visibleMapRect(t){this.setVisibleMapRectAnimated(t)},setVisibleMapRectAnimated:function(t,e){if(this.camera.viewportSize.equals(Ui.Zero))this._visibleMapRect=t.copy();else{const i=this.camera.withNewMapRect(t,this.snapsToIntegralZoomLevels);i.rotation=0,this.setCameraAnimated(i,!!e)}},setCenterAnimated:function(t,e){const i=t.toMapPoint();if(this._visibleMapRect)this._visibleMapRect=new hi.MapRect(i.x-this._visibleMapRect.size.width/2,i.y-this._visibleMapRect.size.height/2,this._visibleMapRect.size.width,this._visibleMapRect.size.height);else{const t=this.camera.copy();t.center=i,this.setCameraAnimated(t,e)}},setCameraBoundaryAnimated:function(t,e){t?(this._cameraBeforeBoundaryChange=this.camera,this._cameraBoundaryRect=new hi.MapRect(t.origin.x,t.origin.y,u(t.size.width,0,1),Math.max(t.size.height,0)),this.setCameraAnimated(this.camera.copy(),e),delete this._cameraBeforeBoundaryChange):delete this._cameraBoundaryRect},constrainCamera:function(t){this._cameraBoundaryRect&&(t.center=this._constrainCenterWithinBounds(t.center)),this._updateMinAndMaxZoomLevelsAtY(t.center.y),t.zoom=u(t.zoom,this.currentMinZoomLevel,this.currentMaxZoomLevel)},constrainCameraRotation:function(t){const e=this.isRotationLocked;if(this.isRotationLocked=t.zoom<7,0!==t.rotation&&this.isRotationLocked)return t.rotation=0,!e&&0!==this.camera.rotation},get transformCenter(){const t=this.node.delegate;return t&&"function"==typeof t.mapTransformCenter?t.mapTransformCenter(this.node):this.camera.center},get interactionCenter(){const t=this.node.delegate;return t&&"function"==typeof t.mapInteractionCenter?t.mapInteractionCenter(this.node):this.camera.center},get zoomLevel(){return this.camera.zoom},set zoomLevel(t){this.setZoomLevelAnimated(t)},setZoomLevelAnimated:function(t,e){if(delete this._cameraDistance,this._suspendedZoom)return this._suspendedZoom.animated=this._suspendedZoom.animated||this._suspendedZoom.level!==t,void(this._suspendedZoom.level=t);if(this.cameraAnimation&&!e)return void(this.cameraAnimation.additiveZoom=t);const i=this.zoomLevel,n=u(t,this.currentMinZoomLevel,this.currentMaxZoomLevel);if(i===n)return;const o=this.interactionCenter,s=this.camera;o.equals(s.center)?this.setCameraAnimated(new ks(s.center,n,s.viewportSize,s.rotation),e):this.scaleCameraAroundMapPoint(Math.pow(2,n-i),this.interactionCenter,e)},setCameraDistanceAnimated:function(t,e){if(0===this.camera.viewportSize.width)return void(this._pendingCameraDistance=t);let i=this.zoomLevelForCameraDistanceAtY(t,this.camera.center.y);this.snapsToIntegralZoomLevels&&(i=Co.getIntegralZoom(i)),this.setZoomLevelAnimated(i,e),this._cameraDistance=t},getCurrentCameraDistance:function(){return this.visibleMapRect.size.width/2/hi.mapUnitsPerMeterAtLatitude(this.camera.center.toCoordinate().latitude)/Ia},get cameraZoomRange(){return this._cameraZoomRange?this._cameraZoomRange.copy():new hi.CameraZoomRange},setCameraZoomRangeAnimated:function(t,e){t?(this._cameraZoomRange=t.copy(),delete this._cameraZoomLevelLimit):delete this._cameraZoomRange,this._updateZoom(e)},setCameraZoomLevelLimitAnimated:function(t,e){t?(this._cameraZoomLevelLimit={minZoomLevel:t.minZoomLevel,maxZoomLevel:t.maxZoomLevel},delete this._cameraZoomRange):delete this._cameraZoomLevelLimit,this._updateZoom(e)},zoomLevelForCameraDistanceAtY:function(t,e){return this._zoomLevelForCameraDistanceAtLatitude(t,hi.convertYToLatitude(e))},adjustMapItemPoint:function(t){if(this.cameraIsZooming||this._pendingCameraDrawingReadiness)return t;if(!this._pointAdjustmentReference){const t=this.camera.zoom,e=this.visibleMapRect.origin,i=new la(this.camera),n=i.zoom,o=i.mapRect.origin,s=Math.pow(2,t-n),a=hi.pointsPerAxis(n)*s;this._pointAdjustmentReference=new Gi((o.x-e.x)*a,(o.y-e.y)*a)}return t.x=Co.roundToDevicePixel(this._pointAdjustmentReference.x)+Co.roundToDevicePixel(t.x-this._pointAdjustmentReference.x),t.y=Co.roundToDevicePixel(this._pointAdjustmentReference.y)+Co.roundToDevicePixel(t.y-this._pointAdjustmentReference.y),t},scaleCameraAroundMapPoint:function(t,e,i){const n=hi.pointsPerAxis(this.currentMinZoomLevel),o=this.camera.viewportSize,s=this.visibleMapRect.size,a=1/t,r=n>0?o.width/(s.width*n):a,l=n>0?o.height/(s.height*n):a,h=Math.min(a,r,l),c=e.x+(e.x<1?1:-1),d=this.visibleMapRect;c>=d.origin.x&&c<=d.maxX()&&(e=new hi.MapPoint(c,e.y));const u=this.camera.withNewMapRect(d.scale(h,e),!1);this.setCameraAnimated(u,i)},setCameraAnimated:function(t,e,i,n){if(0===t.viewportSize.width||0===t.viewportSize.height)return this._pendingCameraDrawingReadiness=!0,void(this.camera=t);delete this._pendingCameraDistance;const o=this.camera;t.viewportSize.equals(o.viewportSize)||(this._updateMinAndMaxZoomLevels(t.viewportSize),!e&&this.cameraAnimation&&this.cameraAnimation.updateViewportSize(t.viewportSize)),n||this.constrainCamera(t);const s=this.constrainCameraRotation(t),a=t.toMapRect().size,r=a.width/2,l=a.height/2;if(t.center.x=c(t.center.x-r,1)+r,t.center.y=u(t.center.y,l,xa-l),this._pendingCameraDrawingReadiness||!t.equals(o))if(delete this._pendingCameraDrawingReadiness,this._cameraWillChange(!!e),!e&&!s||this.cameraAnimation)delete this._pointAdjustmentReference,this.camera=t,this.cameraZoomWasSet(),this._cameraDidChange();else{let n;e?n=this._cameraBeforeBoundaryChange||o:(n=t.copy(),n.rotation=o.rotation),this._cameraChangesMayHaveStarted(),this.cameraAnimation=new Ss(this,n,t,i),this._cameraBeforeBoundaryChange&&(this.cameraAnimation.unconstrained=!0),this.cameraAnimation.rotating&&(this._rotating=!0),this.cameraAnimation.zooming&&this.cameraZoomWasSet(t)}},cameraWillStartZooming:function(t,e,i){const n=this.node.delegate,o=()=>!!n&&"function"==typeof n.mapCanStartZooming&&!n.mapCanStartZooming(this.node);return this.cameraAnimation?!(this._zoomController.active||this.cameraAnimation.zooming||o())&&(this._suspendedZoom={animated:!!e,offCenter:!!i,level:this.zoomLevel,completed:!1},!0):o()?(this._zoomController.interrupt(),!1):(this._cameraWillStartZooming(n,t,e,i),!0)},_cameraWillStartZooming:function(t,e,i,n){t&&"function"==typeof t.mapWillStartZooming&&t.mapWillStartZooming(this.node,e,i,n),this._cameraChangesMayHaveStarted(),this._zooming=!0,this.beforeCameraZoomChange(!0),this._cameraWillChange(!!i)},cameraDidStopZooming:function(){if(this.snapsToIntegralZoomLevels&&(this.camera.zoom=Math.round(this.camera.zoom)),this._suspendedZoom)return void(this._suspendedZoom.complete=!0);delete this._zooming,this.beforeCameraZoomChange(!1),this._cameraDidChange(),this._cameraChangesMayHaveEnded();const t=this.node.delegate;t&&"function"==typeof t.mapDidStopZooming&&t.mapDidStopZooming(this.node)},cameraWillStartRotating:function(){const t=this.node.delegate;!!t&&"function"==typeof t.mapCanStartRotating&&!t.mapCanStartRotating(this.node)||(this._cameraChangesMayHaveStarted(),this._rotating=!0,this._cameraWillChange())},cameraDidStopRotating:function(){if(!this._rotating)return;delete this._rotating,this._cameraDidChange(),this._cameraChangesMayHaveEnded();const t=this.node.delegate;t&&"function"==typeof t.mapDidStopRotating&&t.mapDidStopRotating(this.node)},setPoiFiltered:function(t,e){e?(this._filteredPois.has(t)&&console.warn("[MapKit] Multiple annotations linked to a single place have been added to the map, display instability may occur."),this._filteredPois.add(t)):this._filteredPois.delete(t),this.updatePointOfInterestFilter()},migrateStateTo:function(t){t.configuration=this.node.configuration,t.setTintAndEmphasis(this.node.tint,this.node.tileTint,this.node.emphasis),t.language=this.node.language,t.pannable=this.node.pannable,t.allowWheelToZoom=this.node.allowWheelToZoom,t.allowWheelToZoom2=this.node.allowWheelToZoom2,t.pointOfInterestFilter=this.node._impl.pointOfInterestFilter,t.showsDefaultTiles=this.node.showsDefaultTiles,t.tileOverlays=this.node.tileOverlays,t.size=this.node.size,t.usesInteractionCenter=this.node.usesInteractionCenter;const e=this.node.visibleMapRect;e.size.width>0&&e.size.height>0&&(t.visibleMapRect=e),t.zoomable=this.node.zoomable,t.isRotationEnabled=this.isRotationEnabled,t.rotation=this.rotation,t[vs]=this[vs],this._cameraZoomRange&&t.setCameraZoomRangeAnimated(this._cameraZoomRange,!1),this._cameraZoomLevelLimit&&t.setCameraZoomLevelLimitAnimated(this._cameraZoomLevelLimit,!1),this._cameraDistance>=0&&t.setCameraDistanceAnimated(this._cameraDistance,!1),this._cameraBoundaryRect&&t.setCameraBoundaryAnimated(this._cameraBoundaryRect,!1),t._impl._filteredPois=this._filteredPois,t._impl.updatePointOfInterestFilter(),t._impl.debug=this.debug,t._impl.isRotationLocked=this.isRotationLocked,this.cameraAnimation&&(this.cameraAnimation.map=t._impl,t._impl.cameraAnimation=this.cameraAnimation,this.cameraChangesHaveStarted&&(t._impl.cameraChangesHaveStarted=!0))},createLabelRegion:h,updatedLabelRegion:h,unregisterLabelRegion:h,get debug(){return this._debug},set debug(t){this._debug!==!!t&&(this._debug=!!t,this.refresh())},updateConfiguration:function(t){this._configuration=t,this._updateMinAndMaxZoomLevels(this.camera.viewportSize),this.setCameraAnimated(this.camera),this.refresh()},updatePointOfInterestFilter:function(){this.refresh()},refresh:function(){},beforeCameraZoomChange:function(){},cameraZoomWasSet:function(){},prepareLayer:function(t){},cleanupLayer:function(t){},addLayer:function(t){},insertBefore:function(t,e){},insertAfter:function(t,e){},removeLayer:function(t){},get showsDefaultTiles(){return this._showsDefaultTiles},set showsDefaultTiles(t){this._showsDefaultTiles!==t&&(this._showsDefaultTiles=t,this._tileOverlaysDidChange())},get tileOverlays(){return this._tileOverlays},set tileOverlays(t){if(0===this._tileOverlays.length&&0===t.length)return;y(t,"[MapKit] Map.tileOverlays should be an array, got `"+t+"` instead."),t.forEach((function(t){f(t,pa,"[MapKit] Map.tileOverlays can only contain TileOverlays, but got `"+t+"` instead.")})),this._tileOverlays.forEach((t=>{t.removeEventListener(da.RELOAD_EVENT,this)})),this._tileOverlays=t,this._tileOverlays.forEach((t=>{t.addEventListener(da.RELOAD_EVENT,this)})),this._tileOverlaysDidChange()},addTileOverlay:function(t){return f(t,pa,"[MapKit] Map.addTileOverlay expected a TileOverlay, but got `"+t+"` instead."),this.addTileOverlays([t]),t},addTileOverlays:function(t){return y(t,"[MapKit] Map.addTileOverlays expected an array, but got `"+t+"` instead."),t.forEach((function(t){if(f(t,pa,"[MapKit] Map.addTileOverlays expected only TileOverlays, but got `"+t+"` instead."),"number"==typeof t.minimumZ&&t.minimumZ<this.currentMinZoomLevel){const e=Math.ceil(100*this.currentMinZoomLevel)/100;console.warn("[MapKit] This TileOverlay has its minimumZ set to "+t.minimumZ+", but this map can only zoom to a minimum value of "+e+". As a result, some zoom levels supported by the TileOverlay cannot be viewed on this map.")}}),this),this.tileOverlays=this.tileOverlays.concat(t),t},removeTileOverlay:function(t){return f(t,pa,"[MapKit] Map.removeTileOverlay expected a TileOverlay, but got `"+t+"` instead."),this.tileOverlays=this.tileOverlays.filter((e=>e!==t)),t},removeTileOverlays:function(t){return y(t,"[MapKit] Map.removeTileOverlays expected an array, but got `"+t+"` instead."),t.forEach((function(t){f(t,pa,"[MapKit] Map.removeTileOverlays expected only TileOverlays, but got `"+t+"` instead."),this.removeTileOverlay(t)}),this),t},handleEvent:function(){},cameraWillStartPanning:function(){const t=this.node.delegate;this.cameraAnimation||(()=>!!t&&"function"==typeof t.mapCanStartPanning&&!t.mapCanStartPanning(this.node))()?this._panController.interrupt():(t&&"function"==typeof t.mapWillStartPanning&&t.mapWillStartPanning(this.node),this.refresh(),this._cameraChangesMayHaveStarted(),this._panning=!0,this._cameraWillChange())},cameraWillStopPanning:function(){const t=this.node.delegate;t&&"function"==typeof t.mapWillStopPanning&&t.mapWillStopPanning(this.node)},cameraDidStopPanning:function(){delete this._panning,this._cameraDidChange(),this._cameraChangesMayHaveEnded();const t=this.node.delegate;t&&"function"==typeof t.mapDidStopPanning&&t.mapDidStopPanning(this.node)},cameraAnimationDidProgress:function(t,e){this.setCameraAnimated(t,!1,null,e)},cameraAnimationDidEnd:function(){const t=this.cameraAnimation;this.cameraAnimation=null;let e=!1;if(t.zooming&&!t.zoomIsAdditive&&(this.cameraDidStopZooming(),e=!0),t.rotating&&(this.cameraDidStopRotating(),e=!0),e||this._cameraDidChange(),this._cameraChangesMayHaveEnded(),this._suspendedZoom){const t=this._suspendedZoom;delete this._suspendedZoom,this._cameraWillStartZooming(this.node.delegate,"",t.animated),t.complete&&(this.setZoomLevelAnimated(t.level,t.animated),t.animated||this.cameraDidStopZooming())}this._nextCameraZoomRange&&(this.setCameraZoomRangeAnimated(this._nextCameraZoomRange,!1),delete this._nextCameraZoomRange)},interactionDidStart:function(){this._panController&&this._panController.stopDecelerating(),this._zoomController&&this._zoomController.stopDecelerating(),this._rotationController&&this._rotationController.stopDecelerating()},beganRecognizingRotation:function(){this._zoomController&&(this._zoomController._singleTapWithTwoFingersRecognizer.enabled=!1),this.isRotationLocked&&(this.restrictedCamera=this.camera.copy(),this.restrictIncomingRotation=!0)},finishedRecognizingRotation:function(){this._zoomController&&(this._zoomController._singleTapWithTwoFingersRecognizer.enabled=!0),this.resetRestrictedCamera()},compassRotationWillStart:function(){this.isRotationLocked&&(this.restrictedCamera=this.camera.copy(),this.restrictIncomingRotation=!1)},compassRotationDidEnd:function(){this.resetRestrictedCamera()},resetRestrictedCamera:function(){this.restrictedCamera&&(this.restrictedCamera.rotation=0,this.setCameraAnimated(this.restrictedCamera,!0),delete this.restrictedCamera,delete this.restrictIncomingRotation)},tileGridDidFinishRendering:function(){const t=this.node.delegate;t&&"function"==typeof t.mapDidFinishRendering&&t.mapDidFinishRendering(this.node)},tileAccessForbidden:function(){const t=this.node.delegate;t&&"function"==typeof t.tileAccessForbidden&&t.tileAccessForbidden(this.node)},updateMinAndMaxZoomLevelsWhenConfigurationChanges:function(){this.minZoomLevel=0,this.maxZoomLevel=this.constructor.prototype.maxZoomLevel,this._configuration.tileSources.forEach((function(t){this.minZoomLevel=Math.max(this.minZoomLevel,t.minZoomLevel),this.maxZoomLevel=Math.min(this.maxZoomLevel,t.maxZoomLevel)}),this),this.minAndMaxZoomLevelsWereUpdated(),this.currentMinZoomLevel=this.minZoomLevel,this.currentMaxZoomLevel=this.maxZoomLevel},minAndMaxZoomLevelsWereUpdated:function(){},_updateMinAndMaxZoomLevels:function(t){if(t.width<=0||t.height<=0)return!1;this._configuration&&this.updateMinAndMaxZoomLevelsWhenConfigurationChanges(),this.minZoomLevel=Math.max(this.minZoomLevel,this.minZoomLevelForViewportSize(t,hi.tileSize)),this.snapsToIntegralZoomLevels&&(this.minZoomLevel=Math.ceil(this.minZoomLevel)),this.currentMinZoomLevel=Math.max(this.currentMinZoomLevel,this.minZoomLevel),this.adjustForSize(this.size)},_cameraChangesMayHaveStarted:function(t){if(!(this.cameraChangesHaveStarted||this._panning||this._zooming||this._rotating||this.cameraAnimation)){this.cameraChangesHaveStarted=!0;const e=this.node.delegate;e&&"function"==typeof e.mapCameraChangesWillStart&&e.mapCameraChangesWillStart(this.node,t)}},_cameraWillChange:function(t){this._cameraChangesMayHaveStarted(t),this._cameraWillChangeAnimated=!!t;const e=this.node.delegate;e&&"function"==typeof e.mapCameraWillChange&&e.mapCameraWillChange(this.node,!!t)},_cameraDidChange:function(){const t=this.node.delegate;t&&"function"==typeof t.mapCameraDidChange&&t.mapCameraDidChange(this.node,!!this._cameraWillChangeAnimated),delete this._cameraWillChangeAnimated,this._cameraChangesMayHaveEnded()},_cameraChangesMayHaveEnded:function(t){if(this.cameraChangesHaveStarted&&!this._panning&&!this._zooming&&!this._rotating&&!this.cameraAnimation){delete this.cameraChangesHaveStarted;const t=this.node.delegate;return t&&"function"==typeof t.mapCameraChangesDidEnd&&t.mapCameraChangesDidEnd(this.node),!0}},isMapPointWithinBounds:function(t){if(!this._cameraBoundaryRect)return!0;const e=this._constrainCenterWithinBounds(t);return t.x===e.x&&t.y===e.y},_constrainCenterWithinBounds:function(t){if(0===this.camera.viewportSize.width||0===this.camera.viewportSize.height)return t;const e=this.camera.center,i=this.transformCenter,n=e.x-i.x,o=e.y-i.y,s=c(this._cameraBoundaryRect.origin.x+n,1),a=s+this._cameraBoundaryRect.size.width;let r=c(t.x,1);if(r<s&&(r+=1),r>a){let t=r-s;t>.5&&(t=1-t);let e=r-a;e>.5&&(e=1-e),r=t<e?s:a}const l=u(t.y,this._cameraBoundaryRect.minY()+o,this._cameraBoundaryRect.maxY()+o);return r!==t.x||l!==t.y?new hi.MapPoint(r,l):t},_updateMinAndMaxZoomLevelsAtY:function(t){let e=this.minZoomLevel,i=this.maxZoomLevel;if(this._cameraZoomRange){const n=hi.convertYToLatitude(t);e=u(this._zoomLevelForCameraDistanceAtLatitude(this._cameraZoomRange.maxCameraDistance,n),e,i),i=u(this._zoomLevelForCameraDistanceAtLatitude(this._cameraZoomRange.minCameraDistance,n),e,i),this.snapsToIntegralZoomLevels&&(e=Math.ceil(e),i=Math.floor(i))}else this._cameraZoomLevelLimit&&(e=u(this._cameraZoomLevelLimit.minZoomLevel,e,i),i=u(this._cameraZoomLevelLimit.maxZoomLevel,e,i));this.currentMinZoomLevel=e,this.currentMaxZoomLevel=i},_updateZoom:function(t){this._updateMinAndMaxZoomLevelsAtY(this.camera.center.y);const e=u(this.camera.zoom,this.currentMinZoomLevel,this.currentMaxZoomLevel);if(e!==this.camera.zoom)t&&(this._nextCameraZoomRange=this._cameraZoomRange,delete this._cameraZoomRange),this.setZoomLevelAnimated(e,t);else{const t=this.node.delegate;t&&"function"==typeof t.mapMinAndMaxZoomLevelsDidChange&&t.mapMinAndMaxZoomLevelsDidChange(this.node)}},_zoomLevelForCameraDistanceAtLatitude:function(t,e){return hi.zoomLevelForCameraDistanceAtLatitudeAndViewportWidth(t,e,this.camera.viewportSize.width)}},Object.defineProperty(Ra.prototype,vs,{get:function(){return this._[vs]},set:function(t){this._[vs]=t},configurable:!0});const Oa=Ra;function Pa(t){Lo.call(this,t)}const Da="rgba(0, 0, 0, 0.5)",za="white",Na="rgba(255, 255, 255, 0.75)",Fa="black";Pa.prototype=p(Lo,Pa,{draw:function(t){const e=this._node.size.width,i="standard"===this._node.tile.settings.configuration.name;t.fillStyle=i?Da:Na,t.fillRect(0,0,e,1),t.fillRect(0,1,1,e-1);const n=["x","y","z"].map((t=>t+" = "+this._node.tile[t]));t.font="12px -apple-system-font",t.beginPath(),t.moveTo(1,1);let o=1,s=1;n.forEach((function(e,i){const n=t.measureText(e).width;o=1+n+16,t.lineTo(o,s),s+=20,0===i&&(s+=8),t.lineTo(o,s)})),t.lineTo(1,s),t.closePath(),t.fill(),t.fillStyle=i?za:Fa,t.textBaseline="hanging",n.forEach((function(i,n){t.fillText(i,9,9+20*n,e)}))}});const Ua=Pa;function Ga(t){ln.call(this),this._tile=t,this._renderer=new Ua(this)}Ga.prototype=p(ln,Ga,{get tile(){return this._tile},stringInfo:function(){return"DebugNode<x:"+this.tile.x+",y:"+this.tile.y+",z:"+this.tile.z+">"}});const Ba=Ga;function Za(t){No.call(this),this._tileSource=t._public,this._tileSource&&"function"==typeof this._tileSource.addEventListener&&this._tileSource.addEventListener(da.OPACITY_EVENT,this)}Za.prototype=p(No,Za,{handleEvent:function(){this._tileSource&&(this.opacity=this._tileSource.opacity)},wasRemoved:function(){setTimeout((()=>{this.parent&&this.parent.scene||this._tileSource&&"function"==typeof this._tileSource.removeEventListener&&this._tileSource.removeEventListener(da.OPACITY_EVENT,this)}),0)}});const Wa=Za,Ka=J,Ha=new Zi,ja=new Ui(hi.tileSize,hi.tileSize);function Va(t){Oo.call(this),this._scale=1,this._nodesByTileKey={},this._fadingNodes=[],this._debug=!!t}function qa(t){const e=new Wa(t.tileSource);return e.size=ja,t.loaderState===Ka.Succeeded&&(e.image=t.image,e.opacity=t.preferredOpacity),e}Va.prototype=p(Oo,Va,{stale:!1,fullyRendered:!1,_pendingTileCount:0,_tileData:null,get locked(){return this.wantsLayerBacking},set locked(t){t!==this.wantsLayerBacking&&(t&&this._fadingNodes.length>0?this.wantsLayerBacking=!0:!t&&this._wantsLayerBacking?this.wantsLayerBacking=!1:this.frozen=t)},get tileData(){return this._tileData},setTileDataAnimated:function(t,e){this._fadingNodes=[],delete this._failedTileAndImage;const i=t.tiles,n=t.range.min,o=Math.pow(2,n.z);this._tileData&&this._tileData.tiles.forEach((function(t){if(t.removeEventListener(Qs.Events.LoadSuccess,this),t.removeEventListener(Qs.Events.LoadFail,this),-1===i.indexOf(t)){const e=t.key,i=this._nodesByTileKey[e];i&&(i.remove(),delete this._nodesByTileKey[e])}}),this),this._tileData=t,this.fullyRendered=!1,this._pendingTileCount=i.length;const s=this.childCount,a=t.range.min.x,r=t.range.max.x-a===o,l=o*hi.tileSize;i.forEach((function(t){const i=new Gi(c(t.x-n.x,o)*hi.tileSize,(t.y-n.y)*hi.tileSize),h=this._ensureNodeForTile(t);h.position=i,h.opacity=0,r&&t.x===a&&(h.repeatOffset=l),this.addChild(h),t.loaded?((s>0||!e)&&(h.opacity=1),this._tileDidLoad(t)):(e||(h.opacity=1),t.addEventListener(Qs.Events.LoadSuccess,this),t.addEventListener(Qs.Events.LoadFail,this))}),this)},get pendingTileCount(){return this._pendingTileCount},set scale(t){t!==this._scale&&(this._scale=t,this.transform=1===t?Ha:(new Zi).scale(t))},get debug(){return this._debug},stringInfo:function(){return"TileGridNode"+(this.tileData?"<range:("+this.tileData.range.toString()+")>":"")},get cssBackgroundProperty(){if(!this.fullyRendered)return"";const t=this.position;return Array.prototype.concat.apply([],this._tileData.tiles.map((function(e){const i=this._nodesByTileKey[e.key];return e.tileImages.reduce((function(e,n,o){return"url("+n.image.src+") "+(t.x+i.position.x)+"px "+(t.y+i.position.y)+"px / "+hi.tileSize+"px no-repeat"+(0===o?"":", ")+e}),"")}),this)).join(", ")},handleEvent:function(t){const e=t.target;switch(t.type){case Qs.Events.LoadSuccess:e.removeEventListener(Qs.Events.LoadSuccess,this),this._tileDidLoad(e);break;case Qs.Events.LoadFail:this._tileLoadFail(e,t.tileImage)}},performScheduledUpdate:function(){this._updateFadingNodes(),0===this._pendingTileCount&&0===this._fadingNodes.length&&this._allTilesDidDraw()},_tileDidLoad:function(t){this._pendingTileCount--,0===this._pendingTileCount&&this._failedTileAndImage&&(this._failedTileAndImage.tile._requestTileImageLoadStatus(this._failedTileAndImage.tileImage,(t=>this._handleTileImageLoadStatus(t))),delete this._failedTileAndImage);const e=this._nodesByTileKey[t.key];if(0===e.childCount){const i=t.tileImages;if(e.children=i.map(qa),this.debug){const i=new Ba(t);i.size=ja,e.addChild(i)}}e.opacity<1?(this._fadingNodes.push(e),ue.scheduleASAP(this)):0===this._pendingTileCount&&this._allTilesDidDraw()},_tileLoadFail:function(t,e){this._failedTileAndImage={tile:t,tileImage:e}},_handleTileImageLoadStatus:function(t){403===t.target.status&&this.parent&&this.parent.tileAccessForbidden(this)},_updateFadingNodes:function(){const t=Date.now();this._fadingNodes=this._fadingNodes.filter((function(e){return e._startTime?e.opacity=Math.min(1,(t-e._startTime)/150):0===e.opacity&&(e._startTime=t),1!==e.opacity||(delete e._startTime,!1)})),this._fadingNodes.length>0?ue.scheduleOnNextFrame(this):this._wantsLayerBacking&&(this.wantsLayerBacking=!1,this.frozen=!0)},_allTilesDidDraw:function(){this.fullyRendered=!0,this.parent&&this.parent.tileGridDidFinishRendering(this)},_ensureNodeForTile:function(t){const e=t.key;let i=this._nodesByTileKey[e];return i?delete i.repeatOffset:i=this._nodesByTileKey[e]=new Oo,i}});const Ya=Va;function Xa(t){Oo.call(this),this._map=t}Xa.prototype=p(Oo,Xa,{fullyRendered:!1,scheduleRefresh:function(){this.children.forEach((t=>{t.stale=!0})),this.invalidate()},destroy:function(){this._releaseChildren(!0)},invalidate:function(){this.fullyRendered=!1,ue.scheduleASAP(this)},stringInfo:function(){return"TileGridsGroupNode"},get cssBackgroundProperty(){return this.fullyRendered?this.lastChild.cssBackgroundProperty:""},handleEvent:function(t){this.scheduleRefresh()},performScheduledUpdate:function(){if(!this._canDraw())return;const t=this._map,e=t.camera,i=this.lastChild,n=!!i&&i.debug!==this._map.debug,o=!!i&&i.tileData.settings.showsDefaultTiles!==this._map.showsDefaultTiles;if(!this._tileDataAtZoomCompletion){let s;if(Math.round(e.zoom)!==e.zoom&&t.tileSettings.showsLabels){if(!i)return;s=i.tileData}else s=new la(e,t.tileSettings);if(i){if((i.stale||!i.locked)&&(!s.equals(i.tileData)||n||o)){const t=i.tileData;t.tiles.forEach((function(t){s.tiles.indexOf(t)<0&&t.unschedule()}));const e=s.settings.configuration===t.settings.configuration,o=s.sameSettings(t)&&s.resolution===t.resolution&&!n;if(e?!o:s.sharesTileSourcesWithTileData(t))i.locked=!0,this._addNewTileGridAnimated(s,!0);else if(!i.locked){const t=e&&this._children.length>1;delete i.stale,i.setTileDataAnimated(s,t);const n=this._children[this._children.length-2];n&&!s.sharesTileSourcesWithTileData(n.tileData)&&(this._releaseChildren(!1),this._children=[i])}}}else this._addNewTileGridAnimated(s,!1)}const s=e.zoom,a=t.visibleMapRect,r=a.origin,l=a.size,h=this.children,c=h.length;for(let t=0;t<c;++t){const e=h[t],i=e.tileData,n=i.zoom,o=i.mapRect.origin,a=Math.pow(2,s-n),d=Math.pow(2,n)*(hi.tileSize*a);let u=o.x-r.x;if(u>l.width)u--;else{const t=i.mapRect.size.width;t>0&&u+t<0&&u++}e.scale=a,e.position=new Gi(Co.roundToDevicePixel(u*d),Co.roundToDevicePixel((o.y-r.y)*d)),t<c-1&&i.cancel()}this.fullyRendered=c>0&&this.children[c-1].fullyRendered},cameraWillStartZooming:function(t){if(!this._canDraw())return;const e=this._map;t&&(this._tileDataAtZoomCompletion=new la(t,e.tileSettings),this._tileDataAtZoomCompletion.load()),this.children.forEach((t=>{t.locked=!0}))},cameraDidStopZooming:function(){if(this._canDraw())if(this._tileDataAtZoomCompletion)this._addNewTileGridAnimated(this._tileDataAtZoomCompletion,!0,!0),delete this._tileDataAtZoomCompletion;else{const t=this._map,e=this.lastChild;if(e&&t.camera.zoom===e.tileData.zoom)e.locked=!1;else{const e=new la(t.camera,t.tileSettings);this._addNewTileGridAnimated(e,!0,!0)}}},tileGridDidFinishRendering:function(t){const e=this.children,i=e.length,n=e[i-1];if(n.fullyRendered&&!n.locked){for(let t=0;t<i-1;++t)e[t].tileData.releaseTiles();i>1&&(this.children=[n]),this.fullyRendered=!0,this._map.tileGridDidFinishRendering()}},tileAccessForbidden:function(t){this._map.tileAccessForbidden()},_canDraw:function(){const t=this._map;return t&&!!t.configuration&&!!t.language},_addNewTileGridAnimated:function(t,e,i){const n=new Ya(this._map.debug),o=this.lastChild;o&&!t.sharesTileSourcesWithTileData(o.tileData)?(this._releaseChildren(!0),this.children=[n]):this.addChild(n),n.setTileDataAnimated(t,e),i&&ue.scheduleASAP(this)},_releaseChildren:function(t){for(let e=this.childCount-(t?1:2);e>=0;--e){const t=this.children[e].tileData;t.cancel(),t.releaseTiles()}}});const $a=Xa;function Ja(t){Oa.call(this,t),this._backgroundGrid=this.node.addChild(new ys),this._tileGridsGroup=this.node.addChild(new $a(this)),this._labels=!0,this.rotation=0,this._backgroundGrid.initialRendering=!0,this._tileGridsGroup.opacity=0,setTimeout((()=>{this._backgroundGrid.initialRendering=!1,this._tileGridsGroup.opacity=1}),0)}Ja.prototype=p(Oa,Ja,{stringInfo:function(){return"MapNode<camera:"+this.camera.toString()+">"},get tileSettings(){return{configuration:this._configuration,tint:this._tileTint,emphasis:this._emphasis,language:this._language,showsPOI:this._showsPOI(),showsLabels:this._labels,showsDefaultTiles:this._showsDefaultTiles,showsTileInfo:this._debug,tileOverlays:this._tileOverlays}},get fullyRendered(){return this._tileGridsGroup.fullyRendered},get cssBackgroundProperty(){return this._tileGridsGroup.cssBackgroundProperty},get labels(){return this._labels},set labels(t){this._labels=!!t,this.refresh()},destroy:function(t){Oa.prototype.destroy.call(this,t),this._tileGridsGroup.destroy()},updateTintAndEmphasis:function(t,e,i){this._backgroundGrid.updateThemeFromTint(t),this.refresh()},refresh:function(){this._tileGridsGroup.scheduleRefresh()},cameraZoomWasSet:function(t){t?this._tileGridsGroup.cameraWillStartZooming(t):this._tileGridsGroup.invalidate()},tileGridDidFinishRendering:function(){this._tileOverlays.forEach((t=>{t._impl.reloadComplete()})),Oa.prototype.tileGridDidFinishRendering.call(this)},handleEvent:function(){this._tileGridsGroup.scheduleRefresh()},beforeCameraZoomChange:function(t){t?this._tileGridsGroup.cameraWillStartZooming():this._tileGridsGroup.cameraDidStopZooming()},devicePixelRatioDidChange:function(){return this._tileGridsGroup.scheduleRefresh(),!0},minZoomLevelForViewportSize:function(t,e){const i=Math.max(t.width,t.height);return d(i/e)},minAndMaxZoomLevelsWereUpdated:function(){this.tileOverlays.forEach((function(t){"number"!=typeof t.minimumZ||isNaN(t.minimumZ)||(this.minZoomLevel=Math.min(this.minZoomLevel,t.minimumZ)),"number"!=typeof t.maximumZ||isNaN(t.maximumZ)||(this.maxZoomLevel=Math.max(this.maxZoomLevel,t.maximumZ))}),this)},_tileOverlaysDidChange:function(){this._updateMinAndMaxZoomLevels(this.camera.viewportSize),this._tileGridsGroup.scheduleRefresh()},_showsPOI:function(){return(null==this._pointOfInterestFilter||null==this._pointOfInterestFilter._includes&&0===this._pointOfInterestFilter._excludes.length)&&this.labels},needsReplacing:function(t){return t}});const Qa=Ja;function tr(){bs.call(this),Object.defineProperty(this,"_impl",{value:new Qa(this)})}tr.prototype=p(bs,tr,{get cssBackgroundProperty(){return this._impl.cssBackgroundProperty},get labels(){return this._impl.labels},set labels(t){this._impl.labels=t},get pointOfInterestFilter(){return null===this._impl._pointOfInterestFilter?null:null===this._impl._pointOfInterestFilter._includes&&0===this._impl._pointOfInterestFilter._excludes.length?this._impl._pointOfInterestFilter:Tt.filterExcludingAllCategories},set pointOfInterestFilter(t){this._impl.pointOfInterestFilter=t},get rotation(){return 0},set rotation(t){this._impl.rotation=t},rotateCameraAroundMapPoint:function(t,e){this._impl.rotation+=e}});const er=tr,ir=0,nr=1,or=2,sr=3,ar=4,rr=5;let lr=0;function hr(){throw new Error("[MapKit] The specified reference layer has not been added to the map.")}const cr=kt.performanceMarkers.rendering,dr=kt.performanceMarkers["frame-updates"];function ur(t){this.node=t,this._id=lr++,this._state=ir,this._unregisteredLabelRegions=[],this._unregisteredLayers=[],this._baseLoadedOnce=!1,this._fullyLoadedOnce=!1,this._fullyRenderedOnce=!1}const pr="mapkit-re-bootstrap-notification",mr="mapkit-csr-fallback-notification",gr="mapkit-zoom-support-notification";ur.prototype={constructor:ur,init:function(t,e,i,n,o,s,a){this._state=nr,this.SyrupRenderer=e,this.Camera=i,this.Camera.hasRotationLock=!0,this._initialDisplayOptions=o,this._initialPoiFilter=s,this.initRenderer(e,t,n).then((()=>this.syrupInitHandler(a))).catch((t=>this.syrupInitErrorHandler(a,t)))},initRenderer:function(t,e,i){const n=this._syrupRenderer=new t(i);return n.on("invalid-access-key",(function(){e.accessKeyHasExpired()}),pr),n.on("fallback",(function(){e.syrupRequestedFallback(pn)}),mr),n.on("zoom-support-did-change",(()=>this.node.didReconfigure()),gr),n.init(e)},syrupInitErrorHandler:function(t,e){if(this._state===ar)return this._state=ir,void this.destroy();this._state=ir,t(e||new Error)},syrupInitHandler:function(t){if(this._state===ar)return this._state=sr,void this.destroy();this._state=or;const e=this._syrupRenderer.DrawPasses;e&&(this._drawPasses=[e.BaseMap,e.Roads,e.Borders,e.Buildings,e.Icons,e.Labels]);const i=this._syrupRenderer;i.setDeterministicCollisions(!0),i.setLanguage(this.node.language),i.setDeterministicCollisions(!1),i.setPixelRatio(Co.devicePixelRatio),this._canvas=i.element(),this.updateConfiguration(this.node.configuration,this._initialDisplayOptions),this._initialDisplayOptions=null,this._initialPoiFilter&&(this.updatePointOfInterestFilter(this._initialPoiFilter),this._initialPoiFilter=null),this.performScheduledDraw(),this[vs]&&this[vs](this.node[vs]),this._unregisteredLabelRegions.forEach((t=>{i.registerLabelRegion(t)})),delete this._unregisteredLabelRegions;const n=this._unregisteredLayers;delete this._unregisteredLayers,n.forEach((function(t){this.prepareLayer(t),t._impl.syrupToken=i.addLayer(t._impl.syrupLayer)}),this),t()},deactivate:function(){this._state!==nr?this._state!==ar&&(this._state=sr):this._state=ar},destroy:function(){this._state!==nr?this._state!==ar&&this._state!==rr&&(this._state=rr,this._syrupRenderer&&(this._syrupRenderer.off("invalid-access-key",null,pr),this._syrupRenderer.off("fallback",null,mr),this._syrupRenderer.off("zoom-support-did-change",null,gr),"function"==typeof this._syrupRenderer.destroy&&this._syrupRenderer.destroy(),this._syrupRenderer=null)):this._state=ar},get snapsToIntegralZoomLevels(){return!!this._syrupRenderer&&!this._syrupRenderer.supportsNonIntegralZoomLevels()},getMapFeatureRegions:function(){return this._syrupRenderer&&this._syrupRenderer.getMapFeatureRegions?this._syrupRenderer.getMapFeatureRegions():[]},performScheduledDraw:function(t){if(this._state!==or&&this._state!==sr)return;const e=[this.node.size.width,this.node.size.height];if(0===e[0]||0===e[1])return;this.node.delegate&&this.node.delegate.mapCustomCanvasWillRender&&this.node.delegate.mapCustomCanvasWillRender(this.node);const i=new this.Camera(e[0]/e[1]),n=this.node.zoomLevel,o=[this.node.camera.center.x,1-this.node.camera.center.y,0];i.setTarget(o),i.setZoomLevel(n),i.setRotation(this.node.camera.rotation*_r*-1);const s=dr?performance.now():void 0;let a;this._syrupRenderer.update(i,e,void 0,void 0,t);const r=this.SyrupRenderer.StatusType;if(dr&&(a=this._syrupRenderer.status(),performance.measure("mapkit-syrup-update-frame",{start:s,detail:{syrupStatus:a,timestamp:t,baseLoaded:a>=r.BASE_LOADED,fullyLoaded:a>=r.FULLY_LOADED}})),this._state!==rr){for(const t of ur.PostUpdateHandlers)t.call(this);cr&&!this._fullyRenderedOnce&&this._syrupRenderer.status&&(a||(a=this._syrupRenderer.status()),!this._baseLoadedOnce&&a>=r.BASE_LOADED&&(this._baseLoadedOnce=!0,performance.measure("mapkit-map-land-cover-rendered","mapkit-map-start")),!this._fullyLoadedOnce&&a>=r.FULLY_LOADED&&(this._fullyLoadedOnce=!0,performance.measure("mapkit-map-base-map-loaded","mapkit-map-start")),!this._fullyRenderedOnce&&a>=r.FULLY_RENDERED&&(this._fullyRenderedOnce=!0,performance.measure("mapkit-map-base-map-rendered","mapkit-map-start"))),this._syrupRenderer.mapFullyRendered()?this.node._impl.tileGridDidFinishRendering():this.node.needsDisplay=!0}},forceRerender:function(){this._state===or&&this._syrupRenderer.forceRerender()},devicePixelRatioDidChange:function(){this._syrupRenderer&&this._syrupRenderer.setPixelRatio(Co.devicePixelRatio)},frozen:!1,get element(){return this.canvas},get canvas(){return this._canvas},get fullyRendered(){return this._syrupRenderer&&this._syrupRenderer.mapFullyRendered()},set language(t){this._syrupRenderer&&this._syrupRenderer.setLanguage(t)},set fontSizeRatio(t){this._syrupRenderer&&this._syrupRenderer.setFontSize(t)},updateNetworkConfiguration:function(t){this._syrupRenderer&&this._syrupRenderer.updateNetworkConfiguration(t)},updateConfiguration:function(t,e){this._syrupRenderer&&(e.mode=t.name,this._syrupRenderer.setDisplayOptions(e),t.countryCode&&this._syrupRenderer.setLocationInfo(t.countryCode,t.countryCode))},updatePointOfInterestFilter:function(t){this._syrupRenderer?this._syrupRenderer.setPOIFilter(t):this._initialPoiFilter=t},createLabelRegion:function(){if(!this._syrupRenderer)return;const t=this._syrupRenderer.createLabelRegion();return this._unregisteredLabelRegions?this._unregisteredLabelRegions.push(t):this._syrupRenderer.registerLabelRegion(t),t},unregisterLabelRegion:function(t){this._unregisteredLabelRegions?this._unregisteredLabelRegions.splice(this._unregisteredLabelRegions.indexOf(t),1):this._syrupRenderer&&this._syrupRenderer.unregisterLabelRegion(t)},prepareLayer:function(t){if(!this._unregisteredLayers){if(!t._impl.syrupLayer||t._impl.rendererId!==this._id){0;const e={},i=t._impl.blendMode;if(void 0!==i){if(!m(i,kn))throw new Error("Invalid blendMode: "+i);e.blendMode=i}const n=t._impl.backdropFilter;if(void 0!==n){if(!m(n,Mn))throw new Error("Invalid backdropFilter: "+n);e.backdropFilter=n}t._impl.rendererId=this._id,t._impl.syrupLayer=this._syrupRenderer.createWebGLLayer(t._impl,e)}t._impl.syrupLayer.setDrawPass(this._drawPasses[t._impl.passIndex]+t._impl.passOffset)}},cleanupLayer:function(t){t._impl.syrupLayer=void 0},addLayer:function(t){const e=this._unregisteredLayers;if(e){const i=e.indexOf(t);i>=0&&e.splice(i,1),e.push(t)}else{const e=this._syrupRenderer,i=t._impl,n=t=>{i.syrupToken=e.addLayer(t)};i.syrupToken?i.syrupToken.then(n):n(i.syrupLayer)}},insertBefore:function(t,e){const i=this._unregisteredLayers;if(i){const n=i.indexOf(e);n<0&&hr();const o=i.indexOf(t);o!==n&&(o>=0&&i.splice(o,1),i.splice(n,0,t))}else{const i=this._syrupRenderer,n=e._impl.syrupToken;n||hr(),n.then((function(e){const n=t._impl,o=t=>{n.syrupToken=i.insertBefore(t,e)};n.syrupToken?n.syrupToken.then(o):o(n.syrupLayer)}))}},insertAfter:function(t,e){const i=this._unregisteredLayers;if(i){const n=i.indexOf(e);n<0&&hr();const o=i.indexOf(t);o!==n&&(o>=0&&i.splice(o,1),i.splice(n+1,0,t))}else{const i=this._syrupRenderer,n=e._impl.syrupToken;n||hr(),n.then((function(e){const n=t._impl,o=t=>{n.syrupToken=i.insertAfter(t,e)};n.syrupToken?n.syrupToken.then(o):o(n.syrupLayer)}))}},removeLayer:function(t){if(this._unregisteredLayers){const e=this._unregisteredLayers.indexOf(t);e<0&&hr(),this._unregisteredLayers.splice(e,1)}else{const e=this._syrupRenderer,i=t._impl.syrupToken;i||hr(),t._impl.syrupToken=void 0,i.then((t=>{e.removeLayer(t)}))}}},ur.PostUpdateHandlers=[];const _r=Math.PI/180;const fr=ur,yr={fontFamily:"-apple-system-font, sans-serif",margin:"2em auto",width:"20em",borderRadius:"0.5em",color:"#f8f9f0",backgroundColor:"rgba(0, 0, 0, 0.7)",padding:"1em",textAlign:"center",position:"relative"},vr={listStyleType:"none",margin:0,paddingLeft:0},wr={width:"1em",height:"1em",position:"absolute",top:"0.5em",left:"0.5em"};function br(t,e){this._element=Cr(document.createElement("div"),yr);const i=Cr(this._element.appendChild(document.createElement("ul")),vr);this._items=[function(t){const e=t.center.toCoordinate();return"Center: "+e.latitude.toFixed(6)+", "+e.longitude.toFixed(6)},function(t){return"Zoom: "+t.zoom.toFixed(6)+", rotation: "+t.rotation.toFixed(6)},function(t){const e=Math.floor(t.zoom),i=Math.pow(2,e);return"Center tile: x="+Math.floor(c(t.center.x,1)*i)+", y="+Math.floor(t.center.y*i)+", z="+e},function(t){return"Viewport: "+t.viewportSize.width+"Ã"+t.viewportSize.height}].map((function(t){const e=i.appendChild(document.createElement("li"));return function(i){e.textContent=t(i)}}));const n=Co.svgElement("svg",{viewBox:"-16 -16 32 32"},Co.svgElement("circle",{r:16,fill:"#ccc"}),Co.svgElement("g",{"stroke-width":4,stroke:"#222"},Co.svgElement("line",{x1:-8,y1:-8,x2:8,y2:8}),Co.svgElement("line",{x1:8,y1:-8,x2:-8,y2:8})));this._element.appendChild(Cr(n,wr)),n.addEventListener("click",t),this.update(e),this.update=pe(this.update,50,this)}function Cr(t,e){for(const i in e)t.style[i]=e[i];return t}br.prototype={constructor:br,attachTo:function(t){t.appendChild(this._element)},detach:function(){this._element.remove()},update:function(t){this._items.forEach((e=>{e(t)}))}};const kr=br;class Mr extends ao{constructor(){super(),this._rotation=0,this.rotation=0,this._velocity=0,this._lastEventData=null,this._startAngle=null,this.useGestures=ao.UseGesturesForRotation}get velocity(){return this._velocity}get rotation(){return this._rotation}set rotation(t){this._rotation=function(t){for(;t>180;)t-=360;for(;t<-180;)t+=360;return t}(t)}touchesBegan(t){this.useGestures||t.currentTarget===this.target&&2===this.numberOfTouches&&(super.touchesBegan(t),this.numberOfTouches>2?this.enterFailedState():(this._startAngle=this._angle(),this._startDistance=this._distance(),this.rotation=0,this._lastEventData={rotation:0,scale:1,timeStamp:t.timeStamp}))}touchesMoved(t){this.useGestures||2===this.numberOfTouches&&null!==this._startAngle&&void 0!==this._startDistance&&this._handleEvent(t,{rotation:this._angle()-this._startAngle,scale:0===this._startDistance?1:this._distance()/this._startDistance})}touchesEnded(t){this.useGestures||this.numberOfTouches>=2||null===this._startAngle||(this.state===ao.States.Changed?this.enterEndedState():this.enterFailedState())}gestureBegan(t){this.useGestures&&(super.gestureBegan(t),this.preventDefault(t),this.rotation=0,this._lastEventData={rotation:0,scale:1,timeStamp:t.timeStamp})}gestureChanged(t){this.useGestures&&(this.preventDefault(t),this._handleEvent(t))}gestureEnded(t){this.useGestures&&this.enterEndedState()}reset(){this.rotation=0,this._velocity=0,this._lastEventData=null,this._startAngle=null}_handleEvent(t,e){const i="rotation"in t?t.rotation:e?e.rotation:NaN,n="scale"in t?t.scale:e?e.scale:NaN,o=this._lastEventData;if(!o||isNaN(i)||isNaN(n))throw new Error("");const s=i-o.rotation,a=n-o.scale,r=t.timeStamp-o.timeStamp;if(this._lastEventData={rotation:i,scale:n,timeStamp:t.timeStamp},this.state!==ao.States.Possible)r>0&&(this._velocity=s/r*1e3),this.rotation+=s,this.enterChangedState();else{const t=Math.abs(i)<8,e=Math.abs(s/90)<Math.abs(a),n=Math.abs(s)>=135;if(t||e||n)return;this.enterBeganState()}}_angle(){if(2!==this.numberOfTouches)return 0;const t=this._targetTouches[0],e=new Gi(t.pageX,t.pageY),i=this._targetTouches[1],n=new Gi(i.pageX,i.pageY);return 180*Math.atan2(e.y-n.y,e.x-n.x)/Math.PI}}const Sr=kt.performanceMarkers.interactions,Lr=180/Math.PI,Ar=3*Lr,Er=1e-4*Lr*1e3,xr=.995;function Tr(t){Ts.call(this,t),this._recognizer=this.addRecognizer(new Mr)}Tr.prototype=p(Ts,Tr,{decelerating:!1,stopDecelerating:function(){this.decelerating&&this._decelerationEnded()},destroy:function(){Ts.prototype.destroy.call(this),this.stopDecelerating(),delete this._recognizer},handleEvent:function(t){const e=t.target;e===this._recognizer&&(e.state===po.Began&&(this.map.beganRecognizingRotation(),this.map.cameraWillStartRotating()),e.state===po.Ended&&(delete this._restricted,this.map.finishedRecognizingRotation(),this._startDeceleratingWithVelocity(e)),this._handleRotationChange(t.target),Sr&&performance.measure("mapkit-map-rotate-interaction",{start:e.lastEventTimeStamp,detail:e.state}))},_handleRotationChange:function(t){this._lastRotationCenter=this.centerForGesture(t);const e=this.map.cameraIsRotating&&t.state===po.Changed,i=2===t.numberOfTouches&&Math.abs(t.rotation)<=150/t._distance();e&&!i&&(this.map.rotateCameraAroundMapPoint(this._lastRotationCenter,t.rotation),t.rotation=0)},_centerWithRecognizer:function(t){const e=this.map,i=t.locationInElement();let n=this.map.node.convertPointFromPage(i);n=e.camera.transformGestureCenter(n);const o=e.visibleMapRect,s=e.camera.viewportSize;return new hi.MapPoint(o.minX()+n.x/s.width*o.size.width,o.minY()+n.y/s.height*o.size.height)},performScheduledUpdate:function(t){const e=Sr?performance.now():void 0;if(!this.decelerating)return;if(null==t)return void this._decelerationEnded();const i=t-this._timeAtPreviousFrame;if(i>300)return void this._decelerationEnded();let n=this._velocity/1e3;const o=Math.pow(xr,i),s=xr*n*(o-1)/-.0050000000000000044;if(n*=o,this.map.cameraAnimation?this.map.cameraAnimation.adjustRotation(this._lastRotationCenter,s):this.map.rotateCameraAroundMapPoint(this._lastRotationCenter,s),this._velocity*=o,Math.abs(this._velocity)<=Er)this._decelerationEnded();else{if(this._velocity*=o,Math.abs(this._velocity)<=Er)return this._decelerationEnded(),void(Sr&&performance.measure("mapkit-map-rotate-deceleration",{start:e}));this._timeAtPreviousFrame=t,this._schedule(),Sr&&performance.measure("mapkit-map-rotate-deceleration",{start:e})}},_startDeceleratingWithVelocity:function(t){const e=t.velocity;if(Math.abs(e)>1440||isNaN(e))this.map.cameraDidStopRotating();else{if(Math.abs(e)<Ar)return this.decelerating=!1,void this.map.cameraDidStopRotating();this._velocity=e,this.decelerating=!0,this._timeAtPreviousFrame=t.lastEventTimeStamp,this._schedule()}},_schedule:function(){ue.scheduleOnNextFrame(this)},_decelerationEnded:function(){this.decelerating=!1,this.map.cameraDidStopRotating()}});const Ir=Tr;function Rr(t){Oa.call(this,t),this._renderer=t._renderer,this._requiresFallback=!1,this._fallback=()=>{this._requiresFallback=!0}}Rr.prototype=p(Oa,Rr,{init:function(t,e,i,n,o){if(this._requiresFallback)return void t.syrupRequestedFallback(mn);this._fallback=()=>t.syrupRequestedFallback(mn);const s={tint:this.tileTint,emphasis:this.emphasis};this._renderer.init(this.networkConfigurationFor(t),e,i,n,s,this._getRendererPoiFilter(),(t=>{this._updateMinAndMaxZoomLevels(this.camera.viewportSize),o(t,this._renderer)}))},get isRotationEnabled(){return this._isRotationEnabled},set isRotationEnabled(t){!t&&this._rotationController?(this._rotationController.destroy(),delete this._rotationController):t&&!this._rotationController&&(this._initialInteractionController||(this._initialInteractionController=new As(this)),this._rotationController=new Ir(this),this.camera._initialRotation=0),this._isRotationEnabled=t},get rotation(){return this.camera.rotation},set rotation(t){if(this._cameraWillChange(),this.camera.rotation=t,this._updateDisplay(),this._cameraDidChange(),this.cameraAnimation&&this.cameraAnimation.rotating)return;const e=this.node.delegate;e&&"function"==typeof e.mapRotationDidChange&&e.mapRotationDidChange(this.node)},set fontSizeRatio(t){this._renderer.fontSizeRatio=t,this._updateDisplay()},updateNetworkConfiguration:function(t){this._renderer.updateNetworkConfiguration(this.networkConfigurationFor(t))},forceRerender:function(){this._renderer.forceRerender()},prepareLayer:function(t){this._renderer.prepareLayer(t)},cleanupLayer:function(t){this._renderer.cleanupLayer(t)},addLayer:function(t){this._renderer.addLayer(t)},insertBefore:function(t,e){this._renderer.insertBefore(t,e)},insertAfter:function(t,e){this._renderer.insertAfter(t,e)},removeLayer:function(t){this._renderer.removeLayer(t)},adjustForSize:function(t){Oa.prototype.adjustForSize.call(this,t),this.forceRerender()},adjustMapItemPoint:function(t){return this.cameraIsZooming||this.cameraIsPanning||this.cameraIsRotating||(t.x=Co.roundToDevicePixel(t.x),t.y=Co.roundToDevicePixel(t.y)),t},networkConfigurationFor:function(t){if(!t)return{};let e=null;t.proxyPrefixes&&!t.customMadabaUrl&&(e=t.proxyPrefixes.slice(0));const i=!(!t.withCredentials||t.customMadabaUrl);return{madabaDomains:t.madabaDomains.slice(0),rasterTiles:t.rasterTilesForSyrup,proxyPrefixes:e,withCredentials:i,tileGroup:t.tileGroup,accessKey:t.accessKey,accessKeyHasExpired:()=>t.accessKeyHasExpired(),syrupRequestedFallback:e=>t.syrupRequestedFallback(e)}},rotateCameraAroundMapPoint:function(t,e){if(this.isRotationLocked){if(!this.restrictedCamera)return;if(this.restrictIncomingRotation){const t=c(this.camera.rotation+e,360),i=Co.restrictRotation(t);i!==t&&(e=i-this.camera.rotation)}}if(0===e)return;this._cameraWillChange(),this.camera.rotateAroundCenter(t,e),this.constrainCamera(this.camera),this._updateDisplay(),this._cameraDidChange();const i=this.node.delegate;i&&"function"==typeof i.mapRotationDidChange&&i.mapRotationDidChange(this.node)},deactivate:function(){Oa.prototype.deactivate.call(this),this.isRotationEnabled=!1,this._renderer.deactivate()},getMapFeatureRegions:function(){return this._renderer.getMapFeatureRegions()},destroy:function(t){Oa.prototype.destroy.call(this,t),this.customCanvas&&this.customCanvas.parentNode&&this.customCanvas.parentNode.removeChild(this.customCanvas),this._renderer&&(this._renderer.destroy(),this._renderer=null)},stringInfo:function(){return"SyrupNode<camera:"+this.camera.toString()+">"},get backgroundGridTheme(){return this._backgroundGridTheme},set backgroundGridTheme(t){this._backgroundGridTheme=t},get fullyRendered(){return this._renderer.fullyRendered},get customCanvas(){return this._renderer&&this._renderer.canvas},get camera(){return this._camera},set camera(t){this._camera=t,this.node.needsDisplay=!0},get language(){return this._language},set language(t){this._language!==t&&(this._language=t,this._renderer&&(this._renderer.language=t,this.node.needsDisplay=!0))},updateConfiguration:function(t){const e=this._configuration&&(t.name!==this._configuration.name||t.provider!==this._configuration.provider||t.countryCode!==this._configuration.countryCode);Oa.prototype.updateConfiguration.call(this,t),e&&this._renderer&&(this._renderer.updateConfiguration(t,{}),this.node.needsDisplay=!0)},updateTintAndEmphasis:function(t,e,i){this._renderer.node.pendingConfigurationUpdates?(this._renderer.node.pendingConfigurationUpdates.tint=t,this._renderer.node.pendingConfigurationUpdates.tileTint=e,this._renderer.node.pendingConfigurationUpdates.emphasis=i):this._renderer&&this._configuration&&(this._renderer.updateConfiguration(this._configuration,{tint:e,emphasis:i}),this.node.needsDisplay=!0)},updatePointOfInterestFilter:function(){this._renderer&&(this._renderer.updatePointOfInterestFilter(this._getRendererPoiFilter()),this.node.needsDisplay=!0)},makePendingConfigurationUpdates:function(){const t=this._renderer.node.pendingConfigurationUpdates;t&&(delete this._renderer.node.pendingConfigurationUpdates,t.tint&&t.emphasis&&this.updateTintAndEmphasis(t.tint,t.tileTint,t.emphasis),t.poiFilter&&this.updatePointOfInterestFilter())},devicePixelRatioDidChange:function(){return!this._renderer},forcedSnapsToIntegralZoomLevels:!1,get snapsToIntegralZoomLevels(){return this.forcedSnapsToIntegralZoomLevels||this._renderer&&this._renderer.snapsToIntegralZoomLevels},set snapsToIntegralZoomLevels(t){0},get debug(){return this._debug},set debug(t){this._debug!==!!t&&(this._debug=!!t,this._debug?this._showDebugPanel():this._hideDebugPanel())},minZoomLevelForViewportSize:function(t,e){return this._renderer&&this._renderer.Camera?this._renderer.Camera.getMinZoomLevel([t.width,t.height],e):this.minZoomLevel},needsReplacing:function(t){return!t},createLabelRegion:function(){return this._renderer.createLabelRegion()},updatedLabelRegion:function(){this.forceRerender(),this.node.needsDisplay=!0},unregisterLabelRegion:function(t){this._renderer.unregisterLabelRegion(t),this.node.needsDisplay=!0},_tileOverlaysDidChange:function(){this._fallback()},_showDebugPanel:function(){this._debugPanel=new kr((()=>{this.debug=!1}),this.camera),this._debugPanel.attachTo(this._element),this._cameraDidChange=function(){Oa.prototype._cameraDidChange.call(this),this._debugPanel&&this._debugPanel.update(this.camera)}},_hideDebugPanel:function(){this._debugPanel.detach(),delete this._debugPanel,delete this._cameraDidChange},_updateDisplay:function(){this.forceRerender(),this.node.needsDisplay=!0},_getRendererPoiFilter:function(){const t=null!==this.pointOfInterestFilter,e=0!==this._filteredPois.size,i={};return t&&(i.categoryInclude=this.pointOfInterestFilter._includes,i.categoryExclude=this.pointOfInterestFilter._excludes),e&&(i.muidExclude=Array.from(this._filteredPois)),t||e?i:null}});const Or=Rr;function Pr(){bs.call(this),this._renderer=new fr(this),Object.defineProperty(this,"_impl",{value:new Or(this)})}Pr.prototype=p(bs,Pr,{get isRotationEnabled(){return this._impl.isRotationEnabled},set isRotationEnabled(t){this._impl.isRotationEnabled=t},get customCanvas(){return this._impl.customCanvas},set needsDisplay(t){t&&ue.scheduleDraw(this._renderer)},get forcedSnapsToIntegralZoomLevels(){return this._impl.forcedSnapsToIntegralZoomLevels},set forcedSnapsToIntegralZoomLevels(t){this._impl.forcedSnapsToIntegralZoomLevels=t},init:function(t,e,i,n,o){this._impl.init(t,e,i,n,o)},updateNetworkConfiguration:function(t){this._impl.updateNetworkConfiguration(t)},forceRerender:function(){this._impl.forceRerender()},forceDraw(){this._impl.forceRerender(),this._impl._renderer.performScheduledDraw()},requireRender:function(){this._impl.forceRerender(),ue.scheduleDraw(this._renderer)},rotateCameraAroundMapPoint:function(t,e){this._impl.rotateCameraAroundMapPoint(t,e)},makePendingConfigurationUpdates:function(){this._impl.makePendingConfigurationUpdates()},didReconfigure:function(){this.dispatchEvent(new T.Event("reconfigured"))},getMapFeatureRegions:function(){return this._impl.getMapFeatureRegions()}});const Dr=Pr,zr=Object.freeze({name:"functions",fn:function(){return!!(Array.prototype.fill&&Uint8Array.from&&"undefined"!=typeof Set&&Set.prototype.forEach&&window.btoa)}});function Nr(t){return{VERSION:t.getParameter(t.VERSION),MAX_RENDERBUFFER_SIZE:t.getParameter(t.MAX_RENDERBUFFER_SIZE)}}const Fr=Object.freeze({name:"webGL",fn:function(t,e){if(e)return{capable:!0};const i=t?[t]:["webgl2","webgl"];for(let t=0;t<i.length;t++){const e=document.createElement("canvas");e.width=e.height=0;const o=e.getContext(i[t],{antialias:!1,stencil:!0,failIfMajorPerformanceCaveat:!0});if(null!=o)return{contextType:i[t],capable:(n=o,n.getParameter(n.MAX_TEXTURE_SIZE)>=4096&&n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>=8&&n.getParameter(n.MAX_VARYING_VECTORS)>=8&&n.getParameter(n.STENCIL_BITS)>=8),gpuInfo:Nr(o)}}var n;return!1}});let Ur;fe.createSyrupUrl=function(){if(kt.state===kt.States.UNINITIALIZED)return void 0;let t;const e="/ti/csr/1.x.x";return t=kt._syrupUrl?kt._syrupUrl:kt.proxyPrefixes?kt.proxyPrefixes[0]+i.cdnBase+e:"https:"+i.cdnBase+e,[t,"mk-csr.js?mapkitVersion="+i.version+(kt.enableSourceMap?"&sourcemap=1":"")].join("/")},fe.isSyrupUrlTrusted=function(){return!kt._syrupUrl&&(!kt.proxyPrefixes||kt.isProxyPrefixTrusted())};const Gr=()=>{if(window.Syrup||window.Spile&&window.Spile.Syrup)return Promise.resolve();if(!Ur){const t=kt.performanceMarkers.loading;t&&performance.mark("mapkit-syrup-load-start");const e=()=>new Promise(((t,e)=>{const i=document.head.appendChild(document.createElement("script"));i.addEventListener("error",(t=>e(t)),{once:!0}),i.addEventListener("load",(()=>t()),{once:!0}),kt.nonce&&fe.isSyrupUrlTrusted()&&(i.nonce=kt.nonce),i.crossOrigin=Hs.getCorsAttribute(kt._syrupUrl?kt.urlWithCredentials(kt._syrupUrl):kt.withCredentials),i.src=fe.createSyrupUrl()})).then((()=>{(window.Syrup||window.Spile&&window.Spile.Syrup)&&(t&&performance.measure("mapkit-syrup-load","mapkit-syrup-load-start"),kt.componentVersions.s=window.Syrup?window.Syrup.Version:window.Spile.version)}),(t=>{console.error(t)}));Ur=kt._syrupUrl?e():kt.loginPromise.then(e)}return Ur},Br=tt,Zr=N,Wr={sg_grid:{"global-configuration":"sg_ready",upgrade:"syrup_insert"},sg_insert:{"global-configuration":"sg_ready",upgrade:"syrup_insert",recreate:"sg_insert"},syrup_insert:{"global-configuration":"syrup_need_load",fallback:"sg_insert",recreate:"syrup_insert"},syrup_need_load:{"syrup-load":"syrup_init",fallback:"sg_insert",recreate:"syrup_insert"},syrup_init:{"global-configuration":"syrup_network_stalled",fallback:"sg_insert",recreate:"syrup_insert","syrup-complete":"syrup_ready"},syrup_network_stalled:{"global-configuration":"syrup_network_stalled",fallback:"sg_insert",recreate:"syrup_insert","syrup-complete":"syrup_ready"},sg_ready:{"global-configuration":"sg_ready",upgrade:"syrup_insert",recreate:"sg_insert","map-configuration":"sg_ready"},syrup_ready:{"global-configuration":"syrup_ready",upgrade:"syrup_insert",fallback:"sg_insert",recreate:"syrup_insert","map-configuration":"syrup_ready","print-match":"syrup_printing"},syrup_printing:{"print-unmatch":"syrup_ready"}},Kr=Object.keys(Cn).map((t=>Cn[t]));function Hr(t,e){this._state=null,this._map=t,this._previousNode=null,this.node=null,this._initialOptions=e,this._cachedWebGLCheck=null,this._layers=[],this.loadPriority=Sn.LandCover,void 0!==e.loadPriority&&(m(e.loadPriority,Sn)?this.loadPriority=e.loadPriority:console.warn("[MapKit] Unknown value for `loadPriority`. Choose from mapkit.Map.LoadPriorities.")),this.initialContextType=e.contextType,this._previousCanRunCSR=!1;this._updateState("sg_grid")}function jr(t){this.customCanvas=t.customCanvas,Ko.Opacity.call(this,t)}Hr.prototype={constructor:Hr,get usingSSR(){return"sg_insert"===this._state||"sg_ready"===this._state},get csrCapable(){return"HYBRID"===kt.forcedRenderingMode||"CLIENT"===kt.forcedRenderingMode||this._webglCheckResult.shouldTryCSR},get shouldDynamicallyLoadSyrup(){return this._webglCheckResult.shouldTryCSR},get _webglCheckResult(){return null===this._cachedWebGLCheck&&(this._cachedWebGLCheck=function(t,e){const i={};return i.shouldTryCSR=[zr,Fr].every((function(n){const o=n.fn(t,e);return i[n.name]=o,"object"==typeof o?o.capable:o})),i}(this.initialContextType,kt._disableWebGLCheck)),this._cachedWebGLCheck},get renderingMode(){let t="CLIENT";return this.usingSSR?t="SERVER":this._switchedToLoCSR&&(t="HYBRID"),t},configurationDidBecomeAvailable:function(t){const e=this._previousCanRunCSR,i=kt.canRunCSR;this._previousCanRunCSR=i,!e||i||this.usingSSR?!e&&i?this.handleUpgrade():t||this.handleGlobalConfigurationChange():this.handleFallback(_n)},forceSyrup:function(){this._transition("upgrade")},_findLayerIndex:function(t){let e;const i=this._layers;if("string"==typeof t)for(e=i.length;e--&&i[e].name!==t;);else e=i.indexOf(t);if(e<0)throw new Error("[MapKit] Layer not found");return e},_addLayer:function(t,e,i){const n=this._layers;let o;const s=Kr.indexOf(e);if(s<0)o=this._findLayerIndex(e),t._impl.passIndex=n[o]._impl.passIndex,o+=i;else{for(o=0;o<n.length&&n[o].passIndex<s+i;)o++;t._impl.passIndex=s,t._impl.passOffset=i-1}this.node._impl.prepareLayer(t),o===n.length?this.node._impl.addLayer(t):0===o?this.node._impl.insertBefore(t,n[0]):this.node._impl.insertAfter(t,n[o-1]),n.splice(o,0,t)},_addedLayer:function(t){this.usingSSR?t._impl.contextFailed():this.node.requireRender()},addLayerAbove:function(t,e){void 0===e?(t._impl.passIndex=Kr.length-1,t._impl.passOffset=0,this.node._impl.prepareLayer(t),this.node._impl.addLayer(t),this._layers.push(t)):this._addLayer(t,e,1),this._addedLayer(t)},addLayerBelow:function(t,e){if(void 0===e)throw new Error("[MapKit] Relative layer not specified");this._addLayer(t,e,0),this._addedLayer(t)},removeLayer:function(t){const e=this._findLayerIndex(t);this._layers.splice(e,1),this.node._impl.removeLayer(t),this.node.requireRender()},requireRender:function(){this.node.requireRender()},updateSize:function(t){this.node.size=t,this._previousNode&&(this._previousNode.size=t)},destroy:function(){this._layers.forEach((t=>this.node._impl.removeLayer(t))),this.node.removeEventListener("reconfigured",this),this.node.destroy(),this.node.delegate=null,this.node=null,this._previousNode&&(this._previousNode.destroy(),this._previousNode=null)},handleEvent:function(t){"reconfigured"===t.type&&(this._switchedToLoCSR=this.node.snapsToIntegralZoomLevels,this._map.didReconfigureMapNode(this.node))},handleGlobalConfigurationChange:function(){this._transition("global-configuration")},handleSyrupLoad:function(){this._transition("syrup-load")},handleFallback:function(t,e){const i=kt.didFallback&&kt.fallbackType||t;i&&this._logFallback(i,e),this._fallbackInfo={reason:t,message:e},this._transition("fallback")},handleUpgrade:function(){this._fallbackInfo=void 0,this._transition("upgrade")},handleRecreate:function(){this._transition("recreate")},handleMapConfigurationChange:function(){this._transition("map-configuration"),this._previousNode&&this._previousNode.configuration&&(this._previousNode.language=kt.language,this._previousNode.configuration=kt.types[this._map.mapType])},handleSyrupComplete:function(){this._transition("syrup-complete")},handlePrintMatch:function(){this._transition("print-match")},handlePrintUnmatch:function(){this._transition("print-unmatch")},handleMapRendered:function(){this.node instanceof Dr&&(this.node.forcedSnapsToIntegralZoomLevels=!1,this._removePreviousMapNode(!0))},setPointOfInterestFilter:function(t){this._previousNode&&(this._previousNode.pointOfInterestFilter=t)},setTintAndEmphasis:function(t,e,i){this._previousNode&&this._previousNode.setTintAndEmphasis(t,e,i)},mapCameraDidChange:function(){this._previousNode&&this._previousNode.setCameraAnimated(this.node.camera.copy())},_transition:function(t){const e=Wr[this._state][t];e&&this._updateState(e)},_updateState:function(t){this._state=t;const e=this["_enter_"+t];"function"==typeof e&&e.call(this)},_loadSyrupIfNeeded:function(t){Gr().then((()=>{t.call(this,!!window.Syrup||!!window.Spile&&!!window.Spile.Syrup)}))},_insertSceneGraphNode:function(){this.usingSSR&&(this.node.isRotationEnabled=!1);const t=new er;this._insertNewMapNode(t),this._map.didFinishMapNodeInitialization(t)},_enter_sg_grid:function(){this._insertSceneGraphNode(),kt.ready&&!kt.canRunCSR&&this._updateState("sg_ready")},_enter_sg_insert:function(){this._insertSceneGraphNode(),kt.ready&&this._updateState("sg_ready")},_enter_syrup_insert:function(){const t=new Dr;t.pendingConfigurationUpdates={},this._insertNewMapNode(t),kt.state===kt.States.READY&&this._updateState("syrup_need_load")},_insertNewMapNode:function(t){const e=this._initialOptions||{};this._initialOptions||this.node._impl._cameraWillChange(this.node,!1);const i=this.node;if(i)this._removePreviousMapNode(),i.migrateStateTo(t),i.removeEventListener("reconfigured",this),i.deactivate(),this._layers.forEach((function(t){i._impl.cleanupLayer(t),i._impl.removeLayer(t)})),this._previousNode=i;else{t.allowWheelToZoom=void 0!==e._allowWheelToZoom&&!!e._allowWheelToZoom,t.allowWheelToZoom2=void 0!==e._allowWheelToZoom2&&!!e._allowWheelToZoom2,t.pannable=void 0===e.isScrollEnabled||!!e.isScrollEnabled,t.zoomable=void 0===e.isZoomEnabled||!!e.isZoomEnabled,void 0!==e.pointOfInterestFilter?(void 0!==e.showsPointsOfInterest&&console.warn("[MapKit] `showsPointsOfInterest` is ignored because `pointOfInterestFilter` is set."),null!==e.pointOfInterestFilter&&f(e.pointOfInterestFilter,Tt,"[MapKit] Unknown value for `pointOfInterestFilter`. It must be an instance of mapkit.PointOfInterestFilter."),t.pointOfInterestFilter=e.pointOfInterestFilter):void 0!==e.showsPointsOfInterest&&(e.showsPointsOfInterest?t.pointOfInterestFilter=null:t.pointOfInterestFilter=Tt.filterExcludingAllCategories),t.showsDefaultTiles=void 0===e._showsDefaultTiles||!!e._showsDefaultTiles;for(const i of Hr.InitialOptionsHandlers)i.call(this,t,e)}this.node=t,this.node.addEventListener("reconfigured",this),this._map.didInsertNewMapNode(t),this._layers.forEach((function(e){t._impl.prepareLayer(e),t._impl.addLayer(e)})),this._initialOptions?delete this._initialOptions:this.node._impl._cameraDidChange(this.node,!1)},_removePreviousMapNode:function(t){if(this._previousNode)if(t){if(this._previousNode.animators&&this._previousNode.animators.length)return;const t=this._previousNode;new jr({node:this._previousNode,duration:150,from:1,to:0,customCanvas:this._previousNode.customCanvas,done:()=>{t===this._previousNode&&this._removePreviousMapNode(!1)}}).begin()}else this._previousNode.destroy(!0),this._previousNode.remove(),this._previousNode=null},_enter_syrup_need_load:function(){if(this.shouldDynamicallyLoadSyrup){if(this.loadPriority&&this._previousNode&&this._previousNode instanceof er&&!this._previousNode.configuration)if(0!==this.node.rotation)0;else{const t=this.loadPriority===Sn.PointsOfInterest;this._previousNode.snapsToIntegralZoomLevels=t,this._previousNode.labels=t,t&&(this.node.forcedSnapsToIntegralZoomLevels=!0,this.node.setZoomLevelAnimated(Co.getIntegralZoom(this.node.zoomLevel))),this._previousNode.language=kt.language,this._previousNode.configuration=kt.types[this._map.mapType],this._previousNode.delegate={mapDidFinishRendering:t=>this._map.previousMapDidFinishRendering(t)},this._previousNode.setCameraBoundaryAnimated(null),this._previousNode.setCameraZoomRangeAnimated(null)}this._loadSyrupIfNeeded((t=>{t?this.handleSyrupLoad():(kt.syrupRequestedFallback(),this.handleFallback(dn))}))}else this.handleFallback(un)},_enter_syrup_init:function(){if(!this.node)return;if(!kt.madabaDomains||!kt.madabaDomains.length)return this._csrWarning("Network error"),void this.handleFallback(fn);const t="object"==typeof Syrup?Syrup.SyrupRenderer:Spile.getRendererWithoutAnyWarranty(),e="object"==typeof Syrup?Syrup.Camera:Spile.Syrup.Camera;this._switchedToLoCSR=!1,kt.forcedRenderingMode&&(this._switchedToLoCSR="HYBRID"===kt.forcedRenderingMode);const i=this.node;this._reConfigureMapNode();const n=kt.performanceMarkers.rendering?performance.now():void 0;i.init(kt,t,e,{startInLoCSR:this._switchedToLoCSR,contextType:this._webglCheckResult.webGL.contextType,performanceMarkers:kt.performanceMarkers.rendering},(t=>{kt.performanceMarkers.rendering&&performance.measure("mapkit-syrup-init",{start:n}),t?(this._csrWarning(t),this.handleFallback(t.type||gn,t.message)):(this._reConfigureMapNode(),i.needsDisplay=!0,this._map.didFinishMapNodeInitialization(i),this.handleSyrupComplete())}))},_csrWarning:function(t){console.warn("[MapKit] CSR is unavailable. "+t)},_enter_syrup_network_stalled:function(){this.node.updateNetworkConfiguration(kt)},_enter_sg_ready:function(){this._removePreviousMapNode(),this.node.snapsToIntegralZoomLevels=!0,this.node.isRotationEnabled=!1,"HYBRID"!==kt.forcedRenderingMode&&"CLIENT"!==kt.forcedRenderingMode||(this._map.mapNodeDidFail(this._fallbackInfo),console.warn("[MapKit] Not rendering raster tiles under forced client rendering."),this.node.showsDefaultTiles=!1),this._reConfigureMapNode(),this._map.mapNodeReady(!1),this._layers.forEach((t=>{t._impl.contextFailed()}))},_enter_syrup_ready:function(){!this.node.fullyRendered&&this._previousNode&&this._previousNode.configuration?(this._previousNode.language=kt.language,this._previousNode.configuration=kt.types[this._map.mapType]):this._removePreviousMapNode(),this._reConfigureMapNode(),this.node.updateNetworkConfiguration(kt),this.node.makePendingConfigurationUpdates(),this._map.mapNodeReady(!0)},_reConfigureMapNode:function(){this.node.language=kt.language,this.node.configuration=kt.types[this._map.mapType],this.node._impl.debug||(this.node._impl.debug=!!kt.showsTileInfo),this._map.didReconfigureMapNode(this.node)},_enter_syrup_printing:function(){this.node.forceRerender(),this.node.needsDisplay=!0},_sendAnalytics:function(t){let e="https://gsp10.apple-mapkit.com/hvr/mw/v1/spile";if(kt.proxyPrefixes){e=kt.proxyPrefixes[kt.proxyPrefixes.length-1]+e}const i={};t&&(i.ssrFallback=t);new Br(e,{getDataToSend:function(t){return t.setRequestHeader("Content-Type","text/plain"),t.responseType="text",JSON.stringify(i)}},{method:"POST",priority:Zr.Low,withCredentials:kt.withCredentials}).schedule()},_logFallback:function(t,e){const i=ze.uaParserInfo.browserInfo,n=ze.uaParserInfo.deviceInfo,o=this._usingCSRAPI();this._sendAnalytics({reason:t,message:e,usingCSRAPI:o,devicePlatform:n.platform,deviceOs:n.os,browserName:i.name,browserVersion:i.version})},_usingCSRAPI:function(){return!(this._map._showsCompass!==En.Visible&&(this._map._showsCompass!==En.Adaptive||this._map._usingDefaultShowsCompassValue)&&0===this._map.rotation&&!this._map._annotationsController.containsMarkerAnnotation())}},Hr.InitialOptionsHandlers=[],jr.prototype=p(Ko.Opacity,jr,{update:function(t){this.customCanvas&&(this.customCanvas.style.opacity=this.valueAt(t)),Ko.Opacity.prototype.update.call(this,t)}});const Vr=Hr,qr=(t,e,i)=>{const n=t.createShader(e);t.shaderSource(n,i),t.compileShader(n);if(t.getShaderParameter(n,t.COMPILE_STATUS))return n;t.deleteShader(n)};const Yr=function(t){this._impl={scene:t,failed:!1,prepare(t){if(this.failed)return;const e=qr(t,t.VERTEX_SHADER,"\nattribute vec2 a_position;\nvarying vec2 v_texcoord;\nvoid main() {\n gl_Position = vec4((a_position * 2.0 - 1.0) * vec2(1, -1), 0, 1);\n v_texcoord = a_position;\n}\n"),i=qr(t,t.FRAGMENT_SHADER,"precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D u_texture;\nvoid main() {\n gl_FragColor = texture2D(u_texture, v_texcoord);\n}");this.program=((t,e,i)=>{const n=t.createProgram();if(t.attachShader(n,e),t.attachShader(n,i),t.linkProgram(n),t.getProgramParameter(n,t.LINK_STATUS))return n;t.deleteProgram(n)})(t,e,i)},release(t){this.failed||t.deleteProgram(this.program)},added(t){this.prepare(t)},removed(t){this.release(t)},render(t,e){if(this.failed)return;const i=this.program,n=t.getAttribLocation(i,"a_position"),o=t.getUniformLocation(i,"u_texture"),s=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,s);const a=t.canvas.width,r=t.canvas.height;t.viewport(0,0,a,r),t.useProgram(this.program),t.enableVertexAttribArray(n),t.bindBuffer(t.ARRAY_BUFFER,s);const l=t.createTexture();t.bindTexture(t.TEXTURE_2D,l),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.scene.element),t.generateMipmap(t.TEXTURE_2D),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),t.STATIC_DRAW),t.vertexAttribPointer(n,2,t.FLOAT,!1,0,0),t.uniform1i(o,0),t.enable(t.BLEND),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA),t.drawArrays(t.TRIANGLES,0,6)},contextLost(t){this.release(t)},contextRestored(t){this.prepare(t)},contextFailed(){this.failed=!0}}},Xr={"logo-autonavi":{xMin:.132,xMax:.828},"logo-autonavi-rtl":{xMin:.127,xMax:.833},"logo-autonavi-satellite":{xMin:.132,xMax:.828},"logo-autonavi-satellite-rtl":{xMin:.186,xMax:.862},"logo-wordmark-ar-SA":{xMin:.36,xMax:.996},"logo-wordmark-ca-ES":{xMin:.003,xMax:.631},"logo-wordmark-cs-CZ":{xMin:.003,xMax:.546},"logo-wordmark-da-DK":{xMin:.003,xMax:.434},"logo-wordmark-de-DE":{xMin:.003,xMax:.616},"logo-wordmark-el-GR":{xMin:.003,xMax:.681},"logo-wordmark-en-US":{xMin:.003,xMax:.539},"logo-wordmark-en-GB":{xMin:.003,xMax:.539},"logo-wordmark-es-ES":{xMin:.003,xMax:.63},"logo-wordmark-fr-CA":{xMin:.003,xMax:.533},"logo-wordmark-fi-FI":{xMin:.003,xMax:.578},"logo-wordmark-fr-FR":{xMin:.003,xMax:.533},"logo-wordmark-he-IL":{xMin:.491,xMax:.996},"logo-wordmark-hi-IN":{xMin:.003,xMax:.523},"logo-wordmark-hr-HR":{xMin:.003,xMax:.523},"logo-wordmark-hu-HU":{xMin:.003,xMax:.807},"logo-wordmark-es-MX":{xMin:.003,xMax:.63},"logo-wordmark-id-ID":{xMin:.003,xMax:.454},"logo-wordmark-ja-JP":{xMin:.003,xMax:.506},"logo-wordmark-ko-KR":{xMin:.003,xMax:.407},"logo-wordmark-it-IT":{xMin:.003,xMax:.644},"logo-wordmark-ms-MY":{xMin:.003,xMax:.454},"logo-wordmark-nb-NO":{xMin:.003,xMax:.432},"logo-wordmark-nl-NL":{xMin:.003,xMax:.704},"logo-wordmark-pt-BR":{xMin:.003,xMax:.63},"logo-wordmark-pl-PL":{xMin:.003,xMax:.546},"logo-wordmark-pt-PT":{xMin:.003,xMax:.63},"logo-wordmark-ru-RU":{xMin:.003,xMax:.605},"logo-wordmark-ro-RO":{xMin:.003,xMax:.488},"logo-wordmark-satellite-ar-SA":{xMin:.357,xMax:.996},"logo-wordmark-satellite-ca-ES":{xMin:.003,xMax:.635},"logo-wordmark-satellite-de-DE":{xMin:.003,xMax:.62},"logo-wordmark-satellite-da-DK":{xMin:.003,xMax:.437},"logo-wordmark-satellite-cs-CZ":{xMin:.003,xMax:.551},"logo-wordmark-satellite-en-GB":{xMin:.003,xMax:.542},"logo-wordmark-satellite-en-US":{xMin:.003,xMax:.542},"logo-wordmark-satellite-es-ES":{xMin:.003,xMax:.633},"logo-wordmark-satellite-es-MX":{xMin:.003,xMax:.633},"logo-wordmark-satellite-el-GR":{xMin:.003,xMax:.685},"logo-wordmark-satellite-fr-CA":{xMin:.003,xMax:.537},"logo-wordmark-satellite-fi-FI":{xMin:.003,xMax:.581},"logo-wordmark-satellite-he-IL":{xMin:.487,xMax:.997},"logo-wordmark-satellite-fr-FR":{xMin:.003,xMax:.537},"logo-wordmark-satellite-hu-HU":{xMin:.003,xMax:.814},"logo-wordmark-satellite-hi-IN":{xMin:.003,xMax:.525},"logo-wordmark-satellite-hr-HR":{xMin:.003,xMax:.523},"logo-wordmark-satellite-id-ID":{xMin:.003,xMax:.458},"logo-wordmark-satellite-it-IT":{xMin:.003,xMax:.648},"logo-wordmark-satellite-ja-JP":{xMin:.003,xMax:.51},"logo-wordmark-satellite-ko-KR":{xMin:.003,xMax:.41},"logo-wordmark-satellite-nl-NL":{xMin:.003,xMax:.707},"logo-wordmark-satellite-nb-NO":{xMin:.003,xMax:.435},"logo-wordmark-satellite-ms-MY":{xMin:.003,xMax:.458},"logo-wordmark-satellite-pt-BR":{xMin:.003,xMax:.633},"logo-wordmark-satellite-pl-PL":{xMin:.003,xMax:.551},"logo-wordmark-satellite-pt-PT":{xMin:.003,xMax:.633},"logo-wordmark-satellite-ro-RO":{xMin:.003,xMax:.492},"logo-wordmark-satellite-ru-RU":{xMin:.003,xMax:.608},"logo-wordmark-satellite-sk-SK":{xMin:.003,xMax:.551},"logo-wordmark-satellite-sl-SI":{xMin:.003,xMax:.881},"logo-wordmark-satellite-sv-SE":{xMin:.003,xMax:.588},"logo-wordmark-satellite-th-TH":{xMin:.003,xMax:.542},"logo-wordmark-satellite-tr-TR":{xMin:.003,xMax:.574},"logo-wordmark-satellite-uk-UA":{xMin:.003,xMax:.588},"logo-wordmark-satellite-vi-VN":{xMin:.003,xMax:.636},"logo-wordmark-satellite-zh-CN":{xMin:.003,xMax:.407},"logo-wordmark-satellite-zh-HK":{xMin:.003,xMax:.407},"logo-wordmark-satellite-zh-TW":{xMin:.003,xMax:.407},"logo-wordmark-sv-SE":{xMin:.003,xMax:.585},"logo-wordmark-sk-SK":{xMin:.003,xMax:.546},"logo-wordmark-sl-SI":{xMin:.003,xMax:.882},"logo-wordmark-th-TH":{xMin:.003,xMax:.539},"logo-wordmark-vi-VN":{xMin:.003,xMax:.633},"logo-wordmark-zh-CN":{xMin:.003,xMax:.403},"logo-wordmark-tr-TR":{xMin:.003,xMax:.571},"logo-wordmark-uk-UA":{xMin:.003,xMax:.584},"logo-wordmark-zh-HK":{xMin:.003,xMax:.403},"logo-wordmark-zh-TW":{xMin:.003,xMax:.403}},$r="satellite",Jr="autonavi",Qr="mk-logo-control",tl="mk-logo",el="mk-logo-autonavi";function il(t,e,i){const n=t._logoUpdatedDelegate,o=function(t,e){let i=["logo-wordmark"];kt.isAutoNavi&&(i=["logo",Jr]);t&&i.push($r);kt.isAutoNavi&&e&&i.push("rtl");kt.isAutoNavi||i.push(Oi.localeId);return i.join("-")}(i,t.rtl),s="logos/"+o,a=kt.isAutoNavi,r=a?[1,2,3]:[1],l=a||1===Co.devicePixelRatio?".png":".svg",h=Xr[o];h&&n&&n.logoUpdated&&n.logoUpdated(h),e.classList.toggle(el,kt.isAutoNavi),e.element.crossOrigin=Hs.getCorsAttribute(kt.distUrlWithCredentials),e.setAttribute("src",fe.createImageUrl(Co.imagePathForDevice(r,s,l)))}const nl=class extends qn{constructor(){const t=Co.htmlElement("img");super(Co.htmlElement("div",{class:Qr},t)),this._logoElement=t,this._logoElementNode=new qn(this._logoElement),this._logoElementNode.classList.add(tl),this.tint=void 0,Oi.addEventListener(Oi.Events.LocaleChanged,this),kt.addEventListener(kt.Events.Changed,this),this.rtl=Oi.activeLocale.rtl}setUpdatedDelegate(t){this._logoUpdatedDelegate=t}updateWithMapNodeTint(t){this.tint=t;const e=Co.darkColorScheme(t),i=this._logoElementNode;kt.state===kt.States.UNINITIALIZED?kt.addEventListener(kt.Events.Initialized,(function t(){kt.removeEventListener(kt.Events.Initialized,t),il(this,i,e)})):il(this,i,e);const n=kt.tileProvider?kt.tileProvider:kt.TileProviders.Apple;i.setAttribute("alt",Oi.get("Logo."+n+".Tooltip"))}handleEvent(t){switch(t.type){case Oi.Events.LocaleChanged:this.rtl=t.locale.rtl,this._handleLocaleChange(t);break;case kt.Events.Changed:if(!this.tint)return void 0;this.updateWithMapNodeTint(this.tint)}}mapWasDestroyed(){Oi.removeEventListener(Oi.Events.LocaleChanged,this),kt.removeEventListener(kt.Events.Changed,this)}_handleLocaleChange(t){this.tint&&this.updateWithMapNodeTint(this.tint)}},ol="mk-legal",sl="mk-legal-label";class al extends so.Node{constructor(){super(Co.htmlElement("a",{target:"_blank",tabindex:0})),this.classList.add(ol);const t=Co.htmlElement("span");t.textContent=Oi.get("Legal.Label"),this._labelNode=new so.Node(t),this._labelNode.classList.add(sl),this.element.appendChild(this._labelNode.element),this._handleKeyPressEventListener=t=>this._handleKeyPressEvent(t)}updateWithMapType(t){if(this.mapType=t,this._labelNode.element.textContent=Oi.get("Legal.Label"),kt.isAutoNavi)if(kt.ready){const t=kt.types[this.mapType].tileSources[0];t.attribution&&t.attribution.url&&this.setAttribute("href",t.attribution.url)}else this.removeAttribute("href");else this.setAttribute("href",Oi.get("Legal.Apple.URL"))}willMoveToParent(t){t?this.parent||(this._handleLocaleChangedListener=t=>this._handleLocaleChanged(t),Oi.addEventListener(Oi.Events.LocaleChanged,this._handleLocaleChangedListener),this.element.addEventListener("keypress",this._handleKeyPressEventListener)):(Oi.removeEventListener(Oi.Events.LocaleChanged,this._handleLocaleChangedListener),this.element.removeEventListener("keypress",this._handleKeyPressEventListener))}_handleLocaleChanged(t){this.mapType&&this.updateWithMapType(this.mapType)}_handleKeyPressEvent(t){"Space"===t.code&&(t.preventDefault(),this.element.click())}}const rl=al;class ll extends qn{constructor(t){super(t),this.classList.add(hl.CONTROL),void 0===this._enabled&&(this._enabled=!1),void 0===this.hasFocus&&(this.hasFocus=!1),void 0===this.pageHasFocus&&(this.pageHasFocus=!1)}get enabled(){return this._enabled}set enabled(t){const e=!!t;this._enabled!==e&&(e?this.enable():this.disable(),this._enabled=e,this.reset())}set canShowTooltips(t){t?this._updateLabels():this._clearLabels()}willMoveToParent(t){t?this.parent||(this._createListeners(),Oi.addEventListener(Oi.Events.LocaleChanged,this._eventListener),this.enabled&&(this._addFocusAndBlurListeners(),this._addKeyboardListeners(),this.addEventListeners())):(Oi.removeEventListener(Oi.Events.LocaleChanged,this._eventListener),this.removeEventListeners(),this._removeFocusAndBlurListeners(),this._removeKeyboardListeners(),this._destroyListeners())}enable(){this.classList.remove(hl.DISABLED),this._createListeners(),this.element.addEventListener(Co.startEventType,this._eventListener),this.element.addEventListener("click",this._eventListener),this.parent&&(this._addFocusAndBlurListeners(),this._addKeyboardListeners(),this.addEventListeners())}disable(){this.classList.add(hl.DISABLED),this.element.removeEventListener(Co.startEventType,this._eventListener),this.element.removeEventListener("click",this._eventListener),this.removeEventListeners(),this._removeFocusAndBlurListeners(),this._removeKeyboardListeners()}blurFocusedElement(t){const e=Co.getShadowDOMTargetFromEvent(this.element,t);if(!this.element.contains(e)){const t=Co.containingDocumentOrShadowRoot(this.element);t.activeElement&&this.element.contains(t.activeElement)&&t.activeElement.blur()}}reset(){}saveEndEventProps(t){if(t&&t.type===Co.endEventType){const e=t.changedTouches?t.changedTouches[0]:t;this._endEventProps=[e.clientX,e.clientY,e.screenX,e.screenY]}}checkClickEventProps(t){if(!this._endEventProps)return!1;const e=[t.clientX,t.clientY,t.screenX,t.screenY];let i=!0;for(let t=0;t<e.length;t++)if(Math.abs(this._endEventProps[t]-e[t])>1){i=!1;break}return delete this._endEventProps,i}clicked(){}touchesBegan(t){}touchesMoved(t){}touchesEnded(t){}touchesCanceled(t){}spaceBarKeyDown(t){}spaceBarKeyUp(t){}escapeKeyDown(t){}escapeKeyUp(t){}downArrowKeyUp(t){}downArrowKeyDown(t){}upArrowKeyUp(t){}upArrowKeyDown(t){}rightArrowKeyUp(t){}leftArrowKeyUp(t){}rightArrowKeyDown(t){}leftArrowKeyDown(t){}focused(t){}blurred(t){}pageDidFocus(t){}pageDidBlur(t){}updateTintColor(t){}removeEventListeners(){}addEventListeners(){}localeChanged(){}_clearLabels(){Co.updateLabel(this.element,"")}_createListeners(){this._eventListener||(this._eventListener=new cl(this)),this._windowEventListener||(this._windowEventListener=new ul(this)),this._cancelFocusEventListener||(this._cancelFocusEventListener=new dl(this))}_destroyListeners(){this._eventListener&&(this.element.removeEventListener(Co.startEventType,this._eventListener),this.element.removeEventListener("click",this._eventListener),this._eventListener.destroy(),delete this._eventListener),this._windowEventListener&&(this._windowEventListener.destroy(),delete this._windowEventListener),this._cancelFocusEventListener&&(this._cancelFocusEventListener.destroy(),delete this._cancelFocusEventListener)}_addFocusAndBlurListeners(){this.element.addEventListener("focus",this._eventListener,!0),this.element.addEventListener("blur",this._eventListener,!0),window.addEventListener("focus",this._windowEventListener),window.addEventListener("blur",this._windowEventListener),this.hasFocus=Co.containingDocumentOrShadowRoot(this.element).activeElement===this.element}_removeFocusAndBlurListeners(){this.element.removeEventListener("focus",this._eventListener,!0),this.element.removeEventListener("blur",this._eventListener,!0),window.removeEventListener(Co.startEventType,this._cancelFocusEventListener,!0),window.removeEventListener("focus",this._windowEventListener),window.removeEventListener("blur",this._windowEventListener)}_addKeyboardListeners(){this.element.addEventListener("keydown",this._eventListener),this.element.addEventListener("keyup",this._eventListener)}_removeKeyboardListeners(){this.element.removeEventListener("keydown",this._eventListener),this.element.removeEventListener("keyup",this._eventListener)}}const hl={CONTROL:"mk-control",DISABLED:"mk-disabled",FOCUS:"mk-focus"};function cl(t){this._control=t}function dl(t){this._control=t}function ul(t){this._control=t}T.EventTarget(ll.prototype),cl.prototype={destroy:function(){window.removeEventListener(Co.startEventType,this._control._cancelFocusEventListener,!0),this._removeEventListeners(),delete this._control},handleEvent:function(t){switch(t.type){case"click":this._click(t);break;case Co.startEventType:this._touchesBegan(t);break;case Co.moveEventType:this._control.touchesMoved(t);break;case Co.endEventType:this._removeEventListeners(),this._control.touchesEnded(t);break;case Co.cancelEventType:this._removeEventListeners(),this._control.touchesCanceled(t);break;case"keydown":this._keyDown(t);break;case"keyup":this._keyUp(t);break;case"focus":this._focus(t);break;case"blur":this._blur(t);break;case Oi.Events.LocaleChanged:this._control.localeChanged(t)}},_click:function(t){this._swallowEvent(t),this._control.clicked(t)},_touchesBegan:function(t){this._swallowEvent(t);("mousedown"===t.type||"pointerdown"===t.type&&"mouse"===t.pointerType)&&(0!==t.button||t.ctrlKey)||(window.addEventListener(Co.moveEventType,this,!0),window.addEventListener(Co.endEventType,this,!0),Co.cancelEventType&&window.addEventListener(Co.cancelEventType,this,!0),this._control.touchesBegan(t))},_keyDown:function(t){switch(t.keyCode){case n:this._control.escapeKeyDown(t);break;case o:t.preventDefault(),this._control.spaceBarKeyDown(t);break;case l:t.preventDefault(),this._control.downArrowKeyDown(t);break;case a:t.preventDefault(),this._control.upArrowKeyDown(t);break;case r:t.preventDefault(),this._control.rightArrowKeyDown(t);break;case s:t.preventDefault(),this._control.leftArrowKeyDown(t)}},_keyUp:function(t){switch(t.keyCode){case n:this._control.escapeKeyUp(t);break;case l:t.preventDefault(),this._control.downArrowKeyUp(t);break;case a:t.preventDefault(),this._control.upArrowKeyUp(t);break;case r:t.preventDefault(),this._control.rightArrowKeyUp(t);break;case s:t.preventDefault(),this._control.leftArrowKeyUp(t);break;case o:t.preventDefault(),this._control.spaceBarKeyUp(t)}},_focus:function(t){if(this._control.hasFocus)return void 0;Co.containingDocumentOrShadowRoot(this._control.element).activeElement===t.target&&(this._control.hasFocus=!0,this._control.classList.add(hl.FOCUS),window.addEventListener(Co.startEventType,this._control._cancelFocusEventListener,!0),this._control.focused(t))},_blur:function(t){this._control.hasFocus&&(this._control.hasFocus=!1,window.removeEventListener(Co.startEventType,this._control._cancelFocusEventListener,!0),this._control.classList.remove(hl.FOCUS),this._control.blurred(t))},_removeEventListeners:function(){window.removeEventListener(Co.moveEventType,this,!0),window.removeEventListener(Co.endEventType,this,!0),Co.cancelEventType&&window.removeEventListener(Co.cancelEventType,this,!0)},_swallowEvent:function(t){t.preventDefault(),t.stopPropagation()}},dl.prototype={destroy:function(){delete this._control},handleEvent:function(t){this._control.blurFocusedElement(t)}},ul.prototype={destroy:function(){delete this._control},handleEvent:function(t){switch(t.type){case"focus":this._control.pageHasFocus||(this._control.pageHasFocus=!0,this._control.pageDidFocus(t));break;case"blur":this._control.pageHasFocus=!1,this._control.pageDidBlur(t)}}};const pl=ll;const ml={CONTROL:"mk-popover",ARROW:"mk-popover-arrow",SHOWN:"mk-shown"};const gl=class extends qn{constructor(){super(Co.htmlElement("div",{class:ml.CONTROL,role:"dialog",tabindex:"-1"})),this.element.appendChild(Co.createSVGIcon(Co.svgElement("g",Co.svgElement("rect",{y:12,x:0,height:2,width:30}),Co.svgElement("path",{d:"M0 13v-.5c4.038 0 8.305-3.53 12.835-10.477.454-.71 1.005-1.137 1.564-1.326h.001a2.07 2.07 0 011.814.225c.273.175.505.407.68.68C21.525 8.829 25.881 12.5 30 12.5v.5"})),{class:ml.ARROW,"aria-hidden":!0,width:30,height:14}))}open(){this.classList.add(ml.SHOWN)}handleEvent(t){this.classList.contains(ml.SHOWN)&&this.focus()}focus(){this.element.focus()}close(){this.classList.remove(ml.SHOWN)}didMoveToParent(t){t?this.element.addEventListener("transitionend",this):this.element.removeEventListener("transitionend",this)}};class _l extends so.Node{constructor(t,e,i){super(Co.htmlElement("label",{class:fl.CONTROL})),this.delegate=i,this.mapType=t,this.enabled=!1,this._handleChangeEventListener=()=>this._handleChangeEvent();const n=i.mapTypes[t]===i.mapType,o=Oi.get("Mode."+t),s=Co.htmlElement("input",{type:"radio",name:e,"aria-label":o,tabindex:"0"});s.checked=n,this.radioElement=s,this.element.appendChild(s);const a=function(t,e){const i=[];e[t]===e.Standard?(i.push(Co.htmlElement("img",{class:fl.LIGHT_ICON,"aria-hidden":!0,crossOrigin:Hs.getCorsAttribute(kt.distUrlWithCredentials),src:yl(t,!1)})),i.push(Co.htmlElement("img",{class:fl.DARK_ICON,"aria-hidden":!0,crossOrigin:Hs.getCorsAttribute(kt.distUrlWithCredentials),src:yl(t,!0)}))):i.push(Co.htmlElement("img",{"aria-hidden":!0,crossOrigin:Hs.getCorsAttribute(kt.distUrlWithCredentials),src:yl(t,!1)}));return i}(t,i.mapTypes);a.forEach((t=>this.element.appendChild(t)))}focus(){this.radioElement.focus()}setSelected(){this.element.firstChild.checked=!0}updateLabels(){const t=Oi.get("Mode."+this.mapType);this.radioElement.setAttribute("aria-label",t)}activate(){this.radioElement.addEventListener("change",this._handleChangeEventListener),this._handleChangeEvent()}deactivate(){this.radioElement.removeEventListener("change",this._handleChangeEventListener)}_handleChangeEvent(){this.radioElement.checked&&this._handleSelected(this.radioElement.checked)}_handleSelected(){this.delegate.mapType=this.delegate.mapTypes[this.mapType]}}const fl={CONTROL:"mk-map-type-button",LIGHT_ICON:"mk-light-icon",DARK_ICON:"mk-dark-icon"};function yl(t,e){const i=["icons/map-type"];return i.push(t.toLowerCase()),e&&i.push("dark"),fe.createImageUrl(Co.imagePathForDevice([1,2],i.join("-"),".png"))}const vl=_l,wl=["Standard","Hybrid","Satellite"];const bl={POPOVER:"mk-map-type-popover",MAP_TYPE_LABEL:"mk-map-type-label"},Cl=class extends gl{constructor(t){super(),this.classList.add(bl.POPOVER),this.setAttribute("aria-label",Oi.get("MapType.Tooltip")),this.delegate=t,this.buttons={},this.labels={};const e=`mk-map-type-button-${Math.random().toString(32).substring(2)}`;wl.forEach((i=>{const n=new qn,o=new vl(i,e,t);n.addChild(o);const s=new qn(Co.htmlElement("div",{"aria-hidden":"true",class:bl.MAP_TYPE_LABEL}));s.element.textContent=Oi.get("Mode."+i),n.addChild(s),this.addChild(n),this.buttons[i]=o,this.labels[i]=s,t.mapTypes[i]===t.mapType&&(this.selectedButton=o)}))}focus(){this.selectedButton.focus()}updateSelected(){const t=wl.find((t=>this.delegate.mapTypes[t]===this.delegate.mapType));this.selectedButton=this.buttons[t],this.selectedButton.setSelected()}updateLabels(){this.setAttribute("aria-label",Oi.get("MapType.Tooltip")),wl.forEach((t=>{this.labels[t].element.textContent=Oi.get("Mode."+t),this.buttons[t].updateLabels()}))}didMoveToParent(t){super.didMoveToParent(t),t?wl.forEach((t=>this.buttons[t].activate())):wl.forEach((t=>this.buttons[t].deactivate()))}},kl="data-l10n-key";function Ml(t){this._control=t}Ml.prototype={constructor:Ml,get mapTypes(){return this._control.mapTypes},get mapType(){return this._control.mapType},set mapType(t){this._control.mapType=t}};const Sl="mk-map-type-control",Ll="mk-pressed";class Al extends pl{constructor(t,e,i){super(Co.htmlElement("div",{role:"button",tabindex:"0"})),this.classList.add(Sl),this._delegate=new Ml(this),this._focusDelegate=i;const n=function(){const t=Co.svgElement("path"),e=Co.createSVGIcon(t,{});return e.setAttribute("viewBox","0 0 45 24"),[e,t]}();this.element.appendChild(n[0]),this._iconElement=n[1],this._mapType=e,this._mapTypes=t,this._updateIcon(),this._updateLabels(),this.enabled=!0,this._isOpen=!1}get mapType(){return this._mapType}set mapType(t){t!==this._mapType&&(this._mapType=t,this._updateIcon(),this.popover.updateSelected(),this.dispatchEvent(new T.Event(Al.EVENTS.MAP_TYPE_CHANGE)))}get mapTypes(){return this._mapTypes}localeChanged(t){this._updateLabels(),this.popover.updateLabels()}touchesBegan(t){this._pressed()}touchesEnded(t){this.reset()}clicked(t){this._toggle()}touchesCanceled(t){this.reset()}spaceBarKeyDown(t){this._pressed()}spaceBarKeyUp(t){this.reset(),this._open(!0)}updateTintColor(t){this.tintColor=t,this._iconElement.style.fill=t}reset(){this.classList.remove(Ll),this._focusDelegate.controlWasReleased(this)}handleEvent(t){switch(t.type){case Co.startEventType:{const e=Co.getShadowDOMTargetFromEvent(this.element,t);this.popover.element.contains(e)||this.element.contains(e)||this._close();break}case"keydown":if((t=>t.keyCode===n)(t)){this._close();const t=Co.containingDocumentOrShadowRoot(this.element).activeElement;t&&this.popover.element.contains(t)&&this.element.focus()}break;case"blur":this.popover.element.contains(t.relatedTarget)||this._close()}}didMoveToParent(t){t?(this.popover=new Cl(this._delegate),this.parent.insertAfter(this.popover,this)):(window.removeEventListener(Co.startEventType,this,!0),window.removeEventListener("keydown",this,!0),this.popover.element.removeEventListener("blur",this,!0),this.popover.remove(),this.popover=null)}focused(t){this._focusDelegate.controlDidGetFocus(this)}blurred(t){this._focusDelegate.controlDidLoseFocus(this)}_updateLabels(){Co.updateLabel(this,Oi.get("MapType.Tooltip"))}_toggle(){this._isOpen?this._close():this._open()}_pressed(){this.classList.add(Ll),this._focusDelegate.controlWasPressed(this)}_open(){this._isOpen||(this._isOpen=!0,this.popover.open(),window.addEventListener(Co.startEventType,this,!0),window.addEventListener("keydown",this,!0),this.popover.element.addEventListener("blur",this,!0))}_close(){this._isOpen&&(this._isOpen=!1,this.popover.close(),window.removeEventListener(Co.startEventType,this,!0),window.removeEventListener("keydown",this,!0),this.popover.element.removeEventListener("blur",this,!0))}_handleLocaleChange(){this.children.forEach((function(t){const e=t.element.getAttribute(kl);t.element.textContent=Oi.get(e)}))}_updateIcon(){this._iconElement.setAttribute("d",El[this._mapType])}}Al.EVENTS={MAP_TYPE_CHANGE:"map-type-change"};const El={standard:"M24.597 18.663V8.233L21.53 6.369a1.83 1.83 0 00-.413-.178v10.569l3.136 1.764c.06.03.116.058.171.083a.815.815 0 00.172.057zm-7.548-.178c.17 0 .356-.057.559-.171l2.615-1.416V6.285c-.06.026-.125.055-.197.089-.072.034-.14.07-.203.108l-2.958 1.695c-.199.11-.346.246-.44.41a1.118 1.118 0 00-.144.574v8.544c0 .25.07.442.207.577.137.136.324.203.561.203zm8.436.153a.641.641 0 00.204-.09l3.269-1.853c.203-.114.352-.251.447-.412.095-.161.143-.354.143-.578V7.18c0-.254-.07-.447-.21-.58-.14-.134-.332-.2-.577-.2-.17 0-.358.057-.565.17l-2.71 1.505v10.563z",hybrid:"M22.918 13.579c.13 0 .262-.023.393-.067.131-.044.275-.111.432-.2l4.951-2.875c.267-.157.456-.303.568-.438a.741.741 0 00.168-.49.724.724 0 00-.168-.475c-.112-.136-.301-.282-.568-.438L23.743 5.72a2.539 2.539 0 00-.432-.2 1.22 1.22 0 00-.79 0c-.129.045-.274.111-.435.2l-4.951 2.876c-.267.156-.456.302-.568.438a.724.724 0 00-.168.476c0 .19.056.353.168.489.112.135.301.28.568.438l4.951 2.875c.161.089.306.156.435.2.13.044.261.067.397.067zm0 3.135a.81.81 0 00.343-.076c.11-.05.237-.116.38-.197l5.409-3.192a.775.775 0 00.292-.28.656.656 0 00.095-.33.601.601 0 00-.12-.374.81.81 0 00-.267-.235l-5.847 3.377c-.055.034-.105.06-.152.08a.352.352 0 01-.133.028.366.366 0 01-.14-.029 1.063 1.063 0 01-.152-.08L16.78 12.03a.81.81 0 00-.267.235.601.601 0 00-.12.374c0 .11.032.22.098.33.065.11.164.203.295.28l5.402 3.192c.144.08.27.146.38.197.11.051.227.076.35.076zm0 2.94a.81.81 0 00.343-.077c.11-.05.237-.118.38-.203l5.409-3.186a.825.825 0 00.288-.277.644.644 0 00.099-.34.582.582 0 00-.12-.361.887.887 0 00-.267-.241l-5.847 3.383a2.55 2.55 0 01-.152.076.322.322 0 01-.133.032.335.335 0 01-.14-.032 2.55 2.55 0 01-.152-.076L16.78 14.97a.887.887 0 00-.267.241.582.582 0 00-.12.362c0 .118.032.231.098.34.065.107.164.2.295.275l5.402 3.187c.144.085.27.152.38.203.11.05.227.076.35.076z",satellite:"M22.915 18.923c.888 0 1.725-.169 2.51-.507a6.62 6.62 0 002.079-1.41 6.62 6.62 0 001.41-2.079 6.271 6.271 0 00.507-2.51c0-.889-.17-1.726-.508-2.51a6.583 6.583 0 00-1.41-2.076 6.682 6.682 0 00-2.081-1.41 6.26 6.26 0 00-2.514-.51c-.888 0-1.725.17-2.51.51a6.654 6.654 0 00-3.482 3.485 6.271 6.271 0 00-.508 2.511c0 .889.17 1.725.508 2.51a6.62 6.62 0 001.41 2.08c.6.6 1.293 1.07 2.078 1.409a6.271 6.271 0 002.51.507zm0-.92c-.762 0-1.48-.147-2.155-.441a5.732 5.732 0 01-1.781-1.21 5.687 5.687 0 01-1.206-1.78 5.37 5.37 0 01-.438-2.155c0-.762.146-1.479.438-2.152.209-.48.473-.92.794-1.32l.188-.222-.068.254a4.38 4.38 0 00-.127 1.04c0 .695.23 1.23.689 1.607.459.376 1.114.564 1.964.564.115 0 .196.04.245.121.048.08.041.171-.022.273a2.875 2.875 0 00-.311.584c-.055.157-.083.32-.083.489 0 .283.069.525.206.723.138.2.304.361.499.486a3.2 3.2 0 00.57.295l-.247.997c-.076.296-.039.53.111.704.15.174.348.26.594.26.245 0 .478-.114.698-.342l1.543-1.67c.258-.275.443-.524.555-.749.112-.224.168-.448.168-.672a1.11 1.11 0 00-.11-.426 3.165 3.165 0 00-.664-.958 1.378 1.378 0 00-.594-.337 3.345 3.345 0 00-.784-.076h-.342l-.35-.685.965-.362c.271.178.487.313.648.406.16.093.317.14.47.14.194 0 .347-.06.457-.178a.582.582 0 00.155-.435.742.742 0 00-.225-.485l-.99-1.048c-.064-.063-.096-.124-.096-.18 0-.058.028-.118.083-.182a4.83 4.83 0 00.431-.552c.144-.211.216-.442.216-.692a.813.813 0 00-.084-.357l-.045-.078.183.073c.675.292 1.27.695 1.784 1.21a5.709 5.709 0 011.21 1.78c.291.673.437 1.39.437 2.152a5.37 5.37 0 01-.438 2.155 5.687 5.687 0 01-1.206 1.78 5.732 5.732 0 01-1.78 1.21 5.336 5.336 0 01-2.155.44z"};const xl=Al;function Tl(t,e){if(!e)return this._targetOpacity=t,void(this.opacity=t);t!==this._targetOpacity&&(t!==this.opacity?(this._targetOpacity=t,this._startTime=null,this._startOpacity=this._opacity,ue.scheduleOnNextFrame(this)):this._targetOpacity=t)}function Il(t){if(null==this._startTime&&(this._startTime=t),"function"==typeof this.constructor.prototype.performScheduledUpdate&&this.constructor.prototype.performScheduledUpdate.call(this,t),null===this._targetOpacity)return;if(null==t&&(this.opacity=this._targetOpacity),this._targetOpacity===this.opacity)return this._startTime=null,this._startOpacity=null,void(this._targetOpacity=null);const e=t-this._startTime,i=this._targetOpacity-this._startOpacity,n=Math.abs(i*this._totalDurationMs),o=Math.min(e/n,1),s=Co.easeInOut(o)*i+this._startOpacity;this.opacity=u(s,0,1),ue.scheduleOnNextFrame(this)}const Rl=function(t,e){return t._targetOpacity=null,t._startOpacity=null,t._startTime=null,t._totalDurationMs=e||300,t.setOpacityAnimated=Tl,t.performScheduledUpdate=Il,t},Ol={GlobalFadeDuration:700,InnerTransitionDuration:200,MinimumNumberOfSegments:2,MaximumNumberOfSegments:5,MagicNumbers:[1.25,2.5,5],FirstMagicExponent:-3,LastMagicExponent:7,MaximumNumberOfDisplayedSegments:3,SegmentThickness:3,LegendHorizontalMargin:6,LegendMarginBottom:8,LegendSpacing:1,OutlineWidth:1,LightSegmentColorRegular:"rgba(255, 255, 255, 0.7)",DarkSegmentColorRegular:"rgba(0, 0, 0, 0.73)",OutlineColorRegular:"rgba(255, 255, 255, 0.5)",LightSegmentColorSatellite:"rgba(255, 255, 255, 0.8)",DarkSegmentColorSatellite:"rgba(178, 178, 178, 0.8)",OutlineColorSatellite:"rgba(0, 0, 0, 1)",SegmentInnerStrokeColor:"rgba(0, 0, 0, 0.2)",SegmentInnerStrokeWidth:.5,LegendFontSize:9,LegendFontFamily:"'-apple-system-font', 'Helvetica Neue', 'Helvetica', 'Arial', 'sans-serif'",LegendColorRegular:"rgba(72, 69, 65, 1)",LegendOuterStrokeColorRegular:"rgba(255, 255, 255, 0.5)",LegendColorSatellite:"rgba(255, 255, 255, 1)",LegendOuterStrokeColorSatellite:"rgba(0, 0, 0, 1)",LegendOuterStrokeWidth:1,MetersThreshold:500,FeetThreshold:.25,MilesToMeters:1609.344,MetersToMiles:1/1609.344,MilesToFeet:5280};function Pl(t){Lo.call(this,t)}Pl.prototype=p(Lo,Pl,{measureTextOverflow:function(t,e){const i=this._node;if(!i.legend)return 0;const n=Ol.LegendFontSize*this.node.fontSizeRatio;let o;t.font=`${n}px ${Ol.LegendFontFamily}`,o=e?i.legend.labels[0]:i.legend.labels[i.numberOfSegments];const s=t.measureText(o).width/2;let a;return a=e?0:t.measureText(" "+i.legend.unit).width,s+a},draw:function(t){const e=this._node;if(!e.legend)return;const i=Ol.LegendFontSize*this.node.fontSizeRatio;t.font=`${i}px ${Ol.LegendFontFamily}`,t.textAlign="center",t.textBaseline="bottom",t.lineWidth=Ol.LegendOuterStrokeWidth,t.fillStyle=e.fillColor,t.strokeStyle=e.strokeColor;const n=e.size.height-Ol.LegendMarginBottom-Ol.LegendSpacing;let o=e.segmentStart;for(let i=0;i<=e.numberOfSegments;i++){const s=e.legend.labels[i];t.strokeText(s,o,n),t.fillText(s,o,n),this.node.leftAligned?i===e.numberOfSegments?o+=t.measureText(s).width/2:o+=e.segmentWidth:i===e.numberOfSegments?o-=t.measureText(s).width/2:o-=e.segmentWidth}const s=" "+e.legend.unit;t.textAlign=this.node.leftAligned?"left":"right",t.strokeText(s,o,n),t.fillText(s,o,n)}});const Dl=Pl;function zl(){ln.call(this),this.fontSizeRatio=1,this._legend=null,this._segmentWidth=0,this._segmentStart=0,this._numberOfSegments=0,this._fillColor=null,this._strokeColor=null,this._renderer=new Dl(this)}zl.prototype=p(ln,zl,{get leftAligned(){return this._leftAligned},set leftAligned(t){this._leftAligned=t,this.needsDisplay=!0},get legend(){return this._legend},set legend(t){this._legend=t,this.needsDisplay=!0},get segmentStart(){return this._segmentStart},set segmentStart(t){this._segmentStart=t,this.needsDisplay=!0},get segmentWidth(){return this._segmentWidth},set segmentWidth(t){this._segmentWidth=t,this.needsDisplay=!0},get numberOfSegments(){return this._numberOfSegments},set numberOfSegments(t){this._numberOfSegments=t,this.needsDisplay=!0},get fillColor(){return this._fillColor},set fillColor(t){this._fillColor=t,this.needsDisplay=!0},get strokeColor(){return this._strokeColor},set strokeColor(t){this._strokeColor=t,this.needsDisplay=!0},stringInfo:function(){const t="~"+this.fillColor+"/"+this.strokeColor+"~ ",e=this.leftAligned?"":", rtl";if(!this._legend)return"LegendNode "+t;return"LegendNode<labels:["+this._legend.labels.slice(0,this.numberOfSegments+1).join(", ")+"], unit:"+this._legend.unit+e+")> "+t},measureTextOverflow:function(t,e){return this._renderer.measureTextOverflow(t,e)}});const Nl=zl;function Fl(t){Lo.call(this,t)}Fl.prototype=p(Lo,Fl,{draw:function(t){const e=this._node,i=e.fillColor,n=e.strokeColor,o=e.lineWidth;i&&(t.fillStyle=i,t.fillRect(0,0,e.size.width,e.size.height));n&&o&&(o>=1||Co.devicePixelRatio>1)&&(t.lineWidth=o,t.strokeStyle=n,e.innerStroke?t.strokeRect(o/2,o/2,e.size.width-o,e.size.height-o):t.strokeRect(-o/2,-o/2,e.size.width+o,e.size.height+o))}});const Ul=Fl;function Gl(){ln.call(this),this._fillColor=null,this._strokeColor=null,this._lineWidth=null,this._innerStroke=!1,this._renderer=new Ul(this)}Gl.prototype=p(ln,Gl,{get fillColor(){return this._fillColor},set fillColor(t){this._fillColor=t,this.needsDisplay=!0},get strokeColor(){return this._strokeColor},set strokeColor(t){this._strokeColor=t,this.needsDisplay=!0},get innerStroke(){return this._innerStroke},set innerStroke(t){this._innerStroke=t,this.needsDisplay=!0},get lineWidth(){return this._lineWidth},set lineWidth(t){this._lineWidth=t,this.needsDisplay=!0}});const Bl=Gl;function Zl(){Bl.call(this),Rl(this,Ol.InnerTransitionDuration),this.lineWidth=Ol.OutlineWidth}Zl.prototype=p(Bl,Zl,{stringInfo:function(){return"OutlineNode "+("~"+this.strokeColor+"~ ")}});const Wl=Zl;function Kl(){Bl.call(this),Rl(this,Ol.InnerTransitionDuration),this.lineWidth=Ol.SegmentInnerStrokeWidth,this.innerStroke=!0}Kl.prototype=p(Bl,Kl,{stringInfo:function(){return"SegmentNode "+("~"+this.fillColor+"~ ")}});const Hl=Kl;function jl(){Oo.call(this),this._needsLayout=!1,this._distance=0,this._mapWidth=0,this._theme=jl.Themes.light,this._leftAligned=!1,this._l10n=null,this._segmentWidth=0,this._oldNumberOfSegments=0,this._legend={labels:[],unit:""},this._legendNode=this.addChild(new Nl),this._outlineNodes=[0,1].map((()=>this.addChild(new Wl))),this._activeOutlineNode=this._outlineNodes[0],this._outlineNodes[1].opacity=0,this._segmentNodes=[0,1,2].map((t=>this.addChild(new Hl))),this._updateColors(),Rl(this,Ol.GlobalFadeDuration)}const Vl={light:"Light",dark:"Dark"};jl.prototype=p(Oo,jl,{get layerBounds(){return new Bi(0,0,this.size.width,Math.max(this.size.height,48))},get fontSizeRatio(){return this._legendNode.fontSizeRatio},set fontSizeRatio(t){this._legendNode.fontSizeRatio=t,this._computeSegments()},get distance(){return this._distance},set distance(t){Math.abs(t-this._distance)/this._distance<.01||(this._distance=t,this._computeSegments())},get mapWidth(){return this._mapWidth},set mapWidth(t){t!==this._mapWidth&&(this._mapWidth=t,this._computeSegments())},get theme(){return this._theme},set theme(t){this._theme=t,this._updateColors()},get l10n(){return this._l10n},set l10n(t){this._l10n&&this._l10n.removeEventListener(this._l10n.Events.LocaleChanged,this),this._l10n=t,t&&t.addEventListener(t.Events.LocaleChanged,this)},get useMetric(){return this._useMetric},set useMetric(t){this._useMetric!==t&&(this._useMetric=t,this._computeSegments())},get leftAligned(){return this._leftAligned},set leftAligned(t){this._leftAligned=t,this.needsLayout=!0},stringInfo:function(){return"ScaleNode<distance:"+Math.round(100*this.distance)/100+"m>"},get needsLayout(){return this._needsLayout},set needsLayout(t){this._needsLayout!==t&&(this._needsLayout=t,t&&ue.scheduleASAP(this))},performScheduledUpdate:function(){this.needsLayout&&this.parent&&(this.layoutSubNodes(),this.needsLayout=!1)},layoutSubNodes:function(){const t=this._computeSegmentsRects();for(let e=0;e<Ol.MaximumNumberOfDisplayedSegments;e++){const i=t[e],n=this._segmentNodes[e];i?(n.position=i.origin,n.size=i.size,n.setOpacityAnimated(1,!0)):n.setOpacityAnimated(0,!0)}const e=Bi.unionOfRects(t).round();if(t.length!==this._oldNumberOfSegments){this._activeOutlineNode.setOpacityAnimated(0,!0);const t=0===this._outlineNodes.indexOf(this._activeOutlineNode)?1:0;this._activeOutlineNode=this._outlineNodes[t],this._activeOutlineNode.setOpacityAnimated(1,!0)}this._activeOutlineNode.position=e.origin,this._activeOutlineNode.size=e.size;const i=t[0];this._legendNode.segmentStart=this.leftAligned?i.origin.x:i.origin.x+i.size.width,this._legendNode.leftAligned=this.leftAligned,this._legendNode.segmentWidth=i.size.width,this._legendNode.size.width=this.size.width,this._legendNode.size.height=this.size.height,this._oldNumberOfSegments=t.length},handleEvent:function(t){this._computeSegments()},_updateColors:function(t){const e=this.theme===jl.Themes.dark;this._legendNode.fillColor=e?Ol.LegendColorSatellite:Ol.LegendColorRegular,this._legendNode.strokeColor=e?Ol.LegendOuterStrokeColorSatellite:Ol.LegendOuterStrokeColorRegular;const i=e?[Ol.LightSegmentColorSatellite,Ol.DarkSegmentColorSatellite]:[Ol.DarkSegmentColorRegular,Ol.LightSegmentColorRegular];this._segmentNodes.forEach((function(t,n){t.fillColor=i[n%2],t.strokeColor=e?null:Ol.SegmentInnerStrokeColor}),this);const n=e?Ol.OutlineColorSatellite:Ol.OutlineColorRegular;this._outlineNodes.forEach((t=>{t.strokeColor=n}))},_computeSegments:function(){if(0===this.size.width||0===this.mapWidth||!this._l10n)return;const t=this.size.width,e=this.mapWidth;let i=this.distance*t/e;const n=!this._useMetric;let o,s=!1,a=1;function r(t,e){return o=t*Math.pow(10,e),a=i/o,a>=Ol.MinimumNumberOfSegments&&a<Ol.MaximumNumberOfSegments}n&&(i*=Ol.MetersToMiles,i<Ol.FeetThreshold&&(s=!0,i*=Ol.MilesToFeet));let l=!1;for(let t=Ol.FirstMagicExponent;!l&&t<Ol.LastMagicExponent;t++)l=Ol.MagicNumbers.some((e=>r(e,t)));this._segmentWidth=a?t/a:0;const h=o;n&&(s&&(o/=Ol.MilesToFeet),o*=Ol.MilesToMeters),this._computeLegend(o,h,s)},_computeLegend:function(t,e,i){let n=0;this._useMetric?t>Ol.MetersThreshold?(this._legend.unit=this._l10n.get("Scale.Kilometer.Short"),n=t/1e3):(this._legend.unit=this._l10n.get("Scale.Meter.Short"),n=t):(this._legend.unit=i?this._l10n.get("Scale.Feet.Short"):this._l10n.get("Scale.Mile.Short"),n=e);const o=[];let s;"object"==typeof Intl&&Intl&&Intl.NumberFormat&&(s=new Intl.NumberFormat(this._l10n.activeLocale.localeId));for(let t=0;t<Ol.MaximumNumberOfSegments;t++){const e=t*n,i=s?s.format(e):e.toString();o.push(i)}this._legend.labels=o,this._legendNode.legend=this._legend,this.needsLayout=!0},_computeSegmentsRects:function(){const t=this.scene.contextForMeasurement;let e=0,i=this.leftAligned?Ol.LegendHorizontalMargin+this._legendNode.measureTextOverflow(t,!0):this.size.width-Ol.LegendHorizontalMargin-this._legendNode.measureTextOverflow(t,!0);const n=this.size.height-Ol.LegendMarginBottom+Ol.LegendSpacing,o=this._segmentWidth,s=[];for(let a=0;a<Ol.MaximumNumberOfDisplayedSegments;a++){const a=new Bi(this.leftAligned?i:i-o,n,o,Ol.SegmentThickness).round();s.push(a),i=this.leftAligned?a.origin.x+a.size.width:a.origin.x,this._legendNode.numberOfSegments=s.length,e=this._legendNode.measureTextOverflow(t);const r=o+e+Ol.LegendHorizontalMargin;if(this.leftAligned&&i+r>this.size.width)break;if(!this.leftAligned&&i-r<0)break}return 0===this._oldNumberOfSegments&&(this._oldNumberOfSegments=s.length),s}}),jl.Themes=Vl,jl.ScaleNode=jl;const ql=jl,Yl=new Ui(170,20),Xl="mk-scale";const $l=class extends qn{constructor(t){const e=new Io;super(e.element),this.scene=e,this._map=t;const i=Yl.copy();i.height=this._getHeight(),this.scene.size=i,this.node=this.scene.addChild(new ql),this.node.size=i,this.node.position=new Gi(0,0),this.node.opacity=0,this.node.l10n=Oi,this.node.fontSizeRatio=t.fontSizeRatio,this.node.useMetric=t.useMetric,Oi.addEventListener(Oi.Events.LocaleChanged,this),this.classList.add(Xl),this.element.setAttribute("aria-hidden","true"),this.size=Yl}get shouldDisplayScale(){return this._map._showsScale===En.Visible||this._map._showsScale===En.Adaptive&&this._map.cameraIsZooming}updateTheme(t){this.node.theme=Vl[t]}update(){const t=this._map;if(!this.node||!this.shouldDisplayScale)return;const e=t.renderingMapRect.origin.toCoordinate().latitude,i=t.renderingMapRect.size.width/hi.mapUnitsPerMeterAtLatitude(e);if(i/t._visibleFrame.size.width*Co.devicePixelRatio>=7500)return void this.hideIfNeeded(!0);const n=this._getHeight();if(n!==this.node.size.height){const t=Yl.copy();t.height=n,this.scene.size=t,this.node.size=t}this.node.fontSizeRatio=t.fontSizeRatio,this.node.distance=i,this.node.useMetric=this._map.useMetric,this.node.setOpacityAnimated(1,!1)}hideIfNeeded(t){!this.node||this.shouldDisplayScale&&!t||this.node.setOpacityAnimated(0,!0)}handleEvent(t){this.node.useMetric=this._map.useMetric}mapWasDestroyed(){this.node.l10n=null,this.node.remove(),this.scene.destroy(),Oi.removeEventListener(Oi.Events.LocaleChanged,this)}_getHeight(){const t=Ol.LegendFontSize*this._map.fontSizeRatio;return Yl.height-Ol.LegendFontSize+t}},Jl="mk-zoom-controls",Ql="mk-divider",th="mk-zoom-in",eh="mk-zoom-out",ih="mk-pressed",nh="mk-pill-pressed",oh="mk-disabled";class sh extends pl{constructor(){const t=Co.htmlElement("div");super(t),this.classList.add(Jl),this._zoomInEnabled=!0,this._zoomOutEnabled=!0,this._zoomInButton=Co.htmlElement("div",{role:"button",tabindex:"0"}),this._zoomInButtonNode=new so.Node(this._zoomInButton),this._zoomInButtonNode.classList.add(th),this._zoomInButton.appendChild(function(){const t=Co.svgElement("path",{d:"M11.813 17.404c.4 0 .724-.33.724-.705v-3.974h3.872a.726.726 0 00.717-.723.73.73 0 00-.717-.724h-3.872V7.305a.72.72 0 00-.724-.705.724.724 0 00-.724.705v3.973H7.217a.739.739 0 00-.717.724c0 .4.343.723.717.723h3.872V16.7c0 .375.33.705.724.705z"}),e=Co.createSVGIcon(t,{width:"100%",height:"100%"});return e.setAttribute("viewBox","0 0 24 24"),e}()),t.appendChild(this._zoomInButton),t.appendChild(Co.htmlElement("div",{class:Ql})),this._zoomOutButton=Co.htmlElement("div",{role:"button",tabindex:"0"}),this._zoomOutButtonNode=new so.Node(this._zoomOutButton),this._zoomOutButtonNode.classList.add(eh),this._zoomOutButton.appendChild(function(){const t=Co.svgElement("path",{d:"M16.325 12.75c.364 0 .675-.336.675-.75 0-.408-.31-.75-.675-.75h-8.65c-.352 0-.675.342-.675.75 0 .414.323.75.675.75h8.65z"}),e=Co.createSVGIcon(t,{width:"100%",height:"100%"});return e.setAttribute("viewBox","0 0 24 24"),e}()),t.appendChild(this._zoomOutButton),this._updateLabels()}get zoomInEnabled(){return this._zoomInEnabled}set zoomInEnabled(t){this._enabled&&t===this._zoomInEnabled||(this._zoomInEnabled=this._enabled&&t,ah(this._zoomInButtonNode,this._zoomInEnabled))}get zoomOutEnabled(){return this._zoomOutEnabled}set zoomOutEnabled(t){this._enabled&&t===this._zoomOutEnabled||(this._zoomOutEnabled=this._enabled&&t,ah(this._zoomOutButtonNode,this._zoomOutEnabled))}localeChanged(t){this._updateLabels()}touchesBegan(t){this._pressed(t)}touchesEnded(t){this.saveEndEventProps(t),this.reset(t)}clicked(t){this.checkClickEventProps(t)||(this._pressed(t),this.reset(t))}touchesCanceled(t){this.reset(t)}focused(t){this.updateTintColor(this.tintColor),t.target.style.fill=Co.focusColor}blurred(t){this.updateTintColor(this.tintColor)}spaceBarKeyDown(t){this._pressed(t)}spaceBarKeyUp(t){this.reset(t)}updateTintColor(t){this.tintColor=t,this._zoomInButton.firstChild.style.fill=t,this._zoomOutButton.firstChild.style.fill=t}reset(t){let e;if(this._zoomInButtonNode.classList.contains(ih)?e=this._zoomInButtonNode:this._zoomOutButtonNode.classList.contains(ih)&&(e=this._zoomOutButtonNode),e){e.classList.remove(ih),this.classList.remove(nh);const t=new T.Event(sh.EVENTS.ZOOM_END);this.dispatchEvent(t)}window.removeEventListener(Co.endEventType,this),Co.supportsPointerEvents?window.removeEventListener("pointercancel",this):Co.supportsTouches&&window.removeEventListener("touchcancel",this)}_clearLabels(t){Co.updateLabel(this._zoomInButtonNode,""),Co.updateLabel(this._zoomOutButtonNode,"")}_updateLabels(t){Co.updateLabel(this._zoomInButtonNode,Oi.get("Zoom.In.Tooltip")),Co.updateLabel(this._zoomOutButtonNode,Oi.get("Zoom.Out.Tooltip"))}_pressed(t){const e=this._findButtonNodeFromButtonDOMElement(Co.parentNodeForSvgTarget(t.target));if(!e||e.classList.contains(oh))return;if(this.hasFocus){const t=Co.containingDocumentOrShadowRoot(this.element).activeElement;t!==e.element&&t.blur()}e.classList.add(ih),this.classList.add(nh);const i=new T.Event(sh.EVENTS.ZOOM_START);i.zoomIn=e===this._zoomInButtonNode,this.dispatchEvent(i)}_findButtonNodeFromButtonDOMElement(t){return t===this._zoomOutButton?this._zoomOutButtonNode:t===this._zoomInButton?this._zoomInButtonNode:null}}function ah(t,e){e?(t.classList.remove(oh),t.removeAttribute("aria-disabled"),t.setAttribute("tabindex",0)):(t.classList.add(oh),t.setAttribute("aria-disabled","true"),t.setAttribute("tabindex",-1))}sh.EVENTS={ZOOM_START:"zoom-start",ZOOM_END:"zoom-end"};const rh=sh;const lh={POP_OVER:"mk-user-location-error-popover",ERROR:"mk-error-message",ERROR_TEXT:"mk-error-text",ERROR_SUPPORT:"mk-error-support"},hh=class extends gl{constructor(){super(),this.classList.add(lh.POP_OVER),this._errorMessageElement=this._createErrorMessageElement(),this._errorMessageNode=new qn(this._errorMessageElement),this.update(),this.addChild(this._errorMessageNode)}get errorMessageElement(){return this._errorMessageElement}update(){this._errorMessageElement.getElementsByClassName(lh.ERROR_TEXT)[0].textContent=Oi.get("Location.Error.Message")+" ",this._supportLink.textContent=Oi.get("Location.Error.Support.Label"),Co.supportsTouches?this._supportLink.href="https://support.apple.com/HT203033":this._supportLink.href="https://support.apple.com/guide/mac-help/allow-apps-to-detect-the-location-of-your-mac-mh35873/mac"}_createErrorMessageElement(){const t=Co.htmlElement("div",{class:lh.ERROR});return this._supportLink=Co.htmlElement("a",{class:lh.ERROR_SUPPORT,target:"_blank"}),t.appendChild(Co.htmlElement("span",{class:lh.ERROR_TEXT})),t.appendChild(this._supportLink),t}},ch={CONTROL:"mk-user-location-control",WRAPPER:"mk-user-location-control-wrapper",PRESSED:"mk-pressed",TRACKING:"mk-tracking",WAITING:"mk-waiting",DISABLED:"mk-disabled",WAITING_ICON:"mk-icon-waiting",ARROW_ICON:"mk-icon-arrow",SCALED_OUT:"mk-scaled-out"};class dh extends pl{constructor(t,e,i){super(Co.htmlElement("div",{class:ch.CONTROL,role:"button",tabindex:"0"})),this._state=dh.States.Default,this._tintColor="",this._wrapper=Co.htmlElement("div",{class:ch.WRAPPER}),this.element.appendChild(this._wrapper),this._arrowIconNode=new so.Node(Co.createSVGIcon(Co.svgElement("path"),{class:ch.ARROW_ICON,viewBox:ph})),this._waitingIconNode=new so.Node(function(){const t=[];for(let e=0;e<8;++e)t.push(Co.svgElement("rect",{x:-1.25,y:5,width:2.5,height:6,rx:1.25,transform:"rotate("+45*e+")"}));const e=["g",{transform:"scale(0.6666666666666666, -0.6666666666666666)"}].concat(t);return Co.createSVGIcon(Co.svgElement.apply(null,e),{class:[ch.WAITING_ICON,ch.SCALED_OUT].join(" "),viewBox:mh})}()),this._wrapper.appendChild(this._arrowIconNode.element),this._wrapper.appendChild(this._waitingIconNode.element),this._errorPopover=new hh,this._updateLabels(),this._updateArrowIcon(),this._waitingIconBlades=this._waitingIconNode.element.querySelectorAll("rect"),this._map=t,this._rtl=e,this._focusDelegate=i}get state(){return this._state}set state(t){this._state!==t&&(this._state=t,this.classList.toggle(ch.TRACKING,this.isTrackingState()),this.classList.toggle(ch.WAITING,this.isWaitingState()),this.classList.toggle(ch.DISABLED,this.isDisabledState()),this.updateTintColor(this._tintColor),this.isWaitingState()?this._animateArrowIconOut():this._animateWaitingIconOut())}isDefaultState(){return this.state===dh.States.Default}toDefaultState(){this.state=dh.States.Default,this._updateArrowIcon(),this._closeErrorPopover()}isTrackingState(){return this.state===dh.States.Tracking}toTrackingState(){this.state=dh.States.Tracking,this._updateArrowIcon(),this._closeErrorPopover()}isWaitingState(){return this.state===dh.States.Waiting}toWaitingState(){this.state=dh.States.Waiting}isDisabledState(){return this.state===dh.States.Disabled}toDisabledState(){this._map.tracksUserLocation&&this._map.userLocationAnnotation||(this.state=dh.States.Disabled,this._updateArrowIcon(),this._openErrorPopover())}handleEvent(t){switch(t.type){case Co.startEventType:{const e=Co.getShadowDOMTargetFromEvent(this.element,t);this._errorPopover.errorMessageElement.contains(e)||(this._closeErrorPopover(),window.removeEventListener(Co.startEventType,this,!0));break}case"keydown":27===t.keyCode&&this._closeErrorPopover();break;case"blur":this._errorPopover.element.contains(t.relatedTarget)||this._closeErrorPopover()}}touchesBegan(t){this._pressed(t)}touchesEnded(){this.reset()}clicked(){this.dispatchEvent(new T.Event(dh.EVENTS.PRESSED))}touchesCanceled(t){this.reset()}spaceBarKeyDown(t){this._pressed(t)}spaceBarKeyUp(t){this.reset(t),this.dispatchEvent(new T.Event(dh.EVENTS.PRESSED))}updateTintColor(t){this._tintColor=t,this._arrowIconNode.element.querySelector("g").style.fill=this.isTrackingState()?"":t,this._waitingIconNode.element.querySelector("g").style.fill=t,this.element.style.backgroundColor=this.isTrackingState()?t:""}reset(){this.classList.contains(ch.PRESSED)&&(this.classList.remove(ch.PRESSED),this._focusDelegate.controlWasReleased(this),this.isDefaultState()||this.isDisabledState()?this.toWaitingState():this.toDefaultState()),delete this._mousedown,window.removeEventListener(Co.endEventType,this),Co.supportsPointerEvents?window.removeEventListener("pointercancel",this):Co.supportsTouches&&window.removeEventListener("touchcancel",this)}localeChanged(t){this._updateLabels(),this._rtl=t.locale.rtl,this._errorPopover.update()}mapWasDestroyed(){delete this._map}focused(t){this._focusDelegate.controlDidGetFocus(this)}blurred(t){this._focusDelegate.controlDidLoseFocus(this)}didMoveToParent(t){t?this.parent.insertAfter(this._errorPopover,this):(this._closeErrorPopover(),this._errorPopover.remove())}_updateLabels(){Co.updateLabel(this.element,Oi.get("Track.User.Location.Tooltip"))}_pressed(t){this.classList.add(ch.PRESSED),this._focusDelegate.controlWasPressed(this)}_animateArrowIconOut(){this._arrowIconNode.classList.add(ch.SCALED_OUT),this._waitingIconNode.classList.remove(ch.SCALED_OUT)}_animateWaitingIconOut(){this._waitingIconNode.classList.add(ch.SCALED_OUT),this._arrowIconNode.classList.remove(ch.SCALED_OUT)}_openErrorPopover(){this._errorPopover.open(),window.addEventListener(Co.startEventType,this,!0),window.addEventListener("keydown",this,!0),this._errorPopover.element.addEventListener("blur",this,!0)}_closeErrorPopover(){this._errorPopover.close(),window.removeEventListener(Co.startEventType,this,!0),window.removeEventListener("keydown",this,!0),this._errorPopover.element.removeEventListener("blur",this,!0)}_updateArrowIcon(){this._arrowIconNode.element.querySelector("path").setAttribute("d",uh[this.state])}}dh.States={Default:"default",Waiting:"waiting",Tracking:"tracking",Disabled:"disabled"},dh.EVENTS={PRESSED:"pressed"};const uh={default:"M24.675 17.91L29.48 7.512c.514-1.11-.349-1.847-1.409-1.358l-10.448 4.818c-.971.444-.768 1.802.342 1.809l4.723.019c.095 0 .127.038.127.133l.013 4.691c0 1.092 1.365 1.34 1.847.286zm-.711-1.448l.025-4.272c0-.387-.184-.577-.584-.577l-4.272.025c-.05 0-.07-.057-.012-.089l8.95-4.094c.076-.032.12.013.082.089l-4.1 8.925c-.025.063-.089.05-.089-.007z",disabled:"M27.112 12.641l2.368-5.129c.514-1.11-.349-1.847-1.409-1.358l-5.097 2.348.882.883 4.215-1.93c.076-.032.12.013.082.089l-1.93 4.208.89.89zm2.4 4.196a.51.51 0 000-.717l-9.934-9.934a.517.517 0 00-.724 0 .522.522 0 000 .717l9.947 9.934c.197.197.52.197.71 0zm-4.837 1.073l1.301-2.812-.882-.883-1.041 2.254c-.025.063-.089.05-.089-.007l.02-3.351-1.493-1.492-3.358.02c-.05 0-.07-.058-.012-.09l2.266-1.034-.876-.876-2.888 1.333c-.971.444-.768 1.802.342 1.809l4.723.019c.095 0 .127.038.127.133l.013 4.691c0 1.092 1.365 1.34 1.847.286z",tracking:"M24.675 17.91L29.48 7.512c.514-1.11-.349-1.847-1.409-1.358l-10.448 4.818c-.971.444-.768 1.802.342 1.809l4.723.019c.095 0 .127.038.127.133l.013 4.691c0 1.092 1.365 1.34 1.847.286z"},ph="0 0 45 24",mh="-22.5 -12 45 24";const gh=dh,_h="mk-rotation-control",fh="mk-pressed",yh="mk-heading",vh="mk-rotation-wrapper",wh="mk-rotation-slider";function bh(t,e,i,n){let o;const s=e-n,a=t-i;return o=t>i?e<n?90+Ch(Math.atan(s/a)):180-Ch(Math.atan(a/s)):e<n?360-Ch(Math.atan(a/s)):0!==a?270+Ch(Math.atan(s/a)):180,o}function Ch(t){return 180*t/Math.PI}function kh(t){const e=fe.createImageUrl("icons/compass-sheet.svg");t.crossOrigin=Hs.getCorsAttribute(kt.distUrlWithCredentials),t.src=e}const Mh=class extends pl{constructor(t){const e=Co.htmlElement("div");super(e),this.element=e,this._isDragging=!1,this._isDraggingPrevented=!1,this.classList.add(_h);const i=Co.htmlElement("input",{class:wh,type:"range",min:0,max:360,value:0,"aria-label":Oi.get("Compass.Degrees.Plural",{n:0})});i.addEventListener("change",this),this._slider=i,this._sliderNode=new so.Node(i),this.element.appendChild(i),this._compassNode=new so.Node(Co.htmlElement("div",{class:vh},Co.htmlElement("img",{role:"presentation"}))),this.element.appendChild(this._compassNode.element);const n=Co.htmlElement("div");if(this._heading=n,this._headingNode=new so.Node(n),this._headingNode.classList.add(yh),this.element.appendChild(n),kt.state===kt.States.UNINITIALIZED){const t=()=>{kt.removeEventListener(kt.Events.Initialized,t),kh(this._compassNode.element.firstChild)};kt.addEventListener(kt.Events.Initialized,t)}else kh(this._compassNode.element.firstChild);this._map=t,this._rotation=0,this._activeKeyRightAt=null,this._activeKeyLeftAt=null,this._updateLabels()}enable(){pl.prototype.enable.call(this),this._setupGestureRecognizers(),this._sliderNode.removeAttribute("aria-disabled"),this._sliderNode.setAttribute("tabindex",0)}disable(){pl.prototype.disable.call(this),this._sliderNode.setAttribute("aria-disabled","true"),this._sliderNode.setAttribute("tabindex",-1)}set rotation(t){t===this._rotation||360===this._rotation&&0===t||(this._rotation=t,this._updateHeading(),this._updateSlider(),this._rotateTo(t))}localeChanged(t){this._updateLabels()}mapWasDestroyed(){delete this._map}updateTintColor(t){this.tintColor!==t&&(this.tintColor=t,this._heading.style.color=t)}updateImage(t,e){this._dprValue===t&&this._darkColorScheme===e||(this._dprValue=t,this._darkColorScheme=e,kt.state!==kt.States.UNINITIALIZED&&kh(this._compassNode.element))}touchesEnded(t){this.saveEndEventProps(t)}clicked(t){this.checkClickEventProps(t)||this.reset(t)}reset(t){const e=t&&(t.target===this._tapRecognizer||"click"===t.type||t.keyCode===a||t.keyCode===o);this._map&&this._center&&!e&&this._isDragging&&(this._map.mapDidStopRotating(),this._map.compassRotationDidEnd()),this.classList.remove(fh),e&&this._map.setRotationAnimated(0,!0),this._isDragging=!1,this._isDraggingPrevented=!1,delete this._angleOffset}spaceBarKeyDown(t){this.reset(t)}upArrowKeyUp(t){this.reset(t)}rightArrowKeyDown(t){this._beginKeyboardRotate(t)}rightArrowKeyUp(t){this._endKeyboardRotate(t)}leftArrowKeyDown(t){this._beginKeyboardRotate(t)}leftArrowKeyUp(t){this._endKeyboardRotate(t)}performScheduledUpdate(){if(!this._activeKeyRightAt&&!this._activeKeyLeftAt)return!1;this._keyboardRotate(),ue.scheduleOnNextFrame(this)}handleEvent(t){switch(t.target){case this._tapRecognizer:t.target.state===po.Recognized&&this.reset(t);break;case this._panRecognizer:t.target.state===po.Possible?this._beginDrag(t):t.target.state===po.Changed?this._drag(t):t.target.state!==po.Recognized&&t.target.state!==po.Failed||this.reset(t);break;case this._slider:this._handleSliderChange(t)}}fadeIn(){this.element.style.opacity=1}fadeOut(){this.element.style.opacity=0}_updateHeading(){const t=360-this._rotation,e=Math.round(t/360*4)%4;this._heading.textContent=Oi.get("Compass."+["NorthIndicator","EastIndicator","SouthIndicator","WestIndicator"][e])}_updateLabels(){this._updateHeading(),Co.updateLabel(this.element,Oi.get("Compass.Tooltip"))}_rotateTo(t){this._compassNode.transform="rotate("+t+"deg)"}_setupGestureRecognizers(){const t=new ts;t.numberOfTapsRequired=1,t.addEventListener("statechange",this),t.target=this.element,this._tapRecognizer=t;const e=new Us;e.addEventListener("statechange",this),e.target=this.element,this._panRecognizer=e}removeEventListeners(){this._tapRecognizer.removeEventListener("statechange",this),this._tapRecognizer.enabled=!1,this._tapRecognizer.target=null,this._panRecognizer.removeEventListener("statechange",this),this._panRecognizer.enabled=!1,this._panRecognizer.target=null,this._slider.removeEventListener("change",this)}_beginDrag(t){this.classList.add(fh);const e=this.element.getBoundingClientRect();this._center={x:e.right-e.width/2,y:e.bottom-e.height/2};const i=bh(t.target.locationInClient().x,t.target.locationInClient().y,this._center.x,this._center.y);this._angleOffset=i-this._map.rotation}_drag(t){if(!this._center||isNaN(this._angleOffset))return;if(this._isDraggingPrevented)return;if(!this._isDragging){if(!this._map.mapCanStartRotating())return void(this._isDraggingPrevented=!0);this._isDragging=!0}this._map.compassRotationWillStart(!0);let e=bh(t.target.locationInClient().x,t.target.locationInClient().y,this._center.x,this._center.y)-this._angleOffset;e=this._map.compassRotate(e,!0),this._rotateTo(e)}_beginKeyboardRotate(t){const e=this._activeKeyRightAt&&t.keyCode===r,i=this._activeKeyLeftAt&&t.keyCode===s;if(e||i)return;const n=Date.now();t.keyCode===r?this._activeKeyRightAt=n:this._activeKeyLeftAt=n,this._map.mapCanStartRotating()&&(this._timeAtLastFrame=n,ue.scheduleASAP(this),this._map.compassRotationWillStart(!1))}_keyboardRotate(){const t=Math.max(this._activeKeyRightAt||0,this._activeKeyLeftAt||0);if(!t||!this._timeAtLastFrame)return;const e=Date.now();let i=this._rotation;const n=e-this._timeAtLastFrame;i+=(4*(t===this._activeKeyLeftAt)?-1:1)*(60*n)/1e3,this._map.compassRotate(i,!1),this._timeAtLastFrame=Date.now()}_endKeyboardRotate(t){t.keyCode===r?this._activeKeyRightAt=null:this._activeKeyLeftAt=null,this._activeKeyRightAt||this._activeKeyLeftAt||(this._timeAtLastFrame=null),this._map.mapDidStopRotating(),this._map.compassRotationDidEnd()}_handleSliderChange(t){const e=parseInt(t.target.value);if(e===this._rotation)return;let i=e;0===e?i=360:360===e&&(i=0),this.rotation=i,this._map.setRotationAnimated(i,!1,!0)}_updateSlider(){const t=Math.round(this._rotation);this._slider.value=t;const e=Oi.get(1===t?"Compass.Degrees.Single":"Compass.Degrees.Plural",{n:t});this._sliderNode.setAttribute("aria-label",e)}},Sh=En,Lh=["ca-ES","en-GB","en-US","es-ES","es-MX","hi-IN","id-ID","ja-JP","ko-KR","ms-MY","nb-NO","pt-BR","pt-PT","ro-RO","zh-CN","zh-HK","zh-TW"],Ah="mk-rtl",Eh="mk-autonavi",xh="mk-controls-container-controls-normal",Th="mk-controls-container-controls-larger",Ih="mk-text-zoom",Rh=["mk-top-right-controls-container-children-none","mk-top-right-controls-container-children-one","mk-top-right-controls-container-children-two"],Oh="mk-with-zoom-control",Ph="mk-pill-focus",Dh="mk-pill-pressed",zh=new Gi(7,11);class Nh extends qn{constructor(t){super(Co.htmlElement("div",{class:"mk-controls-container"})),this._rtl=!1,this._map=t,this._topRightControlsNode=new qn(Co.htmlElement("div",{class:this._getTopRightControlsClass()})),this._bottomRightControlsNode=new qn(Co.htmlElement("div",{class:"mk-bottom-right-controls-container"})),this._bottomLeftControlsNode=new qn(Co.htmlElement("div",{class:"mk-bottom-left-controls-container"})),this._setPendingControls(),this._shadowRootNode=Co.addShadowRootChild(this,kt.shadowDOMMode,'@media (inverted-colors){:host(.mk-controls) img,:host(.mk-controls-container) img{filter:initial}}:host(.mk-controls-container) *{box-sizing:content-box}:host(.mk-controls-container) ::selection{background:0 0}.mk-error-message{font-family:"-apple-system-font","Helvetica Neue",Helvetica,Arial,sans-serif;font-size:calc(100% * 13 / var(--font-size-default));width:200px;padding:10px;pointer-events:auto}.mk-error-support{white-space:nowrap}:host(.mk-controls) :focus,:host(.mk-controls-container) :focus{outline:0}.mk-logo-control .mk-logo{vertical-align:bottom;width:auto}:host(.mk-controls-container) .mk-bottom-left-controls-container{--logo-width:101px;--logo-height:24px;--logo-xmin:0;--logo-xmax:1;font:16px sans-serif;--font-size-default:16}:host(.mk-controls-container.mk-text-zoom) .mk-bottom-left-controls-container{font:initial}@supports (font:-apple-system-body) and (-webkit-touch-callout:default){:host(.mk-controls-container.mk-text-zoom) .mk-bottom-left-controls-container{font:-apple-system-body;--font-size-default:17}}:host(.mk-controls-container) .mk-bottom-left-controls-container.mk-controls-container-controls-larger{--logo-width:126.25px;--logo-height:30px}:host(.mk-controls-container) .mk-bottom-left-controls-container.mk-autonavi{--logo-width:68px;--logo-height:45px}:host(.mk-controls-container) .mk-bottom-left-controls-container.mk-autonavi.mk-controls-container-controls-larger{--logo-width:85px;--logo-height:56.25px}:host(.mk-controls-container) div.mk-logo-control img.mk-logo{width:var(--logo-width);height:var(--logo-height);margin:0;transition:width .3s ease-in-out,height .3s ease-in-out}.mk-legal{height:calc(1em * 16 / var(--font-size-default));padding:0 6px;margin:2px 4px;border-radius:5px;pointer-events:auto;z-index:1;text-align:center;vertical-align:middle;line-height:calc(100% * 12 / var(--font-size-default));cursor:pointer;transition:left .3s ease-in-out}.mk-legal .mk-legal-label{display:inline-block;font-size:calc(100% * 9 / var(--font-size-default));font-family:"-apple-system-font","Helvetica Neue",Helvetica,Arial,sans-serif;font-weight:500;text-decoration:underline;white-space:nowrap}:host(.mk-controls-container) .mk-bottom-right-controls-container{font:16px sans-serif;--font-size-default:16}:host(.mk-controls-container.mk-text-zoom) .mk-bottom-right-controls-container{font:initial}@supports (font:-apple-system-body) and (-webkit-touch-callout:default){:host(.mk-controls-container.mk-text-zoom) .mk-bottom-right-controls-container{font:-apple-system-body;--font-size-default:17}}.mk-zoom-controls{width:48px;height:24px;border-radius:25%/50%;pointer-events:auto;transition:width .3s ease-in-out,height .3s ease-in-out}.mk-controls-container-controls-larger .mk-zoom-controls{width:60px;height:30px}.mk-zoom-controls .mk-zoom-in .mk-icon,.mk-zoom-controls .mk-zoom-out .mk-icon{pointer-events:none;display:block;opacity:.55}.mk-zoom-controls .mk-zoom-in.mk-pressed .mk-icon,.mk-zoom-controls .mk-zoom-in:focus .mk-icon,.mk-zoom-controls .mk-zoom-out.mk-pressed .mk-icon,.mk-zoom-controls .mk-zoom-out:focus .mk-icon{opacity:.85}@media not all and (hover:none){.mk-zoom-controls .mk-zoom-in:hover .mk-icon,.mk-zoom-controls .mk-zoom-out:hover .mk-icon{opacity:.85}}.mk-zoom-controls .mk-zoom-in.mk-disabled .mk-icon,.mk-zoom-controls .mk-zoom-out.mk-disabled .mk-icon{opacity:.2}.mk-zoom-controls .mk-zoom-in,.mk-zoom-controls .mk-zoom-out{position:absolute;z-index:2;width:50%;height:100%;cursor:pointer}.mk-zoom-controls .mk-divider{position:absolute;left:calc(50% - 1px);width:2px;height:100%;box-sizing:border-box;z-index:100}:host(.mk-controls-container) .mk-top-left-controls-container{font:16px sans-serif;--font-size-default:16}:host(.mk-controls-container.mk-text-zoom) .mk-top-left-controls-container{font:initial}@supports (font:-apple-system-body) and (-webkit-touch-callout:default){:host(.mk-controls-container.mk-text-zoom) .mk-top-left-controls-container{font:-apple-system-body;--font-size-default:17}}.mk-top-right-controls-container{position:relative;width:0;height:24px;transition:width .3s ease-in-out,height .3s ease-in-out}:host(.mk-controls-container) .mk-top-right-controls-container{font:16px sans-serif;--font-size-default:16}:host(.mk-controls-container.mk-text-zoom) .mk-top-right-controls-container{font:initial}@supports (font:-apple-system-body) and (-webkit-touch-callout:default){:host(.mk-controls-container.mk-text-zoom) .mk-top-right-controls-container{font:-apple-system-body;--font-size-default:17}}.mk-controls-container-controls-larger.mk-top-right-controls-container{height:30px}.mk-top-right-controls-container-children-one{width:45px;border-radius:20%/37.5%}.mk-controls-container-controls-larger.mk-top-right-controls-container-children-one{width:56.25px}.mk-top-right-controls-container-children-two{width:90px;border-radius:10%/37.5%}.mk-controls-container-controls-larger.mk-top-right-controls-container-children-two{width:112.5px}:host(.mk-controls-container) .mk-map-type-control,:host(.mk-controls-container) .mk-user-location-control{display:inline-block;position:absolute;width:45px;height:24px;cursor:pointer;pointer-events:auto;transition:width .3s ease-in-out,height .3s ease-in-out}:host(.mk-controls-container) .mk-user-location-control{left:0}:host(.mk-controls-container.mk-rtl) .mk-user-location-control{left:auto;right:0}:host(.mk-controls-container) .mk-map-type-control{right:0}:host(.mk-controls-container.mk-rtl) .mk-map-type-control{left:0;right:auto}:host(.mk-controls-container) .mk-controls-container-controls-larger .mk-map-type-control,:host(.mk-controls-container) .mk-controls-container-controls-larger .mk-user-location-control{width:56.25px;height:30px}:host(.mk-controls-container) .mk-user-location-control .mk-icon{position:absolute;left:0;height:100%;width:100%;display:block;transition:transform .2s ease-in-out}:host(.mk-controls-container) .mk-user-location-control .mk-scaled-out{transform:scale(0)}:host(.mk-controls-container) .mk-user-location-control .mk-icon.mk-icon-waiting rect{animation:.8s infinite mk-spinner}:host(.mk-controls-container) .mk-user-location-control .mk-icon.mk-icon-waiting rect:nth-child(2){animation-delay:-.1s}:host(.mk-controls-container) .mk-user-location-control .mk-icon.mk-icon-waiting rect:nth-child(3){animation-delay:-.2s}:host(.mk-controls-container) .mk-user-location-control .mk-icon.mk-icon-waiting rect:nth-child(4){animation-delay:-.3s}:host(.mk-controls-container) .mk-user-location-control .mk-icon.mk-icon-waiting rect:nth-child(5){animation-delay:-.4s}:host(.mk-controls-container) .mk-user-location-control .mk-icon.mk-icon-waiting rect:nth-child(6){animation-delay:-.5s}:host(.mk-controls-container) .mk-user-location-control .mk-icon.mk-icon-waiting rect:nth-child(7){animation-delay:-.6s}:host(.mk-controls-container) .mk-user-location-control .mk-icon.mk-icon-waiting rect:nth-child(8){animation-delay:-.7s}@keyframes mk-spinner{0%{opacity:1}88%{opacity:.15}}:host(.mk-controls-container) .mk-map-type-control .mk-icon,:host(.mk-controls-container) .mk-user-location-control .mk-icon{pointer-events:none;display:block;opacity:.55}:host(.mk-controls-container) .mk-map-type-control.mk-pressed .mk-icon,:host(.mk-controls-container) .mk-map-type-control:focus .mk-icon,:host(.mk-controls-container) .mk-map-type-control:hover .mk-icon,:host(.mk-controls-container) .mk-user-location-control.mk-pressed .mk-icon,:host(.mk-controls-container) .mk-user-location-control:focus .mk-icon,:host(.mk-controls-container) .mk-user-location-control:hover .mk-icon{opacity:.85}@media (hover:none){:host(.mk-controls-container) .mk-map-type-control:hover:not(.mk-pressed):not(:focus) .mk-icon,:host(.mk-controls-container) .mk-user-location-control:hover:not(.mk-pressed):not(:focus) .mk-icon{opacity:.55}}:host(.mk-controls-container) .mk-popover{visibility:hidden;transform:scale(.5);opacity:0;border-radius:10px;transition:.2s opacity cubic-bezier(.25,.1,.25,1),.2s visibility step-end,.2s transform step-end;will-change:transform,opacity,visibility;border-width:1px;border-style:solid;cursor:default}:host(.mk-controls-container) .mk-popover.mk-shown{visibility:visible;pointer-events:auto;transform:none;opacity:1;transition:.2s transform cubic-bezier(.25,.1,.25,1.3),.2s opacity cubic-bezier(.25,.1,.25,1.3)}:host(.mk-controls-container) .mk-popover-arrow path{stroke-width:1px}:host(.mk-controls-container) .mk-map-type-popover{width:241px;padding:20px 20px 0 20px}:host(.mk-controls-container) .mk-map-type-popover>div{width:67px;display:inline-block}:host(.mk-controls-container) .mk-map-type-label{margin-top:10px;margin-bottom:17px;text-align:center;font-size:calc(100% * 13 / var(--font-size-default));line-height:calc(16 / 13 * 100%);font-family:"-apple-system-font",HelveticaNeue-Medium,Helvetica,Arial,sans-serif}.mk-map-type-button{position:relative;display:block;cursor:pointer;width:65px;height:52px}.mk-map-type-button input{appearance:none;padding:0;margin:0}.mk-map-type-button img,.mk-map-type-button input,.mk-map-type-button::after{position:absolute;top:0;left:0;width:65px;height:52px;border-radius:8px}.mk-map-type-button::after{content:""}:host(.mk-controls-container) .mk-map-type-button img.mk-dark-icon,:host(.mk-controls-container.mk-color-scheme-dark) .mk-map-type-button img.mk-light-icon{display:none}:host(.mk-controls-container.mk-color-scheme-dark) .mk-map-type-button img.mk-dark-icon{display:block}.mk-style-helper{opacity:0;pointer-events:none}.mk-compass,.mk-rotation-control{width:48px;height:48px;pointer-events:auto;border-radius:50%;overflow:hidden;line-height:0;transition:opacity .1s cubic-bezier(.19,1,.22,1)}.mk-rotation-control{cursor:-webkit-grab;cursor:grab}.mk-rotation-control.mk-pressed{cursor:-webkit-grabbing;cursor:grabbing}@supports ((backdrop-filter:blur(30px)) or (-webkit-backdrop-filter:blur(30px))){.mk-compass,.mk-focus .mk-zoom-in,.mk-focus .mk-zoom-out,.mk-legal:focus-visible,.mk-pill-focus .mk-map-type-control,.mk-pill-focus .mk-user-location-control,.mk-pill-pressed .mk-map-type-control,.mk-pill-pressed .mk-user-location-control,.mk-pill-pressed .mk-zoom-in,.mk-pill-pressed .mk-zoom-out,.mk-rotation-control,.mk-top-right-controls-container:not(.mk-pill-pressed):not(.mk-pill-focus):not(:empty),.mk-zoom-controls:not(.mk-pill-pressed):not(.mk-focus){-webkit-backdrop-filter:blur(30px);backdrop-filter:blur(30px)}}.mk-compass>.mk-compass-wrapper,.mk-rotation-control>.mk-rotation-wrapper{width:100%;height:100%;position:absolute;will-change:transform;overflow:hidden;pointer-events:none}.mk-compass>.mk-compass-wrapper>img,.mk-rotation-control>.mk-rotation-wrapper>img{position:absolute;left:0;top:0;width:200%;height:200%;pointer-events:none}.mk-compass:active>.mk-compass-wrapper>img,.mk-compass:hover>.mk-compass-wrapper>img,.mk-rotation-control.mk-focus>.mk-rotation-wrapper>img,.mk-rotation-control.mk-pressed>.mk-rotation-wrapper>img,.mk-rotation-control:hover>.mk-rotation-wrapper>img{left:-100%}.mk-compass:has(:focus-visible)>.mk-compass-wrapper>img{left:-100%}@media (hover:none){.mk-rotation-control:hover:not(.mk-focus):not(.mk-pressed)>.mk-rotation-wrapper>img{left:0}.mk-compass:hover:not(:has(:focus-visible)):not(:active)>.mk-compass-wrapper>img{left:0}}:host(.mk-dark-mode) .mk-compass>.mk-compass-wrapper>img,:host(.mk-dark-mode) .mk-rotation-control>.mk-rotation-wrapper>img{top:-100%}.mk-compass .mk-compass-heading,.mk-rotation-control .mk-heading{font:15.5px "-apple-system-font",HelveticaNeue-Medium,Helvetica,Arial,sans-serif;font-weight:500;position:absolute;left:0;width:100%;overflow:hidden;text-overflow:clip;text-align:center;opacity:.55;pointer-events:none}.mk-compass .mk-compass-heading{top:0;line-height:48px}.mk-rotation-control .mk-heading{top:calc(50% - 1em / 15.5 * 10.5);line-height:19px}.mk-compass:active .mk-compass-heading,.mk-compass:hover .mk-compass-heading,.mk-rotation-control.mk-focus .mk-heading,.mk-rotation-control.mk-pressed .mk-heading,.mk-rotation-control:hover .mk-heading{opacity:.85}.mk-compass:has(:focus-visible) .mk-compass-heading{opacity:.85}@media (hover:none){.mk-rotation-control:not(.mk-focus):not(.mk-pressed):hover .mk-heading{opacity:.55}.mk-compass:not(:has(:focus-visible)):not(:active):hover .mk-compass-heading{opacity:.55}}.mk-rotation-control .mk-rotation-slider{position:absolute;left:0;width:100%;height:15px;top:-30px}.mk-compass-slider{all:initial;opacity:0;position:absolute;display:block;width:100%;height:100%;top:0;left:0;border-radius:24px;margin:0;padding:0;cursor:grab}.mk-compass-slider:active{cursor:grabbing}.mk-compass-slider::-webkit-slider-runnable-track,.mk-compass-slider::-webkit-slider-thumb{all:initial;appearance:none;display:block;width:100%;height:100%;top:0;left:0}.mk-compass-slider::-moz-range-progress,.mk-compass-slider::-moz-range-thumb,.mk-compass-slider::-moz-range-track{all:initial;appearance:none;display:block;width:100%;height:100%}:host(.mk-controls-container.mk-dragging-annotation) .mk-legal,:host(.mk-controls-container.mk-dragging-annotation) .mk-map-type-control,:host(.mk-controls-container.mk-dragging-annotation) .mk-rotation-control,:host(.mk-controls-container.mk-dragging-annotation) .mk-rotation-control input,:host(.mk-controls-container.mk-dragging-annotation) .mk-user-location-control,:host(.mk-controls-container.mk-dragging-annotation) .mk-zoom-in,:host(.mk-controls-container.mk-dragging-annotation) .mk-zoom-out{cursor:none}.mk-compass,.mk-rotation-control,.mk-top-right-controls-container:not(.mk-pill-pressed):not(.mk-pill-focus):not(:empty),.mk-zoom-controls{box-shadow:0 0 0 .5px rgba(0,0,0,.05)}.mk-compass,.mk-focus .mk-zoom-in,.mk-focus .mk-zoom-out,.mk-pill-focus .mk-map-type-control,.mk-pill-focus .mk-user-location-control,.mk-pill-pressed .mk-map-type-control,.mk-pill-pressed .mk-user-location-control,.mk-pill-pressed .mk-zoom-in,.mk-pill-pressed .mk-zoom-out,.mk-rotation-control,.mk-top-right-controls-container:not(.mk-pill-pressed):not(.mk-pill-focus):not(:empty),.mk-zoom-controls:not(.mk-pill-pressed):not(.mk-focus){background-color:#fff}.mk-compass:active,.mk-map-type-control.mk-pressed,.mk-rotation-control.mk-pressed,.mk-user-location-control.mk-pressed,.mk-zoom-controls .mk-zoom-in.mk-pressed:not(.mk-disabled),.mk-zoom-controls .mk-zoom-out.mk-pressed:not(.mk-disabled){background-color:#e5e5e5}.mk-legal:focus-visible,.mk-map-type-control:focus,.mk-rotation-control.mk-focus,.mk-user-location-control:focus,.mk-zoom-controls.mk-focus .mk-zoom-in:focus,.mk-zoom-controls.mk-focus .mk-zoom-out:focus{background-color:#cce5ff}.mk-legal:focus-visible,.mk-map-type-control:focus,.mk-pill-focus .mk-map-type-control,.mk-pill-focus .mk-user-location-control,.mk-rotation-control.mk-focus,.mk-user-location-control:focus,.mk-zoom-controls.mk-focus{box-shadow:0 0 0 2px #007cff}.mk-compass:has(:focus-visible){background-color:#cce5ff;box-shadow:0 0 0 2px #007cff}.mk-map-type-control.mk-focus.mk-pressed,.mk-rotation-control.mk-focus.mk-pressed,.mk-user-location-control.mk-focus.mk-pressed,.mk-zoom-controls.mk-focus .mk-zoom-in.mk-pressed:focus,.mk-zoom-controls.mk-focus .mk-zoom-out.mk-pressed:focus{background-color:#7fbdff}.mk-compass:has(:focus-visible):active{background-color:#7fbdff}.mk-zoom-controls.mk-focus .mk-divider{border-left:2px solid #007cff}.mk-map-type-control .mk-icon,.mk-user-location-control .mk-icon,.mk-zoom-controls .mk-icon{fill:#000}:host(.mk-controls-container) .mk-popover{background-color:#efefef;color:#000;border-color:transparent;box-shadow:0 5px 10px 0 rgba(0,0,0,.3)}:host(.mk-controls-container) .mk-popover-arrow{fill:#efefef}.mk-error-message{color:#333}.mk-error-message a{color:#007aff}.mk-error-message a:visited{color:#af52de}.mk-legal .mk-legal-label{color:rgba(0,0,0,.7);text-shadow:0 0 1px rgba(255,255,255,.85)}.mk-compass .mk-compass-heading,.mk-rotation-control .mk-heading{color:#000}.mk-popover .mk-map-type-button input{box-shadow:0 0 0 .5px rgb(0,0,0,.14)}.mk-popover .mk-map-type-button input:checked{box-shadow:0 0 0 2px #007cff}.mk-popover .mk-map-type-button input:focus-visible{box-shadow:0 0 0 4px rgba(0,124,255,.4)}.mk-popover .mk-map-type-button input:checked:focus-visible{box-shadow:0 0 0 2px #007cff,0 0 0 4px rgba(0,124,255,.4)}.mk-map-type-button:active::after{background-color:rgba(0,0,0,.25)}@supports ((backdrop-filter:blur(30px)) or (-webkit-backdrop-filter:blur(30px))){.mk-compass,.mk-focus .mk-zoom-in,.mk-focus .mk-zoom-out,.mk-pill-focus .mk-map-type-control,.mk-pill-focus .mk-user-location-control,.mk-pill-pressed .mk-map-type-control,.mk-pill-pressed .mk-user-location-control,.mk-pill-pressed .mk-zoom-in,.mk-pill-pressed .mk-zoom-out,.mk-rotation-control,.mk-top-right-controls-container:not(.mk-pill-pressed):not(.mk-pill-focus):not(:empty),.mk-zoom-controls:not(.mk-pill-pressed):not(.mk-focus){background-color:rgba(255,255,255,.75)}.mk-compass:active,.mk-map-type-control.mk-pressed,.mk-rotation-control.mk-pressed,.mk-user-location-control.mk-pressed,.mk-zoom-controls .mk-zoom-in.mk-pressed:not(.mk-disabled),.mk-zoom-controls .mk-zoom-out.mk-pressed:not(.mk-disabled){background-color:rgba(229,229,229,.6)}.mk-legal:focus-visible,.mk-map-type-control.mk-focus,.mk-rotation-control.mk-focus,.mk-user-location-control.mk-focus,.mk-zoom-controls.mk-focus .mk-zoom-in:focus,.mk-zoom-controls.mk-focus .mk-zoom-out:focus{background-color:rgba(204,229,255,.6)}.mk-compass:has(:focus-visible){background-color:rgba(204,229,255,.6)}.mk-map-type-control.mk-focus.mk-pressed,.mk-rotation-control.mk-focus.mk-pressed,.mk-user-location-control.mk-focus.mk-pressed,.mk-zoom-controls.mk-focus .mk-zoom-in.mk-pressed:focus,.mk-zoom-controls.mk-focus .mk-zoom-out.mk-pressed:focus{background-color:rgb(127,189,255,.6)}.mk-compass:has(:focus-visible):active{background-color:rgb(127,189,255,.6)}}:host(.mk-dark-mode) .mk-compass,:host(.mk-dark-mode) .mk-rotation-control,:host(.mk-dark-mode) .mk-top-right-controls-container:not(.mk-pill-pressed):not(.mk-pill-focus):not(:empty),:host(.mk-dark-mode) .mk-zoom-controls{box-shadow:0 0 0 .5px rgba(255,255,255,.05)}:host(.mk-dark-mode) .mk-compass,:host(.mk-dark-mode) .mk-focus .mk-zoom-in,:host(.mk-dark-mode) .mk-focus .mk-zoom-out,:host(.mk-dark-mode) .mk-pill-focus .mk-map-type-control,:host(.mk-dark-mode) .mk-pill-focus .mk-user-location-control,:host(.mk-dark-mode) .mk-pill-pressed .mk-map-type-control,:host(.mk-dark-mode) .mk-pill-pressed .mk-user-location-control,:host(.mk-dark-mode) .mk-pill-pressed .mk-zoom-in,:host(.mk-dark-mode) .mk-pill-pressed .mk-zoom-out,:host(.mk-dark-mode) .mk-rotation-control,:host(.mk-dark-mode) .mk-top-right-controls-container:not(.mk-pill-pressed):not(.mk-pill-focus):not(:empty),:host(.mk-dark-mode) .mk-zoom-controls:not(.mk-pill-pressed):not(.mk-focus){background-color:#121212}:host(.mk-dark-mode) .mk-map-type-control.mk-pressed,:host(.mk-dark-mode) .mk-user-location-control.mk-pressed,:host(.mk-dark-mode) .mk-zoom-controls .mk-zoom-in.mk-pressed:not(.mk-disabled),:host(.mk-dark-mode) .mk-zoom-controls .mk-zoom-out.mk-pressed:not(.mk-disabled){background-color:#2a2a2a}:host(.mk-dark-mode) .mk-legal:focus-visible,:host(.mk-dark-mode) .mk-map-type-control.mk-focus,:host(.mk-dark-mode) .mk-rotation-control.mk-focus,:host(.mk-dark-mode) .mk-user-location-control.mk-focus,:host(.mk-dark-mode) .mk-zoom-controls.mk-focus .mk-zoom-in:focus,:host(.mk-dark-mode) .mk-zoom-controls.mk-focus .mk-zoom-out:focus{background-color:#0c3159}:host(.mk-dark-mode) .mk-legal:focus-visible,:host(.mk-dark-mode) .mk-map-type-control:focus,:host(.mk-dark-mode) .mk-pill-focus .mk-map-type-control,:host(.mk-dark-mode) .mk-pill-focus .mk-user-location-control,:host(.mk-dark-mode) .mk-rotation-control.mk-focus,:host(.mk-dark-mode) .mk-user-location-control:focus,:host(.mk-dark-mode) .mk-zoom-controls.mk-focus{box-shadow:0 0 0 2px #007cff}:host(.mk-dark-mode) .mk-compass:has(:focus-visible){background-color:#0c3159;box-shadow:0 0 0 2px #007cff}:host(.mk-dark-mode) .mk-map-type-control.mk-focus.mk-pressed,:host(.mk-dark-mode) .mk-rotation-control.mk-focus.mk-pressed,:host(.mk-dark-mode) .mk-user-location-control.mk-focus.mk-pressed,:host(.mk-dark-mode) .mk-zoom-controls.mk-focus .mk-zoom-in.mk-pressed:focus,:host(.mk-dark-mode) .mk-zoom-controls.mk-focus .mk-zoom-out.mk-pressed:focus{background-color:#0366cf}:host(.mk-dark-mode) .mk-compass:has(:focus-visible):active{background-color:#0366cf}:host(.mk-dark-mode) .mk-map-type-control .mk-icon,:host(.mk-dark-mode) .mk-user-location-control .mk-icon,:host(.mk-dark-mode) .mk-zoom-controls .mk-icon{fill:#fff}:host(.mk-controls-container.mk-dark-mode) .mk-popover{background-color:#363636;color:#fff;border-color:#5a5c64}:host(.mk-controls-container.mk-dark-mode) .mk-popover-arrow{fill:#363636}:host(.mk-controls-container.mk-dark-mode) .mk-popover-arrow path{stroke:#5a5c64}:host(.mk-dark-mode) .mk-error-message{color:rgba(255,255,255,.85)}:host(.mk-dark-mode) .mk-error-message a{color:#0a84ff}:host(.mk-dark-mode) .mk-error-message a:visited{color:#bf5af2}:host(.mk-dark-mode) .mk-legal .mk-legal-label{color:rgba(255,255,255,.9);text-shadow:0 0 1px rgba(0,0,0,.5),0 0 10px rgba(0,0,0,1)}:host(.mk-dark-mode) .mk-compass .mk-compass-heading,:host(.mk-dark-mode) .mk-rotation-control .mk-heading{color:#fff}:host(.mk-dark-mode) .mk-popover .mk-map-type-button input:not(:checked):not(:focus-visible){box-shadow:0 0 0 .5px rgb(255,255,255,.3)}@supports ((backdrop-filter:blur(30px)) or (-webkit-backdrop-filter:blur(30px))){:host(.mk-dark-mode) .mk-compass,:host(.mk-dark-mode) .mk-focus .mk-zoom-in,:host(.mk-dark-mode) .mk-focus .mk-zoom-out,:host(.mk-dark-mode) .mk-pill-focus .mk-map-type-control,:host(.mk-dark-mode) .mk-pill-focus .mk-user-location-control,:host(.mk-dark-mode) .mk-pill-pressed .mk-map-type-control,:host(.mk-dark-mode) .mk-pill-pressed .mk-user-location-control,:host(.mk-dark-mode) .mk-pill-pressed .mk-zoom-in,:host(.mk-dark-mode) .mk-pill-pressed .mk-zoom-out,:host(.mk-dark-mode) .mk-rotation-control,:host(.mk-dark-mode) .mk-top-right-controls-container:not(.mk-pill-pressed):not(.mk-pill-focus):not(:empty),:host(.mk-dark-mode) .mk-zoom-controls:not(.mk-pill-pressed):not(.mk-focus){background-color:rgba(18,18,18,.6)}:host(.mk-dark-mode) .mk-compass:active,:host(.mk-dark-mode) .mk-map-type-control.mk-pressed,:host(.mk-dark-mode) .mk-rotation-control.mk-pressed,:host(.mk-dark-mode) .mk-type-control.mk-pressed,:host(.mk-dark-mode) .mk-user-location-control.mk-pressed,:host(.mk-dark-mode) .mk-zoom-controls .mk-zoom-in.mk-pressed:not(.mk-disabled),:host(.mk-dark-mode) .mk-zoom-controls .mk-zoom-out.mk-pressed:not(.mk-disabled){background-color:rgba(42,42,42,.6)}:host(.mk-dark-mode) .mk-legal:focus-visible,:host(.mk-dark-mode) .mk-map-type-control.mk-focus,:host(.mk-dark-mode) .mk-rotation-control.mk-focus,:host(.mk-dark-mode) .mk-user-location-control.mk-focus,:host(.mk-dark-mode) .mk-zoom-controls.mk-focus .mk-zoom-in:focus,:host(.mk-dark-mode) .mk-zoom-controls.mk-focus .mk-zoom-out:focus{background-color:rgba(12,49,89,.6)}:host(.mk-dark-mode) .mk-compass:has(:focus-visible){background-color:rgba(12,49,89,.6)}:host(.mk-dark-mode) .mk-map-type-control.mk-focus.mk-pressed,:host(.mk-dark-mode) .mk-rotation-control.mk-focus.mk-pressed,:host(.mk-dark-mode) .mk-user-location-control.mk-focus.mk-pressed,:host(.mk-dark-mode) .mk-zoom-controls.mk-focus .mk-zoom-in.mk-pressed:focus,:host(.mk-dark-mode) .mk-zoom-controls.mk-focus .mk-zoom-out.mk-pressed:focus{background-color:rgb(3,102,207,.6)}:host(.mk-dark-mode) .mk-compass:has(:focus-visible):active{background-color:rgb(3,102,207,.6)}}.mk-scale{position:absolute;top:0;left:0;vertical-align:top}:host(.mk-rtl) .mk-scale{direction:rtl}:host(.mk-controls-container) .mk-popover{position:absolute;top:38px;right:-1px}:host(.mk-controls-container) .mk-popover-arrow{position:absolute;top:-13px}.mk-top-right-controls-container{position:absolute;top:9px;right:9px;direction:ltr}:host(.mk-controls-container:not(.mk-rtl)) .mk-top-right-controls-container>.mk-control:first-child{border-top-left-radius:20% 37.5%;border-bottom-left-radius:20% 37.5%}:host(.mk-controls-container:not(.mk-rtl)) .mk-top-right-controls-container>.mk-control:nth-last-child(2){border-top-right-radius:20% 37.5%;border-bottom-right-radius:20% 37.5%}:host(.mk-controls-container) .mk-popover.mk-user-location-error-popover{transform-origin:calc(100% - 69px) -12.416px}:host(.mk-controls-container) .mk-popover.mk-map-type-popover,:host(.mk-controls-container) .mk-popover.mk-user-location-error-popover:last-child{transform-origin:calc(100% - 24px) -12.416px}:host(.mk-controls-container) .mk-popover.mk-user-location-error-popover>.mk-popover-arrow{right:52.5px}:host(.mk-controls-container) .mk-popover.mk-map-type-popover>.mk-popover-arrow,:host(.mk-controls-container) .mk-popover.mk-user-location-error-popover:last-child>.mk-popover-arrow{right:10px}:host(.mk-controls-container) .mk-map-type-popover>div:not(:last-child){margin-right:20px}:host(.mk-controls-container) .mk-controls-container-controls-larger .mk-popover{top:44px}:host(.mk-controls-container) .mk-controls-container-controls-larger .mk-popover.mk-user-location-error-popover>.mk-popover-arrow{right:65px}:host(.mk-rtl) .mk-top-right-controls-container{left:9px;right:auto;direction:rtl}:host(.mk-controls-container.mk-rtl) .mk-top-right-controls-container>.mk-control:first-child{border-top-right-radius:20% 37.5%;border-bottom-right-radius:20% 37.5%}:host(.mk-controls-container.mk-rtl) .mk-top-right-controls-container>.mk-control:nth-last-child(2){border-top-left-radius:20% 37.5%;border-bottom-left-radius:20% 37.5%}:host(.mk-controls-container.mk-rtl) .mk-popover{right:auto;left:-1px}:host(.mk-controls-container.mk-rtl) .mk-popover.mk-user-location-error-popover{transform-origin:69px -12.416px}:host(.mk-controls-container.mk-rtl) .mk-popover.mk-map-type-popover,:host(.mk-controls-container.mk-rtl) .mk-popover.mk-user-location-error-popover:last-child{transform-origin:24px -12.416px}:host(.mk-controls-container.mk-rtl) .mk-popover.mk-user-location-error-popover>.mk-popover-arrow{right:auto;left:52.5px}:host(.mk-controls-container) .mk-controls-container-controls-larger .mk-popover.mk-map-type-popover>.mk-popover-arrow{right:12px}:host(.mk-controls-container.mk-rtl) .mk-popover.mk-map-type-popover>.mk-popover-arrow,:host(.mk-controls-container.mk-rtl) .mk-popover.mk-user-location-error-popover:last-child>.mk-popover-arrow{right:auto;left:10px}:host(.mk-controls-container.mk-rtl) .mk-controls-container-controls-larger .mk-popover.mk-user-location-error-popover>.mk-popover-arrow{right:auto;left:69.75px}:host(.mk-controls-container) .mk-controls-container-controls-larger .mk-popover.mk-user-location-error-popover:last-child>.mk-popover-arrow{right:12px}:host(.mk-controls-container.mk-rtl) .mk-controls-container-controls-larger .mk-popover.mk-map-type-popover>.mk-popover-arrow,:host(.mk-controls-container.mk-rtl) .mk-controls-container-controls-larger .mk-popover.mk-user-location-error-popover:last-child>.mk-popover-arrow{right:auto;left:13.25px}:host(.mk-controls-container.mk-rtl) .mk-map-type-popover>div:not(:last-child){margin-left:20px;margin-right:0}.mk-bottom-left-controls-container,.mk-bottom-right-controls-container{position:absolute;bottom:9px}.mk-rotation-control,.mk-zoom-controls{position:absolute;bottom:0}.mk-compass{position:absolute;bottom:42px}.mk-legal,.mk-logo-control{position:absolute}.mk-logo-control,:host(.mk-controls-container) .mk-legal{bottom:-4px}:host(.mk-controls) .mk-legal{bottom:9px}.mk-bottom-right-controls-container{right:9px}.mk-bottom-left-controls-container{left:9px}:host(.mk-reduce-margin) .mk-bottom-right-controls-container{right:0}:host(.mk-reduce-margin) .mk-bottom-left-controls-container{left:4px}.mk-logo-control{left:0}:host(.mk-controls-container) div.mk-logo-control img.mk-logo.mk-logo-autonavi.mk-logo-autonavi{margin:0 0 -6px -9px}.mk-rotation-control,.mk-zoom-controls,:host(.mk-controls-container) .mk-legal{right:0;left:auto}:host(:not(.mk-rtl))>.mk-compass{right:9px}:host(.mk-controls-container) .mk-legal{right:auto;left:0}:host(.mk-controls:not(.mk-rtl))>.mk-legal{right:0}.mk-zoom-controls .mk-zoom-in{border-top-right-radius:50%;border-bottom-right-radius:50%;right:0}.mk-zoom-controls .mk-zoom-out{border-top-left-radius:50%;border-bottom-left-radius:50%;left:0}.mk-rotation-control~.mk-zoom-controls{right:57px;left:auto}:host(.mk-controls-container) .mk-legal:nth-child(2){left:calc(var(--logo-width) * var(--logo-xmax))}:host(.mk-rtl) .mk-bottom-right-controls-container{left:9px;right:auto}:host(.mk-rtl) .mk-bottom-left-controls-container{left:auto;right:9px}:host(.mk-rtl.mk-reduce-margin) .mk-bottom-right-controls-container{left:0;right:auto}:host(.mk-rtl.mk-reduce-margin) .mk-bottom-left-controls-container{left:auto;right:4px}:host(.mk-rtl) .mk-logo-control{left:auto;right:0}:host(.mk-rtl.mk-controls-container) div.mk-logo-control img.mk-logo.mk-logo-autonavi.mk-logo-autonavi{margin:0 -9px -6px 0}:host(.mk-rtl) .mk-zoom-controls .mk-zoom-in{border-top-right-radius:0;border-bottom-right-radius:0;border-top-left-radius:50%;border-bottom-left-radius:50%;right:auto;left:0}:host(.mk-rtl) .mk-zoom-controls .mk-zoom-out{border-top-right-radius:50%;border-bottom-right-radius:50%;border-top-left-radius:0;border-bottom-left-radius:0;right:0;left:auto}:host(.mk-controls-container.mk-rtl) .mk-legal,:host(.mk-rtl) .mk-rotation-control,:host(.mk-rtl) .mk-zoom-controls{left:0;right:auto}:host(.mk-rtl)>.mk-compass{left:9px}:host(.mk-controls.mk-rtl)>.mk-legal{left:0}:host(.mk-controls-container.mk-rtl) .mk-legal{left:auto;right:0}:host(.mk-rtl) .mk-rotation-control~.mk-zoom-controls{left:57px;right:auto}:host(.mk-controls-container) .mk-autonavi .mk-legal:nth-child(2){left:calc(var(--logo-width) * var(--logo-xmax) - 9px)}:host(.mk-controls-container.mk-rtl) .mk-legal:nth-child(2){right:calc(var(--logo-width) * (1 - var(--logo-xmin)))}:host(.mk-controls-container.mk-rtl) .mk-autonavi .mk-legal:nth-child(2){left:auto;right:calc(var(--logo-width) * (1 - var(--logo-xmin)) - 9px)}',kt.nonce),this._shadowRootNode.addChild(this._topRightControlsNode),this._shadowRootNode.addChild(this._bottomRightControlsNode),this._shadowRootNode.addChild(this._bottomLeftControlsNode),this._logo=new nl,this._legalNode=new rl,this._logo.setUpdatedDelegate(this),kt.addEventListener(kt.Events.Changed,this),this._updateAutoNaviClass(),this.textZoom=t.textZoom,Oi.activeLocale&&(this._rtl=Oi.activeLocale.rtl,this.setAttribute("lang",Oi.localeId),this.classList.toggle(Ah,this._rtl)),Oi.addEventListener(Oi.Events.LocaleChanged,this)}get textZoom(){return this.classList.contains(Ih)}set textZoom(t){this.classList.toggle(Ih,t)}get controlsPending(){return this._controlsPending}set canShowTooltips(t){this._userLocationControl&&(this._userLocationControl.canShowTooltips=t),this._zoomControl&&(this._zoomControl.canShowTooltips=t),this._mapTypeControl&&(this._mapTypeControl.canShowTooltips=t),this._rotationControl&&(this._rotationControl.canShowTooltips=t)}mapPaddingDidChange(t){const e=this.element.style;e.top=t.top+"px",e.left=t.left+"px",e.bottom=t.bottom+"px",e.right=t.right+"px",this.sizeDidChange()}sizeDidChange(){const t=this._shouldHideControls();this._toggleControl(this._map.showsZoomControl&&!t,this._zoomControl,this.updateZoomControl),this._toggleControl(this._map.showsMapTypeControl&&!t,this._mapTypeControl,this.updateMapTypeControl),this._toggleControl(this._map.showsUserLocationControl&&!t,this._userLocationControl,this.updateUserLocationControl),this.updateLogo(),this.updateLegalNode(),this.updateRotationControl(),this.updateScale(),this.zoomLevelDidChange();const e=this._getSizeClass();this._updateTopRightControlsContainer(!1),this._setSizeClass(this._bottomRightControlsNode,e),this._setSizeClass(this._bottomLeftControlsNode,e),this._setReduceMargin()}logoUpdated(t){const e=this._bottomLeftControlsNode.domNode;e.style.setProperty("--logo-xmin",t.xMin),e.style.setProperty("--logo-xmax",t.xMax)}zoomLevelDidChange(){this._zoomControl&&(this._zoomControl.zoomOutEnabled=this._map.canZoomOut,this._zoomControl.zoomInEnabled=this._map.canZoomIn)}update(){this._map&&(this.classList.toggle("mk-color-scheme-dark",Co.darkColorScheme(this._map.currentColorScheme)),this.classList.toggle("mk-dark-mode",Co.darkColorScheme(this._map.tint)),this._shouldHideControls()?(this._removeZoomControl(),this._removeMapTypeControl(),this._removeUserLocationControl(),this._removeRotationControl(),this._removeScale()):(this.updateZoomControl(),this.updateMapTypeControl(),this.updateUserLocationControl(),this.updateRotationControl(),this.updateScale()),this.updateLogo(),this.updateLegalNode(),this._setReduceMargin())}scaleDidChange(){this._scale&&(this._scale.update(),this._scale.hideIfNeeded())}updateScale(){this._map.showsScale===Sh.Hidden||this._shouldHideControls()?this._removeScale():(this._addScale(),this._scale.node.mapWidth=this._map._mapNode.size.width,this._scale.updateTheme(this._map.mapNodeTint),this._positionScale(),this._scale.update())}updateZoomControl(){this._map.showsZoomControl&&!this._shouldHideControls()?(this._addZoomControl(),this._zoomControl.enabled=this._map.isZoomEnabled,this.zoomLevelDidChange(),this._zoomControl.updateTintColor(this._map.tintColorForControls)):this._removeZoomControl()}updateMapTypeControl(){this._map.showsMapTypeControl&&!this._shouldHideControls()?(this._addMapTypeControl(),this._mapTypeControl.mapType=this._map.mapType,this._mapTypeControl.enabled=!0,this._mapTypeControl.updateTintColor(this._map.tintColorForControls)):this._removeMapTypeControl()}updateUserLocationControl(){if(this._map.showsUserLocationControl&&!this._shouldHideControls()){switch(this._addUserLocationControl(),this._userLocationControl.enabled=!0,this._userLocationControl.state){case gh.States.Default:Nh.userLocation.isAvailable?this._map.tracksUserLocation&&Nh.userLocation.location?this._userLocationControl.toTrackingState():(this._map.tracksUserLocation||this._map.showsUserLocation&&!this._map.userLocationAnnotation)&&this._userLocationControl.toWaitingState():this._userLocationControl.toDisabledState();break;case gh.States.Waiting:Nh.userLocation.location&&this.userLocationDidChange(Nh.userLocation),this._map.showsUserLocation||this._userLocationControl.toDefaultState();break;case gh.States.Tracking:this._map.tracksUserLocation||this._userLocationControl.toDefaultState()}this._userLocationControl.updateTintColor(this._map.tintColorForControls)}else this._removeUserLocationControl()}updateRotationControl(){this._shouldHideControls()||this._map.isCompassHidden?this._removeRotationControl():(this._addRotationControl(),this._rotationControl.rotation=this._map.rotation,this._rotationControl.updateImage(Co.devicePixelRatio,Co.darkColorScheme(this._map.mapNodeTint)),this._rotationControl.updateTintColor(this._map.tintColorForControls))}updateLegalNode(){this._addAndUpdateLegalNode()}updateLogo(){!this._shouldHideLogo()&&Fh()?this._addAndUpdateLogo():this._logo.remove(),this._legalNode.updateWithMapType(this._map.mapType)}devicePixelRatioDidChange(){this._rotationControl&&this._rotationControl.updateImage(Co.devicePixelRatio,Co.darkColorScheme(this._map.mapNodeTint)),this._scale&&this._scale.update(),this._logo.updateWithMapNodeTint(this._map.mapNodeTint)}fontSizeDidChange(){this._scale&&this._scale.update()}handleEvent(t){if(this._map)switch(t.type){case xl.EVENTS.MAP_TYPE_CHANGE:this._mapTypeControl&&(this._map.mapType=this._mapTypeControl.mapType);break;case gh.EVENTS.PRESSED:this._userLocationControl.state===gh.States.Waiting?this._map.tracksUserLocation=!0:this._userLocationControl.state!==gh.States.Tracking&&(this._map.tracksUserLocation=!1);break;case Oi.Events.LocaleChanged:this._handleLocaleChanged(t);break;case"update":this._unsetPendingControls(),this._map.addWaitingAnnotations();break;case kt.Events.Changed:this._updateAutoNaviClass(),this.updateLogo(),this.updateLegalNode()}}mapWasDestroyed(){this._unsetPendingControls(),Oi.removeEventListener(Oi.Events.LocaleChanged,this),kt.removeEventListener(kt.Events.Changed,this),this._destroyZoomControl(),this._destroyMapTypeControl(),this._destroyUserLocationControl(),this._destroyRotationControl(!0),this._legalNode.remove(),delete this._legalNode,this._logo.mapWasDestroyed(),this._logo.remove(),delete this._logo,this._removeScale(),this.remove(),delete this._map}userLocationDidChange(t){this._userLocationControl&&(this._map.tracksUserLocation?this._userLocationControl.toTrackingState():this._userLocationControl.toDefaultState())}userLocationDidError(t){this._userLocationControl&&this._userLocationControl.toDisabledState(),this._map.userLocationAnnotation||3===t.errorCode||(this._map.showsUserLocation=!1)}_handleLocaleChanged(t){this.classList.toggle(Ah,t.locale.rtl),this.setAttribute("lang",Oi.localeId),this._rtl!==t.locale.rtl?(this._rtl=t.locale.rtl,this._rtlChanged=!0,this.update(),this._rtlChanged=!1):this.updateLogo()}_addScale(){this._scale||(this._setPendingControls(),this._scale=new $l(this._map),this._shadowRootNode.addChild(this._scale,0))}_positionScale(){const t=this._map.ensureVisibleFrame().size,e=!this._rtl;this._scale.node.leftAligned=e,this._scale.position=new Gi(e?zh.x:t.width-this._scale.size.width-zh.x,zh.y),this._scale.shouldDisplayScale||this._scale.node.setOpacityAnimated(0,!1)}_removeScale(){this._scale&&(this._setPendingControls(),this._scale.mapWasDestroyed(),this._scale.remove(),delete this._scale)}_addZoomControl(){!this._map.showsZoomControl||this._zoomControl||this._shouldHideControls()||(this._setPendingControls(),this._zoomControl=new rh,this._zoomControl.enabled=this._map.isZoomEnabled,this._zoomControl.addEventListener(rh.EVENTS.ZOOM_START,this._map),this._zoomControl.addEventListener(rh.EVENTS.ZOOM_END,this._map),this._bottomRightControlsNode.insertBefore(this._zoomControl,this._legalNode),this._rotationControl&&this._rotationControl.classList.add(Oh))}_removeZoomControl(){!this._shouldHideControls()&&this._map.showsZoomControl||!this._zoomControl||(this._setPendingControls(),this._zoomControl.enabled=!1,this._destroyZoomControl())}_destroyZoomControl(){this._zoomControl&&(this._zoomControl.removeEventListener(rh.EVENTS.ZOOM_START,this._map),this._zoomControl.removeEventListener(rh.EVENTS.ZOOM_END,this._map),this._zoomControl.remove(),this._rotationControl&&this._rotationControl.classList.remove(Oh),delete this._zoomControl)}_addMapTypeControl(){!this._map.showsMapTypeControl||this._mapTypeControl||this._shouldHideControls()||(this._setPendingControls(),this._mapTypeControl=new xl(vn,this._map.mapType,this),this._mapTypeControl.addEventListener(xl.EVENTS.MAP_TYPE_CHANGE,this),this._topRightControlsNode.addChild(this._mapTypeControl),this._updateTopRightControlsContainer(!0))}_removeMapTypeControl(){this._mapTypeControl&&(this._setPendingControls(),this._mapTypeControl.enabled=!1,this._destroyMapTypeControl(),this._updateTopRightControlsContainer(!0))}_destroyMapTypeControl(){this._mapTypeControl&&(this._mapTypeControl.removeEventListener(xl.EVENTS.MAP_TYPE_CHANGE,this),this._mapTypeControl.remove(),delete this._mapTypeControl)}_toggleControl(t,e,i){(e&&!t||!e&&t)&&i.call(this)}_shouldHideControls(){if(!kt.ready)return!0;const t=this._map.ensureVisibleFrame().size;return t.width<Dn.minimumSizeToShowControls.width||t.height<Dn.minimumSizeToShowControls.height}_shouldHideLogo(){if(!kt.ready)return!0;const t=-1===Lh.indexOf(Oi.localeId)?Dn.minimumSizeToShowLogo:Dn.minimumSizeToShowLogoWithReducedMargin,e=this._map.ensureVisibleFrame().size;return e.width<t.width||e.height<t.height}_addRotationControl(){this._shouldHideControls()||this._rotationControl||(this._setPendingControls(),this._rotationControl=new Mh(this._map),this._rotationControl.enabled=!0,this._bottomRightControlsNode.insertBefore(this._rotationControl,this._zoomControl||this._legalNode),this._zoomControl&&this._rotationControl.classList.add(Oh))}_removeRotationControl(){this._rotationControl&&(this._setPendingControls(),this._destroyRotationControl())}_destroyRotationControl(t){if(this._rotationControl){if(t)this._rotationControl.mapWasDestroyed(),this._rotationControl.remove();else{const t=this._rotationControl,e=()=>{clearTimeout(i),t.element.removeEventListener("transitionend",e),t.mapWasDestroyed(),t.remove()};t.opacity=0;const i=setTimeout(e,300);t.element.addEventListener("transitionend",e)}delete this._rotationControl}}_addUserLocationControl(){!this._map.showsUserLocationControl||this._userLocationControl||this._shouldHideControls()||(this._setPendingControls(),this._userLocationControl=new gh(this._map,this._rtl,this),this._userLocationControl.addEventListener(gh.EVENTS.PRESSED,this),this._topRightControlsNode.insertBefore(this._userLocationControl,this._mapTypeControl),this._updateTopRightControlsContainer(!0))}controlDidGetFocus(t){this._toggleParentClass(t,Ph,!0)}controlDidLoseFocus(t){this._toggleParentClass(t,Ph,!1)}controlWasPressed(t){this._toggleParentClass(t,Dh,!0)}controlWasReleased(t){this._toggleParentClass(t,Dh,!1)}_setSizeClass(t,e){t.classList.toggle(xh,xh===e),t.classList.toggle(Th,Th===e)}_updateAutoNaviClass(){const t=this._bottomRightControlsNode,e=this._bottomLeftControlsNode;t.classList.toggle(Eh,kt.isAutoNavi),e.classList.toggle(Eh,kt.isAutoNavi)}_toggleParentClass(t,e,i){const n=t.parent;n===this._topRightControlsNode&&n.classList.toggle(e,i)}_removeUserLocationControl(){!this._shouldHideControls()&&this._map.showsUserLocationControl||!this._userLocationControl||(this._setPendingControls(),this._destroyUserLocationControl(),this._updateTopRightControlsContainer(!0))}_destroyUserLocationControl(){this._userLocationControl&&(this._userLocationControl.removeEventListener(gh.EVENTS.STATE_CHANGE,this._map),this._userLocationControl.mapWasDestroyed(),this._userLocationControl.remove(),delete this._userLocationControl)}_addAndUpdateLegalNode(){this._setPendingControls(),kt.showLegalLink&&(this._bottomLeftControlsNode.addChild(this._legalNode),this._legalNode.updateWithMapType(this._map.mapType))}_addAndUpdateLogo(){this._logo.parent||(this._setPendingControls(),this._bottomLeftControlsNode.insertBefore(this._logo,this._legalNode)),this._logo.updateWithMapNodeTint(this._map.mapNodeTint)}_setPendingControls(){this._controlsPending=!0,so.addEventListener("update",this)}_unsetPendingControls(){this._controlsPending=!1,so.removeEventListener("update",this)}_setReduceMargin(){const t=this._map.ensureVisibleFrame().size.width,e=Dn,i=e.minimumSizeToShowLogo.width,n=e.minimumSizeToShowControls.width;this.classList.toggle("mk-reduce-margin",t<i&&Fh()),this.classList.toggle("mk-reduced-vertical-margin",t<n)}_updateTopRightControlsContainer(t){const e=this._topRightControlsNode,i=e.element,n=i&&i.parentNode;if(n&&t){const t=Co.htmlElement("div",{class:i.className});for(;i.children.length>0;)t.appendChild(i.children[0]);n.insertBefore(t,i),n.removeChild(i),e.element=t}e.element&&(e.element.className=this._getTopRightControlsClass(),e.classList.reset())}_getSizeClass(){const t=this._map.ensureVisibleFrame().size,e=Dn.maximumSizeControlsNormal,i=t.width>e.width&&t.height>e.height;return i?"mk-controls-container-controls-larger":"mk-controls-container-controls-normal"}_getTopRightControlsClass(){const t=(this._userLocationControl?1:0)+(this._mapTypeControl?1:0);return"mk-top-right-controls-container "+Rh[t]+" "+this._getSizeClass()}controlBounds(){const t=[];return[this._topRightControlsNode,this._bottomLeftControlsNode,this._bottomRightControlsNode].forEach((function(e){0!==e.children.length&&(e===this._bottomRightControlsNode?Array.prototype.push.apply(t,e.children):t.push(e))}),this),t.map((function(t){try{const e=t.element.getBoundingClientRect();if("none"===window.getComputedStyle(this._map.element).transform){const t=this._map.element.getBoundingClientRect();return new Bi(e.left-t.left,e.top-t.top,e.width,e.height)}return Bi.rectFromClientRect(e)}catch(t){return new Bi}}),this)}}function Fh(){return kt.isAutoNavi||kt.showMapsLogo}Nh.ZoomControl=rh,R.jsModules.userLocation?Nh.userLocation=R.jsModules.userLocation:R.addEventListener("load",(function t(e){e.jsModules.userLocation&&(Nh.userLocation=e.jsModules.userLocation,R.removeEventListener("load",t))}));const Uh=Nh;class Gh{constructor({container:t,fontSizeDidChange:e}){const i=document.createElement("div");this.element=i,t.appendChild(i),i.className="mk-font-size-detector",i.textContent="A",i.ariaHidden="true",this.fontSizeDidChange=e,CSS.supports("(font: -apple-system-body) and (-webkit-touch-callout: default)")?(this.defaultFontSize=this.currentFontSize=17,i.style.font="-apple-system-body"):(this.defaultFontSize=this.currentFontSize=16,i.style.fontSize="initial",i.style.fontFamily="sans-serif"),this.ratio=1,"undefined"!=typeof ResizeObserver&&(this.observer=new ResizeObserver((()=>this._sizeChanged())),this.observer.observe(i))}_sizeChanged(){if(!this.element)throw new Error;const t=parseInt(window.getComputedStyle(this.element).fontSize);if(isNaN(t)||t===this.currentFontSize)return;const e=Math.min(t/this.defaultFontSize,2);this.currentFontSize=this.defaultFontSize*e,this.ratio=e,this.fontSizeDidChange(this)}destroy(){this.observer&&(this.observer.disconnect(),this.observer=null),this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.element=null)}}let Bh=Math.random().toString(36);function Zh(t){if(t===Bh)return;Bh=t;const e="[MapKit] Authorization token is invalid.";if("string"!=typeof t)return void console.warn(e);const i=t.split(".");if(3!==i.length)return void console.warn(e);let n;try{i.pop(),n=i.map((t=>{return JSON.parse((e=t,window.atob(e)));var e}))}catch(t){return void console.warn(e)}"alg"in n[0]?"ES256"!==n[0].alg&&console.warn('[MapKit] Authorization token has incorrect "alg" value.'):console.warn('[MapKit] Authorization token has no "alg" value.'),"typ"in n[0]?"JWT"!==n[0].typ&&console.warn('[MapKit] Authorization token has incorrect "typ" value.'):console.warn('[MapKit] Authorization token has no "typ" value.'),"kid"in n[0]||console.warn('[MapKit] Authorization token has no "kid" value.');const o=Date.now(),s=1e3*parseInt(n[1].iat);if(!("iat"in n[1])||isNaN(s)?console.warn('[MapKit] Authorization token has no "iat" value.'):s>o+36e5&&console.warn('[MapKit] Authorization token may have an "iat" value that is in the future ('+new Date(s)+")."),"exp"in n[1]){const t=1e3*parseInt(n[1].exp);(t<o||isNaN(t))&&console.warn('[MapKit] Authorization token may be expired according to its "exp" value.')}"origin"in n[1]||console.warn("[MapKit] Authorization token without origin restriction is not recommended in production environments.")}for(Object.defineProperties(bt.prototype,{forcedRenderingMode:{get:function(){return this._forcedRenderingMode}},didFallback:{get:function(){return this._syrupRequestedFallback}},fallbackType:{get:function(){return this._syrupRequestedFallbackType}},showMapsLogo:{get:function(){return this._showMapsLogo}},showLegalLink:{get:function(){return this._showLegalLink}},showsTileInfo:{get:function(){return this._showsTileInfo}},canRunCSR:{get:function(){const t="CLIENT"===this.forcedRenderingMode||"HYBRID"===this.forcedRenderingMode,e="SERVER"===this.forcedRenderingMode;return!(!this.ready||e||this._disableCsr&&!t||this._syrupRequestedFallback)}},madabaDomains:{get:function(){return this.customMadabaUrl||!this._madabaDomains&&this._madabaBaseUrl?[this._madabaBaseUrl]:this._madabaDomains?this._madabaDomains:null}}}),bt.prototype.syrupRequestedFallback=function(t){this._syrupRequestedFallback=!0,this._syrupRequestedFallbackType=t,setTimeout((()=>{const t=new T.Event(this.Events.Changed);t.status=bt.ChangeStatus.Refreshed,this.dispatchEvent(t)}),0)},bt.prototype.getMadabaDomainFromStringHash=function(t){const e=function(t){let e=0,i=t.length;for(;i--;)e+=t.charCodeAt(i);return e}(t);return this.madabaDomains[e%this.madabaDomains.length]},bt.prototype._parseMapData=function(){const t=this._data;this.customMadabaUrl||!t.madabaBaseUrl&&!t.madabaDomains||(this._madabaBaseUrl=t.madabaBaseUrl,this._madabaDomains=t.madabaDomains&&t.madabaDomains.length&&t.madabaDomains.map((t=>t.match(/^(https?:)?\/\//)?t:-1!==t.indexOf(":")&&this.proxyPrefixes?"http://"+t:bt.PROTOCOL+"//"+t))),this._disableCsr=!!t.disableCsr;const e={};t.attributions&&t.attributions.forEach((function(t){e[t.attributionId]=t,this.tileGroup=t.attributionId}),this);const i={};t.tileSources.forEach((t=>{const n=t.tileSource;i[n]={name:n,path:t.path,domains:t.domains,proxyPrefixes:this.proxyPrefixes,withCredentials:this.withCredentials,crossOrigin:!0,protocol:t.protocol||(this.proxyPrefixes&&-1!==t.domains[0].indexOf(":")?"http:":"https:"),attribution:e[t.attributionId],minZoomLevel:t.minZoomLevel,maxZoomLevel:t.maxZoomLevel,supportedSizes:t.supportedSizes,supportedResolutions:t.supportedResolutions,showPrivacyLink:t.showPrivacyLink,showTermsOfUseLink:t.showTermsOfUseLink},i[n].attribution&&i[n].attribution.global&&(i[n].attribution.name=i[n].attribution.global[0].name,i[n].attribution.url=i[n].attribution.global[0].url)})),this.types={},this.rasterTilesForSyrup={};for(const e in t.modes){const n=t.modes[e].layers;this.types[e]={name:e,provider:this.tileProvider,countryCode:this.countryCode,lowResolutionTileSource:i[n[0].lowResTileSource],tileSources:n.map((t=>i[t.tileSource]))},this.rasterTilesForSyrup[e]={name:e,provider:this.tileProvider,countryCode:this.countryCode,tileSources:n.map((t=>i[t.tileSource]))}}},kt._data&&kt._parseMapData(),bt.prototype._checkJwtToken=Zh;kt._jwtTokensToCheck.length;){const t=kt._jwtTokensToCheck.shift();kt._checkJwtToken(t)}const Wh=En,Kh=hi.CoordinateRegion,Hh=hi.Coordinate,jh=hi.MapPoint,Vh=hi.MapSize,qh=hi.MapRect,Yh=Co.supportsTouches,Xh=new qh(0,0,1,1),$h="mk-panning",Jh="mk-dragging-cursor",Qh="mk-dragging-annotation",tc="InitializedWithoutConfiguration",ec="Initialized",ic="ReadyWithoutConfiguration",nc="Ready",oc="Rendered",sc="Switched",ac="Destroyed",rc={padding:"rw",isScrollEnabled:"rw",isZoomEnabled:"rw",center:"rw",region:"rw",rotation:"rw",isRotationEnabled:"rw",showsCompass:"rw",visibleMapRect:"rw",tintColor:"rw",annotations:"rw",selectedAnnotation:"rw",overlays:"rw",selectedOverlay:"rw",showsUserLocation:"rw",tracksUserLocation:"rw",mapType:"rw",contextType:"rw",colorScheme:"rw",_allowWheelToZoom:"rw",_allowWheelToZoom2:"rw",_showsDefaultTiles:"rw",_internalAppDelegate:"rw",loadPriority:"rw",showsPointsOfInterest:"rw",showsMapTypeControl:"rw",showsZoomControl:"rw",showsScale:"rw",showsUserLocationControl:"rw",pointOfInterestFilter:"rw",annotationForCluster:"rw",cameraDistance:"rw",cameraZoomRange:"rw",cameraZoomLimit:"rw",cameraBoundary:"rw",distances:"rw",tileOverlays:"rw",selectableMapFeatures:"rw",selectableMapFeatureSelectionAccessory:"rw",annotationForMapFeature:"rw",_unifiedCanvas:"rw",_textZoom:"rw",element:"ro",userLocationAnnotation:"ro"};function lc(t,e){return new Error(1===e.length?`[MapKit] mapkit.Map.${t} is available after loading the following library: ${e.join(", ")}.`:`[MapKit] mapkit.Map.${t} is available after loading one of the following libraries: ${e.join(", ")}.`)}const hc=kt.performanceMarkers.loading,cc=kt.performanceMarkers.rendering,dc=kt.performanceMarkers["frame-updates"];function uc(t,e,i){hc&&performance.mark("mapkit-map-start"),kt.state!==kt.States.UNINITIALIZED&&Gr(),kt.state===kt.States.READY?this.state=ec:this.state=tc;try{(e=this._checkParent(e))&&(this._bootstrapSize=new Ui(e.offsetWidth,e.offsetHeight)),this.public=t,uc.maps.push(this.public),i=v(i),this._checkOptions(i),void 0!==i._internalAppDelegate&&(this.public._internalAppDelegate=i._internalAppDelegate),this._setDefaultState(i),this._setupScene(),this._setupRenderTree(),this._setupControllers(i);const n=void 0!==i.isRotationEnabled;this._setIsRotationEnabled(!n||i.isRotationEnabled,n),void 0!==i.selectableMapFeatures&&(this.selectableMapFeatures=i.selectableMapFeatures),void 0!==i.selectableMapFeatureSelectionAccessory&&(this.selectableMapFeatureSelectionAccessory=i.selectableMapFeatureSelectionAccessory),this._flushToDOM(e),this._handleOptions(i,e),this._setupListeners(),ue.scheduleOnNextFrame(this)}catch(t){throw t}finally{0,hc&&performance.measure("mapkit-map-constructor","mapkit-map-start")}}dc&&so.setPerformanceMeasureName("mapkit-dom-update-frame"),uc.maps=[];const pc="mk-dark-mode",mc="zoom-start",gc="zoom-end",_c="select",fc="deselect",yc="region-change-start",vc="region-change-end",wc="scroll-start",bc="scroll-end",Cc="map-type-change",kc="rotation-start",Mc="rotation-change",Sc="rotation-end",Lc="single-tap",Ac="double-tap",Ec="long-press",xc="map-node-change",Tc="map-node-ready",Ic="complete",Rc="error",Oc="start-up-complete";function Pc(t){t.selected=!0,this._logWithMap(ze.Events.AnnotationClick)}function Dc(t,e,i,n){if(!m(t,e))throw new Error("[MapKit] Unknown value for `"+i+"`. Choose from "+n+".")}function zc(t,e){const i=new St.Event(t),n=e.locationInElement();return i.pointOnPage=new DOMPoint(n.x,n.y),i.domEvents=e.domEvents.slice(),i}uc.MapTypes=vn,uc.Distances={Adaptive:"adaptive",Metric:"metric",Imperial:"imperial"},uc.ColorSchemes=Ot,uc.LoadPriorities=Sn,uc.MapProperties=rc,uc.prototype={constructor:uc,_showsUserLocation:!1,_tracksUserLocation:!1,_tintColor:"",_annotationForCluster:null,_emphasis:An,get padding(){return this._padding.copy()},set padding(t){if(f(t,$o,"[MapKit] The `padding` parameter passed to `Map.padding` is not a Padding."),this._padding.equals(t))return;this._padding=t.copy();const e=this.ensureRenderingFrame();if(!e.equals(Bi.Zero)){this.rotation=0;const t=this._mapRectAccountingForPadding(),i=t.midX(),n=t.midY();this._setRenderingFrameValue(e);const o=this._mapRectAccountingForPadding(),s=i-o.midX(),a=n-o.midY(),r=new qh(o.minX()+s,o.minY()+a,o.size.width,o.size.height);this.setVisibleMapRectAnimated(r,!1)}this.controlsLayer&&this.controlsLayer.mapPaddingDidChange(this._adjustedPadding)},get isScrollEnabled(){return this._mapNode.pannable},set isScrollEnabled(t){this._mapNode.pannable=!!t,this._mapUserInteractionController.updateGestureEnableState()},get isZoomEnabled(){return this._mapNode.zoomable},set isZoomEnabled(t){this._mapNode.zoomable=!!t,this.controlsLayer&&this.controlsLayer.updateZoomControl(),this._mapUserInteractionController.updateGestureEnableState()},get snapsToIntegralZoomLevels(){return this._mapNode.snapsToIntegralZoomLevels},set snapsToIntegralZoomLevels(t){this._mapNode.snapsToIntegralZoomLevels=!!t},get showsZoomControl(){return this._showsZoomControl},set showsZoomControl(t){(t=!!t)!==this._showsZoomControl&&(this._showsZoomControl=t,this.controlsLayer&&(this.controlsLayer.updateZoomControl(),this.controlsLayer.updateScale()))},get showsScale(){return this._showsScale},set showsScale(t){m(t,Wh)?t!==this._showsScale&&(this._showsScale=t,this.controlsLayer&&this.controlsLayer.updateScale()):console.warn("[MapKit] value passed to `Map.showsScale` setter must be part of the mapkit.FeatureVisibility enum.")},get mapType(){return this._mapType},set mapType(t){t!==this._mapType&&(Dc(t,uc.MapTypes,"mapType","Map.MapTypes"),this._setMapTypeAndEmphasis(t,this._emphasis))},getMapTypeWithEmphasis:function(){return this._mapType===uc.MapTypes.Standard&&this._emphasis===Ln?uc.MapTypes.MutedStandard:this._mapType},setMapTypeWithEmphasis:function(t){let e=An;t===uc.MapTypes.MutedStandard?(t=uc.MapTypes.Standard,e=Ln):Dc(t,uc.MapTypes,"mapType","Map.MapTypes"),e===this._emphasis&&t===this._mapType||this._setMapTypeAndEmphasis(t,e)},_setMapTypeAndEmphasis:function(t,e){this._mapType=t,this._emphasis=e,this._annotationsController&&this._annotationsController.mapTypeDidChange(),this._updateMapNodeTintAndEmphasis(this._mapNode),this._mapNodeController.handleMapConfigurationChange(),this.controlsLayer&&this.controlsLayer.update(),this.public.dispatchEvent(new St.Event(Cc)),this._logWithMap(ze.Events.MapTypeChange)},get distances(){return this._distances},set distances(t){t!==this._distances&&(Dc(t,uc.Distances,"distances","Map.Distances"),this._distances=t,this.controlsLayer&&this.controlsLayer.updateScale())},get colorScheme(){return this._colorScheme},set colorScheme(t){t!==this._colorScheme&&(Dc(t,uc.ColorSchemes,"colorScheme","Map.ColorSchemes"),this._colorScheme===Ot.Adaptive&&(this._colorSchemeHandle.removeEventListener("change",this._boundDarkModeDidChange),Dt.removeHandle(this._colorSchemeHandle),this._colorSchemeHandle=null),this._colorScheme=t,t===Ot.Adaptive&&(this._colorSchemeHandle=Dt.addHandle(),this._boundDarkModeDidChange=()=>this._updateMapNodeTintAndEmphasis(this._mapNode),this._colorSchemeHandle.addEventListener("change",this._boundDarkModeDidChange)),this._updateMapNodeTintAndEmphasis(this._mapNode))},currentColorScheme:null,tint:null,get tileTint(){return this._mapNode.tileTint},get _allowWheelToZoom(){return this._mapNode.allowWheelToZoom},set _allowWheelToZoom(t){this._mapNode.allowWheelToZoom=t},get _allowWheelToZoom2(){return this._mapNode.allowWheelToZoom2},set _allowWheelToZoom2(t){this._mapNode.allowWheelToZoom2=t},get loadPriority(){return this._mapNodeController.loadPriority},set loadPriority(t){m(t,uc.LoadPriorities)?this._mapNodeController.loadPriority=t:console.warn("[MapKit] Unknown value for `loadPriority`. Choose from mapkit.Map.LoadPriorities.")},get _showsTileInfo(){return this._mapNode._impl.debug},set _showsTileInfo(t){this._mapNode._impl.debug=t},get _showsDefaultTiles(){return this._mapNode.showsDefaultTiles},set _showsDefaultTiles(t){this._mapNode.showsDefaultTiles=t},get tileOverlays(){return this._mapNode.tileOverlays},set tileOverlays(t){this._mapNode.tileOverlays=t,this.controlsLayer&&this.controlsLayer.updateZoomControl()},addTileOverlay:function(t){if(!this._overlaysController)throw lc("addTileOverlay",["overlays"]);const e=this._mapNode.addTileOverlay(t);return this.controlsLayer&&this.controlsLayer.updateZoomControl(),e},addTileOverlays:function(t){if(!this._overlaysController)throw lc("addTileOverlays",["overlays"]);const e=this._mapNode.addTileOverlays(t);return this.controlsLayer&&this.controlsLayer.updateZoomControl(),e},removeTileOverlay:function(t){if(!this._overlaysController)throw lc("removeTileOverlay",["overlays"]);const e=this._mapNode.removeTileOverlay(t);return this.controlsLayer&&this.controlsLayer.updateZoomControl(),e},removeTileOverlays:function(t){if(!this._overlaysController)throw lc("removeTileOverlays",["overlays"]);const e=this._mapNode.removeTileOverlays(t);return this.controlsLayer&&this.controlsLayer.updateZoomControl(),e},get showsMapTypeControl(){return this._showsMapTypeControl},set showsMapTypeControl(t){(t=!!t)!==this._showsMapTypeControl&&(this._showsMapTypeControl=t,this.controlsLayer&&this.controlsLayer.updateMapTypeControl())},get showsUserLocationControl(){return!!this._userLocationController&&this._showsUserLocationControl},set showsUserLocationControl(t){if((t=!!t)!==this._showsUserLocationControl){if(!this._userLocationController)throw lc("showsUserLocationControl",["user-location"]);this._showsUserLocationControl=t,this.controlsLayer&&(this.controlsLayer.updateUserLocationControl(),this.controlsLayer.updateScale())}},get showsPointsOfInterest(){return null===this.pointOfInterestFilter||null===this.pointOfInterestFilter._includes&&0===this.pointOfInterestFilter._excludes.length},set showsPointsOfInterest(t){if(t){if(null===this.pointOfInterestFilter)return;this.pointOfInterestFilter=null}else{if(this.pointOfInterestFilter===Tt.filterExcludingAllCategories)return;this.pointOfInterestFilter=Tt.filterExcludingAllCategories}},get pointOfInterestFilter(){return this._mapNode.pointOfInterestFilter},set pointOfInterestFilter(t){null!==t&&f(t,Tt,"[MapKit] Value passed to `Map.pointOfInterestFilter` setter must be an instance of mapkit.PointOfInterestFilter."),this._mapNode.pointOfInterestFilter=t,this._mapNodeController.setPointOfInterestFilter(t)},setPoiFiltered:function(t,e){this._mapNode.setPoiFiltered(t,e)},get element(){return this.rootNode&&this.rootNode.element},set element(t){console.warn("[MapKit] The `element` property is read-only.")},get renderingMapRect(){return this._mapNode.visibleMapRect},get visibleMapRect(){return this._visibleMapRect||(this._visibleMapRect=this._mapRectAccountingForPadding()),this._visibleMapRect},set visibleMapRect(t){this.setVisibleMapRectAnimated(t,!1)},setVisibleMapRectAnimated:function(t,e,i){g(t,"[MapKit] Missing `visibleMapRect` parameter in call to `Map.setVisibleMapRectAnimated()`."),f(t,qh,"[MapKit] The `visibleMapRect` parameter passed to `Map.setVisibleMapRectAnimated()` is not a MapRect.");const n=this.ensureRenderingFrame();if(0===n.size.width||0===n.size.height)this._visibleMapRect=t;else{delete this._visibleMapRect;const e=this._visibleFrame;let i=t;const o=this._adjustedPadding;if(!o.equals($o.Zero)){const s=n.size.width/e.size.width,a=n.size.height/e.size.height;i=new qh(t.minX()-o.left*s*t.size.width,t.minY()-o.top*a*t.size.height,t.size.width*s,t.size.height*a)}const s=new jh(t.midX(),t.midY());let a=hi.zoomLevelForMapRectInViewport(i,n.size,hi.tileSize);a=u(this._mapNode.snapsToIntegralZoomLevels?Co.getIntegralZoom(a):a,this.minZoomLevel,this.maxZoomLevel);const r=Math.pow(2,Math.ceil(a))*(hi.tileSize*Math.pow(2,a-Math.ceil(a))),l=new Vh(e.size.width/r,e.size.height/r);t=new qh(s.x-l.width/2,s.y-l.height/2,l.width,l.height)}return e=null==e||!!e,this._setVisibleMapRect(t,e,i),delete this._delayedShowItems,this.public},get region(){return this.visibleMapRect.toCoordinateRegion()},set region(t){this.setRegionAnimated(t,!1)},setRegionAnimated:function(t,e,i){return g(t,"[MapKit] Tried to set `Map.region` property to a non-existent value."),f(t,Kh,"[MapKit] Region passed to `Map.region` setter is not a CoordinateRegion."),this.region.equals(t)||this.setVisibleMapRectAnimated(t.toMapRect(),e,i),this.public},get isRotationAvailable(){return"HYBRID"===kt.forcedRenderingMode||"CLIENT"===kt.forcedRenderingMode?!kt.didFallback&&this.csrCapable:kt.ready||kt.didFallback?kt.canRunCSR&&this.csrCapable:this.csrCapable},set isRotationAvailable(t){console.warn("[MapKit] Map.isRotationAvailable is a read-only property")},get isRotationEnabled(){return this._mapNode.isRotationEnabled},set isRotationEnabled(t){this._setIsRotationEnabled(t,!0)},get isRotationLocked(){return this._mapNode.isRotationLocked},get rotation(){return this._mapNode.rotation},set rotation(t){this.setRotationAnimated(t,!1),this.controlsLayer&&this.controlsLayer.updateRotationControl()},get heading(){const t=this._mapNode.rotation;return 0===t?0:360-t},get showsCompass(){return this.usingCSR?this._showsCompass:Wh.Hidden},set showsCompass(t){m(t,Wh)?(this.isRotationEnabled||t!==Wh.Visible&&t!==Wh.Adaptive||console.warn("[MapKit] The compass cannot be shown when `Map.isRotationEnabled` is false."),this._usingDefaultShowsCompassValue=!1,t!==this._showsCompass&&(this._showsCompass=t,this.controlsLayer&&this.controlsLayer.updateRotationControl())):console.warn("[MapKit] value passed to `Map.showsCompass` setter must be part of the MapKit.FeatureVisibility enum.")},get usingCSR(){return!this._mapNodeController.usingSSR},compassRotate(t,e){if(e){if(this.isRotationLocked){const e=c(t,360),i=Co.restrictRotation(e);t=e<180?i+.025*(e-i):i-.025*(i-e)}Math.abs(t)<5&&(t=0)}else this.isRotationLocked&&(t=Co.restrictRotation(c(t,360)));return this.setRotationAnimated(t,!1,!0),t},setRotationAnimated:function(t,e,i){if(!this.isRotationAvailable)return void console.warn("[MapKit] Rotation is not available.");if(g(t,"[MapKit] Tried to set `Map.rotation` property to a non-existent value."),"number"!=typeof t||!isFinite(t))return void console.warn("[MapKit] Argument for `Map.rotation` is not a finite number.");const n=this.forcedInteractionCenter?this.forcedInteractionCenter:this._centerMapPoint(),o=c(t,360)-this._mapNode.getRotation();if(!o)return;const s=(e||null==e||!i)&&this.mapCanStartRotating();if((e||null==e)&&s){const t=this.camera.copy();t.rotateAroundCenter(n,o),this._mapNode.setCameraAnimated(t,!0,n)}else(s||i)&&this._mapNode.rotateCameraAroundMapPoint(n,o),i||this.mapDidStopRotating();return this.public},get center(){return this._centerMapPoint().toCoordinate()},set center(t){this.setCenterAnimated(t,!1)},setCenterAnimated:function(t,e,i){g(t,"[MapKit] Tried to set `Map.center` property to a non-existent value."),f(t,Hh,"[MapKit] Value passed to `Map.center` setter is not a Coordinate object.");const n=this.ensureRenderingFrame();if(0!==n.size.width&&0!==n.size.height){const e=this._offsetCenterWithPaddingAndRotation(t.toMapPoint(),-1);e&&(t=e.toCoordinate())}return this._mapNode.setCenterAnimated(t,null==e||!!e),delete this._visibleMapRect,i||(this.tracksUserLocation=!1),this.public},get cameraZoomLevelLimit(){return this._mapNode.cameraZoomLimit},set cameraZoomLevelLimit(t){this.setCameraZoomLevelLimitAnimated(t,!1)},setCameraZoomLevelLimitAnimated:function(t,e){return this._mapNode.setCameraZoomLevelLimitAnimated(t,null==e||!!e),this.public},get cameraZoomRange(){return this._mapNode.cameraZoomRange},set cameraZoomRange(t){this.setCameraZoomRangeAnimated(t,!1)},setCameraZoomRangeAnimated:function(t,e){return null!=t&&f(t,hi.CameraZoomRange,"[MapKit] Expected a `mapkit.CameraZoomRange` object for `Map.cameraZoomRange`, but got `"+t+"` instead."),this._mapNode.setCameraZoomRangeAnimated(t,null==e||!!e),this.public},get cameraDistance(){return this._mapNode.getCurrentCameraDistance()},set cameraDistance(t){this.setCameraDistanceAnimated(t,!1)},setCameraDistanceAnimated:function(t,e){if(!(t>=0))throw new Error("[MapKit] Expected a number for Map.cameraDistance, but got `"+t+"` instead");return this._mapNode.setCameraDistanceAnimated(t,null==e||!!e),this.public},get cameraBoundary(){const t=this._cameraBoundary;return t?{region:t.toCoordinateRegion?t.toCoordinateRegion():t.copy(),mapRect:t.toMapRect?t.toMapRect():t.copy()}:null},set cameraBoundary(t){this.setCameraBoundaryAnimated(t,!1)},setCameraBoundaryAnimated:function(t,e){let i=null;if(null==t)delete this._cameraBoundary;else if(t instanceof Kh)i=t.toMapRect(),this._cameraBoundary=t.copy();else{if(!(t instanceof qh))throw new Error("[MapKit] `Map.cameraBoundaryRect` expected a CoordinateRegion or a MapRect, but got `"+t+"` instead.");i=t,this._cameraBoundary=i.copy()}const n=this._centerMapPoint();return this._mapNode.setCameraBoundaryAnimated(i,null==e||!!e),this.tracksUserLocation&&!this._mapNode.isMapPointWithinBounds(n)&&(this.tracksUserLocation=!1),this.public},get overlays(){return this._overlaysController?this._overlaysController.items:[]},set overlays(t){if(!this._overlaysController)throw lc("overlays",["overlays"]);this._overlaysController.items=t},get selectedOverlay(){return this._overlaysController?this._overlaysController.selectedItem:null},set selectedOverlay(t){if(!this._overlaysController)throw lc("selectedOverlay",["overlays"]);this._overlaysController.selectedItem=t},addOverlay:function(t){if(this._overlaysController)return this._overlaysController.addItem(t);throw lc("addOverlay",["overlays"])},addOverlays:function(t){if(this._overlaysController)return this._overlaysController.addItems(t),t;throw lc("addOverlays",["overlays"])},removeOverlay:function(t){if(this._overlaysController)return this._overlaysController.removeItem(t);throw lc("removeOverlay",["overlays"])},removeOverlays:function(t){if(this._overlaysController)return this._overlaysController.removeItems(t);throw lc("removeOverlays",["overlays"])},topOverlayAtPoint:function(t){if(!this._overlaysController)throw lc("topOverlayAtPoint",["overlays"]);f(t,window.DOMPoint,"[MapKit] Map.topOverlayAtPoint expected a DOMPoint, but got `"+t+"` instead.");const e=this.rootNode.convertPointFromPage(t),i=this._overlaysController.pickableItemsCloseToPoint(this.overlays,e,0),n=this.selectedOverlay;return n&&i.indexOf(n)>0?n:i[0]},overlaysAtPoint:function(t){if(!this._overlaysController)throw lc("overlaysAtPoint",["overlays"]);f(t,window.DOMPoint,"[MapKit] Map.overlaysAtPoint expected a DOMPoint, but got `"+t+"` instead.");const e=this.rootNode.convertPointFromPage(t);return this._overlaysController.pickableItemsCloseToPoint(this.overlays,e,0).reverse()},get annotations(){if(this._annotationsController)return this._annotationsController.items;throw lc("annotations",["annotations"])},set annotations(t){if(!this._annotationsController)throw lc("annotations",["annotations"]);this._annotationsController.items=t},get selectedAnnotation(){if(this._annotationsController)return this._annotationsController.selectedItem;throw lc("selectedAnnotation",["annotations"])},set selectedAnnotation(t){if(!this._annotationsController)throw lc("selectedAnnotation",["annotations"]);this._annotationsController.selectedItem=t},addAnnotation:function(t){if(this._annotationsController)return this._annotationsController.addItem(t);throw lc("addAnnotation",["annotations"])},addAnnotations:function(t){if(this._annotationsController)return this._annotationsController.addItems(t);throw lc("addAnnotations",["annotations"])},removeAnnotation:function(t){if(this._annotationsController)return this._annotationsController.removeItem(t);throw lc("removeAnnotation",["annotations"])},removeAnnotations:function(t){if(this._annotationsController)return this._annotationsController.removeItems(t);throw lc("removeAnnotations",["annotations"])},showItems:function(t,e){if(!uc.LayerItemsController||!uc.ItemCollection)throw lc("showItems",["annotations","overlays","user-location"]);const i=new uc.ItemCollection(t).getFlattenedItemList();e=uc.LayerItemsController.checkShowItemsParameters(i,e);const n=[],o=[];return i.forEach((function(t){uc.OverlaysController&&t instanceof uc.OverlaysController.Overlay&&!t.map&&(t._impl._map=this.public,n.push(t)),uc.AnnotationsController&&t instanceof uc.AnnotationsController.Annotation&&this._annotationsController&&this._annotationsController.preAddedAnnotation(t)&&o.push(t)}),this),this.isRooted()&&uc.LayerItemsController.setRegionForItems(this,i,e)||(this._delayedShowItems=[i,e]),n.forEach((t=>{delete t._impl._map})),o.forEach((t=>this._annotationsController.resetAnnotation(t))),this._addItems(i),t},addItems:function(t){if(!uc.ItemCollection)throw lc("addItems",["annotations","overlays","user-location"]);const e=new uc.ItemCollection(t).getFlattenedItemList();return this._addItems(e),t},removeItems:function(t){if(!uc.ItemCollection)throw lc("removeItems",["annotations","overlays","user-location"]);const e=new uc.ItemCollection(t).getFlattenedItemList(),i=[],n=[];return e.forEach((function(t,e){const o=uc.OverlaysController&&t instanceof uc.OverlaysController.Overlay,s=uc.AnnotationsController&&t instanceof uc.AnnotationsController.Annotation;if(!o&&!s)throw new Error("[MapKit] Map.removeItems expected an Annotation, Overlay, ItemCollection, or Array of valid items at index "+e+", but got `"+t+"` instead.");o?i.push(t):n.push(t)}),this),this.removeOverlays(i),this.removeAnnotations(n),t},addLayerAbove:function(t,e){return this._mapNodeController.addLayerAbove(t,e)},addLayerBelow:function(t,e){return this._mapNodeController.addLayerBelow(t,e)},removeLayer:function(t){return this._mapNodeController.removeLayer(t)},requireRender:function(){return this._mapNodeController.requireRender()},annotationsInMapRect:function(t){if(this._annotationsController)return this._annotationsController.annotationsInMapRect(t);throw lc("annotationsInMapRect",["annotations"])},updateSize:function(t){return console.warn("[MapKit] Map resizing is now automatic, the Map.updateSize() method has been deprecated and will be removed in a future version."),this.public},convertCoordinateToPointOnPage:function(t){f(t,Hh,"[MapKit] Map.convertCoordinateToPointOnPage expected a Coordinate, but got `"+t+"` instead.");const e=t.toMapPoint();e.x<this.camera.minX()&&(e.x+=1);const i=this.camera.transformMapPoint(e),n=this.rootNode.convertPointToPage(i);return new window.DOMPoint(n.x,n.y)},convertPointOnPageToCoordinate:function(t){f(t,window.DOMPoint,"[MapKit] Map.convertPointOnPageToCoordinate expected a DOMPoint, but got `"+t+"` instead.");const e=this.camera.transformGestureCenter(this.rootNode.convertPointFromPage(new Gi(t.x,t.y))),i=this.renderingMapRect.origin;return new Hh(hi.convertYToLatitude(i.y+e.y/this.worldSize),hi.convertXToLongitude(i.x+e.x/this.worldSize))},get showsUserLocation(){return!!this._userLocationController&&this._userLocationController.showsUserLocation},set showsUserLocation(t){if((t=!!t)!==this.showsUserLocation){if(!this._userLocationController)throw lc("showsUserLocation",["user-location"]);this._userLocationController.showsUserLocation=t,t||(this._removeUserLocationDisplay(),this.tracksUserLocation=!1),this.showsUserLocationControl&&this.controlsLayer&&(this.controlsLayer.updateUserLocationControl(),this.controlsLayer.updateScale())}},get userLocationAnnotation(){return this._userLocationController?this._annotationsController.userLocationAnnotation:null},get tracksUserLocation(){return!!this._userLocationController&&this._userLocationController.tracksUserLocation},set tracksUserLocation(t){if((t=!!t)!==this.tracksUserLocation){if(!this._userLocationController)throw lc("tracksUserLocation",["user-location"]);this._userLocationController.tracksUserLocation=t,this._mapNode.usesInteractionCenter=!(!t&&!this.forcedInteractionCenter),t?this.showsUserLocation=!0:this.userLocationAnnotation||(this.showsUserLocation=!1),this._firstCameraUpdateToTrackUserLocationPending=t,this._updateCameraToTrackUserLocation(this._userLocationController.userLocation),this._userLocationController.tracksUserLocation===t&&(this.controlsLayer&&this.controlsLayer.updateUserLocationControl(),this._userLocationTrackingDelegate&&"function"==typeof this._userLocationTrackingDelegate.mapUserLocationTrackingDidChange&&this._userLocationTrackingDelegate.mapUserLocationTrackingDidChange(this.public))}},_forcedInteractionCenter:null,get forcedInteractionCenter(){return this._forcedInteractionCenter},set forcedInteractionCenter(t){this._forcedInteractionCenter=t,this._mapNode.usesInteractionCenter=!(!this.tracksUserLocation&&!t)},get tintColor(){return this._tintColor},set tintColor(t){if(t!==this._tintColor){if(null!=t){if(_(t,"string","[MapKit] Expected a string value for Map.tintColor, but got `"+t+"` instead"),""!==t&&!Co.isValidCSSColor(t))return void console.warn("[MapKit] value passed to `Map.tintColor` is not a valid color value. Ignoring: "+t);this._tintColor=t}else delete this._tintColor;this.controlsLayer&&this.controlsLayer.update()}},get tintColorForControls(){return Co.darkColorScheme(this.mapNodeTint)?"":this._tintColor},get minZoomLevel(){return this._mapNode.minZoomLevel},get maxZoomLevel(){return this._mapNode.maxZoomLevel},get zoomLevel(){return this._mapNode.zoomLevel},get canZoomIn(){const t=this.snapsToIntegralZoomLevels?Math.floor(this.maxZoomLevel):this.maxZoomLevel-.01;return this.zoomLevel<t},get canZoomOut(){const t=this.snapsToIntegralZoomLevels?Math.ceil(this.minZoomLevel):this.minZoomLevel+.01;return this.zoomLevel>t},shouldDispatchRotationChangeEvent:!1,set zoomLevel(t){this._mapNode.zoomLevel=t},get worldSize(){return hi.pointsPerAxis(this._mapNode.zoomLevel)},get camera(){return this._mapNodeController.node.camera},get cameraIsPanning(){return this._mapNode.cameraIsPanning},get cameraIsZooming(){return this._mapNode.cameraIsZooming},get cameraIsRotating(){return this._mapNode.cameraIsRotating},get cameraIsAnimating(){return this._mapNode.cameraIsAnimating},get cameraIsMoving(){return this.cameraIsPanning||this.cameraIsZooming||this.cameraIsRotating||this.cameraIsAnimating},get _mapNode(){return this._mapNodeController.node},get csrCapable(){return this._mapNodeController.csrCapable},destroy:function(){if(this.state===ac)return void console.warn("[MapKit] Map was already destroyed.");this.state=ac,this._annotationsController&&this.removeAnnotations(this.annotations),this._overlaysController&&this.removeOverlays(this.overlays),this._stopStabilizationTimeout(),this._linearZoomController.stop(),this.showsUserLocation&&this._removeUserLocationDisplay(),this.controlsLayer&&(this.controlsLayer.mapWasDestroyed(),this.controlsLayer=null),this._mapUserInteractionController.mapWasDestroyed(),this._overlaysController&&this._overlaysController.mapWasDestroyed(),this._annotationsController&&this._annotationsController.mapWasDestroyed(),this._userLocationController&&this._userLocationController.mapWasDestroyed(),this._linearZoomController._delegate=null,this._colorSchemeHandle&&(Dt.removeHandle(this._colorSchemeHandle),this._colorSchemeHandle=null),kt.removeEventListener(kt.Events.Changed,this),Oi.removeEventListener(Oi.Events.LocaleChanged,this),this._boundDevicePixelRatioDidChange&&(this._dppxMediaQueryList.removeListener(this._boundDevicePixelRatioDidChange),this._dppxMediaQueryList=null,this._boundDevicePixelRatioDidChange=null),this._iframe&&(this._iframe.removeEventListener("load",this),this._iframe.contentWindow&&this._iframe.contentWindow.removeEventListener("resize",this),this.element.removeChild(this._iframe),this._iframe=null),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null),this._mapNodeController.destroy(),this._mapRoot.remove(),this._mapRoot=null,this._scene.destroy(),this._scene=null,this._removePrintListener(),this.textZoom&&(this.textZoom=!1),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.rootNode.remove(),this.rootNode=null;const t=uc.maps.indexOf(this.public);t>=0&&uc.maps.splice(t,1)},adjustMapItemPoint:function(t){return this._mapNode.adjustMapItemPoint(t)},get annotationForCluster(){return this._annotationForCluster},set annotationForCluster(t){if(null==t)delete this._annotationForCluster;else{if("function"!=typeof t)throw new Error("[MapKit] annotationForCluster must be a function or null");this._annotationForCluster=t}},selectionMayChange:!0,get selectableMapFeatures(){return this._selectableMapFeatures?kt.ready&&(kt.didFallback||!kt.canRunCSR)||!this.csrCapable||"SERVER"===kt.forcedRenderingMode?[]:this._selectableMapFeatures.slice():[]},set selectableMapFeatures(t){if(null==t)return delete this._selectableMapFeatures,void this._mapFeaturesLayerController.node.remove();if(!uc.MapFeatureType)throw lc("selectableMapFeatures",["annotations"]);y(t,"[MapKit] Map.selectableMapFeatures expected an array of values, but got `"+t+"` instead."),t.forEach((function(t){Dc(t,uc.MapFeatureType,"MapFeatureType","mapkit.MapFeatureType")}));const e=[];if(Object.values(uc.MapFeatureType).forEach((function(i){-1!==t.indexOf(i)&&e.push(i)})),0===e.length)return delete this._selectableMapFeatures,void this._mapFeaturesLayerController.node.remove();(!kt.ready||!kt.didFallback&&kt.canRunCSR)&&this.csrCapable&&"SERVER"!==kt.forcedRenderingMode||console.warn("[MapKit] Selectable map features is not available."),this._selectableMapFeatures=e,this._updateMapFeatureRegionLayer()},get selectableMapFeatureSelectionAccessory(){return this._selectableMapFeatureSelectionAccessory?this._selectableMapFeatureSelectionAccessory:null},set selectableMapFeatureSelectionAccessory(t){if(!uc.PlaceSelectionAccessory)throw lc("selectableMapFeatureSelectionAccessory",["annotations"]);null!==t&&f(t,uc.PlaceSelectionAccessory,"[MapKit] The `selectableMapFeatureSelectionAccessory` parameter passed to `Map.selectableMapFeatureSelectionAccessory` is not a PlaceSelectionAccessory."),this._selectableMapFeatureSelectionAccessory=t},get annotationForMapFeature(){return this._annotationForMapFeature},set annotationForMapFeature(t){if(null==t)delete this._annotationForMapFeature;else{if("function"!=typeof t)throw new Error("[MapKit] annotationForMapFeature must be a function or null");this._annotationForMapFeature=t}},handleEvent:function(t){const e=uc.ControlsLayer?uc.ControlsLayer.ZoomControl.EVENTS.ZOOM_START:void 0,i=uc.ControlsLayer?uc.ControlsLayer.ZoomControl.EVENTS.ZOOM_END:void 0;switch(t.type){case kt.Events.Initialized:Gr();break;case kt.Events.Changed:this._configurationDidBecomeAvailable();break;case e:this.zoomControlStart(t.zoomIn);break;case i:this.zoomControlEnd();break;case Oi.Events.LocaleChanged:this._handleLocaleChange(t);break;case"load":this._iframeDidLoad();break;case"resize":this._sizeDidChange()}},elementShouldPreventDragstart:function(t){return!!this._annotationsController&&!this._annotationsController.isElementInCustomCallout(t)},elementWantsDefaultBrowserBehavior:function(t,e,i){if(e&&i&&("touchstart"===e.type||"pointerdown"===e.type&&"touch"===e.pointerType)){if(1===i&&!this.isScrollEnabled)return!0;if(2===i&&!this.isZoomEnabled&&!this.isRotationEnabled)return!0}return!!this._annotationsController&&this._annotationsController.isElementInAccessory(t)},getEventTargetFromSubShadowDOM:function(t){const e=t.touches?t.touches[0].target:t.target;return Co.supportsShadowDOM&&this._annotationsController&&e===this._annotationsController.node.element&&this._annotationsController.getShadowDOMTargetFromEvent(t)||e},tileAccessForbidden:function(){kt.accessKeyHasExpired()},previousMapDidFinishRendering:function(t){hc&&performance.measure("mapkit-map-start-up-rendered","mapkit-map-start"),this.state!==ac&&this.public.dispatchEvent(new St.Event(Oc))},mapDidFinishRendering:function(t){this.state!==ac&&(this.state=oc,this._controlsLayer||setTimeout((()=>this._loadControlsLayer(!1))),this._mapNodeController.handleMapRendered(),this.addWaitingAnnotations(),this._startStabilizationTimeoutIfNeeded())},mapCanStartPanning:function(t){return this._panningWasPrevented?(delete this._panningWasPrevented,!1):!(this.tracksUserLocation&&this.cameraIsZooming||this._annotationsController&&this._annotationsController.dragging||this._isInitialInteractionTargetInUIElement()||!this.public.dispatchEvent(new St.Event(wc)))},mapWillStartPanning:function(t){this._stopStabilizationTimeout(),this.tracksUserLocation=!1,this.rootNode.classList.add($h),this.rootNode.classList.add(Jh),this._annotationsController&&this._annotationsController.node.classList.add($h),ze._trackPanEvent&&this._logWithMap(ze.Events.Pan)},mapWillStopPanning:function(t){this.rootNode.classList.remove(Jh)},mapDidStopPanning:function(t){this._startStabilizationTimeoutIfNeeded(),this.rootNode.classList.remove($h),this._annotationsController&&this._annotationsController.node.classList.remove($h),this.public.dispatchEvent(new St.Event(bc))},mapCanStartZooming:function(t){return!(this._isInitialInteractionTargetInUIElement()||!this.public.dispatchEvent(new St.Event(mc)))},mapWillStartZooming:function(t,e,i,n){this._stopStabilizationTimeout(),n&&(this.tracksUserLocation=!1),this._logWithMap(ze.Events.Zoom,{eventValue:e})},mapDidStopZooming:function(t){this._startStabilizationTimeoutIfNeeded(),this.public.dispatchEvent(new St.Event(gc)),this.controlsLayer&&this.controlsLayer.scaleDidChange()},mapCameraWillChange:function(t,e){this.mapNodeCameraBeforeChange=t.camera},mapCameraDidChange:function(t,e){if(this.state===ac)return;const i=this.mapNodeCameraBeforeChange;delete this.mapNodeCameraBeforeChange,delete this._visibleMapRect,this._mapNodeController.mapCameraDidChange(),this._overlaysController&&this._overlaysController.mapCameraDidChange(),this._annotationsController&&this._annotationsController.updateVisibleAnnotations();const n=!i||i.rotation!==t.camera.rotation;n&&this._dispatchRotationChangeEvent(),this.controlsLayer&&(this.controlsLayer.scaleDidChange(),n&&this.controlsLayer.updateRotationControl())},mapCameraChangesWillStart:function(t,e){this._mapFeaturesLayerController&&this._mapFeaturesLayerController.node.remove(),this._zoomLevelWhenCameraChangeStarted=this.zoomLevel,this._annotationsController&&this._annotationsController.mapRegionChangeWillStart(),this.public.dispatchEvent(new St.Event(yc))},mapCameraChangesDidEnd:function(t){this.state!==ac&&(this._zoomLevelWhenCameraChangeStarted!==this.zoomLevel&&this.controlsLayer&&this.controlsLayer.zoomLevelDidChange(),delete this._zoomLevelWhenCameraChangeStarted,this._annotationsController&&this._annotationsController.mapRegionChangeDidEnd(),this.public.dispatchEvent(new St.Event(vc)))},mapMinAndMaxZoomLevelsDidChange:function(t){this.controlsLayer&&this.controlsLayer.zoomLevelDidChange()},mapCanStartRotating:function(t){return this.public.dispatchEvent(new St.Event(kc))},mapRotationDidChange:function(t){this.controlsLayer&&this.controlsLayer.updateRotationControl(),this._dispatchRotationChangeEvent()},mapDidStopRotating:function(t){this.public.dispatchEvent(new St.Event(Sc))},mapCustomCanvasWillRender(t){this.state!==ac&&this._canvas2dLayer&&this._scene.flush()},mapInteractionCenter:function(t){return this._forcedInteractionCenter?this._forcedInteractionCenter:this._centerMapPoint()},mapTransformCenter:function(t){return this._centerMapPoint()},userWillTap:function(t){const e=t.locationInElement();if(this._isInitialInteractionTargetInUIElement())return void(Co.supportsTouches&&(this._delayedTapFunction=()=>this._elementWasTapped(this._mapUserInteractionController.initialEventTargetForCurrentInteraction)));const i=this.rootNode.convertPointFromPage(e),n=this._annotationsController?this._annotationsController.enabledItemCloseToPoint(i):void 0;if(n)return void(this._delayedTapFunction=()=>Pc.call(this,n));let o=!1;if(this._overlaysController){const t=this._overlaysController.enabledItemCloseToPoint(i);if(t){if(t!==this._overlaysController.userLocationAccuracyRingOverlay)return void(this._delayedTapFunction=()=>{t.selected=!0});o=!0}}if(this._annotationsController&&this._selectableMapFeatures&&this._mapNode.getMapFeatureRegions){const t=this._mapNode.getMapFeatureRegions(),e=-1!==this._selectableMapFeatures.indexOf(uc.MapFeatureType.PointOfInterest),n=-1!==this._selectableMapFeatures.indexOf(uc.MapFeatureType.Territory),o=-1!==this._selectableMapFeatures.indexOf(uc.MapFeatureType.PhysicalFeature),s=t.filter((t=>-1!==["Poi","Territory","PhysicalFeature"].indexOf(t.category)&&(!(!e&&"Poi"===t.category)&&(!(!n&&"Territory"===t.category)&&!(!o&&"PhysicalFeature"===t.category))))),a=this._annotationsController.mapFeatureRegionCloseToPoint(i,s);if(a){const t=this._annotationsController.getMapFeatureAnnotationForRegion(a,this.selectableMapFeatureSelectionAccessory);return void(this._delayedTapFunction=()=>{this._annotationsController.mapFeatureDidSelect(t),this._logWithMap(ze.Events.MapFeatureSelect,{eventValue:a.category})})}}if(o)return void(this._delayedTapFunction=()=>{const t=this.userLocationAnnotation;t&&Pc.call(this,t)});const s=zc(Lc,t);this._delayedTapFunction=()=>{this.public.dispatchEvent(s),s.defaultPrevented||(this._annotationsController&&(this._annotationsController.selectedItem=null),this._overlaysController&&(this._overlaysController.selectedItem=null))}},shouldDelaySingleTap:function(){return this.isZoomEnabled||this.public._listeners&&(this.public._listeners[Lc]&&this.public._listeners[Lc].length>0||this.public._listeners[Ac]&&this.public._listeners[Ac].length>0)},userDidTap:function(t){this._delayedTapFunction&&(this._delayedTapFunction(),delete this._delayedTapFunction)},userCanceledTap:function(t){delete this._delayedTapFunction},userDidDoubleTap:function(t){const e=t.modifierKeys.alt;(!this.isZoomEnabled||e&&this.zoomLevel===this._mapNode.minZoomLevel||!e&&this.zoomLevel===this._mapNode.maxZoomLevel)&&this.public.dispatchEvent(zc(Ac,t))},userDidLongPress:function(t){if(this._isInitialInteractionTargetInUIElement())return!1;const e=t.locationInElement(),i=this._annotationsController?this._annotationsController.enabledItemCloseToPoint(this.rootNode.convertPointFromPage(e),!0):void 0;if(!i){const e=zc(Ec,t);return this.public.dispatchEvent(e),e.defaultPrevented&&(this._panningWasPrevented=!0),Co.supportsTouches}return i._impl.isDraggable()&&!this.cameraIsMoving?(this._annotationsController.startDraggingAnnotation(i,e),!0):Co.supportsTouches?(Pc.call(this,i),!0):Co.supportsTouches},userMayStartPanningAfterLongPress:function(){delete this._panningWasPrevented},userDidPanAfterLongPress:function(t){this._annotationsController&&this._annotationsController.annotationDraggingDidChange(t)},userDidStopPanningAfterLongPress:function(t){this._annotationsController&&this._annotationsController.annotationDraggingDidEnd(t)},linearZoomControllerDidZoom:function(t){this.cameraIsZooming&&(this.zoomLevel=t,(t<=this.minZoomLevel&&!this._linearZoomController.zoomsIn||t>=this.maxZoomLevel&&this._linearZoomController.zoomsIn)&&this._mapNode.cameraDidStopZooming())},linearZoomControllerDidStop:function(){this._mapNode.cameraDidStopZooming()},userLocationDidChange:function(t){this._updateUserLocationDisplay(t.target),this.controlsLayer&&this.controlsLayer.userLocationDidChange(t.target),this.tracksUserLocation&&this._updateCameraToTrackUserLocation(t.target),this.public.dispatchEvent(t)},userLocationDidError:function(t){this._updateUserLocationDisplay(t.target),this.controlsLayer&&this.controlsLayer.userLocationDidError(t.target),this.public.dispatchEvent(t)},get mapNodeTint(){const t=this._mapNodeController&&this._mapNodeController.node;return t?t.tint:cn},isRooted:function(){return this.element&&this.element.ownerDocument.body.contains(this.element)},stopDraggingAnnotation:function(){this._mapUserInteractionController._stopDraggingAnnotation()},translateVisibleMapRectAnimated:function(t,e){const i=this.visibleMapRect;this._setVisibleMapRect(new qh(i.minX()+t.x/this.worldSize,i.minY()+t.y/this.worldSize,i.size.width,i.size.height),!!e)},translateCameraAnimated:function(t,e){this._mapNode.setCameraAnimated(this.camera.translate(t),!!e)},setCameraAnimated:function(t,e){this._mapNode.setCameraAnimated(t,!!e)},shouldWaitForTilesAndControls:function(){return this.state!==oc||!this.controlsLayer||this.controlsLayer.controlsPending},ensureRenderingFrame:function(){return this._renderingFrame||new Bi},ensureVisibleFrame:function(){return this._visibleFrame||new Bi},annotationDraggingWillStart:function(){this.rootNode.classList.add(Qh),this._loadControlsLayer(!1),this.controlsLayer&&(this.controlsLayer.classList.add(Qh),this.controlsLayer.canShowTooltips=!1)},annotationDraggingDidEnd:function(){this.rootNode.classList.remove(Qh),this.controlsLayer&&(this.controlsLayer.classList.remove(Qh),this.controlsLayer.canShowTooltips=!0)},get useMetric(){switch(this.distances){case uc.Distances.Adaptive:return Oi.useMetric();case uc.Distances.Metric:return!0;case uc.Distances.Imperial:return!1}},get isCompassHidden(){return this.showsCompass===Wh.Hidden||Co.supportsTouches&&this.showsCompass===Wh.Adaptive&&0===this.rotation||!this.isRotationEnabled},get fontSizeRatio(){return this._textZoomDetector?this._textZoomDetector.ratio:1},get textZoom(){return!!this._textZoomDetector},set textZoom(t){t&&!this._textZoomDetector?this._textZoomDetector=new Gh({container:this.element,fontSizeDidChange:()=>{this._mapNode&&(this._mapNode.fontSizeRatio=this.fontSizeRatio),this.controlsLayer&&this.controlsLayer.fontSizeDidChange(),this._annotationsController&&this._annotationsController.fontSizeDidChange()}}):!t&&this._textZoomDetector&&(this._textZoomDetector.destroy(),this._textZoomDetector=void 0,this._mapNode&&(this._mapNode.fontSizeRatio=this.fontSizeRatio)),this.controlsLayer&&(this.controlsLayer.textZoom=!!t),this._annotationsController&&(this._annotationsController.textZoom=!!t)},compassRotationWillStart:function(t){return t&&this.rootNode.classList.add(Jh),this._mapNodeController.node.compassRotationWillStart()},compassRotationDidEnd:function(){this.rootNode.classList.remove(Jh),this._mapNodeController.node.compassRotationDidEnd()},panningDuringAnnotationDrag:function(){this._annotationsController&&this._annotationsController.mapPanningDuringAnnotationDrag()},padMapRect:function(t,e,i){_(e,"object","[MapKit] padding must be an object with any of `top`, `left`, `bottom`, `right`"),["top","left","bottom","right"].forEach((function(t){if(t in e){const i=e[t];if("number"!=typeof i||i<0)throw new Error("[MapKit] property `"+t+"` of padding must be a number >= 0; got `"+i+"`")}else e[t]=0}));const n=this.ensureRenderingFrame().size;let o=d(Math.min((n.width-(e.left+e.right))/(t.size.width*hi.tileSize),(n.height-(e.top+e.bottom))/(t.size.height*hi.tileSize)));const s=Math.max(hi.pointsPerAxis(o),1),a=jo(t,{top:e.top/s,left:e.left/s,bottom:e.bottom/s,right:e.right/s});if(void 0!==i&&i>=0){o=this._mapNode.zoomLevelForCameraDistanceAtY(i,a.midY());const t=s/hi.pointsPerAxis(o);return a.scale(t,new hi.MapPoint(a.midX(),a.midY()))}return a},supportsLabelRegions:function(){return!this._mapNodeController.usingSSR},createLabelRegion:function(){return this._mapNode.createLabelRegion()},updatedLabelRegion:function(){this._mapNode.updatedLabelRegion()},unregisterLabelRegion:function(t){this._mapNode.unregisterLabelRegion(t)},annotationPlaceSelectionAccessoryDidReveal(t,e){this._logWithMap(ze.Events.PlaceAccessoryReveal,{eventValue:t,eventTarget:"PLACECARD_TRAY",states:{PLACE_CARD:()=>e}})},annotationPlaceSelectionAccessoryOpenInMapsClicked(t,e){this._logWithMap(ze.Events.PlaceAccessoryOpenAppleMaps,{eventTarget:"PLACECARD_TRAY",states:{PLACE_CARD:()=>e}})},_addItems:function(t){const e=[];return t.forEach((function(t,i){const n=uc.OverlaysController&&t instanceof uc.OverlaysController.Overlay,o=uc.AnnotationsController&&t instanceof uc.AnnotationsController.Annotation;if(!n&&!o)throw new Error("[MapKit] Map.addItems expected an Annotation, Overlay, ItemCollection, or Array of valid items at index "+i+", but got `"+t+"` instead.");t.map||(n?this.addOverlay(t):e.push(t))}),this),this._annotationsController&&this.addAnnotations(e),t},_configurationDidBecomeAvailable:function(t){let e=t&&this.state===ec;t||(this.state===tc?(this.state=ec,e=!0):this.state===ic&&(this.state=nc,e=!0)),this._mapNodeController.configurationDidBecomeAvailable(t),e&&this._logWithMap(ze.Events.MapsLoad),this.controlsLayer&&this.controlsLayer.update(),this.public._internalAppDelegate&&"function"==typeof this.public._internalAppDelegate.networkConfigurationUpdated&&this.public._internalAppDelegate.networkConfigurationUpdated({madabaDomains:kt.madabaDomains,tileGroup:kt.tileGroup,accessKey:kt.accessKey})},_setupScene:function(){this._scene=new Io,this._scene.sceneDidUpdate=(t,e)=>this._sceneDidUpdate(t,e),dc&&(this._scene.performanceMeasureName="mapkit-scene-graph-update-frame");const t=this._scene.element;t.className="rt-root",Oi.activeLocale&&(t.lang=Oi.localeId,t.dir=Oi.activeLocale.rtl?"rtl":"ltr"),this._scene.element.setAttribute("aria-hidden","true")},unifiedCanvas:!1,_sceneDidUpdate(t,e){if(e||this.state===ac)return;this.unifiedCanvas&&this._mapNode&&this._mapNode.customCanvas&&!this._scene.isTainted()?(this._canvas2dLayer||(this._canvas2dLayer=new Yr(this._scene),this._scene.element.hidden=!0,this.addLayerAbove(this._canvas2dLayer,Cn.Labels)),this._mapNode.forceDraw()):this._canvas2dLayer&&(console.warn("[MapKit] Fallback to 2D rendering because canvas is tainted, or CSR became unavailable."),this.removeLayer(this._canvas2dLayer),this._canvas2dLayer=null,this._scene.element.hidden=!1)},_checkOptions:function(t){_(t,"object","[MapKit] The `options` object is invalid."),Object.keys(t).forEach((function(e){let i=rc[e];if(void 0===i){const n=D(e);i=rc[n],void 0!==i&&(t[n]=t[e])}"rw"===i||("ro"===i?console.warn("[MapKit] `"+e+"` is read-only and can't be set on a Map."):console.warn("[MapKit] `"+e+"` is not a valid property of Map."))}))},_checkParent:function(t){if(null==t)return;const e="string"==typeof t?document.getElementById(t):t;if(!e||!Y(e))throw new Error("[MapKit] `parent` must either be a DOM element or its ID.");return e},_setDefaultState:function(t){this._showsScale=Wh.Hidden,this._visibleMapRect=Xh,this._padding=new $o,this._adjustedPadding=new $o,this._showsCompass=Wh.Adaptive,this._usingDefaultShowsCompassValue=!0,this._distances=uc.Distances.Adaptive,this._showsZoomControl=void 0!==t.showsZoomControl?!!t.showsZoomControl:!Yh,this._showsMapTypeControl=void 0!==t.showsMapTypeControl?!!t.showsMapTypeControl:!Yh,this._showsUserLocationControl=void 0!==t.showsUserLocationControl&&!!t.showsUserLocationControl;const e=t.mapType||uc.MapTypes.Standard;Dc(e,uc.MapTypes,"mapType","Map.MapTypes"),e===uc.MapTypes.MutedStandard?(this._emphasis=Ln,this._mapType=uc.MapTypes.Standard):(this._emphasis=An,this._mapType=e);const i=t.colorScheme||uc.ColorSchemes.Light;Dc(i,uc.ColorSchemes,"colorScheme","Map.ColorSchemes"),this._colorScheme=i,i===Ot.Adaptive&&(this._colorSchemeHandle=Dt.addHandle(),this._boundDarkModeDidChange=()=>this._updateMapNodeTintAndEmphasis(this._mapNode),this._colorSchemeHandle.addEventListener("change",this._boundDarkModeDidChange))},_setIsRotationEnabled:function(t,e){"boolean"==typeof t?(this.isRotationAvailable?this._mapNode.isRotationEnabled=t:e&&t&&console.warn("[MapKit] Rotation can't be enabled because it's not available."),this.controlsLayer&&this.controlsLayer.updateRotationControl(),this._mapUserInteractionController.updateGestureEnableState()):console.warn("[MapKit] Value passed to `Map.isRotationEnabled` is not a Boolean.")},_setupRenderTree:function(){const t=document.createElement("div");t.className="mk-map-view",t.appendChild(this._scene.element),this.rootNode=new so.Node(t)},_setupControllers:function(t){this._loadControlsLayer(!0),uc.OverlaysController&&this.addOverlaysController(),uc.MapFeaturesLayerController&&this.addMapFeaturesLayerController(),uc.AnnotationsController&&this.addAnnotationsController(),uc.UserLocationController&&this.addUserLocationController(),this._mapNodeController=new Vr(this,t),this._linearZoomController=new Qo(this._mapNode.snapsToIntegralZoomLevels,this),this._mapUserInteractionController=new ls(this.rootNode.element,this)},addOverlaysController:function(){this.state===ac||this._overlaysController||(this._overlaysController=new uc.OverlaysController(this),this._scene.insertAfter(this._overlaysController.node,this._mapNodeController?this._mapNodeController.node:void 0))},addMapFeaturesLayerController:function(){this._mapFeaturesLayerController=new uc.MapFeaturesLayerController(this),this._startStabilizationTimeoutIfNeeded()},addAnnotationsController:function(){this.state===ac||this._annotationsController||(this._annotationsController=new uc.AnnotationsController(this),this._mapRoot&&this._mapRoot.insertAfter(this._annotationsController.node,this._mapFeaturesLayerController.node),this._scene.insertAfter(this._annotationsController.sceneGraphNode,this._overlaysController?this._overlaysController.node:this._mapNodeController?this._mapNodeController.node:void 0))},addUserLocationController:function(){this._userLocationController=new uc.UserLocationController(this)},getControlBounds:function(){return this.controlsLayer?this.controlsLayer.controlBounds():[]},_loadControlsLayer:function(t){var e;if(!this._loadControlsLayerHasFailed)return!t&&uc.ControlsLayer?(this._insertControlsLayer(),void this._updateInitialControlsLayerState()):(e=e=>{if(!e)return this._showsDefaultTiles=!1,Object.defineProperty(this,"_showsDefaultTiles",{get:function(){return!1},set:function(){throw new Error("[MapKit] Default tiles are not shown because map controls has failed to load.")},configurable:!0}),void(this._loadControlsLayerHasFailed=!0);uc.ControlsLayer=e,t?(ue.scheduleInBackground((()=>this._insertControlsLayer())),ue.scheduleInBackground((()=>this._updateInitialControlsLayerState()))):(this._insertControlsLayer(),this._updateInitialControlsLayerState())},void e(Uh))},_insertControlsLayer:function(){if(this.state!==ac&&!this.controlsLayer&&(this.controlsLayer=new uc.ControlsLayer(this),this._mapRoot.insertAfter(this.controlsLayer,this._annotationsController?this._annotationsController.node:void 0),cc)){const t=()=>{so.removeEventListener("update",t),performance.measure("mapkit-map-controls-inserted","mapkit-map-start")};so.addEventListener("update",t)}},_updateInitialControlsLayerState:function(){this.state===ac||this._updateInitialControlsLayerStateCalled||(this._updateInitialControlsLayerStateCalled=!0,this.controlsLayer.update(),this.controlsLayer.mapPaddingDidChange(this._adjustedPadding))},_handleOptions:function(t,e){void 0!==t.contextType&&(this.contextType=t.contextType),void 0!==t.showsScale&&(this.showsScale=t.showsScale),void 0!==t.showsCompass&&(this.showsCompass=t.showsCompass),void 0!==t.padding&&(this.padding=t.padding),void 0!==t.cameraZoomRange&&(this.cameraZoomRange=t.cameraZoomRange),void 0!==t.cameraBoundary&&(this.cameraBoundary=t.cameraBoundary),void 0!==t.visibleMapRect?this.visibleMapRect=t.visibleMapRect:void 0!==t.region?this.region=t.region:(void 0!==t.center&&(this.center=t.center),void 0!==t.cameraDistance&&(this.cameraDistance=t.cameraDistance)),void 0!==t.rotation&&(this.rotation=t.rotation);const i=[],n=void 0===t.visibleMapRect&&void 0===t.region&&void 0===t.center&&e;if(void 0!==t.overlays&&(y(t.overlays,"[MapKit] Map constructor overlays option expected an array of overlays, but got `"+t.annotations+"` instead."),n?i.push.apply(i,t.overlays):this.overlays=t.overlays),void 0!==t.annotations&&(y(t.annotations,"[MapKit] Map constructor annotations option expected an array of annotations, but got `"+t.annotations+"` instead."),n?i.push.apply(i,t.annotations):this.annotations=t.annotations),i.length>0){const e={};void 0!==t.cameraDistance&&(e.cameraDistance=t.cameraDistance),this.showItems(i,e)}void 0!==t.selectedOverlay&&(this.selectedOverlay=t.selectedOverlay),void 0!==t.selectedAnnotation&&(this.selectedAnnotation=t.selectedAnnotation),void 0!==t.distances&&(this.distances=t.distances),void 0!==t.tintColor&&(this.tintColor=t.tintColor),void 0!==t.showsUserLocation&&(this.showsUserLocation=t.showsUserLocation),void 0!==t.tracksUserLocation&&(this.tracksUserLocation=t.tracksUserLocation),void 0!==t.tileOverlays&&(this.tileOverlays=t.tileOverlays),void 0!==t.annotationForCluster&&(this.annotationForCluster=t.annotationForCluster),void 0!==t.annotationForMapFeature&&(this.annotationForMapFeature=t.annotationForMapFeature),void 0!==t._unifiedCanvas&&(this.unifiedCanvas=!!t._unifiedCanvas),void 0!==t._textZoom&&(this.textZoom=!!t._textZoom)},_flushToDOM:function(t){this._addMapToParent(t),ue.flush(),this._ensureContainerIsPositioned()},_addMapToParent:function(t){null!=t&&(t.appendChild(this.element),this._bootstrapSize.width&&this._bootstrapSize.height&&this._updateRenderingFrameSize(this._bootstrapSize),delete this._bootstrapSize)},performScheduledUpdate:function(){if(this.state===ac)return;const t=this._mapNode.camera.zoom;t%1!=0&&(this.state===tc||this.state===ec)&&("SERVER"===kt.forcedRenderingMode||kt.ready&&(kt.didFallback||!kt.canRunCSR)||!this.csrCapable||"HYBRID"===kt.forcedRenderingMode||this._mapNodeController.loadPriority===Sn.PointsOfInterest)&&this._mapNode.setZoomLevelAnimated(Co.getIntegralZoom(t)),this.state===tc?this.state=ic:this.state===ec&&(this.state=nc),this._loadResizeDetector()},_loadResizeDetector:function(){if(!this._iframe&&!this._resizeObserver){if(window.ResizeObserver)return this._resizeObserver=new window.ResizeObserver((t=>this._sizeDidChange())),this._resizeObserver.observe(this.rootNode.element),void this._resizeDetectorDidInstall();this._iframe=Co.htmlElement("iframe",{tabindex:-1,"aria-hidden":!0}),this._iframe.addEventListener("load",this),this.element.insertBefore(this._iframe,this.element.firstChild)}},_updateUserLocationDisplay:function(t){this._annotationsController.updateUserLocationAnnotation(t),this._overlaysController.updateUserLocationAccuracyRingOverlay(t)},_removeUserLocationDisplay:function(){this._annotationsController.removeUserLocationAnnotation(),this._overlaysController.removeUserLocationAccuracyRingOverlay()},_updateCameraToTrackUserLocation:function(t){let e,i;if(this.tracksUserLocation&&this.showsUserLocation&&t.coordinate){if(this._mapNode.isMapPointWithinBounds(t.coordinate.toMapPoint()))if(this._firstCameraUpdateToTrackUserLocationPending&&this.zoomLevel<9.5){let n=14;if(t.location.accuracy>0){const e=5*t.location.accuracy*hi.mapUnitsPerMeterAtLatitude(t.location.latitude),i=new qh(0,0,e,e),o=this.ensureVisibleFrame().size;n=Math.max(this.zoomLevel,hi.zoomLevelForMapRectInViewport(i,o,hi.tileSize))}e=this._mapRectForCenterAndZoomLevel(t.coordinate.toMapPoint(),n),this._userLocationTrackingDelegate&&"function"==typeof this._userLocationTrackingDelegate.mapRegionWillChangeToTrackUserLocation&&(i=e.toCoordinateRegion(),this._userLocationTrackingDelegate.mapRegionWillChangeToTrackUserLocation(this.public,i),e=i.toMapRect()),this._mapNode.setCameraAnimated(this.camera.withNewMapRect(e),!0,!0)}else this._userLocationTrackingDelegate&&"function"==typeof this._userLocationTrackingDelegate.mapRegionWillChangeToTrackUserLocation?(e=this._mapRectForCenterAndZoomLevel(t.coordinate.toMapPoint(),this.zoomLevel),i=e.toCoordinateRegion(),this._userLocationTrackingDelegate.mapRegionWillChangeToTrackUserLocation(this.public,i),this._mapNode.setCameraAnimated(this.camera.withNewMapRect(e),!0,!0)):this.setCenterAnimated(t.coordinate,!0,!0);else this.setCenterAnimated(t.coordinate,!0,!0),this._userLocationController.tracksUserLocation=!1,this._mapNode.usesInteractionCenter=!1,this.controlsLayer&&this.controlsLayer.updateUserLocationControl();delete this._firstCameraUpdateToTrackUserLocationPending}},_updateRenderingFrameFromElement:function(){const t=this.rootNode.element,e=t.offsetWidth,i=t.offsetHeight;0!==e&&0!==i&&this._updateRenderingFrameSize(new Ui(e,i))},_setRenderingFrameValue:function(t){this._renderingFrame=t,this._visibleFrame=t;const e=this._adjustedPadding.copy(),i=this._adjustedPadding=this._adjustedPaddingForMapSize(t.size);i.equals($o.Zero)||(this._visibleFrame=new Bi(t.origin.x+i.left,t.origin.y+i.top,t.size.width-i.left-i.right,t.size.height-i.top-i.bottom)),!i.equals(e)&&this.controlsLayer&&this.controlsLayer.mapPaddingDidChange(i)},_adjustedPaddingForMapSize:function(t){const e=new Ui(Math.min(Dn.minimumSizeToShowLogo.width,t.width),Math.min(Dn.minimumSizeToShowLogo.height,t.height)),i=this._padding.copy();i.top<0&&(i.top=0),i.left<0&&(i.left=0),i.bottom<0&&(i.bottom=0),i.right<0&&(i.right=0);const n=i.left+i.right,o=i.top+i.bottom,s=n+e.width-t.width,a=o+e.height-t.height;if(s>0&&n>0){const t=(n-s)/n;i.left*=t,i.right*=t}if(a>0&&o>0){const t=(o-a)/o;i.top*=t,i.bottom*=t}return i},_iframeDidLoad:function(){try{this._iframe.contentWindow.addEventListener("resize",this)}catch(t){console.warn("[MapKit] Map resize detection is disabled when loaded in a sandboxed iframe.")}this._resizeDetectorDidInstall()},_resizeDetectorDidInstall:function(){const t=this._visibleMapRect&&this._visibleMapRect.copy(),e=this.rotation,i=this._padding&&!this._padding.equals($o.Zero);this._ensureContainerIsPositioned(),this._sizeDidChange(),t&&i&&(t.size.width>0||t.size.height>0?(this.setVisibleMapRectAnimated(t,!1),e&&this.setRotationAnimated(e,!1)):this.setCenterAnimated(new jh(t.midX(),t.midY()).toCoordinate()))},_sizeDidChange:function(){this._printMediaQueryList&&this._printMediaQueryList.matches||this._updateRenderingFrameFromElement()},_updateRenderingFrameSize:function(t){const e=!this._renderingFrame;0===t.width||0===t.height||!e&&this._renderingFrame.size.equals(t)||(this._setRenderingFrameValue(new Bi(0,0,t.width,t.height)),this._scene.size=t,this._mapRoot.size=t,this._mapNodeController.updateSize(t),this._delayedShowItems&&(uc.LayerItemsController.setRegionForItems(this,this._delayedShowItems[0],this._delayedShowItems[1]),delete this._delayedShowItems),this.controlsLayer&&this.controlsLayer.sizeDidChange(),this._annotationsController&&this._annotationsController.mapSizeDidUpdate())},_mapRectForCenterAndZoomLevel:function(t,e){const i=this.ensureVisibleFrame().size,n=hi.pointsPerAxis(e),o=i.width/n,s=i.height/n;return new qh(t.x-o/2,t.y-s/2,o,s)},_isInitialInteractionTargetInUIElement:function(){const t=this._mapUserInteractionController.initialEventTargetForCurrentInteraction;return!!t&&(!(!this._annotationsController||!this._annotationsController.isElementInAccessory(t))||!(!this.controlsLayer||!this.controlsLayer.element.contains(t)))},zoomControlStart:function(t){t&&!this.canZoomIn||!t&&!this.canZoomOut||this._linearZoomController.start(this.zoomLevel,t)&&this._mapNode.cameraWillStartZooming(In)},zoomControlEnd:function(){this._linearZoomController.stop()},_centerMapPoint:function(){if(0!==this.rotation){const t=this.renderingMapRect,e=new jh(t.midX(),t.midY()),i=this._offsetCenterWithPaddingAndRotation(e,1);if(i)return i}const t=this.visibleMapRect;return new jh(t.midX(),t.midY())},_offsetCenterWithPaddingAndRotation:function(t,e){const i=2*e*this.worldSize,n=(this._adjustedPadding.right-this._adjustedPadding.left)/i,o=(this._adjustedPadding.bottom-this._adjustedPadding.top)/i;if(0!==n||0!==o){const e=-this.rotation/180*Math.PI;return new jh(t.x-n*Math.cos(e)+o*Math.sin(e),t.y-n*Math.sin(e)-o*Math.cos(e))}},_setVisibleMapRect:function(t,e,i){i||(this.tracksUserLocation=!1);let n=t;const o=this._adjustedPadding,s=this.ensureRenderingFrame(),a=this.ensureVisibleFrame();o.equals($o.Zero)||a.equals(Bi.Zero)||(n=new qh(t.minX()-o.left/a.size.width*t.size.width,t.minY()-o.top/a.size.height*t.size.height,t.size.width*(s.size.width/a.size.width),t.size.height*(s.size.height/a.size.height))),this._mapNode.setVisibleMapRectAnimated(n,e)},_ensureContainerIsPositioned:function(){const t=this.rootNode.element;"static"===t.ownerDocument.defaultView.getComputedStyle(t).position&&(t.style.position="relative")},didInsertNewMapNode:function(t){t.delegate=this,this.state===oc&&(this.state=sc),this._updateMapRoot(t),this._updateMapNodeTintAndEmphasis(t),window.setTimeout((()=>this.public.dispatchEvent(new St.Event(xc))),0)},didReconfigureMapNode:function(t){t.snapsToIntegralZoomLevels&&t.zoomLevel%1!=0&&!t.cameraIsAnimating&&(t.zoomLevel=Co.getIntegralZoom(t.zoomLevel)),this._linearZoomController&&(this._linearZoomController.snapsToIntegralZoomLevels=t.snapsToIntegralZoomLevels),t.fontSizeRatio=this.fontSizeRatio,this.controlsLayer&&this.controlsLayer.updateZoomControl()},didFinishMapNodeInitialization:function(t){t.customCanvas?(t.customCanvas.setAttribute("aria-hidden","true"),this.element.insertBefore(t.customCanvas,this.element.firstChild)):this._scene.addChild(t,0)},mapNodeDidFail:function(t){const e=new St.Event(Rc);t&&(e.reason=t.reason,e.message=t.message),this.public.dispatchEvent(e)},mapNodeReady:function(t){window.setTimeout((()=>{const e=new St.Event(Tc);e.usingCSR=t,this.public.dispatchEvent(e),this._logWithMap(ze.Events.MapNodeReady)}),0),this.controlsLayer&&this.controlsLayer.updateRotationControl(),this._annotationsController&&this._annotationsController.mapSupportForLabelRegionsChanged()},_updateMapRoot:function(t){this._mapRoot&&this._mapRoot.remove(),this._mapRoot=this.rootNode.insertBefore(new so.Node(t.element),this.rootNode.firstChild),t.element.className="mk-map-node-element",this._mapRoot.size=t.size=this._scene.size,this._annotationsController&&this._mapRoot.addChild(this._annotationsController.node),this.controlsLayer&&this._mapRoot.addChild(this.controlsLayer)},_updateMapNodeTintAndEmphasis:function(t){const e=this._colorScheme===Ot.Adaptive?Dt.currentColorScheme:this._colorScheme;this.currentColorScheme=e;const i=this._mapType===uc.MapTypes.Standard?e:hn;this.tint=i;let n=e;this._mapType!==uc.MapTypes.Hybrid&&this._mapType!==uc.MapTypes.Satellite||(n=cn),t.setTintAndEmphasis(i,n,this._emphasis),this._mapNodeController&&this._mapNodeController.setTintAndEmphasis(i,n,this._emphasis),this.controlsLayer&&this.controlsLayer.update(),this._annotationsController&&(this._annotationsController.mapNodeTintWasSet(i),this._annotationsController.node.classList.toggle(pc,Co.darkColorScheme(i))),this.rootNode.classList.toggle(pc,Co.darkColorScheme(i))},overlaySelectionDidChange:function(t){t.selected&&this._annotationsController&&(this._annotationsController.selectedItem=null);const e=new St.Event(t.selected?_c:fc);e.overlay=t,this.selectionMayChange=!1,this.public.dispatchEvent(e),delete this.selectionMayChange},annotationSelectionDidChange:function(t){t.selected&&this._overlaysController&&(this._overlaysController.selectedItem=null),this.selectionMayChange=!1,this.dispatchEventWithAnnotation(t.selected?_c:fc,t),delete this.selectionMayChange},dispatchEventWithAnnotation:function(t,e,i){const n=new St.Event(t);if(n.annotation=e,i)for(const t in i)n[t]=i[t];this.public.dispatchEvent(n)},addWaitingAnnotations:function(){this.shouldWaitForTilesAndControls()||(this._annotationsController?this._annotationsController.addWaitingAnnotations((()=>this._dispatchCompleteEvent())):this._dispatchCompleteEvent())},_completedOnce:!1,_dispatchCompleteEvent:function(){this._completedOnce||(this._completedOnce=!0,cc&&performance.measure("mapkit-map-annotations-rendered","mapkit-map-start")),this._mapNode.fullyRendered&&this.public.dispatchEvent(new St.Event(Ic))},_dispatchRotationChangeEvent:function(){this.shouldDispatchRotationChangeEvent&&this.public.dispatchEvent(new St.Event(Mc))},_handleLocaleChange:function(t){const e=this._scene.element;e.lang=Oi.localeId,e.dir=Oi.activeLocale.rtl?"rtl":"ltr",this._mapNodeController.handleMapConfigurationChange(),this._annotationsController&&(this._annotationsController.localeChanged(),this._userLocationController&&this._annotationsController.updateUserLocationAnnotation(this._userLocationController.userLocation,!0));const i=this.ensureRenderingFrame();0!==i.size.width&&0!==i.size.height&&this._setRenderingFrameValue(i)},_elementWasTapped:function(t){for(;null!==t;t=t.parentNode)if("a"===(e=t).localName||"button"===e.localName||"input"===e.localName&&"button"===e.type)return void t.click();var e},_devicePixelRatioDidChange:function(){this._scene.needsDisplay=!0,this.controlsLayer&&this.controlsLayer.devicePixelRatioDidChange(),this._annotationsController&&this._annotationsController.devicePixelRatioDidChange(),this._mapNode.devicePixelRatioDidChange()||this._mapNodeController.handleRecreate()},_mapRectAccountingForPadding:function(){const t=this.renderingMapRect;if(this._adjustedPadding.equals($o.Zero))return t.copy();const e=this.ensureVisibleFrame(),i=this.ensureRenderingFrame();return new qh(t.minX()+this._adjustedPadding.left/i.size.width*t.size.width,t.minY()+this._adjustedPadding.top/i.size.height*t.size.height,t.size.width*(e.size.width/i.size.width),t.size.height*(e.size.height/i.size.height))},_setupListeners:function(){kt.state===kt.States.READY&&this._configurationDidBecomeAvailable(!0),kt.addEventListener(kt.Events.Initialized,this),kt.addEventListener(kt.Events.Changed,this),Oi.activeLocale&&this._handleLocaleChange({locale:Oi.activeLocale}),Oi.addEventListener(Oi.Events.LocaleChanged,this),this._boundDevicePixelRatioDidChange=()=>this._devicePixelRatioDidChange(),this._dppxMediaQueryList=window.matchMedia("(-webkit-device-pixel-ratio: 1)"),this._dppxMediaQueryList.addListener(this._boundDevicePixelRatioDidChange),this._boundPrintMediaQueryChanged=()=>this._printMediaQueryChanged(),this._printMediaQueryList=window.matchMedia("print"),this._printMediaQueryList.addListener(this._boundPrintMediaQueryChanged)},_removePrintListener:function(){this._printMediaQueryList.removeListener(this._boundPrintMediaQueryChanged),this._boundPrintMediaQueryChanged=null,this._printMediaQueryList=null},_printMediaQueryChanged:function(){const t=this._mapNode;this._printMediaQueryList.matches?(this.rootNode.element.style.background=this.rootNode.element.parentNode.dataset.mapPrintingBackground,t.fullyRendered?this._ensureMapCenterDuringPrint(!0):(t.opacity=0,this._annotationsController&&this._annotationsController.addWaitingAnnotations()),this._loadControlsLayer(!1),this._mapNodeController.handlePrintMatch(),ue.flush()):(this._mapNodeController.handlePrintUnmatch(),t.opacity=1,this.rootNode.element.style.background="",this._ensureMapCenterDuringPrint(!1))},_ensureMapCenterDuringPrint:function(t){const e=[this._scene.element];this._mapNode.customCanvas&&e.push(this._mapNode.customCanvas),e.forEach((function(e){if(t){const t=this._scene.size;e.style.left="50%",e.style.marginLeft="-"+t.width/2+"px",e.style.top="50%",e.style.marginTop="-"+t.height/2+"px"}else e.style.left="",e.style.marginLeft="",e.style.top="",e.style.marginTop=""}),this)},_mapStabilizationTimeout:null,_startStabilizationTimeoutIfNeeded:function(){this._mapNodeController&&this._mapNode&&this._mapNode.fullyRendered&&!this.cameraIsMoving&&(this._stopStabilizationTimeout(),this._mapStabilizationTimeout=window.setTimeout((()=>ue.scheduleInBackground((()=>this._mapIsStabilized()))),500))},_stopStabilizationTimeout:function(){this._mapStabilizationTimeout&&(window.clearTimeout(this._mapStabilizationTimeout),this._mapStabilizationTimeout=null)},_mapIsStabilized:function(){this._updateMapFeatureRegionLayer(),this._updatePrintingBackground()},_updatePrintingBackground:function(){this._mapNode&&this._mapNode.cssBackgroundProperty&&this._mapNode.fullyRendered&&this.isRooted()&&(this.rootNode.element.parentNode.dataset.mapPrintingBackground=this._mapNode.cssBackgroundProperty)},_updateMapFeatureRegionLayer:function(){if(!(this._selectableMapFeatures&&this._mapNode&&this._mapNode.getMapFeatureRegions&&this._mapFeaturesLayerController))return;if(!this._mapNode.fullyRendered||!this.isRooted())return;const t=-1!==this._selectableMapFeatures.indexOf(uc.MapFeatureType.PointOfInterest),e=-1!==this._selectableMapFeatures.indexOf(uc.MapFeatureType.Territory),i=-1!==this._selectableMapFeatures.indexOf(uc.MapFeatureType.PhysicalFeature),n=this._mapNode.getMapFeatureRegions().filter((n=>t&&"Poi"===n.category||e&&"Territory"===n.category||i&&"PhysicalFeature"===n.category));this._mapFeaturesLayerController.update(n,this._mapNode.camera),this._mapRoot.addChild(this._mapFeaturesLayerController.node,0)},_logWithMap:function(t,e={}){if(this.state===ac)return;const i={map:this,eventTarget:e.eventTarget||ze.EventTarget};for(const t in e)i[t]=e[t];ze.log(t,i)}};const Nc=["LayerItemsController","ItemCollection","OverlaysController","MapFeaturesLayerController","AnnotationsController","PlaceSelectionAccessory","UserLocationController","MapFeatureType"];function Fc(){let t=!0;for(let e=0;e<Nc.length;e++){const i=Nc[e];!uc[i]&&R.jsModules[i]?uc[i]=R.jsModules[i]:t=!1}uc.OverlaysController&&uc.maps.forEach((t=>{t._impl.addOverlaysController()})),uc.MapFeaturesLayerController&&uc.maps.forEach((t=>{t._impl.addMapFeaturesLayerController()})),uc.AnnotationsController&&uc.maps.forEach((t=>{t._impl.addAnnotationsController()})),uc.UserLocationController&&uc.maps.forEach((t=>{t._impl.addUserLocationController()})),t&&R.removeEventListener("load",Fc)}R.addEventListener("load",Fc),Fc();const Uc=uc;function Gc(t,e){Yo(this,Gc)&&(Object.defineProperty(this,"_impl",{value:Object.create(Uc.prototype)}),Uc.call(this._impl,this,t,e))}Gc.MapTypes=Uc.MapTypes,Gc.ColorSchemes=Uc.ColorSchemes,Gc.Distances=Uc.Distances,Gc.LoadPriorities=Uc.LoadPriorities,Gc.prototype=p(St.EventTarget,Gc,{get padding(){return this._impl.padding},set padding(t){this._impl.padding=t},get isScrollEnabled(){return this._impl.isScrollEnabled},set isScrollEnabled(t){this._impl.isScrollEnabled=t},get isZoomEnabled(){return this._impl.isZoomEnabled},set isZoomEnabled(t){this._impl.isZoomEnabled=t},get showsZoomControl(){return this._impl.showsZoomControl},set showsZoomControl(t){this._impl.showsZoomControl=t},get showsScale(){return this._impl.showsScale},set showsScale(t){this._impl.showsScale=t},get mapType(){return this._impl.getMapTypeWithEmphasis()},set mapType(t){this._impl.setMapTypeWithEmphasis(t)},get colorScheme(){return this._impl.colorScheme},set colorScheme(t){this._impl.colorScheme=t},get distances(){return this._impl.distances},set distances(t){this._impl.distances=t},get _allowWheelToZoom(){return this._impl._allowWheelToZoom},set _allowWheelToZoom(t){this._impl._allowWheelToZoom=t},get _showsTileInfo(){return this._impl._showsTileInfo},set _showsTileInfo(t){this._impl._showsTileInfo=t},get _showsDefaultTiles(){return this._impl._showsDefaultTiles},set _showsDefaultTiles(t){this._impl._showsDefaultTiles=t},get loadPriority(){return this._impl.loadPriority},set loadPriority(t){this._impl.loadPriority=t},get tileOverlays(){return this._impl.tileOverlays},set tileOverlays(t){this._impl.tileOverlays=t},addTileOverlay:function(t){return this._impl.addTileOverlay(t)},addTileOverlays:function(t){return this._impl.addTileOverlays(t)},removeTileOverlay:function(t){return this._impl.removeTileOverlay(t)},removeTileOverlays:function(t){return this._impl.removeTileOverlays(t)},get showsMapTypeControl(){return this._impl.showsMapTypeControl},set showsMapTypeControl(t){this._impl.showsMapTypeControl=t},get showsUserLocationControl(){return this._impl.showsUserLocationControl},set showsUserLocationControl(t){this._impl.showsUserLocationControl=t},get showsPointsOfInterest(){return this._impl.showsPointsOfInterest},set showsPointsOfInterest(t){this._impl.showsPointsOfInterest=t},get pointOfInterestFilter(){return this._impl.pointOfInterestFilter},set pointOfInterestFilter(t){this._impl.pointOfInterestFilter=t},get element(){return this._impl.element},set element(t){this._impl.element=t},get visibleMapRect(){return this._impl.visibleMapRect},set visibleMapRect(t){this._impl.visibleMapRect=t},setVisibleMapRectAnimated:function(t,e){return this._impl.setVisibleMapRectAnimated(t,e)},get region(){return this._impl.region},set region(t){this._impl.region=t},setRegionAnimated:function(t,e){return this._impl.setRegionAnimated(t,e)},get isRotationAvailable(){return this._impl.isRotationAvailable},set isRotationAvailable(t){this._impl.isRotationAvailable=t},get isRotationEnabled(){return this._impl.isRotationEnabled},set isRotationEnabled(t){this._impl.isRotationEnabled=t},get rotation(){return this._impl.rotation},set rotation(t){this._impl.rotation=t},get showsCompass(){return this._impl.showsCompass},set showsCompass(t){this._impl.showsCompass=t},setRotationAnimated:function(t,e){return this._impl.setRotationAnimated(t,e)},get center(){return this._impl.center},set center(t){this._impl.center=t},setCenterAnimated:function(t,e){return this._impl.setCenterAnimated(t,e)},get cameraZoomRange(){return this._impl.cameraZoomRange},set cameraZoomRange(t){this._impl.cameraZoomRange=t},setCameraZoomRangeAnimated:function(t,e){return this._impl.setCameraZoomRangeAnimated(t,e)},get cameraDistance(){return this._impl.cameraDistance},set cameraDistance(t){this._impl.cameraDistance=t},setCameraDistanceAnimated:function(t,e){return this._impl.setCameraDistanceAnimated(t,e)},get cameraBoundary(){return this._impl.cameraBoundary},set cameraBoundary(t){this._impl.cameraBoundary=t},setCameraBoundaryAnimated:function(t,e){return this._impl.setCameraBoundaryAnimated(t,e)},get overlays(){return this._impl.overlays},set overlays(t){this._impl.overlays=t},get selectedOverlay(){return this._impl.selectedOverlay},set selectedOverlay(t){this._impl.selectedOverlay=t},addOverlay:function(t){return this._impl.addOverlay(t)},addOverlays:function(t){return this._impl.addOverlays(t)},removeOverlay:function(t){return this._impl.removeOverlay(t)},removeOverlays:function(t){return this._impl.removeOverlays(t)},topOverlayAtPoint:function(t){return this._impl.topOverlayAtPoint(t)},overlaysAtPoint:function(t){return this._impl.overlaysAtPoint(t)},get annotations(){return this._impl.annotations},set annotations(t){this._impl.annotations=t},get selectedAnnotation(){return this._impl.selectedAnnotation},set selectedAnnotation(t){this._impl.selectedAnnotation=t},addAnnotation:function(t){return this._impl.addAnnotation(t)},addAnnotations:function(t){return this._impl.addAnnotations(t)},removeAnnotation:function(t){return this._impl.removeAnnotation(t)},removeAnnotations:function(t){return this._impl.removeAnnotations(t)},showItems:function(t,e){return this._impl.showItems(t,e)},addItems:function(t){return this._impl.addItems(t)},removeItems:function(t){return this._impl.removeItems(t)},annotationsInMapRect:function(t){return this._impl.annotationsInMapRect(t)},updateSize:function(t){return this._impl.updateSize(t)},convertCoordinateToPointOnPage:function(t){return this._impl.convertCoordinateToPointOnPage(t)},convertPointOnPageToCoordinate:function(t){return this._impl.convertPointOnPageToCoordinate(t)},get showsUserLocation(){return this._impl.showsUserLocation},set showsUserLocation(t){this._impl.showsUserLocation=t},get userLocationAnnotation(){return this._impl.userLocationAnnotation},get tracksUserLocation(){return this._impl.tracksUserLocation},set tracksUserLocation(t){this._impl.tracksUserLocation=t},get tintColor(){return this._impl.tintColor},set tintColor(t){this._impl.tintColor=t},destroy:function(){this._impl.destroy()},get annotationForCluster(){return this._impl.annotationForCluster},set annotationForCluster(t){this._impl.annotationForCluster=t},get selectableMapFeatures(){return this._impl.selectableMapFeatures},set selectableMapFeatures(t){this._impl.selectableMapFeatures=t},get selectableMapFeatureSelectionAccessory(){return this._impl.selectableMapFeatureSelectionAccessory},set selectableMapFeatureSelectionAccessory(t){this._impl.selectableMapFeatureSelectionAccessory=t},get annotationForMapFeature(){return this._impl.annotationForMapFeature},set annotationForMapFeature(t){this._impl.annotationForMapFeature=t}});const Bc={MapInternal:Uc,css:".mk-map-view{width:100%;height:100%;overflow:hidden;-webkit-tap-highlight-color:transparent}.mk-map-view.mk-dragging-annotation{cursor:none}.mk-map-view.mk-disable-all-gestures{touch-action:none}.mk-map-view.mk-disable-pinch-gestures{touch-action:pan-x pan-y}.mk-map-view.mk-disable-zoom-gestures{touch-action:manipulation}.mk-map-view.mk-disable-pan-gestures{touch-action:none;touch-action:pinch-zoom}div.mk-map-view.mk-map-view img,div.mk-map-view.mk-map-view svg{margin:0;padding:0}.mk-annotation-container,.mk-map-view{z-index:0}.mk-map-view>*{position:absolute;left:0;-webkit-user-select:none;-moz-user-select:none}.mk-map-view .rt-root{letter-spacing:initial}.mk-map-view .mk-font-size-detector{position:absolute;height:1em;visibility:hidden;left:-100%;-webkit-text-size-adjust:none}.mk-controls-container{position:absolute;overflow:hidden;top:0;bottom:0;left:0;right:0;z-index:3;pointer-events:none}.mk-map-view .mk-annotation-container,.mk-map-view .mk-controls-container{-ms-user-select:text}.mk-map-view.mk-panning ::selection{background:0 0}.mk-map-view.mk-dragging-cursor{cursor:pointer;cursor:-moz-grabbing;cursor:-webkit-grabbing;cursor:grabbing}.mk-map-view>iframe{width:100%;height:100%;pointer-events:none;opacity:0;border:0}",utils:Co,mapkit:{FeatureVisibility:En,CoordinateRegion:ei,CoordinateSpan:ii,Coordinate:ni,BoundingRegion:oi,MapPoint:si,MapRect:ri,MapSize:ai,Padding:$o,CameraZoomRange:li,Map:Gc,MapInternal:Uc,get maps(){return Uc.maps},PointOfInterestCategory:Lt,PointOfInterestFilter:Tt.exposedConstructor,get filterIncludingAllCategories(){return Tt.filterIncludingAllCategories},get filterExcludingAllCategories(){return Tt.filterExcludingAllCategories},PlaceDetail:Fi,get placeDetails(){return Ni}}},Zc=hi.MapRect,Wc=hi.CoordinateSpan,Kc=hi.MapPoint,Hc=new Wc(.001,.001),jc=new $o(12,12,12,12),Vc="select",qc="deselect";function Yc(t){this._map=t,this._items=[]}Yc.checkShowItemsParameters=function(t,e){return y(t,"[MapKit] Map.showItems expects an array of items as its first parameter."),e=v(e,"object"),Object.keys(e).forEach((function(t){switch(t){case"animate":break;case"padding":if(void 0===e.padding)break;f(e.padding,$o,"[MapKit] Map.showItems expects a Padding object for `options.padding`.");break;case"minimumSpan":if(void 0===e.minimumSpan)break;f(e.minimumSpan,Wc,"[MapKit] Map.showItems expects a CoordinateSpan for `options.minimumSpan`.");break;case"cameraDistance":if(void 0===e.cameraDistance)break;_(e.cameraDistance,"number","[MapKit] Map.showItems expects a number for `options.cameraDistance`.");break;default:console.warn("[MapKit] `"+t+"` is not a valid option of Map.showItems.")}})),e},Yc.getRegionForItems=function(t,e,i){let n=i.padding||jc;const o=i.minimumSpan||Hc;let s=0,a=0,r=0,l=0;const h=[];for(let i=0,n=e.length;i<n;++i){const n=e[i];if(n.map===t.public){const t=n._impl._boundingRect||n._impl.boundingRectAtScale&&n._impl.boundingRectAtScale(1);if(t){if(n._impl.style){const t=n._impl.style._impl.halfStrokeWidthAtResolution();s=Math.max(s,t),a=Math.max(a,t),r=Math.max(r,t),l=Math.max(l,t)}h.push(t)}else{n._impl.updateLayout(!0);const t=n._impl.delegate.paddingForAnnotation(n);s=Math.max(s,t.top),a=Math.max(a,t.right),r=Math.max(r,t.bottom),l=Math.max(l,t.left),h.push(new Zc(n._impl.x,n._impl.y,0,0))}}}if(0===h.length)return null;n=new $o(n.top+s,n.right+a,n.bottom+r,n.left+l);const c=function(t,e){const i=t.toCoordinateRegion();if(i.span.latitudeDelta>=e.latitudeDelta&&i.span.longitudeDelta>=e.longitudeDelta)return t;i.span.latitudeDelta=Math.max(i.span.latitudeDelta,e.latitudeDelta),i.span.longitudeDelta=Math.max(i.span.longitudeDelta,e.longitudeDelta);const n=i.span.latitudeDelta/2,o=i.span.longitudeDelta/2,s=new Kc(hi.convertLongitudeToX(i.center.longitude-o),hi.convertLatitudeToY(i.center.latitude+n)),a=new Kc(hi.convertLongitudeToX(i.center.longitude+o),hi.convertLatitudeToY(i.center.latitude-n));s.x>a.x&&s.x--;return new Zc(s.x,s.y,Math.min(a.x-s.x,1),a.y-s.y)}(qo(h.sort((function(t,e){return t.minX()-e.minX()}))),o);return t.padMapRect(c,n,i.cameraDistance)},Yc.setRegionForItems=function(t,e,i){if(t.ensureRenderingFrame().size.height<=0||t.ensureRenderingFrame().size.width<=0)return!1;if(0===e.length)return!0;const n=!!i.animate,o=Yc.getRegionForItems(t,e,i);return!o||(t.setVisibleMapRectAnimated(o,n),!0)},Yc.prototype={constructor:Yc,_map:null,_selectedItem:null,_selectionDistance:10,get node(){return this._node},get items(){return this._items.filter(this.isItemExposed,this)},set items(t){y(t,"[MapKit] Map."+this.itemName+"s expected an array of "+this.itemName+"s, but got `"+t+"` instead."),t.forEach((function(t,e){f(t,this.itemConstructor,"[MapKit] Map."+this.itemName+"s expected an "+this.itemName+" at index "+e+", but got `"+t+"` instead.")}),this),t=t.filter((function(t){return!t.map||t.map._impl===this._map||(console.warn("[MapKit] Map."+this.capitalizedItemName+"s: "+this.itemName+" is already in another map."),!1)}),this);const e=[].concat(this._items);t=[].concat(this._items.filter((t=>!this.isItemExposed(t))),t);let i=0,n=0,o=!1;for(;i<t.length;)e[n]!==t[i]?e[n]&&-1===t.indexOf(e[n])?(this.removedItem(e[n],!0),o=!0,n++):(t[i].map&&t[i].map._impl===this._map?e.splice(e.indexOf(t[i]),1):(this.addedItem(t[i],!0),o=!0),i++):(i++,n++);for(;n<e.length;)this.removedItem(e[n],!0),o=!0,n++;t=t.filter((t=>t.map)),this._items=t,o&&this.manyItemsChanged(t,!0)},get selectedItem(){return this._selectedItem},set selectedItem(t){if(t!==this._selectedItem){if(null!=t&&(f(t,this.itemConstructor,"[MapKit] Map.selected"+this.capitalizedItemName+" expected an "+this.itemName+" or `null`, but got `"+t+"` instead."),t.map!==this._map.public))throw new Error("[MapKit] Map.selected"+this.capitalizedItemName+" cannot be set to an "+this.itemName+" that is not in the map.");if(this._selectedItem){const t=this._selectedItem;this._selectedItem=null,t.selected=!1,this._map.selectionMayChange=!1,t.dispatchEvent(new St.Event(qc)),delete this._map.selectionMayChange}t&&(this._selectedItem=t,t.selected=!0,this._map.selectionMayChange=!1,t.dispatchEvent(new St.Event(Vc)),delete this._map.selectionMayChange)}},addItem:function(t,e){return f(t,this.itemConstructor,"[MapKit] Map.add"+this.capitalizedItemName+" expected an "+this.itemName+", but got `"+t+"` instead."),(t=this.addItemToList(t,!1,e))&&this.manyItemsAdded([t],!1),t},addItems:function(t){y(t,"[MapKit] Map.add"+this.capitalizedItemName+"s expected an array of "+this.itemName+"s, but got `"+t+"` instead.");const e=t.filter((function(t,e){return f(t,this.itemConstructor,"[MapKit] Map.add"+this.capitalizedItemName+"s expected an "+this.itemName+" at index "+e+", but got `"+t+"` instead."),!!this.addItemToList(t,!0)}),this);return e.length>0&&this.manyItemsAdded(e,!0),e},shouldAddItem:function(t,e){return t.map?(t.map._impl!==this._map&&console.warn("[MapKit] Map."+this.capitalizedItemName+(e?"s":"")+": "+this.itemName+" is already in another map."),!1):!t._impl.isMapFeature||(console.warn("[MapKit] Map."+this.capitalizedItemName+(e?"s":"")+": "+this.itemName+" cannot be added to another map."),!1)},removeItem:function(t){return f(t,this.itemConstructor,"[MapKit] Map.remove"+this.capitalizedItemName+" expected an "+this.itemName+", but got `"+t+"` instead."),this.isItemExposed(t)?t.map!==this._map.public?console.warn("[MapKit] Map.remove"+this.capitalizedItemName+": cannot remove "+this.itemName+" as it is not attached to this map."):this.removeAnyItem(t):console.warn("[MapKit] Map.remove"+this.capitalizedItemName+": cannot remove "+this.itemName),t},removeAnyItem:function(t){const e=this._items.indexOf(t);return e>=0&&(this._items.splice(e,1),this.removedItem(t),this.manyItemsRemoved([t],!1)),t},removeItems:function(t){return y(t,"[MapKit] Map.remove"+this.capitalizedItemName+"s expected an array of "+this.itemName+"s, but got `"+t+"` instead."),t.forEach((function(t,e){f(t,this.itemConstructor,"[MapKit] Map.remove"+this.capitalizedItemName+"s expected an "+this.itemName+" at index "+e+", but got `"+t+"` instead."),this.isItemExposed(t)?t.map!==this._map.public?console.warn("[MapKit] Map.remove"+this.capitalizedItemName+"s: cannot remove "+this.itemName+" at index "+e+" as it is not attached to this map."):t._impl._toBeRemoved=!0:console.warn("[MapKit] Map.remove"+this.capitalizedItemName+"s: cannot remove "+this.itemName+" at index "+e)}),this),this._items=this._items.filter((t=>!t._impl._toBeRemoved)),t.forEach((function(t){t._impl._toBeRemoved&&(delete t._impl._toBeRemoved,this.removedItem(t,!0))}),this),t.length>0&&this.manyItemsRemoved(t,!0),t},enabledItemCloseToPoint:function(t,e){return this._previousPointForPickingItem&&this._previousPointForPickingItem.equals(t)?(e||(this._closeItemIndex=(this._closeItemIndex+1)%this._closeItems.length),this._closeItems[this._closeItemIndex]):(this._previousPointForPickingItem=t,this._closeItems=this._itemsCloseToPoint(t).filter((t=>t.enabled)),this._closeItemIndex=!e&&this._closeItems.length>1&&this._closeItems[0].selected?1:0,this._closeItems[this._closeItemIndex])},get selectionMayChange(){return!this._map||this._map.selectionMayChange},addItemToList:function(t,e,i){if(this.shouldAddItem(t,e))return(void 0===i||i<0||i>this._items.length)&&(i=this._items.length),this._items.splice(i,0,t),this.addedItem(t,e),t},addedItem:function(t,e){"function"==typeof t._impl.setDelegate?t._impl.setDelegate(this):t._impl.delegate=this,t._impl.addedToMap&&t._impl.addedToMap()},manyItemsAdded:function(t,e){},removedItem:function(t){t.selected=!1,delete t._impl.delegate,t._impl.removedFromMap&&t._impl.removedFromMap()},manyItemsRemoved:function(t,e){},manyItemsChanged:function(t,e){},mapWasDestroyed:function(){delete this._map,this.removedReferenceToMap()},_node:null,_deletePreviousPointForPickingItem:function(){delete this._previousPointForPickingItem,delete this._closeItems,delete this._closeItemIndex},_itemsCloseToPoint:function(t){const e=this._items.filter((t=>t._impl.canBePicked()));return 0===e.length?[]:this.pickableItemsCloseToPoint(e,t)}};const Xc=Yc;function $c(t){Oo.call(this),this._controller=t}$c.prototype=p(Oo,$c,{stringInfo:function(){return"OverlaysControllerNode"}});const Jc=$c,Qc=["visible","enabled","selected","data"];function td(t,e,i){this._node=t,this._public=e,i=v(i),Qc.forEach((function(t){void 0!==i[t]&&(this[t]=i[t])}),this),Object.keys(i).forEach((function(t){Qc.indexOf(t)<0&&console.warn("[MapKit] Unknown option: "+t+". Use the data property to store custom data.")}))}td.prototype={constructor:td,delegate:null,_map:null,_visible:!0,_enabled:!0,_selected:!1,get map(){return this._map},set map(t){console.warn("[MapKit] The `map` property of an overlay is read-only. Use map.addOverlay() instead.")},get data(){return Object.prototype.hasOwnProperty.call(this,"_data")||(this._data={}),this._data},set data(t){this._data=t},get visible(){return this._visible},set visible(t){const e=!!t;this._visible!==e&&(this._visible=e,this.updatedProperty("visible"))},get enabled(){return this._enabled},set enabled(t){this._enabled=!!t},get selected(){return this._selected},set selected(t){const e=!!t;if(e!==this._selected){if(this.delegate&&!this.delegate.selectionMayChange)return void console.warn("[MapKit] Selection may not change in select/deselect event handler.");this._selected=e,this.updatedProperty("selected")}},get node(){return this._node},canBePicked:function(){return this.shown&&this._visible},setMap:function(t){t?this._map=t:this._map&&delete this._map},handleEvent:function(){},updatedProperty:function(t){this.delegate&&this.delegate.overlayPropertyDidChange(this._public,t)},visibleAfterClipping:function(t,e,i,n,o){this._node.shapes=[];const s=this.visibilityToleranceAtScale(i),a=this._boundingRect||this.boundingRectAtScale(i);if(!this.visible||a.maxY()+s<t.minY()||a.minY()-s>t.maxY())return!1;const r=a.minX()-s,l=a.maxX()+s,h=r<0?1:0,c=1+h;for(let s=h-1;s<=c;++s){const a=0===s?t:new ri(t.origin.x-s,t.origin.y,t.size.width,t.size.height);if(l>=a.minX()&&r<=a.maxX()){const t=this.clipOverlay(a,e,i,n,o);t.length>0&&(t.xOffset=s,this._node.shapes.push(t))}}return this._node.shapes.length>0},visibilityToleranceAtScale:function(){return 0}};const ed=td;function id(t){Object.defineProperty(this,"_impl",{value:new ed(null,this,t)})}id.Events={Select:"select",Deselect:"deselect"},id.prototype=p(St.EventTarget,id,{get map(){return this._impl.map},set map(t){this._impl.map=t},get data(){return this._impl.data},set data(t){this._impl.data=t},get visible(){return this._impl.visible},set visible(t){this._impl.visible=t},get enabled(){return this._impl.enabled},set enabled(t){this._impl.enabled=t},get selected(){return this._impl.selected},set selected(t){this._impl.selected=t}});const nd=id;function od(){this._overlays=[]}od.prototype={constructor:od,fadeOverlayTo:function(t,e){Object.prototype.hasOwnProperty.call(t,"fadeInOutOpacity")?t.fadeInOutOpacity.durationMs=350*Math.abs(t.fadeInOutOpacity.value-t.fadeInOutOpacity.end):(t.fadeInOutOpacity={durationMs:350},t.setFadeInOutOpacity(1-e),this._overlays.push(t)),t.fadeInOutOpacity.start=t.fadeInOutOpacity.value,t.fadeInOutOpacity.end=e,t.fadeInOutOpacity.startTime=Date.now(),ue.scheduleASAP(this)},performScheduledUpdate:function(){const t=Date.now();this._overlays=this._overlays.filter((function(e){return e.setFadeInOutOpacity(u(e.fadeInOutOpacity.start+(e.fadeInOutOpacity.end-e.fadeInOutOpacity.start)*((t-e.fadeInOutOpacity.startTime)/e.fadeInOutOpacity.durationMs),0,1)),e.fadeInOutOpacity.value!==e.fadeInOutOpacity.end||(delete e.fadeInOutOpacity,!1)})),this._overlays.length>0&&ue.scheduleOnNextFrame(this)}};const sd=od;function ad(t){Xc.call(this,t),this._node=new Jc(this),this._fadeAnimationController=new sd}ad.Overlay=nd,ad.prototype=p(Xc,ad,{itemConstructor:nd,itemName:"overlay",capitalizedItemName:"Overlay",get map(){return this._map},get userLocationAccuracyRingOverlay(){return this._userLocationAccuracyRingOverlay},isItemExposed:function(t){return t!==this._userLocationAccuracyRingOverlay},removeUserLocationAccuracyRingOverlay:function(){this._userLocationAccuracyRingOverlay&&(this.removeAnyItem(this._userLocationAccuracyRingOverlay),delete this._userLocationAccuracyRingOverlay)},removedReferenceToMap:function(){this._items.forEach((t=>{t._impl.setMap(null)}))},mapCameraDidChange:function(){0!==this._items.length&&(ue.scheduleASAP(this),this._deletePreviousPointForPickingItem())},overlayPropertyDidChange:function(t,e){switch(e){case"selected":t.selected?this.selectedItem=t:this.selectedItem=null,this._map.overlaySelectionDidChange(t),ue.scheduleASAP(this);break;case"style":case"visible":case"geometry":ue.scheduleASAP(this)}},fadeOverlayTo:function(t,e){this._fadeAnimationController.fadeOverlayTo(t,e)},updateUserLocationAccuracyRingOverlay:function(t){t.coordinate&&(this._userLocationAccuracyRingOverlay?this._userLocationAccuracyRingOverlay.updateForUserLocation(t):this._userLocationAccuracyRingOverlay=this.addItem(new ad.AccuracyRingOverlay(t)))},addedItem:function(t,e){Xc.prototype.addedItem.call(this,t,e),t._impl.setMap(this._map.public),t.selected&&(this.selectedItem=t),ue.scheduleASAP(this)},removedItem:function(t){t._impl.setMap(null),Xc.prototype.removedItem.call(this,t),ue.scheduleASAP(this)},pickableItemsCloseToPoint:function(t,e,i){const n=document.createElement("canvas",{willReadFrequently:!0}),o=n.getContext("2d"),s=n.width=n.height=1,a=this._map.camera,r=s/2,l=e.x-r,h=e.y-r;o.translate(-l,-h);const c="number"==typeof i?i:this._selectionDistance/Co.devicePixelRatio;let d=!1;return t.filter((function(t){if(!t._impl.shown)return!1;d&&(o.clearRect(l,h,n.width,n.height),d=!1),t._impl.node._renderer.render(o,a,c),d=!0;return!!o.getImageData(Math.floor(r),Math.floor(r),1,1).data[3]}),this).reverse()},performScheduledUpdate:function(){const t=this.map;if(!t)return;const e=t.camera.toRenderingMapRect(),i=t.worldSize,n=Math.ceil(d(i)),o=[],s=this._items;for(let a=0,r=s.length;a<r;++a){const r=s[a];if(r._impl.shown=r._impl.visibleAfterClipping(e,true,i,n,!0),r===this._userLocationAccuracyRingOverlay){const e=t.mapType,i=e===vn.Satellite||e===vn.Hybrid?"satellite":t.tint;this._userLocationAccuracyRingOverlay.updateIsShown(t.region,t.worldSize,i)}r._impl.shown&&!r.selected&&(o.push(r._impl.node),r._impl.node.needsDisplay=!0)}const a=this.selectedItem;a&&a._impl.shown&&(o.push(a._impl.node),a._impl.node.needsDisplay=!0),this._node.children=o}}),R.jsModules.AccuracyRingOverlay?ad.AccuracyRingOverlay=R.jsModules.AccuracyRingOverlay:R.addEventListener("load",(function t(e){e.jsModules.AccuracyRingOverlay&&(ad.AccuracyRingOverlay=e.jsModules.AccuracyRingOverlay,R.removeEventListener("load",t))}));const rd=ad;function ld(t,e){this.items=t,this.data=e}ld.prototype={constructor:ld,get data(){return this._data},set data(t){this._data=t},get items(){return this._items},set items(t){this._items=t instanceof Array?t:null===t?[]:[t]},getFlattenedItemList:function(){return this.items.reduce((function(t,e){const i="function"==typeof e.getFlattenedItemList?e.getFlattenedItemList(e):e;return t.concat(i)}),[])}};const hd=ld;function cd(t,e){Object.defineProperty(this,"_impl",{value:new hd(t,e)})}cd.prototype={get data(){return this._impl.data},set data(t){this._impl.data=t},get items(){return this._impl._items},set items(t){this._impl.items=t},getFlattenedItemList:function(){return this._impl.getFlattenedItemList()}};const dd=cd,ud=["butt","round","square"],pd=["miter","round","bevel"],md=["nonzero","evenodd"];let gd=0;function _d(t){if(this._offsets=[[0],[1]],this._indices=[],this._lastUpdate=gd++,"object"==typeof t)for(const e in t)this.addColorStop(parseFloat(e),t[e])}_d.UPDATE_EVENT="update-color-stop",_d.prototype=p(T.EventTarget,_d,{constructor:_d,get offsets(){return this._offsets},get indices(){return this._indices},get lastUpdate(){return this._lastUpdate},addColorStop:function(t,e){if("number"!=typeof t||!(t>=0&&t<=1))throw new Error("[MapKit] Expected a number between 0 and 1 for offset of LineGradient.addColorStop, but got `"+t+"` instead.");_(e,"string","[MapKit] Expected a string value for color in LineGradient.addColorStop, but got `"+e+"` instead."),this._addColorStop(this._offsets,t,e)},addColorStopAtIndex:function(t,e){if("number"!=typeof t||t<0||t%1!=0)throw new Error("[MapKit] Expected a integer greater than or equal to 0 for index of LineGradient.addColorStopAtIndex, but got `"+t+"` instead.");_(e,"string","[MapKit] Expected a string value for color in LineGradient.addColorStopAtIndex, but got `"+e+"` instead."),this._addColorStop(this._indices,t,e)},toString:function(){return"LineGradient"},_addColorStop:function(t,e,i){const n=t.length;let o=0;for(o=0;o<n&&t[o][0]<e;)++o;o<n&&t[o][0]===e?t[o][1]=i:t.splice(o,0,[e,i]),this._lastUpdate=gd++,this.dispatchEvent(new T.Event(_d.UPDATE_EVENT))}});const fd=_d;function yd(t){Yo(this,yd)&&Object.defineProperty(this,"_impl",{value:new fd(t)})}yd.prototype={constructor:yd,addColorStop:function(t,e){this._impl.addColorStop(t,e)},addColorStopAtIndex:function(t,e){this._impl.addColorStopAtIndex(t,e)},toString:function(){return this._impl.toString()}};const vd=yd;function wd(t){v(t);for(const e in t){const i=Object.getOwnPropertyDescriptor(wd.prototype,e);i&&i.set?this[e]=t[e]:console.warn("[MapKit] Style has no property named `"+e+"`, ignoring.")}}wd.UPDATE_EVENT="update-style";const bd="rgb(0, 122, 255)";wd.prototype=p(T.EventTarget,wd,{_strokeColor:bd,_strokeOpacity:1,_strokeStart:0,_strokeEnd:1,_lineWidth:1,_lineCap:"round",_lineJoin:"round",_lineDash:[],_lineDashOffset:0,_lineGradient:null,_fillColor:bd,_fillOpacity:.1,_fillRule:"nonzero",get strokeColor(){return this._strokeColor},set strokeColor(t){null!=t&&_(t,"string","[MapKit] Expected a string value for Style.strokeColor, but got `"+t+"` instead."),this._strokeColor!==t&&(this._strokeColor=t,this._updated())},get strokeOpacity(){return this._strokeOpacity},set strokeOpacity(t){_(t,"number","[MapKit] Expected a number value for Style.strokeOpacity, but got `"+t+"` instead.");const e=u(t,0,1);this._strokeOpacity!==e&&(this._strokeOpacity=e,this._warnLineGradientComparability(),this._updated())},get strokeStart(){return this._strokeStart},set strokeStart(t){if("number"!=typeof t||!(t>=0&&t<=1))throw new Error("[MapKit] Expected a number between 0 and 1 for Style.strokeStart, but got `"+t+"` instead.");this._strokeStart!==t&&(this._strokeStart=t,this._updated())},get strokeEnd(){return this._strokeEnd},set strokeEnd(t){if("number"!=typeof t||!(t>=0&&t<=1))throw new Error("[MapKit] Expected a number between 0 and 1 for Style.strokeEnd, but got `"+t+"` instead.");this._strokeEnd!==t&&(this._strokeEnd=t,this._updated())},get lineWidth(){return this._lineWidth},set lineWidth(t){_(t,"number","[MapKit] Expected a number value for Style.lineWidth, but got `"+t+"` instead.");const e=Math.max(0,t);this._lineWidth!==e&&(this._lineWidth=e,this._updated())},get lineCap(){return this._lineCap},set lineCap(t){const e=ud,i="[MapKit] Expected one of "+e.map((t=>"`"+t+"`")).join(", ")+" for Style.lineCap, but got `"+t+"` instead.";if(_(t,"string",i),e.indexOf(t)<0)throw new TypeError(i);this._lineCap!==t&&(this._lineCap=t,this._warnLineGradientComparability(),this._updated())},get lineJoin(){return this._lineJoin},set lineJoin(t){const e=pd,i="[MapKit] Expected one of "+e.map((t=>"`"+t+"`")).join(", ")+" for Style.lineJoin, but got `"+t+"` instead.";if(_(t,"string",i),e.indexOf(t)<0)throw new TypeError(i);this._lineJoin!==t&&(this._lineJoin=t,this._warnLineGradientComparability(),this._updated())},get lineDash(){return this._lineDash},set lineDash(t){y(t,"[MapKit] Expected an array of numbers for Style.lineDash, but got `"+t+"` instead."),t.forEach((function(t,e){_(t,"number","[MapKit] Expected an array of numbers for Style.lineDash, but got `"+t+"` at index "+e+" instead.")})),this._lineDash=t.slice(),this._warnLineGradientComparability(),this._updated()},get lineDashOffset(){return this._lineDashOffset},set lineDashOffset(t){_(t,"number","[MapKit] Expected a number value for Style.lineDashOffset, but got `"+t+"` instead."),this._lineDashOffset!==t&&(this._lineDashOffset=t,this._updated())},get lineGradient(){return this._lineGradient},set lineGradient(t){null!==t&&f(t,vd,"[MapKit] Expected a LineGradient object value (or null) for Style.lineGradient, but got `"+t+"` instead."),this._lineGradient!==t&&(this._lineGradient&&this._lineGradient._impl.removeEventListener(fd.UPDATE_EVENT,this),this._lineGradient=t,this._lineGradient&&this._lineGradient._impl.addEventListener(fd.UPDATE_EVENT,this),this._warnLineGradientComparability(),this._updated())},colorStopsForOverlay:function(t){if(!this._lineGradient)return null;const e=this._lineGradient;return 0===e._impl.indices.length?e._impl.offsets:t.getColorStops(e._impl)},get fillColor(){return this._fillColor},set fillColor(t){null!=t&&_(t,"string","[MapKit] Expected a string value for Style.fillColor, but got `"+t+"` instead."),this._fillColor!==t&&(this._fillColor=t,this._updated())},get fillOpacity(){return this._fillOpacity},set fillOpacity(t){_(t,"number","[MapKit] Expected a number value for Style.fillOpacity, but got `"+t+"` instead.");const e=u(t,0,1);this._fillOpacity!==e&&(this._fillOpacity=e,this._updated())},get fillRule(){return this._fillRule},set fillRule(t){const e=md,i="[MapKit] Expected one of "+e.map((t=>"`"+t+"`")).join(", ")+" for Style.fillRule, but got `"+t+"` instead.";if(_(t,"string",i),e.indexOf(t)<0)throw new TypeError(i);this._fillRule!==t&&(this._fillRule=t,this._updated())},shouldStroke:function(){return(this.strokeColor||this.lineGradient)&&this.strokeOpacity>0&&this.lineWidth>0},shouldFill:function(){return this.fillColor&&this.fillOpacity>0},halfStrokeWidthAtResolution:function(){return this.strokeColor&&this.strokeOpacity>0?this.lineWidth/2*Co.devicePixelRatio:0},styleForHitTesting:function(t){const e=Object.create(this);return null!=this._fillColor&&(e._fillColor=bd,e._fillOpacity=1),e._strokeColor=bd,e._strokeOpacity=1,e._lineWidth=this.lineWidth+t,e._impl=e,e},toString:function(){return["strokeColor","strokeOpacity","strokeStart","strokeEnd","lineWidth","lineCap","lineJoin","lineDash","lineDashOffset","lineGradient","fillColor","fillOpacity","fillRule"].filter((function(t){return Object.prototype.hasOwnProperty.call(this,"_"+t)}),this).map((function(t){return t+":"+(Array.isArray(this[t])?JSON.stringify(this[t]):this.prop&&this[t].toString?this[t].toString():this[t])}),this).join(",")},handleEvent:function(t){t.type===fd.UPDATE_EVENT&&this._updated()},_warnLineGradientComparability:function(){if(!this.lineGradient)return;const t=[];1!==this.strokeOpacity&&t.push("strokeOpacity"),"round"!==this.lineCap&&t.push("lineCap"),"round"!==this.lineJoin&&t.push("lineJoin"),0!==this.lineDash.length&&t.push("lineDash"),0!==t.length&&(1===t.length?console.warn("[MapKit] lineGradient is incompatible with the following style property: "+t[0]+"."):console.warn("[MapKit] lineGradient is incompatible with the following style properties: "+t.join(", ")+"."))},_updated:function(){this.dispatchEvent(new T.Event(wd.UPDATE_EVENT))}});const Cd=wd;function kd(t){Yo(this,kd)&&Object.defineProperty(this,"_impl",{value:new Cd(t)})}kd.prototype={constructor:kd,get strokeColor(){return this._impl.strokeColor},set strokeColor(t){this._impl.strokeColor=t},get strokeOpacity(){return this._impl.strokeOpacity},set strokeOpacity(t){this._impl.strokeOpacity=t},get strokeStart(){return this._impl.strokeStart},set strokeStart(t){this._impl.strokeStart=t},get strokeEnd(){return this._impl.strokeEnd},set strokeEnd(t){this._impl.strokeEnd=t},get lineWidth(){return this._impl.lineWidth},set lineWidth(t){this._impl.lineWidth=t},get lineCap(){return this._impl.lineCap},set lineCap(t){this._impl.lineCap=t},get lineJoin(){return this._impl.lineJoin},set lineJoin(t){this._impl.lineJoin=t},get lineDash(){return this._impl.lineDash},set lineDash(t){this._impl.lineDash=t},get lineDashOffset(){return this._impl.lineDashOffset},set lineDashOffset(t){this._impl.lineDashOffset=t},get lineGradient(){return this._impl.lineGradient},set lineGradient(t){this._impl.lineGradient=t},get fillColor(){return this._impl.fillColor},set fillColor(t){this._impl.fillColor=t},get fillOpacity(){return this._impl.fillOpacity},set fillOpacity(t){this._impl.fillOpacity=t},get fillRule(){return this._impl.fillRule},set fillRule(t){this._impl.fillRule=t},toString:function(){return this._impl.toString()}};const Md=kd;function Sd(t,e,i){if(i){i.style&&(this.style=i.style);const t={};Object.keys(i).forEach((function(e){"style"!==e&&(t[e]=i[e])})),i=t}ed.call(this,t,e,i)}Sd.prototype=p(ed,Sd,{constructor:Sd,_fillable:!0,fadeInOutOpacity:{value:1},get style(){return this._style||(this._style=new Md,this._style._impl.addEventListener(Cd.UPDATE_EVENT,this)),this._style},set style(t){if(this._style){if(this._style===t)return;this._style._impl.removeEventListener(Cd.UPDATE_EVENT,this)}f(t,Md,"[MapKit] Expected a mapkit.Style value for Overlay.style, but got `"+t+"` instead."),this._style!==t&&(this._style=t,this._style&&this._style._impl.addEventListener(Cd.UPDATE_EVENT,this),this.updatedProperty("style"))},visibilityToleranceAtScale:function(t){return this.style._impl.halfStrokeWidthAtResolution()/t},clipOverlay:function(t,e,i,n,o){if(this._simplifiedShapeLevel!==n){const t=Math.abs(this._simplifiedShapeLevel-n),e=!!this._hasPoints,i=this._simplifiedShape;this._simplifiedShape=this.simplifyShapeAtLevel(n),this._simplifiedShapeLevel=n,this._hasPoints=this._simplifiedShape.length>0,1===t&&e!==this._hasPoints&&(this.delegate.fadeOverlayTo(this,e?0:1),e&&(this.fadeInOutOpacity.previousShape=this.clip(i)))}const s=this.fadeInOutOpacity.previousShape||(e||!this.clippedShape?this.clip(this._simplifiedShape,t,this.style._impl.halfStrokeWidthAtResolution()/i):this.clippedShape);return o&&(this.clippedShape=s),s},setFadeInOutOpacity:function(t){this.fadeInOutOpacity.value=t,this.updatedProperty("style")},handleEvent:function(t){t.type===Cd.UPDATE_EVENT&&this.updatedProperty("style")},fillPath:function(t,e){t.save(),t.fillStyle=e.fillColor,t.globalAlpha=e.fillOpacity*this.fadeInOutOpacity.value*this.node.opacity,t.fill(e.fillRule),t.restore()},strokePath:function(t,e,i,n){t.save(),t.strokeStyle=n||e.strokeColor,t.globalAlpha=e.strokeOpacity*this.fadeInOutOpacity.value*this.node.opacity;const o=i||Co.devicePixelRatio;t.lineWidth=e.lineWidth*o,e.lineDash.length>0&&"function"==typeof t.setLineDash&&(t.setLineDash(e.lineDash.map((t=>t*o))),t.lineDashOffset=e.lineDashOffset*o),t.lineJoin=e.lineJoin,t.lineCap=e.lineCap,t.stroke(),t.restore()},updateGeometry:function(){const t=this.calculateBoundingRect();t&&(this._boundingRect=t,this.updatedProperty("geometry"))}});const Ld=Sd;function Ad(t){Object.defineProperty(this,"_impl",{value:new Ld(this,t)})}Ad.prototype=p(nd,Ad,{constructor:Ad,get style(){return this._impl.style},set style(t){this._impl.style=t}});const Ed=Ad;function xd(t){ln.call(this),this.overlay=t}xd.prototype=p(ln,xd,{});const Td=xd;function Id(t){Lo.call(this,t)}Id.prototype=p(Lo,Id,{draw:function(t){if(!this._node.overlay.map)return;const e=this._node.overlay.map._impl.camera;this.render(t,e)},render:function(t,e,i){let n=this._node.overlay.style;"number"==typeof i&&(n=n._impl.styleForHitTesting(i));const o=this._node.closed&&n._impl.shouldFill(),s=n._impl.shouldStroke();(o||s)&&this.drawShapes(t,n,o,s,e)},drawShapes:function(t,e,i,n,o){e._impl.lineGradient&&this._node.supportsLineGradient?n&&this.drawGradient(t,e,o):(t.beginPath(),this._node.shapes.forEach((function(e){e.forEach((function(i){let n=o.transformMapPoint(new Gi(i[0].x+e.xOffset,i[0].y));t.moveTo(n.x,n.y);for(let s=1,a=i.length;s<a;s++)n=o.transformMapPoint(new Gi(i[s].x+e.xOffset,i[s].y)),t.lineTo(n.x,n.y);this._node.closed&&t.closePath()}),this)}),this),i&&this._node.overlay.fillPath(t,e),n&&this._node.overlay.strokePath(t,e,1))},drawGradient:function(t,e,i){const n=e._impl.colorStopsForOverlay(this._node.overlay);let o=0;this._node.shapes.forEach((function(s){s.forEach((function(a){const r=[];let l;for(;a[0]._offset>n[o][0];)++o,l=n[o][0];for(let t=0,h=a.length;t<h;){const h=a[t]._offset,c=i.transformMapPoint(new Gi(a[t].x+s.xOffset,a[t].y));l=n[o][0];const d=Rd.normalize(n[o][1]||e.strokeColor);if(h===l)r.push([h,c,d]),++t,++o;else if(h<l){const i=n[o-1],s=i[0],a=i[1]||e.strokeColor,u=Od(Pd(Rd.stringToRGBA(a),Rd.stringToRGBA(d),(h-s)/(l-s)));r.push([h,c,u]),++t}else{r[r.length-1].push([l,d]),++o}}this.strokePathForLineEvents(t,r,e)}),this)}),this)},strokePathForLineEvents:function(t,e,i){for(let n=0,o=e.length-1;n<o;++n){t.beginPath();const o=e[n],s=o[1],a=e[n+1][1];t.moveTo(s.x,s.y),t.lineTo(a.x,a.y);const r=t.createLinearGradient(s.x,s.y,a.x,a.y);if(r.addColorStop(0,o[2]),o.length>2){const t=o[0],s=e[n+1][0]-t;for(let e=3;e<o.length;++e)r.addColorStop(u((o[e][0]-t)/s,0,1),o[e][1]||i.strokeColor)}r.addColorStop(1,e[n+1][2]),this._node.overlay.strokePath(t,i,1,r)}}});const Rd={colorMap:{},normalize:function(t){return Od(this.stringToRGBA(t))},stringToRGBA:function(t){if(t in this.colorMap)return this.colorMap[t];if(!this.context){const t=$();this.context=t.getContext("2d")}this.context.canvas.width=this.context.canvas.height=1,this.context.fillStyle=t,this.context.fillRect(0,0,1,1);const e=this.context.getImageData(0,0,1,1).data,i=[e[0],e[1],e[2],e[3]];return this.colorMap[t]=i,i}};function Od(t){return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"}function Pd(t,e,i){const n=1-i;return[Math.round(t[0]*n+e[0]*i),Math.round(t[1]*n+e[1]*i),Math.round(t[2]*n+e[2]*i),Math.round(t[3]*n+e[3]*i)]}const Dd=Id;function zd(t,e,i){Td.call(this,t),this._closed=!!e,this._renderer=i||new Dd(this)}zd.prototype=p(Td,zd,{get closed(){return this._closed}});const Nd=zd,Fd=2*Math.PI;function Ud(t){Dd.call(this,t)}function Gd(t,e,i,n,o,s,a){t.beginPath();const r=e.transformMapPoint(new Gi(i.x+n,i.y));s&&(s+=e.rotation),a&&(a-=e.rotation),t.arc(r.x,r.y,o,s||0,a||Fd,!0)}Ud.prototype=p(Dd,Ud,{drawShapes:function(t,e,i,n,o){const s=this._node.overlay;this._node.shapes.forEach((function(a){const r=a[0],l=s._mapRadius,h=l*o.worldSize;h<.5||this.drawClipped(t,e,i,n,o,r,l,a.xOffset)||(Gd(t,o,r,a.xOffset,h),i&&s.fillPath(t,e),n&&s.strokePath(t,e,1))}),this)},drawClipped:function(t,e,i,n,o,s,a,r){const l=o.toRenderingMapRect();if(!n||a<l.size.width||a<l.size.height)return!1;const h=e._impl.halfStrokeWidthAtResolution()/o.worldSize,c=l.minX()-h-r,d=l.maxX()+h-r,u=l.minY()-h,p=l.maxY()+h,m=s.x,g=s.y;function _(t,e){const i=m-t,n=g-e;return i*i+n*n<=a*a}const f=[];let y;_(d,p)&&f.push(new si(d,p));const v=Math.acos((d-m)/a);if(!isNaN(v)){let t=g+a*Math.sin(v);t>=u&&t<=p&&(y=new si(d,t),y.angle=v,f.push(y)),t=g-a*Math.sin(v),t>=u&&t<=p&&(y=new si(d,t),y.angle=Fd-v,f.push(y))}_(d,u)&&f.push(new si(d,u));const w=Math.asin((u-g)/a);if(!isNaN(w)){let t=m+a*Math.cos(w);t>=c&&t<=d&&(y=new si(t,u),y.angle=(w+Fd)%Fd,f.push(y)),t=m-a*Math.cos(w),t>=c&&t<=d&&(y=new si(t,u),y.angle=Math.PI-w,f.push(y))}_(c,u)&&f.push(new si(c,u));const b=Math.acos((c-m)/a);if(!isNaN(b)){let t=g-a*Math.sin(b);t>=u&&t<=p&&(y=new si(c,t),y.angle=Fd-b,f.push(y)),t=g+a*Math.sin(b),t>=u&&t<=p&&(y=new si(c,t),y.angle=b,f.push(y))}_(c,p)&&f.push(new si(c,p));const C=Math.asin((p-g)/a);if(!isNaN(C)){let t=m-a*Math.cos(C);t>=c&&t<=d&&(y=new si(t,p),y.angle=Math.PI-C,f.push(y)),t=m+a*Math.cos(C),t>=c&&t<=d&&(y=new si(t,p),y.angle=(C+Fd)%Fd,f.push(y))}const k=f.length;let M=1;for(;k>2&&M<k&&(!isNaN(f[M-1].angle)||isNaN(f[M].angle)||isNaN(f[(M+1)%k].angle));)M+=1;if(M<k){let l=(M+1)%k;for(;k>2&&!isNaN(f[l].angle)&&!isNaN(f[(l+1)%k].angle);)l=(l+1)%k;const h=a*o.worldSize,c=Math.abs(f[M].angle-f[l].angle),d=h*c-2*h*Math.sin(c/2)>.001,u=o.transformMapPoint(new Gi(f[M].x+r,f[M].y)),p=o.transformMapPoint(new Gi(f[l].x+r,f[l].y));if(i){d?Gd(t,o,s,r,h,f[M].angle,f[l].angle):(t.beginPath(),t.moveTo(u.x,u.y),t.lineTo(p.x,p.y));for(let e=(l+1)%k;isNaN(f[e].angle);e=(e+1)%k){const i=o.transformMapPoint(new Gi(f[e].x+r,f[e].y));t.lineTo(i.x,i.y)}this._node.overlay.fillPath(t,e)}n&&(d?Gd(t,o,s,r,h,f[M].angle,f[l].angle):(t.beginPath(),t.moveTo(u.x,u.y),t.lineTo(p.x,p.y)),this._node.overlay.strokePath(t,e))}else k>0&&i&&(t.fillStyle=e.fillColor,t.globalAlpha=e.fillOpacity,t.fillRect(0,0,l.size.width*o.worldSize,l.size.height*o.worldSize));return!0}});const Bd=Ud;function Zd(t){Nd.call(this,t,!0,new Bd(this))}Zd.prototype=p(Nd,Zd,{stringInfo:function(){const t=this.overlay;return"CircleOverlayNode<radius:"+t.radius+","+t.coordinate.toString().toLowerCase()+">"+(t.style.toString()?"["+t.style+"]":"")}});const Wd=Zd,Kd=hi.Coordinate,Hd=hi.MapRect;function jd(t,e,i,n){Ld.call(this,new Wd(this),t,n),this.coordinate=e,this.radius=i}function Vd(){return[this._coordinate.toMapPoint()]}jd.prototype=p(Ld,jd,{get coordinate(){return this._coordinate},set coordinate(t){f(t,Kd,"[MapKit] CircleOverlayInternal.coordinate expected a Coordinate value, but got `"+t+"` instead."),this._coordinate&&this._coordinate.latitude===t.latitude&&this._coordinate.longitude===t.longitude||(this._coordinate=t.copy(),this.updateGeometry())},get radius(){return this._radius},set radius(t){const e="[MapKit] CircleOverlayInternal.radius expected a non-negative number (radius in meters), but got `"+t+"` instead.";_(t,"number",e),t<0&&console.warn(e);const i=Math.max(0,t);this._radius!==i&&(this._radius=i,this.updateGeometry())},calculateBoundingRect:function(){if(!this._coordinate||isNaN(this._radius))return null;const t=this._center=this._coordinate.toMapPoint(),e=this._mapRadius=this._radius*hi.mapUnitsPerMeterAtLatitude(this._coordinate.latitude);return new Hd(t.x-e,t.y-e,2*e,2*e)},simplifyShapeAtLevel:Vd,clip:Vd});const qd=jd;function Yd(t,e,i){Yo(this,Yd)&&Object.defineProperty(this,"_impl",{value:new qd(this,t,e,i)})}Yd.prototype=p(Ed,Yd,{get coordinate(){return this._impl.coordinate},set coordinate(t){this._impl.coordinate=t},get radius(){return this._impl.radius},set radius(t){this._impl.radius=t}});const Xd=Yd;function $d(t){Nd.call(this,t,!1)}$d.prototype=p(Nd,$d,{supportsLineGradient:!0,stringInfo:function(){const t=this.overlay;return"PolylineOverlayNode<points:"+(t.points.map((t=>t.toString())).join(",")+">")+(t.style.toString()?"["+t.style+"]":"")}});const Jd=$d,Qd=function(t,e){const i=[];function n(t){const e=i.length;t._index=e,i.push(t),s(e)}function o(t,e){const n=i[t];return i[t]=i[e],i[e]=n,i[t]._index=t,i[e]._index=e,e}function s(t){for(;t>0;){const e=Math.floor((t-1)/2);if(i[e]._area<=i[t]._area)return;t=o(t,e)}}function a(t){for(;;){const e=2*t+1,n=2*t+2,s=i[t]._area,a=i[e]?i[e]._area:1/0,r=i[n]?i[n]._area:1/0;if(s<=a&&s<=r)return;t=o(t,a<=s&&a<=r?e:n)}}function r(){const t=i[0],e=i.pop();return i.length>0&&(i[0]=e,e._index=0,a(0)),t}function l(t){const e=t._prev,i=t,n=t._next;return Math.abs((e.x-n.x)*(i.y-e.y)-(e.x-i.x)*(n.y-e.y))/2}function h(t,e){const i=t._area;t._area=Math.max(l(t),e),t._area<i?s(t._index):a(t._index)}let c=t.length-1,d=!1,u=!1;e&&c>1&&(t[c].equals(t[0])||(t.push(t[0].copy()),d=!0,++c),u=!0,t.unshift(t[c-1].copy()),++c),t[0]._area=t[c]._area=1/0;for(let e=1;e<c;++e){const i=t[e];i._prev=t[e-1],i._next=t[e+1],i._area=l(i),n(i)}for(u&&t.shift(),d&&t.pop();i.length>0;){const t=r(),e=t._prev,i=t._next;e._prev&&(e._next=i,h(e,t._area)),i._next&&(i._prev=e,h(i,t._area)),delete t._index,delete t._next,delete t._prev}},tu=function(t,e){const i=1/(e*e),n=t.filter((t=>t._area>i));if(2===n.length){const t=n[0].x-n[1].x,e=n[0].y-n[1].y;if(t*t+e*e<1*i)return[]}return n},eu=hi.Coordinate,iu=hi.MapRect,nu=1e3;function ou(t,e,i){Ld.call(this,new Jd(this),t,i),this.points=e,this.updateGeometry()}function su(t,e,i){const n=t[i];let o=null;for(let e=i-1;!o;--e)void 0!==t[e]._offset&&(o=t[e]);let s=null;for(let e=i+1;!s;++e)void 0!==t[e]._offset&&(s=t[e]);const a=Math.sqrt(Math.pow(o.x-n.x,2)+Math.pow(o.y-n.y,2));t[i]._offset=Math.min(o._offset+a/e,s._offset)}function au(t,e,i,n,o){let s,a=o.minX()-o.size.width;if(t.x<a)return s=(a-t.x)/i,ru(a,(1-s)*t.y+s*e.y,t,e,i,n);if(a=o.maxX()+o.size.width,t.x>a)return s=(a-t.x)/i,ru(a,(1-s)*t.y+s*e.y,t,e,i,n);let r=o.minY()-o.size.height;return t.y<r?(s=(r-t.y)/n,ru((1-s)*t.x+s*e.x,r,t,e,i,n)):(r=o.maxY()+o.size.height,t.y>r?(s=(r-t.y)/n,ru((1-s)*t.x+s*e.x,r,t,e,i,n)):t)}function ru(t,e,i,n,o,s){const a={x:t,y:e};if("number"==typeof i._offset&&"number"==typeof n._offset){const r=Math.sqrt(o*o+s*s),l=Math.sqrt(Math.pow(t-i.x,2)+Math.pow(e-i.y,2));a._offset=i._offset+(n._offset-i._offset)*(l/r)}return a}ou.prototype=p(Ld,ou,{_fillable:!1,get points(){return this._points.slice()},set points(t){f(t,Array,"[MapKit] PolylineOverlay.points expected an array of Coordinates."),this._points=t.slice(),this._mapPoints=this._points.map((function(t,e){return f(t,eu,"[MapKit] PolylineOverlay.points expected a Coordinate at index: "+e),t.toUnwrappedMapPoint()})),this._pointsNeedRemapping=!0,delete this._distances,delete this._colorStops,this.updateGeometry()},calculateBoundingRect:function(){if(0===this._mapPoints.length)return new iu(0,0,0,0);const t=this._mapPoints.reduce((function(t,e){return e.x<t.xMin&&(t.xMin=e.x),e.x>t.xMax&&(t.xMax=e.x),e.y<t.yMin&&(t.yMin=e.y),e.y>t.yMax&&(t.yMax=e.y),t}),{xMin:1/0,xMax:-1/0,yMin:1,yMax:0}),e=t.xMax-t.xMin,i=c(t.xMin,1);if(this._pointsNeedRemapping){delete this._pointsNeedRemapping,e>1&&console.warn("[MapKit] Polyline overlay spans over 360Âº in longitude and may not render correctly.");const n=t.xMin-i;this._mapPoints.forEach((t=>{t.x-=n})),Qd(this._mapPoints),delete this._simplifiedShapeLevel}return new iu(i,t.yMin,e,t.yMax-t.yMin)},simplifyShapeAtLevel:function(t){delete this._distances;const e=this._simplifiedShapeLevel>t?this._simplifiedShape:this._mapPoints;return tu(e,Math.pow(2,t))},clip:function(t,e,i){return t.length>0&&(t=this.clipShapeByStyleProperties(t)),!e||Vo(e,this._boundingRect)?0===t.length?[]:[t]:function(t,e,i){const n=e.minX()-i,o=e.minY()-i,s=e.maxX()+i,a=e.maxY()+i,r=nu*e.size.width,l=nu*e.size.height,h=[];let c,d;for(let i=0,u=t.length;i<u-1;++i){const u=t[i];d=t[i+1];const p=d.x-u.x;let m,g;if(0!==p){const t=(n-u.x)/p,e=(s-u.x)/p;g=!(t<0&&e<0||t>1&&e>1)}else g=u.x>=n&&u.x<=s;if(g)if(m=d.y-u.y,0!==m){const t=(o-u.y)/m,e=(a-u.y)/m;g=!(t<0&&e<0||t>1&&e>1)}else g=u.y>=o&&u.y<=a;const _=Math.abs(p)>r||Math.abs(m)>l;g?(c||(c=[]),_?(c.push(au(u,d,p,m,e)),c.push(au(d,u,-p,-m,e)),h.push(c),c=null):c.push(u)):c&&(_?(c.push(au(u,d,p,m,e)),c.push(au(d,u,-p,-m,e))):c.push(u),h.push(c),c=null)}c&&(c.push(d),h.push(c));return h}(t,e,i)},clipShapeByStyleProperties:function(t){const e=this.style.strokeStart,i=this.style.strokeEnd,n=this.style.lineGradient;if(0!==e||1!==i||n){if(!this._distances||n&&!this._colorStops){this._length=0,this._distances=[];const e=t.length;for(let i=0;i<e-1;++i){const e=t[i],n=t[i+1],o=Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2));this._length+=o,this._distances.push(o)}if(n){if(n._impl.indices.length>0&&void 0!==this._mapPoints[0]._offset)for(let t=0,e=this._mapPoints.length;t<e;++t)delete this._mapPoints[t]._offset;for(let i=0,n=0;i<e-1;++i)t[i]._offset=n/this._length,n+=this._distances[i];e>0&&(t[e-1]._offset=1)}}0===e&&1===i||(t=function(t,e,i,n){if(i>=n)return[];let o=0,s=!1;const a=[];let r;for(let l=0,h=t.length;l<h-1;++l){let h=t[l];r=t[l+1];const c=e[l];if(o+=c,!s&&o>=i){s=!0;const t=(o-i)/c;h={x:t*h.x+(1-t)*r.x,y:t*h.y+(1-t)*r.y,_offset:t*h._offset+(1-t)*r._offset}}if(s&&(a.push(h),o>=n)){const t=(o-n)/c;r={x:t*h.x+(1-t)*r.x,y:t*h.y+(1-t)*r.y,_offset:t*h._offset+(1-t)*r._offset};break}}return a.push(r),a}(t,this._distances,e*this._length,i*this._length))}return t},getColorStops:function(t){if(!this._colorStops||this._colorStops.lastUpdate!==t.lastUpdate){const e=t.offsets,i=t.indices;this._colorStops=e.slice(),this._colorStops.lastUpdate=t.lastUpdate;let n=0;const o=this._mapPoints.length;for(let t=0,e=i.length;n<this._colorStops.length&&t<e;++n,++t){const e=i[t],s=e[0];if(!(s<o))break;{void 0===this._mapPoints[s]._offset&&su(this._mapPoints,this._length,s);const t=this._mapPoints[s]._offset,i=e[1];for(;this._colorStops[n][0]<t;)++n;this._colorStops[n][0]===t?this._colorStops[n][1]=i:this._colorStops.splice(n,0,[t,i])}}}return this._colorStops}});const lu=ou;function hu(t,e){Yo(this,hu)&&Object.defineProperty(this,"_impl",{value:new lu(this,t,e)})}hu.prototype=p(Ed,hu,{get points(){return this._impl.points},set points(t){this._impl.points=t}});const cu=hu;function du(t){Nd.call(this,t,!0)}du.prototype=p(Nd,du,{stringInfo:function(){const t=this.overlay;return"PolygonOverlayNode<points:"+(t.points.map((t=>t.map((t=>t.toString())).join(","))).join("|")+">")+(t.style.toString()?"["+t.style+"]":"")}});const uu=du,pu=hi.Coordinate,mu=hi.MapRect;function gu(t,e,i){Ld.call(this,new uu(this),t,i),this.points=e,this.updateGeometry()}gu.prototype=p(Ld,gu,{get points(){return this._points.map((t=>t.slice()))},set points(t){y(t,"[MapKit] PolygonOverlay.points expected an array of Coordinates."),Array.isArray(t[0])||(t=[t]),this._points=t.map((function(t,e){return y(t,"[MapKit] PolygonOverlay.points expected an array at index: "+e),t.slice()})),this._polygons=this._points.map((function(t,e){return t.map((function(t,i){return f(t,pu,"[MapKit] PolygonOverlay.points expected a Coordinate at index: "+e+", "+i),t.toUnwrappedMapPoint()}))})),this.updateGeometry()},calculateBoundingRect:function(){const t=function(t){const e=t.filter((t=>t.length>2)).map((function(t){const e=t.reduce((function(t,e){return e.x<t.xMin&&(t.xMin=e.x),e.x>t.xMax&&(t.xMax=e.x),e.y<t.yMin&&(t.yMin=e.y),e.y>t.yMax&&(t.yMax=e.y),t}),{xMin:1/0,xMax:-1/0,yMin:1,yMax:0});return new mu(e.xMin,e.yMin,e.xMax-e.xMin,e.yMax-e.yMin)})).sort((function(t,e){return t.minX()-e.minX()}));return qo(e)}(this._polygons);return delete this._simplifiedShapeLevel,t.size.width>1&&console.warn("[MapKit] Polygon overlay spans over 360Âº in longitude and may not render correctly."),this._polygons.forEach((function(e){0!==e.length&&(e.forEach((function(e){const i=c(e.x,1);e.x=i+(i<t.minX()?1:0)})),Qd(e,!0))})),t},simplifyShapeAtLevel:function(t){const e=this._simplifiedShapeLevel>t?this._simplifiedShape:this._polygons,i=Math.pow(2,t);return e.reduce((function(t,e){const n=tu(e,i);return n.length>0&&t.push(n),t}),[])},clip:function(t,e,i){return!e||Vo(e,this._boundingRect)?t:function(t,e,i){const n=e.minX()-i,o=e.minY()-i,s=e.maxX()+i,a=e.maxY()+i,r=[];for(let e=0,i=t.length;e<i;++e){const i=t[e],l=[];for(let t=0,e=i.length;t<e;++t){const o=i[t],s=i[(t-1+e)%e];if(o.x>=n){if(s.x<n){const t=(n-o.x)/(s.x-o.x);l.push({x:n,y:(1-t)*o.y+t*s.y})}l.push(o)}else if(s.x>=n){const t=(n-o.x)/(s.x-o.x);l.push({x:n,y:(1-t)*o.y+t*s.y})}}const h=[];for(let t=0,e=l.length;t<e;++t){const i=l[t],n=l[(t-1+e)%e];if(i.y>=o){if(n.y<o){const t=(o-i.y)/(n.y-i.y);h.push({x:(1-t)*i.x+t*n.x,y:o})}h.push(i)}else if(n.y>=o){const t=(o-i.y)/(n.y-i.y);h.push({x:(1-t)*i.x+t*n.x,y:o})}}const c=[];for(let t=0,e=h.length;t<e;++t){const i=h[t],n=h[(t-1+e)%e];if(i.x<=s){if(n.x>s){const t=(s-i.x)/(n.x-i.x);c.push({x:s,y:(1-t)*i.y+t*n.y})}c.push(i)}else if(n.x<=s){const t=(s-i.x)/(n.x-i.x);c.push({x:s,y:(1-t)*i.y+t*n.y})}}const d=[];for(let t=0,e=c.length;t<e;++t){const i=c[t],n=c[(t-1+e)%e];if(i.y<=a){if(n.y>a){const t=(a-i.y)/(n.y-i.y);d.push({x:(1-t)*i.x+t*n.x,y:a})}d.push(i)}else if(n.y<=a){const t=(a-i.y)/(n.y-i.y);d.push({x:(1-t)*i.x+t*n.x,y:a})}}d.length>2&&r.push(d)}return r}(t,e,i)}});const _u=gu;function fu(t,e){Yo(this,fu)&&Object.defineProperty(this,"_impl",{value:new _u(this,t,e)})}fu.prototype=p(Ed,fu,{get points(){return this._impl.points},set points(t){this._impl.points=t}});const yu=fu,vu={OverlaysController:rd,LayerItemsController:Xc,ItemCollection:dd,mapkit:{Style:Md,LineGradient:vd,CircleOverlay:Xd,PolylineOverlay:cu,PolygonOverlay:yu,TileOverlay:pa}};function wu(t){this._map=t,this.panning=!1}wu.prototype={constructor:wu,update:function(t,e){if(!this._map.isScrollEnabled)return;const i=t._impl.translatedPosition(),n=i.x,o=n+e.size.width,s=i.y,a=s+e.size.height,r=this._map.ensureVisibleFrame();this._direction=new Gi,n<=r.minX()?this._direction.x=1:o>=r.maxX()&&(this._direction.x=-1),s<=r.minY()+5?this._direction.y=1:a>=r.maxY()-5&&(this._direction.y=-1);const l=0!==this._direction.x||0!==this._direction.y;!this.panning&&l?(this.panning=!0,this._startTime=Date.now(),this._initialSpeed=Math.floor(1/104.1*(r.size.width+r.size.height)/2),ue.scheduleOnNextFrame(this)):this.panning&&!l&&this.stop()},stop:function(){this.panning&&(this.panning=!1,delete this._direction,delete this._startTime,delete this._initialSpeed)},performScheduledUpdate:function(){if(!this.panning)return;let t=this._initialSpeed;const e=Date.now()-this._startTime;e>4e3?t*=3:e>1e3&&(t*=1.5),this._map.translateCameraAnimated(new Gi(this._direction.x*t,this._direction.y*t),!1),this._map.panningDuringAnnotationDrag(),ue.scheduleOnNextFrame(this)},mapWasDestroyed:function(){delete this._map}};const bu=wu,Cu="mk-hidden",ku="mk-invisible";function Mu(t){t&&(this._public=t),this._position=this._position?this._position:new Gi,this._anchorPoint=this._anchorPoint?this._anchorPoint:new Gi,this._anchorOffset=this._anchorOffset?this._anchorOffset:new window.DOMPoint}Mu.prototype={_shown:!0,_visible:!0,_position:void 0,_anchorPoint:void 0,_anchorOffset:void 0,_appearanceAnimation:"",renderedByDOMElement:!0,isMapFeature:!1,delegate:null,get node(){return this._node},get element(){return this._element},set element(t){console.warn("[MapKit] The `element` property is read-only.")},get anchorOffset(){return this._anchorOffset},set anchorOffset(t){f(t,window.DOMPoint,"[MapKit] Annotation.anchorOffset expected a DOMPoint, but got `"+t+"` instead."),this._anchorOffset=new window.DOMPoint(t.x,t.y),this.updatePosition()},get visible(){return this._visible},set visible(t){t=!!t,this._visible!==t&&(this._visible=t,this._updateVisibility())},get appearanceAnimation(){return this._appearanceAnimation},set appearanceAnimation(t){if(_(t,"string","[MapKit] Annotation.appearanceAnimation expected a string, but got `"+t+"` instead."),""===t)return void(this._appearanceAnimation=this._appearanceAnimationName="");const e=document.createElement("div");e.style.animation=t,this._appearanceAnimationName=e.style.animationName,this._appearanceAnimationName?this._appearanceAnimation=t:console.warn("[MapKit] Annotation.appearanceAnimation expects an animation style value with an animation name, but got `"+t+"` instead.")},nodePosition:function(){return this._nodePosition||this._node.position},calculateNodePosition:function(){return new Gi(this._position.x-this._anchorPoint.x-this._anchorOffset.x,this._position.y-this._anchorPoint.y-this._anchorOffset.y)},updatePosition:function(){const t=this.calculateNodePosition();!this.renderedByDOMElement&&this.map&&this.map._impl.cameraIsMoving?this._nodePosition=t:(delete this._nodePosition,this._node.position=t),this.positionWasUpdated(t)},setShown:function(t){t=!!t,this._shown!==t&&(this._shown=t,this._node.element&&this._node.classList.toggle(Cu,!t),this.shownPropertyWasUpdated(t))},shownPropertyWasUpdated:function(){},positionWasUpdated:function(t){},isShown:function(){return this._shown},position:function(){return this._position},setPosition:function(t){this._position=t,this.updatePosition()},updateVisibility:function(t){this._node.classList.toggle(ku,t)},setSize:function(t){this._node.size=t,this._anchorPoint=new Gi(t.width/2,t.height),this.updatePosition()},_updateVisibility:function(){!this._visible&&this._animating||(this.updateVisibility(!this._visible),this.delegate&&this.delegate.annotationPropertyDidChange(this._public||this,"visible"))}};const Su=Mu;function Lu(){Object.defineProperty(this,"_impl",{value:new Su(this)})}Lu.prototype=p(St.EventTarget,Lu,{get element(){return this._impl.element},set element(t){this._impl.element=t},get anchorOffset(){return this._impl.anchorOffset},set anchorOffset(t){this._impl.anchorOffset=t},get animates(){return this._impl.animates},set animates(t){this._impl.animates=t},get visible(){return this._impl.visible},set visible(t){this._impl.visible=t},get appearanceAnimation(){return this._impl.appearanceAnimation},set appearanceAnimation(t){this._impl.appearanceAnimation=t}});const Au=Lu,Eu=hi.Coordinate;function xu(t){this.displayLines=t.displayLines,t.id&&(this.id=t.id,this.alternateIds=t.alternateIds||[]),t.muid&&(this.muid=t.muid),t.location&&(this.coordinate=new Eu(t.location.lat,t.location.lng)),this._completionUrl=t.completionUrl,t.attribution&&(this._providerId=t.attribution.vendorId,this._providerItemId=t.attribution.externalItemId),this.name=t.name,this.telephone=t.telephone,this.urls=t.urls||[],this.country=t.country,this.administrativeArea=t.administrativeArea,this.administrativeAreaCode=t.administrativeAreaCode,this.locality=t.locality,this.postCode=t.postCode,this.subLocality=t.subLocality,this.thoroughfare=t.thoroughfare,this.subThoroughfare=t.subThoroughfare,this.fullThoroughfare=t.fullThoroughfare,this.areasOfInterest=t.areasOfInterest,this.dependentLocalities=t.dependentLocalities,this.timezone=t.timezone,this.timezoneSecondsFromGmt=t.timezoneSecondsFromGmt}xu.isConstructable=!1;const Tu=function(t){if(xu.isConstructable)return xu.call(this,t);throw new TypeError("[MapKit] SearchAutocompleteResult may not be constructed.")};xu.prototype=Tu.prototype={constructor:Tu};const Iu=xu,Ru=(t,e,i)=>{const n=[];for(let o=0;o<t.length;o+=1){let s=parseInt(t.charAt(o),e),a=0;for(;s||a<n.length;)s+=(n[a]||0)*e,n[a]=s%i,s=(s-n[a])/i,a+=1}return n.reduce(((t,e)=>e.toString(i).toUpperCase()+t),"")},Ou=(t,e)=>e?`${t}${Ru(e.toString(),10,16)}`:"",Pu={muidToPlaceId:t=>Ou("G",t.protocolVersion)+Ou("H",t.sourceId)+Ou("I",t.muid),placeIdToMuid:t=>{const e={};let i=0,n=0;for(let o=0;o<=t.length;o+=1){const s=t.charCodeAt(o),a=isNaN(s)||s>=71&&s<=90;if(i!==n||a||(n=o),i!==n&&a){e[t.substring(i,n)]=t.substring(n,o),i=o,n=o}}const o=e.I;return o?{sourceId:e.H?parseInt(e.H,16):0,protocolVersion:e.G?parseInt(e.G,16):0,muid:Ru(o,16,10)}:null}},Du=Object.freeze({Automatic:"automatic",Callout:"callout",FullCallout:"fullCallout",CompactCallout:"compactCallout",OpenInMaps:"openInMaps"});class zu{constructor({style:t}={}){this._impl={},this.style=t||Du.Automatic}get style(){return this._impl.style}set style(t){if(!m(t,Du))throw new Error("[MapKit] value passed to `PlaceSelectionAccessory.style` must be a value of `PlaceSelectionAccessory.Styles` enum.");this._impl.style=t}}zu.Styles=Du;const Nu=hi.Coordinate,Fu=Object.freeze({element:"ro",map:"ro",coordinate:"ro",id:"rw",place:"rw",title:"rw",subtitle:"rw",data:"rw",accessibilityLabel:"rw",anchorOffset:"rw",calloutOffset:"rw",size:"rw",callout:"rw",selectionAccessory:"rw",selectionAccessoryOffset:"rw",visible:"rw",enabled:"rw",selected:"rw",calloutEnabled:"rw",animates:"rw",appearanceAnimation:"rw",collisionMode:"rw",padding:"rw",draggable:"rw",displayPriority:"rw",clusteringIdentifier:"rw"}),Uu={DragStart:"drag-start",Dragging:"dragging",DragEnd:"drag-end"},Gu={Low:250,High:750,Required:1e3},Bu={Rectangle:"rectangle",Circle:"circle",None:"none"};function Zu(t){function e(i,n,o,s){this._calloutOffset=this._calloutOffset?this._calloutOffset:new window.DOMPoint(0,1),this._padding=this._padding?this._padding:new $o,this._selectionAccessoryOffset=this._selectionAccessoryOffset?this._selectionAccessoryOffset:new window.DOMPoint(0,0),t.call(this,i),v(s);if((n instanceof mi||n instanceof Iu)&&((s=s?Object.create(s):{}).place=n,n=n.coordinate),this._setCoordinate(n),this._unsized=!0,this.occluded=!1,this._setNode(n,o,s),s){for(const[t,i]of Object.entries(this.ConstructorOptions))void 0!==s[t]&&("ro"!==i?e.OptionSetters[t]?e.OptionSetters[t].call(this,s[t]):this[t]=s[t]:console.warn("[MapKit] `"+t+"` is read-only and can't be set on the Annotation."));Object.keys(s).forEach((function(t){this.isAKnownOption(t)||console.warn("[MapKit] Unknown option for annotation: "+t+" (use the `data` property instead)")}),this)}Oi.addEventListener(Oi.Events.LocaleChanged,this),this.updateLocalizedText()}return e.Events=Uu,e.DisplayPriority=Gu,e.CollisionMode=Bu,e.prototype=p(t,e,{_calloutOffset:void 0,_enabled:!0,_selected:!1,_calloutEnabled:!0,_draggable:!1,_title:"",_subtitle:"",_accessibilityLabel:null,_displayPriority:Gu.Required,_collisionMode:Bu.Rectangle,_clusteringIdentifier:null,_sceneGraphNode:null,_padding:void 0,_draggingLift:40,shouldHideLabels:!1,_callout:null,_selectionAccessory:null,_selectionAccessoryOffset:void 0,get map(){return this.delegate&&this.delegate.mapForAnnotation(this._public)},set map(t){console.warn("[MapKit] The `map` property is read-only.")},get coordinate(){return this._coordinate},set coordinate(t){this.memberAnnotations||this._setCoordinate(t)},get id(){return this._place&&this._place.id||this._id},set id(t){this._id=t},get place(){return this._place},set place(t){if(!(t instanceof mi)&&!(t instanceof Iu))throw new TypeError("[MapKit] Expected a Place for Annotation.place, but got `"+t+"` instead");this._place=t},get title(){return this._title},set title(t){null!=t?(_(t,"string","[MapKit] Expected a string value for Annotation.title, but got `"+t+"` instead"),this._title=t):delete this._title,this.updateLocalizedText(),this._updatedProperty("title")},get subtitle(){return this._subtitle},set subtitle(t){null!=t?(_(t,"string","[MapKit] Expected a string value for Annotation.subtitle, but got `"+t+"` instead"),this._subtitle=t):delete this._subtitle,this.updateLocalizedText(),this._updatedProperty("subtitle")},get accessibilityLabel(){return this._accessibilityLabel},set accessibilityLabel(t){null!=t?(_(t,"string","[MapKit] Expected a string value for Annotation.accessibilityLabel, but got `"+t+"` instead"),this._accessibilityLabel=t):delete this._accessibilityLabel,this.updateLocalizedText()},get data(){return Object.prototype.hasOwnProperty.call(this,"_data")||(this._data={}),this._data},set data(t){this._data=t},get enabled(){return this._enabled},set enabled(t){this._enabled=!!t},get calloutEnabled(){return this._calloutEnabled},set calloutEnabled(t){this._calloutEnabled=!!t},get selected(){return this._selected},set selected(t){const e=!!t;if(e!==this._selected){if(this.delegate&&!this.delegate.selectionMayChange)return void console.warn("[MapKit] Selection may not change in select/deselect event handler.");this._selected=e,this._updatedProperty("selected")}},get animates(){return this._animates},set animates(t){this._animates=!!t},get calloutOffset(){return this._calloutOffset},set calloutOffset(t){f(t,window.DOMPoint,"[MapKit] Annotation.calloutOffset expected a DOMPoint, but got `"+t+"` instead."),this._calloutOffset=new window.DOMPoint(t.x,t.y),this._updatedProperty("calloutOffset")},get callout(){return this._callout},set callout(t){null!==t&&_(t,"object","[MapKit] Annotation.callout expected an object, but got `"+t+"` instead."),this._callout=t},get selectionAccessory(){return this._selectionAccessory},set selectionAccessory(t){if(!this.place&&!this.muid)throw new Error("[MapKit] Selection Accessory can only be set on an annotation with an associated `place`.");null!==t&&f(t,zu,"[MapKit] The `selectionAccessory` parameter passed to `Annotation.selectionAccessory` is not a PlaceSelectionAccessory."),this._selectionAccessory=t},get selectionAccessoryOffset(){return this._selectionAccessoryOffset},set selectionAccessoryOffset(t){f(t,window.DOMPoint,"[MapKit] Annotation.selectionAccessoryOffset expected a DOMPoint, but got `"+t+"` instead."),this._selectionAccessoryOffset=new window.DOMPoint(t.x,t.y),this._updatedProperty("selectionAccessoryOffset")},get draggable(){return this._draggable},set draggable(t){this.memberAnnotations||this._setDraggable(t)},get draggingLift(){return this._draggingLift},set draggingLift(t){if(_(t,"number","[MapKit] Annotation.draggingLift expected a number, but got `"+t+"` instead."),t<0)throw new Error("[MapKit] Annotation.draggingLift must be zero or more.");this._draggingLift=t},get size(){if(this._updateSize(),!this._unsized)return this._node.size.copy()},set size(t){const e="[MapKit] Annotation size expects a size object with width and height properties";_(t,"object",e),_(t.width,"number",e),_(t.height,"number",e),this.setSize(new Ui(t.width,t.height)),this._userSetSize=!0,this.updateSize()},get opacity(){return this.sceneGraphNode?this.sceneGraphNode.opacity:this.node.opacity},set opacity(t){this.sceneGraphNode?this.sceneGraphNode.opacity=t:this.node.opacity=t},get displayPriority(){return this._displayPriority},set displayPriority(t){this.memberAnnotations||this._setDisplayPriority(t)},isRequired:function(){return this.selected||this.displayPriority===Gu.Required},get collisionMode(){return this._collisionMode},set collisionMode(t){if(!m(t,Bu))throw new Error("[MapKit] Unknown value for `collisionMode`. Choose from Annotation.CollisionMode.");t!==this._collisionMode&&(this._collisionMode=t,this._updatedProperty("collisionMode"))},get clusteringIdentifier(){return this._clusteringIdentifier},set clusteringIdentifier(t){this.memberAnnotations||this._setClusteringIdentifier(t)},get padding(){return this._padding.copy()},set padding(t){f(t,$o,"[MapKit] The `padding` parameter passed to `Annotation.padding` is not a Padding."),this._padding.equals(t)||(this._padding=t.copy(),this._updatedProperty("padding"))},get needsLayout(){return this._sceneGraphNode&&this._sceneGraphNode.needsLayout},get elementInAnnotationDOM(){return this._node.element.firstChild},getMuidList(){const t=[],e=this.id,i=e?Pu.placeIdToMuid(e):null,n=i&&i.muid||this.place&&this.place.muid||this._muid;n&&t.push(n);const o=this.place&&this.place.alternateIds||[];for(const e of o){const i=e?Pu.placeIdToMuid(e):null;i&&i.muid&&t.push(i.muid)}return t},centerOffsetForSelectionAccessory(){const t=this.size;return new Gi(-t.width/2,-t.height/2)},removedFromMap:function(){this._removedFromMap=!0,Oi.removeEventListener(Oi.Events.LocaleChanged,this),this._occludedAnimation&&this._occludedAnimation.end(),this._clusteringAnimation&&this._clusteringAnimation.end()},addedToMap:function(){this._removedFromMap&&(this._removedFromMap=!1,Oi.addEventListener(Oi.Events.LocaleChanged,this),this.updateLocalizedText())},delegate:null,setDelegate:function(t){this.delegate=t},updateLayout:function(){},doesAnimate:function(){return this._animates&&!!this._appearanceAnimationName},willMoveToMap:function(){this._isMoving=this.doesAnimate(),this._updateSize()},didMoveToMap:function(){this._isMoving&&this._appearanceAnimationName&&this._visible&&(this.element.style.animation=this._appearanceAnimation,this.element.style.animationName&&(this._animating=!0,this.element.addEventListener("animationend",this))),delete this._isMoving},isStable:function(){return!(this.isWaiting||this._isMoving||this._isAnimating||this._isLifted)},canShowCallout:function(){return this._calloutEnabled&&this.isStable()},canShowSelectionAccessory(){return this.isStable()},selectionAccessoryWillAppear:function(){},selectionAccessoryWillDisappear:function(){},canBePicked:function(){return this._shown&&this._visible&&!this._isMoving&&!this._isAnimating&&!this._isLifted&&!this.occluded},draggingDidStart:function(){this._public.dispatchEvent(new St.Event(Uu.DragStart))},isDraggable:function(){return this.draggable&&!this._isLifted},isLifted:function(){return this._isLifted},dispatchDraggingEvent:function(){const t=new St.Event(e.Events.Dragging);return t.coordinate=this._coordinateDuringDrag(),this._public.dispatchEvent(t),t},positionForCallout:function(){let t=this._calloutAnchorPoint;if(!t){const e=this._userSetSize?this._node.size:this.delegate.sizeForElement(this.elementInAnnotationDOM);t=new Gi(-e.width/2,0)}const e=this.nodePosition();return new Gi(e.x-t.x-this._calloutOffset.x,e.y-t.y-this._calloutOffset.y)},positionForSelectionAccessory:function(t,e){const i=this.centerOffsetForSelectionAccessory();i.x-=this._selectionAccessoryOffset.x,i.y-=this._selectionAccessoryOffset.y;const n=this.nodePosition(),o=this.size;let s;switch(t){case"top":s=new Gi(i.x,e);break;case"left":s=new Gi(e,i.y);break;case"right":s=new Gi(-o.width-e,i.y);break;case"bottom":s=new Gi(i.x,-o.height-e)}return new Gi(n.x-s.x,n.y-s.y)},setDraggingTranslationForMapFrameSize:function(t,e){this._dragController.setTranslation(this.clampDraggingTranslationForMapFrameSize(t,e))},dropAfterDraggingAndRevertPosition:function(t){this._dragController.dropAnnotationAfterDraggingAndRevertPosition(t)},distanceToPoint:function(t){const e=this._node.position.x,i=e+this._node.size.width,n=e-t.x,o=i-t.x,s=n<=0&&o>=0?0:Math.min(Math.abs(n),Math.abs(o)),a=this._node.position.y,r=a+this._node.size.height,l=a-t.y,h=r-t.y,c=l<=0&&h>=0?0:Math.min(Math.abs(l),Math.abs(h));return s*s+c*c},lift:function(){this._isLifted=!0,this._dragController.lift(this._draggingLift),this._updatedProperty("")},translate:function(t,e){this.sceneGraphNode?this.sceneGraphNode.transform=(new Zi).translate(t,e):this._node.transform=(new Bn).translate(t,e)},translatedPosition:function(){const t=this._dragController.getTranslation();return new Gi(this._position.x-this._anchorPoint.x-this._anchorOffset.x+t.x,this._position.y-this._anchorPoint.y-this._anchorOffset.y+t.y)},updatedPosition:function(){return this.coordinate?(this.x=hi.convertLongitudeToX(hi.wrapLongitude(this.coordinate.longitude)),this.y=hi.convertLatitudeToY(this.coordinate.latitude),!0):(this.setShown(!1),this.sceneGraphNode&&this.sceneGraphNode.remove(),!1)},get sceneGraphNode(){return this._sceneGraphNode},mayBeDrawn:function(){return!!this.sceneGraphNode&&this._shown&&this.visible&&!this.isWaiting},isDrawn:function(){return(!this.occluded||this._occludedAnimation)&&this.mayBeDrawn()},animateOcclusion:function(){const t=this.occluded?0:1;this._sceneGraphNode&&(this._occludedAnimation&&this._occludedAnimation.end(),this._occludedAnimation=new Ko.Opacity({node:this._sceneGraphNode,from:1-t,to:t,duration:200,done:()=>{delete this._occludedAnimation}}).begin());const e=this.occluded&&this.cluster&&this.cluster._impl&&!this.cluster._impl.occluded,i=!this.occluded&&this.previousCluster&&!this.previousCluster._impl.wasOccluded;(e||i)&&this._animateClustering()},positionWasUpdated:function(t){this._sceneGraphNode&&(this._sceneGraphNode.needsDisplay=!0)},dragOffset:Gi.Zero,handleEvent:function(t){switch(t.type){case Oi.Events.LocaleChanged:this.updateLocalizedText();break;case"animationend":if(t.animationName!==this._appearanceAnimationName)return;this.element.style.animation="",this.element.removeEventListener("animationend",this),this.finishedAnimating()}},updateLocalizedText:function(){this._node&&this._node.element&&this._node.element.setAttribute("aria-label",this.altText())},altText:function(){return this._accessibilityLabel||(this.title&&this.subtitle?Oi.get("Annotation.Generic.AccessibilityLabel",{title:this.title,subtitle:this.subtitle}):this.title||this.subtitle||"")},updateSize:function(){delete this._unsized,this._selected&&this.delegate&&this.delegate.selectedAnnotationDidMoveToMap(this._public)},clampDraggingTranslationForMapFrameSize:function(t,e){const i=this._anchorPoint.x+this._anchorOffset.x-this._position.x,n=e.width-this._node.size.width+i,o=this._anchorPoint.y+this._anchorOffset.y+this._dragController.liftAmount-this._position.y,s=e.height-this._node.size.height+o;return new Gi(u(t.x,i,n),u(t.y,o,s))},droppedAfterLift:function(){delete this._isLifted,this._selected&&this.delegate&&this.delegate.selectedAnnotationDidMoveToMap(this._public),this._updatedProperty("")},draggingDidEnd:function(){this.coordinate=this._coordinateDuringDrag(),this.resetNodeTransform(),this._public.dispatchEvent(new St.Event(e.Events.DragEnd))},resetNodeTransform:function(){this.node.transform=new Bn},finishedAnimating:function(){delete this._isAnimating,this._selected&&this.delegate&&this.delegate.selectedAnnotationDidMoveToMap(this._public),this._visible||this._updateVisibility(),this.delegate&&this.delegate.annotationFinishedAnimating(this._public)},ConstructorOptions:Fu,isAKnownOption:function(t){return Object.keys(this.ConstructorOptions).includes(t)},_animateClustering:function(){if(this._sceneGraphNode){const t={annotation:this,node:this._sceneGraphNode,duration:200,done:()=>delete this._clusteringAnimation};this.cluster?(t.from=this.coordinate.toMapPoint(),t.to=this.cluster.coordinate.toMapPoint()):(t.from=this.previousCluster.coordinate.toMapPoint(),t.to=this.coordinate.toMapPoint());const e=t.to.x-t.from.x;e<-.5?t.to.x+=1:e>.5&&(t.from.x+=1),this._clusteringAnimation&&this._clusteringAnimation.end(),this._clusteringAnimation=new Wu(t).begin()}},_setCoordinate:function(t){f(t,Nu,"[MapKit] Annotation.coordinate expected a Coordinate value."),delete this._translation,this._coordinate=t.copy(),this._updatedProperty("coordinate")},_setDraggable:function(t){const e=!!t;e!==this._draggable&&(this._draggable=e,this._updatedProperty("draggable"))},_setDisplayPriority:function(t){const e="[MapKit] Annotation displayPriority expects a number between 0 and "+Gu.Required;_(t,"number",e);const i=u(t,0,Gu.Required);if(i!==t)console.warn(e+", value was normalized");else if(i===this._displayPriority)return;this._displayPriority=i,this._updatedProperty("displayPriority")},_setClusteringIdentifier:function(t){null!==t&&_(t,"string","[MapKit] Annotation clusteringIdentifier expects a string"),this._clusteringIdentifier!==t&&(this._clusteringIdentifier=t,this._updatedProperty("clusteringIdentifier"))},_coordinateDuringDrag:function(){const t=this.sceneGraphNode?this._dragController.translation.x:0,e=this.sceneGraphNode?this._dragController.translation.y-this._dragController.liftAmount:0,i=this.node.convertPointToPage(new Gi(t+this.dragOffset.x+this._anchorPoint.x+this.anchorOffset.x,e+this.dragOffset.y+this._anchorPoint.y+this.anchorOffset.y));return this.delegate._map.convertPointOnPageToCoordinate(new window.DOMPoint(i.x,i.y))},_updateSize:function(){if(!this._unsized||this._userSetSize||!this.delegate)return;const t=this.delegate.sizeForElement(this.elementInAnnotationDOM);t&&(delete this._unsized,this.setSize(t))},_updatedProperty:function(t){this.delegate&&this.delegate.annotationPropertyDidChange(this._public,t)}}),e.OptionSetters=Object.freeze({draggable:e.prototype._setIsDraggable,displayPriority:e.prototype._setDisplayPriority,clusteringIdentifier:e.prototype._setClusteringIdentifier}),e}function Wu(t){Ko.Basic.call(this,t),this.annotation=t.annotation}Wu.prototype=p(Ko.Basic,Wu,{update:function(t){const e=this.annotation;if(null==e.delegate)return;const i=e.delegate._map,n=i.camera.toRenderingMapRect(),o=hi.wrapX((1-t)*this.from.x+t*this.to.x,n.midX()),s=(1-t)*this.from.y+t*this.to.y,a=i.adjustMapItemPoint(i.camera.transformMapPoint(new Gi(o,s)));this.node.transform=(new Zi).translate(a.x-e._position.x,a.y-e._position.y)},stringInfo:function(){return Ko.Basic.prototype.stringInfo.call(this,"translation*")}}),Zu.Events=Uu,Zu.DisplayPriority=Gu,Zu.CollisionMode=Bu;const Ku=Zu;function Hu(t){this._annotation=t}Hu.prototype={liftDurationMs:200,liftOpacity:.5,animateLift:function(){const t=Math.min((Date.now()-this._liftAnimationStartDate)/this.liftDurationMs,1);this._annotation.translate(this.translation.x,this.translation.y-this.liftAmount*t),this._annotation.opacity=1-(1-this.liftOpacity)*t,t<1?(ue.scheduleOnNextFrame(this),this._liftAnimationProgress=t):(delete this._liftAnimationStartDate,delete this._liftAnimationProgress)},animateDropAfterLift:function(){const t=Math.max(this._dropAnimationStartP-Math.min((Date.now()-this._dropAfterLiftAnimationStartDate)/this.liftDurationMs,1),0);this._dropAnimationRevert&&this._annotation.translate(0,-this.liftAmount*t),this._annotation.opacity=1-(1-this.liftOpacity)*t,t>0?ue.scheduleOnNextFrame(this):this._annotation.droppedAfterLift()},dropAnnotationAfterDraggingAndRevertPosition:function(t){this._liftAnimationStartDate?(this._dropAnimationStartP=this._liftAnimationProgress,delete this._liftAnimationStartDate,delete this._liftAnimationProgress):this._dropAnimationStartP=1,t?this._annotation.resetNodeTransform():this._annotation.draggingDidEnd(),this._dropAfterLiftAnimationStartDate=Date.now(),this._dropAnimationRevert=t,ue.scheduleOnNextFrame(this)},lift:function(t){this.liftAmount=t,this.translation=new Gi,t>0?(this._liftAnimationStartDate=Date.now(),this._liftAnimationProgress=0,ue.scheduleOnNextFrame(this)):this._annotation.opacity=this.liftOpacity},getTranslation:function(){return new Gi(this.translation.x,this.translation.y-this.liftAmount)},setTranslation:function(t){this.translation=t,this._liftAnimationStartDate||this._annotation.translate(this.translation.x+this._annotation.dragOffset.x,this.translation.y-this.liftAmount+this._annotation.dragOffset.y)},performScheduledUpdate:function(){this._liftAnimationStartDate?this.animateLift():this._dropAfterLiftAnimationStartDate&&this.animateDropAfterLift()}};const ju=Hu,Vu=Ku(Su);Vu.prototype._animates=!0,Vu.prototype._setNode=function(t,e,i){_(e,"function");const n=it(e,window,[t,i]);q(n,"[MapKit] Annotation element factory must return a DOM element, got `"+n+"` instead."),this._element=n;let o=n;if(Co.supportsShadowDOM){const t="mk-slot-"+Math.random().toString(32).substr(2,8);n.slot=t,o=Co.htmlElement("slot"),o.name=t}this._node=new so.Node(Co.htmlElement("div",o)),this._node.wantsHardwareCompositing=this.renderedByDOMElement,this._dragController||(this._dragController=new ju(this))},Vu.div=function(){return document.createElement("div")};const qu=Vu;function Yu(t,e,i){Yo(this,Yu)&&Object.defineProperty(this,"_impl",{value:new qu(this,t,e,i)})}Yu.EVENTS=Ku.EVENTS,Yu.DisplayPriority=Ku.DisplayPriority,Yu.CollisionMode=Ku.CollisionMode,Yu.prototype=p(Au,Yu,{get map(){return this._impl.map},set map(t){this._impl.map=t},get coordinate(){return this._impl.coordinate},set coordinate(t){this._impl.coordinate=t},get id(){return this._impl.id},get title(){return this._impl.title},set title(t){this._impl.title=t},get subtitle(){return this._impl.subtitle},set subtitle(t){this._impl.subtitle=t},get accessibilityLabel(){return this._impl.accessibilityLabel},set accessibilityLabel(t){this._impl.accessibilityLabel=t},get data(){return this._impl.data},set data(t){this._impl.data=t},get enabled(){return this._impl.enabled},set enabled(t){this._impl.enabled=t},get calloutEnabled(){return this._impl.calloutEnabled},set calloutEnabled(t){this._impl.calloutEnabled=t},get selectionAccessory(){return this._impl.selectionAccessory},set selectionAccessory(t){this._impl.selectionAccessory=t},get selectionAccessoryOffset(){return this._impl.selectionAccessoryOffset},set selectionAccessoryOffset(t){this._impl.selectionAccessoryOffset=t},get selected(){return this._impl.selected},set selected(t){this._impl.selected=t},get animates(){return this._impl.animates},set animates(t){this._impl.animates=t},get calloutOffset(){return this._impl.calloutOffset},set calloutOffset(t){this._impl.calloutOffset=t},get callout(){return this._impl.callout},set callout(t){this._impl.callout=t},get draggable(){return this._impl.draggable},set draggable(t){this._impl.draggable=t},get size(){return this._impl.size},set size(t){this._impl.size=t},get displayPriority(){return this._impl.displayPriority},set displayPriority(t){this._impl.displayPriority=t},get collisionMode(){return this._impl.collisionMode},set collisionMode(t){this._impl.collisionMode=t},get clusteringIdentifier(){return this._impl.clusteringIdentifier},set clusteringIdentifier(t){this._impl.clusteringIdentifier=t},get padding(){return this._impl.padding},set padding(t){this._impl.padding=t}});const Xu=Yu;function $u(t){Lo.call(this,t)}$u.prototype=p(Lo,$u,{pathForSquareDot:function(t,e){const i=.6*e,n=.4*e;t.moveTo(e,0),t.lineTo(e+n,0),t.arc(e+n,i,i,Math.PI/2*3,0),t.lineTo(2*e,e+n),t.arc(e+n,e+n,i,0,Math.PI/2),t.lineTo(i,2*e),t.arc(i,e+n,i,Math.PI/2,Math.PI),t.lineTo(0,e-n),t.arc(i,i,i,Math.PI,Math.PI/2*3),t.lineTo(e,0)}});const Ju=$u;let Qu;const tp=["default","selected","bubble"];let ep=[],ip=" ",np="default-loading";function op(t){Ju.call(this,t)}function sp(t,e,i,n){null==n&&(n=e.glyphText),t.save(),t.fillStyle=e.glyphColor;let o,s=i.glyphFontSize;do{t.font=s--+"px "+Tn,o=t.measureText(n).width}while(o>i.glyphImageSize&&s>0);t.textBaseline="alphabetic";const a=i.balloonRadius+.35*s;let r;return"1"===n?(t.textAlign="left",r=i.balloonRadius-o/2-o/16,t.fillText(n,r,a,i.glyphImageSize)):(t.textAlign="center",t.fillText(n,i.balloonRadius,a,i.glyphImageSize)),t.restore(),s+1}function ap(){const t=Math.min(Co.devicePixelRatio,3),e=(t>1?"_"+t+"x":"")+".png",i={};let n=tp.length;function o(){--n,0===n&&(Qu=i,Qu.lifted=Qu.default,ip="",np="default",ep.forEach((function(t){t.freeze(),t.needsDisplay=!0})),ep=void 0)}tp.forEach((function(t){i[t]={},function(t){const n=new js(N.Highest,{urlForImageLoader:fe.createImageUrl("pins/marker"+(t?"-":"")+t+e),loaderDidSucceed:function(){i[t]=n.image,o()},loaderDidFail:function(){console.warn("[MapKit] Error loading marker annotation image "+n.url+"; marker annotations may not display correctly."),ip="?",np="default-error",o()}});n.crossOrigin=Hs.getCorsAttribute(kt.distUrlWithCredentials),n.schedule()}(t)}))}op.loadMarkerResources=function(){lp()},op.prototype=p(Ju,op,{draw:function(t){this._sharedLayer&&(this._sharedLayer.renderer=this);const e=this._node,i=e.state,n=e.annotation,o=e.params;if(!n.balloonVisible)return;!n.warnOnUnselectedGlyphImageAccess||"default"!==i&&"lifted"!==i||console.warn("[MapKit] Unselected glyph image style is not available for this annotation."),delete this.glyphImageSrc,delete this.isTainted,delete this.renderType,t.save(),"bubble"!==o.style&&(t.shadowOffsetY=o.shadowOffsetY*o.balloonRadius,t.shadowBlur=o.shadowBlur,t.shadowColor=o.shadowColor);const s="poi"===o.style;if(t.beginPath(),"callout"===i)this.drawDotUnderCallout(t,n.haloColor||n.fillColor,o.radius);else{if(this.pathForBalloon(t,o.balloonRadius,o.style),s?t.fillStyle=n.haloColor||n.glyphColor:n.isPlaceStyle&&"selected"===i?t.fillStyle=n.haloColor||n.fillColor:t.fillStyle=n.fillColor,t.fill(),t.save(),s){t.beginPath();const e=o.balloonRadius-o.borderWidth;this.pathForMask(t,o.balloonRadius,e),t.fillStyle=n.fillColor,t.fill()}t.restore()}if(t.restore(),"callout"!==i)if(delete this.glyphFontSize,n.glyphText)this.glyphFontSize=sp(t,n,o),this.renderType="glyphText";else{const[s,a]=function(t,e,i,n,o,s){let a,r=o?2*n.balloonRadius:n.glyphImageSize,l=Co.roundToDevicePixel((e.size.width-r)/2),h=!1;a="default"===i||"lifted"===i?e.glyphImage:e.selectedGlyphImage||e.glyphImage;0;0;if(!a&&e.enablesDefaultGlyphImage){if(ip)return lp(),ep.indexOf(e)<0&&ep.push(e),sp(t,e.annotation,n,ip),[null,!1];a=Qu["bubble"===e.params.style?"bubble":i],r=n.glyphImageSize,l=Co.roundToDevicePixel((e.size.width-r)/2),o=!1,h=!0}try{let i;const c="poi"!==n.style&&"default"!==n.style&&e.annotation.haloColor&&e.annotation.haloColor!==e.annotation.fillColor?e.annotation.fillColor:void 0;return i=o?function(t,e,i,n,o){t._maskedPOIImage||(t._maskedPOIImage=[]);const s=Co.devicePixelRatio,a=i*s;if(!t._maskedPOIImage[a]){const i=n*s/2,r=$();r.width=a,r.height=a;const l=r.getContext("2d");l.beginPath(),o(l,a/2,i),e&&(l.fillStyle=e,l.fill()),l.clip(),l.drawImage(t,0,0,a,a),t._maskedPOIImage[a]=r}return t._maskedPOIImage[a]}(a,c,r,2*(n.balloonRadius-n.borderWidth),s):function(t,e,i){t._tinted||(t._tinted={});t._tinted[e]||(t._tinted[e]=[]);const n=i*Co.devicePixelRatio;if(!t._tinted[e][n]){const i=$();i.width=n,i.height=n;const o=i.getContext("2d");o.fillStyle=e,o.fillRect(0,0,n,n),o.globalCompositeOperation="destination-in",o.drawImage(t,0,0,n,n),t._tinted[e][n]=i}return t._tinted[e][n]}(a,e.annotation.glyphColor,r),t.drawImage(i,l,l,r,r),h?[null,!1]:[a.src,null===a.crossOrigin]}catch(t){return e.glyphImageError(),[null,!1]}}(t,e,i,o,n.isPlaceStyle,((t,e,i)=>this.pathForMask(t,e,i)));this.glyphImageSrc=s,this.isTainted=a,this.renderType=this.glyphImageSrc?"glyphImage":np}},get isFallbackGlyphTextPending(){return!Qu},addPendingNode:function(t){ep.indexOf(t)<0&&ep.push(t)},get fallbackGlyphText(){return ip},get rendererForSharedLayer(){return this._sharedLayer?this._sharedLayer.renderer:this},drawDotUnderCallout:function(){0},pathForBalloon:function(){0},pathForMask:function(){0}});let rp=!1;function lp(){rp||(rp=!0,kt.state!==kt.States.PENDING&&kt.state!==kt.States.READY?kt.addEventListener(kt.Events.Initialized,(function t(){kt.removeEventListener(kt.Events.Initialized,t),ap()})):ap())}const hp=op;function cp(t){hp.call(this,t)}cp.prototype=p(hp,cp,{drawDotUnderCallout:function(t,e,i){t.strokeStyle=e,t.lineWidth=i,t.arc(i,i,i/2,0,2*Math.PI),t.stroke()},pathForBalloon:function(t,e,i){switch(i){case"balloon":t.save(),t.scale(e/256,e/256),t.moveTo(327.439,501.776),t.lineTo(327.525,501.776),t.bezierCurveTo(301.142,509.276,279.265,526.476,266.881,550.341),t.bezierCurveTo(263.709,556.456,261.65,562.811,255.956,562.811),t.bezierCurveTo(250.262,562.811,248.204,556.456,245.03,550.341),t.bezierCurveTo(232.648,526.471,210.771,509.272,184.388,501.776),t.lineTo(184.561,501.776),t.bezierCurveTo(77.943,470.858,0,372.507,0,255.944),t.bezierCurveTo(0,114.59,114.615,0,256,0),t.bezierCurveTo(397.385,0,512,114.59,512,255.944),t.bezierCurveTo(512,372.507,434.057,470.858,327.439,501.775),t.closePath(),t.restore();break;case"default":{const i=e/13.5*5,n=i/6,o=i/3,s=2*e,a=.448*e,r=.385*e;t.moveTo(s,e),t.bezierCurveTo(s,1.5*e,s-r,s-i/3,e+i/2+o,s),t.bezierCurveTo(e+i/3,s+i/3,e+n,s+i,e,s+i),t.bezierCurveTo(e-n,s+i,e-i/3,s+i/3,e-(i/2+o),s),t.bezierCurveTo(r,s-i/3,0,1.5*e,0,e),t.bezierCurveTo(0,a,a,0,e,0),t.bezierCurveTo(s-a,0,s,a,s,e),t.closePath();break}default:t.arc(e,e,e,0,2*Math.PI)}},pathForMask:function(t,e,i){t.arc(e,e,i,0,2*Math.PI)}});const dp=cp;function up(t){hp.call(this,t)}up.prototype=p(hp,up,{drawDotUnderCallout:function(t,e,i){t.fillStyle=e,this.pathForSquareDot(t,i),t.fill()},pathForBalloon:function(t,e,i){t.save(),t.scale(e/256,e/256),t.moveTo(424.278,512.1),"balloon"!==i&&"default"!==i||(t.lineTo(363.104,512.1),t.bezierCurveTo(302.97,513.623,278.509,528.747,266.778,551.35),t.bezierCurveTo(263.607,557.462,261.548,563.819,255.857,563.819),t.bezierCurveTo(250.167,563.819,248.107,557.462,244.937,551.35),t.bezierCurveTo(233.205,528.747,208.743,513.623,148.61,512.1)),t.lineTo(87.723,512.1),t.bezierCurveTo(39.475,512.099,0,472.713,0,424.573),t.lineTo(0,87.525),t.bezierCurveTo(0,39.387,39.475,0,87.723,0),t.lineTo(424.278,0),t.bezierCurveTo(472.525,0,512,39.387,512,87.525),t.lineTo(512,424.573),t.bezierCurveTo(512,472.713,472.525,512.099,424.278,512.099),t.closePath(),t.restore()},pathForMask:function(t,e,i){t.save();const n=e-i;t.translate(n,n),t.scale(i/256,i/256),t.moveTo(424.278,512.1),t.lineTo(87.723,512.1),t.bezierCurveTo(39.475,512.099,0,472.713,0,424.573),t.lineTo(0,87.525),t.bezierCurveTo(0,39.387,39.475,0,87.723,0),t.lineTo(424.278,0),t.bezierCurveTo(472.525,0,512,39.387,512,87.525),t.lineTo(512,424.573),t.bezierCurveTo(512,472.713,472.525,512.099,424.278,512.099),t.closePath(),t.restore()}});const pp=up,mp=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);function gp(t,e){ln.call(this),this.annotation=t,e&&(this._state=e)}gp.prototype=p(ln,gp,{delegate:null,enablesDefaultGlyphImage:!0,setDelegate:function(t){this.delegate=t},isTainted(){return this._renderer.isTainted},stringInfo:function(){const t=this._renderer.rendererForSharedLayer,e=mp(this,"_state")?"<"+this.state+">":"",i=mp(t,"glyphFontSize")?' "'+this.annotation.glyphText+'"@'+t.glyphFontSize:"",n=[];this._renderer instanceof pp&&n.push("â¹"),this.annotation.balloonVisible||n.push("ð»"),this.annotation.isAppStyle&&n.push("â­ï¸"),this.annotation.isPlaceStyle&&n.push("ð");const o=n.length?` ${n.join(" ")}`:"",s=t.glyphImageSrc?" ð¼ "+t.glyphImageSrc:"";return"MarkerAnnotationBalloonNode"+e+("<color: "+this.annotation.fillColor+(this.annotation.haloColor?"/"+this.annotation.haloColor:"")+">")+i+s+o},get state(){return mp(this,"_state")?this._state:this.delegate.state},get params(){return this.delegate.getParamsFromState(this.state)},get layerBounds(){const t=Math.ceil(this.size.width/2),e=Math.ceil(this.size.height/4);return new Bi(-t,-e,this.size.width+2*t,Math.ceil(1.5*this.size.height)+e)},glyphImageError:function(t){"selected"===t&&this.selectedGlyphImage?delete this.selectedGlyphImage:delete this.glyphImage,this.needsDisplay=!0},setBalloonStyle:function(){if(this.annotation.useSquareBalloon){if(this._renderer&&this._renderer.constructor===pp)return;this._renderer=new pp(this)}else{if(this._renderer&&this._renderer.constructor===dp)return;this._renderer=new dp(this)}},freeze:function(){if("default"!==this.state&&"lifted"!==this.state)return void(this.keyForFrozenLayer="");const t=this.annotation;!t.glyph&&this._renderer.isFallbackGlyphTextPending&&this._renderer.addPendingNode(this);let e=t.fillColor;t.haloColor&&(e+="/"+t.haloColor),this.keyForFrozenLayer="balloon-"+[e,t.glyph?t.glyph:this._renderer.fallbackGlyphText,t.glyphColor,t.useSquareBalloon?"square":""].join("-"),this.annotation.balloonVisible||(this.keyForFrozenLayer+="-nonvisible"),this.annotation.isPlaceStyle&&(this.keyForFrozenLayer+="-place"),this.annotation.isAppStyle&&(this.keyForFrozenLayer+="-app")}});const _p=gp;function fp(t){Ju.call(this,t)}fp.prototype=p(Ju,fp,{draw:function(t){const e=this._node;e.annotation.balloonVisible&&(t.save(),t.beginPath(),this.pathForDot(t,e.radius),t.fillStyle=e.annotation.haloColor||e.annotation.fillColor,t.fill(),t.restore())},pathForDot:function(){0}});const yp=fp;function vp(t){yp.call(this,t)}vp.prototype=p(yp,vp,{pathForDot:function(t,e){t.arc(e,e,e,0,2*Math.PI)}});const wp=vp;function bp(t){yp.call(this,t)}bp.prototype=p(yp,bp,{pathForDot:function(t,e){this.pathForSquareDot(t,e)}});const Cp=bp;function kp(t,e){ln.call(this),this.annotation=t,this.radius=e,t.useSquareBalloon?this._renderer=new Cp(this):this._renderer=new wp(this)}kp.prototype=p(ln,kp,{stringInfo:function(){const t=this._renderer instanceof Cp?" â¹":"";return"MarkerAnnotationDotNode<color: "+this.annotation.fillColor+">"+t}});const Mp=kp;function Sp(t){this._params=xp(),Lo.call(this,t)}const Lp={title:{font:"600 11px "+Tn,fontWeight:600,fontFamily:Tn,height:16,fontSize:11,lineHeight:12,yPadding:1},subtitle:{font:"500 10px "+Tn,fontWeight:500,fontFamily:Tn,height:15,fontSize:10,lineHeight:11,yPadding:1}},Ap=(t,e,i)=>{const n=Lp[t],o=n.fontFamily||Tn,s=n.fontWeight||500,a=(n.fontSize||11)*e,r=`${s} ${a}px ${o}`;if(i){const t=(n.height||16)*e,o=(n.lineHeight||12)*e;i.weight=s,i.fontSize=a,i.height=t,i.lineHeight=o,i.font=r}return r},Ep=(t,e)=>{for(const i in e){const n=e[i];"object"==typeof n&&i in Lp&&Ap(i,t,n)}},xp=()=>{const t={haloColor:{light:"rgba(255, 255, 255, .8)",dark:"black"},haloSize:2,miterLimit:2,textAlign:"center",title:Object.assign({},Lp.title,{color:{light:"#2b2b2b",dark:"#e7e6e4"}}),subtitle:Object.assign({},Lp.subtitle,{color:{light:"#4c4c4c",dark:"#e7e6e4"}})};return Ep(1,t),t};Sp.prototype=p(Lo,Sp,{_scale:1,_params:void 0,get params(){const t=(this.node?this.node.fontSizeRatio:0)||this._scale;return this.node&&this._scale!==t&&(this._scale=t,Ep(this._scale,this._params)),this._params},_setTextProperties:function(t){const e=this._node,i=this.params[e.kind];t.font=i.font,t.textAlign=this.params.textAlign,t.textBaseline="bottom",t.miterLimit=this.params.miterLimit},draw:function(t){const e=this._node,i=this.params[e.kind];this._setTextProperties(t);const n=e.parent.annotation.darkColorScheme?"dark":"light";t.fillStyle=i.color[n],t.strokeStyle=this.params.haloColor[n],t.lineWidth=this.params.haloSize;const o=e.size.width/2,s=i.height-i.yPadding;t.strokeText(e.text,o,s),t.fillText(e.text,o,s)}}),Sp.computeFont=Ap;const Tp=Sp;function Ip(t,e,i,n,o,s){ln.call(this),this.text=t,this.kind=e,this._renderer=new Tp(this),this.textAscent=n.actualBoundingBoxAscent||0,this.textDescent=n.actualBoundingBoxDescent||0;const a=this.textDescent>0?Math.ceil(this.textDescent):0;this.fontSizeRatio=s,this.size=new Ui(i,this._renderer.params[this.kind].height+a),this.keyForFrozenLayer=(o?"dark":"light")+(1!==s?`-${s}`:"")+"-"+e+"#"+this.text}Ip.prototype=p(ln,Ip,{stringInfo:function(){return"MarkerAnnotationLabelNode<"+this.kind+'> "'+this.text+'"'},get fontSize(){return this._renderer.params[this.kind].fontSize},get lineHeight(){return this._renderer.params[this.kind].lineHeight}});const Rp=Ip,Op=1e-12,Pp={borderWidth:1.5,labelOutlineWidth:2,shadowColor:"rgba(0, 0, 0, .15)",shadowOffsetY:.5,innerShadowColor:"rgba(0, 0, 0, .35)",transitionDuration:500,dotAnimationDuration:100,dotScale:1.5,anchorPointOffset:0},Dp=Hp(Pp,{balloonRadius:13.5,shadowBlur:11.25,dotRadius:0,glyphFontSize:15,glyphImageSize:20,offset:0,style:"default",height:32}),zp=11.5,Np=Hp(Pp,{borderWidth:1.5,balloonRadius:zp,transitionDuration:250,shadowBlur:5,shadowOffsetY:0,dotRadius:0,glyphFontSize:15,glyphImageSize:16,offset:0,style:"poi",height:23,anchorPointOffset:-11.5}),Fp=[];for(let t=2;t<=6;t++){const e=12+.5*t;Fp[t]=Hp(Np,{balloonRadius:e,height:2*e})}const Up=Hp(Pp,{balloonRadius:30,shadowBlur:25,dotRadius:3,glyphFontSize:32,glyphImageSize:40,offset:8,style:"balloon",height:66}),Gp=Hp(Pp,{radius:4.5,shadowOffsetY:0,shadowBlur:0,shadowColor:"transparent"}),Bp=Hp(Pp,{balloonRadius:20,dotRadius:3,glyphFontSize:28,glyphImageSize:30,offset:0,style:"bubble",height:40});function Zp(t){Oo.call(this),this.annotation=t,this._balloon=this.addChild(new _p(t)),this._balloon.setDelegate(this)}let Wp;Zp.Params={default:Dp,lifted:Dp,selected:Up,bubble:Bp,callout:Gp},Zp.POIIconParams=Hp(Zp.Params,{default:Np,lifted:Np}),Zp.prototype=p(ln,Zp,{get position(){return this.annotation?this.annotation.nodePosition():new Gi},stringInfo:function(){return"MarkerAnnotationNode"+("default"!==this.state?"<"+this.state+">":"")},get enablesDefaultGlyphImage(){return this._balloon.enablesDefaultGlyphImage},set enablesDefaultGlyphImage(t){this._balloon.enablesDefaultGlyphImage=t},set needsLayout(t){t&&!this._needsLayout&&ue.scheduleASAP(this),this._needsLayout=t},get needsLayout(){return this._needsLayout},getParamsFromState:function(t){const e=this.annotation.isAppStyle,i=e?Zp.POIIconParams:Zp.Params;return"default"===t&&this.annotation.n&&e?Fp[Math.min(this.annotation.n,6)]:i[t]},balloonNodeSize:function(t){if(!this.annotation.balloonVisible)return new Ui(0,0);t||(t=this.state);const e=this.getParamsFromState(t);if("callout"===t)return new Ui(2*e.radius,2*e.radius);const i=2*e.balloonRadius;return new Ui(i,e.height+e.offset)},updateAppearance:function(t){this._balloon.freeze(),t&&(this.needsDisplay=!0)},updateState:function(t){if(this._usingStaticStyle)return;const e=this.annotation;this.state!==t&&(!e.selected&&"selected"!==this.state&&"callout"!==this.state||!this.state||this._animateFromState||(this._animateFromState=this.state),this.state=t,this.updateSizeAndAppearance())},updateSizeAndAppearance(){this.annotation._node.size=this._size=this._balloon.size=this.balloonNodeSize(),this.updateAppearance(),this.needsLayout=!0},performScheduledUpdate:function(){this.updateLayout(!1)},updateLayout:function(t){this._needsLayout&&(this._layoutSubNodes(t),this._needsLayout=!1)},updateGlyphText:function(){this.updateAppearance(!0),this._balloon.needsDisplay=!0},updateGlyphImage:function(t){this.updateAppearance(),this._balloon.glyphImage=t,this._balloon.needsDisplay=!0},updateSelectedGlyphImage:function(t){this._balloon.selectedGlyphImage=t,this._balloon.needsDisplay=!0},glyphImageError:function(){this.updateAppearance(),this._balloon.glyphImageError(this.state)},animateAppearance:function(t){const e=this.getParamsFromState(this.state);if(this.children.forEach((t=>{this.annotation.isAppStyle||t===this._balloon||jp(t,e)})),!this.annotation.isAppStyle||this.annotation.selected)qp(this._balloon,e,Op,1,new Gi(this._balloon.size.width/2,this._balloon.size.height),void 0,t);else{const i=new Gi(this._balloon.size.width/2,this._balloon.size.height/2);Vp(this._balloon,e,Op,1,i,t)}},fadeInLabels(){const t=this.children.filter((t=>t instanceof Rp)),e=this.getParamsFromState(this.state);t.forEach((t=>{jp(t,e)}))},preventAnimation:function(){this._animationPrevented=!0,this.needsLayout=!0},_layoutSubNodes:function(t){if(!this.annotation)return;this.updateAppearance();const e=this.children.slice();this.children=[this._balloon],this._dot&&this.addChild(this._dot);let i=this._balloon.size.width;const n=this.annotation,o=this.state,s=this.getParamsFromState(this.state),a=n.map&&!this._animationPrevented;delete this._animationPrevented;const r=n&&n.map&&n.map._impl.fontSizeRatio||1;function l(t,i){e.forEach((function(e){e.kind===t&&(this.addChild(e),function(t,e,i){t.fadingOut=!0,new Ko.Opacity({node:t,duration:e.transitionDuration,from:1,to:0,done:function(){delete t.fadingOut,t.remove()}}).begin()}(e,s,this.annotation))}),this),delete this[i]}let h=0;const c=(t,e)=>{const o=Tp.computeFont(t,r),l=n[t],c=a&&!!this.parent&&l!==e&&(!l||!e),d=this.annotation.darkColorScheme;return function(t,e,i){t.font=i;const n=e.trim().split(/[\f\n\r\t\v\u0020\u2000-\u200b\u205f\u3000]+/),o=[];for(;n.length>0;){const e=[n.shift()];let i=e.join(" ").length;for(;n.length>0&&i<=16;)e.push(n.shift()),i=e.join(" ").length;i>16&&e.length>1&&n.unshift(e.pop());const s=e.join(" "),a=t.measureText(s),r=a.width+Pp.labelOutlineWidth;o.push([s,r,a])}return o}(this.scene?this.scene.contextForMeasurement:Kp(),l,o).forEach((([e,n,o])=>{const a=new Rp(e,t,n,o,d,r);i=Math.max(i,n),h=a.lineHeight/2,this.addChild(a),c&&jp(a,s)}),this),l},d="callout"!==o&&"lifted"!==o&&!("default"===o&&n.selected)&&n.labelsCanBeShown(),u=d&&n.titleCanBeShown();u?this._prevTitle=c("title",this._prevTitle):l.call(this,"title","_prevTitle"),d&&n.subtitleCanBeShown(u)?this._prevSubtitle=c("subtitle",this._prevSubtitle):l.call(this,"subtitle","_prevSubtitle");let p=this._balloon.size.height;if("callout"===o&&n.isAppStyle){0!==this.children.filter((t=>t.lineHeight)).length&&(p+=this.getParamsFromState("default").balloonRadius)}let m=p,g=0;this.children.forEach((function(t){let e=0;if(t.lineHeight){const i=Math.ceil(t.textAscent-t.fontSize);if(i>0&&(e+=i),g>0){e+=Math.ceil(g)}}t.position=new Gi((i-t.size.width)/2,t.lineHeight?m+e:0),t.lineHeight&&(m+=t.lineHeight+e,t.fadingOut||(p+=t.lineHeight+e,h=Math.round(t.lineHeight/2+(t.textDescent>0?t.textDescent:0))),g=t.textDescent)})),n._anchorPoint=new Gi(i/2,this._balloon.size.height+s.anchorPointOffset),n._node.size=this.size=new Ui(i,p+h),n.updatePosition();const _=n._position.x-n._anchorPoint.x-n._anchorOffset.x,f=this.position.x;if(this.children.forEach((function(t){t.position=new Gi(Co.roundToDevicePixel(_+t.position.x)-f,t.position.y)})),"selected"===o?(this._dot||(this._dot=this.addChild(new Mp(this.annotation,s.dotRadius*s.dotScale),1)),this._dot.size=new Ui(2*s.dotRadius*s.dotScale,2*s.dotRadius*s.dotScale),this._dot.position=new Gi(this._balloon.position.x+s.balloonRadius-s.dotRadius,this._balloon.size.height-2*s.dotRadius),this._dot.transform=(new Zi).scale(1/s.dotScale)):this._dot&&(this._dot.remove(),delete this._dot),a&&this._animateFromState){const t=this.getParamsFromState(this._animateFromState);if("callout"===o||"callout"===this._animateFromState){const e=Hp(s);e.transitionDuration/=2;const i=this.addChild(new _p(this.annotation,this._animateFromState));let n;i.setDelegate(this),i.glyphImage=this._balloon.glyphImage,i.selectedGlyphImage=this._balloon.selectedGlyphImage,i.setBalloonStyle(),i.size=this.balloonNodeSize(i.state),this._balloon.transform=(new Zi).scale(Op),"callout"===o?(i.position=new Gi((this.size.width-i.size.width)/2,this._balloon.size.height/2-i.size.height-t.anchorPointOffset+4.5),n=new Gi(i.size.width/2,i.size.height+t.anchorPointOffset),Vp(i,e,1,Op,n,(()=>{i.remove();const t=Hp(s);t.transitionDuration/=2,Vp(this._balloon,t,Op,1,new Gi(this._balloon.size.width/2,this._balloon.size.height/2))}))):(i.position=new Gi((this.size.width-i.size.width)/2,this._balloon.size.height+s.anchorPointOffset-i.size.height/2-4.5),n=new Gi(i.size.width/2,i.size.height/2),this.annotation.isAppStyle?Vp(i,e,1,Op,n,(()=>{i.remove();const t=new Gi(this._balloon.size.width/2,this._balloon.size.height/2);Vp(this._balloon,s,Op,1,t)})):Vp(i,e,1,Op,n,(()=>{i.remove(),qp(this._balloon,s,Op,1,new Gi(this._balloon.size.width/2,this._balloon.size.height))})))}else{let e,i,a,r=0;n.isAppStyle?(e=t.balloonRadius/s.balloonRadius,r=Up.height-Up.balloonRadius+Up.offset,"selected"===o?(i=new Gi(s.balloonRadius,s.balloonRadius+r/(1-e)),a=new Gi(this._balloon.size.width/2,this._balloon.size.height)):i=new Gi(s.balloonRadius,s.balloonRadius-r/(1-e))):(e=this.balloonNodeSize(this._animateFromState).height/this.balloonNodeSize().height,i=new Gi(this._balloon.size.width/2,this._balloon.size.height)),1!==e&&qp(this._balloon,s,e,1,i,a);const l=this._dot;l&&jp(l,{transitionDuration:s.dotAnimationDuration});let h=0;if(1!==e&&n.isAppStyle&&(h=(e<1?1:-1)*this.getParamsFromState("default").balloonRadius),0!==h){const t=new Gi(0,0),e=new Gi(0,h);this.children.forEach((function(i){i.lineHeight&&function(t,e,i,n){new Ko.Translation({node:t,duration:e.transitionDuration,from:i,to:n,pop:!0}).begin()}(i,s,e,t)}))}}delete this._animateFromState}t||n.updatedLayout()}}),Zp.FeatureVisibility=En;const Kp=function(){return Wp||(Wp=$()),Wp.getContext("2d")};function Hp(t,e){const i=Object.create(t);for(const t in e)i[t]=e[t];return i}function jp(t,e){new Ko.Opacity({node:t,duration:e.transitionDuration}).begin()}function Vp(t,e,i,n,o,s){new Ko.Scale({node:t,duration:e.transitionDuration,from:i,to:n,center:o,done:s}).begin()}function qp(t,e,i,n,o,s,a){new Ko.Float({node:t,duration:e.transitionDuration,from:i,to:n,center:o,floatCenter:s,done:a}).begin()}const Yp=Zp;function Xp(t,e){t.useSquareBalloon?this._renderer=new pp(this):this._renderer=new dp(this),this.frozen=!0,this.annotation=t,this.state="selected",this.params=e;const i=2*e.balloonRadius;this.size=new Ui(i,i),this.layerBounds=new Bi(0,0,this.size.width,this.size.height)}Xp.prototype.enablesDefaultGlyphImage=!0,Xp.prototype.draw=function(){!this.annotation.glyph&&this._renderer.isFallbackGlyphTextPending&&this._renderer.addPendingNode(this);const t=this._renderer.layer;t.hidden=!1,t.style.width=t.style.height=this.size.width+"px",this._renderer.draw(t.getContext("2d"))},Xp.prototype.getLayer=function(){return this._renderer.layer},Xp.prototype.glyphImageError=function(t){"selected"===t&&this.selectedGlyphImage?delete this.selectedGlyphImage:delete this.glyphImage},Xp.prototype.updateGlyphImage=function(t){this.glyphImage=t},Xp.prototype.updateSelectedGlyphImage=function(t){this.selectedGlyphImage=t},Xp.prototype.freeze=function(){this.draw()};const $p=Xp;const Jp=function(t,e){let i;if("function"!=typeof t.getImageUrl)return i=function(t){if(!t||"object"!=typeof t)return;let e;const i=Object.keys(t).filter((e=>!!t[e])).map(parseFloat).filter((t=>!isNaN(t))).sort(),n=Co.devicePixelRatio;for(let t=i.length-1;t>=0&&((!e||i[t]>=n)&&(e=i[t]),!(i[t]<=n));--t);return e}(t),i?void e({ratio:i,glyphImageUrl:t[i]}):void e();i=Co.devicePixelRatio,it(t.getImageUrl,t,[i,function(t){setTimeout((()=>e(t?{ratio:i,glyphImageUrl:t}:void 0)))}])},Qp={light:"#ff5b40",dark:"#e6523b"},tm={light:"white",dark:"#e7e6e4"},em={light:"white",dark:"black"},im={Default:"default",Dot:"dot",Large:"large"};function nm(t){function e(e,i,n){this._sceneGraphNode=new Yp(this),t.call(this,e,i,t.div,n),this.updateGlyph(),this._setBalloonStyle(),this._userSetSize=!0,this._calloutWithSelectedState||(this._calloutAnchorPoint=new window.DOMPoint(-Yp.Params.callout.radius,1));const o=this.selected?this.canShowCallout()?this.selectedStateForSceneGraphNode():"selected":"default";this._sceneGraphNode.updateState(o)}return e.StaticStyles=im,e.prototype=p(t,e,{_animates:!0,_glyphImage:null,_selectedGlyphImage:null,_glyphText:"",_color:null,_glyphColor:null,_titleVisibility:Yp.FeatureVisibility.Adaptive,_subtitleVisibility:Yp.FeatureVisibility.Adaptive,shouldHideLabels:!0,renderedByDOMElement:!1,get size(){return this._sceneGraphNode.size.copy()},set size(t){console.warn("[MapKit] The `size` property of a marker annotation cannot be set.")},get color(){return null!==this._color?this._color:this.map?Qp[this.map._impl.currentColorScheme]:Qp.light},set color(t){null!==t&&_(t,"string","[MapKit] Expected a string value for MarkerAnnotation.color, but got `"+t+"` instead"),t!==this._color&&(this._color=t,this._sceneGraphNode.updateAppearance(!0),this._drawCalloutAccessory())},get fillColor(){return this.color},get haloColor(){return null},get glyphColor(){return null!==this._glyphColor?this._glyphColor:this.map?this.isPlaceStyle?em[this.map._impl.tint]:tm[this.map._impl.currentColorScheme]:tm.light},set glyphColor(t){null!==t&&_(t,"string","[MapKit] Expected a string value for MarkerAnnotation.glyphColor, but got `"+t+"` instead"),t!==this._glyphColor&&(this._glyphColor=t,this._sceneGraphNode.updateAppearance(!0),this._drawCalloutAccessory())},get glyphImage(){return this._glyphImage},set glyphImage(t){this._setGlyphImage("_glyphImage","updateGlyphImage",t)},get selectedGlyphImage(){return this._selectedGlyphImage},set selectedGlyphImage(t){this._setGlyphImage("_selectedGlyphImage","updateSelectedGlyphImage",t)},updateGlyphImages:function(){this._setGlyphImage("_glyphImage","updateGlyphImage",this._glyphImage),this._setGlyphImage("_selectedGlyphImage","updateSelectedGlyphImage",this._selectedGlyphImage)},get glyphText(){return this._glyphText},set glyphText(t){_(t,"string","[MapKit] Expected a string value for MarkerAnnotation.glyphText, but got `"+t+"` instead"),t!==this._glyphText&&(this._glyphText=t,this.updateLocalizedText(),this.updateGlyph(),this._sceneGraphNode.updateGlyphText(),this._drawCalloutAccessory())},get glyph(){return this._glyph},get titleVisibility(){return this._titleVisibility},set titleVisibility(t){if(!m(t,Yp.FeatureVisibility))throw new Error("[MapKit] Expected one of Hidden, Visible or Adaptive for MarkerAnnotation.titleVisibility");t!==this._titleVisibility&&(this._titleVisibility=t,this._sceneGraphNode.needsLayout=!0)},get subtitleVisibility(){return this._subtitleVisibility},set subtitleVisibility(t){if(!m(t,Yp.FeatureVisibility))throw new Error("[MapKit] Expected one of Hidden, Visible or Adaptive for MarkerAnnotation.subtitleVisibility");t!==this._subtitleVisibility&&(this._subtitleVisibility=t,this._sceneGraphNode.needsLayout=!0)},get labelOccluded(){return this._labelOccluded},set labelOccluded(t){this._labelOccluded!==t&&(this._sceneGraphNode.needsLayout=!0),this._labelOccluded=t},_labelOccluded:!1,labelsCanBeShown:function(){return this.delegate&&this.delegate.supportsLabelRegions()},titleCanBeShown:function(){return this.title&&!this.labelOccluded&&this._titleVisibility!==Yp.FeatureVisibility.Hidden},subtitleCanBeShown:function(t){return this.subtitle&&!this.labelOccluded&&(this._subtitleVisibility===Yp.FeatureVisibility.Visible||this._subtitleVisibility===Yp.FeatureVisibility.Adaptive&&(this._public.memberAnnotations||this.selected&&t))},updateLayout:function(t,e){!e&&t||(this._sceneGraphNode.needsLayout=!0),(e||t)&&this._sceneGraphNode.updateLayout(t)},updatedLayout:function(){this._updatedProperty("")},calculateNodePosition:function(){return new Gi(Co.roundToDevicePixel(this._position.x-this._anchorPoint.x-this._anchorOffset.x),this._position.y-this._anchorPoint.y-this._anchorOffset.y)},animateOcclusion(){if(!this.isLoadingIconMetadata)return t.prototype.animateOcclusion.call(this)},get darkColorScheme(){return!!this.map&&Co.darkColorScheme(this.map._impl.mapNodeTint)},get isAppStyle(){return!!(this._glyphImage&&this._glyphImage.isPOIIcon||this._selectedGlyphImage&&this._selectedGlyphImage.isPOIIcon)},get isPlaceStyle(){return this.isAppStyle},balloonVisible:!0,iconRect(){const t=this.nodePosition(),e=this.sceneGraphNode._balloon.position,i=this.sceneGraphNode._balloon.size;return new Bi(t.x+e.x,t.y+e.y,i.width,i.width)},_labelRect:void 0,_anchorPointWithLabel:void 0,labelRect(){if(!this._labelRect){0;const t=this.sceneGraphNode.children.filter((t=>t instanceof Rp)).map((t=>new Bi(t.position.x,t.position.y,t.size.width,t.size.height)));this._labelRect=t.length?Bi.unionOfRects(t):new Bi(0,0,0,0),this._anchorPointWithLabel=this._anchorPoint.copy()}const t=new Gi(Co.roundToDevicePixel(this._position.x-this._anchorPointWithLabel.x-this._anchorOffset.x),this._position.y-this._anchorPointWithLabel.y-this._anchorOffset.y);return new Bi(t.x+this._labelRect.origin.x,t.y+this._labelRect.origin.y,this._labelRect.size.width,this._labelRect.size.height)},isGlyphImageInternal:!1,warnOnUnselectedGlyphImageAccess:!1,get enablesDefaultGlyphImage(){return this._sceneGraphNode.enablesDefaultGlyphImage},set enablesDefaultGlyphImage(t){this._sceneGraphNode.enablesDefaultGlyphImage=t},setDelegate:function(e){t.prototype.setDelegate.call(this,e),this.labelsCanBeShown()&&this._updatedProperty("title")},doesAnimate:function(){return this._animates},willMoveToMap:function(t){this._isMoving=t&&this.animates},didMoveToMap:function(){const e=this._isMoving;if(t.prototype.didMoveToMap.call(this),this.isLoadingIconMetadata)return this._sceneGraphNode.opacity=0,void(this._isMoving=e);this.animateAppearance(e)},animateAppearance(t,e=!1){this.delegate&&t&&this.visible&&!this._appearanceAnimation&&this._shown?(this._isAnimating=!0,this._sceneGraphNode.animateAppearance((function(t){t.node.annotation.finishedAnimating()})),e&&this._sceneGraphNode.fadeInLabels()):this._sceneGraphNode.preventAnimation()},iconMetadataLoaded(){this.isLoadingIconMetadata&&(this.isLoadingIconMetadata=!1,this._sceneGraphNode.opacity=1,this.animateAppearance(this._isMoving,!0),delete this._isMoving)},lift:function(e){this._sceneGraphNode.updateState("lifted"),t.prototype.lift.call(this,e)},droppedAfterLift:function(){this._sceneGraphNode.updateState("default"),t.prototype.droppedAfterLift.call(this)},canShowCallout:function(){return(!!this.callout||this.delegate&&!this.delegate.supportsLabelRegions())&&t.prototype.canShowCallout.call(this)},centerOffsetForSelectionAccessory(){return new Gi(-this._node.size.width/2,-Yp.Params.selected.balloonRadius)},selectedStateForSceneGraphNode(){return this.selectionAccessory||this._calloutWithSelectedState?"selected":"callout"},selectionAccessoryWillAppear:function(t){const e=t?this.selectedStateForSceneGraphNode():"selected";this.isStable()&&this._sceneGraphNode.updateState(e)},selectionAccessoryWillDisappear:function(){this.selected||(delete this._calloutAccessoryNode,this._sceneGraphNode.updateState("default"))},canvasForCalloutAccessory:function(){if(!this.callout||this.selectionAccessory||!(this.callout.calloutElementForAnnotation||this.callout.calloutContentForAnnotation||this.callout.calloutLeftAccessoryForAnnotation||this.callout.calloutRightAccessoryForAnnotation))return this._calloutAccessoryNode||(this._calloutAccessoryNode=new $p(this,Yp.Params.bubble),this._calloutAccessoryNode.glyphImage=this._sceneGraphNode._balloon.glyphImage,this._calloutAccessoryNode.selectedGlyphImage=this._sceneGraphNode._balloon.selectedGlyphImage,this._calloutAccessoryNode.glyphText=this._glyphText,this._drawCalloutAccessory()),this._calloutAccessoryNode.getLayer();delete this._calloutAccessoryNode},get ignoreCalloutCornerRadiusForLeftAccessory(){return!0},altText:function(){return t.prototype.altText.call(this)||Oi.get("Annotation.Marker.AccessibilityLabel")},ConstructorOptions:Object.freeze(Object.assign({},t.prototype.ConstructorOptions,{color:"rw",glyphColor:"rw",glyphImage:"rw",selectedGlyphImage:"rw",glyphText:"rw",titleVisibility:"rw",subtitleVisibility:"rw",_calloutWithSelectedState:"rw"})),resetNodeTransform:function(){this.sceneGraphNode.transform=new Zi},updateGlyph:function(){this._glyph=this.glyphText||(this._glyphImageElement?this._glyphImageElement.src:"")},get staticStyle(){return this._staticStyle},set staticStyle(t){let e;switch(t){case im.Dot:e="callout";break;case im.Large:e="selected";break;default:t=im.Default,e="default"}this._staticStyle=t,this._sceneGraphNode.updateState(e),this._sceneGraphNode._usingStaticStyle=!0},loadGlyphImage:function(t,e,i,n){Jp(n,(o=>{if(this[e]===n)return o?void function(t,e,i,n){const o=i+"Loader";t[o]&&t[o].unschedule();if(t[o]=new js(N.Highest,{urlForImageLoader:e,loaderDidSucceed:function(e){t[o]===e&&(delete t[o],t[i]=e.image,t.updateGlyph(),t._sceneGraphNode[n](e.image),t._calloutAccessoryNode&&(t._calloutAccessoryNode[n](e.image),t._drawCalloutAccessory()))},loaderDidFail:function(e){t[o]===e&&(delete t[o],delete t[i],t.updateGlyph(),t._sceneGraphNode[n](),t._calloutAccessoryNode&&(t._calloutAccessoryNode[n](),t._drawCalloutAccessory()))}}),t.isGlyphImageInternal){const e=kt.withCredentials&&!kt.customMadabaUrl;t[o].crossOrigin=Hs.getCorsAttribute(e)}t[o].schedule()}(this,o.glyphImageUrl,t,i):(delete this[t],this._sceneGraphNode.glyphImageError(),void(this._calloutAccessoryNode&&this._calloutAccessoryNode.glyphImageError()))}))},_setBalloonStyle(){this.useSquareBalloon=this._glyphImage&&this._glyphImage.useSquareBalloon||this._selectedGlyphImage&&this._selectedGlyphImage.useSquareBalloon,this._sceneGraphNode._balloon.setBalloonStyle()},_setGlyphImage:function(t,e,i){null!=i&&_(i,"object","[MapKit] Expected a hash value or an Image delegate for MarkerAnnotation."+t.replace(/^_/,"")+", but got `"+i+"` instead"),this[t]=i;const n=t+"Element";if(this._setBalloonStyle(),!i){delete this[n];const t=n+"Loader";return this[t]&&(this[t].unschedule(),delete this[t]),this._sceneGraphNode[e](null),void(this._calloutAccessoryNode&&(this._calloutAccessoryNode[e](null),this._drawCalloutAccessory()))}this.loadGlyphImage(n,t,e,i)},_updatedProperty:function(e){"title"!==e&&"subtitle"!==e||(this._labelRect=void 0,this._anchorPointWithLabel=void 0,this._sceneGraphNode.needsLayout=!0),t.prototype._updatedProperty.call(this,e)},_drawCalloutAccessory:function(){this._calloutAccessoryNode&&this._calloutAccessoryNode.draw()}}),e.DefaultColor=Qp,e}nm.StaticStyles=im,nm.DefaultColor=Qp,nm.DefaultGlyphColor=tm;const om=nm,sm=om(qu);function am(t,e){Yo(this,am)&&Object.defineProperty(this,"_impl",{value:new sm(this,t,e)})}am.prototype=p(Xu,am,{get size(){return this._impl.size},set size(t){this._impl.size=t},get color(){return this._impl.color},set color(t){this._impl.color=t},get glyphColor(){return this._impl.glyphColor},set glyphColor(t){this._impl.glyphColor=t},get glyphImage(){return this._impl.glyphImage},set glyphImage(t){this._impl.glyphImage=t},get selectedGlyphImage(){return this._impl.selectedGlyphImage},set selectedGlyphImage(t){this._impl.selectedGlyphImage=t},get glyphText(){return this._impl.glyphText},set glyphText(t){this._impl.glyphText=t},get titleVisibility(){return this._impl.titleVisibility},set titleVisibility(t){this._impl.titleVisibility=t},get subtitleVisibility(){return this._impl.subtitleVisibility},set subtitleVisibility(t){this._impl.subtitleVisibility=t}});const rm=am,lm="mapsearch",hm="callout",cm=function(t,e){e=e||cn;const i=t===vn.Hybrid||t===vn.Satellite?wn:bn;i===wn&&(e=cn);return{iconStyle:i,tint:e,emphasis:t===vn.MutedStandard?Ln:An}};function dm(t=[]){if(t[0]||t[1]||t[2]||t[3])return"rgba("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]/255+")"}function um(t){this.results={},this.completeCallback=t,this.loaders=[],this.loaderData=[]}function pm(){this._deferredFetchOptionsMap=void 0}um.ATLAS_URL="/md/v1/atlas?data=false&dimension=1&entries={{entries}}&format=json&metadata=true&origin=top&type=icon&urls=true&accessKey={{accessKey}}",um._CALLOUT_GLYPH_IMAGE_ENDPOINT_URL_PATH="/md/v1/icon?subtype=poi&style={{style}}&context={{context}}&tint={{tint}}&emphasis={{emphasis}}&attributes={{attributes}}&v={{tileGroup}}&accessKey={{accessKey}}&scale={{scale}}&size={{size}}&glyph=true",um.fillGraphImageUrlPath=function(t,e){let i=um._CALLOUT_GLYPH_IMAGE_ENDPOINT_URL_PATH;return kt.tileGroup&&(i=i.replace("{{tileGroup}}",kt.tileGroup)),i=i.replace("{{attributes}}",e?t.styleAttributes:encodeURIComponent(t.styleAttributes)),i},um.keyFromFetchOptions=function(t){const e=cm(t.mapType,t.colorScheme);return t.styleAttributes+t.iconContext+e.iconStyle+e.tint+e.emphasis},um.prototype.fetch=function(t){const e=new Map(t.map((function(t){const e=cm(t.mapType,t.colorScheme);return[t,um.fillGraphImageUrlPath(t,!0).replace("&accessKey={{accessKey}}","").replace("{{scale}}","2").replace("{{size}}",t.iconContext===lm?"3":"4").replace("{{context}}",t.iconContext).replace("{{style}}",e.iconStyle).replace("{{tint}}",e.tint).replace("{{emphasis}}",e.emphasis).replace("{{tileGroup}}",kt.tileGroup||t.tileGroup)]})));t.sort((function(t,i){const n=e.get(t),o=e.get(i);return n>o?1:n<o?-1:0}));const i=[];for(let e=0;e<t.length;e+=1)i.push(t.slice(e,e+1));let n=kt.getMadabaDomainFromStringHash(t[0].styleAttributes)+um.ATLAS_URL.replace("{{accessKey}}",encodeURIComponent(kt.accessKey||""));kt.proxyPrefixes&&!kt.customMadabaUrl&&(n=kt.proxyPrefixes[0]+n),this.pendingRequestsCount=i.length;for(let t=0;t<i.length;t++){const o=i[t].map((t=>e.get(t))),s=n.replace("{{entries}}",encodeURIComponent(JSON.stringify({requests:o}))),a={withCredentials:kt.withCredentials&&!kt.customMadabaUrl,headers:{}};0;const r=new tt(s,this,a);this.loaders.push(r),this.loaderData.push([o,i[t]]),r.schedule()}},um.prototype.loaderDidSucceed=function(t,e){this.pendingRequestsCount--;const i=this.loaders.indexOf(t),n=this.loaderData[i],o=n[0],s=n[1],a=JSON.parse(e.responseText);o.forEach(((t,e)=>{const i=a.urls[t];if(!i)return void 0;const n=a["icon-metadata"][i],o=s[e].styleAttributes,r=um.keyFromFetchOptions(s[e]),l=cm(s[e].mapType,s[e].colorScheme),h=!("labelIconSource"in n)||0!==n.labelIconSource,c=!("labelTextVisibility"in n)||"Never"!==n.labelTextVisibility;this.results[r]={context:s[e].iconContext,styleAttributes:o,iconStyle:l.iconStyle,tint:l.tint,emphasis:l.emphasis,badgeColor:dm(n.badgeColor),calloutColor:dm(n.calloutColor),calloutHaloColor:dm(n.calloutHaloColor),haloColor:dm(n.haloColor),calloutShape:n.calloutShape?n.calloutShape:"Circle",iconVisibility:h,labelVisibility:c}})),0===this.pendingRequestsCount&&this.completeCallback(this.results)},um.prototype.loaderDidFail=function(t,e){this.pendingRequestsCount--,0===this.pendingRequestsCount&&this.completeCallback(this.results)},pm.fillGraphImageUrlPath=function(t){return um.fillGraphImageUrlPath(t)},pm.keyFromFetchOptions=function(t){return um.keyFromFetchOptions(t)},pm.prototype.fetchAll=function(t,e){if(!t.length)return void setTimeout((()=>e({})));new um(e).fetch(t)},pm.prototype.fetchDeferred=function(t,e){if(!this._deferredFetchOptionsMap)if(this._deferredFetchOptionsMap={},kt.state!==kt.States.READY){const t=()=>{kt.removeEventListener(kt.Events.Changed,t),setTimeout((()=>this._startDeferredFetch()),0)};kt.addEventListener(kt.Events.Changed,t)}else setTimeout((()=>this._startDeferredFetch()),0);const i=pm.keyFromFetchOptions(t);this._deferredFetchOptionsMap[i]||(this._deferredFetchOptionsMap[i]={fetchOptions:t,callbacks:[]});this._deferredFetchOptionsMap[i].callbacks.push(e)},pm.prototype._startDeferredFetch=function(){const t=this._deferredFetchOptionsMap;this._deferredFetchOptionsMap=null,this.fetchAll(Object.values(t).map((t=>t.fetchOptions)),(function(e){Object.entries(t).forEach((([t,i])=>i.callbacks.forEach((i=>i.call(null,e[t])))))}))},pm.sharedMadabaIconMetadata=new pm;const mm=pm;function gm(t,e,i,n,o){this.annotation=t,this._url=e.replace("{{size}}",i.toString()).replace("{{context}}",n),this.useSquareBalloon=o}gm.prototype.getImageUrl=function(t,e){let i,n,o;if(this.annotation.map){0;const t=cm(this.annotation.map.mapType,this.annotation.map._impl.tint);i=t.iconStyle,n=t.tint,o=t.emphasis}else if(this.annotation._impl.iconMetadata){const t=this.annotation._impl.iconMetadata;i=t.iconStyle,n=t.tint,o=t.emphasis}else i=bn,n=cn,o=An;t=Math.ceil(Math.min(Math.max(t,1),3)),e(this._url.replace("{{accessKey}}",encodeURIComponent(kt.accessKey)).replace("{{scale}}",t).replace("{{style}}",i).replace("{{tint}}",n).replace("{{emphasis}}",o))};const _m=gm,fm=mm.sharedMadabaIconMetadata,{Event:ym}=St,vm=Symbol(""),wm="load",bm="error";const Cm=function(t){function e(i,n,o){if(t.call(this,i,n,o),this._cachedIconMetadata={},this.constructor===e){if(!this.place)throw new Error("[MapKit] Expected a Place for PlaceAnnotation.");if(!this.place.coordinate)throw new Error("[MapKit] Expected a Place with coordinate.");this.coordinate.equals(this.place.coordinate)||(this.coordinate=this.place.coordinate),this.styleAttributes=this.place._styleAttributes,this.iconContext=lm,this.styleAttributes&&(this.styleAttributesHasIcon=!0,this.enablesDefaultGlyphImage=!1),this.title||(this.title=this.place.name)}}return e.StaticStyles=t.StaticStyles,e.prototype=p(t,e,{styleAttributesHasIcon:!1,styleAttributes:"",iconContext:"",iconMetadata:void 0,get isAppStyle(){return!1},get isPlaceStyle(){return!(this.iconMetadata&&!this.iconMetadata.iconVisibility)},get balloonVisible(){return!(this.iconMetadata&&!this.iconMetadata.iconVisibility)},titleCanBeShown:function(){return!(this.iconMetadata&&!this.iconMetadata.labelVisibility)&&t.prototype.titleCanBeShown.call(this)},subtitleCanBeShown:function(){return!(this.iconMetadata&&!this.iconMetadata.labelVisibility)&&t.prototype.subtitleCanBeShown.call(this)},get _color(){return this.iconMetadata?this.iconMetadata&&!this.iconMetadata.iconVisibility?this.map?t.DefaultColor[this.map._impl.currentColorScheme]:t.DefaultColor.light:this.selected||this.staticStyle===e.StaticStyles.Large||this.staticStyle===e.StaticStyles.Dot?this.iconMetadata.calloutColor:this.iconMetadata.badgeColor||this.iconMetadata.calloutColor:null},get haloColor(){return this.iconMetadata?this.iconMetadata&&!this.iconMetadata.iconVisibility?null:this.selected||this.staticStyle===e.StaticStyles.Large||this.staticStyle===e.StaticStyles.Dot?this.iconMetadata.calloutHaloColor:this.iconMetadata.haloColor:null},muid:void 0,isGlyphImageInternal:!0,get warnOnUnselectedGlyphImageAccess(){return!(!this.iconMetadata||"callout"!==this.iconMetadata.context)},ConstructorOptions:Object.freeze(Object.assign({},t.prototype.ConstructorOptions,{color:"ro",glyphColor:"ro",glyphImage:"ro",selectedGlyphImage:"ro",draggable:"ro",appearanceAnimation:"ro",anchorOffset:"ro",padding:"ro",size:"ro",glyphText:"ro"})),loadGlyphImage:function(e,i,n,o){(this.map||this.iconMetadata)&&t.prototype.loadGlyphImage.call(this,e,i,n,o)},updateLayout:function(e){this.updateGlyphImages(),this.updateIconMetadata(!0),t.prototype.updateLayout.call(this,e)},addedToMap:function(){t.prototype.addedToMap.call(this),this.updateIconMetadata(!1),this.updateGlyphImages()},updateIconMetadata:function(t){if(!this.map)return;if(!this.styleAttributesHasIcon)return;const e=cm(this.map.mapType,this.map._impl.tint),i=this._cachedIconMetadata[e.iconStyle+e.tint+e.emphasis];return this.iconMetadata&&i===this.iconMetadata?void 0:i&&i!==vm?(this.iconMetadata=i,void this._sceneGraphNode.updateAppearance(t)):void this.fetchIconMetadata(this.map._impl.tint,this.map.mapType)},setIconMetadata(t,e){if(this._cachedIconMetadata[t.iconStyle+t.tint+t.emphasis]=t,!this.iconMetadata){if(this.iconMetadata=t,this.iconMetadata.iconVisibility){const i=e||mm.fillGraphImageUrlPath(this);let n=kt.getMadabaDomainFromStringHash(this.styleAttributes)+i;kt.proxyPrefixes&&!kt.customMadabaUrl&&(n=kt.proxyPrefixes[0]+n);const o="Square"===t.calloutShape;this.selectedGlyphImage=new _m(this._public,n,4,t.context,o),t.context!==hm&&(this.glyphImage=new _m(this._public,n,3,t.context,o))}else this._sceneGraphNode.updateSizeAndAppearance(),this.enablesDefaultGlyphImage=!0;setTimeout((()=>this._public.dispatchEvent(new ym(wm))))}this.updateIconMetadata(!!this.map)},fetchIconMetadata(t,e,i){this.iconMetadata||(this.isLoadingIconMetadata=!0);const n={colorScheme:t,styleAttributes:this.styleAttributes,iconContext:this.iconContext,mapType:e},o=cm(n.mapType,n.colorScheme),s=o.iconStyle+o.tint+o.emphasis;this._cachedIconMetadata[s]!==vm&&(this._cachedIconMetadata[s]=vm,fm.fetchDeferred(n,(t=>{this._cachedIconMetadata[s]=void 0,t?this.setIconMetadata(t):(console.warn("[MapKit] Unable to fetch icon style for annotation."),this.iconMetadata=void 0,this.enablesDefaultGlyphImage=!0,this.glyphImage=this.selectedGlyphImage=null,setTimeout((()=>this._public.dispatchEvent(new ym(bm))))),this.iconMetadataLoaded(),"function"==typeof i&&i(this._public)})))}}),e},km=Cm(sm);function Mm(t,e){this._selected=e,this._impl=e?t.selectedGlyphImage:t.glyphImage}const Sm=function(){throw new Error("[MapKit] `MapFeatureAnnotationGlyphImage` may not be constructed directly.")};Mm.prototype=Sm.prototype={constructor:Sm,getImageUrl:function(t,e){if(("number"!=typeof t||isNaN(t))&&(t=Co.devicePixelRatio),"function"!=typeof e)throw new Error("[MapKit] Expects a callback to be provided.");HTMLCanvasElement.prototype.toBlob?this._impl.getImageUrl(t,(t=>{const i=new js(N.Highest,{urlForImageLoader:t,loaderDidSucceed:t=>{const i=this._impl.annotation._impl.iconMetadata,n=this._selected?i.calloutColor:i.badgeColor,o=t.image,s=document.createElement("canvas");s.width=o.naturalWidth,s.height=o.naturalHeight;const a=s.getContext("2d");n&&(a.fillStyle=n,a.fillRect(0,0,s.width,s.height)),a.drawImage(o,0,0),s.toBlob((function(t){it(e,null,[URL.createObjectURL(t)])}))},loaderDidFail:function(t){setTimeout((function(){it(e,null)}))}}),n=kt.withCredentials&&!kt.customMadabaUrl;i.crossOrigin=Hs.getCorsAttribute(n),i.schedule()})):setTimeout((function(){it(e,null)}))}};const Lm=Mm;function Am(t,e){Yo(this,Am)&&Object.defineProperty(this,"_impl",{value:new km(this,t,e)})}Am.prototype=p(rm,Am,{get element(){return this._impl.element},get coordinate(){return this._impl.coordinate},get draggable(){return this._impl.draggable},get appearanceAnimation(){return this._impl.appearanceAnimation},get anchorOffset(){return this._impl.anchorOffset},get padding(){return this._impl.padding},get size(){return this._impl.size},get glyphText(){return this._impl.glyphText},get color(){return this._impl.color},get glyphColor(){return this._impl.glyphColor},get glyphImage(){return this._impl.glyphImage?(this._impl._glyphImagePublic||(this._impl._glyphImagePublic=new Lm(this._impl,!1)),this._impl._glyphImagePublic):null},get selectedGlyphImage(){return this._impl.selectedGlyphImage?(this._impl._selectedGlyphImagePublic||(this._impl._selectedGlyphImagePublic=new Lm(this._impl,!0)),this._impl._selectedGlyphImagePublic):null}});const Em=Am;function xm(){this._requests={},this._types={},this._counter=1}xm.prototype={constructor:xm,add:function(t,e){const i=this._counter;return this._counter+=1,this._requests[i]=t,this._types[i]=e,i},get:function(t){return this._requests[t]},typeForId:function(t){return this._types[t]},idsByType:function(t){return Object.keys(this._requests).filter((e=>this._types[e]===t)).map((t=>parseInt(t)))},remove:function(t){return!!this.get(t)&&(delete this._requests[t],delete this._types[t],!0)}};const Tm=xm;for(bt.prototype.appendServiceAuthOptions=function(t){return t.withCredentials=this.withCredentials,this.appendAuthOptions(t)},bt.prototype._checkJwtToken=Zh;kt._jwtTokensToCheck.length;){const t=kt._jwtTokensToCheck.shift();kt._checkJwtToken(t)}const Im=tt,Rm={enableHighAccuracy:!1,timeout:8e3,maximumAge:9e5};function Om(t,e){this._name=t,this._requestMap=new Tm,kt.state===kt.States.ERROR&&(this._configFailed=!0),this.language=e.language,void 0!==e.getsUserLocation&&(this.getsUserLocation=!!e.getsUserLocation)}Om.prototype={constructor:Om,_getsUserLocation:!1,get getsUserLocation(){return this._getsUserLocation},set getsUserLocation(t){this._getsUserLocation=!!t},get language(){return this._language},set language(t){this._language=null==t?null:this._bestLanguage(t)},cancel:function(t){g(t,"[MapKit] Missing `id` in call to `"+this._name+".cancel()`."),_(t,"number","[MapKit] `id` passed to `"+this._name+".cancel()` is not a number.");const e=this._requestMap.typeForId(t);if(e)switch(e){case"query":case"geo":return this._requestMap.remove(t);case"xhr":{const e=this._requestMap.get(t);if(e)return e.unschedule(),this._requestMap.remove(t);break}default:throw new Error("Unknown type: "+e)}return!1},handleEvent:function(t){switch(t.type){case kt.Events.Error:this._configFailed=!0;case kt.Events.Changed:this._requestMap.idsByType("query").forEach((function(t){const e=this._requestMap.get(t);this._send(e.path,e.parameters,e.callback,e.transform,e.name),this._requestMap.remove(t)}),this)}0===this._requestMap.idsByType("query").length&&this._stopWatchingConfiguration()},_watchingConfiguration:!1,_watchConfiguration:function(){this._watchingConfiguration||(this._watchingConfiguration=!0,kt.addEventListener(kt.Events.Changed,this),kt.addEventListener(kt.Events.Error,this))},_stopWatchingConfiguration:function(){this._watchingConfiguration&&(this._watchingConfiguration=!1,kt.removeEventListener(kt.Events.Changed,this),kt.removeEventListener(kt.Events.Error,this))},_logNetworkEvent:function(t,e){let i;switch(t){case"search":i=ze.Events.Search;break;case"autocomplete":i=ze.Events.SearchAC;break;case"placeLookup":i=ze.Events.PlaceLookup;break;case"geocode":i=ze.Events.ForwardGeocoder;break;case"reverseGeocode":i=ze.Events.ReverseGeocoder;break;case"directions":i=ze.Events.Directions;break;case"nearbyPoi":i=ze.Events.PointsOfInterestSearch;break;default:return}ze.log(i,e)},_send:function(t,e,n,o,s){const a=this._requestMap;if(!kt.apiBaseUrl||kt.state===kt.States.PENDING)return this._configFailed?(setTimeout((function(){it(n,null,[new Error("MapKit failed to initialize.")])})),0):(this._watchConfiguration(),a.add({path:t,parameters:e,callback:n,transform:o,name:s},"query"));let r;r=0===t.search(/\/v?[0-9]+\//)?kt.apiBaseUrl.replace(/\/v?[0-9]+\//,"")+t:kt.apiBaseUrl+t,(e=e||{}).mkjsVersion=i.version;const l=b(e);""!==l&&(r+=(t.indexOf("?")>-1?"&":"?")+l);const h={loaderDidSucceed:(t,i)=>{let r;if(this._logNetworkEvent(s,{responseCode:i.status}),a.remove(t.id),i.status<200||i.status>=300){try{r=JSON.parse(i.responseText)}catch(t){return void it(n,null,[new Error("HTTP error: "+i.status)])}r&&r.error&&r.error.message?(/categor(y|ies)/i.test(r.error.message)&&console.warn("[MapKit] The version of MapKit may be deprecated."),it(n,null,[new Error("HTTP error: "+i.status+". Message: "+r.error.message+".")])):it(n,null,[new Error("HTTP error: "+i.status)])}else{try{r=JSON.parse(i.responseText)}catch(t){return void it(n,null,[new Error("Failed to parse response: "+i.responseText)])}it(n,null,[null,o(e,r)])}},loaderDidFail:(t,e)=>{this._logNetworkEvent(s,{responseCode:e.status}),a.remove(t.id);let i=kt.ErrorStatus.Unknown;0===e.status?i=kt.ErrorStatus.NetworkError:e.status===kt.HTTP.UNAUTHORIZED?i=kt.ErrorStatus.Unauthorized:e.status===kt.HTTP.TOO_MANY_REQUESTS?i=kt.ErrorStatus.TooManyRequests:e.status===kt.HTTP.BAD_REQUEST&&(i=kt.ErrorStatus.BadRequest),it(n,null,[new Error(i)])}},c=new Im(r,h,kt.appendServiceAuthOptions({}));return c.schedule(),c.id=a.add(c,"xhr"),c.id},_sendImmediatelyOrWithUserLocation:function(t,e,i,n,o){return this.getsUserLocation||e.getsUserLocation?this._sendWithUserLocation.apply(this,arguments):this._send.apply(this,arguments)},_sendWithUserLocation:function(t,e,i,n,o){const s=this._requestMap.add({path:t,parameters:e,callback:i,transform:n,name:o},"geo");return this._locate(((t,e)=>{const i=this._requestMap.get(s);i&&(t?console.warn("[MapKit] Unable to get current location:",t.message):i.parameters.userLocation=[e.latitude,e.longitude].join(","),this._send(i.path,i.parameters,i.callback,i.transform,i.name),this._requestMap.remove(s))})),s},_checkOptions:function(t,e){_(t,"object","[MapKit] The `options` object is invalid."),Object.keys(t).forEach((function(t){-1===e.indexOf(t)&&console.warn("[MapKit] `"+t+"` is not a valid option.")}))},_bestLanguage:function(t){_(t,"string","[MapKit] `language` is not a string."),"zh"===t.toLowerCase()&&(console.warn("[MapKit] `zh` is an ambiguous language ID. Please specify a script or reginal variant: `zh-Hans`, `zh-Hant`, or `zh-HK`."),kt.countryCode&&(t="zh-"+kt.countryCode));const e=A.bestMatch(t);return null===e&&console.warn("[MapKit] "+this._name+": â"+t+"â is not supported."),e},_locate:function(t){g(t,"Missing callback"),_(t,"function"),Om.userLocation.locate((function(e){const i=e.coords;t(null,new ni(i.latitude,i.longitude))}),(function(e){let i;switch(e.code){case e.PERMISSION_DENIED:i="PERMISSION_DENIED";break;case e.POSITION_UNAVAILABLE:i="POSITION_UNAVAILABLE";break;case e.TIMEOUT:i="TIMEOUT";break;default:throw new Error("Unknown PositionError code: "+e.code)}t(new Error(i))}),Rm)}},R.jsModules.userLocation?Om.userLocation=R.jsModules.userLocation:R.addEventListener("load",(function t(e){e.jsModules.userLocation&&(Om.userLocation=e.jsModules.userLocation,R.removeEventListener("load",t))}));const Pm=Om;function Dm(){Pm.call(this,"PlaceData",{})}Dm.prototype=p(Pm,Dm,{fetch:function(t,e){if("CN"===kt.countryCode)return void setTimeout((function(){const t=new Error("[MapKit] MapFeatureAnnotation.fetch() is not supported in China yet.");it(e,null,[t])}));const i={mapsId:JSON.stringify({muid:t}),lang:kt.language};return this._send("placedata",i,e,(function(t,e){if(e&&e.result)return new mi(e.result)}),"placedata")}});const zm=Dm;const Nm=function(t){function e(e,i,n){t.call(this,e,i,n),this._cachedIconMetadata={}}return e.StaticStyles=t.StaticStyles,e.prototype=p(t,e,{featureType:"",pointOfInterestCategory:null,fetchPlace:function(t){g(t,"[MapKit] Missing `callback` in call to `MapFeatureAnnotation.fetch()`."),_(t,"function","[MapKit] `callback` passed to `MapFeatureAnnotation.fetch()` is not a function.");return(new zm).fetch(this.muid,t)},get isAppStyle(){return!0},ConstructorOptions:Object.freeze(Object.assign({},t.prototype.ConstructorOptions,{color:"rw",glyphColor:"rw",glyphImage:"rw",selectedGlyphImage:"rw",draggable:"rw",appearanceAnimation:"rw",anchorOffset:"rw",padding:"rw",size:"rw",glyphText:"rw"}))}),e},Fm=Nm(km),Um={PointOfInterest:"PointOfInterest",Territory:"Territory",PhysicalFeature:"PhysicalFeature"};function Gm(t,e){Object.defineProperty(this,"_impl",{value:new Fm(this,t,e)})}Gm.isConstructable=!1;const Bm=function(t,e){if(Gm.isConstructable)return Gm.call(this,t,e);throw new TypeError("[MapKit] MapFeatureAnnotation may not be constructed.")};function Zm(){R.jsModules.fromStyleAttributes&&(Gm.isConstructable=!0,Bm.fromStyleAttributes=R.jsModules.fromStyleAttributes,Bm.IconContext=R.jsModules.IconContext,R.removeEventListener("load",Zm))}Gm.prototype=Bm.prototype=p(Em,Bm,{get featureType(){return this._impl.featureType},fetchPlace:function(t){return this._impl.fetchPlace(t)},get pointOfInterestCategory(){return this._impl.pointOfInterestCategory},get map(){return this._impl.map},get collisionMode(){return this._impl.collisionMode},get title(){return this._impl.title},get subtitle(){return this._impl.subtitle},get titleVisibility(){return this._impl.titleVisibility},get subtitleVisibility(){return this._impl.subtitleVisibility},get accessibilityLabel(){return this._impl.accessibilityLabel}}),Gm.fromMapFeatureRegion=function(t,e,i){const n=!!(t.calloutGlyphImageUrlTemplate&&t.metadata&&t.metadata.calloutColor),o=new Gm(new hi.MapPoint(t.position[0],t.position[1]).toCoordinate(),{selected:!0,id:Pu.muidToPlaceId({muid:t.muid}),title:t.title});switch(t.annotation&&(o._impl.subtitle=t.annotation),o._impl.muid=t.muid,o._impl.styleAttributes=t.styleAttributes,t.category){case"Poi":o._impl.featureType=Um.PointOfInterest;break;case"Territory":o._impl.featureType=Um.Territory;break;case"PhysicalFeature":o._impl.featureType=Um.PhysicalFeature}if(n){o._impl.styleAttributesHasIcon=!0;const n=t.metadata;n.iconVisibility=!("labelIconSource"in n)||0!==n.labelIconSource,n.labelVisibility=!("labelTextVisibility"in n)||"Never"!==n.labelTextVisibility,n.styleAttributes=t.styleAttributes,n.context=(t.calloutGlyphImageUrlTemplate.match(/context=(\w+)/)||[])[1],o._impl.iconContext=n.context;const{iconStyle:s,tint:a,emphasis:r}=cm(e,i);n.iconStyle=s,n.tint=a,n.emphasis=r;const l=t.calloutGlyphImageUrlTemplate.replace(/emphasis=(standard|muted)/,"emphasis={{emphasis}}");o._impl.setIconMetadata(n,l),o._impl.enablesDefaultGlyphImage=!1,t.poiType&&Lt[t.poiType]&&(o._impl.pointOfInterestCategory=t.poiType)}return o},R.addEventListener("load",Zm),Zm();const Wm=Gm;function Km(t){this._annotationsController=t}Km.prototype={getMapFeatureAnnotationForRegion:function(t,e){const i=this._annotationsController.map;let n=Wm.fromMapFeatureRegion(t,i.mapType,i.tileTint);const o=i.annotationForMapFeature;return"function"==typeof o&&(n=it(o,i.public,[n])||n),n._impl.selected=!0,e&&(n._impl.selectionAccessory=e),n},mapFeatureDidSelect:function(t){this._annotationsController.addItem(t,0),t._impl.isMapFeature=!0},mapTypeDidChange:function(){const t=this._annotationsController.selectedItem;t&&t._impl.isMapFeature&&this._annotationsController.items.indexOf(t)>=0&&this._annotationsController.removeItem(t)},annotationSelectionDidChange:function(t){!t.selected&&t._impl.isMapFeature&&this._annotationsController.items.indexOf(t)>=0&&this._annotationsController.removeItem(t)}};const Hm=Km,jm=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);function Vm(t,e,i,n){this._memberAnnotations=i,sm.call(this,t,e,n)}Vm.prototype=p(sm,Vm,{get memberAnnotations(){return this._memberAnnotations},get n(){return this._memberAnnotations.length},get title(){return jm(this,"_title")?this._title:this._topAnnotation.title},set title(t){Object.getOwnPropertyDescriptor(qu.prototype,"title").set.call(this,t)},get subtitle(){const t=this.n-1;return jm(this,"_subtitle")?this._subtitle:Oi.get("Annotation.Clustering.More"+(t>1?".Plural":""),{n:Oi.digits(t)})},set subtitle(t){Object.getOwnPropertyDescriptor(qu.prototype,"subtitle").set.call(this,t)},get glyphText(){return jm(this,"_glyphText")?this._glyphText:jm(this,"_glyphImage")||jm(this,"_selectedGlyphImage")?"":Oi.digits(this.n)},set glyphText(t){Object.getOwnPropertyDescriptor(sm.prototype,"glyphText").set.call(this,t)},get draggable(){return!1},set draggable(t){},get displayPriority(){return this._topAnnotation.displayPriority},set displayPriority(t){},get clusteringIdentifier(){return this._topAnnotation.clusteringIdentifier},set clusteringIdentifier(t){},get _topAnnotation(){return this._memberAnnotations[0]},get _showDefaultAltText(){return jm(this,"_glyphText")||jm(this,"_glyphImage")||jm(this,"_selectedGlyphImage")},get isAppStyle(){return!!this._topAnnotation._impl.isAppStyle},get isPlaceStyle(){const t=this.isAppStyle;return t||!1},updateLocalizedText:function(){qu.prototype.updateLocalizedText.call(this),this.updateGlyph(),this._sceneGraphNode.updateAppearance(!0)},altText:function(){return this._showDefaultAltText?qu.prototype.altText.call(this):this.title?Oi.get("Annotation.Clustering.AccessibilityLabel",{n:this.glyphText,title:this.title,subtitle:this.subtitle}):Oi.get("Annotation.Clustering.NoTitle.AccessibilityLabel",{n:this.glyphText,subtitle:this.subtitle})}});const qm=Vm;function Ym(t,e,i){Object.defineProperty(this,"_impl",{value:new qm(this,t,e,i)})}const Xm=function(){throw new TypeError("[MapKit] ClusterAnnotation may not be constructed.")};Ym.prototype=Xm.prototype=p(rm,Xm,{get memberAnnotations(){return this._impl.memberAnnotations}});const $m=Ym,Jm=kt.performanceMarkers.frameUpdates;function Qm(t){this._annotationsController=t,this._clusters=[],this._previousClusters=[],this._previousOverlaps=[],this._previousAnnotations=[],this._frameCounter=0}function tg(t,e){const i=Xu.DisplayPriority.Required,n=t.selected?i:t.displayPriority;return(e.selected?i:e.displayPriority)-n||e._impl.boundingBox.y2-t._impl.boundingBox.y2}function eg(t,e){return e.displayPriority-t.displayPriority||t._impl.index-e._impl.index}function ig(t,e){return t._impl.collisionMode===Xu.CollisionMode.None||e._impl.collisionMode===Xu.CollisionMode.None?0:t._impl.boundingBox.x1-e._impl.boundingBox.x1}function ng(t){const e=t._impl.node,i=t._impl.nodePosition(),n=t.padding,o=e.size,s=o.width,a=o.height,r=i.x+n.left,l=i.x+s-n.right,h=i.y+n.top,c=i.y+a-n.bottom;if(t._impl.isAppStyle&&!t.selected){const e=t._impl.iconRect(),i=t._impl.labelRect(),n=Math.min(e.size.width,e.size.height)/2;return{boundType:"circle",x1:e.origin.x,x2:e.origin.x+e.size.width,y1:e.origin.y,y2:e.origin.y+e.size.height,cx:e.origin.x+e.size.width/2,cy:e.origin.y+e.size.height/2,r:n/2,padding:0,iconBoundingBox:{boundType:"circle",x1:e.origin.x,x2:e.origin.x+e.size.width,y1:e.origin.y,y2:e.origin.y+e.size.height,cx:e.origin.x+e.size.width/2,cy:e.origin.y+e.size.height/2,r:n,padding:0},labelBoundingBox:{boundType:"rect",x1:i.origin.x,x2:i.origin.x+i.size.width,y1:i.origin.y,y2:i.origin.y+i.size.height,padding:1}}}return t._impl.collisionMode===Xu.CollisionMode.Circle?{boundType:"circle",x1:r,x2:l,y1:h,y2:c,cx:(r+l)/2,cy:(h+c)/2,r:Math.min(s,a)/2,padding:5}:{boundType:"rect",x1:r,x2:l,y1:h,y2:c,padding:5}}function og(t){switch(t.boundType){case"circle":return{boundType:t.boundType,x1:t.x1-t.padding,x2:t.x2+t.padding,y1:t.y1-t.padding,y2:t.y2+t.padding,cx:t.cx,cy:t.cy,r:t.r+t.padding,padding:0};case"rect":return{boundType:t.boundType,x1:t.x1-t.padding,x2:t.x2+t.padding,y1:t.y1-t.padding,y2:t.y2+t.padding,padding:0}}}function sg(t,e){const i=t.cx-u(t.cx,e.x1,e.x2),n=t.cy-u(t.cy,e.y1,e.y2);return i*i+n*n<=t.r*t.r}function ag(t,e){if(!(e.x2>=t.x1&&e.x1<=t.x2&&e.y2>=t.y1&&e.y1<=t.y2))return!1;if("circle"===t.boundType){if("circle"===e.boundType){const i=t.cx-e.cx,n=t.cy-e.cy,o=Math.sqrt(i*i+n*n);return t.r+e.r>=o}return sg(t,e)}return"circle"!==e.boundType||sg(e,t)}function rg(t,e){t._impl.occluded=e,t._impl.updateVisibility(e)}Qm.prototype={collideAnnotations:function(t,e,i,n){this._locked||(this._annotations=t,this._zoomLevel=e,this._rotation=i,this._changesSinceLastCollision=n,ue.scheduleOnNextFrame(this))},setRequiredClusterAnnotationProperties:function(t,e){return t!==e&&(t||(t=e),t.coordinate=e.coordinate,t.draggable=!1,t.displayPriority=e.memberAnnotations[0].displayPriority,t.clusteringIdentifier=e.memberAnnotations[0].clusteringIdentifier,Object.defineProperty(t,"memberAnnotations",{enumerable:!0,get:function(){return this._impl.memberAnnotations}}),Object.defineProperty(t._impl,"memberAnnotations",{enumerable:!0,value:e.memberAnnotations})),t.animates=e.memberAnnotations.some((function(t){return!t._impl.wasCollided})),t.selected=!1,t},removedAnnotation:function(t){t.memberAnnotations||(this._previousClusters=this._previousClusters.filter((function(e){if(e.memberAnnotations.indexOf(t)<0)return!0;this._annotationsController.removeAnyItem(e)}),this))},mapWasDestroyed:function(){this._annotationsController=null},performScheduledUpdate:function(){const t=Jm?performance.now():void 0;if(!this._annotationsController)return;if(this._frameCounter=(this._frameCounter+1)%10,1!==this._frameCounter)return void ue.scheduleOnNextFrame(this);const e=this._needsUpdate();if(!e)return;this._changesSinceLastCollision=!1,this._previousZoomLevel=this._zoomLevel,this._previousRotation=this._rotation,this._previousAnnotations=this._annotations.slice(),this._locked=!0,this._annotationsController.willUpdateCollisions(),"region"===e&&this._annotationsController.deselectClusterAnnotation(),this._overlaps=[];let i=0;for(let t=0,e=this._annotations.length;t<e;++t){const e=this._annotations[t];if(e._impl.needsLayout)return this._frameCounter=0,this._locked=!1,void ue.scheduleOnNextFrame(this);e._impl.index=t,e._impl.occluded=!1,e._impl.previousCluster=e._impl.cluster,delete e._impl.cluster,e._impl.collisionMode!==Xu.CollisionMode.None&&(e._impl.boundingBox=ng(e),i=Math.max(i,e._impl.boundingBox.x2-e._impl.boundingBox.x1))}const n=this._annotations.sort(ig),o={};n.forEach((function(t){if(t.selected||t._impl.collisionMode===Xu.CollisionMode.None)return;const e=t.clusteringIdentifier;e&&(o[e]?o[e].push(t):o[e]=[t])}));const s=this._clusters;this._clusters=[];for(const t in o)o[t].length>1&&(i=this._clusterAnnotationsWithMaxWidth(o[t],i));s.forEach((function(t){this._clusters.indexOf(t)<0&&(rg(t,!0),t.selected&&(t.selected=!1))}),this),this._collideAnnotationsAndClusters(n,i),this._collideAnnotationLabels([...n,...this._clusters]),this._previousOverlaps=this._overlaps,this._annotationsController.didUpdateCollisions(),this._locked=!1,Jm&&performance.measure("mapkit-map-collision",{start:t})},_clusterAnnotationsWithMaxWidth:function(t,e){for(let i=0;i<t.length;){const n=t[i];if(n._impl.cluster){++i;continue}const o=n._impl.boundingBox.x2;let s=[n],a=i+1;if(n.memberAnnotations&&i>0){const o=n._impl.boundingBox.x1-e;for(a=i-1;a>0&&t[a]._impl.boundingBox.x1>=o;)a-=1}for(;a<t.length&&t[a]._impl.boundingBox.x1<=o;++a){const e=t[a];!e._impl.cluster&&a!==i&&this._annotationsOverlapExcludingSelected(n,e)&&s.push(e)}if(s.length>1){s=s.reduce((function(t,e){return e.memberAnnotations?(t=t.concat(e.memberAnnotations),e._impl.cluster=!0,rg(e,!0)):t.push(e),t}),[]).sort(eg);const n=this._clusterAnnotationForMemberAnnotations(s);for(n._impl.occluded=!1,n._impl.collisionMode!==Xu.CollisionMode.None&&(n._impl.boundingBox=ng(n),e=Math.max(e,n._impl.boundingBox.x2-n._impl.boundingBox.x1)),delete n._impl.cluster,a=0;a<s.length;++a)s[a]._impl.occluded=!0,s[a]._impl.cluster=n;for(a=0;a<t.length&&t[a]._impl.boundingBox.x1<n._impl.boundingBox.x1;)a+=1;t.splice(a,0,n),i=Math.min(i+1,a)}else++i}return t.forEach((function(t){t.memberAnnotations&&!t._impl.cluster&&(this._clusters.push(t),t.map||this._annotationsController.addItem(t))}),this),e},_collideAnnotationsAndClusters:function(t,e){let i=!1;const n=[];for(let e=0,o=0,s=t.length,a=this._clusters.length;e<s||o<a;){const s=t[e],a=this._clusters[o];s?s._impl.cluster||s._impl.collisionMode===Xu.CollisionMode.None?++e:a&&a._impl.boundingBox.x1<s._impl.boundingBox.x1?(a._impl.isRequired()||(i=!0),n.push(a),++o):(s._impl.isRequired()||(i=!0),n.push(s),++e):(a._impl.isRequired()||(i=!0),n.push(a),++o)}i&&this._collideAnnotationsWithMaxWidth(n,e)},_collideAnnotationsWithMaxWidth:function(t,e){const i=[];for(let e=0,n=t.length;e<n;++e){const o=t[e];0;const s=o._impl.boundingBox.x2;for(let a=e+1;a<n;++a){const e=t[a];if(e._impl.boundingBox.x1>s)break;o._impl.isRequired()&&e._impl.isRequired()||this._annotationsOverlap(o,e)&&i.push(tg(o,e)<=0?[o,e]:[e,o])}}i.sort((function(t,e){return tg(t[0],e[0])})).forEach((function(t){t[0]._impl.occluded||(t[1]._impl.occluded=!0)}))},_annotationsOverlapExcludingSelected:function(t,e){return!t.selected&&!e.selected&&this._annotationsOverlap(t,e)},_annotationsOverlap:function(t,e){if(t._impl.isLifted()||e._impl.isLifted())return!1;const i=eg(t,e)<=0?[t,e]:[e,t];let n;for(let t=0,e=this._previousOverlaps.length;t<e&&!n;++t){const e=this._previousOverlaps[t];e[0]===i[0]&&e[1]===i[1]&&(n=e)}const o=function(t,e,i){0;let n=t._impl.boundingBox,o=e._impl.boundingBox;i&&(n=og(n),o=og(o));return ag(n,o)}(t,e,n);return o&&this._overlaps.push(i),o},_clusterAnnotationForMemberAnnotations:function(t){let e;const i=function(t,e){for(let i=0,n=t.length;i<n;++i){const n=t[i],o=e.length;if(n.memberAnnotations.length===o){let t=0;for(;t<o&&e[t]===n.memberAnnotations[t];)t+=1;if(t===o)return i}}return-1}(this._previousClusters,t);if(i>=0)e=this._previousClusters[i],e._impl.resetNodeTransform();else{const i=function(t){let e=0,i=0,n=0;t.forEach((function(t){e+=t.coordinate.latitude;const o=hi.wrapLongitude(t.coordinate.longitude)/180*Math.PI;i+=Math.cos(o),n+=Math.sin(o)}));const o=t.length,s=e/o,a=0===i?n<0?-90:90:180*Math.atan(n/i)/Math.PI+(i<0?180:0);return new hi.Coordinate(s,a)}(t);e=this._annotationsController.addCluster(new $m(i,t)),this._previousClusters.push(e)}return e},_collideAnnotationLabels(t){for(const e of t){if(e._impl.collisionMode===Xu.CollisionMode.None){e._impl.labelOccluded=!1;continue}const i=e._impl.boundingBox;if(e._impl.occluded){e._impl.labelOccluded=!!i.labelBoundingBox;continue}if(!i.labelBoundingBox){e._impl.labelOccluded=!1;continue}const n=og(i.labelBoundingBox);let o=!1;for(const i of t){if(e===i)continue;if(e._impl.occluded||e._impl.collisionMode===Xu.CollisionMode.None||i._impl.occluded||i._impl.collisionMode===Xu.CollisionMode.None)continue;if(ag(n,i._impl.boundingBox.iconBoundingBox?i._impl.boundingBox.iconBoundingBox:i._impl.boundingBox)){o=!0;break}if(i._impl.boundingBox.labelBoundingBox&&!i._impl.labelOccluded&&ag(n,og(i._impl.boundingBox.labelBoundingBox))){o=!0;break}}e._impl.labelOccluded=o}},_needsUpdate:function(){if(this._zoomLevel!==this._previousZoomLevel||this._rotation!==this._previousRotation)return"region";if(this._changesSinceLastCollision)return"annotations";const t=this._annotations.length;if(this._previousAnnotations.length!==t)return"annotations";for(let e=0;e<t;++e)if(this._annotations[e]!==this._previousAnnotations[e])return"annotations";return""}};const lg=Qm;function hg(t){Oo.call(this),this._element=t}hg.prototype=p(Oo,hg,{get element(){return this._element},stringInfo:function(){return"AnnotationsControllerNode"}});const cg=hg;function dg(t){this._element=Co.htmlElement("div",{class:"mk-style-helper"}),this.delegate=t}dg.prototype={constructor:dg,delegate:null,get element(){return this._element},sizeForElement:function(t){const e=t.cloneNode(!0),i=[],n=[];!function(t,e,i){if(Co.supportsShadowDOM){if("slot"===t.localName)e.push(t),i.push(t.name);else{const n=t.getElementsByTagName("slot");0!==n.length&&Array.prototype.forEach.call(n,(function(t){e.push(t),i.push(t.name)}))}e.forEach((t=>{t.name="mk-slot-disabled"}))}}(t,i,n),this._element.appendChild(e),this.delegate&&this.delegate.styleHelperNodeDidMoveToParent&&this.delegate.styleHelperNodeDidMoveToParent(e);let o=e;Co.supportsShadowDOM&&"slot"===t.localName&&(o=e.assignedNodes()[0]);const s=function(t){if(!t||t.nodeType!==window.Node.ELEMENT_NODE)return;const e=window.getComputedStyle(t),i=parseFloat(e.marginLeft),n=parseFloat(e.marginTop),o=parseFloat(e.marginRight),s=parseFloat(e.marginBottom);return Bi.rectFromClientRect(t.getBoundingClientRect()).inset(-i,-n,-o,-s)}(o);return this._element.removeChild(e),function(t,e){Co.supportsShadowDOM&&t.forEach(((t,i)=>{t.name=e[i]}))}(i,n),s&&s.size},backgroundColorForElement:function(t,e){this._element.appendChild(t),this.delegate&&this.delegate.styleHelperNodeDidMoveToParent&&this.delegate.styleHelperNodeDidMoveToParent(t);let i=t;if(Co.supportsShadowDOM&&"slot"===t.localName&&(i=t.assignedNodes()[0],!i))return this._element.removeChild(t),null;const n=window.getComputedStyle(i).backgroundColor;return e&&(i.style.backgroundColor="transparent"),this._element.removeChild(t),/^transparent|initial|rgba\(.*, 0\)$/.test(n)?null:n},setAnimationForElement:function(t,e,i){let n=t;if(Co.supportsShadowDOM&&"slot"===t.localName&&(n=t.assignedNodes()[0],!n))return;n.style.animation=e;const o=function(t){t.animationName===i&&(n.style.animation="",n.removeEventListener("animationend",o))};n.addEventListener("animationend",o)}};const ug=dg;class pg extends so.Node{toString(){return this.stringInfo()+" â"}}function mg(t){this.hostNode=t,this._elementNodeMap={}}mg.prototype={constructor:mg,appendAssignedElement:function(t,e){const i=t.slot,n=new pg(t);this._elementNodeMap[i]=n,this.hostNode.addChild(n),e||this.hostNode.element.appendChild(t)},removeAssignedElement:function(t,e){const i=t.name,n=this._elementNodeMap[i];delete this._elementNodeMap[i],this.hostNode.removeChild(n),e||this.hostNode.element.removeChild(n.element)},getAssignedElement:function(t){return this._elementNodeMap[t.name]?this._elementNodeMap[t.name].element:null}};const gg=mg,_g=18,fg=12,yg=277/249,vg=237/249,wg="mk-selection-accessory",bg="mk-selection-accessory-bubble",Cg="mk-selection-accessory-content",kg="mk-selection-accessory-loading",Mg="mk-selection-accessory-failed",Sg="mk-failed-labels",Lg="mk-rtl",Ag=new Ui(243,311),Eg=new Ui(180,70);function xg(t,{place:e,muid:i,uiStyle:n,side:o,rtl:s}){Su.call(this),this.delegate=t,this._node=new so.Node(Co.htmlElement("div",{class:`${wg} mk-ui-style-${n}`}));const a=this._node.element;this._tailScale=1,this._bubbleElement=Co.svgElement("path"),this._svgElement=a.appendChild(Co.svgElement("svg",{class:bg},this._bubbleElement)),this._containerElement=Co.htmlElement("div"),this._containerElementNode=new so.Node(this._containerElement),this._containerContentElement=this._containerElement.appendChild(Co.htmlElement("div"));this.uiStyle=n,this._controller=new zi(this._containerContentElement,{get colorScheme(){return t.tint},get place(){return e||{muid:i}},placeCardSizeDidChange:(t,e)=>this._placeCardSizeDidChange(t,e),loadingDidFail:()=>this._placeCardFrameLoadingDidFail(),uiStyle:n,placeCardDidReveal:t=>this.delegate.placeCardDidReveal("full"===n?"LARGE":"MEDIUM",t),placeCardOpenInMapsClicked:t=>this.delegate.placeCardOpenInMapsClicked("full"===n?"LARGE":"MEDIUM",t)}),this.side=o,this._controller.update(),this._containerElementNode.classList.add(Cg),s&&this._containerElementNode.classList.add(Lg),a.appendChild(this._containerElement),this._rtl=s,this._loadingCanvasElement=Co.htmlElement("canvas",{"aria-hidden":"true",class:kg}),this._containerElement.appendChild(this._loadingCanvasElement),this._node.wantsHardwareCompositing=!0}function Tg(t,e,i,n){const o=15*e,s=fg*e,a=t.width/2-o,r=t.height/2-o,l=10*e,h=12*e;return"M0,18c0,-9.972 8.028,-18 18,-18"+("bottom"===i?"h"+(-n+a)+"c"+l+",0 "+h+","+-s+" "+o+","+-s+"c"+(-h+o)+",0 "+(-l+o)+","+s+" "+o+","+s+"h"+(n+a):"h"+t.width)+"c9.972,0 "+"18,"+"8.028 "+"18,"+_g+("left"===i?"v"+r+"c0,"+l+" "+s+","+h+" "+s+","+o+"c0,"+(-h+o)+" "+-s+","+(-l+o)+" "+-s+","+o+"v"+r:"v"+t.height)+"c0,9.972 "+"-8.028,"+"18 "+"-18,"+_g+("top"===i?"h"+(-n-a)+"c"+-l+",0 "+-h+","+s+" "+-o+","+s+"c"+(h-o)+",0 "+(l-o)+","+-s+" "+-o+","+-s+"h"+(n-a):"h"+-t.width)+"c"+"-9.972,0 "+"-18,"+"-8.028 "+"-18,"+-18+("right"===i?"v"+-r+"c0,"+-l+" "+-s+","+-h+" "+-s+","+-o+"c0,"+(h-o)+" "+s+","+(l-o)+" "+s+","+-o+"v"+-r:"z")}xg.prototype=p(Su,xg,{_tailXAxisShift:0,get node(){return this._node},get boundingRect(){const t=this._node.position;return new Bi(t.x,t.y,this._node.size.width,this._node.size.height)},delegate:null,willMoveToMap:function(){this._node.transform=(new Bn).scale(0)},setAnchorOffset:function(t){0},containsElement:function(t){return t!==this._svgElement&&!!this._containerElement.contains(t)},isCustomCallout:function(){return!1},updateInfo:function(t,e){const i=this.placeCardSize?this.placeCardSize.copy():"full"===this.uiStyle?Ag.copy():Eg.copy();return this._updateSize(i),this.updatePosition(),!0},setPositionWithSide(t,e){switch(this.side=e,e){case"top":t.y+=-12*this._tailScale;break;case"left":t.x-=this._node.size.width/2+fg*this._tailScale,t.y+=this._node.size.height/2;break;case"right":t.x+=this._node.size.width/2+fg*this._tailScale,t.y+=this._node.size.height/2;break;case"bottom":t.y+=this._node.size.height+fg*this._tailScale}return this.setPosition(t)},shiftTailBy:function(t){if("left"===this.side||"right"===this.side)return this._tailXAxisShift=0,this._bubbleElement.setAttribute("d",Tg(this._bubbleSize,this._tailScale,this.side,this._tailXAxisShift)),0;const e=Math.max(0,(this._bubbleSize.width-36)/2);return this._tailXAxisShift=t<0?Math.min(e,-t):-Math.min(e,t),this._bubbleElement.setAttribute("d",Tg(this._bubbleSize,this._tailScale,this.side,this._tailXAxisShift)),this._node.position=new Gi(this._node.position.x+this._tailXAxisShift,this._node.position.y),this._tailXAxisShift},animateIn:function(){if(!this.animates)return this.animatedIn=!0,void(this._node.transform=new Bn);this.animatedIn||(this.animatedIn=!0,this._setScaleOffsets(),this._scaleAnimationParameterIndex=0,this._scaleAnimationStartDate=Date.now(),ue.scheduleOnNextFrame(this))},animateOut:function(t){!t&&this.visible?(this._scaleAnimationStartDate&&this._finishAnimatingScale(),this._fadeoutAnimationStartDate=Date.now(),ue.scheduleOnNextFrame(this)):this._node.remove()},mapNodeTintWasSet(t){this.updateInfo(),this._controller.update()},performScheduledUpdate:function(){this._scaleAnimationStartDate&&this._animateScale(),this._fadeoutAnimationStartDate&&this._animateFadeout()},didRemoveFromParent:function(){this.delegate.accessoryNodeDidRemove(this)},setSize:function(t){const e=fg*this._tailScale,i=t.width+20+2*e,n=t.height+20+2*e,o=-10.5-e,s=-10.5-e;this._svgElement.style.width=i+"px",this._svgElement.style.height=n+"px",this._svgElement.style.top=o+"px",this._svgElement.style.left=s+"px",this._svgElement.setAttribute("viewBox",`${s} ${o} ${i} ${n}`),Su.prototype.setSize.call(this,t)},_placeCardSizeDidChange(t,e){if(0===t||0===e)return;let i;switch(this._placeCardDidLoad(),this.uiStyle){case"full":i=new Ui(Ag.width,Math.min(600,this.delegate.getMaximumSizeForAccessory().height,e));break;case"compact":i=new Ui(t,e);break;default:0,i=new Ui}this.placeCardSize=i.copy(),this._updateSize(i),this.delegate.accessorySizeDidChange(this)},_updateLoadingCanvas(t){const e=this._loadingCanvasElement;if(!e)return;e.width=t.width*Co.devicePixelRatio,e.height=t.height*Co.devicePixelRatio;const i=e.getContext("2d");if(i.scale(Co.devicePixelRatio,Co.devicePixelRatio),this._rtl&&(i.translate(t.width,0),i.scale(-1,1)),"full"===this.uiStyle){const e=t.width-18-.2*t.width*Math.random();i.roundRect(9,12,e,20,5);const n=t.width-18-.2*t.width*Math.random();i.roundRect(9,36,n,13,5),i.fillStyle=this.delegate.tint===cn?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)",i.fill();const o=t.width-18,s=61,a=46,r=t.height-s-12-a-12,l=s+r+12;i.beginPath(),i.roundRect(9,s,o,r,10),i.roundRect(9,l,o,a,10),i.fillStyle=this.delegate.tint===cn?"#ffffff":"#242628",i.fill();const h=50,c=[1,1,1,1];c[Math.floor(4*Math.random())]+=1,c[Math.floor(4*Math.random())]+=1;let d=s+9;i.beginPath();for(const e of c){i.roundRect(21,d,h,11,5),d+=13;for(let n=0;n<e;n++)i.roundRect(21,d,t.width-42-.2*t.width*Math.random(),13,5),d+=13+(n+1===e?9:2)}i.arc(35,l+9+14,14,0,2*Math.PI),i.roundRect(58,l+9+7,t.width-42-37-.2*t.width*Math.random(),14,5),i.fillStyle=this.delegate.tint===cn?"rgba(0, 0, 0, 0.03)":"rgba(255, 255, 255, 0.03)",i.fill()}else{let e=12;for(;e<=t.height-12;){const n=t.width-32-.2*t.width*Math.random();i.roundRect(16,e,n,12,5),e+=18}i.fillStyle=this.delegate.tint===cn?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)",i.fill()}},_placeCardDidLoad(){this._removeLoadingCanvas(),this._removeLoadingFailureLabel()},_removeLoadingCanvas(){this._loadingCanvasElement&&(this._containerElement.removeChild(this._loadingCanvasElement),this._loadingCanvasElement=null)},_placeCardFrameLoadingDidFail(){this._removeLoadingCanvas(),this._loadingFailureLabel=Co.htmlElement("div",{class:Mg}),this._containerElement.appendChild(this._loadingFailureLabel);const t=this._loadingFailureLabel.appendChild(Co.htmlElement("div",{class:Sg}));t.appendChild(Co.htmlElement("p",Oi.get("Place.Error.Title"))),t.appendChild(Co.htmlElement("p",Oi.get("Place.Error.Message")));const e="full"===this.uiStyle?Ag.copy():Eg.copy();e.height=t.offsetHeight,this._updateSize(e),this.delegate.accessorySizeDidChange(this)},_removeLoadingFailureLabel(){this._loadingFailureLabel&&(this._containerElement.removeChild(this._loadingFailureLabel),this._loadingFailureLabel=null)},_updateSize:function(t){this._updateLoadingCanvas(t);const e=t.width-this.node.size.width;this._tailXAxisShift=Math.max(0,this._tailXAxisShift+Math.min(0,e)),this._containerElement.style.width=t.width+"px",this._containerElement.style.height=t.height+"px",t.height+=36,t.height-=36,this.setSize(t),this._bubbleSize=new Ui(t.width-36,t.height-36),this._bubbleElement.setAttribute("d",Tg(this._bubbleSize,this._tailScale,this.side,this._tailXAxisShift));(this._scaleXOffset||this._scaleYOffset)&&this._setScaleOffsets()},_setScaleOffsets(){const t=this._node.size,e=fg*this._tailScale;switch(this.side){case"top":this._scaleXOffset=-this._tailXAxisShift,this._scaleYOffset=t.height/2;break;case"left":this._scaleXOffset=t.width/2+e,this._scaleYOffset=-e/2;break;case"right":this._scaleXOffset=-t.width/2-e,this._scaleYOffset=-e/2;break;case"bottom":this._scaleXOffset=-this._tailXAxisShift,this._scaleYOffset=-t.height/2}},_scaleAnimationParameters:[[8e3/60,30/249,yg],[5e3/60,yg,vg],[5e3/60,vg,1]],_animateScale:function(){const t=this._scaleAnimationParameters[this._scaleAnimationParameterIndex],e=t[0],i=t[1],n=t[2],o=Date.now(),s=Math.min((o-this._scaleAnimationStartDate)/e,1),a=i+(n-i)*s;if(this._node.transform=(new Bn).translate(this._scaleXOffset,this._scaleYOffset).scale(a).translate(-this._scaleXOffset,-this._scaleYOffset),1===s){if(++this._scaleAnimationParameterIndex,!(this._scaleAnimationParameterIndex<this._scaleAnimationParameters.length))return void this._finishAnimatingScale();this._scaleAnimationStartDate=o}ue.scheduleOnNextFrame(this)},_finishAnimatingScale:function(){delete this._scaleXOffset,delete this._scaleYOffset,delete this._scaleAnimationStartDate,delete this._scaleAnimationParameterIndex},_animateFadeout:function(){const t=(Date.now()-this._fadeoutAnimationStartDate)/100,e=Math.max(0,1-t);0!==e?(this._node.opacity=e,ue.scheduleOnNextFrame(this)):this._node.remove()},animateTailScale:function(t,e){0},animateAnchorOffset:function(t,e){0},getCenterOffset:function(t){0}}),xg.DEFAULT_FULL_SIZE=Ag,xg.DEFAULT_COMPACT_SIZE=Eg,xg.TAIL_LENGTH=fg,xg.TAIL_DISTANCE_TO_ANCHOR=8;const Ig=xg,Rg=10.5,Og=3.5826363,Pg=3.58028186,Dg=277/249,zg=237/249,Ng="white",Fg={left:10,right:10,content:{left:4,right:4}},Ug={left:7.5,right:10},Gg={left:7.5,right:7.5},Bg=5.5,Zg=0,Wg="mk-callout",Kg="mk-bubble",Hg="mk-title",jg="mk-subtitle",Vg="mk-no-subtitle",qg="mk-no-accessories",Yg="mk-standard",Xg="mk-standard-content",$g="mk-callout-accessory",Jg="mk-callout-content",Qg="mk-custom-content",t_="mk-callout-accessory-content",e_="mk-rtl";class i_ extends so.Node{constructor(t){super(Co.htmlElement("div",{class:Wg,style:"direction: ltr"})),this._callout=t}didMoveToParent(t){null===t&&this._callout.didRemoveFromParent()}}function n_(t,e){Su.call(this),this.delegate=t,this._rtl=e.rtl,this._node=new i_(this);const i=this._node.element;function n(e){return t.backgroundColorForElement(e,!0)}function o(t,e){const i=Co.htmlElement("div",{class:t_},t);i.style.maxWidth="186.5px",e&&(i.style.padding="0");return Co.htmlElement("div",{class:$g},i)}e.customElement?(this._containerElement=this._customElement=e.customElement,this.setSize(this.delegate.sizeForElement(this._customElement)),i.appendChild(e.customElement)):(this._ignoreCalloutCornerRadiusForLeftAccessory=e.ignoreCalloutCornerRadiusForLeftAccessory,this._tailScale=e.tailScale||1,this._bubbleElement=Co.svgElement("path"),this._svgElement=i.appendChild(Co.svgElement("svg",{class:Kg},this._bubbleElement)),this._containerElement=Co.htmlElement("div"),this._containerElementNode=new so.Node(this._containerElement),e.leftAccessory&&(this._leftAccessoryBackgroundColor=n(e.leftAccessory),this._leftAccessory=o(e.leftAccessory,!this._rtl&&this._ignoreCalloutCornerRadiusForLeftAccessory),this._containerElement.appendChild(this._leftAccessory)),this._containerContentElement=this._containerElement.appendChild(Co.htmlElement("div")),this._containerContentElement.className=Jg,e.rightAccessory&&(this._rightAccessoryBackgroundColor=n(e.rightAccessory),this._rightAccessory=o(e.rightAccessory,this._rtl&&this._ignoreCalloutCornerRadiusForLeftAccessory),this._containerElement.appendChild(this._rightAccessory)),(this._leftAccessoryBackgroundColor||this._rightAccessoryBackgroundColor)&&(this._calloutId=s_(),this._linearGradientElement=Co.svgElement("linearGradient",{id:this._calloutId}),this._svgElement.appendChild(Co.svgElement("defs",this._linearGradientElement))),e.contentElement?this._setContentElement(e.contentElement):(this._containerElementNode.classList.add(Yg),e.rtl&&(this._containerContentElement.className+=" "+e_)),i.appendChild(this._containerElement)),e.position&&this.setPosition(e.position),this._node.wantsHardwareCompositing=!0}function o_(t,e,i){const n=17*e,o=13*e,s=t.width/2-n,a=10*e,r=12*e;return"M0,10.5c0,-6.9197181400000005 3.5826363,-10.5 10.5,-10.5h"+t.width+"c6.9173637,0 "+"10.5,"+Pg+" "+"10.5,"+"10.5v"+t.height+"c0,6.9197181400000005 "+-Og+","+"10.5 "+"-10.5,"+"10.5h"+(-i-s)+"c"+-a+",0 "+-r+","+o+" "+-n+","+o+"c"+(r-n)+",0 "+(a-n)+","+-o+" "+-n+","+-o+"h"+(i-s)+"c"+"-6.9173637,0 "+"-10.5,"+-Pg+" "+"-10.5,"+"-10.5z"}function s_(){const t=Math.random().toString(36).substr(2);return document.getElementById(t)?s_():t}n_.prototype=p(Su,n_,{_tailShift:0,get node(){return this._node},get boundingRect(){const t=this._node.position;return new Bi(t.x,t.y,this._node.size.width,this._node.size.height)},delegate:null,willMoveToMap:function(){this._node.transform=(new Bn).scale(0)},setAnchorOffset:function(t){this._anchorOffset=t?new window.DOMPoint(t.x,t.y):new window.DOMPoint},containsElement:function(t){if(t===this._svgElement)return!1;if(this._containerElement.contains(t))return!0;if(!Co.supportsShadowDOM||!this.isCustomCallout())return!1;const e=this.customOrContentElement.assignedNodes()[0];return!!e&&e.contains(t)},isCustomCallout:function(){return!!this.customOrContentElement},get customOrContentElement(){return this._customElement||this._contentElement},get customLeftAccessory(){if(this._leftAccessory)return this._leftAccessory.firstChild.firstChild},get customRightAccessory(){if(this._rightAccessory)return this._rightAccessory.firstChild.firstChild},updateInfo:function(t,e){if(this.isCustomCallout())return!0;if(!t||!t.title)return!1;this._containerContentElement.innerHTML="",this._containerElement.style.width="",this._containerContentElement.classList.add(Xg),this._containerContentElement.appendChild(Co.htmlElement("div",{class:Hg,dir:"auto"},t.title)),t.subtitle?(this._containerContentElement.appendChild(Co.htmlElement("div",{class:jg,dir:"auto"},t.subtitle)),this._containerElementNode.classList.remove(Vg)):(this._containerElementNode.classList.add(Vg),this._containerElementNode.classList.toggle(qg,!this._leftAccessory&&!this._rightAccessory)),this._updateAccessoryViews(),this._containerElement.className=this._containerElementNode.classList.toString();const i=this.delegate.sizeForElement(this._containerElement),n=t.map._impl.ensureVisibleFrame().size.width-2*e-this._extraWidth(this._ignoreCalloutCornerRadiusForLeftAccessory);return i.width=u(i.width,74,u(n,74,373)),0!==this._accessoryHeight&&(i.height=Math.max(this._accessoryHeight,i.height)),this._updateSize(i,!1),this.updatePosition(),!0},shiftTailBy:function(t){if(this._customElement)return 0;const e=Math.max(0,(this._bubbleSize.width-74-Rg)/2);return this._tailShift=t<0?Math.min(e,-t):-Math.min(e,t),this._bubbleElement.setAttribute("d",o_(this._bubbleSize,this._tailScale,this._tailShift)),this._node.position=new Gi(this._node.position.x+this._tailShift,this._node.position.y),this._tailShift},animateIn:function(){if(!this.animates||this.animates&&this._customElement&&!this.appearanceAnimation)this._node.transform=new Bn;else{if(this._appearanceAnimationName)return this._node.transform=new Bn,void this.delegate.setAnimationForElement(this._containerElement,this._appearanceAnimation,this._appearanceAnimationName);this._scaleXOffset=-this._tailShift,this._scaleYOffset=this._node.size.height/2,this._scaleAnimationParameterIndex=0,this._scaleAnimationStartDate=Date.now(),ue.scheduleOnNextFrame(this)}},animateOut:function(t){!t&&this.visible?(this._scaleAnimationStartDate&&this._finishAnimatingScale(),this._fadeoutAnimationStartDate=Date.now(),ue.scheduleOnNextFrame(this)):this._node.remove()},mapNodeTintWasSet(t){},performScheduledUpdate:function(){this._scaleAnimationStartDate&&this._animateScale(),this._fadeoutAnimationStartDate&&this._animateFadeout(),this._tailAnimation&&this._animateTail(),this._anchorOffsetAnimation&&this._animateAnchorOffset()},didRemoveFromParent:function(){this.delegate.accessoryNodeDidRemove(this)},setSize:function(t){this._svgElement&&(this._svgElement.style.width=t.width+"px",this._svgElement.style.height=t.height+"px",this._svgElement.setAttribute("viewBox","-0.5 -0.5 "+t.width+" "+t.height)),Su.prototype.setSize.call(this,t)},_updateSize:function(t,e){const i=this._ignoreCalloutCornerRadiusForLeftAccessory,n=t.width-this.node.size.width-22;this._tailShift=Math.max(0,this._tailShift+Math.min(0,n)),this._containerElement.style.width=t.width+"px";const o=this._extraWidth(i),s=13*this._tailScale,a=22+s;t.width+=o;const r=t.height,l=(i?55:50)+s;t.height+=a,t.height-=Rg,t.height=e?t.height:Math.max(t.height,l);const h=e?Zg:Bg,c=(t.height-r-s)/2;this._containerElement.style.top=r/2+Math.max(h,c)+"px";const d=Gg.left,u=Gg.right;let p;this._containerElement.style.left=d+"px",this.setSize(t),this._bubbleSize=new Ui(t.width-22,t.height-22-s),this._bubbleElement.setAttribute("d",o_(this._bubbleSize,this._tailScale,this._tailShift)),this._leftAccessoryBackgroundColor&&(p=100*(this._leftAccessoryWidth+d)/t.width,this._updateAccessoryViewBackground(p,this._leftAccessoryBackgroundColor,Ng)),this._rightAccessoryBackgroundColor&&(p=100-100*(this._rightAccessoryWidth+u)/t.width,this._updateAccessoryViewBackground(p,Ng,this._rightAccessoryBackgroundColor))},_extraWidth:function(t){return t?Ug.left+Ug.right:Fg.left+Fg.right-Fg.content.left},_updateAccessoryViews:function(){if(this._accessoryHeight=0,this._leftAccessory){const t=this.delegate.sizeForElement(this._leftAccessory.children[0]);this._leftAccessoryWidth=(!this._rtl&&this._ignoreCalloutCornerRadiusForLeftAccessory?0:Rg)+t.width,this._accessoryHeight=t.height,this._leftAccessory.style.width=this._leftAccessoryWidth+"px",this._ignoreCalloutCornerRadiusForLeftAccessory&&!this._rtl&&(this._leftAccessory.style.height=this._leftAccessoryWidth+"px",this._leftAccessory.style.overflow="visible"),this._containerContentElement.style.marginLeft=this._leftAccessoryWidth+"px"}if(this._rightAccessory){const t=this.delegate.sizeForElement(this._rightAccessory.children[0]);this._rightAccessoryWidth=(this._rtl&&this._ignoreCalloutCornerRadiusForLeftAccessory?0:Rg)+t.width,this._accessoryHeight=Math.max(this._accessoryHeight,t.height),this._rightAccessory.style.width=this._rightAccessoryWidth+"px",this._ignoreCalloutCornerRadiusForLeftAccessory&&this._rtl&&(this._rightAccessory.style.height=this._rightAccessoryWidth+"px",this._rightAccessory.style.overflow="visible"),this._containerContentElement.style.marginRight=this._rightAccessoryWidth+"px"}},_updateAccessoryViewBackground:function(t,e,i){this._linearGradientElement.appendChild(Co.svgElement("stop",{offset:t+"%","stop-color":""+e})),this._linearGradientElement.appendChild(Co.svgElement("stop",{offset:t+"%","stop-color":""+i})),this._bubbleElement.style.fill="url(#"+this._calloutId+")"},_setContentElement:function(t){this._updateAccessoryViews(),this._contentElement=t,this._containerContentElement.appendChild(Co.htmlElement("div",t)),this._containerElementNode.classList.add(Qg),this._containerElement.className=this._containerElementNode.classList.toString();const e=this.delegate.sizeForElement(this._containerElement);e.height=Math.max(e.height,this._accessoryHeight),this._updateSize(e,!0)},_scaleAnimationParameters:[[8e3/60,30/249,Dg],[5e3/60,Dg,zg],[5e3/60,zg,1]],_animateScale:function(){const t=this._scaleAnimationParameters[this._scaleAnimationParameterIndex],e=t[0],i=t[1],n=t[2],o=Date.now(),s=Math.min((o-this._scaleAnimationStartDate)/e,1),a=i+(n-i)*s;if(this._node.transform=(new Bn).translate(this._scaleXOffset,this._scaleYOffset).scale(a).translate(-this._scaleXOffset,-this._scaleYOffset),1===s){if(++this._scaleAnimationParameterIndex,!(this._scaleAnimationParameterIndex<this._scaleAnimationParameters.length))return void this._finishAnimatingScale();this._scaleAnimationStartDate=o}ue.scheduleOnNextFrame(this)},_finishAnimatingScale:function(){delete this._scaleXOffset,delete this._scaleYOffset,delete this._scaleAnimationStartDate,delete this._scaleAnimationParameterIndex},_animateFadeout:function(){const t=(Date.now()-this._fadeoutAnimationStartDate)/100,e=Math.max(0,1-t);0!==e?(this._node.opacity=e,ue.scheduleOnNextFrame(this)):this._node.remove()},animateTailScale:function(t,e){const i=(new Date).getTime();e=e||0===e?e:500,this._tailAnimation={timeStart:i,timeEnd:i+e,valueStart:this._tailScale,valueEnd:t},this._animateTail()},_animateTail:function(){if(!this._tailAnimation)return;const t=(new Date).getTime(),e=this._tailAnimation.timeStart,i=this._tailAnimation.timeEnd,n=this._tailAnimation.valueStart,o=this._tailAnimation.valueEnd,s=i<=e?1:(t-e)/(i-e),a=Co.easeInOut(u(s,0,1)),r=Co.lerp(a,n,o),l=13*(r-this._tailScale);this._tailScale=r,this.setSize(new Ui(this.node.size.width,this.node.size.height+l)),this._bubbleElement.setAttribute("d",o_(this._bubbleSize,this._tailScale,this._tailShift)),t<i?ue.scheduleOnNextFrame(this):this._tailAnimation=null},animateAnchorOffset:function(t,e){const i=(new Date).getTime();e=e||0===e?e:500,this._anchorOffsetAnimation={timeStart:i,timeEnd:i+e,startX:this._anchorOffset.x,startY:this._anchorOffset.y,endX:t.x,endY:t.y},this._animateAnchorOffset()},_animateAnchorOffset:function(){if(!this._anchorOffsetAnimation)return;const t=(new Date).getTime(),e=this._anchorOffsetAnimation.timeStart,i=this._anchorOffsetAnimation.timeEnd,n=this._anchorOffsetAnimation.startX,o=this._anchorOffsetAnimation.endX,s=this._anchorOffsetAnimation.startY,a=this._anchorOffsetAnimation.endY,r=i<=e?1:(t-e)/(i-e),l=Co.easeInOut(u(r,0,1)),h=Co.lerp(l,n,o),c=Co.lerp(l,s,a);this._anchorOffset.x=h,this._anchorOffset.y=c,this.updatePosition(),t<i?ue.scheduleOnNextFrame(this):this._anchorOffsetAnimation=null},getCenterOffset:function(t){const e=13*this._tailScale,i=this._node.size;return new Gi(0,(e-i.height-(t?13:0))/2)}});const a_=n_,r_="mk-selection-accessory-badge",l_="mk-selection-accessory-badge-content",h_="mk-fade-out";const c_=class extends Su{constructor(t,{place:e={},muid:i,coordinate:n,title:o}){super(),this.style=Du.OpenInMaps,this.placeUrl=this._getPlaceUrl(e,i,n,o),this.delegate=t,this._node=new so.Node(Co.htmlElement("div",{class:r_}));const s=this._node.element;this._containerElement=Co.htmlElement("button",{role:"link",dir:"auto",type:"button",class:l_}),this.handleLinkClickedListener=t=>this._handleLinkClicked(),this._containerElement.addEventListener("click",this.handleLinkClickedListener),this._containerElementNode=new so.Node(this._containerElement),this._handleLocaleChangedListener=t=>this._handleLocaleChanged(t),Oi.addEventListener(Oi.Events.LocaleChanged,this._handleLocaleChangedListener),this._textElement=this._containerElement.appendChild(Co.htmlElement("span")),this._textElement.textContent=Oi.get("OpenInAppleMaps.Label"),s.appendChild(this._containerElement),this.setSize(this.delegate.sizeForElement(s)),this._node.wantsHardwareCompositing=!0,this.analyticsState={place_action_details:{businessID:e.muid||i}},this.delegate.placeCardDidReveal("SMALL",this.analyticsState)}get node(){return this._node}get boundingRect(){const t=this._node.position;return new Bi(t.x,t.y,this._node.size.width,this._node.size.height)}setPosition(t){t.y+=this._node.size.height,Su.prototype.setPosition.call(this,t)}willMoveToMap(){}setAnchorOffset(t){this._anchorOffset=t?new window.DOMPoint(t.x,t.y):new window.DOMPoint}containsElement(t){return!!this._containerElement.contains(t)}isCustomCallout(){return!1}updateInfo(t,e){return!0}shiftTailBy(){return 0}animateIn(){}animateOut(t){!t&&this.visible||this._node.remove(),this._containerElementNode.classList.add(h_),setTimeout((()=>this._node.remove()),500)}mapNodeTintWasSet(t){}didRemoveFromParent(){this.delegate.accessoryNodeDidRemove(this),Oi.removeEventListener(Oi.Events.LocaleChanged,this._handleLocaleChangedListener),this._containerElement.removeEventListener("click",this.handleLinkClickedListener)}_getPlaceUrl(t={},e,i,n){const o=new URLSearchParams;return(t.name||n)&&o.append("q",t.name||n),(t.muid||e)&&o.append("auid",t.muid||e),t.formattedAddress&&o.append("address",t.formattedAddress),i=t.coordinate||i,o.append("ll",`${i.latitude},${i.longitude}`),`https://maps.apple.com/?${o.toString()}`}_handleLinkClicked(){window.open(this.placeUrl,"_blank","noopener"),this.delegate.placeCardOpenInMapsClicked("SMALL",this.analyticsState)}_handleLocaleChanged(){this._textElement.textContent=Oi.get("OpenInAppleMaps.Label"),this.setSize(this.delegate.sizeForElement(this._containerElement))}animateTailScale(t,e){0}animateAnchorOffset(t,e){0}getCenterOffset(t){0}},d_="mk-selection-accessories",u_="mk-selected";class p_{constructor(t){this.delegate=t,this._oldCenterMode=!1,this.node=new so.Node(Co.htmlElement("div")),this.node.classList.add(d_),this._waitingForRegionChangeToEnd=0}get accessoryIsShown(){return!!this._accessory}getAccessoryBoundingRect(){if(this._accessory)return this._accessory.boundingRect}selectedAnnotationVisibilityDidChange(t){this._accessory?this._accessory.visible=t.visible:t.visible&&this.showAccessoryForAnnotation(t,!0)}isElementInAccessory(t){return!!this._accessory&&this._accessory.containsElement(t)}isElementInCustomCallout(t){return!!this._accessory&&this._accessory.isCustomCallout()&&this._accessory.node.element.contains(t)}showAccessoryForAnnotation(t,e){this.hideAccessory(t,e);const{showsSelectionAccessory:i,showsCallout:n,calloutDelegate:o,customCalloutElement:s,customCalloutContentElement:a}=this._canShowSelectionAccessoryForAnnotation(t);if(!i&&!n)return void t._impl.selectionAccessoryWillAppear(!1);t._impl.selectionAccessoryWillAppear(!0);let r=s;if(Co.supportsShadowDOM&&r){const t="mk-slot-"+Math.random().toString(32).substring(2,10);r.slot=t;const e=Co.htmlElement("slot");e.name=t,this.delegate.appendElementAssignedToSlot(r),r=e}if(n){const{ignoreCalloutCornerRadiusForLeftAccessory:e,leftAccessory:i,rightAccessory:n}=this._getCalloutPartElements(t,o);this._accessory=new a_(this,{customElement:r,contentElement:a,ignoreCalloutCornerRadiusForLeftAccessory:e,leftAccessory:this.delegate.rtl?n:i,rightAccessory:this.delegate.rtl?i:n,rtl:this.delegate.rtl})}else if(i){const e=t._impl.selectionAccessory.style;if(e===Du.OpenInMaps)this._accessory=new c_(this,{place:t._impl.place,muid:t._impl.muid,coordinate:t.coordinate,title:t.title});else if(e===Du.CompactCallout||e===Du.FullCallout){const i=e===Du.CompactCallout;this._accessory=new Ig(this,{place:t._impl.place,muid:t._impl.muid,uiStyle:i?"compact":"full",side:this._findSideForAccessorySize(i?Ig.DEFAULT_COMPACT_SIZE:Ig.DEFAULT_FULL_SIZE)||(this.delegate.rtl?"right":"left"),rtl:this.delegate.rtl})}else{0;const i=this._findSideForAccessorySize(Ig.DEFAULT_FULL_SIZE),n=this._findSideForAccessorySize(Ig.DEFAULT_COMPACT_SIZE),o=i?"full":"compact",s=i||n;s||e===Du.Callout?this._accessory=new Ig(this,{place:t._impl.place,muid:t._impl.muid,uiStyle:o,side:s||(this.delegate.rtl?"right":"left"),rtl:this.delegate.rtl}):this._accessory=new c_(this,{place:t._impl.place,muid:t._impl.muid,coordinate:t.coordinate,title:t.title})}}else 0;this._accessory.animates=!e&&(!o||"function"!=typeof o.calloutShouldAnimateForAnnotation||!!it(o.calloutShouldAnimateForAnnotation,o,[t],!0));const l=r&&this._accessory.animates&&o&&"function"==typeof o.calloutAppearanceAnimationForAnnotation?it(o.calloutAppearanceAnimationForAnnotation,o,[t],""):"";if(_(l,"string","[MapKit] calloutAppearanceAnimationForAnnotation() must return a string, but returned `"+l+"` instead."),this._accessory.appearanceAnimation=l,r){let e;o&&"function"==typeof o.calloutAnchorOffsetForAnnotation&&(e=it(o.calloutAnchorOffsetForAnnotation,o,[t,this._accessory.node.size]),f(e,window.DOMPoint,"[MapKit] calloutAnchorOffsetForAnnotation() must return a DOMPoint, but returned `"+e+"` instead.")),this._accessory.setAnchorOffset(e)}if(this.updateAccessoryInfo(t),t===this.delegate.userLocationAnnotation){0;const t=this.delegate.constructor.AccuracyRingOverlay.getMode(this.delegate.map.worldSize,100);if(this._oldCenterMode=t,t){const t=this._accessory.getCenterOffset(!0);this._accessory.animateAnchorOffset(t,-1),this._accessory.animateTailScale(0,-1)}else this._accessory.animateAnchorOffset(new Gi(0,0),-1),this._accessory.animateTailScale(1,-1)}this.updateAccessoryPositionWithTailShift(t,!1);const h=!e&&this._nudgeMapToShowAccessory();this._accessory.willMoveToMap(),this._accessory.node.classList.add(u_),this.node.addChild(this._accessory.node),this._accessory.appearanceAnimation&&this.node.element.appendChild(this._accessory.node.element),h||this._accessory.animateIn()}hideAccessory(t,e){t._impl.selectionAccessoryWillDisappear(),this._accessory&&(this._accessory.node.classList.remove(u_),this._accessory.animateOut(e),delete this._accessory)}updateCenterMode(){const t=this.delegate.selectedItem===this.delegate.userLocationAnnotation,e=this.delegate.constructor.AccuracyRingOverlay.getMode(this.delegate.map.worldSize,100),i=this._oldCenterMode!==e;if(this._oldCenterMode=e,this._accessory&&t&&i)if(this._accessory.animateTailScale(e?0:1),e){const t=this._accessory.getCenterOffset();t.y=t.y-this.delegate.userLocationAnnotation._impl._node.size.height/4,this._accessory.animateAnchorOffset(t)}else this._accessory.animateAnchorOffset(new Gi(0,0))}sizeForElement(t){return this.delegate.sizeForElement(t)}backgroundColorForElement(t){return this.delegate.backgroundColorForElement(t)}setAnimationForElement(t,e,i){return this.delegate.setAnimationForElement(t,e,i)}annotationPropertyDidChange(){}accessorySizeDidChange(t){this._nudgeMapToShowAccessory()}accessoryNodeDidRemove(t){Co.supportsShadowDOM&&(t.isCustomCallout()&&"slot"===t.customOrContentElement.localName&&this.delegate.removeElementAssignedToSlot(t.customOrContentElement),t.customLeftAccessory&&"slot"===t.customLeftAccessory.localName&&this.delegate.removeElementAssignedToSlot(t.customLeftAccessory),t.customRightAccessory&&"slot"===t.customRightAccessory.localName&&this.delegate.removeElementAssignedToSlot(t.customRightAccessory))}updateAccessoryPositionWithTailShift(t,e){if(this.delegate.selectedItem===t&&this._accessory)return this._accessory.setShown(t._impl.isShown()),this._accessory instanceof a_?this._accessory.setPosition(t._impl.positionForCallout()):this._accessory instanceof c_?this._accessory.setPosition(t._impl.positionForSelectionAccessory("bottom",4)):this._accessory.setPositionWithSide(t._impl.positionForSelectionAccessory(this._accessory.side,Ig.TAIL_DISTANCE_TO_ANCHOR),this._accessory.side),e?this.updateAccessoryTailShift(e):void 0}updateAccessoryInfo(t){this._accessory?this._accessory.updateInfo(t,12)||this.hideAccessory(t):this.showAccessoryForAnnotation(t)}updateAccessoryTailShift(t){if(!this._accessory)return!1;const e=t?this._accessory.boundingRect.pad(12):this._boundingRectForSelectedAnnotationAndAccessory().pad(12),i=this._totalMapNudgingTranslation(e,this.delegate.map.ensureVisibleFrame(),t),n=i.x,o=i.y,s=this._accessory.shiftTailBy(n);return 0!==n||0!==o?new Gi(-(n+s),-o):void 0}get tint(){return this.delegate.map.tint}mapNodeTintWasSet(t){this._accessory&&this._accessory.mapNodeTintWasSet(t)}mapRegionChangeWillStart(){this._waitingForRegionChangeToStart&&(this._nudgeStarted=!0,this._waitingForRegionChangeToEnd++)}mapRegionChangeDidEnd(){if(!this._waitingForRegionChangeToEnd)return;this._waitingForRegionChangeToEnd--;0!==this._waitingForRegionChangeToEnd&&this._nudgeMapToShowAccessory()?this._waitingForRegionChangeToEnd=1:(this._waitingForRegionChangeToEnd=0,this.updateAccessoryPositionWithTailShift(this.delegate.selectedItem,!0),this._accessory&&this._accessory.animateIn())}getMaximumSizeForAccessory(){if(!this.delegate.selectedItem)return void 0;const t=this.delegate.selectedItem._impl._node.size,e=this.delegate.map.ensureVisibleFrame().size.copy();return"left"===this._accessory.side||"right"===this._accessory.side?(e.width-=t.width+50+Ig.TAIL_LENGTH+Ig.TAIL_DISTANCE_TO_ANCHOR,e.height-=50):(e.width-=50,e.height-=t.height+50+Ig.TAIL_LENGTH+Ig.TAIL_DISTANCE_TO_ANCHOR),e}placeCardDidReveal(t,e){this.delegate.placeCardDidReveal(t,e)}placeCardOpenInMapsClicked(t,e){this.delegate.placeCardOpenInMapsClicked(t,e)}_findSideForAccessorySize(t){if(!this.delegate.selectedItem)return void 0;const e=this.delegate.selectedItem,i=e._impl._node,n=new Bi(i.position.x,i.position.y,i.size.width,i.size.height).round(),o=this.delegate.map.ensureVisibleFrame(),s=e._impl.positionForSelectionAccessory("left",Ig.TAIL_DISTANCE_TO_ANCHOR).y,a=n.minX()-o.minX(),r=o.maxX()-n.maxX();if(s+t.height/2<o.maxY()&&s-t.height/2>o.minY()){const e=t.width<a,i=t.width<r;if(e&&i)return a===r?this.delegate.rtl?"right":"left":a>r?"left":"right";if(e)return"left";if(i)return"right"}const l=n.minY()-o.minY();if(t.height<l)return"top";const h=o.maxY()-n.maxY();return t.height<h?"bottom":o.size.width-n.size.width>t.width+Ig.TAIL_LENGTH+Ig.TAIL_DISTANCE_TO_ANCHOR?a>=r?"left":"right":o.size.height-n.size.height>t.height+Ig.TAIL_LENGTH+Ig.TAIL_DISTANCE_TO_ANCHOR?l>=h?"top":"bottom":null}_canShowSelectionAccessoryForAnnotation(t){const e=t._impl.place;if(t._impl.selectionAccessory&&(e&&e.name&&e.coordinate||t.title&&t._impl.muid&&t.coordinate))return t._impl.canShowSelectionAccessory()?"CN"!==kt.countryCode||kt.customUiBaseUrl?{showsSelectionAccessory:!0}:(console.warn("[MapKit] PlaceSelectionAccessory is not supported in China yet."),{showsSelectionAccessory:!1,showsCallout:!1}):{showsSelectionAccessory:!1,showsCallout:!1};if(!t._impl.canShowCallout())return{showsSelectionAccessory:!1,showsCallout:!1};const i=t._impl.callout;if(i&&"function"==typeof i.calloutShouldAppearForAnnotation&&!it(i.calloutShouldAppearForAnnotation,i,[t],!0))return{showsSelectionAccessory:!1,showsCallout:!1};let n;let o;i&&"function"==typeof i.calloutElementForAnnotation&&(n=it(i.calloutElementForAnnotation,i,[t]),q(n,"[MapKit] calloutElementForAnnotation() must return a DOM element, but returned `"+n+"` instead."));let s=!1;if(!n){if(s=i&&"function"==typeof i.calloutContentForAnnotation,s&&(o=it(i.calloutContentForAnnotation,i,[t]),q(o,"[MapKit] contentElementForAnnotation() must return a DOM element, but returned `"+o+"` instead."),Co.supportsShadowDOM)){const t="mk-slot-"+Math.random().toString(32).substring(2,10);o.slot=t;const e=Co.htmlElement("slot");e.name=t,this.delegate.appendElementAssignedToSlot(o),o=e}if(!s&&!t.title)return{showsSelectionAccessory:!1,showsCallout:!1}}return{showsSelectionAccessory:!1,showsCallout:!0,calloutDelegate:i,customCalloutElement:n,customCalloutContentElement:o}}_getCalloutPartElements(t,e){let i;const n=e&&"function"==typeof e.calloutLeftAccessoryForAnnotation;if(n&&(i=it(e.calloutLeftAccessoryForAnnotation,e,[t]),q(i,"[MapKit] calloutLeftAccessoryForAnnotation() must return a DOM element, but returned `"+i+"` instead."),Co.supportsShadowDOM)){const t="mk-slot-"+Math.random().toString(32).substr(2,8);i.slot=t;const e=Co.htmlElement("slot");e.name=t,this.delegate.appendElementAssignedToSlot(i),i=e}let o;const s=e&&"function"==typeof e.calloutRightAccessoryForAnnotation;if(s&&(o=it(e.calloutRightAccessoryForAnnotation,e,[t]),q(o,"[MapKit] calloutRightAccessoryForAnnotation() must return a DOM element, but returned `"+o+"` instead."),Co.supportsShadowDOM)){const t="mk-slot-"+Math.random().toString(32).substring(2,10);o.slot=t;const e=Co.htmlElement("slot");e.name=t,this.delegate.appendElementAssignedToSlot(o),o=e}const a=t._impl.ignoreCalloutCornerRadiusForLeftAccessory&&!n&&!s;return!n&&t._impl.canvasForCalloutAccessory&&(i=t._impl.canvasForCalloutAccessory()),{ignoreCalloutCornerRadiusForLeftAccessory:a,leftAccessory:i,rightAccessory:o}}_boundingRectForSelectedAnnotationAndAccessory(){const t=this.getAccessoryBoundingRect(),e=this.delegate.selectedItem._impl.position(),i=Math.min(t.minX(),e.x),n=Math.min(t.minY(),e.y),o=Math.max(t.maxX(),e.x)-i,s=Math.max(t.maxY(),e.y)-n;return new Bi(i,n,o,s)}_translationToFitInFrame(t,e){const i={x:0,y:0};return(t.maxX()>e.maxX()||t.minX()<e.minX()||t.maxY()>e.maxY()||t.minY()<e.minY())&&(i.x=t.minX()<e.minX()?t.minX()-e.minX():t.maxX()>e.maxX()?t.maxX()-e.maxX():0,i.y=t.minY()<e.minY()?t.minY()-e.minY():t.maxY()>e.maxY()?t.maxY()-e.maxY():0),i}_totalMapNudgingTranslation(t,e,i){const n=this._translationToFitInFrame(t,e),o=this.delegate.map.getControlBounds(),s=e.midX(),a=e.midY();let r=0,l=0;return t=m_(t,n.x,n.y),o.forEach((function(e){if(t.minX()<e.maxX()&&t.maxX()>e.minX()&&t.minY()<e.maxY()&&t.maxY()>e.minY()){if(r+=e.maxX()<s?t.minX()-e.maxX():t.maxX()-e.minX(),l+=e.maxY()<a?t.minY()-e.maxY():t.maxY()-e.minY(),i)return;0!==l&&Math.abs(r)>Math.abs(l)?r=0:l=0,t=m_(t,r,l)}}),this),n.x+=r,n.y+=l,n}_nudgeMapToShowAccessory(){if(this.delegate.map.cameraIsMoving)return this._waitingForRegionChangeToEnd++,!0;if(!this.delegate.selectedItem||!this.delegate.selectedItem._impl.isShown())return!1;const t=this.updateAccessoryPositionWithTailShift(this.delegate.selectedItem,!0);if(!t)return!1;this._waitingForRegionChangeToStart=!0,this.delegate.map.translateCameraAnimated(t,!0);const e=this._nudgeStarted;return delete this._nudgeStarted,this._waitingForRegionChangeToStart=!1,e}}function m_(t,e,i){return new Bi(t.origin.x-e,t.origin.y-i,t.size.width,t.size.height)}const g_=hi.MapRect,__="mk-annotation-container",f_="mk-annotations",y_="mk-dragging",v_="mk-selected",w_="mk-lifted",b_="mk-text-zoom";let C_=null;function k_(t){Xc.call(this,t),this._pendingAnnotations=[],this._mapFeatureAnnotationController=new Hm(this),this._clustersController=new lg(this),Oi.activeLocale&&(this._rtl=Oi.activeLocale.rtl),this._node=new so.Node(Co.htmlElement("div",{class:__})),Oi.activeLocale&&this._node.element.setAttribute("lang",Oi.localeId),this._shadowDOMSlotController=new gg(this._node);const e=Co.htmlElement("div",{class:f_});this._sceneGraphNode=new cg(e),this._shadowRootNode=Co.addShadowRootChild(this._node,kt.shadowDOMMode,':host(.mk-annotation-container.mk-dragging) ::selection,div.mk-annotations ::selection{background:0 0}.mk-invisible{opacity:0;pointer-events:none}.mk-hidden{display:none}div.mk-annotations,div.mk-annotations>div,div.mk-selection-accessories,div.mk-style-helper{position:absolute;top:0;left:0}.mk-selected{z-index:1}.mk-lifted{z-index:2}.mk-callout,.mk-selection-accessory{position:absolute;top:0;left:0;pointer-events:auto;-webkit-user-select:auto;-moz-user-select:text;-ms-user-select:text}:host(.mk-annotation-container) .mk-selection-accessory,:host(.mk-annotation-container) .mk-selection-accessory-badge{font:16px sans-serif;--font-size-default:16}:host(.mk-dark-mode) .mk-callout,:host(.mk-dark-mode) .mk-selection-accessory{color:#fff}:host(.mk-annotation-container.mk-text-zoom) .mk-selection-accessory,:host(.mk-annotation-container.mk-text-zoom) .mk-selection-accessory-badge{font:initial}@supports (font:-apple-system-body) and (-webkit-touch-callout:default){:host(.mk-annotation-container.mk-text-zoom) .mk-selection-accessory,:host(.mk-annotation-container.mk-text-zoom) .mk-selection-accessory-badge{font:-apple-system-body;--font-size-default:17}}.mk-callout>*{position:absolute;top:0;left:0}svg.mk-bubble{display:block;width:100%;height:100%}svg.mk-selection-accessory-bubble{position:absolute;display:block;filter:drop-shadow(0 0 5px rgba(0, 0, 0, .3))}div.mk-callout-accessory{position:absolute;top:50%;transform:translateY(-50%);overflow:hidden}div.mk-callout-accessory-content{white-space:nowrap;position:relative;text-align:center;font-size:12px}div.mk-callout-accessory:first-child{left:0}div.mk-callout-accessory:last-child{right:0}div.mk-callout-accessory:first-child .mk-callout-accessory-content{padding-right:8px}div.mk-callout-accessory:last-child .mk-callout-accessory-content{padding-left:8px}div.mk-standard{font-family:"-apple-system",BlinkMacSystemFont,"Helvetica Neue",Helvetica,Arial,sans-serif;box-sizing:border-box;position:relative}:host(.mk-annotation-container) .mk-standard-content{font:16px sans-serif;--font-size-default:16}:host(.mk-annotation-container.mk-text-zoom) .mk-standard-content{font:initial}@supports (font:-apple-system-body) and (-webkit-touch-callout:default){:host(.mk-annotation-container.mk-text-zoom) .mk-standard-content{font:-apple-system-body;--font-size-default:17}}div.mk-selection-accessory-content{box-sizing:border-box;position:relative;overflow:auto;color-scheme:light;top:0;left:0;border-radius:18px}div.mk-selection-accessory-content.mk-rtl{direction:rtl}.mk-ui-style-compact div.mk-selection-accessory-content{overflow:hidden}:host(.mk-dark-mode) div.mk-selection-accessory-content{color-scheme:dark}:host(.mk-panning) div.mk-selection-accessory-content{pointer-events:none}.mk-ui-style-compact div.mk-selection-accessory-content>div{width:243px}div.mk-custom-content,div.mk-standard{transform:translateY(-50%)}div.mk-standard .mk-callout-content>div{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}div.mk-standard .mk-callout-content{padding:0 4px}.mk-callout-content.mk-rtl{direction:rtl}.mk-callout-content.mk-rtl *{text-align:right}div.mk-callout-accessory:first-child+.mk-callout-content{padding-left:8px}div.mk-standard .mk-callout-content:nth-last-child(2){padding-right:8px}div.mk-standard .mk-title{font-size:calc(100% * 17 / var(--font-size-default));font-family:"-apple-system",BlinkMacSystemFont,"Helvetica Neue",Helvetica,Arial,sans-serif;font-weight:500;color:#000;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;letter-spacing:.025em}:host(.mk-dark-mode) div.mk-standard .mk-title{color:#fff}div.mk-standard .mk-subtitle{font-size:calc(100% * 13 / var(--font-size-default));font-family:"-apple-system",BlinkMacSystemFont,"Helvetica Neue",Helvetica,Arial,sans-serif;color:rgba(0,0,0,.7);letter-spacing:.025em}:host(.mk-dark-mode) div.mk-standard .mk-subtitle{color:rgba(255,255,255,.7)}svg.mk-bubble path{fill:#fff;stroke:rgba(0,0,0,.2)}svg.mk-selection-accessory-bubble path{fill:#efefef;stroke:rgb(239,239,239,.7);stroke-width:2px}:host(.mk-dark-mode) svg.mk-bubble path{fill:#3e3e3e;stroke:rgba(0,0,0,.5)}:host(.mk-dark-mode) svg.mk-selection-accessory-bubble path{fill:#363636;stroke:rgb(54,54,54,.7);stroke-width:2px}.mk-selection-accessory-loading{display:block;width:100%;height:100%}.mk-selection-accessory-failed{display:flex;height:100%;align-items:center;justify-content:center;color:#000;opacity:.55;font-family:"-apple-system-font","Helvetica Neue",Helvetica,Arial,sans-serif}:host(.mk-dark-mode) .mk-selection-accessory-failed{color:#fff}.mk-selection-accessory-failed .mk-failed-labels{padding:0 20px}.mk-ui-style-compact .mk-selection-accessory-failed .mk-failed-labels{flex-grow:1}.mk-selection-accessory-failed p{margin:0;font-size:calc(100% * 12 / var(--font-size-default));font-weight:400}.mk-ui-style-full .mk-selection-accessory-failed p{margin:2px 0;text-align:center}.mk-selection-accessory-failed p:first-child{font-size:calc(100% * 14 / var(--font-size-default));font-weight:500}.mk-ui-style-compact .mk-selection-accessory-failed p:first-child{margin-top:10px}.mk-ui-style-compact .mk-selection-accessory-failed p:last-child{margin-bottom:10px}.mk-ui-style-full .mk-selection-accessory-failed p:first-child{margin-top:60px}.mk-ui-style-full .mk-selection-accessory-failed p:last-child{margin-bottom:60px}.mk-selection-accessory-badge-content{cursor:pointer;padding:4px 8px;font-size:calc(100% * 13 / var(--font-size-default));font-family:13px "-apple-system-font",HelveticaNeue-Medium,Helvetica,Arial,sans-serif;font-weight:500;border:1px solid rgba(0,0,0,.1);border-radius:13px;color:#007aff;background-color:#fff;box-shadow:0 0 5px 0 rgba(0,0,0,.3);animation:fade-in .5s}.mk-selection-accessory-badge-content.mk-fade-out{transition:visibility .5s,opacity .5s;opacity:0;visibility:hidden}.mk-selection-accessory-badge-content span{opacity:.8}.mk-selection-accessory-badge-content:hover span{opacity:1}.mk-selection-accessory-badge-content:active{background-color:#e5e5e5}.mk-selection-accessory-badge-content:focus-visible{outline:0;background-color:#cce5ff;box-shadow:0 0 5px 0 rgba(0,0,0,.3),0 0 0 2px #007cff}.mk-selection-accessory-badge-content:active:focus-visible{background-color:#7fbdff}@keyframes fade-in{from{opacity:0}to{opacity:1}}:host(.mk-dark-mode) .mk-selection-accessory-badge-content{color:#0a84ff;background-color:#363636}:host(.mk-dark-mode) .mk-selection-accessory-badge-content:active{background-color:#2a2a2a}:host(.mk-dark-mode) .mk-selection-accessory-badge-content:focus-visible{background-color:#0c3159}:host(.mk-dark-mode) .mk-selection-accessory-badge-content:active:focus-visible{color:#64b1ff;background-color:#0366cf}@supports ((backdrop-filter:blur(30px)) or (-webkit-backdrop-filter:blur(30px))){.mk-selection-accessory-badge-content{-webkit-backdrop-filter:blur(30px);backdrop-filter:blur(30px);background-color:rgba(255,255,255,.75)}.mk-selection-accessory-badge-content:active{background-color:rgba(229,229,229,.6)}.mk-selection-accessory-badge-content:focus-visible{background-color:rgba(204,229,255,.6)}.mk-selection-accessory-badge-content:active:focus-visible{background-color:rgb(127,189,255,.6)}:host(.mk-dark-mode) .mk-selection-accessory-badge-content{background-color:rgba(18,18,18,.6)}:host(.mk-dark-mode) .mk-selection-accessory-badge-content:active{background-color:rgba(42,42,42,.6)}:host(.mk-dark-mode) .mk-selection-accessory-badge-content:focus-visible{background-color:rgba(12,49,89,.6)}:host(.mk-dark-mode) .mk-selection-accessory-badge-content:active:focus-visible{background-color:rgb(3,102,207,.6)}}',kt.nonce),this._annotationsNode=this._shadowRootNode.addChild(new so.Node(e)),this._selectionAccessoryController=new p_(this),this._shadowRootNode.addChild(this._selectionAccessoryController.node),this._styleHelper=new ug(this),this._shadowRootNode.addChild(new so.Node(this._styleHelper.element)),this._annotationDraggingMapPanningController=new bu(t),this.textZoom=t.textZoom}k_.Annotation=Xu,k_.prototype=p(Xc,k_,{itemConstructor:Xu,itemName:"annotation",capitalizedItemName:"Annotation",_rtl:!1,_selectionDistance:Math.pow(Xc.prototype._selectionDistance,2),get sceneGraphNode(){return this._sceneGraphNode},isItemExposed:function(t){return t!==this._userLocationAnnotation&&!t.memberAnnotations},_userLocationAnnotation:null,get map(){return this._map},get userLocationAnnotation(){return this._userLocationAnnotation},get dragging(){return!!this._draggedAnnotation},get rtl(){return this._rtl},set rtl(t){this._rtl!==t&&(this._rtl=t,this._selectedItem&&this._selectionAccessoryController.accessoryIsShown&&this._selectionAccessoryController.showAccessoryForAnnotation(this._selectedItem,!0))},get textZoom(){return this._node.classList.contains(b_)},set textZoom(t){this._node.classList.toggle(b_,t)},preAddedAnnotation:function(t){if(!t._impl.updatedPosition())return!1;const e=!t.map,i=Co.supportsShadowDOM&&this._annotationsNode&&t._impl.renderedByDOMElement&&!t.element.parentNode;return i&&this._shadowDOMSlotController.appendAssignedElement(t.element,!1),e&&t._impl.setDelegate(this),e||i},resetAnnotation:function(t){Co.supportsShadowDOM&&this._annotationsNode&&t._impl.renderedByDOMElement&&t.element.parentNode&&this._shadowDOMSlotController.removeAssignedElement(t._impl.elementInAnnotationDOM,!1),-1===this._items.indexOf(t)&&delete t._impl.delegate},addItems:function(t){t=Xc.prototype.addItems.call(this,t);if(this._shouldAnnotationBePending())return t;t.sort((function(t,e){return e.coordinate.latitude-t.coordinate.latitude}));const e=this._map.camera.toMapRect(),i=e.size.width,n=e.size.height,o=e.origin.x-i,s=o+3*i,a=e.origin.y-n,r=a+3*n;let l=0;t.forEach((function(t){if(t._impl.doesAnimate()&&t.visible){t._impl.x+(t._impl.x<o?1:0)<=s&&t._impl.y>=a&&t._impl.y<=r&&(t._impl.delayRank=l,++l)}}));const h=Math.min(50*l,3e3),c=0===l?0:h/l;return t.forEach((function(t){t._impl.delayMs=t._impl.delayRank*c,delete t._impl.delayRank}),this),t},addWaitingAnnotations:function(t){const e="function"==typeof t;this._waitingAnnotations?(e&&(this._completionCallback=t),window.clearTimeout(this._tileLoadingTimeout),delete this._tileLoadingTimeout,this._waitingAnnotations.forEach((function(t){t.map&&this._addAnnotationWaitingForTiles(t,!1,!e)}),this),this._updateSceneGraph(),delete this._waitingAnnotations,ue.scheduleOnNextFrame((()=>this._checkCompletion()))):e&&t()},annotationsInMapRect:function(t){f(t,g_,"[MapKit] Map.annotationsInMapRect expects a MapRect as its argument, got `"+t+"` instead.");const e=c(t.origin.x,1),i=e+t.size.width,n=t.origin.y,o=n+t.size.height;return this._items.filter((function(t){if(!this.isItemExposed(t))return!1;const s=t._impl.x+(t._impl.x<e?1:0),a=t._impl.y;return s>=e&&s<=i&&a>=n&&a<=o}),this)},removeItem:function(t){return t===this._userLocationAnnotation?(console.warn("[MapKit] Map.removeAnnotation: the user location annotation cannot be removed. Set showsUserLocation to false instead."),t):Xc.prototype.removeItem.call(this,t)},removeUserLocationAnnotation:function(){this._userLocationAnnotation&&(this._userLocationAnnotation._impl.removedFromMap(),Xc.prototype.removeAnyItem.call(this,this._userLocationAnnotation),delete this._userLocationAnnotation)},updateUserLocationAnnotation:function(t,e){if(!t.coordinate)return;const i=this._userLocationAnnotation||new k_.UserLocationAnnotation(t);if(this._userLocationAnnotation||(this._userLocationAnnotation=i,this.addItem(i,0)),t.stale)return delete this._lastGeocoderRequestCoordinate,delete this._lastUserLocationAnnotationSubtitle,void(i._impl.stale=!0);if(i._impl.stale=!1,i._impl.setCoordinate(t.coordinate),C_){if(!e&&this._lastGeocoderRequestCoordinate&&this._lastGeocoderRequestCoordinate.latitude===i._impl.coordinate.latitude&&this._lastGeocoderRequestCoordinate.longitude===i._impl.coordinate.longitude)return void(this._userLocationAnnotation.subtitle=this._lastUserLocationAnnotationSubtitle)}else C_=new k_.Geocoder;this._lastGeocoderRequestCoordinate=i._impl.coordinate.copy(),M_(C_,i,this)},mapSizeDidUpdate:function(){if(0===this._pendingAnnotations.length)return;const t=this._map.shouldWaitForTilesAndControls();this._pendingAnnotations.forEach((function(e){e._impl.isPending&&this._addAnnotationWaitingForTiles(e,t)}),this),this._updateSceneGraph(),this._pendingAnnotations=[]},updateVisibleAnnotations:function(){0!==this._items.length&&(this._updateVisibleAnnotations(this._items),this._updateSceneGraph())},startDraggingAnnotation:function(t,e){this._map.annotationDraggingWillStart(),this._draggedAnnotation=t,this._pendingDragStart=!0,t.selected&&this._selectionAccessoryController.hideAccessory(t),this._node.classList.add(y_),this._draggedAnnotation._impl.node.classList.add(w_),this._draggedAnnotation._impl.lift(),this._updateSceneGraph()},mapNodeTintWasSet:function(t){this._items.forEach((t=>{t._impl.updateLayout()})),this._selectionAccessoryController.mapNodeTintWasSet(t)},mapTypeDidChange:function(){this._mapFeatureAnnotationController.mapTypeDidChange()},fontSizeDidChange:function(){this._items.forEach((function(t){t._impl.updateLayout(!1,!0)}))},devicePixelRatioDidChange:function(){this._items.forEach((function(t){"function"==typeof t._impl.updateGlyphImages&&t._impl.updateGlyphImages()}))},styleHelperNodeDidMoveToParent:function(t){if(!Co.supportsShadowDOM)return;const e=t.assignedNodes?t:t.querySelector("slot"),i=e&&this._shadowDOMSlotController.getAssignedElement(e);e&&i&&i.parentNode&&0===e.assignedNodes().length&&(this._node.element.removeChild(i),this._node.element.appendChild(i))},getShadowDOMTargetFromEvent:function(t){if(this._shadowRootNode.domNode)return Co.getShadowDOMTargetFromEvent(this._shadowRootNode.domNode,t)},performScheduledUpdate:S_,addedItem:function(t,e){for(const e of t._impl.getMuidList())this.map.setPoiFiltered(e,!0);Xc.prototype.addedItem.call(this,t,e),t._impl.isWaiting=!0,e&&(t._impl.delayRank=0);const i=this._shouldAnnotationBePending(t);i&&(t._impl.isPending=!0,this._pendingAnnotations.push(t)),this._updateAnnotation(t),t._impl.selected&&this._didSelectAnnotation(t),i||this._addAnnotationWaitingForTiles(t,this._map.shouldWaitForTilesAndControls())},manyItemsAdded:function(t){this._updateSceneGraph()},removedItem:function(t,e){for(const e of t._impl.getMuidList())this.map.setPoiFiltered(e,!1);delete t._impl.wasCollided,"function"==typeof t._impl.node.remove&&(Co.supportsShadowDOM&&t._impl.node.parent&&this._shadowDOMSlotController.removeAssignedElement(t._impl.elementInAnnotationDOM,!t._impl.renderedByDOMElement),t._impl.node.remove()),Xc.prototype.removedItem.call(this,t),t._impl.labelRegion&&this._removeLabelRegionForAnnotation(t),e||this._updateVisibleAnnotations([t]),this._clustersController.removedAnnotation(t),t.memberAnnotations||this._updateCollisions(this._items)},manyItemsRemoved:function(t){this._updateVisibleAnnotations(this.items),this._updateSceneGraph()},manyItemsChanged:function(t){this._updateVisibleAnnotations(this.items),this._updateSceneGraph()},removedReferenceToMap:function(){this._userLocationAnnotation&&this._userLocationAnnotation._impl.removedFromMap()},pickableItemsCloseToPoint:function(t,e){const i=t.filter((function(t,i){const n=t._impl.distanceToPoint(e);return n<=this._selectionDistance&&(t._impl.distance=n,t._impl.index=i,!0)}),this).sort((function(t,e){return t._impl.distance-e._impl.distance||e._impl.index-t._impl.index}));return i.forEach((function(t){delete t._impl.distance,delete t._impl.index})),i},annotationDraggingDidChange:function(t){this._draggedAnnotation&&!this._draggedAnnotation._impl.shouldPreventDrag&&(this._pendingDragStart&&(delete this._pendingDragStart,this._draggedAnnotation._impl.draggingDidStart(),this._map.dispatchEventWithAnnotation(Ku.Events.DragStart,this._draggedAnnotation)),ue.scheduleASAP(this),this._draggedAnnotation._impl.setDraggingTranslationForMapFrameSize(t,this._map.ensureRenderingFrame().size),this._annotationDraggingMapPanningController.update(this._draggedAnnotation,this._draggedAnnotation._impl.node))},annotationDraggingDidEnd:function(t){this._draggedAnnotation&&(this._annotationDraggingMapPanningController.stop(),this._draggedAnnotation._impl.dropAfterDraggingAndRevertPosition(!t),this._draggedAnnotation._impl.node.classList.remove(w_),this._node.classList.remove(y_),this._map.annotationDraggingDidEnd(),this._map.dispatchEventWithAnnotation(Ku.Events.DragEnd,this._draggedAnnotation),delete this._draggedAnnotation,this._updateSceneGraph())},annotationPropertyDidChange:function(t,e){switch(e){case"selected":t.selected?this._didSelectAnnotation(t):this._didDeselectAnnotation(t);break;case"coordinate":if(!t._impl.updatedPosition())return;break;case"":case"displayPriority":case"collisionMode":case"clusteringIdentifier":case"padding":break;case"calloutOffset":0,this._selectionAccessoryController.updateAccessoryPositionWithTailShift(t,!0);break;case"selectionAccessoryOffset":default:0;break;case"visible":this._selectedItem===t&&this._selectionAccessoryController.selectedAnnotationVisibilityDidChange(t),t._impl.needsColliding=!0;break;case"draggable":this._draggedAnnotation!==t||t.draggable||this._map.stopDraggingAnnotation();break;case"title":case"subtitle":this._selectedItem===t&&(this._selectionAccessoryController.updateAccessoryInfo(t),this._selectionAccessoryController.updateAccessoryTailShift())}t.map&&t.map===this._map.public&&(this._annotationsDidChangeSinceLastCollision=!0,this._updateVisibleAnnotations([t]),this._updateSceneGraph(),this._updateLabelRegionForAnnotation(t))},mapForAnnotation:function(t){return this._map?this._map.public:null},sizeForElement:function(t){if(this._map.isRooted())return this._styleHelper.sizeForElement(t)},backgroundColorForElement:function(t,e){return this._styleHelper.backgroundColorForElement(t,e)},setAnimationForElement:function(t,e,i){return this._styleHelper.setAnimationForElement(t,e,i)},selectedAnnotationDidMoveToMap:function(t){this._updateSceneGraph(),this._selectionAccessoryController.showAccessoryForAnnotation(t)},supportsLabelRegions:function(){return this._map.supportsLabelRegions()},annotationFinishedAnimating:function(t){this._checkCompletion()},isElementInAccessory:function(t){return this._selectionAccessoryController.isElementInAccessory(t)},isElementInCustomCallout:function(t){return this._selectionAccessoryController.isElementInCustomCallout(t)},mapPanningDuringAnnotationDrag:S_,mapSupportForLabelRegionsChanged:function(){this._items.forEach((function(t){const e=t._impl;e.updateLayout(),delete e.labelRegion,this._updateLabelRegionForAnnotation(t)}),this)},containsMarkerAnnotation:function(){return this._items.some((t=>"string"==typeof t.glyphText))},paddingForAnnotation:function(t){let e=0,i=0;t.size?(e=t.size.width,i=t.size.height):console.warn("[MapKit] Computing padding for showItems() when an annotation was not yet added the DOM can cause the annotation to not be entirely visible. The `size` property of the annotation can be changed to ensure that it shows up properly.");const n={top:t._impl._anchorPoint.y,right:e-t._impl._anchorPoint.x,bottom:i-t._impl._anchorPoint.y,left:t._impl._anchorPoint.x};if(t===this.selectedItem&&this._selectionAccessoryController.accessoryIsShown){const e=this._selectionAccessoryController.getAccessoryBoundingRect(),i=t._impl.position();n.top=Math.max(n.top,i.y-e.minY()),n.right=Math.max(n.right,e.maxX()-i.x),n.bottom=Math.max(n.bottom,e.maxY()-i.y),n.left=Math.max(n.left,i.x-e.minX())}return n},appendElementAssignedToSlot(t){this._shadowDOMSlotController.appendAssignedElement(t)},removeElementAssignedToSlot(t){this._shadowDOMSlotController.removeAssignedElement(t)},mapFeatureRegionCloseToPoint(t,e){if(!e.length)return;let i,n,o=1/0;for(const s of e){const e=new hi.MapPoint(s.position[0],s.position[1]);e.x<this.map.camera.minX()&&(e.x+=1);const a=this.map.camera.transformMapPoint(e);for(const e of s.rects){const r=e.size,l=a.x+e.offset[0],h=a.y+e.offset[1];if(l<t.x&&t.x<l+r[0]&&h<t.y&&t.y<h+r[1]){i=s;break}const c=l,d=c+r[0],u=c-t.x,p=d-t.x,m=u<=0&&p>=0?0:Math.min(Math.abs(u),Math.abs(p)),g=h,_=g+r[1],f=g-t.y,y=_-t.y,v=f<=0&&y>=0?0:Math.min(Math.abs(f),Math.abs(y)),w=m*m+v*v;o>w&&(o=w,n=s)}if(i)break;if(s.circles&&s.circles.length){const e=this.map.ensureVisibleFrame().size.height;for(const a of s.circles){const r=a.x,l=e-a.y,h=a.radius,c=Math.abs(t.x-r),d=Math.abs(t.y-l),u=c*c+d*d;if(u<h*h){i=s;break}o>u&&(o=u,n=s)}}if(i)break}return i||(n&&o<this._selectionDistance?n:void 0)},getMapFeatureAnnotationForRegion:function(t,e){return this._mapFeatureAnnotationController.getMapFeatureAnnotationForRegion(t,e)},mapFeatureDidSelect:function(t){this._mapFeatureAnnotationController.mapFeatureDidSelect(t)},mapRegionChangeWillStart(){this._selectionAccessoryController.mapRegionChangeWillStart()},mapRegionChangeDidEnd(){this._selectionAccessoryController.mapRegionChangeDidEnd()},localeChanged(){this._node.setAttribute("lang",Oi.localeId),this.rtl=Oi.activeLocale.rtl},placeCardDidReveal(t,e){this._map.annotationPlaceSelectionAccessoryDidReveal(t,e)},placeCardOpenInMapsClicked(t,e){this._map.annotationPlaceSelectionAccessoryOpenInMapsClicked(t,e)},_addAnnotationToMapAsync:function(t){this._addAnnotationToMap(t,!1),this._updateSceneGraph()},_addAnnotationToMap:function(t,e){if(this._shouldAnnotationBePending())return void(t._impl.isPending=!0);Co.supportsShadowDOM&&this._annotationsNode&&this._shadowDOMSlotController.appendAssignedElement(t.element,!t._impl.renderedByDOMElement),t._impl.willMoveToMap(t._impl.canAnimate&&!e),delete t._impl.timeout,delete t._impl.isWaiting,delete t._impl.canAnimate,delete t._impl.delayMs;const i=this._items.indexOf(t);this._annotationsNode&&this._annotationsNode.addChild(t._impl.node,i),t._impl.sceneGraphNode&&this._sceneGraphNode.addChild(t._impl.sceneGraphNode,i),this._updateAnnotation(t),t.selected&&this._selectionAccessoryController.showAccessoryForAnnotation(t),this._updateLabelRegionForAnnotation(t),t._impl.didMoveToMap()},_addAnnotationWaitingForTiles:function(t,e,i){if(Object.prototype.hasOwnProperty.call(t._impl,"canAnimate")||(t._impl.canAnimate=!t._impl.isPending),delete t._impl.isPending,e&&t!==this._userLocationAnnotation){if(!this._items.some((t=>t!==this._userLocationAnnotation&&t._impl.mayBeDrawn())))return void(this._waitingAnnotations?this._waitingAnnotations.push(t):(this._waitingAnnotations=[t],this._tileLoadingTimeout=window.setTimeout((()=>this.addWaitingAnnotations(h)),3e3)))}!i&&t._impl.doesAnimate()&&t._impl.delayMs>0?t._impl.timeout=window.setTimeout((()=>this._addAnnotationToMapAsync(t)),t._impl.delayMs):this._addAnnotationToMap(t,i)},_didDeselectAnnotation:function(t){t._impl.node.classList.remove(v_),this.selectedItem=null,this._selectionAccessoryController.hideAccessory(t),this._map.annotationSelectionDidChange(t),this._mapFeatureAnnotationController.annotationSelectionDidChange(t)},_didSelectAnnotation:function(t){t._impl.node.classList.add(v_),this.selectedItem=t,this._map.annotationSelectionDidChange(t),this._mapFeatureAnnotationController.annotationSelectionDidChange(t),t._impl.visible&&this._selectionAccessoryController.showAccessoryForAnnotation(t)},_shouldAnnotationBePending:function(){return!this._map.isRooted()},mapWasDestroyed:function(){Xc.prototype.mapWasDestroyed.call(this),this._annotationDraggingMapPanningController&&this._annotationDraggingMapPanningController.mapWasDestroyed(),this._clustersController.mapWasDestroyed(),this._mapWasDestroyed=!0},_updateLabelRegionForAnnotation:function(t){const e=t._impl;if(!e.shouldHideLabels)return;e.labelRegion||(e.labelRegion=this._map.createLabelRegion());const i=e.labelRegion;if(i){const t=e.node.size,n=t.width,o=t.height;i.x=null==e.visibleX?e.x:e.visibleX,i.y=1-e.y,i.width=n,i.height=o,i.xOffset=n/2-e._anchorPoint.x-e._anchorOffset.x,i.yOffset=e._anchorPoint.y+e._anchorOffset.y-o/2,this._map.updatedLabelRegion()}},_removeLabelRegionForAnnotation:function(t){this._map.unregisterLabelRegion(t._impl.labelRegion),delete t._impl.labelRegion},_updateVisibleAnnotations:function(t,e){e||this._deletePreviousPointForPickingItem();const i=this._userLocationAnnotation,n=this._map;if(i){0;const t=k_.AccuracyRingOverlay.getMode(n.worldSize);i._impl.isRingMode=t,this._selectionAccessoryController.updateCenterMode()}const o=n.camera.toRenderingMapRect(),s=o.size.width,a=Math.min(1.5*s,.5),r=o.midX(),l=o.size.height,h=o.minY()-l,c=h+3*l;t.forEach((function(t){if(t===this._draggedAnnotation&&this._annotationDraggingMapPanningController.panning)return;let e=NaN;const i=t._impl.y;if(s>0&&l>0&&i>=h&&i<=c){const i=t._impl.x,o=t.anchorOffset.x/n.worldSize;let s=a;for(let t=-1;t<=1;++t){const n=Math.abs(i-o+t-r);n<s&&(s=n,e=i+t)}}isNaN(e)?t._impl.setShown(!1):(t._impl.isShown()||t!==this._selectedItem||this._selectionAccessoryController.showAccessoryForAnnotation(t,!0),t._impl.setShown(!0),t._impl.setPosition(n.adjustMapItemPoint(n.camera.transformMapPoint(new Gi(e,i)))),t._impl.visibleX!==e&&(t._impl.visibleX=e,this._updateLabelRegionForAnnotation(t)))}),this),this._selectionAccessoryController.updateAccessoryPositionWithTailShift(this._selectedItem,!0),e||this._updateCollisions(t)},_updateCollisions:function(t){let e=!1;const i=this._items.filter((function(t){const i=t.visible&&t._impl.isShown(),n=i||t._impl.needsColliding;return delete t._impl.needsColliding,n&&(t.displayPriority<Xu.DisplayPriority.Required||t.clusteringIdentifier)&&(e=!0),n&&i&&!t.memberAnnotations}),this);if(e){const t=this._map;this._clustersController.collideAnnotations(i,t.zoomLevel,t.rotation,this._annotationsDidChangeSinceLastCollision)}this._annotationsDidChangeSinceLastCollision=!1},addCluster:function(t){let e="function"==typeof this._map.annotationForCluster?it(this._map._annotationForCluster,this._map.public,[t],null):t;return e&&e instanceof Xu||(console.warn("[MapKit] Expects Map.annotationForCluster to return an annotation."),e=t),e=this._clustersController.setRequiredClusterAnnotationProperties(e,t),this.addItem(e),e._impl.customCluster=e!==t,e._impl.updateLayout(!0),this._updateLabelRegionForAnnotation(e),e},willUpdateCollisions:function(){this._items.forEach((function(t){t._impl.wasOccluded=t._impl.occluded,t._impl.previousCluster=t._impl.cluster}))},didUpdateCollisions:function(){this._items.forEach((function(t){const e=t._impl;e.wasCollided||e.occluded||(e.wasCollided=!0),t.memberAnnotations&&t.memberAnnotations[0]._impl.cluster!==t&&(e.cluster=e.memberAnnotations[0]._impl.cluster),e.updateVisibility(e.occluded),e.occluded!==e.wasOccluded&&e.animateOcclusion(),delete e.previousCluster,e.shouldHideLabels&&(e.occluded||e.labelRegion?e.occluded&&e.labelRegion&&this._removeLabelRegionForAnnotation(t):this._updateLabelRegionForAnnotation(t))}),this),this._items.forEach((t=>{delete t._impl.wasOccluded})),this._updateVisibleAnnotations(this._items,!0),this._updateSceneGraph()},deselectClusterAnnotation:function(){this._selectedItem&&this._selectedItem.memberAnnotations&&(this._selectedItem.selected=!1)},_updateAnnotation:function(t){t._impl.updatedPosition()&&this._updateVisibleAnnotations([t])},_updateSceneGraph:function(){const t=this._selectedItem,e=this._draggedAnnotation,i=this._items.filter((function(i){return i._impl.isDrawn()&&i!==t&&i!==e})).map((t=>t._impl.sceneGraphNode));t&&t._impl.isDrawn()&&i.push(t._impl.sceneGraphNode),e&&e._impl.isDrawn()&&i.push(e._impl.sceneGraphNode),this._sceneGraphNode.children=i},_checkCompletion:function(){if(this._mapWasDestroyed)return;if(this._annotationsDidChangeSinceLastCollision=!0,this._updateVisibleAnnotations(this._items),this._updateSceneGraph(),!this._completionCallback)return;this._items.some((t=>!t._impl.isStable()))||"function"!=typeof this._completionCallback||(this._completionCallback(),delete this._completionCallback)}});const M_=pe((function(t,e,i){i._geocoderRequestId&&t.cancel(i._geocoderRequestId);const n=t.reverseLookup(e._impl.coordinate,(function(t,o){n===i._geocoderRequestId&&(delete i._geocoderRequestId,t?(console.error("[MapKit] Error getting address for user location: "+t.message),e.subtitle=null):o.results.length>0?i._lastUserLocationAnnotationSubtitle=e.subtitle=o.results[0].formattedAddress:e.subtitle=null)}));i._geocoderRequestId=n}),1e3);function S_(){if(!this._draggedAnnotation||this._mapWasDestroyed)return;const t=this._draggedAnnotation._impl.dispatchDraggingEvent();this._map.dispatchEventWithAnnotation(t.type,this._draggedAnnotation,{coordinate:t.coordinate})}const L_=["UserLocationAnnotation","AccuracyRingOverlay","Geocoder"];function A_(){let t=!0;for(let e=0;e<L_.length;e++){const i=L_[e];!k_[i]&&R.jsModules[i]?k_[i]=R.jsModules[i]:t=!1}t&&R.removeEventListener("load",A_)}R.addEventListener("load",A_),A_();const E_=k_,x_=hi.MapPoint,T_="mk-map-features-container",I_="mk-map-features";function R_(t){this.map=t,window.document&&(this.node=new so.Node(Co.htmlElement("div",{class:T_})),this._shadowRootNode=Co.addShadowRootChild(this.node,kt.shadowDOMMode,":host(.mk-map-features-container) .mk-map-features>div{position:absolute;top:0;left:0}",kt.nonce),this._featuresContainer=this._shadowRootNode.addChild(new so.Node(Co.htmlElement("div",{class:I_}))))}R_.prototype={constructor:R_,update:function(t,e){this._featuresContainer.children=[];for(let i=0;i<t.length;i++){const n=t[i];let o,s;const a=new x_(n.position[0],n.position[1]);a.x<e.minX()&&(a.x+=1);const r=e.transformMapPoint(a);if(n.rects&&n.rects.length){let t=1/0,e=0,i=1/0,a=0;for(const o of n.rects){const n=r.x+o.offset[0],s=n+o.size[0],l=r.y+o.offset[1],h=l+o.size[1];t>n&&(t=n),e<s&&(e=s),i>l&&(i=l),a<h&&(a=h)}o=new Ui(e-t,a-i),s=new Gi(t,i)}else if(n.circles&&n.circles.length){let t=1/0,e=0,i=1/0,a=0;const r=this.map.ensureVisibleFrame().size.height;for(const o of n.circles){const n=o.x-o.radius,s=o.x+o.radius,r=o.y-o.radius,l=o.y+o.radius;t>n&&(t=n),e<s&&(e=s),i>r&&(i=r),a<l&&(a=l)}o=new Ui(e-t,a-i),s=new Gi(t,r-a)}if(!o)continue;const l=new so.Node(Co.htmlElement("div",{"aria-label":n.title}));l.position=s,l.size=o,this._featuresContainer.addChild(l)}}};const O_=R_;function P_(t){No.call(this),this._annotation=t}P_.prototype=p(No,P_,{get position(){return this._annotation.nodePosition()}});const D_=P_;function z_(t){this._realAnnotation=t}function N_(t){ln.call(this),this._realAnnotation=t,this.annotation=new z_(t),this._renderer=new dp(this);const e=2*this.params.balloonRadius;this.size=new Ui(e,this.params.height+this.params.offset),this._renderer.isFallbackGlyphTextPending&&this._renderer.addPendingNode(this),this.needsDisplay=!0}z_.prototype={constructor:z_,glyphText:"",get glyphColor(){const t=this._realAnnotation.map;return t?om.DefaultGlyphColor[t._impl.currentColorScheme]:om.DefaultGlyphColor.light},isAppStyle:!1,isPlaceStyle:!1,balloonVisible:!0,get fillColor(){const t=this._realAnnotation.map;return t?om.DefaultColor[t._impl.currentColorScheme]:om.DefaultColor.light},get haloColor(){return null},useSquareBalloon:!1},N_.prototype=p(ln,N_,{enablesDefaultGlyphImage:!0,get position(){return this._realAnnotation.nodePosition()},frozen:!0,state:"default",params:Yp.Params.default,stringInfo:function(){return"ImageAnnotationFallbackNode"},freeze:function(){}});const F_=N_;const U_=function(t){function e(e,i,n){if(this._sceneGraphNode=new D_(this),t.call(this,e,i,t.div,n),!this.url)throw new Error("[MapKit] No URL for image of ImageAnnotation");this._waitingForImageSize=!this._userSetSize,this._setSceneGraphNode()}return e.prototype=p(t,e,{renderedByDOMElement:!1,get url(){return this._url},set url(t){this._pendingGlyphImage=t,Jp(t,(e=>{if(this._pendingGlyphImage!==t)return;if(delete this._pendingGlyphImage,!e)throw new Error("[MapKit] No URL for image of ImageAnnotation");const i=e.ratio,n=e.glyphImageUrl;this._ratio=i,this._url=t,this._setSceneGraphNode(),this._removeImageEventListener();(this._sceneGraphNode.image=Co.htmlElement("img",{src:n})).complete?this.updateSize():(this._userSetSize||(this._waitingForImageSize=!0),this._addImageEventListener())})),this._url=t},centerOffsetForSelectionAccessory(){return this._sceneGraphNode instanceof D_?t.prototype.centerOffsetForSelectionAccessory.call(this):new Gi(-this._sceneGraphNode.params.balloonRadius,-this._sceneGraphNode.params.balloonRadius)},positionForCallout:function(){if(this._sceneGraphNode instanceof D_)return t.prototype.positionForCallout.call(this);const e=this._node.size,i=new Gi(-e.width/2,0),n=this.nodePosition(),o=new Gi(0,1);return new Gi(n.x-i.x-o.x,n.y-i.y-o.y)},calculateNodePosition:function(){return this._sceneGraphNode instanceof D_?t.prototype.calculateNodePosition.call(this):new Gi(this._position.x-this._anchorPoint.x,this._position.y-this._anchorPoint.y)},handleEvent:function(e){switch(e.type){case"load":0,this._removeImageEventListener(),this._handleImageLoaded();break;case"error":0,this._removeImageEventListener(),this._handleImageError();break;default:return void t.prototype.handleEvent.call(this,e)}},resetNodeTransform:function(){this.sceneGraphNode.transform=new Zi},updateSize:function(){let e;if(this._waitingForImageSize=!1,this._sceneGraphNode instanceof D_){if(this._userSetSize)e=this._node.size;else{const t=this._sceneGraphNode.image;e=new Ui(t.naturalWidth/this._ratio,t.naturalHeight/this._ratio),this.setSize(e)}this._sceneGraphNode.size=e}else e=this._sceneGraphNode.size,this._userSetSize&&console.warn("[MapKit] Size set on the ImageAnnotation is removed."),this.setSize(e),this._userSetSize=!1;this._setElementSize(e),t.prototype.updateSize.call(this)},ConstructorOptions:Object.freeze(Object.assign({},t.prototype.ConstructorOptions,{url:"rw"})),willMoveToMap:function(){this._isMoving=this.doesAnimate()},canShowCallout:function(){return!this._waitingForImageSize&&t.prototype.canShowCallout.call(this)},_addImageEventListener:function(){this._sceneGraphNode.image.addEventListener("load",this),this._sceneGraphNode.image.addEventListener("error",this)},_removeImageEventListener:function(){this._sceneGraphNode.image&&(this._sceneGraphNode.image.removeEventListener("load",this),this._sceneGraphNode.image.removeEventListener("error",this))},_handleImageLoaded:function(){this.updateSize()},_handleImageError:function(){this._sceneGraphNode.image&&console.error("[MapKit] Could not load image for ImageAnnotation at URL: "+this._sceneGraphNode.image.src),this._setSceneGraphNodeToFallback(),this.updatePosition(),this.updateSize()},_setElementSize:function(t){this._element.style.width=t.width+"px",this._element.style.height=t.height+"px"},_setSceneGraphNode:function(){if(this._sceneGraphNode instanceof D_)return;const t=this._sceneGraphNode;this._sceneGraphNode=new D_(this),t.parent&&t.parent.replaceChild(this._sceneGraphNode,t)},_setSceneGraphNodeToFallback:function(){if(this._sceneGraphNode instanceof F_)return;this._removeImageEventListener();const t=this._sceneGraphNode;this._sceneGraphNode=new F_(this),t.parent&&t.parent.replaceChild(this._sceneGraphNode,t)}}),e},G_=U_(qu);function B_(t,e){Yo(this,B_)&&Object.defineProperty(this,"_impl",{value:new G_(this,t,e)})}B_.prototype=p(Xu,B_,{get url(){return this._impl._url},set url(t){this._impl.url=t}});const Z_={AnnotationsController:E_,MapFeaturesLayerController:O_,LayerItemsController:Xc,ItemCollection:dd,PlaceSelectionAccessory:zu,MapFeatureType:Um,mapkit:{MapFeatureType:Um,Annotation:Xu,PlaceAnnotation:Em,PlaceSelectionAccessory:zu,ImageAnnotation:B_,MarkerAnnotation:rm,MapFeatureAnnotation:Wm.prototype.constructor}},W_=tt,K_=Math.pow(2,21);function H_(t){const e=t.toMapPoint(),i=K_*Ze;return{x:Math.floor(e.x*i),y:Math.floor(e.y*i),z:21}}const j_={shift:function(t,e){const i=kt.locationShiftUrl;!function(t,e,i){0;new W_(e,{getDataToSend:function(){return t},loaderDidSucceed:function(t,e){if(e.status<200||e.status>=300)i(new Error("HTTP error:"+e.status));else try{i(null,JSON.parse(e.responseText))}catch(t){return void i(new Error("Failed to parse response: "+e.responseText))}},loaderDidFail:function(t,e){i(new Error("Network error"))}},{method:"POST",withCredentials:kt.withCredentials}).schedule()}(JSON.stringify({pixelPoint:H_(t)}),i,(function(t,i){t?e(new Error):i&&i.shiftedPixelPoint?e(null,function(t){function e(t){return t/K_/Ze}return new si(e(t.x),e(t.y)).toCoordinate()}(i.shiftedPixelPoint)):e(new Error)}))}},V_=j_,q_=hi.MapRect,Y_=hi.Coordinate,X_={Change:"user-location-change",Error:"user-location-error"};let $_=null;function J_(){this._location=null,this._coordinate=null,this._stale=!1,this._watchers=0,kt.addEventListener(kt.Events.Changed,this),kt.addEventListener(kt.Events.Error,this)}J_.prototype=p(T.EventTarget,J_,{Events:X_,get location(){return this._location},get coordinate(){return this._coordinate},get stale(){return this._stale},get mapAccuracyRadius(){const t=this.location;return!this.stale&&t.accuracy>0?t.accuracy:0},get isAvailable(){return window.navigator.geolocation&&"function"==typeof window.navigator.geolocation.watchPosition&&"function"==typeof window.navigator.geolocation.getCurrentPosition},getMapRect:function(){const t=this.location&&this.location.accuracy||0,e=this.coordinate.latitude,i=this.coordinate.toMapPoint(),n=t*hi.mapUnitsPerMeterAtLatitude(e);return new q_(i.x-n,i.y-n,2*n,2*n)},watch:function(){this._watchId||(window.navigator.geolocation.watchPosition?(nf(),this._watchId=window.navigator.geolocation.watchPosition(sf,rf),$_=setTimeout((function(){nf(),rf({code:3,message:"Timeout expired"})}),15e3)):console.warn("[MapKit] User location is unavailable."))},locate:function(t,e,i){window.navigator.geolocation.getCurrentPosition?ef&&this._watchId?of(ef,t,e):window.navigator.geolocation.getCurrentPosition((function(i){of(i,t,e)}),e,i):console.warn("[MapKit] User location is unavailable.")},addEventListener:function(){T.EventTarget.prototype.addEventListener.apply(this,arguments)&&++this._watchers},removeEventListener:function(){T.EventTarget.prototype.removeEventListener.apply(this,arguments)&&(--this._watchers,0===this._watchers&&this._watchId&&(window.navigator.geolocation.clearWatch(this._watchId),this._watchId=null))},handleEvent:function(t){switch(t.type){case kt.Events.Changed:case kt.Events.Error:if(Q_&&(ef=Q_,Q_=null),!ef)return;sf(ef)}},reset:function(){nf(),this._watchers=0,this._watchId=null,ef=null}});let Q_=null;const tf=new J_;let ef;function nf(){clearTimeout($_),$_=null}function of(t,e,i){if("AutoNavi"===kt.tileProvider){const n=new Y_(t.coords.latitude,t.coords.longitude);V_.shift(n,(function(n,o){if(n)return void(i&&i(n));const s={coords:{latitude:o.latitude,longitude:o.longitude}};"accuracy"in t.coords&&(s.coords.accuracy=t.coords.accuracy),e&&e(s)}))}else e&&e(t)}function sf(t){nf(),ef=t,kt.error?rf({code:4,message:"MapKit not initialized."}):kt.ready?!tf._stale&&tf._coordinate&&t.coords.latitude===tf._coordinate.latitude&&t.coords.longitude===tf._coordinate.longitude||of(t,af,rf):Q_=t}function af(t){tf._stale=!1,tf._location=t.coords,tf._coordinate=new Y_(t.coords.latitude,t.coords.longitude),tf.dispatchEvent(new lf(tf._coordinate,t.coords.floorLevel))}function rf(t){Q_=null,ef=null,tf._stale=!0,tf.dispatchEvent(new hf(t))}class lf extends T.Event{constructor(t,e){super(X_.Change),this.coordinate=t,this.floorLevel=e,this.timestamp=new Date}}class hf extends T.Event{constructor(t){super(X_.Error),this.code=t.code,this.message=t.message}}const cf=tf;function df(t){this._delegate=t,this._showsUserLocation=!1,this._tracksUserLocation=!1}df.prototype={constructor:df,get showsUserLocation(){return this._showsUserLocation},set showsUserLocation(t){!t||cf.isAvailable?(this._showsUserLocation=t,t?(cf.addEventListener(cf.Events.Change,this),cf.addEventListener(cf.Events.Error,this),cf.watch()):(cf.removeEventListener(cf.Events.Change,this),cf.removeEventListener(cf.Events.Error,this))):console.warn("[MapKit] User location is unavailable.")},get tracksUserLocation(){return this._tracksUserLocation},set tracksUserLocation(t){!t||cf.isAvailable?(this._tracksUserLocation=t,t?(cf.addEventListener(cf.Events.Change,this),cf.addEventListener(cf.Events.Error,this),cf.watch()):(cf.removeEventListener(cf.Events.Change,this),cf.removeEventListener(cf.Events.Error,this))):console.warn("[MapKit] User location is unavailable.")},get userLocation(){return cf},handleEvent:function(t){switch(t.type){case cf.Events.Change:this._handleUserLocationChange(t);break;case cf.Events.Error:this._handleUserLocationError(t)}},mapWasDestroyed:function(){delete this._delegate,cf.removeEventListener(cf.Events.Change,this),cf.removeEventListener(cf.Events.Error,this)},_handleUserLocationChange:function(t){cf.errorCode=0,this._delegate.userLocationDidChange(t)},_handleUserLocationError:function(t){cf.errorCode=t.code,this._delegate.userLocationDidError(t)}};const uf=df,pf=[],mf=function t(){const e=pf.length;if(e>0){for(let t=0;t<e;++t)ue.scheduleASAP(pf[t]);ue.scheduleOnNextFrame(t)}},gf={setIsAnimated:function(t,e){const i=pf.indexOf(t);e&&i<0&&(pf.push(t),1===pf.length&&ue.scheduleASAP(mf)),!e&&i>-1&&pf.splice(i,1)},getIsAnimated:function(t){return pf.indexOf(t)>-1}},_f=new Md({lineWidth:2,strokeColor:"white"}),ff=function(t,e){const i=cf.location,n=void 0===e?56:e,o=(i&&i.accuracy||0)<=3e4;return cf.getMapRect().size.width*t>=n&&o},yf=Co.lerp,vf=function(t,e,i){return u((t-e)/(i-e),0,1)},wf=function(){const t=cf.location,e=t&&t.accuracy||0;return e>3e4?0:e};function bf(t){const e=t.coordinate,i=wf();Xd.call(this,e,i,{style:_f}),gf.setIsAnimated(this,!0),this._isRingMode=!1,this._isShown=!1,this._fadeClock=0}bf.prototype=p(Xd,bf,{updateIsShown:function(t,e,i){const n=Date.now(),o=ff(e),s=o!==this._isRingMode?n:this._fadeClock,a=n-s<1e3,r=this._impl.shown&&(o||a);r!==this._isShown&&gf.setIsAnimated(this,r),this._impl.shown=r,this._fadeClock=s,this._isRingMode=o,this._isShown=r,this._mapRegion=t,this._worldSize=e,this._colorSchemeOrSatellite=i},performScheduledUpdate:function(){const t=Date.now(),e=cf.stale,i=this._mapRegion&&this._mapRegion.toMapRect(),n=i?i.size.width*this._worldSize:0,o=cf.getMapRect().size.width*this._worldSize,s=xn[cn],a=xn[hn],r=this._colorSchemeOrSatellite===cn?e?s.gray:s.blue:e?a.gray:a.blue;this.style.fillColor="rgb("+r.join(",")+")",this.style.strokeColor=this._colorSchemeOrSatellite===hn?"rgba("+s.gray3.join(",")+", 0.5)":"white";const l=vf(o,56,940),h=(e?.2:.14)*("satellite"===this._colorSchemeOrSatellite?2:1);this.style.fillOpacity=Math.pow(1-l,2)*h;const c=t-this._fadeClock,d=vf(c,0,1e3),u=this._isRingMode?d:1-d;this._impl.node.opacity=u;const p=vf(o,56,n),m=yf(p,2,2.5),g=yf(p,4,5),_=t%2e3/2e3,f=Co.easeInOut(1-Math.abs(2*_-1));this.style.lineWidth=yf(f,m,g)},updateForUserLocation:function(t){this.coordinate=cf.coordinate,this.radius=wf()}}),Object.defineProperties(bf,{getMode:{value:ff}});const Cf=bf;function kf(t){Lo.call(this,t),this.opacity=null,this.opacityTime=0}kf.prototype=p(Lo,kf,{draw:function(t){const e=this._node._annotation.stale,i=this._node._annotation.style,n=Date.now(),o=n-this.opacityTime,s=Math.min(o,500)/500,a=Co.lerp(s,1-this.opacity,this.opacity);if(a>0){const o=i.ANIMATION_HALF_DURATION_MS,s=n%i.ANIMATION_DURATION_MS,c=Co.easeInOut(s<o?1-s/o:(s-o)/o),d=Co.lerp(c,i.ANIMATION_SCALE_TO,i.ANIMATION_SCALE_FROM),u=t.globalAlpha,p=i.INNER_RADIUS*d,m=i.OUTER_RADIUS-p,g=p+m/2,_=i.TOTAL_RADIUS,f=i.TOTAL_RADIUS;t.save(),t.globalAlpha=a,t.beginPath(),t.arc(_,f,g,0,2*Math.PI),t.strokeStyle="rgb("+i.OUTER_FILL.join(",")+")",t.shadowColor="rgba("+i.SHADOW_COLOR.join(",")+")",t.shadowBlur=i.SHADOW_BLUR,t.lineWidth=m,t.stroke(),t.restore(),t.globalAlpha=a,t.beginPath(),t.arc(_,f,p,0,2*Math.PI),t.fillStyle=e?"rgb("+i.STALE_FILL.join(",")+")":(r=i.ANIMATION_FILL_FROM,l=i.ANIMATION_FILL_TO,h=c,"rgb("+r.map(((t,e)=>Math.round(t+(l[e]-t)*h))).join(", ")+")"),t.fill(),t.globalAlpha=u}var r,l,h}});const Mf=kf;function Sf(t){ln.call(this),this._annotation=t,this._renderer=new Mf(this)}Sf.prototype=p(ln,Sf,{stringInfo:function(){return"UserLocationAnnotationNode< "+(this._renderer.stale?"stale ":"live ")+(1!==this._renderer.opacity?`opacity: ${this._renderer.opacity} `:"")+">"},get size(){return this._annotation.node.size},get position(){return this._annotation.nodePosition()}});const Lf=Sf;function Af(t,e){const i=xn.default,n={INNER_RADIUS:8,OUTER_RADIUS:11,SHADOW_BLUR:10,TOTAL_RADIUS:0,OUTER_FILL:[255,255,255],STALE_FILL:i.gray2,SHADOW_COLOR:[0,0,0,.25],ANIMATION_DURATION_MS:3e3,ANIMATION_HALF_DURATION_MS:0,ANIMATION_SCALE_FROM:1,ANIMATION_SCALE_TO:.81,ANIMATION_FILL_FROM:i.blue,ANIMATION_FILL_TO:i.blue};n.TOTAL_RADIUS=n.OUTER_RADIUS+n.SHADOW_BLUR,n.ANIMATION_HALF_DURATION_MS=n.ANIMATION_DURATION_MS/2;const o=n.TOTAL_RADIUS,s=n.SHADOW_BLUR,a=window.DOMPoint;this.style=n,this.stale=!1,this._animationScheduler=gf,this._anchorOffset=new a(0,-o),this._calloutAnchorPoint=new a(-o,-s),qu.call(this,t,e.coordinate,qu.div),this._updateTitleAndSubtitleForLocale();const r=2*o;this.setSize(new Ui(r,r)),this._userSetSize=!0,this._sceneGraphNode=new Lf(this),this.shownPropertyWasUpdated(!0)}Af.prototype=p(qu,Af,{_collisionMode:qu.CollisionMode.None,renderedByDOMElement:!1,get coordinate(){return this._coordinate},set coordinate(t){var e,i;(e=this,i="_coordinate",Object.prototype.hasOwnProperty.call(e,i))?console.warn("[MapKit] The `coordinate` property of the user location annotation cannot be set."):this._coordinate=t.copy()},get draggable(){return!1},set draggable(t){console.warn("[MapKit] The `draggable` property of the user location annotation cannot be set.")},get size(){return this._node.size.copy()},set size(t){console.warn("[MapKit] The `size` property of the user location annotation cannot be set.")},get node(){return this._node},handleEvent:function(t){t.type===Oi.Events.LocaleChanged&&this._updateTitleAndSubtitleForLocale()},set isRingMode(t){this.enabled=!t;const e=this._sceneGraphNode._renderer,i=t?0:1;i!==e.opacity&&(e.opacity=i,e.opacityTime=Date.now())},shownPropertyWasUpdated:function(t){gf.setIsAnimated(this,t)},removedFromMap:function(){gf.setIsAnimated(this,!1),Oi.removeEventListener(Oi.Events.LocaleChanged,this)},setCoordinate:function(t){Object.getOwnPropertyDescriptor(qu.prototype,"coordinate").set.call(this,t)},performScheduledUpdate:function(){const t=this.map&&this.map._impl.tint,e=this.map&&this.map.mapType,i=xn[cn],n=xn[hn],o=xn[t]||xn.default,s=e===vn.Satellite||e===vn.Hybrid?"satellite":t;this.style.OUTER_FILL=s===hn?i.gray3:[255,255,255],this.style.STALE_FILL=s===cn?i.gray:n.gray2,this.style.ANIMATION_FILL_FROM=o.blue,this.style.ANIMATION_FILL_TO=o.blue,this.style.SHADOW_COLOR=[0,0,0,s===cn?.25:.3],this._sceneGraphNode.needsDisplay=!0},_updateTitleAndSubtitleForLocale:function(){this.title=Oi.get("Location.Title"),this.subtitle=Oi.get("Location.Subtitle")}});const Ef=Af;function xf(t){Object.defineProperty(this,"_impl",{value:new Ef(this,t)})}const Tf=function(){throw new TypeError("[MapKit] UserLocationAnnotation may not be constructed.")};xf.prototype=Tf.prototype=p(Xu,Tf,{set coordinate(t){this._impl.coordinate=t},get coordinate(){return this._impl.coordinate},get draggable(){return this._impl.draggable},set draggable(t){this._impl.draggable=t},get size(){return this._impl.size},set size(t){this._impl.size=t}});const If=xf;function Rf(t,e){Object.defineProperty(this,"_impl",{value:new Pm(t,e)})}Rf.prototype={constructor:Rf,get getsUserLocation(){return this._impl.getsUserLocation},set getsUserLocation(t){this._impl.getsUserLocation=t},get language(){return this._impl.language},set language(t){this._impl.language=t},cancel:function(t){return this._impl.cancel(t)}};const Of=Rf,Pf=hi.Coordinate,Df=["language","getsUserLocation"],zf=["language","region","coordinate","limitToCountries"],Nf=["language"];function Ff(t){t=v(t),this._checkOptions(t,Df),Pm.call(this,"Geocoder",t)}Ff.prototype=p(Pm,Ff,{constructor:Ff,lookup:function(t,e,i){const n={};i=v(i),this._checkOptions(i,zf),g(t,"[MapKit] Missing `address` in call to `Geocoder.lookup()`."),_(t,"string","[MapKit] `address` passed to `Geocoder.lookup()` is not a string."),g(e,"[MapKit] Missing `callback` in call to `Geocoder.lookup()`."),_(e,"function","[MapKit] `callback` passed to `Geocoder.lookup()` is not a function."),n.q=t;const o=i.region,s=i.coordinate,a=i.limitToCountries;let r=this.language||kt.language;if(o){const t=o.toBoundingRegion();n.searchRegion=[t.northLatitude,t.eastLongitude,t.southLatitude,t.westLongitude].join(",")}else s&&(n.searchLocation=[s.latitude,s.longitude].join(","));return i.language&&(r=this._bestLanguage(i.language)),r&&(n.lang=r),a&&(_(a,"string","[MapKit] `limitToCountries` is not a string."),n.limitToCountries=a),this._sendImmediatelyOrWithUserLocation("geocode",n,e,this._transform,"geocode")},reverseLookup:function(t,e,i){const n={};let o=this.language||kt.language;return i=v(i),this._checkOptions(i,Nf),g(t,"[MapKit] Missing `coordinate` in call to `Geocoder.reverseLookup()`."),f(t,Pf,"[MapKit] `coordinate` passed to `Geocoder.reverseLookup()` is not a Coordinate."),g(e,"[MapKit] Missing `callback` in call to `Geocoder.reverseLookup()`."),_(e,"function","[MapKit] `callback` passed to `Geocoder.reverseLookup()` is not a function."),n.loc=t.latitude+","+t.longitude,i.language&&(o=this._bestLanguage(i.language)),o&&(n.lang=o),this._send("reverseGeocode",n,e,this._transform,"reverseGeocode")},_transform:function(t,e){const i={status:e.status,results:[]};return e.results&&(i.results=e.results.map((t=>new mi(t)))),i}});const Uf=Ff;function Gf(t){Yo(this,Gf)&&Object.defineProperty(this,"_impl",{value:new Uf(t)})}Gf.prototype=p(Of,Gf,{constructor:Gf,lookup:function(t,e,i){return this._impl.lookup(t,e,i)},reverseLookup:function(t,e,i){return this._impl.reverseLookup(t,e,i)}});const Bf=Gf,Zf={mapkit:{}};[Bc,vu,Z_,{AnnotationsController:E_,MapFeaturesLayerController:O_,OverlaysController:rd,UserLocationController:uf,LayerItemsController:Xc,ItemCollection:dd,AccuracyRingOverlay:Cf,UserLocationAnnotation:If,Geocoder:Bf,userLocation:cf,mapkit:{}}].forEach((function(t){Object.keys(t).forEach((function(e){"mapkit"!==e?Object.defineProperty(Zf,e,Object.getOwnPropertyDescriptor(t,e)):Object.keys(t.mapkit).forEach((function(e){Object.defineProperty(Zf.mapkit,e,Object.getOwnPropertyDescriptor(t.mapkit,e))}))}))}));const Wf=Zf,Kf=Object.freeze({Country:"Country",AdministrativeArea:"AdministrativeArea",SubAdministrativeArea:"SubAdministrativeArea",Locality:"Locality",SubLocality:"SubLocality",PostalCode:"PostalCode"});function Hf(t){return t.map((function(t){if(!m(t,Kf))throw new Error("[MapKit] Unknown category `"+t+"`. Choose from mapkit.AddressCategory.");return t}))}function jf(t){if(void 0!==(t=v(t)).includes&&void 0!==t.excludes)throw new Error("[MapKit] `includes` and `excludes` may not be specified at the same time.");if(void 0===t.includes&&void 0===t.excludes)throw new Error("[MapKit] Either `includes` or `excludes` should be specified.");void 0!==t.includes&&(this._includes=Hf(t.includes)),void 0!==t.excludes&&(this._excludes=Hf(t.excludes))}const Vf=function(){throw new Error("[MapKit] `AddressFilter` may not be constructed directly. Use the mapkit.AddressFilter.including or the mapkit.AddressFilter.excluding methods.")};jf.prototype=Vf.prototype={constructor:Vf,_includes:null,_excludes:null,includesCategory:function(t){if(!m(t,Kf))throw new Error("[MapKit] Unknown category `"+t+"`. Choose from mapkit.AddressCategory.");return this._includes?-1!==this._includes.indexOf(t):this._excludes?-1===this._excludes.indexOf(t):void 0},excludesCategory:function(t){if(!m(t,Kf))throw new Error("[MapKit] Unknown category `"+t+"`. Choose from mapkit.AddressCategory.");return this._includes?-1===this._includes.indexOf(t):this._excludes?-1!==this._excludes.indexOf(t):void 0}},jf.including=function(t){return y(t,"[MapKit] AddressFilter.including expected an array of categories."),new jf({includes:t})},jf.excluding=function(t){return y(t,"[MapKit] AddressFilter.excluding expected an array of categories."),new jf({excludes:t})},jf.exposedConstructor=Vf,Object.defineProperties(jf,{filterIncludingAllCategories:{get:function(){const t=this.excluding([]);return Object.defineProperty(this,"filterIncludingAllCategories",{value:t,configurable:!0}),t},configurable:!0},filterExcludingAllCategories:{get:function(){const t=this.including([]);return Object.defineProperty(this,"filterExcludingAllCategories",{value:t,configurable:!0}),t},configurable:!0}}),Object.defineProperties(Vf,{including:{get:function(){return jf.including},configurable:!0},excluding:{get:function(){return jf.excluding},configurable:!0},includingAllCategories:{get:function(){return jf.filterIncludingAllCategories},configurable:!0},excludingAllCategories:{get:function(){return jf.filterExcludingAllCategories},configurable:!0}});const qf=jf,Yf=Object.freeze({Default:"Default",Required:"Required"}),Xf=hi.BoundingRegion,$f=hi.CoordinateRegion,Jf=hi.Coordinate,Qf=["language","getsUserLocation","coordinate","region","includeAddresses","includePointsOfInterest","includePhysicalFeatures","includeQueries","pointOfInterestFilter","addressFilter","limitToCountries","regionPriority"],ty=["language","region","coordinate","includeAddresses","includePointsOfInterest","includePhysicalFeatures","pointOfInterestFilter","addressFilter","limitToCountries","regionPriority"],ey=ty.concat(["includeQueries"]);function iy(t){t=v(t),this._checkOptions(t,Qf),Pm.call(this,"Search",t),this.coordinate=t.coordinate,this.region=t.region,void 0!==t.includeAddresses&&(this.includeAddresses=t.includeAddresses),void 0!==t.includePointsOfInterest&&(this.includePointsOfInterest=t.includePointsOfInterest),void 0!==t.includePhysicalFeatures&&(this.includePhysicalFeatures=t.includePhysicalFeatures),void 0!==t.includeQueries&&(this.includeQueries=t.includeQueries),void 0!==t.pointOfInterestFilter&&(this.pointOfInterestFilter=t.pointOfInterestFilter),void 0!==t.addressFilter&&(this.addressFilter=t.addressFilter),void 0!==t.limitToCountries&&(this.limitToCountries=t.limitToCountries),void 0!==t.regionPriority&&(this.regionPriority=t.regionPriority)}iy.prototype=p(Pm,iy,{constructor:iy,_coordinate:null,_region:null,_includeAddresses:!0,_includePointsOfInterest:!0,_includePhysicalFeatures:void 0,_includeQueries:!0,_pointOfInterestFilter:null,_addressFilter:null,_limitToCountries:null,_regionPriority:Yf.Default,get coordinate(){return this._coordinate},set coordinate(t){null!=t&&(f(t,Jf,"[MapKit] Search.coordinate expected a Coordinate value."),t=t.copy()),this._coordinate=t||null},get region(){return this._region},set region(t){null!=t&&(f(t,$f,"[MapKit] Search.region expected a CoordinateRegion value."),t=t.copy()),this._region=t||null},get includeAddresses(){return this._includeAddresses},set includeAddresses(t){this._includeAddresses=!!t},get includePointsOfInterest(){return this._includePointsOfInterest},set includePointsOfInterest(t){this._includePointsOfInterest=!!t},get includePhysicalFeatures(){return void 0===this._includePhysicalFeatures?this._includePointsOfInterest:this._includePhysicalFeatures},set includePhysicalFeatures(t){this._includePhysicalFeatures=!!t},get includeQueries(){return this._includeQueries},set includeQueries(t){this._includeQueries=!!t},get pointOfInterestFilter(){return this._pointOfInterestFilter},set pointOfInterestFilter(t){t&&f(t,Tt,"[MapKit] Unknown value for `pointOfInterestFilter`. It must be an instance of mapkit.PointOfInterestFilter."),this._pointOfInterestFilter=t||null},get addressFilter(){return this._addressFilter},set addressFilter(t){t&&f(t,qf,"[MapKit] Unknown value for `addressFilter`. It must be an instance of mapkit.AddressFilter."),this._addressFilter=t||null},get limitToCountries(){return this._limitToCountries},set limitToCountries(t){t&&_(t,"string","[MapKit] `limitToCountries` is not a string."),this._limitToCountries=t||null},get regionPriority(){return this._regionPriority},set regionPriority(t){if(t&&!m(t,Yf))throw new Error("[MapKit] Unknown value for `Search.regionPriority`. Choose from Search.RegionPriority.");this._regionPriority=t},search:function(t,e,i){return i=v(i),this._checkOptions(i,ty),this._request("search","search",this._searchTransform,t,e,i)},autocomplete:function(t,e,i){return i=v(i),this._checkOptions(i,ey),this._request("autocomplete","searchAutocomplete",this._autocompleteTransform,t,e,i)},_request:function(t,e,i,n,o,s){if("object"==typeof o){const e=o;o=function(i,n){const o="search"===t?e.searchDidError:e.autocompleteDidError,s="search"===t?e.searchDidComplete:e.autocompleteDidComplete;i?"function"==typeof o&&o.call(e,i):"function"==typeof s&&s.call(e,n)}}const a={},r="Search."+t+"()";if(g(n,"[MapKit] Missing `query` in call to `"+r+"`."),g(o,"[MapKit] Missing `callback` in call to `"+r+"`."),_(o,"function","[MapKit] `callback` passed to `"+r+"` is not a function."),n instanceof Iu)e=n._completionUrl;else{if("string"!=typeof n)throw new TypeError("[MapKit] `query` passed to `"+r+"` is neither a string nor SearchAutocompleteResult.");a.q=n}const l=s.region||this.region,h=s.coordinate||this.coordinate;let c=this.language||kt.language;if(l){const t=l.toBoundingRegion();a.searchRegion=[t.northLatitude,t.eastLongitude,t.southLatitude,t.westLongitude].join(",")}else h&&(a.searchLocation=[h.latitude,h.longitude].join(","));if(s.language&&(c=this._bestLanguage(s.language)),c&&(a.lang=c),s.pointOfInterestFilter&&f(s.pointOfInterestFilter,Tt,"[MapKit] Unknown value for `pointOfInterestFilter`. It must be an instance of mapkit.PointOfInterestFilter."),s.addressFilter&&f(s.addressFilter,qf,"[MapKit] Unknown value for `addressFilter`. It must be an instance of mapkit.AddressFilter."),s.limitToCountries&&_(s.limitToCountries,"string","[MapKit] `limitToCountries` is not a string."),(s.limitToCountries||this.limitToCountries)&&(a.limitToCountries=s.limitToCountries||this.limitToCountries),s.regionPriority&&!m(s.regionPriority,Yf))throw new Error("[MapKit] Unknown value for `regionPriority`. Choose from Search.RegionPriority.");a.searchRegionPriority=s.regionPriority||this.regionPriority;const d=s.pointOfInterestFilter||this.pointOfInterestFilter;let u=!0;d&&(s.includePointsOfInterest||this.includePointsOfInterest||console.warn("[MapKit] `includePointsOfInterest` is false but `pointOfInterestFilter` is set."),d._includes&&(0===d._includes.length?u=!1:a.includePoiCategories=d._includes.join(",")),d._excludes&&(a.excludePoiCategories=d._excludes.join(",")));const p=s.addressFilter||this.addressFilter;let y=!0;p&&(s.includeAddresses||this.includeAddresses||console.warn("[MapKit] `includeAddresses` is false but `addressFilter` is set."),p._includes&&(0===p._includes.length?y=!1:a.includeAddressCategories=p._includes.join(",")),p._excludes&&(a.excludeAddressCategories=p._excludes.join(",")));const v=[],w=iy.ResultTypeFilterValueMap;if(p?y&&v.push(w.address):void 0!==s.includeAddresses?s.includeAddresses&&v.push(w.address):this.includeAddresses&&v.push(w.address),d?u&&v.push(w.poi):void 0!==s.includePointsOfInterest?s.includePointsOfInterest&&v.push(w.poi):this.includePointsOfInterest&&v.push(w.poi),void 0!==s.includePhysicalFeatures)s.includePhysicalFeatures&&v.push(w.physicalFeature);else switch(this._includePhysicalFeatures){case!0:v.push(w.physicalFeature);break;case!1:break;case void 0:d?u&&v.push(w.physicalFeature):void 0!==s.includePointsOfInterest?s.includePointsOfInterest&&v.push(w.physicalFeature):this.includePointsOfInterest&&v.push(w.physicalFeature)}if("searchAutocomplete"===e&&(void 0!==s.includeQueries?s.includeQueries&&v.push(w.query):this.includeQueries&&v.push(w.query)),0===v.length)throw new Error("[MapKit] At least one of the types needs to be included in the search/autocomplete request.");return a.resultTypeFilter=v.join(","),this._sendImmediatelyOrWithUserLocation(e,a,o,i,t)},_searchTransform:function(t,e){const i={places:[]};if(t.q&&(i.query=t.q),e.displayMapRegion){0;const t=new Xf(e.displayMapRegion.northLat,e.displayMapRegion.eastLng,e.displayMapRegion.southLat,e.displayMapRegion.westLng);i.boundingRegion=t.toCoordinateRegion()}return e.results&&(i.places=e.results.map((t=>new mi(t)))),i},_autocompleteTransform:function(t,e){const i={query:t.q,results:[]};return e.results&&(i.results=e.results.map((t=>new Iu(t)))),i}}),iy.ResultTypeFilterValueMap=Object.freeze({address:"Address",poi:"PointOfInterest",physicalFeature:"PhysicalFeature",query:"Query"});const ny=iy;function oy(t){Yo(this,oy)&&Object.defineProperty(this,"_impl",{value:new ny(t)})}oy.prototype=p(Of,oy,{constructor:oy,get coordinate(){return this._impl.coordinate},set coordinate(t){this._impl.coordinate=t},get region(){return this._impl.region},set region(t){this._impl.region=t},get regionPriority(){return this._impl.regionPriority},set regionPriority(t){this._impl.regionPriority=t},get includeAddresses(){return this._impl.includeAddresses},set includeAddresses(t){this._impl.includeAddresses=t},get includePointsOfInterest(){return this._impl.includePointsOfInterest},set includePointsOfInterest(t){this._impl.includePointsOfInterest=t},get includePhysicalFeatures(){return this._impl.includePhysicalFeatures},set includePhysicalFeatures(t){this._impl.includePhysicalFeatures=t},get includeQueries(){return this._impl.includeQueries},set includeQueries(t){this._impl.includeQueries=t},get addressFilter(){return this._impl.addressFilter},set addressFilter(t){this._impl.addressFilter=t},get pointOfInterestFilter(){return this._impl.pointOfInterestFilter},set pointOfInterestFilter(t){this._impl.pointOfInterestFilter=t},get limitToCountries(){return this._impl.limitToCountries},set limitToCountries(t){this._impl.limitToCountries=t},search:function(t,e,i){return this._impl.search(t,e,i)},autocomplete:function(t,e,i){return this._impl.autocomplete(t,e,i)}}),oy.RegionPriority=Yf;const sy=oy,ay=["language"],ry=["language"];function ly(t){t=v(t),this._checkOptions(t,ay),Pm.call(this,"PlaceLookup",t)}ly.prototype=p(Pm,ly,{constructor:ly,getPlace:function(t,e,i){if(i=v(i),this._checkOptions(i,ry),"string"!=typeof t)throw new Error("[MapKit] `id` argument is not a string.");const n=i.language?this._bestLanguage(i.language):this.language||kt.language,o=n?{lang:n}:{};return this._send("place/"+t,o,e,this._transform,"placeLookup")},_transform:function(t,e){return new mi(e)}});const hy=ly;function cy(t){Yo(this,cy)&&Object.defineProperty(this,"_impl",{value:new hy(t)})}cy.prototype=p(Of,cy,{constructor:cy,getPlace:function(t,e,i){return this._impl.getPlace(t,e,i)}});const dy=cy,uy=["language"],py=["origin","destination","transportType","requestsAlternateRoutes","arrivalDate","departureDate","avoidTolls"],my=["origin","destinations","transportType","departureDate"];function gy(t){t=v(t),this._checkOptions(t,uy),Pm.call(this,"Directions",t)}function _y(t,e){if(!(t instanceof Date)||isNaN(t.getTime()))throw new TypeError("[MapKit] Expected a `Date` object for `"+e+"`, but got `"+t+"` instead.")}function fy(t){if("string"==typeof t)return{q:t};if("object"==typeof t&&t.muid)return{muid:t.muid};const e=t.coordinate||t;if(e instanceof ni)return{loc:{lat:e.latitude,lng:e.longitude}};throw new Error("[MapKit] Location must be an address (string), Coordinate object or Place object.")}function yy(t,e){return e?new mi(e):t instanceof mi?t:t instanceof ni?t.copy():void 0}function vy(t,e,i){this.name=t.name,this.distance=t.distanceMeters,this.expectedTravelTime=t.durationSeconds,this.transportType=t.transportType;const n=t.avoidTolls;this.hasTolls="boolean"==typeof n?!n:void 0,this._path=t.stepIndexes.map((t=>i[t])),this.steps=t.stepIndexes.map((t=>e[t]))}gy.Transport={Automobile:"AUTOMOBILE",Walking:"WALKING"},gy.prototype=p(Pm,gy,{constructor:gy,eta:function(t,e){if(g(t,"[MapKit] Missing `request` in call to `Directions.eta()`."),v(t,"[MapKit] `request` is not a valid object."),g(e,"[MapKit] Missing `callback` in call to `Directions.eta()`."),_(e,"function","[MapKit] `callback` passed to `Directions.eta()` is not a function."),this._checkOptions(t,my),g(t.origin,"[MapKit] Missing required property `origin` in `request` object."),g(t.destinations,"[MapKit] Missing required property `destinations` in `request` object."),!Array.isArray(t.destinations))throw new Error("[MapKit] Required property `destinations` in `request` object must be an array.");if(t.destinations.length>10)throw new Error("[MapKit] `destinations` array must be less than 10 destinations.");if(f(t.origin,ni,"[MapKit] `origin` property in `request` is not a Coordinate."),t.destinations.forEach((function(t){f(t,ni,"[MapKit] One of the values in `destinations` property in `request` is not a Coordinate.")})),"CN"===kt.countryCode)return void setTimeout((function(){const t=new Error("[MapKit] ETA Requests are not supported in China yet.");it(e,null,[t])}));const i={origin:t.origin.latitude+","+t.origin.longitude,destinations:t.destinations.map((t=>t.latitude+","+t.longitude)).join("|")},n=t.transportType;if(n){for(const t in gy.Transport)n===gy.Transport[t]&&(i.transportType=gy.Transport[t]);if(!i.transportType)throw new TypeError("[MapKit] transportType must be a value of `Directions.Transport`.")}const o=t.departureDate;o&&(_y(o,"departureDate"),i.departureDate=o.toISOString());const s=this.language||kt.language;return s&&(i.lang=s),this._send("etas",i,e,((e,i)=>this._handleEtaResponse(t,e,i)),"etas")},route:function(t,e){g(t,"[MapKit] Missing `request` in call to `Directions.route()`."),v(t,"[MapKit] `request` is not a valid object."),g(e,"[MapKit] Missing `callback` in call to `Directions.route()`."),_(e,"function","[MapKit] `callback` passed to `Directions.route()` is not a function."),this._checkOptions(t,py);const i={},n=t.origin,o=t.destination,s=t.transportType,a=t.arrivalDate,r=t.departureDate,l=t.avoidTolls,h=s===gy.Transport.Automobile,c=s===gy.Transport.Walking;if(g(n,"[MapKit] Missing required property `origin` in `request` object."),g(o,"[MapKit] Missing required property `destination` in `request` object."),i.wps=JSON.stringify([fy(n),fy(o)]),s){if(!h&&!c)throw new TypeError("[MapKit] transportType must be either Directions.Transport.Automobile or Directions.Transport.Walking.");i.transport=s}var d,u;a&&r?console.warn("[MapKit] `Directions.route()` should not be sent an `arrivalDate` and `departureDate` in the same request. These parameters have been dropped from the request."):"CN"===kt.countryCode&&(a||r)?console.warn("[MapKit] `arrivalDate` and `departureDate` are not supported in China yet. These parameters have been dropped from the request."):a?(_y(a,"arrivalDate"),i.arrivalDate=a.toISOString()):r&&(_y(r,"departureDate"),i.departureDate=r.toISOString()),d=t,u="requestsAlternateRoutes",Object.prototype.hasOwnProperty.call(d,u)?i.n=t.requestsAlternateRoutes?"3":"1":i.n="1";const p=this.language||kt.language;return p&&(i.lang=p),l&&c?console.warn("[MapKit] When `transportType` is `Directions.Transport.Walking`, the `avoidTolls` parameter has no effect. The `avoidTolls` parameter has been dropped from the request."):l&&"CN"===kt.countryCode?console.warn("[MapKit] `avoidTolls` is not supported in China yet. This parameter has been dropped from the request."):l&&(i.avoid="tolls"),this._send("directions",i,e,((e,i)=>this._handleResponse(t,e,i)),"directions")},_handleEtaResponse:function(t,e,i){return{request:e,origin:t.origin.copy(),etas:i.etas.map((function(e,i){return{destination:t.destinations[i]?t.destinations[i].copy():void 0,transportType:e.transportType,distance:e.distanceMeters,expectedTravelTime:e.expectedTravelTimeSeconds,staticTravelTime:e.staticTravelTimeSeconds}}))}},_handleResponse:function(t,e,i){const n=i.stepPaths.map((function(t){return t.map((t=>new ni(t.lat,t.lng)))})),o=i.steps.map((t=>new ky(t,n,i.shieldDomains))),s=i.routes.map((t=>new vy(t,o,n)));return{request:e,origin:yy(t.origin,i.origin),destination:yy(t.destination,i.destination),routes:s}}});const wy=function(){throw new TypeError("[MapKit] Route may not be constructed.")};function by(t){delete vy.prototype.polyline,Object.defineProperty(vy.prototype,"polyline",{enumerable:!0,configurable:!0,get:function(){return this._polyline||(this._polyline=new t(this._path.reduce((function(t,e){return t.concat(e)}),[]))),this._polyline}})}wy.prototype=vy.prototype={constructor:wy,get path(){return console.warn("[MapKit] The `Route.path` property is deprecated and will be removed in a future release."),this._path},get polyline(){throw new Error("[MapKit] Route.polyline is available after loading the following library: overlays.")}},R.jsModules.mapkit.PolylineOverlay?by(R.jsModules.mapkit.PolylineOverlay):R.addEventListener("load",(function t(e){e.jsModules.mapkit&&e.jsModules.mapkit.PolylineOverlay&&(R.removeEventListener("load",t),by(R.jsModules.mapkit.PolylineOverlay))})),gy.Route=vy;const Cy=["ON_RAMP","OFF_RAMP","HIGHWAY_OFF_RAMP_LEFT","HIGHWAY_OFF_RAMP_RIGHT","CHANGE_HIGHWAY","CHANGE_HIGHWAY_LEFT","CHANGE_HIGHWAY_RIGHT"];function ky(t,e,i){if(this.instructions=t.instructions,this.pathIndex=t.stepPathIndex,this.distance=t.distanceMeters,this.transportType=t.transportType,this.path=e[t.stepPathIndex],!i||!i.length||!t.maneuver)return;const n=i[t.stepPathIndex%i.length],o=t.maneuver;let s,a;if(o.names&&o.names.length){const t=o.names.filter((t=>t.type&&t.shieldUrl));t.length&&(s="//"+n+t[0].shieldUrl)}o.arrowUrl&&(a="//"+n+o.arrowUrl);const r=s&&-1!==Cy.indexOf(o.type);this._imageUrl=r?s:a}const My=function(){throw new TypeError("[MapKit] Step may not be constructed.")};My.prototype=ky.prototype={constructor:My};const Sy=gy;function Ly(t){Yo(this,Ly)&&Object.defineProperty(this,"_impl",{value:new Sy(t)})}Ly.Transport=Sy.Transport,Ly.prototype=p(Of,Ly,{constructor:Ly,eta:function(t,e){return this._impl.eta(t,e)},route:function(t,e){return this._impl.route(t,e)}});const Ay=Ly,Ey=hi.CoordinateRegion,xy=hi.Coordinate,Ty=["language","getsUserLocation","center","radius","region","pointOfInterestFilter"];function Iy(t){t=v(t),this._checkOptions(t,Ty),Pm.call(this,"PointsOfInterestsSearch",t),void 0!==t.center&&(this.center=t.center),void 0!==t.radius&&(this.radius=t.radius),void 0!==t.region&&(this.region=t.region),t.pointOfInterestFilter&&(this.pointOfInterestFilter=t.pointOfInterestFilter)}Iy.prototype=p(Pm,Iy,{constructor:Iy,_center:null,_radius:null,_region:null,_pointOfInterestFilter:null,get center(){return this._center},set center(t){null!=t&&(f(t,xy,"[MapKit] PointsOfInterestSearch.center expected a Coordinate value."),t=t.copy()),this._center=t||null},get radius(){return this._radius},set radius(t){null!=t&&_(t,"number","[MapKit] PointsOfInterestSearch.radius expected a number value."),this._radius=t||null},get region(){return this._region},set region(t){null!=t&&(f(t,Ey,"[MapKit] PointsOfInterestSearch.region expected a CoordinateRegion value."),t=t.copy()),this._region=t||null},get getsUserLocation(){return!1},set getsUserLocation(t){throw new TypeError("[MapKit] getsUserLocation on PointsOfInterestSearch has not effect.")},get pointOfInterestFilter(){return this._pointOfInterestFilter},set pointOfInterestFilter(t){t&&f(t,Tt,"[MapKit] Unknown value for `pointOfInterestFilter`. It must be an instance of mapkit.PointOfInterestFilter."),this._pointOfInterestFilter=t||null},search:function(t,e){if(e=v(e),this._checkOptions(e,Ty),"object"==typeof t){const e=t;t=function(t,i){const n=e.searchDidError,o=e.searchDidComplete;t?"function"==typeof n&&n.call(e,t):"function"==typeof o&&o.call(e,i)}}if("CN"===kt.countryCode)return void setTimeout((function(){const e=new Error("[MapKit] PointsOfInterestSearch is not supported in China yet.");it(t,null,[e])}));const i={};e.pointOfInterestFilter&&f(e.pointOfInterestFilter,Tt,"[MapKit] Unknown value for `pointOfInterestFilter`. It must be an instance of mapkit.PointOfInterestFilter."),g(t,"[MapKit] Missing `callback` in call to `search`."),_(t,"function","[MapKit] `callback` passed to `search` is not a function.");const n=e.center||this.center,o=e.radius||this.radius,s=e.region||this.region;if((n||o)&&s)return void setTimeout((function(){const e=new Error("[MapKit] Setting both `center`/`radius` and region are not allowed. Expects either a circular region defined by `center`/`radius` or a rectangular region defined by `region`.");it(t,null,[e])}));if(!n&&!o&&!s)return void setTimeout((function(){const e=new Error("[MapKit] No search region specified. Expects either a circular region defined by `center`/`radius` or a rectangular region defined by `region`.");it(t,null,[e])}));if(n||o)f(n,xy,"[MapKit] `center` should be a Coordinate when specify a circular search region."),i.center=[n.latitude,n.longitude].join(","),o&&(i.radius=o.toString(10));else if(s){f(s,Ey,"[MapKit] `region` should be a CoordinateRegion when specify a rectangular search region.");const t=s.toBoundingRegion();i.mapRegion=[t.northLatitude,t.eastLongitude,t.southLatitude,t.westLongitude].join(",")}else 0;if(void 0!==e.getsUserLocation)throw Error("[MapKit] getsUserLocation on PointsOfInterestSearch has not effect.");let a=this.language||kt.language;e.language&&(a=this._bestLanguage(e.language)),a&&(i.lang=a);const r=e.pointOfInterestFilter||this.pointOfInterestFilter;if(r){if(r._includes){if(0===r._includes.length)return void setTimeout((()=>it(t,null,[null,this._nearbyPoiTransform(void 0,{})])));i.includePoiCategories=r._includes.join(",")}r._excludes&&(i.excludePoiCategories=r._excludes.join(","))}return this._send("nearbyPoi",i,t,this._nearbyPoiTransform,"nearbyPoi")},_checkOptions:function(t,e){if((void 0!==t.center||void 0!==t.radius)&&void 0!==t.region)throw new Error("[MapKit] Setting both `center`/`radius` and region are not allowed. Expects either a circular region defined by `center`/`radius` or a rectangular region defined by `region`.");return Pm.prototype._checkOptions.call(this,t,e)},_nearbyPoiTransform:function(t,e){const i={places:[]};return e.results&&(i.places=e.results.map((t=>new mi(t)))),i}});const Ry=Iy;function Oy(t){Yo(this,Oy)&&Object.defineProperty(this,"_impl",{value:new Ry(t)})}Oy.prototype=p(Of,Oy,{constructor:Oy,get center(){return this._impl.center},set center(t){this._impl.center=t},get radius(){return this._impl.radius},set radius(t){this._impl.radius=t},get region(){return this._impl.region},set region(t){this._impl.region=t},get pointOfInterestFilter(){return this._impl.pointOfInterestFilter},set pointOfInterestFilter(t){this._impl.pointOfInterestFilter=t},search:function(t,e){return this._impl.search(t,e)}}),Object.defineProperty(Oy,"MaxRadius",{enumerable:!0,value:2e3});const Py=Oy,Dy={userLocation:cf,mapkit:{CoordinateRegion:hi.CoordinateRegion,CoordinateSpan:hi.CoordinateSpan,Coordinate:hi.Coordinate,BoundingRegion:hi.BoundingRegion,MapPoint:hi.MapPoint,MapRect:hi.MapRect,MapSize:hi.MapSize,Geocoder:Bf,Search:sy,PlaceLookup:dy,Directions:Ay,PointsOfInterestSearch:Py,Place:mi.prototype.constructor,SearchAutocompleteResult:Iu.prototype.constructor,PointOfInterestCategory:Lt,PointOfInterestFilter:Tt.exposedConstructor,AddressCategory:Kf,AddressFilter:qf.exposedConstructor,get filterIncludingAllCategories(){return Tt.filterIncludingAllCategories},get filterExcludingAllCategories(){return Tt.filterExcludingAllCategories}}},zy={Feature:"Feature",FeatureCollection:"FeatureCollection",GeometryCollection:"GeometryCollection",MultiPoint:"MultiPoint",MultiLineString:"MultiLineString",MultiPolygon:"MultiPolygon",Point:"Point",LineString:"LineString",Polygon:"Polygon",Position:"Position"},Ny={Feature:function(t){return Fy(t,t.geometry&&t.geometry.type)},FeatureCollection:function(t){if(!(t instanceof Object&&t.features instanceof Array))return!1;for(const e in t.features){const i=t.features[e];if(i.geometry&&!Fy(i,i.geometry.type))return!1}return!0},Position:function(t){return function(t){if(!Array.isArray(t)||t.length<2)return!1;for(let e=0;e<2;++e)if("number"!=typeof t[e]||isNaN(t[e]))return!1;return!0}(t)},Point:function(t){return Uy(t,zy.Point)},MultiPoint:function(t){return Uy(t,zy.MultiPoint)},LineString:function(t){return Uy(t,zy.LineString)},MultiLineString:function(t){return Uy(t,zy.MultiLineString)},Polygon:function(t){return Uy(t,zy.Polygon)},MultiPolygon:function(t){return Uy(t,zy.MultiPolygon)},GeometryCollection:function(t){if(!(t instanceof Object&&t.geometries instanceof Array))return!1;for(const e in t.features){if(!Uy(t,t.geometries[e].type))return!1}return!0}};function Fy(t,e){return t instanceof Object&&(t.type===zy.Feature&&!!Uy(t.geometry,e))}function Uy(t,e){return t instanceof Object&&((!e||t.type===e)&&(((i=t.type)instanceof String||"string"==typeof i)&&(t.type===zy.GeometryCollection?Ny.GeometryCollection(t):t.type===zy.MultiLineString||t.type===zy.MultiPolygon||t.type===zy.MultiPoint?function(t){for(let e=0;e<t.length;e+=1)if(!(t[e]instanceof Array))return!1;return!0}(t.coordinates):t.coordinates instanceof Array)));var i}const Gy={isValid:function(t){return!!Ny[t.type]&&Ny[t.type](t)},isPosition:function(t){return Ny.Position(t)}},By={Point:rm,LineString:cu,Polygon:yu},Zy={MultiPoint:zy.Point,MultiLineString:zy.LineString,MultiPolygon:zy.Polygon},Wy=[zy.MultiPoint,zy.MultiLineString,zy.MultiPolygon];function Ky(t){this.message=t}function Hy(t,e,i){const n=function(){const e=i(n.collection?n.collection.items[n.index]:t.scheduledTaskItem);n.collection?n.collection.items[n.index]=e:t.scheduledTaskItem=e};return e&&(n.collection=e,n.index=e.items.length),ue.scheduleInBackground(n,ue.Priority.Highest),n}function jy(t){if(!Gy.isPosition(t))throw new Ky("[MapKit] Expected a GeoJSON Position type, instead got "+t);return new ni(t[1],t[0])}function Vy(t,e,i){const n=Wy.indexOf(t.type)>-1,o="GeometryCollection"===t.type;let s;if(n||o){const a=n?t.coordinates:t.geometries;if(n)switch(t.type){case zy.MultiPoint:s=e.delegate.itemForMultiPoint;break;case zy.MultiLineString:s=e.delegate.itemForMultiLineString;break;case zy.MultiPolygon:s=e.delegate.itemForMultiPolygon}o&&(s=e.delegate.itemForPoint);const r=new dd([],t);return a.forEach((function(i){n&&(i={type:Zy[t.type],coordinates:i}),r.items.push(Vy(i,e,r))})),e.hasCallbackOrDelegate&&Hy(e,i,(function(){return r._impl.items=r.items.filter((function(t){return!!t})),s?it(s,e.delegate,[r,t],r):r})),r}const a=By[t.type];if(!a)throw new Ky("[MapKit] Expected a GeoJSON "+t.type+" type, instead got "+t);const r=function(t,e){switch(e){case zy.MultiPoint:case zy.LineString:return t.map((t=>jy(t)));case zy.Polygon:return t.map((function(t){return t.map((t=>jy(t)))}));default:return jy(t)}}(t.coordinates,t.type);let l,h;switch(t.type){case zy.Point:s=e.delegate.itemForPoint,l=r;break;case zy.LineString:s=e.delegate.itemForLineString,h=e.delegate.styleForOverlay;break;case zy.Polygon:s=e.delegate.itemForPolygon,h=e.delegate.styleForOverlay}function c(){const i=new a(r,{data:t}),n=s?it(s,e.delegate,[l||i,t],i):i;return n?(++e.itemCount,h&&(n.style=it(h,e.delegate,[i,t],i)),n):null}return e.hasCallbackOrDelegate?Hy(e,i,c):c()}function qy(t,e,i){let n;switch(t.type){case zy.Feature:return n=function(t,e,i){if(null===t.geometry)return e.hasCallbackOrDelegate?Hy(e,i,(function(){return null})):null;if(!Gy.isValid(t))throw new Ky("[MapKit] Expected a GeoJSON "+t.type+" type, instead got "+t);const n=Vy(t.geometry,e,i);if(!n)throw new Ky("[MapKit] "+t+" is an unknown GeoJSON type");return n}(t,e,i),e.delegate.itemForFeature&&Hy(e,i,(function(i){return it(e.delegate.itemForFeature,e.delegate,[i,t],i)})),n;case zy.FeatureCollection:return n=new dd([],t),t.features.forEach((function(t){const i=qy(t,e,n);i&&n.items.push(i)})),e.hasCallbackOrDelegate&&Hy(e,i,(function(){return n._impl.items=n.items.filter((t=>!!t)),e.delegate.itemForFeatureCollection?it(e.delegate.itemForFeatureCollection,e.delegate,[n,t],n):n})),n;case zy.GeometryCollection:case zy.MultiPoint:case zy.MultiLineString:case zy.MultiPolygon:case zy.Point:case zy.LineString:case zy.Polygon:case zy.Position:return Vy(t,e,i);default:throw"string"==typeof t.type?new Ky('[MapKit] "'+t.type+'" is an unknown GeoJSON type.'):new Ky("[MapKit] importGeoJSON expects an object with a known GeoJSON `type` property.")}}Ky.prototype=Object.create(Error.prototype);const Yy={importGeoJSON:function(t,e){const i={delegate:{},itemCount:0,hasCallbackOrDelegate:!1};e&&(i.delegate=e,i.hasCallbackOrDelegate=!0);try{const n="[MapKit] importGeoJSON expects an Object and was passed ";if(!t)throw new Ky(n+"a falsy value");if(!(t instanceof Object))throw new Ky(n+t);if(Array.isArray(t))throw new Ky(n+"an array");let o=qy(t,i);return i.hasCallbackOrDelegate?void ue.scheduleInBackground((function(){let n=void 0===i.scheduledTaskItem?o:i.scheduledTaskItem;n instanceof dd||(n=new dd(n,t)),"function"==typeof e?it(e,null,[null,n]):i.delegate.geoJSONDidComplete?(0===i.itemCount&&console.warn("[MapKit] No item is imported with importGeoJSON, either because GeoJSON has no geometries, or the delegate methods did not return any item."),it(i.delegate.geoJSONDidComplete,i.delegate,[n,t])):console.warn("[MapKit] importGeoJSON was called asynchronously with a delegate object but no `geoJSONDidComplete` method was defined.")}),ue.Priority.Highest):(o instanceof dd||(o=new dd(o,t)),o)}catch(n){if(!(n instanceof Ky))throw n;"function"==typeof i.delegate.geoJSONDidError?it(i.delegate.geoJSONDidError,i.delegate,[n,t]):"function"==typeof e?it(e,null,[n]):console.error(n.message)}},constants:zy,validate:Gy},Xy=tt;const $y=function(t,e){const i="function"==typeof e,n="object"==typeof e&&null!==e,o="string"==typeof t;if(o&&!i&&!n)throw new Error("[MapKit] For GeoJSON file imports, a callback must be provided as a second argument");return o?function(t,e){const i=new Xy(t,{loaderDidSucceed:function(i,n){let o;try{o=JSON.parse(n.responseText)}catch(i){return void e(new Error("[MapKit] The response of "+t+" does not appear to be valid JSON:"+n.responseText))}e(null,o)},loaderDidFail:function(i,n){e(new Error("[MapKit] Failed to load "+t))}});return i.schedule(),i.id}(t,(function(t,o){if(!t)return Yy.importGeoJSON(o,e);n&&e.geoJSONDidError?it(e.geoJSONDidError,e,[t]):i&&it(e,null,[t])})):Yy.importGeoJSON(t,e)},Jy={mapkit:{importGeoJSON:$y}},Qy=Math.min(Co.devicePixelRatio,3),tv=(Qy>1?"_"+Qy+"x":"")+".png";let ev;const iv={};let nv=[],ov=!1;function sv(t){Lo.call(this,t),function(){if(rv)return;if(rv=!0,kt.state===kt.States.PENDING||kt.state===kt.States.READY)return void av();kt.addEventListener(kt.Events.Initialized,(function t(){kt.removeEventListener(kt.Events.Initialized,t),av()}))}()}function av(){const t={};function e(e,n){const o=fe.createImageUrl("pins/pin"+(e?"-":"")+e+"-"+n+tv),s=Co.htmlElement("img",{src:o}),a={handleEvent:function(o){switch(s.removeEventListener("load",a),s.removeEventListener("error",a),o.type){case"load":t[e][n]=s;break;case"error":console.warn("[MapKit] Error loading pin annotation image "+o.target.src+"; pin annotations may not display correctly."),ov=!0}--i,0===i&&(ev=t,nv.forEach((t=>{t.needsDisplay=!0})),nv=void 0)}};s.crossOrigin=Hs.getCorsAttribute(kt.distUrlWithCredentials),s.addEventListener("load",a),s.addEventListener("error",a)}let i=["","floating","down1","down2","down3"].reduce((function(i,n){return t[n]={},e(n,"base"),e(n,"head"),i+2}),1);e("","shadow")}sv.prototype=p(Lo,sv,{draw:function(t){if(!ev)return void(nv.indexOf(this._node)<0&&nv.push(this._node));const e=this._node,i=e.size.width,n=e.size.height;if(ov){return void function(t,e,i,n){t.strokeStyle="#ff4040",t.lineWidth=2,t.strokeRect(0,e,i,n-e),t.beginPath(),t.moveTo(0,e),t.lineTo(i,n),t.moveTo(0,n),t.lineTo(i,e),t.stroke()}(t,n-e._annotation.size.height,e._annotation.size.width,n)}const o=e._state,s=e._annotation.color;if(iv[s]||(iv[s]={}),!iv[s][o]){const t=document.createElement("canvas");t.width=i*Qy,t.height=n*Qy;const e=t.getContext("2d");e.fillStyle=s,e.fillRect(0,0,t.width,t.height),e.save(),e.globalCompositeOperation="destination-in",e.drawImage(ev[o].head,0,0),e.restore(),e.drawImage(ev[o].base,0,0),iv[s][o]=t}e.shadowTransform&&t.drawImage(ev[""].shadow,e.shadowTransform.e,e.shadowTransform.f,i,n),t.drawImage(iv[s][o],0,0,i,n)}});let rv=!1;const lv=sv;function hv(t){ln.call(this),this.size=new Ui(32,39),this._annotation=t,this._renderer=new lv(this),this.updateState()}hv.prototype=p(ln,hv,{get position(){return this._annotation.nodePosition()},stringInfo:function(){return"PinAnnotationNode"+(this._state?"<"+this._state+">":"")},updateState:function(t){t=this._annotation.floating?"floating":t||"",this._state!==t&&(this._state=t,this.needsDisplay=!0)}});const cv=hv,dv=[1,2,3,2,1],uv=Math.tan(.820304748437335);function pv(t){ju.call(this,t)}pv.prototype=p(ju,pv,{get isBouncing(){return this._bounceAnimationFrameIndex>=0},animateDropAfterLift:function(){const t=Math.max(this._dropAnimationStartP-Math.min((Date.now()-this._dropAfterLiftAnimationStartDate)/this.liftDurationMs,1),0);let e=this.liftAmount*t;this._annotation.sceneGraphNode.transform=(new Zi).translate(0,-e),this._dropAnimationRevert||(e*=1.25),this._annotation.sceneGraphNode.shadowTransform=(new Zi).translate(uv*e,-e),0===t&&(delete this._annotation.floating,this._annotation.sceneGraphNode.updateState(),delete this._dropAfterLiftAnimationStartDate,delete this._dropAnimationStartP,delete this._dropAnimationRevert,this._dequeueNextAnimation()),ue.scheduleOnNextFrame(this)},animateLift:function(){const t=Math.min((Date.now()-this._liftAnimationStartDate)/this.liftDurationMs,1);let e=this.liftAmount*t;this._annotation.sceneGraphNode.transform=(new Zi).translate(this.translation.x,this.translation.y-e),this._shadowLiftDamping&&(e=this.liftAmount*(1+.25*t)),this._annotation.sceneGraphNode.shadowTransform=(new Zi).translate(uv*e,-e),t<1?(ue.scheduleOnNextFrame(this),this._liftAnimationProgress=t):(delete this._liftAnimationStartDate,delete this._liftAnimationProgress,delete this._shadowLiftDamping,this._dequeueNextAnimation())},drop:function(){const t=this._annotation.position().y;this._pinVerticalTranslation=-t-4,this._shadowHorizontalTranslation=uv*-this._pinVerticalTranslation,this._shadowVerticalTranslation=this._pinVerticalTranslation;const e=t/this._annotation.delegate.mapForAnnotation(this._annotation._public)._impl.ensureRenderingFrame().size.height;this._dropDurationMs=1e3*Math.min(.35*(e+(1-e)/2),3),this._dropAnimationStartDate=Date.now(),this._annotation.floating=!0,this._annotation.sceneGraphNode.updateState(),this._animateDrop(),this._annotation._isAnimating=!0,this._animationQueue=[this._bounce,()=>this._annotation.finishedAnimating()],ue.scheduleOnNextFrame(this)},dropAnnotationAfterDraggingAndRevertPosition:function(t){const e=()=>this._annotation.droppedAfterLift();this._bounceAnimationFrameIndex>=0?this._animationQueue=[e]:(this._liftAnimationStartDate?(this._dropAnimationStartP=this._liftAnimationProgress,delete this._liftAnimationStartDate,delete this._liftAnimationProgress):this._dropAnimationStartP=1,t?(this._dropAfterLift(),this._animationQueue=[this._bounce,e]):(this._annotation.draggingDidEnd(),this._shadowLiftDamping=!0,this._animationQueue=[this._dropAfterLift,this._bounce,e],ju.prototype.lift.call(this,this.nominalLiftAmount)),this._dropAnimationRevert=t,ue.scheduleOnNextFrame(this))},lift:function(t){this.nominalLiftAmount=t,this._animationQueue=[this._liftAfterBounce],this._bounce(),ue.scheduleOnNextFrame(this)},setTranslation:function(t){this.translation=t,this._bounceAnimationFrameIndex>=0||this._liftAnimationStartDate||(this._annotation.sceneGraphNode.transform=(new Zi).translate(t.x,t.y-this.liftAmount),this._annotation.sceneGraphNode.shadowTransform=(new Zi).translate(uv*this.liftAmount,-this.liftAmount))},performScheduledUpdate:function(){this._dropAnimationStartDate?this._animateDrop():this._bounceAnimationFrameIndex>=0?this._animateBounce():ju.prototype.performScheduledUpdate.call(this)},_animateBounce:function(){this._bounceAnimationFrameIndex<dv.length?(this._annotation.sceneGraphNode.updateState("down"+dv[this._bounceAnimationFrameIndex]),++this._bounceAnimationFrameIndex):(delete this._bounceAnimationFrameIndex,this._dequeueNextAnimation()),ue.scheduleOnNextFrame(this)},_animateDrop:function(){const t=Math.min((Date.now()-this._dropAnimationStartDate)/this._dropDurationMs,1),e=1-t;this._annotation.sceneGraphNode.transform=(new Zi).translate(0,e*this._pinVerticalTranslation),this._annotation.sceneGraphNode.shadowTransform=(new Zi).translate(e*this._shadowHorizontalTranslation,e*this._shadowVerticalTranslation),1===t&&(delete this._pinVerticalTranslation,delete this._shadowHorizontalTranslation,delete this._shadowVerticalTranslation,delete this._dropAnimationStartDate,delete this._dropDurationMs,this._annotation.floating=!1,this._annotation.sceneGraphNode.updateState(),this._dequeueNextAnimation()),ue.scheduleOnNextFrame(this)},_bounce:function(){this._bounceAnimationFrameIndex=0},_dequeueNextAnimation:function(){this._animationQueue.length>0&&this._animationQueue.shift().call(this)},_dropAfterLift:function(){delete this.translation,this._dropAfterLiftAnimationStartDate=Date.now(),ue.scheduleOnNextFrame(this)},_liftAfterBounce:function(){ju.prototype.lift.call(this,this.nominalLiftAmount),this._annotation.floating=!0,this._annotation.sceneGraphNode.updateState()}});const mv=pv,gv=new Ui(15,36),_v={Red:"#ff3d38",Green:"#54d669",Purple:"#c969e0"},fv=new window.DOMPoint(8,35),yv=new window.DOMPoint(-8,0);function vv(t){function e(e,i,n){this._animationController=new mv(this),this._dragController=this._animationController,this._sceneGraphNode=new cv(this),t.call(this,e,i,t.div,n),this.setSize(gv)}return e.Colors=_v,e.prototype=p(t,e,{_animates:!0,_color:_v.Red,_anchorPoint:fv,_calloutAnchorPoint:yv,renderedByDOMElement:!1,get size(){return gv.copy()},set size(t){console.warn("[MapKit] The `size` property of a pin annotation cannot be set.")},get color(){return this._color},set color(t){_(t,"string","[MapKit] Expected a string value for PinAnnotation.color, but got `"+t+"` instead"),t!==this._color&&(this._color=t,this.updateLocalizedText(),this._sceneGraphNode.needsDisplay=!0)},centerOffsetForSelectionAccessory:()=>new Gi(-8,-2),get shouldPreventDrag(){return this._animationController.isBouncing},doesAnimate:function(){return this._animates},willMoveToMap:function(t){this._isMoving=t&&this.animates},didMoveToMap:function(){const e=this._isMoving;t.prototype.didMoveToMap.call(this),this.delegate&&e&&this.visible&&!this._appearanceAnimation&&this._shown&&(this._isAnimating=!0,this._animationController.drop())},droppedAfterLift:function(){this.resetNodeTransform(),this._sceneGraphNode.updateState(),t.prototype.droppedAfterLift.call(this)},finishedAnimating:function(){this._sceneGraphNode.updateState(),t.prototype.finishedAnimating.call(this)},altText:function(){return t.prototype.altText.call(this)||(this._color===_v.Green?Oi.get("Annotation.Pin.Green.AccessibilityLabel"):this._color===_v.Purple?Oi.get("Annotation.Pin.Purple.AccessibilityLabel"):this._color===_v.Red?Oi.get("Annotation.Pin.Red.AccessibilityLabel"):Oi.get("Annotation.Pin.AccessibilityLabel"))},draggingDidEnd:function(){t.prototype.draggingDidEnd.call(this),t.prototype.updatePosition.call(this)},dragOffset:new Gi(0,2),ConstructorOptions:Object.freeze(Object.assign({},t.prototype.ConstructorOptions,{color:"rw"})),resetNodeTransform:function(){this.sceneGraphNode.transform=new Zi}}),e}vv.Colors=_v;const wv=vv,bv=wv(qu);function Cv(t,e){Yo(this,Cv)&&(console.warn("[MapKit] mapkit.PinAnnotation is deprecated and will be removed in a future release. Please use the newer mapkit.MarkerAnnotation class instead."),Object.defineProperty(this,"_impl",{value:new bv(this,t,e)}))}Cv.Colors=wv.Colors,Cv.prototype=p(Xu,Cv,{get size(){return this._impl.size},set size(t){this._impl.size=t},get color(){return this._impl._color},set color(t){this._impl.color=t}});const kv={mapkit:{}};[Wf,{mapkit:{PinAnnotation:Cv}},Jy,Dy].forEach((function(t){Object.keys(t).forEach((function(e){"mapkit"!==e?kv[e]=t[e]:Object.keys(t.mapkit).forEach((e=>{kv.mapkit[e]=t.mapkit[e]}))}))}));const Mv=kv;function Sv(){throw new TypeError("[MapKit] MapKit may not be constructed.")}const Lv=function(t){const e=new St.Event(t.type);e.status=t.status,t.message&&(e.message=t.message),t.responseIdentifier&&(e.responseIdentifier=t.responseIdentifier),Tv.dispatchEvent(e)};Sv.prototype=p(St.EventTarget,Sv,{init:function(t){kt.init(t),kt.addEventListener(kt.Events.Changed,Lv),kt.addEventListener(kt.Events.Error,Lv)},get version(){return i.version},get build(){return i.build+""+kt.buildTags},get language(){return kt.language},set language(t){kt.language=t},toString:function(){return["MapKit JS",this.version,"("+this.build+")"].join(" ")},get _tileProvider(){return kt.tileProvider},get _countryCode(){return kt.countryCode},set _countryCode(t){kt._c(z).setForcedCountryCode(t)},_login(){kt.login()},_restore:function(){kt._restore()},get _environment(){return kt.environment}});const Av=Object.keys({importGeoJSON:["geojson"],FeatureVisibility:["map"],CoordinateRegion:["map","services"],CoordinateSpan:["map","services"],Coordinate:["map","services"],BoundingRegion:["map","services"],MapPoint:["map","services"],MapRect:["map","services"],MapSize:["map","services"],Padding:["map"],CameraZoomRange:["map"],MapFeatureType:["annotations"],Style:["overlays"],LineGradient:["overlays"],CircleOverlay:["overlays"],PolylineOverlay:["overlays"],PolygonOverlay:["overlays"],Geocoder:["services"],Search:["services"],PlaceLookup:["services"],Directions:["services"],PointsOfInterestSearch:["services"],Map:["map"],maps:["map"],Annotation:["annotations"],PinAnnotation:["annotations"],ImageAnnotation:["annotations"],MarkerAnnotation:["annotations"],MapFeatureAnnotation:["annotations"],TileOverlay:["overlays"],Place:["services"],SearchAutocompleteResult:["services"],PointOfInterestCategory:["map","services"],PointOfInterestFilter:["map","services"],filterIncludingAllCategories:["map","services"],filterExcludingAllCategories:["map","services"],AddressCategory:["services"],AddressFilter:["services"],PlaceDetail:["map"],PlaceSelectionAccessory:["annotations"]});let Ev=!1;!function(t){t.loadAll=function(){this._chunkLoaded(Mv,(()=>this._dispatchLoadEndEvent(["all"])))}}(R),R.addEventListener(R.Events.LOAD,(function(t){const e=t.jsModules;if(e.mapkit)for(const t of Object.keys(e.mapkit)){const i=Av.indexOf(t);-1!==i&&(delete Sv.prototype[t],Av.splice(i,1)),Object.defineProperty(Sv.prototype,t,Object.getOwnPropertyDescriptor(e.mapkit,t))}if(!Ev&&R.jsModules.css&&R.jsModules.utils){const t=R.jsModules.utils.htmlElement("style",R.jsModules.css);t.nonce=kt.nonce,document.head.appendChild(t),Ev=!0}}));const xv=fe.findScriptAndSetBasePath();xv&&xv.nonce&&(kt.nonce=xv.nonce,kt.scriptBaseUrl=fe.scriptBaseUrl),R.loadAll(),function(t){if(!t)return;const e=t.dataset.callback,i=t.dataset.language,n=t.dataset.libraries,o=void 0!==t.dataset.token?t.dataset.token:t.dataset.initialToken,s=t.dataset.distUrl,a=t.dataset.proxyPrefix,r=t.dataset.countryCode,l=!("false"===t.dataset.shouldLogin),h=t.dataset.teamId,c={_shouldLogin:l,_teamId:h};if(t.src&&-1!==t.src.indexOf("sourcemap=1")&&(kt.enableSourceMap=!0),kt.setPerformanceMarkers(t.dataset.performanceMarkers),!(e||i||n||void 0!==o||s||a||r||h))return;i&&(c.language=i),(o||""===o&&a)&&(c.authorizationCallback=function(t){t(o)}),s&&(c._distUrl=s),a&&(c._proxyPrefixes=[a]),r&&(c.countryCode=r),kt.init(c,!0),e&&setTimeout((function(){"function"==typeof window[e]&&window[e]()}))}(xv),kt.state!==kt.States.UNINITIALIZED&&(kt.addEventListener(kt.Events.Changed,Lv),kt.addEventListener(kt.Events.Error,Lv));const Tv=Object.create(Sv.prototype);kt.performanceMarkers.loading&&performance.mark("mapkit-core-load");const Iv=Tv;window.mapkit&&window.mapkit.init&&console.warn("[MapKit] Mapkit namespace already exists; did you import MapKit more than once?"),window.mapkit=Iv})();
</script>

</body>
</html>
