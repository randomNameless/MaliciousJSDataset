"use strict";(()=>{(function(o,m){let C=o.ymab;if("ymab"in o&&typeof C=="function"&&C.inited)return;let V=o.requestAnimationFrame,b=o.location,Y=o.history,ve=10,Te=5e3,G=100,Ie=10*1e3/G,B={},E={},W={},R={enableRedir:!0,enableVisual:!0,enableHTML:!0,enableJS:!1,enableWatch:!1,enableAdv:!0,enableIntegrations:!0,storeRedirParam:!0,removeAbRedirParam:!1,metrikaTimeout:100,cookieDomain:void 0,nonce:void 0,storeReferer:!1,enableSendYmUid:!0,enableSetYmUid:!1},Se={enableRedir:["boolean"],enableVisual:["boolean"],enableHTML:["boolean"],enableJS:["boolean"],enableWatch:["boolean"],enableAdv:["boolean"],enableIntegrations:["boolean"],cookieDomain:["string"],metrikaTimeout:["number"],storeRedirParam:["boolean","string"],removeAbRedirParam:["boolean"],storeReferer:["boolean"],nonce:["string"],enableSendYmUid:["boolean"],enableSetYmUid:["boolean"]},T={},Re="https://uaas.yandex.ru/v1/exps/",K="_ymab_param",P="_ym_uid",x=60,ke=x*60*24*365,Ae="wSIKtymTfos,",X=/\/$/,v;function M({name:t,value:n,domain:e,ttl:r=ke}){let i=`${t}=${n}; path=/;`;if(b.protocol==="https:"&&(i+="SameSite=None; Secure;"),e){let s=e[0]==="."?1:0;b.hostname.indexOf(e.slice(s))>=0?i+=`domain=${e};`:console.error(`cookieDomain=${e} is not valid for current hostname`)}m.cookie=i+`max-age=${r};`}function O(t){let n=new RegExp(`(?:^|; )${t}=([^;]*)`,"g"),e,r;for(;(r=n.exec(m.cookie))!==null;)e=r[1];return e}function k(t,n){let e=t.indexOf(n);if(e===-1)return[];let r=t.slice(0,e).trim(),i=t.slice(e+1);return[r,i]}function Ee(t){return t.t==="integration"}function Pe(t,n){return t.reduce((e,r)=>{let{t:i,n:s,v:a}=r;if(n.enableIntegrations&&Ee(r))return e.integrations.push(r),e;if(i==="visual"&&n.enableVisual){let[l,d]=k(a,"|");if(!l||d===void 0)return e;switch(s){case"css-insert":return e.cssInsert.unshift({selector:l,value:d}),e;case"text-insert":return e.textInsert.unshift({selector:l,value:d}),e;case"href-insert":return e.hrefInsert.unshift({selector:l,value:d}),e;case"image-insert":return e.imageSrcInsert.unshift({selector:l,value:d}),e;case"html-replace":if(!n.enableHTML)break;return e.htmlReplace.unshift({selector:l,value:d}),e;case"js-insert":if(!n.enableJS)break;return e.jsInsert.unshift({selector:l,value:d}),e}}if(i==="redir"&&n.enableRedir)return e.redirect.push(a),e;if(i==="adv"&&n.enableAdv)return e.adv.push({type:s,value:a}),e;if(i==="advReplaceId"&&n.enableAdv)return e.advReplaceId[s]=a,e;let c=e.flags[s];return c||(e.flags[s]=c=[]),c.push(a),e},{cssInsert:[],textInsert:[],redirect:[],hrefInsert:[],imageSrcInsert:[],htmlReplace:[],jsInsert:[],adv:[],advReplaceId:{},flags:{},integrations:[]})}function xe(t){return t?m.querySelector(t):void 0}function Me(t,n){let e=[];for(let{selector:r,value:i}of t){let s=i.trim();e.push(`${r} {${s}}`)}try{let r=m.createElement("style");r.nonce=n,r.setAttribute("type","text/css"),r.textContent=e.join(`
`).replace(/;/g," !important;"),m.body.appendChild(r)}catch(r){}}function _e(t,n){try{let r=n.trim().split(";");for(let i of r)if(i){let[s,a]=k(i,":");s&&a!==void 0&&(t.style[s]=a)}}catch(e){}}function Ue(t,n,e,r){try{let i=m.createElement("script");i.nonce=t,i.setAttribute("type","text/javascript"),i.innerHTML=`(function(element){${e}})(document.querySelector('${r}'));`,m.body.appendChild(i)}catch(i){}}let z={};function Z(t,n){if(z[t])return;let e=m.createElement("script");e.async=!0,e.type="text/javascript",e.src=t,n&&e.addEventListener("load",n);let r=m.head;r.insertBefore(e,r.firstChild),z[t]=!0}let Le=new Set(["js-insert","css-insert"]),w={cache:{},getItem(t,n){let e=this.cache[t];e||(e=this.cache[t]={});let r=e[n.selector];r||(r=e[n.selector]={});let i=r[n.value];return i||(i=r[n.value]=new Set),i},has(t,n,e){return Le.has(t)&&this.getItem(t,n).has(e)},add(t,n,e){return this.getItem(t,n).add(e)}};function Q(t,n,e,r){let{selector:i,value:s}=e;if(!i||s===void 0)return;let a=xe(i);if(!a){r>0&&setTimeout(()=>Q(t,n,e,r-1),G);return}w.has(t,e,a)||(n(a,s,i),w.add(t,e,a))}function I(t,n,e,r){e.forEach(i=>Q(t,n,i,r?Ie:0))}class Fe{constructor(){this.callbacks={};this.MAX_DEPTH=1e3;this.depth=0;this.started=!1;this.item=new o.MutationObserver(()=>{if(this.depth++>=this.MAX_DEPTH){this.item.disconnect(),V(()=>this.observe());return}Object.values(this.callbacks).forEach(n=>n()),clearTimeout(this.depthTimeout),this.depthTimeout=setTimeout(()=>{this.depth=0},0)})}observe(){this.item.observe(m.body,{subtree:!0,childList:!0,characterData:!0,attributes:!0,attributeFilter:["class"]})}start(n,e){this.callbacks[n]=e,this.started||(this.observe(),this.started=!0)}}let Ve=new Fe,Oe=I.bind(null,"text-insert",(t,n)=>t.textContent===n||(t.textContent=n)),He=I.bind(null,"href-insert",(t,n)=>t.getAttribute("href")===n.trim()||t.setAttribute("href",n.trim())),De=I.bind(null,"image-insert",(t,n)=>t.getAttribute("src")===n.trim()||t.setAttribute("src",n.trim())),Ne=I.bind(null,"html-replace",(t,n)=>t.innerHTML===n||(t.innerHTML=n)),je=I.bind(null,"css-insert",_e),$e=(t,n,e)=>{I("js-insert",Ue.bind(null,n),t,e)};function ee(t){var r,i;let n=`yaCounter${t}`,e=o[n];if(!e)try{let s=((i=(r=o.Ya)==null?void 0:r._metrika)==null?void 0:i.counters)||{},a=Object.keys(s).find(c=>c.indexOf(`${t}:`)===0);return s[a||""]}catch(s){}return e}let te=!1;function H(t,n){return new Promise(e=>{var s;let r=k(t,".")[1];if(r)try{(s=o.ym)==null||s.call(o,r,"experiments",n)}catch(a){}function i(){if(!r){console.error(`Bad clientId = ${t}`);return}let a=ee(r);if(!a){setTimeout(i,10);return}try{a.experiments(n)}catch(c){}te=!0,e(!0)}i()})}function Je(t,n){var r;let e=k(t,".")[1];if(e){let i=ee(e);i?i.hit(b.href,{referer:n}):(r=o.ym)==null||r.call(o,e,"hit",b.href,{referer:n})}}function qe(t,n=b.href){if(t.length===0)return;let e=new URL(n),r=new URL(t,e.toString()),i=r.searchParams;r.protocol=e.protocol,r.hostname=e.hostname;let s=0,a=!0;if(e.searchParams.forEach((c,l)=>{if(l==="ab__exp_flags"||l==="vq__redir_param"){i.delete(l);return}let d=l==="ab_redir"||l==="vq__ab_redir",y=i.get(l);if(y===null){if(d)return;i.set(l,c)}else a&&!d&&y!==c&&(a=!1);s++}),a&&(a=s===Array.from(i.keys()).length),!a||e.pathname.replace(X,"")!==r.pathname.replace(X,""))return r}function Ye(t,n,e){let r;for(let y of t)if(r=qe(y),r)break;if(!r)return!1;let i=0;try{ne(n,e,r,()=>i=n.metrikaTimeout)}catch(y){i=n.metrikaTimeout}let s=r.toString(),a,c;function l(){clearTimeout(c),clearTimeout(a),b.replace(s)}c=setTimeout(l,i);function d(){if(!te){a=setTimeout(d,10);return}l()}return d(),!0}function ne(t,n,e,r){if(n){if(t.storeReferer&&m.referrer)try{let i={referer:m.referrer,url:b.href,ts:Date.now()};o.sessionStorage.setItem("vq__referer",JSON.stringify(i))}catch(i){}switch(t.storeRedirParam){case!0:case"localstorage":let i={experiments:n,ts:Date.now(),target:e.toString()};o.localStorage.setItem("vq__redir_param",JSON.stringify(i));break;case"cookie":M({name:"vq__redir_param",value:n,ttl:5*x,domain:t.cookieDomain});break;case"get":e.searchParams.set("vq__redir_param",n);break;default:r()}}}function Ge(t,n,e){if(typeof e!="string"||e.length===0)return;let r=e;try{let i=new URL(e,b.href);ne(t,n,i,()=>console.error("storeRedirParam is required")),r=i.toString()}catch(i){console.error(i)}return r}function Be(t){if(!v||typeof v!="object")return;v[t]===!0&&(v[t]=!1);let{callback:n}=v;if(n){for(let[e,r]of Object.entries(v)){let[i,s]=k(e,".");if(!(!i||!s)&&r===!0&&i.length>0&&!isNaN(Number(s)))return}setTimeout(n,0)}}function We(t){o.addEventListener("load",()=>{var a,c;let n=(c=(a=o.Ya)==null?void 0:a.Context)==null?void 0:c.AdvManager;if(!n)return;let e=n.getPlatform(),r=t[e];if(!r||!r.id)return;let i=l=>{o.yaContextCb.push(()=>{r&&r.id&&n.render({type:"inImage",blockId:r.id,renderTo:l})})},s=Array.from(m.querySelectorAll("img"));for(let l of s)l.id=`yandex_rtb_${r.id}-${Math.random().toString(16).slice(2)}`,l.tagName==="IMG"&&!l.complete?l.addEventListener("load",()=>{i(l.id)},{once:!0}):i(l.id)},{once:!0})}let Ke=(t,n)=>o.Math.floor(o.Math.random()*(n-t))+t,Xe=()=>[o.Math.round(o.Date.now()/1e3),Ke(1e6,999999999)].join("");function ze(t){let n=O(P);if(n)return n;try{let e=o.localStorage.getItem(P);if(e)return e}catch(e){}if(t.enableSetYmUid){let e=Xe();try{o.localStorage.setItem(P,e)}catch(r){}return M({name:P,value:e,domain:t.cookieDomain}),e}return""}function Ze(t,n){let e=6,r=0;function i(){var s;try{for(;r<n.length;r++)(s=n[r])==null||s.call(null,t)}catch(a){e-- >0?setTimeout(i,50):console.error(a)}}i()}function re(t,n,e){(T[t]||R).removeAbRedirParam&&(D("ab_redir"),D("vq__ab_redir")),e.length&&Ze(n,e),Be(t)}function we(t,n,e,r){let i=new URL(Re),s=i.searchParams;return s.set("client_id",String(t)),s.set("url",b.href),s.set("i",n||O(K)||""),r.enableSendYmUid&&s.set("duid",ze(r)),e&&s.set("client_features",JSON.stringify(e)),i.toString()}function D(t){let n=new URL(b.href),e=n.searchParams;if(e.has(t)){let r=e.get(t);try{e.delete(t),Y.replaceState(Y.state,"",n.toString())}catch(i){}return r||void 0}}function Qe(t){try{switch(t.storeRedirParam){case"cookie":{let n=O("vq__redir_param");return M({name:"vq__redir_param",value:"",ttl:0,domain:t.cookieDomain}),n}case"get":return D("vq__redir_param");case"localstorage":case!0:{let n=o.localStorage,e=n.getItem("vq__redir_param"),r;if(e){let i=JSON.parse(e);i.ts>Date.now()-5*x*1e3&&(r=i.experiments)}return n.removeItem("vq__redir_param"),r||void 0}}}catch(n){}}function A(t,n,e,r){if(typeof t!="string")throw new Error("clientId: should be string");W[t]=!0;let i=ve,s=T[t]||R,a=we(t,n,e,s),c=E[a];if(c)return r(c);let l=B[a]||(B[a]=[]);if(l.push(r),l.length>1)return;function d(){if(E[a])return;let p={flags:{},i:n,experiments:void 0,prepareUrl:f=>typeof f=="string"?f:void 0,getBlockId:f=>typeof f=="string"?f:void 0};E[a]=p,H(t,Ae),re(t,p,l)}let y=setTimeout(d,Te);function _(p){var pe,he;let f=T[t]||R,{flags:tt,redirect:oe,htmlReplace:le,adv:ce,advReplaceId:nt,integrations:rt,cssInsert:U,textInsert:ue,hrefInsert:de,jsInsert:fe,imageSrcInsert:ge}=Pe(p.flags,f),L=Object.assign({},p,{flags:tt,prepareUrl:Ge.bind(null,f,p.experiments),getBlockId:at});p.i&&(n=p.i);let J=Qe(f),S=Promise.resolve();J&&J!==p.experiments&&(S=S.then(()=>H(t,J))),S=S.then(()=>H(t,p.experiments));try{let u=o.sessionStorage,h=u.getItem("vq__referer");if(h){let g=JSON.parse(h);g&&g.ts>Date.now()-5*x*1e3&&g.url===m.referrer&&(S=S.then(()=>{Je(t,g.referer),u.removeItem("vq__referer")}))}}catch(u){}clearTimeout(y),E[a]=L,L.i&&M({name:K,value:L.i,domain:f.cookieDomain});function me(u=!1){le.length&&Ne(le,u),de.length&&He(de,u),ge.length&&De(ge,u),ue.length&&Oe(ue,u),U.length&&je(U,u),fe.length&&$e(fe,f.nonce,u)}function it(u){try{return JSON.parse(u)}catch(h){}}rt.forEach(u=>{let h=it(u.v);h&&ae(u.n,h.version,()=>{o.dispatchEvent(new CustomEvent("init-plugin",{detail:{t:u.t,n:u.n,v:h}}))})});function st(){f.enableVisual&&(U.length&&Me(U,f.nonce),f.enableWatch&&Ve.start(t,me),me(!f.enableWatch)),re(t,L,l)}function at(u){var h;try{let g=JSON.parse((h=nt[u])!=null?h:"");return(g==null?void 0:g.toId)||u}catch(g){return u}}function ot(){for(let{type:u,value:h}of ce)try{let g=JSON.parse(h);if(typeof g!="object"||g===null)continue;if(u==="in_image"){We(g);continue}o.yaContextCb.push(()=>{var ye,Ce;let q=(Ce=(ye=o.Ya)==null?void 0:ye.Context)==null?void 0:Ce.AdvManager;if(!q)return;let be=q.getPlatform(),F=g[be];F&&F.id&&q.render({type:u,platform:be,blockId:F.id,renderTo:F.renderTo})})}catch(g){}}(!oe.length||!Ye(oe,f,p.experiments))&&(V(st),ce.length&&(o.yaContextCb||(o.yaContextCb=[]),(he=(pe=o.Ya)==null?void 0:pe.Context)!=null&&he.AdvManager||Z("https://yandex.ru/ads/system/context.js"),V(ot)))}function $(){if(--i>0)return ie(a,_,$);clearTimeout(y),d()}try{localStorage.removeItem("vq__redirect_param")}catch(p){}ie(a,_,$)}function ie(t,n,e){let r=new XMLHttpRequest;return r.open("GET",t),r.addEventListener("load",function(){if(r.status===200){try{let i=JSON.parse(r.responseText);n(i)}catch(i){i instanceof Error&&e(i.message)}return}e(r.statusText)}),r.addEventListener("error",()=>e(r.statusText)),r.send()}let N={init:(t,n,e,r)=>{A(t,n,e,i=>r&&r(i))},getFlags:(t,n,e,r)=>{A(t,n,e,i=>r&&r(i.flags))},getExperiments:(t,n,e,r)=>{A(t,n,e,i=>r&&r(i.experiments))},getParam:(t,n,e,r)=>{A(t,n,e,i=>r&&r(i.i))},setConfig:(t,n,e,r)=>{se(t,e),r&&r()},getConfig:(t,n,e,r)=>{let i=T[t]||R,s=Object.assign({},i);delete s.nonce,r&&r(s)},adv:(t,n,e,r)=>{A(t,n,e,i=>r&&r(i))}};function se(t,n){var e;if(typeof n=="object"){let r=T[t]||(T[t]=Object.assign({},R)),i=Object.keys(n);for(let s of i)if(s in r){let a=s,c=n[a];(e=Se[a])!=null&&e.includes(typeof c)&&(r[a]=c)}}}function et(t){let{clientId:n,config:e}=t;if(!n)throw new Error("clientId is required");se(n,e),N.init(n,t.i,t.clientFeatures,t.callback)}function ae(t,n,e){let r=n==="beta";(r||/^(\d\.)+\d+$/.test(n)&&/^[a-z0-9-]+$/ig.test(t))&&Z(`https://abt.s3.yandex.net/${t}/${r?"":"v"}${n}/main.js`,e)}function j(t,n,e,r,i){if(typeof t=="object")return et(t);if(!n)throw new Error("method not specified");if(!(n in N))throw new Error("unknown method");typeof r=="function"&&(i=r,r={}),typeof e=="function"&&(i=e,e=void 0),typeof e=="object"&&(r=e,e=void 0),r||(r={}),N[n](t,e,r,i)}C&&(Array.isArray(C.a)&&C.a.forEach(t=>j.apply(null,t)),typeof C.antiFlicker=="object"&&(v=C.antiFlicker)),j.inited=!0,o.ymab=j,function(t){let n=["ru","ua","by","kz","com","com.tr"];function e(s){if(!s)return null;if(typeof s!="string")return s;try{return JSON.parse(s)}catch(a){return null}}function r(s){let a=new URL(s),{hostname:c,protocol:l}=a,d=(c==null?void 0:c.split("."))||[];d[1]==="test"&&d.splice(1,1);let[y,_]=d,p=d.slice(2).join(".");return l==="https:"&&y==="ab"&&_==="yandex"&&n.indexOf(p)!==-1}function i(s){let a=s.origin;if(!a||!r(a))return;let c=e(s.data);if(!(!c||!W[c.clientId]))switch(c.type){case"appendplugin":ae(c.plugin,c.version);break}}t.addEventListener("message",i)}(o)})(window,document);})();
