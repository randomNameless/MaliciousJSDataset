<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>page-search.8cb29546fd4f.mo.html</title>
</head>
<body>

<script>
(self.webpackChunkpikabu=self.webpackChunkpikabu||[]).push([[960],{17311:(e,t,a)=>{"use strict";a.d(t,{t0:()=>r.t0,et:()=>r.et,xd:()=>s.x,$F:()=>r.$F,h1:()=>r.h1,hR:()=>r.hR,ch:()=>r.ch,vf:()=>s.v,P:()=>u});var s=a(67133),r=a(69288),i=(a(41817),a(73736)),l=a(42107),n=a(63907),o=a(12953);function c(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class u extends n.u1{constructor(e){var t;super(e),c(this,"_isTagsPage",!1);const{isTagsPage:a=!1}=null!==(t=o.core.config("modules.searchConfig"))&&void 0!==t?t:{};this.isTagsPage=a}setSortingByAnlParam(e){this.isTagsPage&&(l.cp.getInstance().commonParameters.sorting_by=e,i.dV.commonParameters.sorting_by=e)}set isTagsPage(e){this._isTagsPage=e}get isTagsPage(){return this._isTagsPage}}},39364:(e,t,a)=>{"use strict";a.r(t),a.d(t,{createApp:()=>Mt});var s=a(76944),r=a(66252),i=a(3577),l=a(2262),n=a(66309),o=a(62728),c=a(75645);var u=a(7996),d=a.n(u),p=a(83744);const h={},_={};_.$style=d();const g=(0,p.Z)(h,[["render",function(e,t){return(0,r.wg)(),(0,r.iD)("div",{class:(0,i.C_)(e.$style.host)},[e.$slots.legend?((0,r.wg)(),(0,r.iD)("div",{key:0,class:(0,i.C_)(e.$style.legend)},[(0,r.WI)(e.$slots,"legend")],2)):(0,r.kq)("v-if",!0),(0,r.WI)(e.$slots,"default")],2)}],["__cssModules",_]]);a(74916),a(66992),a(33948),a(88674);var m=a(41218),v=(a(41817),a(49963)),f=a(28959),y=a(66037),b=a(85983),w=a(50451),k=a(40094),x=a(53329),T=a(55529);function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(Object(a),!0).forEach((function(t){S(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function S(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const $=["disabled"],U=(0,r.aZ)({__name:"pkb-input-filter",props:{modelValue:{},dropdownItems:{},dropdownLabelName:{},size:{default:"medium"},theme:{default:"normal"},inputValue:{},label:{default:"Добавить"},loading:{type:Boolean},error:{type:[Boolean,String],default:!1},disabled:{type:Boolean},maxItems:{default:void 0},borderless:{type:Boolean},iconName:{default:"ic_plus_small"}},emits:["update:modelValue","update:inputValue","add","dropdown:show","dropdown:clear","enter"],setup(e,{expose:t,emit:a}){const s=e,o=(0,l.iH)(),u=(0,l.iH)(),d=(0,l.iH)(),p=(0,r.Fl)((()=>s.dropdownItems.length>0&&s.inputValue.length>0)),h=(0,l.iH)([]),_=a,{focused:g}=(0,n.L_M)(u),{focused:m}=(0,n.L_M)(d),{floatingStyles:D}=(0,f.YF)(o,d,{whileElementsMounted:y.Me,middleware:[(0,y.RR)(),(0,b.cv)(4)],placement:"bottom",strategy:"absolute",transform:!1}),S=(0,r.Fl)({get:()=>s.modelValue,set(e){_("update:modelValue",e)}}),U=(0,r.Fl)({get:()=>s.inputValue,set(e){_("update:inputValue",e)}}),F=(0,r.Fl)((()=>{var e;return C(C({},D.value),{},{zIndex:(0,T.e)(),width:((null===(e=o.value)||void 0===e?void 0:e.offsetWidth)||"0")+"px"})}));function E(){_("dropdown:clear")}function P(){var e;null===(e=u.value)||void 0===e||e.focus()}function M(){var e;null===(e=u.value)||void 0===e||e.blur(),E()}async function O(){const e=u.value;e&&(e.style.width="0",e.style.width=`${e.scrollWidth+1}px`)}return(0,r.YP)(S,(async(e,t)=>{t.length===s.maxItems&&(await(0,r.Y3)(),O())})),(0,r.YP)(U,O,{flush:"post"}),(0,r.bv)(O),t({focus:P}),(e,t)=>((0,r.wg)(),(0,r.iD)("div",{ref_key:"hostEl",ref:o,class:(0,i.C_)(e.$style.host)},[(0,r.Wm)(w.Z,{class:(0,i.C_)(e.$style.baseInput),error:s.error,disabled:s.disabled,loading:s.loading,empty:!S.value.length&&!U.value,size:s.size,theme:s.theme,borderless:s.borderless,onClick:t[4]||(t[4]=e=>P())},{default:(0,r.w5)((()=>[(0,r._)("div",{class:(0,i.C_)([e.$style.wrapper,{[e.$style.wrapper_padding]:!s.loading}])},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(S.value,((t,a)=>(0,r.WI)(e.$slots,"item",{key:a,item:t}))),128)),!s.maxItems||S.value.length<s.maxItems?((0,r.wg)(),(0,r.iD)("div",{key:0,class:(0,i.C_)(e.$style.inputWrapper)},[(0,r._)("div",{class:(0,i.C_)(e.$style.inputContainer)},[(0,r.wy)((0,r._)("input",{ref_key:"inputEl",ref:u,"onUpdate:modelValue":t[0]||(t[0]=e=>U.value=e),class:(0,i.C_)([e.$style.input,{[e.$style.input_empty]:!U.value}]),disabled:s.disabled,onKeydown:[t[1]||(t[1]=(0,v.D2)((e=>{s.disabled||U.value||(S.value=S.value.slice(0,-1))}),["backspace"])),t[2]||(t[2]=(0,v.D2)((0,v.iM)((e=>M()),["prevent"]),["esc"])),t[3]||(t[3]=(0,v.D2)((0,v.iM)((e=>{var t;return null===(t=h.value[0])||void 0===t?void 0:t.focus()}),["prevent"]),["down"]))]},null,42,$),[[v.nr,U.value]])],2),(0,r._)("span",{class:(0,i.C_)(e.$style.inputLabel),style:(0,i.j5)({visibility:U.value?"hidden":"visible"})},[s.iconName?((0,r.wg)(),(0,r.j4)(k.Z,{key:0,name:s.iconName,size:20},null,8,["name"])):(0,r.kq)("v-if",!0),(0,r.Uk)(" "+(0,i.zw)(s.label),1)],6)],2)):(0,r.kq)("v-if",!0)],2)])),_:3},8,["class","error","disabled","loading","empty","size","theme","borderless"]),(0,r.Wm)(c.Z,null,{default:(0,r.w5)((()=>[((0,l.SU)(g)||(0,l.SU)(m))&&p.value?((0,r.wg)(),(0,r.iD)("div",{key:0,ref_key:"dropdownEl",ref:d,class:(0,i.C_)(e.$style.dropdown),style:(0,i.j5)(F.value)},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(s.dropdownItems,((a,i)=>((0,r.wg)(),(0,r.j4)(x.Z,{ref_for:!0,ref_key:"itemsRefs",ref:h,key:i,index:i,label:String(a[s.dropdownLabelName]),"items-refs":h.value,selection:U.value,onClick:e=>_("add",a),onEnter:e=>_("add",a),onEsc:t[5]||(t[5]=e=>async function(){P(),await(0,r.Y3)(),E()}()),"onNavigation:first":t[6]||(t[6]=e=>P())},{prefix:(0,r.w5)((()=>[(0,r.WI)(e.$slots,"dropdownItemPrefix",{item:a})])),suffix:(0,r.w5)((()=>[(0,r.WI)(e.$slots,"dropdownItemSuffix",{item:a})])),_:2},1032,["index","label","items-refs","selection","onClick","onEnter"])))),128))],6)):(0,r.kq)("v-if",!0)])),_:3})],2))}});var F=a(23441),E=a.n(F);const P={};P.$style=E();const M=(0,p.Z)(U,[["__cssModules",P]]),O=(0,r.aZ)({__name:"pkb-input-filter-item",emits:["remove"],setup(e,{emit:t}){const a=t;return(e,t)=>((0,r.wg)(),(0,r.iD)("div",{class:(0,i.C_)(e.$style.host)},[(0,r.WI)(e.$slots,"default"),(0,r.Wm)(k.Z,{class:(0,i.C_)(e.$style.removeButton),name:"ic_close",onClick:t[0]||(t[0]=e=>a("remove"))},null,8,["class"])],2))}});var V=a(13521),I=a.n(V);const j={};j.$style=I();const W=(0,p.Z)(O,[["__cssModules",j]]);var N=a(32453),A=a(12950);const B={all:["tag"],search:({query:e})=>[...B.all,"search",{query:e}]};var R=a(17311);const Z=(0,r.aZ)({__name:"tags-input-filter-view",props:{modelValue:{},mode:{default:"include"}},emits:["update:modelValue","add","remove"],setup(e,{emit:t}){const a=e,s=t,n=(0,l.iH)(),o=(0,l.iH)([]),c=(0,l.iH)(""),u=(0,m.VW)(c,500),d=(0,r.Fl)((()=>u.value.length>1)),p=(0,r.Fl)((()=>"include"===a.mode)),h=(0,r.Fl)({get:()=>a.modelValue,set(e){s("update:modelValue",e)}}),{data:_,isLoading:g}=(({queryKey:e,enabled:t})=>(0,N.a)({queryKey:e,enabled:t,queryFn:async({queryKey:e})=>{const{query:t}=e[2],{data:a}=await A.cf.postOrFail("/ajax/tags_actions.php",{action:"droplist",value:t,filter:"search"});return a}}))({queryKey:(0,r.Fl)((()=>B.search({query:u.value}))),enabled:d});function v(){o.value=[]}function f(){var e;null===(e=n.value)||void 0===e||e.focus()}function y(e){return e===R.$F?"[моё]":e}return(0,r.YP)(_,(e=>{e?(f(),o.value=e.filter((([e])=>h.value.every((t=>t!==e)))).map((([e,t])=>({displayName:y(e),count:t,name:e})))):v()})),(e,t)=>((0,r.wg)(),(0,r.j4)(M,{ref_key:"inputFilterRef",ref:n,modelValue:h.value,"onUpdate:modelValue":t[0]||(t[0]=e=>h.value=e),"input-value":c.value,"onUpdate:inputValue":t[1]||(t[1]=e=>c.value=e),theme:"gray",class:(0,i.C_)(e.$style.host),loading:(0,l.SU)(g)&&d.value,"dropdown-items":o.value,label:p.value?"Добавить":"Исключить","icon-name":p.value?"ic_plus_small":"ic_minus_small","dropdown-label-name":"displayName","onDropdown:clear":t[2]||(t[2]=e=>v()),onAdd:t[3]||(t[3]=e=>async function({name:e}){c.value="",h.value.push(e),s("add",e),await(0,r.Y3)(),f()}(e))},{item:(0,r.w5)((({item:t})=>[(0,r.Wm)(W,{class:(0,i.C_)(e.$style.tag),onRemove:e=>{return a=t,h.value=h.value.filter((e=>e!==a)),void s("remove",a);var a}},{default:(0,r.w5)((()=>[(0,r.Uk)((0,i.zw)(y(t)),1)])),_:2},1032,["class","onRemove"])])),dropdownItemSuffix:(0,r.w5)((({item:e})=>[(0,r.Uk)((0,i.zw)(e.count),1)])),_:1},8,["modelValue","input-value","class","loading","dropdown-items","label","icon-name"]))}});var L=a(35834),H=a.n(L);const z={};z.$style=H();const q=(0,p.Z)(Z,[["__cssModules",z]]);var Y=a(69876),G=a(12953);const K=G.core.config("modules.searchDateFrom")||"",X=G.core.config("modules.searchDateTo")||"",Q=G.core.config("modules.searchRating")||0,J=G.core.config("modules.searchType")||R.hR.ANY,ee=G.core.config("modules.searchTags")||[],te=G.core.config("modules.searchExcludeTags")||[],ae="h"===G.core.config("modules.searchVisited"),se=G.core.config("modules.searchUser"),re=G.core.config("modules.searchCommunity"),ie=G.core.config("modules.searchConfig").isAdultVisible,le=(0,Y.Q_)("storiesSearchFilter",{state:()=>({dateFrom:K,dateTo:X,rating:Q,type:J,tags:ee,excludeTags:te,visited:ae,user:se.id?se:null,community:re.id?re:null,isAdultVisible:ie}),actions:{isStoriesTypeActive(e){return this.type!==R.hR.ANY&&(this.type&e)===e},applyMineTagIfNeeded(e){e?this.tags=this.tags.filter((e=>e!==R.$F)):this.tags.every((e=>e!==R.$F))&&this.tags.push(R.$F)},applyNsfwTagIfNeeded(e){e?this.tags=this.tags.filter((e=>e!==R.h1)):this.tags.every((e=>e!==R.h1))&&this.tags.push(R.h1)},clearMineAndNsfwTags(){this.tags=this.tags.filter((e=>e!==R.$F&&e!==R.h1))},activateType(e){this.type|=e},deactivateType(e){this.type&=~e}},getters:{isTypeActive:e=>t=>e.type!==R.hR.ANY&&(e.type&t)===t}}),ne=(0,r.aZ)({__name:"tags-fieldset-view",setup(e){const t=le();return(e,a)=>((0,r.wg)(),(0,r.j4)(g,null,{legend:(0,r.w5)((()=>[(0,r.Uk)(" Теги ")])),default:(0,r.w5)((()=>[(0,r.Wm)(q,{modelValue:(0,l.SU)(t).tags,"onUpdate:modelValue":a[0]||(a[0]=e=>(0,l.SU)(t).tags=e),mode:"include",onAdd:a[1]||(a[1]=e=>{var a;(a=e)===R.$F?t.activateType(R.hR.MINE):a===R.h1&&t.activateType(R.hR.NSFW)}),onRemove:a[2]||(a[2]=e=>{var a;(a=e)===R.$F?t.deactivateType(R.hR.MINE):a===R.h1&&t.deactivateType(R.hR.NSFW)})},null,8,["modelValue"]),(0,r.Wm)(q,{modelValue:(0,l.SU)(t).excludeTags,"onUpdate:modelValue":a[3]||(a[3]=e=>(0,l.SU)(t).excludeTags=e),mode:"exclude"},null,8,["modelValue"])])),_:1}))}});var oe=a(20252),ce=a(16723);const ue=(0,r.aZ)({__name:"user-fieldset-view",setup(e){const t=le(),a=(0,r.Fl)((()=>t.user?[t.user]:[])),s=(0,l.iH)(),n=(0,l.iH)([]),o=(0,l.iH)(""),c=(0,m.VW)(o,500),u=(0,r.Fl)((()=>c.value.length>2)),{data:d,isLoading:p}=(0,ce.s1)({queryKey:(0,r.Fl)((()=>ce.TZ.searchUsers({query:c.value}))),enabled:u});function h(){n.value=[]}function _(){var e;null===(e=s.value)||void 0===e||e.focus()}return(0,r.YP)(d,(e=>{e?(_(),n.value=e):h()})),(e,c)=>((0,r.wg)(),(0,r.j4)(g,null,{legend:(0,r.w5)((()=>[(0,r.Uk)(" Автор ")])),default:(0,r.w5)((()=>[(0,r.Wm)(M,{ref_key:"inputFilterRef",ref:s,modelValue:a.value,"onUpdate:modelValue":c[1]||(c[1]=e=>a.value=e),"input-value":o.value,"onUpdate:inputValue":c[2]||(c[2]=e=>o.value=e),theme:"gray",class:(0,i.C_)(e.$style.inputFilter),loading:(0,l.SU)(p)&&u.value,"dropdown-items":n.value,"max-items":1,"icon-name":"ic_plus_small",label:"Добавить","dropdown-label-name":"name","onDropdown:clear":c[3]||(c[3]=e=>h()),onAdd:c[4]||(c[4]=e=>async function(e){o.value="",t.user=e.id?{id:e.id,name:e.name,avatar:e.avatar}:null,await(0,r.Y3)(),_()}(e))},{item:(0,r.w5)((({item:a})=>[a?((0,r.wg)(),(0,r.j4)(W,{key:0,class:(0,i.C_)(e.$style.user),onRemove:c[0]||(c[0]=e=>{t.user=null})},{default:(0,r.w5)((()=>[(0,r.Wm)(oe.Z,{src:a.avatar,size:20,class:(0,i.C_)(e.$style.avatar)},null,8,["src","class"]),(0,r.Uk)(" "+(0,i.zw)(a.name),1)])),_:2},1032,["class"])):(0,r.kq)("v-if",!0)])),dropdownItemPrefix:(0,r.w5)((({item:e})=>[(0,r.Wm)(oe.Z,{src:e.avatar,size:20},null,8,["src"])])),_:1},8,["modelValue","input-value","class","loading","dropdown-items"])])),_:1}))}});var de=a(29436),pe=a.n(de);const he={};he.$style=pe();const _e=(0,p.Z)(ue,[["__cssModules",he]]);a(2707);var ge=a(37043),me=(a(15306),a(50542));const ve=(0,r.aZ)({__name:"pkb-date-input",props:{modelValue:{}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,s=t,i=(0,l.iH)("");function n(e){return e.replace(/[^\d.]/g,"")}function o(e){let[t="",a="",s=""]=e.replace(/[^\d.]/g,"").split(".").map(((e,t)=>e.slice(0,2===t?4:2)));1===t.length&&e.endsWith(".")&&(t="0"+t),1===a.length&&e.endsWith(".")&&(a="0"+a);2===a.length&&Number(a)>12&&(a=String(12));const r=function(e,t=0){if(!e)return 31;if(!t&&2===e)return 29;return new Date(t,e,0).getDate()}(2===a.length?Number(a):void 0,4===s.length?Number(s):void 0);2===t.length&&Number(t)>r&&(t=String(r));let i=[t,a,s].filter(Boolean).join(".");return!e.endsWith(".")||2!==i.length&&5!==i.length||(i+="."),i}function c(e){const t=i.value.slice(0,10);10!==t.length?!e&&t.length||s("update:modelValue",void 0):s("update:modelValue",t.split(".").reverse().join("-"))}return(0,r.YP)((()=>a.modelValue),(e=>{i.value=e?e.split("-").reverse().join("."):""}),{immediate:!0}),(0,r.YP)(i,(()=>c(!1))),(e,t)=>((0,r.wg)(),(0,r.j4)(me.Z,{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value=e),clean:n,format:o,placeholder:"ДД.ММ.ГГГГ",onBlur:t[1]||(t[1]=e=>c(!0))},null,8,["modelValue"]))}});var fe=a(34653);function ye(e){if(!e)return;const[t,a,s]=e.split("-").map(Number);return Date.UTC(t,a-1,s)}function be(e){return new Date(e).toISOString().slice(0,10)}function we(e){const[t,a]=e.split("-").map(Number);return new Date(Date.UTC(t,a-1))}function ke(e){return e.toISOString().slice(0,7)}function xe(e){const[t,a,s]=e.split("-").map(Number);return new Date(Date.UTC(t,a-1,s))}const Te=["onPointerenter","onClick"],De=(0,r.aZ)({__name:"calendar-sheet",props:{month:{},start:{},end:{}},emits:["update:month","hover:day","click:day"],setup(e,{emit:t}){const a=e,s=t,l=["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],n=(0,r.Fl)({get:()=>a.month,set:e=>s("update:month",e)}),c=(0,r.Fl)((()=>(0,fe.p)(we(n.value),{month:"long",year:"numeric"}))),u=(0,r.Fl)((()=>{const e=we(n.value),t=(e.getUTCDay()+6)%7;return e.setUTCDate(e.getUTCDate()-t)})),d=(0,r.Fl)((()=>{const e=we(n.value);e.setUTCMonth(e.getUTCMonth()+1,0);const t=(e.getUTCDay()+6)%7;return e.setUTCDate(e.getUTCDate()-t+6)})),p=(0,r.Fl)((()=>{const e=[],t=new Date(u.value),s=we(n.value).getUTCMonth();let r=t.getTime();const i=ye(a.start),l=ye(a.end);for(;r<=d.value;){const a=t.getUTCDate();e.push({key:r,date:t.toISOString().split("T")[0],text:a,isMuted:t.getUTCMonth()!==s,isStart:i===r,isEnd:l===r,isBetween:i&&i<r&&l&&l>r}),r=t.setUTCDate(a+1)}return e}));function h(e){const t=we(n.value);t.setUTCMonth(t.getUTCMonth()+e),n.value=ke(t)}return(e,t)=>((0,r.wg)(),(0,r.iD)("div",{class:(0,i.C_)(e.$style.host)},[(0,r._)("div",{class:(0,i.C_)(e.$style.month)},[(0,r.Wm)(o.Z,{"icon-name":"arrow-left_20",onClick:t[0]||(t[0]=e=>h(-1))}),(0,r._)("span",{class:(0,i.C_)(e.$style.monthTitle)},(0,i.zw)(c.value),3),(0,r.Wm)(o.Z,{"icon-name":"arrow-right_20",onClick:t[1]||(t[1]=e=>h(1))})],2),t[2]||((0,r.qZ)(-1),t[2]=(0,r._)("div",{class:(0,i.C_)(e.$style.weekDays)},[((0,r.wg)(),(0,r.iD)(r.HY,null,(0,r.Ko)(l,(t=>(0,r._)("div",{key:t,class:(0,i.C_)(e.$style.weekDay)},(0,i.zw)(t),3))),64))],2),(0,r.qZ)(1),t[2]),(0,r._)("div",{class:(0,i.C_)(e.$style.days)},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(p.value,(t=>((0,r.wg)(),(0,r.iD)("div",{key:t.key,class:(0,i.C_)({[e.$style.day]:!0,[e.$style.day_muted]:t.isMuted,[e.$style.day_start]:t.isStart,[e.$style.day_end]:t.isEnd,[e.$style.day_between]:t.isBetween}),onPointerenter:e=>s("hover:day",t.date),onClick:e=>s("click:day",t.date)},(0,i.zw)(t.text),43,Te)))),128))],2)],2))}});var Ce=a(45117),Se=a.n(Ce);const $e={};$e.$style=Se();const Ue=(0,p.Z)(De,[["__cssModules",$e]]),Fe=(0,r.aZ)({__name:"range-picker",props:{approveText:{},start:{},end:{}},emits:["update:start","update:end","approve"],setup(e,{emit:t}){const a=e,s=t,n=(0,l.iH)(ke(function(){const e=a.start&&a.end&&a.start.slice(0,7)===a.end.slice(0,7);if(a.start&&!e)return xe(a.start);const t=y();return new Date(Date.UTC(t.getFullYear(),t.getMonth()-1))}())),o=(0,l.iH)(ke(y())),c=(0,l.iH)(),u=(0,l.iH)();let d=!1;const p=(0,r.Fl)((()=>f(c.value,u.value)>0)),h=(0,r.Fl)({get:()=>p.value?u.value:c.value,set:e=>p.value?u.value=e:c.value=e}),_=(0,r.Fl)({get:()=>p.value?c.value:u.value,set:e=>p.value?c.value=e:u.value=e});function g(e){d&&(u.value=e)}function m(e){d||(c.value=e),u.value=e,d=!d}function v(e){return e.slice().sort(f)}function f(e,t){var a,s;return(null!==(a=ye(e))&&void 0!==a?a:1/0)-(null!==(s=ye(t))&&void 0!==s?s:1/0)}function y(){if(a.end)return xe(a.end);const e=new Date;return new Date(Date.UTC(e.getFullYear(),e.getMonth()))}return(0,r.YP)([()=>a.start,()=>a.end],(e=>{const[t,a]=v(e);c.value=t,u.value=a}),{immediate:!0}),(e,t)=>((0,r.wg)(),(0,r.iD)("div",{class:(0,i.C_)(e.$style.host)},[(0,r._)("div",{class:(0,i.C_)(e.$style.sheets)},[e.IS_MOBILE?(0,r.kq)("v-if",!0):((0,r.wg)(),(0,r.j4)(Ue,{key:0,month:n.value,"onUpdate:month":t[0]||(t[0]=e=>n.value=e),class:(0,i.C_)(e.$style.sheet),start:h.value,end:_.value,"onHover:day":g,"onClick:day":m},null,8,["month","class","start","end"])),(0,r.Wm)(Ue,{month:o.value,"onUpdate:month":t[1]||(t[1]=e=>o.value=e),class:(0,i.C_)(e.$style.sheet),start:h.value,end:_.value,"onHover:day":g,"onClick:day":m},null,8,["month","class","start","end"])],2),(0,r._)("div",{class:(0,i.C_)(e.$style.footer)},[(0,r.Wm)(ve,{modelValue:h.value,"onUpdate:modelValue":t[2]||(t[2]=e=>h.value=e),class:(0,i.C_)(e.$style.input),theme:"gray",inputmode:"numeric"},null,8,["modelValue","class"]),(0,r.Wm)(k.Z,{class:(0,i.C_)(e.$style.separator),name:"arrow_left_full",size:20},null,8,["class"]),(0,r.Wm)(ve,{modelValue:_.value,"onUpdate:modelValue":t[3]||(t[3]=e=>_.value=e),class:(0,i.C_)(e.$style.input),theme:"gray",inputmode:"numeric"},null,8,["modelValue","class"]),(0,r.Wm)(ge.Z,{class:(0,i.C_)(e.$style.approve),label:a.approveText,disabled:!h.value||!_.value,wide:e.IS_MOBILE,onClick:t[4]||(t[4]=e=>function(){const[e,t]=v([c.value,u.value]);s("update:start",e),s("update:end",t),s("approve",[e,t])}())},null,8,["class","label","disabled","wide"])],2)],2))}});var Ee=a(23200),Pe=a.n(Ee);const Me={};Me.$style=Pe();const Oe=(0,p.Z)(Fe,[["__cssModules",Me]]);var Ve=a(17430),Ie=a.n(Ve);const je={},We={};We.$style=Ie();const Ne=(0,p.Z)(je,[["render",function(e,t){return(0,r.wg)(),(0,r.iD)("div",{class:(0,i.C_)(e.$style.host)},[(0,r.WI)(e.$slots,"default")],2)}],["__cssModules",We]]),Ae=(0,r.aZ)({__name:"filter-tab-view",props:{label:{},active:{type:Boolean}},setup(e){const t=e;return(e,a)=>((0,r.wg)(),(0,r.iD)("span",{class:(0,i.C_)([e.$style.host,{[e.$style.host_active]:t.active}])},(0,i.zw)(t.label),3))}});var Be=a(33742),Re=a.n(Be);const Ze={};Ze.$style=Re();const Le=(0,p.Z)(Ae,[["__cssModules",Ze]]);var He=a(85679),ze=a(74750);const qe={ALL:"Все время",TODAY:"Сегодня",WEEK:"Неделя",MONTH:"Месяц",DATE:"Выбрать дату"},Ye={ANY:"Любые",TEXT:"Текстовые",IMAGE:"Картинки",VIDEO:"Видео",MINE:"[моё]",NSFW:ze.x};function Ge(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function Ke(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(a),!0).forEach((function(t){Xe(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ge(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Xe(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const Qe=(0,r.aZ)({__name:"period-tabs-view",setup(e){const t=le(),a=(0,l.iH)(qe.ALL),s=(0,l.iH)(),o=(0,l.iH)(),u=(0,l.iH)(!1),{floatingStyles:d}=(0,f.YF)(s,o,{whileElementsMounted:y.Me,middleware:[(0,y.RR)(),(0,b.cv)(4)],placement:"bottom",strategy:"absolute",transform:!1});function p(e){a.value=e;const s=Date.now();e===qe.MONTH?(t.dateFrom=be(s-He.$E),t.dateTo=be(s)):e===qe.WEEK?(t.dateFrom=be(s-He.P0),t.dateTo=be(s)):e===qe.TODAY?(t.dateFrom=be(s),t.dateTo=""):e===qe.DATE?u.value=!0:(t.dateFrom="",t.dateTo="")}(0,r.wF)((()=>{t.dateFrom&&(a.value=qe.DATE)}));const h=(0,r.Fl)((()=>{if(!t.dateFrom)return qe.DATE;const e=xe(t.dateFrom);let a=String(e.getDate()).padStart(2,"0")+"."+String(e.getMonth()+1).padStart(2,"0")+"."+e.getFullYear();if(t.dateTo){const e=xe(t.dateTo);a+=" - "+String(e.getDate()).padStart(2,"0")+"."+String(e.getMonth()+1).padStart(2,"0")+"."+e.getFullYear()}return a}));return(0,n.i9H)(o,(()=>u.value=!1),{ignore:[s]}),(e,n)=>((0,r.wg)(),(0,r.j4)(g,null,{legend:(0,r.w5)((()=>[(0,r.Uk)(" Период ")])),default:(0,r.w5)((()=>[(0,r.Wm)(Ne,null,{default:(0,r.w5)((()=>[(0,r.Wm)(Le,{label:(0,l.SU)(qe).ALL,active:a.value===(0,l.SU)(qe).ALL,onClick:n[0]||(n[0]=e=>p((0,l.SU)(qe).ALL))},null,8,["label","active"]),(0,r.Wm)(Le,{label:(0,l.SU)(qe).TODAY,active:a.value===(0,l.SU)(qe).TODAY,onClick:n[1]||(n[1]=e=>p((0,l.SU)(qe).TODAY))},null,8,["label","active"]),(0,r.Wm)(Le,{label:(0,l.SU)(qe).WEEK,active:a.value===(0,l.SU)(qe).WEEK,onClick:n[2]||(n[2]=e=>p((0,l.SU)(qe).WEEK))},null,8,["label","active"]),(0,r.Wm)(Le,{label:(0,l.SU)(qe).MONTH,active:a.value===(0,l.SU)(qe).MONTH,onClick:n[3]||(n[3]=e=>p((0,l.SU)(qe).MONTH))},null,8,["label","active"]),(0,r.Wm)(Le,{ref_key:"dateTabRef",ref:s,label:h.value,active:a.value===(0,l.SU)(qe).DATE,onClick:n[4]||(n[4]=e=>p((0,l.SU)(qe).DATE))},null,8,["label","active"]),(0,r.Wm)(c.Z,null,{default:(0,r.w5)((()=>[u.value?((0,r.wg)(),(0,r.iD)("div",{key:0,ref_key:"calendarEl",ref:o,class:(0,i.C_)(e.$style.calendar),style:(0,i.j5)(Ke(Ke({},(0,l.SU)(d)),{},{zIndex:(0,l.SU)(T.e)()}))},[(0,r.Wm)(Oe,{"approve-text":(0,l.SU)(qe).DATE,start:(0,l.SU)(t).dateFrom,end:(0,l.SU)(t).dateTo,onApprove:n[5]||(n[5]=e=>function([e,a]){t.dateFrom=e,t.dateTo=a,u.value=!1}(e))},null,8,["approve-text","start","end"])],6)):(0,r.kq)("v-if",!0)])),_:1})])),_:1})])),_:1}))}});var Je=a(83157),et=a.n(Je);const tt={};tt.$style=et();const at=(0,p.Z)(Qe,[["__cssModules",tt]]),st=(0,r.aZ)({__name:"type-tabs-view",setup(e){const t=le();function a(e){const a=t.isTypeActive(e);if(e===R.hR.ANY&&t.type!==R.hR.ANY)return t.type=e,void t.clearMineAndNsfwTags();e===R.hR.MINE?t.applyMineTagIfNeeded(a):e===R.hR.NSFW&&t.applyNsfwTagIfNeeded(a),a?t.deactivateType(e):t.activateType(e)}return(e,s)=>((0,r.wg)(),(0,r.j4)(g,null,{legend:(0,r.w5)((()=>[(0,r.Uk)(" Типы ")])),default:(0,r.w5)((()=>[(0,r.Wm)(Ne,null,{default:(0,r.w5)((()=>[(0,r.Wm)(Le,{label:(0,l.SU)(Ye).ANY,active:(0,l.SU)(t).type===(0,l.SU)(R.hR).ANY,onClick:s[0]||(s[0]=e=>a((0,l.SU)(R.hR).ANY))},null,8,["label","active"]),(0,r.Wm)(Le,{label:(0,l.SU)(Ye).TEXT,active:(0,l.SU)(t).isTypeActive((0,l.SU)(R.hR).TEXT),onClick:s[1]||(s[1]=e=>a((0,l.SU)(R.hR).TEXT))},null,8,["label","active"]),(0,r.Wm)(Le,{label:(0,l.SU)(Ye).IMAGE,active:(0,l.SU)(t).isTypeActive((0,l.SU)(R.hR).IMAGE),onClick:s[2]||(s[2]=e=>a((0,l.SU)(R.hR).IMAGE))},null,8,["label","active"]),(0,r.Wm)(Le,{label:(0,l.SU)(Ye).VIDEO,active:(0,l.SU)(t).isTypeActive((0,l.SU)(R.hR).VIDEO),onClick:s[3]||(s[3]=e=>a((0,l.SU)(R.hR).VIDEO))},null,8,["label","active"]),(0,r.Wm)(Le,{label:(0,l.SU)(Ye).MINE,active:(0,l.SU)(t).isTypeActive((0,l.SU)(R.hR).MINE),onClick:s[4]||(s[4]=e=>a((0,l.SU)(R.hR).MINE))},null,8,["label","active"]),(0,l.SU)(t).isAdultVisible?((0,r.wg)(),(0,r.j4)(Le,{key:0,label:(0,l.SU)(Ye).NSFW,active:(0,l.SU)(t).isTypeActive((0,l.SU)(R.hR).NSFW),onClick:s[5]||(s[5]=e=>a((0,l.SU)(R.hR).NSFW))},null,8,["label","active"])):(0,r.kq)("v-if",!0)])),_:1})])),_:1}))}}),rt=st;var it=a(57599);const lt=(0,r.aZ)({__name:"rating-view",setup(e){const t=le(),a=[-200,...R.et];return(e,s)=>((0,r.wg)(),(0,r.j4)(g,null,{legend:(0,r.w5)((()=>[(0,r.Uk)(" Рейтинг "),(0,r.wy)((0,r._)("span",{class:(0,i.C_)(e.$style.suffix)}," от "+(0,i.zw)(a[(0,l.SU)(t).rating]),3),[[v.F8,(0,l.SU)(t).rating>0]])])),default:(0,r.w5)((()=>[(0,r.Wm)(it.Z,{modelValue:(0,l.SU)(t).rating,"onUpdate:modelValue":s[0]||(s[0]=e=>(0,l.SU)(t).rating=e),class:(0,i.C_)(e.$style.slider),options:a},null,8,["modelValue","class"])])),_:1}))}});var nt=a(4177),ot=a.n(nt);const ct={};ct.$style=ot();const ut=(0,p.Z)(lt,[["__cssModules",ct]]);var dt=a(34273),pt=a(73850);const ht=(0,r.aZ)({__name:"community-fieldset-view",setup(e){const t=le(),a=(0,r.Fl)((()=>t.community?[t.community]:[])),s=(0,l.iH)(),n=(0,l.iH)([]),o=(0,l.iH)(""),c=(0,m.VW)(o,500),u=(0,r.Fl)((()=>c.value.length>1)),{data:d,isLoading:p}=(0,pt.UX)({queryKey:(0,r.Fl)((()=>pt.aw.searchCommunity({query:c.value}))),enabled:u});function h(){n.value=[]}function _(){var e;null===(e=s.value)||void 0===e||e.focus()}return(0,r.YP)(d,(e=>{e?(_(),n.value=e):h()})),(e,c)=>((0,r.wg)(),(0,r.j4)(g,null,{legend:(0,r.w5)((()=>[(0,r.Uk)(" Сообщество ")])),default:(0,r.w5)((()=>[(0,r.Wm)(M,{ref_key:"inputFilterRef",ref:s,modelValue:a.value,"onUpdate:modelValue":c[1]||(c[1]=e=>a.value=e),"input-value":o.value,"onUpdate:inputValue":c[2]||(c[2]=e=>o.value=e),theme:"gray",class:(0,i.C_)(e.$style.inputFilter),loading:(0,l.SU)(p)&&u.value,"dropdown-items":n.value,"max-items":1,label:"Добавить","icon-name":"ic_plus_small","dropdown-label-name":"name","onDropdown:clear":c[3]||(c[3]=e=>h()),onAdd:c[4]||(c[4]=e=>async function(e){o.value="",a.value.push(e),t.community=e.id?{id:e.id,name:e.name,avatar:e.avatar,link:e.link}:null,await(0,r.Y3)(),_()}(e))},{item:(0,r.w5)((({item:a})=>[a?((0,r.wg)(),(0,r.j4)(W,{key:0,class:(0,i.C_)(e.$style.community),onRemove:c[0]||(c[0]=e=>{t.community=null})},{default:(0,r.w5)((()=>[(0,r.Wm)(dt.Z,{class:(0,i.C_)(e.$style.avatar),src:a.avatar,size:20},null,8,["class","src"]),(0,r.Uk)(" "+(0,i.zw)(a.name),1)])),_:2},1032,["class"])):(0,r.kq)("v-if",!0)])),dropdownItemPrefix:(0,r.w5)((({item:t})=>[(0,r.Wm)(dt.Z,{class:(0,i.C_)(e.$style.avatar),src:t.avatar,size:20},null,8,["class","src"])])),_:1},8,["modelValue","input-value","class","loading","dropdown-items"])])),_:1}))}});var _t=a(32406),gt=a.n(_t);const mt={};mt.$style=gt();const vt=(0,p.Z)(ht,[["__cssModules",mt]]);var ft=a(69023);const yt=(0,r._)("span",null," Скрыть просмотренные ",-1),bt=(0,r.aZ)({__name:"hide-viewed-fieldset-view",setup(e){const t=le();function a(e){G.core.initParams.isDeleted&&(G.core.ui.authRequired(),e.preventDefault())}return(e,s)=>((0,r.wg)(),(0,r.j4)(g,{class:(0,i.C_)(e.$style.host)},{default:(0,r.w5)((()=>[yt,(0,r.Wm)(ft.Z,{modelValue:(0,l.SU)(t).visited,"onUpdate:modelValue":s[0]||(s[0]=e=>(0,l.SU)(t).visited=e),onClick:a},null,8,["modelValue"])])),_:1},8,["class"]))}});var wt=a(98259),kt=a.n(wt);const xt={};xt.$style=kt();const Tt=(0,p.Z)(bt,[["__cssModules",xt]]);var Dt=a(92934);const Ct=(0,r._)("h3",null,"Фильтры",-1),St=(0,r.aZ)({__name:"app",emits:["change"],setup(e,{emit:t}){const a=le(),s=(0,l.iH)(),u=(0,l.iH)(),d=(0,l.iH)(),{floatingStyles:p}=(0,f.YF)(s,u,{whileElementsMounted:y.Me,middleware:[(0,y.RR)(),(0,b.cv)(4)],placement:"bottom-end",strategy:"fixed",transform:!1}),h=t;function _(e){a.tags.push(e)}return(0,n.i9H)(u,(()=>d.value=!1),{ignore:[s]}),a.$subscribe((0,Dt.D)(((e,t)=>{h("change",t)}),500)),(0,r.bv)((()=>{G.core.listenTo(G.core,"stories-search:linked-tag-click",_)})),(0,r.Ah)((()=>{G.core.stopListening(G.core,"stories-search:linked-tag-click",_)})),(e,t)=>((0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(o.Z,{ref_key:"triggerEl",ref:s,"icon-size":20,class:(0,i.C_)({[e.$style.trigger_active]:d.value}),"icon-name":"ic_filter",size:"large",onClick:t[0]||(t[0]=e=>d.value=!d.value)},null,8,["class"]),((0,r.wg)(),(0,r.j4)(r.lR,{to:"body"},[(0,r.Wm)(c.Z,null,{default:(0,r.w5)((()=>[d.value&&(0,l.SU)(a).tags.length>0?((0,r.wg)(),(0,r.iD)("div",{key:0,ref_key:"hintEl",ref:u,class:(0,i.C_)(e.$style.hint),style:(0,i.j5)((0,l.SU)(p))},[Ct,(0,r.Wm)(ne),(0,r.Wm)(_e),(0,r.Wm)(vt),(0,r.Wm)(at),(0,r.Wm)(rt),(0,r.Wm)(ut),(0,r.Wm)(Tt)],6)):(0,r.kq)("v-if",!0)])),_:1})]))],64))}});var $t=a(56058),Ut=a.n($t);const Ft={};Ft.$style=Ut();const Et=(0,p.Z)(St,[["__cssModules",Ft]]);var Pt=a(74689);function Mt(e){const t=(0,s.a)(Et,e);return t.directive("tooltip",Pt.u),t}},23175:(e,t,a)=>{"use strict";var s=a(12953),r=a(97099),i=a(16093),l=a(57215),n=a(17311),o=a(20446);const c=a(19755);class u extends r.T3{route(e,t){return this.ctx=e,this._searchMode=e.params.hasOwnProperty("name")?n.xd.TAG:n.xd.ALL,this.isRendered||this.show(),t()}render(){return this.isRendered||(s.core.ui.screen=this._searchMode===n.xd.TAG?o.dt.TAGS:o.dt.SEARCH,this._feed=new l._D({$el:c(".stories-feed"),feedName:"search",focused:!0}),this._search=new i.P({feed:this._feed,searchMode:this._searchMode,$el:c(".stories-search")}),this._filter=new l.pd({$el:c(".stories-search__feed-panel"),feed:this._feed,feedName:l.DV.SEARCH.valueOf()}),super.render()),this}}s.core.use({"/search":u,"/search.php":u,"/tag/:name/:mode?":u,"/tag/:name/:mode?/all":u})},16093:(e,t,a)=>{"use strict";a.d(t,{P:()=>M});a(88674),a(2707),a(66992),a(33948),a(74916),a(15306),a(41817);var s=a(12953),r=a(63907),i=a(44361),l=a(85823),n=a(81772),o=a(41574),c=a(88358),u=a(48218),d=a(3668),p=a(36005),h=a(68016),_=a(72346),g=a(17311),m=a(36005);var v=a(36005);var f=a(36005);var y=a(36005);var b=a(36005);var w=a(92934),k=a(42107),x=a(93172);function T(e){const t=e.split("-"),a=new Date(2008,0,1,0,0,0,0).getTime();let s=new Date(parseInt(t[0]),parseInt(t[1])-1,parseInt(t[2]),0,0,0,0).getTime()-a;return s<0&&(s=0),Math.round(s/864e5)}var D=a(61950),C=a(19359),S=a(73736),$=(a(96637),a(43241));class U extends $.u{constructor(e){super(e),this.init()}async init(){if(!this.el)return;const{createApp:e}=await a(39364);this.vueApp=await e({onChange:e=>this.emit("change",e)}).mount(this.el)}}function F(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function E(e,t,a){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const P=a(19755);class M extends g.P{constructor(e){super(e),this.show()}render(){return this.isRendered||(this.feed.loadAnimationName="stories-search",this.$el||(this.$el=P(".stories-search")),this.$els={rating:this.$(".stories-search-rating"),ratingCaption:this.$(".stories-search-rating__caption"),ratingSlider:this.$(".stories-search-rating__slider"),type:this.$(".stories-search__types"),typeGroup:this.$(".stories-search__types-group"),dates:this.$(".stories-search__dates"),datesGroup:this.$(".stories-search__dates-group"),dateRangeButton:this.$('.stories-search-item_button[data-value="range"]'),visited:this.$(".stories-search__visited"),visitedGroup:this.$(".stories-search__visited-group"),textInput:this.$('.input[data-role="search"]'),tags:this.$(".stories-search__tags-group .stories-search__tags"),excludeTags:this.$(".stories-search__tags-group .stories-search__exclude-tags"),tagsGroup:this.$(".stories-search__tags-group"),tagsTitleBlock:this.$(".stories-search__tags-title"),user:this.$(".stories-search__user"),userGroup:this.$(".stories-search__user-group"),userAddInput:this.$(".stories-search__user-group .input"),community:this.$(".stories-search__community"),communityGroup:this.$(".stories-search__community-group"),communityAddInput:this.$(".stories-search__community-group .input"),resultBlock:this.$(".stories-search-results"),loader:this.$(".stories-search__loader"),panel:this.$(".stories-search__feed-panel"),sortButton:this.$(".stories-search__feed-panel > a"),sortButtonCaption:this.$(".stories-search__feed-panel > a > span")},this._searchData={linkedTags:s.default.config("modules.search.found.linkedTags")||[],tags:s.default.config("modules.searchTags")||[],excludeTags:s.default.config("modules.searchExcludeTags")||[],type:s.default.config("modules.searchType")||0,dateFrom:s.default.config("modules.searchDateFrom")||"",dateTo:s.default.config("modules.searchDateTo")||"",sort:g.vf[s.default.config("modules.searchSort")]||g.vf.FRESH,rating:s.default.config("modules.searchRating")||0,visited:s.default.config("modules.searchVisited")||!1,user:s.default.config("modules.searchUser")||{avatar:"",name:""},community:s.default.config("modules.searchCommunity")||{avatar:"",name:"",link:""},shouldHideForm:s.default.config("modules.shouldHideForm")||!1},this._prevRequest="",this._calendar=null,this._calendarPopup=null,this._sortPopup=null,this._searchAnalytics=x.v.retrieveSearchSession(),this.listenTo(this.feed,"loaded",this._processFeedLoad.bind(this)),this._searchData.shouldHideForm||this.isTagsPage||(this._form=new l.x(this.$("form")),this.listenTo(this._form,"submit",this._search.bind(this,!0)),this._input=new d.u3({$el:this.$els.textInput,sanitizerRules:[_.o.trim()]})),this._searchData.shouldHideForm||this.isTagsPage||(this._createCalendar(),this._prepareTagsControl(),this._prepareTypesControl(),this._prepareDatesControl(),this._prepareRatingControl(),this._prepareUserControl(),this._prepareCommunityControl()),this._prepareSortControl(),this._searchData.shouldHideForm||this.isTagsPage||this._updateDateCaption(),this._setFeedSearchParams(),this._searchData.shouldHideForm||(this._updateFoundTagsBlock(),this._updateTitleTagsBlock(),this._updateFoundUsersBlock(),this._updateFoundCommunitiesBlock(),this._prepareLinkedBlock()),this._initFilter(),(s.default.isUserAuthorized||s.default.initParams.isDeleted&&!this.isTagsPage)&&this._prepareVisitedControl(),this._setAnalyticsTagParameter(this._searchData.tags),super.render()),this}async _initFilter(){this.isTagsPage&&(this._storiesSearchFilter=new U({el:this.$el.find(".stories-search__filter")[0]}),this.listenTo(this._storiesSearchFilter,"change",(e=>{this._searchData.dateFrom=e.dateFrom,this._searchData.dateTo=e.dateTo,this._searchData.rating=e.rating,this._searchData.type=e.type,this._searchData.tags=e.tags,this._searchData.excludeTags=e.excludeTags,this._searchData.visited=e.visited?"h":"",this._searchData.user=e.user,this._searchData.community=e.community,this._setAnalyticsTagParameter(this._searchData.tags),this._updateTitleTagsBlock(),this._search()})))}_prepareSortControl(){this._sortPopup=u.g.popupEnum(this.$els.sortButton,g.vf,"stories-search.sort-mode",this._searchData.sort),this.$els.sortButton.on("click",(()=>{this._sortPopup.toggle()})),this.setSortingByAnlParam(g.t0[this._searchData.sort.valueOf()]),this.listenTo(this._sortPopup,"change",((e,t)=>{if(t){if(this.isTagsPage){const e=g.t0[t.valueOf()];k.cp.getInstance().sendEvent("filter",{type:e,sorting_by:g.t0[this._searchData.sort.valueOf()]}),this.setSortingByAnlParam(e)}this.$els.sortButtonCaption.text(s.default.i18n("stories-search.sort-mode."+t.toString())),this._searchData.sort=t,this._sortPopup.isShown&&(this._sortPopup.hide(),this._search())}}));const e=(0,w.D)((e=>{const t=this._sortPopup.marks.get("form");if(!t)return;const a=e?g.vf.RELEVANCE:g.vf.FRESH,s=t.getUIElement(null,a.toString());s&&s.toggleChecked(!0)}),300);this._input&&(this.listenTo(this._input,"input",e),this.listenTo(this._input,"change",e))}_createCalendar(){let e=this._calendar=new o.E;e.width=Math.min(550,window.innerWidth),e.datesRangeMode=!0,e.showButtonsPanel=!1,e.setDate(this._searchData.dateFrom,this._searchData.dateTo),e.on("select",(t=>{e.isFullRangeSelected?(this._searchData.dateFrom="",this._searchData.dateTo=""):(this._searchData.dateFrom=t.startDate,t.endDate&&t.endDate!==t.startDate?this._searchData.dateTo=t.endDate:this._searchData.dateTo=""),this._updateDateCaption(),this._search()}))}_prepareDatesControl(){let e=this.$els.dates;this.$els.dates.find(".stories-search-item_button").click((t=>{let a=P(t.target).closest(".stories-search-item_button"),s=a.attr("data-value");if(e.find(".stories-search-item_button").removeClass("stories-search-item_selected"),a.addClass("stories-search-item_selected"),"range"===s){let e,t=this._calendar;this._calendarPopup?e=this._calendarPopup:(e=this._calendarPopup=new c._(a),e.direction=c.Lh.BOTTOM,e.indent=!1,t.show(),e.content=t.$el),e.show()}else this._calendar.setRangeByType(s),this._updateDateCaption(),this._search()})),""===this._searchData.dateFrom?e.find('.stories-search-item_button[data-value="all_time"]').addClass("stories-search-item_selected"):(e.find('.stories-search-item_button[data-value="range"]').addClass("stories-search-item_selected"),r.u1.getUIElement(this.$els.datesGroup).open())}_updateDateCaption(){this._calendar.isFullRangeSelected?this.$els.dateRangeButton.text(s.default.i18n("page-search.captions.interval")):this.$els.dateRangeButton.text(this._calendar.selectedDatesCaption)}_prepareVisitedControl(){let e=this.$els.visited;if(!e.length)return;let t=e.find('.stories-search-item_button[data-value="s"]'),a=e.find('.stories-search-item_button[data-value="h"]'),i="h"!==this._searchData.visited;t.toggleClass("stories-search-item_selected",i),a.toggleClass("stories-search-item_selected",!i),i||r.u1.getUIElement(this.$els.visitedGroup).open(),this.$els.visited.find(".stories-search-item_button").click((e=>{if(s.default.initParams.isDeleted)return void s.default.ui.authRequired();let r=P(e.target).closest(".stories-search-item_button").data("value");i="h"!==r,t.toggleClass("stories-search-item_selected",i),a.toggleClass("stories-search-item_selected",!i),this._searchData.visited=i?"":"h",this._search()}))}_prepareTypesControl(){this.$els.type.find(".stories-search-item_button").click((e=>{const t=P(e.target).closest(".stories-search-item_button"),a=Number(t.attr("data-value")),s=t.hasClass("stories-search-item_selected");if(a===g.hR.ANY)s||(this._searchData.type=a,this._searchData.tags=this._searchData.tags.filter((e=>!g.ch[e]||(this._tagsList.removeItem(e,!0),!1))));else if(s?this._searchData.type&=~a:this._searchData.type|=a,s&&Object.values(g.ch).includes(a)){var r;const e=null===(r=Object.entries(g.ch).find((([,e])=>e===a)))||void 0===r?void 0:r[0];e&&(this._tagsList.removeItem(e,!0),this._searchData.tags=this._searchData.tags.filter((t=>t!==e)))}this._updateTypeButtonsState(),this._updateTitleTagsBlock(),this._search()})),this._updateTypeButtonsState(),this._searchData.type!==g.hR.ANY&&r.u1.getUIElement(this.$els.typeGroup).open()}_updateTypeButtonsState(){const e="stories-search-item_selected";if(this._searchData.type===g.hR.ANY)this.$els.type.find(".stories-search-item_button").removeClass(e),this.$els.type.find('.stories-search-item_button[data-value="0"]').addClass(e);else for(const t of Object.values(g.hR)){const a=t!==g.hR.ANY&&(this._searchData.type&t)===t;this.$els.type.find(`.stories-search-item_button[data-value="${t}"]`).toggleClass(e,a)}}_prepareTagsControl(){const e=this._tagsList=new h.EZ({$el:this.$els.tags,items:this._searchDataTagsWithSpecials,analyticsType:"search_similar_tags_popup",filter:C.ll.SEARCH}),t=e.tagsInput.suggestion;this.listenTo(t,D.n.SET,(()=>{this._searchDataTagsWithSpecials.forEach((e=>{var a;null===(a=t.$els.items.find(`[data-id='${e}']`))||void 0===a||a.remove(),t.$els.items.children().length||t.hide()}))})),this.listenTo(e,"change",((e,t)=>{this._updateTagsList([...e],[...t]),this.searchMode!==g.xd.ALL&&this.searchMode!==g.xd.TAG||this._updateTitleTagsBlock(),this._search()}));const a=new h.EZ({$el:this.$els.excludeTags,items:this._searchData.excludeTags});a.tagsInput.suggestion.parseFilter=t=>!e.items.includes(t.name),this.listenTo(a,"change",(e=>{this._updateExcludeTagsList(e),this._search()})),r.u1.getUIElement(this.$els.tagsGroup).toggleGroup(e.items.length>0||a.items.length>0)}_prepareUserControl(){if(!this.$els.userAddInput.length)return;const{user:e}=this._searchData;let t=new h._d({$el:this.$els.user,items:[e]});t.on("change",(e=>{this._updateUsersList(e),this._search()})),null!=e&&e.name&&(t.addItem(e),r.u1.getUIElement(this.$els.userGroup).open())}_prepareCommunityControl(){if(!this.$els.communityAddInput.length)return;const{community:e}=this._searchData;let t=new h.C2({$el:this.$els.community,items:[e]});t.on("change",(e=>{this._updateCommunitiesList(e),this._search()})),null!=e&&e.name&&(t.addItem(e),r.u1.getUIElement(this.$els.communityGroup).open())}_updateTagsList(e,t){const a=this._searchData.type;e.length>t.length?e.filter((e=>e&&g.ch[e]&&!t.includes(e))).forEach((e=>{this._searchData.type|=g.ch[e]})):e.length<t.length&&t.filter((t=>t&&g.ch[t]&&!e.includes(t))).forEach((e=>{this._searchData.type&=~g.ch[e]})),a!==this._searchData.type&&this._updateTypeButtonsState(),this._searchData.tags=e,this._setAnalyticsTagParameter(e),this._toggleLinkedTagsBlock(!1)}_setAnalyticsTagParameter(e){null!=e&&e.length?(k.cp.getInstance().commonParameters.screen_tag=e.join(","),S.dV.commonParameters.screen_tag=e.join(",")):(delete k.cp.getInstance().commonParameters.screen_tag,delete S.dV.commonParameters.screen_tag),this._searchData.shouldHideForm&&(k.cp.getInstance().commonParameters.lite_page=1,S.dV.commonParameters.lite_page=1)}_updateExcludeTagsList(e){this._searchData.excludeTags=e,Array.isArray(this._lastLinkedTags)&&this._updateLinkedTagsBlock(this._lastLinkedTags.filter((t=>!e.includes(t))))}_updateUsersList(e){this._searchData.user=e[0]||{name:"",avatar:""}}_updateCommunitiesList(e){this._searchData.community=e[0]||{name:"",avatar:"",link:""}}_prepareRatingControl(){const e=[-200,...g.et];let t=new n.T;t.options=e;let a=this._searchData.rating;t.value=e[a]||-200,a>0&&this.$els.ratingCaption.text(s.default.i18n("page-search.captions.rating",e[a])),t.on("change",(t=>{this.$els.rating.attr("data-rating",t),this._searchData.rating=e.indexOf(t),this.$els.ratingCaption.text(s.default.i18n("page-search.captions.rating",t)),this._search()})),this.$(".stories-search-rating__slider").append(t.show().$el),r.u1.getUIElement(this.$els.rating).toggleGroup(a>0)}_replaceLocation(e){const t=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?F(Object(a),!0).forEach((function(t){E(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):F(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e),a=this.searchMode===g.xd.VISITED;let r;a?r="Просмотренные":(r=(0,p.isUndefined)(t.q)?(0,p.isUndefined)(t.t)?"Поиск":t.t.replace(/[<>&]/g,"").replace(/,\s*/g,", "):t.q.replace(/[<>&]/g,"")+" - Поиск",void 0!==t.q?r=t.q.replace(/[<>&]/gi,"")+" - Поиск":void 0!==t.t&&(r=t.t.replace(/[<>&]/gi,"").replace(/,/gi,", ")));const i=!(0,p.isUndefined)(t.cl)&&this.searchMode===g.xd.COMMUNITY,l=!(0,p.isUndefined)(t.u)&&this.searchMode===g.xd.USER,n=!(0,p.isUndefined)(t.t)&&[g.xd.TAG,g.xd.ALL].includes(this.searchMode);let o="/search";switch(!0){case a:o="/visited-stories";break;case i:o="/community/"+t.cl+"/search",delete t.cl;break;case l:o="/@"+t.u+"/search",delete t.u;break;case n:const e=t.t.split(",").sort();if(e.length>3)break;o="/tag/"+e.map((e=>encodeURIComponent(e))).join(","),delete t.t;const s=1,r=t.r===s,c={default:!t.hasOwnProperty("st")||1===t.st,best:2===t.st,relevance:3===t.st};this.isTagsPage||(t.route="search"),c.best&&!r&&(o+="/best",delete t.st),c.relevance&&r&&(o+="/hot",delete t.r),c.default&&r&&(o+="/hot",delete t.st,delete t.r);break;default:o="/search"}const c=P.param(t);document.title=r;const u=o+(c?"?"+c:"");s.default.history.replaceState(t,r,u),this.feed.requestUrl=u}_search(){const{data:e}=this._getData();this._replaceLocation(e),!this.isTagsPage||e.t?(this._clearSearchResults(),this.feed.showSkeletonLoader(),this.timeout("request",1500,this._searchRequest)):s.default.location.reload()}async _searchRequest(){var e;this._setFeedSearchParams(),this._searchAnalytics.sendSearchEvent(null===(e=this._input)||void 0===e?void 0:e.value,this._searchData),await this.feed.clear().loadStories(!1)}_setFeedSearchParams(){let{data:e,emptyKeys:t}=this._getData();for(let a of t)this.feed.searchParams.delete(a)}_clearSearchResults(){this.marks.get("cleanResults")||(this._updateFoundTagsBlock([]),this._updateFoundUsersBlock([]),this._updateFoundCommunitiesBlock([]),this.$els.panel.hide(),this.feed.clear(),this.marks.set("cleanResults",!0))}_processFeedLoad(e){var t;(this.marks.set("cleanResults",!1),this.$els.panel.show(),void 0!==e.linked_tags&&this._updateLinkedTagsBlock(e.linked_tags),this.isTagsPage)?1===e.page&&(null===(t=this.feedMenu)||void 0===t||t.updateFeedCount(e.feed_comment_count)):(void 0!==e.tags&&this._updateFoundTagsBlock(e.tags),void 0!==e.users&&this._updateFoundUsersBlock(e.users),void 0!==e.communities&&this._updateFoundCommunitiesBlock(e.communities))}_getData(){var e,t,a;let s,r=[],i={};return s=(null===(e=this._input)||void 0===e?void 0:e.value)||"",""!==s?i.q=s:r.push("q"),s=this._searchData.tags.filter((e=>e&&!g.ch[e])).sort().join(","),""!==s?i.t=s:r.push("t"),s=this._searchData.excludeTags.join(","),""!==s?i.et=s:r.push("et"),s=this._searchData.type,0!==s?i.n=s:r.push("n"),s=this._searchData.sort.valueOf(),1!==s?i.st=s:r.push("st"),s=this._searchData.rating,0!==s?i.r=s:r.push("r"),s=(null===(t=this._searchData.user)||void 0===t?void 0:t.name)||"",""!==s?i.u=s:r.push("u"),s=(null===(a=this._searchData.community)||void 0===a?void 0:a.link)||"",""!==s?i.cl=s:r.push("cl"),s=this._searchData.visited,!1!==s&&""!==s?i.vn=s:r.push("vn"),s=this._searchData.dateFrom,""!==s?i.d=String(T(s)):r.push("d"),s=this._searchData.dateTo,""!==s?i.D=String(T(s)):r.push("D"),s=this._searchData.shouldHideForm,!1!==s?i.short=s:r.push("short"),{data:i,emptyKeys:r}}_prepareLinkedBlock(){this.$els.linkedTags=this.$(".stories-search__linked-tags").on("click",".tags__tag",(e=>{e.preventDefault(),this.isTagsPage?s.default.emit("stories-search:linked-tag-click",e.currentTarget.dataset.tag):this._tagsList.addItem(e.currentTarget.dataset.tag)})),this.$els.linkedTags.length&&this.$els.linkedTags.get(0).querySelectorAll(".tags__tag").forEach((e=>{e.dataset.analyticsType="search_similar_tags_popup"}))}_toggleLinkedTagsBlock(e){const t=this.$els.linkedTags;if(!t.length)return;t.is(":visible")!==e&&(e?t.slideDown():t.slideUp())}_updateLinkedTagsBlock(e){const t=this.$els.linkedTags;if(null==t||!t.length)return;const a=this._searchDataTagsWithSpecials,s=a.length>=1&&a.length<3&&e.length>2;var r,i,l;(e=e.filter((e=>!a.includes(e))),this._lastLinkedTags=e,s)?(t.empty().append((r={tags:e,key:a[0],isTagsPage:this.isTagsPage},i="",l=y.escape,Array.prototype.join,i+='    <h4>С этим тегом используют</h4>\n    <div class="tags">\n        ',r.tags.forEach((e=>{i+='\n            <a class="tags__tag" href="/tag/'+l([r.key,e].sort().join(","))+'/hot"  data-tag="'+l(e)+'" target="_blank" rel="noopener">'+l(e)+"</a>\n        "})),i+="\n\n",r.isTagsPage?i+='\n        <a href="/linked-tags/'+l(r.key)+'" target="_blank" rel="noopener" class="stories-search__linked-tags-all">Все</a>\n    </div>\n':i+='\n    </div>\n    <a href="/linked-tags/'+l(r.key)+'" target="_blank" rel="noopener" class="stories-search__linked-tags-all">Все теги</a>\n',i+="\n")),this._toggleLinkedTagsBlock(!0)):this._toggleLinkedTagsBlock(!1)}async _updateTitleTagsBlock(){const e=this._searchDataTagsWithSpecials,t=e.join(i.Gm);var a;if(!e.length)return this.$els.tagsTitleBlock.hide(),void(null===(a=this.storiesSearchFilter)||void 0===a||a.destroy());const r=1===e.length,l=e.map((e=>"Моё"===e?"[моё]":e)).join(" + "),n=await i.zG.getTagStatus(t),o=n.is_subscribed,c=n.is_ignored,u=n.is_subscribable,d=P((p={renderSubscribeButton:u,subscribed:o,ignored:c,tag:i.zG.normalizeTag(t),title:l,showDots:r},h="",_=b.escape,Array.prototype.join,h+='<div class="stories-search__tags-wrapper">\n\t<h1>\n\t\t'+_(p.title)+"\n\t\t",p.showTitleFilter,h+="\n\t</h1>\n\n\t",p.renderSubscribeButton&&(h+='\n\t\t<div class="stories-search__tags-buttons">\n\t\t\t<span\n\t\t\t\tdata-css-class="stories-search__tags-button-subscribe"\n\t\t\t\tdata-role="subscribe"\n\t\t\t\tdata-type="tag"\n\t\t\t\tdata-id="'+_(p.tag)+'"\n\t\t\t\tdata-is-subscribed="'+_(p.subscribed?"true":"false")+'"\n\t\t\t\tdata-is-ignored="'+_(p.ignored?"true":"false")+'"\n\t\t\t\tdata-actions="'+_(p.showDots?"ignore":"")+'"\n\t\t\t\tdata-analytics-type="header"\n\t\t\t\tdata-size="medium"\n\t\t\t\tdata-wide="true"\n\t\t\t>\n\t\t\t</span>\n\n\t\t\t',p.renderMoreTagsBtn,h+="\n\t\t</div>\n\t"),h+="\n</div>\n"));var p,h,_;this.$els.tagsTitleBlock.children(".stories-search__tags-wrapper").remove(),this.$els.tagsTitleBlock.prepend(d),this.$els.tagsTitleBlock.show(),s.default.ui.attachSubscribeButtons()}_updateFoundTagsBlock(e=null){let t=this.$els.resultBlock.find(".stories-search-result_tags");if(t.slideUp(200,(()=>{t.remove()})),null===e&&(e=s.default.config("modules.foundTags")||[]),0===e.length)return;let a=P(function(e){var t,a="",s=v.escape;Array.prototype.join,a+='<section class="stories-search-result stories-search-result_tags">\n\t',e.tags.length>5&&(a+='\n\t\t<a href="javascript: void(0);" data-role="show-all">'+(null==(t=e.tagsCount)?"":t)+'</a>\n\t\t<a href="javascript: void(0);" data-role="collapse">свернуть</a>\n\t'),a+="\n\t";for(var r=0,i=e.tags,l=i.length;r<l;r++)a+='\n\t\t<a class="tag stories-search-result__tag stories-search-result__item '+s(r>4?"stories-search-result__item_hidden":"")+'"\n\t\t   href="/tag/'+(null==(t=encodeURIComponent(i[r].name))?"":t)+'/hot">'+s(i[r].name)+"</a>\n\t";return a+"\n</section>\n"}({tags:e,tagsCount:e.length+" "+s.default.i18n("^page-search.tags('%0')",e.length)}));this.$els.resultBlock.append(a),a.slideDown(200),a.find('a[data-role="show-all"]').click((()=>{a.addClass("stories-search-result_show-all")})),a.find('a[data-role="collapse"]').click((()=>{a.removeClass("stories-search-result_show-all")}))}_updateFoundUsersBlock(e=null){let t=this.$els.resultBlock.find(".stories-search-result_users");if(t.slideUp(200,(()=>{t.remove()})),null===e&&(e=s.default.config("modules.foundUsers")||[]),0===e.length)return;let a=P(function(e){var t,a="",s=f.escape;Array.prototype.join,a+='<section class="stories-search-result stories-search-result_users">\n\t',e.users.length>5&&(a+='\n\t\t<a href="javascript: void(0);" data-role="show-all">'+(null==(t=e.usersCount)?"":t)+'</a>\n\t\t<a href="javascript: void(0);" data-role="collapse">свернуть</a>\n\t'),a+="\n\t";for(var r=0,i=e.users,l=i.length;r<l;r++)a+='\n\t\t<a class="user user_inline stories-search-result__user stories-search-result__item '+s(r>4?"stories-search-result__item_hidden":"")+'"\n\t\t   href="/@'+s(i[r].name)+'">\n\t\t\t<span class="avatar avatar_small"><img src="'+s(i[r].avatar)+'"></span>\n\t\t\t<span>'+s(i[r].name)+"</span>\n\t\t\t",i[r].approval&&(a+='\n\t\t\t<span class="user__label hint" data-type="approved" aria-label="'+s(i[r].approval)+'"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__approved"><use xlink:href="#icon--ui__approved"></use></svg></span>\n\t\t\t'),a+="\n\t\t</a>\n\t";return a+"\n</section>\n"}({users:e,usersCount:e.length+" "+s.default.i18n("^page-search.users('%0')",e.length)}));this.$els.resultBlock.append(a),a.slideDown(200),a.find('a[data-role="show-all"]').click((()=>{a.addClass("stories-search-result_show-all")})),a.find('a[data-role="collapse"]').click((()=>{a.removeClass("stories-search-result_show-all")}))}_updateFoundCommunitiesBlock(e=null){let t=this.$els.resultBlock.find(".stories-search-result_communities");if(t.slideUp(200,(()=>{t.remove()})),null===e&&(e=s.default.config("modules.foundCommunities")||[]),0===e.length)return;e.forEach((e=>{let t=e.subs.split(" ")[0];e.subs=`<b>${t}</b> ${s.default.i18n("plural.subs",t)}`;let a=e.stories.split(" ")[0];e.stories=`<b>${a}</b> ${s.default.i18n("plural.stories",a)}`}));let a=P(function(e){var t,a="",s=m.escape;Array.prototype.join,a+='<section class="stories-search-result stories-search-result_communities">\n\t',e.communities.length>3&&(a+='\n\t\t<a href="javascript: void(0);" data-role="show-all">Показать все '+(null==(t=e.communitiesCount)?"":t)+'</a>\n\t\t<a href="javascript: void(0);" data-role="collapse">свернуть</a>\n\t'),a+="\n\t";for(var r=0,i=e.communities,l=i.length;r<l;r++)a+='\n\t\t<div class="community stories-search-result__item '+s(r>3?"stories-search-result__item_hidden":"")+'" data-id="'+s(i[r].id)+'">\n\t\t\t<div class="community-avatar community-avatar_medium"><img src="'+s(i[r].avatar)+'" alt=""></div>\n\t\t\t<div class="community__wrapper">\n\t\t\t\t<div class="community__title"><a href="/community/'+s(i[r].link)+'">'+s(i[r].name)+'</a></div>\n\t\t\t\t<div class="community__information">\n\t\t\t\t\t<span>'+(null==(t=i[r].stories)?"":t)+"</span> <span>•</span> <span>"+(null==(t=i[r].subs)?"":t)+'</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="community__tags tags">\n\t\t\t\t\t',i[r].tags.forEach((function(e){a+='\n\t\t\t\t\t<a href="/communities/tag/'+s(e)+'" class="tags__tag" target="_blank" title="Поиск сообществ по тегу &quot;'+s(e)+'&quot;">\n\t\t\t\t\t\t'+s(e)+"\n\t\t\t\t\t</a>\n\t\t\t\t\t"})),a+="\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t";return a+="\n</section>\n"}({communities:e,communitiesCount:e.length+" "+s.default.i18n("page-search.communities",e.length)}));this.$els.resultBlock.append(a),a.slideDown(200),a.find('a[data-role="show-all"]').click((()=>{a.addClass("stories-search-result_show-all")})),a.find('a[data-role="collapse"]').click((()=>{a.removeClass("stories-search-result_show-all")}))}get searchMode(){return this._options.searchMode||g.xd.ALL}get feed(){return this._options.feed}set feed(e){this._options.feed!==e&&(this._options.feed=e)}get _searchDataTagsWithSpecials(){const e=[...this._searchData.tags].filter((e=>e&&!g.ch[e]));for(const[t,a]of Object.entries(g.ch))this._searchData.type&a&&e.push(t);return e}}},15944:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(8081),r=a.n(s),i=a(23645),l=a.n(i)()(r());l.push([e.id,".app__hint--TVc4Odz4{display:flex;flex-wrap:wrap;gap:16px;width:300px;z-index:7000;padding:15px 15px 23px;background-color:var(--color-bright-800);border-radius:8px;filter:drop-shadow(0 1px 8px var(--color-contrast-shadow))}.app__trigger_active--N8SAS3TE{background-color:rgba(0,0,0,.08)}",""]),l.locals={hint:"app__hint--TVc4Odz4",trigger_active:"app__trigger_active--N8SAS3TE"};const n=l},88024:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(8081),r=a.n(s),i=a(23645),l=a.n(i)()(r());l.push([e.id,".community-fieldset-view__community--wIXD9FHn{padding:4px 0 4px 2px}.community-fieldset-view__avatar--GZjmOVig{margin-right:6px;border-radius:4px}.community-fieldset-view__inputFilter--jm9s7GnV{width:100%}",""]),l.locals={community:"community-fieldset-view__community--wIXD9FHn",avatar:"community-fieldset-view__avatar--GZjmOVig",inputFilter:"community-fieldset-view__inputFilter--jm9s7GnV"};const n=l},74219:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(8081),r=a.n(s),i=a(23645),l=a.n(i)()(r());l.push([e.id,".fieldset-view__host--_pRC0Qcd{display:flex;flex-wrap:wrap;gap:8px;border:0;color:var(--color-black-940);width:100%;font-size:14px;line-height:24px;font-weight:400}.fieldset-view__legend--kJL1yCAp{display:flex;align-items:center;width:100%}",""]),l.locals={host:"fieldset-view__host--_pRC0Qcd",legend:"fieldset-view__legend--kJL1yCAp"};const n=l},62968:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(8081),r=a.n(s),i=a(23645),l=a.n(i)()(r());l.push([e.id,".filter-tab-view__host--CWB7LbY_{display:inline-flex;padding:4px 12px;background-color:var(--color-black-100);border-color:1px solid var(--color-black-300);color:var(--color-black-940);border-radius:8px;cursor:pointer}.filter-tab-view__host_active--KaPuIK8e{background-color:var(--color-primary-700);border-color:var(--color-primary-800);color:var(--color-bright-900)}",""]),l.locals={host:"filter-tab-view__host--CWB7LbY_",host_active:"filter-tab-view__host_active--KaPuIK8e"};const n=l},89256:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(8081),r=a.n(s),i=a(23645),l=a.n(i)()(r());l.push([e.id,".filter-tabs-view__host--fhvVywE4{display:flex;flex-wrap:wrap;gap:8px}",""]),l.locals={host:"filter-tabs-view__host--fhvVywE4"};const n=l},59811:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(8081),r=a.n(s),i=a(23645),l=a.n(i)()(r());l.push([e.id,".hide-viewed-fieldset-view__host--MeHlC9Ru{flex-direction:row;justify-content:space-between}",""]),l.locals={host:"hide-viewed-fieldset-view__host--MeHlC9Ru"};const n=l},27300:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(8081),r=a.n(s),i=a(23645),l=a.n(i)()(r());l.push([e.id,".period-tabs-view__calendar--GVhg6kSV{background-color:var(--color-bright-800);border-radius:8px;filter:drop-shadow(0 1px 8px var(--color-contrast-shadow))}",""]),l.locals={calendar:"period-tabs-view__calendar--GVhg6kSV"};const n=l},20697:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(8081),r=a.n(s),i=a(23645),l=a.n(i)()(r());l.push([e.id,".rating-view__suffix--J4P73Iqi{color:var(--color-black-700);margin-left:auto;font-size:13px;line-height:20px;font-weight:400}.rating-view__slider--I7oSLTTr{width:100%}",""]),l.locals={suffix:"rating-view__suffix--J4P73Iqi",slider:"rating-view__slider--I7oSLTTr"};const n=l},70986:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(8081),r=a.n(s),i=a(23645),l=a.n(i)()(r());l.push([e.id,".tags-input-filter-view__host--R6RnxqJk{width:100%}.tags-input-filter-view__tag--y87o8CNa{background-color:var(--color-bright-800);padding:3px 7px;border:1px solid var(--color-black-430);border-radius:8px}",""]),l.locals={host:"tags-input-filter-view__host--R6RnxqJk",tag:"tags-input-filter-view__tag--y87o8CNa"};const n=l},10289:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(8081),r=a.n(s),i=a(23645),l=a.n(i)()(r());l.push([e.id,".user-fieldset-view__user--yP12TihI{padding:4px 0 4px 2px}.user-fieldset-view__avatar--SgoGznby{margin-right:6px}.user-fieldset-view__inputFilter--UTq3_FWu{width:100%}",""]),l.locals={user:"user-fieldset-view__user--yP12TihI",avatar:"user-fieldset-view__avatar--SgoGznby",inputFilter:"user-fieldset-view__inputFilter--UTq3_FWu"};const n=l},32196:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(8081),r=a.n(s),i=a(23645),l=a.n(i)()(r());l.push([e.id,".calendar-sheet__host--etF7sIuq{width:fit-content;user-select:none}.calendar-sheet__month--Crroecxp{padding:8px 0;display:flex;align-items:center}.calendar-sheet__monthTitle--KhrL5pES{margin:0 8px;flex:1 1 0;text-align:center;color:var(--color-black-940);font-size:14px;line-height:24px;font-weight:500}.calendar-sheet__weekDays--RM7ITLy8{display:grid;justify-content:center;grid-template:36px/repeat(7, 36px)}.calendar-sheet__weekDay--JsrvLB5F{display:flex;align-items:center;justify-content:center;color:var(--color-black-700);font-size:13px;line-height:20px;font-weight:500}.calendar-sheet__days--NKr1ulzS{display:grid;justify-content:center;grid-template:repeat(6, 36px)/repeat(7, 36px)}.calendar-sheet__day--QrVXoUlO{display:flex;align-items:center;justify-content:center;color:var(--color-black-940);background:var(--color-bright-800);cursor:pointer;transition:200ms ease-out;border-radius:8px;font-size:14px;line-height:24px;font-weight:400}.calendar-sheet__day--QrVXoUlO:hover{filter:brightness(0.96)}.calendar-sheet__day--QrVXoUlO:active{filter:brightness(0.92)}.calendar-sheet__day_start--LOxUEXuc,.calendar-sheet__day_end--er2v0mX6{background:var(--color-primary-700);color:var(--color-bright-900)}.calendar-sheet__day_start--LOxUEXuc{border-radius:8px 0 0 8px}.calendar-sheet__day_end--er2v0mX6{border-radius:0 8px 8px 0}.calendar-sheet__day_start--LOxUEXuc.calendar-sheet__day_end--er2v0mX6{border-radius:8px}.calendar-sheet__day_between--pxyqTuFL{border-radius:0;background:var(--color-primary-200)}.calendar-sheet__day_muted--ycFybqh2{opacity:.4}",""]),l.locals={host:"calendar-sheet__host--etF7sIuq",month:"calendar-sheet__month--Crroecxp",monthTitle:"calendar-sheet__monthTitle--KhrL5pES",weekDays:"calendar-sheet__weekDays--RM7ITLy8",weekDay:"calendar-sheet__weekDay--JsrvLB5F",days:"calendar-sheet__days--NKr1ulzS",day:"calendar-sheet__day--QrVXoUlO",day_start:"calendar-sheet__day_start--LOxUEXuc",day_end:"calendar-sheet__day_end--er2v0mX6",day_between:"calendar-sheet__day_between--pxyqTuFL",day_muted:"calendar-sheet__day_muted--ycFybqh2"};const n=l},18062:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(8081),r=a.n(s),i=a(23645),l=a.n(i)()(r());l.push([e.id,".range-picker__host--EOfWNnSg{width:fit-content;background:var(--color-bright-800)}.range-picker__sheets--BFtH6Kwe{display:flex}.range-picker__sheet--xwzlQv7i{padding:20px 15px 15px}.range-picker__sheet--xwzlQv7i:first-child{padding-left:24px}.range-picker__sheet--xwzlQv7i:last-child{padding-right:24px}.range-picker__sheet--xwzlQv7i+.range-picker__sheet--xwzlQv7i{border-left:1px solid var(--color-black-300)}.range-picker__footer--rQ0cWEB1{display:flex;align-items:center;border-top:1px solid var(--color-black-300);padding:12px 24px 16px}.range-picker__input--yXN1MfYe{width:109px}.range-picker__separator--zm2Rkq2W{margin:0 4px;color:var(--color-black-600);transform:rotateZ(0.5turn)}.range-picker__approve--_Skih5Uh{margin-left:auto}",""]),l.locals={host:"range-picker__host--EOfWNnSg",sheets:"range-picker__sheets--BFtH6Kwe",sheet:"range-picker__sheet--xwzlQv7i",footer:"range-picker__footer--rQ0cWEB1",input:"range-picker__input--yXN1MfYe",separator:"range-picker__separator--zm2Rkq2W",approve:"range-picker__approve--_Skih5Uh"};const n=l},84177:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(8081),r=a.n(s),i=a(23645),l=a.n(i)()(r());l.push([e.id,".pkb-input-filter-item__host--ZOMHPUhO{font-size:13px;color:var(--color-black-800);display:flex;align-items:center;overflow:hidden}.pkb-input-filter-item__host__label--_Ivt3AHX{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block}.pkb-input-filter-item__removeButton--Brx_ukFN{color:var(--color-black-600);flex-shrink:0;padding:0 4px;transition:color 200ms ease-out;cursor:pointer}.pkb-input-filter-item__removeButton--Brx_ukFN:hover{color:linear-gradient(0deg, rgba(0, 0, 0, 0.12), rgba(0, 0, 0, 0.12)),var(--color-black-600)}.pkb-input-filter-item__removeButton--Brx_ukFN:active{color:linear-gradient(0deg, rgba(0, 0, 0, 0.24), rgba(0, 0, 0, 0.24)),var(--color-black-600)}",""]),l.locals={host:"pkb-input-filter-item__host--ZOMHPUhO",host__label:"pkb-input-filter-item__host__label--_Ivt3AHX",removeButton:"pkb-input-filter-item__removeButton--Brx_ukFN"};const n=l},30400:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(8081),r=a.n(s),i=a(23645),l=a.n(i)()(r());l.push([e.id,".pkb-input-filter__host--rNpoBnue{position:relative}.pkb-input-filter__baseInput--HvhJZNOl{padding:5px 7px}.pkb-input-filter__wrapper--Cp8OldyM{display:flex;flex-wrap:wrap;gap:4px;cursor:text}.pkb-input-filter__wrapper_padding--ZEEf8jTc{padding-right:24px}.pkb-input-filter__dropdown--MVayiNq_{overflow:hidden;background-color:var(--color-bright-800);border-radius:8px;filter:drop-shadow(0 1px 8px var(--color-contrast-shadow))}.pkb-input-filter__inputWrapper--hYPOZBKM{display:flex;align-items:center;position:relative;max-width:100%;overflow:hidden}.pkb-input-filter__inputContainer--Fc0EX0sC{flex:1}.pkb-input-filter__inputLabel--EhgOPaZ7{display:inline-flex;align-items:center;color:var(--color-black-600);gap:4px}.pkb-input-filter__inputLabel--EhgOPaZ7 span{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block}.pkb-input-filter__input--CNX5lICB{font-size:inherit;line-height:inherit;font-weight:inherit;color:var(--color-black-940);outline:none;border:0;background-color:rgba(0,0,0,0);overflow:hidden;padding:4px}.pkb-input-filter__input_empty--Shkm4EvS{padding:4px 0;position:relative;left:4px}",""]),l.locals={host:"pkb-input-filter__host--rNpoBnue",baseInput:"pkb-input-filter__baseInput--HvhJZNOl",wrapper:"pkb-input-filter__wrapper--Cp8OldyM",wrapper_padding:"pkb-input-filter__wrapper_padding--ZEEf8jTc",dropdown:"pkb-input-filter__dropdown--MVayiNq_",inputWrapper:"pkb-input-filter__inputWrapper--hYPOZBKM",inputContainer:"pkb-input-filter__inputContainer--Fc0EX0sC",inputLabel:"pkb-input-filter__inputLabel--EhgOPaZ7",input:"pkb-input-filter__input--CNX5lICB",input_empty:"pkb-input-filter__input_empty--Shkm4EvS"};const n=l},95418:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(8081),r=a.n(s),i=a(23645),l=a.n(i)()(r());l.push([e.id,".pkb-slider__wrapper--oA8miETI{overflow:hidden}.pkb-slider__input--VrMGtbNW{--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min)) / var(--range));--sx: calc(0.5 * 18px + var(--ratio) * (100% - 18px));margin:0;padding:0;width:100%;height:18px;background:rgba(0,0,0,0);display:block}.pkb-slider__input--VrMGtbNW,.pkb-slider__input--VrMGtbNW::-webkit-slider-thumb{-webkit-appearance:none}.pkb-slider__input--VrMGtbNW::-webkit-slider-runnable-track{box-sizing:border-box;border:none;width:100%;height:2px;background:var(--color-black-440);background:linear-gradient(var(--color-primary-700), var(--color-primary-700)) 0/var(--sx) 100% no-repeat var(--color-black-440)}.pkb-slider__input--VrMGtbNW::-moz-range-track{box-sizing:border-box;border:none;width:100%;height:2px;background:var(--color-black-440)}.pkb-slider__input--VrMGtbNW::-ms-track{box-sizing:border-box;border:none;width:100%;height:2px;background:var(--color-black-440)}.pkb-slider__input--VrMGtbNW::-moz-range-progress{height:2px;background:var(--color-primary-700)}.pkb-slider__input--VrMGtbNW::-ms-fill-lower{height:2px;background:var(--color-primary-700)}.pkb-slider__input--VrMGtbNW::-webkit-slider-thumb{margin-top:-8px;box-sizing:border-box;border:none;width:18px;height:18px;border-radius:50%;background:var(--color-primary-700);cursor:move}.pkb-slider__input--VrMGtbNW::-moz-range-thumb{box-sizing:border-box;border:none;width:18px;height:18px;border-radius:50%;background:var(--color-primary-700);cursor:move}.pkb-slider__input--VrMGtbNW::-ms-thumb{margin-top:0;box-sizing:border-box;border:none;width:18px;height:18px;border-radius:50%;background:var(--color-primary-700);cursor:move}.pkb-slider__input--VrMGtbNW::-ms-tooltip{display:none}",""]),l.locals={wrapper:"pkb-slider__wrapper--oA8miETI",input:"pkb-slider__input--VrMGtbNW"};const n=l},57599:(e,t,a)=>{"use strict";a.d(t,{Z:()=>p});var s=a(66252),r=a(3577),i=a(2262);const l=["value","max"],n=(0,s.aZ)({__name:"pkb-slider",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,n=t,o=(0,i.iH)(),c=(0,i.iH)(),u=(0,i.iH)();function d(){var e;u.value=Number(null===(e=c.value)||void 0===e?void 0:e.value),n("update:modelValue",u.value)}return(0,s.bv)((()=>{u.value=a.modelValue})),(e,t)=>((0,s.wg)(),(0,s.iD)("div",{ref_key:"hostEl",ref:o,class:(0,r.C_)(e.$style.wrapper)},[(0,s._)("input",{ref_key:"inputEl",ref:c,class:(0,r.C_)(e.$style.input),type:"range",value:u.value,min:"0",max:a.options.length-1,style:(0,r.j5)({"--val":u.value,"--min":0,"--max":a.options.length-1}),onInput:d},null,46,l)],2))}});var o=a(31619),c=a.n(o),u=a(83744);const d={};d.$style=c();const p=(0,u.Z)(n,[["__cssModules",d]])},56058:(e,t,a)=>{var s=a(15944);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);(0,a(54402).Z)("6be53322",s,!1,{})},32406:(e,t,a)=>{var s=a(88024);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);(0,a(54402).Z)("0aa972d0",s,!1,{})},7996:(e,t,a)=>{var s=a(74219);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);(0,a(54402).Z)("35f02c31",s,!1,{})},33742:(e,t,a)=>{var s=a(62968);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);(0,a(54402).Z)("7a087a89",s,!1,{})},17430:(e,t,a)=>{var s=a(89256);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);(0,a(54402).Z)("342518f6",s,!1,{})},98259:(e,t,a)=>{var s=a(59811);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);(0,a(54402).Z)("35113cf1",s,!1,{})},83157:(e,t,a)=>{var s=a(27300);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);(0,a(54402).Z)("30d2907d",s,!1,{})},4177:(e,t,a)=>{var s=a(20697);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);(0,a(54402).Z)("72fe37ee",s,!1,{})},35834:(e,t,a)=>{var s=a(70986);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);(0,a(54402).Z)("354b0e74",s,!1,{})},29436:(e,t,a)=>{var s=a(10289);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);(0,a(54402).Z)("caa248c0",s,!1,{})},45117:(e,t,a)=>{var s=a(32196);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);(0,a(54402).Z)("e9a5912c",s,!1,{})},23200:(e,t,a)=>{var s=a(18062);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);(0,a(54402).Z)("9d6f285c",s,!1,{})},13521:(e,t,a)=>{var s=a(84177);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);(0,a(54402).Z)("2cf47cf4",s,!1,{})},23441:(e,t,a)=>{var s=a(30400);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);(0,a(54402).Z)("81a88204",s,!1,{})},31619:(e,t,a)=>{var s=a(95418);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[e.id,s,""]]),s.locals&&(e.exports=s.locals);(0,a(54402).Z)("63d54632",s,!1,{})}},e=>{e.O(0,[583,522,216,143],(()=>{return t=23175,e(e.s=t);var t}));e.O()}]);
</script>

</body>
</html>
