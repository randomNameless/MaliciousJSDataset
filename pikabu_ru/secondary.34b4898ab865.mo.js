(self.webpackChunkpikabu=self.webpackChunkpikabu||[]).push([[441],{5398:(t,e,s)=>{"use strict";s.d(e,{Qu:()=>n,Zg:()=>r,hP:()=>o,o6:()=>a,ob:()=>i});const i="pkb_Cla",n=12e4,a={NO_TARGET:0,COMMENT:1,STORY:2,PERMANENT:3},o={DELETE:1,BAN:2,APPROVE:3,DISAPPROVE:4,MOVE:5,UNBAN:6,CHANGE_PINNED:7,CHANGE_SETTINGS:8,ADD_MODERATOR:9,REMOVE_MODERATOR:10,ADD_TRUSTED_USER:11,REMOVE_TRUSTED_USER:12,ADD_CHIEF:13,REMOVE_CHIEF:14,MOVE_STORY_TO_COMMUNITY:17},r={LIMITED:0,PERMANENT:1,CANCELED:2}},17311:(t,e,s)=>{"use strict";s.d(e,{t0:()=>n.t0,et:()=>n.et,xd:()=>i.x,$F:()=>n.$F,h1:()=>n.h1,hR:()=>n.hR,ch:()=>n.ch,vf:()=>i.v,P:()=>d});var i=s(67133),n=s(69288),a=(s(41817),s(73736)),o=s(42107),r=s(63907),l=s(12953);function c(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class d extends r.u1{constructor(t){var e;super(t),c(this,"_isTagsPage",!1);const{isTagsPage:s=!1}=null!==(e=l.core.config("modules.searchConfig"))&&void 0!==e?e:{};this.isTagsPage=s}setSortingByAnlParam(t){this.isTagsPage&&(o.cp.getInstance().commonParameters.sorting_by=t,a.dV.commonParameters.sorting_by=t)}set isTagsPage(t){this._isTagsPage=t}get isTagsPage(){return this._isTagsPage}}},2122:(t,e,s)=>{"use strict";s.r(e),s.d(e,{createApp:()=>St});var i=s(76944),n=s(66252),a=s(2262),o=s(3577),r=s(49963),l=s(7233),c=s(55946);s(66992),s(33948);function d(t,e,s){const i=(0,a.iH)(!1),o=(0,a.qj)({maxHeight:"0px"}),r=()=>{var n;if(o.maxHeight=parseInt(o.maxHeight)+s+"px",i.value=parseInt(o.maxHeight)>=((null===(n=t.value)||void 0===n?void 0:n.scrollHeight)||0),i.value||!e.value||!t.value)return void(e.value&&(e.value.hidden=!0));let a;const r=e.value.offsetWidth+parseInt(getComputedStyle(e.value).marginRight);e.value.hidden=!0;for(const s of Array.from((null===(l=t.value)||void 0===l?void 0:l.children)||[])){var l;if(s.offsetTop===parseInt(o.maxHeight)){a=s.previousElementSibling;const i=a.offsetWidth+parseInt(getComputedStyle(a).marginRight);a&&a.offsetLeft+i+r>t.value.offsetWidth&&(a=a.previousElementSibling),a.insertAdjacentElement("afterend",e.value),e.value.hidden=!1;break}}};return(0,n.bv)(r),{setMoreLink:r,styleObject:o}}const u=["href","onClick","onMouseup"],p=["href"],h=(0,n.aZ)({__name:"tags-view",props:{block:{},link:{}},setup(t){var e;const s=t,{sendEvent:i}=(0,c.z)(),h=(0,l.o)(),_=(0,a.iH)(null===(e=h.browsingParams)||void 0===e?void 0:e[s.block]),m=(0,a.iH)(),g=(0,a.iH)(),{setMoreLink:f,styleObject:v}=d(m,g,108);function b(t,e){i("transition_to_tag",{type:"explore",tag_id:t,position:e})}function y(){f(),i("more_compilations_button_tapped",{type:"more_tags"})}return(t,e)=>((0,n.wg)(),(0,n.iD)("div",{ref_key:"container",ref:m,class:(0,o.C_)(t.$style.container),style:(0,o.j5)((0,a.SU)(v))},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(_.value,((e,s)=>((0,n.wg)(),(0,n.iD)("a",{key:e,href:"/tag/"+e+"/hot",class:(0,o.C_)(t.$style.block),target:"_blank",onClick:(0,r.iM)((t=>b(e,s)),["left"]),onMouseup:(0,r.iM)((t=>b(e,s)),["middle"])},(0,o.zw)(e),43,u)))),128)),s.link?((0,n.wg)(),(0,n.iD)("a",{key:0,ref_key:"moreLink",ref:g,class:(0,o.C_)(t.$style.linkAll),href:s.link,target:"_blank",onClick:e[0]||(e[0]=(0,r.iM)((t=>y()),["left","prevent"])),onMouseup:e[1]||(e[1]=(0,r.iM)((t=>y()),["middle"]))}," ещё ",42,p)):(0,n.kq)("v-if",!0)],6))}});var _=s(44848),m=s.n(_),g=s(83744);const f={};f.$style=m();const v=(0,g.Z)(h,[["__cssModules",f]]);var b=s(23627),y=s(47994),w=s(37043),k=s(86445);const x=["data-story-id"],S=["onClick","onMouseup","innerHTML"],$=(0,n.aZ)({__name:"comments-view",props:{block:{}},setup(t){const e=t,{sendEvent:s}=(0,c.z)(),i=(0,l.o)(),d=(0,a.iH)(i.comments),u=(0,a.iH)();function p(){new b.z({el:u.value,mode:y.lL.BEST}).show().initComments()}function h(){i.loadTopComments(),s("compilation_show_all_button_tapped",{type:"explore"})}function _(t,i){var n;null!==(n=t.target)&&void 0!==n&&n.closest(".comments__title")&&s("transition_to_post",{type:"explore",transition_source:k.lH[e.block],post_id:i.story_id})}return(0,n.bv)(p),(0,n.ic)(p),(t,s)=>((0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("div",{ref_key:"rootEl",ref:u,"data-role":"comments",class:"comments-part"},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(d.value,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e.comment_id,class:(0,o.C_)([t.$style.block,"comments comments_show"]),"data-story-id":e.story_id},[(0,n._)("div",{class:"comments__container",onClick:(0,r.iM)((t=>_(t,e)),["left"]),onMouseup:(0,r.iM)((t=>_(t,e)),["middle"]),innerHTML:e.html},null,40,S)],10,x)))),128))],512),(0,a.SU)(i).canLoadMore[e.block]?((0,n.wg)(),(0,n.j4)(w.Z,{key:0,label:"Показать еще",class:(0,o.C_)(t.$style.loadmore),loading:(0,a.SU)(i).loading[e.block],outline:"",onClick:h},null,8,["class","loading"])):(0,n.kq)("v-if",!0)],64))}});var C=s(25221),T=s.n(C);const E={};E.$style=T();const I=(0,g.Z)($,[["__cssModules",E]]);var O=s(40094),U=s(24431),D=s(1206);const A=["hidden"],M=["hidden"],N=(0,n.aZ)({__name:"pkb-carousel",props:{blockClass:{},edgeSize:{default:0}},emits:["reachEnd","moveRight","moveLeft"],setup(t,{emit:e}){const s=t,i=e,l=(0,a.iH)(!1),c=(0,a.iH)(),d=(0,a.iH)(),u=(0,a.iH)(),p=(0,a.iH)(!0),h=(0,a.iH)(!0),_=(0,r.fb)();let m=0;function g(t){const e=c.value;if(!e||l.value)return;const n=e.querySelector(`.${s.blockClass}`);if(!n)return;const a=n.offsetWidth+parseInt(window.getComputedStyle(n).marginRight),o=e.scrollLeft,r=o+(t?a:-a),d=r-o,u=performance.now();l.value=!0;const p=s=>{const n=s-u;e.scrollLeft=Math.round((0,U.m)(n,o,d,300)),n<300?requestAnimationFrame(p):(e.scrollLeft=r,l.value=!1,f(),i(t?"moveRight":"moveLeft"),m=r)};requestAnimationFrame(p)}function f(){if(!c.value)return;p.value=c.value.scrollLeft<=0;const t=c.value.scrollLeft+c.value.offsetWidth>=c.value.scrollWidth-1;h.value=t,t&&i("reachEnd")}function v(){}return(0,n.bv)((()=>{f(),c.value&&(0,D.Z)(c.value,{onDrag:t=>{var e,s,n;if(t)return void(null===(n=c.value)||void 0===n||n.classList.add(_.inner_grabbing));null===(e=c.value)||void 0===e||e.classList.remove(_.inner_grabbing);const a=(null===(s=c.value)||void 0===s?void 0:s.scrollLeft)||0;f(),i(m>a?"moveLeft":"moveRight"),m=a}})})),(0,n.ic)(f),(t,e)=>((0,n.wg)(),(0,n.iD)("div",{class:(0,o.C_)((0,a.SU)(_).host),style:(0,o.j5)("--edge-size:"+s.edgeSize+"px")},[(0,n._)("div",{ref_key:"innerEl",ref:c,class:(0,o.C_)((0,a.SU)(_).inner),onScroll:v},[(0,n.WI)(t.$slots,"default")],34),t.IS_DESKTOP?((0,n.wg)(),(0,n.iD)("div",{key:0,ref_key:"arrowLeft",ref:d,class:(0,o.C_)([(0,a.SU)(_).arrow,(0,a.SU)(_).arrow_left]),hidden:p.value,onClick:e[0]||(e[0]=t=>g(!1))},[(0,n.Wm)(O.Z,{name:"arrow-left_20"})],10,A)):(0,n.kq)("v-if",!0),t.IS_DESKTOP?((0,n.wg)(),(0,n.iD)("div",{key:1,ref_key:"arrowRight",ref:u,class:(0,o.C_)([(0,a.SU)(_).arrow,(0,a.SU)(_).arrow_right]),hidden:h.value,onClick:e[1]||(e[1]=t=>g(!0))},[(0,n.Wm)(O.Z,{name:"arrow-right_20"})],10,M)):(0,n.kq)("v-if",!0)],6))}});var P=s(96458),L=s.n(P);const R={};R.$style=L();const j=(0,g.Z)(N,[["__cssModules",R]]);var B=s(58330),q=s(96637);const F=["onClick"],V=(0,n.aZ)({__name:"videos-view",props:{block:{}},setup(t){var e;const s=t,{sendEvent:i}=(0,c.z)(),r=(0,l.o)(),d=(0,a.iH)(),u=(0,a.iH)((null===(e=r.browsingParams)||void 0===e?void 0:e[s.block])||[]),p=B.S.getInstance().get("UIVideoFeed");function h(){var t;let e=0;return null===(t=d.value)||void 0===t||t.forEach(((t,s)=>{var i,n;const a=(null===(i=t.parentElement)||void 0===i?void 0:i.scrollLeft)||0,o=(null===(n=t.parentElement)||void 0===n?void 0:n.offsetWidth)||0;t.offsetLeft+t.offsetWidth>=a&&t.offsetLeft<=a+o&&(e=s+1)})),e}function _(t){i(t?"compilation_next_button_tapped":"compilation_back_buttton_tapped",{position:h(),screen_index:s.block,type:k.lH[s.block]})}return(t,e)=>((0,n.wg)(),(0,n.j4)(j,{"block-class":t.$style.block,onMoveRight:e[0]||(e[0]=t=>_(!0)),onMoveLeft:e[1]||(e[1]=t=>_(!1))},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(u.value,(e=>((0,n.wg)(),(0,n.iD)("div",{ref_for:!0,ref_key:"carouselBlocks",ref:d,key:e.story_id,class:(0,o.C_)(t.$style.block),style:(0,o.j5)({"background-image":`url(${e.story_image})`}),onClick:t=>function(t){i("transition_to_tab",{type:"video_feed",component_name:"explore"}),new p({options:t})}(e)},[(0,n._)("div",{class:(0,o.C_)(t.$style.views)},[(0,n.Wm)(O.Z,{name:"eye_16"}),(0,n.Uk)(" "+(0,o.zw)((0,a.SU)(q.Utils).reduceNumber(e.views_count)),1)],2)],14,F)))),128))])),_:1},8,["block-class"]))}});var Z=s(32882),W=s.n(Z);const z={};z.$style=W();const H=(0,g.Z)(V,[["__cssModules",z]]);var G=s(20723),Y=s(66309),K=s(34273),Q=s(63363);const X=["href"],J=(0,n.aZ)({__name:"community-view",props:{id:{},avatar:{},name:{},href:{}},setup(t){const e=t,s=(0,a.iH)(),i=(0,Y.N4s)(s);return(t,r)=>((0,n.wg)(),(0,n.iD)("a",{ref_key:"hostEl",ref:s,href:e.href,class:(0,o.C_)(t.$style.host),target:"_blank"},[t.IS_DESKTOP?((0,n.wg)(),(0,n.j4)(Q.Z,{key:0,for:s.value,active:(0,a.SU)(i),"community-id":e.id},null,8,["for","active","community-id"])):(0,n.kq)("v-if",!0),(0,n.Wm)(K.Z,{"community-name":e.name,url:e.avatar,size:20,class:(0,o.C_)(t.$style.avatar)},null,8,["community-name","url","class"]),(0,n._)("span",null,(0,o.zw)(e.name),1)],10,X))}});var tt=s(69680),et=s.n(tt);const st={};st.$style=et();const it=(0,g.Z)(J,[["__cssModules",st]]),nt=["href"],at=(0,n.aZ)({__name:"communities-view",props:{block:{},link:{}},setup(t){const e=t,{sendEvent:s}=(0,c.z)(),i=(0,l.o)(),u=(0,a.iH)(i.communities),p=(0,a.iH)(),h=(0,a.iH)(),{setMoreLink:_,styleObject:m}=d(p,h,96);function g(t,e){s("transition_to_community",{type:"explore",community_id:t.community_id,position:e})}function f(){_(),s("more_compilations_button_tapped",{type:"more_communities"})}return(t,s)=>((0,n.wg)(),(0,n.iD)("div",{ref_key:"container",ref:p,class:(0,o.C_)(t.$style.container),style:(0,o.j5)((0,a.SU)(m))},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(u.value,((t,e)=>((0,n.wg)(),(0,n.j4)(it,{id:t.community_id,key:t.community_id,avatar:t.community_avatar,name:t.community_name,href:t.community_link,onClick:(0,r.iM)((s=>g(t,e)),["left"]),onMouseup:(0,r.iM)((s=>g(t,e)),["middle"])},null,8,["id","avatar","name","href","onClick","onMouseup"])))),128)),e.link?((0,n.wg)(),(0,n.iD)("a",{key:0,ref_key:"moreLink",ref:h,class:(0,o.C_)(t.$style.linkAll),href:e.link,target:"_blank",onClick:s[0]||(s[0]=(0,r.iM)((t=>f()),["left","prevent"])),onMouseup:s[1]||(s[1]=(0,r.iM)((t=>f()),["middle"]))}," ещё ",42,nt)):(0,n.kq)("v-if",!0)],6))}});var ot=s(57435),rt=s.n(ot);const lt={};lt.$style=rt();const ct=(0,g.Z)(at,[["__cssModules",lt]]),dt=["href","onClick","onMouseup"],ut={key:1},pt=(0,n.aZ)({__name:"block-view",props:{title:{},link:{},type:{},block:{}},setup(t){const e=t,{sendEvent:s}=(0,c.z)();function i(t){s("compilation_tapped",{screen_index:e.block,type:k.lH[e.block]||""}),"video"===e.type&&(t.preventDefault(),function(){s("transition_to_tab",{type:"video_feed",component_name:"explore"});new(B.S.getInstance().get("UIVideoFeed"))}())}return(t,s)=>((0,n.wg)(),(0,n.iD)("div",{class:(0,o.C_)(t.$style.block)},[(0,n._)("h3",{class:(0,o.C_)(t.$style.caption)},[e.link||"video"===e.type?((0,n.wg)(),(0,n.iD)("a",{key:0,target:"_blank",href:e.link,onClick:(0,r.iM)(i,["left"]),onMouseup:(0,r.iM)(i,["middle"])},[(0,n.Uk)((0,o.zw)(e.title)+" ",1),(0,n.Wm)(O.Z,{name:"arrow-right_20"})],40,dt)):((0,n.wg)(),(0,n.iD)("span",ut,(0,o.zw)(e.title),1))],2),"cards"===e.type?((0,n.wg)(),(0,n.j4)(G.Z,{key:0,block:e.block,link:e.link},null,8,["block","link"])):"tags"===e.type?((0,n.wg)(),(0,n.j4)(v,{key:1,block:e.block,link:e.link},null,8,["block","link"])):"comments"===e.type?((0,n.wg)(),(0,n.j4)(I,{key:2,block:e.block},null,8,["block"])):"communities"===e.type?((0,n.wg)(),(0,n.j4)(ct,{key:3,block:e.block,link:e.link},null,8,["block","link"])):"video"===e.type?((0,n.wg)(),(0,n.j4)(H,{key:4,block:e.block},null,8,["block"])):(0,n.kq)("v-if",!0)],2))}});var ht=s(68578),_t=s.n(ht);const mt={};mt.$style=_t();const gt=(0,g.Z)(pt,[["__cssModules",mt]]);var ft=s(82222);const vt=(0,n.aZ)({__name:"browsing-page-view",setup(t){const e=(0,l.o)();return(t,s)=>{var i,r,l,c,d,u;return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(gt,{type:"cards",title:"По типу контента",block:(0,a.SU)(ft.eQ).CARDS_BY_CONTENT,class:(0,o.C_)(t.$style.firstBlock)},null,8,["block","class"]),(0,n.Wm)(gt,{type:"cards",title:"Авторские посты",block:(0,a.SU)(ft.eQ).CARDS_AUTHORS},null,8,["block"]),(0,n.Wm)(gt,{type:"cards",title:"Ленты по фильтрам",block:(0,a.SU)(ft.eQ).CARDS_BY_FILTERS},null,8,["block"]),(0,n.Wm)(gt,{type:"cards",title:"Формат",block:(0,a.SU)(ft.eQ).CARDS_BY_FORMAT},null,8,["block"]),t.IS_MOBILE&&null!==(i=(0,a.SU)(e).browsingParams)&&void 0!==i&&null!==(r=i[(0,a.SU)(ft.bF).SHORT_VIDEOS_STORY])&&void 0!==r&&r.length?((0,n.wg)(),(0,n.j4)(gt,{key:0,type:"video",title:"Короткие видео",block:(0,a.SU)(ft.bF).SHORT_VIDEOS_STORY},null,8,["block"])):(0,n.kq)("v-if",!0),null!==(l=(0,a.SU)(e).browsingParams)&&void 0!==l&&null!==(c=l[(0,a.SU)(ft.bF).POPULAR_TAGS])&&void 0!==c&&c.length?((0,n.wg)(),(0,n.j4)(gt,{key:1,type:"tags",title:"Популярные теги",link:"/tag",block:(0,a.SU)(ft.bF).POPULAR_TAGS},null,8,["block"])):(0,n.kq)("v-if",!0),null!==(d=(0,a.SU)(e).communities)&&void 0!==d&&d.length?((0,n.wg)(),(0,n.j4)(gt,{key:2,type:"communities",title:"Популярные сообщества",link:"/communities",block:(0,a.SU)(ft.hR).TOP_COMMUNITIES},null,8,["block"])):(0,n.kq)("v-if",!0),null!==(u=(0,a.SU)(e).comments)&&void 0!==u&&u.length?((0,n.wg)(),(0,n.j4)(gt,{key:3,type:"comments",title:"Топ комментариев дня",link:"/top-comments",block:(0,a.SU)(ft.hR).TOP_COMMENTS},null,8,["block"])):(0,n.kq)("v-if",!0)],64)}}});var bt=s(28822),yt=s.n(bt);const wt={};wt.$style=yt();const kt=(0,g.Z)(vt,[["__cssModules",wt]]),xt=(0,n.aZ)({__name:"app",setup:t=>(t,e)=>((0,n.wg)(),(0,n.j4)(kt))});function St(){return(0,i.a)(xt)}},59018:(t,e,s)=>{"use strict";s.r(e),s.d(e,{createApp:()=>Ve});var i=s(76944),n=(s(88674),s(66252)),a=s(3577),o=s(2262),r=s(37043),l=s(47344),c=s(91904),d=(s(41817),s(69876));let u,p;!function(t){t.BAN="donations_ban",t.DISABLED="donations_pds_restriction",t.RATING_AND_SUBSCRIBERS="donations_limit",t.NO_PHONE="donations_no_phone",t.NOT_RUSSIAN_PHONE="donations_wrong_phone",t.CAN_ENABLE="donations_disabled",t.ENABLED="donations_enabled"}(u||(u={})),function(t){t[t.ACTIVE=0]="ACTIVE",t[t.CANCELLED=1]="CANCELLED",t[t.RENEWAL=2]="RENEWAL"}(p||(p={}));var h=s(66090),_=s(78370),m=s(12953),g=s(53035);function f(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function v(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?f(Object(s),!0).forEach((function(e){b(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):f(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function b(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const y=m.core.config("modules.monetization"),w=(0,d.Q_)("monetization",{state:()=>{let t;return y.fundraisingCampaign&&(t=y.fundraisingCampaign?(0,g.Oe)(y.fundraisingCampaign):void 0,delete y.fundraisingCampaign),v(v({},y),{},{fundraising:t,loading:{enable:!1,unsubscribe:!1,setSubscriptionCost:!1,deleteSubscriptionCost:!1,fundraising:!1}})},getters:{fundraisingCompleted:t=>Boolean(t.fundraising&&t.fundraising.currentAmount>=t.fundraising.targetAmount)},actions:{async enable(){this.loading.enable=!0;try{const t=await h.wp(this.userId);return t.response.result&&(this.isEnabled=!0),t}finally{this.loading.enable=!1}},async unsubscribe(t){this.loading.unsubscribe=!0;try{const e=await h.r1(t);if(!e.response.result)return e;const s=this.subscriptions.find((e=>e.authorId===t));return s&&(s.state=p.CANCELLED),e}finally{this.loading.unsubscribe=!1}},async setSubscriptionCost(t){this.loading.setSubscriptionCost=!0;try{const e=await h.wC(t);return e.response.result&&(this.subscriptionCost=t),e}finally{this.loading.setSubscriptionCost=!1}},async deleteSubscriptionCost(){this.loading.deleteSubscriptionCost=!0;try{const t=await h.KH();return t.response.result&&(this.subscriptionCost=0),t}finally{this.loading.deleteSubscriptionCost=!1}},async createFundraisingWidget(t){try{this.loading.fundraising=!0;const e=await _.k.add(t);return e.response.result&&(this.fundraising=(0,g.Oe)(e.data)),e}finally{this.loading.fundraising=!1}},async editFundraisingWidget(t){try{var e;this.loading.fundraising=!0;const s=await _.k.edit(t);return s.response.result&&null!==(e=this.fundraising)&&void 0!==e&&e.id&&(this.fundraising=v(v({},this.fundraising),{},{title:t.title,targetAmount:Number(t.amount),description:t.description})),s}finally{this.loading.fundraising=!1}},async deleteFundraisingWidget(){try{this.loading.fundraising=!0;const t=this.fundraising,e=await _.k.close(t.id);return e.response.result&&(this.fundraising=void 0),e}finally{this.loading.fundraising=!1}}}});var k=s(55946);const x={key:0},S=(0,n._)("br",null,null,-1),$=(0,n._)("br",null,null,-1),C={key:1},T=(0,n._)("br",null,null,-1),E=(0,n._)("br",null,null,-1),I=(0,n._)("a",{href:"https://static.cloudpayments.ru/docs/CloudTips/cloudtips_oferta_pikabu.pdf",target:"_blank"},"условиями сервиса CloudTips",-1),O=(0,n._)("a",{href:"https://static.cloudpayments.ru/docs/CloudTips/cloudtips_agreement_pikabu.pdf",target:"_blank"},"согласие на обработку персональных данных",-1),U=(0,n._)("a",{href:"https://static.cloudpayments.ru/docs/policy-cloudpayments.pdf",target:"_blank"},"политикой сервиса",-1),D=[(0,n._)("p",null," Если к телефону нет доступа, рекомендуем сначала сменить его, потому что он используется для входа в систему. Телефон необходим, чтобы исключить доступ третьих лиц к вашим денежным средствам. На данный момент, вывод средств доступен только на карты банков РФ (в том числе, виртуальные карты в сервисе «ЮMoney»). ",-1)],A=(0,n.aZ)({__name:"disabled-view",setup(t){const e=c.V.isUserInExperiment(c.t.PAID_SUBS),{sendEvent:s}=(0,k.z)(),i=w(),d=(0,o.iH)(!1);async function u(){s("author_donation_enable_button_tapped",{subscribers:i.userSubsCount,rating:i.userKarma});const{response:t}=await i.enable();t.result?location.reload():m.core.ui.toasts.showError(t.message)}return(t,s)=>((0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("div",{class:(0,a.C_)(t.$style.text)},[(0,o.SU)(e)?((0,n.wg)(),(0,n.iD)("p",x,[(0,n.Uk)(" Вы можете получать донаты, а также создавать уникальный контент, доступный пикабушникам только по платной подписке."),S,(0,n.Uk)(" Чтобы создать аккаунт в системе монетизации, наш партнер CloudTips просит сообщить телефон, привязанный к вашему аккаунту Пикабу."),$,(0,n.Uk)(" Вы согласны его передать? ")])):((0,n.wg)(),(0,n.iD)("p",C,[(0,n.Uk)(" Вы можете получать донаты в качестве благодарности от пикабушников."),T,(0,n.Uk)(" Чтобы создать аккаунт в системе донатов, наш партнер CloudTips просит сообщить данные вашего аккаунта Пикабу."),E,(0,n.Uk)(" Вы согласны их передать? ")]))],2),(0,n.Wm)(l.Z,{modelValue:d.value,"onUpdate:modelValue":s[0]||(s[0]=t=>d.value=t),class:(0,a.C_)(t.$style.confirm)},{default:(0,n.w5)((()=>[(0,n.Uk)(" Я согласен с "),I,(0,n.Uk)(", а также даю свое "),O,(0,n.Uk)(" в соответствии с "),U,(0,n.Uk)(". ")])),_:1},8,["modelValue","class"]),(0,n.Wm)(r.Z,{class:(0,a.C_)(t.$style.button),label:(0,o.SU)(e)?"Включить монетизацию":"Включить донаты",wide:t.IS_MOBILE,loading:(0,o.SU)(i).loading.enable,disabled:!d.value,onClick:u},null,8,["class","label","wide","loading","disabled"]),(0,n._)("div",{class:(0,a.C_)(t.$style.note)},D,2)],64))}});var M=s(4261),N=s.n(M),P=s(83744);const L={};L.$style=N();const R=(0,P.Z)(A,[["__cssModules",L]]),j={key:0},B=(0,n._)("br",null,null,-1),q=(0,n._)("br",null,null,-1),F=(0,n._)("strong",null,"Когда вы получите первый платеж",-1),V={key:1},Z=(0,n._)("br",null,null,-1),W=(0,n._)("br",null,null,-1),z=(0,n._)("strong",null,"Когда вы получите первый донат",-1),H=(0,n.aZ)({__name:"enabled-view",setup(t){const e=c.V.isUserInExperiment(c.t.PAID_SUBS),{sendEvent:s}=(0,k.z)(),i=w();function l(){s("go_to_cloudtips_button_tapped",{subscribers:i.userSubsCount,rating:i.userKarma})}return(t,s)=>((0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("div",{class:(0,a.C_)(t.$style.text)},[(0,o.SU)(e)?((0,n.wg)(),(0,n.iD)("p",j,[(0,n.Uk)(" Вы подключили монетизацию для своего аккаунта."),B,(0,n.Uk)(" Сейчас вы можете пользоваться системой нашего партнера CloudTips. В ней можно привязать карту, отслеживать доступную сумму и выводить полученные средства."),q,F,(0,n.Uk)(", на привязанный телефон придёт СМС со ссылкой для входа в систему CloudTips. ")])):((0,n.wg)(),(0,n.iD)("p",V,[(0,n.Uk)(" Вы включили донаты своему аккаунту."),Z,(0,n.Uk)(" Сейчас вы можете пользоваться системой нашего партнера CloudTips. В ней можно привязать карту, отслеживать доступную сумму и выводить полученные донаты."),W,z,(0,n.Uk)(", на привязанный телефон придёт СМС со ссылкой для входа в систему CloudTips. ")]))],2),(0,n.Wm)(r.Z,{class:(0,a.C_)(t.$style.button),wide:t.IS_MOBILE,icon:"new-tab_16",label:"Перейти в CloudTips",href:"https://lk.cloudtips.ru/sign-in",target:"_blank",onClick:l},null,8,["class","wide"])],64))}});var G=s(77159),Y=s.n(G);const K={};K.$style=Y();const Q=(0,P.Z)(H,[["__cssModules",K]]),X=["innerHTML"],J=(0,n.aZ)({__name:"state-view",setup(t){const e=w();return(t,s)=>((0,n.wg)(),(0,n.iD)("div",null,[(0,o.SU)(e).receiveDenialReason?((0,n.wg)(),(0,n.iD)("p",{key:0,innerHTML:(0,o.SU)(e).receiveDenialReason},null,8,X)):(0,o.SU)(e).isEnabled?((0,n.wg)(),(0,n.j4)(Q,{key:1})):(0,o.SU)(e).canReceive?((0,n.wg)(),(0,n.j4)(R,{key:2})):(0,n.kq)("v-if",!0)]))}});var tt=s(92514);const et=(0,n.aZ)({__name:"statistics-view",props:{donations:{},sponsors:{}},setup(t){const e=t;return(t,s)=>((0,n.wg)(),(0,n.iD)("div",{class:(0,a.C_)(t.$style.host)},[(0,n._)("div",{class:(0,a.C_)(t.$style.item)},[(0,n._)("div",{class:(0,a.C_)(t.$style.value)},(0,a.zw)((0,o.SU)(tt.xG)(e.donations)),3),(0,n.Uk)(" получено за месяц ")],2),(0,n._)("div",{class:(0,a.C_)(t.$style.item)},[(0,n._)("div",{class:(0,a.C_)(t.$style.value)},(0,a.zw)((0,o.SU)(tt.uf)(e.sponsors)),3),(0,n.Uk)(" количество спонсоров ")],2)],2))}});var st=s(69524),it=s.n(st);const nt={};nt.$style=it();const at=(0,P.Z)(et,[["__cssModules",nt]]);var ot=s(76122),rt=s(97652);const lt=(0,n.aZ)({__name:"donations-view",setup(t){const e=c.V.isUserInExperiment(c.t.PAID_SUBS),{sendEvent:s}=(0,k.z)(),i=w();function r(t){0!==t.button&&1!==t.button||s("click",{button:"author_donation_about"})}return(0,n.bv)((()=>{i.state&&s("reach_element",{subscribers:i.userSubsCount,rating:i.userKarma,type:i.state})})),(t,s)=>((0,n.wg)(),(0,n.j4)(ot.Z,null,{default:(0,n.w5)((()=>[(0,n.Wm)(rt.Z,null,{right:(0,n.w5)((()=>[(0,n._)("a",{href:"/go/donates_info",target:"_blank",onClick:r,onAuxclick:r}," Что такое донаты? ",32)])),default:(0,n.w5)((()=>[(0,n.Uk)(" Ваши спонсоры ")])),_:1}),(0,n._)("div",{class:(0,a.C_)(t.$style.content)},[(0,n.Wm)(at,{donations:(0,o.SU)(i).gainedLastMonth,sponsors:(0,o.SU)(i).supportersCount},null,8,["donations","sponsors"]),(0,o.SU)(e)?(0,n.kq)("v-if",!0):((0,n.wg)(),(0,n.j4)(J,{key:0}))],2)])),_:1}))}});var ct=s(11168),dt=s.n(ct);const ut={};ut.$style=dt();const pt=(0,P.Z)(lt,[["__cssModules",ut]]);var ht=s(34828),_t=s(6314),mt=s(91181),gt=s(62357),ft=s(50542);s(85827);const vt=(t,...e)=>e.reduce(((t,e)=>s=>t(e(s))),t);var bt=s(72346);const yt=(0,n._)("strong",null,"Внимание!",-1),wt=(0,n.aZ)({__name:"fundraising-editor-view",props:{active:{type:Boolean,default:!1}},emits:["update:active"],setup(t,{emit:e}){var s,i;const l=t,c=e,{sendEvent:d}=(0,k.z)(),u=w(),p=(0,o.iH)(u.fundraising?u.fundraising.title:""),h=(0,o.iH)(null!==(s=u.fundraising)&&void 0!==s&&s.description?u.fundraising.description:""),_=(0,o.iH)(void 0!==(null===(i=u.fundraising)||void 0===i?void 0:i.targetAmount)?String(u.fundraising.targetAmount):""),f=bt.o.singleSpace(),v=bt.o.clearEmoji(),b=vt(v,f),y=vt(f,bt.o.ltrim(),bt.o.whitelist("0-9 "),bt.o.clearExtraExcludingSpaces(11)),x=(0,n.Fl)((()=>u.fundraising?"Редактировать целевой сбор":"Открыть целевой сбор")),S=(0,n.Fl)((()=>(0,g.$Q)(_.value))),$=(0,n.Fl)((()=>!p.value||!S.value||Number.isNaN(S.value))),C=(0,n.Fl)((()=>{if(!u.fundraising)return!0;const{title:t,description:e,targetAmount:s}=u.fundraising;return t!==p.value||e!==h.value||s!==S.value})),T=(0,n.Fl)((()=>!$.value&&C.value));function E(){c("update:active",!1)}return(t,e)=>((0,n.wg)(),(0,n.j4)((0,n.LL)(t.IS_MOBILE?gt.Z:mt.Z),{"model-value":l.active,active:l.active,title:x.value,"onUpdate:active":e[5]||(e[5]=t=>c("update:active",t)),"onUpdate:modelValue":e[6]||(e[6]=t=>c("update:active",t))},{default:(0,n.w5)((()=>[(0,n._)("div",{class:(0,a.C_)(t.$style.container)},[(0,n._)("p",{class:(0,a.C_)(t.$style.warning)},[yt,(0,n.Uk)(" Редактирование виджета для целевого сбора станет недоступно после первого доната ")],2),(0,n._)("div",null,[(0,n.Wm)(ft.Z,{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=t=>p.value=t),class:(0,a.C_)(t.$style.input),"max-length":140,clean:(0,o.SU)(b),clearable:"",placeholder:"Цель сбора*","aria-autocomplete":"none"},null,8,["modelValue","class","clean"]),(0,n.Wm)(ft.Z,{modelValue:h.value,"onUpdate:modelValue":e[1]||(e[1]=t=>h.value=t),class:(0,a.C_)(t.$style.input),"max-length":512,clean:(0,o.SU)(b),clearable:"",placeholder:"О сборе","aria-autocomplete":"none"},null,8,["modelValue","class","clean"]),(0,n.Wm)(ft.Z,{modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=t=>_.value=t),class:(0,a.C_)(t.$style.input),clean:(0,o.SU)(y),clearable:"",inputmode:"numeric",placeholder:"Целевая сумма сбора*","aria-autocomplete":"none"},null,8,["modelValue","class","clean"])]),(0,n._)("div",{class:(0,a.C_)(t.$style.controls)},[(0,n.Wm)(r.Z,{label:"Сохранить",class:(0,a.C_)(t.$style.control),wide:t.IS_MOBILE,disabled:!T.value,onClick:e[3]||(e[3]=t=>async function(){var t;if(u.loading.fundraising||!T.value)return;E();const e={id:null===(t=u.fundraising)||void 0===t?void 0:t.id,title:p.value,description:h.value,amount:S.value};let s;e.id?(d("click",{button:"author_donation_edit_target"}),s=await u.editFundraisingWidget(e)):(d("click",{button:"author_donation_create_target",size:e.amount,status:1}),s=await u.createFundraisingWidget(e)),s.response.result||m.core.ui.toasts.showError(s.response.message)}())},null,8,["class","wide","disabled"]),t.IS_DESKTOP?((0,n.wg)(),(0,n.j4)(r.Z,{key:0,label:"Отмена",theme:"gray",class:(0,a.C_)(t.$style.cancelBtn),onClick:e[4]||(e[4]=t=>(d("click",{button:"author_donation_open_target_cancel"}),void E()))},null,8,["class"])):(0,n.kq)("v-if",!0)],2)],2)])),_:1},40,["model-value","active","title"]))}});var kt=s(91329),xt=s.n(kt);const St={};St.$style=xt();const $t=(0,P.Z)(wt,[["__cssModules",St]]);var Ct=s(40094);const Tt=(0,n._)("br",null,null,-1),Et=(0,n.aZ)({__name:"fundraising-view",setup(t){const e=w(),{sendEvent:s}=(0,k.z)(),i=(0,o.iH)(!1),l=(0,o.iH)(!1);return(t,c)=>((0,n.wg)(),(0,n.j4)(ot.Z,null,{default:(0,n.w5)((()=>[(0,o.SU)(e).fundraising?(0,n.kq)("v-if",!0):((0,n.wg)(),(0,n.j4)(rt.Z,{key:0},{default:(0,n.w5)((()=>[(0,n.Uk)(" Целевой сбор средств ")])),_:1})),(0,o.SU)(e).fundraisingCompleted?((0,n.wg)(),(0,n.iD)("div",{key:1,class:(0,a.C_)(t.$style.completedHeader)},[(0,n.Wm)(Ct.Z,{name:"cookie-thumbs-up",size:48}),(0,n.Uk)(" Сбор завершён! ")],2)):(0,n.kq)("v-if",!0),(0,n._)("div",{class:(0,a.C_)(t.$style.content)},[(0,o.SU)(e).fundraising?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[(0,n._)("h3",{class:(0,a.C_)(t.$style.fundraisingTitle)},(0,a.zw)((0,o.SU)(e).fundraising.title),3),(0,n._)("p",{class:(0,a.C_)(t.$style.description)},(0,a.zw)((0,o.SU)(e).fundraising.description),3),(0,n.Wm)(_t.Z,{class:(0,a.C_)(t.$style.progressbar),value:(0,o.SU)(e).fundraising.currentAmount,max:(0,o.SU)(e).fundraising.targetAmount,completed:(0,o.SU)(e).fundraisingCompleted},null,8,["class","value","max","completed"])],64)):((0,n.wg)(),(0,n.iD)("p",{key:1,class:(0,a.C_)(t.$style.emptyDescription)},[(0,n.Uk)(" Вы можете открыть сбор средств на определенную цель. Виджет для сбора появится в вашем профиле. Также вы сможете добавлять его в свои посты."),Tt,(0,n.Uk)(" Мы пока тестируем возможность целевого сбора средств, поэтому виджет доступен не всем пользователям. ")],2)),(0,n._)("div",{class:(0,a.C_)(t.$style.controls)},[(0,o.SU)(e).fundraising?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[(0,n.Wm)(r.Z,{label:"Закрыть сбор",class:(0,a.C_)(t.$style.closeBtn),loading:(0,o.SU)(e).loading.fundraising,wide:t.IS_MOBILE,theme:"negative",onClick:c[0]||(c[0]=t=>(s("click",{button:"author_donation_stop_target"}),void(i.value=!0)))},null,8,["class","loading","wide"]),0===(0,o.SU)(e).fundraising.currentAmount?((0,n.wg)(),(0,n.j4)(r.Z,{key:0,label:"Редактировать",wide:t.IS_MOBILE,theme:"gray",onClick:c[1]||(c[1]=t=>async function(){!e.loading.fundraising&&e.fundraising&&(l.value=!0,s("click",{button:"author_donation_edit_target"}))}())},null,8,["wide"])):(0,n.kq)("v-if",!0)],64)):((0,n.wg)(),(0,n.j4)(r.Z,{key:1,label:"Открыть",loading:(0,o.SU)(e).loading.fundraising,wide:t.IS_MOBILE,onClick:c[2]||(c[2]=t=>async function(){e.loading.fundraising||(l.value=!0,s("click",{button:"author_donation_open_target"}))}())},null,8,["loading","wide"]))],2),(0,o.SU)(e).fundraising?((0,n.wg)(),(0,n.iD)("p",{key:2,class:(0,a.C_)(t.$style.note)}," Вы можете добавлять виджет для целевого сбора средств к своим постам. Для этого зайдите в редактор, нажмите на иконку со знаком плюса и выберите значок виджета. ",2)):(0,n.kq)("v-if",!0)],2),(0,n.Wm)(ht.Z,{active:i.value,"onUpdate:active":c[3]||(c[3]=t=>i.value=t),title:"Закрыть сбор",content:"Вы уверены, что хотите закрыть сбор?",onConfirm:c[4]||(c[4]=t=>async function(){if(e.loading.fundraising||!e.fundraising)return;s("click",{button:"author_donation_stop_target_confirm"});const{response:t}=await e.deleteFundraisingWidget();t.result||m.core.ui.toasts.showError(t.message)}()),onClose:c[5]||(c[5]=t=>{s("click",{button:"author_donation_stop_target_cancel"})})},null,8,["active"]),(0,n.Wm)($t,{active:l.value,"onUpdate:active":c[6]||(c[6]=t=>l.value=t)},null,8,["active"])])),_:1}))}});var It=s(46914),Ot=s.n(It);const Ut={};Ut.$style=Ot();const Dt=(0,P.Z)(Et,[["__cssModules",Ut]]);var At=s(85651);const Mt=["innerHTML"],Nt=(0,n.aZ)({__name:"state-view",setup(t){const e=w(),s=(0,n.Fl)((()=>[u.NO_PHONE,u.NOT_RUSSIAN_PHONE].includes(e.state)));return(t,i)=>((0,n.wg)(),(0,n.iD)("div",null,[(0,o.SU)(e).receiveDenialReason?((0,n.wg)(),(0,n.j4)(At.Z,{key:0,theme:s.value?"yellow":"red"},{default:(0,n.w5)((()=>[(0,n._)("div",{innerHTML:(0,o.SU)(e).receiveDenialReason},null,8,Mt)])),_:1},8,["theme"])):((0,n.wg)(),(0,n.j4)(ot.Z,{key:1},{default:(0,n.w5)((()=>[(0,n._)("div",{class:(0,a.C_)(t.$style.content)},[(0,o.SU)(e).isEnabled?((0,n.wg)(),(0,n.j4)(Q,{key:0})):((0,n.wg)(),(0,n.j4)(R,{key:1}))],2)])),_:1}))]))}});var Pt=s(38531),Lt=s.n(Pt);const Rt={};Rt.$style=Lt();const jt=(0,P.Z)(Nt,[["__cssModules",Rt]]);var Bt=s(78373),qt=s(96614),Ft=s(70197),Vt=s(24482);const Zt=(0,n.aZ)({__name:"dialog-view",props:{modelValue:{type:Boolean}},emits:["update:modelValue","close","approve"],setup(t,{emit:e}){const s=t,i=e,l=(0,n.Fl)({get:()=>s.modelValue,set:t=>i("update:modelValue",t)}),c=w();async function d(){i("approve");const{response:t}=await c.deleteSubscriptionCost();t.result?(l.value=!1,m.core.ui.toasts.add({content:"Подписка успешно удалена. Ваши эксклюзивные посты теперь доступны всем пользователям"})):m.core.ui.toasts.showError(t.message)}function u(){l.value=!1,i("close")}return(t,e)=>((0,n.wg)(),(0,n.j4)(mt.Z,{modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=t=>l.value=t),title:"Удалить платную подписку",onClose:e[1]||(e[1]=t=>i("close"))},{footer:(0,n.w5)((()=>[(0,n._)("div",{class:(0,a.C_)(t.$style.footer)},[(0,n.Wm)(r.Z,{wide:t.IS_MOBILE,label:"Оставить подписку",onClick:u},null,8,["wide"]),(0,n.Wm)(r.Z,{wide:t.IS_MOBILE,theme:"gray",label:"Удалить",loading:(0,o.SU)(c).loading.deleteSubscriptionCost,onClick:d},null,8,["wide","loading"])],2)])),default:(0,n.w5)((()=>[(0,n._)("p",{class:(0,a.C_)(t.$style.p)}," Вы уверены, что хотите удалить возможность платной подписки на вас? ",2),(0,n._)("p",{class:(0,a.C_)(t.$style.p)}," Ваши эксклюзивные посты после этого станут доступны всем пользователям ",2)])),_:1},8,["modelValue"]))}});var Wt=s(35164),zt=s.n(Wt);const Ht={};Ht.$style=zt();const Gt=(0,P.Z)(Zt,[["__cssModules",Ht]]),Yt=(0,n.aZ)({__name:"delete-form-view",setup(t){const e=w(),{sendEvent:s}=(0,k.z)(),i=(0,o.iH)(!1);function r(){i.value=!0,s("click",{button:"paid_author_subscription_delete",subscribers:e.userSubsCount,rating:e.userKarma,size:100*e.subscriptionCost})}function l(){s("click",{button:"paid_author_subscription_delete_decline",subscribers:e.userSubsCount,rating:e.userKarma,size:100*e.subscriptionCost})}function c(){s("paid_author_subscription_delete_approve_button_tapped",{subscribers:e.userSubsCount,rating:e.userKarma,size:100*e.subscriptionCost})}return(t,s)=>((0,n.wg)(),(0,n.iD)("div",null,[(0,n._)("div",{class:(0,a.C_)(t.$style.cost)},[(0,n._)("span",{class:(0,a.C_)(t.$style.value)},(0,a.zw)((0,o.SU)(tt.uf)((0,o.SU)(e).subscriptionCost)),3),(0,n._)("span",{class:(0,a.C_)(t.$style.units)},"рублей",2)],2),(0,n._)("button",{class:(0,a.C_)(t.$style.button),type:"button",onClick:r},[(0,n.Wm)(Ct.Z,{name:"delete_16",class:(0,a.C_)(t.$style.icon)},null,8,["class"]),(0,n.Uk)(" Удалить ")],2),(0,n.Wm)(Gt,{modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=t=>i.value=t),onClose:l,onApprove:c},null,8,["modelValue"])]))}});var Kt=s(34728),Qt=s.n(Kt);const Xt={};Xt.$style=Qt();const Jt=(0,P.Z)(Yt,[["__cssModules",Xt]]);s(74916),s(15306);var te=s(49963);const ee=["onSubmit"],se=(0,n.aZ)({__name:"set-form-view",setup(t){const e=w(),{sendEvent:s}=(0,k.z)(),i=(0,o.iH)(e.subscriptionCost?String(e.subscriptionCost):""),l=(0,n.Fl)((()=>{if(!i.value)return!1;const t=Number(i.value);return t<e.MIN_SUBSCRIPTION_COST?`Стоимость подписки не может быть меньше ${(0,tt.uf)(e.MIN_SUBSCRIPTION_COST)} руб.`:t>e.MAX_SUBSCRIPTION_COST&&`Стоимость подписки не может быть больше ${(0,tt.uf)(e.MAX_SUBSCRIPTION_COST)} руб.`})),c=(0,n.Fl)((()=>i.value&&!l.value));function d(t){return t.replace(/\D/g,"").replace(/^0+/,"").slice(0,4)}async function u(){const t=Number(i.value);if(s("paid_author_subscription_create_button_tapped",{component_name:"monetization",subscribers:e.userSubsCount,rating:e.userKarma,size:100*t}),!c.value)return;const{response:n}=await e.setSubscriptionCost(t);n.result||m.core.ui.toasts.showError(n.message)}function p(){s("error_occurred",{type:"invalid_subscription_cost",type_i8:k.k.MONETIZATION,component_name:"monetization"})}return(t,s)=>((0,n.wg)(),(0,n.iD)("form",{onSubmit:(0,te.iM)(u,["prevent"])},[(0,n._)("p",{class:(0,a.C_)(t.$style.note)}," Внимание! После сохранения вы не сможете изменить стоимость подписки ",2),(0,n._)("div",{class:(0,a.C_)(t.$style.cost)},[(0,n.Wm)(ft.Z,{modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=t=>i.value=t),class:(0,a.C_)(t.$style.input),inputmode:"numeric",label:"Введите сумму",clean:d,error:l.value,"onShow:error":p},null,8,["modelValue","class","error"]),(0,n._)("span",{class:(0,a.C_)(t.$style.units)},"рублей",2)],2),(0,n.Wm)(r.Z,{label:"Сохранить",class:(0,a.C_)(t.$style.button),wide:t.IS_MOBILE,disabled:!c.value,loading:(0,o.SU)(e).loading.setSubscriptionCost,type:"submit"},null,8,["class","wide","disabled","loading"])],40,ee))}});var ie=s(93493),ne=s.n(ie);const ae={};ae.$style=ne();const oe=(0,P.Z)(se,[["__cssModules",ae]]),re=[(0,n._)("p",null,"Укажите стоимость ежемесячной подписки на ваши эксклюзивные посты.",-1),(0,n._)("p",null," После ввода суммы, при создании нового поста в редакторе вы сможете отметить его как доступный только для подписчиков. ",-1)],le=(0,n.aZ)({__name:"paid-subscription-view",setup(t){const e=w(),{sendEvent:s}=(0,k.z)();function i(){s("click",{button:"paid_author_subscription_about",component_name:"monetization"})}return(0,n.bv)((()=>s("paid_author_subscription_form_showed",{component_name:"monetization"}))),(t,s)=>((0,n.wg)(),(0,n.j4)(ot.Z,null,{default:(0,n.w5)((()=>[(0,n.Wm)(rt.Z,null,{right:(0,n.w5)((()=>[(0,n._)("a",{href:"/go/help_paid_subs",target:"_blank",onClick:i}," Что такое платные подписки? ")])),default:(0,n.w5)((()=>[(0,n.Uk)(" Платная подписка ")])),_:1}),(0,n._)("div",{class:(0,a.C_)(t.$style.content)},[(0,n._)("div",{class:(0,a.C_)(t.$style.text)},re,2),(0,o.SU)(e).subscriptionCost?((0,n.wg)(),(0,n.j4)(Jt,{key:0,class:(0,a.C_)(t.$style.deleteForm)},null,8,["class"])):((0,n.wg)(),(0,n.j4)(oe,{key:1,class:(0,a.C_)(t.$style.setForm)},null,8,["class"]))],2)])),_:1}))}});var ce=s(64417),de=s.n(ce);const ue={};ue.$style=de();const pe=(0,P.Z)(le,[["__cssModules",ue]]),he=(0,n.aZ)({__name:"tabs-view",setup(t){const e=(0,o.iH)("sponsors");return(t,s)=>((0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(Bt.Z,{modelValue:e.value,"onUpdate:modelValue":s[0]||(s[0]=t=>e.value=t)},{default:(0,n.w5)((()=>[(0,n.Wm)(qt.Z,{name:"sponsors"},{default:(0,n.w5)((()=>[(0,n.Uk)(" Донаты ")])),_:1}),(0,n.Wm)(qt.Z,{name:"subscription"},{default:(0,n.w5)((()=>[(0,n.Uk)(" Платная подписка ")])),_:1})])),_:1},8,["modelValue"]),(0,n.Wm)(Ft.Z,{tab:e.value,class:(0,a.C_)(t.$style.panels)},{default:(0,n.w5)((()=>[(0,n.Wm)(Vt.Z,{name:"sponsors"},{default:(0,n.w5)((()=>[(0,n.Wm)(pt),(0,n.Wm)(Dt,{class:(0,a.C_)(t.$style.fundraising)},null,8,["class"])])),_:1}),(0,n.Wm)(Vt.Z,{name:"subscription"},{default:(0,n.w5)((()=>[(0,n.Wm)(pe)])),_:1})])),_:1},8,["tab","class"])]))}});var _e=s(81026),me=s.n(_e);const ge={};ge.$style=me();const fe=(0,P.Z)(he,[["__cssModules",ge]]);var ve=s(32499),be=s(90008),ye=s(62728),we=s(1876);const ke=(0,n._)("strong",null,"потеряете доступ ко всем эксклюзивным постам автора",-1),xe=(0,n.aZ)({__name:"dialog-view",props:{modelValue:{type:Boolean},authorId:{},authorName:{}},emits:["update:modelValue","close","approve"],setup(t,{emit:e}){const s=t,i=e,l=(0,n.Fl)({get:()=>s.modelValue,set:t=>i("update:modelValue",t)}),c=w();function d(){i("close"),l.value=!1}async function u(){i("approve");const{response:t}=await c.unsubscribe(s.authorId);t.result?(l.value=!1,m.core.ui.toasts.add({content:"Подписка отменена. Доступ будет отключен после окончания оплаченного периода"})):m.core.ui.toasts.showError(t.message,{isGlobal:!0})}return(t,e)=>((0,n.wg)(),(0,n.j4)(mt.Z,{modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=t=>l.value=t),title:"Отмена подписки",onClose:e[1]||(e[1]=t=>i("close"))},{footer:(0,n.w5)((()=>[(0,n._)("div",{class:(0,a.C_)(t.$style.footer)},[(0,n.Wm)(r.Z,{wide:t.IS_MOBILE,label:"Хочу оставить подписку",onClick:d},null,8,["wide"]),(0,n.Wm)(r.Z,{wide:t.IS_MOBILE,theme:"gray",label:"Отменить подписку",loading:(0,o.SU)(c).loading.unsubscribe,onClick:u},null,8,["wide","loading"])],2)])),default:(0,n.w5)((()=>[(0,n._)("p",{class:(0,a.C_)(t.$style.p)}," Вы уверены, что хотите отменить подписку на автора "+(0,a.zw)(s.authorName)+"? ",3),(0,n._)("p",{class:(0,a.C_)(t.$style.p)},[(0,n.Uk)(" Подписка продолжит действовать до окончания оплаченного периода, а затем будет отключена. После этого вы "),ke,(0,n.Uk)(". ")],2)])),_:1},8,["modelValue"]))}});var Se=s(51559),$e=s.n(Se);const Ce={};Ce.$style=$e();const Te=(0,P.Z)(xe,[["__cssModules",Ce]]);function Ee(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function Ie(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?Ee(Object(s),!0).forEach((function(e){Oe(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Ee(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function Oe(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const Ue=(0,n.aZ)({__name:"subscriptions-view",setup(t){const e=w(),{sendEvent:s}=(0,k.z)(),i=(0,o.qj)({isActive:!1,name:"",id:null});function r(t){switch(t.state){case p.RENEWAL:return"Неудачная попытка продления";case p.ACTIVE:return`Следующее списание ${(0,tt.p6)(1e3*t.nextRenewalTime)}`;default:return`Действует до ${(0,tt.p6)(1e3*t.nextRenewalTime)}`}}let l={};function c(){s("click",Ie({button:"paid_author_subscription_cancel_decline"},l))}function d(){s("paid_author_subscription_cancel_approve_button_tapped",Ie({},l))}return(t,u)=>((0,n.wg)(),(0,n.j4)(ot.Z,null,{default:(0,n.w5)((()=>{var h;return[(0,n.Wm)(rt.Z,null,{default:(0,n.w5)((()=>[(0,n.Uk)("Кого вы поддерживаете")])),_:1}),(0,n._)("div",{class:(0,a.C_)(t.$style.content)},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)((0,o.SU)(e).subscriptions,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e.authorId,class:(0,a.C_)(t.$style.subscription)},[(0,n.Wm)(we.Z,{class:(0,a.C_)(t.$style.user),avatar:e.authorAvatarUrl,name:e.authorUsername},null,8,["class","avatar","name"]),(0,n._)("div",{class:(0,a.C_)(t.$style.cost)},(0,a.zw)((0,o.SU)(tt.xG)(e.cost))+" в месяц ",3),(0,n._)("div",{class:(0,a.C_)({[t.$style.status]:!0,[t.$style.status_danger]:e.state!==(0,o.SU)(p).ACTIVE})},(0,a.zw)(r(e)),3),(0,n._)("div",{class:(0,a.C_)(t.$style.actions)},[e.state!==(0,o.SU)(p).CANCELLED?((0,n.wg)(),(0,n.j4)(ve.Z,{key:0},{trigger:(0,n.w5)((({toggle:t})=>[(0,n.Wm)(ye.Z,{"icon-name":"more_16",size:"large",onClick:e=>t()},null,8,["onClick"])])),default:(0,n.w5)((({toggle:t})=>[(0,n.Wm)(be.Z,{label:"Отменить подписку",onClick:n=>function(t,e){e(),i.name=t.authorUsername,i.id=t.authorId,i.isActive=!0,s("click",Ie({button:"paid_author_subscription_cancel"},l={author_id:t.authorId,size:100*t.cost}))}(e,t)},null,8,["onClick"])])),_:2},1024)):(0,n.kq)("v-if",!0)],2)],2)))),128))],2),(0,n.Wm)(Te,{modelValue:i.isActive,"onUpdate:modelValue":u[0]||(u[0]=t=>i.isActive=t),"author-id":null!==(h=i.id)&&void 0!==h?h:void 0,"author-name":i.name,onClose:c,onApprove:d},null,8,["modelValue","author-id","author-name"])]})),_:1}))}});var De=s(23370),Ae=s.n(De);const Me={};Me.$style=Ae();const Ne=(0,P.Z)(Ue,[["__cssModules",Me]]);var Pe=s(75130);const Le={key:0},Re=(0,n.aZ)({__name:"app",setup(t){const e=new Pe.U,s=c.V.isUserInExperiment(c.t.PAID_SUBS),i=w();return(0,n.bv)((async()=>{e.get("isDonationsNewBadgeHidden")||e.set("isDonationsNewBadgeHidden",!0)})),(t,e)=>((0,n.wg)(),(0,n.iD)("div",{class:(0,a.C_)(t.$style.host)},[(0,o.SU)(s)?((0,n.wg)(),(0,n.iD)("div",Le,[(0,n.Wm)(jt,{class:(0,a.C_)(t.$style.card)},null,8,["class"]),(0,o.SU)(i).subscriptions.length?((0,n.wg)(),(0,n.j4)(Ne,{key:0,class:(0,a.C_)(t.$style.card)},null,8,["class"])):(0,n.kq)("v-if",!0),(0,o.SU)(i).canReceive&&(0,o.SU)(i).isEnabled?((0,n.wg)(),(0,n.j4)(fe,{key:1,class:(0,a.C_)(t.$style.card)},null,8,["class"])):(0,n.kq)("v-if",!0)])):((0,n.wg)(),(0,n.iD)(n.HY,{key:1},[(0,o.SU)(i).subscriptions.length?((0,n.wg)(),(0,n.j4)(Ne,{key:0,class:(0,a.C_)(t.$style.card)},null,8,["class"])):(0,n.kq)("v-if",!0),(0,n.Wm)(pt,{class:(0,a.C_)(t.$style.card)},null,8,["class"]),(0,n.Wm)(Dt,{class:(0,a.C_)(t.$style.card)},null,8,["class"])],64))],2))}});var je=s(61709),Be=s.n(je);const qe={};qe.$style=Be();const Fe=(0,P.Z)(Re,[["__cssModules",qe]]);function Ve(){return(0,i.a)(Fe)}},37319:(t,e,s)=>{"use strict";s.r(e),s.d(e,{createApp:()=>G});var i=s(76944),n=s(66252),a=s(2262),o=s(3577),r=s(12953),l=(s(88674),s(96637)),c=s(1262),d=s(40094),u=s(34828),p=(s(41817),s(69876));function h(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function _(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?h(Object(s),!0).forEach((function(e){m(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):h(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function m(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const g=r.core.config("modules.notifications"),f=(0,p.Q_)("notifications",{state:()=>_(_({},g),{},{count:g.messages.length})}),v=(0,n.aZ)({__name:"notifications-info",setup(t){const e=f(),s=(0,a.iH)(!1),i=(0,n.Fl)((()=>e.newCount?`\n\t\t\t${e.newCount} ${l.Utils.pluralNounRU(e.newCount,["новое уведомление","новых уведомления","новых уведомлений"])}\n\t\t`:"Новых уведомлений нет")),p=(0,n.Fl)((()=>`\n\t\tВсего ${e.count} ${l.Utils.pluralNounRU(e.count,["уведомление","уведомления","уведомлений"])}\n\t`));async function h(){try{await c.User.removeNotifications(),window.location.reload()}catch(t){r.core.ui.toasts.showError(t)}}return(t,e)=>((0,n.wg)(),(0,n.iD)("div",{class:(0,o.C_)(t.$style.block)},[(0,n._)("div",null,[(0,n._)("h3",{class:(0,o.C_)(t.$style.title)},(0,o.zw)(i.value),3),(0,n._)("p",{class:(0,o.C_)(t.$style.text)},(0,o.zw)(p.value),3)]),(0,n._)("span",{class:(0,o.C_)(t.$style.delete),onClick:e[0]||(e[0]=t=>s.value=!0)},[(0,n.Wm)(d.Z,{name:"delete_16",class:(0,o.C_)(t.$style.icon)},null,8,["class"])],2),(0,n.Wm)(u.Z,{active:s.value,"onUpdate:active":e[1]||(e[1]=t=>s.value=t),title:"Подтверждение",content:"Действительно удалить все уведомления?",onConfirm:h},null,8,["active"]),(0,n._)("a",{href:"/settings/notifications",class:(0,o.C_)([t.$style.link,"hint"]),"aria-label":"Настройка уведомлений"},[(0,n.Wm)(d.Z,{name:"setting_20",class:(0,o.C_)(t.$style.icon)},null,8,["class"])],2)],2))}});var b=s(13609),y=s.n(b),w=s(83744);const k={};k.$style=y();const x=(0,w.Z)(v,[["__cssModules",k]]),S={2:"delete_16",3:"ban_20",4:"news_20"};var $=s(30381),C=s.n($),T=s(80037);const E={key:0},I={key:1},O=["datetime"],U=["innerHTML"],D=["src"],A=["href"],M=(0,n.aZ)({__name:"notifications-item",props:{item:{}},setup(t){const e=t,s=(0,a.iH)();(0,n.bv)((()=>{s.value&&(0,T.I)(e.item)}));const i=(0,n.Fl)((()=>C()(e.item.datetime).format("DD MMMM YYYY, HH:mm"))),r=(0,n.Fl)((()=>e.item.icon&&e.item.icon.endsWith(".png"))),l=(0,n.Fl)((()=>S[e.item.icon_code]||"message_20"));return(t,a)=>((0,n.wg)(),(0,n.iD)("div",{class:(0,o.C_)([t.$style.item,{[t.$style.new]:e.item.is_new}])},[(0,n._)("div",{class:(0,o.C_)(t.$style.header)},[(0,n._)("div",{class:(0,o.C_)(t.$style.typeIcon)},[r.value?((0,n.wg)(),(0,n.iD)("div",E,[(0,n.Wm)(d.Z,{name:"reward_20",class:(0,o.C_)(t.$style.rewardIcon)},null,8,["class"])])):((0,n.wg)(),(0,n.iD)("div",I,[(0,n.Wm)(d.Z,{name:l.value},null,8,["name"])]))],2),(0,n._)("time",{class:(0,o.C_)(t.$style.datetime),datetime:e.item.datetime},(0,o.zw)(i.value),11,O)],2),(0,n._)("div",{ref_key:"contentEl",ref:s,class:(0,o.C_)(t.$style.content)},[(0,n._)("p",{innerHTML:e.item.text},null,8,U),r.value&&e.item.icon?((0,n.wg)(),(0,n.iD)("img",{key:0,src:e.item.icon},null,8,D)):(0,n.kq)("v-if",!0)],2),e.item.type?((0,n.wg)(),(0,n.iD)("a",{key:0,href:`/settings/notifications#option-${e.item.type}`,class:(0,o.C_)(t.$style.settings)},[(0,n.Wm)(d.Z,{name:"setting_20",class:(0,o.C_)(t.$style.settingsIcon)},null,8,["class"])],10,A)):(0,n.kq)("v-if",!0)],2))}});var N=s(40082),P=s.n(N);const L={};L.$style=P();const R=(0,w.Z)(M,[["__cssModules",L]]);var j=s(85651),B=s(20446);const q=(0,n._)("h3",null,"Пока рассказывать не о чем ¯\\_(ツ)_/¯",-1),F=(0,n._)("p",null,"Здесь будут уведомления о полученных наградах, обновлениях на сайте и многом другом.",-1),V=(0,n.aZ)({__name:"app",setup(t){const e=f(),s=(0,n.Fl)((()=>!e.isAdminView&&e.count));return(0,n.bv)((()=>{r.core.ui.screen=B.dt.NOTIFICATIONS})),(t,i)=>((0,n.wg)(),(0,n.iD)(n.HY,null,[(0,a.SU)(e).isAdminView?((0,n.wg)(),(0,n.j4)(j.Z,{key:0,theme:"yellow"},{default:(0,n.w5)((()=>[(0,n._)("div",{class:(0,o.C_)(t.$style.alert)},[(0,n._)("span",null,[(0,n.Wm)(d.Z,{name:"moderator",class:(0,o.C_)(t.$style.alertIcon)},null,8,["class"])]),(0,n.Uk)(" Режим просмотра от лица администратора ")],2)])),_:1})):(0,n.kq)("v-if",!0),(0,a.SU)(e).count?((0,n.wg)(),(0,n.iD)("section",{key:2,class:(0,o.C_)(t.$style.content)},[s.value?((0,n.wg)(),(0,n.j4)(x,{key:0})):(0,n.kq)("v-if",!0),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)((0,a.SU)(e).messages,(t=>((0,n.wg)(),(0,n.j4)(R,{key:t.id,item:t},null,8,["item"])))),128))],2)):((0,n.wg)(),(0,n.iD)("section",{key:1,class:(0,o.C_)(t.$style.empty)},[q,F,(0,n._)("a",{href:"/settings/notifications",class:(0,o.C_)([t.$style.link,"hint"]),"aria-label":"Настройка уведомлений"},[(0,n.Wm)(d.Z,{name:"setting_20"})],2)],2))],64))}});var Z=s(76425),W=s.n(Z);const z={};z.$style=W();const H=(0,w.Z)(V,[["__cssModules",z]]);function G(){return(0,i.a)(H)}},39681:(t,e,s)=>{"use strict";s.r(e),s.d(e,{createApp:()=>z});var i=s(76944),n=s(66252),a=s(3577),o=s(37043),r=s(42107);const l=(0,n.aZ)({__name:"success-message",setup:t=>((0,n.bv)((()=>{r.cp.getInstance().sendEvent("form_show",{type:"pikabu_plus_request_sent"})})),(t,e)=>((0,n.wg)(),(0,n.iD)("section",{class:(0,a.C_)(t.$style.host)},[(0,n._)("div",{class:(0,a.C_)(t.$style.host__title)}," Ваша заявка принята! ",2),(0,n._)("div",{class:(0,a.C_)(t.$style.host__text)}," В течение 3 рабочих дней наш менеджер свяжется с вами и отправит счет на оплату для подключения подписки. ",2),(0,n._)("div",null,[(0,n.Wm)(o.Z,{href:"/"},{default:(0,n.w5)((()=>[(0,n.Uk)(" На главную ")])),_:1})])],2)))});var c=s(1144),d=s.n(c),u=s(83744);const p={};p.$style=d();const h=(0,u.Z)(l,[["__cssModules",p]]);s(66992),s(33948),s(74916),s(41817);var _=s(2262),m=s(20446),g=s(50542),f=s(47961),v=s(3485),b=s(22177),y=s(47344),w=s(64090),k=s(49963),x=s(55946),S=s(96637),$=s(89661),C=s(55680),T=s(12953),E=s(66309);function I(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function O(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?I(Object(s),!0).forEach((function(e){U(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):I(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function U(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const D=(0,n._)("p",null," С этой подпиской для малого бизнеса и самозанятых вы привлечете внимание большого количества людей. Сможете делиться новостями, рассказывать о своих продуктах или услугах и получать моментальную обратную связь. ",-1),A=(0,n._)("p",null,[(0,n.Uk)(" Ежедневно Пикабу посещает более 3 млн человек. Создавайте качественный контент, открыто отвечайте на вопросы пользователей в комментариях и получайте заслуженно высокие результаты от размещения. По всем вопросам — "),(0,n._)("a",{href:"mailto:plus@pikabu.ru"},"plus@pikabu.ru"),(0,n.Uk)(". ")],-1),M=(0,n._)("p",null,[(0,n._)("b",null,"Что еще дает подписка Пикабу+:"),(0,n._)("br"),(0,n.Uk)(" — Галочку верифицированного аккаунта;"),(0,n._)("br"),(0,n.Uk)(" — Возможность добавлять рекламные ссылки;"),(0,n._)("br"),(0,n.Uk)(" — Попадание во все пользовательские ленты в зависимости от рейтинга;"),(0,n._)("br"),(0,n.Uk)(" — Возможность отключить рекламу на Пикабу;"),(0,n._)("br"),(0,n.Uk)(" — 5 000 бонусных рублей в Яндекс Бизнесе. ")],-1),N=(0,n._)("hr",null,null,-1),P=["data-field"],L=(0,n._)("div",null,[(0,n.Uk)(" Подтверждаю, что ознакомился с условиями "),(0,n._)("a",{href:"https://specials.pikabu.ru/apps/docs/c/oferta_plus_pikabu.pdf",target:"_blank"},"публичной оферты")],-1),R=["src"],j="Поле обязательно для заполнения",B=(0,n.aZ)({__name:"request-form",emits:["submitSuccess"],setup(t,{emit:e}){const{sendEvent:s}=(0,x.z)(),i=e,r={jur:"Юрлицо",ip:"ИП",phys:"Самозанятый / Физлицо"},l=(0,_.qj)({profile:T.core.initParams.userName?`https://pikabu.ru/@${T.core.initParams.userName}`:"",period:1,promocode:"",orgType:"phys",inn:"",kpp:"",orgName:"",addressActual:"",addressJur:"",addressReg:"",addressMail:"",fioPhys:"",phone:"",fio:"",email:""}),c=(0,_.iH)(""),{data:d}=(0,C.BN)((0,n.Fl)((()=>l.period)),(0,n.Fl)((()=>c.value))),u=(0,C.qh)(),p=(0,_.iH)(0),h=(0,n.YP)(d,(()=>{d.value&&(p.value=Math.ceil(d.value.price/l.period),h())})),I=(0,_.iH)(),{stop:U}=(0,E.S1d)(I,(([{isIntersecting:t}])=>{t&&(s("reach_element",{type:"pikabu_plus_faq"}),U())}),{threshold:1}),B={jur:[["ИНН","inn"],["КПП","kpp"],["Название юрлица","orgName"],["Адрес фактический","addressActual"],["Адрес юридический","addressJur"]],ip:[["ИНН","inn"],["Название ИП","orgName"],["Адрес регистрации","addressReg"],["Адрес для отправки корреспонденции","addressMail"]],phys:[]},q=[{title:"Какому бизнесу подходит подписка?",content:"Подписка ориентирована на&nbsp;малый бизнес и&nbsp;самозанятых. Вы&nbsp;можете быть художником, селлером на&nbsp;маркетплейсах, владельцем точки общепита или оказывать услуги по&nbsp;ремонту бытовой техники. Мы&nbsp;уверены, что внутри Пикабу каждый найдет свою аудиторию."},{title:"Я могу использовать utm-метки?",content:'Да, вы&nbsp;можете использовать любые метки, которые помогут вам лучше проанализировать результаты размещения. Если понадобится какая-либо помощь по&nbsp;технической части, пишите нам на&nbsp;<a href="mailto:plus@pikabu.ru">plus@pikabu.ru</a>.'},{title:"Вы модерируете негативные отзывы и комментарии?",content:"Нет, мы&nbsp;не&nbsp;удаляем негативные комментарии и&nbsp;отзывы, если они не&nbsp;нарушают правила Пикабу. Мы&nbsp;считаем, что одна из&nbsp;задач бизнеса&nbsp;&mdash; работа с&nbsp;обратной связью от&nbsp;пользователей, в&nbsp;том числе негативной."},{title:"Я могу заморозить подписку?",content:'Да, действие подписки можно заморозить на&nbsp;2&nbsp;недели. Для этого напишите нам на&nbsp;<a href="mailto:plus@pikabu.ru">plus@pikabu.ru</a>.'},{title:"Можно ли дополнительно продвигать посты?",content:"Вы&nbsp;можете дополнительно продвигать свои посты в&nbsp;лентах Пикабу. Стоимость 1000 показов поста&nbsp;&mdash; 300 рублей с&nbsp;НДС. <br/><b>Важно:</b> у&nbsp;таких постов появится плашка &laquo;Промо&raquo; и&nbsp;соответствующая маркировка, чтобы остальные пользователи могли понять, что это рекламный пост."},{title:"Если я перестану оплачивать подписку Пикабу+, вы удалите посты?",content:"Посты останутся в&nbsp;вашем аккаунте и&nbsp;будут доступны по&nbsp;прямой ссылке. Но&nbsp;будут исключены из&nbsp;индексации поисковыми системами и&nbsp;показа в&nbsp;лентах Пикабу."},{title:"Что дает промокод на Яндекс Бизнес?",content:"Промокод добавляет 5&nbsp;000 бонусных рублей к&nbsp;рекламному бюджету в&nbsp;Яндекс Бизнесе. Действует для новых клиентов Яндекс Бизнеса или если последняя рекламная кампания закончилась более 365 дней назад. Активируется при минимальном бюджете рекламной кампании от&nbsp;15&nbsp;000&nbsp;рублей."}],F=(0,_.iH)(!1),V=(0,_.iH)({}),Z=(0,k.fb)(),W=()=>{c.value=l.promocode.toUpperCase()},z=(0,n.Fl)((()=>d.value&&d.value.promo_code&&c.value)),H=(0,n.Fl)((()=>d.value&&!d.value.promo_code&&c.value)),G=()=>{et.value=`https://yandex.ru/ads/adfox/260477/getCode?p1=cnpjl&p2=frfe&pfc=gmzsx&pfb=subxp&pr=${J()}&ptrc=b`;const t=(()=>{const t={};return 0===l.profile.trim().length?t.profile=j:/https:\/\/pikabu\.ru\/@[\d.A-Za-z]{4,}/.test(l.profile.trim())||(t.profile="Ссылка на аккаунт указана неверно"),B[l.orgType].forEach((([e,s])=>{0===l[s].trim().length&&(t[s]=j)})),0===l.fio.trim().length&&(t.fio=j),0===l.email.trim().length?t.email=j:/^\S+@\S+\.\S+$/.test(l.email.trim())||(t.email="E-mail указан неверно"),t})();if(0===Object.keys(t).length)s("pikabu_plus_request_sent",{}),u.mutate(O(O({profile_link:l.profile.trim(),month_count:l.period,fullName:l.fio.trim(),email:l.email.trim()},"jur"===l.orgType?{type:C.XX.jur,legal_entity_itn:l.inn.trim(),legal_entity_kpp:l.kpp.trim(),legal_entity_name:l.orgName.trim(),legal_entity_actual_address:l.addressActual.trim(),legal_entity_legal_address:l.addressJur.trim()}:"ip"===l.orgType?{type:C.XX.ip,individual_entrepreneur_itn:l.inn.trim(),individual_entrepreneur_name:l.orgName.trim(),individual_entrepreneur_registration_address:l.addressReg.trim(),individual_entrepreneur_address_for_correspondence:l.addressMail.trim()}:{type:C.XX.phys}),{},{promo_code:c.value}),{onSuccess:()=>{i("submitSuccess")}});else{var e;const s=Object.keys(t)[0];Object.keys(t).forEach((e=>{e!==s&&(t[e]=!0)})),V.value=t,null===(e=document.querySelector(`.${Z.form} [data-field="${s}"]`))||void 0===e||e.scrollIntoView({behavior:"smooth"})}};let Y=O({},l);(0,n.YP)(l,(()=>{Object.keys(l).forEach((t=>{if(Y[t]!==l[t]){if(delete V.value[t],"orgType"===t)for(const[t,e]of B[Y.orgType])delete V.value[e];"period"===t&&K("placement_period")}})),Y=O({},l)})),(0,n.YP)(F,(()=>{F.value&&s("mark",{type:"offer_terms"})}));const K=t=>{s("page_load",{type:t})},Q=t=>{if("requisites"===t){let e=!0;for(let t of B[l.orgType])0===l[t[1]].trim().length&&(e=!1);e&&s("fields_fulled",{type:t})}"contact_information"===t&&0!==l.fio.trim().length&&0!==l.email.trim().length&&s("fields_fulled",{type:t})},X=(t,e)=>{s(t?"answer_hid":"answer_unhid",{type:"pikabu_plus_faq",level:e})},J=()=>Math.ceil(4294967295*Math.random()),tt=`https://yandex.ru/ads/adfox/260477/getCode?p1=cnpjl&p2=frfe&pfc=gmzsx&pfb=subxm&pr=${J}&ptrc=b`,et=(0,_.iH)("");return(0,n.bv)((()=>{T.core.ui.screen=m.dt.PIKABU_PLUS,s("page_load",{})})),(t,e)=>((0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("section",{class:(0,a.C_)((0,_.SU)(Z).header)},[(0,n._)("div",{class:(0,a.C_)((0,_.SU)(Z).header__title)}," Подписка Пикабу+ ",2),(0,n._)("div",{class:(0,a.C_)((0,_.SU)(Z).header__descr)},[D,A,(0,n._)("p",null,[(0,n._)("b",null,[(0,n.Uk)(" Стоимость подписки — "),p.value?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[(0,n.Uk)((0,a.zw)(p.value.toLocaleString("ru-RU"))+" рублей в месяц ",1)],64)):((0,n.wg)(),(0,n.j4)($.Z,{key:1,class:(0,a.C_)((0,_.SU)(Z).loader)},null,8,["class"]))])]),M],2)],2),(0,n._)("section",{class:(0,a.C_)((0,_.SU)(Z).form)},[(0,n._)("div",{class:(0,a.C_)([(0,_.SU)(Z).field,(0,_.SU)(Z).field_profile]),"data-field":"profile"},[(0,n._)("div",{class:(0,a.C_)((0,_.SU)(Z).field__title)}," Ссылка на ваш аккаунт на Пикабу ",2),(0,n.Wm)(g.Z,{modelValue:l.profile,"onUpdate:modelValue":e[0]||(e[0]=t=>l.profile=t),placeholder:"https://pikabu.ru/@НИКНЕЙМ","aria-autocomplete":"none",class:(0,a.C_)((0,_.SU)(Z).field__input),inputmode:"url",error:V.value.profile,"show-error-immediately":!0,onChange:e[1]||(e[1]=t=>K("account_link"))},null,8,["modelValue","class","error"])],2),(0,n._)("div",{class:(0,a.C_)([(0,_.SU)(Z).field,(0,_.SU)(Z).field_period])},[(0,n._)("div",{class:(0,a.C_)((0,_.SU)(Z).field__title)}," Период размещения ",2),(0,n.Wm)(f.Z,{modelValue:l.period,"onUpdate:modelValue":e[2]||(e[2]=t=>l.period=t),label:"Выберите период размещения",class:(0,a.C_)((0,_.SU)(Z).field__input)},{default:(0,n.w5)((()=>[((0,n.wg)(),(0,n.iD)(n.HY,null,(0,n.Ko)(12,(t=>(0,n.Wm)(v.Z,{key:t,label:t+" "+(0,_.SU)(S.Utils).pluralNounRU(t,["месяц","месяца","месяцев"]),value:t},null,8,["label","value"]))),64))])),_:1},8,["modelValue","class"])],2),(0,n._)("div",{class:(0,a.C_)([(0,_.SU)(Z).field,(0,_.SU)(Z).field_promocode])},[(0,n._)("div",{class:(0,a.C_)((0,_.SU)(Z).field__title)}," У меня есть промокод ",2),(0,n._)("div",{class:(0,a.C_)((0,_.SU)(Z).promocodeWrapper)},[(0,n.Wm)(g.Z,{modelValue:l.promocode,"onUpdate:modelValue":e[3]||(e[3]=t=>l.promocode=t),placeholder:"Введите промокод","aria-autocomplete":"none",class:(0,a.C_)([(0,_.SU)(Z).field__input,(0,_.SU)(Z).field__input_promocode,z.value&&(0,_.SU)(Z).field__input_valid,H.value&&(0,_.SU)(Z).field__input_error]),onInput:e[4]||(e[4]=t=>c.value="")},null,8,["modelValue","class"]),(0,n.Wm)(o.Z,{disabled:!l.promocode,class:(0,a.C_)((0,_.SU)(Z).button_promocode),onClick:W},{default:(0,n.w5)((()=>[(0,n.Uk)(" Применить ")])),_:1},8,["disabled","class"])],2),z.value?((0,n.wg)(),(0,n.iD)("p",{key:0,class:(0,a.C_)([(0,_.SU)(Z).promocodeNote])},"Ваш промокод применен",2)):(0,n.kq)("v-if",!0),H.value?((0,n.wg)(),(0,n.iD)("p",{key:1,class:(0,a.C_)([(0,_.SU)(Z).promocodeNote,(0,_.SU)(Z).promocodeError])}," Введенный промокод недействителен ",2)):(0,n.kq)("v-if",!0)],2),(0,n._)("div",{class:(0,a.C_)((0,_.SU)(Z).field)},[(0,n._)("div",{class:(0,a.C_)([(0,_.SU)(Z).field__title,(0,_.SU)(Z).field_cost])},[(0,n.Uk)(" Стоимость: "),(0,_.SU)(d)?((0,n.wg)(),(0,n.iD)("div",{key:0,class:(0,a.C_)((0,_.SU)(Z)["cost-label"])},[(0,n.Uk)((0,a.zw)((0,_.SU)(d).result_price.toLocaleString("ru-RU"))+" рублей ",1),(0,_.SU)(d).percent_discount?((0,n.wg)(),(0,n.iD)("span",{key:0,class:(0,a.C_)((0,_.SU)(Z)["discount-badge"])},(0,a.zw)(`-${(0,_.SU)(d).percent_discount}%`),3)):(0,n.kq)("v-if",!0)],2)):((0,n.wg)(),(0,n.j4)($.Z,{key:1,class:(0,a.C_)((0,_.SU)(Z)["cost-loader"])},null,8,["class"]))],2),(0,n._)("div",{class:(0,a.C_)((0,_.SU)(Z).field__descr)}," Рассчитывается за выбранный период подписки с учетом НДС ",2)],2),N,(0,n._)("div",{class:(0,a.C_)([(0,_.SU)(Z).field,(0,_.SU)(Z)["field_org-type"]])},[(0,n._)("div",{class:(0,a.C_)((0,_.SU)(Z).field__title)}," Тип организации ",2),(0,n._)("div",{class:(0,a.C_)((0,_.SU)(Z).field__descr)}," На данные реквизиты будут выставлены документы ",2),(0,n._)("div",{class:(0,a.C_)((0,_.SU)(Z).field__input)},[((0,n.wg)(),(0,n.iD)(n.HY,null,(0,n.Ko)(r,((t,s)=>(0,n.Wm)(b.Z,{key:s,modelValue:l.orgType,"onUpdate:modelValue":e[5]||(e[5]=t=>l.orgType=t),label:t,value:s},null,8,["modelValue","label","value"]))),64))],2)],2),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(B[l.orgType],(([t,s])=>((0,n.wg)(),(0,n.iD)("div",{key:s,class:(0,a.C_)([(0,_.SU)(Z).field,(0,_.SU)(Z)["field_"+s]]),"data-field":s},[(0,n._)("div",{class:(0,a.C_)((0,_.SU)(Z).field__title)},(0,a.zw)(t),3),(0,n.Wm)(g.Z,{modelValue:l[s],"onUpdate:modelValue":t=>l[s]=t,class:(0,a.C_)((0,_.SU)(Z).field__input),error:V.value[s],"show-error-immediately":!0,onChange:e[6]||(e[6]=t=>Q("requisites"))},null,8,["modelValue","onUpdate:modelValue","class","error"])],10,P)))),128)),(0,n._)("div",{class:(0,a.C_)([(0,_.SU)(Z).field,(0,_.SU)(Z).field_contacts])},[(0,n._)("div",{class:(0,a.C_)((0,_.SU)(Z).field__title)}," Ваши контактные данные ",2),(0,n._)("div",{class:(0,a.C_)((0,_.SU)(Z).field__descr)}," На указанную почту придет информация о подписке и счет на оплату ",2)],2),(0,n._)("div",{class:(0,a.C_)([(0,_.SU)(Z).field,(0,_.SU)(Z).field_fio]),"data-field":"fio"},[(0,n._)("div",{class:(0,a.C_)((0,_.SU)(Z).field__title)}," ФИО ",2),(0,n.Wm)(g.Z,{modelValue:l.fio,"onUpdate:modelValue":e[7]||(e[7]=t=>l.fio=t),class:(0,a.C_)((0,_.SU)(Z).field__input),error:V.value.fio,"show-error-immediately":!0,onChange:e[8]||(e[8]=t=>Q("contact_information"))},null,8,["modelValue","class","error"])],2),(0,n._)("div",{class:(0,a.C_)([(0,_.SU)(Z).field,(0,_.SU)(Z).field_email]),"data-field":"email"},[(0,n._)("div",{class:(0,a.C_)((0,_.SU)(Z).field__title)}," E-mail ",2),(0,n.Wm)(g.Z,{modelValue:l.email,"onUpdate:modelValue":e[9]||(e[9]=t=>l.email=t),class:(0,a.C_)((0,_.SU)(Z).field__input),inputmode:"email",error:V.value.email,"show-error-immediately":!0,onChange:e[10]||(e[10]=t=>Q("contact_information"))},null,8,["modelValue","class","error"])],2),(0,n._)("div",{class:(0,a.C_)((0,_.SU)(Z).confirm)},[(0,n.Wm)(y.Z,{modelValue:F.value,"onUpdate:modelValue":e[11]||(e[11]=t=>F.value=t)},null,8,["modelValue"]),L],2),(0,n._)("div",{class:(0,a.C_)((0,_.SU)(Z).button)},[(0,n.Wm)(o.Z,{disabled:!F.value,wide:t.IS_MOBILE,loading:(0,_.SU)(u).isLoading.value,onClick:e[12]||(e[12]=t=>G())},{default:(0,n.w5)((()=>[(0,n.Uk)(" Отправить ")])),_:1},8,["disabled","wide","loading"])],2)],2),(0,n._)("section",{ref_key:"faqEl",ref:I,class:(0,a.C_)((0,_.SU)(Z).faqSection)},[(0,n._)("h3",{class:(0,a.C_)((0,_.SU)(Z).title)}," Часто задаваемые вопросы ",2),(0,n.Wm)(w.Z,{items:q,onDrop:X})],2),(0,n._)("img",{src:tt,class:(0,a.C_)((0,_.SU)(Z).pixel)},null,2),et.value?((0,n.wg)(),(0,n.iD)("img",{key:0,src:et.value,class:(0,a.C_)((0,_.SU)(Z).pixel)},null,10,R)):(0,n.kq)("v-if",!0)],64))}});var q=s(63301),F=s.n(q);const V={};V.$style=F();const Z=(0,u.Z)(B,[["__cssModules",V]]),W=(0,n.aZ)({__name:"app",setup(t){const e=(0,_.iH)(!1);return(0,n.YP)(e,(()=>{e.value&&document.documentElement.scroll(0,0)})),(t,s)=>e.value?((0,n.wg)(),(0,n.j4)(h,{key:1})):((0,n.wg)(),(0,n.j4)(Z,{key:0,onSubmitSuccess:s[0]||(s[0]=t=>e.value=!0)}))}});function z(){return(0,i.a)(W)}},48748:(t,e,s)=>{"use strict";s.r(e),s.d(e,{createApp:()=>j});var i=s(76944),n=s(66252),a=s(3577);const o=["xlink:href"],r=(0,n.aZ)({__name:"pkb-svg",props:{name:{}},setup(t){const e=t;return(t,s)=>((0,n.wg)(),(0,n.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",class:(0,a.C_)([t.$style.host,`icon--${e.name}`])},[(0,n._)("use",{"xlink:href":`#icon--${e.name}`},null,8,o)],2))}});var l=s(84588),c=s.n(l),d=s(83744);const u={};u.$style=c();const p=(0,d.Z)(r,[["__cssModules",u]]),h=(0,n.aZ)({__name:"intro",setup:t=>(t,e)=>((0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(p,{name:"pikabu15__intro",class:(0,a.C_)(t.$style.image)},null,8,["class"]),(0,n._)("p",{class:(0,a.C_)(t.$style.text)}," в честь 15-летия ",2)]))});var _=s(88627),m=s.n(_);const g={};g.$style=m();const f=(0,d.Z)(h,[["__cssModules",g]]),v=(0,n.aZ)({__name:"outro",setup:t=>(t,e)=>((0,n.wg)(),(0,n.iD)("div",{class:(0,a.C_)(t.$style.host)},[(0,n.Wm)(p,{name:"pikabu15__outro"})],2))});var b=s(49210),y=s.n(b);const w={};w.$style=y();const k=(0,d.Z)(v,[["__cssModules",w]]);var x=s(2262),S=s(49963),$=s(58330);const C=["src","data-large-image"],T=(0,n.aZ)({__name:"comics-card",props:{image:{}},setup(t){const e=$.S.getInstance().get("UIImageViewer"),s=t,i=(0,S.fb)(),o=(0,x.iH)();return(t,r)=>((0,n.wg)(),(0,n.iD)("img",{ref_key:"imageEl",ref:o,class:(0,a.C_)((0,x.SU)(i).image),src:`https://cs.pikabu.ru/files/pikabu15/comics/${s.image}.webp`,"data-large-image":`https://cs.pikabu.ru/files/pikabu15/comics/${s.image}_b.webp`,alt:"",onClick:r[0]||(r[0]=t=>{o.value&&new e({showImageBackground:!1,images:document.querySelectorAll(`.${i.image}`)}).setTarget(o.value).show()})},null,10,C))}});var E=s(42777),I=s.n(E);const O={};O.$style=I();const U=(0,d.Z)(T,[["__cssModules",O]]),D=(0,n._)("br",null,null,-1),A=(0,n.aZ)({__name:"app",setup(t){const e=["1vRWOSXha47lhBIx","25WBnlsiPkOtii5t","3Tws7tk501CWOW5i","4q36VdQSORi3YM2u","5oUQ22ESuh9WWHQO","6hrbOKinO66xMhjZ","71cPewzbG0D1euJr","8tPJeY6qpfQkdO57","9kzChVGxKP0H2Drk","10xrRSq3KpmA78PeL","11Uh2z0DgH8YqqdGY","12BIv2rFMBQlohEed","13cTpGvV1OQoy8v2q","14c6fUOcJsjpN5EfT","158gyF4GHoQOZnlIf"];return(t,s)=>((0,n.wg)(),(0,n.iD)("div",{class:(0,a.C_)(t.$style.host)},[t.IS_DESKTOP?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[(0,n.Wm)(p,{name:"pikabu15__bolt",class:(0,a.C_)([t.$style.bolt,t.$style.bolt_1])},null,8,["class"]),(0,n.Wm)(p,{name:"pikabu15__bolt",class:(0,a.C_)([t.$style.bolt,t.$style.bolt_2])},null,8,["class"])],64)):(0,n.kq)("v-if",!0),(0,n._)("div",{class:(0,a.C_)(t.$style.inner)},[(0,n._)("p",{class:(0,a.C_)(t.$style.text)},[(0,n.Uk)(" На этой странице мы праздновали день рождения Пикабу в августе 2024-го."),D,(0,n.Uk)(" Ивент закончился, а комикс — остался. И теперь доступен целиком и всем! ")],2),(0,n._)("div",null,[(0,n.Wm)(f),(0,n._)("div",{class:(0,a.C_)(t.$style.cards)},[((0,n.wg)(),(0,n.iD)(n.HY,null,(0,n.Ko)(e,(e=>(0,n.Wm)(U,{key:e,class:(0,a.C_)(t.$style.card),image:e},null,8,["class","image"]))),64))],2)]),(0,n.Wm)(k)],2)],2))}});var M=s(83809),N=s.n(M);const P={};P.$style=N();const L=(0,d.Z)(A,[["__cssModules",P]]);var R=s(74689);function j(){const t=(0,i.a)(L);return t.directive("tooltip",R.u),t}},39364:(t,e,s)=>{"use strict";s.r(e),s.d(e,{createApp:()=>Ae});var i=s(76944),n=s(66252),a=s(3577),o=s(2262),r=s(66309),l=s(62728),c=s(75645);var d=s(7996),u=s.n(d),p=s(83744);const h={},_={};_.$style=u();const m=(0,p.Z)(h,[["render",function(t,e){return(0,n.wg)(),(0,n.iD)("div",{class:(0,a.C_)(t.$style.host)},[t.$slots.legend?((0,n.wg)(),(0,n.iD)("div",{key:0,class:(0,a.C_)(t.$style.legend)},[(0,n.WI)(t.$slots,"legend")],2)):(0,n.kq)("v-if",!0),(0,n.WI)(t.$slots,"default")],2)}],["__cssModules",_]]);s(74916),s(66992),s(33948),s(88674);var g=s(41218),f=(s(41817),s(49963)),v=s(28959),b=s(66037),y=s(85983),w=s(50451),k=s(40094),x=s(53329),S=s(55529);function $(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function C(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?$(Object(s),!0).forEach((function(e){T(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):$(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function T(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const E=["disabled"],I=(0,n.aZ)({__name:"pkb-input-filter",props:{modelValue:{},dropdownItems:{},dropdownLabelName:{},size:{default:"medium"},theme:{default:"normal"},inputValue:{},label:{default:"Добавить"},loading:{type:Boolean},error:{type:[Boolean,String],default:!1},disabled:{type:Boolean},maxItems:{default:void 0},borderless:{type:Boolean},iconName:{default:"ic_plus_small"}},emits:["update:modelValue","update:inputValue","add","dropdown:show","dropdown:clear","enter"],setup(t,{expose:e,emit:s}){const i=t,l=(0,o.iH)(),d=(0,o.iH)(),u=(0,o.iH)(),p=(0,n.Fl)((()=>i.dropdownItems.length>0&&i.inputValue.length>0)),h=(0,o.iH)([]),_=s,{focused:m}=(0,r.L_M)(d),{focused:g}=(0,r.L_M)(u),{floatingStyles:$}=(0,v.YF)(l,u,{whileElementsMounted:b.Me,middleware:[(0,b.RR)(),(0,y.cv)(4)],placement:"bottom",strategy:"absolute",transform:!1}),T=(0,n.Fl)({get:()=>i.modelValue,set(t){_("update:modelValue",t)}}),I=(0,n.Fl)({get:()=>i.inputValue,set(t){_("update:inputValue",t)}}),O=(0,n.Fl)((()=>{var t;return C(C({},$.value),{},{zIndex:(0,S.e)(),width:((null===(t=l.value)||void 0===t?void 0:t.offsetWidth)||"0")+"px"})}));function U(){_("dropdown:clear")}function D(){var t;null===(t=d.value)||void 0===t||t.focus()}function A(){var t;null===(t=d.value)||void 0===t||t.blur(),U()}async function M(){const t=d.value;t&&(t.style.width="0",t.style.width=`${t.scrollWidth+1}px`)}return(0,n.YP)(T,(async(t,e)=>{e.length===i.maxItems&&(await(0,n.Y3)(),M())})),(0,n.YP)(I,M,{flush:"post"}),(0,n.bv)(M),e({focus:D}),(t,e)=>((0,n.wg)(),(0,n.iD)("div",{ref_key:"hostEl",ref:l,class:(0,a.C_)(t.$style.host)},[(0,n.Wm)(w.Z,{class:(0,a.C_)(t.$style.baseInput),error:i.error,disabled:i.disabled,loading:i.loading,empty:!T.value.length&&!I.value,size:i.size,theme:i.theme,borderless:i.borderless,onClick:e[4]||(e[4]=t=>D())},{default:(0,n.w5)((()=>[(0,n._)("div",{class:(0,a.C_)([t.$style.wrapper,{[t.$style.wrapper_padding]:!i.loading}])},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(T.value,((e,s)=>(0,n.WI)(t.$slots,"item",{key:s,item:e}))),128)),!i.maxItems||T.value.length<i.maxItems?((0,n.wg)(),(0,n.iD)("div",{key:0,class:(0,a.C_)(t.$style.inputWrapper)},[(0,n._)("div",{class:(0,a.C_)(t.$style.inputContainer)},[(0,n.wy)((0,n._)("input",{ref_key:"inputEl",ref:d,"onUpdate:modelValue":e[0]||(e[0]=t=>I.value=t),class:(0,a.C_)([t.$style.input,{[t.$style.input_empty]:!I.value}]),disabled:i.disabled,onKeydown:[e[1]||(e[1]=(0,f.D2)((t=>{i.disabled||I.value||(T.value=T.value.slice(0,-1))}),["backspace"])),e[2]||(e[2]=(0,f.D2)((0,f.iM)((t=>A()),["prevent"]),["esc"])),e[3]||(e[3]=(0,f.D2)((0,f.iM)((t=>{var e;return null===(e=h.value[0])||void 0===e?void 0:e.focus()}),["prevent"]),["down"]))]},null,42,E),[[f.nr,I.value]])],2),(0,n._)("span",{class:(0,a.C_)(t.$style.inputLabel),style:(0,a.j5)({visibility:I.value?"hidden":"visible"})},[i.iconName?((0,n.wg)(),(0,n.j4)(k.Z,{key:0,name:i.iconName,size:20},null,8,["name"])):(0,n.kq)("v-if",!0),(0,n.Uk)(" "+(0,a.zw)(i.label),1)],6)],2)):(0,n.kq)("v-if",!0)],2)])),_:3},8,["class","error","disabled","loading","empty","size","theme","borderless"]),(0,n.Wm)(c.Z,null,{default:(0,n.w5)((()=>[((0,o.SU)(m)||(0,o.SU)(g))&&p.value?((0,n.wg)(),(0,n.iD)("div",{key:0,ref_key:"dropdownEl",ref:u,class:(0,a.C_)(t.$style.dropdown),style:(0,a.j5)(O.value)},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.dropdownItems,((s,a)=>((0,n.wg)(),(0,n.j4)(x.Z,{ref_for:!0,ref_key:"itemsRefs",ref:h,key:a,index:a,label:String(s[i.dropdownLabelName]),"items-refs":h.value,selection:I.value,onClick:t=>_("add",s),onEnter:t=>_("add",s),onEsc:e[5]||(e[5]=t=>async function(){D(),await(0,n.Y3)(),U()}()),"onNavigation:first":e[6]||(e[6]=t=>D())},{prefix:(0,n.w5)((()=>[(0,n.WI)(t.$slots,"dropdownItemPrefix",{item:s})])),suffix:(0,n.w5)((()=>[(0,n.WI)(t.$slots,"dropdownItemSuffix",{item:s})])),_:2},1032,["index","label","items-refs","selection","onClick","onEnter"])))),128))],6)):(0,n.kq)("v-if",!0)])),_:3})],2))}});var O=s(23441),U=s.n(O);const D={};D.$style=U();const A=(0,p.Z)(I,[["__cssModules",D]]),M=(0,n.aZ)({__name:"pkb-input-filter-item",emits:["remove"],setup(t,{emit:e}){const s=e;return(t,e)=>((0,n.wg)(),(0,n.iD)("div",{class:(0,a.C_)(t.$style.host)},[(0,n.WI)(t.$slots,"default"),(0,n.Wm)(k.Z,{class:(0,a.C_)(t.$style.removeButton),name:"ic_close",onClick:e[0]||(e[0]=t=>s("remove"))},null,8,["class"])],2))}});var N=s(13521),P=s.n(N);const L={};L.$style=P();const R=(0,p.Z)(M,[["__cssModules",L]]);var j=s(32453),B=s(12950);const q={all:["tag"],search:({query:t})=>[...q.all,"search",{query:t}]};var F=s(17311);const V=(0,n.aZ)({__name:"tags-input-filter-view",props:{modelValue:{},mode:{default:"include"}},emits:["update:modelValue","add","remove"],setup(t,{emit:e}){const s=t,i=e,r=(0,o.iH)(),l=(0,o.iH)([]),c=(0,o.iH)(""),d=(0,g.VW)(c,500),u=(0,n.Fl)((()=>d.value.length>1)),p=(0,n.Fl)((()=>"include"===s.mode)),h=(0,n.Fl)({get:()=>s.modelValue,set(t){i("update:modelValue",t)}}),{data:_,isLoading:m}=(({queryKey:t,enabled:e})=>(0,j.a)({queryKey:t,enabled:e,queryFn:async({queryKey:t})=>{const{query:e}=t[2],{data:s}=await B.cf.postOrFail("/ajax/tags_actions.php",{action:"droplist",value:e,filter:"search"});return s}}))({queryKey:(0,n.Fl)((()=>q.search({query:d.value}))),enabled:u});function f(){l.value=[]}function v(){var t;null===(t=r.value)||void 0===t||t.focus()}function b(t){return t===F.$F?"[моё]":t}return(0,n.YP)(_,(t=>{t?(v(),l.value=t.filter((([t])=>h.value.every((e=>e!==t)))).map((([t,e])=>({displayName:b(t),count:e,name:t})))):f()})),(t,e)=>((0,n.wg)(),(0,n.j4)(A,{ref_key:"inputFilterRef",ref:r,modelValue:h.value,"onUpdate:modelValue":e[0]||(e[0]=t=>h.value=t),"input-value":c.value,"onUpdate:inputValue":e[1]||(e[1]=t=>c.value=t),theme:"gray",class:(0,a.C_)(t.$style.host),loading:(0,o.SU)(m)&&u.value,"dropdown-items":l.value,label:p.value?"Добавить":"Исключить","icon-name":p.value?"ic_plus_small":"ic_minus_small","dropdown-label-name":"displayName","onDropdown:clear":e[2]||(e[2]=t=>f()),onAdd:e[3]||(e[3]=t=>async function({name:t}){c.value="",h.value.push(t),i("add",t),await(0,n.Y3)(),v()}(t))},{item:(0,n.w5)((({item:e})=>[(0,n.Wm)(R,{class:(0,a.C_)(t.$style.tag),onRemove:t=>{return s=e,h.value=h.value.filter((t=>t!==s)),void i("remove",s);var s}},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(b(e)),1)])),_:2},1032,["class","onRemove"])])),dropdownItemSuffix:(0,n.w5)((({item:t})=>[(0,n.Uk)((0,a.zw)(t.count),1)])),_:1},8,["modelValue","input-value","class","loading","dropdown-items","label","icon-name"]))}});var Z=s(35834),W=s.n(Z);const z={};z.$style=W();const H=(0,p.Z)(V,[["__cssModules",z]]);var G=s(69876),Y=s(12953);const K=Y.core.config("modules.searchDateFrom")||"",Q=Y.core.config("modules.searchDateTo")||"",X=Y.core.config("modules.searchRating")||0,J=Y.core.config("modules.searchType")||F.hR.ANY,tt=Y.core.config("modules.searchTags")||[],et=Y.core.config("modules.searchExcludeTags")||[],st="h"===Y.core.config("modules.searchVisited"),it=Y.core.config("modules.searchUser"),nt=Y.core.config("modules.searchCommunity"),at=Y.core.config("modules.searchConfig").isAdultVisible,ot=(0,G.Q_)("storiesSearchFilter",{state:()=>({dateFrom:K,dateTo:Q,rating:X,type:J,tags:tt,excludeTags:et,visited:st,user:it.id?it:null,community:nt.id?nt:null,isAdultVisible:at}),actions:{isStoriesTypeActive(t){return this.type!==F.hR.ANY&&(this.type&t)===t},applyMineTagIfNeeded(t){t?this.tags=this.tags.filter((t=>t!==F.$F)):this.tags.every((t=>t!==F.$F))&&this.tags.push(F.$F)},applyNsfwTagIfNeeded(t){t?this.tags=this.tags.filter((t=>t!==F.h1)):this.tags.every((t=>t!==F.h1))&&this.tags.push(F.h1)},clearMineAndNsfwTags(){this.tags=this.tags.filter((t=>t!==F.$F&&t!==F.h1))},activateType(t){this.type|=t},deactivateType(t){this.type&=~t}},getters:{isTypeActive:t=>e=>t.type!==F.hR.ANY&&(t.type&e)===e}}),rt=(0,n.aZ)({__name:"tags-fieldset-view",setup(t){const e=ot();return(t,s)=>((0,n.wg)(),(0,n.j4)(m,null,{legend:(0,n.w5)((()=>[(0,n.Uk)(" Теги ")])),default:(0,n.w5)((()=>[(0,n.Wm)(H,{modelValue:(0,o.SU)(e).tags,"onUpdate:modelValue":s[0]||(s[0]=t=>(0,o.SU)(e).tags=t),mode:"include",onAdd:s[1]||(s[1]=t=>{var s;(s=t)===F.$F?e.activateType(F.hR.MINE):s===F.h1&&e.activateType(F.hR.NSFW)}),onRemove:s[2]||(s[2]=t=>{var s;(s=t)===F.$F?e.deactivateType(F.hR.MINE):s===F.h1&&e.deactivateType(F.hR.NSFW)})},null,8,["modelValue"]),(0,n.Wm)(H,{modelValue:(0,o.SU)(e).excludeTags,"onUpdate:modelValue":s[3]||(s[3]=t=>(0,o.SU)(e).excludeTags=t),mode:"exclude"},null,8,["modelValue"])])),_:1}))}});var lt=s(20252),ct=s(16723);const dt=(0,n.aZ)({__name:"user-fieldset-view",setup(t){const e=ot(),s=(0,n.Fl)((()=>e.user?[e.user]:[])),i=(0,o.iH)(),r=(0,o.iH)([]),l=(0,o.iH)(""),c=(0,g.VW)(l,500),d=(0,n.Fl)((()=>c.value.length>2)),{data:u,isLoading:p}=(0,ct.s1)({queryKey:(0,n.Fl)((()=>ct.TZ.searchUsers({query:c.value}))),enabled:d});function h(){r.value=[]}function _(){var t;null===(t=i.value)||void 0===t||t.focus()}return(0,n.YP)(u,(t=>{t?(_(),r.value=t):h()})),(t,c)=>((0,n.wg)(),(0,n.j4)(m,null,{legend:(0,n.w5)((()=>[(0,n.Uk)(" Автор ")])),default:(0,n.w5)((()=>[(0,n.Wm)(A,{ref_key:"inputFilterRef",ref:i,modelValue:s.value,"onUpdate:modelValue":c[1]||(c[1]=t=>s.value=t),"input-value":l.value,"onUpdate:inputValue":c[2]||(c[2]=t=>l.value=t),theme:"gray",class:(0,a.C_)(t.$style.inputFilter),loading:(0,o.SU)(p)&&d.value,"dropdown-items":r.value,"max-items":1,"icon-name":"ic_plus_small",label:"Добавить","dropdown-label-name":"name","onDropdown:clear":c[3]||(c[3]=t=>h()),onAdd:c[4]||(c[4]=t=>async function(t){l.value="",e.user=t.id?{id:t.id,name:t.name,avatar:t.avatar}:null,await(0,n.Y3)(),_()}(t))},{item:(0,n.w5)((({item:s})=>[s?((0,n.wg)(),(0,n.j4)(R,{key:0,class:(0,a.C_)(t.$style.user),onRemove:c[0]||(c[0]=t=>{e.user=null})},{default:(0,n.w5)((()=>[(0,n.Wm)(lt.Z,{src:s.avatar,size:20,class:(0,a.C_)(t.$style.avatar)},null,8,["src","class"]),(0,n.Uk)(" "+(0,a.zw)(s.name),1)])),_:2},1032,["class"])):(0,n.kq)("v-if",!0)])),dropdownItemPrefix:(0,n.w5)((({item:t})=>[(0,n.Wm)(lt.Z,{src:t.avatar,size:20},null,8,["src"])])),_:1},8,["modelValue","input-value","class","loading","dropdown-items"])])),_:1}))}});var ut=s(29436),pt=s.n(ut);const ht={};ht.$style=pt();const _t=(0,p.Z)(dt,[["__cssModules",ht]]);s(2707);var mt=s(37043),gt=(s(15306),s(50542));const ft=(0,n.aZ)({__name:"pkb-date-input",props:{modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const s=t,i=e,a=(0,o.iH)("");function r(t){return t.replace(/[^\d.]/g,"")}function l(t){let[e="",s="",i=""]=t.replace(/[^\d.]/g,"").split(".").map(((t,e)=>t.slice(0,2===e?4:2)));1===e.length&&t.endsWith(".")&&(e="0"+e),1===s.length&&t.endsWith(".")&&(s="0"+s);2===s.length&&Number(s)>12&&(s=String(12));const n=function(t,e=0){if(!t)return 31;if(!e&&2===t)return 29;return new Date(e,t,0).getDate()}(2===s.length?Number(s):void 0,4===i.length?Number(i):void 0);2===e.length&&Number(e)>n&&(e=String(n));let a=[e,s,i].filter(Boolean).join(".");return!t.endsWith(".")||2!==a.length&&5!==a.length||(a+="."),a}function c(t){const e=a.value.slice(0,10);10!==e.length?!t&&e.length||i("update:modelValue",void 0):i("update:modelValue",e.split(".").reverse().join("-"))}return(0,n.YP)((()=>s.modelValue),(t=>{a.value=t?t.split("-").reverse().join("."):""}),{immediate:!0}),(0,n.YP)(a,(()=>c(!1))),(t,e)=>((0,n.wg)(),(0,n.j4)(gt.Z,{modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=t=>a.value=t),clean:r,format:l,placeholder:"ДД.ММ.ГГГГ",onBlur:e[1]||(e[1]=t=>c(!0))},null,8,["modelValue"]))}});var vt=s(34653);function bt(t){if(!t)return;const[e,s,i]=t.split("-").map(Number);return Date.UTC(e,s-1,i)}function yt(t){return new Date(t).toISOString().slice(0,10)}function wt(t){const[e,s]=t.split("-").map(Number);return new Date(Date.UTC(e,s-1))}function kt(t){return t.toISOString().slice(0,7)}function xt(t){const[e,s,i]=t.split("-").map(Number);return new Date(Date.UTC(e,s-1,i))}const St=["onPointerenter","onClick"],$t=(0,n.aZ)({__name:"calendar-sheet",props:{month:{},start:{},end:{}},emits:["update:month","hover:day","click:day"],setup(t,{emit:e}){const s=t,i=e,o=["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],r=(0,n.Fl)({get:()=>s.month,set:t=>i("update:month",t)}),c=(0,n.Fl)((()=>(0,vt.p)(wt(r.value),{month:"long",year:"numeric"}))),d=(0,n.Fl)((()=>{const t=wt(r.value),e=(t.getUTCDay()+6)%7;return t.setUTCDate(t.getUTCDate()-e)})),u=(0,n.Fl)((()=>{const t=wt(r.value);t.setUTCMonth(t.getUTCMonth()+1,0);const e=(t.getUTCDay()+6)%7;return t.setUTCDate(t.getUTCDate()-e+6)})),p=(0,n.Fl)((()=>{const t=[],e=new Date(d.value),i=wt(r.value).getUTCMonth();let n=e.getTime();const a=bt(s.start),o=bt(s.end);for(;n<=u.value;){const s=e.getUTCDate();t.push({key:n,date:e.toISOString().split("T")[0],text:s,isMuted:e.getUTCMonth()!==i,isStart:a===n,isEnd:o===n,isBetween:a&&a<n&&o&&o>n}),n=e.setUTCDate(s+1)}return t}));function h(t){const e=wt(r.value);e.setUTCMonth(e.getUTCMonth()+t),r.value=kt(e)}return(t,e)=>((0,n.wg)(),(0,n.iD)("div",{class:(0,a.C_)(t.$style.host)},[(0,n._)("div",{class:(0,a.C_)(t.$style.month)},[(0,n.Wm)(l.Z,{"icon-name":"arrow-left_20",onClick:e[0]||(e[0]=t=>h(-1))}),(0,n._)("span",{class:(0,a.C_)(t.$style.monthTitle)},(0,a.zw)(c.value),3),(0,n.Wm)(l.Z,{"icon-name":"arrow-right_20",onClick:e[1]||(e[1]=t=>h(1))})],2),e[2]||((0,n.qZ)(-1),e[2]=(0,n._)("div",{class:(0,a.C_)(t.$style.weekDays)},[((0,n.wg)(),(0,n.iD)(n.HY,null,(0,n.Ko)(o,(e=>(0,n._)("div",{key:e,class:(0,a.C_)(t.$style.weekDay)},(0,a.zw)(e),3))),64))],2),(0,n.qZ)(1),e[2]),(0,n._)("div",{class:(0,a.C_)(t.$style.days)},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(p.value,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e.key,class:(0,a.C_)({[t.$style.day]:!0,[t.$style.day_muted]:e.isMuted,[t.$style.day_start]:e.isStart,[t.$style.day_end]:e.isEnd,[t.$style.day_between]:e.isBetween}),onPointerenter:t=>i("hover:day",e.date),onClick:t=>i("click:day",e.date)},(0,a.zw)(e.text),43,St)))),128))],2)],2))}});var Ct=s(45117),Tt=s.n(Ct);const Et={};Et.$style=Tt();const It=(0,p.Z)($t,[["__cssModules",Et]]),Ot=(0,n.aZ)({__name:"range-picker",props:{approveText:{},start:{},end:{}},emits:["update:start","update:end","approve"],setup(t,{emit:e}){const s=t,i=e,r=(0,o.iH)(kt(function(){const t=s.start&&s.end&&s.start.slice(0,7)===s.end.slice(0,7);if(s.start&&!t)return xt(s.start);const e=b();return new Date(Date.UTC(e.getFullYear(),e.getMonth()-1))}())),l=(0,o.iH)(kt(b())),c=(0,o.iH)(),d=(0,o.iH)();let u=!1;const p=(0,n.Fl)((()=>v(c.value,d.value)>0)),h=(0,n.Fl)({get:()=>p.value?d.value:c.value,set:t=>p.value?d.value=t:c.value=t}),_=(0,n.Fl)({get:()=>p.value?c.value:d.value,set:t=>p.value?c.value=t:d.value=t});function m(t){u&&(d.value=t)}function g(t){u||(c.value=t),d.value=t,u=!u}function f(t){return t.slice().sort(v)}function v(t,e){var s,i;return(null!==(s=bt(t))&&void 0!==s?s:1/0)-(null!==(i=bt(e))&&void 0!==i?i:1/0)}function b(){if(s.end)return xt(s.end);const t=new Date;return new Date(Date.UTC(t.getFullYear(),t.getMonth()))}return(0,n.YP)([()=>s.start,()=>s.end],(t=>{const[e,s]=f(t);c.value=e,d.value=s}),{immediate:!0}),(t,e)=>((0,n.wg)(),(0,n.iD)("div",{class:(0,a.C_)(t.$style.host)},[(0,n._)("div",{class:(0,a.C_)(t.$style.sheets)},[t.IS_MOBILE?(0,n.kq)("v-if",!0):((0,n.wg)(),(0,n.j4)(It,{key:0,month:r.value,"onUpdate:month":e[0]||(e[0]=t=>r.value=t),class:(0,a.C_)(t.$style.sheet),start:h.value,end:_.value,"onHover:day":m,"onClick:day":g},null,8,["month","class","start","end"])),(0,n.Wm)(It,{month:l.value,"onUpdate:month":e[1]||(e[1]=t=>l.value=t),class:(0,a.C_)(t.$style.sheet),start:h.value,end:_.value,"onHover:day":m,"onClick:day":g},null,8,["month","class","start","end"])],2),(0,n._)("div",{class:(0,a.C_)(t.$style.footer)},[(0,n.Wm)(ft,{modelValue:h.value,"onUpdate:modelValue":e[2]||(e[2]=t=>h.value=t),class:(0,a.C_)(t.$style.input),theme:"gray",inputmode:"numeric"},null,8,["modelValue","class"]),(0,n.Wm)(k.Z,{class:(0,a.C_)(t.$style.separator),name:"arrow_left_full",size:20},null,8,["class"]),(0,n.Wm)(ft,{modelValue:_.value,"onUpdate:modelValue":e[3]||(e[3]=t=>_.value=t),class:(0,a.C_)(t.$style.input),theme:"gray",inputmode:"numeric"},null,8,["modelValue","class"]),(0,n.Wm)(mt.Z,{class:(0,a.C_)(t.$style.approve),label:s.approveText,disabled:!h.value||!_.value,wide:t.IS_MOBILE,onClick:e[4]||(e[4]=t=>function(){const[t,e]=f([c.value,d.value]);i("update:start",t),i("update:end",e),i("approve",[t,e])}())},null,8,["class","label","disabled","wide"])],2)],2))}});var Ut=s(23200),Dt=s.n(Ut);const At={};At.$style=Dt();const Mt=(0,p.Z)(Ot,[["__cssModules",At]]);var Nt=s(17430),Pt=s.n(Nt);const Lt={},Rt={};Rt.$style=Pt();const jt=(0,p.Z)(Lt,[["render",function(t,e){return(0,n.wg)(),(0,n.iD)("div",{class:(0,a.C_)(t.$style.host)},[(0,n.WI)(t.$slots,"default")],2)}],["__cssModules",Rt]]),Bt=(0,n.aZ)({__name:"filter-tab-view",props:{label:{},active:{type:Boolean}},setup(t){const e=t;return(t,s)=>((0,n.wg)(),(0,n.iD)("span",{class:(0,a.C_)([t.$style.host,{[t.$style.host_active]:e.active}])},(0,a.zw)(e.label),3))}});var qt=s(33742),Ft=s.n(qt);const Vt={};Vt.$style=Ft();const Zt=(0,p.Z)(Bt,[["__cssModules",Vt]]);var Wt=s(85679),zt=s(74750);const Ht={ALL:"Все время",TODAY:"Сегодня",WEEK:"Неделя",MONTH:"Месяц",DATE:"Выбрать дату"},Gt={ANY:"Любые",TEXT:"Текстовые",IMAGE:"Картинки",VIDEO:"Видео",MINE:"[моё]",NSFW:zt.x};function Yt(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function Kt(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?Yt(Object(s),!0).forEach((function(e){Qt(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Yt(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function Qt(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const Xt=(0,n.aZ)({__name:"period-tabs-view",setup(t){const e=ot(),s=(0,o.iH)(Ht.ALL),i=(0,o.iH)(),l=(0,o.iH)(),d=(0,o.iH)(!1),{floatingStyles:u}=(0,v.YF)(i,l,{whileElementsMounted:b.Me,middleware:[(0,b.RR)(),(0,y.cv)(4)],placement:"bottom",strategy:"absolute",transform:!1});function p(t){s.value=t;const i=Date.now();t===Ht.MONTH?(e.dateFrom=yt(i-Wt.$E),e.dateTo=yt(i)):t===Ht.WEEK?(e.dateFrom=yt(i-Wt.P0),e.dateTo=yt(i)):t===Ht.TODAY?(e.dateFrom=yt(i),e.dateTo=""):t===Ht.DATE?d.value=!0:(e.dateFrom="",e.dateTo="")}(0,n.wF)((()=>{e.dateFrom&&(s.value=Ht.DATE)}));const h=(0,n.Fl)((()=>{if(!e.dateFrom)return Ht.DATE;const t=xt(e.dateFrom);let s=String(t.getDate()).padStart(2,"0")+"."+String(t.getMonth()+1).padStart(2,"0")+"."+t.getFullYear();if(e.dateTo){const t=xt(e.dateTo);s+=" - "+String(t.getDate()).padStart(2,"0")+"."+String(t.getMonth()+1).padStart(2,"0")+"."+t.getFullYear()}return s}));return(0,r.i9H)(l,(()=>d.value=!1),{ignore:[i]}),(t,r)=>((0,n.wg)(),(0,n.j4)(m,null,{legend:(0,n.w5)((()=>[(0,n.Uk)(" Период ")])),default:(0,n.w5)((()=>[(0,n.Wm)(jt,null,{default:(0,n.w5)((()=>[(0,n.Wm)(Zt,{label:(0,o.SU)(Ht).ALL,active:s.value===(0,o.SU)(Ht).ALL,onClick:r[0]||(r[0]=t=>p((0,o.SU)(Ht).ALL))},null,8,["label","active"]),(0,n.Wm)(Zt,{label:(0,o.SU)(Ht).TODAY,active:s.value===(0,o.SU)(Ht).TODAY,onClick:r[1]||(r[1]=t=>p((0,o.SU)(Ht).TODAY))},null,8,["label","active"]),(0,n.Wm)(Zt,{label:(0,o.SU)(Ht).WEEK,active:s.value===(0,o.SU)(Ht).WEEK,onClick:r[2]||(r[2]=t=>p((0,o.SU)(Ht).WEEK))},null,8,["label","active"]),(0,n.Wm)(Zt,{label:(0,o.SU)(Ht).MONTH,active:s.value===(0,o.SU)(Ht).MONTH,onClick:r[3]||(r[3]=t=>p((0,o.SU)(Ht).MONTH))},null,8,["label","active"]),(0,n.Wm)(Zt,{ref_key:"dateTabRef",ref:i,label:h.value,active:s.value===(0,o.SU)(Ht).DATE,onClick:r[4]||(r[4]=t=>p((0,o.SU)(Ht).DATE))},null,8,["label","active"]),(0,n.Wm)(c.Z,null,{default:(0,n.w5)((()=>[d.value?((0,n.wg)(),(0,n.iD)("div",{key:0,ref_key:"calendarEl",ref:l,class:(0,a.C_)(t.$style.calendar),style:(0,a.j5)(Kt(Kt({},(0,o.SU)(u)),{},{zIndex:(0,o.SU)(S.e)()}))},[(0,n.Wm)(Mt,{"approve-text":(0,o.SU)(Ht).DATE,start:(0,o.SU)(e).dateFrom,end:(0,o.SU)(e).dateTo,onApprove:r[5]||(r[5]=t=>function([t,s]){e.dateFrom=t,e.dateTo=s,d.value=!1}(t))},null,8,["approve-text","start","end"])],6)):(0,n.kq)("v-if",!0)])),_:1})])),_:1})])),_:1}))}});var Jt=s(83157),te=s.n(Jt);const ee={};ee.$style=te();const se=(0,p.Z)(Xt,[["__cssModules",ee]]),ie=(0,n.aZ)({__name:"type-tabs-view",setup(t){const e=ot();function s(t){const s=e.isTypeActive(t);if(t===F.hR.ANY&&e.type!==F.hR.ANY)return e.type=t,void e.clearMineAndNsfwTags();t===F.hR.MINE?e.applyMineTagIfNeeded(s):t===F.hR.NSFW&&e.applyNsfwTagIfNeeded(s),s?e.deactivateType(t):e.activateType(t)}return(t,i)=>((0,n.wg)(),(0,n.j4)(m,null,{legend:(0,n.w5)((()=>[(0,n.Uk)(" Типы ")])),default:(0,n.w5)((()=>[(0,n.Wm)(jt,null,{default:(0,n.w5)((()=>[(0,n.Wm)(Zt,{label:(0,o.SU)(Gt).ANY,active:(0,o.SU)(e).type===(0,o.SU)(F.hR).ANY,onClick:i[0]||(i[0]=t=>s((0,o.SU)(F.hR).ANY))},null,8,["label","active"]),(0,n.Wm)(Zt,{label:(0,o.SU)(Gt).TEXT,active:(0,o.SU)(e).isTypeActive((0,o.SU)(F.hR).TEXT),onClick:i[1]||(i[1]=t=>s((0,o.SU)(F.hR).TEXT))},null,8,["label","active"]),(0,n.Wm)(Zt,{label:(0,o.SU)(Gt).IMAGE,active:(0,o.SU)(e).isTypeActive((0,o.SU)(F.hR).IMAGE),onClick:i[2]||(i[2]=t=>s((0,o.SU)(F.hR).IMAGE))},null,8,["label","active"]),(0,n.Wm)(Zt,{label:(0,o.SU)(Gt).VIDEO,active:(0,o.SU)(e).isTypeActive((0,o.SU)(F.hR).VIDEO),onClick:i[3]||(i[3]=t=>s((0,o.SU)(F.hR).VIDEO))},null,8,["label","active"]),(0,n.Wm)(Zt,{label:(0,o.SU)(Gt).MINE,active:(0,o.SU)(e).isTypeActive((0,o.SU)(F.hR).MINE),onClick:i[4]||(i[4]=t=>s((0,o.SU)(F.hR).MINE))},null,8,["label","active"]),(0,o.SU)(e).isAdultVisible?((0,n.wg)(),(0,n.j4)(Zt,{key:0,label:(0,o.SU)(Gt).NSFW,active:(0,o.SU)(e).isTypeActive((0,o.SU)(F.hR).NSFW),onClick:i[5]||(i[5]=t=>s((0,o.SU)(F.hR).NSFW))},null,8,["label","active"])):(0,n.kq)("v-if",!0)])),_:1})])),_:1}))}}),ne=ie;var ae=s(57599);const oe=(0,n.aZ)({__name:"rating-view",setup(t){const e=ot(),s=[-200,...F.et];return(t,i)=>((0,n.wg)(),(0,n.j4)(m,null,{legend:(0,n.w5)((()=>[(0,n.Uk)(" Рейтинг "),(0,n.wy)((0,n._)("span",{class:(0,a.C_)(t.$style.suffix)}," от "+(0,a.zw)(s[(0,o.SU)(e).rating]),3),[[f.F8,(0,o.SU)(e).rating>0]])])),default:(0,n.w5)((()=>[(0,n.Wm)(ae.Z,{modelValue:(0,o.SU)(e).rating,"onUpdate:modelValue":i[0]||(i[0]=t=>(0,o.SU)(e).rating=t),class:(0,a.C_)(t.$style.slider),options:s},null,8,["modelValue","class"])])),_:1}))}});var re=s(4177),le=s.n(re);const ce={};ce.$style=le();const de=(0,p.Z)(oe,[["__cssModules",ce]]);var ue=s(34273),pe=s(73850);const he=(0,n.aZ)({__name:"community-fieldset-view",setup(t){const e=ot(),s=(0,n.Fl)((()=>e.community?[e.community]:[])),i=(0,o.iH)(),r=(0,o.iH)([]),l=(0,o.iH)(""),c=(0,g.VW)(l,500),d=(0,n.Fl)((()=>c.value.length>1)),{data:u,isLoading:p}=(0,pe.UX)({queryKey:(0,n.Fl)((()=>pe.aw.searchCommunity({query:c.value}))),enabled:d});function h(){r.value=[]}function _(){var t;null===(t=i.value)||void 0===t||t.focus()}return(0,n.YP)(u,(t=>{t?(_(),r.value=t):h()})),(t,c)=>((0,n.wg)(),(0,n.j4)(m,null,{legend:(0,n.w5)((()=>[(0,n.Uk)(" Сообщество ")])),default:(0,n.w5)((()=>[(0,n.Wm)(A,{ref_key:"inputFilterRef",ref:i,modelValue:s.value,"onUpdate:modelValue":c[1]||(c[1]=t=>s.value=t),"input-value":l.value,"onUpdate:inputValue":c[2]||(c[2]=t=>l.value=t),theme:"gray",class:(0,a.C_)(t.$style.inputFilter),loading:(0,o.SU)(p)&&d.value,"dropdown-items":r.value,"max-items":1,label:"Добавить","icon-name":"ic_plus_small","dropdown-label-name":"name","onDropdown:clear":c[3]||(c[3]=t=>h()),onAdd:c[4]||(c[4]=t=>async function(t){l.value="",s.value.push(t),e.community=t.id?{id:t.id,name:t.name,avatar:t.avatar,link:t.link}:null,await(0,n.Y3)(),_()}(t))},{item:(0,n.w5)((({item:s})=>[s?((0,n.wg)(),(0,n.j4)(R,{key:0,class:(0,a.C_)(t.$style.community),onRemove:c[0]||(c[0]=t=>{e.community=null})},{default:(0,n.w5)((()=>[(0,n.Wm)(ue.Z,{class:(0,a.C_)(t.$style.avatar),src:s.avatar,size:20},null,8,["class","src"]),(0,n.Uk)(" "+(0,a.zw)(s.name),1)])),_:2},1032,["class"])):(0,n.kq)("v-if",!0)])),dropdownItemPrefix:(0,n.w5)((({item:e})=>[(0,n.Wm)(ue.Z,{class:(0,a.C_)(t.$style.avatar),src:e.avatar,size:20},null,8,["class","src"])])),_:1},8,["modelValue","input-value","class","loading","dropdown-items"])])),_:1}))}});var _e=s(32406),me=s.n(_e);const ge={};ge.$style=me();const fe=(0,p.Z)(he,[["__cssModules",ge]]);var ve=s(69023);const be=(0,n._)("span",null," Скрыть просмотренные ",-1),ye=(0,n.aZ)({__name:"hide-viewed-fieldset-view",setup(t){const e=ot();function s(t){Y.core.initParams.isDeleted&&(Y.core.ui.authRequired(),t.preventDefault())}return(t,i)=>((0,n.wg)(),(0,n.j4)(m,{class:(0,a.C_)(t.$style.host)},{default:(0,n.w5)((()=>[be,(0,n.Wm)(ve.Z,{modelValue:(0,o.SU)(e).visited,"onUpdate:modelValue":i[0]||(i[0]=t=>(0,o.SU)(e).visited=t),onClick:s},null,8,["modelValue"])])),_:1},8,["class"]))}});var we=s(98259),ke=s.n(we);const xe={};xe.$style=ke();const Se=(0,p.Z)(ye,[["__cssModules",xe]]);var $e=s(92934);const Ce=(0,n._)("h3",null,"Фильтры",-1),Te=(0,n.aZ)({__name:"app",emits:["change"],setup(t,{emit:e}){const s=ot(),i=(0,o.iH)(),d=(0,o.iH)(),u=(0,o.iH)(),{floatingStyles:p}=(0,v.YF)(i,d,{whileElementsMounted:b.Me,middleware:[(0,b.RR)(),(0,y.cv)(4)],placement:"bottom-end",strategy:"fixed",transform:!1}),h=e;function _(t){s.tags.push(t)}return(0,r.i9H)(d,(()=>u.value=!1),{ignore:[i]}),s.$subscribe((0,$e.D)(((t,e)=>{h("change",e)}),500)),(0,n.bv)((()=>{Y.core.listenTo(Y.core,"stories-search:linked-tag-click",_)})),(0,n.Ah)((()=>{Y.core.stopListening(Y.core,"stories-search:linked-tag-click",_)})),(t,e)=>((0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(l.Z,{ref_key:"triggerEl",ref:i,"icon-size":20,class:(0,a.C_)({[t.$style.trigger_active]:u.value}),"icon-name":"ic_filter",size:"large",onClick:e[0]||(e[0]=t=>u.value=!u.value)},null,8,["class"]),((0,n.wg)(),(0,n.j4)(n.lR,{to:"body"},[(0,n.Wm)(c.Z,null,{default:(0,n.w5)((()=>[u.value&&(0,o.SU)(s).tags.length>0?((0,n.wg)(),(0,n.iD)("div",{key:0,ref_key:"hintEl",ref:d,class:(0,a.C_)(t.$style.hint),style:(0,a.j5)((0,o.SU)(p))},[Ce,(0,n.Wm)(rt),(0,n.Wm)(_t),(0,n.Wm)(fe),(0,n.Wm)(se),(0,n.Wm)(ne),(0,n.Wm)(de),(0,n.Wm)(Se)],6)):(0,n.kq)("v-if",!0)])),_:1})]))],64))}});var Ee=s(56058),Ie=s.n(Ee);const Oe={};Oe.$style=Ie();const Ue=(0,p.Z)(Te,[["__cssModules",Oe]]);var De=s(74689);function Ae(t){const e=(0,i.a)(Ue,t);return e.directive("tooltip",De.u),e}},55660:(t,e,s)=>{"use strict";s.r(e),s.d(e,{createApp:()=>F});var i=s(76944),n=s(66252),a=s(3577),o=s(2262),r=(s(88674),s(76122)),l=s(97652),c=s(9771),d=(s(41817),s(69876)),u=s(26117),p=s(94217),h=s(12953);function _(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function m(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?_(Object(s),!0).forEach((function(e){g(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):_(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function g(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const f=h.core.config("modules.story-drafts"),v=(0,d.Q_)("story-drafts",{state:()=>m(m({},f),{},{list:f.list.map((t=>(0,p.E)(t))),loading:!1}),getters:{count:t=>t.list.length,empty(){return 0===this.count},limitExceeded(t){return this.count>=t.limit}},actions:{getScreenIndex(t){return this.list.findIndex((e=>e.id===t))+1},async delete(t){try{this.loading=!0;const{response:e,data:s}=await u.co.deleteDraft(t);if(!e.result)throw e.message;s.drafts_count!==this.count-1?this.list=(await u.co.getPreviewList()).data.drafts.map((t=>(0,p.E)(t))):this.list=this.list.filter((e=>e.id!==t))}catch(e){h.core.ui.toasts.showError(e)}finally{this.loading=!1}},async deleteAll(){try{this.loading=!0;const{response:t}=await u.co.deleteAllDrafts();if(!t.result)throw t.message;this.list=[]}catch(t){h.core.ui.toasts.showError(t)}finally{this.loading=!1}}}});var b=s(37043),y=s(34828),w=s(55946);const k=(0,n.aZ)({__name:"add-story-btn-view",setup:t=>(t,e)=>((0,n.wg)(),(0,n.j4)(b.Z,{label:"Добавить пост",wide:t.IS_MOBILE,icon:"add_16",href:"/add"},null,8,["wide"]))}),x=(0,n.aZ)({__name:"list-view",setup(t){const e=v(),{sendEvent:s}=(0,w.z)(),i=(0,o.iH)(!1),d=(0,o.iH)(null);function u(){s("delete_all_drafts_cancel_button_tapped",{size:e.count})}return(t,p)=>((0,n.wg)(),(0,n.j4)(r.Z,null,{default:(0,n.w5)((()=>[(0,n.Wm)(l.Z,{class:(0,a.C_)(t.$style.header)},{right:(0,n.w5)((()=>[(0,n._)("div",{class:(0,a.C_)(t.$style.controls)},[(0,n.Wm)(k,{disabled:(0,o.SU)(e).limitExceeded,onClick:p[0]||(p[0]=t=>{s("click_create_post",{type:"drafts",size:e.count})})},null,8,["disabled"]),(0,n.Wm)(b.Z,{class:(0,a.C_)(t.$style.deleteAllBtn),wide:t.IS_MOBILE,loading:(0,o.SU)(e).loading,theme:"gray",label:"Удалить все",icon:"delete_16",onClick:p[1]||(p[1]=t=>{e.loading||(s("delete_all_drafts_button_tapped",{size:e.count}),i.value=!0)})},null,8,["class","wide","loading"])],2)])),default:(0,n.w5)((()=>[(0,n._)("span",{class:(0,a.C_)(t.$style.title)},"Черновики ("+(0,a.zw)((0,o.SU)(e).list.length)+"/"+(0,a.zw)((0,o.SU)(e).limit)+")",3)])),_:1},8,["class"]),(0,n._)("div",{class:(0,a.C_)(t.$style.container)},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)((0,o.SU)(e).list,(i=>((0,n.wg)(),(0,n.j4)(c.Z,{id:i.id,key:i.id,tabindex:"0",loading:d.value===i.id,class:(0,a.C_)(t.$style.draft),title:i.title,"title-class":t.$style.draftTitle,text:i.text,"text-class":t.$style.draftText,"created-at":i.createdAt,"created-interval":i.createdInterval,"img-count":i.imgCount,"video-count":i.videoCount,"polls-count":i.pollsCount,"fundraising-widgets-count":i.fundraisingWidgetsCount,onClick:t=>{return n=i.id,s("draft_post_choose",{draft_id:n,screen_index:e.getScreenIndex(n),size:e.count}),void h.core.history.redirect(`/add?draft_id=${n}`);var n},onDelete:p[2]||(p[2]=t=>async function(t){e.loading||(d.value=t,await e.delete(t),d.value=null,s("delete_draft_approve_button_tapped",{draft_id:t,size:e.count}))}(t)),onDeleteClick:p[3]||(p[3]=t=>{return i=t,void(e.loading||s("delete_draft_post",{draft_id:i,type:"drafts",size:e.count}));var i}),onDeleteAbort:p[4]||(p[4]=t=>{s("delete_draft_cancel_button_tapped",{draft_id:t,size:e.count})})},null,8,["id","loading","class","title","title-class","text","text-class","created-at","created-interval","img-count","video-count","polls-count","fundraising-widgets-count","onClick"])))),128))],2),(0,n.Wm)(y.Z,{active:i.value,"onUpdate:active":p[5]||(p[5]=t=>i.value=t),title:"Удалить все черновики",content:"Вы действительно хотите удалить все черновики? Это действие нельзя будет отменить",onConfirm:p[6]||(p[6]=t=>{e.loading||(e.deleteAll(),s("delete_all_drafts_approve_button_tapped",{size:e.count}))}),onClose:p[7]||(p[7]=t=>u()),onCancel:p[8]||(p[8]=t=>u())},null,8,["active"])])),_:1}))}});var S=s(88779),$=s.n(S),C=s(83744);const T={};T.$style=$();const E=(0,C.Z)(x,[["__cssModules",T]]),I=(0,n.aZ)({__name:"empty-view",setup:t=>(t,e)=>((0,n.wg)(),(0,n.j4)(r.Z,{class:(0,a.C_)(t.$style.host)},{default:(0,n.w5)((()=>[(0,n._)("h3",{class:(0,a.C_)(t.$style.heading)}," У вас пока нет черновиков. Самое время создать новый пост! 📝 ",2),(0,n.Wm)(k)])),_:1},8,["class"]))});var O=s(89244),U=s.n(O);const D={};D.$style=U();const A=(0,C.Z)(I,[["__cssModules",D]]);var M=s(79431),N=s(85651);const P=(0,n.aZ)({__name:"app",setup(t){const e=v();return(0,n.bv)((()=>{M.NM.add(M.hA.STORY_DRAFTS_PAGE)})),(t,s)=>((0,n.wg)(),(0,n.iD)("div",{class:(0,a.C_)(t.$style.host)},[(0,o.SU)(e).limitExceeded?((0,n.wg)(),(0,n.j4)(N.Z,{key:0,class:(0,a.C_)(t.$style.alert),theme:"red"},{default:(0,n.w5)((()=>[(0,n.Uk)(" Вы создали максимальное количество черновиков. Продолжите один из них или удалите неактуальные черновики ")])),_:1},8,["class"])):(0,n.kq)("v-if",!0),(0,o.SU)(e).empty?(0,n.kq)("v-if",!0):((0,n.wg)(),(0,n.j4)(E,{key:1})),(0,o.SU)(e).empty?((0,n.wg)(),(0,n.j4)(A,{key:2})):(0,n.kq)("v-if",!0)],2))}});var L=s(2694),R=s.n(L);const j={};j.$style=R();const B=(0,C.Z)(P,[["__cssModules",j]]);var q=s(74689);function F(){const t=(0,i.a)(B);return t.directive("tooltip",q.u),t}},81980:(t,e,s)=>{"use strict";s.r(e),s.d(e,{createApp:()=>wt,createAppRules:()=>kt});var i=s(76944),n=s(66252),a=s(12953),o=(s(88674),s(66992),s(33948),s(3577)),r=s(2262),l=s(49963);const c=[(0,n._)("b",null,"Что это значит:",-1),(0,n._)("ul",null,[(0,n._)("li",null,"ваш пост будет показан на каждой четвертой позиции во всех лентах; "),(0,n._)("li",null,"у вашего поста появится аккуратная пометка «Промо».")],-1)],d=[(0,n._)("b",null,"Минимальная стоимость продвижения — 3 000 ₽.",-1)],u=(0,n._)("a",{href:"mailto:plus@pikabu.ru"},"plus@pikabu.ru",-1);var p=s(34346),h=s.n(p),_=s(83744);const m={},g={};g.$style=h();const f=(0,_.Z)(m,[["render",function(t,e){return(0,n.wg)(),(0,n.iD)("section",{class:(0,o.C_)(t.$style.host)},[t.IS_DESKTOP?((0,n.wg)(),(0,n.iD)("h2",{key:0,class:(0,o.C_)(t.$style.title)}," Продвижение постов на Пикабу ",2)):(0,n.kq)("v-if",!0),(0,n._)("p",{class:(0,o.C_)(t.$style.text)}," Хотите, чтобы ваши посты увидели больше людей? Теперь вы можете вывести свои публикации на заметные рекламные позиции. ",2),(0,n._)("p",{class:(0,o.C_)(t.$style.text)},c,2),(0,n._)("p",{class:(0,o.C_)(t.$style.text)}," Продвижение — это способ увеличить просмотры и получить мгновенную обратную связь. Органическую популярность поста (выход поста в «Горячее или «Лучшее») по-прежнему определяют реакции и интерес пользователей. ",2),(0,n._)("p",{class:(0,o.C_)(t.$style.text)},d,2),(0,n._)("p",{class:(0,o.C_)(t.$style.text)},[(0,n.Uk)(" Ежедневная аудитория Пикабу — более 3 млн человек. Это значит, что ваш контент не останется незамеченным. По всем вопросам настройки пишите на "),u,(0,n.Uk)(". ")],2)],2)}],["__cssModules",g]]);var v=s(92514);const b={1:[["ИНН","inn","number"],["КПП","kpp","number"],["Название юрлица","orgName"],["ОКВЭД","okved"],["Адрес фактический","addressActual"],["Адрес юридический","addressJur"]],2:[["ИНН","inn","number"],["Название ИП","orgName"],["ОКВЭД","okved"],["Адрес регистрации","addressReg"],["Адрес для отправки корреспонденции","addressMail"]],3:[["ИНН","inn","number"]]},y=250,w=.2,k=1e3,x=1e4,S=1e6,$=["link","fio","email"],C=[{title:"Нужно ли маркировать пост?",content:"Да, по&nbsp;закону все рекламные размещения подлежат обязательной маркировке. Маркировка материала включает в&nbsp;себя:<ul><li>Рекламную метку (слово &laquo;Реклама&raquo;).</li><li>Юридическое лицо конечного рекламодателя и ИНН. Пример: <i>ООО «Ромашка», ИНН: 123456789.</i></li><li>Токен во&nbsp;всех рекламных ссылках. Это уникальный буквенно-цифровой код, который идентифицирует ваше размещение в&nbsp;системе ОРД. Пример: https://site.ru/<b>?erid=123456</b>,  где erid=XXX&nbsp;&mdash; это токен.</li></ul><br/><b>Важно:</b> в&nbsp;каждом материале должны присутствовать все части рекламной метки (слово &laquo;Реклама&raquo;, юрлицо, ИНН и&nbsp;токен), иначе это считается нарушением закона."},{title:"Можно ли отменить продвижение поста?",content:"Если пост еще не&nbsp;запущен, вы&nbsp;можете отменить продвижение. Однако после запуска поста остановить его продвижение уже нельзя."},{title:"Будут ли видны реакции и комментарии на моем посте? ",content:"Да, продвижение никак не&nbsp;ограничивает оставлять комментарии, плюсовать и&nbsp;делиться постом."},{title:"Вы модерируете негативные отзывы и комментарии?",content:"Нет, мы&nbsp;не&nbsp;удаляем негативные комментарии и&nbsp;отзывы, если они не&nbsp;нарушают правила Пикабу. Мы&nbsp;рекомендуем работать с&nbsp;обратной связью от&nbsp;пользователей, в&nbsp;том числе негативной."}];var T=s(22177),E=s(47344),I=s(50542),O=s(55317),U=s(64090),D=s(43339);const A=(0,n.aZ)({__name:"pkb-input-label",props:{withHint:{type:Boolean},hintContent:{}},setup(t){const e=t,s=(0,r.iH)(!1);return(t,i)=>((0,n.wg)(),(0,n.iD)("h4",{class:(0,o.C_)(t.$style.label)},[(0,n.WI)(t.$slots,"default"),e.withHint?((0,n.wg)(),(0,n.iD)("span",{key:0,class:(0,o.C_)(t.$style.hint)},[(0,n.Wm)(D.Z,{active:s.value,"onUpdate:active":i[0]||(i[0]=t=>s.value=t),direction:"top"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(e.hintContent),1)])),_:1},8,["active"])],2)):(0,n.kq)("v-if",!0)],2))}});var M=s(46478),N=s.n(M);const P={};P.$style=N();const L=(0,_.Z)(A,[["__cssModules",P]]);var R=s(40094),j=s(37043),B=(s(74916),s(41817),s(69876)),q=s(30381),F=s.n(q),V=s(12950),Z=s(95374);function W(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function z(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?W(Object(s),!0).forEach((function(e){H(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):W(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function H(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const G=/https:\/\/pikabu\.ru\/story\/[\d.A-Za-z]{4,}/,Y="YYYY-MM-DD",K="Поле обязательное для заполенения",Q=(0,B.Q_)("user-ads",{state:()=>{const t=F()(Date.now()).add(3,"d");return{link:"",minDateStart:t.format(Y),maxDateStart:F()(t).add(29,"d").format(Y),dateStart:t.format(Y),dateEnd:F()(t).add(1,"d").format(Y),isDateTarget:!1,isGeoTarget:!1,hasPikabuPlus:!1,geo:"all",cities:[],shows:String(x),budget:String(3e3),thousandCost:String(300),orgType:"3",inn:"",kpp:"",okved:"",orgName:"",addressActual:"",addressJur:"",addressReg:"",addressMail:"",fio:"",email:"",errors:{}}},getters:{data:t=>z(z({link:t.link,geo:"all"===t.geo?"Россия":"Города",cities:t.cities,full_name:t.fio,email:t.email,view_limit:t.shows,price:t.budget,client_type:t.orgType,has_pikabu_plus:t.hasPikabuPlus},t.isDateTarget?{startAt:F()(t.dateStart).unix(),endAt:F()(t.dateEnd).unix()}:{}),"1"===t.orgType?{legal_entity_itn:t.inn.trim(),legal_entity_kpp:t.kpp.trim(),legal_entity_name:t.orgName.trim(),legal_entity_okved:t.okved.trim(),legal_entity_actual_address:t.addressActual.trim(),legal_entity_legal_address:t.addressJur.trim()}:"2"===t.orgType?{individual_entrepreneur_itn:t.inn.trim(),individual_entrepreneur_name:t.orgName.trim(),individual_entrepreneur_okved:t.okved.trim(),individual_entrepreneur_registration_address:t.addressReg.trim(),individual_entrepreneur_address_for_correspondence:t.addressMail.trim()}:{natural_person_itn:t.inn.trim()}),minDateEnd:t=>F()(t.dateStart).add(1,"d").format(Y),maxDateEnd:t=>F()(t.dateStart).add(29,"d").format(Y)},actions:{async getSettings(){const{data:t}=await V.cf.postOrFail("/ajax.php",{route:"ads-form/settings"});return t},async submit(){const{response:t}=await V.cf.post("/ajax.php",{route:"ads-form/request",data:JSON.stringify(this.data)});if(!t.result)throw a.core.ui.toasts.showError(t.message),t.message;return t.result},updateStartDate(t){let e=F()(t);e.isBefore(this.minDateStart)?e=F()(this.minDateStart):e.isAfter(this.maxDateStart)&&(e=F()(this.maxDateStart)),this.dateStart=e.format(Y),F()(this.dateEnd).isAfter(this.maxDateEnd)?this.dateEnd=this.maxDateEnd:F()(this.dateEnd).isBefore(this.minDateEnd)&&(this.dateEnd=this.minDateEnd)},updateEndDate(t){const e=F()(t);e.isBefore(this.minDateEnd)?this.dateEnd=this.minDateEnd:e.isAfter(this.maxDateEnd)?this.dateEnd=this.maxDateEnd:this.dateEnd=e.format(Y)},validate(){this.errors={},this.link&&!G.test(this.link.trim())&&(this.errors.link="Некорректная ссылка на пост"),this.okved&&!/^\d+(\.\d+)+$/.test(this.okved)&&(this.errors.okved="Поле может содержать только числа и точку"),this.email&&!Z.c.email()(this.email)&&(this.errors.email="Некорректный email"),$.forEach((t=>{this[t]||(this.errors[t]=K)})),b[this.orgType].forEach((([t,e])=>{this[e]||(this.errors[e]=K)}))}}});var X=s(57552);const J=(0,n._)("span",null,"–",-1),tt=["onClick"],et=["id","onClick"],st=(0,n._)("div",null,"У меня есть Пикабу+",-1),it=(0,n._)("div",null,[(0,n.Uk)(" Для пользователей подписки "),(0,n._)("a",{href:"https://ads.adfox.ru/260477/goLink?p1=cnpjl&p2=frfe&p5=bbziwo&pr=%random%",target:"_blank"},"Пикабу+"),(0,n.Uk)(" — "),(0,n._)("b",null,"скидка 50%"),(0,n.Uk)(" на продвижение постов. Если у вас еще нет подписки, вы можете "),(0,n._)("a",{href:"https://ads.adfox.ru/260477/goLink?p1=cnpjl&p2=frfe&p5=bbziwo&pr=%random%",target:"_blank"}," оформить ее тут"),(0,n.Uk)(". ")],-1),nt=["data-field"],at=(0,n._)("div",null,[(0,n.Uk)(" Подтверждаю, что ознакомился с условиями "),(0,n._)("a",{href:"https://specials.pikabu.ru/apps/docs/c/oferta_11.11.pdf",target:"_blank"},"публичной оферты")],-1),ot=(0,n.aZ)({__name:"user-form",emits:["submitSuccess"],setup(t,{emit:e}){const s=Q(),i=(0,l.fb)(),a=(0,r.iH)(),c=(0,r.iH)({cities:{},client_types:{}}),d=(0,r.iH)(!1),u=(0,r.iH)(!1),{orgType:p}=(0,B.Jk)(s),h=e,_=t=>{delete s.errors[t]},m=(t,e)=>{_(e)},g=()=>{"all"===s.geo?(s.cities=[],N()):d.value=!0},$=t=>{const e=t?Number(s.shows)+k:Number(s.shows)-k;s.shows=String(e),P()},D=t=>{s.shows=String(t),P()},A=t=>{const e=t.currentTarget;e.id&&M("cities",e.id)},M=(t,e)=>{s[t].includes(e)?s[t]=s[t].filter((t=>t!==e)):s[t].push(e),N()},N=()=>{let t=0;const e=s.hasPikabuPlus?.5:1;s.cities.length&&s.cities.length!==Object.keys(c.value.cities).length&&t++;const i=50*t,n=y+i+(y+i)*w;s.thousandCost=String(n),s.budget=String(Number(s.shows)/k*n*e)},P=()=>{const t=s.hasPikabuPlus?.5:1;let e=Math.round(Number(s.shows)/k)*k;e<x?e=x:e>S&&(e=S),s.shows=String(e),s.budget=String(e/k*Number(s.thousandCost)*t)};(0,n.YP)(p,(()=>{s.errors={}}));const q=async()=>{if(s.validate(),Object.keys(s.errors).length){var t;const e=Object.keys(s.errors)[0];return void(null===(t=document.querySelector(`.${i.form} [data-field="${e}"]`))||void 0===t||t.scrollIntoView({behavior:"smooth"}))}await s.submit()&&((0,X.g)("send-user-ads-form","https://yandex.ru/ads/adfox/260477/getCode?p1=cnpjl&p2=frfe&pfc=gzcut&pfb=bcoshq&pr=[random]&ptrc=b"),h("submitSuccess"),(0,X.g)("show-finish-step","https://yandex.ru/ads/adfox/260477/getCode?p1=cnpjl&p2=frfe&pfc=gzcut&pfb=bcoslp&pr=[random]&ptrc=b"))};(0,n.wF)((async()=>{c.value=await s.getSettings()}));const F=(t,e)=>{t.value!==e&&(t.value=e)};return(t,e)=>((0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(f),(0,n._)("section",{class:(0,o.C_)((0,r.SU)(i).form)},[(0,n._)("div",{class:(0,o.C_)((0,r.SU)(i).part)},[(0,n._)("div",{class:(0,o.C_)((0,r.SU)(i).field),"data-field":"link"},[(0,n.Wm)(L,null,{default:(0,n.w5)((()=>[(0,n.Uk)("Ссылка на ваш пост на Пикабу")])),_:1}),(0,n.Wm)(I.Z,{modelValue:(0,r.SU)(s).link,"onUpdate:modelValue":e[0]||(e[0]=t=>(0,r.SU)(s).link=t),class:(0,o.C_)((0,r.SU)(i).input),placeholder:"https://",error:(0,r.SU)(s).errors.link,"show-error-immediately":!0,onChange:e[1]||(e[1]=t=>_("link"))},null,8,["modelValue","class","error"])],2)],2),(0,n._)("div",{class:(0,o.C_)((0,r.SU)(i).part)},[(0,n._)("div",{class:(0,o.C_)((0,r.SU)(i).confirm)},[(0,n.Wm)(E.Z,{modelValue:(0,r.SU)(s).isDateTarget,"onUpdate:modelValue":e[2]||(e[2]=t=>(0,r.SU)(s).isDateTarget=t)},null,8,["modelValue"]),(0,n.Wm)(L,{"with-hint":!0,"hint-content":"Максимальный срок — 1 месяц."},{default:(0,n.w5)((()=>[(0,n.Uk)(" Даты размещения ")])),_:1}),(0,r.SU)(s).isDateTarget?((0,n.wg)(),(0,n.iD)("div",{key:0,class:(0,o.C_)((0,r.SU)(i).dropContent)},[(0,n._)("div",{class:(0,o.C_)((0,r.SU)(i).dateWrapper)},[(0,n.Wm)(I.Z,{"model-value":(0,r.SU)(s).dateStart,type:"date",min:(0,r.SU)(s).minDateStart,max:(0,r.SU)(s).maxDateStart,"onUpdate:modelValue":(0,r.SU)(s).updateStartDate,onChange:e[3]||(e[3]=t=>F(t.target,(0,r.SU)(s).dateStart))},null,8,["model-value","min","max","onUpdate:modelValue"]),J,(0,n.Wm)(I.Z,{"model-value":(0,r.SU)(s).dateEnd,type:"date",min:(0,r.SU)(s).minDateEnd,max:(0,r.SU)(s).maxDateEnd,"onUpdate:modelValue":(0,r.SU)(s).updateEndDate,onChange:e[4]||(e[4]=t=>F(t.target,(0,r.SU)(s).dateEnd))},null,8,["model-value","min","max","onUpdate:modelValue"])],2)],2)):(0,n.kq)("v-if",!0)],2),(0,n._)("div",{class:(0,o.C_)((0,r.SU)(i).confirm)},[(0,n.Wm)(E.Z,{modelValue:(0,r.SU)(s).isGeoTarget,"onUpdate:modelValue":e[5]||(e[5]=t=>(0,r.SU)(s).isGeoTarget=t)},null,8,["modelValue"]),(0,n.Wm)(L,{"with-hint":!0,"hint-content":"Настройте таргет по городам. При отсутствии выбора пост будет показан всем."},{default:(0,n.w5)((()=>[(0,n.Uk)(" География ")])),_:1}),(0,r.SU)(s).isGeoTarget?((0,n.wg)(),(0,n.iD)("div",{key:0,class:(0,o.C_)((0,r.SU)(i).dropContent)},[(0,n._)("div",{class:(0,o.C_)((0,r.SU)(i).drop)},[(0,n.Wm)(T.Z,{key:"geo",modelValue:(0,r.SU)(s).geo,"onUpdate:modelValue":e[6]||(e[6]=t=>(0,r.SU)(s).geo=t),label:"Россия",value:"all",class:(0,o.C_)((0,r.SU)(i).column),onChange:g},null,8,["modelValue","class"]),(0,n.Wm)(T.Z,{key:"geo",modelValue:(0,r.SU)(s).geo,"onUpdate:modelValue":e[7]||(e[7]=t=>(0,r.SU)(s).geo=t),label:"Города",value:"cities",class:(0,o.C_)((0,r.SU)(i).column),onChange:g},null,8,["modelValue","class"])],2),(0,n._)("div",null,[(0,n._)("div",{ref_key:"dropdownInputEl",ref:a,class:(0,o.C_)([(0,r.SU)(i).citiesBlock,{[(0,r.SU)(i).disabled]:"all"===(0,r.SU)(s).geo}]),onClick:e[8]||(e[8]=t=>d.value=!0)},[(0,r.SU)(s).cities.length?((0,n.wg)(),(0,n.iD)("div",{key:1,class:(0,o.C_)((0,r.SU)(i).citiesContent)},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)((0,r.SU)(s).cities,(t=>((0,n.wg)(),(0,n.iD)("div",{key:t,class:(0,o.C_)((0,r.SU)(i).cityItem)},[(0,n.Uk)((0,o.zw)(c.value.cities[t])+" ",1),(0,n._)("span",{onClick:(0,l.iM)((e=>(t=>{d.value=!1,s.cities=s.cities.filter((e=>e!==t))})(t)),["stop"])},[(0,n.Wm)(R.Z,{name:"close_ios"})],8,tt)],2)))),128))],2)):((0,n.wg)(),(0,n.iD)("span",{key:0,class:(0,o.C_)((0,r.SU)(i).placeholder)},"Выбрать города",2))],2),(0,n.Wm)(O.Z,{active:d.value,"onUpdate:active":e[9]||(e[9]=t=>d.value=t),for:a.value,"onClick:outside":e[10]||(e[10]=t=>d.value=!1)},{default:(0,n.w5)((()=>[(0,n._)("div",{class:(0,o.C_)((0,r.SU)(i).cities)},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(c.value.cities,((t,e)=>((0,n.wg)(),(0,n.iD)("div",{id:e,key:e,class:(0,o.C_)((0,r.SU)(i).city),onClick:(0,l.iM)(A,["stop"])},[(0,n.Wm)(E.Z,{"model-value":(0,r.SU)(s).cities.includes(e),label:t},null,8,["model-value","label"])],10,et)))),128))],2)])),_:1},8,["active","for"])])],2)):(0,n.kq)("v-if",!0)],2)],2),(0,n._)("div",{class:(0,o.C_)((0,r.SU)(i).part)},[(0,n._)("div",{class:(0,o.C_)((0,r.SU)(i).field)},[(0,n.Wm)(L,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Количество показов ")])),_:1}),(0,n._)("div",{class:(0,o.C_)((0,r.SU)(i).shows)},[(0,n._)("button",{class:(0,o.C_)((0,r.SU)(i).showsBtn),onClick:e[11]||(e[11]=t=>$(!1))},[(0,n.Wm)(R.Z,{name:"hide_16"})],2),(0,n.Wm)(I.Z,{modelValue:(0,r.SU)(s).shows,"onUpdate:modelValue":e[12]||(e[12]=t=>(0,r.SU)(s).shows=t),class:(0,o.C_)((0,r.SU)(i).input),"show-error-immediately":!0,min:String((0,r.SU)(x)),max:String((0,r.SU)(S)),step:1e3,type:"number",size:"small",onChange:P},null,8,["modelValue","class","min","max"]),(0,n._)("button",{class:(0,o.C_)((0,r.SU)(i).showsBtn),onClick:e[13]||(e[13]=t=>$(!0))},[(0,n.Wm)(R.Z,{name:"plus_16"})],2)],2),(0,n._)("div",{class:(0,o.C_)((0,r.SU)(i).examples)},[(0,n._)("span",{onClick:e[14]||(e[14]=t=>D(1e5))},"100 000"),(0,n._)("span",{onClick:e[15]||(e[15]=t=>D(5e5))},"500 000"),(0,n._)("span",{onClick:e[16]||(e[16]=t=>D(1e6))},"1 000 000")],2),(0,n._)("div",{class:(0,o.C_)((0,r.SU)(i).budget)},[(0,n.Wm)(L,{"with-hint":!0,"hint-content":"Автоматически рассчитывается исходя из настроек."},{default:(0,n.w5)((()=>[(0,n.Uk)(" Общий бюджет: "),(0,n._)("span",null,(0,o.zw)((0,r.SU)(v.uf)((0,r.SU)(s).budget))+" рублей",1),(0,r.SU)(s).hasPikabuPlus?((0,n.wg)(),(0,n.iD)("span",{key:0,class:(0,o.C_)((0,r.SU)(i).discount)},"50%",2)):(0,n.kq)("v-if",!0)])),_:1})],2),(0,n._)("div",{class:(0,o.C_)((0,r.SU)(i).confirm)},[(0,n.Wm)(E.Z,{modelValue:(0,r.SU)(s).hasPikabuPlus,"onUpdate:modelValue":[e[17]||(e[17]=t=>(0,r.SU)(s).hasPikabuPlus=t),N]},null,8,["modelValue"]),st],2),it],2)],2),(0,n._)("div",{class:(0,o.C_)((0,r.SU)(i).part)},[(0,n.Wm)(L,{"with-hint":!0,"hint-content":"На указанную почту придет информация о заказе и способе оплаты.",class:(0,o.C_)((0,r.SU)(i)["block-heading"])},{default:(0,n.w5)((()=>[(0,n.Uk)(" Ваши данные ")])),_:1},8,["class"]),(0,n._)("div",{class:(0,o.C_)([(0,r.SU)(i).field,(0,r.SU)(i).types])},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(c.value.client_types,((t,a)=>((0,n.wg)(),(0,n.j4)(T.Z,{key:a,modelValue:(0,r.SU)(s).orgType,"onUpdate:modelValue":e[18]||(e[18]=t=>(0,r.SU)(s).orgType=t),class:(0,o.C_)((0,r.SU)(i).column),label:t,value:a},null,8,["modelValue","class","label","value"])))),128))],2),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)((0,r.SU)(b)[(0,r.SU)(s).orgType],(([t,e,a])=>((0,n.wg)(),(0,n.iD)("div",{key:e,"data-field":e,class:(0,o.C_)((0,r.SU)(i).field)},[(0,n.Wm)(L,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(t),1)])),_:2},1024),(0,n.Wm)(I.Z,{modelValue:(0,r.SU)(s)[e],"onUpdate:modelValue":t=>(0,r.SU)(s)[e]=t,error:(0,r.SU)(s).errors[e],"show-error-immediately":!0,type:a?"number":"text",onChange:t=>m(0,e)},null,8,["modelValue","onUpdate:modelValue","error","type","onChange"])],10,nt)))),128)),(0,n._)("div",{class:(0,o.C_)((0,r.SU)(i).field),"data-field":"fio"},[(0,n.Wm)(L,null,{default:(0,n.w5)((()=>[(0,n.Uk)("ФИО")])),_:1}),(0,n.Wm)(I.Z,{modelValue:(0,r.SU)(s).fio,"onUpdate:modelValue":e[19]||(e[19]=t=>(0,r.SU)(s).fio=t),class:(0,o.C_)((0,r.SU)(i).input),error:(0,r.SU)(s).errors.fio,"show-error-immediately":!0,onChange:e[20]||(e[20]=t=>m(0,"fio"))},null,8,["modelValue","class","error"])],2),(0,n._)("div",{class:(0,o.C_)((0,r.SU)(i).field),"data-field":"email"},[(0,n.Wm)(L,null,{default:(0,n.w5)((()=>[(0,n.Uk)("E-mail")])),_:1}),(0,n.Wm)(I.Z,{modelValue:(0,r.SU)(s).email,"onUpdate:modelValue":e[21]||(e[21]=t=>(0,r.SU)(s).email=t),class:(0,o.C_)((0,r.SU)(i).input),error:(0,r.SU)(s).errors.email,"show-error-immediately":!0,onChange:e[22]||(e[22]=t=>m(0,"email"))},null,8,["modelValue","class","error"])],2),(0,n._)("div",{class:(0,o.C_)((0,r.SU)(i).confirm)},[(0,n.Wm)(E.Z,{modelValue:u.value,"onUpdate:modelValue":e[23]||(e[23]=t=>u.value=t)},null,8,["modelValue"]),at],2),(0,n._)("div",{class:(0,o.C_)((0,r.SU)(i).button)},[(0,n.Wm)(j.Z,{disabled:!u.value,wide:t.IS_MOBILE,onClick:q},{default:(0,n.w5)((()=>[(0,n.Uk)(" Отправить ")])),_:1},8,["disabled","wide"])],2)],2)],2),(0,n._)("section",{ref:"faqEl",class:(0,o.C_)((0,r.SU)(i).faqSection)},[(0,n._)("h3",{class:(0,o.C_)((0,r.SU)(i).title)}," Часто задаваемые вопросы ",2),(0,n.Wm)(U.Z,{items:(0,r.SU)(C)},null,8,["items"])],2)],64))}});var rt=s(28093),lt=s.n(rt);const ct={};ct.$style=lt();const dt=(0,_.Z)(ot,[["__cssModules",ct]]);var ut=s(55946);const pt=(0,n.aZ)({__name:"finish-step",setup(t){const{sendEvent:e}=(0,ut.z)(),s=()=>{e("click_custom_ad_to_main_page",{}),(0,X.g)("click-user-ads-main","https://yandex.ru/ads/adfox/260477/getCode?p1=cnpjl&p2=frfe&pfc=goqqh&pfb=uayot&pr=[random]&ptrc=b")},i=()=>{e("click_custom_ad_one_more",{}),(0,X.g)("click-user-ads-form","https://yandex.ru/ads/adfox/260477/getCode?p1=cnpjl&p2=frfe&pfc=gzcut&pfb=bcosme&pr=[random]&ptrc=b")};return(t,e)=>((0,n.wg)(),(0,n.iD)("section",{class:(0,o.C_)(t.$style.host)},[(0,n._)("div",{class:(0,o.C_)(t.$style.title)}," Все получилось! ",2),(0,n._)("div",{class:(0,o.C_)(t.$style.text)}," В течение трех рабочих дней наш менеджер свяжется с вами и отправит счет на оплату для подключения продвижения. ",2),(0,n._)("div",null,[(0,n.Wm)(j.Z,{href:"/",theme:"gray",class:(0,o.C_)(t.$style.btn),onClick:s},{default:(0,n.w5)((()=>[(0,n.Uk)(" На главную ")])),_:1},8,["class"]),(0,n.Wm)(j.Z,{href:"/information/user-ads",onClick:i},{default:(0,n.w5)((()=>[(0,n.Uk)(" Новое объявление ")])),_:1})])],2))}});var ht=s(55187),_t=s.n(ht);const mt={};mt.$style=_t();const gt=(0,_.Z)(pt,[["__cssModules",mt]]);var ft=s(20446);const vt=(0,n.aZ)({__name:"app",setup(t){const{sendEvent:e}=(0,ut.z)(),s=(0,r.iH)(!1);return(0,n.bv)((()=>{a.core.ui.screen=ft.dt.CUSTOM_AD_CREATE,e("transition_to_custom_ad_create",{}),(0,X.g)("show-user-ads-form","https://yandex.ru/ads/adfox/260477/getCode?p1=cnpjl&p2=frfe&pfc=gzcut&pfb=bcosbt&pr=[random]&ptrc=b")})),(0,n.YP)(s,(()=>{s.value&&document.documentElement.scroll(0,0)})),(t,e)=>s.value?((0,n.wg)(),(0,n.j4)(gt,{key:1})):((0,n.wg)(),(0,n.j4)(dt,{key:0,onSubmitSuccess:e[0]||(e[0]=t=>s.value=!0)}))}});var bt=s(42107);const yt=(0,n.aZ)({__name:"app-rules",setup(t){const{sendEvent:e}=(0,ut.z)();return(0,n.bv)((()=>{var t;a.core.ui.screen=bt.dt.CUSTOM_AD_RULES,(0,X.g)("show-user-ads-rules","https://yandex.ru/ads/adfox/260477/getCode?p1=cnpjl&p2=frfe&pfc=goqqh&pfb=ubfbg&pr=[random]&ptrc=b"),e("transition_to_custom_ad_rules",{}),null===(t=document.getElementById("user-ad-button"))||void 0===t||t.addEventListener("click",(()=>{e("click_custom_ad_application",{}),(0,X.g)("click-user-ads-rules","https://yandex.ru/ads/adfox/260477/getCode?p1=cnpjl&p2=frfe&pfc=goqqh&pfb=ubfbf&pr=[random]&ptrc=b")}))})),(t,e)=>((0,n.wg)(),(0,n.iD)("div"))}});function wt(){return(0,i.a)(vt)}function kt(){return(0,i.a)(yt)}},80687:(t,e,s)=>{"use strict";var i=s(12953),n=(s(74916),s(15306),s(88674),s(99819)),a=s(48218),o=s(1262),r=s(96637),l=s(57215),c=s(16093),d=s(31474),u=s(81605),p=s(17311),h=s(99867),_=s(42107),m=s(97099),g=s(2889),f=s(5398),v=s(26938),b=s(19755),y=s.n(b),w=s(63748),k=s(53056),x=s(5651),S=s(53035),$=s(41381);s(66992),s(33948),s(41817);var C=s(36005);function T(t){var e="",s=C.escape;Array.prototype.join;return e+='<span class="avatar donators-list__avatar '+s(t.avatarUrl?"avatar_32":"avatar_donator")+'\'">\n\t<span class="avatar__inner">\n\t\t',t.avatarUrl?e+='\n\t\t\t<img src="'+s(t.avatarUrl)+'" alt="'+s(t.name||"Гость")+'" loading="lazy" />\n\t\t':e+='\n\t\t\t<span class="avatar__donator-img avatar__donator-img_'+s(t.avatarPostfix)+'"></span>\n\t\t',e+="\n\t</span>\n</span>\n"}function E(t){var e,i="";Array.prototype.join;const n=s(96637).Utils;return i+='\n\n<span class="donators-list__label">\n\t<span  class="donators-list__user">'+(null==(e=t.name||"Гость")?"":e)+"</span> и еще "+(null==(e=t.count)?"":e)+" "+(null==(e=n.pluralNounRU(t.count,["донатер","донатера","донатеров"]))?"":e)+"\n</span>\n"}var I=s(55576);function O(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class U{constructor(t){O(this,"sponsorsCount",0),O(this,"currentUserDonated",!1),O(this,"handleWidgetSuccess",(()=>{try{if(this.currentUserDonated)return;if(this.currentUserDonated=!0,0===this.sponsorsCount)return void(this.sponsorsCount=1);1===this.sponsorsCount?this.handleSingleSponsorsExists():this.handleSeveralSponsorsExists(),++this.sponsorsCount}catch(t){console.error(t)}})),this._options=t,this.init()}init(){var t,e;return this.sponsorsCount=Number(this.getDataSource().sponsorsCount||0),this.currentUserDonated=Boolean(this.getDataSource().currentUserDonated),null===(t=this._options.supportBtn)||void 0===t||t.addEventListener("click",(t=>{_.cp.getInstance().sendEvent("author_donation_button_tapped",{type:"author_support",component_name:"user_profile",subscribers:t.target.dataset.subsCount}),(0,I.B)({authorId:this._options.userId,supportType:"subscribe",giveChoice:!0,onDonateSuccess:()=>this.handleWidgetSuccess()})})),null===(e=this._options.becomeDonatorBtn)||void 0===e||e.addEventListener("click",(t=>{_.cp.getInstance().sendEvent("author_donation_button_tapped",{type:"first_author_donation",component_name:"user_profile",subscribers:t.target.dataset.subsCount}),(0,I.B)({authorId:this._options.userId,supportType:"donate",onDonateSuccess:()=>this.handleWidgetSuccess()})})),this}handleSingleSponsorsExists(){if(!this._options.becomeDonatorBtn)return;const[t,e]=this.getAvatarPostfixes(),{sponsorAvatar:s,sponsorName:i,currentUserAvatar:n,currentUserName:a}=this._options.becomeDonatorBtn.dataset,o=T({avatarUrl:s,name:i,avatarPostfix:t}),r=T({avatarUrl:n,name:a,avatarPostfix:e}),l=document.createElement("template");l.innerHTML=function(t){var e,s="";return s+'<div class="donators-list">\n\t<div class="donators-list__avatars">\n\t\t'+(null==(e=t.avatars)?"":e)+"\n\t</div>\n\t"+(null==(e=t.label)?"":e)+"\n</div>"}({avatars:o+r,label:E({name:this.getDataSource().currentUserName,count:this.sponsorsCount})}),this._options.becomeDonatorBtn.replaceWith(l.content)}handleSeveralSponsorsExists(){if(!this._options.sponsorsList)return;const t=this._options.sponsorsList.querySelector(".donators-list__avatars"),e=this._options.sponsorsList.querySelector(".donators-list__label");if(!t||!e)return;const{currentUserAvatar:s,currentUserName:i}=this._options.sponsorsList.dataset,[n]=this.getAvatarPostfixes(),a=document.createElement("template");var o;(a.innerHTML=T({avatarUrl:s,name:i,avatarPostfix:n}),2===this.sponsorsCount)?t.appendChild(a.content):null===(o=t.querySelector(".donators-list__avatar:last-of-type"))||void 0===o||o.replaceWith(a.content);e.outerHTML=E({name:i,count:this.sponsorsCount})}getAvatarPostfixes(){var t;return(null===(t=this.getDataSource().avatarPostfixes)||void 0===t?void 0:t.split(","))||[]}getDataSource(){var t,e;const s=this._options.sponsorsList?null===(t=this._options.sponsorsList)||void 0===t?void 0:t.dataset:null===(e=this._options.becomeDonatorBtn)||void 0===e?void 0:e.dataset;return null!=s?s:{}}}var D=s(58330),A=s(12950);const M="/ajax/users_actions.php";class N extends m.T3{render(){var t;if(this.isRendered)return this;(null===(t=this.$el)||void 0===t?void 0:t.get(0)).querySelectorAll('[data-role="ignore"], .profile__user-notification-bell').forEach((t=>{t.dataset.analyticsType="header"})),this.initCompanyBlogBadgeAnalytics(),this.initSubscriptionsPopup();const e=document.querySelector(".page-profile-anonymous > form");return e&&this.initAnonymousFilters(e),super.render(),this}initAnonymousFilters(t){const e=this._feed,s=new(D.S.getInstance().get("UIForm"))(t);s.on("submit",(t=>{t.preventDefault();const n=s.serialize(),a=y().param(n),o=i.core.history.pathname+(a?"?"+a:"");i.core.history.replaceState(n,void 0,o),e.requestUrl="/ajax"+o,e.showSkeletonLoader(),this.timeout("request",1500,(()=>e.clear().loadStories(!1)))}))}initCompanyBlogBadgeAnalytics(){var t;const e=null===(t=this.el)||void 0===t?void 0:t.querySelector(".profile__company-blog-badge");if(!e)return;const s=()=>{_.cp.getInstance().sendEvent("click",{type:"company_blog_label"})};e.addEventListener("click",s),e.addEventListener("auxclick",(t=>{1===t.button&&s()}))}initQueueBox({container:t,StoriesFeed:e,SimilarStories:s}){const n=t.find(".community-stories-queue__button");new e({$el:t,feedName:"community-queue"}),n.on("click",(()=>{n.slideUp(200,(()=>n.remove())),t.find(".stories-feed__container").fadeIn(500)}));const a=t=>{var e;return null!==(e=y()(t).closest(".community-queue-panel").attr("data-queue-id"))&&void 0!==e?e:""},o=t=>Number(y()(t).data("com-id"))||0;y()('.community-queue-panel__buttons button[data-role="allow"]').click((({target:t,currentTarget:e})=>{this.approveStory(a(t),o(e),g.dO.APPROVED,e)})),y()('.community-queue-panel__buttons button[data-role="deny"]').click((({target:t,currentTarget:e})=>{this.approveStory(a(t),o(e),g.dO.REJECTED,e)})),y()('.community-queue-panel__buttons button[data-role="cancel-community-change"]').click((({target:t,currentTarget:e})=>{this.approveStory(a(t),o(e),g.dO.MOVED_TO_COMMON_FEED,e)})),y()(".community-queue-panel__buttons .community-queue-panel__cmp").click((({target:t,currentTarget:e})=>{this.showCompareResults(a(t),o(e),s)}));try{if("storyPublishedId"in i.core.history.state){const e=t.offset();e&&i.core.ui.scrollTo(Math.max(0,e.top-50),!0)}}catch(r){}}initAdminNote(t,e){const s=t.getAttribute("data-note-id"),n=D.S.getInstance().get("UITextArea"),a=D.S.getInstance().get("UIButton"),r=t.querySelector(".input"),l=t.querySelector(".admin-note__value"),c=t.querySelector(".admin-note__edit"),d=t.querySelector(".admin-note__remove");if(!(r&&c&&d&&l))return;const u=new n(r),p=new a(c);l.innerHTML=o.User.noteValueToHtml(u.value),l.addEventListener("click",(e=>{e.target instanceof HTMLAnchorElement||(t.classList.add("admin-note_editable"),u.focus(),u.els.input.setSelectionRange(u.value.length,u.value.length))})),this.listenTo(u,"blur",(()=>{t.classList.remove("admin-note_editable")})),p.on("click",(async()=>{p.progress=p.disabled=!0,l.innerHTML=o.User.noteValueToHtml(u.value);const{response:t}=await A.cf.post(M,{action:"update_admin_note",note_id:s,note_text:u.value});t.result||i.core.ui.toasts.showError("Не удалось сохранить заметку"),p.progress=p.disabled=!1}));const h=new a(d);h.on("click",(async()=>{h.progress=h.disabled=!0;const{response:n}=await A.cf.post(M,{action:"remove_admin_note",note_id:s});if(!n.result)return i.core.ui.toasts.showError("Не удалось удалить заметку"),void(h.progress=h.disabled=!1);var a;(t.remove(),e)&&(e.innerHTML=String(parseInt(null!==(a=null==e?void 0:e.textContent)&&void 0!==a?a:"0")-1))}))}initAdminNotes(t){const e=D.S.getInstance().get("UITextArea"),s=D.S.getInstance().get("UIButton"),n=document.querySelector(".admin-notes__header");null==n||n.addEventListener("click",(()=>t.classList.toggle("admin-notes_collapsed")));const a=null==n?void 0:n.querySelector("span");t.querySelectorAll(".admin-note").forEach((t=>this.initAdminNote(t,a)));const r=t.querySelector(".admin-notes__form");if(!r)return;const l=r.dataset.userId,c=r.querySelector(".input"),d=r.querySelector(".admin-notes__form-submit"),u=new e(c);new s(d).on("click",(async()=>{const{response:t,data:e}=await A.cf.post(M,{action:"create_admin_note",target_user_id:l,note_text:u.value});if(!t.result)return void i.core.ui.toasts.showError("Не удалось создать заметку");u.value="",a&&(a.innerHTML=String((parseInt(null==a?void 0:a.innerHTML)||0)+1));const s=document.createElement("template");s.innerHTML=`\n\t\t\t\t<section class="admin-note" data-note-id="${e.note_id}">\n\t\t\t\t\t<div class="admin-note__header">\n\t\t\t\t\t\t<a class="admin-note__userlink user__nick" data-profile="true" href="/@${e.author_name}">\n\t\t\t\t\t\t\t${e.author_name}\n\t\t\t\t\t\t</a> -\n\t\t\t\t\t\t<time datetime="${(new Date).toISOString()}" class="story__datetime hint">0 секунд назад</time>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="admin-note__value">${o.User.noteValueToHtml(e.note)}</div>\n\t\t\t\t\t<div class="admin-note__body">\n\t\t\t\t\t\t<div class="input input_editor">\n\t\t\t\t\t\t\t<textarea class="input__input" placeholder="Новая заметка">${e.note}</textarea>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="admin-note__controls">\n\t\t\t\t\t\t<button class="button_success admin-note__edit">Изменить</button>\n\t\t\t\t\t\t<button class="button_danger admin-note__remove">Удалить</button>\n\t\t\t\t\t</div>\n\t\t\t\t</section>\n\t\t\t`;const n=s.content.querySelector(".admin-note");n&&(r.insertAdjacentElement("afterend",n),this.initAdminNote(n,a))}))}async showCompareResults(t,e,s){const n=y()(`.community-queue-panel[data-queue-id="${t}"] .community-queue-panel__similar-stories`);let a=this.marks.get(t);if(a)n.slideToggle();else{a=new s({$parent:n,type:v.VQ.MANUAL,queueId:t}),this.marks.set(t,a),a.show(),a.state=v.DX.WAIT;try{const s=new g.S1(e),i=await s.getComporatorResultForQueue(t);(0,w.K)(i)&&Object.keys(i).length?a.addSources(i):a.state=v.DX.EMPTY}catch(o){i.core.ui.toasts.showError(o)}n.slideDown()}}async approveStory(t,e,s,n){const a=y()(`.community-queue-panel[data-queue-id="${t}"]`),o=a.find("button");if(a.attr("disabled","disabled"),o.attr("disabled","disabled"),n.classList.add("button_spinning"),s===g.dO.APPROVED){const t=k.m.get(f.ob)||0;Date.now()-t<f.Qu&&_.cp.getInstance().yandex.goal("community_fast-approve"),k.m.set(f.ob,Date.now())}try{const n=new g.S1(e),o=await n.processStoryInQueue(t,s);this.toastApprove&&o.length&&(this.toastApprove.hide(),this.timeout("reopen",200,(()=>{this.toastApprove.content=o,this.toastApprove.show()})));const r=a.find(".community-queue-panel__message"),l=a.closest(".story");if(r.length){const t=r.find("a");let e,n=4;r.find("span").text(i.core.i18n("page-community."+(s===g.dO.APPROVED?"approved":"disapproved")));const a=()=>{e&&clearTimeout(e),l.slideUp(400,(()=>l.remove()))},o=()=>{n--,n>=0&&(t.text(`закрыть (${n} сек)`),n>0?e=setTimeout(o,1e3):a())};t.click(a),o(),r.slideDown(400)}else l.slideUp(400,(()=>l.remove()));const c=y()('.bell[data-role="community"]');let d=Number(c.text()||"0");--d>0?c.text(String(d)):c.hide()}catch(r){r.message.length&&i.core.ui.toasts.showError(r)}finally{a.removeAttr("disabled"),o.removeAttr("disabled"),n.classList.remove("button_spinning")}}initSupportBtns(){var t,e,s;this.el&&new U({userId:Number(this._userId),sponsorsList:null===(t=this.el)||void 0===t?void 0:t.querySelector(".donators-list"),supportBtn:null===(e=this.el)||void 0===e?void 0:e.querySelector(".profile__support-btn"),becomeDonatorBtn:null===(s=this.el)||void 0===s?void 0:s.querySelector(".become-donator-btn")})}initFundraisingWidget(){var t,e,s,n;const a=null===(t=this.el)||void 0===t?void 0:t.querySelector(".fundraising-widget__donate-btn");if(!a)return;const o=new $.D({el:null===(e=this.el)||void 0===e?void 0:e.querySelector(".fundraising-progressbar")}),r=Number(null===(s=this.el)||void 0===s||null===(n=s.querySelector(".fundraising-widget"))||void 0===n?void 0:n.getAttribute("data-id")),l=()=>{i.core.initParams.isDeleted?i.core.ui.authRequired():(0,S.Ll)({userId:this._userId,fundraisingId:r,progressbar:o})};a.addEventListener("click",l),a.addEventListener("auxclick",l)}initSubscriptionsPopup(){var t;const e=null===(t=this.$el)||void 0===t?void 0:t.find(".profile__open-tab");null!=e&&e.length&&e.on("click",(t=>{const e=t.target.dataset.type,s={screen_user:this._userId,type:e,rating:this._userRating,size:t.target.dataset.count};_.cp.getInstance().sendEvent("followers"===e?"followers_button_tapped":"following_button_tapped",s),new x.r({userId:Number(this._userId),type:e,analyticsParams:s})}))}}var P=s(36005),L=(s(2707),s(72044)),R=s(88358),j=s(43241);function B(t){var e,s="";Array.prototype.join;return s+='<div class="scheduled-story-popup">\n    ',t.isMobile?s+='\n        <header class="pkb-header-pop-up scheduled-story-popup__header">\n            <button type="button" class="pkb-icon-btn pkb-icon-btn_dark pkb-header-pop-up__back-btn" data-role="close">\n                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__close_20"><use xlink:href="#icon--ui__close_20"></use></svg>\n            </button>\n            <div class="pkb-header-pop-up__title">Отложенные посты</div>\n        </header>\n    ':s+='\n        <div class="pkb-block-header scheduled-story-popup__header">\n            <div class="pkb-block-header__title">Отложенные посты</div>\n            <div class="pkb-block-header__right-bar">\n                <button type="button" class="pkb-icon-btn pkb-icon-btn_dark" data-role="close">\n                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__close_16"><use xlink:href="#icon--ui__close_16"></use></svg>\n                </button>\n            </div>\n        </div>\n    ',s+='\n    <div class="scheduled-story-popup__body">\n        ',t.stories.forEach((t=>{s+='\n            <a class="pkb-story-draft scheduled-story-popup__edit" href="/edit/'+(null==(e=t.id)?"":e)+'?m=schedule">\n                <div class="pkb-story-draft__header">\n                    <h3 class="pkb-story-draft__title">\n                        '+(null==(e=t.title)?"":e)+'\n                    </h3>\n                    <time class="pkb-story-draft__date" datetime="'+(null==(e=t.date)?"":e)+'">'+(null==(e=t.dateString)?"":e)+'</time>\n                    <div class="pkb-story-draft__header-bar">\n                        <button type="button" class="pkb-icon-btn scheduled-story-popup__remove-btn" data-id="'+(null==(e=t.id)?"":e)+'">\n                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__delete_16"><use xlink:href="#icon--ui__delete_16"></use></svg>\n                        </button>\n                    </div>\n                </div>\n                ',t.text&&(s+='<div class="pkb-story-draft__text">'+(null==(e=t.text)?"":e)+"</div>"),s+="\n                ",t.mediaCount&&(s+='\n                    <div class="pkb-story-draft__media">\n                        ',t.hasImage&&(s+='<div class="pkb-story-draft__media-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__photo_20"><use xlink:href="#icon--ui__photo_20"></use></svg></div>'),s+="\n                        ",t.hasVideo&&(s+='<div class="pkb-story-draft__media-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__play_20"><use xlink:href="#icon--ui__play_20"></use></svg></div>'),s+='\n                        <div class="pkb-story-draft__media-count">'+(null==(e=t.mediaCount)?"":e)+"</div>\n                    </div>\n                "),s+="\n            </a>\n        "})),s+="\n    </div>\n</div>\n"}var q=s(30381),F=s.n(q),V=s(86455);let Z,W;!function(t){t.ALERT_LINK="scheduled-story-alert__link",t.POPUP_WRAPPER="scheduled-story-popup-wrapper",t.POPUP_REMOVE="scheduled-story-popup__remove-btn",t.POPUP_EDIT="scheduled-story-popup__edit"}(Z||(Z={})),function(t){t.STORIES="modules.scheduled-stories"}(W||(W={}));class z extends j.u{constructor(t){super(t),this.els={popupLink:document.querySelector(`.${Z.ALERT_LINK}`)},this.init()}init(){var t;this.autoScrollToAlert(),null===(t=this.els.popupLink)||void 0===t||t.addEventListener("click",(t=>{t.preventDefault(),this.openStoriesPopup(),_.cp.getInstance().sendEvent("click",{type:"scheduled_list",size:i.core.config(W.STORIES).length})}))}autoScrollToAlert(){if("scheduled-story-alert"!==i.core.history.hash||!this.els.popupLink)return;const t=this.els.popupLink.offsetTop-window.innerHeight/2;window.scrollTo({top:t,behavior:"smooth"})}openStoriesPopup(){var t;const e=i.core.config(W.STORIES).map((t=>{const e=t.imageCount+t.videoCount,s=new Date(1e3*t.createdAt);return{id:t.id,title:t.title,date:s.getTime(),dateString:F()(s).format("DD.MM.YYYY HH:mm"),text:t.text,hasImage:t.imageCount>0,hasVideo:t.videoCount>0,mediaCount:e}})).sort(((t,e)=>t.date-e.date)),s=new L.LD({wrapperExtraClass:Z.POPUP_WRAPPER,content:B({isMobile:!1,stories:e}),destroyAfterHide:!0,isBlockOverflowTouch:!0});s.show(),null===(t=s.el.querySelector('button[data-role="close"]'))||void 0===t||t.addEventListener("click",(()=>s.hide())),s.el.querySelectorAll(`.${Z.POPUP_REMOVE}`).forEach(((t,e)=>{t.addEventListener("click",(t=>{t.preventDefault(),t.stopPropagation(),z.handleRemoveButtonClick(t),_.cp.getInstance().sendEvent("click",{type:"scheduled_post_delete",size:i.core.config(W.STORIES).length,screen_index:e+1})}))})),s.el.querySelectorAll(`.${Z.POPUP_EDIT}`).forEach(((t,e)=>{t.addEventListener("click",(()=>{_.cp.getInstance().sendEvent("click",{type:"scheduled_post_edit",size:i.core.config(W.STORIES).length,screen_index:e+1})}))}))}static async handleRemoveButtonClick(t){const e=await R.nk.confirmModal({content:"Вы действительно хотите удалить отложенный пост?",buttons:[["modal.remove",V.j.DANGER,!0],["modal.cancel"]]});if(_.cp.getInstance().sendEvent("click",{type:e?"scheduled_post_delete_confirm":"scheduled_post_delete_cancel"}),!e)return;const s=t.target,{response:n}=await A.cf.post("/ajax/gtpost_actions.php",{action:"remove_schedule",schedule_id:s.dataset.id});if(!n.result)throw i.core.ui.toasts.showError(n.message),n.message;window.location.reload()}}s(91904);var H=s(36005);var G=s(20446),Y=s(92934),K=s(77289),Q=s(47442);const X=s(19755);class J extends N{render(){if(this.isRendered)return this;if(this.$el=X(".profile"),this._userId=this.$el.data("user-id"),this._userNick=this.$el.find(".profile__nick a").text(),this._userRating=Number(this.$el.data("rating")),this._xhrNote=void 0,this._profileUserCache=r.MemoryCacheStorage.getInstance("profileUser"),i.core.ui.screen=G.dt.USER,_.cp.getInstance().commonParameters.screen_user=this._userId,this.$els={note:this.$('.input[data-role="note"]'),noteText:this.$(".profile-note__text"),noteTextarea:this.$(".profile-note__textarea"),noteLoading:this.$(".profile-note__loading"),aboutInfo:this.$(".profile__user-about"),aboutInfoContent:this.$(".profile__user-about-content"),notificationBell:this.$(".profile__user-notification-bell"),awardsMore:this.$('button[data-role="awards-more"]').on("click",this._onClickAwardsMore.bind(this)),communitiesMore:this.$('button[data-role="communities-more"]').on("click",this._onClickCommunitiesMore.bind(this)),bansMore:X(".profile__bans-more").on("click",this._onClickBannedMore.bind(this)),block:this.$('.profile__mod[data-role="block"]').on("click",this._onClickBlockNewUser.bind(this)),search:X(".stories-search"),adminNotes:X(".admin-notes"),series:X(".profile-series"),feed:X(".stories-feed")},this.$els.note.length){this._note=new n.G(this.$els.note),this.$els.noteText.removeClass("profile-note__text_invisible"),this.$els.noteTextarea.removeClass("profile-note__textarea_initial"),this.$els.noteLoading.length&&this.$els.noteLoading.fadeOut(200);const t=(0,Y.D)(this._onChangeNote.bind(this),1500);this.listenTo(i.core.ui,"resize",(0,P.throttle)((()=>{this._note.autoSize()}),400)),this.listenTo(this._note,"input",t),this.listenTo(this._note,"cut",t),this.listenTo(this._note,"paste",t),this.listenTo(this._note,"blur",(t=>{this._note.value=this._note.value.replace(/ +/gm," "),this.$els.noteText.html(o.User.noteValueToHtml(t.target.value,{cropLinks:!0,commentLinks:!0})),this._note.value=this._note.value.trim(),this._note.value.length&&this._note.$els.input.filter("textarea").addClass("profile-note__textarea_invisible"),this._note.autoSize()})),this.listenTo(this._note,"focus",(t=>{this._note.$els.input.filter("textarea").removeClass("profile-note__textarea_invisible"),t.target.setSelectionRange(t.target.value.length,t.target.value.length)})),this.$els.noteText.on("click","a",(t=>(window.open(t.target.href,"_blank").focus(),!1))),this._noteSaved=this._note.value}return this.initAdminNotes(),this.$els.aboutInfo.length&&this.$els.aboutInfoContent.html(o.User.noteValueToHtml(this.$els.aboutInfoContent.html(),{noFollow:!0,unEscapeTags:!1,newLineToBr:!1})),this.$els.feed.length?(this._feed=new l._D({$el:this.$els.feed,feedName:this.$els.search.length?"profile-search":"profile",focused:!0}),new l.pd({$el:this.$els.feed,feed:this._feed,feedName:l.DV.PROFILE.valueOf()}),this.$els.search.length&&(this._search=new c.P({feed:this._feed,searchMode:p.xd.USER,$el:this.$els.search})),new h.J1({notificationBellOptions:{el:this.$els.notificationBell[0],user:this.user,showHint:!0,profileType:"author_page"}}),this._initPublicRatingsLinks(),"?subscribe_suggestion"===i.core.history.location.search&&_.cp.getInstance().sendEvent("transition_to_author",{type:"subscribe_suggest_author",author_id:this._userId}),this._initProfileSeries(),this.$el.find(".profile__communities a.community__title").on("click auxclick",(t=>{0!==t.button&&1!==t.button||_.cp.getInstance().sendEvent("transition_to_community",{type:"from_user",community_id:Number(t.currentTarget.dataset.id||0)})})),this.initSupportBtns(),this.initFundraisingWidget(),new z,super.render(),this.initQueueBox(),this):super.render()}async _onClickBlockNewUser(t){t.preventDefault();let e=X(function(t){var e="",s=H.escape;return Array.prototype.join,e+='<div class="profile__mod-confirm">\n\tВы&nbsp;действительно хотите забанить пользователя, а&nbsp;также <b>безвозвратно удалить</b> все комментарии и&nbsp;посты данного пользователя?\n\t<p>Данная операция необратима!</p>\n\t',t&&t.length>0&&(e+='\n\t\t<form class="profile__mod-form">\n\t\t\t<p><label class="profile__mod-label" for="profile__mod-reason">Причина:</label></p>\n\t\t\t<select class="profile__mod-select" id="profile__mod-reason" name="reason">\n\t\t\t\t',t.forEach((function(t){e+='\n\t\t\t\t<option value="'+s(t.id)+'"'+s(124===t.id?" selected":"")+">"+s(t.name)+"</option>\n\t\t\t\t"})),e+="\n\t\t\t</select>\n\t\t</form>\n\t"),e+="\n</div>\n"}(this.$els.block.data("reasons"))),s=new u.C(e.find("select"));await a.g.confirmBalloon({target:this.$els.block,content:e,buttons:[["modal.ban",d.j.DANGER,!0],["modal.cancel"]]})&&(await this.user.block(Number(s.value)),window.location.reload())}_initPublicRatingsLinks(){this.$(".public-ratings-profile__link").on("click",(t=>{var e;_.cp.getInstance().sendEvent("click",{type:null===(e=t.currentTarget)||void 0===e?void 0:e.dataset.analyticsType})}))}_onClickAwardsMore(t){t&&(0,P.isFunction)(t.preventDefault)&&t.preventDefault(),this.$(".profile__award").fadeIn(),this.$els.awardsMore.hide()}_onClickCommunitiesMore(t){t&&(0,P.isFunction)(t.preventDefault)&&t.preventDefault(),this.$(".community").show(),this.$els.communitiesMore.hide()}_onClickBannedMore(t){t&&(0,P.isFunction)(t.preventDefault)&&t.preventDefault(),X(".profile__bans tr:hidden").show(),this.$els.bansMore.hide()}async _onChangeNote(t){if(this._xhrNote||t===this._noteSaved)return this;this._resetNoteCacheValue(t),this._xhrNote=!0;try{await this.user.note(t),i.core.ui.toasts.add("profile-note-saved",{content:i.core.i18n("users.note-saved"),closeAfter:3e3}),o.User.changeMiniProfileNote(this._userNick,t),_.cp.getInstance().sendEvent(this._noteSaved?"user_note_edit":"user_note_add",{"author_id!empty":this._userId,"rating!undefined":this._userRating}),this._noteSaved=t}catch(e){i.core.ui.toasts.showError(e)}this._xhrNote=!1}_resetNoteCacheValue(t){(""===this._noteSaved&&""!==t||""!==this._noteSaved&&""===t)&&this._profileUserCache.has(this._userNick)&&this._profileUserCache.remove(this._userNick)}_initProfileSeries(){0!==this.$els.series.length&&new h.sA({el:this.$els.series.get(0)})}initAdminNotes(){const t=document.querySelector(".admin-notes");t&&super.initAdminNotes(t)}initQueueBox(){const t=X(".community-stories-queue");t.length&&(this.toastApprove=new Q.O({closeAfter:1e4,destroyAfterHide:!1,addCloseButton:!0}),super.initQueueBox({container:t,StoriesFeed:l._D,SimilarStories:K.Bi}))}get user(){let t=this._options.user;return t||(t=this._options.user=new o.User(this._userId)),t}}var tt=s(10850);class et extends m.T3{async _confirmAdult(t,e){var s;let i=!0;if(t&&null!==(s=t.$els)&&void 0!==s&&s.input.data("confirmAdult")&&!t.checked){let s=await tt.Z.showAdultPopup({isConfirmPopup:!1,birthdayInput:e});if(s.input.value&&(e.value=s.input.value,this._prevBirthdateValue=F()(s.input.value,"DD.MM.YYYY").format("YYYY-MM-DD")),s.result){if(s.notSave)return!0}else t.checked=!1;i=s.result}return i}}var st=s(16226);const it=s(19755);class nt extends et{render(){return this.isRendered||(this._saveSettingsDebounce=(0,P.debounce)(this._saveSettings,800),this.$parent=it(".settings"),super.render()),this}async _detectNeedFocusToOption(t){if(!this.ctx.hash||0!==this.ctx.hash.indexOf("option-"))return;let e=this.ctx.hash.slice(7),s=!!e.length&&this.$(`.${t}[data-role="${e}"]`);i.core.ui.scrollRestoration="auto",s&&1===s.length&&(i.core.ui.scrollRestoration="manual",i.core.ui.elementInViewport(s)||await i.core.ui.scrollTo(s.offset().top-s.height(),!0),s.addClass(`${t}_highlight`),setTimeout((()=>s.removeClass(`${t}_highlight`)),2400))}async _onChangeGeneral(){this._settings.update(this._currentFormOptions),this._isSaved?this.state=st.eT.GOOD:(this.state=st.eT.WAIT,this._saveSettingsDebounce())}get _isSaved(){return 0===this._settings.diff("saved").length}get state(){return this._options.state||st.eT.GOOD}set state(t){let e=this.state;if((t=st.eT[t])!==e)if(t){switch(this._saveToast||(this._saveToast=new Q.O),t){case st.eT.GOOD:this._saveToast.theme=Q.K.DEFAULT,this._saveToast.closeAfter=1500;break;case st.eT.BAD:this._saveToast.theme=Q.K.DANGER,this._saveToast.closeAfter=!0;break;case st.eT.WAIT:default:this._saveToast.theme=Q.K.WARNING,this._saveToast.closeAfter=!1}this._saveToast.content=i.core.i18n(`page-settings.main.save-message.${t.toString().toLowerCase()}`),this._saveToast.show(),this._options.state=t}else this._saveToast&&this._saveToast.hide()}}var at=s(85823),ot=s(44361),rt=s(63907),lt=s(90477),ct=s(36005);var dt=s(21255),ut=s(65448),pt=s(71503),ht=s(35856),_t=s(31200),mt=s(82800);function gt(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const ft="profile-block__textarea_invisible";class vt extends j.u{constructor(t){super(t),gt(this,"savedValue",""),gt(this,"isSaving",!1),gt(this,"handleChange",(async t=>{if(this.isSaving||t===this.savedValue)return this;this.isSaving=!0;try{await this.saveValue(t),this.notifySaved(),this.sendAnalytics(),this.savedValue=t,this.emit("saved",t)}catch(e){i.core.ui.toasts.showError(e)}finally{this.isSaving=!1}return this})),this.init()}init(){if(!this.el)return;const t=new(D.S.getInstance().get("UITextArea"))(this.el),e=t.$els.input.filter("textarea").get(0);this.user=new o.User(this._options.userId),this._options.$aboutText.removeClass("profile-block__text_invisible"),e.classList.remove("profile-block__textarea_initial");const s=(0,Y.D)(this.handleChange,1500);this.listenTo(t,"input",s),this.listenTo(t,"cut",s),this.listenTo(t,"paste",s),this.listenTo(t,"blur",(s=>{t.value=t.value.replace(/ +/gm," ").trim(),this._options.$aboutText.html(o.User.noteValueToHtml(s.target.value)),t.value=t.value.trim(),t.value.length&&e.classList.add(ft),t.autoSize()})),this.listenTo(t,"focus",(t=>{e.classList.remove(ft),setTimeout((()=>{t.target.setSelectionRange&&t.target.setSelectionRange(t.target.value.length,t.target.value.length)}),0)})),this.savedValue=t.value,setTimeout((()=>t.autoSize()))}async saveValue(t){return{about:()=>this.user.about(t),topAuthorInfo:()=>this.user.topAuthorDescription(t)}[this._options.type]()}sendAnalytics(){o.User.sendSettingsChangeAnalytics({about:"about",topAuthorInfo:"about_top_author"}[this._options.type])}notifySaved(){i.core.ui.toasts.add("settings-"+this._options.type,{content:{about:"Информация о себе изменена",topAuthorInfo:"Описание в плашке топового автора изменено"}[this._options.type],closeAfter:3e3})}}function bt(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function yt(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?bt(Object(s),!0).forEach((function(e){wt(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):bt(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function wt(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const kt=s(19755);class xt extends nt{route(t,e){return this.ctx=t,this.isShown?this._detectNeedFocusToOption("settings-main__option"):(this.show(),this.timeout("detect",2e3,(()=>{this._detectNeedFocusToOption("settings-main__option")}))),e()}render(){return super.render(),this.config||(this.config=i.core.config("modules.settings.main")),this._prevBirthdateValue=this.config.birthdate?F()(this.config.birthdate).format("DD.MM.YYYY"):"",this.$el=kt(function(t){var e,s="",i=ct.escape;Array.prototype.join,s+='<div class="settings-main">\n\t<form name="general" method="POST" action="javascript:void 0;" autocomplete="off" novalidate>\n\t\t<section class="section section_padding_none profile" data-user-id="'+i(t.userId)+'">\n\t\t\t<div class="profile__header">\n\t\t\t\t<div class="background background_show-upload" data-editable="true" '+(null==(e=(t.headerBackgroundUrl?"":' data-default="true"')+(t.headerBackgroundForbidden?' data-forbidden="true"':""))?"":e)+'>\n\t\t\t\t\t<div class="background__placeholder"'+(null==(e=t.headerBackgroundUrl?' style="background-image: url('+t.headerBackgroundUrl+')"':"")?"":e)+'></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="avatar avatar_large avatar_show-upload" data-own="true" data-editable="true"><img src="'+(null==(e=t.avatar)?"":e)+'"></div>\n\t\t\t</div>\n\t\t\t<div class="profile__user">\n\t\t\t\t<div class="settings-main__block">\n\t\t\t\t\t<h1 class="profile__nick">\n\t\t\t\t\t\t<a href="/@'+i(t.userName)+'">'+i(t.userName)+'</a>\n\t\t\t\t\t</h1>\n\x3c!--\t\t\t\t\t<div class="settings-main__profession">--\x3e\n\x3c!--\t\t\t\t\t\t<div>Специализация или сфера интересов</div>--\x3e\n\x3c!--\t\t\t\t\t\t<section class="input input_editor profile-block" data-role="profession">--\x3e\n\x3c!--\t\t\t\t\t\t\t<textarea class="input__input profile-block__textarea profile-block__textarea_initial"--\x3e\n\x3c!--\t\t\t\t\t\t\t\t\t  rows="1" tabindex="1" placeholder="Например, Javascript-программист">'+(null==(e=t.profession_proposal?t.profession_proposal:t.profession)?"":e)+'</textarea>--\x3e\n\x3c!--\t\t\t\t\t\t\t<div tabindex="1" class="input__input profile-block__text profile-block__text_invisible"--\x3e\n\x3c!--\t\t\t\t\t\t\t\t title="Например, Javascript-программист">'+(null==(e=t.profession_proposal?t.profession_proposal:t.profession)?"":e)+'</div>--\x3e\n\x3c!--\t\t\t\t\t\t</section>--\x3e\n\x3c!--\t\t\t\t\t</div>--\x3e\n\t\t\t\t\t<div class="settings-main__about">\n\t\t\t\t\t\t<div class="settings-main__label">О себе</div>\n\t\t\t\t\t\t<section class="input input_editor profile-block" data-role="about">\n\t\t\t\t\t\t\t<textarea class="input__input profile-block__textarea profile-block__textarea_initial '+(null==(e=t.about_info?"profile-block__textarea_invisible":"")?"":e)+'"\n\t\t\t\t\t\t\t\t\t  rows="1" placeholder="Не более 512 символов">'+(null==(e=t.about_info?t.about_info:"")?"":e)+'</textarea>\n\t\t\t\t\t\t\t<div class="input__input profile-block__text profile-block__text_invisible"\n\t\t\t\t\t\t\t\t title="Не более 512 символов">'+(null==(e=t.about_info?t.about_info:"")?"":e)+"</div>\n\t\t\t\t\t\t</section>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t",t.isUserTopAuthor&&(s+='\n\t\t\t\t\t<div class="settings-main__top-author">\n\t\t\t\t\t\t<div class="settings-main__label">Описание в плашке топового автора</div>\n\t\t\t\t\t\t<section class="input input_editor profile-block" data-role="top-author">\n\t\t\t\t\t\t\t<textarea class="input__input profile-block__textarea profile-block__textarea_initial '+(null==(e=t.userAuthorDescription?"profile-block__textarea_invisible":"")?"":e)+'"\n\t\t\t\t\t\t\t\t\t  rows="1" placeholder="Не более 140 символов" maxlength="140">'+(null==(e=t.userAuthorDescription?t.userAuthorDescription:"")?"":e)+'</textarea>\n\t\t\t\t\t\t\t<div class="input__input profile-block__text profile-block__text_invisible"\n\t\t\t\t\t\t\t\t title="Не более 140 символов">'+(null==(e=t.userAuthorDescription?t.userAuthorDescription:"")?"":e)+"</div>\n\t\t\t\t\t\t</section>\n\t\t\t\t\t</div>\n\t\t\t\t\t"),s+='\n\n\t\t\t\t\t<div class="settings-main__birthdate">\n\t\t\t\t\t\t<div class="settings-main__label">Дата рождения</div>\n\n\t\t\t\t\t\t<div class="settings-main__birthdate-inner">\n\t\t\t\t\t\t\t<div class="input input_box input_medium">\n\t\t\t\t\t\t\t\t<div class="input__box">\n\t\t\t\t\t\t\t\t\t<input type="text" name="birthdate" class="input__input" value="'+(null==(e=t.birthdate)?"":e)+'">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<select name="birthdate_display_mode" data-role="listbox">\n\t\t\t\t\t\t\t\t<option value="0" '+(null==(e=0===t.birthdateDisplayMode?'selected="selected"':"")?"":e)+'>Показывать</option>\n\t\t\t\t\t\t\t\t<option value="1" '+(null==(e=1===t.birthdateDisplayMode?'selected="selected"':"")?"":e)+'>Показывать только день и месяц</option>\n\t\t\t\t\t\t\t\t<option value="2" '+(null==(e=2===t.birthdateDisplayMode?'selected="selected"':"")?"":e)+'>Не показывать</option>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="settings-main__sex">\n\t\t\t\t\t\t<div class="settings-main__label">Пол</div>\n\t\t\t\t\t\t<div class="select">\n\t\t\t\t\t\t\t<select name="gender" data-role="listbox">\n\t\t\t\t\t\t\t\t<option value="0" '+(null==(e=0===t.gender?'selected="selected"':"")?"":e)+'>Не показывать </option>\n\t\t\t\t\t\t\t\t<option value="1" '+(null==(e=1===t.gender?'selected="selected"':"")?"":e)+'>Мужской</option>\n\t\t\t\t\t\t\t\t<option value="2" '+(null==(e=2===t.gender?'selected="selected"':"")?"":e)+'>Женский</option>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="settings-main__options">\n\t\t\t\t<h4 class="settings-main__sub-header" id="links-stories-feed">Лента</h4>\n\n\t\t\t\t',t.isSettingPruning||(s+='\n\t\t\t\t\t\x3c!-- Постраничный просмотр --\x3e\n\t\t\t\t\t<div class="settings-main__option" data-role="used-ajax-load">\n\t\t\t\t\t\t<label><input type="checkbox" name="is_twitmode" class="checkbox_switch" value="false" '+(null==(e=0==t.isUsedAjaxLoad?'checked="checked"':"")?"":e)+"><span>Постраничный просмотр</span></label>\n\t\t\t\t\t</div>\n\t\t\t\t"),s+='\n\n\t\t\t\t\x3c!-- Сворачивать содержание постов --\x3e\n\t\t\t\t<div class="settings-main__option">\n\t\t\t\t\t<label><input type="checkbox" name="is_scrollmode" class="checkbox_switch" value="false" '+(null==(e=0==t.isUsedScrollMode?'checked="checked"':"")?"":e)+"><span>Сворачивать содержание постов</span></label>\n\t\t\t\t</div>\n\n\t\t\t\t",t.isSettingPruning||(s+='\n\t\t\t\t\t\x3c!-- Показывать полностью длинные посты --\x3e\n\t\t\t\t\t<div class="settings-main__option">\n\t\t\t\t\t\t<label><input name="is_full_story_view" type="checkbox" class="checkbox_switch" value="1" '+(null==(e=!0===t.isFullStoryView?'checked="checked"':"")?"":e)+"><span>Показывать полностью длинные посты</span></label>\n\t\t\t\t\t</div>\n\t\t\t\t"),s+='\n\n\t\t\t\t\x3c!-- Показывать материалы 16+ --\x3e\n\t\t\t\t<div class="settings-main__option" data-option="show_porno">\n\t\t\t\t\t<label><input name="show_porno" type="checkbox" class="checkbox_switch" value="1" data-confirm-adult="1" '+(null==(e=1==t.isAdultVisible?'checked="checked"':"")?"":e)+'><span>Показывать 18+ контент</span></label>\n\t\t\t\t</div>\n\n\t\t\t\t\x3c!-- Показывать посты с тегом жесть --\x3e\n\t\t\t\t<div class="settings-main__option" data-option="is_horror">\n\t\t\t\t\t<label><input name="is_horror" type="checkbox" class="checkbox_switch" value="1" data-confirm-adult="1" '+(null==(e=1==t.isHorrorVisible?'checked="checked"':"")?"":e)+'><span>Показывать посты с тегом <span class="tag">жесть</span></span></label>\n\t\t\t\t</div>\n\n\t\t\t\t<h4 class="settings-main__sub-header">Пост</h4>\n\n\t\t\t\t\x3c!-- Показывать теги вверху поста --\x3e\n\t\t\t\t<div class="settings-main__option">\n\t\t\t\t\t<label><input name="is_tags_at_top_dv" type="checkbox" class="checkbox_switch" value="1" '+(null==(e=1==t.isTagsAtTop?'checked="checked"':"")?"":e)+'><span>Показывать теги вверху поста</span></label>\n\t\t\t\t</div>\n\n\t\t\t\t\x3c!-- Автоматическое воспроизведение видео/гиф в лентах --\x3e\n\t\t\t\t<div class="settings-main__option">\n\t\t\t\t\t<label><input name="is_video_autoplay_mode" value="1" type="checkbox" class="checkbox_switch" '+(null==(e=1==t.isVideoAutoplayMode?'checked="checked"':"")?"":e)+'><span>Воспроизводить видео и GIF в постах автоматически</span></label>\n\t\t\t\t</div>\n\n\t\t\t\t\x3c!-- Показывать дополнительные посты под комментариями --\x3e\n\t\t\t\t<div class="settings-main__option">\n\t\t\t\t\t<label><input name="show_related_stories" type="checkbox" class="checkbox_switch" value="1" '+(null==(e=1==t.isShowRelatedStories?'checked="checked"':"")?"":e)+"><span>Показывать дополнительные посты под комментариями</span></label>\n\t\t\t\t</div>\n\n\t\t\t\t",t.isSettingPruning||(s+='\n\t\t\t\t\t<div class="settings-main__option">\n\t\t\t\t\t\t<div class="settings-main__dropdown settings-main__tags-fold">\n\t\t\t\t\t\t\t<input name="tags_fold_mode" class="hidden" value="'+i(t.tagsFoldMode)+'" />\n\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t  <span>\n\t\t\t\t\t\t\t\tТеги\n\t\t\t\t\t\t\t\t<span data-role="tags_fold_mode" data-mode="'+i(t.tagsFoldMode)+'">\n\t\t\t\t\t\t\t\t\t'+i(0===t.tagsFoldMode?"Сворачивать частично":1===t.tagsFoldMode?"Скрывать":"Показывать все")+'\n\t\t\t\t\t\t\t\t</span> <span> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-down icon--ui__arrow-down_settings"><use xlink:href="#icon--ui__arrow-down"></use></svg></span>\n\t\t\t\t\t\t\t  </span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t'),s+='\n\n\t\t\t\t<h4 class="settings-main__sub-header">Комментарии</h4>\n\n\t\t\t\t\x3c!-- Сворачивать вложенные комментарии после --\x3e\n\t\t\t\t<div class="settings-main__option">\n\t\t\t\t\t<div class="settings-main__slider-wrapper">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<select name="max_comments_branch_depth" data-role="slider">\n\t\t\t\t\t\t\t\t';for(var n=1;n<10;n++)s+='\n\t\t\t\t\t\t\t\t\t<option value="'+(null==(e=n)?"":e)+'"'+(null==(e=t.maxCommentsBranchDepth===n?' selected="selected"':"")?"":e)+">"+i(n)+" ур.</option>\n\t\t\t\t\t\t\t\t";return s+='\n\t\t\t\t\t\t\t\t<option value="0"'+(null==(e=0==t.maxCommentsBranchDepth?' selected="selected"':"")?"":e)+'>10 ур.</option>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>Сворачивать вложенные комментарии после <span class="settings-main__value" data-role="max_comments_branch_depth">'+(null==(e=0===t.maxCommentsBranchDepth?10:t.maxCommentsBranchDepth)?"":e)+' ур.</span></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t\x3c!-- Останавливать Gif анимацию в комментариях --\x3e\n\t\t\t\t<div class="settings-main__option">\n\t\t\t\t\t<label><input name="hide_gifs" type="checkbox" class="checkbox_switch" value="1" '+(null==(e=1==t.isAnimPreviewComment?'checked="checked"':"")?"":e)+">Ставить GIF на паузу в комментариях</label>\n\t\t\t\t</div>\n\n\t\t\t\t",t.isSettingPruning||(s+='\n\t\t\t\t\t<div class="settings-main__option">\n\t\t\t\t\t\t<div class="settings-main__dropdown settings-main__sorting">\n\t\t\t\t\t\t\t<input name="default_com_view" class="hidden" value="'+i(t.defaultCommentsViewMode)+'" />\n\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t  <span>\n\t\t\t\t\t\t\t\tСортировать комментарии <span data-role="default_com_view" data-order="'+i(t.defaultCommentsViewMode)+'">'+i(1===t.defaultCommentsViewMode?"по рейтингу":2===t.defaultCommentsViewMode?"по времени":"по актуальности")+' </span><span> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-down icon--ui__arrow-down_settings"><use xlink:href="#icon--ui__arrow-down"></use></svg></span>\n\t\t\t\t\t\t\t  </span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t'),s+'\n\n\n\t\t\t\t<h4 class="settings-main__sub-header">Подписки</h4>\n\t\t\t\t\x3c!-- Скрывать мои подписки и подписчиков --\x3e\n\t\t\t\t<div class="settings-main__option">\n\t\t\t\t\t<label><input name="is_subs_hidden" type="checkbox" class="checkbox_switch" value="1" '+(null==(e=t.isSubsHidden?'checked="checked"':"")?"":e)+'><span>Скрывать мои подписки и подписчиков</span></label>\n\t\t\t\t</div>\n\n\t\t\t\t<h4 class="settings-main__sub-header" id="links-others">Другие</h4>\n\n\t\t\t\t\x3c!-- Показывать полосу прокрутки наверх --\x3e\n\t\t\t\t<div class="settings-main__option">\n\t\t\t\t\t<label><input name="scroll_top" type="checkbox" class="checkbox_switch" value="1" '+(null==(e=1==t.isUsedScrollTopButton?'checked="checked"':"")?"":e)+'><span>Показывать полосу прокрутки наверх</span></label>\n\t\t\t\t</div>\n\n\t\t\t\t\x3c!-- Отключить рекламу --\x3e\n\t\t\t\t<div class="settings-main__option" data-role="is-ads-disabled">\n\t\t\t\t\t<label>\n\t\t\t\t\t\t<input name="is_ads_disabled" '+(null==(e=t.isDisableAdsAllowed?"":"disabled")?"":e)+' type="checkbox" class="checkbox_switch" value="1" '+(null==(e=t.isDisableAds?'checked="checked"':"")?"":e)+'>\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\tОтключить рекламу\n\t\t\t\t\t\t\t<i class="fa fa-question-circle hint" aria-label="'+(null==(e=t.disableAdsHint)?"":e)+'"></i>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</section>\n\t</form>\n</div>'}(yt(yt({},this.config),{},{birthdate:this._prevBirthdateValue}))),this.$orderMode=this.$('span[data-role="default_com_view"]'),this.$tagsFoldMode=this.$('span[data-role="tags_fold_mode"]'),this._userId=this.$(".profile").data("user-id"),this.$els={about:this.$('.input[data-role="about"]'),aboutText:this.$('.input[data-role="about"] .profile-block__text'),topAuthorInfo:this.$('.input[data-role="top-author"]'),topAuthorInfoText:this.$('.input[data-role="top-author"] .profile-block__text'),profession:this.$('.input[data-role="profession"]'),birthdate:this.$('input[name="birthdate"]')},this._initAboutInput(),this._initTopAuthorInfoInput(),this.$els.profession.length&&(this._professionsDropdown=new dt.v({$el:this.$els.profession,closeAfterSelect:!0})),this._saveToast=void 0,this._formGeneral=new at.x(this.$('form[name="general"]')),this.listenTo(this._formGeneral,"change",this._onChangeGeneral),["commentst","newst","page_num","max_comments_branch_depth"].forEach((t=>{let e=rt.u1.closestUIElement(this.$('select[name="'+t+'"]')),s=this.$(`.settings-main__value[data-role="${t}"]`);e&&this.listenTo(e,"change",((t,e)=>{s.text(e)}))})),this._initBirthdateHandlers(),this.$orderMode.on("click",this._onClickOrder.bind(this)),this.$tagsFoldMode.on("click",this._onClickTagsFold.bind(this)),this._settings=new lt.Lo(this._currentFormOptions),this._settings.save("saved"),this._formOptionsBeforeSave=yt({},this._currentFormOptions),Object.keys(this._formOptionsBeforeSave).forEach((t=>{this.listenTo(this._settings,t,((e,s,i)=>{this.config[o.USER_SETTINGS_CONFIG_MAP[t]]=s,this.state!==st.eT.WAIT&&(this._formOptionsBeforeSave[t]=i)}))})),this.listenTo(i.core.ui,"beforeunload",(t=>{if(!this._isSaved){let e=i.core.i18n("page-settings.main.before-close");return t.returnValue=e,e}})),this}mount(){return super.mount(),i.core.ui._attachChangeBackground(),i.core.ui._attachChangeProfileAvatar(),this}_initAboutInput(){const t=new vt({el:this.$els.about.get(0),type:"about",$aboutText:this.$els.aboutText});this.listenTo(t,"saved",(t=>{this.config.about_info=t}))}_initTopAuthorInfoInput(){!async function(t){t&&await(0,_t.kd)({id:"top-author-info",target:t,text:"Теперь вы можете заполнить описание блока топового автора",theme:mt.xb.GREEN,direction:mt.Lh.TOP,alignment:mt.SE.CENTER,hideByScroll:!1,wrapperExtraClass:"popup_feature-notification",showOnce:!0})}(this.$(".settings-main__top-author").get(0));const t=new vt({el:this.$els.topAuthorInfo.get(0),type:"topAuthorInfo",$aboutText:this.$els.topAuthorInfoText});this.listenTo(t,"saved",(t=>{this.config.userAuthorDescription=t}))}_initBirthdateHandlers(){this.$els.birthdate.length&&(this.$els.showPornoCheckbox=this._formGeneral.$el.find('[data-option="show_porno"] .checkbox'),this.$els.isHorrorCheckbox=this._formGeneral.$el.find('[data-option="is_horror"] .checkbox'),this.birthdateInput=new ht.o({el:this.$els.birthdate.parent().parent()[0],minDate:pt.Ll,acceptCallback:()=>{const t=this.birthdateInput.input.mask;t.masked.rawInputValue?t.typedValue&&(this._prevBirthdateValue=t.typedValue):this._prevBirthdateValue=null,i.core.initParams.birthday=t.typedValue},blurCallback:()=>{this._onChangeGeneral();const t=this.birthdateInput.input.mask,e=F()().diff(F()(this.birthdateInput.value,"DD-MM-YYYY"),"milliseconds");if(e&&F().duration(e).years()<18||!t.masked.rawInputValue){const t=this._currentFormOptions;t.show_porno&&this.$els.showPornoCheckbox.trigger("click"),t.is_horror&&this.$els.isHorrorCheckbox.trigger("click")}}}),setTimeout((()=>{var t;this._prevBirthdateValue=null===(t=this.birthdateInput.input)||void 0===t?void 0:t.mask.typedValue}),1e3))}async _saveSettings(){if(this._isSaved)return void(this.state=st.eT.GOOD);if(await o.User.saveSettings(this._settings.plainData)){this.state=st.eT.GOOD;const t=this._settings.diff("saved")[0];t&&o.User.sendSettingsChangeAnalytics(t.property,this._formOptionsBeforeSave[t.property],t.value),this._settings.save("saved")}else this.state=st.eT.BAD}async _onChangeGeneral(t,e){await this._confirmAdult(e,this.birthdateInput.input)&&super._onChangeGeneral()}_onClickOrder(){let t=this.marks.get("order-mode-popup");if(!t){const e=this.$(".settings-main__sorting input");t=a.g.popupEnum(this.$orderMode,new ut.xs({RATING:1,TIME:2,RELEVANCE:3}),"comments.order-mode",this.$orderMode.data("order")),this.listenTo(t,"change",(async(s,n)=>{e.val(n.valueOf()),this.$orderMode.text(i.core.i18n("comments.order-mode."+n.toString())),this._onChangeGeneral(),t.hide()})),this.marks.set("order-mode-popup",t)}return t.toggle(),this}_onClickTagsFold(){let t=this.marks.get("tags-fold-popup");if(!t){const e=this.$(".settings-main__tags-fold input");t=a.g.popupEnum(this.$tagsFoldMode,ot.yX,"tags.fold-mode",this.$tagsFoldMode.data("mode")),this.listenTo(t,"change",(async(s,n)=>{e.val(n.valueOf()),this.$tagsFoldMode.text(i.core.i18n("tags.fold-mode."+n.toString())),this._onChangeGeneral(),t.hide()})),this.marks.set("tags-fold-popup",t)}return t.toggle(),this}get _currentFormOptions(){return(0,P.defaults)(yt(yt({},this._formGeneral.serialize()),{},{birthdate:this._prevBirthdateValue?F()(this._prevBirthdateValue,"DD.MM.YYYY").format("YYYY-MM-DD"):""}),{is_scrollmode:0,is_full_story_view:0,is_video_autoplay_mode:0,hide_gifs:0,show_porno:0,newst:-15,is_horror:0,scroll_top:0,show_related_stories:0,is_tags_at_top_dv:0,is_ads_disabled:0,tags_fold_mode:0,is_subs_hidden:0,default_com_view:3,action:"change_settings"})}}var St=s(90312);class $t extends m.T3{route(t,e){return this.ctx=t,this.isRendered?this._tabs.currentTab=t.params.typeName||"users":this.show(),e()}_initAnalytics(){this.$els.tabUsers.find(".user").on("click auxclick",(t=>{0!==t.button&&1!==t.button||St.c.getInstance().sendEvent("transition_to_author",{type:"from_subs_manage","author_id!empty":Number(t.currentTarget.dataset.id)})})),this.$els.tabTags.find(".tag").on("click auxclick",(t=>{0!==t.button&&1!==t.button||St.c.getInstance().sendEvent("transition_to_tag",{type:"from_subs_manage",tag_id:t.currentTarget.textContent.trim()})})),this.$els.tabCommunities.find(".community__title").on("click auxclick",(t=>{0!==t.button&&1!==t.button||St.c.getInstance().sendEvent("transition_to_community",{type:"from_subs_manage","community_id!empty":Number(t.currentTarget.dataset.id)})}))}}var Ct=s(88227),Tt=(s(24603),s(3668)),Et=s(65035),It=s(77416),Ot=s(36005);var Ut=s(36005);var Dt=s(36005);var At=s(36005);var Mt=s(36005);var Nt=s(36005);var Pt=s(53201);const Lt=s(19755);class Rt extends rt.u1{constructor(t,e,s){super(),this.$el=t,this._type=e,this._prefix=s,this.$el.length&&this.render()}render(){this.$els={form:this.$el.find(`.${this._prefix}__form`),searchInput:this.$el.find("[data-role=find]"),searchSubmit:this.$el.find('button[type="submit"]'),userList:this.$el.find(`.${this._prefix}-list`),userListItems:this.$el.find(`.${this._prefix}-list__item`),globalList:this.$el.find(`.${this._prefix}-global-list`),globalBlock:this.$el.find(`.${this._prefix}__global-block`),loadMoreBtn:this.$el.find(`.${this._prefix}__show-more-btn`)},this._form=new at.x(this.$els.form),this._searchInput=new Tt.u3(this.$els.searchInput),this._form.add(this._searchInput),this._lastSearch=this._searchInput.value,this._currentSearch=this._searchInput.value,this._currentRegexp=new RegExp(r.Utils.escapeStringRegExp(this._searchInput.value),"i"),this._pageType="settings-subs"===this._prefix?"subscribe":"ignore",this._lastListItemsArray=[],this.$els.userListItems.each(((t,e)=>{this._lastListItemsArray.push(Lt(e).data("id"))}));let t=this.$els.form.attr("data-has-more");this._hasMore=void 0!==t&&!1!==t,this.listenTo(this._searchInput,"input",(0,P.debounce)(this._searchController,500)),this.listenTo(this._searchInput,"change",(0,P.debounce)((()=>{0===this._searchInput.value.length&&this._searchController()}),400)),this.listenTo(this._searchInput,"enter",(t=>t.preventDefault())),this.$els.globalList.on("click",`.${this._prefix}-list__item-add-btn`,this._addOrRemoveItem.bind(this,!0,this._type)),this.$els.userList.on("click",`.${this._prefix}-list__item-remove-btn`,this._addOrRemoveItem.bind(this,!1,this._type)),this.$els.loadMoreBtn.click((t=>{t.preventDefault(),this._loadUserItems()}))}async _loadUserItems(t="loadMore",e=""){let s,i=this.$el.data("id"),n=(0,P.last)(this._lastListItemsArray);s="ignore"===this._pageType?await Et.mB.getList(i,e,n):await Et.bF.getList(i,e,n),s.hasMore||"loadMore"!==t||(this.$els.form.removeAttr("data-has-more"),this._hasMore=!1),s.list.forEach((e=>{if(this.$el.find(`.${this._prefix}-list__item[data-id=${e.id}]`).length)return;let s=e;"string"==typeof e&&(s={label:e,hidden:"loadMore"!==t});let n=this._prepareItemData(i,s,this._prefix,"removable"),a=this._createListItem(n);this.$els.userList.append(a)})),this.$els.userListItems=this.$el.find(`.${this._prefix}-list__item`),"loadMore"===t&&(this._lastListItemsArray=[],this.$els.userListItems.each(((t,e)=>{this._lastListItemsArray.push(Lt(e).data("id"))})))}async _searchController(t=!1){let e=this._searchInput.value;if(this._searchInput.progress=!0,this._currentSearch=e,this._currentRegexp=new RegExp(r.Utils.escapeStringRegExp(this._currentSearch),"i"),t||this._currentSearch!==this._lastSearch){if(this._lastSearch=this._currentSearch,this.$els.userListItems.filter(((t,e)=>Lt(e).data("to-hide"))).remove(),this.$els.globalList.html(""),It.y.remove(this.$els.form,"dropdown-item__highlight"),""===this._currentSearch)return this.$els.userListItems.show(),this._hasMore&&this.$els.form.attr("data-has-more",""),0===this.$els.userListItems.length?this.$els.form.attr("data-not-found-user","").attr("data-not-found-global",""):this.$els.form.removeAttr("data-not-found-user").attr("data-not-found-global",""),void(this._searchInput.progress=!1);this._hasMore&&(this.$els.form.removeAttr("data-has-more"),await this._loadUserItems("search",e)),this._searchUserItems(),Et.k0.getList(e,this._type).then((t=>{this._searchInput.value===e&&(this._updateGlobalList(this._type,t),this._searchInput.progress=!1)}))}else this._searchInput.progress=!1}_searchUserItems(){let t=this._currentRegexp,e=0;this.$els.userListItems.filter(((s,i)=>{let n=Lt(i);return t.test(n.data("name"))?(It.y.add(n,t,"dropdown-item__highlight"),e++,!0):(n.hide(),!1)})).show(),e?this.$els.form.removeAttr("data-not-found-user"):this.$els.form.attr("data-not-found-user","")}_updateGlobalList(t,e){let s=this.$els.globalList,i=this.$els.userListItems,n=this._prefix,a=0;e.length?(e.every((e=>{let o=!0;if(i.each((function(){if((e.name||e.label)===Lt(this).data("name"))return o=!1,!1})),o){a++;let i=this._prepareItemData(t,e,n,"addable"),o=this._createListItem(i);s.append(o)}return a<=17}),this),a>0?(It.y.add(s,this._currentRegexp,"dropdown-item__highlight"),this.$els.form.removeAttr("data-not-found-global")):this.$els.form.attr("data-not-found-global","")):this.$els.form.attr("data-not-found-global","")}async _addOrRemoveItem(t,e,s){let n,a="settings-subs"===this._prefix;n=t?a?"subscribe":"ignore":a?"unsubscribe":"remove-ignore";let r,l,c,d=Lt(s.currentTarget).parent(`.${this._prefix}-list__item`),u=d.data("id"),p=this._prepareItemData(e,d,this._prefix),h={type:t?"my_subs_search":"my_subs"};switch(e){case"users":r=i.default.i18n(`page-settings.confirmations.${n}.users.middle`),l=function(t){var e="",s=Mt.escape;return e+'<a class="user user_inline" href="/@'+s(t.label)+'" target="_blank" data-id="'+s(t.id)+'" data-name="'+s(t.label)+'" data-avatar="'+s(t.avatar)+'">\n\t<span class="avatar avatar_small"><img src="'+s(t.avatar)+'"></span>\n\t<span class="user__nick">'+s(t.label)+"</span>\n</a>"}(p);break;case"tags":r=i.default.i18n(`page-settings.confirmations.${n}.tags.middle`),l=function(t){var e="",s=Dt.escape;return e+'<a class="'+s(t.prefix)+'__tag tag" data-name="'+s(t.label)+'" href="/tag/'+s(t.label)+'" target="_blank" title="Поиск по тегу '+s(t.label)+'">'+s(t.label)+"</a>"}(p);break;case"communities":r=i.default.i18n(`page-settings.confirmations.${n}.communities.middle`),l=function(t){var e="",s=Ot.escape;return e+'<div class="'+s(t.prefix)+'__community community community_inline">\n\t<div class="community-avatar community-avatar_small" data-id="'+s(t.id)+'" data-name="'+s(t.label)+'" data-link="'+s(t.link)+'" data-avatar="'+s(t.avatar)+'">\n\t\t<a href="/community/'+s(t.link)+'" target="_blank">\n\t\t\t<img src="'+s(t.avatar)+'">\n\t\t</a>\n\t</div>\n\t<a class="community__title" href="/community/'+s(t.link)+'" target="_blank">'+s(t.label)+"</a>\n</div>"}(p)}d.addClass(`${this._prefix}-list__item_translucent`);try{switch(e){case"users":a?await new o.User(u).subscribe(t,h):await new o.User(u).ignore(t,h);break;case"tags":a?await ot.zG.subscribe(u,t,h):await ot.zG.ignore(u,t,h);break;case"communities":a?await new g.S1(u).subscribe(t,h):await new g.S1(u).ignore(t,h);break;case"reply-stories":a&&await(0,Pt.t)(u,t,h)}}catch(_){return i.default.ui.toasts.showError(_.message||_),void d.removeClass(`${this._prefix}-list__item_translucent`)}if(t){let t=this._prepareItemData(e,d,this._prefix,"removable");c=this._createListItem(t),this.$els.userList.append(c),It.y.add(c,this._currentRegexp,"dropdown-item__highlight")}else if(!t&&""!==this._currentSearch){let t=this._prepareItemData(e,d,this._prefix,"addable");c=this._createListItem(t),this.$els.globalList.append(c),It.y.add(c,this._currentRegexp,"dropdown-item__highlight")}!t&&this._hasMore&&(this._lastListItemsArray=(0,P.without)(this._lastListItemsArray,u)),d.remove(),this.$els.userListItems=this.$els.userList.find(`.${this._prefix}-list__item`),this.$els.userListItems.filter(":visible").length?this.$els.form.removeAttr("data-not-found-user"):this.$els.form.attr("data-not-found-user",""),this.$els.globalList.find("li").length?this.$els.form.removeAttr("data-not-found-global"):this.$els.form.attr("data-not-found-global","")}_prepareItemData(t,e,s,i="addable"){let n=e;return n.variant=i,n.prefix=s,n.type=t,n.label||(n.label=e.name?e.name:""),L.Zv.isJQuery(e)&&(n.id=e.data("id"),n.label=e.data("name"),n.avatar=e.data("avatar"),n.link=e.data("link"),n.has_note=e.data("has-note")),n}_createListItem(t){let e;switch(t.type){case"users":e=function(t){var e="",i=Nt.escape;Array.prototype.join;const n=s(12953).core;return e+='\n<li class="'+i(t.prefix)+'-list__item" data-to-hide="'+i(t.hidden)+'" data-id="'+i(t.id)+'" data-avatar="'+i(t.avatar)+'" data-name="'+i(t.label)+'" data-has-note="'+i(t.has_note)+'">\n\t<button\n\t',"addable"===t.variant?e+='\n       class="'+i(t.prefix)+'-list__item-add-btn button_link" title="'+i("settings-ignore"===t.prefix?"Добавить в игнор-лист":"Подписаться на пользователя")+'"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__plus icon--ui__plus_settings-list"><use xlink:href="#icon--ui__plus"></use></svg></button>\n    ':e+='\n      class="'+i(t.prefix)+'-list__item-remove-btn button_link" title="'+i("settings-ignore"===t.prefix?"Убрать пользователя из игнор-листа":"Отписаться от пользователя")+'"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__close icon--ui__close_settings-list"><use xlink:href="#icon--ui__close"></use></svg></button>\n    ',e+='\n\t<div class="'+i(t.prefix)+'-list__item-content">\n\t\t<a class="user user_inline" data-profile="true" target="_blank" href="/@'+i(t.label)+'" data-id="'+i(t.id)+'" data-name="'+i(t.label)+'" data-avatar="'+i(t.avatar)+'">\n\t\t\t<span class="avatar avatar_small avatar_note">\n\t\t\t\t<span class="avatar__inner"><img src="'+i(t.avatar)+'"></span>\n\t\t\t\t',t.has_note&&(e+='\n\t\t\t\t\t<span class="avatar__note"></span>\n\t\t\t\t'),e+='\n\t\t\t</span><span class="user__nick">'+i(t.label)+"</span>\n\t\t</a>\n        ",t.is_permabanned&&(e+='\n            <span class="user__ban hint" aria-label="'+i(n.i18n("users."+(t.ban_reason?"permabanned":"permabanned-without-reason"),t.ban_reason))+'">\n\t\t\t\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__ban icon--ui__ban_profile"><use xlink:href="#icon--ui__ban"></use></svg>\n\t\t\t\t\t\t</span>\n        '),e+"\n\t</div>\n</li>\n"}(t);break;case"tags":e=function(t){var e="",s=At.escape;return Array.prototype.join,e+='<li class="'+s(t.prefix)+'-list__item" data-to-hide="'+s(t.hidden)+'" data-id="'+s(t.label)+'" data-name="'+s(t.label)+'">\n\t<button\n\t',"addable"===t.variant?e+='\n       class="'+s(t.prefix)+'-list__item-add-btn button_link" title="'+s("settings-ignore"===t.prefix?"В скрытое":"Подписаться на тег")+'"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__plus icon--ui__plus_size-middle"><use xlink:href="#icon--ui__plus"></use></svg></button>\n\t':e+='\n       class="'+s(t.prefix)+'-list__item-remove-btn button_link" title="'+s("settings-ignore"===t.prefix?"Убрать из скрытого":"Отписаться от тега")+'"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__close icon--ui__close_size-middle"><use xlink:href="#icon--ui__close"></use></svg></button>\n\t',e+='\n\t<div class="'+s(t.prefix)+'-list__item-content">\n\t\t<a class="'+s(t.prefix)+'__tag tag" data-name="'+s(t.label)+'" href="/tag/'+s(encodeURIComponent(t.label))+'" target="_blank" title="Поиск по тегу '+s(t.label)+'">'+s(t.label)+"</a>\n\t</div>\n</li>\n"}(t);break;case"communities":e=function(t){var e="",s=Ut.escape;return Array.prototype.join,e+='<li class="'+s(t.prefix)+'-list__item" data-to-hide="'+s(t.hidden)+'" data-id="'+s(t.id)+'" data-name="'+s(t.label)+'" data-link="'+s(t.link)+'" data-avatar="'+s(t.avatar)+'">\n\t<button\n\t',"addable"===t.variant?e+='\n       class="'+s(t.prefix)+'-list__item-add-btn button_link" title="'+s("settings-ignore"===t.prefix?"Добавить в игнор-лист":"Подписаться на сообщество")+'"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__plus icon--ui__plus_size-middle"><use xlink:href="#icon--ui__plus"></use></svg></button>\n    ':e+='\n       class="'+s(t.prefix)+'-list__item-remove-btn button_link" title="'+s("settings-ignore"===t.prefix?"Убрать сообщество из игнор-листа":"Отписаться от сообщества")+'"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__close icon--ui__close_size-middle"><use xlink:href="#icon--ui__close"></use></svg></button>\n    ',e+='\n\t<div class="'+s(t.prefix)+'-list__item-content">\n\t\t<div class="'+s(t.prefix)+'__community community" >\n\t\t\t<div class="community-avatar community-avatar_small">\n\t\t\t\t<a href="/community/'+s(t.link)+'" target="_blank">\n\t\t\t\t\t<img src="'+s(t.avatar)+'">\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t\t<a class="community__title" target="_blank" href="/community/'+s(t.link)+'">'+s(t.label)+"</a>\n\t\t</div>\n\t</div>\n</li>\n"}(t)}return Lt(Lt.parseHTML(e))}}const jt=s(19755);class Bt extends $t{render(){let t="settings-subs";return this.$el=jt(`.${t}`),this.$els={tabs:this.$el.find(`.${t}__tabs`),tabUsers:this.$el.find(`.${t}__tab[data-id="users"]`),tabTags:this.$el.find(`.${t}__tab[data-id="tags"]`),tabCommunities:this.$el.find(`.${t}__tab[data-id="communities"]`),tabComstories:this.$el.find(`.${t}__tab[data-id="reply-stories"]`)},this._tabs=new Ct.F(this.$els.tabs),new Rt(this.$els.tabUsers,"users",t),new Rt(this.$els.tabTags,"tags",t),new Rt(this.$els.tabCommunities,"communities",t),new Rt(this.$els.tabComstories,"reply-stories",t),i.core.ui.screen=G.dt.USER_SUBS_LIST,this._initAnalytics(),super.render(),this}}s(85827);var qt=s(75021),Ft=s(18910),Vt=s(76468);const Zt={render:()=>{const t=i.default.ua.mac?"text":"password";return qt.vu.create("form",{className:"security-option__fields",name:"password",autoComplete:"off",noValidate:"true"},qt.vu.create("label",{className:"security-option__field"},qt.vu.create("div",{className:"security-option__label"},"Текущий пароль"),qt.vu.create("div",{className:"security-option__value"},qt.vu.create("div",{className:"input input_box input_medium"},qt.vu.create("div",{className:"input__box"},qt.vu.create("input",{type:t,className:"input__input",name:"password_current",required:!0,minLength:"4",maxLength:"160"}))))),qt.vu.create("label",{className:"security-option__field"},qt.vu.create("div",{className:"security-option__label"},"Новый пароль"),qt.vu.create("div",{className:"security-option__value"},qt.vu.create("div",{className:"input input_box input_medium"},qt.vu.create("div",{className:"input__box"},qt.vu.create("input",{type:t,className:"input__input",name:"password_new",required:!0,minLength:"4",maxLength:"160"})),qt.vu.create("span",{className:"input__complexity"})))),qt.vu.create("label",{className:"security-option__field"},qt.vu.create("div",{className:"security-option__label"},"Повторите пароль"),qt.vu.create("div",{className:"security-option__value"},qt.vu.create("div",{className:"input input_box input_medium"},qt.vu.create("div",{className:"input__box"},qt.vu.create("input",{type:t,className:"input__input",name:"password_confirm",required:!0,minLength:"4",maxLength:"160"}))))),qt.vu.create("div",{className:"security-option__footer"},qt.vu.create("button",{type:"submit",className:"button_medium button_success"}),qt.vu.create("div",{className:"security-option__value-hint"}),qt.vu.create("button",{className:"button_medium security-option__close","data-to":"cancel"},"Отмена")))},notUpdate:!0},Wt={render:()=>qt.vu.create("form",{className:"security-option__fields",name:"email",autoComplete:"off",noValidate:"true"},qt.vu.create("div",{className:"security-option__header"},qt.vu.create("div",{className:"security-option__field"},qt.vu.create("div",{className:"security-option__label"},"Email"),qt.vu.create("div",{className:"security-option__value"}))),qt.vu.create("label",{className:"security-option__field"},qt.vu.create("div",{className:"security-option__label"},"Новая почта"),qt.vu.create("div",{className:"security-option__value"},qt.vu.create("div",{className:"input input_box input_medium"},qt.vu.create("div",{className:"input__box"},qt.vu.create("input",{type:"email",className:"input__input",name:"email",required:!0}))))),qt.vu.create("label",{className:"security-option__field"},qt.vu.create("div",{className:"security-option__label"},"Текущий пароль"),qt.vu.create("div",{className:"security-option__value"},qt.vu.create("div",{className:"input input_box input_medium"},qt.vu.create("div",{className:"input__box"},qt.vu.create("input",{type:"password",className:"input__input",name:"password",required:!0}))))),qt.vu.create("div",{className:"security-option__footer"},qt.vu.create("button",{type:"submit",className:"button_medium button_success"}),qt.vu.create("div",{className:"security-option__value-hint"}),qt.vu.create("button",{className:"button_medium security-option__close","data-to":"cancel"},"Отмена"))),notUpdate:!0},zt={render:()=>qt.vu.create("form",{className:"security-option__fields",name:"phone",autoComplete:"off",noValidate:"true"},qt.vu.create("div",{className:"security-option__header"},qt.vu.create("div",{className:"security-option__field"},qt.vu.create("div",{className:"security-option__label"},"Телефон"),qt.vu.create("div",{className:"security-option__value"}))),qt.vu.create("label",{className:"security-option__field"},qt.vu.create("div",{className:"security-option__label"},"Новый номер"),qt.vu.create("div",{className:"security-option__value"},qt.vu.create("div",{className:"input input_box input_medium"},qt.vu.create("div",{className:"input__box"},qt.vu.create("input",{type:"tel",className:"input__input",autoComplete:"tel",name:"phone",required:!0}))))),qt.vu.create("label",{className:"security-option__field"},qt.vu.create("div",{className:"security-option__label"},"Текущий пароль"),qt.vu.create("div",{className:"security-option__value"},qt.vu.create("div",{className:"input input_box input_medium"},qt.vu.create("div",{className:"input__box"},qt.vu.create("input",{type:"password",className:"input__input",name:"password",required:!0,minLength:"4",maxLength:"160"}))))),qt.vu.create("div",{className:"security-option__footer"},qt.vu.create("button",{type:"submit",className:"button_medium button_success"}),qt.vu.create("div",{className:"security-option__value-hint"}),qt.vu.create("button",{className:"button_medium security-option__close","data-to":"cancel"},"Отмена"))),notUpdate:!0},Ht={render:()=>qt.vu.create("form",{className:"security-option__fields",name:"nickname",autoComplete:"off",noValidate:"true"},qt.vu.create("div",{className:"security-option__header"},qt.vu.create("div",{className:"security-option__field"},qt.vu.create("div",{className:"security-option__label"},"Никнейм"),qt.vu.create("div",{className:"security-option__value"}))),qt.vu.create("div",{className:"security-option__warning",hidden:!0},qt.vu.create("p",{className:"security-option__warning_nickname"},"Вы слишком часто меняете никнейм. Попробуйте позже")),qt.vu.create("label",{className:"security-option__field"},qt.vu.create("div",{className:"security-option__label"},"Новый никнейм"),qt.vu.create("div",{className:"security-option__value"},qt.vu.create("div",{className:"input input_box input_medium"},qt.vu.create("div",{className:"input__box"},qt.vu.create("input",{type:"text",className:"input__input",name:"nickname",autoComplete:"off",autoCapitalize:"none",autoCorrect:"off",minLength:"4",maxLength:"16",required:!0})))),qt.vu.create("div",{className:"security-option__available-nicknames"})),qt.vu.create("label",{className:"security-option__field"},qt.vu.create("div",{className:"security-option__label"},"Текущий пароль"),qt.vu.create("div",{className:"security-option__value"},qt.vu.create("div",{className:"input input_box input_medium"},qt.vu.create("div",{className:"input__box"},qt.vu.create("input",{type:"password",className:"input__input",name:"password",required:!0}))))),qt.vu.create("div",{className:"security-option__footer"},qt.vu.create("button",{type:"submit",className:"button_medium button_success"}),qt.vu.create("button",{className:"button_medium security-option__close","data-to":"cancel"},"Отмена"))),notUpdate:!0};s(81780);const Gt=({token:t,onTokenCopied:e,onBotOpen:s,tokenClipboard:n,timeLeft:a,onGetNewToken:o,onClose:r,isPopup:l})=>{const c=a<=0,d=async()=>{c||(await navigator.clipboard.writeText(t),e(t),l||i.core.ui.toasts.add("telegram-token",{content:"Код скопирован!"}))},u=parseInt(a/60)+1,p=c?" истекло":": 30 мин. ";return qt.vu.create("div",{className:"settings-security-telegram__code-block"},qt.vu.create("p",null,"Ваш код доступа"),qt.vu.create("div",{onClick:d,className:"settings-security-telegram__input input input_section"+(c?" input_readonly":"")},qt.vu.create("span",{className:"input__box"},qt.vu.create("span",{className:"settings-security-telegram__code-wrapper"},qt.vu.create("span",null,t))),qt.vu.create("span",{className:"input__icon"},qt.vu.create(Vt.t,{block:"ui__copy_16"}))),qt.vu.create("h4",null,"Время действия кода",p,c?null:qt.vu.create("span",{className:"settings-security-telegram__left-time"},"(Осталось: ",u>30?30:u," мин.)")),qt.vu.create("div",{className:"settings-security-telegram__btns-wrapper"},c?[qt.vu.create("button",{className:"button_success",onClick:s},"Перейти к боту"),qt.vu.create("button",{className:"button_border",onClick:o},"Получить новый код")]:l?[qt.vu.create("button",{onClick:d,className:"button_success","data-role":"copy"},qt.vu.create(Vt.t,{block:"ui__copy_16"}),n===t?"Скопировано!":"Скопировать код"),qt.vu.create("button",{className:"button_border",onClick:s},"Перейти к боту")]:qt.vu.create("button",{className:"button_success",onClick:s},"Перейти к боту")),l?qt.vu.create("span",{onClick:r,class:"settings-security-telegram__icon-close"},qt.vu.create(Vt.t,{block:"ui__close_16"})):null)};function Yt(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function Kt(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?Yt(Object(s),!0).forEach((function(e){Qt(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Yt(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function Qt(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class Xt extends j.u{constructor(...t){super(...t),Qt(this,"tokenBlockEl",null)}show(){return this.isRendered||(this.vNode=Gt(this.getTelegramCodeProps()),this.tokenBlockEl=qt.wK.createElement(this.vNode,"code-block",void 0,{}),this.popup=new R.LD({isModalMenu:!0,width:560,header:"Получить код",isHeaderLeftAlign:!0,destroyAfterHide:!0,content:this.tokenBlockEl}),this.popup.show()),this}update(t={}){const e=Gt(this.getTelegramCodeProps(t));qt.zM.node(this.vNode,e,"code-block").reduce(qt.nq.updateElement(void 0,this),this.tokenBlockEl),this.vNode=e}getTelegramCodeProps(t={}){return Kt(Kt({token:this._options.telegramTokenBlockProps.token,timeLeft:this._options.telegramTokenBlockProps.timeLeft,tokenClipboard:this._options.telegramTokenBlockProps.tokenClipboard,isPopup:!0},t),{},{onClose:()=>{var t,e;null===(t=(e=this._options.telegramTokenBlockProps).onClose)||void 0===t||t.call(e),this.popup.hide()},onBotOpen:()=>{this.popup.hide(),this._options.telegramTokenBlockProps.onBotOpen()},onTokenCopied:t=>{this._options.telegramTokenBlockProps.onTokenCopied(t)}})}}const Jt="https://t.me/pikabu_publish_bot";function te(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function ee(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?te(Object(s),!0).forEach((function(e){se(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):te(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function se(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class ie{static async getToken(){try{const{response:t,data:e}=await A.cf.get("/ajax.php",{route:"settings/telegram-publish-token"});return t.result?ee(ee({},e),{},{isAssigned:e.is_assigned}):(this.showError(this.TOKEN_ERROR_MSG),{})}catch(t){this.showError(this.TOKEN_ERROR_MSG)}return{}}static async unlink(){try{const{response:t}=await A.cf.post("/ajax.php",{route:"settings/unlink-publishing-bot"});return!!t.result||(this.showError(this.UNLINK_ERROR_MSG),!1)}catch(t){this.showError(this.UNLINK_ERROR_MSG)}return!1}}se(ie,"TOKEN_ERROR_MSG","Ошибка! Не удалось получить код"),se(ie,"UNLINK_ERROR_MSG","Ошибка! Не удалось отвязать аккаунт"),se(ie,"showError",(t=>i.core.ui.toasts.showError(t)));var ne=s(33877);function ae(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function oe(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?ae(Object(s),!0).forEach((function(e){re(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ae(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function re(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}let le,ce=!1;const de=t=>{var e;const s=e=>{var s;St.c.getInstance().sendEvent("click",{type:"button_telegram_bot_copy_code"}),t.telegramTokenClipboard=e,null===(s=le)||void 0===s||s.update(oe(oe({},p()),{},{tokenClipboard:e}))},n=()=>Jt+(t.telegramToken?`?start=${t.telegramToken}`:""),a=t=>{window.open(t,"_blank").focus()},o=()=>{St.c.getInstance().sendEvent("click",{type:"button_telegram_bot_go_to_bot"}),a(n())},r=async()=>{if(ce)return;ce=!0;const{token:e,ttl:s}=await ie.getToken();ce=!1,e&&(t.telegramToken=e,t.telegramTokenTtl=s,le||(le=new Xt({telegramTokenBlockProps:p()})),le.show())},l=()=>{St.c.getInstance().sendEvent("click",{type:"button_telegram_bot_renew_code"}),r()},c=()=>{St.c.getInstance().sendEvent("click",{type:"button_telegram_bot_code_popup_close"})},u=()=>({token:t.telegramToken,tokenClipboard:t.telegramTokenClipboard,timeLeft:t.telegramTokenTtl,onTokenCopied:s,onBotOpen:o,onGetNewToken:l}),p=()=>oe(oe({},u()),{},{onClose:c});return null===(e=le)||void 0===e||e.update(p()),qt.vu.create("div",{className:"section-group settings-security-telegram"},qt.vu.create("section",{className:"section_gray"},qt.vu.create("h4",{className:"settings-security-telegram__title"},qt.vu.create(Vt.t,{block:"ui__telegram-logo_16"}),"Telegram-бот",i.core.initParams.isConfirmed&&!t.telegramLoading&&t.telegramLinked?qt.vu.create("span",{onClick:async()=>{if(!(await R.nk.confirmModal({content:"Вы действительно хотите отвязать Telegram-бота от вашего аккаунта?",buttons:[["Отвязать",d.j.SUCCESS,!0],["modal.cancel",d.j.DANGER,!1]]})))return;await ie.unlink()&&(t.telegramLinked=!1,i.core.ui.toasts.add("telegram-code",{content:"Telegram-бот отвязан от вашего аккаунта"}),await(0,ne.g)(100),window.location.reload())},className:"settings-security-telegram__unlink"},"Отвязать бота"):null)),t.telegramLoading?qt.vu.create("section",{class:"section_center"},qt.vu.create(Vt.t,{block:"ui__progress-circle"})):null,null,t.telegramLoading||t.telegramToken||t.telegramAssigned?null:qt.vu.create("section",{className:"settings-security-telegram__get-code"},i.core.initParams.isConfirmed?null:qt.vu.create("div",{className:"pkb-alert pkb-alert_red settings-security-telegram__alert"},"Чтобы воспользоваться ботом, вам нужно подтвердить аккаунт"),qt.vu.create("p",null,"Вы можете автоматизировать публикацию постов на Пикабу из вашего Telegram-канала. Для этого у нас есть специальный бот в Telegram:",qt.vu.create("a",{onClick:t=>{t.preventDefault();const e=n();St.c.getInstance().sendEvent("click_external_link",{link:e}),a(e)}}," ",Jt),". Получите код доступа и отправьте его боту, чтобы привязать аккаунт."),qt.vu.create("button",{className:"button_success ",onClick:()=>{St.c.getInstance().sendEvent("click",{type:"button_telegram_bot_receive_code"}),r()},disabled:!i.core.initParams.isConfirmed},"Получить код")),!t.telegramLoading&&t.telegramAssigned?qt.vu.create("section",null,"Telegram-бот подключён. ",qt.vu.create("br",null),"С его помощью вы можете быстро публиковать посты из вашего Telegram-канала прямо на Пикабу.",qt.vu.create("div",{className:"settings-security-telegram__btns-wrapper"},qt.vu.create("button",{className:"button_success",onClick:o},"Перейти к боту"))):null,i.core.initParams.isConfirmed&&!t.telegramLoading&&t.telegramToken&&!t.telegramAssigned?qt.vu.create("section",{className:"section_padding_none"},Gt(u())):null)},ue=s(30381);function pe(t,e){const s="page-settings.security.promo",n="security-option security-option_type_header",a="security-option security-option_type_form";let o=e===st.O5.PASSWORD,r=e===st.O5.EMAIL,l=e===st.O5.PHONE,c=e===st.O5.NICKNAME,d=t.data.isEmptyPassword,u=t.data.isEmptyPhone,p=t.data.isEmptyEmail,h=Boolean(t.data.phoneNew),_=!(d||p||u),m=u&&p&&d,g=i.core.i18n(s+".header."+(_?"strong":m?"week":"good")),f=_?"success":m?"danger":"warning";return qt.vu.create("div",{className:"settings-security"},i.core.initParams.isConfirmed?null:qt.vu.create("section",{className:"section_warning","data-role":"account-confirm"},"Ваш аккаунт ещё не подтверждён. Привяжите соцсеть или номер телефона, чтобы получить возможность публиковать посты и оставлять комментарии."),qt.vu.create("div",{className:"section-group"},qt.vu.create("section",{className:"section_gray settings-security__promo"},qt.vu.create("div",null,qt.vu.create(Vt.t,{block:"ui__shield",modifiers:"settings_security "+f}),qt.vu.create("h4",null,g)),qt.vu.create("div",null,d?qt.vu.create("div",null,qt.vu.create("a",{href:"#set-password"},i.core.i18n(s+".messages.need-password"))):null,u?qt.vu.create("div",null,qt.vu.create("a",{href:"#set-phone"},i.core.i18n(s+".messages.need-phone"))):null,p?qt.vu.create("div",null,qt.vu.create("a",{href:"#set-email"},i.core.i18n(s+".messages.need-email"))):null)),qt.vu.create("section",{className:"section_padding_none settings-security__options"},qt.vu.create("div",{className:n+(o?" security-option_hide":"")},qt.vu.create("div",{className:"security-option__field"},qt.vu.create("div",{className:"security-option__label"},"Пароль"),qt.vu.create("div",{className:"security-option__value"},!d&&t.data.passwordLastUpdate?i.core.i18n("page-settings.security.password.last-set",ue(t.data.passwordLastUpdate).fromNow()):"")),qt.vu.create("button",{className:"button_link security-option__action","data-to":"password"},i.core.i18n(d?"modal.set":"modal.change"))),qt.vu.create("hr",{style:o||l?"display: none":""}),qt.vu.create("div",{className:a+(o?"":" security-option_hide")},qt.vu.create(Zt,null)),qt.vu.create("div",{className:n+(l?" security-option_hide":"")},qt.vu.create("div",{className:"security-option__field"},qt.vu.create("div",{className:"security-option__label"},"Телефон"),qt.vu.create("div",{className:"security-option__value"},t.data.phoneNew?i.core.i18n("page-settings.security.phone.change-after",ue(t.data.phoneNewDate).fromNow(),t.data.phoneNew):t.data.phoneCurrent||null)),qt.vu.create("button",{className:"button_link security-option__action","data-to":"phone"},i.core.i18n(u?"modal.add":h?"page-settings.security.phone.cancel-phone-change":"modal.change"))),qt.vu.create("hr",{style:l||c?"display: none":""}),qt.vu.create("div",{className:a+(l?"":" security-option_hide")},qt.vu.create(zt,null)),qt.vu.create("div",{className:n+(c?" security-option_hide":"")},qt.vu.create("div",{className:"security-option__field"},qt.vu.create("div",{className:"security-option__label"},"Никнейм"),qt.vu.create("div",{className:"security-option__value"},t.data.nicknameCurrent||"")),qt.vu.create("button",{className:"button_link security-option__action","data-to":"nickname"},i.core.i18n("modal.change"))),qt.vu.create("hr",{style:c||r?"display: none":""}),qt.vu.create("div",{className:a+(c?"":" security-option_hide")},qt.vu.create(Ht,null)),qt.vu.create("div",{className:n+(r?" security-option_hide":"")},qt.vu.create("div",{className:"security-option__field"},qt.vu.create("div",{className:"security-option__label"},"Email"),qt.vu.create("div",{className:"security-option__value"},t.data.emailCurrent||"")),qt.vu.create("button",{className:"button_link security-option__action","data-to":"email"},i.core.i18n(p?"modal.add":"modal.change"))),qt.vu.create("div",{className:a+(r?"":" security-option_hide")},qt.vu.create(Wt,null))),qt.vu.create("section",{className:"section_gray section_center"},qt.vu.create("button",{type:"button",className:"button_danger","data-role":"logout"},"Выйти на всех устройствах"))),(({vk:t,fb:e,tw:s,google:n,ya:a,canDelete:o})=>qt.vu.create("div",{className:"settings-security-social section-group"},qt.vu.create("section",{className:"section_gray"},qt.vu.create("h4",null,"Вход через социальные сети")),qt.vu.create("section",{className:"section_padding_none settings-security-social__list"},qt.vu.create("div",{className:"settings-security-social__item"},qt.vu.create("div",{className:"settings-security-social__item-wrapper"},qt.vu.create("span",{className:"settings-security-social__item-icon social-icon social-icon_color","data-role":"vk"},qt.vu.create(Vt.t,{block:"social__vkid"})),qt.vu.create("div",{className:"settings-security-social__item-value"},t||"VK"),qt.vu.create("button",{className:"settings-security-social__item-button button_link","data-to":"vk"},i.core.i18n("page-settings.security.social."+(t?"unset":"set"))))),qt.vu.create("div",{className:"settings-security-social__item"},qt.vu.create("div",{className:"settings-security-social__item-wrapper"},qt.vu.create("span",{className:"settings-security-social__item-icon social-icon social-icon_color","data-role":"ya"},qt.vu.create(Vt.t,{block:"social__ya"})),qt.vu.create("div",{className:"settings-security-social__item-value"},a||"Яндекс"),qt.vu.create("button",{className:"settings-security-social__item-button button_link","data-to":"ya"},i.core.i18n("page-settings.security.social."+(a?"unset":"set")))))),qt.vu.create("section",{className:"section_gray section_center"},o&&qt.vu.create("button",{type:"button","data-role":"delete",className:"button_danger"},"Удалить аккаунт"),!o&&qt.vu.create("button",{type:"button",disabled:"true","data-role":"delete",className:"button_danger"},"Удалить аккаунт",qt.vu.create("span",{className:"hint hint_left","aria-label":"Вы недавно восстанавливали аккаунт. <br> Удаление аккаунта вам пока недоступно."})))))(t.data),de(t.data))}var he=s(62956),_e=s(57443);var me=s(32061),ge=s(79025);function fe(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class ve{constructor(){fe(this,"getTokenAttempts",3),fe(this,"swCountdownTimer",new ge.A)}static getInstance(){return ve.instance||(ve.instance=new ve)}async getToken(t){const{token:e,ttl:s,isAssigned:i=!1}=await ie.getToken();if(i)return{isAssigned:i};if(!e||!s){if(--this.getTokenAttempts>0)return await(0,ne.g)(1e3),this.getToken(t);throw new Error}return this.swCountdownTimer.start(s,t),{token:e,ttl:s,isAssigned:i}}}var be=s(79961),ye=s(55474);function we(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class ke extends m.T3{constructor(...t){super(...t),we(this,"_availableNames",[])}async checkUserAvailable(t){if(!t)return!1;const e=await o.User.isUserAvailable(t).then((e=>e.message?(e.availableUserNames&&e.availableUserNames.length>0?this._availableNames=e.availableUserNames:this._availableNames=[],!1):(this._availableNames&&!this._availableNames.includes(t)&&(this._availableNames=[]),!0)));return Boolean(e)}showAvailableUserNames(t){if(document.querySelector(".requirements-hint_names"))return;this.$els.availableNames&&this.$els.availableNames.remove();const e=y()(".security-option__available-nicknames"),s=y()(t({names:this._availableNames}));e.append(s),this.$els.availableNames=s,this.$els.availableNames.on("click",(t=>{t.target.dataset.name&&(_.cp.getInstance().sendEvent("click",{type:"reg_nick_advice"}),this.nickname.value=t.target.dataset.name,this.nickname.setCustomValidity())}))}initPhoneInput(t){return this._phoneInput=new ye.a({el:t}),this._phoneInput.init()}}const xe=s(19755),Se=s(30381),$e={validationEvent:Tt.km.MANUAL,validationHint:{direction:R.Lh.RIGHT,alignment:R.SE.CENTER}};class Ce extends ke{route(t,e){return this.ctx=t,this.isShown||this.show(),this._detectNeedFocusToOption(),e()}async _detectNeedFocusToOption(){if("security-tg-code"===this.ctx.hash){const t="settings-security-telegram__code-block",e=this.$(`.${t}`);return i.core.ui.scrollRestoration="auto",void(null!=e&&e.length&&(i.core.ui.scrollRestoration="manual",await i.core.ui.scrollTo(e.offset().top-e.height(),!0)))}if("autonickname"===this.ctx.hash)return this._initAutonickname(),void i.core.history.removeHash();if(!this.ctx.hash||0!==this.ctx.hash.indexOf("set-"))return void(this.currentOption&&(this.currentOption=void 0));let t=st.O5[this.ctx.hash.slice(4)];if(t){this.currentOption=t;try{if(this.currentOption===t&&this._forms.has(t)){let e=this._forms.get(t).form.$el;i.core.ui.elementInViewport(e)||await i.core.ui.scrollTo(e.offset().top-20,!0)}}catch(e){}}}render(){if(this.isRendered)return this;this.$parent=xe(".settings");const t=i.core.config("modules.settings.security");this._updateStateThrottle=(0,P.throttle)(this._updateState.bind(this),30),this._forms=new Map,this._options.state=new lt.Lo({isEmptyPassword:t.isEmptyPassword,isEmptyPhone:!((0,P.isString)(t.phoneCurrent)&&t.phoneCurrent.length>0),isEmptyEmail:!((0,P.isString)(t.emailCurrent)&&t.emailCurrent.length>0),passwordLastUpdate:t.passwordLastUpdate?Se(t.passwordLastUpdate):void 0,phoneCurrent:t.phoneCurrent,phoneNew:t.phoneNew,phoneNewDate:t.phoneNewDate,emailCurrent:t.emailCurrent,nicknameCurrent:i.core.config("modules.settings.main.userName"),lastChangeNicknameTimestamp:t.lastChangeNicknameTimestamp,vk:t.oauth[st.lr.VK.valueOf()],ya:t.oauth[st.lr.YA.valueOf()],telegramAssigned:!1,telegramLoading:i.core.initParams.isConfirmed,telegramToken:null,telegramTokenTtl:0,telegramTokenClipboard:"",telegramLinked:t.tgIsLinkedWithPublishingBot,canDelete:t.isProfileDeletionAllowed}),this.listenTo(this.state,lt.u$.CHANGE,this._updateStateThrottle),this._update(!0),_e.c.checkSocialAccountRemoval(),this._initPasswordForm(),this._initPhoneForm(),this._initEmailForm(),this._initCopyListener(),this._initNicknameForm(),this._getTelegramToken(),this.$('button[data-role="logout"]').click(o.User.logout.bind(this,!0)),this.$('button[data-role="delete"]').click(this._attachDeleteConfirmPopup);const e=".security-option__action, .settings-security-social__item-button, .security-option__close";return this.$el.on("click",e,this._routeToOption.bind(this)),this.$el.on("click",".security-option_type_header, .settings-security-social__item",(t=>{xe(t.target).closest("button").length||xe(t.currentTarget).find(e).trigger("click")})),super.render(),this}_update(t=!1){if(!t&&!this.isRendered)return;let e=pe(this.state,this.currentOption);this.el?this.marks.has("_vNode")?qt.zM.node(this.marks.get("_vNode"),e,"root").reduce(qt.nq.updateElement(void 0,this),this.el):L.Zv.clearEmptyTextNode(this.el):this.el=qt.wK.createElement(e,"root",void 0,this),this.marks.set("_vNode",e)}_attachDeleteConfirmPopup(){_e.c.showRemoveAccountPopup()}_updateState(t){if(this._update(!0),t&&t.plainData.telegramToken!==this.state.data.telegramToken&&ve.getInstance().startTtlCountdown((t=>{this.state.data.telegramTokenTtl=t})),!this.currentOption||!this._forms.has(this.currentOption))return;const e=this._forms.get(this.currentOption);if(this.form!==e)switch(this.form=e,this.form.form.reset(),this.currentOption){case st.O5.PASSWORD:this._showPasswordForm(this.form);break;case st.O5.PHONE:this._showPhoneForm(this.form);break;case st.O5.NICKNAME:this._showNicknameForm(this.form);break;case st.O5.EMAIL:this._showEmailForm(this.form)}}_showPasswordForm(t){const e=this.state.data.isEmptyPassword;t.$current.toggle(!e),e?(t.passwordNew.focus(),t.submit.title=i.core.i18n("page-settings.security.password.set")):(t.passwordCurrent.focus(),t.submit.title=i.core.i18n("page-settings.security.password.change")),t.$passwordComplexity.dataset.type="",St.c.getInstance().sendEvent("click",{component_name:"settings",type:"password",button:e?"add":"edit"})}_showPhoneForm(t){const e=this.state.data.isEmptyPhone,s=Boolean(this.state.data.phoneNew);s?t.passwordCurrent.focus():this._phoneInput.initRusMaskAndFocus(),t.$phone.toggle(!s),t.$password.toggle(!e),t.$current.toggle(!e&&!s).find(".security-option__value").text(this.state.data.phoneCurrent||""),e&&t.$current.parent().remove(),t.submit.title=i.core.i18n("page-settings.security.phone."+(e?"set":s?"cancel-phone-change-button":"change")),St.c.getInstance().sendEvent("click",{component_name:"settings",type:"phone",button:e?"add":"edit"})}_showNicknameForm(t){if(this._isNicknameChangeRecently()){this._disableNicknameForm(t),t.$current.find(".security-option__value").text(this.state.data.nicknameCurrent);t.form.el.querySelector(".security-option__warning").removeAttribute("hidden");t.form.el.querySelectorAll(".input__box").forEach((t=>t.classList.add("input_disabled")))}else t.nickname.focus(),t.$current.toggle(!0).find(".security-option__value").text(this.state.data.nicknameCurrent),t.submit.title=i.core.i18n("page-settings.security.nickname.change"),St.c.getInstance().sendEvent("click",{component_name:"settings",type:"nickname",button:"edit"})}_showEmailForm(t){let e=this.state.data.isEmptyEmail;t.email.focus(),t.$current.toggle(!e).find(".security-option__value").text(this.state.data.emailCurrent||""),t.submit.title=i.core.i18n("page-settings.security.email."+(e?"set":"change")),St.c.getInstance().sendEvent("click",{component_name:"settings",type:"email",button:e?"add":"edit"})}_isNicknameChangeRecently(){return Date.now()-(this.state.data.lastChangeNicknameTimestamp||0)<15552e6}_disableNicknameForm(t){t.nickname.disabled=!0,t.passwordCurrent.disabled=!0,t.submit.title=i.core.i18n("page-settings.security.nickname.change"),t.submit.disabled=!0}async _routeToOption(t){const e=xe(t.currentTarget).closest("button"),s=String(e.data("to"));if("cancel"===s)t.preventDefault(),this.currentOption=void 0;else if(st.O5[s])this.currentOption=st.O5[s];else if(st.lr[s.toUpperCase()]){const t=st.lr[s.toUpperCase()],e=t.valueOf().toLowerCase(),n=this.state.data[e];if(!Boolean(n)){const{result:t,message:n,accounts:a}=await(new he.Sq).link(e);return t?(this._showAccountConfirmationMessage=!1,St.c.getInstance().sendEvent("approve_account",{component_name:"settings",type:(0,he.Lq)(s)}),void Object.entries(a).forEach((([t,e])=>{t in this.state.data&&(this.state.data[t]=e)}))):void i.core.ui.toasts.add("oauth-error",{theme:Q.K.DANGER,closeAfter:5e3,content:n})}if(this.state.data.isEmptyPassword)return void this._needPasswordToast("social");await a.g.confirmModal({header:i.core.i18n("page-settings.security.social.deactive.header"),content:`\n\t\t\t\t\t<div class="security-option_popup">\n\t\t\t\t\t\t<span class="social-icon social-icon_color" data-type="${t.name.toLowerCase()}">\n\t\t\t\t\t\t${i.core.icon("social__"+t.name.toLowerCase())}\n\t\t\t\t\t\t</span> ${n}\n\t\t\t\t\t</div>\n\t\t\t\t`,buttons:[["page-settings.security.social.deactive.button",d.j.DANGER,!0],["modal.cancel"]]})&&await o.User.removeOAuth(t)&&(this._showAccountConfirmationMessage=!0,this.state.data[t.toString().toLowerCase()]=!1)}}_lockForm(t,e){if(!this._forms.has(t))return this;let s=this._forms.get(t);return(e=e||0)>1e3?(s.submit.disabled=!0,s.$tryHint.show(),s.$tryHint.text(i.core.i18n("page-settings.security.try",Se(e).format("mm:ss"))),this.interval("lock-"+t,1e3,(()=>{(e-=1e3)>0?s.$tryHint.text(i.core.i18n("page-settings.security.try",Se(e).format("mm:ss"))):this._lockForm(t,0)}))):(s.submit.disabled=!1,s.$tryHint.hide(),this.cancelInterval("lock-"+t)),this}_initPasswordForm(){let t=this.$('form[name="password"]');if(!t.length)return;let e=new at.x(t);this.listenTo(e,"submit",this._onSubmitPassword);let s=new Ft.y3({$el:t.find('button[type="submit"]'),animationName:"signup"}),i=new Tt.u3({$el:t.find('input[name="password_current"]').closest(".input")});i.setOptions($e),e.add(i);let n=t.find(".input__complexity").get(0),a=new Tt.u3({$el:t.find('input[name="password_new"]').closest(".input"),validationRules:{"page-settings.security.password.identical":t=>!!this.state.data.isEmptyPassword||t!==i.value,"auth.up.errors.password-short":Tt.cX.isLength(4),"auth.up.errors.password-week":()=>r.PasswordStrength.test(a.value)>r.PASSWORD_STRENGTH.WEEK}});a.setOptions($e),this.listenTo(a,"input",(0,P.throttle)((()=>n.dataset.type=r.PasswordStrength.test(a.value).toString().toLowerCase()),200)),e.add(a);let o=new Tt.u3({$el:t.find('input[name="password_confirm"]').closest(".input"),validationRules:{"page-settings.security.password.not-identical":t=>a.value===t}});o.setOptions($e),e.add(o),this._forms.set(st.O5.PASSWORD,{form:e,submit:s,passwordCurrent:i,passwordNew:a,passwordConfirm:o,$passwordComplexity:n,$current:t.find('input[name="password_current"]').closest(".security-option__field"),$tryHint:t.find(".security-option__value-hint")})}async _onSubmitPassword(t,e){t&&(0,P.isFunction)(t.preventDefault)&&t.preventDefault();let s=this._forms.get(st.O5.PASSWORD);if(s.submit.disabled||s.submit.animation||!(await e.checkValidity()))return;s.submit.animation=!0;let n=e.serialize(),l=this.state.data.isEmptyPassword,c=Date.now();try{let t=await o.User.changePassword(n.password_new,n.password_current),d=!0===t;if(await r.Utils.delay(1e3-(Date.now()-c)),!d){let e=3;d=await a.g.confirmSMS({header:"Введите код из SMS сообщения",id:t,callback:async s=>e-- >0&&await o.User.changePasswordConfirm(t,s)})}d?(this.state.data.passwordLastUpdate=new Date,this.state.data.isEmptyPassword=!1,this.currentOption=void 0,i.core.ui.toasts.add({content:i.core.i18n("page-settings.security.password.good-"+(l?"set":"change"))}),e.reset(),this._submitPasswordCallback&&this._submitPasswordCallback()):this._lockForm(st.O5.PASSWORD,o.SETTINGS_TIMEOUTE-(Date.now()-c)),s.submit.animation=!1}catch(d){switch(await r.Utils.delay(1e3-(Date.now()-c)),d.param){case"password_current":s.passwordCurrent.setCustomValidity(d.message);break;case"password_new":s.passwordNew.setCustomValidity(d.message);break;case"password_confirm":s.passwordConfirm.setCustomValidity(d.message);break;default:i.core.ui.toasts.showError(d.message||i.core.i18n("page-settings.save.password-bad"))}s.submit.animation=!1}}async _initPhoneForm(){const t=this.$('form[name="phone"]');if(!t.length)return;const e=new at.x(t);this.listenTo(e,"submit",this._onSubmitPhone);const s=new Ft.y3({$el:t.find('button[type="submit"]'),animationName:"signup"});await this.initPhoneInput(t.find('input[name="phone"]').get(0));const i=this._phoneInput.input;e.add(i);let n=new Tt.u3({$el:t.find('input[name="password"]').closest(".input")});n.setOptions($e),e.add(n),this._forms.set(st.O5.PHONE,{form:e,submit:s,phone:i,passwordCurrent:n,$phone:i.$el.closest(".security-option__field"),$current:t.find(".security-option__field:first"),$password:t.find('input[name="password"]').closest(".security-option__field"),$tryHint:t.find(".security-option__value-hint")})}async _onSubmitPhone(t,e){t&&(0,P.isFunction)(t.preventDefault)&&t.preventDefault();let s=this._forms.get(st.O5.PHONE);if(s.submit.disabled||s.submit.animation||!(await e.checkValidity()))return;let n=this.state.data.isEmptyPhone,l=Boolean(this.state.data.phoneNew),c=s.passwordCurrent.value,d=this._phoneInput.value;s.submit.animation=!0;let u=Date.now();try{let t;t=l?await o.User.cancelChangePhone(c):n?await o.User.addPhone(d):await o.User.changePhone(d,c),await r.Utils.delay(1e3-(Date.now()-u));let p=3;await a.g.confirmSMS({header:"Введите код из SMS сообщения",id:t,callback:async e=>p-- >0&&(l?await o.User.cancelChangePhoneConfirm(t,e):n?await o.User.addPhoneConfirm(t,e):await o.User.changePhoneConfirm(t,e))})?(this.state.data.isEmptyPhone=!1,l?(this.state.data.phoneNew=void 0,this.state.data.phoneNewDate=void 0):n?this.state.data.phoneCurrent=r.Utils.maskPhone(d):(this.state.data.phoneNew=r.Utils.maskPhone(d),this.state.data.phoneNewDate=Se().add(1,"days").toDate()),this.currentOption=void 0,this.form=void 0,i.core.ui.toasts.add({content:i.core.i18n("page-settings.security.phone.good-"+(n?"set":l?"change-cancel":"change"))}),e.reset(),this._showAccountConfirmationMessage=!1):this._lockForm(st.O5.PHONE,o.SETTINGS_TIMEOUTE-(Date.now()-u)),s.submit.animation=!1}catch(p){switch(await r.Utils.delay(1e3-(Date.now()-u)),p.param){case"password":s.passwordCurrent.setCustomValidity(p.message);break;case"phone":case"new_phone":s.phone.setCustomValidity(p.message);break;default:i.core.ui.toasts.showError(p.message||i.core.i18n("page-settings.save.password-bad"))}s.submit.animation=!1}}_initEmailForm(){let t=this.$('form[name="email"]');if(!t.length)return;let e=new at.x(t);this.listenTo(e,"submit",this._onSubmitEmail);let s=new Ft.y3({$el:t.find('button[type="submit"]'),animationName:"signup"}),i=new Tt.u3({$el:t.find('input[name="email"]').closest(".input")});i.setOptions($e),e.add(i);let n=new Tt.u3({$el:t.find('input[name="password"]').closest(".input")});n.setOptions($e),e.add(n),this._forms.set(st.O5.EMAIL,{form:e,submit:s,email:i,passwordCurrent:n,$current:t.find(".security-option__field:first"),$password:t.find('input[name="password"]').closest(".security-option__field"),$tryHint:t.find(".security-option__value-hint")})}_initNicknameForm(){const t=this.$('form[name="nickname"]');if(!t.length)return;const e=new at.x(t);this.listenTo(e,"submit",this._onSubmitNickname);const s=new Ft.y3({$el:t.find('button[type="submit"]'),animationName:"signup"});this.nickname=new Tt.u3({$el:t.find('input[name="nickname"]').closest(".input"),sanitizerRules:[Tt.op.trim(),Tt.op.clearHTMLTags(),Tt.op.clearURLs(),Tt.op.escape()],validationRules:{"validation-rules.required":Tt.cX.required(),"auth.up.errors.username-short":Tt.cX.isLength(4),"auth.up.errors.username-long":[Tt.cX.isLength(0,16)],"auth.up.errors.username-whitelist":Tt.cX.patternMatch(/^([A-Za-z0-9.]*)$/),"auth.up.errors.username-last-dot":Tt.cX.patternMatch(/[^.]$/),"auth.up.errors.username-first-dot":Tt.cX.patternMatch(/^[^.]/),"auth.up.errors.username-many-dot":t=>(t.match(/\./g)||[]).length<2,"auth.up.errors.username-busy":async t=>{const e=await this.checkUserAvailable(t);return!e&&this._availableNames&&Array.isArray(this._availableNames)&&this._availableNames.length>0?(this.showAvailableUserNames(be.Z),!1):(this._availableNames&&0===this._availableNames.length&&this.$els.availableNames&&this.$els.availableNames.remove(),e)}},onValidityErrorMessage:(t,{input:e})=>{this._sendOnValidationErrorAnalytics(t,{input:e})}}),this.nickname.setOptions($e),e.add(this.nickname);const i=new Tt.u3({$el:t.find('input[name="password"]').closest(".input")});i.setOptions($e),e.add(i),this._forms.set(st.O5.NICKNAME,{form:e,submit:s,nickname:this.nickname,passwordCurrent:i,$nickname:this.nickname.$el.closest(".security-option__field"),$current:t.find(".security-option__field:first"),$password:t.find('input[name="password"]').closest(".security-option__field"),$tryHint:t.find(".security-option__value-hint")})}async _onSubmitNickname(t,e){t.preventDefault();let s=this._forms.get(st.O5.NICKNAME);if(s.submit.disabled||s.submit.animation)return;const n=this.state.data.nicknameCurrent,a=s.nickname.value,l=t=>{St.c.getInstance().sendEvent("click",{button:"change_nickname",login:a,status:t})};if(!(await e.checkValidity()))return void l(0);l(1);const c=s.passwordCurrent.value,d=Date.now();s.submit.animation=!0;try{let t=await o.User.changeNickname(a,c);await r.Utils.delay(1e3-(Date.now()-d)),t?(o.User.sendSettingsChangeAnalytics("nickname",n,a),this._changeNicknameOnPage(a),this.currentOption=void 0,i.core.ui.toasts.add({content:i.core.i18n("page-settings.security.nickname.good-change")}),e.reset()):this._lockForm(st.O5.NICKNAME,o.SETTINGS_TIMEOUTE-(Date.now()-d)),s.submit.animation=!1}catch(u){switch(await r.Utils.delay(1e3-(Date.now()-d)),u.param){case"password":s.passwordCurrent.setCustomValidity(u.message);break;case"nickname":s.nickname.setCustomValidity(u.message);break;default:i.core.ui.toasts.showError(u.message||i.core.i18n("page-settings.save.password-bad"))}s.submit.animation=!1}}_changeNicknameOnPage(t){this.state.data.nicknameCurrent=t;const e=document.querySelector("a.user__nick");e.textContent=t,e.setAttribute("title",t),e.setAttribute("href",i.core.history.location.origin+"/@"+t)}async _onSubmitEmail(t,e){t&&(0,P.isFunction)(t.preventDefault)&&t.preventDefault();let s=this._forms.get(st.O5.EMAIL);if(s.submit.disabled||s.submit.animation||!(await e.checkValidity()))return;let n=this.state.data.isEmptyEmail,a=s.passwordCurrent.value,l=s.email.value,c=Date.now();s.submit.animation=!0;try{let t=await o.User.changeEmail(l,a);await r.Utils.delay(1e3-(Date.now()-c)),t?(this.state.data.emailCurrent=r.Utils.maskEmail(l),this.state.data.isEmptyEmail=!1,this.currentOption=void 0,i.core.ui.toasts.add({content:i.core.i18n("page-settings.security.email.good-"+(n?"set":"change"))}),e.reset()):this._lockForm(st.O5.EMAIL,o.SETTINGS_TIMEOUTE-(Date.now()-c)),s.submit.animation=!1}catch(d){switch(await r.Utils.delay(1e3-(Date.now()-c)),d.param){case"password":s.passwordCurrent.setCustomValidity(d.message);break;case"email":s.email.setCustomValidity(d.message);break;default:i.core.ui.toasts.showError(d.message||i.core.i18n("page-settings.save.password-bad"))}s.submit.animation=!1}}_needPasswordToast(t){i.core.ui.toasts.add("need-password-"+t,{content:`page-settings.security.${t}.need-password`,theme:Q.K.DANGER}).$el.find("a").off(".message").click("click.message",(t=>rt.u1.closestUIElement(t.target).hide()))}_initCopyListener(){document.addEventListener("copy",(t=>{t.preventDefault(),this.state.data.telegramTokenClipboard=document.getSelection().toString(),this._update(!0)}))}_sendOnValidationErrorAnalytics(t,{input:e}){const s=t.match(/^.+\.(.+?)(?:\(.*)?$/i),i="nickname"===e.attr("name")?"username":e.attr("name"),n=s&&s[1]?s[1]:t,a=me.T[i][n]||"unknown_error";St.c.getInstance().sendEvent("error_occurred",{type:a})}async _getTelegramToken(){if(i.core.initParams.isConfirmed)try{const{token:t,ttl:e,isAssigned:s}=await ve.getInstance().getToken((t=>{this.state.data.telegramTokenTtl=t}));this.state.data.telegramToken=t,this.state.data.telegramTokenTtl=e,this.state.data.telegramAssigned=s}finally{this.state.data.telegramLoading=!1}}async _initAutonickname(){this.currentOption=st.O5.PASSWORD,this._submitPasswordCallback=()=>this.currentOption=st.O5.NICKNAME;if(!(await(0,_t.aM)({target:this.el.querySelector('input[name="password_new"]'),text:"Чтобы изменить никнейм в поле ниже, сначала задайте пароль.",direction:R.Lh.RIGHT,alignment:R.SE.CENTER,theme:R.xb.GREEN,hideByScroll:!1,autoCloseOutsideClick:!1})))return!1}get state(){return this._options.state}get currentOption(){return this._options.currentOption}set currentOption(t){t=st.O5[t];let e=this._options.currentOption,s=(t||"").toString().toLowerCase();t!==e&&(!this.state.data.isEmptyPassword||(t!==st.O5.PHONE||this.state.data.isEmptyPhone)&&t!==st.O5.EMAIL&&t!==st.O5.NICKNAME?(this._options.currentOption=t,this.isRendered&&this._updateStateThrottle()):this._needPasswordToast(s))}set _showAccountConfirmationMessage(t){setTimeout((()=>{document.querySelectorAll('[data-role="account-confirm"]').forEach((e=>e.hidden=!t))}),1)}}var Te=s(92948);class Ee extends m.T3{_initAnalytics(){this.$el.find(".user").on("click auxclick",(t=>{0!==t.button&&1!==t.button||St.c.getInstance().sendEvent("transition_to_author",{type:"from_notes",author_id:(0,Te.$)(t.currentTarget)})}))}}const Ie=s(19755);const Oe=s(19755);class Ue extends m.GR{constructor(t){super(t),this.use({"/settings/:page(security|notifications|interests)?":this,"/settings":xt,"/settings/security":Ce,"/settings/notifications":Me})}onMatch(t,e){var s;document.title={main:"Настройки",security:"Безопасность",notifications:"Настройки уведомлений",interests:"Интересы"}[t.params.page||"main"],super.onMatch(t,e),this.showSpinner(null==e?void 0:e.keepSpinner),St.c.getInstance().sendEvent("settings_tab_opened",{type:null!==(s=t.params.page)&&void 0!==s?s:"main"})}render(){return this.isRendered||(this.$el=Oe(".settings"),this.$els.spinner=this.$('div[data-role="spinner"]'),i.core.ui.screen=G.dt.USER_SETTINGS,super.render()),this}showSpinner(t){this.$els.spinner.toggle(Boolean(t))}}var De=s(36005);const Ae=s(19755);class Me extends nt{route(t,e){return this.ctx=t,this.isShown||this.show(),this._detectNeedFocusToOption("notification-option__wrapper"),e()}render(){super.render();const t=i.default.config("modules.settings.notifications");return this.$el=Ae(function(t){var e="",s=De.escape;return e+'<div class="settings-notifications">\n\t\x3c!-- Аккаунт --\x3e\n\t<form class="settings-notifications__form" name="notification" method="POST" action="javascript:void 0;" autocomplete="off" novalidate>\n\t\t<div class="section-group">\n\t\t\t<section class="section section_gray">\n\t\t\t\t<h4>Аккаунт</h4>\n\t\t\t</section>\n\t\t\t<section class="section_padding_none settings-notifications__options">\n\t\t\t\t<div class="notification-option__wrapper" data-role="moderator_user_action">\n\t\t\t\t\t<div class="notification-option">\n\t\t\t\t\t\t<div class="notification-option__label">Модерация и поддержка</div>\n\t\t\t\t\t\t<div class="notification-option__action" data-option="moderator_user_action" data-disabled="bell">\n\t\t\t\t\t\t\t<input type="hidden" name="moderator_user_action" value="'+s(JSON.stringify(t.moderator_user_action))+'"/>\n\t\t\t\t\t\t\t<span class="notification-option__text">Включены</span>\n\t\t\t\t\t\t\t<span class="notification-option__arrow"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-down icon--ui__arrow-down_settings"><use xlink:href="#icon--ui__arrow-down"></use></svg></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t</div>\n\n\t\t\x3c!-- Посты --\x3e\n\t\t<div class="section-group">\n\t\t\t<section class="section section_gray">\n\t\t\t\t<h4>Посты</h4>\n\t\t\t</section>\n\t\t\t<section class="section_padding_none settings-notifications__options">\n\t\t\t\t<div class="notification-option__wrapper" data-role="moderator_story_action">\n\t\t\t\t\t<div class="notification-option">\n\t\t\t\t\t\t<div class="notification-option__label">Модерация и поддержка</div>\n\t\t\t\t\t\t<div class="notification-option__action" data-option="moderator_story_action" data-disabled="bell">\n\t\t\t\t\t\t\t<input type="hidden" name="moderator_story_action" value="'+s(JSON.stringify(t.moderator_story_action))+'"/>\n\t\t\t\t\t\t\t<span class="notification-option__text">Включены</span>\n\t\t\t\t\t\t\t<span class="notification-option__arrow"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-down icon--ui__arrow-down_settings"><use xlink:href="#icon--ui__arrow-down"></use></svg></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="notification-option__wrapper" data-role="community_story_reject">\n\t\t\t\t\t<div class="notification-option">\n\t\t\t\t\t\t<div class="notification-option__label">Отклонение поста <br>с премодерации в сообществе</div>\n\t\t\t\t\t\t<div class="notification-option__action" data-option="community_story_reject" data-disabled="bell">\n\t\t\t\t\t\t\t<input type="hidden" name="community_story_reject" value="'+s(JSON.stringify(t.community_story_reject))+'">\n\t\t\t\t\t\t\t<span class="notification-option__text">Включены</span>\n\t\t\t\t\t\t\t<span class="notification-option__arrow"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-down icon--ui__arrow-down_settings"><use xlink:href="#icon--ui__arrow-down"></use></svg></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="notification-option__wrapper" data-role="interesting_stories">\n\t\t\t\t\t<div class="notification-option">\n\t\t\t\t\t\t<div class="notification-option__label">Интересные посты</div>\n\t\t\t\t\t\t<div class="notification-option__action" data-option="interesting_stories">\n\t\t\t\t\t\t\t<input type="hidden" name="interesting_stories" value="'+s(JSON.stringify(t.interesting_stories))+'">\n\t\t\t\t\t\t\t<span class="notification-option__text">Включены</span>\n\t\t\t\t\t\t\t<span class="notification-option__arrow"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-down icon--ui__arrow-down_settings"><use xlink:href="#icon--ui__arrow-down"></use></svg></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="notification-option__wrapper" data-role="community_story_move">\n\t\t\t\t\t<div class="notification-option">\n\t\t\t\t\t\t<div class="notification-option__label">Перемещение поста в сообщество</div>\n\t\t\t\t\t\t<div class="notification-option__action" data-option="community_story_move">\n\t\t\t\t\t\t\t<input type="hidden" name="community_story_move" value="'+s(JSON.stringify(t.community_story_move))+'">\n\t\t\t\t\t\t\t<span class="notification-option__text">Включены</span>\n\t\t\t\t\t\t\t<span class="notification-option__arrow"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-down icon--ui__arrow-down_settings"><use xlink:href="#icon--ui__arrow-down"></use></svg></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="notification-option__wrapper" data-role="story_in_hot">\n\t\t\t\t\t<div class="notification-option">\n\t\t\t\t\t\t<div class="notification-option__label">Выход поста в горячее</div>\n\t\t\t\t\t\t<div class="notification-option__action" data-option="story_in_hot">\n\t\t\t\t\t\t\t<input type="hidden" name="story_in_hot" value="'+s(JSON.stringify(t.story_in_hot))+'">\n\t\t\t\t\t\t\t<span class="notification-option__text">Включены</span>\n\t\t\t\t\t\t\t<span class="notification-option__arrow"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-down icon--ui__arrow-down_settings"><use xlink:href="#icon--ui__arrow-down"></use></svg></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="notification-option__wrapper" data-role="story_social_publish">\n\t\t\t\t\t<div class="notification-option">\n\t\t\t\t\t\t<div class="notification-option__label">Публикация поста в соцсетях Пикабу</div>\n\t\t\t\t\t\t<div class="notification-option__action" data-option="story_social_publish">\n\t\t\t\t\t\t\t<input type="hidden" name="story_social_publish" value="'+s(JSON.stringify(t.story_social_publish))+'">\n\t\t\t\t\t\t\t<span class="notification-option__text">Включены</span>\n\t\t\t\t\t\t\t<span class="notification-option__arrow"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-down icon--ui__arrow-down_settings"><use xlink:href="#icon--ui__arrow-down"></use></svg></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t</div>\n\n\t\t\x3c!-- Комментарии --\x3e\n\t\t<div class="section-group">\n\t\t\t<section class="section section_gray">\n\t\t\t\t<h4>Комментарии</h4>\n\t\t\t</section>\n\t\t\t<section class="section_padding_none settings-notifications__options">\n\t\t\t\t<div class="notification-option__wrapper" data-role="story_reply">\n\t\t\t\t\t<div class="notification-option">\n\t\t\t\t\t\t<div class="notification-option__label">Ответы на посты</div>\n\t\t\t\t\t\t<div class="notification-option__action" data-option="story_reply">\n\t\t\t\t\t\t\t<input type="hidden" name="comment_incoming" value="'+s(JSON.stringify(t.story_reply))+'">\n\t\t\t\t\t\t\t<span class="notification-option__text">Включены</span>\n\t\t\t\t\t\t\t<span class="notification-option__arrow"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-down icon--ui__arrow-down_settings"><use xlink:href="#icon--ui__arrow-down"></use></svg></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="notification-option__wrapper" data-role="comment_incoming">\n\t\t\t\t\t<div class="notification-option">\n\t\t\t\t\t\t<div class="notification-option__label">Ответы на комментарии</div>\n\t\t\t\t\t\t<div class="notification-option__action" data-option="comment_incoming">\n\t\t\t\t\t\t\t<input type="hidden" name="comment_incoming" value="'+s(JSON.stringify(t.comment_incoming))+'">\n\t\t\t\t\t\t\t<span class="notification-option__text">Включены</span>\n\t\t\t\t\t\t\t<span class="notification-option__arrow"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-down icon--ui__arrow-down_settings"><use xlink:href="#icon--ui__arrow-down"></use></svg></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="notification-option__wrapper" data-role="comment_mention">\n\t\t\t\t\t<div class="notification-option">\n\t\t\t\t\t\t<div class="notification-option__label">Упоминания вас</div>\n\t\t\t\t\t\t<div class="notification-option__action" data-option="comment_mention">\n\t\t\t\t\t\t\t<input type="hidden" name="comment_mention" value="'+s(JSON.stringify(t.comment_mention))+'">\n\t\t\t\t\t\t\t<span class="notification-option__text">Включены</span>\n\t\t\t\t\t\t\t<span class="notification-option__arrow"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-down icon--ui__arrow-down_settings"><use xlink:href="#icon--ui__arrow-down"></use></svg></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t</div>\n\n\t\t\x3c!-- Донаты --\x3e\n\t\t<div class="section-group">\n\t\t\t<section class="section section_gray">\n\t\t\t\t<h4>Донаты</h4>\n\t\t\t</section>\n\t\t\t<section class="section_padding_none settings-notifications__options">\n\t\t\t\t<div class="notification-option__wrapper" data-role="new_donation">\n\t\t\t\t\t<div class="notification-option">\n\t\t\t\t\t\t<div class="notification-option__label">Новые донаты</div>\n\t\t\t\t\t\t<div class="notification-option__action" data-option="new_donation">\n\t\t\t\t\t\t\t<input type="hidden" name="new_donation" value="'+s(JSON.stringify(t.new_donation))+'">\n\t\t\t\t\t\t\t<span class="notification-option__text">Включены</span>\n\t\t\t\t\t\t\t<span class="notification-option__arrow"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-down icon--ui__arrow-down_settings"><use xlink:href="#icon--ui__arrow-down"></use></svg></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="notification-option__wrapper" data-role="donation_technical">\n\t\t\t\t\t<div class="notification-option">\n\t\t\t\t\t\t<div class="notification-option__label">Служебная информация</div>\n\t\t\t\t\t\t<div class="notification-option__action" data-option="donation_technical" data-disabled="bell">\n\t\t\t\t\t\t\t<input type="hidden" name="donation_technical" value="'+s(JSON.stringify(t.donation_technical))+'">\n\t\t\t\t\t\t\t<span class="notification-option__text">Включены</span>\n\t\t\t\t\t\t\t<span class="notification-option__arrow"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-down icon--ui__arrow-down_settings"><use xlink:href="#icon--ui__arrow-down"></use></svg></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t</div>\n\n\t\t\x3c!-- Теги --\x3e\n\t\t<div class="section-group">\n\t\t\t<section class="section section_gray">\n\t\t\t\t<h4>Теги</h4>\n\t\t\t</section>\n\t\t\t<section class="section_padding_none settings-notifications__options">\n\t\t\t\t<div class="notification-option__wrapper" data-role="tag_edit">\n\t\t\t\t\t<div class="notification-option">\n\t\t\t\t\t\t<div class="notification-option__label">Редактирование тегов</div>\n\t\t\t\t\t\t<div class="notification-option__action" data-option="tag_edit">\n\t\t\t\t\t\t\t<input type="hidden" name="tag_edit" value="'+s(JSON.stringify(t.tag_edit))+'">\n\t\t\t\t\t\t\t<span class="notification-option__text">Включены</span>\n\t\t\t\t\t\t\t<span class="notification-option__arrow"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-down icon--ui__arrow-down_settings"><use xlink:href="#icon--ui__arrow-down"></use></svg></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t</div>\n\n\t\t\x3c!-- Сообщества --\x3e\n\t\t<div class="section-group">\n\t\t\t<section class="section section_gray">\n\t\t\t\t<h4>Сообщества</h4>\n\t\t\t</section>\n\t\t\t<section class="section_padding_none settings-notifications__options">\n\t\t\t\t<div class="notification-option__wrapper" data-role="community_manage">\n\t\t\t\t\t<div class="notification-option">\n\t\t\t\t\t\t<div class="notification-option__label">Управление сообществами</div>\n\t\t\t\t\t\t<div class="notification-option__action" data-option="community_manage" data-disabled="bell">\n\t\t\t\t\t\t\t<input type="hidden" name="community_manage" value="'+s(JSON.stringify(t.community_manage))+'">\n\t\t\t\t\t\t\t<span class="notification-option__text">Включены</span>\n\t\t\t\t\t\t\t<span class="notification-option__arrow"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-down icon--ui__arrow-down_settings"><use xlink:href="#icon--ui__arrow-down"></use></svg></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="notification-option__wrapper" data-role="interesting_communities">\n\t\t\t\t\t<div class="notification-option">\n\t\t\t\t\t\t<div class="notification-option__label">Интересные сообщества</div>\n\t\t\t\t\t\t<div class="notification-option__action" data-option="interesting_communities">\n\t\t\t\t\t\t\t<input type="hidden" name="interesting_communities" value="'+s(JSON.stringify(t.interesting_communities))+'">\n\t\t\t\t\t\t\t<span class="notification-option__text">Включены</span>\n\t\t\t\t\t\t\t<span class="notification-option__arrow"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-down icon--ui__arrow-down_settings"><use xlink:href="#icon--ui__arrow-down"></use></svg></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t</div>\n\n\t\t\x3c!-- Другое --\x3e\n\t\t<div class="section-group">\n\t\t\t<section class="section section_gray">\n\t\t\t\t<h4>Другое</h4>\n\t\t\t</section>\n\t\t\t<section class="section_padding_none settings-notifications__options">\n\t\t\t\t<div class="notification-option__wrapper" data-role="pikabu_news">\n\t\t\t\t\t<div class="notification-option">\n\t\t\t\t\t\t<div class="notification-option__label">Новости Пикабу</div>\n\t\t\t\t\t\t<div class="notification-option__action" data-option="pikabu_news" data-disabled="bell">\n\t\t\t\t\t\t\t<input type="hidden" name="pikabu_news" value="'+s(JSON.stringify(t.pikabu_news))+'">\n\t\t\t\t\t\t\t<span class="notification-option__text">Включены</span>\n\t\t\t\t\t\t\t<span class="notification-option__arrow"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-down icon--ui__arrow-down_settings"><use xlink:href="#icon--ui__arrow-down"></use></svg></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="notification-option__wrapper" data-role="interesting_events">\n\t\t\t\t\t<div class="notification-option">\n\t\t\t\t\t\t<div class="notification-option__label">Интересные события на Пикабу</div>\n\t\t\t\t\t\t<div class="notification-option__action" data-option="interesting_events">\n\t\t\t\t\t\t\t<input type="hidden" name="interesting_events" value="'+s(JSON.stringify(t.interesting_events))+'">\n\t\t\t\t\t\t\t<span class="notification-option__text">Включены</span>\n\t\t\t\t\t\t\t<span class="notification-option__arrow"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-down icon--ui__arrow-down_settings"><use xlink:href="#icon--ui__arrow-down"></use></svg></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="notification-option__wrapper" data-role="achievements">\n\t\t\t\t\t<div class="notification-option">\n\t\t\t\t\t\t<div class="notification-option__label">Достижения</div>\n\t\t\t\t\t\t<div class="notification-option__action" data-option="achievements">\n\t\t\t\t\t\t\t<input type="hidden" name="achievements" value="'+s(JSON.stringify(t.achievements))+'">\n\t\t\t\t\t\t\t<span class="notification-option__text">Включены</span>\n\t\t\t\t\t\t\t<span class="notification-option__arrow"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-down icon--ui__arrow-down_settings"><use xlink:href="#icon--ui__arrow-down"></use></svg></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t</div>\n\t</form>\n</div>'}(t)),this._actions=new Map,this._defaultValues={},this.$els={options:this.$(".notification-option__action")},this.$els.options.each(((t,e)=>{let s=Ae(e),i=s.data("option"),n=s.find("input"),a=s.find(".notification-option__text");n.length&&a.length&&this._actions.set(i,{input:n,title:a}),s.on("click",(()=>this._initOptionPopup(s)))})),this._settings=new lt.Lo(this._currentFormOptions),this._settings.save("saved"),this._actions.forEach(((t,e)=>{this._changeOptionTitle(e),this._defaultValues[e]={bell:!0,push:!0}})),this}get _currentFormOptions(){return(0,P.defaults)(this._serializeForm(),this._defaultValues)}_serializeForm(){let t={};return this._actions.forEach(((e,s)=>t[s]=JSON.parse(e.input.val()))),t}async _saveSettings(){if(this._isSaved)return void(this.state=st.eT.GOOD);await o.User.saveSettings({action:"save_notification_settings",payload:JSON.stringify(this._settings.plainData)})?(this.state=st.eT.GOOD,this._settings.save("saved")):this.state=st.eT.BAD}_changeOptionTitle(t){let e=this._settings.plainData[t],s=this._actions.get(t).title;if(new Set(Object.values(e)).size<=1)return void s.text(i.default.i18n("page-settings.notifications.flags."+(Object.values(e)[0]?"on":"off")));let n=Object.entries(e).filter((t=>!0===t[1])).map((t=>i.default.i18n(`page-settings.notifications.flags.${t[0]}`)));s.text(n.join(","))}_initOptionPopup(t){let e=t.data("option"),s=t.data("disabled"),i=this._settings.plainData[e]||[],n=this.marks.get(`${e}-popup`);n||(n=a.g.popupCheckboxes({target:t,enumEntries:st.VC,localePrefix:"page-settings.notifications.flags.",currentValues:i,disabledOptions:s}),this.listenTo(n,"change",(async(t,s)=>{this._actions.get(e).input.val(JSON.stringify(s)),this._onChangeGeneral(),this._changeOptionTitle(e)}))),this.marks.set(`${e}-popup`,n),n.toggle()}}var Ne=s(36005);var Pe=s(36005);var Le=s(36005);var Re=s(36005);var je=s(36005);var Be=s(33662);class qe extends m.T3{reloadList(){this._list&&(this._list.clear(),this._page=0,this._hasMore=!0,this.loadMore())}attachHandlers(){this.listenTo(i.core.ui,"document-scroll",(0,P.throttle)((()=>this.handleScrolling()),200)),this._form&&this.listenTo(this._form,"submit",(t=>this.handleSearch(t))),this.listenTo(i.core,Be.AJ.STORIES,this.reloadList.bind(this)),this.listenTo(i.core,Be.AJ.COMMENTS,this.reloadList.bind(this))}handleScrolling(){this._hasMore&&!this._list.loading&&this._list.elementWillSoonScrolled&&this.loadMore()}handleSearch(t){t.preventDefault();let e=this._searchInput.value;""===e?i.core.history.searchParams.delete("q"):i.core.history.searchParams.set("q",e);let s=i.core.history.searchParams.toString(),n=s?"?"+s:"";i.core.history.pushUrl(i.core.history.location.pathname+n,!0)}}const Fe=s(19755);class Ve extends rt.u1{constructor(t){super(t),this.render()}render(){if(this.isRendered)return;const{usersListTemplate:t}=this.useRegistry();this._selectors={listItem:".ignored-user",blink:".ignored-user_blink",tool:".ignored-user__tool"};let e=t=>this.$(`.ignore-users-list__${t}`);this.$el.append(t({noPadding:this._options.showUntilDate})),this.$els={list:e("list").hide(),header:e("header"),spinner:e("spinner"),count:e("count"),empty:e("empty")},this.$els.empty.text(i.core.i18n("page-ignore-list.empty.users")).hide(),this._users=[],this._spinner=i.core.ui.player.createAnimation("stories-spinner",{$parent:this.$els.spinner}),this._attachActions()}add(t,e=!1){const{userTemplate:s}=this.useRegistry();return t=(0,P.isArray)(t)?t:[t],this.$els.list[e?"prepend":"append"](Fe(t.map(s).join(""))),this._users=e?this._users.concat(t):t.concat(this._users),this}remove(t){let e=this.$els.list.find(this._selectors.listItem+`[data-id="${t}"]`);return this._animateUpdate(e).then((()=>e.remove())),this._users=this._users.filter((e=>Number(e.id)!==t)),this}clear(){this._users=[]}async toggleLoading(t){t=Boolean(t),this.loading!==t&&(t?(this._options.animationStart=Date.now(),this.$els.empty.hide(),this.$els.header.toggle(this.hasUsers)):this._options.animationStart&&(await r.Utils.delay(500-(Date.now()-this._options.animationStart)),this.$els.header.show()),this.loading=t,this._spinner.togglePlay(t))}async _animateUpdate(t){let e=this._selectors.blink.substring(1);t.addClass(e),await r.Utils.delay(200),t.removeClass(e)}_onChange(){this.$els.empty.toggle(!this.hasUsers),this.$els.list.toggle(this.hasUsers),!this.hasUsers&&this.$els.list.empty()}_attachActions(){[{name:"delete",handler:this._handleDelete}].forEach((t=>{this.$el.on("click",this._selectors.tool+`[data-action="${t.name}"]`,(0,P.debounce)(t.handler.bind(this),200))}))}_handleDelete(t){const e=Fe(t.currentTarget).closest(this._selectors.listItem).data("id");e&&this.emit("delete",e)}get _users(){return this._options.users}set _users(t){this._options.users=t,this._onChange()}get users(){return this._users}get hasUsers(){return this._users.length>0}get elementWillSoonScrolled(){return i.core.ui.elementWillSoonScrolled(this.$els.list[0])}}function Ze(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const We=s(19755);class ze extends qe{constructor(...t){super(...t),Ze(this,"_handleDelete",(async t=>{try{await Be.jj.removeCommentsIgnore(t)&&this._list.remove(t)}catch(e){i.core.ui.toasts.showError(e)}}))}route(t,e){this.ctx=t;let s=i.core.history.searchParams.get("q")||null,n=s!==this.query;return this.query=s,n&&this.reloadList(),this.isShown||this.show(),e()}render(){if(this.isRendered)return this;const{Sanitizers:t,UIForm:e,UIInput:s,pageCommentsTemplate:i}=this.useRegistry();let n=t=>this.$(`.ignore-comments__${t}`);return this.$parent=We(".ignore-settings"),this.$el=We(i()),this.$els={container:n("container"),categories:n("categories"),form:n("form"),searchInput:this.$('.input[data-role="search"]')},this._list=new Ve(this.$els.container),this._form=new e(this.$els.form),this._searchInput=new s({$el:this.$els.searchInput,sanitizerRules:[t.trim(),t.singleSpace()]}),this._form.add(this._searchInput),this.listenTo(this._list,"delete",this._handleDelete),this.attachHandlers(),this.loadMore(),super.render(),this}async loadMore(){if(this._loading)return;this._loading=!0,await this._list.toggleLoading(!0);let t=this._page+1||1,{total:e,users:s}=await Be.jj.getCommentsIgnoreRules({page:t,search:this.query||void 0});this._page=t,this._hasMore=this._list.users.length+s.length<e,await this._list.toggleLoading(!1),this._list.add(s),this._initAnalytics(),this._loading=!1}_initAnalytics(){this.$els.container.find(".user").off("click.analytics auxclick.analytics").on("click.analytics auxclick.analytics",(t=>{0!==t.button&&1!==t.button||St.c.getInstance().sendEvent("transition_to_author",{type:"from_ignore",author_id:(0,Te.$)(t.currentTarget)})}))}}var He=s(74750);const Ge=s(19755);class Ye extends rt.u1{constructor(t){super(t),this.setOptions({reload:t.reload}),this.render()}render(){if(this.isRendered)return;const{rulesListTemplate:t}=this.useRegistry();this._selectors={rule:".ignore-rule",blink:".ignore-rule_blink",tool:".ignore-rule__tool"};const e=t=>this.$(`.ignore-rules-list__${t}`);this.$el.append(t()),this.$els={list:e("list"),header:e("header"),spinner:e("spinner"),total:e("total"),add:e("add"),empty:e("empty")},this.$els.add.text(i.core.i18n("page-ignore-list.button.add")).on("click",this._handleCreate.bind(this)),this.$els.empty.text(i.core.i18n("page-ignore-list.empty.stories")).hide(),this._rules=[],this._popup=void 0,this._spinner=i.core.ui.player.createAnimation("stories-spinner",{$parent:this.$els.spinner}),this._attachActions()}add(t,e=!1){return t=(0,P.isArray)(t)?t:[t],this.$els.list[e?"prepend":"append"](Ge(t.map((t=>this._renderRule(t))).join(""))),this._rules=e?this._rules.concat(t):t.concat(this._rules),this}remove(t){let e=this.$els.list.find(this._selectors.rule+`[data-id="${t}"]`);return this._animateUpdate(e).then((()=>e.remove())),this._rules=this._rules.filter((e=>Number(e.id)!==t)),this.total=this.total-1,this}update(t){let e=(0,P.findIndex)(this._rules,(e=>Number(e.id)===Number(t.id)));if(e<0)return this;this._rules[e]=t;let s=this.$els.list.find(this._selectors.rule+`[data-id="${t.id}"]`);return this._animateUpdate(s).then((()=>{s.replaceWith(Ge(this._renderRule(t)))})),this}clear(){this._rules=[]}reload(){this._options.reload?this._options.reload():i.core.logger.error("нужно передать обработчик перезагрузки списка!")}async toggleLoading(t){(t=Boolean(t))?(this._options.animationStart=Date.now(),this.$els.empty.hide(),this.$els.total.hide()):this._options.animationStart&&await r.Utils.delay(500-(Date.now()-this._options.animationStart)),this.loading=t,this._spinner.togglePlay(t)}async _animateUpdate(t){let e=this._selectors.blink.substring(1);t.addClass(e),await r.Utils.delay(200),t.removeClass(e)}_onChange(){!this.hasRules&&this.$els.list.empty(),this.$els.empty.toggle(!this.hasRules),this.$els.total.toggle(this.hasRules),this.$els.list.toggle(this.hasRules)}_renderRule(t){if(!(t.authors.length||t.communities.length||t.keywords.length||t.tags.length))return void(this.total=this.total-1);const{ruleTemplate:e}=this.useRegistry(),s=t.valid_until,{dateEnds:i,daysUntil:n}=r.Utils.timestampToDaysUntil(s);return e((0,P.extend)(t,{dateEnds:i,daysUntil:n}))}_attachActions(){[{name:"update",handler:this._handleEdit},{name:"delete",handler:this._handleDelete}].forEach((t=>{this.$el.on("click",this._selectors.tool+`[data-action="${t.name}"]`,(0,P.debounce)(t.handler.bind(this),200))}))}async _handleEdit(t){const{UIIgnoreRulePopup:e}=this.useRegistry();let s=Ge(t.currentTarget).closest(this._selectors.rule).data("id");if(!s)return;let i=(0,P.find)(this._rules,(t=>Number(t.id)===Number(s)));this._popup=new e({ignoreRule:i,updateRule:!0});let{result:n}=await this._popup.show().ready();n&&this.update(n)}async _handleDelete(t){var e;const s=Ge(t.currentTarget).closest(this._selectors.rule),n=s.data("id"),a=(null===(e=s.data("tag"))||void 0===e?void 0:e.toLowerCase())||"";if(n)try{if(a===He.x||"жесть"===a){const t=i.core.initParams.birthday?F()(i.core.initParams.birthday).format("DD.MM.YYYY"):"";if(!t||!tt.Z.isAdultAge(t)){if(!(await tt.Z.showAdultPopup(!0)).result)return}}await Be.jj.removeRule(n)&&this.remove(n)}catch(o){i.core.logger.error("ignore",o.message)}}async _handleCreate(){const{UIIgnoreRulePopup:t}=this.useRegistry();this._popup=new t;let{result:e}=await this._popup.show().ready();e&&this.reload()}get _rules(){return this._options.rules}set _rules(t){this._options.rules=t,this._onChange()}get rules(){return this._rules}get hasRules(){return this._rules.length>0}get total(){return this._options.total}set total(t){let e=t?`${t} ${i.core.i18n("plural.records",t)}`:"";this.$els.total.text(e),this._options.total=t}get elementWillSoonScrolled(){return i.core.ui.elementWillSoonScrolled(this.$els.list[0])}}const Ke=s(19755);class Qe extends qe{route(t,e){this.ctx=t;let s=t.params.category||null,n=i.core.history.searchParams.get("q")||null,a=s!==this.category||n!==this.query;return this.category=s,this.query=n,this._updateCategoriesMenu(),a&&this.reloadList(),this.isShown||this.show(),e()}render(){if(this.isRendered)return this;const{Sanitizers:t,UIForm:e,UIInput:s,pageStoriesTemplate:i}=this.useRegistry();let n=t=>this.$(`.ignore-stories__${t}`);return this.$parent=Ke(".ignore-settings"),this.$el=Ke(i()),this.$els={container:n("container"),categories:n("categories"),form:n("form"),searchInput:this.$('.input[data-role="search"]')},this._list=new Ye({$el:this.$els.container,reload:this.reloadList.bind(this)}),this._form=new e(this.$els.form),this._searchInput=new s({$el:this.$els.searchInput,sanitizerRules:[t.trim(),t.singleSpace()]}),this._form.add(this._searchInput),this._updateCategoriesMenu(),this.attachHandlers(),this.loadMore(),super.render(),this}hide(){return super.hide(),this._form.reset(),this}_updateCategoriesMenu(){let t=this.category||Be.BF.ALL.valueOf();this.$els.categories&&this.$els.categories.find(".menu__item_route").removeClass("menu__item_current").filter(`[data-category="${t}"]`).addClass("menu__item_current")}async loadMore(){this._loading=!0;try{let t=this._lastRequestId=(0,P.uniqueId)("ignore-rules_");await this._list.toggleLoading(!0);let e=this._page+1||1,{total:s,rules:i}=await Be.jj.getIgnoreRules({page:e,search:this.query||void 0,type:this.category?Be.BF[this.category.toUpperCase()+"_CONVOLUTED"]:void 0});if(this._page=e,await this._list.toggleLoading(!1),t!==this._lastRequestId)return void(await this._list.toggleLoading(!0));this._list.total=s,this._list.add(i),this._initAnalytics(),this._hasMore=this._list.rules.length<s}catch(t){i.core.ui.toasts.showError(t)}this._loading=!1}_initAnalytics(){this.$els.container.find(".ignore-rule__item_user").off("click.analytics auxclick.analytics").on("click.analytics auxclick.analytics",(t=>{0!==t.button&&1!==t.button||St.c.getInstance().sendEvent("transition_to_author",{type:"from_ignore","author_id!empty":Number(t.currentTarget.dataset.id)})})),this.$els.container.find(".ignore-rule__item_tag").off("click.analytics auxclick.analytics").on("click.analytics auxclick.analytics",(t=>{0!==t.button&&1!==t.button||St.c.getInstance().sendEvent("transition_to_tag",{type:"from_ignore",tag_id:t.currentTarget.textContent.trim()})})),this.$els.container.find(".ignore-rule__item_community").off("click.analytics auxclick.analytics").on("click.analytics auxclick.analytics",(t=>{0!==t.button&&1!==t.button||St.c.getInstance().sendEvent("transition_to_community",{type:"from_ignore","community_id!empty":Number(t.currentTarget.dataset.id)})}))}}var Xe=s(87540);function Je(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const ts=s(19755),es="pkb_iuai";class ss extends qe{constructor(...t){super(...t),Je(this,"_handleDelete",(async t=>{try{const e=this.$els.container.find(`.ignored-user[data-id="${t}"]`)[0];if(!(await(0,Xe.oY)(t)))return;const s=this._list.users.find((e=>e.id===t));_.cp.getInstance().sendEvent("user_unbanned",{type:"for_author",content_type:0===s.ban_end_at?"forever":"temporary"}),this._appendRevertEl(t,e)}catch(e){i.core.ui.toasts.showError(e)}}))}route(t,e){var s;if(this.ctx=t,null===(s=i.core.config("modules.ignorePageParams"))||void 0===s||!s.is_author_moderation_tab_hidden)return this.isShown||this.show(),e();i.core.history.redirect("/ignore-list")}render(){return this.isRendered||(this.$parent=ts(".ignore-settings"),this.$el=ts(function(t){var e="";return Array.prototype.join,s(12953).core,e+='\n<div class="ignore-comments">\n\t<div class="section-group">\n\t\t',t.showInfoAlert&&(e+='\n\t\t<div class="pkb-alert pkb-alert_yellow">\n\t\t\t<span class="pkb-alert__icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__block_20"><use xlink:href="#icon--ui__block_20"></use></svg></span>\n\t\n\t\t\t<div class="pkb-alert__content">\n\t\t\t\t<button class="pkb-alert__close"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__close_16"><use xlink:href="#icon--ui__close_16"></use></svg></button>\n\t\t\t\t<h4 class="pkb-alert__title">\n\t\t\t\t\tЗаблокированные пользователи\n\t\t\t\t</h4>\n\t\n\t\t\t\tНа этой странице отображён список людей, которым вы ограничили комментирование<br>в&nbsp;ваших постах.\n\t\t\t\tУдаление из&nbsp;этого списка возвращает эту&nbsp;возможность.\n\t\t\t</div>\n\t\t</div>\n\t\t'),e+='\n\t</div>\n\t\n\t<div class="ignore-comments__container"></div>\n</div>\n'}({showInfoAlert:!k.m.get(es)})),this.$els={container:this.$(".ignore-comments__container"),categories:this.$(".ignore-comments__categories"),alert:this.$(".pkb-alert")},this._list=new Ve({$el:this.$els.container,showUntilDate:!0}),this.$els.alert.on("click",".pkb-alert__close",(()=>{k.m.set(es,1),this.$els.alert.hide()})),this.listenTo(this._list,"delete",this._handleDelete),this.attachHandlers(),this.loadMore(),super.render()),this}async loadMore(){if(!this._loading){this._loading=!0,await this._list.toggleLoading(!0);try{const t=this._page+1||1,{total:e,users:s}=await(0,Xe.z9)(t);this._page=t,this._hasMore=this._list.users.length+s.length<e,await this._list.toggleLoading(!1),this._list.add(s)}catch(t){i.core.ui.toasts.showError(t)}finally{this._loading=!1}}}async _appendRevertEl(t,e){if(!e)return;const s=document.createElement("div"),n=document.createElement("span");s.classList.add("ignored-user__revert-ban"),n.classList.add("ignored-user__revert-ban-trigger"),n.innerText="отменить",s.innerText="Автор разблокирован",n.addEventListener("click",(async()=>{try{const e=this._list.users.find((e=>e.id===t));if(!(await(0,Xe.WV)(t,e.ban_end_at)))return;_.cp.getInstance().sendEvent("user_unban_cancelled",{type:"for_author",content_type:0===e.ban_end_at?"forever":"temporary"}),s.classList.remove("ignored-user__revert-ban_active"),s.addEventListener("transitionend",(()=>{s.remove()}),{once:!0})}catch(e){i.core.ui.toasts.showError(e)}}),{once:!0}),s.append(n),e.append(s),s.offsetWidth,s.classList.add("ignored-user__revert-ban_active")}}const is=s(19755);class ns extends m.GR{onMatch(t,e){super.onMatch(t,e)}constructor(t){super(t),this.use({"/ignore-list":this,"/ignore-list/:category(tags|authors|communities|keywords)?":Qe,"/ignore-list/comments":ze,"/ignore-list/users":ss})}render(){return this.isRendered||(this.$el=is(".ignore-settings"),this.$('div[data-role="spinner"]').hide(),i.core.ui.screen=G.dt.USER_IGNORE_LIST,super.render()),this}}D.S.getInstance().fillLocal(Qe,{pageStoriesTemplate:function(t){var e="",i=Ne.escape;Array.prototype.join;const n=s(12953).core;return e+='\n<div class="ignore-stories">\n\t<form class="section-group ignore-stories__form" method="POST" action="javascript:void 0;" novalidate>\n\t\t<section class="input input_box input_section" data-role="search">\n\t\t\t<span class="input__icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__search icon--ui__search_input"><use xlink:href="#icon--ui__search"></use></svg></span>\n\t\t\t<span class="input__box">\n\t\t\t\t<input class="input__input" placeholder="'+i(n.i18n("page-ignore-list.placeholders.posts"))+'" autocomplete="off" name="search" value="">\n\t\t\t</span>\n\t\t\t<button class="button button_success">Поиск</button>\n\t\t</section>\n\t\t<section class="section_gray ignore-stories__categories">\n\t\t\t',[{route:"",name:"all"},{route:"/tags",name:"tags"},{route:"/authors",name:"authors"},{route:"/communities",name:"communities"},{route:"/keywords",name:"keywords"}].forEach((function(t){e+='\n\t\t\t\t<a href="/ignore-list'+i(t.route)+'" data-category="'+i(t.name)+'" class="button button_small menu__item_route">\n\t\t\t\t\t'+i(n.i18n("page-ignore-list.categories."+t.name))+"\n\t\t\t\t</a>\n\t\t\t"})),e+='\n\t\t</section>\n\t</form>\n\n\t<div class="ignore-stories__container"></div>\n</div>\n'}}).fillLocal(ze,{pageCommentsTemplate:function(t){var e="",i=Pe.escape;Array.prototype.join;const n=s(12953).core;return e+='\n<div class="ignore-comments">\n\t<form class="section-group ignore-comments__form" method="POST" action="javascript:void 0;" novalidate>\n\t\t<section class="input input_box input_section" data-role="search">\n\t\t\t<span class="input__icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__search icon--ui__search_input"><use xlink:href="#icon--ui__search"></use></svg></span>\n\t\t\t<span class="input__box">\n\t\t\t\t<input class="input__input" placeholder="'+i(n.i18n("page-ignore-list.placeholders.comments"))+'" autocomplete="off" name="search" value="">\n\t\t\t</span>\n\t\t\t<button class="button button_success">Поиск</button>\n\t\t</section>\n\t</form>\n\n\t<div class="ignore-comments__container"></div>\n</div>\n'}}).fillLocal(Ye,{rulesListTemplate:function(t){return'<div class="section-group">\n\t<section class="ignore-rules-list__header section_gray">\n\t\t<strong class="ignore-rules-list__total"></strong>\n\t\t<button class="ignore-rules-list__add button_success button_small"></button>\n\t</section>\n\t<section class="ignore-rules-list__list-container">\n\t\t<div class="ignore-rules-list__list"></div>\n\t\t<div class="ignore-rules-list__spinner"></div>\n\t\t<div class="ignore-rules-list__empty"></div>\n\t</section>\n</div>\n\n\n','<div class="section-group">\n\t<section class="ignore-rules-list__header section_gray">\n\t\t<strong class="ignore-rules-list__total"></strong>\n\t\t<button class="ignore-rules-list__add button_success button_small"></button>\n\t</section>\n\t<section class="ignore-rules-list__list-container">\n\t\t<div class="ignore-rules-list__list"></div>\n\t\t<div class="ignore-rules-list__spinner"></div>\n\t\t<div class="ignore-rules-list__empty"></div>\n\t</section>\n</div>\n\n\n'},ruleTemplate:function(t){var e,i="",n=Re.escape;Array.prototype.join;const a=s(12953).core;return i+='\n\n<div class="ignore-rule" data-id="'+n(t.id)+'" data-tag="'+n((null===(e=t.tags)||void 0===e?void 0:e.join(","))||"")+'">\n\t<div class="ignore-rule__content">\n\t\t',t.keywords&&(i+="\n\t\t\t",t.keywords.forEach((function(t){i+='\n\t\t\t\t<div class="ignore-rule__wrapper">\n\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__plus"><use xlink:href="#icon--ui__plus"></use></svg>\n\t\t\t\t\t<span class="ignore-rule__item ignore-rule__item_keyword">'+n(t)+"</span>\n\t\t\t\t</div>\n\t\t\t"})),i+="\n\t\t"),i+="\n\n\t\t",t.tags&&(i+="\n\t\t\t",t.tags.forEach((function(t){i+='\n\t\t\t\t<div class="ignore-rule__wrapper">\n\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__plus"><use xlink:href="#icon--ui__plus"></use></svg>\n\t\t\t\t\t<a href="'+n("/tag/"+encodeURIComponent(t))+'" rel="noopener" target="_blank"\n\t\t\t\t\t   class="ignore-rule__item ignore-rule__item_tag">'+n("Моё"===t?"[моё]":t)+"</a>\n\t\t\t\t</div>\n\t\t\t"})),i+="\n\t\t"),i+="\n\n\t\t",t.communities&&(i+="\n\t\t\t",t.communities.forEach((function(t){i+='\n\t\t\t\t<div class="ignore-rule__wrapper">\n\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__plus"><use xlink:href="#icon--ui__plus"></use></svg>\n\t\t\t\t\t<a href="/community/'+n(t.slug)+'" data-id="'+n(t.id)+'" class="ignore-rule__item ignore-rule__item_community">\n\t\t\t\t\t\t<span class="community-avatar community-avatar_small">\n\t\t\t\t\t\t\t',t.avatar?i+='\n\t\t\t\t\t\t\t\t<img src="'+n(t.avatar)+'" alt="'+n(t.name)+'" />\n\t\t\t\t\t\t\t':i+='\n\t\t\t\t\t\t\t\t<span class="community-avatar__default"></span>\n\t\t\t\t\t\t\t',i+='\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class="community__title">'+n(t.name)+"</span>\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t"})),i+="\n\t\t"),i+="\n\n\t\t",t.authors&&(i+="\n\t\t\t",t.authors.forEach((function(t){i+='\n\t\t\t\t<div class="ignore-rule__wrapper">\n\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__plus"><use xlink:href="#icon--ui__plus"></use></svg>\n\t\t\t\t\t<a href="/@'+n(t.name)+'" data-id="'+n(t.id)+'" class="ignore-rule__item ignore-rule__item_user user user_inline">\n\t\t\t\t\t\t<span class="avatar avatar_small">\n\t\t\t\t\t\t\t',t.avatar?i+='\n\t\t\t\t\t\t\t\t<img src="'+n(t.avatar)+'" alt="'+n(t.name)+'" />\n\t\t\t\t\t\t\t':i+='\n\t\t\t\t\t\t\t\t<span class="community-avatar__default"></span>\n\t\t\t\t\t\t\t',i+='\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class="user__nick" data-profile="true">'+n(t.name)+"</span>\n\t\t\t\t\t</a>\n\t\t\t\t\t",t.is_permabanned&&(i+='\n\t\t\t\t\t\t<span class="ignore-rule__ban-status hint" aria-label="'+n(a.i18n("users."+(t.ban_reason?"permabanned":"permabanned-without-reason"),t.ban_reason))+'">\n\t\t\t\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__ban icon--ui__ban_profile"><use xlink:href="#icon--ui__ban"></use></svg>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t'),i+="\n\t\t\t\t</div>\n\t\t\t"})),i+="\n\t\t"),i+='\n\t</div>\n\n\t<div class="ignore-rule__controls">\n\t\t',t.dateEnds&&(i+='\n\t\t\t<div class="ignore-rule__days hint" aria-label="'+n(a.i18n("ignore.hints.date",t.dateEnds))+'">\n\t\t\t\t'+n(t.daysUntil)+" "+n(a.i18n("plural.days",t.daysUntil))+"\n\t\t\t</div>\n\t\t"),i+='\n\n\t\t<span class="ignore-rule__tool" data-action="update" aria-label="'+n(a.i18n("page-ignore-list.tools.edit"))+'">\n\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__pencil"><use xlink:href="#icon--ui__pencil"></use></svg>\n\t\t</span>\n\n\t\t<span class="ignore-rule__tool" data-action="delete" aria-label="'+n(a.i18n("page-ignore-list.tools.delete"))+'">\n\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__close"><use xlink:href="#icon--ui__close"></use></svg>\n\t\t</span>\n\t</div>\n</div>\n'}}).fillLocal(Ve,{usersListTemplate:function(t){var e="";return e+='<div class="section-group">\n\t<section class="ignore-users-list__list-container section_padding_none">\n\t\t<div class="ignore-users-list__list'+(0,je.escape)(null!=t&&t.noPadding?" ignore-users-list__list_no-padding":"")+'"></div>\n\t\t<div class="ignore-users-list__empty"></div>\n\t\t<div class="ignore-users-list__spinner"></div>\n\t</section>\n</div>\n\n'},userTemplate:function(t){var e="",i=Le.escape;Array.prototype.join;const n=s(12953).core;e+="\n";const a=s(30381);return e+='\n\n<div class="ignored-user'+i(void 0!==t.ban_end_at?" ignored-user_row":"")+'" data-id="'+i(t.id)+'">\n\t<button class="ignored-user__tool pkb-icon-btn" data-action="delete"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__close_16"><use xlink:href="#icon--ui__close_16"></use></svg></button>\n\t<div class="ignored-user__content">\n\t\t<a href="/@'+i(t.name)+'" class="user user_inline">\n\t\t\t<span class="avatar avatar_small">\n\t\t\t\t',t.avatar?(e+='\n\t\t\t\t\t<img src="'+i(t.avatar)+'" alt="',t.name,e+='"/>\n\t\t\t\t'):e+='\n\t\t\t\t\t<span class="avatar__default"></span>\n\t\t\t\t',e+='\n\t\t\t</span>\n\t\t\t<span class="user__nick" data-profile="true">'+i(t.name)+"</span>\n\t\t</a>\n\n\t\t",t.is_permabanned&&(e+='\n\t\t\t<span class="ignore-rule__ban-status hint" aria-label="'+i(n.i18n("users."+(t.ban_reason?"permabanned":"permabanned-without-reason"),t.ban_reason))+'">\n\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__ban icon--ui__ban_profile"><use xlink:href="#icon--ui__ban"></use></svg>\n\t\t\t</span>\n\t\t'),e+="\n\t</div>\n\n\t",void 0!==t.ban_end_at&&(e+='\n\t\t<div class="ignored-user__ban-until">\n\t\t\t',0===t.ban_end_at?e+="\n\t\t\t\tНавсегда\n\t\t\t":e+="\n\t\t\t\t7 дней до (<span>"+i(a(1e3*t.ban_end_at).format("DD.MM.YYYY"))+"</span>)\n\t\t\t",e+="\n\t\t</div>\n\t"),e+="\n</div>\n"}});class as extends m.T3{async render(){const{createApp:t}=await s(37319);t().mount("#notifications")}}var os=s(47520);class rs extends os.K{constructor(t){super(t),this.maxVisibleRows=1,this.oneRowHeight=32,this.init()}}var ls=s(51691),cs=s(35263);class ds{constructor(t){if(!(t instanceof HTMLElement))throw new Error("No container element found");const e=t.querySelector(".tabset");if(!(e instanceof HTMLElement))throw new Error("No tabset container element found");this.el=t,this.accordion=new ls.U(this.el,{stateId:"comStatsAccordionHidden"}),this.tabset=new cs.l(e),this.initTooltips()}initTooltips(){const t=this.el.dataset.tooltip;if(!t)return;const e=this.el.querySelector(".accordion__item-header-text");if(!(e instanceof HTMLElement))return;const[s]=JSON.parse(t);s||this.showTooltip(e)}async showTooltip(t){(await(0,_t.aM)({target:t,content:'\n\t\t\t<div class="popup__content-notification community-statistics__tooltip">\n\t\t\t\t<div class="community-statistics__tooltip-label">Статистика сообщества</div>\n\t\t\t\t<p class="community-statistics__tooltip-text">\n\t\t\t\t\tВ этом окне администраторы сообщества могут наблюдать динамику по основным показателям сообщества.\n\t\t\t\t\t<br>Этот блок видят только <strong>адмодеры</strong> — администрация вашего сообщества.\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t',theme:L.xb.GREEN,overlapSidebars:!1,direction:L.Lh.BOTTOM,alignment:L.SE.CENTER,autoCloseIfTargetNotVisible:!0,autoCloseOutsideClick:!0,delay:500,delayClose:500,hideByScroll:!1,wrapperExtraClass:"com-value-hint"})).addCloseButtonIntoFooter("Понятно!")}}class us extends m.T3{initQueueBox({container:t,StoriesFeed:e,SimilarStories:s}){const i=t.find(".community-stories-queue__button");new e({$el:t,feedName:"community-queue"}),i.on("click",(()=>{i.slideUp(200,(()=>i.remove())),t.find(".stories-feed__container").fadeIn(500)}));const n=t=>{var e;return null!==(e=y()(t).closest(".community-queue-panel").attr("data-queue-id"))&&void 0!==e?e:""};y()('.community-queue-panel__buttons button[data-role="allow"]').click((({target:t,currentTarget:e})=>{this.approveStory(n(t),g.dO.APPROVED,e)})),y()('.community-queue-panel__buttons button[data-role="deny"]').click((({target:t,currentTarget:e})=>{this.approveStory(n(t),g.dO.REJECTED,e)})),y()('.community-queue-panel__buttons button[data-role="cancel-community-change"]').click((({target:t,currentTarget:e})=>{this.approveStory(n(t),g.dO.MOVED_TO_COMMON_FEED,e)})),y()(".community-queue-panel__buttons .community-queue-panel__cmp").click((({target:t})=>{this.showCompareResults(n(t),s)}))}async showCompareResults(t,e){const s=y()(`.community-queue-panel[data-queue-id="${t}"] .community-queue-panel__similar-stories`);let n=this.marks.get(t);if(n)s.slideToggle();else{n=new e({$parent:s,type:v.VQ.MANUAL,queueId:t}),this.marks.set(t,n),n.show(),n.state=v.DX.WAIT;try{const e=await this.community.getComporatorResultForQueue(t);(0,P.isObject)(e)&&Object.keys(e).length?n.addSources(e):n.state=v.DX.EMPTY}catch(a){i.core.ui.toasts.showError(a)}s.slideDown()}}async approveStory(t,e,s){const n=y()(`.community-queue-panel[data-queue-id="${t}"]`),a=n.find("button");if(n.attr("disabled","disabled"),a.attr("disabled","disabled"),s.classList.add("button_spinning"),e===g.dO.APPROVED){const t=k.m.get(f.ob)||0;Date.now()-t<f.Qu&&_.cp.getInstance().yandex.goal("community_fast-approve"),k.m.set(f.ob,Date.now())}try{const s=await this.community.processStoryInQueue(t,e);this.toastApprove&&s.length&&(this.toastApprove.hide(),this.timeout("reopen",200,(()=>{this.toastApprove.content=s,this.toastApprove.show()})));const a=n.find(".community-queue-panel__message"),o=n.closest(".story"),r=a.find("a");let l,c=4;a.find("span").text(i.core.i18n("page-community."+(e===g.dO.APPROVED?"approved":"disapproved")));const d=()=>{l&&clearTimeout(l),o.slideUp(400,(()=>o.remove()))},u=()=>{c--,c>=0&&(r.text(`закрыть (${c} сек)`),c>0?l=setTimeout(u,1e3):d())};r.click(d),u(),a.slideDown(400);const p=y()('.bell[data-role="community"]');let h=Number(p.text()||"0");--h>0?p.text(String(h)):p.hide()}catch(o){o.message.length&&i.core.ui.toasts.showError(o)}finally{n.removeAttr("disabled"),a.removeAttr("disabled"),s.classList.remove("button_spinning")}}}const ps=s(19755);class hs extends us{render(){if(this.isRendered)return this;this.$el=ps(".community-header"),this._communityID=this._options.communityId=Number(this.$el.data("id"))||0,this._community=this._options.community=new g.S1(this._communityID),this._isLocked=this._options.isLocked=1===Number(this.$el.data("locked")),super.render();const t=document.querySelector(".community-statistics");t&&new ds(t);const e=ps(".community-top-tags");return e.length&&new rs({$el:e,communityId:this.communityId}),this}get communityId(){return this._options.communityId}get community(){return this._options.community}get isLocked(){return this._options.isLocked}}const _s=s(19755);class ms extends hs{route(t,e){return this.ctx=t,this.isRendered?(this._feed.requestUrl=t.path,this._feed.clear(),this._feed.loadStories(!1)):this.show(),e()}render(){return this.isRendered?this:(super.render(),i.core.ui.screen=G.dt.COMMUNITY,St.c.getInstance().commonParameters.screen_community=this.communityId,this.$els={feed:_s(".stories-feed"),queue:_s(".community-stories-queue"),search:_s(".stories-search")},this.$els.queue.length>0&&this.initQueueBox(),this.$els.feed.length?(this._feed=new l._D({$el:this.$els.feed,feedName:this.$els.search.length?"community-search":"community",feedRecordId:document.location.pathname,focused:!0}),new l.pd({$el:this.$els.feed,feed:this._feed,feedName:l.DV.COMMUNITY.valueOf()}),this.$els.search.length&&(this._search=new c.P({feed:this._feed,searchMode:p.xd.COMMUNITY,$el:this.$els.search})),this.toastApprove=new Q.O({closeAfter:1e4,destroyAfterHide:!1,addCloseButton:!0}),this):this)}initQueueBox(){super.initQueueBox({container:this.$els.queue,StoriesFeed:l._D,SimilarStories:K.Bi})}}const gs=s(19755);var fs=s(23703),vs=s(92393),bs=s(36005);function ys(t){var e="",s=bs.escape;return e+='Вы действительно хотите проголосовать за пользователя <a href="/@'+s(t.name)+'" target="_blank" class="user user_inline"><span class="avatar avatar_small"><img src="'+s(t.avatar)+'"></span><span class="user__nick">'+s(t.name)+"</span></a>?\n"}const ws=s(19755);class ks extends m.T3{}var xs=s(81772);const Ss=s(19755),$s=[-10,0,25,100,250,500,1e3,2500];class Cs extends g.W_{constructor(t){super(t),this.el&&this.show()}render(){return this.isRendered||(this.$els={container:this.$(".communities-feed__container"),message:this.$(".communities-feed__message"),spinner:this.$(".communities-feed__spinner"),addButton:this.$(".feed-panel .menu__item_button-success")},this.$els.spinner.length&&(this.animation=i.core.ui.player.createAnimation("stories-spinner",{$parent:this.$els.spinner})),this.$els.addButton.on("click",(()=>{St.c.getInstance().sendEvent("click",{type:"community_create"})})),this.listenTo(i.core.ui,"document-scroll",this._feedScrolling),this.$el.data("has-more")||(this.endOfFeed=!0),this.amount=this.$els.container.find(".community").length,super.render()),this}_feedScrolling(){i.core.ui.elementWillSoonScrolled(this.el)&&this._loadCommunitiesThrottle()}_updateEndOfFeed(t){this.$els.message.toggle(t)}_updateLoadAnimation(t){this.$els.container.toggle(this.amount>0&&!t||this.amount>0),this.animation&&this.animation.togglePlay(t)}}var Ts=s(68016);const Es=s(19755);class Is extends ks{route(t,e){return this.ctx=t,this.state.update({sortMode:g.$z[t.params.sort]||g.$z.ACTUAL,type:g.WV[t.params.type]||g.WV.ALL,tag:t.params.tag,filterType:g.Av[i.core.history.searchParams.get("t")]||g.Av.ALL,searchText:i.core.history.searchParams.get("q")||""}),this.show(),e()}render(){var t;if(this.isRendered)return this;this.$el=Es(".communities-feed"),this.$els={sortBlock:this.$(".communities-feed__filter"),sortOrder:this.$('.communities-feed__filter > span[data-role="sort"]').on("click",this._toggleSortMode.bind(this)),message:this.$(".communities-feed__message"),menu:this.$(".menu"),search:{section:this.$('section[data-role="filter"]'),input:this.$('.input[data-role="search"]'),form:this.$(".communities-feed__search")},tags:this.$(".stories-search__tags-group .stories-search__tags"),tagsGroup:this.$(".stories-search__tags-group"),tagsInput:this.$(".stories-search__tags-group input"),linkCommunityAdd:this.$(".button_community-add")},this.$els.search.form.length&&(this._form=new at.x(this.$els.search.form),this.listenTo(this._form,"submit",(t=>{t.preventDefault(),this.state.data.searchText=this._searchInput.value}))),this._prepareTagsControl();let e=this.$('.form-group[data-role="type"]');if(this.$els.search.type={group:e,items:e.find(".items-list__item").on("click",this._selectType.bind(this))},this._feed=new Cs({$el:this.$el,params:this.state}),this.listenTo(this._feed,g.cP.PARSED,((t,e,s)=>{if(!s)return;let n=this.state.data.searchText.length>0||this.state.data.tag,a=this._feed.amount+e<=0,o=(n?"search-":"")+(a?"empty":"message");a&&this.state.data.type===g.WV.MINE&&(o="mine-empty"),this.$els.message.html(i.core.i18n("communities.feed.eof."+o))})),this.$el.on("click",".tags__tag",(t=>{t.preventDefault(),i.core.navigate(null,null,t.currentTarget.getAttribute("href"),!0)})),this.$els.search.input.length){this._searchInput=new Tt.u3({$el:this.$els.search.input,sanitizerRules:[Tt.op.trim()]});const t=()=>{this.$els.sortBlock.toggle(0===this._searchInput.value.length)};this.listenTo(this._searchInput,"input",t),this.listenTo(this._searchInput,"change",t),this._form.add(this._searchInput),t()}return i.core.ui.screen=G.dt.COMMUNITIES,null===(t=this.$els.linkCommunityAdd[0])||void 0===t||t.addEventListener("click",(t=>{i.core.isUserAuthorized||(t.preventDefault(),i.core.ui.authRequired({analyticsParams:{reason:"create_community"}}))})),this.$el.find(".community a.community-avatar, .community__title a").on("click auxclick",(t=>{0!==t.button&&1!==t.button||_.cp.getInstance().sendEvent("transition_to_community",{type:"from_tab",community_id:(0,Te.$)(t.currentTarget)})})),super.render(),this}_syncComponent(t){if(!this.isShown)return;let e=t.diff("sync");if(!e.length)return;for(let r of e){let{property:t,value:e,type:a}=r;if("searchText"===t&&(this._searchInput.value=e),"tag"===t&&"set"===a){const t=this.$els.tags.find(".items-list__item_tag");t&&this.tagsList.removeItem(t),e&&(this.tagsList.addItem(e),this._tagGroup.toggleGroup(!0))}if("sortMode"===t&&this.$els.sortOrder.find("span:first-child").text(i.core.i18n("communities.feed.sort-mode."+e.toString()).toLowerCase()),"type"===t){var s,n;if(e===g.WV.MINE)null===(s=this._tagGroup)||void 0===s||s.toggleGroup(!1),null===(n=this._typeGroup)||void 0===n||n.toggleGroup(!1);this.$els.menu.find(".menu__item_current").removeClass("menu__item_current"),this.$els.menu.find('a[href="/communities'+(e===g.WV.MINE?"/mine":"")+'"]').addClass("menu__item_current"),this.$els.search.section.toggle(e!==g.WV.MINE),i.core.ui.screen=this.state.data.type===g.WV.MINE?G.dt.COMMUNITIES_MINE:G.dt.COMMUNITIES}"filterType"===t&&(e!==g.Av.ALL&&this._toggleTypeFilter(!0),this.$els.search.type.items.removeClass("items-list__item_selected").filter(`[data-value="${e.valueOf()}"]`).addClass("items-list__item_selected"))}t.save("sync");let a=this.state.plainData,o="/communities"+(a.type!==g.WV.ALL?`/${a.type.valueOf()}`:"")+(a.type===g.WV.TAG?"/"+(a.tag||""):"")+(a.sortMode!==g.$z.ACTUAL?"/"+a.sortMode.valueOf():"");a.filterType!==g.Av.ALL&&(o+=(o.includes("?")?"&":"?")+"t="+a.filterType.valueOf()),a.searchText.length&&(o+=(o.includes("?")?"&":"?")+"q="+encodeURIComponent(a.searchText)),i.core.history.replaceState({},"",o,!1)}_prepareTagsControl(){this.tagsList=new Ts.EZ({$el:this.$els.tags,items:this.state.data.tag?[this.state.data.tag]:[],maxItems:1,addTagMenu:!1}),this.tagsList.on("change",(t=>{this.state.data.tag=t[0]})),this.$els.tagsInput.on("blur",(async()=>{this.tagsList.items.length||(await r.Utils.delay(100),this.$els.tagsInput.val(""))})),this._toggleTagFilter(this.tagsList.items.length>0)}_toggleTagFilter(t){this._tagGroup||(this._tagGroup=rt.u1.getUIElement(this.$els.tagsGroup)),this._tagGroup.toggleGroup(Boolean(t))}_toggleTypeFilter(t){this._typeGroup||(this._typeGroup=rt.u1.getUIElement(this.$els.search.type.group)),this._typeGroup.toggleGroup(Boolean(t))}_selectType(t){let e=Es(t.target);this.state.data.filterType=g.Av[e.attr("data-value")]}_toggleSortMode(){let t=this.marks.get("sort-popup");t||(t=a.g.popupEnum(this.$els.sortOrder,g.$z,"communities.feed.sort-mode",g.$z.ACTUAL),this.listenTo(t,"change",((e,s)=>{this.state.data.sortMode=s,t.hide()})),this.marks.set("sort-popup",t)),t.toggle()}get state(){let t=this._options.state;return t||(t=this._options.state=new lt.Lo({sortMode:void 0,type:void 0,tag:void 0,filterType:void 0,searchText:void 0}),this.listenTo(t,lt.u$.CHANGE,((t,e)=>{if("tag"in e){let e=t.data.tag,s=t.data.type;e&&s!==g.WV.TAG?t.update({type:g.WV.TAG},!0):e||s!==g.WV.TAG||t.update({type:g.WV.ALL},!0)}})),this.listenTo(t,lt.u$.CHANGE,(0,P.debounce)(this._syncComponent.bind(this),20))),t}}var Os=s(36012);class Us{static async loadBanList(t="",e=1){let{data:s}=await A.cf.getOrFail(i.core.history.location.pathname,{q:t,ajax_mode:"1",page:e});return{list:s.list,hasMore:s.has_more}}static getInitialTitle(t=""){return 0===t.length?document.title:document.title.replace(`${t} - `,"")}static formatTitle(t,e=""){return i.core.i18n("banned-profiles.title."+(e.length>0?"query":"empty"),e,e.length>0?(s=t).charAt(0).toLowerCase()+s.substr(1):(t=>t.charAt(0).toUpperCase()+t.substr(1))(t));var s}}const Ds=new ut.xs({STORY:1,COMMENT:2,PERMANENT:3,SLOWMODE:4}),As=s(19755),Ms=s(30381);class Ns extends m.T3{render(){if(this.isRendered)return this;this.$el=As(".banned-profiles"),this.$els={input:this.$('.input[data-role="search"]'),spinner:this.$('section[data-role="spinner"]'),form:this.$("form"),table:this.$('section[data-role="table"]')};let t=this._searchInput=new Tt.u3({$el:this.$els.input,suggestion:new fs.xI,sanitizerRules:[Tt.op.trim()]});this.listenTo(new at.x(this.$els.form),"submit",(t=>{t.preventDefault(),this._loadList()})),this.listenTo(t.suggestion,fs.nT.SELECT,(e=>{e&&(t.value=e.data.name,this._loadList())}));let e=[["Пользователь",20],["Причина",40],["Дата",20]];return i.core.isUserModerator&&e.push(["Модератор",0]),this._initialTitle=Us.getInitialTitle(t.value),this._table=new Os.$({$parent:this.$els.table,renderBody:this._renderTable.bind(this),header:e}),this._table.rows.fieldId="id",this._loadList(!1,i.core.config("modules.banned-profile")),this._table.show(),this._table.$el.on("click",".banned-profiles__more",this._loadList.bind(this,!0,null)),this.$els.spinner.remove(),this.$els.table.show(),i.core.ui.screen=G.dt.BANNED_PROFILES,super.render(),this}async _loadList(t=!1,e){let s=this._searchInput.value;if(!t&&this.marks.get("query")===s)return;this.marks.set("query",s);let n=Us.formatTitle(this._initialTitle,s);s.length?i.core.history.searchParams.set("q",s):i.core.history.searchParams.delete("q");let a=i.core.history.searchParams.toString();i.core.history.replaceState({},n,i.core.history.location.pathname+(a.length>0?"?"+a:""),!1),document.title=n;let o=t?(this.marks.get("page")||1)+1:1;if(!e||!(0,P.isObject)(e))try{e=await Us.loadBanList(s,o)}catch(c){return void i.core.ui.toasts.showError(c)}let{list:r,hasMore:l}=e;this.marks.set("has-more",l),r=((0,P.isArray)(r)?r:[]).map((t=>(t.time=Number(Ms(t.datetime).format("X")),t.ban_type=Ds[t.ban_type],t))),this.marks.set("page",o),this._table.rows.set(r,{merge:t})}_renderTable(t){let e=i.core.isUserModerator?4:3;return qt.vu.create("tbody",null,t.size?null:qt.vu.create("tr",{className:"table__message"},qt.vu.create("td",{colSpan:e},i.core.i18n("banned-profiles."+(this.marks.get("query").length>0?"search-":"")+"empty"))),t.items.map((t=>{const e=t.data.ban_type,s=i.core.i18n("page-banned-profiles.source."+e.toString());let n=t.data.reason,a=null;return e===Ds.COMMENT||e===Ds.STORY?t.data.ban_source_url&&(a=qt.vu.create("a",{href:t.data.ban_source_url,target:"_blank"},s)):n+=", "+s,qt.vu.create("tr",{key:t.id,"data-id":t.id},qt.vu.create("td",null,qt.vu.create(Vt.N,{name:t.data.user_name,avatar:t.data.user_avatar})),qt.vu.create("td",{className:"caption banned-profiles__reason"},n,a),qt.vu.create("td",null,qt.vu.create("time",{className:"caption hint",dateTime:t.data.datetime},Ms(t.data.datetime).fromNow())),i.core.isUserModerator&&qt.vu.create("td",null,qt.vu.create(Vt.N,{name:t.data.moderator_name,avatar:t.data.moderator_avatar,short:!0})))})),Boolean(this.marks.get("has-more"))&&qt.vu.create("tr",{key:"hasMore"},qt.vu.create("td",{colSpan:e,className:"banned-profiles__more"},qt.vu.create("button",{type:"button",className:"button button_success"},i.core.i18n("page-banned-profiles.more")))))}}class Ps{static async loadUsers(t={}){const e=t.page||1,s=t.sort||"default",i=t.search||"",n=t.internal?1:0,{data:a}=await A.cf.getOrFail("/ajax/get_approved_users.php",{page:e,sort:s,search:i,internal:n});return{users:a.users,total:a.total,hasMore:a.has_more}}}const Ls=new ut.xs({DEFAULT:"default",STORIES:"stories",NAME:"name"});const Rs=s(19755);class js extends m.T3{route(t,e){const{page:s,internal:n,sort:a,hasMore:o}=i.core.config("modules.approved-users"),{q:l}=r.Utils.getQueryParams(i.core.location.search);let c;switch(a){case"stories":c=Ls.STORIES;break;case"name":c=Ls.NAME;break;default:c=Ls.DEFAULT}return this.state.update({page:s,hasMore:o,internal:n,search:l,sort:c}),this.marks.set("first-load",!0),this.show(),e()}render(){return this.isRendered||(this.$el=Rs(".page-approved-users"),this.$els={container:this.$(".users-list__container").addClass("users-list__container_no-pagination"),usersList:this.$(".users-list__grid"),showMore:this.$(".users-list__show-more button"),sortOrder:this.$('.page-approved-users__filter span[data-role="sort"]'),message:this.$(".users-list__message"),spinner:{top:this.$(".page-approved-users__spinner_top"),bottom:this.$(".page-approved-users__spinner_bottom")},search:{form:this.$(".page-approved-users__form"),input:this.$('.input[data-role="search"]')},navigation:{menu:this.$(".menu_horizontal"),items:this.$(".menu__item").not(".menu__item_right")}},this._form=new at.x(this.$els.search.form),this.listenTo(this._form,"submit",(t=>{t.preventDefault(),this.state.data.search=this._searchInput.value})),this._searchInput=new Tt.u3({$el:this.$els.search.input,sanitizerRules:[Tt.op.trim()]}),this._form.add(this._searchInput),this.topSpinner=i.core.ui.player.createAnimation("stories-spinner",{$parent:this.$els.spinner.top}),this.bottomSpinner=i.core.ui.player.createAnimation("stories-spinner",{$parent:this.$els.spinner.bottom}),this.$els.navigation.items.on("click",(t=>this._toggleListType(t))),this.$els.showMore.on("click",(()=>this._loadUsers())),this.$els.sortOrder.on("click",(()=>this._toggleSortMode())),this.listenTo(i.core.ui,"document-scroll",(0,P.throttle)(this._handleScrolling,200)),i.core.ui.screen=G.dt.APPROVED_USERS,super.render()),this}_syncComponent(t){if(!this.isShown)return;let e=t.diff("sync");if(!e.length)return;let s=!1;for(let o of e){let{property:t,value:e}=o;if("search"===t&&(this._searchInput.value=e,s=!0),"sort"===t&&(this.$els.sortOrder.find("span:first-child").text(i.core.i18n("approved-users.sort-mode."+e.toString()).toLowerCase()),s=!0),"internal"===t){const t=this.state.data.internal?'[href*="staff"]':':not([href*="staff"])';this.$els.navigation.items.removeClass("menu__item_current").filter(t).addClass("menu__item_current"),s=!0}}t.save("sync"),!this.marks.has("first-load")&&s&&this._loadUsers(!0),this.marks.delete("first-load");let n=this.state.plainData,a="/approved-users"+(n.internal?"/staff":"")+(n.sort!==Ls.DEFAULT?"/"+n.sort.valueOf():"");n.search&&n.search.length&&(a+=(a.includes("?")?"&":"?")+"q="+encodeURIComponent(n.search)),i.core.replaceState({},"",a,!1)}_handleScrolling(){this.state.data.hasMore&&!this.marks.get("loading")&&i.core.ui.elementWillSoonScrolled(this.$els.spinner.bottom[0])&&this._loadUsers()}_toggleSortMode(){let t=this.marks.get("sort-popup");if(!t){const e=this.state.data.sort||Ls.DEFAULT;t=a.g.popupEnum(this.$els.sortOrder,Ls,"approved-users.sort-mode",e),this.listenTo(t,"change",((e,s)=>{this.state.data.sort=s,t.hide()})),this.marks.set("sort-popup",t)}t.toggle()}_toggleListType(t){t.preventDefault(),this.state.data.internal=-1!==Rs(t.currentTarget).attr("href").indexOf("staff")}_loadUsers(t=!1){if(!t&&!this.state.data.hasMore)return;let{sort:e,search:s,internal:n,page:a}=this.state.data,o=this.lastRequestId=(0,P.uniqueId)("approved-users_");this._toggleLoadAnimation(!0,t),t&&(this.$els.container.hide(),this.$els.usersList.html(""),this.state.data.page=a=0),Ps.loadUsers({page:a+1,sort:e.valueOf(),search:s,internal:n}).then((async e=>{await r.Utils.delay(400),o===this.lastRequestId&&(this._toggleLoadAnimation(!1),(0,P.isArray)(e.users)&&(e.users.length>0?(this._toggleNoUsers(!1),this.$els.usersList.append(this._renderUsers(e.users)),this.state.data.page++):t&&this._toggleNoUsers(!0)),this.state.data.hasMore=Boolean(e.hasMore))})).catch((t=>{this._toggleLoadAnimation(!1),this._toggleNoUsers(!0),i.core.logger.error("approved-users","error loading more approved users",t)}))}_toggleNoUsers(t){(0,P.isUndefined)(t)||(t?(this.$els.message.show(),this.$els.container.hide()):(this.$els.message.hide(),this.$els.container.show()))}_toggleLoadAnimation(t,e=!0){if(t){(e?this.topSpinner:this.bottomSpinner).togglePlay(!0),this.marks.set("loading",!0)}else this.topSpinner.togglePlay(!1),this.bottomSpinner.togglePlay(!1),this.marks.set("loading",!1)}_renderUsers(t){if(!(0,P.isArray)(t)||t.length<1)return;let e=[],s=this.state.data.internal;return t.map((t=>{const i=t.stories>0?`${t.stories} ${r.Utils.pluralNounRU(t.stories,["пост","поста","постов"])}`:"Ещё нет постов";e.push(function(t){var e,s="";return Array.prototype.join,s+='<li class="users-list__user">\n\t<div class="users-list__avatar-wrapper">\n\t\t<div class="avatar avatar_medium-big">\n\t\t\t',t.avatar?s+='\n\t\t\t\t<img src="'+(null==(e=t.avatar)?"":e)+'" alt="Аватар пользователя '+(null==(e=t.name)?"":e)+'">\n\t\t\t':s+='\n\t\t\t\t<span class="avatar__default"></span>\n\t\t\t',s+='\n\t\t</div>\n\t</div>\n\t<div class="users-list__information">\n\t\t<a class="users-list__nick" href="'+(null==(e=t.url)?"":e)+'">\n\t\t\t<span class="users-list__nick-inner" data-profile="true" data-name="'+(null==(e=t.name)?"":e)+'">\n\t\t\t\t'+(null==(e=t.isStaffPage?t.name:t.approved)?"":e)+'\n\t\t\t</span>\n\t\t\t<span class="users-list__approved">\n\t\t\t\t',t.isStaffPage?s+='\n\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__pikabu-team"><use xlink:href="#icon--ui__pikabu-team"></use></svg>\n\t\t\t\t':s+='\n\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__approved"><use xlink:href="#icon--ui__approved"></use></svg>\n\t\t\t\t',s+='\n\t\t\t</span>\n\t\t</a>\n\t\t<span class="users-list__posts-count">\n\t\t\t',t.isStaffPage?s+="\n\t\t\t\t"+(null==(e=""!==t.approvedRole?t.approvedRole:t.approved)?"":e)+"\n\t\t\t":s+="\n\t\t\t\t"+(null==(e=t.storiesCount)?"":e)+"\n\t\t\t",s+="\n\t\t</span>\n\t</div>\n</li>\n"}({storiesCount:i,isStaffPage:s,url:t.url,name:t.name,avatar:t.avatar,approved:t.value,approvedRole:t.role}))})),e.join("")}get state(){let t=this._options.state;return t||(t=this._options.state=new lt.Lo({page:void 0,hasMore:void 0,internal:void 0,search:void 0,sort:void 0}),this.listenTo(t,lt.u$.CHANGE,(0,P.debounce)(this._syncComponent.bind(this),20))),this._options.state}set lastRequestId(t){t&&(this._options.lastRequestId=t)}get lastRequestId(){return this._options.lastRequestId}}const Bs=s(19755);class qs extends m.T3{render(){return this.isRendered||(this.$el=Bs(".stories-feed"),i.core.ui.screen=G.dt.SAVED,this._feed=new l._D({$el:this.$el,feedName:"most-saved",focused:!0}),new l.RP({$el:Bs(".feed-panel"),feed:this._feed,isDisableCalendar:!0}),super.render()),this}}const Fs=s(19755);class Vs extends m.T3{render(){return this.isRendered||(this.$el=Fs(".stories-feed"),i.core.ui.screen=G.dt.DISCUSSED,this._feed=new l._D({$el:this.$el,feedName:"disputed",focused:!0}),new l.RP({$el:Fs(".feed-panel"),feed:this._feed,isDisableCalendar:!0}),super.render()),this}}const Zs=s(19755);class Ws extends m.T3{route(t,e){return this.ctx=t,this.isLiked=void 0===t.params.not,this.show(),e()}render(){return this.isRendered||(this.$el=Zs(".stories-liked"),this.$els.message=Zs(".stories-feed > .stories-feed__message"),this._form=new at.x(this.$("form")),this.listenTo(this._form,"submit",this._formSubmit),this._feed=new l._D({$el:Zs(".stories-feed"),feedName:"liked",focused:!0}),i.default.ui.screen=G.dt.USER_LIKED,this.listenTo(this._feed,"loaded",((t,e)=>{let s=!(this._feed.stories.size||(0,P.isArray)(t.stories)&&t.stories.length);e&&s&&this.$els.message.html(i.default.i18n(this._lastSearch.length?"stories-feed.eof.search-empty":"stories-feed.eof.empty"))})),this._searchInput=new Tt.u3({$el:this.$(".input"),sanitizerRules:[Tt.op.trim()]}),this.listenTo(this._searchInput,"input",(t=>{this._submitButton.disabled=this._lastSearch===t})),this._lastSearch=this._searchInput.value,this._submitButton=new Ft.y3(this.$("button")),super.render()),this}async _formSubmit(t){t.preventDefault();let e=this._searchInput.value;e!==this._lastSearch&&(this._lastSearch=e,this._submitButton.progress=!0,await this._updateFeed(),this._submitButton.progress=!1,this._submitButton.disabled=!0)}_updateEndOfFeedMessage(){this.$els.message.text(i.default.i18n(this._lastSearch.length?"stories-feed.eof.search":"stories-feed.eof.default"))}async _updateFeed(){let t=this._searchInput.value;this._updateEndOfFeedMessage(),this._feed.clear().searchParams.set("search",t),this._feed.requestUrl=i.default.location.pathname,await this._feed.loadStories(!1)}get isLiked(){return this._options.isLiked}set isLiked(t){this._options.isLiked!==(t=Boolean(t))&&(this._options.isLiked=t,this.isRendered&&(this._lastSearch=this._searchInput.value="",this._updateFeed()))}}var zs=s(51474),Hs=s(3436);var Gs=s(36005);s(41773);function Ys(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function Ks(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?Ys(Object(s),!0).forEach((function(e){Qs(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Ys(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function Qs(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const Xs=s(19755);class Js extends m.T3{route(t,e){return this.ctx=t,this.categoryId=t.params.cid||0,this.show(),e()}render(){if(this.isRendered)return this;this.categories=Et.YD.categories,this.listenTo(this.categories,lt.u$.CHANGE,(t=>{const e=this.$els.categories.find(`[data-id="${t.id}"]`);e.find('[data-role="count"]').text(t.data.count),e.find('[data-role="name"]').text(t.data.name)})),this.$el=Xs(".saved-stories"),this.$els={form:this.$("form"),message:Xs(".stories-feed > .stories-feed__message"),categories:this.$(".saved-stories__categories"),share:this.$(".saved-stories__share"),shareSwitchBtn:this.$(".saved-stories__share-switch"),copyLinkBtn:this.$(".saved-stories__copy-link"),search:this.$('.input[data-role="find"]')},this._isCheckboxChangedAutomatically=!1,this.$el.on("click",".saved-stories__category",(t=>{this.$els.categories.hasClass("saved-stories__categories_ordering")||(this.categoryId=Number(t.currentTarget.getAttribute("data-id")))}));let t=this.$(".saved-stories__category.button_success").data("id");return this.categoryId=t?Number(t):this.categoryId,this._searchInput=new Tt.u3({$el:this.$els.search,sanitizerRules:[Tt.op.trim()]}),this.listenTo(this._searchInput,"input",(t=>{this._submitButton.disabled=this._lastSearch===t})),this._lastSearch=this._searchInput.value,this._submitButton=new Ft.y3(this.$els.search.find("button")),this.listenTo(new at.x(this.$els.form),"submit",this._formSubmit),this._feed=new l._D({$el:Xs(".stories-feed"),feedName:"saved",focused:!0}),i.default.ui.screen=G.dt.USER_SAVED_STORIES,this.listenTo(this._feed,"loaded",((t,e)=>{let s=!(this._feed.stories.size||(0,P.isArray)(t.stories)&&t.stories.length);e&&s&&this.$els.message.html(this._lastSearch.length?i.default.i18n("stories-feed.eof.search-empty"):"Здесь пока что нет ни одного поста")})),this.shareMsg=new Q.O({destroyAfterHide:!1,addCloseButton:!0,closeAfter:3e3}),this.$els.shareSwitchBtn.length&&(this._shareSwitch=new vs.m(this.$els.shareSwitchBtn),this._copyLink=new Ft.y3(this.$els.copyLinkBtn),this.listenTo(this._shareSwitch,"change",(async t=>{if(this._isCheckboxChangedAutomatically)return void(this._isCheckboxChangedAutomatically=!1);this._copyLink.progress=!0;let e=await Hs.b.share(t,this.categoryId);this._copyLink.progress=!1,this._copyLink.disabled=!e.is_shared,this.shareMsg.hide(),this.timeout("reopen",200,(()=>{this.shareMsg.content=i.default.i18n("page-stories-saved.category."+(e.is_shared?"shared":"unshared")),this.shareMsg.show()})),this.categories.get(this.categoryId).data.is_shared=Boolean(e.is_shared)})),this.listenTo(this._copyLink,"click",(()=>{const t=this.$el.data("share-url")+this.categoryId;r.Utils.copyToClipboard(t),this.shareMsg.hide(),this.timeout("reopen",200,(()=>{this.shareMsg.content=i.default.i18n("page-stories-saved.copy-link"),this.shareMsg.show()}))}))),this._initBookmarks(),super.render(),this}_updateEndOfFeedMessage(){this.$els.message.text(i.default.i18n(this._lastSearch.length?"stories-feed.eof.search":"stories-feed.eof.default"))}async _formSubmit(t){t.preventDefault();let e=this._searchInput.value;e!==this._lastSearch&&(this._lastSearch=e,this._submitButton.progress=!0,await this._updateFeed(),this._submitButton.progress=!1,this._submitButton.disabled=!0)}async _updateFeed(){let t=this._searchInput.value;this._updateEndOfFeedMessage(),this._feed.clear().searchParams.set("search",t),this._feed.requestUrl=i.default.history.location.pathname+"?search="+t,await this._feed.loadStories(!1)}_initBookmarks(){this.$els=Ks(Ks({},this.$els),{},{categoryAddBtn:this.$els.categories.find('button[data-role="add"]'),categoryRemoveBtn:this.$('button[data-role="remove"]'),categoryRenameBtn:this.$('button[data-role="edit"]'),categoryOrderBtn:this.$('button[data-role="order"]'),nameInput:this.$(".saved-stories__input")}),this._isOrderingMode=!1,this.listenTo(this.categories,lt.u$.UPDATE,((t,e)=>{var s,i;(null===(s=e.removed)||void 0===s?void 0:s.length)>0&&e.removed.forEach((t=>{this.$els.categories.find(`[data-id="${t.id}"]`).remove()})),(null===(i=e.inserted)||void 0===i?void 0:i.length)>0&&e.inserted.forEach((t=>{this.$els.categories.append(Xs(function(t){var e,s="";return s+'<button type="button" data-id="'+(null==(e=t.id)?"":e)+'" data-shared="0" class="saved-stories__category button_small">\n    <span data-role="name">'+(null==(e=t.name)?"":e)+'</span> <b data-role="count">0</b>\n</button>'}(t.data)))}))})),this._initRename(),this.$els.categoryRemoveBtn.on("click",(t=>{t.preventDefault(),this._removeCategory(this.categoryId)})),this.$els.categoryAddBtn.on("click",(t=>{this._showAddCategoryPopup(t.target)})),this._initSortableBlock(),this.$els.categoryOrderBtn.on("click",(t=>{this._isOrderingMode=!this._isOrderingMode,this.$els.categoryOrderBtn.toggleClass("button_success",this._isOrderingMode),this.$els.categories.toggleClass("saved-stories__categories_ordering",this._isOrderingMode),this._sortableCategories.options.sort=this._isOrderingMode}))}_initRename(){const t=new Tt.u3({$el:this.$els.nameInput.closest(".input__box"),addClearButton:!1});let e;this.$els.categoryRenameBtn.on("click",(()=>{const t=this.$els.nameInput[0];t.focus(),t.setSelectionRange(t.value.length,t.value.length)}));const s=()=>{e===this.categoryId&&this._renameCategory(this.categoryId,t.value)},i=(0,P.debounce)(s,800);this.listenTo(t,"input",(()=>{e=this.categoryId,this.$els.categoryRenameBtn.attr("data-state",""),i()})),this.listenTo(t,"blur",(()=>{s(),i.cancel()}))}async _renameCategory(t,e){if(!(e=e.trim()))return;if(this.categories.get(t).data.name===e)return;const s=this.$els.categoryRenameBtn;if(s.attr("data-state",""),Et.YD.isCategoryNameAvailable(e,t))try{await Et.YD.renameCategory(e,t),t===this.categoryId&&s.attr("data-state","success")}catch(n){i.default.ui.toasts.showError(n),t===this.categoryId&&s.attr("data-state","error")}else s.attr("data-state","error"),i.default.ui.toasts.showError(i.default.i18n("page-settings.save-categories.name-duplication")||"Ошибка")}_showAddCategoryPopup(t){const e=new R._({target:t,direction:R.Lh.BOTTOM,alignment:R.SE.CENTER,destroyAfterHide:!0,interactive:!0,autoCloseOutsideClick:!0,hideByScroll:!0,showArrow:!0,content:'<form class="saved-stories__category-add">\n    <input type="text" maxlength="25" placeholder="Новая категория" />\n    <button type="submit" disabled class="button_success">Создать</button>\n</form>'}),s=e.content[0].querySelector("form"),n=e.content[0].querySelector("input"),a=e.content[0].querySelector("button");n.addEventListener("keyup",(()=>{a.disabled=0===n.value.length})),s.addEventListener("submit",(async t=>{t.preventDefault();const s=n.value;if(null!=s&&s.length)if(Et.YD.isCategoryNameAvailable(s)){a.disabled=!0,n.disabled=!0;try{await Et.YD.add(s,{component_name:"saved"}),e.hide()}catch(o){i.default.ui.toasts.showError(o),a.disabled=!1,n.disabled=!1}}else i.default.ui.toasts.showError(i.default.i18n("page-settings.save-categories.name-duplication")||"Ошибка")})),e.show(),setTimeout((()=>n.focus()),100)}_initSortableBlock(){this._sortableCategories=new zs.ZP(this.$els.categories.get(0),{sort:!1,animation:200,delay:10,ghostClass:"saved-stories__category_ghost",chosenClass:"saved-stories__category_chosen",filter:".saved-stories__order-btn",preventOnFilter:!0,onEnd:t=>{const e=[];t.target.querySelectorAll(".saved-stories__category").forEach((t=>{e.push(t.dataset.id)})),Et.YD.setCategoriesOrder(e).catch((t=>{i.default.ui.toasts.showError(t)}))}})}_removeCategory(t){if(0===t)return;const e=this.categories.get(t),s=this.categories.items.indexOf(e),n=this.categories.items[0===s?1:s-1].id,a=e=>{Et.YD.deleteCategory(t,e).then((()=>{this.categoryId=-1!==e?e:n}),(t=>{i.default.ui.toasts.showError(t)}))};if(e.data.count>0){const t=function(t){var e="",s=Gs.escape;if(Array.prototype.join,e+='<form class="settings-saves__popup">\n\t<p class="settings-saves__group">В удаляемой категории <b>'+s(t.name)+'</b> имеются сохраненные посты.\n\t\t<br>Какое действие необходимо выполнить с постами из этой категории?</p>\n\t<div class="settings-saves__group settings-saves__group_mb">\n\t\t<p class="settings-saves__option"><label><input type="radio" name="categoryDeleteType" value="0" checked>удалить все посты вместе с категорией</label></p>\n\t\t<p class="settings-saves__option"><label><input type="radio" name="categoryDeleteType" value="1">переместить все посты в\n\t\t\t\t',1===t.categories.length)e+=' категорию <b>Общее</b>\n\t\t\t\t<input type="hidden" value="0" name="moveStoriesToID">\n\t\t\t\t';else{e+='\n\t\t\t\tдругую категорию\n\t\t\t\t<div class="settings-saves__group settings-saves__group_ml">\n\t\t\t\t\t<select data-role="listbox" name="moveStoriesToID">\n\t\t\t\t\t\t';for(var i=0;i<t.categories.length;i++)e+='\n\t\t\t\t\t\t<option value="'+s(t.categories[i].id)+'" ',0==t.categories[i].id&&(e+='selected="selected"'),e+=">\n\t\t\t\t\t\t\t"+s(t.categories[i].name)+"</option>\n\t\t\t\t\t\t";e+="\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t\t"}return e+"\n\t\t\t</label>\n\t\t</p>\n\t</div>\n</form>\n"}({categories:this.categories.items.filter((t=>t.id!==e.id)).map((t=>t.data)),name:e.data.name,id:e.id}),s=new R.LD({header:"Удалить категорию",indent:!0,content:t});new at.x(s.content.find("form")),s.addButtonIntoFooter(i.default.i18n("page-settings.save-categories.yes"),(async()=>{const t=s.content.find('.radio_checked [name="categoryDeleteType"]').val(),e=s.content.find('[name="moveStoriesToID"]').val(),i=Number(t)?Number(e):-1;a(i),s.hide()}),d.j.SUCCESS),s.addButtonIntoFooter(i.default.i18n("page-settings.save-categories.no"),(()=>{s.hide()})),s.show()}else a(-1)}get categoryId(){return this._options.categoryId}set categoryId(t){let e=this._options.categoryId;if(e===(t="number"==typeof t?t:parseInt(t,10)))return;if(this._options.categoryId=t,i.default.storage["saved-stories-current-category"]=t,(0,P.isUndefined)(e)||!this.isRendered)return;i.default.history.replaceState({},"Моя лента","/saved-stories"+(t>=0?"/"+t:"")),this._updateFeed();const s=this.categories.get(t);this.$els.categories.find(".saved-stories__category.button_success").removeClass("button_success"),this.$els.categories.find(`[data-id="${t}"]`).addClass("button_success"),this._lastSearch=this._searchInput.value="";const n=Boolean(s.data.is_shared);n!==this._shareSwitch.checked&&(this._isCheckboxChangedAutomatically=!0,this._shareSwitch.checked=n,this._copyLink.disabled=!n,this._isCheckboxChangedAutomatically=!1),this.$els.nameInput.val(s.data.name);const a=0===t;this.$els.nameInput.prop("readonly",a),this.$els.categoryRemoveBtn.prop("disabled",a),this.$els.categoryRenameBtn.prop("disabled",a),this.$els.categoryRenameBtn.attr("data-state","")}}const ti=s(19755);class ei extends m.T3{render(){if(this.isRendered)return this;if(this.$el=ti(".tags-search"),this.$els={searchFrom:this.$(".tags-search__form"),searchInput:this.$("#tags-search-search"),tagsSection:this.$(".tags__section")},this.$els.searchFrom.length){let t=new at.x(this.$els.searchFrom);this.search=new Tt.u3((0,P.defaults)({$el:this.$els.searchInput.closest(".input")},{validationHint:{direction:R.Lh.TOP,alignment:R.SE.CENTER}})),this.search.validationRules={"page-tags-search.form.invalid-text-length":t=>1!==t.length},this.listenTo(t,"submit",this._handleSearch),this._lastSearchedText=this.$els.searchInput.val()}return super.render(),this}async _handleSearch(){const t=this.$els.searchInput.val();await this.search.checkValidity()&&(i.default.searchParams.delete("q"),i.default.searchParams.set("q",t),i.default.location.href=i.default.location.pathname+"?"+i.default.searchParams.toString())}static _updateHistoryState(t){let e=`${t} - поиск тегов`.replace(/[<>&]/gi,""),s="?q="+encodeURIComponent(t);i.default.replaceState({},e,s,!0),document.title=e}}var si=s(32617),ii=s(65801),ni=s(61950);function ai(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function oi(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?ai(Object(s),!0).forEach((function(e){ri(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ai(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function ri(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class li extends fs.Vd{constructor(t){super(oi(oi({},t),{},{useNumericIds:!1})),this._options.items.DataObject=fs.U}async _requestItems(t,e){let s=await ot.Hx.searchMerge(t);return s&&s.forEach((t=>this.tags.set(t.name.toLowerCase(),t))),s}addTag(t,e){let s={label:t,info:e},i=t.toLowerCase();this.tags.has(i)||this.tags.set(i,s)}get tags(){return(0,P.isObject)(i.default.storage.cacheDropList)||(i.default.storage.cacheDropList={}),(0,P.isObject)(i.default.storage.cacheDropList.mergeTags)?i.default.storage.cacheDropList.mergeTags:i.default.storage.cacheDropList.mergeTags=new Map}get cache(){return(0,P.isObject)(i.default.storage.cacheDropList)||(i.default.storage.cacheDropList={}),(0,P.isObject)(i.default.storage.cacheDropList.mergeTagsSearchResults)?i.default.storage.cacheDropList.mergeTagsSearchResults:i.default.storage.cacheDropList.mergeTagsSearchResults=new Map}}var ci=s(36005);var di=s(36005);var ui=s(36005);var pi=s(36005);function hi(t){var e="",s=pi.escape;return e+='<div class="tm-conflicts__issue">\n\tОбъединение тега\n\t<a href="/tag/'+s(t.tag1)+'" class="tm-tag" target="_blank">\n\t\t<span class="tm-tag__name">'+s(t.tag1)+'</span>\n\t\t<span class="tm-tag__counter">'+s(t.count1)+'</span>\n\t</a>\n\tв тег\n\t<a href="/tag/'+s(t.tag2)+'" class="tm-tag" target="_blank">\n        <span class="tm-tag__name">'+s(t.tag2)+'</span>\n        <span class="tm-tag__counter">'+s(t.count2)+"</span>\n    </a>\n\tранее было отменено модератором\n</div>"}var _i=s(36005);function mi(t){var e="",s=_i.escape;Array.prototype.join;return e+='<div class="tm-conflicts__issue">\n\tДля тега\n\t<a href="/tag/'+s(t.tag1)+'" class="tm-tag" target="_blank">\n\t\t<span class="tm-tag__name">'+s(t.tag1)+'</span>\n\t\t<span class="tm-tag__counter">'+s(t.count1)+'</span>\n\t</a>\n\tуже есть предложение объединения в тег\n\t<a href="/tag/'+s(t.tag2)+'" class="tm-tag" target="_blank">\n\t\t<span class="tm-tag__name">'+s(t.tag2)+'</span>\n\t\t<span class="tm-tag__counter">'+s(t.count2)+"</span>\n\t</a>\n\t",t.isModerator&&t.ruleId>0&&(e+='\n\t\t<button class="button_small"\n\t\t\tdata-tag-from="'+s(t.tag1)+'"\n\t\t\tdata-tag-to="'+s(t.tag2)+'"\n\t\t\tdata-id="'+s(t.ruleId)+'"\n\t\t    data-is-approved="false"\n\t\t\tdata-role="cancel">Отклонить</button>\n\t'),e+="\n</div>"}var gi=s(36005);function fi(t){var e="",s=gi.escape;Array.prototype.join;return e+='<div class="tm-conflicts__issue">\n\tТег\n\t<a href="/tag/'+s(t.tag1)+'" class="tm-tag" target="_blank">\n\t\t<span class="tm-tag__name">'+s(t.tag1)+'</span>\n\t\t<span class="tm-tag__counter">'+s(t.count1)+'</span>\n\t</a>\n\tуже имеет объединение в тег\n\t<a href="/tag/'+s(t.tag2)+'" class="tm-tag" target="_blank">\n\t\t<span class="tm-tag__name">'+s(t.tag2)+'</span>\n\t\t<span class="tm-tag__counter">'+s(t.count2)+"</span>\n\t</a>\n\t",t.isModerator&&t.ruleId>0&&(e+='\n\t\t<button class="button_small"\n\t\t\tdata-tag-from="'+s(t.tag1)+'"\n\t\t\tdata-tag-to="'+s(t.tag2)+'"\n\t\t\tdata-id="'+s(t.ruleId)+'"\n\t\t\tdata-is-approved="true"\n\t\t\tdata-role="cancel">отменить правило</button>\n\t'),e+="\n</div>"}var vi=s(36005);function bi(t){var e="",s=vi.escape;Array.prototype.join;return e+='<div class="tm-conflicts__issue">\n\tДля тега\n\t<a href="/tag/'+s(t.tag2)+'" class="tm-tag" target="_blank">\n\t\t<span class="tm-tag__name">'+s(t.tag2)+'</span>\n\t\t<span class="tm-tag__counter">'+s(t.count2)+'</span>\n\t</a>\n\tсуществует объединение тега\n\t<a href="/tag/'+s(t.tag1)+'" class="tm-tag" target="_blank">\n        <span class="tm-tag__name">'+s(t.tag1)+'</span>\n        <span class="tm-tag__counter">'+s(t.count1)+"</span>\n    </a>\n\t",t.isModerator&&t.ruleId>0&&(e+='\n        <button class="button_small"\n            data-tag-from="'+s(t.tag1)+'"\n            data-tag-to="'+s(t.tag2)+'"\n            data-id="'+s(t.ruleId)+'"\n            data-is-approved="true"\n            data-role="cancel">отменить правило</button>\n\t\t<button class="button_small"\n\t        data-tag="'+s(t.tag1)+'"\n\t        data-id="'+s(t.ruleId)+'"\n\t        data-is-approved="true"\n\t        data-role="remerge">переобъединить</button>\n    '),e+="\n</div>"}var yi=s(36005);function wi(t){var e="",s=yi.escape;return e+='<div class="tm-conflicts__issue">\n\tТег\n\t<a href="/tag/'+s(t.tag1)+'" class="tm-tag" target="_blank">\n\t\t<span class="tm-tag__name">'+s(t.tag1)+'</span>\n\t\t<span class="tm-tag__counter">'+s(t.count1)+"</span>\n\t</a>\n\tне найден среди тегов\n</div>"}var ki=s(36005);function xi(t){var e="",s=ki.escape;Array.prototype.join;return e+='<div class="tm-conflicts__issue">\n\tПредложение на объединение тега\n\t<a href="/tag/'+s(t.tag1)+'" class="tm-tag" target="_blank">\n\t\t<span class="tm-tag__name">'+s(t.tag1)+'</span>\n\t\t<span class="tm-tag__counter">'+s(t.count1)+'</span>\n\t</a>\n\tв тег\n\t<a href="/tag/'+s(t.tag2)+'" class="tm-tag" target="_blank">\n        <span class="tm-tag__name">'+s(t.tag2)+'</span>\n        <span class="tm-tag__counter">'+s(t.count2)+"</span>\n    </a>\n\tранее было отклонено модератором\n\t",t.isModerator&&(e+='\n\t<button class="button_small"\n\t        data-tag-from="'+s(t.tag1)+'"\n\t        data-tag-to="'+s(t.tag2)+'"\n\t        data-role="cancel-rejection">отменить отклонение</button>\n\t'),e+="\n</div>"}const Si=s(19755);class $i extends m.T3{render(){return this.el=document.querySelector(".tags-merge"),this.els={tagsSearchForm:this.el.querySelector(".tags-search"),tagsFoundSectionGroup:this.el.querySelector(".tags-found"),paginationContainer:this.el.querySelector(".tags-found__pagination-container"),tagsFoundList:this.el.querySelector(".tags-found__list"),mergeProposalForm:this.el.querySelector(".merge-proposal"),fromProposalContainer:this.el.querySelector('.merge-proposal__find[data-role="from"]'),storiesQuantityButton:this.el.querySelector(".tags-search__quantity-button"),storiesQuantityNumber:this.el.querySelector(".tags-search__quantity-number"),mergingSection:this.el.querySelector(".merging-section"),bannedSection:this.el.querySelector(".tm-banned-section")},this.$els={mergeProposalForm:this.$(".merge-proposal"),mergeProposalFormButton:this.$(".merge-proposal button"),conflicts:this.$(".tm-conflicts"),conflictsBody:this.$(".tm-conflicts__body"),conflictsMessage:this.$(".tm-conflicts__message"),conflictsApplyButton:this.$('.tm-conflicts button[data-role="apply"]'),conflictsBackButton:this.$('.tm-conflicts button[data-role="back"]')},this._data=i.default.config("modules.params"),this._loadingButton={$button:null,button:null},this.els.tagsSearchForm&&this._initTagsSearch(),this.els.mergingSection&&this._initMergingSection(),this.els.mergeProposalForm&&this._initMergeProposal(),this.els.bannedSection&&this._initBannedSection(),this.$els.conflicts.length>0&&this._initConflicts(),this}async _initTagsSearch(){this.els.tagsSearchInput=this.els.tagsSearchForm.querySelector(".input"),this._tagsSearchInput=new Tt.u3(this.els.tagsSearchInput),this._tagsSearchForm=new at.x(this.els.tagsSearchForm),this._tagsSearchForm.add(this._tagsSearchInput),this._storiesQuantityNumber=this.els.storiesQuantityNumber.innerText||30,this.els.tagsSearchForm.dataset.lastQuantity=this._storiesQuantityNumber,this._initQuantityPicker(),this.els.storiesQuantityButton.addEventListener("click",this._quantityBalloonShow.bind(this)),this.listenTo(this._tagsSearchForm,"submit",this._handleSearchSubmit)}async _initMergingSection(){this.els.nonApprovedForm=this.els.mergingSection.querySelector(".merging-section__item_non-approved"),this.els.nonApprovedInput=this.els.nonApprovedForm.querySelector('.input[data-role="find"]'),this.els.nonApprovedRulesList=this.els.nonApprovedForm.querySelector(".tm-small-search__list"),this.els.approvedForm=this.els.mergingSection.querySelector(".merging-section__item_approved"),this.els.approvedInput=this.els.approvedForm.querySelector('.input[data-role="find"]'),this.els.approvedRulesList=this.els.approvedForm.querySelector(".tm-small-search__list"),this._rulesLimit=30,this._initRules(!1),this._initRules(!0),this.els.mergingSection.addEventListener("click",this._handleBtnMoreClick.bind(this)),this.els.approvedRulesList.addEventListener("click",this._rollbackRule.bind(this)),this.els.nonApprovedRulesList.addEventListener("click",this._approveRule.bind(this)),this.els.nonApprovedRulesList.addEventListener("click",this._disapproveRule.bind(this)),this._approvedForm=new at.x(this.els.approvedForm),this._approvedInput=new Tt.u3(this.els.approvedInput),this._approvedForm.add(this._approvedInput),this.listenTo(this._approvedForm,"submit",this._handleSmallSearchSubmit),this._nonApprovedForm=new at.x(this.els.nonApprovedForm),this._nonApprovedInput=new Tt.u3(this.els.nonApprovedInput),this._nonApprovedForm.add(this._nonApprovedInput),this.listenTo(this._nonApprovedForm,"submit",this._handleSmallSearchSubmit)}async _initMergeProposal(){this._UIInputsByInputs=new Map,this._mergeProposalForm=new at.x(this.els.mergeProposalForm),this.listenTo(this._mergeProposalForm,"submit",this._handleProposalSubmit),this._initProposalInputs(),this.els.fromProposalContainer.addEventListener("focusin",this._handleProposalFocus.bind(this)),this.els.fromProposalContainer.addEventListener("click",this._handleProposalRemove.bind(this)),this.els.tagsFoundList.addEventListener("click",this._handleFoundTagClick.bind(this))}async _initBannedSection(){this.els.bannedSearchForm=this.els.bannedSection.querySelector(".tm-banned-container__item_search"),this.els.bannedSearchInput=this.els.bannedSearchForm.querySelector(".input"),this.els.bannedList=this.els.bannedSearchForm.querySelector(".tm-small-search__list"),this.els.bannedSearchForm.addEventListener("click",this._handleBtnMoreClick.bind(this)),this.els.bannedList.addEventListener("click",this._unbanTag.bind(this)),this._bannedSearchForm=new at.x(this.els.bannedSearchForm),this._bannedSearchInput=new Tt.u3(this.els.bannedSearchInput),this._bannedSearchForm.add(this._bannedSearchInput),this.listenTo(this._bannedSearchForm,"submit",this._handleSmallSearchSubmit),this.els.bannedAddForm=this.els.bannedSection.querySelector(".tm-banned-container__item_add"),this.els.bannedAddInput=this.els.bannedAddForm.querySelector(".input"),this._bannedAddForm=new at.x(this.els.bannedAddForm);let t=this.els.bannedAddInput.querySelector("input");this._bannedAddInput=new Tt.u3({el:this.els.bannedAddInput,validationHint:{direction:R.Lh.TOP,alignment:R.SE.CENTER},suggestion:new li}),this._bannedAddInput.validationRules={"page-tags-merge.proposal-form.non-existent-tag":t=>{let e=this._bannedAddInput.suggestion.tags.has(t.toLowerCase());return this.els.bannedAddInput.dataset.novalidate||e}},this._bannedAddForm.add(this._bannedAddInput),this.listenTo(this._bannedAddInput,ni.n.SELECT,(t=>{this._bannedAddInput.suggestion.hide(),t&&t.data&&t.data.name&&(this._bannedAddInput.value=t.data.name)})),t.disabled=!1,this.listenTo(this._bannedAddForm,"submit",this._handleBanTagSubmit),this._badTagsLimit=30,this._updateBadTagsList(this._data.badTags)}async _updateBadTagsList(t,e){let s=this.els.bannedList;e&&(s.innerHTML="");let i=s.childElementCount;for(let n of t){let t=$i._constructBannedTag(n.tag,n.count);s.appendChild(t)}if(!t.length&&!i)return s.dataset.notFound="",void delete s.dataset.hasMore;delete s.dataset.notFound,t.length<this._badTagsLimit?delete s.dataset.hasMore:s.dataset.hasMore=""}async _initRules(t){let e;e=t?this._data.approvedRules.rules:this._data.nonApprovedRules.rules,this._insertIntoRulesList(e,t)}async _insertIntoRulesList(t,e,s,i){let n;n=e?this.els.approvedRulesList:this.els.nonApprovedRulesList,s&&(n.innerHTML="");let a=n.childElementCount,o=!!this._data.isModerator&&Boolean(this._data.isModerator);for(let r of t){let t=$i._constructRule(r,e,o);i?n.insertAdjacentElement("afterbegin",t):n.appendChild(t)}if(!t.length&&!a)return n.dataset.notFound="",void delete n.dataset.hasMore;delete n.dataset.notFound,t.length<this._rulesLimit?delete n.dataset.hasMore:n.dataset.hasMore=""}async _handleSmallSearchSubmit(t){t.preventDefault();let e,s,i=t.target,n=i.dataset.type,a=i.dataset.lastSearch;switch(n){case"approved":e=this._approvedInput.value,s=!0;break;case"non-approved":e=this._nonApprovedInput.value,s=!1;break;case"banned":e=this._bannedSearchInput.value;break;default:return}if(i.dataset.lastSearch=e,a!==e){if("approved"===n||"non-approved"===n){let{rules:t}=await ot.lX.getRules(s,0,e);this._insertIntoRulesList(t,s,!0)}if("banned"===n){let t=await ot.Hx.getBannedByName(0,e);this._updateBadTagsList(t,!0)}}}async _handleBtnMoreClick(t){let e=t.target.closest(".tm-small-search__show-more-btn");if(!e)return;if(e.disabled)return;t.preventDefault(),e.disabled=!0;let s,i=e.closest("form"),n=e.dataset.approved,a=i.dataset.type,o=i.dataset.lastSearch;switch(a){case"approved":s=this.els.approvedRulesList.childElementCount;break;case"non-approved":s=this.els.nonApprovedRulesList.childElementCount;break;case"banned":s=this.els.bannedList.childElementCount;break;default:return}if("approved"===a||"non-approved"===a){let{rules:t}=await ot.lX.getRules(n,s,o);this._insertIntoRulesList(t,n)}if("banned"===a){let t=await ot.Hx.getBannedByName(s,o);this._updateBadTagsList(t)}e.disabled=!1}async _approveRule(t){let e=t.target.closest('a[data-role="approve"]');if(!e)return;t.preventDefault();let s=e.closest(".tm-rule"),n=s.dataset.from,o=s.dataset.to,r=`\n\t\t\t<p>${i.default.i18n("page-tags-merge.confirmation.approve-rule.start")} <span class="tm-tag__name">${n}</span>\n\t\t\t${i.default.i18n("page-tags-merge.confirmation.approve-rule.end")} <span class="tm-tag__name">${o}</span> ?</p>\n\t\t`;a.g.confirmModal({content:r,header:i.default.i18n("page-tags-merge.confirmation.approve-rule.header"),indent:!0,buttonsAlign:"left",buttons:[[i.default.i18n("page-tags-merge.confirmation.yes"),d.j.SUCCESS,!0],[i.default.i18n("page-tags-merge.confirmation.no")]]}).then((async t=>{if(t){let t=s.dataset.id;try{let e=await ot.lX.approveRule(t);if(e){let t=this.els.nonApprovedRulesList;t.removeChild(s),t.childElementCount||t.hasAttribute("data-has-more")||(t.dataset.notFound=""),this._insertIntoRulesList([e],!0,!1,!0)}}catch(e){i.default.ui.toasts.showError(e)}}}))}async _unbanTag(t){t.preventDefault();let e=t.target.closest('a[data-role="unban"]');if(!e)return;let s=e.closest(".tm-tag"),n=s.dataset.name,o=`\n\t\t\t<p>\n\t\t\t\t${i.default.i18n("page-tags-merge.confirmation.unban-tag.start")} \n\t\t\t\t<span class="tm-tag__name">${n}</span> ?\n\t\t\t</p>\n\t\t`;a.g.confirmModal({content:o,header:i.default.i18n("page-tags-merge.confirmation.unban-tag.header"),indent:!0,buttonsAlign:"left",buttons:[[i.default.i18n("page-tags-merge.confirmation.yes"),d.j.SUCCESS,!0],[i.default.i18n("page-tags-merge.confirmation.no")]]}).then((async t=>{if(t)try{if(await ot.lX.unbanTag(n)){let t=this.els.bannedList;t.removeChild(s),t.childElementCount||t.hasAttribute("data-has-more")||(t.dataset.notFound="")}}catch(e){i.default.ui.toasts.showError(e)}}))}async _disapproveRule(t){let e=t.target.closest('a[data-role="disapprove"]');if(!e)return;t.preventDefault();let s=e.closest(".tm-rule");try{await this._showDisapproveRuleConfirm(s.dataset.id,s.dataset.from,s.dataset.to)}catch(n){return}let i=this.els.nonApprovedRulesList;i.removeChild(s),i.childElementCount||i.hasAttribute("data-has-more")||(i.dataset.notFound="")}_showDisapproveRuleConfirm(t,e,s,n=null){return new Promise(((o,r)=>{a.g.confirmModal({content:`\n\t\t\t\t\t<p>\n\t\t\t\t\t\t${i.default.i18n("page-tags-merge.confirmation.disapprove-rule.start")} \n\t\t\t\t\t\t<span class="tm-tag__name">${e}</span>\n\t\t\t\t\t\t${i.default.i18n("page-tags-merge.confirmation.disapprove-rule.end")} \n\t\t\t\t\t\t<span class="tm-tag__name">${s}</span> ?\n\t\t\t\t\t</p>\n\t\t\t\t`,header:i.default.i18n("page-tags-merge.confirmation.disapprove-rule.header"),indent:!0,buttonsAlign:"left",buttons:[[i.default.i18n("page-tags-merge.confirmation.yes"),"green",!0],[i.default.i18n("page-tags-merge.confirmation.no"),"gray",!1]]}).then((async e=>{if(e)try{this._displayLoading(!0,n);let e=await ot.lX.disapproveRule(t);this._displayLoading(!1),e?o():r()}catch(s){this._displayLoading(!1),r(),i.default.ui.toasts.showError(s)}}))}))}async _rollbackRule(t){let e=t.target.closest('a[data-role="rollback"]');if(!e)return;t.preventDefault();let s=e.closest(".tm-rule");try{await this._showRollbackRuleConfirm(s.dataset.id,s.dataset.from,s.dataset.to)}catch(n){return}let i=this.els.approvedRulesList;i.removeChild(s),i.childElementCount||i.hasAttribute("data-has-more")||(i.dataset.notFound="")}_showRollbackRuleConfirm(t,e,s,n=null){return new Promise(((o,r)=>{a.g.confirmModal({content:`\n\t\t\t\t\t<p>\n\t\t\t\t\t\t${i.default.i18n("page-tags-merge.confirmation.rollback-rule.start")} \n\t\t\t\t\t\t<span class="tm-tag"><span class="tm-tag__name">${e}</span></span>\n\t\t\t\t\t\t${i.default.i18n("page-tags-merge.confirmation.rollback-rule.middle")} \n\t\t\t\t\t\t<span class="tm-tag"><span class="tm-tag__name">${s}</span></span>\n\t\t\t\t\t\t${i.default.i18n("page-tags-merge.confirmation.rollback-rule.end")} ?\n\t\t\t\t\t</p>\n\t\t\t\t`,header:i.default.i18n("page-tags-merge.confirmation.rollback-rule.header"),indent:!0,buttonsAlign:"left",buttons:[[i.default.i18n("page-tags-merge.confirmation.yes"),"green",!0],[i.default.i18n("page-tags-merge.confirmation.no"),"gray",!1]]}).then((async e=>{if(e)try{this._displayLoading(!0,n);let e=await ot.lX.rollbackRule(t);this._displayLoading(!1),e?o():r()}catch(s){this._displayLoading(!1),r(),i.default.ui.toasts.showError(s)}}))}))}_quantityBalloonShow(t){t.preventDefault();let e=this._selectedOption;if(e&&e.classList.contains("tm-quantity-baloon__option_custom")){let t=e.querySelector('input[name="quantity"]'),s=e.querySelector('input[name="custom-quantity"]');if(!s.value){let e=this._quantityRadioElements.find((t=>Number(t.value)===this._storiesQuantityNumber));e?this._checkOptionByRadioEl(e):(s.value=this._storiesQuantityNumber,this._checkOptionByRadioEl(t))}}this._storiesQuantityBaloon.show()}_initQuantityPicker(){let t=L.Zv.fragment('<form class="tm-quantity-baloon">\n\x3c!--<div class="tm-quantity-baloon">--\x3e\n\t<p class="tm-quantity-baloon__option tm-quantity-baloon__option_default">\n\t\t<label><input checked type="radio" name="quantity" value="30"> 30</label>\n\t</p>\n\t<p class="tm-quantity-baloon__option">\n\t\t<label><input type="radio" name="quantity" value="50"> 50</label>\n\t</p>\n\t<p class="tm-quantity-baloon__option">\n\t\t<label><input type="radio" name="quantity" value="100"> 100</label>\n\t</p>\n\t<hr>\n\t<p class="tm-quantity-baloon__option tm-quantity-baloon__option_custom">\n\t\t<label><input type="radio" name="quantity" value="custom-quantity"></label>\n\t\t<input tabindex="-1" type="text" name="custom-quantity" placeholder="Ваш вариант">\n\t</p>\n\x3c!--</div>--\x3e\n</form>\n').firstElementChild;this._storiesQuantityBaloon=new R._({target:this.els.storiesQuantityButton,indent:!0,direction:R.Lh.START,alignment:R.SE.END,content:t}),this._quantityRadioElements=Array.from(t.querySelectorAll('input[type="radio"]')),this._quantityRadios=new Map,this._quantityRadioElements.forEach((t=>{let e=new si.Z({el:t});this._quantityRadios.set(t,e)}));let e=t.querySelector(".tm-quantity-baloon__option_custom"),s=e.querySelector('input[name="custom-quantity"]');t.addEventListener("submit",(t=>{t.preventDefault(),this._storiesQuantityBaloon.hide()})),t.addEventListener("change",(t=>{let i=t.target.closest(".tm-quantity-baloon__option"),n=i.querySelector('input[name="quantity"]');if(i.classList.contains("tm-quantity-baloon__option_custom"))return s.focus(),void(this._selectedOption=e);this._storiesQuantityBaloon.hide(),this._selectedOption=i,this._storiesQuantityNumber=n.value,this.els.storiesQuantityNumber.innerText=n.value})),s.addEventListener("focus",this._updateQuantityNumberByCustom.bind(this));let i=(0,P.debounce)(this._updateQuantityNumberByCustom.bind(this),500);s.addEventListener("input",i)}_updateQuantityNumberByCustom(t){let e=t.target,s=e.value,i=this._quantityRadioElements.find((t=>"custom-quantity"===t.value));this._quantityRadios.get(i).checked||this._checkOptionByRadioEl(i),this._selectedOption=e.closest(".tm-quantity-baloon__option"),/^\d+$/.test(s)&&(this._storiesQuantityNumber=e.value,this.els.storiesQuantityNumber.innerText=e.value)}_checkOptionByRadioEl(t){this._quantityRadioElements.forEach((e=>{let s=this._quantityRadios.get(e);e===t?(s.$els.input.prop("checked",!0).change(),s.checked=!0):s.checked=!1}))}async _handleBanTagSubmit(t){if(t.preventDefault(),!(await this._bannedAddForm.checkValidity()))return;let e=this._bannedAddInput.value,s=(this._bannedAddInput.suggestion.tags.get(e.toLowerCase()),`\n\t\t\t<p>\n\t\t\t\t${i.default.i18n("page-tags-merge.confirmation.ban-tag.start")} \n\t\t\t\t<span class="tm-tag__name">${e}</span> ?\n\t\t\t</p>\n\t\t`);a.g.confirmModal({content:s,header:i.default.i18n("page-tags-merge.confirmation.ban-tag.header"),indent:!0,buttonsAlign:"left",buttons:[[i.default.i18n("page-tags-merge.confirmation.yes"),d.j.SUCCESS,!0],[i.default.i18n("page-tags-merge.confirmation.no")]]}).then((async t=>{if(t)try{if(await ot.lX.banTag(e)){this._bannedAddInput.value="",this._bannedSearchInput.value=e;let t=await ot.Hx.getBannedByName(0,e);this.els.bannedSearchForm.dataset.lastSearch=e,this._updateBadTagsList(t,!0)}}catch(s){i.default.ui.toasts.showError(s)}}))}_handleFoundTagClick(t){if(t.target.closest(".tm-tag__counter"))return;t.preventDefault();let e=t.target.closest(".tm-tag"),s=e.dataset.name,i=e.dataset.count,n=Array.from(this.els.mergeProposalForm.elements).filter((t=>"from"===t.dataset.role)),a=n.find((t=>t.value===s));if(a)return void a.focus();let o=n.pop(),r=this._handleFromProposalInputs(o);this._UIInputsByInputs.get(r).suggestion.addTag(s,i),rt.u1.closestUIElement(r).toggleClearButton(!0),this._addTagCount(r,s,i),r.value=s,r.focus()}async _handleProposalSubmit(t){t.preventDefault(),await this._mergeProposalForm.checkValidity()&&await this._proposeNewRules()}async _proposeNewRules(){this._displayLoading(!0,this.$els.mergeProposalFormButton);let t=Array.from(this.els.mergeProposalForm.elements),e=t.filter((t=>"from"===t.dataset.role));e.pop();let s=e.map((t=>t.value)).filter((t=>t.length)),n=t.find((t=>"to"===t.dataset.role)).value;try{let t=await ot.lX.validateSuggestion(s,n);if(""!==t.message||t.issues.length>0)return this._displayLoading(!1),void this._displayConflicts(t)}catch(a){return this._displayLoading(!1),void i.default.ui.toasts.add({theme:Q.K.RED,content:a.message?a.message:a})}try{let{rules:t}=await ot.lX.sendSuggestion(s,n);this._displayLoading(!1),i.default.ui.toasts.add({content:i.default.i18n("page-tags-merge.proposal-form.messages.merged")}),this._insertIntoRulesList(t,!1,!1,!0),this._resetProposalInputs()}catch(a){this._displayLoading(!1),i.default.ui.toasts.showError(a)}}_initConflicts(){this.$els.conflictsBackButton.click((()=>{this.$els.conflicts.slideUp(200),this.$els.mergeProposalForm.slideDown(200)})),this.$els.conflictsApplyButton.toggle(this._data.isModerator),this.$els.conflictsApplyButton.click((async()=>{this.$els.conflicts.slideUp(200),this.$els.mergeProposalForm.slideDown(200,(async()=>{await this._proposeNewRules()}))})),this.$els.conflictsBody.on("click",'button[data-role="cancel"]',(async t=>{let e=Si(t.target).closest("button"),s="true"===e.attr("data-is-approved");try{s?await this._showRollbackRuleConfirm(parseInt(String(e.attr("data-id"))),String(e.attr("data-tag-from")),String(e.attr("data-tag-to")),e):await this._showDisapproveRuleConfirm(parseInt(String(e.attr("data-id"))),String(e.attr("data-tag-from")),String(e.attr("data-tag-to")),e)}catch(i){return}e.closest(".tm-conflicts__issue").remove(),this._updateConflictsApplyButtonState()})),this.$els.conflictsBody.on("click",'button[data-role="cancel-rejection"]',(async t=>{let e=Si(t.target).closest("button");try{this._displayLoading(!0,e),await ot.lX.cancelRejection(String(e.attr("data-tag-from")),String(e.attr("data-tag-to"))),this._displayLoading(!1)}catch(s){return this._displayLoading(!1),void i.default.ui.toasts.showError(s)}e.closest(".tm-conflicts__issue").remove(),this._updateConflictsApplyButtonState()})),this.$els.conflictsBody.on("click",'button[data-role="remerge"]',(async t=>{let e=Si(t.target).closest("button");if(!("true"===e.attr("data-is-approved")))return;let s=Array.from(this.els.mergeProposalForm.elements).find((t=>"to"===t.dataset.role));try{this._displayLoading(!0,e),await ot.lX.remergeRule(String(e.attr("data-id")),s.value),this._displayLoading(!1)}catch(n){return this._displayLoading(!1),void i.default.ui.toasts.showError(n)}e.closest(".tm-conflicts__issue").remove(),this._updateConflictsApplyButtonState()}))}_updateConflictsApplyButtonState(){0===this.$els.conflictsBody.find(".tm-conflicts__issue").length&&(this.$els.conflictsApplyButton.prop("disabled",!1),this.$els.conflictsMessage.removeClass("section_red").addClass("section_green").text(i.default.i18n("page-tags-merge.conflicts.empty")))}_displayConflicts(t){this.$els.conflictsMessage.removeClass("section_green").addClass("section_red").text(t.issues.length>0?i.default.i18n("page-tags-merge.conflicts.has-issues"):t.message),this.$els.conflictsApplyButton.prop("disabled",!0);let e=this._data.isModerator,s="",n={canceled:hi,"exists-not-approved":mi,"exists-from":fi,"exists-to":bi,"not-found":wi,rejected:xi},a=new Map(t.count);for(let i of t.issues)n[i.type]&&(s+=n[i.type]({isModerator:e,ruleId:i.rule_id||0,tag1:i.tag1,count1:a.get((i.tag1||"").toLowerCase())||"",tag2:i.tag2,count2:a.get((i.tag2||"").toLowerCase())||""}));this.$els.conflictsBody.html(s),this.$els.mergeProposalForm.slideUp(200),this.$els.conflicts.slideDown(200)}_handleProposalFocus(t){t.preventDefault();let e=t.target.closest('input[data-role="from"]');e&&this._handleFromProposalInputs(e)}_handleFromProposalInputs(t){let e=Array.from(this.els.mergeProposalForm.elements).filter((t=>"from"===t.dataset.role));if(t!==e[e.length-1])return;e.pop();let s=e.filter((t=>""===t.value));if(s.length)return s[0].focus(),s[0];let i=t.parentElement.parentElement;i.insertAdjacentHTML("beforeEnd",'<a data-role="remove" role="button"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__close icon--ui__close_table-row"><use xlink:href="#icon--ui__close"></use></svg></a>\n'),delete i.dataset.novalidate,t.removeAttribute("tabindex");let n=L.Zv.fragment('<div class="merge-proposal__input input" data-novalidate="novalidate" data-role="from">\n\t<span class="input__box">\n\t\t<input data-role="from" class="input__input" type="text" placeholder="Добавить тег">\n\t</span>\n\t\x3c!--<a data-role="remove" role="button"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__close"><use xlink:href="#icon--ui__close"></use></svg></a>--\x3e\n</div>\n');return this._initProposalInput(n.firstElementChild),n.querySelector("input").setAttribute("tabindex",-1),this.els.fromProposalContainer.appendChild(n),t}_handleProposalRemove(t){t.preventDefault();let e=t.target.closest('a[data-role="remove"]');if(!e)return;let s=e.parentElement;s.classList.contains("merge-proposal__input")&&this._removeProposalInput(s)}_removeProposalInput(t){let e=t.querySelector("input"),s=this._UIInputsByInputs.get(e);s.emit("destroy",s),this._UIInputsByInputs.delete(e);let i=t.parentElement;i.removeChild(t),i.childElementCount||i.hasAttribute("data-has-more")||(i.dataset.notFound="")}async _initProposalInputs(){let t=Array.from(document.querySelectorAll(".merge-proposal__input"));for(let e of t)this._initProposalInput(e)}_initProposalInput(t){let e=t.querySelector("input"),s=new Tt.u3({el:t,validationHint:{direction:R.Lh.TOP,alignment:R.SE.CENTER},suggestion:new li});this._UIInputsByInputs.set(e,s),"to"===e.dataset.count?s.validationRules={"page-tags-merge.proposal-form.non-existent-tag":e=>{let i=s.suggestion.tags.has(e.toLowerCase());return t.dataset.novalidate||i}}:s.validationRules={"page-tags-merge.proposal-form.non-existent-tag":e=>{let i=0,n=s.suggestion.tags.has(e.toLowerCase());if(!e.length){for(let t of this._UIInputsByInputs)"to"!==t[0].dataset.role&&t[0].value&&i++;return i>0}return t.dataset.novalidate||n}},this._mergeProposalForm.add(s),this.listenTo(s.suggestion,ni.n.SELECT,(t=>{s.suggestion.hide(),t&&t.data&&t.data.name&&(s.value=t.data.name),this._addTagCount(s,t.data.name,t.data.count)})),this.listenTo(s.suggestion,ni.n.SEARCH_START,(()=>{this._deleteTagCount(s)})),this.listenTo(s,"change",(()=>{this._deleteTagCount(s)})),e.disabled=!1}_addTagCount(t,e,s){let i=Si(`<a target="_blank" href="tag/${encodeURIComponent(e)}" class="merge-proposal__count">\n\t\t\t\t\t\t${s}\n\t\t\t\t\t\t</a>`);i.click((t=>{t.stopPropagation()})),t instanceof rt.u1||(t=rt.u1.closestUIElement(t)),t.$els.input.after(i)}_deleteTagCount(t){let e;t instanceof rt.u1||(t=rt.u1.closestUIElement(t)),e=t.$els.input.next(".merge-proposal__count"),e.length&&e.remove()}_resetProposalInputs(){let t=0;Si(".merge-proposal__input").each(((e,s)=>{let i=Si(s);i.find("input").val(""),this._deleteTagCount(i),"to"!==i.data("role")&&(++t<=2?i.find('[data-role="remove"]').remove():this._removeProposalInput(s))}))}_initTagsSearchPagination(t){this._tagsSearchPagination&&(delete this._tagsSearchPagination,this.els.paginationContainer.firstElementChild&&this.els.paginationContainer.removeChild(this.els.paginationContainer.firstElementChild)),!t||t<2||(this._tagsSearchPagination=new ii.S({currentPage:1,endPage:t}),this.els.paginationContainer.appendChild(this._tagsSearchPagination.show().el),this.listenTo(this._tagsSearchPagination,"change",this._handlePageChange))}_handlePageChange(t){this._searchTags(this._lastSearch,null,t-1,!0)}async _handleSearchSubmit(t){t.preventDefault();let e=this._lastSearch,s=this._tagsSearchInput.value;this._lastSearch=this._tagsSearchInput.value;let i=Number(this.els.tagsSearchForm.dataset.lastQuantity);this.els.tagsSearchForm.dataset.lastQuantity=this._storiesQuantityNumber,e===s&&this._storiesQuantityNumber===i||this._searchTags(s,this._storiesQuantityNumber)}async _searchTags(t="",e=0,s=0,n=!1){if(this.els.tagsFoundList.innerHTML="",""===t)return this.els.tagsFoundList.dataset.type="empty",void this._initTagsSearchPagination();this.els.tagsFoundList.dataset.type="";try{let{tags:i,total:a}=await ot.Hx.getListByName(t,e,s);if(a=Number(a),i.length&&a&&a>0){n||this._initTagsSearchPagination(Math.ceil(a/i.length));let t=document.createDocumentFragment();for(let e of i){let s=$i._constructTag(...e);t.appendChild(s)}this.els.tagsFoundList.appendChild(t)}else this._initTagsSearchPagination(),this.els.tagsFoundList.dataset.type="not-found"}catch(a){i.default.ui.toasts.showError(a),this.els.tagsFoundList.dataset.type="empty"}}_displayLoading(t,e=null){this.$el.toggleClass("tags-merge_loading",t),null!==this._loadingButton.$button&&(this._loadingButton.$button=null,this._loadingButton.button.progress=!1,this._loadingButton.button=null),t&&e&&(this._loadingButton.$button=e,this._loadingButton.button=new Ft.y3(e),this._loadingButton.button.progress=!0)}static _constructTag(t,e){if(!t||!e)return;let s=function(t){var e="",s=ui.escape;return e+'<div class="tm-tag tm-tag_search" data-name="'+s(t.name)+'" data-count="'+s(t.count)+'">\n\t<a class="tm-tag__name" href="javascript: void(0)">'+s(t.name)+'</a>\n\t<a class="tm-tag__counter" href="'+s("/tag/"+encodeURIComponent(t.name))+'" target="_blank"><b>'+s(t.count)+"</b></a>\n</div>"}({name:t,count:e});return L.Zv.fragment(s).firstElementChild}static _constructBannedTag(t,e){if(!t||!e)throw new Error("Banned tag name or count was not specified");let s=function(t){var e="",s=ci.escape;return e+'<div class="tm-tag tm-tag_banned" data-name="'+s(t.name)+'" data-count="'+s(t.count)+'">\n\t<a class="tm-tag__name" href="javascript: void(0)">'+s(t.name)+'</a>\n\t<a class="tm-tag__counter" href="'+s("/tag/"+encodeURIComponent(t.name))+'" target="_blank"><b>'+s(t.count)+'</b></a>\n\t<div class="tm-tag__buttons">\n\t\t<a title="'+s(t.tagActions.unban)+'" class="tm-tag__btn" data-role="unban" role="button"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__close icon--ui__close_remove-tag-merge"><use xlink:href="#icon--ui__close"></use></svg></a>\n\t</div>\n</div>'}({name:t,count:e,tagActions:{unban:i.default.i18n("page-tags-merge.tag-actions.unban")}});return L.Zv.fragment(s).firstElementChild}static _constructRule(t,e,s){if(!t)throw new Error("Rule was not specified");Object.assign(t,{isModerator:s,isApproved:e,ruleActions:{rollback:i.default.i18n("page-tags-merge.rule-actions.rollback"),approve:i.default.i18n("page-tags-merge.rule-actions.approve"),disapprove:i.default.i18n("page-tags-merge.rule-actions.disapprove")}});let n=function(t){var e="",s=di.escape;return Array.prototype.join,e+='<div class="tm-rule '+s(t.isApproved?"tm-rule_approved":"tm-rule_non-approved")+'" data-id="'+s(t.id)+'" data-from="'+s(t.from)+'" data-to="'+s(t.to)+'">\n\t<div class="tm-rule__tags-container">\n\t\t<a\n\t\t\tclass="tm-tag"\n\t\t\thref="'+s("/tag/"+encodeURIComponent(t.from))+s(t.isApproved?"?is_merged_tag=1":"")+'"\n\t\t\ttarget="_blank">\n\t\t\t<span class="tm-tag__name">'+s(t.from)+"</span>\n\t\t\t",t.fromCount&&(e+='\n\t\t\t<span class="tm-tag__counter"><b>'+s(t.fromCount)+"</b></span>\n\t\t\t"),e+='\n\t\t</a>\n\t\t<span class="tm-rule__arrow">&#10140;</span>\n\t\t<a class="tm-tag" href="'+s("/tag/"+encodeURIComponent(t.to))+'" target="_blank">\n\t\t\t<span class="tm-tag__name">'+s(t.to)+'</span>\n\t\t\t<span class="tm-tag__counter"><b>'+s(t.toCount)+"</b></span>\n\t\t</a>\n\t</div>\n\t",t.isModerator&&(e+="\n\t",t.isApproved?e+='\n\t<div class="tm-rule__user user">\n\t\t<div class="user__info">\n\t\t\t<div class="user__info-item">\n\t\t\t\t<a href="'+s("/@"+t.offerer)+'" class="user__nick">'+s(t.offerer)+'</a>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="tm-rule__buttons">\n\t\t<a title="'+s(t.ruleActions.rollback)+'" class="tm-rule__btn" data-role="rollback" role="button"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__close icon--ui__close_remove-tag-merge"><use xlink:href="#icon--ui__close"></use></svg></a>\n\t</div>\n\t':e+='\n\t<div class="tm-rule__user user">\n\t\t<div class="user__info">\n\t\t\t<div class="user__info-item">\n\t\t\t\t<a href="'+s("/@"+t.offerer)+'" class="user__nick">'+s(t.offerer)+'</a>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="tm-rule__buttons">\n\t\t<a title="'+s(t.ruleActions.approve)+'" class="tm-rule__btn" data-role="approve" role="button"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__success icon--ui__success_approve-merge"><use xlink:href="#icon--ui__success"></use></svg></a>\n\t\t<a title="'+s(t.ruleActions.disapprove)+'" class="tm-rule__btn" data-role="disapprove" role="button"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__close icon--ui__close_remove-tag-merge"><use xlink:href="#icon--ui__close"></use></svg></a>\n\t</div>\n\t',e+="\n\t"),e+="\n</div>\n"}(t);return L.Zv.fragment(n).firstElementChild}}var Ci=s(79849),Ti=s(23627),Ei=s(47994);class Ii extends m.T3{render(){return this.isRendered||(this.$el=y()(".page-comments"),this.$els={input:this.$('.input[data-role="search"]')},this.$els.input.length&&(this._searchInput=new Tt.u3(this.$els.input)),new Ti.z({$el:this.$(".comments-part"),mode:Ei.lL.OUTCOMING}).show().initComments(),new Ci.B,i.core.ui.screen=G.dt.USER_COMMENTS,super.render()),this}}const Oi=s(19755);class Ui extends m.T3{render(){return this.isRendered||(this.$el=Oi(".page-comments"),this.$els={input:this.$('.input[data-role="search"]')},this.$els.input.length&&(this._searchInput=new Tt.u3(this.$els.input)),new Ti.z({$el:this.$(".comments-part"),mode:Ei.lL.OUTCOMING}).show().initComments(),new Ci.B,super.render()),this}}const Di=s(19755);class Ai extends m.T3{render(){return this.isRendered||(this.$el=Di("#subscribe-success"),setTimeout((()=>{window.location.href="/"}),5e3),super.render()),this}}const Mi=s(19755);class Ni extends m.T3{render(){return this.isRendered||(this.$el=Mi(".page-top-comments"),this.$els={},new Ci.B,new Ti.z({$el:this.$(".comments-part"),mode:Ei.lL.BEST}).show().initComments(),i.core.ui.screen=G.dt.TOP_COMMENTS,super.render()),this}}const Pi=s(19755);class Li extends m.T3{render(){return this.isRendered||(this.$el=Pi(".page-story-preview"),this._initStoryFeed(),super.render()),this}_initStoryFeed(){return new l._D({useEmptyIds:!0,$el:this.$el,feedName:"story-preview"}),this}}class Ri{static async getAwards(t,e){const s={ajax_mode:1,page:t,mode:e},i="individual"===e?"/awards/individual":"/awards",{data:n}=await A.cf.getOrFail(i,s);return n}}const ji=s(19755);class Bi extends m.T3{render(){return this.isRendered||(this.$el=ji(".awards-feed"),this.$els={loadMore:this.$(".awards-feed__show-more button"),list:this.$(".awards-feed__list")},this._page=2,this.$els.loadMore.length&&(this._loadMoreBtn=new Ft.y3({$el:this.$els.loadMore}),this.listenTo(this._loadMoreBtn,"click",this._loadMore)),i.default.ui.screen=G.dt.AWARDS_LENT,super.render()),this}_loadMore(){const t=window.location.pathname.match(/\/awards(?:\/(individual|community))?$/)[1]||"all";this._loadMoreBtn.progress=!0,Ri.getAwards(this._page,t).then((t=>{this._loadMoreBtn.progress=!1,t.eof&&this.$els.loadMore.fadeOut(),this._page=this._page+1;let e=ji(t.html).hide();this.$els.list.append(e),e.slideDown("fast")}),(t=>{this._loadMoreBtn.progress=!1,i.default.ui.toasts.showError(t)}))}}const qi=Bi;var Fi=s(65645),Vi=s(24126);const Zi=s(19755);class Wi extends m.T3{render(){return this.isRendered||(this.$el=Zi(".password-restore"),"new_password"===this.$el.data("role")?new Vi.C(this.$el):new Fi.Z(this.$el),super.render()),this}}class zi{static async save(t,e){const{data:s}=await A.cf.postOrFail("/ajax/surveys_actions.php",{action:"vote",id:t,answers:JSON.stringify(e)});return s.result}}const Hi=s(19755);class Gi extends m.T3{render(){return this.isRendered||(this.$el=Hi(".survey"),this.$els={saveButton:this.$(".survey__buttons-bar button"),radioAnswers:this.$('.survey-question__answer input[type="radio"]'),questions:this.$(".survey-question")},this._id=this.$el.data("id"),this.$els.saveButton.click(this.save.bind(this)),this.$els.radioAnswers.each(((t,e)=>{new si.Z({$el:Hi(e)}).on("change",(()=>{"n"===this.$els.saveButton.data("disabled")&&Hi('.survey-question__answer input[type="radio"]:checked').length>0?this.$els.saveButton.removeAttr("disabled"):this.$els.saveButton.attr("disabled","disabled")}))})),super.render()),this}async save(){let t={},e=!0;if(this.$els.questions.each(((s,n)=>{let a=Hi(n),o=a.find('input[type="radio"]:checked').val();o?t[a.data("id")]=o:(e&&i.default.ui.toasts.showError("page-survey.errors."+(this.$els.questions.length>1?"no-answer-all":"no-answer")),e=!1)})),e){this.$els.saveButton.attr("disabled","disabled"),this.$els.radioAnswers.attr("disabled","disabled");try{await zi.save(this._id,t),window.scrollTo(0,0),window.location.reload()}catch(s){this.$els.radioAnswers.removeAttr("disabled"),this.$els.saveButton.removeAttr("disabled"),i.default.ui.toasts.showError(s.message||i.default.i18n("page-survey.errors.invalid-request"))}}}}var Yi=s(39549);class Ki extends Yi.h{route(t,e){return this._series=t.params.series,super.route(t,e)}render(){return this.isRendered?this:(i.core.ui.screen=G.dt.SERIES,super.render())}_getBaseUrl(){return`/${this._currentMode.valueOf()}/${this._series}`}}s(92087);var Qi=s(7016);function Xi(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class Ji{constructor(t){Xi(this,"flags",{}),Xi(this,"scoreBasedResult",0),Xi(this,"_current",0),Xi(this,"_isFinished",!1),Xi(this,"_isStarted",!1),Xi(this,"_results",{score:0,data:{}}),this._defaults=t,this._final=t.final,this.questionsCount=t.questions.length,this.isScoreBased=t.settings.score_based,this.id=t.id,this.oid=t.oid,this.pixels=t.pixels,this.questions=t.questions,this._initFlags(),this._pixelReplaceRandom("feed"),this._pixelReplaceRandom("result"),this._addFeedPixel()}start(){this._isStarted=!0,this._isFinished=!1,this._current=1,this._results.score=0,this._results.data={},this._saveStart()}next(){this._current++}finish(){this._saveResult(this._results.data),this._isStarted&&this._current>=this.questionsCount&&(this._isFinished=!0)}pushResult(t){t.success&&this._results.score++,this._results.data[t.question]=[t.answer],this._current!==this.questionsCount&&this._saveResult(this._results.data)}loadImage(t,e,s){const i=new Image;i.src=t,i.onload=()=>{e(s)}}getImageSrc(t){const e=t.find(".pt-question__desc img");return e.length?e.attr("src"):""}showImageBlock(t){const e=this.getImageSrc(t),s=t.find(".pt-question__loading");e?this.loadImage(e,(()=>{s.hide()})):s.hide()}getResults(t){const e=this._final.scores.length;let s=this._final.scores[0],i=0;for(let n=0;n<e;n++)t<=this._final.scores[n].score&&t>i&&(s=this._final.scores[n]),i=this._final.scores[n].score;return t>=this._final.scores[e-1].score&&(s=this._final.scores[e-1]),{title:this._final.title||this._defaults.general.title,fontColor:this._final.font.color,data:s,isShowCountAnswers:this.flags.show_correct_answers_count,pixel:this.pixels.result}}pushMetricsGoal(t){window.ym&&t&&St.c.getInstance().yandex.goal(t)}async _saveStart(){const t={action:"start",id:this.id},{data:e}=await A.cf.postOrFail("/ajax/promo_test_actions.php",t);return e.result}async _saveResult(t){const e={action:"result",id:this.id,result:JSON.stringify(t)},{data:s}=await A.cf.postOrFail("/ajax/promo_test_actions.php",e);return s.result}_initFlags(){(0,P.each)(this._defaults.flags,(t=>{this.flags[t.type]=t.value}))}_pixelReplaceRandom(t){if(!this.pixels[t])return;const e=Math.round(1e6*Math.random());this.pixels[t]=this.pixels[t].replace("%random%",String(e))}_addFeedPixel(){const t=y()(".promo-test__pixel-feed");if(!t.length||"string"!=typeof this.pixels.feed)return;if(!Qi.v)return void t.attr("src",this.pixels.feed);new IntersectionObserver((t=>{t.forEach((t=>{t.isIntersecting&&!t.target.getAttribute("src")&&t.target.setAttribute("src",this.pixels.feed)}))})).observe(t[0])}get score(){return this._results.score}get isFinished(){return this._isFinished}get current(){return this._current}}var tn=s(36005);const en=s(19755);class sn extends rt.u1{constructor(t){super(t),this.akey="a_",this._data=t.data,this._parent=t.parent,this._ptcontroller=t.controller,this._ptmodel=this._ptcontroller.model,this.orderId=t.orderId,this.isPassed=!1,this.selected=null,this.classes={answer:"pt-answer",checked:"pt-answer_checked",checkedFail:"pt-answer_checked-fail",correct:"pt-answer_correct",short:"pt-answer_short",nextbtn:"promo-test__next-button",result:"promo-test__answer-text"},this._initAnswers(),this._initMode()}_initAnswers(){this._answers={};for(let t=0;t<this._data.options.length;t++)this._answers[this.akey+this._data.options[t].id]=this._data.options[t]}_initMode(){this._mode=0,this._ptmodel.flags.mode&&Number(this._ptmodel.flags.mode)>0&&(this._mode=Number(this._ptmodel.flags.mode))}render(){return this.isRendered||(this.$el=en(function(t){var e,s="",i=tn.escape;Array.prototype.join,s+='<div class="promo-test__screen promo-test__screen_question pt-question">\n\t<div class="pt-question__info">\n\t\t<div class="pt-question__number">\n\t\t\t';let n=t.questionsCount>9&&t.orderId<10?"0"+t.orderId:t.orderId;s+='\n\t\t\t<span class="pt-question__n-current">'+i(n)+'</span> / <span class="pt-question__n-all">'+i(t.questionsCount)+'</span>\n\t\t</div>\n\t\t<h3 class="pt-question__question">'+(null==(e=t.title)?"":e)+'</h3>\n\t\t<div class="pt-question__desc">\n\t\t\t<div class="pt-question__loading"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__progress-circle icon--ui__progress-circle_story-editor"><use xlink:href="#icon--ui__progress-circle"></use></svg></div>\n\t\t\t'+(null==(e=t.desc)?"":e)+'\n\t\t</div>\n\t</div>\n\t<div class="pt-question__answers">\n\t\t<ul>\n\t\t';for(let a=0;a<t.options.length;a++)s+='\n\t\t\t<li class="pt-question__answer pt-answer" data-id="'+i(t.options[a].id)+'">\n\t\t\t\t<span>'+(null==(e=t.options[a].desc)?"":e)+"</span>\n\t\t\t</li>\n\t\t";return s+='\n\t\t</ul>\n\t</div>\n\t<div class="pt-question__bottom">\n\t\t<div class="promo-test__answer-text"></div>\n\t\t<button class="button_success promo-test__button promo-test__next-button">\n\t\t\t',t.orderId===t.questionsCount?s+="\n\t\t\t\t<span>"+(null==(e=t.i18n.resultbtn)?"":e)+"</span>\n\t\t\t":s+="\n\t\t\t\t<span>"+(null==(e=t.i18n.nextbtn)?"":e)+"</span>\n\t\t\t",s+"\n\t\t</button>\n\t</div>\n</div>"}((0,P.extend)(this._data,{orderId:this.orderId,questionsCount:this._ptmodel.questionsCount,i18n:{nextbtn:i.core.i18n("promo-test.buttons.next"),resultbtn:i.core.i18n("promo-test.buttons.result")}}))),this.$el.on("click",`.${this.classes.answer}`,this._clickAnswer.bind(this)),this.$el.on("click",`.${this.classes.nextbtn}`,this._goNext.bind(this)),this.$els={result:this.$el.find(`.${this.classes.result}`),nextbtn:this.$el.find(`.${this.classes.nextbtn}`)},this.reset(),this.$el.appendTo(this._parent),super.render()),this}show(){return this.isRendered||this.render(),this.$el.show(),this}_goNext(){this.emit("next",{success:this.selected.is_correct,question:this._data.id,answer:this.selected.id})}_clickAnswer(t){if(t.preventDefault(),this.isPassed)return;let e=en(t.currentTarget),s=this._answers[this.akey+e.data("id")];this.isPassed=!0,this.selected=s,e.addClass(this.classes.checked),St.c.getInstance().sendEvent("click",{type:"promo_quiz_click"}),1!==this._mode&&(this.selected.is_correct?e.addClass(this.classes.correct):e.addClass(this.classes.checkedFail)),s.note&&s.note.length>0?(this.$els.result.html(s.note).show(),e.siblings(`.${this.classes.answer}`).hide()):e.addClass(this.classes.short),this._ptmodel.isScoreBased&&(this._ptmodel.scoreBasedResult+=s.score),this.$els.nextbtn.show()}reset(){this.isPassed=!1,this.selected=null,this.$el.find(`.${this.classes.answer}`).removeClass(this.classes.checked).removeClass(this.classes.correct).removeClass(this.classes.checkedFail).show(),this.$els.result.hide(),this.$els.nextbtn.hide()}}var nn=s(36005);var an=s(91033);const on=s(19755);class rn extends m.T3{render(){return this.isRendered||(this.$els={box:on(".promo-test").first(),startscreen:on(".promo-test__screen_start"),startbutton:on(".promo-test__start-button"),questionsbox:on(".promo-test__questions"),finalbox:on(".promo-test__final")},this._init(),this._initQuestions(),this._initQuestionsHeightJumpFix(),this.$els.startbutton.on("click",this.start.bind(this)),this.$els.finalbox.on("click",".promo-test__restart",this.restart.bind(this)),super.render()),this}_init(){let t=JSON.parse(on('.app__config[data-entry="promo-test-data"]').text());t.id=this.$els.box.data("id"),t.oid=this.$els.box.data("oid"),this.model=new Ji(t),this.$els.box.data("embedded")&&window.parent&&this._runEmbeddedMode(),this.$els.box.on("click","[data-goal]",(t=>{let e=on(t.currentTarget).data("goal");this.model.pushMetricsGoal(e)}))}_initQuestions(){this._questions=this.model.questions;let t=0;(0,P.each)(this._questions,(e=>{e.view=new sn({parent:this.$els.questionsbox,data:e,controller:this,orderId:++t}),e.view.on("next",this.next.bind(this))}))}start(){this.model.start(),this.$els.startscreen.hide(),this.showQuestion(1),this.$els.questionsbox.show()}showQuestion(t){this.$els.questionsbox.find(".pt-question").hide(),this._questions[t-1].view.show(),this.scrollTop(),this.model.showImageBlock(this._questions[t-1].view.$el),t<this.model.questionsCount&&this._questions[t].view.render().$el.hide()}next(t){this.model.pushResult(t),this.model.current>=this.model.questionsCount?this.showResults():(this.model.next(),this.showQuestion(this.model.current))}scrollTop(){if(this._isEmbedded){let t=window.parent.pageYOffset+window.frameElement.getBoundingClientRect().top;window.parent.scrollTo(0,t-48)}else i.core.ui.scrollTo(this.$els.box)}getResults(){if(!this.model.isFinished)return!1;const t=this.model.isScoreBased?this.model.scoreBasedResult:this.model.score,e=this.model.getResults(t);return{id:this.model.id,questionsCount:this.model.questionsCount,fontColor:e.fontColor,img:e.img,title:e.title,result:e.data,isShowCountAnswers:e.isShowCountAnswers,isScoreBased:this.model.isScoreBased,pixel:this.model.pixels.result,settings:this.model._defaults.settings,score:t}}showResults(){this.model.finish();let t=this.getResults();this.$els.questionsbox.hide();const e=this.$els.finalbox.html(function(t){var e,s="",i=nn.escape;Array.prototype.join,s+='<div class="promo-test__loading"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__progress-circle icon--ui__progress-circle_story-editor"><use xlink:href="#icon--ui__progress-circle"></use></svg></div>\n<div class="promo-test__screen promo-test__screen_final promo-test__screen_final_hide">\n\t',t.pixel&&(s+='\n\t\t<img src="'+(null==(e=t.pixel)?"":e)+'" border=0 width=1 height=1>\n\t'),s+='\n\t<div class="promo-test__result-image">\n\t\t<div class="promo-test__bg" style="background-image:url(\''+(null==(e=t.result.img)?"":e)+'\')"></div>\n\t\t<div class="promo-test__text" style="color: '+(null==(e=t.fontColor)?"":e)+'">\n\t\t\t<h3>'+i(t.title)+"</h3>\n\t\t\t",t.isShowCountAnswers&&(s+="\n\t\t\t\t",t.isScoreBased||(s+='\n\t\t\t\t\t<div class="promo-test__result-score">'+(null==(e=t.score)?"":e)+"/"+(null==(e=t.questionsCount)?"":e)+"</div>\n\t\t\t\t"),s+="\n\t\t\t\t",t.isScoreBased&&(s+='\n\t\t\t\t\t<div class="promo-test__result-score">'+(null==(e=t.score)?"":e)+"</div>\n\t\t\t\t"),s+="\n\t\t\t"),s+='\n\t\t\t<p class="promo-test__result-title">'+(null==(e=t.result.title)?"":e)+"</p>\n\t\t</div>\n\t</div>\n\t";let n=t.settings.share&&t.settings.share.goal_prefix?t.settings.share.goal_prefix:null;s+="\n\t";let a=encodeURIComponent("https://pikabu.ru/promo-test/"+t.id+"?share=1&score="+t.score);return s+'\n\t<div class="promo-test__sharer">\n\t\t<a class="promo-test__share-btn promo-test__share-btn_fb" href="https://www.facebook.com/sharer/sharer.php?u='+(null==(e=a)?"":e)+'" data-goal="'+(null==(e=n?n+"_fb_web":"")?"":e)+'" target="_blank">\n\t\t\t<i class="fa fa-facebook" aria-hidden="true"></i>\n\t\t</a>\n\t\t<a class="promo-test__share-btn promo-test__share-btn_tw" href="https://twitter.com/share?url='+(null==(e=a)?"":e)+'" data-goal="'+(null==(e=n?n+"_tw_web":"")?"":e)+'" target="_blank">\n\t\t\t<i class="fa fa-twitter" aria-hidden="true"></i>\n\t\t</a>\n\t\t<a class="promo-test__share-btn promo-test__share-btn_vk" href="https://vk.com/share.php?url='+(null==(e=a)?"":e)+'" data-goal="'+(null==(e=n?n+"_vk_web":"")?"":e)+'" target="_blank">\n\t\t\t<i class="fa fa-vk" aria-hidden="true"></i>\n\t\t</a>\n\t\t<a class="promo-test__share-btn promo-test__share-btn_ok" href="https://connect.ok.ru/offer?url='+(null==(e=a)?"":e)+'" data-goal="'+(null==(e=n?n+"_ok_web":"")?"":e)+'" target="_blank">\n\t\t\t<i class="fa fa-odnoklassniki" aria-hidden="true"></i>\n\t\t</a>\n\t</div>\n\t<div class="promo-test__hr"></div>\n\t<div class="promo-test__result-note">'+(null==(e=t.result.note)?"":e)+'</div>\n\t<div class="promo-test__restart">\n\t\t<span>Ещё раз</span><i class="fa fa-undo" aria-hidden="true"></i>\n\t</div>\n</div>'}(t));e.show(),t.result.img?this.model.loadImage(t.result.img,this.showFinalScreen,e):this.showFinalScreen(e),this.scrollTop()}showFinalScreen(t){t.find(".promo-test__loading").hide(),t.find(".promo-test__screen_final").removeClass("promo-test__screen_final_hide")}restart(){for(let t=0;t<this._questions.length;t++)this._questions[t].view.reset();this.model.scoreBasedResult=0,this.$els.finalbox.hide().html(""),this.$els.startscreen.show(),this.scrollTop()}_runEmbeddedMode(){this._isEmbedded=!0,this._ro=new an.Z(((t,e)=>{for(const s of t)window.frameElement.style.height=s.contentRect.height+"px"})),this._ro.observe(this.$els.box[0]),document.body.style.overflow="hidden"}_initQuestionsHeightJumpFix(){const t=this.$els.questionsbox.get(0);let e=0;const s=new an.Z((()=>{const s=t.offsetHeight;s>e&&(t.style.minHeight=`${s}px`,e=s)})).observe(t);this.listenTo(this,rt.eM.DESTROYED,(()=>{s.disconnect()}))}}const ln=s(19755);class cn extends m.T3{render(){return this.isRendered||(this.$el=ln(".stories-feed"),this._feed=new l._D({$el:this.$el,feedName:"news-preview",focused:!0}),super.render()),this}}var dn=s(8251),un=s(80459),pn=s(95411),hn=s(21906);class _n{static async save(t,e,s){let{data:i}=await A.cf.postOrFail("/ajax/cedit_actions.php",(0,P.defaults)({action:"save",type:t,sid:e},s));return i.id}static async vote(t,e){await A.cf.postOrFail("/ajax/cedit_actions.php",{action:"vote",id:e,v:t})}static async approve(t){await A.cf.postOrFail("/ajax/cedit_actions.php",{action:"approve",id:t})}static async reject(t){await A.cf.postOrFail("/ajax/cedit_actions.php",{action:"reject",id:t})}static async revert(t){await A.cf.postOrFail("/ajax/cedit_actions.php",{action:"revert",id:t})}static async remove(t){await A.cf.postOrFail("/ajax/cedit_actions.php",{action:"delete",id:t})}static async blockStory(t,e,s){await A.cf.postOrFail("/ajax/cedit_actions.php",{action:"block_story",sid:t,type:e,flag:s?"1":"0"})}static async hidePromoBlock(){await A.cf.postOrFail("/ajax/cedit_actions.php",{action:"hide_promo"})}}var mn=s(33416),gn=s(62520),fn=s(19359);class vn extends rt.u1{constructor(t,e){super(t),this.$els={tags:this.$(".cedit-record__tag"),ratingUp:this.$(".cedit-record__rating-up"),ratingDown:this.$(".cedit-record__rating-down"),approveButton:this.$(".cedit-record__button_approve"),rejectButton:this.$(".cedit-record__button_reject"),revertButton:this.$(".cedit-record__button_revert"),deleteButton:this.$(".cedit-record__button_delete"),linkButton:this.$(".cedit-record__button_link"),plusesBar:this.$(".cedit-record__rating-bar-pluses"),label:this.$(".cedit-record__label")},this._id=this.$el.data("id"),this._isLocked=!1,this._story=e,this._assignListeners()}_assignListeners(){this.$els.ratingUp.length>0&&(this.$els.ratingUp.on("click",(()=>{this.$els.ratingUp.hasClass("cedit-record__rating-up_disabled")||this.vote(!0)})),this.$els.ratingDown.on("click",(()=>{this.$els.ratingDown.hasClass("cedit-record__rating-down_disabled")||this.vote(!1)}))),this.$els.deleteButton.on("click",(()=>{this.remove()})),this.$els.approveButton.length>0&&(this.$els.approveButton.on("click",(()=>{this.approve()})),this.$els.rejectButton.on("click",(()=>{this.reject()})),this.$els.revertButton.on("click",(()=>{this.revert()}))),this.$els.linkButton.on("click",(t=>{t.preventDefault();const e=t.target.getAttribute("href");r.Utils.copyToClipboard(e),i.core.ui.toasts.add("copy-link",{content:"Ссылка скопирована!"})}))}_updateState(){let t="true"===this.$el.attr("data-is-approved"),e="true"===this.$el.attr("data-is-rejected");this.$els.ratingUp.toggleClass("cedit-record__rating-up_disabled",t||e),this.$els.ratingDown.toggleClass("cedit-record__rating-down_disabled",t||e),t||e?this.$els.label.text(i.core.i18n("cedit.label."+(t?"approved":"rejected"),i.core.initParams.isUserModerator?"":i.core.initParams.userName)).attr("class","cedit-record__label "+(t?"cedit-record__label_approved":"cedit-record__label_rejected")):this.$els.label.text(i.core.i18n("cedit.label.waiting")).attr("class","cedit-record__label cedit-record__label_waiting")}async approve(){if(!this._isLocked&&"true"!==this.$el.attr("data-is-approved")&&"true"!==this.$el.attr("data-is-canceled")){this.$el.attr("data-is-approved","true"),this.$el.attr("data-is-rejected","false");try{this._isLocked=!0,await _n.approve(this._id),this._isLocked=!1,this._updateState()}catch(t){this.$el.attr("data-is-approved","false"),this._updateState(),i.core.ui.toasts.add({theme:Q.K.DANGER,content:t.message}),this._isLocked=!1}}}async reject(){if(!this._isLocked&&"true"!==this.$el.attr("data-is-rejected")&&"true"!==this.$el.attr("data-is-canceled")){this.$el.attr("data-is-approved","false"),this.$el.attr("data-is-rejected","true");try{this._isLocked=!0,await _n.reject(this._id),this._isLocked=!1,this._updateState()}catch(t){this.$el.attr("data-is-rejected","false"),this._updateState(),i.core.ui.toasts.add({theme:Q.K.DANGER,content:t.message}),this._isLocked=!1}}}async revert(){let t=this.$el.attr("data-is-approved"),e=this.$el.attr("data-is-rejected");if(!(this._isLocked||"false"===t&&"false"===e||"true"===this.$el.attr("data-is-canceled"))){this.$el.attr("data-is-approved","false"),this.$el.attr("data-is-rejected","false");try{this._isLocked=!0,await _n.revert(this._id),this._isLocked=!1,this._updateState()}catch(s){this.$el.attr("data-is-approved",t),this.$el.attr("data-is-reject",e),this._updateState(),i.core.ui.toasts.add({theme:Q.K.DANGER,content:s.message})}}}async remove(){if(!this._isLocked)try{await _n.remove(this._id),this._story&&gn.l.getInstance().sendAddedOrRemovedTagsAnalytics(this._story.tagsList,[...this.$els.tags].map((t=>t.dataset.tag)),{event:"tag_edit_propose",story:this._story,extraParams:{proposal:fn.a8.CANCEL.value}}),this._isLocked=!0,window.location.reload()}catch(t){i.core.ui.toasts.add({theme:Q.K.DANGER,content:t.message})}}async vote(t){if("true"!==this.$el.attr("data-is-available"))return;if(!i.core.isUserAuthorized)return void i.core.ui.authRequired();let e=0,s=t?10:-10;if(this.$els.ratingUp.hasClass("cedit-record__rating-up_active")?(e=1,s=t?0:-10):this.$els.ratingDown.hasClass("cedit-record__rating-down_active")&&(e=-1,s=t?10:0),t){if(1===e)return;-1===e?(this.$els.ratingDown.removeClass("cedit-record__rating-down_active"),e=0):(this.$els.ratingUp.addClass("cedit-record__rating-up_active"),e=1)}else{if(-1===e)return;1===e?(this.$els.ratingUp.removeClass("cedit-record__rating-up_active"),e=0):(this.$els.ratingDown.addClass("cedit-record__rating-down_active"),e=-1)}let n=parseInt(this.$els.plusesBar.attr("data-new-width")||this.$els.plusesBar.attr("data-width"))+s,a=Math.min(100,Math.max(0,n));this.$els.plusesBar.attr("data-new-width",n).attr("data-width",a).css("width",a+"%");try{await _n.vote(e,this._id),0!==e&&this._story&&gn.l.getInstance().sendAddedOrRemovedTagsAnalytics(this._story.tagsList,[...this.$els.tags].map((t=>t.dataset.tag)),{event:"tag_edit_vote",story:this._story,extraParams:{user_rate:e}})}catch(o){1===e?this.$els.ratingUp.removeClass("cedit-record__rating-up_active"):-1===e&&this.$els.ratingDown.removeClass("cedit-record__rating-down_active"),i.core.ui.toasts.add({theme:Q.K.DANGER,content:o.message})}}}const bn=s(19755);class yn extends m.T3{route(t,e){return this.ctx=t,this.show(),this._mode=t.params.mode||"waiting",this.filterRecordsByMode(),e()}render(){if(this.isRendered)return this;let t=bn(".cedit-records");if(this.$els=Object.assign(this.$els||{},{recsCont:t,recs:t.find(".cedit-record").detach(),story:bn(".cedit-story"),emptyMessages:t.find(".cedit-records__empty-msg")}),this._mode=this.$els.recsCont.data("mode")||"waiting",this._records=new WeakMap,this.$els.story.length>0){const t=new mn._({$el:this.$els.story,feedName:"story"});this._story=t.stories.items[0]}return this.$els.recs.each(((t,e)=>{this._records.has(e)||this._records.set(e,new vn(e,this._story))})),i.core.ui.screen=G.dt.POST_TAG_EDIT,super.render(),this}filterRecordsByMode(){let t=null;switch(this.$els.recs.detach(),this._mode){case"waiting":t=this.$els.recs.filter('[data-is-approved="false"][data-is-rejected="false"][data-is-canceled="false"]');break;case"approved":t=this.$els.recs.filter('[data-is-approved="true"]');break;case"rejected":t=this.$els.recs.filter('[data-is-rejected="true"]');break;case"canceled":t=this.$els.recs.filter('[data-is-canceled="true"]')}return this.$els.emptyMessages.removeClass("cedit-records__empty-msg_show"),t&&(this.$els.recsCont.prepend(t.addClass("cedit-record_show")),this.$els.emptyMessages.filter(`[data-mode="${this._mode}"]`).toggleClass("cedit-records__empty-msg_show",0===t.length)),this}}var wn=s(30521),kn=s(81042),xn=s(93971);function Sn(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class $n extends j.u{constructor(...t){super(...t),Sn(this,"_isAddingInProgress",!1),Sn(this,"tags",[])}async update({storyId:t,isAdult:e,tags:s}){if(!this._options.tagsInputEl)return;const{data:i}=await(0,xn.G)({story_id:t,data:JSON.stringify({is_adult:e,tags:s})});this.tags=i.tags.map((t=>t.extra_tag)),this.el?this.updateInnerHTML():(this.el=document.createElement("div"),this.el.classList.add("cedit-story__recommended-tags"),this.updateInnerHTML(),this._options.tagsInputEl.insertAdjacentElement("afterend",this.el),this.el.addEventListener("click",(t=>{t.target instanceof HTMLAnchorElement&&t.target.textContent&&(t.preventDefault(),this.isAddingInProgress=!0,this.emit("click:tag",t.target.textContent))})))}handleAdded(t){this.tags=this.tags.filter((e=>e!==t)),this.updateInnerHTML()}updateInnerHTML(){this.el&&(this.el.innerHTML=this.tags.length?"Рекомендованные теги: "+this.tags.map((t=>`<a href="#${t}">${t}</a>`)).join(""):"")}get isAddingInProgress(){return this._isAddingInProgress}set isAddingInProgress(t){this._isAddingInProgress=t}}var Cn=s(32691);function Tn(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const En=s(19755);class In extends yn{constructor(...t){super(...t),Tn(this,"_updateRecommendedTags",(0,Y.D)((()=>{if(!this.recommendedTags)return;const t=this._form.serialize();this.recommendedTags.update({storyId:this._storyId,isAdult:t.is_adult,tags:t.tags})}),300))}render(){if(this.isRendered)return this;this.$el=En(".cedit-editor"),this.$els=Object.assign(this.$els||{},{form:this.$(".cedit-editor__form"),submitButton:this.$('.cedit-editor__form button[type="submit"]'),blockButton:this.$(".cedit-story__block-btn")}),this._storyId=parseInt(this.$el.data("story-id"))||0,this._type=this.$el.data("type")||"tags",this._id=parseInt(this.$el.data("id"))||0,this._form=this.$els.form.length>0?new dn.x(this.$els.form):null,this._submitButton=this.$els.submitButton.length>0?new un.y(this.$els.submitButton):null,this._form&&(this.listenTo(this._form,"submit",this._onSubmit),"tags"===this._type&&this._initTagsEditor()),this.$els.blockButton.on("click",this._onToggleBlock.bind(this)),i.core.ui.screen=G.dt.POST_TAG_EDIT,super.render()}async _onToggleBlock(){let t=this.$els.blockButton;if(!this.marks.has("is_blocked")){this.marks.set("is_blocked",!0),t.toggleClass("cedit-story__block-btn_active");try{await _n.blockStory(this._storyId,this._type,t.hasClass("cedit-story__block-btn_active"))}catch(e){this._submitButton.disabled=!1,i.core.ui.toasts.showError(e)}this.marks.delete("is_blocked")}}async _onSubmit(t,e){if(t.preventDefault(),this._submitButton.progress)return!1;await r.Utils.delay(100);const s=e instanceof dn.x?e:this._form;if(!(await s.checkValidity(!0)))return!1;this._submitButton.progress=!0;try{this._submitButton.disabled=!0;const t=this._form.serialize(),e=t.tags.split(",");let s=await _n.save(this._type,this._storyId,t);gn.l.getInstance().sendAddedOrRemovedTagsAnalytics(this._story.tagsList,e,{event:"tag_edit_propose",story:this._story}),i.core.ui.toasts.add({content:i.core.i18n("cedit.editor.form.saved")}),await r.Utils.delay(500),window.location.href=`/edits/${this._storyId}/${s}`}catch(n){this._submitButton.disabled=!1,i.core.ui.toasts.showError(n)}this._submitButton.progress=!1}_initTagsEditor(){const t=this.$(".input_tags");if(0===t.length)return;const e=new hn.K({$el:this.$(".input_tags"),validationHint:!0,validationEvent:kn.k.BLUR,softLimitsValidation:!0});e.suggestion=new wn.Z({tagsLine:!0,filter:fn.ll.SEARCH}),this._form.add(e),this._hotkeys=new pn.SV(e.$el.find("input")),this._hotkeys.on("cmd+enter",this._onSubmit.bind(this),{type:pn.FM.KEYDOWN}),t.data("recommended-available")&&(this.recommendedTags=new $n({tagsInputEl:t.get(0)}),this._updateRecommendedTags(),this.listenTo(this._form,"change",((t,e)=>{e instanceof Cn.m&&"is_adult"===e.$els.input.attr("name")&&this._updateRecommendedTags()})),this.listenTo(this.recommendedTags,"click:tag",(t=>{e.items.size>=e.maxTags?i.core.ui.toasts.showError("Превышен максимальный лимит тегов"):(e.createItem(t),this.recommendedTags.handleAdded(t))})),this.listenTo(e.items,lt.u$.UPDATE,(()=>{this.recommendedTags.isAddingInProgress?this.recommendedTags.isAddingInProgress=!1:this._updateRecommendedTags()})))}}const On=s(19755);class Un extends m.T3{render(){if(this.isRendered)return this;const t=new mn._({$el:On(".cedit-story"),feedName:"story"});return new vn(On(".cedit-record"),t.stories.items[0]),i.core.ui.screen=G.dt.POST_TAG_EDIT,super.render(),this}}s(41637);const Dn=new ut.xs({SHOW_ALL:0,HIDE_VOTED:1}),An=new ut.xs({ACTUALITY:0,TIME_DESC:1,TIME_ASC:2}),Mn=new ut.xs({ALL:"all",WAITING:"waiting",APPROVED:"approved",REJECTED:"rejected",CANCELED:"canceled"}),Nn=new ut.xs({SHOW:0,HIDE:1});function Pn(t){var e,s="";return s+='<form class="cedit-feed-filter">\n\t<label class="cedit-feed-filter__field">\n\t\t<span class="cedit-feed-filter__title">Скрывать оценённые</span>\n\t\t<input type="checkbox" name="hideVoted" class="checkbox_switch" value="true" data-to-boolean="true" '+(null==(e=t.hideVoted?'checked="checked"':"")?"":e)+'>\n\t</label>\n    <label class="cedit-feed-filter__field">\n        <span class="cedit-feed-filter__title">Скрывать автоматические предложения</span>\n        <input type="checkbox" name="botFilter" class="checkbox_switch" value="true" data-to-boolean="true" '+(null==(e=t.botFilter?'checked="checked"':"")?"":e)+'>\n    </label>\n\t<label class="cedit-feed-filter__field">\n\t\t<span class="cedit-feed-filter__title">Сортировка</span>\n\t\t<select data-role="listbox" name="sort">\n\t\t\t<option value="0" '+(null==(e=0===t.sort?'selected="selected"':"")?"":e)+'>По актуальности</option>\n\t\t\t<option value="1" '+(null==(e=1===t.sort?'selected="selected"':"")?"":e)+'>Сначала новые</option>\n\t\t\t<option value="2" '+(null==(e=2===t.sort?'selected="selected"':"")?"":e)+">Сначала старые</option>\n\t\t</select>\n\t</label>\n</form>\n"}const Ln=s(19755);class Rn extends m.T3{route(t,e){this.ctx=t,this.show();const s="string"==typeof t.params.user?"user":t.params.mode||"waiting";return this._mode===s||"mine"===this._mode&&"user"===s&&t.params.user===i.core.initParams.userName||(this._mode=s,this.$el&&this.$el.attr("data-mode",this._mode),this._rebuildFeed()),e()}render(){if(this.isRendered)return this;this.$el=Ln(".cedit-feed"),this.$els={panel:this.$(".cedit-feed__panel"),statusFilter:this.$(".cedit-feed__status-filter"),statusFilterButtons:this.$(".cedit-feed__status-filter .cedit-feed__button"),filterButton:this.$el.find(".button-filter"),total:this.$(".cedit-feed__total")};const t=new URLSearchParams(window.location.search),e=t.get("filter")||this.$el.data("filter"),s=t.get("bot_filter")||this.$el.data("bot-filter"),n=t.get("sort")||this.$el.data("sort"),a=t.get("status")||this.$els.statusFilter.data("status")||"all";return this._mode=this.$el.data("mode")||"waiting",this._status=Mn[a]||Mn.ALL,this._records=new WeakMap,this._filterMode=Dn[parseInt(e)]||Dn.SHOW_ALL,this._botFilterMode=Nn[parseInt(s)]||Nn.SHOW,this._sortMode=An[parseInt(n)]||An.ACTUALITY,this._feed=new mn._({$el:this.$el,feedName:"cedit",focused:!0}),this.$els.filterButton.toggleClass("cedit-feed__filter-button_hide","waiting"!==this._mode),this.listenTo(this._feed,"loaded",this._processFeedLoad.bind(this)),Ln(".cedit-promo button").on("click",this._hidePromo.bind(this)),i.core.ui.screen=G.dt.TAGS_EDITS,super.render(),this._prepareFeedFilter(),this._prepareStatusFilter(),this._processFeedLoad(),this}_prepareFeedFilter(){if(!this.$els.filterButton.length)return;const t=new R._({target:this.$els.filterButton,alignment:R.SE.END,distance:-12,indent:!1,content:Pn({hideVoted:this._filterMode===Dn.HIDE_VOTED,sort:this._sortMode.valueOf(),botFilter:this._botFilterMode===Nn.HIDE})}),e=t.content;this.$els.filterButton.on("click",(()=>t.toggle())),this.listenTo(t,rt.eM.RENDERED,(()=>{const s=new at.x(e);this.listenTo(s,"change",(()=>{const e=s.serialize();this._filterMode=Dn[e.hideVoted?1:0],this._botFilterMode=Nn[e.botFilter?1:0],this._sortMode=An[parseInt(e.sort)],t.hide(),this._rebuildFeed()}))}))}_prepareStatusFilter(){this.$els.statusFilterButtons.on("click",(t=>{const e=Ln(t.target).closest(".cedit-feed__button").data("value");this._status=Mn[e],this.$els.statusFilter.attr("data-status",this._status.valueOf());const s=new URLSearchParams(window.location.search);s.delete("page"),i.core.history.replaceUrl(window.location.pathname+"?"+s.toString()),this._rebuildFeed()}))}_hidePromo(){_n.hidePromoBlock(),Ln(".cedit-promo").slideUp(500)}_rebuildFeed(){this.$els.panel.addClass("cedit-feed__panel_hide"),this.$els.filterButton.toggleClass("cedit-feed__filter-button_hide","waiting"!==this._mode);const t=new URLSearchParams(window.location.search);this._records=new WeakMap,this._feed.requestUrl=window.location.pathname,this._feed.searchParams.set("filter",this._filterMode.valueOf()),this._feed.searchParams.set("bot_filter",this._botFilterMode.valueOf()),this._feed.searchParams.set("sort",this._sortMode.valueOf()),this._feed.searchParams.set("status",this._status.valueOf()),t.set("filter",this._filterMode.valueOf()),t.set("bot_filter",this._botFilterMode.valueOf()),t.set("sort",this._sortMode.valueOf()),t.set("status",this._status.valueOf());const e=t.get("page");e&&(this._feed.page=parseInt(e)),i.core.history.replaceUrl(window.location.pathname+"?"+t.toString()),this._feed.clear().loadStories(!1)}_processFeedLoad(t){t&&this.$els.total.text(i.core.i18n("cedit.feed.total",parseInt(t.total_cedit_recs))),this.$els.panel.removeClass("cedit-feed__panel_hide"),(0,P.defer)((()=>{this.$el.find(".cedit-record").each(((t,e)=>{if(!this._records.has(e)){const t=this._feed.stories.get(Number(e.closest(".story").dataset.storyId));this._records.set(e,new vn(e,t))}})),this.$el.find(".cedit-records__show-more:not(.cedit-records__show-more_processed)").addClass("cedit-records__show-more_processed").on("click",Rn._onShowMore)}))}static _onShowMore(t){Ln(t.target).closest(".cedit-records").addClass("cedit-records_view-all").find(".cedit-record").addClass("cedit-record_show")}}!function(){if("object"==typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var t=window.document,e=[];i.prototype.THROTTLE_TIMEOUT=100,i.prototype.POLL_INTERVAL=null,i.prototype.USE_MUTATION_OBSERVER=!0,i.prototype.observe=function(t){if(!this._observationTargets.some((function(e){return e.element==t}))){if(!t||1!=t.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:t,entry:null}),this._monitorIntersections(),this._checkForIntersections()}},i.prototype.unobserve=function(t){this._observationTargets=this._observationTargets.filter((function(e){return e.element!=t})),this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())},i.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorIntersections(),this._unregisterInstance()},i.prototype.takeRecords=function(){var t=this._queuedEntries.slice();return this._queuedEntries=[],t},i.prototype._initThresholds=function(t){var e=t||[0];return Array.isArray(e)||(e=[e]),e.sort().filter((function(t,e,s){if("number"!=typeof t||isNaN(t)||t<0||t>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return t!==s[e-1]}))},i.prototype._parseRootMargin=function(t){var e=(t||"0px").split(/\s+/).map((function(t){var e=/^(-?\d*\.?\d+)(px|%)$/.exec(t);if(!e)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(e[1]),unit:e[2]}}));return e[1]=e[1]||e[0],e[2]=e[2]||e[0],e[3]=e[3]||e[1],e},i.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(n(window,"resize",this._checkForIntersections,!0),n(t,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in window&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))},i.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,a(window,"resize",this._checkForIntersections,!0),a(t,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))},i.prototype._checkForIntersections=function(){var t=this._rootIsInDom(),e=t?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach((function(i){var n=i.element,a=o(n),r=this._rootContainsTarget(n),l=i.entry,c=t&&r&&this._computeTargetAndRootIntersection(n,e),d=i.entry=new s({time:window.performance&&performance.now&&performance.now(),target:n,boundingClientRect:a,rootBounds:e,intersectionRect:c});l?t&&r?this._hasCrossedThreshold(l,d)&&this._queuedEntries.push(d):l&&l.isIntersecting&&this._queuedEntries.push(d):this._queuedEntries.push(d)}),this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)},i.prototype._computeTargetAndRootIntersection=function(e,s){if("none"!=window.getComputedStyle(e).display){for(var i,n,a,r,c,d,u,p,h=o(e),_=l(e),m=!1;!m;){var g=null,f=1==_.nodeType?window.getComputedStyle(_):{};if("none"==f.display)return;if(_==this.root||_==t?(m=!0,g=s):_!=t.body&&_!=t.documentElement&&"visible"!=f.overflow&&(g=o(_)),g&&(i=g,n=h,a=void 0,r=void 0,c=void 0,d=void 0,u=void 0,p=void 0,a=Math.max(i.top,n.top),r=Math.min(i.bottom,n.bottom),c=Math.max(i.left,n.left),d=Math.min(i.right,n.right),p=r-a,!(h=(u=d-c)>=0&&p>=0&&{top:a,bottom:r,left:c,right:d,width:u,height:p})))break;_=l(_)}return h}},i.prototype._getRootRect=function(){var e;if(this.root)e=o(this.root);else{var s=t.documentElement,i=t.body;e={top:0,left:0,right:s.clientWidth||i.clientWidth,width:s.clientWidth||i.clientWidth,bottom:s.clientHeight||i.clientHeight,height:s.clientHeight||i.clientHeight}}return this._expandRectByRootMargin(e)},i.prototype._expandRectByRootMargin=function(t){var e=this._rootMarginValues.map((function(e,s){return"px"==e.unit?e.value:e.value*(s%2?t.width:t.height)/100})),s={top:t.top-e[0],right:t.right+e[1],bottom:t.bottom+e[2],left:t.left-e[3]};return s.width=s.right-s.left,s.height=s.bottom-s.top,s},i.prototype._hasCrossedThreshold=function(t,e){var s=t&&t.isIntersecting?t.intersectionRatio||0:-1,i=e.isIntersecting?e.intersectionRatio||0:-1;if(s!==i)for(var n=0;n<this.thresholds.length;n++){var a=this.thresholds[n];if(a==s||a==i||a<s!=a<i)return!0}},i.prototype._rootIsInDom=function(){return!this.root||r(t,this.root)},i.prototype._rootContainsTarget=function(e){return r(this.root||t,e)},i.prototype._registerInstance=function(){e.indexOf(this)<0&&e.push(this)},i.prototype._unregisterInstance=function(){var t=e.indexOf(this);-1!=t&&e.splice(t,1)},window.IntersectionObserver=i,window.IntersectionObserverEntry=s}function s(t){this.time=t.time,this.target=t.target,this.rootBounds=t.rootBounds,this.boundingClientRect=t.boundingClientRect,this.intersectionRect=t.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0},this.isIntersecting=!!t.intersectionRect;var e=this.boundingClientRect,s=e.width*e.height,i=this.intersectionRect,n=i.width*i.height;this.intersectionRatio=s?Number((n/s).toFixed(4)):this.isIntersecting?1:0}function i(t,e){var s,i,n,a=e||{};if("function"!=typeof t)throw new Error("callback must be a function");if(a.root&&1!=a.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=(s=this._checkForIntersections.bind(this),i=this.THROTTLE_TIMEOUT,n=null,function(){n||(n=setTimeout((function(){s(),n=null}),i))}),this._callback=t,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(a.rootMargin),this.thresholds=this._initThresholds(a.threshold),this.root=a.root||null,this.rootMargin=this._rootMarginValues.map((function(t){return t.value+t.unit})).join(" ")}function n(t,e,s,i){"function"==typeof t.addEventListener?t.addEventListener(e,s,i||!1):"function"==typeof t.attachEvent&&t.attachEvent("on"+e,s)}function a(t,e,s,i){"function"==typeof t.removeEventListener?t.removeEventListener(e,s,i||!1):"function"==typeof t.detatchEvent&&t.detatchEvent("on"+e,s)}function o(t){var e;try{e=t.getBoundingClientRect()}catch(s){}return e?(e.width&&e.height||(e={top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.right-e.left,height:e.bottom-e.top}),e):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function r(t,e){for(var s=e;s;){if(s==t)return!0;s=l(s)}return!1}function l(t){var e=t.parentNode;return e&&11==e.nodeType&&e.host?e.host:e&&e.assignedSlot?e.assignedSlot.parentNode:e}}();var jn=s(73429),Bn=s(36005);var qn=s(36005);function Fn(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const Vn=s(19755);class Zn extends rt.u1{constructor(t){super(),Fn(this,"_labelPopupShown",!1),Fn(this,"_onMentionMarked",(()=>{})),this.mention=t.mention,this._onMentionMarked=t.onMentionMarked}render(){return this.isRendered?this:(this.$el=Vn(function(t){var e,i="",n=Bn.escape;Array.prototype.join;const a=s(12953).core;return i+='\n\n<section class="client-mention" data-type="'+n(t.type)+'" data-id="'+n(t.id)+'">\n    <div class="client-mention__header">\n        ',t.isRead||(i+='\n            <span class="client-mention__badge client-mention__badge_new">Новое</span>\n        '),i+='\n\n        <span class="client-mention__badge">'+n(a.i18n("reputation.typeCaptions."+t.type))+'</span>\n        <div class="client-mention__label-controls"></div>\n\n        ',t.isRead||(i+='\n            <div class="client-mention__read-btn button_link-icon">\n                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__message"><use xlink:href="#icon--ui__message"></use></svg> Прочитано\n            </div>\n        '),i+='\n    </div>\n\n    <div class="client-mention__main">\n        ',i+"\n        "+(null==(e=t.html)?"":e)+"\n    </div>\n</section>"}(this.mention)),this.$els={label:this.$(".client-mention__label-controls"),readBtn:this.$(".client-mention__read-btn"),badgeNew:this.$(".client-mention__badge_new")},["comment","comment_reply"].includes(this.mention.type)&&this._initComment(),this._attachHandlers(),this._updateLabel(),super.render())}async _markAsRead(){this.mention.isRead||(await jn.Y.markAsRead([this.mention]),this.mention.isRead=!0,this.$els.readBtn.hide(),this.$els.badgeNew.hide(),i.core.ui.sidebar.reputationMonitoringMenuItem.decrementMentionsByType(this.mention.type),this._onMentionMarked())}removeLabel(){i.core.ui.overlays.modal.hidePopup(),jn.b.unstick(this.mention),this.mention.labelId=null,this.mention.labelName="",this._updateLabel()}async addLabel(){if(this._labelPopupShown)return;this._labelPopupShown=!0;const t=await jn.b.popup(this.$els.label);this._labelPopupShown=!1,t&&(await jn.b.stick(this.mention,t.id),this.mention.labelId=t.id,this.mention.labelName=t.name,this._updateLabel())}_initComment(){const t=this.$el.find(".comments").parent().addClass("comments-part");new Ti.z({$el:t,mode:Ei.lL.REPUTATION}).show().initComments()}_attachHandlers(){this.$els.label.on("click",(t=>this._onLabelClick(t))),this.$els.readBtn.on("click",(()=>this._markAsRead()))}_updateLabel(){this.$els.label.html(function(t){var e="",s=qn.escape;return Array.prototype.join,t.labelName?e+='\n    <span data-role="label-badge" class="client-mention__badge client-mention__badge_label">'+s(t.labelName)+'</span>\n\n    <span data-action="remove-label" role="button" class="client-mention__label-button hint" aria-label="Снять метку">\n        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__reputation-label-remove"><use xlink:href="#icon--ui__reputation-label-remove"></use></svg>\n    </span>\n':e+='\n    <span data-action="add-label" role="button" class="client-mention__label-button" aria-label="Добавить метку">\n        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__reputation-label-add"><use xlink:href="#icon--ui__reputation-label-add"></use></svg>\n    </span>\n',e+="\n\n"}(this.mention))}_onLabelClick(t){const{target:e}=t;switch(e.getAttribute("data-action")){case"add-label":this.addLabel();break;case"remove-label":this.removeLabel()}}}const Wn=s(19755);class zn extends rt.u1{constructor(t){super(t),this._filter="",this._label=null,this._offset=0,this._timestamp=Date.now(),this._keywords=[],this._mentions=[],this._hasMore=!0,this._loading=!1,this._animationStart=Date.now(),this._spinner=null,this._storiesFeed=null}render(){return this.isRendered||(this.$els={empty:this.$(".mentions-feed__empty").hide(),feed:this.$(".mentions-feed__feed"),storiesFeed:this.$(".stories-feed"),spinner:this.$(".mentions-feed__spinner"),downloads:Wn(".mentions-feed__downloads"),getCsvButton:Wn(".mentions-feed__get-csv")},this._spinner=this._renderSpinner(),this._storiesFeed=this._renderStoriesFeed(),this.listenTo(i.core.ui,"document-scroll",(0,P.throttle)((()=>this._handleScrolling()),200)),this.$els.downloads.hide(),this.loadMore(),this._createCsvButton()),this}clear(){this._mentions=[],this._offset=0,this._hasMore=!0,this.$els.feed.empty(),this.$els.empty.hide()}setFilter(t){return this._filter=t,this}setLabel(t){return this._label=t,this}async toggleLoading(t){this._loading!==t&&(t?(this._animationStart=Date.now(),this.$els.empty.hide()):await r.Utils.delay(500-(Date.now()-this._animationStart)),this._loading=t,this._spinner.togglePlay(t))}async loadMore(){try{const t=this._lastRequestId=(0,P.uniqueId)("client-mentions-feed_");await this.toggleLoading(!0);const{mentions:e=[],keywords:s,hasMore:i,timestamp:n}=await jn.Y.getMentions(this._filter,this._label,this._offset,this._timestamp);if(t!==this._lastRequestId)return void(await this.toggleLoading(!0));await this.toggleLoading(!1),this._offset+=e.length||0,this._hasMore=i,this._keywords=s,this._timestamp=n,this._addMentions(e),this._storiesFeed.initStories(),this._toggleEmpty(),this.emit("mentions-loaded")}catch(t){i.core.ui.toasts.showError(t)}}_renderSpinner(){return i.core.ui.player.createAnimation("stories-spinner",{$parent:this.$els.spinner})}_renderStoriesFeed(){const{ReputationStoriesFeed:t}=this.useRegistry();return new t(this.$els.storiesFeed)}_highlightKeywords(t){var e;if(null===(e=this._keywords)||void 0===e||!e.length)return;const s=[".comment__content",".comments__title",".story__header",".story__content",".story__tags"].join(","),i=this._keywords.map((t=>{const e="[^a-zа-яА-ЯёЁ]",s=`(?:[a-zа-яА-ЯёЁ]{0,2}(?:$|${e}))`;return`(?:^|${e})`+"("+r.Utils.escapeStringRegExp(t)+")"+s})),n=new RegExp(i.join("|"),"i");It.y.add(t.find(s),n,"highlight",(t=>{const e=t.find(((t,e)=>e>0&&Boolean(t)));return{startPos:t[0].indexOf(e),length:e.length}}))}_handleScrolling(){this._hasMore&&!this._loading&&i.core.ui.elementWillSoonScrolled(this.$els.feed[0])&&this.loadMore()}_toggleEmpty(){const t=this._mentions.length>0;this.$els.downloads.toggle(null!==i.core.storage.reputationLabelStorage.labelId&&t),this.$els.empty.toggle(!t)}_addMentions(t=[]){const e=Wn(document.createDocumentFragment());for(const s of t){const t=new Zn({mention:s,onMentionMarked:()=>this.emit("mention-marked-as-read")});t.appendTo(e).mount(),this._mentions.push(t)}this._highlightKeywords(e),this.$els.feed.append(e)}_createCsvButton(){this.$els.getCsvButton.off("click").on("click",(()=>{null!==i.core.storage.reputationLabelStorage.labelId&&0!==this._mentions.length&&jn.Y.getMentionsCSV(this._filter,this._label,this._timestamp)}))}get loading(){return this._loading}}function Hn(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const Gn=s(19755),Yn=["story","comment","comment_reply","feedback"];class Kn extends m.T3{constructor(...t){super(...t),Hn(this,"_hasUnreadMention",!1),Hn(this,"_onMentionsLoaded",(()=>{const t=i.default.ui.sidebar.reputationMonitoringMenuItem;if(!t)return;const e=t.getTotalUnreadMentionsCount(),s=t.getMentionsCountsMap();this._hasUnreadMention=this._filter?s[this._filter]>0:e>0,this.$els.readAll.css("display",this._hasUnreadMention?"flex":"none")})),Hn(this,"_loadTotalMentionsForSidebar",(()=>{jn.Y.getSidebarCounters().then((({answers:t,mentions:e})=>{this.$els.sidebarMentions.text(e).toggle(Boolean(e)),this.$els.sidebarAnswers.text(t).toggle(Boolean(t))}))})),Hn(this,"_onMentionMarkedAsRead",(()=>{const t=i.default.ui.sidebar.reputationMonitoringMenuItem;if(!t)return;const e=t.getTotalUnreadMentionsCount(),s=t.getMentionsCountsMap();(0===e||s&&0===s[this._filter])&&(this._hasUnreadMention=!1,this.$els.readAll.hide())}))}route(t,e){this.ctx=t;const s=t.params.filter||"",n=String(s).replace(/-/g,"_"),a=this._filter;this._filter=Yn.includes(n)?n:"",this._filter!==a&&this._reloadFeed();const{reputationLabelStorage:o}=i.default.storage;return this._label=o?o.labelId:null,this.isShown||this.show(),this.$els.sidebarMentions.length&&this.$els.sidebarAnswers.length&&this._loadTotalMentionsForSidebar(),e()}render(){return this.isRendered||(this.$parent=Gn(".page-reputation-monitoring"),this.$el=Gn('<div class="mentions-feed-page">\n    <div class="mentions-feed">\n        <div class="mentions-feed__container">\n            <div class="mentions-feed__read-all">\n                <div class="button_link-icon">\n                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__message"><use xlink:href="#icon--ui__message"></use></svg> Отметить всё прочитанным\n                </div>\n            </div>\n            <div class="stories-feed">\n                <div class="stories-feed__container">\n                    <div class="mentions-feed__feed"></div>\n                    <div class="mentions-feed__spinner center"></div>\n                    <section class="mentions-feed__empty" style="display: none">\n                        К сожалению, по вашему запросу ничего нет. Попробуйте изменить параметры поиска\n                    </section>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'),this.$els={readAll:this.$(".mentions-feed__read-all"),sidebarMentions:Gn('.bell_profile-menu[data-role="reputation"]'),sidebarAnswers:Gn('.bell_profile-menu[data-role="answers"]')},this._feed=this._createFeed().setFilter(this._filter).setLabel(this._label).show(),this.listenTo(this._feed,"mentions-loaded",this._onMentionsLoaded),this.listenTo(this._feed,"mention-marked-as-read",this._onMentionMarkedAsRead),i.default.storage.reputationLabelStorage.on("change search-by-label",(t=>{this._label=t,this._reloadFeed()})),this._createReadAllButton()),this}_createFeed(){return new zn({$el:this.$(".mentions-feed")})}_reloadFeed(){this._feed&&(this._feed.clear(),this._feed.setFilter(this._filter),this._feed.setLabel(this._label),this._feed.loadMore())}_createReadAllButton(){this.$els.readAll.find(".button_link-icon").on("click",(async()=>{this._hasUnreadMention&&(await jn.Y.markAllAsRead(this._filter),i.default.ui.sidebar.reputationMonitoringMenuItem.reduceAllCountByType(this._filter),this._reloadFeed())}))}}var Qn=s(42930);const Xn=s(19755);class Jn extends m.T3{render(){return this.isRendered||(this.$el=Xn('<div class="reputation-labels-page">\n    <div class="reputation-labels-page__container"></div>\n</div>\n'),this.$parent=Xn(".page-reputation-monitoring"),this.$els={container:this.$(".reputation-labels-page__container")},this._labelsList=new Qn.Y({$el:this.$el,$parent:this.$els.container}).show()),this}}var ta=s(16106),ea=s(53561);const sa=new ut.xs({FIRST_ON:0,LAST_OFF:1,ON:2,OFF:3});class ia{constructor(t=!1){this._listeningTo=void 0,this._events=void 0,t&&this.initHook(),this._listenId=(0,P.uniqueId)("lid")}get hook(){return this._hook}initHook(){return this._hook||(this._hook=new ia),this}static prepare(t,e,s,...i){if(!s)return!0;let n=s instanceof ut.Tf;if("object"==typeof s&&!n){if((0,P.isArray)(s))for(let n of s)t[e].call(t,n,...i);else for(let n in s)s.hasOwnProperty(n)&&t[e].call(t,n,s[n],...i);return!1}if(!n&&ea.X.test(s)){for(let n of s.split(ea.X))t[e].call(t,n,...i);return!1}return!0}_createListenMethod(t,e,s,i){if(!e)throw new Error(`Trying to listenTo event: '${s}' but the target object is undefined`);if(!e._listenId)throw new Error(`Trying to listenTo event: '${s}' but the target object does not have listen id`);if((this._listeningTo||(this._listeningTo={}))[e._listenId]=e,i||"object"!=typeof s||(i=this),"function"!=typeof e[t])throw new Error(`Trying to listenTo event: '${s}' on object: ${e.toString()} but it does not have an \n\t\t\t\t'${t}' method so is unbindable`);return e[t](s,i,this),this}listenTo(t,e,s){return this._createListenMethod("on",t,e,s)}listenToOnce(t,e,s){return this._createListenMethod("once",t,e,s)}stopListening(t,e,s){if(!this._listeningTo)return this;let i=this._listeningTo,n=!e&&!s;return s||"object"!=typeof e||e instanceof ut.Tf||(s=this),t&&((i={})[t._listenId]=t),(0,P.forEach)(i,((t,i)=>{t.off(e,s,this),(n||(0,P.isEmpty)(t._events))&&delete this._listeningTo[i]})),this}on(t,e,s){if(!ia.prepare(this,"on",t,e,s)||!e)return this;let i;return this._events||(this._events=new Map),this._events.has(t)?(i=this._events.get(t),this._hook&&this._hook.emit(t,sa.ON,e)):(this._events.set(t,i=[]),this._hook&&(this._hook.emit(t,sa.FIRST_ON),this._hook.emit(t,sa.ON,e))),i.push({callback:e,context:s,ctx:s||this}),this}once(t,e,s){if(!ia.prepare(this,"once",t,e,s)||!e)return this;let i=this,n=function(){i.off(t,n),e.apply(this,arguments)};return n._callback=e,this.on(t,n,s)}off(t,e,s){let i;if(!this._events||!ia.prepare(this,"off",t,e,s))return this;if(!t&&!e&&!s)return this._events.clear(),this._events=void 0,this._hook,this;i=t?[t]:this._events.keys();for(let n of i){let t,i=this._events.get(n);if(i){if(this._events.set(n,t=[]),e||s)for(let n of i)(e&&e!==n.callback&&e!==n.callback._callback||s&&s!==n.context)&&t.push(n);t.length||(this._events.delete(n),this._hook&&this._hook.emit(n,sa.LAST_OFF))}}return this}removeAllListeners(){this.off()}emit(t,...e){return this._events&&ia.prepare(this,"emit",t,...e)?(this._events.has(t)&&this._emit(this._events.get(t),e),this._events.has(ea.b)&&this._emit(this._events.get(ea.b),[t].concat(e)),this):this}_emit(t,e){if(!t)return this;for(let s=0,i=t.length;s<i;s++){let i=t[s];i.callback.apply(i.ctx,e)}return this}emitResult(t,...e){let s;if(this._events&&this._events.has(t)){s=this._events.get(t);for(let t=s.length;t--;){let i=s[t],n=i.callback.apply(i.ctx,e);if(void 0!==n)return n}}}listeners(t){return this._events&&this._events.get(t)||[]}}function na(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}ia.prototype.removeEventListener=ia.prototype.removeListener=ia.prototype.off,ia.prototype.addEventListener=ia.prototype.addListener=ia.on,ia.prototype.emitEvent=ia.prototype.trigger=ia.prototype.emit;class aa extends ia{constructor(...t){super(...t),na(this,"_label",null)}setLabel(t){return(0,P.isEqual)(t,this._label)||(this._label=t,this.emit("change",null==t?void 0:t.id)),this}search(){this.emit("search-by-label",this.labelId)}get labelId(){return this._label?this._label.id:null}}function oa(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const ra=s(19755);class la extends m.GR{constructor(t){super(t),this.use({[la._reputationRoute]:this,[`${la._reputationRoute}/:filter(story|comment|comment-reply|feedback)?`]:Kn,[la._reputationLabelsRoute]:Jn})}render(){return this.isRendered||(this.$el=ra(".page-reputation-monitoring"),this.$els={spinner:this.$('[data-role="spinner"]').hide(),readAll:this.$(".mentions-feed__read-all"),downloads:ra(".mentions-feed__downloads"),search:ra("#page-reputation-monitoring__search")},this._createSearchInput(),this.listenTo(this._router,"match",(t=>{this.$els.readAll.hide(),this._toggleCsvDownloadsButton(t)})),super.render()),this}_toggleCsvDownloadsButton(t){this.$els.downloads.toggle(null!==i.default.storage.reputationLabelStorage.labelId&&t!==la._reputationLabelsRoute)}_createSearchInput(){const{UIInput:t,UIDropDownReputationLabels:e}=this.useRegistry();this._searchInput=new t({$el:this.$els.search,addClearButton:!0}),this._searchInput.suggestion=new e,i.default.storage.reputationLabelStorage=new aa,this._searchInput.$("button").on("click",(()=>{i.default.storage.reputationLabelStorage.search()})),this.listenTo(this._searchInput,"change",(t=>{""===t&&i.default.storage.reputationLabelStorage.setLabel(null)})),this.listenTo(this._searchInput,ta.nT.SELECT,(t=>{if(!t)return;const{id:e,name:s,count:n}=t.data;i.default.storage.reputationLabelStorage.setLabel({id:e,name:s,count:n}),this._searchInput.value=s}))}}oa(la,"_reputationRoute","/reputation"),oa(la,"_reputationLabelsRoute",`${la._reputationRoute}/labels`);class ca extends j.u{constructor(){super();const t=document.querySelector(".page-reputation-monitoring__menu > .menu");if(!t)throw new Error;this.els={menu:t},this.scrollToActiveElement(),this.initMouseDragScroll()}scrollToActiveElement(){const{menu:t}=this.els,e=t.querySelector(".menu__item_current");if(!e)return;const s=t.clientWidth,i=e.offsetLeft+e.offsetWidth;i>s&&(t.scrollLeft=i-s)}initMouseDragScroll(){const t=this.els.menu;let e,s,i=!1;const n=()=>{i=!1,t.classList.remove("scrolling")};t.addEventListener("pointerdown",(n=>{t.scrollWidth!==t.clientWidth&&(i=!0,e=n.pageX-t.offsetLeft,s=t.scrollLeft)})),t.addEventListener("pointerleave",n),t.addEventListener("pointercancel",n),t.addEventListener("pointerup",n),t.addEventListener("pointermove",(n=>{if(!i)return;const a=n.pageX-t.offsetLeft-e;!t.hasPointerCapture(n.pointerId)&&Math.abs(a)>=4&&(t.setPointerCapture(n.pointerId),t.classList.add("scrolling")),t.scrollLeft=s-a})),t.addEventListener("dragstart",(t=>{i&&(t.preventDefault(),t.stopPropagation())}))}}var da=s(72346),ua=s(95374);const pa=s(19755);class ha extends m.T3{render(){if(this.isRendered)return this;const{UIForm:t}=this.useRegistry();return this.$el=pa(".page-profile"),this.$els={container:this.$(".reputation-feedback-form"),form:this.$(".reputation-feedback-form__form"),error:this.$(".reputation-feedback-form__error")},this._form=new t(this.$els.form),this._form.on("submit",this._onSubmit.bind(this)),this._hintStyle={direction:R.Lh.LEFT,alignment:R.SE.CENTER},this._name=this._prepareNameInput(),this._message=this._prepareMessageInput(),this._phone=this._preparePhoneInput(),this._email=this._prepareEmailInput(),[this._name,this._message,this._phone,this._email].forEach((t=>{this._form.add(t),this.listenTo(t,"enter",(t=>t.preventDefault()))})),this}getClientID(){return parseInt(this.$els.container.data("client-id"),10)}_getInputElement(t){return this.$(`[name="${t}"]`).closest(".input")}_prepareNameInput(){const{UIInput:t}=this.useRegistry();return new t({$el:this._getInputElement("name"),sanitizerRules:[da.o.whitelist("A-Za-zА-Яа-яЁё "),da.o.singleSpace()],autocorrect:!0,validationRules:{"validation-rules.required":ua.c.required()},validationHint:this._hintStyle})}_prepareEmailInput(){const{UIInput:t}=this.useRegistry();return new t({$el:this._getInputElement("email"),autocorrect:!0,sanitizerRules:[da.o.trim()],validationRules:{"validation-rules.email":ua.c.email()},validationHint:this._hintStyle})}_preparePhoneInput(){const{UIInput:t}=this.useRegistry();return new t({$el:this._getInputElement("phone"),autocorrect:!0,sanitizerRules:[da.o.whitelist("0-9\\+\\-\\(\\)"),da.o.singleSpace()]})}_prepareMessageInput(){const{UITextArea:t}=this.useRegistry();return new t({$el:this._getInputElement("message"),sanitizerRules:[da.o.trim()],validationRules:{"validation-rules.required":ua.c.required()},validationHint:this._hintStyle})}async _checkSecondaryFieldsValidity(){const t=i.core.i18n("page-reputation-feedback.secondary-inputs-empty");if(!Boolean(this._email.value||this._phone.value))return[this._email,this._phone].forEach((t=>t.removeState(ye.dD.SUCCESS).addState(ye.dD.ERROR))),this.$els.error.text(t).show(),!1;this.$els.error.empty().hide();return(await Promise.all([this._email.checkValidity(),this._phone.checkValidity()])).every((t=>!0===t))}async _onSubmit(t){t.preventDefault();const e=await this._name.checkValidity(),s=await this._message.checkValidity();if(e&&s&&await this._checkSecondaryFieldsValidity())try{await jn.Y.saveFeedback(this._form.serialize()),this._form.reset(),this.$el.hide().after('<section class="reputation-feedback-success">\n    <h1 class="reputation-feedback-success__title">Ваше сообщение отправлено!</h1>\n\n    <p class="reputation-feedback-success__text">Спасибо, что воспользовались формой обращения в поддержку. Мы надеемся, что представители компании оперативно свяжутся с вами для решения вопроса.</p>\n\n    <a href="/" class="button button_success reputation-feedback-success__button">НА ГЛАВНУЮ</a>\n</section>'),St.c.getInstance().sendEvent("send_company_feedback",{partner_id:this.getClientID()}),setTimeout((()=>{window.location.href="/"}),5e3)}catch(n){i.core.logger.error("reputation","error submitting form",n),i.core.ui.toasts.showError(n.message)}}}const _a=s(19755);class ma extends m.T3{route(t,e){return this.ctx=t,this._searchMode=p.xd.VISITED,this.isRendered||this.show(),e()}render(){return this.isRendered||(i.core.ui.screen=G.dt.VISITED,this._feed=new l._D({$el:_a(".stories-feed"),feedName:"visited",focused:!0}),this._search=new c.P({feed:this._feed,searchMode:p.xd.VISITED}),super.render()),this}}const ga="company-blogs-info__companies-container",fa="company-blogs-info_expanded",va="company-blogs-info__toggle",ba="company-blogs-info__company";class ya extends j.u{constructor(t){if(!t.el)throw Error();if(super(t),this.els={toggle:t.el.querySelector("."+va),companiesContainer:document.querySelector("."+ga)},!this.els.toggle||!this.els.companiesContainer)throw Error();this.attachToggleHandler(),this.attachCompanyClickHandler()}attachToggleHandler(){const t=this.el;this.els.toggle.addEventListener("click",(()=>{if(t.classList.contains(fa))t.classList.remove(fa),this.els.companiesContainer.style.height="0";else{t.classList.add(fa);const e=this.els.companiesContainer.firstElementChild,s=window.getComputedStyle(e),i=parseInt(s.marginTop,10)+parseInt(s.marginBottom,10)+e.offsetHeight;this.els.companiesContainer.style.height=`${i}px`,_.cp.getInstance().sendEvent("click",{type:"companies"})}}))}attachCompanyClickHandler(){const t=t=>{if(!(t.target instanceof HTMLElement))return;const e=t.target.closest("."+ba);e&&_.cp.getInstance().sendEvent("transition_to_author",{type:"company",author_id:e.dataset.id})};this.els.companiesContainer.addEventListener("click",t),this.els.companiesContainer.addEventListener("auxclick",(e=>{1===e.button&&t(e)}))}}class wa extends ya{}class ka extends Yi.h{render(){if(this.isRendered)return this;const t=document.querySelector(".company-blogs-info");return t&&new wa({el:t}),super.render(),this}}s(38559);const xa=new ut.xs({DATE:"date",VIEWS:"views",UNIQUE_VIEWS:"unique_views",READS:"reads",READS_CTR:"reads_ctr",CLICKS:"clicks",CLICKS_CTR:"clicks_ctr"});var Sa=s(41574);function $a(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function Ca(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?$a(Object(s),!0).forEach((function(e){Ta(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):$a(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function Ta(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class Ea extends j.u{show(){return this.popup.show(),this}hide(){return this.popup.hide(),this}get calendar(){return this.calendarInstance||(this.calendarInstance=new Sa.E(Ca({width:Math.min(550,window.innerWidth)},this._options.calendarOptions))),this.calendarInstance}get popup(){var t;this.popupInstance||(this.popupInstance=new R._(Ca({target:this._options.target,content:this.calendar.show().$el,wrapperExtraClass:"popup_company-blog-select-date"},this._options.popupOptions)),this.popupInstance.addButtonIntoFooter(null!==(t=this._options.submitButtonTitle)&&void 0!==t?t:"Выбрать",this.onSubmitClick.bind(this),d.j.SUCCESS),this.listenTo(this.popup,rt.eM.UNMOUNTED,(()=>{this.emit("close")})));return this.popupInstance}onSubmitClick(){const t=this.calendar.selectedDates;this.emit("submit",t)}}function Ia(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const Oa="YYYY-MM-DD",Ua="company-blog-search-panel__type-group",Da="company-blog-search-panel__type",Aa="company-blog-search-panel__sort-group",Ma="company-blog-search-panel__dates-group",Na="company-blog-search-panel__dates",Pa="company-blog-search-panel__item_button",La="company-blog-search-panel__item_selected";class Ra extends j.u{constructor(t){super({}),Ia(this,"searchData",{}),this.el=t,this.els={typeGroup:t.querySelector(`.${Ua}`),type:t.querySelector(`.${Da}`),textInput:t.querySelector('.input[data-role="search"]'),sortButton:t.querySelector(`.${Aa} .link`),sortButtonCaption:t.querySelector(`.${Aa} .link > span`),datesGroup:t.querySelector(`.${Ma}`),dates:t.querySelector(`.${Na}`),dateRangeButton:t.querySelector(`.${Pa}[data-value="range"]`)}}render(){var t;if(this.isRendered||!this.el)return this;this.searchData=null!==(t=i.default.config("modules.searchData"))&&void 0!==t?t:{};const e=new at.x(this.el.querySelector("form"));return this.listenTo(e,"submit",this.search.bind(this,!0)),this.prepareTextInput(),this.prepareDatesControl(),this.prepareSortControl(),this.prepareTypeControl(),super.render(),this}prepareTextInput(){this.input=new Tt.u3({el:this.els.textInput,sanitizerRules:[da.o.trim()]}),this.listenTo(this.input,"change",(t=>{this.searchData.text=t}))}prepareSortControl(){this.sortPopup=a.g.popupEnum(this.els.sortButton,xa,"page-company-blog.sort-mode",this.searchData.order),this.els.sortButton.addEventListener("click",(()=>{this.sortPopup.toggle()})),this.listenTo(this.sortPopup,"change",((t,e)=>{e&&(this.els.sortButtonCaption.textContent=i.default.i18n("page-company-blog.sort-mode."+e.toString()),this.searchData.order=e.value,this.sortPopup.isShown&&(this.sortPopup.hide(),this.search()))}))}prepareDatesControl(){const t=this.els.dates;if(!t)return;const e=new Ea({target:this.els.dateRangeButton,submitButtonTitle:i.default.i18n("modal.apply"),popupOptions:{direction:R.Lh.BOTTOM,indent:!1},calendarOptions:{datesRangeMode:!0,showButtonsPanel:!1}});e.render(),this.listenTo(e,"submit",(t=>{this.searchData.date_from=t.startDate,this.searchData.date_to=t.endDate,this.search()})),t.querySelectorAll(`.${Pa}`).forEach((s=>{s.addEventListener("click",(()=>{const i=s.dataset.value;if(t.querySelectorAll(`.${La}`).forEach((t=>{t.classList.remove(La)})),s.classList.add(La),"range"===i){var n;e.calendar.setDate(this.searchData.date_from,null!==(n=this.searchData.date_to)&&void 0!==n?n:F()().format(Oa)),e.show()}else{let t;"week"!==i&&"month"!==i||(t=F()().subtract(1,i).format(Oa)),this.searchData.date_from=t,this.searchData.date_to=void 0,this.search()}}))}))}prepareTypeControl(){const t=this.els.type;if(!t)return;this.els.type.querySelectorAll(`.${Pa}`).forEach((e=>{e.addEventListener("click",(e=>{var s,i;const n=null===(s=e.target)||void 0===s||null===(i=s.dataset)||void 0===i?void 0:i.value;n&&((e=>{t.querySelectorAll(`.${Pa}`).forEach((t=>{const s=t;s.classList.toggle(La,s.dataset.value===e)}))})(n),this.searchData.type=n,this.search())}))}))}search(){const t=new URLSearchParams(this.filterParamsToQuery()).toString(),e=i.default.history.location.pathname+"?"+t;i.default.history.redirect(e)}filterParamsToQuery(){const t=this.searchData,e={text:t.text,order:t.order,date_from:t.date_from,date_to:t.date_to?t.date_to+" 23:59:59":""};return"adverts"===t.type?e.is_advert=1:"hot"===t.type&&(e.is_in_hot=1),Object.fromEntries(Object.entries(e).filter((([t,e])=>Boolean(e))))}}class ja extends m.T3{render(){if(this.isRendered)return this;const t=document.querySelector(".company-blog-search-panel");return t&&new Ra(t).render(),super.render(),this}}class Ba extends j.u{constructor(t){super(t),this.els={btn:document.querySelector(".company-blog-story-stats-panel__select-date")},this.params=i.default.config("modules.pageParams")}render(){return this.isRendered||this.initCalendar(),this}initCalendar(){const t=new Ea({target:this.els.btn,submitButtonTitle:"Показать статистику",popupOptions:{alignment:R.SE.START,showArrow:!1},calendarOptions:{datesRangeMode:!0,showButtonsPanel:!1}});return t.render(),this.els.btn.addEventListener("click",(()=>{t.calendar.setDate(this.params.date_from,this.params.date_to),this.els.btn.classList.add("company-blog-story-stats-panel__select-date_active"),t.show()})),this.listenTo(t,"close",(()=>{this.els.btn.classList.remove("company-blog-story-stats-panel__select-date_active")})),this.listenTo(t,"submit",(t=>{const e=new URLSearchParams({date_from:t.startDate,date_to:t.endDate}).toString(),s=i.default.history.location.pathname+"?"+e;i.default.history.redirect(s)})),this}}class qa extends m.T3{render(){return this.isRendered||((new Ba).render(),super.render()),this}}var Fa=s(36005);var Va=s(28217);function Za(t){var e="";Array.prototype.join;return e+='<div class="move-story-popup">\n\t<h4 class="move-story-popup__title">\n\t\t',e+='\n\t\tПеренос поста в Баяны\n\t</h4>\n\n\t<input class="pkb-input pkb-input_large move-story-popup__input" placeholder="Ссылка на пост-оригинал" autocomplete="off" />\n\n\t<div class="move-story-popup__actions">\n\t\t<button type="button" data-action="move" class="pkb-normal-btn move-story-popup__button">Перенести</button>\n\t\t',e+='\n\t\t\t<button type="button" data-action="close" class="pkb-normal-btn pkb-normal-btn_gray move-story-popup__button">Отмена</button>\n\t\t',e+="\n\t</div>\n</div>\n"}const Wa=s(19755);class za extends m.T3{route(t,e){return this.ctx=t,this.isShown||this.show(),e()}render(){var t;return this.isRendered||(this._initComments(),this._resolveButton=Wa(".report__button_resolve"),this._lockReportButton=Wa(".report__button_lock"),this._moveButton=Wa(".report__button_move"),this._markButton=Wa(".report__button_mark"),this._reportsCount=Wa(".report__count"),this._copyLinkButton=Wa('[data-role="link"]'),this.el=window.document.querySelector(".reports"),this.addHandlers(),this.currentId=null===(t=new URLSearchParams(window.location.search))||void 0===t?void 0:t.get("id"),this.currentId&&this._scrollToReport(),super.render()),this}_initComments(){[...Wa(".comments")].forEach((t=>{const e=new Va.C({$el:Wa(t)}),s=Array.from(e.el.querySelectorAll(".comment__user"));for(let i=0;i<s.length;i++)Array.from(s[i].querySelectorAll("a")).map((t=>{null==t||t.setAttribute("target","_blank")}));e.initComments()}))}hide(){return super.hide(),this._form.reset(),this}addHandlers(){this._resolveButton.on("click",(t=>this._handleResolve(t))),this._lockReportButton.on("click",(t=>this._handleToggleReportLock(t))),this._moveButton.on("click",(t=>this._handleMove(t))),this._markButton.on("click",(t=>this._handleMark(t))),this._reportsCount.on("click",(t=>this._toggleSummary(t))),this._copyLinkButton.on("click",(t=>this._copyLink(t)))}async _handleResolve(t){const{targetId:e,reasonId:s}=t.target.dataset,n=await this._sendResolve(e,s);n.result?this._removeReport(t.target.closest(".report")):i.core.ui.toasts.showError(n.message)}async _handleToggleReportLock(t){const{reportId:e,locked:s}=t.target.dataset,n=await this._lockReport(e,s);n.result?(t.target.innerText=s?"Берусь":"Отмена",t.target.dataset.locked=s?"":"1"):i.core.ui.toasts.showError(n.message)}async _scrollToReport(){const t=this.el.querySelector(`[data-report-id='${this.currentId}']`);t&&setTimeout((async()=>{await i.core.ui.scrollTo(t,!0)}),200)}async _handleMove(t){const{targetId:e}=t.target.dataset,s=new R.LD({isModalMenu:!0,wrapperExtraClass:"move-story-popup__wrapper",destroyAfterHide:!0,content:Za(),zIndex:6003});s.show();const n=s.el.querySelector(".move-story-popup__input");s.el.querySelector('[data-action="close"]').addEventListener("click",(()=>s.hide())),s.el.querySelector('[data-action="move"]').addEventListener("click",(async()=>{const a=n.value.trim();if(!a||!/^(https?:\/\/)?pikabu\.(ru|lh|dev)/i.test(a))return void i.core.ui.toasts.showError("Указана некорректная ссылка на пост-оригинал");const{response:o}=await A.cf.post(Ga,{action:"transfer_duplicate",story_id:e,origin_url:a});o.result?(this._removeReport(t.target.closest(".report")),s.hide()):i.core.ui.toasts.showError(o.message)}))}async _handleMark(t){const{targetId:e}=t.target.dataset,{response:s}=await A.cf.post(Ga,{action:"mark_as_duplicate",story_id:e});s.result?this._removeReport(t.target.closest(".report")):i.core.ui.toasts.showError(s.message)}_removeReport(t){t.remove(),this.el.firstElementChild||(this.el.innerHTML='<p class="no-reports">Жалоб нет</p>')}async _sendResolve(t,e){const{response:s}=await A.cf.post(Ga,{action:"resolve",target_id:t,reason_id:e});return s}async _lockReport(t,e){const{response:s}=await A.cf.post(Ga,{action:e?"unlock_report":"lock_report",report_id:t});return s}async _toggleSummary(t){if(this._isRequestSending)return;const{id:e}=t.target.dataset,s=Wa(t.target),i=s.closest(".report").find(".summary"),n=s.hasClass("header__item_active");if(s.toggleClass("header__item_active",!n),n)i.slideUp(200,(()=>i.empty()));else{this._isRequestSending=!0;try{const{data:t}=await A.cf.post(Ga,{action:"get_summary_details",summary_id:e});if(null==t||!t.html)return;i.append(t.html),i.slideDown(200)}catch(a){console.log("Error getting summary details:",a)}finally{this._isRequestSending=!1}}}_copyLink(t){t.preventDefault();const e=t.currentTarget,s=e.getAttribute("href");r.Utils.copyToClipboard(s);{let t=Wa(e).data("hint");t&&(t.content.find(".popup__hint").html("Скопирована!"),t.updatePosition(),t.destroyAfterHide=!0)}}}s(19755);class Ha extends m.GR{onMatch(t,e){super.onMatch(t,e)}constructor(t){super(t),this.use({"/reports-feed":za,"/reports-feed/time":za,"/reports-feed/checked":za,"/reports-feed/mine":za,"/reports-feed/time-asc":za,"/reports-feed/checked/time":za,"/reports-feed/checked/time-asc":za,"/reports-feed/mine/time":za,"/reports-feed/mine/time-asc":za})}render(){return this.isRendered||(i.core.ui.screen=G.dt.COMPLAINTS_LIST,super.render()),this}}const Ga="/ajax/reports_actions.php";D.S.getInstance().fillLocal(za,{pageComplaintsTemplate:function(t){var e="",i=Fa.escape;Array.prototype.join;const n=s(12953).core;return e+='\n<div class="complaints-list">\n    <form class="section-group complaints-list__form" method="POST" action="javascript:void 0;" novalidate>\n        <section class="input input_box input_section" data-role="search">\n            <span class="input__icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__search icon--ui__search_input"><use xlink:href="#icon--ui__search"></use></svg></span>\n            <span class="input__box">\n\t\t\t\t<input class="input__input" placeholder="'+i(n.i18n("page-ignore-list.placeholders.posts"))+'" autocomplete="off" name="search" value="">\n\t\t\t</span>\n            <button class="button button_success">Поиск</button>\n        </section>\n        <section class="section_gray complaints-list__categories">\n            ',[{route:"",name:"all"},{route:"/tags",name:"tags"},{route:"/users",name:"users"},{route:"/communities",name:"communities"},{route:"/keywords",name:"keywords"}].forEach((function(t){e+='\n                <a href="/ignore-list'+i(t.route)+'" data-category="'+i(t.name)+'" class="button button_small menu__item_route">\n                    '+i(n.i18n("page-ignore-list.categories."+t.name))+"\n                </a>\n            "})),e+='\n        </section>\n    </form>\n\n    <div class="ignore-stories__container"></div>\n</div>'}});var Ya=s(9980);function Ka(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class Qa extends j.u{constructor(...t){super(...t),Ka(this,"isCaptchaConfirmed",!1),Ka(this,"onCaptchaConfirm",(t=>{this.isCaptchaConfirmed=Boolean(t),this.updateSubmitButtonState()})),Ka(this,"updateSubmitButtonState",(()=>{const t=this.els.form.checkValidity()&&this.isCaptchaConfirmed;this.els.button.disabled=!t}))}render(){return this.isRendered||(this.el=document.querySelector(".law-violation-report"),this.els={form:this.el.querySelector("form"),button:this.el.querySelector("button")},this.initCaptcha(),this.initForm(),this.showError()),this}async initCaptcha(){var t;await Ya.k.initScript(),grecaptcha.render(null===(t=this.el)||void 0===t?void 0:t.querySelector(".g-recaptcha"),{sitekey:i.core.config("grecaptchaKey"),callback:this.onCaptchaConfirm,size:"normal"})}initForm(){const t=new(D.S.getInstance().get("UIForm"))(this.els.form),e=Array.from(this.els.form.elements);e.filter((t=>{const e=t.tagName.toLowerCase();return"input"===e||"textarea"===e})).forEach((t=>{t.addEventListener("paste",(t=>{t.preventDefault()}))})),e.forEach((t=>{const e=t.tagName.toLowerCase(),s="input"===e||"textarea"===e?"input":"change";t.addEventListener(s,this.updateSubmitButtonState)})),this.listenTo(t,"change",((t,e)=>{var s,i;"checkbox"===(null===(s=e.$els)||void 0===s||null===(i=s.input)||void 0===i?void 0:i.get(0).type)&&this.updateSubmitButtonState()}))}showError(){const t=i.core.config("modules.law-violation-report-form.error");t&&i.core.ui.toasts.showError(t)}}class Xa extends m.T3{render(){return this.isRendered||(new Qa).render(),this}}var Ja=s(14025);class to extends m.T3{render(){if(this.el=document.querySelector(".page-achievements"),i.core.isUserAuthorized){const t=this.el.querySelectorAll("a");Ja.DT.initSitesEventLinks(t)}i.core.ui.screen=G.dt.GAMIFICATION,this.scrollToHash(),window.addEventListener("hashchange",this.scrollToHash.bind(this)),super.render()}scrollToHash(){location.hash&&setTimeout((()=>{var t;const e=this.el.querySelector(`.achievement_${location.hash.substring(1)}`);null===(t=document.querySelector(".header"))||void 0===t||t.getBoundingClientRect();e&&(i.core.ui.scrollTo(e.offsetTop-0-5,!0),this.el.querySelectorAll(".achievement_bordered").forEach((t=>{t.classList.remove("achievement_bordered")})),e.classList.add("achievement_bordered"))}))}}class eo extends m.T3{async render(){const{createApp:t}=await s(59018);t().mount("#monetization")}}class so extends m.T3{route(t,e){return this.ctx=t,this.isRendered?(this._feed.requestUrl=t.path,this._feed.clear(),this._feed.loadStories(!1)):this.show(),e()}render(){return this.isRendered||(this.$el=y()("body"),super.render()),this}show(){return super.show(),this}initQueueBox({container:t,StoriesFeed:e,SimilarStories:s}){const i=t.find(".community-stories-queue__button");new e({$el:t,feedName:"community-queue"}),i.on("click",(()=>{i.slideUp(200,(()=>i.remove())),t.find(".stories-feed__container").fadeIn(500)}));const n=t=>{var e;return null!==(e=y()(t).closest(".community-queue-panel").attr("data-queue-id"))&&void 0!==e?e:""},a=t=>Number(y()(t).data("com-id"))||0;y()('.community-queue-panel__buttons button[data-role="allow"]').click((({target:t,currentTarget:e})=>{this.approveStory(n(t),a(e),g.dO.APPROVED,e)})),y()('.community-queue-panel__buttons button[data-role="deny"]').click((({target:t,currentTarget:e})=>{this.approveStory(n(t),a(e),g.dO.REJECTED,e)})),y()('.community-queue-panel__buttons button[data-role="cancel-community-change"]').click((({target:t,currentTarget:e})=>{this.approveStory(n(t),a(e),g.dO.MOVED_TO_COMMON_FEED,e)})),y()(".community-queue-panel__buttons .community-queue-panel__cmp").click((({target:t,currentTarget:e})=>{this.showCompareResults(n(t),a(e),s)}))}async showCompareResults(t,e,s){const n=y()(`.community-queue-panel[data-queue-id="${t}"] .community-queue-panel__similar-stories`);let a=this.marks.get(t);if(a)n.slideToggle();else{a=new s({$parent:n,type:v.VQ.MANUAL,queueId:t}),this.marks.set(t,a),a.show(),a.state=v.DX.WAIT;try{const s=new g.S1(e),i=await s.getComporatorResultForQueue(t);P.default.isObject(i)&&Object.keys(i).length?a.addSources(i):a.state=v.DX.EMPTY}catch(o){i.core.ui.toasts.showError(o)}n.slideDown()}}async approveStory(t,e,s,n){const a=y()(`.community-queue-panel[data-queue-id="${t}"]`),o=a.find("button");if(a.attr("disabled","disabled"),o.attr("disabled","disabled"),n.classList.add("button_spinning"),s===g.dO.APPROVED){const t=k.m.get(f.ob)||0;Date.now()-t<f.Qu&&_.cp.getInstance().yandex.goal("community_fast-approve"),k.m.set(f.ob,Date.now())}try{const n=new g.S1(e),r=await n.processStoryInQueue(t,s);this.toastApprove&&r.length&&(this.toastApprove.hide(),this.timeout("reopen",200,(()=>{this.toastApprove.content=r,this.toastApprove.show()}))),a.removeAttr("disabled"),o.removeAttr("disabled");const l=a.find(".community-queue-panel__message"),c=a.closest(".story"),d=l.find("a");let u,p=4;l.find("span").text(i.core.i18n("page-community."+(s===g.dO.APPROVED?"approved":"disapproved")));const h=()=>{u&&clearTimeout(u),c.slideUp(400,(()=>c.remove()))},_=()=>{p--,p>=0&&(d.text(`закрыть (${p} сек)`),p>0?u=setTimeout(_,1e3):h())};d.click(h),_(),l.slideDown(400);const m=y()('.bell[data-role="community"]');let f=Number(m.text()||"0");--f>0?m.text(String(f)):m.hide()}catch(r){r.message.length&&i.core.ui.toasts.showError(r)}finally{a.removeAttr("disabled"),o.removeAttr("disabled"),n.classList.remove("button_spinning")}}}const io=s(19755);var no=s(39660);class ao extends m.T3{route(t,e){return this.isShown||this.show(),i.core.ui.screen=G.dt.TOP_AUTHORS,e()}render(){return this.isRendered||(this._publicRatings=new no.V({el:document.querySelector(".public-ratings")})),this}}class oo extends m.T3{async render(){i.core.ui.screen=G.dt.STORY_DRAFTS;const{createApp:t}=await s(55660);t().mount("#story-drafts")}}s(84944),s(33792);function ro(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class lo extends m.T3{constructor(...t){super(...t),ro(this,"unreadClass",".comments__container_highlight_yellow"),ro(this,"blocks",new Map),ro(this,"blocksObserver",new IntersectionObserver(this.blocksObserverCallback.bind(this),{rootMargin:"300px 0px"}))}isMarkAsReadObserverStrategy(){return o.SUPPORT_TECH_USER_ID!==i.core.initParams.userID}initMarkAsReadStrategy(){this.isMarkAsReadObserverStrategy()?this.initMarkAsReadObserver():this.initMarkAsReadOnClick()}getLastBlock(t){return t.children().last()[0]}observeBlock(t,e){t&&(this.blocks.set(t,e),this.blocksObserver.observe(t))}unobserveBlock(t){t&&(this.blocksObserver.unobserve(t),this.blocks.delete(t))}initMarkAsReadOnClick(){this.$el&&this.$el.on("click",".comments__container_highlight_yellow",(async t=>{const e=t.currentTarget.parentElement;if(!e)return;const s=e.dataset.commentId?Number(e.dataset.commentId):void 0;if(!s)return;await Ti.z.markAsRead([s])&&(t.currentTarget.classList.remove(this.unreadClass.slice(1)),this.updateUnreadCounter([s]))}))}updateUnreadCounter(t){const e=y()('.bell[data-role="answers"]');let s=parseInt(e.text(),10);if(e.length&&99!==s){s-=t.length,e.text(s).toggle(s>0),this.$els&&s<=0&&this.$els.markAll.remove();const i=y()(".avatar__notifications");i.length&&s<=0&&i.remove()}}getAnswerIds(t){return t.map((t=>{var e,s;return parseInt(null!==(e=null===(s=t.el)||void 0===s?void 0:s.dataset.commentId)&&void 0!==e?e:"0")})).filter((t=>t>0))}prepareIds(t,e=[]){const s=[...t,...e],i=Math.min(...s);return{excludeIds:s.map((t=>t-i)),baseId:i}}blocksObserverCallback(t){for(const{target:e,isIntersecting:s}of t){const t=e,i=this.blocks.get(t);i&&(s?(i.forEach((t=>t.show())),t.style.removeProperty("height"),this.togglePlayers(t,s)):(t.style.height=`${t.offsetHeight}px`,this.togglePlayers(t,s),i.forEach((t=>t.hide()))))}}togglePlayers(t,e){y()(t).find('.player[data-type="gifx"]').each(((t,s)=>{const i=y()(s).data("player");i&&i.togglePlay(!!e&&i.playAfterInitialization)}))}}const co=[...Array(10).keys()].map((t=>(t+1)/10));var uo=s(35924),po=s(51540);const ho=s(19755);class _o extends m.T3{route(t,e){return this.isRendered||this.show(),i.core.ui.screen=G.dt.BROWSING,e()}render(){return this.isRendered||this.initBrowsingPage(),this}show(){return super.show(),this}async initBrowsingPage(){const{createApp:t}=await s(2122);await t().mount("#browsing")}}class mo extends m.T3{async render(){const{createApp:t}=await s(39681);t().mount("#pikabu-plus-form")}}class go extends m.T3{async render(){const{createApp:t}=await s(81980);t().mount("#user-ads")}}class fo extends m.T3{async render(){const{createAppRules:t}=await s(81980);t().mount("#user-ads-rules")}}function vo(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function bo(t,e,s){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const yo=(t,e)=>{parent.postMessage(function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?vo(Object(s),!0).forEach((function(e){bo(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):vo(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({event:t},e),"*")},wo=()=>yo("pkb:auth-close"),ko=t=>{yo("pkb:auth-success",t)};class xo extends m.T3{render(){new URLSearchParams(window.location.search).has("embedded")&&this.initIframeAuth()}initIframeAuth(){if(yo("pkb:auth-init"),this.handleOauthInNewTab(),i.core.isUserAuthorized)return void ko({type:"signin"});i.core.ui.authModal.modal.on("uiUnmounted",wo),i.core.ui.listenTo(i.core.ui.authModal.form,"authSuccess",(t=>ko({type:t})));const t=new URLSearchParams(window.location.search);i.core.ui.authRequired({formType:t.get("type")})}handleOauthInNewTab(){const t="pkb:oauth";if(i.core.isUserAuthorized){const s=i.core.initParams.oauth_result;if(s){var e;const{type:i,source:n}=s;null===(e=window.opener)||void 0===e||e.postMessage({event:t,type:i,oauthSource:n}),window.close()}}else window.addEventListener("message",(e=>{var s;if((null===(s=e.data)||void 0===s?void 0:s.event)===t){const{type:t,oauthSource:s}=e.data;ko({type:t,oauthSource:s})}}))}}class So extends m.T3{async render(){const{createApp:t}=await s(48748);t().mount("#pikabu15")}}i.core.use({"communities-stories":class extends ks{render(){return this.isRendered||(i.core.ui.screen=G.dt.COMMUNITIES_FEED,super.render(),this.$el=Ss(".communities-stories-feed"),this.$els={rating:this.$(".communities-stories-feed__rating").on("click",this._showRatingBox.bind(this))},this._loadListDebounced=(0,P.debounce)(this._loadList,500),this._feed=new l._D({$el:Ss(".stories-feed"),feedName:"communities",focused:!0}),new l.RP({$el:Ss(".communities-stories .feed-panel"),feed:this._feed,isDisableCalendar:!0})),this}_showRatingBox(){let t=this.marks.get("rating-box");if(!t){let e=Number(this.$els.rating.data("value")||0),s=new xs.T({options:$s,value:e});t=new R._({target:this.$els.rating,indent:!0,content:s.render().el}),this.marks.set("rating-box",t),s.$el.css("width",200),this.listenTo(s,"change",(t=>{this._ratingLimit=t,this.$els.rating.text(i.core.i18n("page-communities.rating",t)),this._loadListDebounced()}))}t.toggle()}_loadList(){let t=this._feed;this._ratingLimit&&t.searchParams.set("mr",this._ratingLimit),t.clear().loadStories(!1)}},"/communities/:type(mine)?/:sort(actual|time|subs)?":Is,"/communities/:type(tag)/:tag/:sort(actual|time|subs)?":Is,community:ms,"/community/:name/search":ms,"/communities-mod":class extends so{render(){return this.isRendered||(i.core.ui.screen=G.dt.COMMUNITIES_MOD,this.$els={feedPanel:io(".feed-panel"),queue:io(".community-stories-queue")},super.render(),this.$els.queue.length>0&&this.initQueueBox(),this._feed=new l._D({$el:io(".stories-feed"),feedName:"community",focused:!0}),this._initFeedFilterPanel(),this.toastApprove=new Q.O({closeAfter:1e4,destroyAfterHide:!1,addCloseButton:!0})),this}_initFeedFilterPanel(){new l.pd({$el:this.$els.feedPanel,feed:this._feed,feedName:"community",isDisableCalendar:!0,isSubsMode:!1,inlineFiltersMode:!0})}initQueueBox(){super.initQueueBox({container:this.$els.queue,StoriesFeed:l._D,SimilarStories:K.Bi})}}}),i.core.use({"most-saved-stories":qs,"disputed-stories":Vs,"/saved-stories/:cid?":Js,"shared-saved-stories":Js,"/liked/:not?":Ws,"news-preview":cn,"/visited-stories":ma,"/companies/:date([0-9--]{10})?":ka,"/series/:series([a-z0-9._-]*_\\d+)/:date([0-9--]{10})?":Ki}),i.core.use("story-preview",Li),i.core.use("incoming-comments",class extends lo{render(){if(this.isRendered)return this;this.$el=ho(".page-answers"),this.$els={author:this.$('input[name="auth"]'),form:this.$("form"),loading:this.$(".page-answers__loading").hide(),filters:this.$(".page-answers__filters").show(),markAll:this.$('span[data-role="mark-all-as-read"]'),commentsContainer:this.$(".comments-part"),spinner:this.$(".stories-feed__spinner")},this._form=new at.x(this.$els.form),this._searchInput=new Tt.u3(this.$('.input[data-role="search"]')),this.initBtnMarkAll(),this._author=new Ts._d({$el:this.$(".form-group__body")});const t=i.core.config("modules.author");t&&(this._author.addItem({name:t.name,avatar:t.avatar}),rt.u1.getUIElement(this.$(".form-group")).open()),this.listenTo(this._author,"change",(t=>{this.$els.author.val(t.length>0?t[0].name:""),this._form.submit()})),this._shareFeature=new Ci.B,this._commentsParts=new Ti.z({$el:this.$(".comments-part"),mode:Ei.lL.INCOMING}).show();const e=this._commentsParts.addComments();return this.observeBlock(this.getLastBlock(this.$els.commentsContainer),e),i.core.ui.screen=G.dt.USER_ANSWERS,this.initMarkAsReadStrategy(),this.initLoadOnScroll(),super.render(),this}initBtnMarkAll(){this.$els.markAll.on("click",(async()=>{await Ti.z.markAllAsRead()&&window.location.reload()}))}initLoadOnScroll(){if(!this.$els.spinner.length)return;this.loadOnScrollOptions={onDocumentEndThrottle:(0,po.P)((()=>this.loadAnswers()),100),spinner:i.core.ui.player.createAnimation("stories-spinner",{$parent:this.$els.spinner}),isLoadingAnswers:!1,nextPage:2,filteredIds:[],attempts:5},this.loadOnScrollOptions.hasMoreAnswers=Boolean(this.$els.commentsContainer.data("has-more"));this.listenTo(i.core.ui,"document-scroll",(()=>{const{hasMoreAnswers:t,isLoadingAnswers:e,nextPage:s}=this.loadOnScrollOptions;t&&!e&&s<=101&&i.core.ui.elementWillSoonScrolled(this.el,500)&&this.loadOnScrollOptions.onDocumentEndThrottle()}))}async loadAnswers(){if(this.loadOnScrollOptions.isLoadingAnswers)return;this.loadOnScrollOptions.isLoadingAnswers=!0,this.loadOnScrollOptions.spinner.play();const t=Array.from(this.blocks.values()).flat(),{excludeIds:e,baseId:s}=this.prepareIds(this.getAnswerIds(t),this.loadOnScrollOptions.filteredIds),i=new uo._(location.search);i.set("exclude_ids",e),i.set("base_id",s),this.loadOnScrollOptions.nextPage++;const{response:n,data:a}=await A.cf.post(location.pathname,i);if(!n.result)return this.loadOnScrollOptions.spinner.stop(),void(this.loadOnScrollOptions.isLoadingAnswers=!1);const{has_more:o,comments:r,filtered_ids:l}=a;if(this.loadOnScrollOptions.hasMoreAnswers=o,null!=l&&l.length&&(this.loadOnScrollOptions.filteredIds=[...this.loadOnScrollOptions.filteredIds,...l]),this.loadOnScrollOptions.attempts&&o&&!r.length&&null!=l&&l.length)return this.loadOnScrollOptions.attempts--,this.loadOnScrollOptions.spinner.stop(),this.loadOnScrollOptions.isLoadingAnswers=!1,void this.loadAnswers();if(this.loadOnScrollOptions.attempts=5,!r.length)return this.loadOnScrollOptions.hasMoreAnswers=!1,this.loadOnScrollOptions.spinner.stop(),void(this.loadOnScrollOptions.isLoadingAnswers=!1);const c=L.Zv.fragment(`\n\t\t\t<div class="comments-part__group">\n\t\t\t\t${r.map((({html:t})=>t)).join("")}\n\t\t\t</div>\n\t\t`),d=[...ho(c).find(".comments")];this.$els.commentsContainer.append(c);const u=this._commentsParts.addComments();d.forEach((t=>{if(this.isMarkAsReadObserverStrategy()){const e=ho(t).find(this.unreadClass);this.addToMarkAsReadObserver([...e])}})),this.observeBlock(this.getLastBlock(this.$els.commentsContainer),u),this._shareFeature.updateShareButtons(),this.loadOnScrollOptions.spinner.stop(),this.loadOnScrollOptions.isLoadingAnswers=!1}initMarkAsReadObserver(){if(!this.$els.markAll.length)return;this.answersToMark=[];const t=(0,Y.D)(this.markAsRead.bind(this),500),e=new WeakMap;this.markAsReadObserver=new IntersectionObserver((s=>{s.forEach((({target:s,intersectionRatio:i,rootBounds:n,boundingClientRect:a,intersectionRect:o})=>{const r=n.height<=a.height,l=1===i,c=o.height>=n.height/2,d=e.has(s);if(!(r?c:l)||d)d&&(clearTimeout(e.get(s)),e.delete(s));else{const i=setTimeout((()=>{this.markAsReadObserver.unobserve(s);const e=ho(s),i=e.data("comment-id");i&&(this.answersToMark.push({id:i,$answer:e}),t())}),2e3);e.set(s,i)}}))}),{threshold:co});const s=this.$els.commentsContainer.find(this.unreadClass);this.addToMarkAsReadObserver([...s])}addToMarkAsReadObserver(t){this.markAsReadObserver&&t.length&&t.forEach((t=>this.markAsReadObserver.observe(t.parentNode)))}async markAsRead(){if(!this.answersToMark.length)return;const{ids:t,$answers:e}=this.answersToMark.reduce(((t,{id:e,$answer:s})=>(t.ids.push(e),t.$answers.push(s),t)),{ids:[],$answers:[]});this.answersToMark=[];await Ti.z.markAsRead(t)&&(e.forEach((t=>{t.find(this.unreadClass).removeClass(this.unreadClass.slice(1))})),this.updateUnreadCounter(t))}}),i.core.use("outcoming-comments",Ii),i.core.use("saved-comments",Ui),i.core.use("top50-comments",Ni),i.core.use("survey",Gi),i.core.use({"/promo-test/:id([A-Za-z0-9+/]{9,16})":rn,"/promo_test.php":rn}),i.core.use("/edits/:story(\\d+)/:mode(waiting|approved|rejected|canceled|history)?",yn),i.core.use("/edits/:story(\\d+)/:type(tags|title)/:mode(waiting|approved|rejected|canceled|history)?",In),i.core.use("/edits/:story(\\d+)/:type(text|image|video)/:id(\\d+)/:mode(waiting|approved|rejected|canceled|history)?",In),i.core.use("/edits/:story(\\d+)/:id(\\d+)",Un),i.core.use("/edits/:mode(waiting|approved|rejected|canceled|mine)?",Rn),i.core.use("/edits/@:user",Rn),i.core.use({"user-notifications":as}),i.core.use({"community-banlist":class extends hs{render(){return this.isRendered||(super.render(),gs('.page-community-banlist__record .page-community-banlist__record__button[data-role="show-history"]').each((function(){let t=gs(this),e=t.closest(".page-community-banlist__record").attr("data-id");gs(`.page-community-banlist__record[data-parent-id="${e}"]`).length>0&&t.show()})).off("click").on("click",(t=>{let e=gs(t.target).closest(".page-community-banlist__record__button"),s=e.closest(".page-community-banlist__record").attr("data-id");e.toggleClass("page-community-banlist__record__button_open"),gs(`.page-community-banlist__record[data-parent-id="${s}"]`).toggle()}))),this}},"community-voting":class extends hs{render(){return this.isRendered||(super.render(),this.$el=ws(".community-voting"),this.$els={selectUser:this.$('.community-voting__select input[type="checkbox"]'),searchUser:this.$(".community-editor__add"),selfRemove:this.$(".community-voting__self-remove"),candidate:this.$(".community-voting__candidate")},this._communityID=this.$el.data("id"),this.$els.selectUser.each(((t,e)=>{let s=new vs.m({$el:ws(e)});this.listenTo(s,"change",(()=>{s.checked||this._createModal(s.$els.input.val(),s.$els.input.data("img"))})),this.on("modalCancel",(()=>{s.checked=!1}))})),this.$els.selfRemove.click((()=>{this.community.cancelVotingCandidate().then((()=>{this.$els.candidate.slideUp(400,(()=>{window.location.reload()}))}),(t=>{i.default.ui.toasts.showError(t||i.default.i18n("moderator-tools.errors.request"))}))})),this.$els.searchUser.length&&(this._searchUser=new Tt.u3({$el:this.$els.searchUser,suggestion:new fs.xI}),this.listenTo(this._searchUser.suggestion,fs.nT.SELECT,(t=>{this._createModal(t._data.name,t._data.avatar)})),this.listenTo(this._searchUser,"blur",(()=>this._searchUser.value="")))),this}async _createModal(t,e){if(!t)return void i.default.ui.toasts.showError(i.default.i18n("moderator-tools.errors.request"));let s={name:t,avatar:e};await a.g.confirmModal({content:ys(s),minWidth:500,buttons:[["Да, хочу!",d.j.SUCCESS,!0],["Нет, я промазал"]]})?this.community.voteForNewAdmin(t,!0).then((()=>{window.location.reload()}),(t=>{i.default.ui.toasts.add({theme:Q.K.WARNING,content:t||i.default.i18n("moderator-tools.errors.request")})})):this.emit("modalCancel")}}}),i.core.use({"/@:username":J,"/@:username/:mode(search|rating|mine|time)":J,"/@:username/:mode(search|rating|mine|time)/asc":J,"/@:username/anonymous":J}),i.core.use(new Ue),i.core.use({"/subs-list":Bt,"/subs-list/:typeName":Bt,"/notes":class extends Ee{render(){return this.isRendered||(this.$el=Ie(".settings-notes"),this.$els={list:this.$(".settings-notes__list")},this.$els.list.on("click",".settings-note__remove",this._onRemoveClick.bind(this)),i.default.ui.screen=G.dt.USER_NOTES,this._initAnalytics(),super.render()),this}_onRemoveClick(t){t.preventDefault();let e=Ie(t.currentTarget).closest(".settings-note");this._removeNoteConfirmation(e,Number(e.data("id")))}_removeNoteConfirmation(t,e){let s=t.find(".user").prop("outerHTML"),n=new R.LD({header:i.default.i18n("page-settings.remove-note.header"),indent:!0,content:Ie(document.createElement("span")).html(i.default.i18n("page-settings.remove-note.message",s))});n.addButtonIntoFooter("page-settings.remove-note.success",(async()=>{try{await new o.User(e).note()}catch(s){i.default.ui.toasts.showError(s)}t.remove(),this.$els.list.find(".settings-note").length||this.$el.attr("data-empty",!0),n.hide()}),d.j.DANGER),n.addCloseButtonIntoFooter("page-settings.confirmations.no"),n.show()}}}),i.core.use(new ns),i.core.use(new class extends la{render(){return this.isRendered||(super.render(),this._initMenu()),this}_initMenu(){try{new ca}catch(t){}}}),i.core.use("/@:username/feedback",ha),i.core.use("/subscribe-email-success",Ai),i.core.use("banned-users",Ns),i.core.use("approved-users",js),i.core.use("tags-list",ei),i.core.use("tags-merge",$i),i.core.use("user-awards-feed",qi),i.core.use("restore-password",Wi),i.core.use("/my-blog",ja),i.core.use("/my-blog/story/:id(\\d+)",qa),i.core.use(new Ha),i.core.use("/violation-report",Xa),i.core.use("/achievements",to),i.core.use("/donations",eo),i.core.use("/top/authors",ao),i.core.use("/drafts",oo),i.core.use("/browse",_o),i.core.use("/information/pikabu-plus",mo),i.core.use("/information/user-ads",go),i.core.use("/information/user_ad_rules",fo),i.core.use("/birthday2024",So),i.core.use("/auth",xo)},16093:(t,e,s)=>{"use strict";s.d(e,{P:()=>A});s(88674),s(2707),s(66992),s(33948),s(74916),s(15306),s(41817);var i=s(12953),n=s(63907),a=s(44361),o=s(85823),r=s(81772),l=s(41574),c=s(88358),d=s(48218),u=s(3668),p=s(36005),h=s(68016),_=s(72346),m=s(17311),g=s(36005);var f=s(36005);var v=s(36005);var b=s(36005);var y=s(36005);var w=s(92934),k=s(42107),x=s(93172);function S(t){const e=t.split("-"),s=new Date(2008,0,1,0,0,0,0).getTime();let i=new Date(parseInt(e[0]),parseInt(e[1])-1,parseInt(e[2]),0,0,0,0).getTime()-s;return i<0&&(i=0),Math.round(i/864e5)}var $=s(61950),C=s(19359),T=s(73736),E=(s(96637),s(43241));class I extends E.u{constructor(t){super(t),this.init()}async init(){if(!this.el)return;const{createApp:t}=await s(39364);this.vueApp=await t({onChange:t=>this.emit("change",t)}).mount(this.el)}}function O(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function U(t,e,s){return e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var i=s.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e),e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const D=s(19755);class A extends m.P{constructor(t){super(t),this.show()}render(){return this.isRendered||(this.feed.loadAnimationName="stories-search",this.$el||(this.$el=D(".stories-search")),this.$els={rating:this.$(".stories-search-rating"),ratingCaption:this.$(".stories-search-rating__caption"),ratingSlider:this.$(".stories-search-rating__slider"),type:this.$(".stories-search__types"),typeGroup:this.$(".stories-search__types-group"),dates:this.$(".stories-search__dates"),datesGroup:this.$(".stories-search__dates-group"),dateRangeButton:this.$('.stories-search-item_button[data-value="range"]'),visited:this.$(".stories-search__visited"),visitedGroup:this.$(".stories-search__visited-group"),textInput:this.$('.input[data-role="search"]'),tags:this.$(".stories-search__tags-group .stories-search__tags"),excludeTags:this.$(".stories-search__tags-group .stories-search__exclude-tags"),tagsGroup:this.$(".stories-search__tags-group"),tagsTitleBlock:this.$(".stories-search__tags-title"),user:this.$(".stories-search__user"),userGroup:this.$(".stories-search__user-group"),userAddInput:this.$(".stories-search__user-group .input"),community:this.$(".stories-search__community"),communityGroup:this.$(".stories-search__community-group"),communityAddInput:this.$(".stories-search__community-group .input"),resultBlock:this.$(".stories-search-results"),loader:this.$(".stories-search__loader"),panel:this.$(".stories-search__feed-panel"),sortButton:this.$(".stories-search__feed-panel > a"),sortButtonCaption:this.$(".stories-search__feed-panel > a > span")},this._searchData={linkedTags:i.default.config("modules.search.found.linkedTags")||[],tags:i.default.config("modules.searchTags")||[],excludeTags:i.default.config("modules.searchExcludeTags")||[],type:i.default.config("modules.searchType")||0,dateFrom:i.default.config("modules.searchDateFrom")||"",dateTo:i.default.config("modules.searchDateTo")||"",sort:m.vf[i.default.config("modules.searchSort")]||m.vf.FRESH,rating:i.default.config("modules.searchRating")||0,visited:i.default.config("modules.searchVisited")||!1,user:i.default.config("modules.searchUser")||{avatar:"",name:""},community:i.default.config("modules.searchCommunity")||{avatar:"",name:"",link:""},shouldHideForm:i.default.config("modules.shouldHideForm")||!1},this._prevRequest="",this._calendar=null,this._calendarPopup=null,this._sortPopup=null,this._searchAnalytics=x.v.retrieveSearchSession(),this.listenTo(this.feed,"loaded",this._processFeedLoad.bind(this)),this._searchData.shouldHideForm||this.isTagsPage||(this._form=new o.x(this.$("form")),this.listenTo(this._form,"submit",this._search.bind(this,!0)),this._input=new u.u3({$el:this.$els.textInput,sanitizerRules:[_.o.trim()]})),this._searchData.shouldHideForm||this.isTagsPage||(this._createCalendar(),this._prepareTagsControl(),this._prepareTypesControl(),this._prepareDatesControl(),this._prepareRatingControl(),this._prepareUserControl(),this._prepareCommunityControl()),this._prepareSortControl(),this._searchData.shouldHideForm||this.isTagsPage||this._updateDateCaption(),this._setFeedSearchParams(),this._searchData.shouldHideForm||(this._updateFoundTagsBlock(),this._updateTitleTagsBlock(),this._updateFoundUsersBlock(),this._updateFoundCommunitiesBlock(),this._prepareLinkedBlock()),this._initFilter(),(i.default.isUserAuthorized||i.default.initParams.isDeleted&&!this.isTagsPage)&&this._prepareVisitedControl(),this._setAnalyticsTagParameter(this._searchData.tags),super.render()),this}async _initFilter(){this.isTagsPage&&(this._storiesSearchFilter=new I({el:this.$el.find(".stories-search__filter")[0]}),this.listenTo(this._storiesSearchFilter,"change",(t=>{this._searchData.dateFrom=t.dateFrom,this._searchData.dateTo=t.dateTo,this._searchData.rating=t.rating,this._searchData.type=t.type,this._searchData.tags=t.tags,this._searchData.excludeTags=t.excludeTags,this._searchData.visited=t.visited?"h":"",this._searchData.user=t.user,this._searchData.community=t.community,this._setAnalyticsTagParameter(this._searchData.tags),this._updateTitleTagsBlock(),this._search()})))}_prepareSortControl(){this._sortPopup=d.g.popupEnum(this.$els.sortButton,m.vf,"stories-search.sort-mode",this._searchData.sort),this.$els.sortButton.on("click",(()=>{this._sortPopup.toggle()})),this.setSortingByAnlParam(m.t0[this._searchData.sort.valueOf()]),this.listenTo(this._sortPopup,"change",((t,e)=>{if(e){if(this.isTagsPage){const t=m.t0[e.valueOf()];k.cp.getInstance().sendEvent("filter",{type:t,sorting_by:m.t0[this._searchData.sort.valueOf()]}),this.setSortingByAnlParam(t)}this.$els.sortButtonCaption.text(i.default.i18n("stories-search.sort-mode."+e.toString())),this._searchData.sort=e,this._sortPopup.isShown&&(this._sortPopup.hide(),this._search())}}));const t=(0,w.D)((t=>{const e=this._sortPopup.marks.get("form");if(!e)return;const s=t?m.vf.RELEVANCE:m.vf.FRESH,i=e.getUIElement(null,s.toString());i&&i.toggleChecked(!0)}),300);this._input&&(this.listenTo(this._input,"input",t),this.listenTo(this._input,"change",t))}_createCalendar(){let t=this._calendar=new l.E;t.width=Math.min(550,window.innerWidth),t.datesRangeMode=!0,t.showButtonsPanel=!1,t.setDate(this._searchData.dateFrom,this._searchData.dateTo),t.on("select",(e=>{t.isFullRangeSelected?(this._searchData.dateFrom="",this._searchData.dateTo=""):(this._searchData.dateFrom=e.startDate,e.endDate&&e.endDate!==e.startDate?this._searchData.dateTo=e.endDate:this._searchData.dateTo=""),this._updateDateCaption(),this._search()}))}_prepareDatesControl(){let t=this.$els.dates;this.$els.dates.find(".stories-search-item_button").click((e=>{let s=D(e.target).closest(".stories-search-item_button"),i=s.attr("data-value");if(t.find(".stories-search-item_button").removeClass("stories-search-item_selected"),s.addClass("stories-search-item_selected"),"range"===i){let t,e=this._calendar;this._calendarPopup?t=this._calendarPopup:(t=this._calendarPopup=new c._(s),t.direction=c.Lh.BOTTOM,t.indent=!1,e.show(),t.content=e.$el),t.show()}else this._calendar.setRangeByType(i),this._updateDateCaption(),this._search()})),""===this._searchData.dateFrom?t.find('.stories-search-item_button[data-value="all_time"]').addClass("stories-search-item_selected"):(t.find('.stories-search-item_button[data-value="range"]').addClass("stories-search-item_selected"),n.u1.getUIElement(this.$els.datesGroup).open())}_updateDateCaption(){this._calendar.isFullRangeSelected?this.$els.dateRangeButton.text(i.default.i18n("page-search.captions.interval")):this.$els.dateRangeButton.text(this._calendar.selectedDatesCaption)}_prepareVisitedControl(){let t=this.$els.visited;if(!t.length)return;let e=t.find('.stories-search-item_button[data-value="s"]'),s=t.find('.stories-search-item_button[data-value="h"]'),a="h"!==this._searchData.visited;e.toggleClass("stories-search-item_selected",a),s.toggleClass("stories-search-item_selected",!a),a||n.u1.getUIElement(this.$els.visitedGroup).open(),this.$els.visited.find(".stories-search-item_button").click((t=>{if(i.default.initParams.isDeleted)return void i.default.ui.authRequired();let n=D(t.target).closest(".stories-search-item_button").data("value");a="h"!==n,e.toggleClass("stories-search-item_selected",a),s.toggleClass("stories-search-item_selected",!a),this._searchData.visited=a?"":"h",this._search()}))}_prepareTypesControl(){this.$els.type.find(".stories-search-item_button").click((t=>{const e=D(t.target).closest(".stories-search-item_button"),s=Number(e.attr("data-value")),i=e.hasClass("stories-search-item_selected");if(s===m.hR.ANY)i||(this._searchData.type=s,this._searchData.tags=this._searchData.tags.filter((t=>!m.ch[t]||(this._tagsList.removeItem(t,!0),!1))));else if(i?this._searchData.type&=~s:this._searchData.type|=s,i&&Object.values(m.ch).includes(s)){var n;const t=null===(n=Object.entries(m.ch).find((([,t])=>t===s)))||void 0===n?void 0:n[0];t&&(this._tagsList.removeItem(t,!0),this._searchData.tags=this._searchData.tags.filter((e=>e!==t)))}this._updateTypeButtonsState(),this._updateTitleTagsBlock(),this._search()})),this._updateTypeButtonsState(),this._searchData.type!==m.hR.ANY&&n.u1.getUIElement(this.$els.typeGroup).open()}_updateTypeButtonsState(){const t="stories-search-item_selected";if(this._searchData.type===m.hR.ANY)this.$els.type.find(".stories-search-item_button").removeClass(t),this.$els.type.find('.stories-search-item_button[data-value="0"]').addClass(t);else for(const e of Object.values(m.hR)){const s=e!==m.hR.ANY&&(this._searchData.type&e)===e;this.$els.type.find(`.stories-search-item_button[data-value="${e}"]`).toggleClass(t,s)}}_prepareTagsControl(){const t=this._tagsList=new h.EZ({$el:this.$els.tags,items:this._searchDataTagsWithSpecials,analyticsType:"search_similar_tags_popup",filter:C.ll.SEARCH}),e=t.tagsInput.suggestion;this.listenTo(e,$.n.SET,(()=>{this._searchDataTagsWithSpecials.forEach((t=>{var s;null===(s=e.$els.items.find(`[data-id='${t}']`))||void 0===s||s.remove(),e.$els.items.children().length||e.hide()}))})),this.listenTo(t,"change",((t,e)=>{this._updateTagsList([...t],[...e]),this.searchMode!==m.xd.ALL&&this.searchMode!==m.xd.TAG||this._updateTitleTagsBlock(),this._search()}));const s=new h.EZ({$el:this.$els.excludeTags,items:this._searchData.excludeTags});s.tagsInput.suggestion.parseFilter=e=>!t.items.includes(e.name),this.listenTo(s,"change",(t=>{this._updateExcludeTagsList(t),this._search()})),n.u1.getUIElement(this.$els.tagsGroup).toggleGroup(t.items.length>0||s.items.length>0)}_prepareUserControl(){if(!this.$els.userAddInput.length)return;const{user:t}=this._searchData;let e=new h._d({$el:this.$els.user,items:[t]});e.on("change",(t=>{this._updateUsersList(t),this._search()})),null!=t&&t.name&&(e.addItem(t),n.u1.getUIElement(this.$els.userGroup).open())}_prepareCommunityControl(){if(!this.$els.communityAddInput.length)return;const{community:t}=this._searchData;let e=new h.C2({$el:this.$els.community,items:[t]});e.on("change",(t=>{this._updateCommunitiesList(t),this._search()})),null!=t&&t.name&&(e.addItem(t),n.u1.getUIElement(this.$els.communityGroup).open())}_updateTagsList(t,e){const s=this._searchData.type;t.length>e.length?t.filter((t=>t&&m.ch[t]&&!e.includes(t))).forEach((t=>{this._searchData.type|=m.ch[t]})):t.length<e.length&&e.filter((e=>e&&m.ch[e]&&!t.includes(e))).forEach((t=>{this._searchData.type&=~m.ch[t]})),s!==this._searchData.type&&this._updateTypeButtonsState(),this._searchData.tags=t,this._setAnalyticsTagParameter(t),this._toggleLinkedTagsBlock(!1)}_setAnalyticsTagParameter(t){null!=t&&t.length?(k.cp.getInstance().commonParameters.screen_tag=t.join(","),T.dV.commonParameters.screen_tag=t.join(",")):(delete k.cp.getInstance().commonParameters.screen_tag,delete T.dV.commonParameters.screen_tag),this._searchData.shouldHideForm&&(k.cp.getInstance().commonParameters.lite_page=1,T.dV.commonParameters.lite_page=1)}_updateExcludeTagsList(t){this._searchData.excludeTags=t,Array.isArray(this._lastLinkedTags)&&this._updateLinkedTagsBlock(this._lastLinkedTags.filter((e=>!t.includes(e))))}_updateUsersList(t){this._searchData.user=t[0]||{name:"",avatar:""}}_updateCommunitiesList(t){this._searchData.community=t[0]||{name:"",avatar:"",link:""}}_prepareRatingControl(){const t=[-200,...m.et];let e=new r.T;e.options=t;let s=this._searchData.rating;e.value=t[s]||-200,s>0&&this.$els.ratingCaption.text(i.default.i18n("page-search.captions.rating",t[s])),e.on("change",(e=>{this.$els.rating.attr("data-rating",e),this._searchData.rating=t.indexOf(e),this.$els.ratingCaption.text(i.default.i18n("page-search.captions.rating",e)),this._search()})),this.$(".stories-search-rating__slider").append(e.show().$el),n.u1.getUIElement(this.$els.rating).toggleGroup(s>0)}_replaceLocation(t){const e=function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?O(Object(s),!0).forEach((function(e){U(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):O(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},t),s=this.searchMode===m.xd.VISITED;let n;s?n="Просмотренные":(n=(0,p.isUndefined)(e.q)?(0,p.isUndefined)(e.t)?"Поиск":e.t.replace(/[<>&]/g,"").replace(/,\s*/g,", "):e.q.replace(/[<>&]/g,"")+" - Поиск",void 0!==e.q?n=e.q.replace(/[<>&]/gi,"")+" - Поиск":void 0!==e.t&&(n=e.t.replace(/[<>&]/gi,"").replace(/,/gi,", ")));const a=!(0,p.isUndefined)(e.cl)&&this.searchMode===m.xd.COMMUNITY,o=!(0,p.isUndefined)(e.u)&&this.searchMode===m.xd.USER,r=!(0,p.isUndefined)(e.t)&&[m.xd.TAG,m.xd.ALL].includes(this.searchMode);let l="/search";switch(!0){case s:l="/visited-stories";break;case a:l="/community/"+e.cl+"/search",delete e.cl;break;case o:l="/@"+e.u+"/search",delete e.u;break;case r:const t=e.t.split(",").sort();if(t.length>3)break;l="/tag/"+t.map((t=>encodeURIComponent(t))).join(","),delete e.t;const i=1,n=e.r===i,c={default:!e.hasOwnProperty("st")||1===e.st,best:2===e.st,relevance:3===e.st};this.isTagsPage||(e.route="search"),c.best&&!n&&(l+="/best",delete e.st),c.relevance&&n&&(l+="/hot",delete e.r),c.default&&n&&(l+="/hot",delete e.st,delete e.r);break;default:l="/search"}const c=D.param(e);document.title=n;const d=l+(c?"?"+c:"");i.default.history.replaceState(e,n,d),this.feed.requestUrl=d}_search(){const{data:t}=this._getData();this._replaceLocation(t),!this.isTagsPage||t.t?(this._clearSearchResults(),this.feed.showSkeletonLoader(),this.timeout("request",1500,this._searchRequest)):i.default.location.reload()}async _searchRequest(){var t;this._setFeedSearchParams(),this._searchAnalytics.sendSearchEvent(null===(t=this._input)||void 0===t?void 0:t.value,this._searchData),await this.feed.clear().loadStories(!1)}_setFeedSearchParams(){let{data:t,emptyKeys:e}=this._getData();for(let s of e)this.feed.searchParams.delete(s)}_clearSearchResults(){this.marks.get("cleanResults")||(this._updateFoundTagsBlock([]),this._updateFoundUsersBlock([]),this._updateFoundCommunitiesBlock([]),this.$els.panel.hide(),this.feed.clear(),this.marks.set("cleanResults",!0))}_processFeedLoad(t){var e;(this.marks.set("cleanResults",!1),this.$els.panel.show(),void 0!==t.linked_tags&&this._updateLinkedTagsBlock(t.linked_tags),this.isTagsPage)?1===t.page&&(null===(e=this.feedMenu)||void 0===e||e.updateFeedCount(t.feed_comment_count)):(void 0!==t.tags&&this._updateFoundTagsBlock(t.tags),void 0!==t.users&&this._updateFoundUsersBlock(t.users),void 0!==t.communities&&this._updateFoundCommunitiesBlock(t.communities))}_getData(){var t,e,s;let i,n=[],a={};return i=(null===(t=this._input)||void 0===t?void 0:t.value)||"",""!==i?a.q=i:n.push("q"),i=this._searchData.tags.filter((t=>t&&!m.ch[t])).sort().join(","),""!==i?a.t=i:n.push("t"),i=this._searchData.excludeTags.join(","),""!==i?a.et=i:n.push("et"),i=this._searchData.type,0!==i?a.n=i:n.push("n"),i=this._searchData.sort.valueOf(),1!==i?a.st=i:n.push("st"),i=this._searchData.rating,0!==i?a.r=i:n.push("r"),i=(null===(e=this._searchData.user)||void 0===e?void 0:e.name)||"",""!==i?a.u=i:n.push("u"),i=(null===(s=this._searchData.community)||void 0===s?void 0:s.link)||"",""!==i?a.cl=i:n.push("cl"),i=this._searchData.visited,!1!==i&&""!==i?a.vn=i:n.push("vn"),i=this._searchData.dateFrom,""!==i?a.d=String(S(i)):n.push("d"),i=this._searchData.dateTo,""!==i?a.D=String(S(i)):n.push("D"),i=this._searchData.shouldHideForm,!1!==i?a.short=i:n.push("short"),{data:a,emptyKeys:n}}_prepareLinkedBlock(){this.$els.linkedTags=this.$(".stories-search__linked-tags").on("click",".tags__tag",(t=>{t.preventDefault(),this.isTagsPage?i.default.emit("stories-search:linked-tag-click",t.currentTarget.dataset.tag):this._tagsList.addItem(t.currentTarget.dataset.tag)})),this.$els.linkedTags.length&&this.$els.linkedTags.get(0).querySelectorAll(".tags__tag").forEach((t=>{t.dataset.analyticsType="search_similar_tags_popup"}))}_toggleLinkedTagsBlock(t){const e=this.$els.linkedTags;if(!e.length)return;e.is(":visible")!==t&&(t?e.slideDown():e.slideUp())}_updateLinkedTagsBlock(t){const e=this.$els.linkedTags;if(null==e||!e.length)return;const s=this._searchDataTagsWithSpecials,i=s.length>=1&&s.length<3&&t.length>2;var n,a,o;(t=t.filter((t=>!s.includes(t))),this._lastLinkedTags=t,i)?(e.empty().append((n={tags:t,key:s[0],isTagsPage:this.isTagsPage},a="",o=b.escape,Array.prototype.join,a+='    <h4>С этим тегом используют</h4>\n    <div class="tags">\n        ',n.tags.forEach((t=>{a+='\n            <a class="tags__tag" href="/tag/'+o([n.key,t].sort().join(","))+'/hot"  data-tag="'+o(t)+'" target="_blank" rel="noopener">'+o(t)+"</a>\n        "})),a+="\n\n",n.isTagsPage?a+='\n        <a href="/linked-tags/'+o(n.key)+'" target="_blank" rel="noopener" class="stories-search__linked-tags-all">Все</a>\n    </div>\n':a+='\n    </div>\n    <a href="/linked-tags/'+o(n.key)+'" target="_blank" rel="noopener" class="stories-search__linked-tags-all">Все теги</a>\n',a+="\n")),this._toggleLinkedTagsBlock(!0)):this._toggleLinkedTagsBlock(!1)}async _updateTitleTagsBlock(){const t=this._searchDataTagsWithSpecials,e=t.join(a.Gm);var s;if(!t.length)return this.$els.tagsTitleBlock.hide(),void(null===(s=this.storiesSearchFilter)||void 0===s||s.destroy());const n=1===t.length,o=t.map((t=>"Моё"===t?"[моё]":t)).join(" + "),r=await a.zG.getTagStatus(e),l=r.is_subscribed,c=r.is_ignored,d=r.is_subscribable,u=D((p={renderSubscribeButton:d,subscribed:l,ignored:c,tag:a.zG.normalizeTag(e),title:o,showDots:n},h="",_=y.escape,Array.prototype.join,h+='<div class="stories-search__tags-wrapper">\n\t<h1>\n\t\t'+_(p.title)+"\n\t\t",p.showTitleFilter,h+="\n\t</h1>\n\n\t",p.renderSubscribeButton&&(h+='\n\t\t<div class="stories-search__tags-buttons">\n\t\t\t<span\n\t\t\t\tdata-css-class="stories-search__tags-button-subscribe"\n\t\t\t\tdata-role="subscribe"\n\t\t\t\tdata-type="tag"\n\t\t\t\tdata-id="'+_(p.tag)+'"\n\t\t\t\tdata-is-subscribed="'+_(p.subscribed?"true":"false")+'"\n\t\t\t\tdata-is-ignored="'+_(p.ignored?"true":"false")+'"\n\t\t\t\tdata-actions="'+_(p.showDots?"ignore":"")+'"\n\t\t\t\tdata-analytics-type="header"\n\t\t\t\tdata-size="medium"\n\t\t\t\tdata-wide="true"\n\t\t\t>\n\t\t\t</span>\n\n\t\t\t',p.renderMoreTagsBtn,h+="\n\t\t</div>\n\t"),h+="\n</div>\n"));var p,h,_;this.$els.tagsTitleBlock.children(".stories-search__tags-wrapper").remove(),this.$els.tagsTitleBlock.prepend(u),this.$els.tagsTitleBlock.show(),i.default.ui.attachSubscribeButtons()}_updateFoundTagsBlock(t=null){let e=this.$els.resultBlock.find(".stories-search-result_tags");if(e.slideUp(200,(()=>{e.remove()})),null===t&&(t=i.default.config("modules.foundTags")||[]),0===t.length)return;let s=D(function(t){var e,s="",i=f.escape;Array.prototype.join,s+='<section class="stories-search-result stories-search-result_tags">\n\t',t.tags.length>5&&(s+='\n\t\t<a href="javascript: void(0);" data-role="show-all">'+(null==(e=t.tagsCount)?"":e)+'</a>\n\t\t<a href="javascript: void(0);" data-role="collapse">свернуть</a>\n\t'),s+="\n\t";for(var n=0,a=t.tags,o=a.length;n<o;n++)s+='\n\t\t<a class="tag stories-search-result__tag stories-search-result__item '+i(n>4?"stories-search-result__item_hidden":"")+'"\n\t\t   href="/tag/'+(null==(e=encodeURIComponent(a[n].name))?"":e)+'/hot">'+i(a[n].name)+"</a>\n\t";return s+"\n</section>\n"}({tags:t,tagsCount:t.length+" "+i.default.i18n("^page-search.tags('%0')",t.length)}));this.$els.resultBlock.append(s),s.slideDown(200),s.find('a[data-role="show-all"]').click((()=>{s.addClass("stories-search-result_show-all")})),s.find('a[data-role="collapse"]').click((()=>{s.removeClass("stories-search-result_show-all")}))}_updateFoundUsersBlock(t=null){let e=this.$els.resultBlock.find(".stories-search-result_users");if(e.slideUp(200,(()=>{e.remove()})),null===t&&(t=i.default.config("modules.foundUsers")||[]),0===t.length)return;let s=D(function(t){var e,s="",i=v.escape;Array.prototype.join,s+='<section class="stories-search-result stories-search-result_users">\n\t',t.users.length>5&&(s+='\n\t\t<a href="javascript: void(0);" data-role="show-all">'+(null==(e=t.usersCount)?"":e)+'</a>\n\t\t<a href="javascript: void(0);" data-role="collapse">свернуть</a>\n\t'),s+="\n\t";for(var n=0,a=t.users,o=a.length;n<o;n++)s+='\n\t\t<a class="user user_inline stories-search-result__user stories-search-result__item '+i(n>4?"stories-search-result__item_hidden":"")+'"\n\t\t   href="/@'+i(a[n].name)+'">\n\t\t\t<span class="avatar avatar_small"><img src="'+i(a[n].avatar)+'"></span>\n\t\t\t<span>'+i(a[n].name)+"</span>\n\t\t\t",a[n].approval&&(s+='\n\t\t\t<span class="user__label hint" data-type="approved" aria-label="'+i(a[n].approval)+'"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__approved"><use xlink:href="#icon--ui__approved"></use></svg></span>\n\t\t\t'),s+="\n\t\t</a>\n\t";return s+"\n</section>\n"}({users:t,usersCount:t.length+" "+i.default.i18n("^page-search.users('%0')",t.length)}));this.$els.resultBlock.append(s),s.slideDown(200),s.find('a[data-role="show-all"]').click((()=>{s.addClass("stories-search-result_show-all")})),s.find('a[data-role="collapse"]').click((()=>{s.removeClass("stories-search-result_show-all")}))}_updateFoundCommunitiesBlock(t=null){let e=this.$els.resultBlock.find(".stories-search-result_communities");if(e.slideUp(200,(()=>{e.remove()})),null===t&&(t=i.default.config("modules.foundCommunities")||[]),0===t.length)return;t.forEach((t=>{let e=t.subs.split(" ")[0];t.subs=`<b>${e}</b> ${i.default.i18n("plural.subs",e)}`;let s=t.stories.split(" ")[0];t.stories=`<b>${s}</b> ${i.default.i18n("plural.stories",s)}`}));let s=D(function(t){var e,s="",i=g.escape;Array.prototype.join,s+='<section class="stories-search-result stories-search-result_communities">\n\t',t.communities.length>3&&(s+='\n\t\t<a href="javascript: void(0);" data-role="show-all">Показать все '+(null==(e=t.communitiesCount)?"":e)+'</a>\n\t\t<a href="javascript: void(0);" data-role="collapse">свернуть</a>\n\t'),s+="\n\t";for(var n=0,a=t.communities,o=a.length;n<o;n++)s+='\n\t\t<div class="community stories-search-result__item '+i(n>3?"stories-search-result__item_hidden":"")+'" data-id="'+i(a[n].id)+'">\n\t\t\t<div class="community-avatar community-avatar_medium"><img src="'+i(a[n].avatar)+'" alt=""></div>\n\t\t\t<div class="community__wrapper">\n\t\t\t\t<div class="community__title"><a href="/community/'+i(a[n].link)+'">'+i(a[n].name)+'</a></div>\n\t\t\t\t<div class="community__information">\n\t\t\t\t\t<span>'+(null==(e=a[n].stories)?"":e)+"</span> <span>•</span> <span>"+(null==(e=a[n].subs)?"":e)+'</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="community__tags tags">\n\t\t\t\t\t',a[n].tags.forEach((function(t){s+='\n\t\t\t\t\t<a href="/communities/tag/'+i(t)+'" class="tags__tag" target="_blank" title="Поиск сообществ по тегу &quot;'+i(t)+'&quot;">\n\t\t\t\t\t\t'+i(t)+"\n\t\t\t\t\t</a>\n\t\t\t\t\t"})),s+="\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t";return s+="\n</section>\n"}({communities:t,communitiesCount:t.length+" "+i.default.i18n("page-search.communities",t.length)}));this.$els.resultBlock.append(s),s.slideDown(200),s.find('a[data-role="show-all"]').click((()=>{s.addClass("stories-search-result_show-all")})),s.find('a[data-role="collapse"]').click((()=>{s.removeClass("stories-search-result_show-all")}))}get searchMode(){return this._options.searchMode||m.xd.ALL}get feed(){return this._options.feed}set feed(t){this._options.feed!==t&&(this._options.feed=t)}get _searchDataTagsWithSpecials(){const t=[...this._searchData.tags].filter((t=>t&&!m.ch[t]));for(const[e,s]of Object.entries(m.ch))this._searchData.type&s&&t.push(e);return t}}},7912:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".block-view__block--KgUJrbHo{margin-bottom:32px}.block-view__caption--MeFJmbxl{margin-bottom:16px;color:var(--color-black-940);font-weight:700}.block-view__caption--MeFJmbxl a{color:inherit;display:flex;align-items:center}.block-view__caption--MeFJmbxl svg{margin-left:4px}",""]),o.locals={block:"block-view__block--KgUJrbHo",caption:"block-view__caption--MeFJmbxl"};const r=o},37881:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".browsing-page-view__firstBlock--L9LzIUqD{margin-top:20px}",""]),o.locals={firstBlock:"browsing-page-view__firstBlock--L9LzIUqD"};const r=o},63488:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".comments-view__block--zZYenH4M{margin-bottom:16px;padding:15px 23px 8px;border:1px solid var(--color-black-440);border-radius:8px;background:var(--color-bright-800)}.comments-view__loadmore--bANq7qGc{display:block;margin:16px auto 0}",""]),o.locals={block:"comments-view__block--zZYenH4M",loadmore:"comments-view__loadmore--bANq7qGc"};const r=o},24872:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".communities-view__container--YERK3ex2{position:relative;overflow:hidden;display:flex;flex-wrap:wrap;align-items:center;justify-content:flex-start;transition:max-height 200ms ease-out}.communities-view__linkAll--E8evNbf4{margin:0 0 12px 0;color:var(--color-primary-900);font-size:13px;line-height:20px;font-weight:500}",""]),o.locals={container:"communities-view__container--YERK3ex2",linkAll:"communities-view__linkAll--E8evNbf4"};const r=o},95801:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".community-view__host--XVGhUAHw{white-space:nowrap;margin:0 12px 12px 0;display:flex;align-items:center;color:var(--color-black-700);font-size:13px;line-height:20px;font-weight:400}.community-view__avatar--OHcdTxsX{margin-right:8px}",""]),o.locals={host:"community-view__host--XVGhUAHw",avatar:"community-view__avatar--OHcdTxsX"};const r=o},43805:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".tags-view__container--BBk2YGAi{overflow:hidden;display:flex;flex-wrap:wrap;align-items:center;justify-content:flex-start;position:relative;transition:max-height 200ms ease-out}.tags-view__block--mowpB9Ic{white-space:nowrap;margin:0 10px 8px 0;padding:3px 7px;display:block;color:var(--color-black-700);border-radius:2px;border:1px solid var(--color-black-430);background:var(--color-bright-800);font-size:13px;line-height:20px;font-weight:400}.tags-view__block--mowpB9Ic:last-child{margin-right:0}.tags-view__linkAll--QPlEqBwd{margin-bottom:10px;color:var(--color-primary-900);font-size:13px;line-height:20px;font-weight:500}",""]),o.locals={container:"tags-view__container--BBk2YGAi",block:"tags-view__block--mowpB9Ic",linkAll:"tags-view__linkAll--QPlEqBwd"};const r=o},16737:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".videos-view__block--XLgtiMrO{position:relative;min-width:140px;height:260px;border-radius:8px;margin-right:8px;background-position:center center;background-size:cover}.videos-view__views--O4ukDzRm{position:absolute;display:flex;align-items:center;left:12px;bottom:12px;border-radius:8px;padding:4px;background:var(--color-black-alpha-70);color:var(--color-bright-900);font-size:13px;line-height:20px;font-weight:500}.videos-view__views--O4ukDzRm svg{margin-right:8px}",""]),o.locals={block:"videos-view__block--XLgtiMrO",views:"videos-view__views--O4ukDzRm"};const r=o},68978:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".app__card--USFIgyD3:not(:first-child){margin-top:16px}",""]),o.locals={card:"app__card--USFIgyD3"};const r=o},75211:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,'.donations-view__content--bMXmnFr8{padding:16px 220px 24px 24px;min-height:200px;background:url("https://cs.pikabu.ru/images/donation-cookie.svg") no-repeat right 24px bottom/180px 200px}',""]),o.locals={content:"donations-view__content--bMXmnFr8"};const r=o},35585:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".fundraising-editor-view__warning--F7S_bVxJ{color:var(--color-black-800);margin-bottom:20px;font-size:14px;line-height:24px;font-weight:500;margin-top:12px}.fundraising-editor-view__input--mSDPMrtP+.fundraising-editor-view__input--mSDPMrtP{margin-top:12px}.fundraising-editor-view__controls--lBh4C61l{margin-top:12px}.fundraising-editor-view__cancelBtn--KbhO0xQV{margin-left:12px}",""]),o.locals={warning:"fundraising-editor-view__warning--F7S_bVxJ",input:"fundraising-editor-view__input--mSDPMrtP",controls:"fundraising-editor-view__controls--lBh4C61l",cancelBtn:"fundraising-editor-view__cancelBtn--KbhO0xQV"};const r=o},31862:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".fundraising-view__completedHeader--vbs0KjyP{background-color:var(--color-primary-200);color:var(--color-black-800);display:flex;line-height:48px;font-size:20px;font-weight:400;padding:20px 20px 12px}.fundraising-view__completedHeader--vbs0KjyP svg{margin-right:12px}.fundraising-view__content--RgChH9t4{color:var(--color-black-800);padding:16px 24px 24px}.fundraising-view__fundraisingTitle--yB3FZ_S1{color:var(--color-black-800);font-size:16px;line-height:20px;font-weight:500}.fundraising-view__progressbar--UvIxdW8s{margin-top:20px}.fundraising-view__description--qpeA_3yt{margin-top:8px;font-size:13px;line-height:20px;font-weight:400}.fundraising-view__emptyDescription--d7Q0IVIG{font-size:14px;line-height:24px;font-weight:400}.fundraising-view__note--gFgZJiCm{margin-top:20px;font-size:12px;line-height:16px;font-weight:400}.fundraising-view__controls--DJ2HiSOA{margin-top:20px}.fundraising-view__closeBtn--PGnvN5_y{margin-right:12px}",""]),o.locals={completedHeader:"fundraising-view__completedHeader--vbs0KjyP",content:"fundraising-view__content--RgChH9t4",fundraisingTitle:"fundraising-view__fundraisingTitle--yB3FZ_S1",progressbar:"fundraising-view__progressbar--UvIxdW8s",description:"fundraising-view__description--qpeA_3yt",emptyDescription:"fundraising-view__emptyDescription--d7Q0IVIG",note:"fundraising-view__note--gFgZJiCm",controls:"fundraising-view__controls--DJ2HiSOA",closeBtn:"fundraising-view__closeBtn--PGnvN5_y"};const r=o},7825:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".delete-form-view__cost--laFkRyOV{display:flex;align-items:center}.delete-form-view__value--y6BKx640{font-size:20px;line-height:20px;font-weight:500}.delete-form-view__units--elPoNEyl{margin-left:8px;font-size:13px;line-height:20px;font-weight:400}.delete-form-view__button--qzvaYnd4{display:flex;align-items:center;margin-top:16px;color:var(--color-danger-900);background:none;cursor:pointer;text-transform:none;user-select:none;padding:0;transition:filter 200ms ease-out;font-size:14px;line-height:24px;font-weight:500}.delete-form-view__icon--TAVJs5aq{margin-right:8px}",""]),o.locals={cost:"delete-form-view__cost--laFkRyOV",value:"delete-form-view__value--y6BKx640",units:"delete-form-view__units--elPoNEyl",button:"delete-form-view__button--qzvaYnd4",icon:"delete-form-view__icon--TAVJs5aq"};const r=o},20593:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".dialog-view__p--bQWz00LL+.dialog-view__p--bQWz00LL{margin-top:4px}.dialog-view__footer--QdpX99Ax{display:flex}.dialog-view__footer--QdpX99Ax>*:not(:first-child){margin-left:12px}",""]),o.locals={p:"dialog-view__p--bQWz00LL",footer:"dialog-view__footer--QdpX99Ax"};const r=o},32095:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".paid-subscription-view__content--cwW23Viu{color:var(--color-black-800);padding:16px 24px 24px}.paid-subscription-view__text--HhbiZGJm{font-size:14px;line-height:24px;font-weight:400}.paid-subscription-view__deleteForm--iXwinI1z{margin-top:16px}.paid-subscription-view__setForm--aD5uhOly{margin-top:4px}",""]),o.locals={content:"paid-subscription-view__content--cwW23Viu",text:"paid-subscription-view__text--HhbiZGJm",deleteForm:"paid-subscription-view__deleteForm--iXwinI1z",setForm:"paid-subscription-view__setForm--aD5uhOly"};const r=o},57168:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".set-form-view__note--C6QGr64m{font-size:14px;line-height:24px;font-weight:500}.set-form-view__cost--QmMr5sf3{display:flex;align-items:center;margin-top:16px}.set-form-view__input--m0OscMVU{width:160px}.set-form-view__units--ar9Lc8_g{margin-left:8px;font-size:13px;line-height:20px;font-weight:400}.set-form-view__button--XAO13gaW{margin-top:16px}",""]),o.locals={note:"set-form-view__note--C6QGr64m",cost:"set-form-view__cost--QmMr5sf3",input:"set-form-view__input--m0OscMVU",units:"set-form-view__units--ar9Lc8_g",button:"set-form-view__button--XAO13gaW"};const r=o},26566:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".disabled-view__text--P6em7nhu{color:var(--color-black-800);font-size:14px;line-height:24px;font-weight:400}.disabled-view__confirm--EF0u8VoA{margin-top:12px}.disabled-view__button--S_USOhxa{margin-top:20px}.disabled-view__note--vi6UcsAn{color:var(--color-black-700);margin-top:12px;font-size:13px;line-height:20px;font-weight:400}",""]),o.locals={text:"disabled-view__text--P6em7nhu",confirm:"disabled-view__confirm--EF0u8VoA",button:"disabled-view__button--S_USOhxa",note:"disabled-view__note--vi6UcsAn"};const r=o},37975:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".enabled-view__text--Fd3CmDBH{font-size:14px;line-height:24px;font-weight:400}.enabled-view__button--IuuBMcXN{margin-top:16px}",""]),o.locals={text:"enabled-view__text--Fd3CmDBH",button:"enabled-view__button--IuuBMcXN"};const r=o},45749:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".state-view__content--I1ACH7uf{padding:15px 23px}",""]),o.locals={content:"state-view__content--I1ACH7uf"};const r=o},51118:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".statistics-view__host--FLpHdV8J{display:flex;justify-content:flex-start;padding:0 0 17px;margin-bottom:18px;border-bottom:1px solid var(--color-black-430)}.statistics-view__item--IwidtqaO{font-size:12px;line-height:16px;font-weight:400;width:160px}.statistics-view__item--IwidtqaO:not(:first-child){margin-left:48px}.statistics-view__value--PEff1rP3{margin-bottom:4px;font-size:20px;line-height:20px;font-weight:500}",""]),o.locals={host:"statistics-view__host--FLpHdV8J",item:"statistics-view__item--IwidtqaO",value:"statistics-view__value--PEff1rP3"};const r=o},40360:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".dialog-view__p--ShFdWoT2+.dialog-view__p--ShFdWoT2{margin-top:4px}.dialog-view__footer--xGI8OM24{display:flex}.dialog-view__footer--xGI8OM24>*:not(:first-child){margin-left:12px}",""]),o.locals={p:"dialog-view__p--ShFdWoT2",footer:"dialog-view__footer--xGI8OM24"};const r=o},80976:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".subscriptions-view__content--fZWz2vse{padding:24px}.subscriptions-view__subscription--UHtv4Tm6{color:var(--color-black-700);font-size:13px;line-height:20px;font-weight:400}.subscriptions-view__status_danger--ybS73DTi{color:var(--color-danger-900)}.subscriptions-view__subscription--UHtv4Tm6{display:flex;align-items:center}.subscriptions-view__subscription--UHtv4Tm6:not(:first-child){margin-top:12px}.subscriptions-view__user--yki3OxQ_{margin-right:auto}.subscriptions-view__cost--oDPCRl8J{margin-left:8px;flex:0 0 104px}.subscriptions-view__status--oC8w0_of{margin-left:8px;flex:0 0 212px}.subscriptions-view__actions--j4DzvQP3{margin-left:8px;flex:0 0 28px}",""]),o.locals={content:"subscriptions-view__content--fZWz2vse",subscription:"subscriptions-view__subscription--UHtv4Tm6",status_danger:"subscriptions-view__status_danger--ybS73DTi",user:"subscriptions-view__user--yki3OxQ_",cost:"subscriptions-view__cost--oDPCRl8J",status:"subscriptions-view__status--oC8w0_of",actions:"subscriptions-view__actions--j4DzvQP3"};const r=o},41767:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".tabs-view__panels--gk8UDDey{margin-top:16px}.tabs-view__fundraising--CyI95AvR{margin-top:16px}",""]),o.locals={panels:"tabs-view__panels--gk8UDDey",fundraising:"tabs-view__fundraising--CyI95AvR"};const r=o},19828:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".app__content--Zw6sCtQk{padding:15px 11px}.app__empty--BfT1MoV6{position:relative;margin-bottom:20px}.app__empty--BfT1MoV6 h3{margin-bottom:4px;font-size:16px;line-height:20px;font-weight:500}.app__empty--BfT1MoV6 p{color:var(--color-black-700);font-size:12px;line-height:16px;font-weight:400}.app__alert--AAUC_BoU{display:flex;align-items:center}.app__alert--AAUC_BoU span{margin-right:4px}.app__link--WmqmmERh{position:absolute;display:block;top:18px;right:23px}.app__link--WmqmmERh svg{width:16px;height:16px;transition:fill 200ms;pointer-events:auto;color:var(--color-black-700)}.app__alertIcon--BZ931qm4{fill:currentColor}",""]),o.locals={content:"app__content--Zw6sCtQk",empty:"app__empty--BfT1MoV6",alert:"app__alert--AAUC_BoU",link:"app__link--WmqmmERh",alertIcon:"app__alertIcon--BZ931qm4"};const r=o},53471:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".notifications-info__title--yphL0ppY{color:var(--color-black-940);margin-bottom:6px;font-size:16px;line-height:20px;font-weight:500}.notifications-info__text--UwAkXsNP{color:var(--color-black-700);font-size:12px;line-height:16px;font-weight:400}.notifications-info__block--rWpGcrSN{display:flex;padding:6px 12px;margin-bottom:15px}.notifications-info__delete--OZ67hAXI{color:var(--color-black-700);text-decoration:none;cursor:pointer;margin-left:auto;padding-top:3px;text-transform:lowercase}.notifications-info__delete--OZ67hAXI svg{width:16px;height:16px}.notifications-info__link--DB8jA4N5{position:relative;display:block;margin-left:11px;padding:3px}.notifications-info__icon--uo1UwDQu{width:16px;height:16px;transition:fill 200ms;pointer-events:auto;color:var(--color-black-700);fill:var(--color-black-700)}",""]),o.locals={title:"notifications-info__title--yphL0ppY",text:"notifications-info__text--UwAkXsNP",block:"notifications-info__block--rWpGcrSN",delete:"notifications-info__delete--OZ67hAXI",link:"notifications-info__link--DB8jA4N5",icon:"notifications-info__icon--uo1UwDQu"};const r=o},77231:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".notifications-item__item--GnIMs2FX{width:100%;padding:12px;position:relative;margin-bottom:4px;border-radius:8px;color:var(--color-black-800);font-size:14px;line-height:24px;font-weight:400}.notifications-item__item--GnIMs2FX:hover .notifications-item__settings--zJSyhmQV{opacity:1}.notifications-item__item--GnIMs2FX.notifications-item__new--FO2Fo1yC{background-color:var(--color-warning-alpha-10);margin:0 0 4px}.notifications-item__content--l0y21XPB img{width:auto;max-height:36px;display:block;margin-top:4px}.notifications-item__header--jgfkBt30{display:flex;align-items:center;margin-bottom:8px}.notifications-item__typeIcon--zv5TD4hw{width:20px;box-sizing:content-box;text-align:center;margin-right:8px}.notifications-item__typeIcon--zv5TD4hw img{width:16px;height:16px}.notifications-item__typeIcon--zv5TD4hw svg{width:20px;height:20px;fill:var(--color-black-600);color:var(--color-black-600)}.notifications-item__typeIcon--zv5TD4hw .notifications-item__rewardIcon--DrLmchb5{width:20px;height:20px;color:var(--color-black-600)}.notifications-item__datetime--de4pyC5y{color:var(--color-black-700);display:block;font-size:14px;line-height:24px;font-weight:400}.notifications-item__settings--zJSyhmQV{position:absolute;top:12px;right:12px;display:block;opacity:0;transition:opacity 200ms}.notifications-item__settingsIcon--xNCLUV8Y{width:16px;height:16px;padding:2px;transition:fill 200ms;pointer-events:auto;color:var(--color-black-700)}",""]),o.locals={item:"notifications-item__item--GnIMs2FX",settings:"notifications-item__settings--zJSyhmQV",new:"notifications-item__new--FO2Fo1yC",content:"notifications-item__content--l0y21XPB",header:"notifications-item__header--jgfkBt30",typeIcon:"notifications-item__typeIcon--zv5TD4hw",rewardIcon:"notifications-item__rewardIcon--DrLmchb5",datetime:"notifications-item__datetime--de4pyC5y",settingsIcon:"notifications-item__settingsIcon--xNCLUV8Y"};const r=o},73735:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".request-form__header__title--AanADT_q{margin-bottom:4px;font-size:20px;line-height:28px;font-weight:400}.request-form__header__descr--arV8VOgK{font-size:14px;line-height:24px}.request-form__header__descr--arV8VOgK p{margin-bottom:4px}.request-form__header__descr--arV8VOgK p:last-child{margin-bottom:0}.request-form__title--_BMqBtcZ{font-size:16px;line-height:20px;font-weight:500}.request-form__loader--U2z1qb5K{display:inline-block}.request-form__button_promocode--kgZJKzId{min-width:192px;margin-top:4px}.request-form__discount-badge--htIBoN_U{background-color:var(--color-primary-700);color:var(--color-primary-50);padding:0 4px;border-radius:50px;font-size:13px;line-height:20px;font-weight:400}.request-form__cost-label--kBQxcSmf{color:var(--color-black-800);margin-left:4px}.request-form__cost-loader--ppsu0Zhp{margin-left:6px}.request-form__form--w8VKDndf{display:flex;flex-direction:column;overflow:visible}.request-form__form--w8VKDndf hr{margin:24px 0}.request-form__field--MWcQdSwQ{margin-top:4px;scroll-margin-top:32px}.request-form__field__title--WDQwFXaw{font-size:14px;font-weight:700;line-height:20px;color:var(--color-black-800)}.request-form__field__descr--GkZ45zZh{font-size:13px;font-weight:400;line-height:20px;color:var(--color-black-940);margin:4px 0}.request-form__field__input--lLXhpYcb{margin-top:4px;width:100%}.request-form__field__input_promocode--jarsszUN input{text-transform:uppercase}.request-form__field__input_promocode--jarsszUN input::placeholder{text-transform:none}.request-form__field__input_valid--WENJ3f3H{border-color:var(--color-primary-900)}.request-form__field__input_error--MqOzhc6Y{border-color:var(--color-danger-800)}.request-form__field_profile--XzU3nzs2{margin-top:0}.request-form__field_period--lIMrGD34,.request-form__field_promocode--AgkPDBPJ,.request-form__field_cost--JE6jM5nw{margin-top:16px}.request-form__field_cost--JE6jM5nw{display:flex}.request-form__field_cost--JE6jM5nw+div{margin-bottom:0}.request-form__field_org-type--lOshB8eK{margin-bottom:12px}.request-form__field_org-type--lOshB8eK .request-form__field__input--lLXhpYcb{display:flex;margin-top:10px}.request-form__field_org-type--lOshB8eK .request-form__field__input--lLXhpYcb>*{width:200px;margin-right:8px;white-space:nowrap}.request-form__field_org-type--lOshB8eK .request-form__field__title--WDQwFXaw,.request-form__field_contacts--dIlKpplW .request-form__field__title--WDQwFXaw{font-size:16px;line-height:24px}.request-form__field_org-type--lOshB8eK .request-form__field__descr--GkZ45zZh,.request-form__field_contacts--dIlKpplW .request-form__field__descr--GkZ45zZh{font-size:14px;color:var(--color-black-800)}.request-form__field_contacts--dIlKpplW{margin-top:28px;margin-bottom:8px}.request-form__field_email--cujFunrQ{margin-top:8px}.request-form__confirm--jIyaA9Xe{display:grid;gap:8px 12px;grid-template-columns:auto 1fr;align-items:start;margin:16px 0}.request-form__pixel--KZFUDiAY{width:1px;height:1px;position:absolute;left:-10000px}.request-form__promocodeWrapper--HqE4N8AE{display:flex;align-items:center;gap:10px}.request-form__promocodeNote--UuPxj0SA{margin-top:4px;color:var(--color-primary-900);font-size:13px;line-height:20px;font-weight:400}.request-form__promocodeError--jqchY7NB{color:var(--color-danger-800)}",""]),o.locals={header__title:"request-form__header__title--AanADT_q",header__descr:"request-form__header__descr--arV8VOgK",title:"request-form__title--_BMqBtcZ",loader:"request-form__loader--U2z1qb5K",button_promocode:"request-form__button_promocode--kgZJKzId","discount-badge":"request-form__discount-badge--htIBoN_U","cost-label":"request-form__cost-label--kBQxcSmf","cost-loader":"request-form__cost-loader--ppsu0Zhp",form:"request-form__form--w8VKDndf",field:"request-form__field--MWcQdSwQ",field__title:"request-form__field__title--WDQwFXaw",field__descr:"request-form__field__descr--GkZ45zZh",field__input:"request-form__field__input--lLXhpYcb",field__input_promocode:"request-form__field__input_promocode--jarsszUN",field__input_valid:"request-form__field__input_valid--WENJ3f3H",field__input_error:"request-form__field__input_error--MqOzhc6Y",field_profile:"request-form__field_profile--XzU3nzs2",field_period:"request-form__field_period--lIMrGD34",field_promocode:"request-form__field_promocode--AgkPDBPJ",field_cost:"request-form__field_cost--JE6jM5nw","field_org-type":"request-form__field_org-type--lOshB8eK",field_contacts:"request-form__field_contacts--dIlKpplW",field_email:"request-form__field_email--cujFunrQ",confirm:"request-form__confirm--jIyaA9Xe",pixel:"request-form__pixel--KZFUDiAY",promocodeWrapper:"request-form__promocodeWrapper--HqE4N8AE",promocodeNote:"request-form__promocodeNote--UuPxj0SA",promocodeError:"request-form__promocodeError--jqchY7NB"};const r=o},87566:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".success-message__host--jiwEmREv{display:flex;flex-direction:column;align-items:center;padding-top:59px;padding-bottom:59px}.success-message__host__title--rUD4ySyE{color:var(--color-black-800);font-size:24px;font-weight:400;line-height:28px;margin-bottom:12px}.success-message__host__text--Dw6PQx2I{color:var(--color-black-700);text-align:center;font-size:14px;font-weight:400;line-height:24px;margin-bottom:24px}",""]),o.locals={host:"success-message__host--jiwEmREv",host__title:"success-message__host__title--rUD4ySyE",host__text:"success-message__host__text--Dw6PQx2I"};const r=o},44871:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,'.app__host--XMA_nYvC{position:relative;margin-top:16px;background:var(--color-bright-800);box-shadow:var(--shadow-small);overflow:hidden;margin-bottom:16px;--offset-bottom: 198px;padding:24px 24px var(--offset-bottom);border-radius:8px}.app__host--XMA_nYvC::after{content:image-set(url("https://cs.pikabu.ru/files/pikabu15/end-complete.webp") 1x, url("https://cs.pikabu.ru/files/pikabu15/end-complete@2x.webp") 2x);line-height:0;position:absolute;bottom:0;left:50%;transform:translateX(-50%);max-width:100%}.app__bolt--zChXpaxr{position:absolute;color:#f2cc24;pointer-events:none}:root[data-theme-dark] .app__bolt--zChXpaxr{color:#bfa11d}.app__bolt_1--UHiyycjD{right:-288px;top:322px}.app__bolt_2--r53Oanrx{left:-288px;top:2444px}.app__inner--z_XYc0_O{display:flex;flex-direction:column;gap:48px;position:relative}.app__text--ybboiJWa{text-align:center;text-wrap:pretty;font-size:14px;line-height:24px;font-weight:400}.app__cards--TW853Exd{display:grid;gap:16px;grid-template-columns:repeat(2, 1fr)}.app__card--Q5Plf6HW{height:475px}.app__card--Q5Plf6HW:nth-child(5n){height:280px;grid-column:span 2}',""]),o.locals={host:"app__host--XMA_nYvC",bolt:"app__bolt--zChXpaxr",bolt_1:"app__bolt_1--UHiyycjD",bolt_2:"app__bolt_2--r53Oanrx",inner:"app__inner--z_XYc0_O",text:"app__text--ybboiJWa",cards:"app__cards--TW853Exd",card:"app__card--Q5Plf6HW"};const r=o},92989:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".comics-card__image--ERTEUlTE{display:block;height:100%;width:100%;object-fit:scale-down;cursor:pointer}",""]),o.locals={image:"comics-card__image--ERTEUlTE"};const r=o},275:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".intro__image--RODf1OEP{margin:0 auto}.intro__text--YIZGHwu3{text-align:center;margin-top:16px;font-size:14px;line-height:24px;font-weight:400}",""]),o.locals={image:"intro__image--RODf1OEP",text:"intro__text--YIZGHwu3"};const r=o},6281:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".outro__host--zo5v8Ldp{display:flex;flex-direction:column;align-items:center;gap:24px}",""]),o.locals={host:"outro__host--zo5v8Ldp"};const r=o},15944:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".app__hint--TVc4Odz4{display:flex;flex-wrap:wrap;gap:16px;width:300px;z-index:7000;padding:15px 15px 23px;background-color:var(--color-bright-800);border-radius:8px;filter:drop-shadow(0 1px 8px var(--color-contrast-shadow))}.app__trigger_active--N8SAS3TE{background-color:rgba(0,0,0,.08)}",""]),o.locals={hint:"app__hint--TVc4Odz4",trigger_active:"app__trigger_active--N8SAS3TE"};const r=o},88024:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".community-fieldset-view__community--wIXD9FHn{padding:4px 0 4px 2px}.community-fieldset-view__avatar--GZjmOVig{margin-right:6px;border-radius:4px}.community-fieldset-view__inputFilter--jm9s7GnV{width:100%}",""]),o.locals={community:"community-fieldset-view__community--wIXD9FHn",avatar:"community-fieldset-view__avatar--GZjmOVig",inputFilter:"community-fieldset-view__inputFilter--jm9s7GnV"};const r=o},74219:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".fieldset-view__host--_pRC0Qcd{display:flex;flex-wrap:wrap;gap:8px;border:0;color:var(--color-black-940);width:100%;font-size:14px;line-height:24px;font-weight:400}.fieldset-view__legend--kJL1yCAp{display:flex;align-items:center;width:100%}",""]),o.locals={host:"fieldset-view__host--_pRC0Qcd",legend:"fieldset-view__legend--kJL1yCAp"};const r=o},62968:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".filter-tab-view__host--CWB7LbY_{display:inline-flex;padding:4px 12px;background-color:var(--color-black-100);border-color:1px solid var(--color-black-300);color:var(--color-black-940);border-radius:8px;cursor:pointer}.filter-tab-view__host_active--KaPuIK8e{background-color:var(--color-primary-700);border-color:var(--color-primary-800);color:var(--color-bright-900)}",""]),o.locals={host:"filter-tab-view__host--CWB7LbY_",host_active:"filter-tab-view__host_active--KaPuIK8e"};const r=o},89256:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".filter-tabs-view__host--fhvVywE4{display:flex;flex-wrap:wrap;gap:8px}",""]),o.locals={host:"filter-tabs-view__host--fhvVywE4"};const r=o},59811:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".hide-viewed-fieldset-view__host--MeHlC9Ru{flex-direction:row;justify-content:space-between}",""]),o.locals={host:"hide-viewed-fieldset-view__host--MeHlC9Ru"};const r=o},27300:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".period-tabs-view__calendar--GVhg6kSV{background-color:var(--color-bright-800);border-radius:8px;filter:drop-shadow(0 1px 8px var(--color-contrast-shadow))}",""]),o.locals={calendar:"period-tabs-view__calendar--GVhg6kSV"};const r=o},20697:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".rating-view__suffix--J4P73Iqi{color:var(--color-black-700);margin-left:auto;font-size:13px;line-height:20px;font-weight:400}.rating-view__slider--I7oSLTTr{width:100%}",""]),o.locals={suffix:"rating-view__suffix--J4P73Iqi",slider:"rating-view__slider--I7oSLTTr"};const r=o},70986:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".tags-input-filter-view__host--R6RnxqJk{width:100%}.tags-input-filter-view__tag--y87o8CNa{background-color:var(--color-bright-800);padding:3px 7px;border:1px solid var(--color-black-430);border-radius:8px}",""]),o.locals={host:"tags-input-filter-view__host--R6RnxqJk",tag:"tags-input-filter-view__tag--y87o8CNa"};const r=o},10289:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".user-fieldset-view__user--yP12TihI{padding:4px 0 4px 2px}.user-fieldset-view__avatar--SgoGznby{margin-right:6px}.user-fieldset-view__inputFilter--UTq3_FWu{width:100%}",""]),o.locals={user:"user-fieldset-view__user--yP12TihI",avatar:"user-fieldset-view__avatar--SgoGznby",inputFilter:"user-fieldset-view__inputFilter--UTq3_FWu"};const r=o},15549:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".app__host--I3ZypP7h{min-height:100vh}.app__alert--E4ZtXvh7{margin-bottom:16px}",""]),o.locals={host:"app__host--I3ZypP7h",alert:"app__alert--E4ZtXvh7"};const r=o},21666:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".empty-view__host--_8gAXXlp{display:flex;flex-wrap:wrap;justify-content:center;text-align:center;padding:19px 39px}.empty-view__heading--VuL501jX{margin-bottom:20px;width:100%;font-size:16px;line-height:20px;font-weight:500}",""]),o.locals={host:"empty-view__host--_8gAXXlp",heading:"empty-view__heading--VuL501jX"};const r=o},60989:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".list-view__header--BTGoQckz{display:flex}.list-view__title--xRnE_0mU{line-height:40px;font-size:20px;font-weight:400}.list-view__controls--eMvnJTNb{display:flex}.list-view__draftTitle--ihFj6ky6{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block}.list-view__draftText--zJFT2a3P{display:-webkit-box;line-clamp:4;-webkit-line-clamp:4;-webkit-box-orient:vertical;overflow:hidden}.list-view__deleteAllBtn--C6YVuizc{margin-left:12px}.list-view__container--vaFN8CxQ{padding:24px 0}.list-view__draft--VG7NsAzy+.list-view__draft--VG7NsAzy{margin-top:8px}",""]),o.locals={header:"list-view__header--BTGoQckz",title:"list-view__title--xRnE_0mU",controls:"list-view__controls--eMvnJTNb",draftTitle:"list-view__draftTitle--ihFj6ky6",draftText:"list-view__draftText--zJFT2a3P",deleteAllBtn:"list-view__deleteAllBtn--C6YVuizc",container:"list-view__container--vaFN8CxQ",draft:"list-view__draft--VG7NsAzy"};const r=o},2842:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".finish-step__host--ih6Y12Du{display:flex;flex-direction:column;padding-top:24px;padding-bottom:24px}.finish-step__title--SYG3NtSy{color:var(--color-black-900);font-size:24px;font-weight:400;line-height:28px;margin-bottom:12px}.finish-step__text--I8DTDmgg{color:var(--color-black-800);font-size:14px;font-weight:400;line-height:24px;margin-bottom:24px}.finish-step__btn--L9e99Ysi{margin-right:12px}",""]),o.locals={host:"finish-step__host--ih6Y12Du",title:"finish-step__title--SYG3NtSy",text:"finish-step__text--I8DTDmgg",btn:"finish-step__btn--L9e99Ysi"};const r=o},49246:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".form-header__title--tBrXaE00{margin-bottom:16px;font-size:20px;line-height:28px;font-weight:400}.form-header__text--Z3bFzmS6{font-size:14px;font-weight:400;line-height:24px}.form-header__text--Z3bFzmS6+.form-header__text--Z3bFzmS6{margin-top:12px}",""]),o.locals={title:"form-header__title--tBrXaE00",text:"form-header__text--Z3bFzmS6"};const r=o},9773:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".user-form__form--uVrKr4_h{display:block}.user-form__part--m66fJI7y{padding:12px 0 24px;border-bottom:1px solid var(--color-black-430)}.user-form__part--m66fJI7y:first-child{padding-top:0}.user-form__part--m66fJI7y:last-child{border:none}.user-form__part--m66fJI7y input[type=number]::-webkit-inner-spin-button,.user-form__part--m66fJI7y input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.user-form__subtitle--kjLfoQyL{margin-bottom:12px}.user-form__types--QIAcKWSX{display:flex;justify-content:start;gap:8px}.user-form__type--QUk6luOL{width:216px;padding-right:28px;box-sizing:border-box}.user-form__type--QUk6luOL label{margin-bottom:8px}.user-form__typeImage--nxlEVkys{width:100%}.user-form__typeImage--nxlEVkys img{width:100%}.user-form__field--T8yEvmRc{padding:5px 0}.user-form__shows--wHjPh9vg{display:flex;align-items:center;margin-bottom:8px}.user-form__showsBtn--Il3FwtBm{width:32px;height:32px;margin-right:4px;cursor:pointer;padding:0 8px;color:var(--color-bright-900);box-sizing:border-box;background-color:var(--color-primary-700);border-radius:8px}.user-form__showsBtn--Il3FwtBm:last-child{margin-left:4px}.user-form__examples--gmJoKGwN{display:flex;color:var(--color-primary-900);margin-bottom:12px}.user-form__examples--gmJoKGwN span{margin-right:24px;cursor:pointer}.user-form__examples--gmJoKGwN span:hover{text-decoration:underline}.user-form__citiesBlock--x2FOJf5c{width:100%;background-color:var(--color-bright-800);border:1px solid var(--color-black-430);border-radius:8px;min-height:42px;padding:9px 15px 0;color:var(--color-black-940);resize:none;overflow:hidden}.user-form__citiesBlock--x2FOJf5c .user-form__placeholder--OLj7FSlV{color:var(--color-black-700)}.user-form__citiesContent--hWdb29hy{display:flex;flex-wrap:wrap;font-size:13px;line-height:20px;font-weight:400}.user-form__cityItem--Dg32xq8D{display:flex;align-items:center;padding:2px 8px 2px 12px;border-radius:40px;background-color:var(--color-black-300);margin-right:10px;margin-bottom:10px}.user-form__cityItem--Dg32xq8D span{margin-left:8px;color:var(--color-black-600);cursor:pointer}.user-form__disabled--cUQSE9Pa{opacity:.5;pointer-events:none;cursor:not-allowed}.user-form__thousandCost--aqAKQ9pP{margin-bottom:16px}.user-form__thousandCost--aqAKQ9pP span{margin-left:4px;color:var(--color-black-700)}.user-form__budget--HiOGdKFv{padding:16px;margin-bottom:16px;background-color:var(--color-primary-200);border-radius:8px}.user-form__budget--HiOGdKFv span{margin-left:4px;color:var(--color-black-700)}.user-form__discount--DKr2Nm5s{padding:0 4px;border-radius:50px;margin-left:4px;background-color:var(--color-primary-700);color:var(--color-primary-50) !important;font-size:13px;line-height:20px;font-weight:400}.user-form__label--XM8s55Ea{display:flex;align-items:center;margin-bottom:4px}.user-form__inputText--cAv0aVmw{min-height:80px;align-items:flex-start}.user-form__postImage--qhopPI54{position:relative;border:4px dashed var(--color-black-430);height:56px;border-radius:8px;display:flex;justify-content:center}.user-form__postImage--qhopPI54.user-form__error--zu_mPK_0{border-color:var(--color-danger-800)}.user-form__postImageInput--dDEFiaJ_{width:100%;height:100%;opacity:0;position:absolute;top:0;left:0;cursor:pointer}.user-form__postImageInfo--asFBEFQK{color:var(--color-black-800);cursor:pointer;display:flex;align-items:center;font-size:14px;line-height:24px;font-weight:500}.user-form__postImageInfo--asFBEFQK p span{color:var(--color-black-700)}.user-form__postImageIcon--ngSvFBGK{width:16px;height:16px;display:block;border-radius:50%;color:var(--color-bright-900);padding:0 4px;box-sizing:border-box;margin-right:8px;background-color:var(--color-primary-700)}.user-form__postImageIcon--ngSvFBGK svg{width:8px}.user-form__hint--ysiw7wJ4{display:block;margin-left:4px}.user-form__dateWrapper--mki4ge_L{display:flex;align-items:center;gap:8px}.user-form__drop--BIyB5VXI{display:flex;align-items:center;flex-wrap:wrap}.user-form__column--Hvg4xg7o{min-width:200px;margin-bottom:8px}.user-form__column--Hvg4xg7o:first-child{order:2}.user-form__column--Hvg4xg7o:nth-child(2){order:3}.user-form__confirm--kCCzAwgj{display:flex;flex-wrap:wrap;align-items:center;padding:8px 0;gap:8px;margin-bottom:8px}.user-form__confirm--kCCzAwgj:last-child{margin-bottom:0}.user-form__confirm--kCCzAwgj h4{margin-bottom:0}.user-form__dropContent--catzVrAk{width:100%}.user-form__cities--agdvzXjj{padding:4px 0}.user-form__city--WkWND6Gd{padding:9px 15px;cursor:pointer}.user-form__city--WkWND6Gd:hover{background-color:var(--color-black-430)}.user-form__block-heading--bQMlQkJ6{font-size:16px;font-weight:700;line-height:24px;color:var(--color-black-800)}.user-form__title--XABueGNg{font-size:16px;line-height:20px;font-weight:500}",""]),o.locals={form:"user-form__form--uVrKr4_h",part:"user-form__part--m66fJI7y",subtitle:"user-form__subtitle--kjLfoQyL",types:"user-form__types--QIAcKWSX",type:"user-form__type--QUk6luOL",typeImage:"user-form__typeImage--nxlEVkys",field:"user-form__field--T8yEvmRc",shows:"user-form__shows--wHjPh9vg",showsBtn:"user-form__showsBtn--Il3FwtBm",examples:"user-form__examples--gmJoKGwN",citiesBlock:"user-form__citiesBlock--x2FOJf5c",placeholder:"user-form__placeholder--OLj7FSlV",citiesContent:"user-form__citiesContent--hWdb29hy",cityItem:"user-form__cityItem--Dg32xq8D",disabled:"user-form__disabled--cUQSE9Pa",thousandCost:"user-form__thousandCost--aqAKQ9pP",budget:"user-form__budget--HiOGdKFv",discount:"user-form__discount--DKr2Nm5s",label:"user-form__label--XM8s55Ea",inputText:"user-form__inputText--cAv0aVmw",postImage:"user-form__postImage--qhopPI54",error:"user-form__error--zu_mPK_0",postImageInput:"user-form__postImageInput--dDEFiaJ_",postImageInfo:"user-form__postImageInfo--asFBEFQK",postImageIcon:"user-form__postImageIcon--ngSvFBGK",hint:"user-form__hint--ysiw7wJ4",dateWrapper:"user-form__dateWrapper--mki4ge_L",drop:"user-form__drop--BIyB5VXI",column:"user-form__column--Hvg4xg7o",confirm:"user-form__confirm--kCCzAwgj",dropContent:"user-form__dropContent--catzVrAk",cities:"user-form__cities--agdvzXjj",city:"user-form__city--WkWND6Gd","block-heading":"user-form__block-heading--bQMlQkJ6",title:"user-form__title--XABueGNg"};const r=o},54954:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".pkb-card-header__host--Yku2Zi6a{display:flex;border-bottom:1px solid var(--color-black-430);background-color:var(--color-bright-800);padding:17px 23px;border-radius:inherit;border-bottom-left-radius:0;border-bottom-right-radius:0}.pkb-card-header__title--myylVc5x{color:var(--color-black-940);margin-right:auto;font-size:14px;line-height:20px;font-weight:500;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block}.pkb-card-header__right--g_ncUO9s{flex-shrink:0;margin-left:12px;font-size:13px;line-height:20px;font-weight:500}",""]),o.locals={host:"pkb-card-header__host--Yku2Zi6a",title:"pkb-card-header__title--myylVc5x",right:"pkb-card-header__right--g_ncUO9s"};const r=o},55028:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".pkb-carousel__host--ESudrLzl{position:relative;margin:0 calc(-1*var(--edge-size))}.pkb-carousel__inner--D5Eyc5B5{display:flex;position:relative;padding-right:var(--edge-size);padding-left:var(--edge-size);overflow:hidden}.pkb-carousel__inner_grabbing--liROhJLJ{cursor:grabbing}.pkb-carousel__inner_grabbing--liROhJLJ a{cursor:grabbing}.pkb-carousel__inner--D5Eyc5B5>*:last-child{margin-right:0 !important}.pkb-carousel__arrow--ZTIldxh4{position:absolute;top:50%;width:32px;height:32px;background:var(--color-bright-800);box-shadow:var(--shadow-default);color:var(--color-contrast-bg);border-radius:40px;display:flex;justify-content:center;align-items:center;cursor:pointer;transition:background-color ease-out .2s}.pkb-carousel__arrow_right--rgYvNkJx{right:25px}.pkb-carousel__arrow_left--IsUpyvog{left:25px}:root[data-theme-dark] .pkb-carousel__arrow--ZTIldxh4{box-shadow:0 1px 8px var(--color-contrast-shadow)}.pkb-carousel__arrow--ZTIldxh4:hover{filter:none !important;background-color:var(--color-primary-400)}",""]),o.locals={host:"pkb-carousel__host--ESudrLzl",inner:"pkb-carousel__inner--D5Eyc5B5",inner_grabbing:"pkb-carousel__inner_grabbing--liROhJLJ",arrow:"pkb-carousel__arrow--ZTIldxh4",arrow_right:"pkb-carousel__arrow_right--rgYvNkJx",arrow_left:"pkb-carousel__arrow_left--IsUpyvog"};const r=o},8653:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".pkb-comment-user__host--qVF_aEwk{display:flex;align-items:center;overflow:hidden;color:var(--color-black-800)}.pkb-comment-user__name--lCzIEacH{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;font-size:13px;line-height:20px;font-weight:500;margin-left:8px}",""]),o.locals={host:"pkb-comment-user__host--qVF_aEwk",name:"pkb-comment-user__name--lCzIEacH"};const r=o},32196:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".calendar-sheet__host--etF7sIuq{width:fit-content;user-select:none}.calendar-sheet__month--Crroecxp{padding:8px 0;display:flex;align-items:center}.calendar-sheet__monthTitle--KhrL5pES{margin:0 8px;flex:1 1 0;text-align:center;color:var(--color-black-940);font-size:14px;line-height:24px;font-weight:500}.calendar-sheet__weekDays--RM7ITLy8{display:grid;justify-content:center;grid-template:36px/repeat(7, 36px)}.calendar-sheet__weekDay--JsrvLB5F{display:flex;align-items:center;justify-content:center;color:var(--color-black-700);font-size:13px;line-height:20px;font-weight:500}.calendar-sheet__days--NKr1ulzS{display:grid;justify-content:center;grid-template:repeat(6, 36px)/repeat(7, 36px)}.calendar-sheet__day--QrVXoUlO{display:flex;align-items:center;justify-content:center;color:var(--color-black-940);background:var(--color-bright-800);cursor:pointer;transition:200ms ease-out;border-radius:8px;font-size:14px;line-height:24px;font-weight:400}.calendar-sheet__day--QrVXoUlO:hover{filter:brightness(0.96)}.calendar-sheet__day--QrVXoUlO:active{filter:brightness(0.92)}.calendar-sheet__day_start--LOxUEXuc,.calendar-sheet__day_end--er2v0mX6{background:var(--color-primary-700);color:var(--color-bright-900)}.calendar-sheet__day_start--LOxUEXuc{border-radius:8px 0 0 8px}.calendar-sheet__day_end--er2v0mX6{border-radius:0 8px 8px 0}.calendar-sheet__day_start--LOxUEXuc.calendar-sheet__day_end--er2v0mX6{border-radius:8px}.calendar-sheet__day_between--pxyqTuFL{border-radius:0;background:var(--color-primary-200)}.calendar-sheet__day_muted--ycFybqh2{opacity:.4}",""]),o.locals={host:"calendar-sheet__host--etF7sIuq",month:"calendar-sheet__month--Crroecxp",monthTitle:"calendar-sheet__monthTitle--KhrL5pES",weekDays:"calendar-sheet__weekDays--RM7ITLy8",weekDay:"calendar-sheet__weekDay--JsrvLB5F",days:"calendar-sheet__days--NKr1ulzS",day:"calendar-sheet__day--QrVXoUlO",day_start:"calendar-sheet__day_start--LOxUEXuc",day_end:"calendar-sheet__day_end--er2v0mX6",day_between:"calendar-sheet__day_between--pxyqTuFL",day_muted:"calendar-sheet__day_muted--ycFybqh2"};const r=o},18062:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".range-picker__host--EOfWNnSg{width:fit-content;background:var(--color-bright-800)}.range-picker__sheets--BFtH6Kwe{display:flex}.range-picker__sheet--xwzlQv7i{padding:20px 15px 15px}.range-picker__sheet--xwzlQv7i:first-child{padding-left:24px}.range-picker__sheet--xwzlQv7i:last-child{padding-right:24px}.range-picker__sheet--xwzlQv7i+.range-picker__sheet--xwzlQv7i{border-left:1px solid var(--color-black-300)}.range-picker__footer--rQ0cWEB1{display:flex;align-items:center;border-top:1px solid var(--color-black-300);padding:12px 24px 16px}.range-picker__input--yXN1MfYe{width:109px}.range-picker__separator--zm2Rkq2W{margin:0 4px;color:var(--color-black-600);transform:rotateZ(0.5turn)}.range-picker__approve--_Skih5Uh{margin-left:auto}",""]),o.locals={host:"range-picker__host--EOfWNnSg",sheets:"range-picker__sheets--BFtH6Kwe",sheet:"range-picker__sheet--xwzlQv7i",footer:"range-picker__footer--rQ0cWEB1",input:"range-picker__input--yXN1MfYe",separator:"range-picker__separator--zm2Rkq2W",approve:"range-picker__approve--_Skih5Uh"};const r=o},87170:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".pkb-dropinfo__host--NA6Y4RSE{margin-top:8px;border-radius:8px;border:1px solid var(--color-black-430);border-bottom:none}.pkb-dropinfo__header--fSVA9Tqa{display:flex;align-items:center;justify-content:space-between;padding:15px 24px;border-bottom:1px solid var(--color-black-430);cursor:pointer}.pkb-dropinfo__header--fSVA9Tqa svg{width:24px;height:24px;margin-right:-4px;fill:var(--color-black-700)}.pkb-dropinfo__title--jpqdpZyP{font-size:14px;line-height:24px;font-weight:500}.pkb-dropinfo__opened--JDARqODu svg{transform:rotate(180deg)}.pkb-dropinfo__content--pIx2GnRp{padding:8px 24px 16px;border-bottom:1px solid var(--color-black-430);font-size:14px;line-height:20px}.pkb-dropinfo__content--pIx2GnRp ul{margin-top:12px;margin-left:12px}",""]),o.locals={host:"pkb-dropinfo__host--NA6Y4RSE",header:"pkb-dropinfo__header--fSVA9Tqa",title:"pkb-dropinfo__title--jpqdpZyP",opened:"pkb-dropinfo__opened--JDARqODu",content:"pkb-dropinfo__content--pIx2GnRp"};const r=o},84177:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".pkb-input-filter-item__host--ZOMHPUhO{font-size:13px;color:var(--color-black-800);display:flex;align-items:center;overflow:hidden}.pkb-input-filter-item__host__label--_Ivt3AHX{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block}.pkb-input-filter-item__removeButton--Brx_ukFN{color:var(--color-black-600);flex-shrink:0;padding:0 4px;transition:color 200ms ease-out;cursor:pointer}.pkb-input-filter-item__removeButton--Brx_ukFN:hover{color:linear-gradient(0deg, rgba(0, 0, 0, 0.12), rgba(0, 0, 0, 0.12)),var(--color-black-600)}.pkb-input-filter-item__removeButton--Brx_ukFN:active{color:linear-gradient(0deg, rgba(0, 0, 0, 0.24), rgba(0, 0, 0, 0.24)),var(--color-black-600)}",""]),o.locals={host:"pkb-input-filter-item__host--ZOMHPUhO",host__label:"pkb-input-filter-item__host__label--_Ivt3AHX",removeButton:"pkb-input-filter-item__removeButton--Brx_ukFN"};const r=o},30400:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".pkb-input-filter__host--rNpoBnue{position:relative}.pkb-input-filter__baseInput--HvhJZNOl{padding:5px 7px}.pkb-input-filter__wrapper--Cp8OldyM{display:flex;flex-wrap:wrap;gap:4px;cursor:text}.pkb-input-filter__wrapper_padding--ZEEf8jTc{padding-right:24px}.pkb-input-filter__dropdown--MVayiNq_{overflow:hidden;background-color:var(--color-bright-800);border-radius:8px;filter:drop-shadow(0 1px 8px var(--color-contrast-shadow))}.pkb-input-filter__inputWrapper--hYPOZBKM{display:flex;align-items:center;position:relative;max-width:100%;overflow:hidden}.pkb-input-filter__inputContainer--Fc0EX0sC{flex:1}.pkb-input-filter__inputLabel--EhgOPaZ7{display:inline-flex;align-items:center;color:var(--color-black-600);gap:4px}.pkb-input-filter__inputLabel--EhgOPaZ7 span{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block}.pkb-input-filter__input--CNX5lICB{font-size:inherit;line-height:inherit;font-weight:inherit;color:var(--color-black-940);outline:none;border:0;background-color:rgba(0,0,0,0);overflow:hidden;padding:4px}.pkb-input-filter__input_empty--Shkm4EvS{padding:4px 0;position:relative;left:4px}",""]),o.locals={host:"pkb-input-filter__host--rNpoBnue",baseInput:"pkb-input-filter__baseInput--HvhJZNOl",wrapper:"pkb-input-filter__wrapper--Cp8OldyM",wrapper_padding:"pkb-input-filter__wrapper_padding--ZEEf8jTc",dropdown:"pkb-input-filter__dropdown--MVayiNq_",inputWrapper:"pkb-input-filter__inputWrapper--hYPOZBKM",inputContainer:"pkb-input-filter__inputContainer--Fc0EX0sC",inputLabel:"pkb-input-filter__inputLabel--EhgOPaZ7",input:"pkb-input-filter__input--CNX5lICB",input_empty:"pkb-input-filter__input_empty--Shkm4EvS"};const r=o},70266:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".pkb-input-label__label--ICqZ2W81{display:flex;align-items:center;margin-bottom:4px}.pkb-input-label__hint--tEjD6McT{display:block;margin-left:0 !important}.pkb-input-label__hint--tEjD6McT svg{fill:var(--color-black-700)}",""]),o.locals={label:"pkb-input-label__label--ICqZ2W81",hint:"pkb-input-label__hint--tEjD6McT"};const r=o},95418:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".pkb-slider__wrapper--oA8miETI{overflow:hidden}.pkb-slider__input--VrMGtbNW{--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min)) / var(--range));--sx: calc(0.5 * 18px + var(--ratio) * (100% - 18px));margin:0;padding:0;width:100%;height:18px;background:rgba(0,0,0,0);display:block}.pkb-slider__input--VrMGtbNW,.pkb-slider__input--VrMGtbNW::-webkit-slider-thumb{-webkit-appearance:none}.pkb-slider__input--VrMGtbNW::-webkit-slider-runnable-track{box-sizing:border-box;border:none;width:100%;height:2px;background:var(--color-black-440);background:linear-gradient(var(--color-primary-700), var(--color-primary-700)) 0/var(--sx) 100% no-repeat var(--color-black-440)}.pkb-slider__input--VrMGtbNW::-moz-range-track{box-sizing:border-box;border:none;width:100%;height:2px;background:var(--color-black-440)}.pkb-slider__input--VrMGtbNW::-ms-track{box-sizing:border-box;border:none;width:100%;height:2px;background:var(--color-black-440)}.pkb-slider__input--VrMGtbNW::-moz-range-progress{height:2px;background:var(--color-primary-700)}.pkb-slider__input--VrMGtbNW::-ms-fill-lower{height:2px;background:var(--color-primary-700)}.pkb-slider__input--VrMGtbNW::-webkit-slider-thumb{margin-top:-8px;box-sizing:border-box;border:none;width:18px;height:18px;border-radius:50%;background:var(--color-primary-700);cursor:move}.pkb-slider__input--VrMGtbNW::-moz-range-thumb{box-sizing:border-box;border:none;width:18px;height:18px;border-radius:50%;background:var(--color-primary-700);cursor:move}.pkb-slider__input--VrMGtbNW::-ms-thumb{margin-top:0;box-sizing:border-box;border:none;width:18px;height:18px;border-radius:50%;background:var(--color-primary-700);cursor:move}.pkb-slider__input--VrMGtbNW::-ms-tooltip{display:none}",""]),o.locals={wrapper:"pkb-slider__wrapper--oA8miETI",input:"pkb-slider__input--VrMGtbNW"};const r=o},29719:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".pkb-svg__host--MldW5EwY{display:block;pointer-events:revert}",""]),o.locals={host:"pkb-svg__host--MldW5EwY"};const r=o},80744:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,".pkb-tab__host--lBjLw4m7{padding:11px 0;color:var(--color-black-700);cursor:pointer;text-align:center;transition:200ms ease-out;user-select:none;position:relative;flex-shrink:0;font-size:14px;line-height:24px;font-weight:500}@media(hover: hover){.pkb-tab__host--lBjLw4m7:hover{filter:opacity(0.8)}}.pkb-tab__host--lBjLw4m7:active{filter:brightness(0.85)}.pkb-tab__host--lBjLw4m7:focus-visible{box-shadow:var(--shadow-focus)}@supports(color: color-mix(in sRGB, white, black)){@media(hover: hover){.pkb-tab__host--lBjLw4m7:hover{filter:none;color:color-mix(in sRGB, var(--color-black-700), #ffffff 20%)}}.pkb-tab__host--lBjLw4m7:active{filter:none;color:color-mix(in sRGB, var(--color-black-700), #000000 20%)}}.pkb-tab__active--Ca4Xklj1{pointer-events:none;color:var(--color-primary-800)}.pkb-tab__rounded--E2YYfNP1{padding:15px 0}.pkb-tab__rounded--E2YYfNP1.pkb-tab__active--Ca4Xklj1{color:var(--color-bright-900)}.pkb-tab__roundedCompact--Tl170ZIH{padding:13px 0}.pkb-tab__roundedCompact--Tl170ZIH.pkb-tab__active--Ca4Xklj1{color:var(--color-bright-900)}",""]),o.locals={host:"pkb-tab__host--lBjLw4m7",active:"pkb-tab__active--Ca4Xklj1",rounded:"pkb-tab__rounded--E2YYfNP1",roundedCompact:"pkb-tab__roundedCompact--Tl170ZIH"};const r=o},32365:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});var i=s(8081),n=s.n(i),a=s(23645),o=s.n(a)()(n());o.push([t.id,'.pkb-tabs__host--b7LhjX9M{display:flex;align-items:center;background:var(--color-bright-800);overflow-x:auto;position:relative;border:1px solid var(--color-black-300);border-radius:8px}.pkb-tabs__host--b7LhjX9M>*:not(:first-child){margin-left:24px}.pkb-tabs__host--b7LhjX9M::before{content:"";display:block;height:2px;background-color:var(--color-primary-800);position:absolute;bottom:0;left:var(--left);width:var(--width);transition:left 200ms ease-out,width 200ms ease-out;border-radius:2px}.pkb-tabs__rounded--mNhP7z_y::before{height:auto;top:11px;bottom:11px;left:calc(var(--left) - 8px);width:calc(var(--width) + 16px);transition:left 200ms ease-out,width 200ms ease-out;border-radius:8px}.pkb-tabs__roundedCompact--KOBLaYVR{padding:0 6px;border:none;margin-bottom:16px}.pkb-tabs__roundedCompact--KOBLaYVR::before{height:auto;top:11px;bottom:11px;left:calc(var(--left) - 8px);width:calc(var(--width) + 16px);transition:left 200ms ease-out,width 200ms ease-out;border-radius:25px}',""]),o.locals={host:"pkb-tabs__host--b7LhjX9M",rounded:"pkb-tabs__rounded--mNhP7z_y",roundedCompact:"pkb-tabs__roundedCompact--KOBLaYVR"};const r=o},97652:(t,e,s)=>{"use strict";s.d(e,{Z:()=>d});var i=s(66252),n=s(3577);var a=s(21649),o=s.n(a),r=s(83744);const l={},c={};c.$style=o();const d=(0,r.Z)(l,[["render",function(t,e){return(0,i.wg)(),(0,i.iD)("header",{class:(0,n.C_)(t.$style.host)},[(0,i._)("h3",{class:(0,n.C_)(t.$style.title)},[(0,i.WI)(t.$slots,"default")],2),t.$slots.right?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,n.C_)(t.$style.right)},[(0,i.WI)(t.$slots,"right")],2)):(0,i.kq)("v-if",!0)],2)}],["__cssModules",c]])},1876:(t,e,s)=>{"use strict";s.d(e,{Z:()=>p});var i=s(66252),n=s(3577),a=s(20252);const o=["href"],r=(0,i.aZ)({__name:"pkb-comment-user",props:{name:{},avatar:{default:void 0}},setup:t=>(t,e)=>((0,i.wg)(),(0,i.iD)("a",{class:(0,n.C_)(t.$style.host),href:`/@${t.name}`},[(0,i.Wm)(a.Z,{size:20,url:t.avatar},null,8,["url"]),(0,i._)("span",{class:(0,n.C_)(t.$style.name)},(0,n.zw)(t.name),3)],10,o))});var l=s(33787),c=s.n(l),d=s(83744);const u={};u.$style=c();const p=(0,d.Z)(r,[["__cssModules",u]])},64090:(t,e,s)=>{"use strict";s.d(e,{Z:()=>m});var i=s(66252),n=s(3577),a=s(49963),o=s(40094),r=s(2262);const l=["onClick"],c=["innerHTML"],d=(0,i.aZ)({__name:"pkb-dropinfo",props:{items:{}},emits:["drop"],setup(t,{emit:e}){const s=(0,r.iH)(-1),d=t,u=e;return(t,e)=>((0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(t.$style.host)},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(d.items,((e,r)=>((0,i.wg)(),(0,i.iD)("div",{key:r},[(0,i._)("div",{class:(0,n.C_)([t.$style.header,{[t.$style.opened]:s.value===r}]),onClick:t=>function(t){u("drop",s.value===t,t+1),s.value=s.value===t?-1:t}(r)},[(0,i._)("h4",{class:(0,n.C_)(t.$style.title)},(0,n.zw)(e.title),3),(0,i.Wm)(o.Z,{name:"arrow_down_16"})],10,l),(0,i.wy)((0,i._)("div",{class:(0,n.C_)(t.$style.content)},[(0,i._)("div",{innerHTML:e.content},null,8,c)],2),[[a.F8,s.value===r]])])))),128))],2))}});var u=s(51514),p=s.n(u),h=s(83744);const _={};_.$style=p();const m=(0,h.Z)(d,[["__cssModules",_]])},57599:(t,e,s)=>{"use strict";s.d(e,{Z:()=>p});var i=s(66252),n=s(3577),a=s(2262);const o=["value","max"],r=(0,i.aZ)({__name:"pkb-slider",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const s=t,r=e,l=(0,a.iH)(),c=(0,a.iH)(),d=(0,a.iH)();function u(){var t;d.value=Number(null===(t=c.value)||void 0===t?void 0:t.value),r("update:modelValue",d.value)}return(0,i.bv)((()=>{d.value=s.modelValue})),(t,e)=>((0,i.wg)(),(0,i.iD)("div",{ref_key:"hostEl",ref:l,class:(0,n.C_)(t.$style.wrapper)},[(0,i._)("input",{ref_key:"inputEl",ref:c,class:(0,n.C_)(t.$style.input),type:"range",value:d.value,min:"0",max:s.options.length-1,style:(0,n.j5)({"--val":d.value,"--min":0,"--max":s.options.length-1}),onInput:u},null,46,o)],2))}});var l=s(31619),c=s.n(l),d=s(83744);const u={};u.$style=c();const p=(0,d.Z)(r,[["__cssModules",u]])},96614:(t,e,s)=>{"use strict";s.d(e,{Z:()=>_});var i=s(66252),n=s(3577),a=s(2262),o=s(59870),r=s(93356);const l=["data-tab"],c=(0,i.aZ)({__name:"pkb-tab",props:{name:{}},setup(t){const e=t,{tab:s,setTab:c,type:d}=(0,r.D3)(o.SC);return(t,o)=>((0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)({[t.$style.host]:!0,[t.$style.active]:e.name===(0,a.SU)(s),[t.$style.rounded]:"rounded"===(0,a.SU)(d),[t.$style.roundedCompact]:"rounded-compact"===(0,a.SU)(d)}),"data-tab":e.name,onClick:o[0]||(o[0]=t=>(0,a.SU)(c)(e.name))},[(0,i.WI)(t.$slots,"default")],10,l))}});var d=s(37335),u=s.n(d),p=s(83744);const h={};h.$style=u();const _=(0,p.Z)(c,[["__cssModules",h]])},78373:(t,e,s)=>{"use strict";s.d(e,{Z:()=>p});var i=s(66252),n=s(3577),a=s(2262),o=s(59870);const r=(0,i.aZ)({__name:"pkb-tabs",props:{modelValue:{},type:{default:"normal"}},emits:["update:modelValue"],setup(t,{emit:e}){const s=t,r=e,l=(0,i.Fl)({get:()=>s.modelValue,set:t=>r("update:modelValue",t)}),c=(0,a.iH)(),d=(0,a.qj)({left:void 0,width:void 0});function u(){const t=null!==(e=null===(s=c.value)||void 0===s?void 0:s.querySelector(`:scope > [data-tab="${l.value}"]`))&&void 0!==e?e:null;var e,s;d.left=t?`${t.offsetLeft}px`:void 0,d.width=t?`${t.offsetWidth}px`:void 0,c.value&&t&&(c.value.scrollLeft>t.offsetLeft||c.value.scrollLeft+c.value.clientWidth<t.offsetLeft+t.offsetWidth)&&(c.value.scrollLeft=t.offsetLeft-23)}return(0,i.YP)(l,(()=>(0,i.Y3)(u)),{immediate:!0}),(0,i.JJ)(o.SC,{tab:(0,a.OT)(l),setTab:function(t){l.value=t},type:(0,i.Fl)((()=>s.type))}),(t,e)=>((0,i.wg)(),(0,i.iD)("div",{ref_key:"hostEl",ref:c,class:(0,n.C_)({[t.$style.host]:!0,[t.$style.rounded]:"rounded"===s.type,[t.$style.roundedCompact]:"rounded-compact"===s.type}),style:(0,n.j5)({"--left":d.left,"--width":d.width,padding:`0 ${(0,a.SU)(23)}px`})},[(0,i.WI)(t.$slots,"default")],6))}});var l=s(79403),c=s.n(l),d=s(83744);const u={};u.$style=c();const p=(0,d.Z)(r,[["__cssModules",u]])},68578:(t,e,s)=>{var i=s(7912);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("58ea634c",i,!1,{})},28822:(t,e,s)=>{var i=s(37881);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("3615487a",i,!1,{})},25221:(t,e,s)=>{var i=s(63488);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("3b484b2c",i,!1,{})},57435:(t,e,s)=>{var i=s(24872);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("1188c010",i,!1,{})},69680:(t,e,s)=>{var i=s(95801);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("18596876",i,!1,{})},44848:(t,e,s)=>{var i=s(43805);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("2f1c29e0",i,!1,{})},32882:(t,e,s)=>{var i=s(16737);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("a3c578da",i,!1,{})},61709:(t,e,s)=>{var i=s(68978);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("3af62e32",i,!1,{})},11168:(t,e,s)=>{var i=s(75211);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("0f486957",i,!1,{})},91329:(t,e,s)=>{var i=s(35585);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("ac46eee8",i,!1,{})},46914:(t,e,s)=>{var i=s(31862);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("18a22a58",i,!1,{})},34728:(t,e,s)=>{var i=s(7825);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("91a95002",i,!1,{})},35164:(t,e,s)=>{var i=s(20593);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("3ac4de93",i,!1,{})},64417:(t,e,s)=>{var i=s(32095);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("26296293",i,!1,{})},93493:(t,e,s)=>{var i=s(57168);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("465a5c16",i,!1,{})},4261:(t,e,s)=>{var i=s(26566);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("03b94b42",i,!1,{})},77159:(t,e,s)=>{var i=s(37975);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("a0c35d4e",i,!1,{})},38531:(t,e,s)=>{var i=s(45749);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("082d9450",i,!1,{})},69524:(t,e,s)=>{var i=s(51118);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("3327e4ac",i,!1,{})},51559:(t,e,s)=>{var i=s(40360);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("7dec142d",i,!1,{})},23370:(t,e,s)=>{var i=s(80976);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("ac5e0e00",i,!1,{})},81026:(t,e,s)=>{var i=s(41767);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("853a139c",i,!1,{})},76425:(t,e,s)=>{var i=s(19828);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("05683051",i,!1,{})},13609:(t,e,s)=>{var i=s(53471);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("693777c6",i,!1,{})},40082:(t,e,s)=>{var i=s(77231);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("5d8a7899",i,!1,{})},63301:(t,e,s)=>{var i=s(73735);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("422f6a9e",i,!1,{})},1144:(t,e,s)=>{var i=s(87566);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("5ddaf561",i,!1,{})},83809:(t,e,s)=>{var i=s(44871);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("3758a6dc",i,!1,{})},42777:(t,e,s)=>{var i=s(92989);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("764c905c",i,!1,{})},88627:(t,e,s)=>{var i=s(275);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("73c7091c",i,!1,{})},49210:(t,e,s)=>{var i=s(6281);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("edd174e8",i,!1,{})},56058:(t,e,s)=>{var i=s(15944);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("6be53322",i,!1,{})},32406:(t,e,s)=>{var i=s(88024);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("0aa972d0",i,!1,{})},7996:(t,e,s)=>{var i=s(74219);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("35f02c31",i,!1,{})},33742:(t,e,s)=>{var i=s(62968);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("7a087a89",i,!1,{})},17430:(t,e,s)=>{var i=s(89256);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("342518f6",i,!1,{})},98259:(t,e,s)=>{var i=s(59811);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("35113cf1",i,!1,{})},83157:(t,e,s)=>{var i=s(27300);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("30d2907d",i,!1,{})},4177:(t,e,s)=>{var i=s(20697);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("72fe37ee",i,!1,{})},35834:(t,e,s)=>{var i=s(70986);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("354b0e74",i,!1,{})},29436:(t,e,s)=>{var i=s(10289);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("caa248c0",i,!1,{})},2694:(t,e,s)=>{var i=s(15549);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("3413e7b8",i,!1,{})},89244:(t,e,s)=>{var i=s(21666);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("2b8c5c14",i,!1,{})},88779:(t,e,s)=>{var i=s(60989);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("b63ba56c",i,!1,{})},55187:(t,e,s)=>{var i=s(2842);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("127af52c",i,!1,{})},34346:(t,e,s)=>{var i=s(49246);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("970571f6",i,!1,{})},28093:(t,e,s)=>{var i=s(9773);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("7c112072",i,!1,{})},21649:(t,e,s)=>{var i=s(54954);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("2959f29f",i,!1,{})},96458:(t,e,s)=>{var i=s(55028);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("544dae8b",i,!1,{})},33787:(t,e,s)=>{var i=s(8653);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("00e64cf5",i,!1,{})},45117:(t,e,s)=>{var i=s(32196);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("e9a5912c",i,!1,{})},23200:(t,e,s)=>{var i=s(18062);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("9d6f285c",i,!1,{})},51514:(t,e,s)=>{var i=s(87170);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("22334fb6",i,!1,{})},13521:(t,e,s)=>{var i=s(84177);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("2cf47cf4",i,!1,{})},23441:(t,e,s)=>{var i=s(30400);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("81a88204",i,!1,{})},46478:(t,e,s)=>{var i=s(70266);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("15514bca",i,!1,{})},31619:(t,e,s)=>{var i=s(95418);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("63d54632",i,!1,{})},84588:(t,e,s)=>{var i=s(29719);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("2adb34d0",i,!1,{})},37335:(t,e,s)=>{var i=s(80744);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("6ad671fc",i,!1,{})},79403:(t,e,s)=>{var i=s(32365);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(54402).Z)("ec3773b4",i,!1,{})}},t=>{t.O(0,[522,583,216,143],(()=>{return e=80687,t(t.s=e);var e}));t.O()}]);