(self.webpackChunkpikabu=self.webpackChunkpikabu||[]).push([[143],{12411:(e,t,s)=>{"use strict";function i(e){return'<div class="awarning">\n\t<h4>Привет!</h4>\n\t<p>Работа блокировщиков рекламы может приводить к нестабильной работе сайта. В данный момент мы делаем всё возможное для минимизации последствий, но не можем гарантировать их полное исчезновение</p>\n\t<div class="awarning__buttons">\n\t\t<button class="pkb-normal-btn awarning__button" data-role="close">Буду знать</button>\n\t\t<a href="/go/about_recl" class="pkb-normal-btn pkb-normal-btn_border awarning__button" data-role="moreinfo" target="_blank">Подробнее</a>\n\t</div>\n</div>\n','<div class="awarning">\n\t<h4>Привет!</h4>\n\t<p>Работа блокировщиков рекламы может приводить к нестабильной работе сайта. В данный момент мы делаем всё возможное для минимизации последствий, но не можем гарантировать их полное исчезновение</p>\n\t<div class="awarning__buttons">\n\t\t<button class="pkb-normal-btn awarning__button" data-role="close">Буду знать</button>\n\t\t<a href="/go/about_recl" class="pkb-normal-btn pkb-normal-btn_border awarning__button" data-role="moreinfo" target="_blank">Подробнее</a>\n\t</div>\n</div>\n'}s.d(t,{Z:()=>i})},75223:(e,t,s)=>{"use strict";function i(e){return'<svg height="100" width="400" viewBox="0 0 400 100">\n    <rect role="presentation" x="0" y="0" width="100%" height="100%" clip-path="url(#nh03ye-diff)"\n          style="fill: url(#animation-comment);"/>\n    <defs role="presentation">\n        <clipPath id="nh03ye-diff">\n            <rect x="0" y="7" rx="3" ry="3" width="25" height="6"/>\n            <circle cx="45" cy="10" r="10"/>\n            <rect x="65" y="7" rx="3" ry="3" width="100" height="6"/>\n            <rect x="0" y="30" rx="3" ry="3" width="400" height="6"/>\n            <rect x="0" y="50" rx="3" ry="3" width="340" height="6"/>\n            <rect x="0" y="70" rx="3" ry="3" width="380" height="6"/>\n            <rect x="0" y="94" rx="3" ry="3" width="50" height="6"/>\n        </clipPath>\n        <linearGradient id="animation-comment">\n            <stop offset="-1.43361" stop-color="#a1a1a1" stop-opacity="1">\n                <animate attributeName="offset" values="-2; -2; 1" keyTimes="0; 0.25; 1" dur="2s"\n                         repeatCount="indefinite"/>\n            </stop>\n            <stop offset="-0.433612" stop-color="#ecebeb" stop-opacity="1">\n                <animate attributeName="offset" values="-1; -1; 2" keyTimes="0; 0.25; 1" dur="2s"\n                         repeatCount="indefinite"/>\n            </stop>\n            <stop offset="0.566388" stop-color="#a1a1a1" stop-opacity="1">\n                <animate attributeName="offset" values="0; 0; 3" keyTimes="0; 0.25; 1" dur="2s"\n                         repeatCount="indefinite"/>\n            </stop>\n        </linearGradient>\n    </defs>\n</svg>','<svg height="100" width="400" viewBox="0 0 400 100">\n    <rect role="presentation" x="0" y="0" width="100%" height="100%" clip-path="url(#nh03ye-diff)"\n          style="fill: url(#animation-comment);"/>\n    <defs role="presentation">\n        <clipPath id="nh03ye-diff">\n            <rect x="0" y="7" rx="3" ry="3" width="25" height="6"/>\n            <circle cx="45" cy="10" r="10"/>\n            <rect x="65" y="7" rx="3" ry="3" width="100" height="6"/>\n            <rect x="0" y="30" rx="3" ry="3" width="400" height="6"/>\n            <rect x="0" y="50" rx="3" ry="3" width="340" height="6"/>\n            <rect x="0" y="70" rx="3" ry="3" width="380" height="6"/>\n            <rect x="0" y="94" rx="3" ry="3" width="50" height="6"/>\n        </clipPath>\n        <linearGradient id="animation-comment">\n            <stop offset="-1.43361" stop-color="#a1a1a1" stop-opacity="1">\n                <animate attributeName="offset" values="-2; -2; 1" keyTimes="0; 0.25; 1" dur="2s"\n                         repeatCount="indefinite"/>\n            </stop>\n            <stop offset="-0.433612" stop-color="#ecebeb" stop-opacity="1">\n                <animate attributeName="offset" values="-1; -1; 2" keyTimes="0; 0.25; 1" dur="2s"\n                         repeatCount="indefinite"/>\n            </stop>\n            <stop offset="0.566388" stop-color="#a1a1a1" stop-opacity="1">\n                <animate attributeName="offset" values="0; 0; 3" keyTimes="0; 0.25; 1" dur="2s"\n                         repeatCount="indefinite"/>\n            </stop>\n        </linearGradient>\n    </defs>\n</svg>'}s.d(t,{Z:()=>i})},61308:(e,t,s)=>{"use strict";function i(e){var t="";Array.prototype.join;return t+='<div class="author-moderation-tools author-moderation-tools_loading">\n\t<div class="author-moderation-tools__loader">\n\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__preloader"><use xlink:href="#icon--ui__preloader"></use></svg>\n\t</div>\n\t<div class="popup-menu__item author-moderation-tools__temporary">\n\t\t',t+='\n\t\t<div class="popup-menu__label">Заблокировать на 7 дней</div>\n\t</div>\n\t<div class="popup-menu__item author-moderation-tools__permanent">\n\t\t',t+='\n\t\t<div class="popup-menu__label">Навсегда</div>\n\t</div>\n</div>\n'}s.d(t,{Z:()=>i})},63326:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var i=s(36005);function o(e){var t="",o=i.escape;Array.prototype.join;const r=s(30381);t+='\n<div class="mt__tags-title">История редактирование тегов</div>\n<div class="mt__tags-history">\n\t';for(let s=0;s<e.length;s++){t+='\n\t\t<div class="mt__tags-history-item">\n\t\t\t<a class="user user_inline" href="/@'+o(e[s].moderator_name)+'">\n\t\t\t\t<span class="avatar avatar_small"><img src="'+o(e[s].moderator_avatar)+'"></span><span class="user__nick">'+o(e[s].moderator_name)+'</span>\n\t\t\t</a> <span class="caption">отредактировал</span> <span class="caption hint" aria-label="'+o(r(1e3*e[s].datetime).format("D MMMM YYYY [в] H:mm"))+'">'+o(r(1e3*e[s].datetime).fromNow())+'</span>\n\t\t\t<div class="mt__tags-history-list tags">\n\t\t\t\t';for(let i=0;i<e[s].oldTags.length;i++)t+='\n\t\t\t\t\t<div class="tags__tag">'+o(e[s].oldTags[i])+"</div>\n\t\t\t\t";t+="\n\t\t\t\t";for(let i=0;i<e[s].removedTags.length;i++)t+='\n\t\t\t\t\t<div class="tags__tag tags__tag_removed hint" aria-label="Тег был удалён">'+o(e[s].removedTags[i])+"</div>\n\t\t\t\t";t+="\n\t\t\t\t";for(let i=0;i<e[s].addedTags.length;i++)t+='\n\t\t\t\t\t<div class="tags__tag tags__tag_added hint" aria-label="Тег был добавлен">'+o(e[s].addedTags[i])+"</div>\n\t\t\t\t";t+="\n\n\t\t\t</div>\n\t\t</div>\n\t"}return t+="\n</div>"}},94620:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var i=s(36005);function o(e){var t="";return t+='<div class="mt__popup-cnt mt__popup-cnt_center">\n\t'+(0,i.escape)(e)+"\n</div>"}},14025:(e,t,s)=>{"use strict";s.d(t,{DT:()=>d,_1:()=>S,PG:()=>h,Qp:()=>O});s(88674);var i=s(53056),o=s(70017),r=s(12950),n=s(12953);const a=[{code:"hot10",points:10,name:"Любитель погорячее",description:"Просмотреть 10 постов в Горячем или Лучшем"},{code:"new10",points:10,name:"Любитель посвежее",description:"Просмотреть 10 постов в Свежем"},{code:"open5",points:10,name:"Первооткрыватель",description:"Открыть 5 постов"},{code:"sites",points:10,name:"А что вы ещё умеете?",description:"Посетить разделы Промокоды и Скидки"},{code:"end",points:10,name:"Отлично, всё прочитано!",description:"Дойти до конца ленты Горячего или Лучшего"},{code:"share",points:10,name:"От всей души",description:"Поделиться постом в соцсетях"},{code:"read100",points:10,name:"Свой уютный уголок",description:"Прочитать 100 постов из своего раздела подписок"},{code:"registr",points:5,name:"Дратути",description:"Зарегистрироваться на Пикабу"},{code:"myself",points:10,name:"Поговорим обо мне...",description:'Заполнить раздел "О себе" в профиле'},{code:"custom",points:10,name:"Во всей красе",description:"Загрузить аватарку и фон профиля"},{code:"3com",points:10,name:"Принимайте в лигу",description:"Подписаться на 3 сообщества"},{code:"3tag",points:10,name:"Да здравствуют теги!",description:"Подписаться на 3 тега"},{code:"5authors",points:10,name:"Буду следить за вашими успехами",description:"Подписаться на 5 пользователей"},{code:"1stcom",points:15,name:"Начало положено",description:"Оставить первый комментарий"},{code:"1thread",points:25,name:"Первый пошел!",description:"Написать первый пост"}],l={"промокоды":"promo","скидки":"skidki"},c="pkb_ach_gain_v2";class d{static async sendEvent(e,t){if(!n.core.isUserAuthorized)return;const s=`/ajax/achievements/check?code=${e}`+(t?"&"+d.parseParams(t):""),{response:i}=await r.cf.post(s);i.result&&(["sites","read100","open5","hot10","new10"].includes(e)||this.showNotification(e),["sites","read100"].includes(e)||this.isGained(e)||this.setGained(e))}static parseParams(e){const t=e=>null===e||"object"!=typeof e&&"function"!=typeof e;return e&&"object"==typeof e?Object.keys(e).map((s=>t(e[s])?encodeURIComponent(s)+"="+encodeURIComponent(e[s]):Array.isArray(e[s])?e[s].map((e=>t(e)?encodeURIComponent(s)+"[]="+encodeURIComponent(e):null)).filter((e=>e)).join("&"):void 0)).filter((e=>e)).join("&"):""}static showNotification(e){const t=a.find((t=>t.code===e));t&&!this.isGained(e)&&new S(t)}static checkNewAchievementsFromCookie(){const e=o.e.get("lga");if(!e)return;const t=setTimeout((()=>{this.showNotification(e),o.e.remove("lga"),window.removeEventListener("beforeunload",s),window.removeEventListener("popstate",s)}),2e3),s=()=>{t&&clearTimeout(t)};window.addEventListener("beforeunload",s),window.addEventListener("popstate",s)}static isGained(e){return this.getGained().includes(e)}static getAllGained(){try{return JSON.parse(i.m.get(c)||"{}")}catch(e){return{}}}static getGainedUserKey(){return n.core.initParams.userName||"guest"}static getGained(){const e=this.getAllGained(),t=this.getGainedUserKey();return e[t]?e[t].split(","):[]}static setGained(e){const t=this.getGained();t.push(e);const s=this.getAllGained();s[this.getGainedUserKey()]=t.join(","),i.m.set(c,JSON.stringify(s))}static initSitesEventLinks(e){e.forEach((e=>{const t=e.text.trim().toLowerCase();l[t]&&e.addEventListener("mousedown",(()=>{d.sendEvent("sites",{site:l[t]})}),{once:!0})}))}}s(41817);var u=s(20446);const p=[{code:"open5",limit:5,key:"pkb_ach_open5",screen:[u.dt.POST],points:10,name:"Первооткрыватель",description:"Открыть 5 постов",oncePerPage:!0},{code:"hot10",limit:10,key:"pkb_ach_hot10",screen:[u.dt.HOT,u.dt.BEST],points:10,name:"Любитель погорячее",description:"Просмотреть 10 постов в Горячем или Лучшем",oncePerPage:!1},{code:"new10",limit:10,key:"pkb_ach_new10",screen:[u.dt.NEW],points:10,name:"Любитель посвежее",description:"Просмотреть 10 постов в Свежем",oncePerPage:!1}];class h{static setViewed(e){p.forEach((t=>{var s;if(!t.screen.includes(n.core.ui.screen)||t.oncePerPage&&this.onceViewed.includes(t.code))return;const o=(null===(s=i.m.get(t.key))||void 0===s?void 0:s.split(",").map((e=>Number(e))))||[];o.length>=t.limit?d.isGained(t.code)||this.saveAchievement(t):(o.includes(e)||(o.push(e),t.oncePerPage&&this.onceViewed.push(t.code)),i.m.set(t.key,o.join(",")),o.length===t.limit&&this.saveAchievement(t))}))}static saveAchievement(e){n.core.isUserAuthorized&&d.sendEvent(e.code)}}var _,m,g;_=h,g=[],(m=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(m="onceViewed"))in _?Object.defineProperty(_,m,{value:g,enumerable:!0,configurable:!0,writable:!0}):_[m]=g;var v=s(43241);var f=s(42107),y=s(87864);function b(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function w(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?b(Object(s),!0).forEach((function(t){k(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):b(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function k(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class S extends v.u{constructor(e){super(e),this.show()}render(){var e,t,s;return this.el=(0,y.m)((t=this._options,""+'<div class="achievement-notification">\n\t<div class="achievement-notification__close"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__close_16"><use xlink:href="#icon--ui__close_16"></use></svg></div>\n\t<div class="achievement-notification__icon">\n\t\t<div class="achievement__icon">\n\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--achievements__bg"><use xlink:href="#icon--achievements__bg"></use></svg>\n\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--achievements__'+(null==(s=t.code)?"":s)+'"><use xlink:href="#icon--achievements__'+(null==(s=t.code)?"":s)+'"></use></svg>\n\t\t</div>\n\t</div>\n\t<div class="achievement-notification__text">\n\t\t<p class="achievement-notification__header">\n\t\t\t«'+(null==(s=t.name)?"":s)+'» – получено!\n\t\t\t<span class="achievement-notification__points">+'+(null==(s=t.points)?"":s)+'</span>\n\t\t</p>\n\t\t<p class="achievement-notification__description">\n\t\t\t'+(null==(s=t.description)?"":s)+'. <a href="/achievements">Все достижения</a>\n\t\t</p>\n\t</div>\n</div>\n')),document.body.appendChild(this.el),f.cp.getInstance().sendEvent("form_show",w({type:"achievement_granted"},this.analyticsParams)),null===(e=this.el.querySelector(".achievement-notification__close"))||void 0===e||e.addEventListener("click",(()=>{this.hide()})),setTimeout((()=>this.hide()),7e3),super.render()}hide(){return f.cp.getInstance().sendEvent("form_close",w({type:"achievement_granted"},this.analyticsParams)),super.hide()}get analyticsParams(){var e;return{reason:this._options.code||"",level:Number((null===(e=document.querySelector(".sidebar-achievements"))||void 0===e?void 0:e.dataset.level)||0)}}}class O extends v.u{render(){var e,t,s;return null===(e=this.$el)||void 0===e||e.find(".achievements-progress").on("click",(()=>{f.cp.getInstance().sendEvent("click",{button:"achievements_progress",component_name:"sidebar",type:"gamification"})})),null===(t=this.$el)||void 0===t||t.find(".sidebar-achievements__slider").on("click",(e=>{var t,s;const i=e.currentTarget.classList.contains("sidebar-achievements__slider_down"),o=null===(t=this.$el)||void 0===t?void 0:t.find(".sidebar-achievements__list");var r,n,a,l;(f.cp.getInstance().sendEvent("click",{button:i?"expand_achievements":"collapse_achievements",component_name:"sidebar",type:"gamification",level:Number(null===(s=this.el)||void 0===s?void 0:s.dataset.level)}),i)?(o&&o.slideDown(),null===(r=this.$el)||void 0===r||r.find(".sidebar-achievements__slider_down").hide(),null===(n=this.$el)||void 0===n||n.find(".sidebar-achievements__slider_up").show()):(o&&o.slideUp(),null===(a=this.$el)||void 0===a||a.find(".sidebar-achievements__slider_down").show(),null===(l=this.$el)||void 0===l||l.find(".sidebar-achievements__slider_up").hide())})),null===(s=this.$el)||void 0===s||s.find(".achievement").on("click",(e=>{var t;f.cp.getInstance().sendEvent("click",{button:"achievement_icon",component_name:"sidebar",type:"gamification",reason:e.currentTarget.dataset.code,level:Number(null===(t=this.el)||void 0===t?void 0:t.dataset.level)})})),super.render()}}},12182:(e,t,s)=>{"use strict";s.d(t,{Q:()=>k});s(66992),s(33948),s(41817),s(74916),s(12953);var i=s(5603),o=s(95593),r=s(57852),n=s(90312),a=s(96637),l=s(53963);const c=l.HQ.getDateNow.bind(l.HQ);var d=s(34608),u=s(27478);const p=s(19755),h="[id^=adfox]",_=new Set([r.L.RIGHT_LAST,r.L.UNDER_COMMENTS]),m=[1810996,1904509],g=Symbol();let v;const f=0,y=1,b=2,w=3;class k{constructor(e){if(g!==e)throw new Error("Cannot construct singleton");this._isAdblockEnabled=(0,d.Ih)(),this._adShowObserver=null,this._items=new WeakMap,i.v&&(this._adShowObserver=new IntersectionObserver((e=>{e.forEach((e=>{const t=e.target,s=this._items.get(t);s&&(s.isVisibleForView=e.isIntersecting&&e.intersectionRatio>=u.nT,s.isVisibleForRedeemedView=e.isIntersecting&&e.intersectionRatio>=u.CX,this._handleVisibilityChange(s),s.isLoaded||this._togglePlaceholderAnimation(s,e.isIntersecting))}))}),{threshold:[u.nT,u.CX]}));const t=window.addAnlTracker;(void 0===t||Array.isArray(t))&&(null==t||t.forEach((([e,t])=>this.watch(e,t))),window.addAnlTracker=Object.freeze({push([e,t]){this.watch(e,t)}})),window.addEventListener("message",(e=>{var t,s;if(e.origin!==location.origin||"pkb:adfox-request"!==(null===(t=e.data)||void 0===t?void 0:t.event)&&"pkb:adfox-load"!==(null===(s=e.data)||void 0===s?void 0:s.event))return;let i,o=document.getElementById(e.data.id);if(o){do{i=this._items.get(o),o=o.parentElement}while(o&&!i);i&&("pkb:adfox-load"===e.data.event&&this._setAdfoxTypeParam(i),this._sendAnalytics("pkb:adfox-request"===e.data.event?"ad_request":"ad_load",i.params))}}))}watch(e,t){p(e).each(((e,s)=>{this._items.has(s)||this._attachHandlers(s,t)}))}unwatch(e){p(e).each(((e,t)=>{this._detachHandlers(t)}))}reload(e){var t;null!==(t=window.Ya)&&void 0!==t&&t.adfoxCode&&p(e).each(((e,t)=>{var s,i;if(!t.adType)return;const o=this._items.get(t);if(o&&o.viewStage<b)return;const r=null===(s=null!==(i=t.querySelector(h))&&void 0!==i?i:t)||void 0===s?void 0:s.id;window.Ya.adfoxCode.reload(r),window.adInfoStorage.add(r),this._detachHandlers(t),this._attachHandlers(t,t.adType),t._loadCount=(parseInt(t._loadCount)||1)+1,this._items.get(t).params.loadCount=t._loadCount}))}_handleVisibilityChange(e){e.isVisibleForView&&(e.isLoaded||this._checkAdIsLoaded(e),this._sendShowAnalytics(e)),!e.isLoaded&&e.viewStage<=y?this._watchAdLoading(e,e.isVisibleForView):e.viewStage===b&&this._watchRedeemedView(e,e.isVisibleForRedeemedView)}_setAdfoxTypeParam(e){if(!window.adfoxBlocks||!window.adfoxBlocks[e.params.adId])return;const t=window.adfoxBlocks[e.params.adId];switch(t.type){case"banner.native":case"banner.direct":e.params.mode=r.A.YANDEX;break;case"bid":e.params.mode=r.A.BIDS;break;case"banner.image":e.params.mode=t.campaignId&&m.includes(t.campaignId)?r.A.PROMO:r.A.DIRECT}}_attachHandlers(e,t){if(this._items.has(e))return;e.adType=(0,o.i)(r.L,t)||r.L.FEED,this._adShowObserver&&this._adShowObserver.observe(e);const s=this._getParams(e),i=()=>{this._sendAnalytics("click_ad",s),e.removeEventListener("click",i,{capture:!0,once:!0})};e.addEventListener("click",i,{capture:!0,once:!0});this._items.set(e,{detach:()=>{this._items.delete(e),this._adShowObserver.unobserve(e),e.removeEventListener("click",i,{capture:!0,once:!0})},params:s,viewStage:f,isRedeemed:!1,isLoaded:!1})}_detachHandlers(e){if(!this._items.has(e))return;const{detach:t}=this._items.get(e);null==t||t()}_sendAnalytics(e,t){const{adType:s,createAt:i,adId:o,userRate:r,typeI8:a,link:l,postId:c,screenIndex:d,adCode:u,loadCount:p,promoId:h,mode:_}=t,m={type:s,"create_at!empty":i,"post_id!empty":c,"screen_index!empty":d,"user_rate!empty":r||"","content_type!empty":o,"type_i8!empty":a,"link!empty":l,"ad_params!empty":u,mode:_,level:p};h&&(m.promo_id=h),n.c.getInstance().sendEvent(e,m)}static getScreenIndex(e){if(!e)return 0;const t=document.evaluate("//comment()",document,null,XPathResult.ANY_TYPE,null);let s=t.iterateNext(),i=[];const o=/story_\d+_end/,r=`story_ad_${e}_end`;for(;s;)(o.test(s.data)||s.data.includes(r))&&i.push(s.data),s=t.iterateNext();return i.findIndex((t=>t.includes(e)))}static get instance(){return v||(v=new k(g),v)}_watchAdLoading(e,t){if(e.isLoaded)return;const s=`${e.params.storageAdId}_load`;t?this._timeout(s,1e3,(()=>{if(this._checkAdIsLoaded(e),e.isLoaded)this._sendShowAnalytics(e),e.isVisibleForRedeemedView&&this._watchRedeemedView(e,!0);else{if(Date.now()-e.params.createAt>6e4)return this._adShowObserver.unobserve(e.params.adWrapper),void this._togglePlaceholderAnimation(e,!1);this._watchAdLoading(e,!0)}})):this._cancelTimeout(s)}_watchRedeemedView(e,t){const s=`${e.params.storageAdId}_redeemed_view`;t?this._timeout(s,u.Pd,(()=>{this._adShowObserver.unobserve(e.params.adWrapper),e.isRedeemed=!0,this._sendShowAnalytics(e)})):this._cancelTimeout(s)}_sendShowAnalytics(e){e.isLoaded||e.viewStage||!e.isVisibleForView?e.isLoaded&&e.viewStage<b&&e.isVisibleForView?(e.params.userRate=1,this._sendAnalytics("show_ad",e.params),e.viewStage=b):e.isRedeemed&&e.viewStage!==w&&e.isVisibleForRedeemedView&&(this._sendAnalytics("redeemed_ad_showed",e.params),e.viewStage=w):(e.params.userRate=0,e.params.createAt=c(),this._sendAnalytics("show_ad",e.params),e.viewStage=y)}_checkAdIsLoaded(e){var t;!e.isLoaded&&null!==(t=window.adInfoStorage)&&void 0!==t&&t.has(e.params.storageAdId)&&(window.adInfoStorage.delete(e.params.storageAdId),e.isLoaded=!0,this._setAdfoxTypeParam(e),this._togglePlaceholderAnimation(e,!1))}_timeout(e,t,s,i=!0){return i&&this._cancelTimeout(e),this._timeoutList||(this._timeoutList=new Map),this._timeoutList.set(e,setTimeout(s.bind(this),t)),this}_cancelTimeout(...e){return this._timeoutList&&this._timeoutList.size?(e.length?e.forEach((e=>{this._timeoutList.has(e)&&(clearTimeout(this._timeoutList.get(e)),this._timeoutList.delete(e))})):(this._timeoutList.values().forEach((e=>clearTimeout(e))),this._timeoutList.clear()),this):this}_getParams(e){var t;const s=e.querySelector(h)||e,i=s.id||(null===(t=s.querySelector(h))||void 0===t?void 0:t.id),o=i,r=e.adType,n=e.dataset.storyId;let l="",c="";if(Boolean(e.querySelector('a[href^="https://ads.adfox.ru/260477/"]'))){var d;if(c=null===(d=s.querySelector("img"))||void 0===d?void 0:d.src,!c){var u;const e=s.querySelector("a");c=null==e||null===(u=e.style.backgroundImage)||void 0===u?void 0:u.split(/"/)[1]}l=1}const p=a.Utils.getStoryIdFromUrl(),m=s.dataset.code;let g=k.getScreenIndex(n);g=g>0?g:"";return{adWrapper:e,adElement:s,adId:i,adType:r,articleId:n,typeI8:l,link:c,postId:p,screenIndex:g,storageAdId:o,adCode:m,loadCount:_.has(r)?1:void 0,promoId:s.dataset.promoId}}_togglePlaceholderAnimation(e,t){this._isAdblockEnabled||(t?e.params.adWrapper.style.setProperty("--animations-state","running"):e.params.adWrapper.style.removeProperty("--animations-state"))}}},27478:(e,t,s)=>{"use strict";s.d(t,{CX:()=>n,PM:()=>i,Pd:()=>o,nT:()=>r});const i="pkb_vk",o=2e3,r=0,n=.5},57852:(e,t,s)=>{"use strict";let i,o;s.d(t,{A:()=>o,L:()=>i}),function(e){e.BANNER="banner",e.FEED="feed",e.RIGHT="right",e.RIGHT_LAST="right_last",e.COMMENTS="comments",e.UNDER_COMMENTS="under_comments",e.UNDER_POST="under_post",e.VIDEO_END="video_end",e.RECOM_FEED="feed_post_add",e.VIDEO_FEED="video_feed",e.UNDER_RELATED_POSTS="under_related_posts"}(i||(i={})),function(e){e.YANDEX="yandex",e.BIDS="header-bidding",e.DIRECT="direct",e.PROMO="promo"}(o||(o={}))},26251:(e,t,s)=>{"use strict";s.d(t,{o:()=>u});s(66992),s(33948),s(88674),s(12953);var i=s(96637),o=s(12950),r=s(27478),n=(s(44497),s(90312));const a=new Set,l=new Set;function c(e){let t=i.SessionStorage.get(r.PM);return t=Array.isArray(t)?t:[],!t.includes(e)&&(t.push(e),i.SessionStorage.set(r.PM,t),!0)}function d(e){const t=i.SessionStorage.get(r.PM);return(Array.isArray(t)?t:[]).includes(e)}class u{constructor(){throw new Error("Cannot construct singleton")}static isPlayVideo(e){return l.has(e)}static async setPlayVideo(e,t,s){if(u.isPlayVideo(t))return!0;l.add(t);const{response:i}=await o.cf.post("/ajax/save_click.php",{aid:t,sid:e,rsid:s});return i.result}static isClickReadMore(e){return a.has(e)}static async setClickReadMore(e,t,s){if(u.isClickReadMore(e))return!0;a.add(e);const{response:i}=await o.cf.post("/ajax/save_click.php",{aid:t,sid:e,t:"more",rsid:s});return i.result}static isViewed(e,t){return d(`V${e}${t}`)}static async setViewed(e,t){if(n.c.getInstance().yandex.goal("cpm_show_pс"),!c(`V${e}${t}`))return!0;const{response:s}=await o.cf.post("/ajax/save_view.php",{k:e,mv:void 0,rsid:t});return s.result}static isShortRead(e,t){return d(`R${e}${t}`)}static async setShortRead({adViewKey:e,referrerStoryId:t,isStoryPage:s}){if(!c(`R${e}${t}`))return!0;const i={k:e,mv:void 0,rsid:t};s&&(i.is_story_page=1);const{response:r}=await o.cf.post("/ajax/save_short_read.php",i);return r.result}}},88251:(e,t,s)=>{"use strict";s.d(t,{F:()=>n});s(66992),s(33948);var i=s(65448),o=s(16253),r=s(36005);class n extends o.vp{constructor(){super(),this._mask=0}static getBitFromEnumProperty(e){return e instanceof i.Tf?(0,r.isNumber)(e.index)?1<<e.index:0:e}set(e){return 0===(e=n.getBitFromEnumProperty(e))?this._mask:(this._mask|=e,this.emit("update",this),this)}has(e){return 0!==(e=n.getBitFromEnumProperty(e))&&(this._mask&e)===e}hasSome(...e){return(0,r.some)(e,(e=>this.has(e)))}remove(e){return e=n.getBitFromEnumProperty(e),this._mask=this._mask&~e,this.emit("update",this),this}toggle(e,t){let s=this.has(e);return!(t=(0,r.isBoolean)(t)?t:!s)&&s?this.remove(e):t&&!s?this.set(e):this}toEnums(e){let t=[];if(!(e instanceof i.xs))return t;for(let s of e.entries())this.has(s)&&t.push(s);return t}toString(){return String(this._mask)}valueOf(){return this._mask}static create(){return new n}}},98859:(e,t,s)=>{"use strict";s.d(t,{O:()=>i});const i=void 0!==((()=>{try{return"localStorage"in window&&Boolean(window.localStorage)}catch(e){return!1}})()?window.localStorage:void 0)},62520:(e,t,s)=>{"use strict";s.d(t,{l:()=>l});s(66992),s(33948),s(41817);var i=s(42107),o=s(19359);function r(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?r(Object(s),!0).forEach((function(t){a(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):r(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function a(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class l{static getInstance(){return l.instance||(l.instance=new l)}sendTagAnalytics({event:e,tag:t,proposal:s,createAt:o,story:r,extraParams:a={}}){i.cp.getInstance().sendEvent(e,n(n({tag:t,proposal:s,"create_at!empty":o},r.analyticsData),a))}sendAddedOrRemovedTagsAnalytics(e,t,s){const i=new Set(t);e.forEach(((e,t)=>{i.has(e)?i.delete(e):this.sendTagAnalytics(n(n({},s),{},{tag:e,proposal:o.a8.DELETE.value,createAt:Date.now()+50*t}))})),i.size>0&&[...i].forEach(((e,t)=>{this.sendTagAnalytics(n(n({},s),{},{tag:e,proposal:o.a8.ADD.value,createAt:Date.now()+100*t}))}))}}},48591:(e,t,s)=>{"use strict";s.d(t,{GG:()=>n,Qm:()=>o,ST:()=>r,zJ:()=>a});s(88674);var i=s(12950);async function o(e){return i.cf.postOrFail("/ajax.php",{route:"comment-subs/subscribe",comment_id:e})}async function r(e){return i.cf.postOrFail("/ajax.php",{route:"comment-subs/unsubscribe",comment_id:e})}async function n({page:e}){const{data:t}=await i.cf.postOrFail("/ajax.php",{route:"comment-subs/get-list",page:e});return t}async function a(e){return i.cf.postOrFail("/ajax.php",{route:"comment-subs/visit",comment_id:e})}},20794:(e,t,s)=>{"use strict";s.d(t,{s:()=>l});var i=s(12953),o=s(6393),r=s(26451),n=s(47994),a=s(95593);function l(e,t=!0,s={}){return!!i.core.checkAccessUserActions(t,s)&&(e.depth>=o.BE?(t&&i.core.ui.toasts.add("max-depth",{theme:r.K.DANGER,content:"comments.errors.max-depth"}),!1):e.ignoreType!==n.IV.COMMUNITY_IGNORES_YOU&&e.comments.commentsMeta.ignoreType!==n.IV.COMMUNITY_IGNORES_YOU||(t&&i.core.ui.toasts.add("ignore",{theme:r.K.WARNING,content:i.core.i18n("comments.ignore."+(0,a.S)(n.IV,e.ignoreType),e.ignoreCommunityName)}),!1))}},82959:(e,t,s)=>{"use strict";s.d(t,{B:()=>p});s(66992),s(33948),s(85827),s(41817);var i=s(12953),o=s(2439),r=s(89604),n=s(42512),a=s(6393),l=s(87864),c=s(10553),d=s(90312);function u(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class p extends o.v{constructor(e){super(),u(this,"items",[]),this.child=e}setInitData({isChildrenShown:e,$childrenContainer:t}){"boolean"==typeof e&&(this._isChildrenShown=e),t&&(this._$childrenContainer=t)}appendChild(e){this.items.push(e)}prependChild(e){this.items.unshift(e)}getChildHiddenGroupById(e){for(const t of this.items)if(t instanceof r.H&&t.id===e)return t}getChildCommentById(e){for(const t of this.items){if(t instanceof n.U&&t.id===e)return t;if(t instanceof r.H){const s=t.children.getChildCommentById(e);if(s)return s}}}getUnloadChildComments(e,t,s=!1,i=null){if(this.child.depth>=e)return[];const o=[];for(const a of this.items){if(a.isRendered&&s)break;if(a.isRendered&&a.isMounted||this.isOnlyHiddenGroupChildren&&!this.isRootComment||o.push(a),o.length>=t)break;if((!(a instanceof r.H)||a.children.isChildrenShown)&&(!(a instanceof n.U&&(a.children.isOnlyHiddenGroupChildren||a.isRendered&&!a.children.isChildrenShown&&a.id!==i))&&(o.push(...a.children.getUnloadChildComments(e,t-o.length,!1,i)),o.length>=t)))break}return o}mountChild(e){const t=this.items.length;let s=this.items.indexOf(e);if(-1!==s&&e.el){if(s>0&&s!==t-1)for(;--s>=0;){const t=this.items[s];if(null!=t&&t.isRendered){var i,o,r;let s=t.el;return null!==(i=s)&&void 0!==i&&null!==(o=i.nextElementSibling)&&void 0!==o&&o.classList.contains("comments__adv")&&(s=s.nextElementSibling),void(null===(r=s)||void 0===r||r.insertAdjacentElement("afterend",e.el))}}if(0!==s||this.isRootComment){const t=this.$childrenContainer.querySelector(":scope > .comment__close-branch, :scope > .comment__more");t?t.insertAdjacentElement("beforebegin",e.el):this.$childrenContainer.insertAdjacentElement("beforeend",e.el)}else{const t=this.$childrenContainer.querySelector(":scope > .comment__collapsing-area");t?t.insertAdjacentElement("afterend",e.el):this.$childrenContainer.insertAdjacentElement("afterbegin",e.el)}}}updateChildrenCount(){const e=this.$toggleChildren.classList.contains("comment-toggle-children_loading"),t=this.$toggleChildren.querySelector(".comment-toggle-children__label");!e&&t&&(t.innerHTML=this.toggleChildrenLabelText),this.$toggleChildren.classList.toggle("comment-toggle-children_highlight_yellow",this.childNewCount>0),this.$toggleChildren.hidden=0===this.childTotalCount&&!e}updateChildrenShown(e){if(this.isRootComment||!this.$childrenContainer)return;!this.$childrenContainer.isConnected&&this.child.el&&(this.child.el.append(this.$toggleChildren),this.child.el.append(this.$childrenContainer)),this.$childrenContainer.hidden=!e,this.$toggleChildren.classList.toggle("comment-toggle-children_collapse",!e);const t=this.isOnlyHiddenGroupChildren&&Boolean(this.items[0]);this.$toggleChildren.classList.toggle("comment-toggle-children_only-hidden",t),e&&t&&(this.items[0].render(),this.items[0].children.isChildrenShown=!0),e||this.updateChildrenCount()}get isRootComment(){return this.child instanceof n.U&&Boolean(this.child.isRoot)}get isOnlyHiddenGroupChildren(){return 1===this.items.length&&this.items[0]instanceof r.H}get childTotalCount(){return this.items.reduce(((e,t)=>e+t.children.childTotalCount+(t instanceof n.U?1:0)),0)}get childNewCount(){return this.items.reduce(((e,t)=>e+t.children.childNewCount+(t instanceof n.U&&t.isNewest?1:0)),0)}get toggleChildrenLabelText(){const e=this.childTotalCount,t=this.childNewCount;if(this.isOnlyHiddenGroupChildren)return i.core.i18n("comments.button.toggle-hidden-children",e);const s=e&&e===t?`+ ${t}`:e-t+(t?` + ${t}`:"");return i.core.i18n("comments.button.toggle-children",s)}get $childrenContainer(){var e;if(this._$childrenContainer)return this._$childrenContainer;if(this.child instanceof r.H){var t;const e=null===(t=this.child.el)||void 0===t?void 0:t.firstElementChild;return e instanceof HTMLElement&&e.classList.contains("comment-hidden-group__children")?e:this._$childrenContainer=(0,l.m)('<div class="comment-hidden-group__children"/>')}const s=null===(e=this.child.el)||void 0===e?void 0:e.lastElementChild;if(s instanceof HTMLElement&&s.classList.contains("comment__children"))return s;const i=this.child.indent===a.Iz?"comment__children_next-floor":"",o=(0,l.m)(`\n\t\t\t<div class="comment__children ${i}">\n\t\t\t\t<div class="comment__collapsing-area"></div>\n\t\t\t</div>\n\t\t`);return this.child.indent===a.Iz&&o.append((0,l.m)(`<div class="comment__close-branch">${(0,c.t)("ui__close","close-branch")}</div>`)),this._$childrenContainer=o}get $toggleChildren(){var e;if(this._$toggleChildren)return this._$toggleChildren;if(this.child instanceof r.H){var t;const e=null===(t=this.child.el)||void 0===t?void 0:t.querySelector(":scope > .comment-hidden-group__toggle");if(e instanceof HTMLElement)return e;const s=i.core.i18n("comments.button.toggle-hidden-group-children",this.items.length);return this._$toggleChildren=(0,l.m)(`<div class="comment-hidden-group__toggle">\n\t\t\t\t\t\t<div class="comment-toggle-children__icon">${(0,c.t)("comments__toggle")}</div>\n\t\t\t\t\t\t${s}\n\t\t\t\t</div>`)}const s=null===(e=this.child.el)||void 0===e?void 0:e.querySelector(":scope > .comment-toggle-children");if(s instanceof HTMLElement)return s;const o=[this.child.indent===a.Iz?"comment-toggle-children_next-floor":"",this.childNewCount>0?"comment-toggle-children_highlight_yellow":"",this.isChildrenShown?"":"comment-toggle-children_collapse",this.isOnlyHiddenGroupChildren?" comment-toggle-children_only-hidden":""].filter(Boolean).join(" ");return this._$toggleChildren=(0,l.m)(`\n\t\t\t\t<div class="comment-toggle-children ${o}">\n\t\t\t\t\t<div class="comment-toggle-children__icon">${(0,c.t)("comments__toggle")}</div>\n\t\t\t\t\t<div class="comment-toggle-children__label">${this.toggleChildrenLabelText}</div>\n\t\t\t\t</div>\n\t\t`)}get isChildrenShown(){return this._isChildrenShown||!1}set isChildrenShown(e){if(this._isChildrenShown!==e){if(this._isChildrenShown=e,this.child instanceof r.H)return this.$childrenContainer&&(this.$childrenContainer.hidden=!e),void(this.$toggleChildren&&(this.$toggleChildren.hidden=e));e||d.c.getInstance().yandex.goal("collapse-comments-branch"),this.updateChildrenShown(e)}}}},42512:(e,t,s)=>{"use strict";s.d(t,{U:()=>ye});s(85827),s(41817),s(88674),s(66992),s(33948);var i,o,r=s(12953),n=s(12950),a=s(2439),l=s(47994),c=s(95593),d=s(6393),u=s(19755),p=s.n(u),h=s(42107),_=s(89770),m=s(29845),g=s(58330),v=s(51540),f=s(62430),y=s(29084);function b(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}let w=(T=1e3,i=function(e,t,s){const i=s.value;if(e instanceof y.T){var o;const t=(0,f.O)(e);t.cancelable=null!==(o=t.cancelable)&&void 0!==o?o:new Set;const r=(0,v.P)((function(...e){this.isDestroyed||i.apply(this,e)}),T,I);return s.value=function(...e){this.isDestroyed||r.apply(this,e)},t.cancelable.add(r),s}return s.value=(0,v.P)(i,T,I),s},o=class e extends a.v{constructor(){super(),b(this,"mapStory",new WeakMap),b(this,"setNotVisitedStories",new Set);this.intersectionObserver=new IntersectionObserver(this.onIntersectionObserver.bind(this),{rootMargin:"0px",threshold:.5})}static getInstance(){return e.instance?e.instance:e.instance=new e}checkVisited(){if(this.setNotVisitedStories.size){for(const e of this.setNotVisitedStories){let t=e.isVisited,s=e.isViewed,i=!0;!t&&e.checkVisited()&&(e.isVisited=t=!0,_.C.setVisited({storyId:e.id,authorId:e.authorId,isSubscribed:e.isSubscribed}),i=!1),!s&&e.checkViewed()&&(e.isViewed=s=!0,m.N.setViewed({storyId:e.id,authorId:e.authorId,isSubscribed:e.isSubscribed},i)),t&&s&&(this.intersectionObserver.unobserve(e.el),this.setNotVisitedStories.delete(e))}this.checkVisited()}}onIntersectionObserver(e){e.forEach((e=>{const t=e.target,s=this.mapStory.get(t);s&&(s.inViewport=e.isIntersecting,s.isVisited&&s.isViewed||this.setNotVisitedStories.add(s))})),this.checkVisited()}addComstory(e){var t;const s=null===(t=e.el)||void 0===t?void 0:t.querySelector(".story");if(!s||this.mapStory.has(s))return;const i=s.getAttribute("data-story-id"),o=g.S.getInstance().get("Story");if(!o||"function"!=typeof o)throw new Error("not found Story in UIComponentsRegistry");const n=new o(i,s);this.mapStory.set(s,n);const a=p()(n.$readMore);a.on("click",(t=>{if(void 0===t.originalEvent)return;const s=n.isCollapsedLongStory;if(!s){var i,o;let t=null===(i=e.$el)||void 0===i||null===(o=i.offset())||void 0===o?void 0:o.top;if(t)r.core.ui.scrollTo(t)}a.find("span:first-child").text(r.core.i18n("comments.comstory."+(s?"collapse":"expand"))),n.isCollapsedLongStory=!s})),n.isVisited&&n.isViewed||this.intersectionObserver.observe(s),this.listenTo(e,"_destroy",(()=>{this.intersectionObserver.unobserve(s),n.destroy()}))}},k=o.prototype,S="checkVisited",O=[i],E=Object.getOwnPropertyDescriptor(o.prototype,"checkVisited"),C=o.prototype,x={},Object.keys(E).forEach((function(e){x[e]=E[e]})),x.enumerable=!!x.enumerable,x.configurable=!!x.configurable,("value"in x||x.initializer)&&(x.writable=!0),x=O.slice().reverse().reduce((function(e,t){return t(k,S,e)||e}),x),C&&void 0!==x.initializer&&(x.value=x.initializer?x.initializer.call(C):void 0,x.initializer=void 0),void 0===x.initializer&&(Object.defineProperty(k,S,x),x=null),o);var k,S,O,E,C,x,T,I,P=s(30381),A=s.n(P);const D=new WeakMap;function M(){return function(e,t,s){const i=s.value;return s.value=function(...e){const t=D.get(s);if(t)return t;const o=i.apply(this,e);return o instanceof Promise&&(D.set(s,o),o.then((()=>D.delete(s))).catch((()=>D.delete(s)))),o},s}}var R,N,B=s(56927),L=s(87864),j=s(90312),$=s(96430),U=s(33877);function F(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}let V=(R=(0,$.E)(700),function(e,t,s,i,o){var r={};Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=s.slice().reverse().reduce((function(s,i){return i(e,t,s)||s}),r),o&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(o):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null)}((N=class extends a.v{constructor(e){super(),F(this,"voteSync",l.OC.NONE),F(this,"_$ratingUp",null),F(this,"_$ratingDown",null),F(this,"_$ratingCount",null),F(this,"_$authorLike",null),F(this,"_vote",l.OC.NONE),this.comment=e}async syncVote(){if(await(0,U.g)(100),this.vote===this.voteSync)return;const{response:e}=await n.cf.post("/ajax/vote_comment.php",{comment_id:this.comment.id,vote:this.vote.valueOf()});e.result?this.voteSync=this.vote:(this.vote=this.voteSync||l.OC.NONE,r.core.logger.error("comments","bad sync vote",this.vote,"by comment",this.comment.id))}setVoteDirection(e){if(j.c.getInstance().yandex.goal("vote-for-comment"),j.c.getInstance().yandex.goal(e>0?"tap-comment-plus":"tap-comment-minus"),j.c.getInstance().google.event("evaluation","comment"),(e=this.vote+e)>l.OC.UP||e<l.OC.DOWN)return this.comment.comments.sendVoteAnalytics(this.vote,this.comment),void(this.vote=l.OC.NONE);this.comment.comments.sendVoteAnalytics(e,this.comment),this.vote=e}setInitData({vote:e,inputAmountVotes:t,inputRating:s}){this._vote=this.voteSync=e;let i=!1;if(t){const s=e===l.OC.UP,[o]=t.split(",").map(Number);i=s&&0===o,this.amountVotes=i?[o]:[o-(s?1:0)]}const o=Number(s);Number.isFinite(o)&&(this.rating=-1!==this.vote?o-(i?0:this.vote):o)}hasAuthorLike(){var e;return Boolean(null===(e=this.$authorLike)||void 0===e?void 0:e.classList.contains("comment__author-like_show"))}updateRating(){if(!this.$ratingUp||!this.$ratingDown||!this.$ratingCount)return;const e=this.rating,t=this.vote,s=t===l.OC.UP,i=t===l.OC.DOWN,o=this.$ratingDown.classList.contains("comment__rating-down_active");var n;(this.$ratingUp.classList.toggle("comment__rating-up_active",s),this.$ratingDown.classList.toggle("comment__rating-down_active",i),this.comment.comments.ui.meta.storyAuthorId===r.core.initParams.userID)&&(null===(n=this.$authorLike)||void 0===n||n.classList.toggle("comment__author-like_show",s));if(void 0!==e&&void 0!==t){if(!i){const s=e+t;if(s<=0)this.$ratingCount.innerHTML='<span class="comment__bull"></span>';else{if(o)return;this.$ratingCount.textContent=s.toString()}}if(this.amountVotes){const[e]=this.amountVotes,t=e+(s?1:0);this.$ratingCount.setAttribute("aria-label",t>0?r.core.i18n("comments.rating-hint",t):r.core.i18n("comments.rating-zero"));try{p()(this.$ratingCount).data("hint").destroy()}catch(a){}}}}get vote(){return this._vote}set vote(e){const t=this._vote;this.comment.isAuthorCurrentUser||(this._vote=e,void 0!==t?(e!==this.voteSync&&this.syncVote(),this.updateRating()):this.voteSync=e)}get $ratingUp(){return this._$ratingUp||!this.comment.$body?this._$ratingUp||null:this._$ratingUp=this.comment.$body.querySelector(".comment__rating-up")}get $ratingDown(){return this._$ratingDown||!this.comment.$body?this._$ratingDown||null:this._$ratingDown=this.comment.$body.querySelector(".comment__rating-down")}get $ratingCount(){return this._$ratingCount||!this.comment.$body?this._$ratingCount:this._$ratingCount=this.comment.$body.querySelector(".comment__rating-count")}get $authorLike(){var e;return this._$authorLike?this._$authorLike:this._$authorLike=null===(e=this.comment.$body)||void 0===e?void 0:e.querySelector(".comment__author-like")}}).prototype,"syncVote",[R],Object.getOwnPropertyDescriptor(N.prototype,"syncVote"),N.prototype),N);var H=s(96883),Z=s(8233);function z(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function q(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?z(Object(s),!0).forEach((function(t){W(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):z(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function W(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class G extends a.v{constructor(e){super(),W(this,"_$replyWrapper",null),W(this,"handleAddComment",(({id:e,content:t,analyticsParams:s})=>{var i,o,n;this.comment.addChildCommentByCurrentUser(e,t),this.emit("add"),H.d.send("leaveComment",q(q({postId:this.storyId,authorId:this.comment.comments.commentsMeta.storyAuthorId,commentAuthorId:this.comment.authorId,commentId:this.comment.id},r.core.initParams.isReputationClient&&{type:"company"}),{},{level:this.comment.depth+1,comments:this.comment.comments.ui.isFullTree?this.comment.comments.items.length:void 0,typeI8:this.comment.comments.ui.isFullTree?this.comment.comments.ui.story.subsCode:void 0,postDonation:null===(i=this.comment.comments)||void 0===i||null===(o=i.ui.story)||void 0===o||null===(n=o.donationButton)||void 0===n?void 0:n.length},s||{})),B.z.getInstance().init(),this.hide()})),W(this,"handleEditComment",(({id:e,content:t})=>{r.core.emit("comment_edit",{id:e,content:t}),this.comment.updateHtmlAfterEdit(t),B.z.getInstance().init(),this.hide()})),W(this,"handleDuplicateReportTrigger",(()=>{this.comment.comments.ui.story.contextMenuPopup.showDuplicateReportModal()})),this.comment=e,this._isReplyShown=!1}async lock(e){this.isReplyShown&&(await this.initEditor()).lock(e)}async show(e){if(this.isReplyShown)return;this.isReplyShown=!0;const t=await this.initEditor();t.setMode("create"===e?l.tT.CREATE:l.tT.EDIT),await(0,Z.y)(),this.$replyWrapper.hidden=!1,this.updateReplyPosition(),this.updateCommentShift(!0),this.comment.controls.updateControls(),this.toggleContent(!0),t.show()}async hide(){if(this.comment.isRoot||!this.isReplyShown)return;this.isReplyShown=!1;const e=await this.initEditor();this.$replyWrapper.hidden=!0,this.updateCommentShift(!1),this.comment.controls.updateControls(),this.toggleContent(!1),e.hide()}async insertBlockquote(e){this.isReplyShown&&(await this.initEditor()).insertBlockquote(e)}hasUnsavedChanges(){var e,t;return!this.comment.isRoot&&this.isReplyShown&&this.createModeActive()&&!(null!==(e=this._editor)&&void 0!==e&&e.isDraftSaved())&&!(null!==(t=this._editor)&&void 0!==t&&t.isEmpty())}createModeActive(){var e;return(null===(e=this._editor)||void 0===e?void 0:e.getMode())===l.tT.CREATE}editModeActive(){var e;return(null===(e=this._editor)||void 0===e?void 0:e.getMode())===l.tT.EDIT}updateReplyPosition(){this.comment.isRoot||(this.comment.isEditable&&this.editModeActive()?this.comment.controls.$controls.insertAdjacentElement("beforebegin",this.$replyWrapper):this.comment.controls.$controls.insertAdjacentElement("afterend",this.$replyWrapper))}async createVueApp(){await(0,Z.y)();const{createApp:e}=await s(66338),t=!this.comment||this.comment.isStoryComment?0:this.comment.id;await(0,Z.y)();const i=e({root:this.comment.id===d.iM,parentId:t,parentIds:this.getParentIds(t),commentId:this.comment.id,storyId:this.storyId,authorUserName:this.comment.authorUserName,storyAuthorId:this.comment.commentsMeta.storyAuthorId,storyAuthorUserName:this.comment.commentsMeta.storyAuthorUserName,official:this.comment.comments.commentsMeta.canReplyOfficially,ignoreTypes:[this.comment.ignoreType,this.comment.comments.commentsMeta.ignoreType],baseAnalyticsParams:this.comment.comments.ui.getBaseAnalyticsParameters(this.comment),canPostAdCaptions:this.comment.comments.commentsMeta.canPostAdCaptions,canReplyAnonymously:this.comment.comments.commentsMeta.canReplyAnonymously,handleCloseComment:()=>this.hide(),handleAddComment:this.handleAddComment,handleEditComment:this.handleEditComment,handleDuplicateReportTrigger:this.handleDuplicateReportTrigger});return await(0,Z.y)(),this._editor=i.mount(this.$replyWrapper),this._editor}async initEditor(){return this._editorPromise?this._editorPromise:this._editorPromise=this.createVueApp()}updateCommentShift(e){}toggleContent(e){this.comment.$content&&(this.comment.$content.hidden=e&&this.comment.isEditable&&this.editModeActive())}getParentIds(e){const t=[];let s=e,i=this.comment.comments.get(s);for(;s&&s!==d.iM&&i;)t.push(s),s=i.parent.id,i=this.comment.comments.get(s);return t.reverse()}get storyId(){return this.comment.comments.commentsMeta.storyId}get isReplyShown(){return this._isReplyShown}set isReplyShown(e){this._isReplyShown=e}get $replyWrapper(){if(this._$replyWrapper)return this._$replyWrapper;const e=this._$replyWrapper=document.createElement("div");return e.classList.add("comment__reply-wrapper"),e}set $replyWrapper(e){this._$replyWrapper=e}}function Y(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class K extends a.v{constructor(e){super(),Y(this,"_$toolBranch",null),Y(this,"_$toolFromParent",null),Y(this,"_$toolToggleBranch",null),this.comment=e}async toggleToolParent(e,t=!0){const s=this.comment.parentComment;if(s&&s.branchTools.$toolFromParent&&(s.branchTools.$toolFromParent.hidden=!e),!e&&t)return await this.comment.scrollTo(!0),void this.comment.highlight("green",!0,!0);e&&s&&(await s.scrollTo(!0),s.highlight("green",!0,e))}get branchIds(){const e=[];let t=this.comment;if(this.comment.children.items.length){this.comment.children.$childrenContainer.querySelectorAll(".comment").forEach((t=>e.push(t.getAttribute("data-id"))))}let s=100;for(;t&&!t.isRoot&&t.parentComment&&s--;)e.push(t.id),t=t.parentComment;return e}get $toolBranch(){return this._$toolBranch?this._$toolBranch:this._$toolBranch=this.comment.$body.querySelector('.comment__tool[data-role="branch"]')}get $toolFromParent(){return this._$toolFromParent?this._$toolFromParent:this._$toolFromParent=this.comment.$body.querySelector('.comment__tool[data-role="from-parent"]')}get $toolToggleBranch(){return this._$toolToggleBranch?this._$toolToggleBranch:this._$toolToggleBranch=this.comment.$body.querySelector('.comment__tool[data-role="branch-toggle"]')}}function X(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class J extends a.v{constructor(e){super(),X(this,"_isSaved",!1),X(this,"_$toolSave",null),this.comment=e}setInitData({isSaved:e}){this._isSaved=e}async syncSaved(){const{response:e}=await n.cf.post(d.WB,{action:this.isSaved?"save_comment+":"save_comment-",comment_id:this.comment.id});e.result||r.core.logger.error("comments","bad sync saed",this.isSaved,"by comment",this.comment.id)}get isSaved(){return this._isSaved}set isSaved(e){this._isSaved!==e&&(this._isSaved=e,this.syncSaved())}get $toolSave(){return this._$toolSave?this._$toolSave:this._$toolSave=this.comment.$body.querySelector('.comment__tool[data-role="save"]')}}var Q=s(20794);const ee=e=>`<button class="button_link comment__control" data-type="${e}"></button>`;class te extends a.v{constructor(e){super(),this.comment=e}updateControls(){const e=this.comment.replyEditor.isReplyShown;this.$controlCreate.hidden=e,this.$controlCreate.classList.toggle("button_disabled",!(0,Q.s)(this.comment,!1));const t=this.comment.isEditable&&!e,s=this.$controlEdit;s&&(s.hidden=!t),this.$controlCancel.hidden=!e;const i=this.comment.isEditable,o=this.$controlRemove;o&&(o.hidden=!i);const r=this.comment.isOfficial&&this.comment.canUnpin;this.$controlUnpin.hidden=!r}get $controls(){if(this._$controls)return this._$controls;const e=this.comment.$body.querySelector(":scope > .comment__controls");return e instanceof HTMLElement?this._$controls=e:this._$controls=p()('<div class="comment__controls"></div>')[0]}get $controlInner(){if(this._$controlInner)return this._$controlInner;const e=this.$controls.querySelector(":scope > .comment__controls-inner");return e instanceof HTMLElement?this._$controlInner=e:this._$controlInner=p()('<div class="comment__controls-inner"></div>').appendTo(this.$controls)[0]}get $controlCreate(){if(this._$controlCreate)return this._$controlCreate;const e=this.$controls.querySelector('.comment__control[data-type="create"]');return e instanceof HTMLElement?this._$controlCreate=e:this._$controlCreate=p()(ee("create")).appendTo(this.$controlInner).get(0)}get $controlEdit(){var e;return this._$controlEdit||(this._$controlEdit=null!==(e=this.$controls.querySelector('.comment__control[data-type="edit"]'))&&void 0!==e?e:void 0),this._$controlEdit}get $controlCancel(){if(this._$controlCancel)return this._$controlCancel;const e=this.$controls.querySelector('.comment__control[data-type="cancel"]');return e instanceof HTMLElement?this._$controlCancel=e:this._$controlCancel=p()(ee("cancel")).appendTo(this.$controlInner).get(0)}get $controlRemove(){var e;return this._$controlRemove||(this._$controlRemove=null!==(e=this.$controls.querySelector('.comment__control[data-type="remove"]'))&&void 0!==e?e:void 0),this._$controlRemove}get $controlUnpin(){if(this._$controlUnpin)return this._$controlUnpin;const e=this.$controls.querySelector('.comment__control[data-type="unpin"]');return e instanceof HTMLElement?this._$controlUnpin=e:this._$controlUnpin=p()(ee("unpin")).appendTo(this.$controlInner).get(0)}}var se=s(82959),ie=s(89604),oe=s(75223),re=s(7016),ne=s(91920);const ae="comment__best-answer_is-best";class le extends a.v{constructor(e){super(),this.comment=e}get isBestAnswer(){var e,t;return(null===(e=this.comment.el)||void 0===e||null===(t=e.querySelector(d.xk))||void 0===t?void 0:t.classList.contains(ae))||!1}async setBestAnswer(e){if(!(this.isBestAnswer&&e||!this.isBestAnswer&&!e))try{var t,s;const i=null===(t=this.comment.el)||void 0===t||null===(s=t.querySelector(d.xk))||void 0===s?void 0:s.classList;i&&i.toggle("hint",!e),await n.cf.post("/ajax.php",{route:e?"best-answer/set":"best-answer/delete",comment_id:this.comment.id,story_id:this.comment.comments.ui.story.id}),i&&i.toggle(ae,e)}catch(i){r.core.ui.toasts.showError(i instanceof Error?i.message:"comments.error.400")}}}var ce,de,ue,pe,he=s(91904),_e=s(45990);s(22470);function me(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function ge(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?me(Object(s),!0).forEach((function(t){ve(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):me(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function ve(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function fe(e,t,s,i,o){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=s.slice().reverse().reduce((function(s,i){return i(e,t,s)||s}),r),o&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(o):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}let ye=(ce=M(),de=M(),ue=M(),pe=class e extends a.v{get hasChildren(){var e;return Boolean((null===(e=this.children.items)||void 0===e?void 0:e.length)>0||this.hasChildrenMetaFlag||this.isFake)}constructor(e,t){super(t),ve(this,"isStoryComment",!1),ve(this,"isViewObserverAttached",!1),ve(this,"_isSubsToolsAppended",!1),this.id=e;(this.isRoot=e===d.iM)&&(this._options.depth=-1,this._isRendered=!0,this._isMounted=!0,this.children.setInitData({isChildrenShown:!0})),null!=t&&t.el&&(this._options.$el=p()(t.el),this._isRendered=!0,this._isMounted=!0,this.getInformationFromData(),this.appendSubscribeTools(),this.attachObserver()),this.subscribeOnAuthorModerationBan(),this.showSubsNotification()}async togglePinAuthors(e){const{response:t}=await n.cf.post("/ajax.php",{route:"comment/"+(e?"pin":"unpin"),comment_id:this.id});return!!t.result||(r.core.ui.toasts.showError(t.message||"comments.error.400"),!1)}async removeByCurrentUser(){if(!this.isEditable)return!1;const{response:e}=await n.cf.post("/ajax/comments_actions.php",{action:"delete",id:this.id});return e.result?(r.core.initParams.isSlowModeEnabled&&r.core.initParams.availableNumberOfCommentsForToday++,this.$el&&this.$el.addClass("comment_deleted"),this.isRemoved=!0,!0):(r.core.ui.toasts.showError(e.message||"comments.error.400"),!1)}async restoreByCurrentUser(){if(!this.isRemoved)return!1;const{response:e}=await n.cf.post("/ajax/comments_actions.php",{action:"restore",id:this.id});return e.result?(r.core.initParams.isSlowModeEnabled&&r.core.initParams.availableNumberOfCommentsForToday--,this.$el&&this.$el.removeClass("comment_deleted"),this.isRemoved=!1,!0):(r.core.ui.toasts.showError(e.message||"comments.error.400"),!1)}destroy(e=!1){var t;this.isRendered&&(null===(t=this.el)||void 0===t||t.remove());this._isRendered=!1,this._isMounted=!1,super.destroy(e)}render(){if(this.isRendered)return;if(this.el)return void(this._isRendered=!0);const e=this._options.el=(0,L.m)(`\n\t\t\t<div class="comment ${this.isLoading?" comment_placeholder":""}"\n\t\t\t\tid="comment_${this.id}"\n\t\t\t\tdata-id="${this.id}"\n\t\t\t\tdata-indent="${this.indent}"\n\t\t\t\t${this.isNewest?' data-newest="true"':""}>\n\t\t\t\t<div class="comment__body"></div>\n\t\t\t</div>\n\t\t`);this._options.$el=p()(e),this.isLoading&&e.insertAdjacentElement("afterbegin",this.$placeholder),this.isNewest&&this.highlight("yellow",!1,!0),this.children.items.length&&(e.append(this.children.$toggleChildren),e.append(this.children.$childrenContainer),this.children.updateChildrenShown(this.children.isChildrenShown)),this._isRendered=!0}renderByHtml(e){if(this.isRendered)return;if(this.el)return void(this._isRendered=!0);const t=p()(e),s=t[0];s instanceof HTMLElement&&(this._options.el=s,this._options.$el=t,s.dataset.indent=String(this.indent),this._isRendered=!0)}mount(){this.isMounted||(!this.el||!this.el.parentElement&&this.parent?(this.parent.children.mountChild(this),this._isMounted=!0,this.attachObserver()):this._isMounted=!0)}setDomElement(e){this._options.el=e,this._options.$el=p()(e),this.getInformationFromData(),this.appendSubscribeTools(),this._isRendered=!0,this._isMounted=!0,this.attachObserver(),this.children.setInitData({isChildrenShown:!this.children.$toggleChildren.classList.contains("comment-toggle-children_collapse")}),this.children.updateChildrenCount(),this.subscribeOnAuthorModerationBan(),this.showSubsNotification()}attachObserver(){if(this.isViewObserverAttached||!re.v||!this.$content)return;const e=new IntersectionObserver((t=>{t.forEach((t=>{t.isIntersecting&&(e.unobserve(t.target),this.isViewed=!0,this.comments.ui.mode===l.lL.STORY_TOP&&h.cp.getInstance().sendEvent("comment_showed",this.topStoryCommentAnalyticsParams))}))}),{rootMargin:`-${ne.VIEWPORT_START}px 0px -${100*(1-ne.VIEWPORT_LIMIT)}% 0px`});e.observe(this.$content),this.isViewObserverAttached=!0}addChildCommentByCurrentUser(t,s){if(this.hasChildren&&!this.children.isChildrenShown&&!this.isChildCommentsInitialized&&(this.children.$toggleChildren.click(),"dom"===this.comments.commentInitializationType))return;const i=new e(t,{parent:this,comments:this.comments,depth:this.depth+1});if(this.children.prependChild(i),this.children.updateChildrenCount(),this.isRoot)this.comments.add(i);else{const e=[...this.comments.items];e.splice(e.indexOf(this)+1,0,i),this.comments.set(e,{merge:!1})}return i.renderByHtml(s),i.mount(),i.getInformationFromData(),i.appendSubscribeTools(),this.comments.ui.mode!==l.lL.INCOMING&&this.comments.ui.mode!==l.lL.OUTCOMING&&i.highlight("green"),this.children.isChildrenShown=!0,r.core.ui.player.init(i.$content),B.z.getInstance().init(),i}updateHtmlAfterEdit(e){var t;if(!this.$content)return;B.z.getInstance().unobserve(this.$content);const s=p()(e);this.$content.innerHTML=s.find(".comment__content").html(),this.controls.$controls.innerHTML=s.find(".comment__controls").html(),this._controls=void 0;const i=null===(t=this.el)||void 0===t?void 0:t.querySelector(".comment__header");i&&(i.innerHTML=s.find(".comment__header").html()),this.comments.ui.mode!==l.lL.INCOMING&&this.comments.ui.mode!==l.lL.OUTCOMING&&this.highlight("green"),r.core.ui.player.init(this.$content)}updateHtmlAfterLoad(e){const t=this.el,s=document.createElement("div");s.innerHTML=e;const i=s.querySelector(".comment__body")||document.createElement("div"),o=s.querySelector(".comment");if(!t||!i||!o)throw new Error("not found body | header of comment");for(;i.childNodes.length>0;)this.$body.appendChild(i.childNodes[0]);if(t.dataset.meta=o.dataset.meta,t.className=o.className,this.getInformationFromData(),this.appendSubscribeTools(),this.isLoading=!1,this.isEditable){const e=o.querySelector(".comment__restore");e&&t.prepend(e)}t.classList.add("comment_show"),this.timeout("remove-show",200,(()=>{t.classList.remove("comment_show")})),this.attachObserver(),this.subscribeOnAuthorModerationBan(),this.showSubsNotification()}sendCommentPinAnalytics(){const e=this.comments.ui.story;h.cp.getInstance().sendEvent("company_comment_pin",ge(ge({},e?{"rating!undefined":e.rating}:{}),{},{partner_id:r.core.initParams.reputationClientId,post_id:this.comments.commentsMeta.storyId,author_id:this.comments.commentsMeta.storyAuthorId},this.baseAnalyticsParams))}get commentsMeta(){return this.comments.ui.meta}async scrollTo(e=!1){if(!this.el)return;const{top:t}=this.el.getBoundingClientRect(),s=t+window.pageYOffset-20;await r.core.ui.scrollTo(s,e)}open(){this.hasChildren&&(this.children.isChildrenShown=!0),!this.isRoot&&this.parent&&this.parent.open()}highlight(e,t=!0,s){if(!this.$body)return;const i=`comment__body_highlight_${e}`,o=this.$body.classList.contains(i),r=void 0!==s?s:!o;o!==r&&(this.$body.classList.toggle(i,r),t?(this.$body.classList.toggle("comment__body_highlight_blink",r),this.timeout(e,2e3,(()=>{this.$body&&this.$body.classList.remove(i,"comment__body_highlight_blink")}))):this.cancelTimeout(e))}checkNeedLoadingButton(){if(!(this.isRoot&&this.isRendered&&this.children.items.length&&this.children.isChildrenShown))return void this.toggleMoreButton(!1);this.children.items.forEach((t=>t instanceof e&&t.checkNeedLoadingButton()));let t=this.comments.getNextPartChildrenComments(this,!1,!1).filter((t=>t instanceof e)).length>0;if(t){const{total:e}=this.comments.unrevealedCommentsCount;for(let s=this.comments.items.length-1;s>0;s--){const i=this.comments.items[s];if(i.isRendered){t=i.children.childTotalCount!==e;break}}}return this.toggleMoreButton(t)}toggleMoreButton(e){if(!e)return void(this.$toggleMore&&(this.$toggleMore&&this.$toggleMore.remove(),delete this.$toggleMore));if(this.$toggleMore)return this.$toggleMore;const t=r.core.i18n("comments.button.toggle-more"),s=this.$toggleMore=(0,L.m)(`<button class="comment__more">${t}</button>`);return this.children.$childrenContainer.append(s),s}canSubsribe(){return he.V.isUserInExperiment(he.t.COMMENTS_SUBSCRIPTION)&&!this.isComstory&&!this._isSubsToolsAppended&&(this.comments.ui.mode!==l.lL.STORY_TOP&&"story"===r.core.initParams.pageName||this.comments.ui.mode===l.lL.SUBS_FEED)}async appendSubscribeTools(){var e;this.canSubsribe()&&(this._isSubsToolsAppended=!0,this.isSubscribed=this.comments.ui.mode===l.lL.SUBS_FEED||_e.L.getInstance().isCommentSubscribed(this.id),await(0,Z.y)(),null===(e=this.$body.querySelector(".comment__header > .comment__tools"))||void 0===e||e.prepend(this.isSubscribed?_e.L.createUnsubscribeTool():_e.L.createSubscribeTool()))}getInformationFromData(){const e=this.el;if(!e)return;if(e.classList.contains("comment_fake"))return this.children.setInitData({isChildrenShown:!0}),void(this.isFake=!0);const t=e.dataset,s=new Map,i=new Set;var o;("string"==typeof t.meta&&t.meta.split(";").forEach((e=>{const[t,o]=e.split("=");o?s.set(t,o):i.add(t)})),this.depth||(this._options.depth=this.isRoot?0:this.parent.depth+1),s.has("de")?this._options.realDepth=Number(s.get("de")):(this._options.realDepth=this._options.depth,e.dataset.meta&&(e.dataset.meta+=`;de=${this._options.depth}`)),this.authorId=Number(s.get("aid"))||0,this.voter.setInitData({vote:(0,c.i)(l.OC,Number(s.get("v")))||l.OC.NONE,inputAmountVotes:s.get("av"),inputRating:s.get("r")}),this.ignoreType=Number(s.get("ic")),this.ignoreCommunityName=s.get("cn"),this.ignoredByList=s.has("ib")?(s.get("ib")||"").split(",").filter((e=>""!==e.trim())):[],this.datetime=A()(s.get("d")||""),this.editableTime=s.has("et")?Number(s.get("et")):void 0,this.isAuthorCurrentUser=i.has("ua"),this._options.isEditable=i.has("e"),this.saver.setInitData({isSaved:i.has("s")}),this._options.isOfficial=i.has("io"),this._options.canUnpin=i.has("cu"),this._options.canPinAuthors=i.has("cpa"),this._options.canUnpinAuthors=i.has("cua"),this._options.canBanByStoryAuthor=i.has("cbsa"),this._options.isNewest="boolean"==typeof this._options.isNewest?this._options.isNewest:"true"===t.newest,this.isStoryComment=i.has("sc"),this.hasChildrenMetaFlag=i.has("hc"),t.url&&(this._options.url=t.url),this.copyUrl=t.copyUrl,this.isComstory=e.classList.contains("comment_comstory"),this.isComstory)&&(w.getInstance().addComstory(this),this.parentStoryId=(null===(o=this.$content)||void 0===o?void 0:o.querySelector(".story_comment").dataset.storyId)||null)}subscribeOnAuthorModerationBan(){this.canBanByStoryAuthor&&!this.authorModerationBanListener&&(this.authorModerationBanListener=this.listenToOnce(r.core,"author-moderation:ban",(e=>{e===this.authorId&&this._isRendered&&(this.canBanByStoryAuthor=!1,this.insertAuthorModerationBanIcon())})))}async insertAuthorModerationBanIcon(){await(0,Z.y)();const e=`\n\t\t\t<div\n\t\t\t\tclass="hint comment__tool"\n\t\t\t\tdata-role="banned-by-story-author"\n\t\t\t\taria-label="Пользователь заблокирован">\n\t\t\t\t${r.core.icon("ui__ban","banned-by-story-author")}\n\t\t\t</div>\n\t\t`;{var t,s;const i=null===(t=this.el)||void 0===t?void 0:t.querySelector('[data-role="story-author-ban"]');if(!i)return;null===(s=i.parentElement)||void 0===s||s.insertAdjacentHTML("afterend",e),i.remove()}}showSubsNotification(){}updateIsEditable(e){this.replyEditor.lock(e),this.controls.$controlRemove&&(this.controls.$controlRemove.hidden=!e),this.controls.updateControls()}get el(){return this._options.el}get $el(){return this._options.$el}get $body(){var e;if(this._options.$body)return this._options.$body;const t=null===(e=this.el)||void 0===e?void 0:e.querySelector(":scope > .comment__body");return t instanceof HTMLElement?t:this._options.$body=p()('<div class="comment__body"/>')[0]}get $datetime(){return this._options.$datetime?this._options.$datetime:this._options.$datetime=this.$body.querySelector(".comment__datetime")}get $content(){if(this._options.$content)return this._options.$content;const e=this.$body.querySelector(".comment__content");return e?this._options.$content=e:null}get $placeholder(){var e;if(this._options.$placeholder)return this._options.$placeholder;const t=null===(e=this.el)||void 0===e?void 0:e.querySelector(":scope > .comment__placeholder");if(t instanceof HTMLElement)return this._options.$placeholder=t;const s=this._options.$placeholder=(0,L.m)(`\n\t\t\t<div class="${"comment__placeholder"+(this.isNewest?" comment__body_highlight_yellow":"")}">\n\t\t\t\t${(0,oe.Z)()}\n\t\t\t</div>\n\t\t`);return requestAnimationFrame((()=>{this.el&&this.el.insertAdjacentElement("afterbegin",s)})),this._options.$placeholder}get isNewest(){return Boolean(this._options.isNewest)}set isNewest(e){this._options.isNewest!==e&&(this._options.isNewest=e,this.el&&(this.highlight("yellow",!1,e),e?this.el.setAttribute("data-newest","true"):this.el.removeAttribute("data-newest")))}get isEditable(){return this._options.isEditable}set isEditable(e){this._options.isEditable!==e&&(this._options.isEditable=e,this.updateIsEditable(e))}get depth(){return this._options.depth}get realDepth(){return this._options.realDepth}get indent(){const e=this.depth||0;return 0===e?0:e%d.Iz||d.Iz}get floor(){return Math.trunc(Math.abs((this.depth||0)-1)/d.Iz)}get children(){return this._children?this._children:this._children=new se.B(this)}get parent(){return this._options.parent}get parentComment(){const t=this.parent;return t?t instanceof e?t:t.parent:void 0}get comments(){return this._options.comments}get isRendered(){return!0===this._isRendered}get isMounted(){return!0===this._isMounted}get isLoading(){return this._options.isLoading}set isLoading(e){var t;this._options.isLoading!==e&&(this._options.isLoading=e,this.isRendered&&this.el&&this.$placeholder&&requestAnimationFrame((()=>{var t,s;(null===(t=this.el)||void 0===t||t.classList.toggle("comment_placeholder",e),e)||(null===(s=this.el)||void 0===s||s.classList.remove("comment_loading-hidden"))})),e||(null===(t=this._options.$placeholder)||void 0===t||t.remove(),this._options.$placeholder=null))}get isConcealed(){return!0===this._isConcealed}set isConcealed(e){if(this.el){this.el.hidden=e;const t=this.parent.children,s=t.items.indexOf(this);if(s>=0&&s<t.items.length-1){const i=t.items[s+1];i instanceof ie.H&&i.el&&(i.el.hidden=e)}this._isConcealed=e}else this._isConcealed=!1}get isChildCommentsInitialized(){if(0===this.children.items.length)return!0;for(let e=this.children.items.length-1;e>=0;e--){const t=this.children.items[e];if(!t.isRendered||!t.isChildCommentsInitialized)return!1}return!0}get authorUserName(){if(this.isRoot)return this.commentsMeta.storyAuthorUserName;if(this._options.authorUserName||!this.el)return this._options.authorUserName||"";const e=this.el.querySelector(".comment__user");return e instanceof HTMLElement?this._options.authorUserName=e.dataset.name||"":""}get isOfficial(){return this._options.isOfficial}set isOfficial(e){if(this._options.isOfficial=Boolean(e),!e&&(this.canUnpin=!1,this.el)){const e=this.el.querySelector('.comment__label[data-role="official"]');e&&e.remove()}}get canUnpin(){return this._options.canUnpin}set canUnpin(e){this._options.canUnpin=Boolean(e),this.controls.updateControls()}get canPinAuthors(){return this._options.canPinAuthors}set canPinAuthors(e){this._options.canPinAuthors=Boolean(e),this.controls.updateControls()}get isSubscribed(){return this._options.isSubscribed}set isSubscribed(e){this._options.isSubscribed=e}get canBanByStoryAuthor(){return this._options.canBanByStoryAuthor}set canBanByStoryAuthor(e){this._options.canBanByStoryAuthor=Boolean(e)}get canUnpinAuthors(){return this._options.canUnpinAuthors}set canUnpinAuthors(e){this._options.canUnpinAuthors=Boolean(e),this.controls.updateControls()}get url(){return this._options.url?this._options.url:this.comments.commentsMeta.storyUrl?`${this.comments.commentsMeta.storyUrl}?cid=${this.id}`:(null===(e=this.$body.querySelector('[data-role="link"]'))||void 0===e?void 0:e.getAttribute("href"))||`?cid=${this.id}`;var e}get voter(){return this._voter?this._voter:this._voter=new V(this)}get replyEditor(){return this._replyEditor?this._replyEditor:this._replyEditor=new G(this)}get branchTools(){return this._branchTools?this._branchTools:this._branchTools=new K(this)}get saver(){return this._saver?this._saver:this._saver=new J(this)}get controls(){return this._controls?this._controls:this._controls=new te(this)}get bestAnswer(){return this._bestAnswer?this._bestAnswer:this._bestAnswer=new le(this)}get isViewed(){return this._options.isViewed}set isViewed(e){this._options.isViewed=e}get baseAnalyticsParams(){return{comment_id:this.id,comment_author_id:this.authorId,level:this.realDepth+1}}get topStoryCommentAnalyticsParams(){var e;const t=this.comments.ui.story,s=null!==(e=null==t?void 0:t.tagsMask)&&void 0!==e?e:0;return ge(ge(ge({},this.baseAnalyticsParams),{},{rating:this.voter.rating,post_id:this.comments.commentsMeta.storyId,author_id:this.comments.commentsMeta.storyAuthorId,comments:t.commentsCount,screen_index:t.screenIndex+1},s>0&&{tags_mask:s}),{},{type_i8:this.voter.hasAuthorLike()?1:void 0,content_type:null==t?void 0:t.contentTypes,type:"comment_in_feed"})}},fe(pe.prototype,"togglePinAuthors",[ce],Object.getOwnPropertyDescriptor(pe.prototype,"togglePinAuthors"),pe.prototype),fe(pe.prototype,"removeByCurrentUser",[de],Object.getOwnPropertyDescriptor(pe.prototype,"removeByCurrentUser"),pe.prototype),fe(pe.prototype,"restoreByCurrentUser",[ue],Object.getOwnPropertyDescriptor(pe.prototype,"restoreByCurrentUser"),pe.prototype),pe)},65542:(e,t,s)=>{"use strict";s.d(t,{g:()=>D});s(85827),s(41817),s(66992),s(33948),s(88674);var i=s(12950),o=s(12953),r=(s(2707),s(2439)),n=s(48270),a=s(63748);function l(e){const t=null===e?0:e.length;return t>0?e[t-1]:void 0}let c;function d(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function u(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?d(Object(s),!0).forEach((function(t){p(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function p(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}c=Symbol.iterator;class h extends r.v{constructor(e=!1,t,s="id"){super(),p(this,"items",[]),p(this,"onChangeData",((e,t)=>{this.emit("dataSetChange",this,e,t)})),this.DObject=t,this.fieldId=s,e&&(this.ids=[])}[c](){return this.items.values()}destroy(){this.isDestroyed||(this.clear(),delete this.ids,this.items=[],super.destroy())}add(e,t={}){return this.set(e,u(u({},t),{},{merge:!0}))}set(e,t={}){if(t=u({silent:!1,merge:!1,destroy:!0},t),Array.isArray(e)||(e=[e]),!e.length&&!t.merge)return this.clear();const s=this.items,i=[];let o=[];for(let c of e){if(!(0,a.K)(c))continue;if(s.includes(c)){o.push(c);continue}const e=this.getIdFromData(c);if(void 0!==e&&(this.ids&&this.ids.includes(e)||!this.ids)){const t=this.get(e);if(t){o.push(t);continue}}const r=this.prepareData(c);r&&(c=r),c instanceof n.L&&(this.listenTo(c,"dataDestroy",this.onDestroyData.bind(this)),this.listenTo(c,"dataChange",this.onChangeData)),i.push(c),o.push(c),t.silent||this.emit("dataSetAdd",this,c)}let r=s.filter((e=>!o.includes(e)));r.length&&(t.merge?(o=[...r].concat(o),r=null):this._remove(r,t)),this.items=o,this.ids&&this.updateIds();const l=this.prepareDelta(i,r);return!t.silent&&l&&this.emit("dataSetUpdate",this,l),l}prepareData(e){if(!this.DObject)return;if(e instanceof this.DObject)return e;const t=void 0===this.fieldId||this.DObject.prototype.fieldId?void 0:this.fieldId;return new this.DObject(e,!0,t)}getIdFromData(e){if(e instanceof n.L)return e.id;const t=this.DObject&&this.DObject.prototype.fieldId||this.fieldId;return t&&Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}prepareDelta(e,t){const s={inserted:void 0,removed:void 0};let i=!1;return e&&e.length&&(s.inserted=e,i=!0),t&&t.length&&(s.removed=t,i=!0),i?s:null}remove(e,t={silent:!1,destroy:!0}){if(e===this.items)return this.clear(t);const s=Array.isArray(e)?e:[e],i=this.prepareDelta(null,this._remove(s,t));return this.emit("dataSetUpdate",this,i||{}),i}get(e){for(const t of this.items)if(t===e||this.getIdFromData(t)===e)return t}has(e){const t=this.items;let s;if("object"==typeof e){if(t.includes(e))return!0;const i=this.getIdFromData(e);if(void 0===i)return!1;s=i}return"string"!=typeof e&&"number"!=typeof e||(s=e),void 0!==s&&(this.ids?this.ids.includes(s):t.some((e=>this.getIdFromData(e)===s)))}findIndex(e){return this.items.findIndex(e)}firstId(){if(this.size)return this.ids?this.ids[0]:this.getIdFromData(this.items[0])}lastId(){if(!this.size)return;if(this.ids)return l(this.ids);const e=l(this.items);return e?this.getIdFromData(e):void 0}nextItem(e){const t=this.get(e);if(!t)return;const s=this.items.indexOf(t);return-1!==s&&s!==this.size-1?this.items[s+1]:void 0}prevItem(e){const t=this.get(e);if(!t)return;const s=this.items.indexOf(t);return-1!==s&&0!==s?this.items[s-1]:void 0}nextId(e){if(void 0===e)return;if(this.ids){let t=this.ids.indexOf(e);if(-1===t||t===this.size-1)return;return this.ids[++t]}const t=this.nextItem(e);return t?this.getIdFromData(t):void 0}prevId(e){if(void 0===e)return;if(this.ids){let t=this.ids.indexOf(e);if(-1===t||0===t)return;return this.ids[--t]}const t=this.prevItem(e);return t?this.getIdFromData(t):void 0}sort(e){this.items.sort(e),this.ids?(this.updateIds(),this.emit("dataSetSort",this)):this.emit("dataSetSort",this)}clear({silent:e=!1,destroy:t=!0}={silent:!1,destroy:!0}){const s=this.items;if(!this.size)return null;for(const o of this.items)!e&&o instanceof n.L&&o.emit("dataRemove",o,this),o instanceof r.v&&this.stopListening(o),t&&"object"==typeof o&&"function"==typeof o.destroy&&o.destroy();this.items=[],this.ids&&(this.ids=[]);const i=this.prepareDelta(null,s);return i&&this.emit("dataSetUpdate",this,i),i}updateIds(){this.ids=[],this.items.forEach((e=>{const t=this.getIdFromData(e);void 0!==t&&this.ids&&this.ids.push(t)}))}_remove(e,t={}){t=u({silent:!1,destroy:!0},t);const s=[],i=[],o=this.items;for(const a of e){let e,l=o.indexOf(a);if(-1===l){const t=this.get(a);if(!t)continue;l=o.indexOf(t),e=t}else e=a;if(-1!==l){if(o.splice(l,1),s.push(e),this.ids){const t=e instanceof n.L?e.id:this.getIdFromData(e);void 0!==t&&i.push(t)}!t.silent&&e instanceof n.L&&e.emit("dataRemove",e,this),e instanceof r.v&&this.stopListening(e),t.destroy&&"object"==typeof e&&"function"==typeof e.destroy&&e.destroy()}}return s.length?(this.ids&&(this.ids=function(e,...t){return e.filter((e=>!t.includes(e)))}(this.ids,...i)),s):null}onDestroyData(e){const t=this.prepareDelta(null,this._remove([e],{silent:!1}));t&&this.emit("dataSetUpdate",this,t)}get size(){return this.items.length}}var _=s(42512),m=s(6393),g=s(89604),v=s(96430);let f;!function(e){e[e.IS_IN_HIDDEN_GROUP=1]="IS_IN_HIDDEN_GROUP",e[e.IS_NEWEST=2]="IS_NEWEST",e[e.IS_STORY_AUTHOR=4]="IS_STORY_AUTHOR"}(f||(f={}));var y,b,w=s(30381),k=s.n(w),S=s(47994),O=s(85456),E=s(42107),C=s(49463),x=s(96637),T=s(91904);s(69483);function I(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function P(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?I(Object(s),!0).forEach((function(t){A(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):I(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function A(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}let D=(y=(0,v.E)(600),b=class e extends h{constructor(e){super(!0,_.U),A(this,"commentInitializationType","tree"),this.ui=e,this.interval("updateTime",m.ly,this.updateCommentsTime.bind(this))}static createCommentsListByTree(t,s,i){const o=[],r=i.comments,n=r.getMaxCommentIdFromStorage();let a,l,c=!1;for(const[d,u,p]of s){const s=d+t,h=Boolean(u&f.IS_IN_HIDDEN_GROUP),m=Boolean(u&f.IS_NEWEST)||n?n<s:void 0,v=Boolean(u&f.IS_STORY_AUTHOR);h&&!c&&(a="number"==typeof a?a+1:0,l=new g.H(a,{parent:i,comments:r}),i.children.appendChild(l)),c=h;const y=h?l:i,b=new _.U(s,{isNewest:m,isStoryAuthor:v,parent:y,comments:r,depth:i.depth+1});o.push(b),null==y||y.children.appendChild(b),p&&o.push(...e.createCommentsListByTree(t,p,b))}return o}static createCommentsListByDom(t){const s=t.children.$childrenContainer;if(!s)return[];const i=[],o=t.comments,r=o.getMaxCommentIdFromStorage();let n=0;for(const a of Array.from(s.children)){if(!(a instanceof HTMLElement))continue;const s=a.classList.contains("comment");if(!s&&a.classList.contains("comment-hidden-group")&&t instanceof _.U){const s=new g.H(n++,{el:a,parent:t,comments:o});t.children.items.includes(s)||t.children.items.push(s),s.children.$childrenContainer&&i.push(...e.createCommentsListByDom(s));continue}if(!s)continue;const l=Number(a.dataset.id),c=r?r<l:void 0,d=new _.U(l,{el:a,isNewest:c,parent:t,comments:o,depth:t.depth+1});t.children.items.includes(d)||t.children.items.push(d),i.push(d);const u=d.children.$childrenContainer;u&&(d.children.setInitData({isChildrenShown:!u.hidden&&Boolean(u.querySelector(".comment"))}),i.push(...e.createCommentsListByDom(d)))}return i}static getTreeFromElement(e){if(e)try{const t=JSON.parse(e.innerHTML);return t&&"number"==typeof t.min&&Array.isArray(t.tree)?t:void o.core.logger.error("comments","bad data of JSON tree")}catch(t){o.core.logger.error("comments","problem with JSON tree",t)}}async loadComments(e){if(!this.commentStack||!this.commentStack.length)return;const t=[...this.commentStack];delete this.commentStack;const{data:s,response:{result:o}}=await i.cf.post(m.WB,{action:"get_comments_by_ids",ids:t.join(","),expert_story_id:this.ui.story.isExperts?this.ui.story.id:void 0});if(!o&&!s)return void this.rollbackLoadComments(e);const r=(s||[]).filter((e=>"number"==typeof e.id&&"string"==typeof e.html));if(r.forEach((({id:e,html:t})=>{var s;return null===(s=this.get(e))||void 0===s?void 0:s.updateHtmlAfterLoad(t)})),T.V.isUserInExperiment(T.t.COMMENTS_ADS_2)){var n;const t=null===(n=e.el)||void 0===n?void 0:n.querySelector(".comment__children");t&&this.initAds(t)}t.filter((e=>!r.find((t=>e===t.id)))).forEach((e=>{const t=this.get(e);t&&t.destroy()})),(0,O.U)()}updateCommentsByDom(e){const t=e.children.$childrenContainer;if(!t)return;const s=e instanceof g.H?e.parentComment.comments:e.comments,i=s.getMaxCommentIdFromStorage();let r=0;for(const n of Array.from(t.children)){if(!(n instanceof HTMLElement))continue;const t=n.classList.contains("comment");if(!t&&n.classList.contains("comment-hidden-group")&&e instanceof _.U){let t=e.children.getChildHiddenGroupById(r++);t?t.setDOM(n):(t=new g.H(r,{el:n,parent:e}),e.children.items.push(t)),t.children.$childrenContainer&&this.updateCommentsByDom(t);continue}if(!t)continue;const a=Number(n.dataset.id);let l=e.children.getChildCommentById(a);if(l)l.setDomElement(n);else{o.core.logger.error("comments","has dom comment, but not found in tree");const t=i?i<a:void 0;l=new _.U(a,{el:n,isNewest:t,parent:e,comments:s,depth:e.depth+1}),e.children.items.includes(l)||e.children.items.push(l),this.add(l)}l.children.$childrenContainer&&this.updateCommentsByDom(l)}}getNextPartChildrenComments(e,t=!1,s=!1,i=null){if(!e.children.items){if(e instanceof _.U){const t=e.checkNeedLoadingButton();this.setLoadingButtonText(t)}return[]}const r=e.depth+1,n=Math.ceil(Math.max(1,r)/m.Iz)*m.Iz,a=Math.min(o.core.initParams.maxCommentsBranchDepth-1,m.Iz),l=r<=a?a:n,c=this.items.filter((e=>e.isRendered));return e.children.getUnloadChildComments(l,i||(s?e.children.childTotalCount:m.Q1),t,c.length?c[c.length-1].id:null)}loadNextPartChildrenComments(e,t=!1,s=!1,i=null){const o=this.getNextPartChildrenComments(e,t,s,i);if(o.length)setTimeout((()=>{const t=e.depth<0;let s=!0;const i=[];for(const a of o)if(a.parent.isChildCommentsInitialized||a.parent.children.isChildrenShown||(a.parent.children.isChildrenShown=!0),e.children.isOnlyHiddenGroupChildren&&(a.parent.render(),a.parent.mount()),a.render(),a.mount(),a instanceof _.U){var r;if(a.isLoading=!0,i.push(a.id),t&&!s)null===(r=a.el)||void 0===r||r.classList.add("comment_loading-hidden");s=!1}if(this.commentStack=this.commentStack||[],this.commentStack.push(...i),this.loadComments(e),e instanceof _.U){const t=e.checkNeedLoadingButton();this.setLoadingButtonText(t)}var n;e.id!==m.iM&&this.setLoadingButtonText(null===(n=e.comments.get(0))||void 0===n?void 0:n.checkNeedLoadingButton());this.initHiddenAdvert()}));else if(e instanceof _.U){const t=e.checkNeedLoadingButton();this.setLoadingButtonText(t)}}addHighlightVisibleParent(e){const t="comment-toggle-children_highlight_blink";for(;e.parentComment;)if((e=e.parentComment).el&&null!==e.el.offsetParent&&e.children.$toggleChildren.offsetParent){const s=e.children.$toggleChildren;if(s.classList.contains(t))return;const i=s.classList.contains(t);s.classList.add("comment-toggle-children_highlight_yellow",t),this.timeout(`comments-highlight-${e.id}`,3e3,(()=>{i||s.classList.remove("comment-toggle-children_highlight_yellow"),s.classList.remove(t)}))}}initComments(t,s){const i=e.getTreeFromElement(s&&s.get(0));i?(this.commentInitializationType="tree",this.initCommentByTree(t,i)):(this.commentInitializationType="dom",this.initCommentByDom(t))}initCommentByTree(t,s){const i=new _.U(m.iM,{comments:this});i.children.setInitData({$childrenContainer:t.get(0)}),this.set(i);const r=e.createCommentsListByTree(s.min,s.tree,i);if(this.add(r),this.updateCommentsByDom(i),this.items.find((e=>e.id!==m.iM&&e.isRendered)))setTimeout((()=>{const e=i.checkNeedLoadingButton();this.setLoadingButtonText(e),o.core.initParams.isExternalReferer&&this.concealRenderedComments()}));else{const e=null,t="#comments"===o.core.history.location.hash?e:null;this.loadNextPartChildrenComments(i,!1,!1,t)}}sendVoteAnalytics(e,t){const{UIAllComments:i}=s(33727),o=this.ui instanceof i?this.items.length:void 0,r=this.ui instanceof i?this.ui.story.subsCode:void 0;let n="",a=null;t.voter.vote===S.OC.NONE?n=e===S.OC.UP?"comment_liked":"comment_disliked":(n="comment_rating_canceled",a=t.voter.vote===S.OC.UP?1:-1),E.cp.getInstance().sendEvent(n,P(P(P(P({post_id:this.commentsMeta.storyId,author_id:this.commentsMeta.storyAuthorId},a&&{type:a}),{},{time:1e3*C.Z.getInstance().getViewTime("comments"),"type_i8!empty":r},t.baseAnalyticsParams),o&&{comments:o}),this.ui.mode===S.lL.STORY_TOP&&t.topStoryCommentAnalyticsParams))}sendViewAnalytics(){let e=[];if(this.items.forEach((t=>{t.isViewed&&t.depth>=0&&(e[t.depth]||(e[t.depth]=0),e[t.depth]++)})),e=e.map((e=>e||0)),!e.length)return;const t=P(P({},this.ui.story.analyticsData),{},{create_at:C.Z.getInstance().getFirstViewTime("comments"),view_time:C.Z.getInstance().getViewTime("comments"),list:"["+e.join(", ")+"]"});E.cp.getInstance().sendEvent("show_comments",t)}getMaxCommentIdFromStorage(){return this.ui.getMaxCommentIdFromStorage()}initCommentByDom(t){const s=new _.U(m.iM,{comments:this});s.children.setInitData({$childrenContainer:t.get(0)}),this.set(s);const i=e.createCommentsListByDom(s);this.add(i),setTimeout((()=>{this.concealRenderedComments()}))}concealRenderedComments(){}updateCommentsTime(){const e=k()();this.items.forEach((t=>{var s;if(t.isRoot||!t.datetime)return;const i=e.diff(t.datetime);t.$datetime&&i<m.aH&&!o.core.ui.elementInViewport(t.$el)&&(t.$datetime.textContent=t.datetime.fromNow()),t.isEditable&&i>1e3*(null!==(s=t.editableTime)&&void 0!==s?s:0)&&(t.isEditable=!1)}))}rollbackLoadComments(e){const t=e=>{for(const s of e)s instanceof _.U&&(s.children.items.length&&t(s.children.items),s.isLoading=!1,s.destroy())};e.children.isChildrenShown=!1,t(e.children.items)}setLoadingButtonText(e){if(!e)return;const{total:t,newest:s}=this.unrevealedCommentsCount;if(t>0){const s=`${t} комментари${x.Utils.pluralNounRU(t,["й","я","ев"])}`;e.innerHTML=`Раскрыть <span class="comments__more-count">${s}</span>`}e.classList.toggle("comment__more_newest",s>0)}initAds(e){e.querySelectorAll(".comments__adv div").forEach((e=>{this.initAd(e)}))}initAd(e){const t={p1:"cwago",p2:"hbed"};try{window.yaContextCb.push((()=>{window.Ya.adfoxCode.create({ownerId:260477,containerId:e.id,params:t,onRender:()=>{window.adInfoStorage=(window.adInfoStorage||new Set).add(e.id)}})}))}catch(s){console.error(s)}}initHiddenAdvert(){var e;const t=null===(e=this.ui.el)||void 0===e?void 0:e.querySelector(".comments__adv.hidden");if(!t)return;const s=this.items.find((e=>e.isRoot));if(!s)return;let i=0;for(const r of s.children.items)if(r.isMounted&&r instanceof _.U&&i++,15===i){var o;null===(o=r.el)||void 0===o||o.insertAdjacentElement("afterend",t),t.classList.remove("hidden");break}}get commentsMeta(){return this.ui.meta}get unrevealedCommentsCount(){let e=0,t=0;for(let s=this.items.length-1;s>=0;s--){const i=this.items[s];if(i.isRendered&&!i.isConcealed)break;e++,i.isNewest&&t++}return{total:e,newest:t}}},M=b.prototype,R="loadComments",N=[y],B=Object.getOwnPropertyDescriptor(b.prototype,"loadComments"),L=b.prototype,j={},Object.keys(B).forEach((function(e){j[e]=B[e]})),j.enumerable=!!j.enumerable,j.configurable=!!j.configurable,("value"in j||j.initializer)&&(j.writable=!0),j=N.slice().reverse().reduce((function(e,t){return t(M,R,e)||e}),j),L&&void 0!==j.initializer&&(j.value=j.initializer?j.initializer.call(L):void 0,j.initializer=void 0),void 0===j.initializer&&(Object.defineProperty(M,R,j),j=null),b);var M,R,N,B,L,j},6393:(e,t,s)=>{"use strict";s.d(t,{BE:()=>c,Ck:()=>d,Iz:()=>l,Q1:()=>n,WB:()=>p,Wk:()=>u,aH:()=>r,hb:()=>h,iM:()=>i,kZ:()=>a,ly:()=>o,xk:()=>_});const i=0,o=3e4,r=828e5,n=40,a=1,l=10,c=50,d="pkb_Cmi",u=400,p="/ajax/comments_actions.php",h={id:"id",pid:"parentID",aid:"authorId",d:"datetime",de:"depth",e:"isEditable",et:"editableTime",v:"vote",ic:"ignoreType",cn:"communityName",ua:"isCommenterCurrentUser",r:"rating",av:"amountVotes",s:"isSaved",n:"isNewest",hc:"hasChildren",st:"isShowTools",hg:"isInHiddenGroup",sc:"isStoryComment",io:"isOfficial",cu:"canUnpin",sid:"storyId",said:"storyAuthorId"},_='[data-role="best"]'},47994:(e,t,s)=>{"use strict";let i,o,r,n,a;s.d(t,{IV:()=>r,OC:()=>i,hL:()=>n,lL:()=>a,tT:()=>o}),function(e){e[e.DOWN=-1]="DOWN",e[e.NONE=0]="NONE",e[e.UP=1]="UP"}(i||(i={})),function(e){e.NONE="none",e.CREATE="create",e.EDIT="edit"}(o||(o={})),function(e){e[e.NONE=0]="NONE",e[e.YOU_IGNORES_AUTHOR_OF_STORY=1]="YOU_IGNORES_AUTHOR_OF_STORY",e[e.AUTHOR_OF_STORY_IGNORES_YOU=2]="AUTHOR_OF_STORY_IGNORES_YOU",e[e.YOU_IGNORES_AUTHOR_OF_COMMENT=3]="YOU_IGNORES_AUTHOR_OF_COMMENT",e[e.AUTHOR_OF_COMMENT_IGNORES_YOU=4]="AUTHOR_OF_COMMENT_IGNORES_YOU",e[e.COMMUNITY_IGNORES_YOU=5]="COMMUNITY_IGNORES_YOU"}(r||(r={})),function(e){e[e.RATING=1]="RATING",e[e.TIME=2]="TIME",e[e.RELEVANCE=3]="RELEVANCE"}(n||(n={})),function(e){e[e.MAIN=0]="MAIN",e[e.INCOMING=1]="INCOMING",e[e.OUTCOMING=2]="OUTCOMING",e[e.STORY_AUTHOR=3]="STORY_AUTHOR",e[e.MODERATOR_CALLS=4]="MODERATOR_CALLS",e[e.REPUTATION=5]="REPUTATION",e[e.BEST=6]="BEST",e[e.HIDDEN=7]="HIDDEN",e[e.STORY_TOP=8]="STORY_TOP",e[e.SUBS_FEED=9]="SUBS_FEED"}(a||(a={}))},69483:(e,t,s)=>{"use strict";s.d(t,{z:()=>d});s(74916),s(66992),s(33948),s(41637);var i=s(35249),o=(s(15306),s(41817),s(2439)),r=s(27743),n=s(48270);function a(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class l extends o.v{constructor(){super(),a(this,"url",new n.L({search:"",hostname:"",hash:"",path:"",pathname:""})),a(this,"onPopStateChange",(e=>this.emit("popstate",e.state,e))),this.listenTo(this,"_eventHook",(e=>{e!==o.Z.FIRST_ON?e===o.Z.LAST_OFF&&window.removeEventListener("popstate",this.onPopStateChange):window.addEventListener("popstate",this.onPopStateChange)}))}static getInstance(){return l.instance?l.instance:l.instance=new l}static extractFromUrl(e){const t="string"==typeof e?(0,i.k)(e):l.location;return{hostname:t.hostname,search:t.search.replace(/^\?/,""),pathname:t.pathname,path:t.pathname+t.search,hash:t.hash.replace(/^#/,"")}}static get location(){return window.location}static get history(){return window.history}init(){this.listenTo(this,"popstate",this.loadUrl.bind(this)),this.loadUrl()}back(){l.history.back()}go(e){l.history.go(e)}redirect(e){l.location.href=e}forward(){l.history.forward()}pushUrl(e=null,t=!1){return this.pushState(void 0,"",e,t)}pushState(e=void 0,t="",s=null,i=!1){l.history.pushState(e,t,s),i?this.loadUrl():this.url.update(l.extractFromUrl(null!=s?s:void 0))}replaceUrl(e=null,t=!1){this.replaceState(void 0,"",e,t)}replaceState(e=void 0,t="",s=null,i=!1){l.history.replaceState(e,t,s),i?this.loadUrl():this.url.update(l.extractFromUrl(null!=s?s:void 0))}loadUrl(){this.url.update(l.extractFromUrl()),this.url.diff("current").length?(this.url.save("current"),r.kg.log("history",`change ${this.pathname} ${this.hash}`),this.emit("route",this)):r.kg.log("history","prevent rerouting")}get state(){return history.state}get pathname(){return this.url.data.pathname}get hash(){return this.url.data.hash}get path(){return this.url.data.path}get hostname(){return this.url.data.hostname}}const c=/#comment_(\d+)/;function d(e){const t=e?(0,i.k)(e):l.location,s=c.exec(t.hash),o=new URLSearchParams(t.search).get("cid");return s?Number(s[1]):o?Number(o):void 0}},72426:(e,t,s)=>{"use strict";s.d(t,{X:()=>E});s(85827),s(88674);var i,o,r,n,a,l,c,d,u=s(12953),p=s(47442),h=s(12950),_=s(2439),m=s(19755),g=s.n(m),v=s(58330),f=s(10553),y=s(61547),b=s(29086),w=s(70807);function k(e,t,s,i,o){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=s.slice().reverse().reduce((function(s,i){return i(e,t,s)||s}),r),o&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(o):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}const S="comment__tool",O="comment__control";let E=(i=(0,w.p)("click",`.comment__controls-mod .${S}[data-role="ban"]`),o=(0,w.p)("click",`.${S}[data-role="remove"]`),r=(0,w.p)("click",`.${S}[data-role="restore"]`),n=(0,w.p)("click",`.${O}[data-role="take"]`),a=(0,w.p)("click",`.${O}[data-role="check"]`),l=(0,w.p)("click",`.${S}[data-role="branch-hide"]`),c=(0,w.p)("click",`.${S}[data-role="branch-show"]`),d=class e extends _.v{constructor(){super()}static getInstance(){return e.instance?e.instance:e.instance=new e}static getModeratorLoading(e){const t=e.find(".comment__moderator-loading");return t.length?t:g()(`<div class="comment__moderator-loading" data-type="loading">\n\t\t\t${(0,f.t)("ui__progress-circle","player")}\n\t\t</div>`).appendTo(e)}static getModeratorTools(){const e=v.S.getInstance().get("ModeratorTools");if(!e||"function"!=typeof e)throw new Error("not found Story in UIComponentsRegistry");return new e}onBanClick(e,t){const s=t.target,i=Boolean(t.target.dataset.admoder);this.showBanPopup(e,s,i,(()=>s.classList.add(`${S}_active`)))}showBanPopup(t,s,i,o){const r=t.authorId,n=t.id;r&&e.getModeratorTools().on("complete",(()=>{null==o||o()})).showBanUserDialog(s,r,n,2,i)}onRemove(t){return new Promise((s=>{const i=t.controls.$controls.querySelector(`.${S}[data-role="remove"]`),o=t.$content,r=t.id;r&&e.getModeratorTools().on("complete",(e=>{i instanceof HTMLElement&&(i.hidden=!0);const r=t.controls.$controls.querySelector(`.${S}[data-role="restore"]`);r instanceof HTMLElement&&(r.hidden=!1),null==o||o.insertAdjacentHTML("afterbegin",`<span class="comment__content-removed-info">\n\t\t\t\t\t\t${u.core.i18n("comments.success.deleted")}\n\t\t\t\t\t\t${e.toLowerCase()}\n\t\t\t\t\t</span>`);new p.O({content:`${u.core.i18n("comments.success.deleted")}${e.toLowerCase()}`}).show(),s(!0)})).on("cancel",(()=>s(!1))).showDeleteCommentDialog(i||t.controls.$controls,t.authorId,r)}))}onRestore(t){return new Promise((s=>{const i=t.controls.$controls.querySelector(`.${S}[data-role="restore"]`),o=t.id;o&&e.getModeratorTools().on("complete",(()=>{var e,o;i instanceof HTMLElement&&(i.hidden=!0);const r=t.controls.$controls.querySelector(`.${S}[data-role="remove"]`);null===(e=t.$content)||void 0===e||null===(o=e.querySelector(".comment__content-removed-info"))||void 0===o||o.remove(),r instanceof HTMLElement&&(r.hidden=!1);new p.O({content:u.core.i18n("comments.success.restored")}).show(),s(!0)})).on("cancel",(()=>s(!1))).restoreComment(o)}))}onTake(t,s){const i=g()(s.target),o=i.data("current"),r=e.getModeratorLoading(i.parent()),n=i.data("id");n&&(r.show(),e.getModeratorTools().on("cancel",(()=>{r.hide()})).on("complete",(()=>{i.data("current",o?0:1).text(o?"Берусь":"Вернуть").attr("title",o?"Взяться на проверку":"Вернуть с проверки"),r.hide()})).takeModCall(n,o))}onCheck(t,s){const i=g()(s.target).closest(`.${O}`),o=e.getModeratorLoading(i.parent()),r=i.siblings(`.${O}[data-role="take"]`),n=i.data("current"),a=i.data("id");a&&(o.show(),e.getModeratorTools().on("cancel",(()=>{o.hide()})).on("complete",(()=>{i.siblings(".comment__moderator-checked").toggle().html(u.core.icon("ui__moderator","comments")+" "+u.core.initParams.userName),i.data("current",n?0:1).text(n?"Проверено":"Отмена").attr("title",n?"Проверка выполнена":"Убрать отметку о проверке"),r.toggle(n),o.hide()})).approveModCall(a,n))}onBranchHide(t,s){return new Promise((i=>{e.getModeratorTools().on("complete",(async()=>{var e;const{response:o}=await h.cf.post("/ajax/comments_actions.php",{action:"hide",comment_id:t.id});if(!o.result)return u.core.ui.toasts.showError(o.message||"comments.error.400"),i(!1);null===(e=t.$content)||void 0===e||e.insertAdjacentHTML("afterend",`<div class="comment__notice">\n\t\t\t\t\t\t${String(u.core.i18n("comments.notice.branch-hidden"))}\n\t\t\t\t\t</div>`),t.children.isChildrenShown=!1,s&&s.target&&(s.target.hidden=!0,s.target.nextElementSibling.hidden=!1),i(!0),u.core.ui.toasts.add("hidden",{content:"comments.success.hidden"})})).on("cancel",(()=>i(!1))).showHideBranchDialog(s&&s.target,t.authorId,t.id)}))}onBranchShow(t,s){return new Promise((i=>{e.getModeratorTools().on("complete",(async()=>{const{response:e}=await h.cf.post("/ajax/comments_actions.php",{action:"reveal",comment_id:t.id});if(!e.result)return u.core.ui.toasts.showError(e.message||"comments.error.400"),i(!1);const o=t.$body.querySelector(".comment__notice");o&&o.remove(),s&&s.target&&(s.target.hidden=!0,s.target.previousElementSibling.hidden=!1),i(!0),u.core.ui.toasts.add("shown",{content:"comments.success.shown"})})).on("cancel",(()=>i(!1))).showRestoreBranchDialog(s&&s.target,t.authorId,t.id)}))}init(e){var t,s;const i=e.ui.$el;i&&i.length&&(null===(t=this.__meta)||void 0===t||null===(s=t.listDelegatedEvents)||void 0===s||s.forEach((({events:e,selector:t,handler:s})=>{i.on(e,t,(e=>{const t=(0,y.Y)(e.currentTarget,400);if(!(t&&t instanceof b.t))return;const i=t.getCommentByElement(e.currentTarget);i&&s.call(this,i,e)}))})))}},k(d.prototype,"onBanClick",[i],Object.getOwnPropertyDescriptor(d.prototype,"onBanClick"),d.prototype),k(d.prototype,"onRemove",[o],Object.getOwnPropertyDescriptor(d.prototype,"onRemove"),d.prototype),k(d.prototype,"onRestore",[r],Object.getOwnPropertyDescriptor(d.prototype,"onRestore"),d.prototype),k(d.prototype,"onTake",[n],Object.getOwnPropertyDescriptor(d.prototype,"onTake"),d.prototype),k(d.prototype,"onCheck",[a],Object.getOwnPropertyDescriptor(d.prototype,"onCheck"),d.prototype),k(d.prototype,"onBranchHide",[l],Object.getOwnPropertyDescriptor(d.prototype,"onBranchHide"),d.prototype),k(d.prototype,"onBranchShow",[c],Object.getOwnPropertyDescriptor(d.prototype,"onBranchShow"),d.prototype),d)},55837:(e,t,s)=>{"use strict";s.d(t,{F:()=>y});s(41817);var i=s(12953),o=s(88358),r=s(2439),n=s(82800),a=s(10553),l=s(19755),c=s.n(l),d=s(92934),u=s(61547),p=s(29086),h=s(90312),_=s(6393),m=s(20794),g=s(47994);function v(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function f(e,t){for(;e;){if(e instanceof Element&&e.matches(t))return e;e=e.parentNode}return null}class y extends r.v{constructor(){super(),v(this,"shownForCurrentSelection",!1)}static getInstance(){return y.instance?y.instance:y.instance=new y}init(){document.addEventListener("mouseup",(0,d.D)(this.onClickQuote.bind(this),300)),document.addEventListener("selectionchange",(()=>{this.shownForCurrentSelection=!1;const e=window.getSelection();e&&e.rangeCount&&!e.isCollapsed||!this._quotePopup||this.quotePopup.hide()}))}onClickQuote(){var e,t;if(this.shownForCurrentSelection)return;const s=window.getSelection();if(!s||!s.rangeCount||s.isCollapsed)return;const o=s.getRangeAt(0),r=o.cloneRange(),n=document.createElement("div"),a=f(s.anchorNode,".comment"),l=f(s.focusNode,".comment");if(!a||a!==l||f(s.anchorNode,".comment__reply-wrapper")||c()(l).hasClass("comment_comstory"))return;const d=(0,u.Y)(a);if(!(d&&d instanceof p.t&&d.mode!==g.lL.STORY_TOP&&d.mode!==g.lL.SUBS_FEED))return;const h=d.getCommentByElement(a);if(!h)return;const _=o.startContainer,m=o.endContainer,v=f(_,".comment__content"),y=f(m,".comment__content");if(!v)return;const b=h.$content;!y&&b&&b.firstChild&&b.lastChild&&(v||r.setStart(b.firstChild,0),r.setEndAfter(b.lastChild)),o.startOffset===r.startOffset&&o.endOffset===r.endOffset||(s.removeAllRanges(),s.addRange(r)),n.appendChild(r.cloneContents()),n.querySelectorAll("figure, svg, img, video, iframe").forEach((e=>e.remove()));const w=null!==(e=null===(t=n.textContent)||void 0===t?void 0:t.trim())&&void 0!==e?e:"";if(!w||w.length<5)return;const k=n.innerHTML;this.quote=k,this.quoteCommentId=h.id,this.currentComments=d;const S=r.getBoundingClientRect(),O=this.quotePopup;O.target={offset:{top:S.top+i.core.ui.scrollTop,left:S.left+i.core.ui.scrollLeft},height:S.height,width:S.width},O.show(),this.shownForCurrentSelection=!0}get quotePopup(){return this._quotePopup||(this._quotePopup=new o._({delay:800,content:`<div class="comment-quote">${(0,a.t)("editor__quote")}</div>`,minWidth:1,zIndex:7e3,theme:n.xb.WARNING,direction:n.Lh.TOP}),this._quotePopup.content.on("mousedown",(()=>{if(!this.currentComments||!this.quoteCommentId||!this.quote)return;if(h.c.getInstance().yandex.goal("Quote_text_selection"),!i.core.isUserAuthorized)return void i.core.ui.authRequired();if(!this.currentComments)return;let e=this.currentComments.comments.items.find((e=>!e.isRoot&&e.replyEditor.isReplyShown));if(!e){if(e=this.currentComments.comments.get(this.quoteCommentId),!e||e.depth>=_.BE||!(0,m.s)(e,!0))return;e.replyEditor.show("create")}setTimeout((()=>{var t;this.quote&&(null===(t=e)||void 0===t||t.replyEditor.insertBlockquote(this.quote))}),300),this._quotePopup.hide()}))),this._quotePopup}}},45990:(e,t,s)=>{"use strict";s.d(t,{L:()=>b});s(85827),s(41817),s(66992),s(33948),s(88674);var i,o,r,n=s(91904),a=s(61547),l=s(29086),c=s(2439),d=s(22470),u=s(42107),p=s(70807),h=s(48591),_=s(6393),m=s(12953);function g(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function v(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?g(Object(s),!0).forEach((function(t){f(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):g(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function f(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function y(e,t,s,i,o){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=s.slice().reverse().reduce((function(s,i){return i(e,t,s)||s}),r),o&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(o):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}let b=(i=(0,p.p)("click",'[data-role="sub"]'),o=(0,p.p)("click",'[data-role="unsub"]'),r=class e extends c.v{constructor(...e){super(...e),f(this,"subscriptions",null)}static getInstance(){var t;return null!==(t=this.instance)&&void 0!==t?t:this.instance=new e}static createUnsubscribeTool(){return this.createTool()}static createSubscribeTool(){return this.createTool(!0)}static createTool(e=!1){const t=document.createElement("div");return t.classList.add("comment__tool"),t.classList.add("hint"),e||t.classList.add("comment__tool_active"),t.setAttribute("data-role",e?"sub":"unsub"),t.setAttribute("aria-label",e?"Подписаться на ответы":"Убрать из подписок"),t.innerHTML=m.core.icon(e?"ui__rss-add":"ui__rss-delete"),t}init(e){var t,s;const i=m.core.config("modules.subscribed_comment_ids");Array.isArray(i)&&(this.subscriptions=new Set(i)),this.comments=e;const o=e.ui.$el;o&&o.length&&(null===(t=this.__meta)||void 0===t||null===(s=t.listDelegatedEvents)||void 0===s||s.forEach((({events:e,selector:t,handler:s})=>{o.on(e,t,(e=>{const t=(0,a.Y)(e.currentTarget,400);if(!(t&&t instanceof l.t))return;const i=t.getCommentByElement(e.currentTarget);i&&s.call(this,i,e)}))})))}async subsribeToCommentById(e){const t=this.comments.get(e);if(t)return this.subsribeToComment(t)}async subsribeToComment(t,s){try{const r=v(v({},t.comments.ui.getBaseAnalyticsParameters(t)),{},{comment_type:this.getAnalyticsCommentType(t)});if(!m.core.isUserAuthorized)return void m.core.ui.authRequired({redirectUrl:t.url,analyticsParams:v({reason:"subscribe_comment"},r),triggeredAction:{action:"subscribe_comment",data:{id:t.id}}});await(0,h.Qm)(t.id),m.core.ui.toasts.add("comment-subscribed",{content:"Вы успешно подписались на ответы"}),t.isSubscribed=!0,u.cp.getInstance().sendEvent("subscribe_to_comment",r);{var i,o;const r=e.createUnsubscribeTool(),n=null!==(i=null==s?void 0:s.target)&&void 0!==i?i:null===(o=t.el)||void 0===o?void 0:o.querySelector('[data-role="sub"]');return null==n||n.replaceWith(r),void(0,d.Yk)(r)}}catch(r){m.core.ui.toasts.showError(r)}}async unsubscribeFromComment(t,s){try{var i,o;await(0,h.ST)(t.id),m.core.ui.toasts.add("comment-unsubscribed",{content:"Вы успешно убрали комментарий из подписок"}),t.isSubscribed=!1,u.cp.getInstance().sendEvent("unsubscribe_from_comment",v(v({},t.comments.ui.getBaseAnalyticsParameters(t)),{},{comment_type:this.getAnalyticsCommentType(t)}));const r=e.createSubscribeTool(),n=null!==(i=null==s?void 0:s.target)&&void 0!==i?i:null===(o=t.el)||void 0===o?void 0:o.querySelector('[data-role="unsub"]');null==n||n.replaceWith(r)}catch(r){m.core.ui.toasts.showError(r)}}handleSubscribeClick(e,t){this.subsribeToComment(e,t)}handleUnsubscribeClick(e,t){this.unsubscribeFromComment(e,t)}getAnalyticsCommentType(e){return e.parent.id===_.iM?e.hasChildren?"main_batch":"main_single":"answer"}isCommentSubscribed(e){return!(!n.V.isUserInExperiment(n.t.COMMENTS_SUBSCRIPTION)||!this.subscriptions)&&this.subscriptions.has(e)}get comments(){return this._comments}set comments(e){this._comments=e}},y(r.prototype,"handleSubscribeClick",[i],Object.getOwnPropertyDescriptor(r.prototype,"handleSubscribeClick"),r.prototype),y(r.prototype,"handleUnsubscribeClick",[o],Object.getOwnPropertyDescriptor(r.prototype,"handleUnsubscribeClick"),r.prototype),r)},89604:(e,t,s)=>{"use strict";s.d(t,{H:()=>u});s(41817);var i=s(12953),o=s(2439),r=s(10553),n=s(87864),a=s(82959),l=s(19755),c=s.n(l);function d(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class u extends o.v{constructor(e,t){super(t),d(this,"_isRendered",!1),this.id=e,this._isRendered=Boolean(this.el),this.children.setInitData({isChildrenShown:!1})}render(){if(this.isRendered||this.el)return void(this._isRendered=!0);const e=this._options.el=c()('<div class="comment-hidden-group"/>')[0];e.appendChild(this.children.$childrenContainer),e.appendChild(this.$toggleChildren),this._isRendered=!0}mount(){this.isMounted||(!this.el||!this.el.parentElement&&this.parent?(this.parent.children.mountChild(this),this._isMounted=!0):this._isMounted=!0)}setDOM(e){this._options.el=e,this._isRendered=!0}open(){this.children.isChildrenShown=!0,this.parent&&this.parent.open()}get el(){return this._options.el}get $toggleChildren(){var e;if(this._options.$toggleChildren)return this._options.$toggleChildren;const t=null===(e=this.el)||void 0===e?void 0:e.querySelector(":scope > .comment-hidden-group__toggle");if(t instanceof HTMLElement)return t;const s=i.core.i18n("comments.button.toggle-hidden-group-children",this.children.items.length);return this._options.$toggleChildren=(0,n.m)(`<div class="comment-hidden-group__toggle">\n\t\t\t\t\t<div class="comment-toggle-children__icon">${(0,r.t)("comments__toggle")}</div>\n\t\t\t\t\t${s}\n\t\t\t\t</div>`)}get depth(){return this.parent.depth}get parent(){return this._options.parent}get parentComment(){return this._options.parent}get children(){return this._children?this._children:this._children=new a.B(this)}get comments(){return this._options.comments}get isRendered(){return this._isRendered}get isMounted(){return!0===this._isMounted}get isChildCommentsInitialized(){if(0===this.children.items.length)return!0;for(let e=this.children.items.length-1;e>=0;e--){const t=this.children.items[e];if(!t.isRendered||!t.isChildCommentsInitialized)return!1}return!0}}},85456:(e,t,s)=>{"use strict";s.d(t,{U:()=>r});var i=s(12953),o=s(56927);function r(){o.z.getInstance().init(),i.core.ui.player.init()}},33727:(e,t,s)=>{"use strict";s.r(t),s.d(t,{UIAllComments:()=>b});s(66992),s(33948),s(88674),s(41817);var i=s(12953),o=s(12950),r=s(29086),n=s(6393),a=s(47994),l=s(19755),c=s.n(l),d=s(72426),u=s(55837),p=s(33877),h=s(53056),_=s(85456),m=s(95593),g=s(42107),v=s(68505),f=s(45990);function y(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class b extends r.t{constructor(...e){super(...e),y(this,"isFullTree",!0)}render(){return this.isRendered||(super.render(),d.X.getInstance().init(this.comments),u.F.getInstance().init(),f.L.getInstance().init(this.comments),this.$el&&this.$el.is(":hidden")?this.initWithoutDom():this.initByDom(),this.enableDetectUnload()),this}initByDom(){var e;const t=null===(e=this.$els)||void 0===e?void 0:e.comments;this.$el&&t&&(this.initComments(),this.initMainReply(),this.setMaxCommentIdToStorage())}async initWithoutDom(){var e;if(!this.$el)return;this.$el.show();const t=i.core.ui.player.createAnimation("comments-spinner",{$parent:c()('<div class="comments__spinner"></div>').appendTo(this.$el.find(".comments"))}),s=Date.now();t.play();const{data:r}=await o.cf.post(n.WB,{action:"get_story_comments",story_id:this.story.id||56});await(0,p.g)(500-(Date.now()-s)),t.stop(),t.$parent.remove(),t.destroy();const a=r.comments;this.emit("commentsLoaded",{total:r.total});const l=null===(e=this.$els)||void 0===e?void 0:e.comments;l&&(a.forEach((e=>l.append(e.html))),this.comments.initCommentByTree(l,r.snapshot),(0,_.U)(),this.initMainReply(),this.setMaxCommentIdToStorage())}getMaxCommentIdFromStorage(){return this.meta.isUserInComments?0:this.getMaxCommentIdStorage().get(this.meta.storyId)||0}getDisableReplyMessage(){if(!i.core.isUserAuthorized)return{message:'\n\t\t\t\t\tЧтобы оставить комментарий,\n\t\t\t\t\tнеобходимо <a href="#signup" class="to-signup">зарегистрироваться</a>\n\t\t\t\t\tили <a href="#signin" class="to-signin">войти</a>\n\t\t\t\t',type:"default"};if(i.core.isUserBanned||i.core.isFullyBanned)return{message:i.core.i18n("comments.reply.banned"),type:"warning"};if(this.meta.ignoreType===a.IV.COMMUNITY_IGNORES_YOU&&!i.core.isUserModerator){let e=c()('.community-info-block[data-type="about"] .community__title > a').text();return e=e&&e.length?` «${e}»`:e,{message:i.core.i18n("comments.ignore."+(0,m.S)(a.IV,this.meta.ignoreType),e),type:"warning"}}}initMainReply(){const e=this.$('section[data-role="answer"]');if(!e||!e.length)return this;if(i.core.initParams.isDeleted)return this;const t=this.getDisableReplyMessage();if(t)return e.addClass("warning"===t.type?"story-comments__comments-disabled":"section_gray").html(t.message).show(),this;const s=this.comments.get(n.iM);if(!s)return this;g.cp.getInstance().sendEvent("form_show",{type:"add_comment"}),s.replyEditor.$replyWrapper=e.addClass("section_padding_none").show().get(0);const o=(0,v.m)(s.replyEditor.$replyWrapper,(({isIntersecting:e})=>{e&&(s.replyEditor.show("create"),o())}),{rootMargin:"500px 0px"});return this.listenToOnce(s.replyEditor,"add",(()=>{var e;this.el&&(null===(e=this.el.parentElement)||void 0===e||e.classList.remove("story-comments_empty"))})),this}enableDetectUnload(){this.listenTo(i.core.ui,"beforeunload",(e=>{this.setMaxCommentIdToStorage();const t=this.comments.items.find((e=>e.replyEditor.hasUnsavedChanges()));if(!t)return;this.timeout("close-timeout",500,(()=>{const e=t.replyEditor.$replyWrapper;var s;(t.highlight("yellow",!0),e&&!i.core.ui.elementInViewport(e))&&i.core.ui.scrollTo(((null===(s=c()(e).offset())||void 0===s?void 0:s.top)||0)-50,!0)}));const s=i.core.i18n("comments.before-exit");return e.returnValue=s,s})),this.listenTo(i.core.ui,"unload",(()=>{this.cancelTimeout("close-timeout")}))}getMaxCommentIdStorage(){const e=h.m.get(n.Ck);return new Map(Array.isArray(e)?e.filter((e=>Array.isArray(e)&&2===e.length)):[])}setMaxCommentIdToStorage(){if(this.meta.isUserInComments)return;const e=this.meta.storyId,t=h.m.get(n.Ck),s=new Map(Array.isArray(t)?t.filter((e=>Array.isArray(e)&&2===e.length)):[]);s.delete(e),s.set(e,Math.max(...this.comments.items.map((e=>e.id)))),s.size>n.Wk&&s.delete(s.keys().next().value),h.m.set(n.Ck,Array.from(s.entries()))}}},28217:(e,t,s)=>{"use strict";s.d(t,{C:()=>S});s(85827),s(88674);var i,o,r,n=s(12950),a=s(12953),l=s(29086),c=s(70807),d=s(42512),u=s(65542),p=s(47994),h=s(33877),_=s(19755),m=s.n(_),g=s(85456),v=s(72426),f=s(75223),y=s(42107),b=s(48591),w=s(45990);function k(e,t,s,i,o){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=s.slice().reverse().reduce((function(s,i){return i(e,t,s)||s}),r),o&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(o):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}let S=(i=(0,c.p)("click",".comments__show-parent"),o=(0,c.p)("click",".comment-toggle-children_not-loaded"),k((r=class extends l.t{onShowParent(e,t){const s=e.children.items[0];if(!(s&&s instanceof d.U&&s.el))return;s.children.isChildrenShown=!0,s.el.classList.toggle("comment_hidden-body"),s.el.classList.toggle("comment_show");const i=t.currentTarget.classList.toggle("collapse-button_active"),o=t.target;requestIdleCallback((()=>{if(this.isDestroyed)return;const e=o.closest(".comments");if(e){var t;const{commentId:s,storyId:o,storyAuthorId:r}=e.dataset,n=null===(t=e.querySelector(`#comment_${s}`))||void 0===t?void 0:t.dataset.authorId;y.cp.getInstance().sendEvent(i?"hide_parent_comment_button_tapped":"show_parent_comment_button_tapped",{comment_id:s,comment_author_id:n,post_id:o,author_id:r})}}))}async onShowChildren(e){if(this.comments.ui.mode===p.lL.SUBS_FEED){window.open(e.url+"#comments","_blank");try{await(0,b.zJ)(e.id),e.isNewest=!1}catch(c){a.core.ui.toasts.showError(c)}return}const t=e.children.$toggleChildren;if(!e.hasChildren||null==t||!t.classList.contains("comment-toggle-children_not-loaded"))return;t.classList.remove("comment-toggle-children_not-loaded"),t.classList.add("comment-toggle-children_loading");const s=m()(`<div class="comment__placeholder" style="display: block">\n\t\t\t${(0,f.Z)()}\n\t\t</div>`);e.children.$childrenContainer.insertAdjacentElement("afterbegin",s.get(0));const i=Date.now(),{response:o,data:r}=await n.cf.post("/ajax/comments_actions.php",{action:"get_comments_subtree",id:e.id});if(await(0,h.g)(500-(Date.now()-i)),s.remove(),t.classList.remove("comment-toggle-children_loading"),!o.result||!e.children.$childrenContainer)return a.core.logger.error("comments","problem with `get_comments_subtree`"),void e.children.$childrenContainer.insertAdjacentHTML("afterbegin","Не удалось загрузить комментарии :(");if(e.children.$childrenContainer.insertAdjacentHTML("afterbegin",r.html),this.comments.add(u.g.createCommentsListByDom(e)),(0,g.U)(),this.mode===p.lL.INCOMING){var l;const e=r.fresh_comments_count||0,t=m()('.bell[data-role="answers"]'),s=Math.min(Math.max(0,null!==(l=Number(t.text()))&&void 0!==l?l:0)-e,99);t.text(s).toggle(s>0)}}toggleChildren(e){super.toggleChildren(e),this.onShowChildren(e)}render(){return this.isRendered||(super.render(),w.L.getInstance().init(this.comments),a.core.on("comment_edit",this.delegateEditComment.bind(this)),v.X.getInstance().init(this.comments)),this}delegateEditComment({id:e,content:t}){if(this.$el&&this.$el.hasClass("comments_show"))return;const s=this.comments.get(e);if(!s||!s.isAuthorCurrentUser||!s.$content)return;const i=m()(t).find(".comment__content").html();i&&(s.$content.innerHTML=i)}}).prototype,"onShowParent",[i],Object.getOwnPropertyDescriptor(r.prototype,"onShowParent"),r.prototype),k(r.prototype,"onShowChildren",[o],Object.getOwnPropertyDescriptor(r.prototype,"onShowChildren"),r.prototype),r)},23627:(e,t,s)=>{"use strict";s.d(t,{z:()=>u});s(88674),s(66992),s(33948);var i=s(12953),o=s(12950),r=s(43241),n=s(19755),a=s.n(n),l=s(28217),c=s(85456),d=s(61547);class u extends r.u{static async markAllAsRead(){const{response:e}=await o.cf.post("/ajax/comments_actions.php",{action:"mark_readed_all"});return e.result||i.core.ui.toasts.showError(e.message||"Извините, произошла ошибка"),e.result}static async markAsRead(e){const{response:t}=await o.cf.post("/ajax/comments_actions.php",{action:"mark_readed",ids:e});return t.result||i.core.ui.toasts.showError(t.message||"Извините, произошла ошибка"),t.result}render(){return this.isRendered||super.render(),this}initComments(){return this.$el?([...this.$el.find(".comments")].forEach((e=>{if(e.dataset.hasInit)return;e.dataset.hasInit="1";new l.C({story:this._options.story,$el:a()(e),mode:this._options.mode}).initComments()})),(0,c.U)(),this):this}addComments(){if(!this.$el)return[];const e=[...this.$el.find(".comments")].map((e=>{if((0,d.Y)(e)instanceof l.C)return;const t=new l.C({story:this._options.story,$el:a()(e),mode:this._options.mode});return t.initComments(),t}));return(0,c.U)(),e.filter(Boolean)}}},29086:(e,t,s)=>{"use strict";s.d(t,{t:()=>Ne});s(41817),s(66992),s(33948),s(85827),s(88674);var i=s(12953),o=s(72044),r=s(33324),n=s(88358),a=s(96637),l=s(65542),c=s(89604),d=s(47994),u=s(95593),p=s(43241),h=s(19755),_=s.n(h),m=s(70807),g=s(90312),v=s(72426),f=s(20794),y=s(85456),b=s(36005);function w(e){var t,i="",o=b.escape;Array.prototype.join;const r=s(61308).Z;return i+='\n\n<div class="popup-menu">\n    <div class="popup-menu__step">\n        ',e.canBanByStoryAuthor&&(i+="\n            "+(null==(t=r())?"":t)+"\n        "),i+="\n        ",e.canSubscribe&&(i+='\n        <div class="popup-menu__item" data-role="sub">\n            <div class="popup-menu__label">\n                Подписаться на ответы\n                ',e.showSubsribeNewBadge&&(i+='\n                    <span class="pkb-badge" style="margin-left: 8px">новое</span>\n                '),i+="\n            </div>\n        </div>\n        "),i+="\n        ",e.canUnsubscribe&&(i+='\n        <div class="popup-menu__item" data-role="unsub">\n            <div class="popup-menu__label">Убрать из подписок</div>\n        </div>\n        '),i+='\n        <div class="popup-menu__item" data-role="share">\n            <div class="popup-menu__label">Поделиться</div>\n        </div>\n        <div class="popup-menu__item" data-role="link">\n            <div class="popup-menu__label">Скопировать ссылку</div>\n        </div>\n        ',e.isLinkTo&&(i+='\n        <a class="popup-menu__item" data-role="link-to" href="'+o(e.copyUrl?e.copyUrl:e.url)+'">\n            <div class="popup-menu__label">Перейти к комментарию</div>\n        </a>\n        '),i+="\n        ",e.isComstory||(i+='\n        <div class="popup-menu__item" data-role="save">\n            <div class="popup-menu__label">'+(null==(t=e.isSaved?"Убрать из сохранённого":"Сохранить")?"":t)+"</div>\n        </div>\n        "),i+="\n        ",e.hasChildren&&(i+='\n            <div class="popup-menu__item" data-role="toggle-branch">\n                <div class="popup-menu__label">'+(null==(t=e.isChildrenShown?"Свернуть":"Показать")?"":t)+" ветку</div>\n            </div>\n        "),i+='\n        <div class="popup-menu__item" data-role="complain">\n            <div class="popup-menu__label">Пожаловаться</div>\n        </div>\n        ',e.canPinAuthors&&(i+='\n            <div class="popup-menu__item" data-role="pin">\n                <div class="popup-menu__label">Закрепить</div>\n            </div>\n        '),i+="\n        ",e.canUnpinAuthors&&(i+='\n        <div class="popup-menu__item" data-role="unpin">\n            <div class="popup-menu__label">Открепить</div>\n        </div>\n        '),i+='\n    </div>\n    <div class="popup-menu__step" style="display: none">\n        <a class="popup-menu__item" data-role="tg" href="https://t.me/share/url?url='+o(e.url+encodeURIComponent("&utm_source=tgshare&utm_medium=sharing"))+'" target="_blank" rel="nofollow noopener">\n            <div class="popup-menu__icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--social__telegram"><use xlink:href="#icon--social__telegram"></use></svg></div>\n            <div class="popup-menu__label">Telegram</div>\n        </a>\n        <a class="popup-menu__item" data-role="ok" href="https://connect.ok.ru/offer?url='+o(e.url+encodeURIComponent("&utm_source=okshare&utm_medium=sharing"))+'" target="_blank" rel="nofollow noopener">\n            <div class="popup-menu__icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--social__ok"><use xlink:href="#icon--social__ok"></use></svg></div>\n            <div class="popup-menu__label">Одноклассники</div>\n        </a>\n        <a class="popup-menu__item" data-role="vk" href="https://vk.com/share.php?url='+o(e.url+encodeURIComponent("&utm_source=vshare&utm_medium=sharing"))+'" target="_blank" rel="nofollow noopener">\n            <div class="popup-menu__icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__share_social_vk"><use xlink:href="#icon--ui__share_social_vk"></use></svg></div>\n            <div class="popup-menu__label">Вконтакте</div>\n        </a>\n    </div>\n</div>'}var k=s(36005);function S(e){var t="",s=k.escape;Array.prototype.join;return t+='<div class="popup-menu">\n    ',e.pdsLink&&(t+='\n        <a class="popup-menu__item" href="'+s(e.pdsLink)+'" target="_blank">\n            <div class="popup-menu__icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__settings icon--ui__settings_comment-moderator"><use xlink:href="#icon--ui__settings"></use></svg></div>\n            <div class="popup-menu__label">PDS</div>\n        </a>\n    '),t+="\n\n    ",e.canBanByCommunity&&(t+='\n        <div class="popup-menu__item" data-role="ban-community">\n            <div class="popup-menu__icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__ban icon--ui__ban_comments"><use xlink:href="#icon--ui__ban"></use></svg></div>\n            <div class="popup-menu__label">Внести в игнор-лист сообщества</div>\n        </div>\n    '),t+="\n\n    ",e.canBanByModerator&&(t+='\n        <div class="popup-menu__item" data-role="ban-moderator">\n            <div class="popup-menu__icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__ban icon--ui__ban_comments"><use xlink:href="#icon--ui__ban"></use></svg></div>\n            <div class="popup-menu__label">Заблокировать пользователя</div>\n        </div>\n    '),t+="\n\n    ",e.canDeletedByModerator&&(t+='\n        <div class="popup-menu__item" data-role="remove-moderator">\n            <div class="popup-menu__icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__remove icon--ui__remove_comments"><use xlink:href="#icon--ui__remove"></use></svg></div>\n            <div class="popup-menu__label">Удалить комментарий</div>\n        </div>\n    '),t+="\n\n    ",e.canRestoreByModerator&&(t+='\n        <div class="popup-menu__item" data-role="restore-moderator">\n            <div class="popup-menu__icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__undo icon--ui__undo_comments"><use xlink:href="#icon--ui__undo"></use></svg></div>\n            <div class="popup-menu__label">Восстановить</div>\n        </div>\n    '),t+="\n\n    ",e.editionHistoryLink&&(t+='\n        <a class="popup-menu__item" href="'+s(e.editionHistoryLink)+'" target="_blank">\n            <div class="popup-menu__icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__book icon--ui__book_comments"><use xlink:href="#icon--ui__book"></use></svg></div>\n            <div class="popup-menu__label">Журнал изменений</div>\n        </a>\n    '),t+="\n    ",e.canHide&&(t+='\n        <div class="popup-menu__item" data-role="branch-hide">\n            <div class="popup-menu__icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__eye icon--ui__eye_comments"><use xlink:href="#icon--ui__eye"></use></svg></div>\n            <div class="popup-menu__label">Скрыть ветку</div>\n        </div>\n    '),t+="\n    ",e.canReveal&&(t+='\n        <div class="popup-menu__item" data-role="branch-show">\n            <div class="popup-menu__icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__eye-close icon--ui__eye-close_comments"><use xlink:href="#icon--ui__eye-close"></use></svg></div>\n            <div class="popup-menu__label">Показать ветку</div>\n        </div>\n    '),t+="\n</div>"}var O,E,C,x,T=s(58330),I=s(49463),P=s(91904),A=s(42107),D=s(96883),M=s(26639),R=s(86455),N=s(81780),B=s(68505),L=s(82800),j=s(31200),$=s(6393),U=s(2439);function F(e,t,s,i,o){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=s.slice().reverse().reduce((function(s,i){return i(e,t,s)||s}),r),o&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(o):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}let V=(O=(0,m.p)("click",$.xk),E=(0,m.p)("click",'span[data-role="unbest"]'),x=class e extends U.v{constructor(e){super(),this.comments=e,this.initEvents(),this.initBestAnswerOnboarding()}initEvents(){var e,t;null===(e=this.__meta)||void 0===e||null===(t=e.listDelegatedEvents)||void 0===t||t.forEach((({events:e,selector:t,handler:s})=>{this.comments.$el&&this.comments.$el.on(e,t,(e=>{const t=this.comments.getCommentByElement(e.target);t&&s.call(this,t,e)}))}))}onBestClick(e){var t,s,i,o,r,a;if(e.bestAnswer.isBestAnswer)return;const l=null===(t=e.el)||void 0===t||null===(s=t.querySelector(".comment__user"))||void 0===s?void 0:s.cloneNode(!0),c=null===(i=e.el)||void 0===i||null===(o=i.querySelector(".comment__datetime"))||void 0===o?void 0:o.cloneNode(!0),d=null===(r=e.el)||void 0===r||null===(a=r.querySelector(".comment__content"))||void 0===a?void 0:a.cloneNode(!0),u=new n.LD({width:520,isHeaderLeftAlign:!0,isBottomWidget:!1,isModalMenu:!1,wrapperExtraClass:"popup_best-answer",content:`\n\t\t\t<h2>Выбрать этот ответ в качестве лучшего?</h2>\n\t\t\t<div class="comment comment_popup">\n\t\t\t\t<div class="comment__body">\n\t\t\t\t\t<div class="comment__header">\n\t\t\t\t\t\t<div class="comment__user">\n\t\t\t\t\t\t\t${(null==l?void 0:l.innerHTML)||""}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<time class="comment__datetime">\n\t\t\t\t\t\t\t${(null==c?void 0:c.innerHTML)||""}\n\t\t\t\t\t\t</time>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="comment__content">\n\t\t\t\t\t\t${(null==d?void 0:d.innerHTML)||""}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>`}),p=()=>{u.hide()};u.addButtonIntoFooter("Выбрать",(()=>{this.comments.comments.items.forEach((t=>{var s,i;t!==e&&(null===(s=t.el)||void 0===s||null===(i=s.querySelector($.xk))||void 0===i||i.setAttribute("hidden","hidden"))})),e.bestAnswer.setBestAnswer(!0);const t=this.comments.getBaseAnalyticsParameters(e);g.c.getInstance().sendEvent("best_answer_popup_approve_button_tapped",t),p()}),R.j.SUCCESS),u.addButtonIntoFooter("Отмена",p),u.addCloseIcon({modificatorCss:"default"}),u.on(N.e.UNMOUNTED,(()=>{const t=this.comments.getBaseAnalyticsParameters(e);g.c.getInstance().sendEvent("best_answer_popup_closed",t)})),u.show();const h=this.comments.getBaseAnalyticsParameters(e);g.c.getInstance().sendEvent("best_answer_popup_showed",h)}onUnbestClick(e,t){t.stopPropagation(),this.comments.comments.items.forEach((e=>{var t,s;null===(t=e.el)||void 0===t||null===(s=t.querySelector($.xk))||void 0===s||s.removeAttribute("hidden")})),e.bestAnswer.setBestAnswer(!1)}initBestAnswerOnboarding(){var t;if(e.onboardingInitialized)return;e.onboardingInitialized=!0;const s=null===(t=this.comments.el)||void 0===t?void 0:t.querySelector('span[data-role="best"]:not(.comment__best-answer_is-best)');if(!s)return;const i=(0,B.m)(s,(e=>{e.isIntersecting&&(i(),this.showNotificationPopup(s))}),{threshold:1})}async showNotificationPopup(e){const t="best_answer_info",s=await(0,j.kd)({id:t,autoCloseIfTargetNotVisible:!1,autoCloseOutsideClick:!1,target:e,theme:L.xb.GREEN,direction:L.Lh.TOP,title:"Выберите лучший ответ",text:"У ответа появится отметка «Лучший», которую увидят все, и автор комментария получит больше рейтинга.",btnConfig:{label:"Понятно"},width:292});null==s||s.on(N.e.MOUNTED,(()=>{g.c.getInstance().sendEvent("tip_show",{type:t})})),null==s||s.on(N.e.UNMOUNTED,(()=>{g.c.getInstance().sendEvent("tip_close",{type:t})}))}},H=x,z=!1,(Z=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(Z="onboardingInitialized"))in H?Object.defineProperty(H,Z,{value:z,enumerable:!0,configurable:!0,writable:!0}):H[Z]=z,F((C=x).prototype,"onBestClick",[O],Object.getOwnPropertyDescriptor(C.prototype,"onBestClick"),C.prototype),F(C.prototype,"onUnbestClick",[E],Object.getOwnPropertyDescriptor(C.prototype,"onUnbestClick"),C.prototype),C);var H,Z,z,q=s(61308),W=s(87540);function G(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Y="dropdown:mounted",K="dropdown:hidden";class X extends p.u{constructor(...e){super(...e),G(this,"_isLoading",!0),G(this,"banCount",0),G(this,"els",{container:null})}static showBanUserOptions(e,t){if(!e||!t.canBanByStoryAuthor)return;let s=X.authorModerationToolsMap.get(t.id);if(s)s.show();else{X.authorModerationToolsMap.set(t.id,new X({el:e,commentId:t.id,userId:t.authorId})),s=X.authorModerationToolsMap.get(t.id);{const e="comment__body_active";this.listenTo(s,Y,(()=>{t.$body.classList.add(e)})),this.listenTo(s,K,(()=>{t.$body.classList.remove(e)}))}s.show()}}static deleteBanUserOptionsFromMap(e){this.authorModerationToolsMap.delete(e.id)}show(){return this.el?(this.initDropdown(),super.show(),this):this}initDropdown(){if(this.dropdown)return void this.dropdown.show();this.dropdown=new n._({target:this.el,content:(0,q.Z)(),alignment:n.SE.END,direction:n.Lh.BOTTOM,autoCorrectPosition:!0,distance:4,showArrow:!1}),this.els.container=this.dropdown.content.get(0).querySelector(".author-moderation-tools");const e="comment__tool_active";this.listenTo(this.dropdown,"uiMounted",(()=>{var t;null===(t=this.el)||void 0===t||t.classList.add(e),this.emit(Y)})),this.listenTo(this.dropdown,"uiHidden",(()=>{var t;null===(t=this.el)||void 0===t||t.classList.remove(e),this.emit(K)})),this.initOptionsHandlers(),(async()=>{try{this.dropdown.show(),await this.checkPermanentBanStatus()}catch(b){this.dropdown.hide()}finally{this.isLoading=!1}})()}async initMenu(){if(this.el){this.els.container=this.el;try{await this.checkPermanentBanStatus(),this.initOptionsHandlers()}catch(e){i.core.ui.toasts.showError(e.message)}finally{this.isLoading=!1}}}initOptionsHandlers(){var e,t;this.els.container&&(null===(e=this.els.container.querySelector(".author-moderation-tools__temporary"))||void 0===e||e.addEventListener("click",(()=>{this.isLoading||this.banUser()})),null===(t=this.els.container.querySelector(".author-moderation-tools__permanent"))||void 0===t||t.addEventListener("click",(()=>{!this.isLoading&&this.isPermanentAvailable()&&this.banUser(!0)})))}async checkPermanentBanStatus(){try{this.banCount=await(0,W.Ni)(this._options.userId)}catch(s){i.core.ui.toasts.showError(s)}finally{var e,t;if(!this.isPermanentAvailable())null===(e=this.els.container)||void 0===e||null===(t=e.querySelector(".author-moderation-tools__permanent"))||void 0===t||t.setAttribute("hidden","hidden")}}async banUser(e=!1){var t;null===(t=this.dropdown)||void 0===t||t.hide(),this.isLoading=!0;try{await(0,W.sD)(this._options.commentId,e)&&(A.cp.getInstance().sendEvent("user_banned",{type:"for_author",content_type:e?"forever":"temporary"}),i.core.ui.toasts.add("author-moderation-ban",{content:"Пользователь успешно заблокирован"}),i.core.emit("author-moderation:ban",this._options.userId))}catch(s){i.core.ui.toasts.showError(s)}finally{this.isLoading=!1}}isPermanentAvailable(){return this.banCount>=X.TEMP_BAN_COUNT}get isLoading(){return this._isLoading}set isLoading(e){var t;this._isLoading=e,null===(t=this.els.container)||void 0===t||t.classList.toggle("author-moderation-tools_loading",e)}}G(X,"TEMP_BAN_COUNT",3),G(X,"authorModerationToolsMap",new Map);var J,Q,ee,te,se,ie,oe,re,ne,ae,le,ce,de,ue,pe,he,_e,me,ge,ve,fe,ye,be,we,ke,Se,Oe,Ee,Ce,xe=s(34524),Te=s(22470),Ie=s(45990);function Pe(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function Ae(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(s),!0).forEach((function(t){De(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Pe(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function De(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Me(e,t,s,i,o){var r={};return Object.keys(i).forEach((function(e){r[e]=i[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=s.slice().reverse().reduce((function(s,i){return i(e,t,s)||s}),r),o&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(o):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}const Re=".comment__collapsing-area";let Ne=(J=(0,m.p)("click",".comment-hidden-group__toggle"),Q=(0,m.p)("click",".comment-toggle-children"),ee=(0,m.p)("click",".comment__more"),te=(0,m.p)("click",".comment__all-comments"),se=(0,m.p)("auxclick",".comment__all-comments"),ie=(0,m.p)("click",".comment__close-branch"),oe=(0,m.p)("click",".comment__rating-up,.comment__rating-down"),re=(0,m.p)("click",".comment__comstory-link"),ne=(0,m.p)("click",'.comment__tool[data-role="save"]'),ae=(0,m.p)("click",'.comment__tool[data-role="story-author-ban"]'),le=(0,m.p)("mouseenter",".comment__body"),ce=(0,m.p)("click",'.comment__tool[data-role="pin"]'),de=(0,m.p)("click",'.comment__tool[data-role="unpin"]'),ue=(0,m.p)("click",'.comment__tool[data-role="complain"]'),pe=(0,m.p)("click",'.comment__control[data-type="remove"]'),he=(0,m.p)("click",".comment__restore"),_e=(0,m.p)("click",'.comment__control[data-type="create"],.comment__control[data-type="edit"]'),me=(0,m.p)("click",'.comment__control[data-type="cancel"]'),ge=(0,m.p)("click",'.comment__tool[data-role="link"]'),ve=(0,m.p)("click",Re),fe=(0,m.p)("click",'.comment__tool[data-role="branch"]'),ye=(0,m.p)("click",'.comment__tool[data-role="to-parent"]'),be=(0,m.p)("click",'.comment__tool[data-role="from-parent"]'),we=(0,m.p)("click",".comment__user"),ke=(0,m.p)("click",".comment__moderator-menu"),Se=(0,m.p)("click",".comment__right"),Oe=(0,m.p)("click",".comment__body"),Ce=class e extends p.u{constructor(e){super(e),De(this,"isFullTree",!1),De(this,"isScrolling",!1),De(this,"sendViewAnalytics",(()=>this.comments.sendViewAnalytics())),this.comments=new l.g(this),this.extension=this.getUICommentsExtensionClass(),this.render()}getUICommentsExtensionClass(){const e=T.S.getInstance();if(e.has("UICommentsExtension")){return new(e.get("UICommentsExtension"))(this)}}sendBranchToggleAnalytics(e,t){g.c.getInstance().sendEvent(t?"comment_branch_show":"comment_branch_collapse",Ae({"post_id!empty":e.commentsMeta.storyId,"author_id!empty":e.commentsMeta.storyAuthorId,"rating!undefiend":e.voter.rating},this.getBaseAnalyticsParameters(e)))}static toFakeComment(e){i.core.ui.toasts.add("slice-mode",{content:'Родительский комментарий находится на другой стороне луны, <a href="'+i.core.history.location.pathname+(e?"?cid="+e:"#comments")+'">вылететь за ним</a>'})}onHiddenGroupToggleClick(e,t){const s=t.currentTarget.closest(".comment-hidden-group");requestIdleCallback((()=>{this.isDestroyed||g.c.getInstance().sendEvent("more_comments_in_branch_button_tapped",this.getBaseAnalyticsParameters(e))}));for(const i of e.children.items)if(i instanceof c.H&&i.el===s){const e=!i.children.isChildrenShown;if(i.children.isChildrenShown=e,!e)return;return void this.comments.loadNextPartChildrenComments(i,!1)}}onToggleChildrenClick(e,t){if(null==t||t.preventDefault(),this.mode===d.lL.SUBS_FEED)return;const s=!e.children.isChildrenShown;this.sendBranchToggleAnalytics(e,s),setTimeout((()=>e.children.isChildrenShown=s)),s&&(setTimeout((()=>this.comments.loadNextPartChildrenComments(e,!e.children.isOnlyHiddenGroupChildren&&e.isChildCommentsInitialized,!0))),g.c.getInstance().sendEvent("click_show_comments_thread",this.getBaseAnalyticsParameters(e)))}onMoreButtonClick(e){this.comments.items.forEach((e=>{e.isConcealed?e.isConcealed=!1:e.hasChildren&&(e.children.$toggleChildren.hidden=!1)}));const t=this.comments.unrevealedCommentsCount.total,s=this.comments.items.reduce(((e,t)=>e+(t.isRendered?1:0)),0);this.comments.loadNextPartChildrenComments(e),i.core.ui.emit("show-more-comments-click");const o=this.story.subsCode;g.c.getInstance().sendEvent("click_show_comments",Ae(Ae({post_id:this.meta.storyId,author_id:this.meta.storyAuthorId},o&&{type_i8:Number(o)}),{},{size:t},s<=6&&{type:"reveal_all_comments"}))}onAllCommentsClick(e,t){3!==t.button&&g.c.getInstance().sendEvent("transition_to_post",Ae({transition_source:"all_coments_on_comment_in_feed",screen_index:this.story?this.story.screenIndex+1:null},this.getBaseAnalyticsParameters(e)))}onCloseBranchClick(e){e.children.isChildrenShown=!1,e.scrollTo(!0)}onRatingToggleClick(e,t){const s=t.currentTarget.classList.contains("comment__rating-up")?d.OC.UP:d.OC.DOWN;this.vote(e,s)}onComstoryLinkClick(e){g.c.getInstance().sendEvent("transition_to_post",Ae(Ae({},this.getBaseAnalyticsParameters(e)),{},{type:"parent_post_comments"}))}vote(e,t){i.core.isUserAuthorized?i.core.isLostAccount?i.core.ui.toasts.showWarningMessage(i.ZF.LOST_ACCOUNT):e.voter.setVoteDirection(t):setTimeout((()=>{i.core.ui.authRequired({analyticsParams:Ae({reason:t===d.OC.UP?"plus":"minus"},this.getBaseAnalyticsParameters(e))}),g.c.getInstance().sendEvent("click",Ae(Ae({},this.getBaseAnalyticsParameters(e)),{},{type:"comment_rate",user_rate:t}))}))}onSaveClick(e){var t;if(i.core.isComstory)return;if(!i.core.isUserAuthorized)return void i.core.ui.authRequired({analyticsParams:Ae({reason:"save_comment"},this.getBaseAnalyticsParameters(e))});const s=!e.saver.isSaved;e.saver.isSaved=s,null===(t=e.saver.$toolSave)||void 0===t||t.classList.toggle("comment__tool_active",s),g.c.getInstance().sendEvent(s?"save_comment":"unsave_comment",this.getBaseAnalyticsParameters(e))}onBanClick(e,t){X.showBanUserOptions.call(this,t.currentTarget,e)}async onBodyHover(e){if(!e.el||e.isComstory)return;const t=e.el.querySelector('.comment__tools [data-role="sub"]'),s=await(0,Te.gl)(t);if(!s)return;const i="comment__body_active",o="comment__tool_highlight";this.listenTo(s,N.e.MOUNTED,(()=>{null==t||t.classList.add(o),e.$body.classList.add(i)})),this.listenTo(s,N.e.UNMOUNTED,(()=>{null==t||t.classList.remove(o),e.$body.classList.remove(i)}))}async onPinClick(e){if(i.core.initParams.isDeleted)return void i.core.ui.authRequired();i.core.ui.toasts.add({content:"Закрепляем"});await e.togglePinAuthors(!0)&&(D.d.send("commentPinned",{authorId:this.meta.storyAuthorId,postId:this.meta.storyId,commentId:e.id,commentAuthorId:e.authorId}),this.addScrollToCommentsHistoryStateAndReload())}async onUnpinClick(e){if(i.core.initParams.isDeleted)return void i.core.ui.authRequired();i.core.ui.toasts.add({content:"Открепляем"});await e.togglePinAuthors(!1)&&(D.d.send("commentUnpinned",{authorId:this.meta.storyAuthorId,postId:this.meta.storyId,commentId:e.id,commentAuthorId:e.authorId}),this.addScrollToCommentsHistoryStateAndReload())}addScrollToCommentsHistoryStateAndReload(){i.core.ui.scrollRestoration="manual",i.core.history.replaceState({scrollToComments:!0},document.title,i.core.history.location.href),i.core.history.location.reload()}onComplainClick(e){if(!i.core.isUserAuthorized)return void i.core.ui.authRequired({analyticsParams:Ae({reason:"report"},this.getBaseAnalyticsParameters(e))});const t=e.isComstory?"post":"comment";new r.n({destroyAfterHide:!0,targetId:e.isComstory?e.parentStoryId:e.id,authorId:e.authorId,targetType:t,name:"UIComplainModalPopup",closeHintShown:!0}).show()}onRemoveClick(e){e.isEditable&&e.removeByCurrentUser()}onRestoreClick(e,t){t.preventDefault(),e.restoreByCurrentUser()}onCreateOrEditClick(t,s){if(!(0,f.s)(t,!0,{analyticsParams:Ae({reason:"reply"},this.getBaseAnalyticsParameters(t))}))return void g.c.getInstance().sendEvent("click",Ae(Ae({},this.getBaseAnalyticsParameters(t)),{},{type:"comment_reply"}));if(this.mode===d.lL.SUBS_FEED)return xe.x.set(e.REPLY_FORM_OPEN,"1"),window.open(t.url,"_blank"),void g.c.getInstance().sendEvent("reply_comment_button_tapped",Ae({},this.getBaseAnalyticsParameters(t)));const i=s.currentTarget.getAttribute("data-type");"create"===i&&this.sendControlEvent("reply_comment_button_tapped",t),setTimeout((async()=>{for(const e of this.comments)!e.isRoot&&e.replyEditor.isReplyShown&&e.replyEditor.hide();await(0,M.W)(),t.replyEditor.show(i)}))}onCancelClick(e,t){e.replyEditor.hide();"cancel"===t.currentTarget.getAttribute("data-type")&&this.sendControlEvent("reply_comment_cancel_button_tapped",e)}async onClickLink(e,t){if(t.ctrlKey||t.metaKey||![d.lL.MAIN,d.lL.STORY_AUTHOR,d.lL.STORY_TOP,d.lL.BEST,d.lL.SUBS_FEED].includes(this.comments.ui.mode))return;t.preventDefault(),e.isComstory||this.comments.ui.mode!==d.lL.MAIN||i.core.history.replaceState({},"",e.url),i.core.ui.elementInViewport(e.el)||await e.scrollTo(),this.animationFrame("link-highlight",(()=>e.highlight("green",!0))),"clipboard"in navigator&&await navigator.clipboard.writeText(e.url);const s=_()(t.target).data("hint");s&&(s.content.find(".popup__hint").html("Скопирована!"),s.isShown||s.show(),s.updatePosition(),s.destroyAfterHide=!0),g.c.getInstance().sendEvent("comment_shared",Ae(Ae({},this.getBaseAnalyticsParameters(e)),{},{type:"copy_link"}))}async onCollapsingAreaClick(t,s){s.preventDefault(),s.stopPropagation(),t.isFake?e.toFakeComment():(i.core.ui.elementInViewport(t.$body)||await t.scrollTo(!0),t.children.isChildrenShown=!1,t.highlight("green",!0,!0),this.sendBranchToggleAnalytics(t,!1))}onBranchClick(e){this.currentBranchId=this.currentBranchId===e.id?void 0:e.id}onToParentClick(e){this.highlightParent(e.id)}onFromParentClick(){this.highlightParent(null)}onUserClick(e){g.c.getInstance().sendEvent("transition_to_author",Ae(Ae({screen_index:this.story?this.story.screenIndex+1:null},this.getBaseAnalyticsParameters(e)),this.comments.ui.mode!==d.lL.STORY_TOP&&{type:"comments"}))}onModeratorMenuClick(e,t){const s=t.currentTarget.dataset,i=new n.LD({content:_()(S({editionHistoryLink:s.ehl,pdsLink:s.pl,canBanByCommunity:"true"===s.bc,canBanByModerator:"true"===s.bm,canDeletedByModerator:"true"===s.dm,canRestoreByModerator:"true"===s.rm,canHide:s.ch,canReveal:s.cr}))});this.listenTo(i,"uiMounted",(()=>i.$el.addClass("popup_modal-menu")));const o=()=>i.hide();i.addButtonIntoFooter("закрыть",o),i.content.on("click",'.popup-menu__item[data-role="ban-community"]',(()=>v.X.getInstance().showBanPopup(e,e.controls.$controls,!0))),i.content.on("click",'.popup-menu__item[data-role="ban-moderator"]',(()=>v.X.getInstance().showBanPopup(e,e.controls.$controls))),i.content.on("click",'.popup-menu__item[data-role="remove-moderator"]',(async()=>{await v.X.getInstance().onRemove(e)&&(delete s.dm,s.rm=!0)})),i.content.on("click",'.popup-menu__item[data-role="restore-moderator"]',(async()=>{await v.X.getInstance().onRestore(e)&&(delete s.rm,s.dm=!0)})),i.content.on("click",'.popup-menu__item[data-role="branch-hide"]',(async()=>{await v.X.getInstance().onBranchHide(e)&&(delete s.ch,s.cr=!0)})),i.content.on("click",'.popup-menu__item[data-role="branch-show"]',(async()=>{await v.X.getInstance().onBranchShow(e)&&(delete s.cr,s.ch=!0)})),i.content.on("click",".popup-menu__item",o),i.show()}onExtraButtonClick(e){const t=void 0!==e.isSubscribed,s=new n.LD({content:_()(w({url:e.url,copyUrl:e.copyUrl,isSaved:e.saver.isSaved,isComstory:e.isComstory,isLinkTo:this.mode!==d.lL.MAIN,hasChildren:e.hasChildren,isChildrenShown:e.children.isChildrenShown,canUnpinAuthors:e.canUnpinAuthors,canPinAuthors:e.canPinAuthors,canBanByStoryAuthor:e.canBanByStoryAuthor,canSubscribe:t&&!e.isSubscribed,canUnsubscribe:t&&e.isSubscribed,showSubsribeNewBadge:new Date(Te.tP)>new Date}))});this.listenTo(s,"uiMounted",(()=>s.$el.addClass("popup_modal-menu"))),this.listenTo(s,"uiUnmounted",(()=>X.deleteBanUserOptionsFromMap(e)));const o=()=>{s.hide()};s.addButtonIntoFooter("закрыть",o),s.content.on("click",'.popup-menu__item[data-role="share"]',(t=>(g.c.getInstance().sendEvent("comment_share_button_tapped",Ae(Ae({},this.getBaseAnalyticsParameters(e)),{},{type:"meatballs"})),t.stopImmediatePropagation(),void s.content.find(".popup-menu__step").slideToggle(300)))),s.content.on("click",'.popup-menu__item[data-role="toggle-branch"]',(()=>this.toggleChildren(e))),s.content.on("click",'.popup-menu__item[data-role="link"]',(()=>{var t;const s=null!==(t=e.copyUrl)&&void 0!==t?t:e.url;a.Utils.copyToClipboard(s),i.core.ui.toasts.add("copy-link",{content:"Ссылка скопирована!"}),g.c.getInstance().sendEvent("comment_copy_link_button_tapped",Ae(Ae({},this.getBaseAnalyticsParameters(e)),{},{type:"meatballs"}))})),s.content.on("click",'.popup-menu__item[data-role="save"]',(()=>this.onSaveClick(e))),s.content.on("click",".popup-menu__item",o),s.content.on("click",'.popup-menu__item[data-role="complain"]',(()=>this.onComplainClick(e))),s.content.on("click",'.popup-menu__item[data-role="pin"]',(()=>this.onPinClick(e))),s.content.on("click",'.popup-menu__item[data-role="unpin"]',(()=>this.onUnpinClick(e))),s.content.on("click",'.popup-menu__item[data-role="sub"]',(()=>{Ie.L.getInstance().subsribeToComment(e)})),s.content.on("click",'.popup-menu__item[data-role="unsub"]',(()=>{Ie.L.getInstance().unsubscribeFromComment(e)})),X.showBanUserOptions.call(this,s.content.find(".author-moderation-tools").get(0),e),s.show()}onCommentActions(e,t){e.isNewest=!1,!P.V.isUserInExperiment(P.t.COMMENTS_UX_FIX)||e.isComstory}getCommentIdByElement(e){if(!o.Zv.isHTMLElement(e))throw new Error("expected HTMLElement");const t=e.closest(".comment");return t instanceof HTMLElement&&Number(t.dataset.id)||0}getCommentByElement(e){const t=this.getCommentIdByElement(e);if(this.comments.has(t))return this.comments.get(t)}render(){var e;return this.isRendered||(this.$els={comments:this.$(".comments__container"),tree:this.$('script[data-entry="comments-tree"]')},this.attachTools(),super.render(),null===(e=this.extension)||void 0===e||e.render(),this.initAnalytics(),this.initUnfoldButton(),this.initAnonymousReplyOnboarding(),i.core.history.state&&i.core.history.state.scrollToComments&&setTimeout((()=>{i.core.ui.scrollTo(this.el),i.core.history.replaceState({},document.title,i.core.history.location.href),i.core.ui.scrollRestoration="auto"}),350)),this}async scrollTo(e,t=!1){this.isScrolling=!0,await i.core.ui.scrollTo(e,t),this.isScrolling=!1}initComments(){this.$els&&this.$els.comments&&(this.comments.initComments(this.$els.comments,this.$els.tree),setTimeout((()=>{(0,y.U)(),new V(this)})))}initAnalytics(){var e;const t=document.querySelector(".story-comments");if(!(null!==(e=this.story)&&void 0!==e&&e.commentsCount&&t instanceof HTMLElement))return;const s=I.Z.getInstance();s.addItems({comments:[t]}),"comments"===s.focusedElement&&this.interval("sendCommentsAnalytics",2e3,this.sendViewAnalytics),s.on("focused-element-change",(e=>{"comments"===e?this.interval("sendCommentsAnalytics",2e3,this.sendViewAnalytics):(this.cancelInterval("sendCommentsAnalytics"),this.sendViewAnalytics())}))}initUnfoldButton(){var e;const t=null===(e=this.el)||void 0===e?void 0:e.querySelector(".comments__more-button");if(!t)return;const s=e=>{var s,o,n;if(null===(s=r)||void 0===s||s(),t.remove(),null===(o=this.$els)||void 0===o||null===(n=o.comments)||void 0===n||n.removeClass("hidden"),i.core.history.location.hash="comments",e){const e=this.story.subsCode;g.c.getInstance().sendEvent("click_show_comments",Ae(Ae({post_id:this.meta.storyId,author_id:this.meta.storyAuthorId},e&&{type_i8:Number(e)}),{},{size:Number(t.dataset.size)}))}};t.addEventListener("click",(()=>s(!0)));const o=()=>"#comments"===i.core.history.location.hash&&(s(!1),!0);let r;o()||(window.addEventListener("hashchange",o),r=()=>window.removeEventListener("hashchange",o))}getMaxCommentIdFromStorage(){return 0}get meta(){if(this._meta)return this._meta;const e=this.$el&&this.$el.hasClass("comments")?this.$el:this.$(".comments");if(!e||!e.length)throw new Error("not found .comments");const t=e.get(0).dataset;return this._meta={storyId:Number(t.storyId),storyAuthorId:Number(t.storyAuthorId),storyAuthorUserName:t.storyUsername||"",storyUrl:t.storyUrl||"",storyCommunityId:Number(t.storyCommunityId),ignoreType:(0,u.i)(d.IV,Number(t.ignoreType))||d.IV.NONE,isUserInComments:"true"===t.userInComments,sliceMode:Boolean(t.sliceMode),orderMode:(0,u.i)(d.hL,Number(t.orderMode))||d.hL.RELEVANCE,canPostAdCaptions:"true"===t.canPostAdCaptions,canReplyOfficially:"true"===t.canReplyOfficially,canReplyAnonymously:"true"===t.canReplyAnonymously}}attachTools(){var e,t;this.$el&&(null===(e=this.__meta)||void 0===e||null===(t=e.listDelegatedEvents)||void 0===t||t.forEach((({events:e,selector:t,handler:s})=>{this.$el&&this.$el.on(e,t,(e=>{const t=this.getCommentByElement(e.target);t&&s.call(this,t,e)}))})),this.$el.on("mouseenter",Re,(e=>{var t;const s=this.getCommentByElement(e.target);if(s){var i;if(1===e.buttons)null===(i=this.$el)||void 0===i||i.addClass("story-comments_hide-hover");null===(t=s.el)||void 0===t||t.classList.add("comment_collapsing-area")}})),this.$el.on("mouseleave",Re,(e=>{var t;const s=this.getCommentByElement(e.target);s&&(null===(t=s.el)||void 0===t||t.classList.remove("comment_collapsing-area"))})),this.$el.on("mouseup",(()=>{var e;null===(e=this.$el)||void 0===e||e.removeClass("story-comments_hide-hover")})))}toggleChildren(e){this.onToggleChildrenClick(e)}highlightParent(t){let s=this._options.currentToParentId;if(s===t&&(s=void 0),s&&s!==t){const e=this.comments.get(s);e&&e.branchTools.toggleToolParent(!1,!1)}this._options.currentToParentId=null!=t?t:void 0;const i=this.comments.get(t||s||0);if(!i||i.isRoot)return;if(i.isFake)return void e.toFakeComment(i.parent.id);const o=!!t&&t!==s;i.branchTools.toggleToolParent(o),requestIdleCallback((()=>{if(this.isDestroyed)return;const e=o?i:this.comments.get(i.parent.id);e&&g.c.getInstance().sendEvent(o?"go_to_parent_comment_button_tapped":"return_from_parent_comment_button_tapped",this.getBaseAnalyticsParameters(e))}))}getBaseAnalyticsParameters(e){var t,s;const i=this.story,o=new Map([[d.lL.STORY_TOP,()=>e.topStoryCommentAnalyticsParams],[d.lL.MAIN,()=>e.baseAnalyticsParams]]),r=(null===(t=o.get(this.mode))||void 0===t?void 0:t())||(null===(s=o.get(d.lL.MAIN))||void 0===s?void 0:s());return Ae({author_id:this.meta.storyAuthorId,post_id:this.meta.storyId,"community_id!empty":this.meta.storyCommunityId,"rating!undefined":e.voter.rating,"type_i8!empty":null==i?void 0:i.subsCode,"content_type!empty":null==i?void 0:i.contentTypes,"promo_id!empty":null==i?void 0:i.adId,"time!empty":I.Z.getInstance().getViewTimeMS("comments")},r)}sendControlEvent(e,t){let s;i.core.ui.screen===A.dt.BROWSING?s="compilation":i.core.ui.screen===A.dt.TOP_COMMENTS?s="top":this.meta.canReplyAnonymously&&(s="anonymous_comment"),s&&g.c.getInstance().sendEvent(e,Ae(Ae({},this.getBaseAnalyticsParameters(t)),{},{type:s}))}async initAnonymousReplyOnboarding(){var t;if(!this.meta.canReplyAnonymously||e.anonymousReplyOnboardingInitialized)return;const s="anonymous_comment",i=null===(t=this.el)||void 0===t?void 0:t.querySelectorAll('button[data-type="create"]');if(null==i||!i.length)return;const o=Array.from(i).find((e=>e.clientWidth>0));if(!o)return;e.anonymousReplyOnboardingInitialized=!0;const r=await(0,j.kd)({id:s,autoCloseIfTargetNotVisible:!1,target:o,theme:L.xb.DEFAULT,direction:L.Lh.TOP,title:"Можно ответить анонимно",text:"Функция активируется переключателем в правом нижнем углу поля комментария",btnConfig:{label:"Круто!",class:"popup__button_thin pkb-normal-btn pkb-normal-btn_small"},width:260});null==r||r.on(N.e.MOUNTED,(()=>{g.c.getInstance().sendEvent("tip_show",{type:s})})),null==r||r.on(N.e.UNMOUNTED,(()=>{g.c.getInstance().sendEvent("tip_close",{type:s})}))}get story(){return this._options.story}get currentBranchId(){return this._options.currentBranchId}set currentBranchId(t){var s,o,r;const n=this._options.currentBranchId,a=void 0!==t&&t!==n;if(!t&&!n)return;const l=this.comments.get(t||n||0);if(!l||l.isRoot)return;if(l.parentComment&&null!==(s=l.parentComment)&&void 0!==s&&s.isFake)return void e.toFakeComment(l.parentComment.id);if(a&&n&&t!==n){const e=this.comments.get(n);var c;if(e)null===(c=e.branchTools.$toolBranch)||void 0===c||c.classList.remove("comment__tool_active"),e.highlight("green",!1,!1)}const d="comment_hidden",u="comment-hidden-group__toggle_hidden";let p="."+(a?"comment":d);const h=(null===(o=l.el)||void 0===o?void 0:o.getBoundingClientRect().top)||0;a&&(p+=l.branchTools.branchIds.reduce(((e,t)=>e+':not([data-id="'+t+'"])'),"")),this.el&&(this.el.querySelectorAll(p).forEach((e=>e.classList.toggle(d,a))),this.el.querySelectorAll(`.${a?"comment-hidden-group__toggle":u}`).forEach((e=>e.classList.toggle(u,a)))),this.animationFrame("scrollTo",(()=>{var e;a&&(i.core.ui.sidebar._lastScrollTop=0),i.core.ui.scrollTo(i.core.ui.scrollTop+(null===(e=l.el)||void 0===e?void 0:e.getBoundingClientRect().top)-h)})),null===(r=l.branchTools.$toolBranch)||void 0===r||r.classList.toggle("comment__tool_active",a),l.highlight("green",!1,a),this._options.currentBranchId=t}get mode(){return this._options.mode||d.lL.MAIN}},De(Ce,"REPLY_FORM_OPEN","pkb_orf"),De(Ce,"anonymousReplyOnboardingInitialized",!1),Me((Ee=Ce).prototype,"onHiddenGroupToggleClick",[J],Object.getOwnPropertyDescriptor(Ee.prototype,"onHiddenGroupToggleClick"),Ee.prototype),Me(Ee.prototype,"onToggleChildrenClick",[Q],Object.getOwnPropertyDescriptor(Ee.prototype,"onToggleChildrenClick"),Ee.prototype),Me(Ee.prototype,"onMoreButtonClick",[ee],Object.getOwnPropertyDescriptor(Ee.prototype,"onMoreButtonClick"),Ee.prototype),Me(Ee.prototype,"onAllCommentsClick",[te,se],Object.getOwnPropertyDescriptor(Ee.prototype,"onAllCommentsClick"),Ee.prototype),Me(Ee.prototype,"onCloseBranchClick",[ie],Object.getOwnPropertyDescriptor(Ee.prototype,"onCloseBranchClick"),Ee.prototype),Me(Ee.prototype,"onRatingToggleClick",[oe],Object.getOwnPropertyDescriptor(Ee.prototype,"onRatingToggleClick"),Ee.prototype),Me(Ee.prototype,"onComstoryLinkClick",[re],Object.getOwnPropertyDescriptor(Ee.prototype,"onComstoryLinkClick"),Ee.prototype),Me(Ee.prototype,"onSaveClick",[ne],Object.getOwnPropertyDescriptor(Ee.prototype,"onSaveClick"),Ee.prototype),Me(Ee.prototype,"onBanClick",[ae],Object.getOwnPropertyDescriptor(Ee.prototype,"onBanClick"),Ee.prototype),Me(Ee.prototype,"onBodyHover",[le],Object.getOwnPropertyDescriptor(Ee.prototype,"onBodyHover"),Ee.prototype),Me(Ee.prototype,"onPinClick",[ce],Object.getOwnPropertyDescriptor(Ee.prototype,"onPinClick"),Ee.prototype),Me(Ee.prototype,"onUnpinClick",[de],Object.getOwnPropertyDescriptor(Ee.prototype,"onUnpinClick"),Ee.prototype),Me(Ee.prototype,"onComplainClick",[ue],Object.getOwnPropertyDescriptor(Ee.prototype,"onComplainClick"),Ee.prototype),Me(Ee.prototype,"onRemoveClick",[pe],Object.getOwnPropertyDescriptor(Ee.prototype,"onRemoveClick"),Ee.prototype),Me(Ee.prototype,"onRestoreClick",[he],Object.getOwnPropertyDescriptor(Ee.prototype,"onRestoreClick"),Ee.prototype),Me(Ee.prototype,"onCreateOrEditClick",[_e],Object.getOwnPropertyDescriptor(Ee.prototype,"onCreateOrEditClick"),Ee.prototype),Me(Ee.prototype,"onCancelClick",[me],Object.getOwnPropertyDescriptor(Ee.prototype,"onCancelClick"),Ee.prototype),Me(Ee.prototype,"onClickLink",[ge],Object.getOwnPropertyDescriptor(Ee.prototype,"onClickLink"),Ee.prototype),Me(Ee.prototype,"onCollapsingAreaClick",[ve],Object.getOwnPropertyDescriptor(Ee.prototype,"onCollapsingAreaClick"),Ee.prototype),Me(Ee.prototype,"onBranchClick",[fe],Object.getOwnPropertyDescriptor(Ee.prototype,"onBranchClick"),Ee.prototype),Me(Ee.prototype,"onToParentClick",[ye],Object.getOwnPropertyDescriptor(Ee.prototype,"onToParentClick"),Ee.prototype),Me(Ee.prototype,"onFromParentClick",[be],Object.getOwnPropertyDescriptor(Ee.prototype,"onFromParentClick"),Ee.prototype),Me(Ee.prototype,"onUserClick",[we],Object.getOwnPropertyDescriptor(Ee.prototype,"onUserClick"),Ee.prototype),Me(Ee.prototype,"onModeratorMenuClick",[ke],Object.getOwnPropertyDescriptor(Ee.prototype,"onModeratorMenuClick"),Ee.prototype),Me(Ee.prototype,"onExtraButtonClick",[Se],Object.getOwnPropertyDescriptor(Ee.prototype,"onExtraButtonClick"),Ee.prototype),Me(Ee.prototype,"onCommentActions",[Oe],Object.getOwnPropertyDescriptor(Ee.prototype,"onCommentActions"),Ee.prototype),Ee)},2889:(e,t,s)=>{"use strict";s.d(t,{cP:()=>l,WV:()=>n,Av:()=>a,$z:()=>r,dO:()=>c,yV:()=>y,W_:()=>O,S1:()=>_});s(88674),s(41817);var i=s(12950),o=s(65448);const r=new o.xs({ACTUAL:"actual",TIME:"time",SUBS:"subs"}),n=new o.xs({ALL:"all",MINE:"mine",TAG:"tag"}),a=new o.xs({ALL:"all",OPENED:"opened",CLOSED:"closed",NSFW:"nsfw"}),l=new o.xs({PARSED:1}),c=(new o.xs({NO_TARGET:0,COMMENT:1,STORY:2,PERMANENT:3}),new o.xs({DELETE:1,BAN:2,APPROVE:3,DISAPPROVE:4,MOVE:5,UNBAN:6,CHANGE_PINNED:7,CHANGE_SETTINGS:8,ADD_MODERATOR:9,REMOVE_MODERATOR:10,ADD_TRUSTED_USER:11,REMOVE_TRUSTED_USER:12,ADD_CHIEF:13,REMOVE_CHIEF:14,MOVE_STORY_TO_COMMUNITY:17}),new o.xs({LIMITED:0,PERMANENT:1,CANCELED:2}),new o.xs({APPROVED:0,REJECTED:1,MOVED_TO_COMMON_FEED:2}));var d=s(90312),u=s(36005);function p(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function h(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class _{constructor(e){this._id=Number(e)}async create(e){let{data:t}=await i.cf.postOrFail("/ajax/communities_actions.php",(0,u.defaults)({action:"create",id:this._id},e));return this._id=Number(t.id)}async edit(e){const{data:t}=await i.cf.postOrFail("/ajax/communities_actions.php",(0,u.defaults)({action:"edit",id:this._id},e));return t}async subscribe(e,t={},s=0){d.c.getInstance().sendEvent(e?"subscribe_to_community":"unsubscribe",function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?p(Object(s),!0).forEach((function(t){h(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):p(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({community_id:this._id},t));const{data:o}=await i.cf.postOrFail("/ajax/communities_actions.php",{action:"subs"+(e?"+":"-"),id:this._id,admoder_source:s});return o}async ignore(e){await i.cf.postOrFail("/ajax/communities_actions.php",{action:"ignore"+(e?"+":"-"),id:this._id})}async processStoryInQueue(e,t){let s;switch(t){default:case c.APPROVED:s="allow_story_in_queue";break;case c.REJECTED:s="deny_story_in_queue";break;case c.MOVED_TO_COMMON_FEED:s="disapprove_from_queue"}const{response:o}=await i.cf.postOrFail("/ajax/communities_actions.php",{action:s,qid:e,id:this._id});return o.message}async getComporatorResultForQueue(e){let{data:t}=await i.cf.postOrFail("/ajax/communities_actions.php",{action:"get_duplicates_in_queue",qid:e,id:this._id});return t}async voteForNewAdmin(e,t){let{data:s}=await i.cf.postOrFail("/ajax/communities_actions.php",{action:"vote_new_admin",user_name:e,as_new:t?"1":"0",id:this._id});return s}async cancelVotingCandidate(){let{data:e}=await i.cf.postOrFail("/ajax/communities_actions.php",{action:"cancel_candidate",id:this._id});return e}async loadModerationHistory(e){let{data:t}=await i.cf.postOrFail("/ajax/communities_actions.php",{action:"get_history",from_time:e||0,id:this._id});return{list:t.data,hasMore:t.has_more}}async loadBanList(e,t){let{data:s}=await i.cf.postOrFail("/ajax/communities_actions.php",{action:"get_ban_list",user_name:e,from_id:t||0,id:this._id});return{list:s.data,hasMore:s.has_more}}async cancelBan(e){await i.cf.postOrFail("/ajax/communities_actions.php",{action:"cancel_ban",user_id:e,id:this._id})}async addModerator(e,t=!1){let{data:s}=await i.cf.postOrFail("/ajax/communities_actions.php",{action:"add_moderator",user_name:e,add_as_chief:Number(t),id:this._id});return s}async deleteModerator(e){await i.cf.postOrFail("/ajax/communities_actions.php",{action:"delete_moderator",user_id:e,id:this._id})}async addTrustedUser(e){let{data:t}=await i.cf.postOrFail("/ajax/communities_actions.php",{action:"add_trusted_user",user_name:e,id:this._id});return{list:t.data,hasMore:t.has_more}}async deleteTrustedUser(e){await i.cf.postOrFail("/ajax/communities_actions.php",{action:"delete_trusted_user",user_id:e,id:this._id})}async loadTrustedUsersList(e){let{data:t}=await i.cf.postOrFail("/ajax/communities_actions.php",{action:"get_trusted_users_list",from_id:e||0,id:this._id});return{list:t.data,hasMore:t.has_more}}static async uploadAvatar(e){}async uploadBackground(e){}async dropBackground(){await i.cf.postOrFail("/ajax/communities_actions.php",{action:"drop_header_bg",id:this._id})}}var m=s(96637),g=s(12953);function v(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function f(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class y{static async search(e="",t={}){const s=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?v(Object(s),!0).forEach((function(t){f(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):v(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({action:"search_communities",name:e},t);("story-editor"===g.core.initParams.pageName||s.only_in_title)&&(s.f="512"),g.core.initParams.isNsfwStory&&(s.f+=", 256");let o=i.cf.post("/ajax/gtpost_actions.php",s);return o=o.then((e=>e.response.result?e.data.communities.map((e=>(0,u.extend)(e,{id:Number(e.id)}))):[])),o}static hasSearchCache(e=""){let t=m.MemoryCacheStorage.getInstance("searchCommunities");return t.has(e)&&!(t.get(e)instanceof Promise)}}var b=s(72044),w=s(63907),k=s(90477);const S=s(19755);class O extends w.u1{constructor(e){super(),b.Zv.isHTMLElement(e)&&(e=S(e)),e instanceof S&&(e={$el:e}),this._options.loadAnimation=!1,(0,u.isObject)(e)&&this.setOptions((0,u.defaults)(e,{page:1})),this._loadCommunitiesThrottle=(0,u.throttle)(this.loadCommunities,100)}_updateParams(e){e.diff("get").length&&(e.save("get"),this.clear(),this.loadCommunities(!1))}parseResponse(e,t){if(!e.result)return this._removeAllLastStory(),g.core.logger.error("feed","something went wrong"),!1;let s=!(0,u.isArray)(t.list)||0===t.list.length,i=!t.has_more;return this.emit(l.PARSED,t,s?0:t.list.length,s||i),this.endOfFeed=s||i,!s&&t.list}async loadCommunities(e=!0){if(this.endOfFeed||this.marks.has("request")||this.marks.has("requestDelay"))return!1;let t=this.requestId,s=this.page||0,o=Date.now();if(s)e&&s++;else{if(e)return!1;s=1}let r={action:"get_communities",text:this.params.data.searchText||"",filterType:this.params.data.filterType.valueOf()||"",sort:this.params.data.sortMode.valueOf(),type:this.params.data.type.valueOf(),tag:this.params.data.tag||"",page:this.page+1};if(this.loadAnimation=!0,this.marks.set("request",!0),this.marks.has("requestLastStart")){let e=this.marks.get("requestLastStart"),s=o-e;if(e&&s<5e3&&(this.marks.set("requestDelay",!0),await m.Utils.delay(s),this.marks.delete("requestDelay"),this.requestId!==t))return!1}this.marks.set("requestLastStart",o);const{response:n,data:a}=await i.cf.post("/ajax/communities_actions.php",r);if(await m.Utils.delay(1e3-(Date.now()-o)),this.requestId!==t)return!1;let l=this.parseResponse(n,a);return(0,u.isArray)(l)&&l.length&&(this.$els.container.append(b.Zv.fragment(l.join(""))),this.amount+=l.length),!1===l||!e&&1!==s||(this.page=s),this.loadAnimation=!1,this.marks.delete("request"),g.core.ui.attachSubscribeButtons(),!0}clear(){return delete this._options.requestId,this.marks.delete("request"),this.marks.delete("requestLastStart"),this.marks.delete("requestDelay"),this.loadAnimation=!1,this.page=0,this.amount=0,this.$els.container.empty(),this.endOfFeed=!1,this}_updateEndOfFeed(e){}_updateLoadAnimation(e){}get endOfFeed(){return this._options.endOfFeed}set endOfFeed(e){this._options.endOfFeed!==(e=Boolean(e))&&(this._options.endOfFeed=e,this._updateEndOfFeed(e))}get requestId(){return this._options.requestId?this._options.requestId:this._options.requestId=Symbol("feedRequestId")}get amount(){return this._options.amount}set amount(e){let t=this._options.amount;e="number"==typeof e?e:parseInt(e,10),isNaN(e)||e<0||t===e||(this._options.amount=e)}get page(){return this._options.page}set page(e){let t=this._options.page;e="number"==typeof e?e:parseInt(e,10),isNaN(e)||e<0||t===e||(this._options.page=e)}get loadAnimation(){return this._options.loadAnimation}set loadAnimation(e){this._options.loadAnimation!==(e=Boolean(e))&&(this._options.loadAnimation=e,this._updateLoadAnimation(e))}get params(){return this._options.params}set params(e){let t=this._options.params;t!==e&&(this._options.params=e,t&&this.stopListening(t),this.listenTo(e,k.u$.CHANGE,(0,u.debounce)(this._updateParams.bind(this),100)))}}},53201:(e,t,s)=>{"use strict";s.d(t,{t:()=>c,x:()=>d});s(88674),s(41817);var i=s(12950),o=s(42107),r=s(15112),n=s(12953);function a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function l(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}async function c(e,t,s={}){if(!e)return!1;if(!n.core.isUserAuthorized)return n.core.ui.authRequired(),!1;o.cp.getInstance().sendEvent(t?"subscribe_to_post_answers":"unsubscribe",function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?a(Object(s),!0).forEach((function(t){l(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({post_id:e},s)),await i.cf.postOrFail("/ajax.php",{route:t?"comstory/subscribe":"comstory/unsubscribe",id:e});try{(0,r.S)().subscribe.comstory[String(e)]=t}catch(c){}return!0}async function d(e,t){if(!e)return!1;if(!n.core.isUserAuthorized)return n.core.ui.authRequired(),!1;t&&o.cp.getInstance().sendEvent("add_to_ignore_list",{post_id:e,ignore_type:"post_answers"}),await i.cf.postOrFail("/ajax.php",{route:t?"comstory/ignore":"comstory/unignore",id:e});try{(0,r.S)().pessimize.comstory[String(e)]=t}catch(s){}return!0}},89536:(e,t,s)=>{"use strict";s.d(t,{c:()=>h});s(88674),s(66992),s(33948);var i=s(90647),o=s(12953),r=s(91920),n=s(12950),a=s(26117);const l="_comstory_db_store",c="_comstory_db_media_key";var d=s(53536),u=s(44813),p=s(10703);class h{static async create({id:e,content:t="",media:s=[],beforeRedirect:i=Promise.resolve.bind(Promise)}){if(!isFinite(e)||!Array.isArray(s)||"string"!=typeof t)throw new Error("wrong arguments passed");if(await a.co.checkIsDraftsLimitReached()){if(!(await a.a_.show()))return}const n=[{type:r.STORY_BLOCK_TYPE.TEXT.valueOf(),body:t}];await h._setMedia(s);const{draftId:l}=await h._setComstoryDraft(e,n);await i(),o.core.history.redirect(`/add?draft_id=${l}`)}static async publish({id:e,content:t="",media:s=[]}){const i=await Promise.all(s.map((async e=>{if(e instanceof File&&(0,d.hJ)(e)){var t,s;const{response:i,data:o}=await(0,u.Ix)(e);if(!i.result)throw new Error(i.message);const n=null!==(t=null!==(s=o.small)&&void 0!==s?s:o.large)&&void 0!==t?t:o.preview;return{type:r.STORY_BLOCK_TYPE.IMAGE.valueOf(),url:n.file_url}}if("image-url"===(null==e?void 0:e.type)){var i,o;const{response:t,data:s}=await(0,u.uc)(e.url);if(!t.result)throw new Error(t.message);const n=null!==(i=null!==(o=s.small)&&void 0!==o?o:s.large)&&void 0!==i?i:s.preview;return{type:r.STORY_BLOCK_TYPE.IMAGE.valueOf(),url:n.file_url}}if("video"===(null==e?void 0:e.type)){const{response:t,data:s}=await p.tv.getVideoDetails(e.url);if(!t.result)throw new Error(t.message);return{type:r.STORY_BLOCK_TYPE.VIDEO.valueOf(),url:s.url}}}))),{data:o}=await n.cf.postOrFail("/ajax.php",{route:"comstory/publish",data:JSON.stringify({blocks:[{type:r.STORY_BLOCK_TYPE.TEXT.valueOf(),body:t},...i.filter(Boolean)],parent_story_id:e})});return{storyId:o.story_id,commentId:o.comment_id,commentHtml:o.comment_html,message:o.message}}static async _setComstoryDraft(e,t){return a.co.saveDraft({time:a.co.getDraftTime(),blocks:t,parent_story_id:e,title:"",tags:"",is_adult:!1,is_authors:!1,is_community:!1},"overwrite_oldest")}static async getInheritablePropsByUrl(e){if("string"!=typeof e)return!1;let{response:t,data:s}=await n.cf.post("/ajax/gtpost_actions.php",{action:"story_by_url",url:e});return!!t.result&&s}static async _setMedia(e){let t=await h._getMediaStorage();t&&await t.put(e,c)}static async getMedia(){let e=await h._getMediaStorage();return e&&await e.get(c)||[]}static async cleanMedia(){let e=await h._getMediaStorage();e&&await e.delete(c)}static async _getMediaStorage(){try{return(await(0,i.X3)("_comstory_db",1,{upgrade(e){e.objectStoreNames.contains(l)||e.createObjectStore(l)}})).transaction(l,"readwrite").objectStore(l)}catch(e){return null}}}},97323:(e,t,s)=>{"use strict";s.d(t,{R:()=>f,J:()=>v});s(88674),s(41817);var i=s(88358),o=s(12953),r=s(36005);var n=s(62956),a=s(55474),l=s(82800),c=s(51294),d=s(42107),u=s(58330),p=s(28650),h=s(6508);function _(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function m(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?_(Object(s),!0).forEach((function(t){g(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):_(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function g(e,t,s){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}let v;!function(e){e[e.STORY=0]="STORY",e[e.COMMENT=1]="COMMENT"}(v||(v={}));class f{constructor(e){g(this,"smsSessionId",""),this._analyticsParams=(null==e?void 0:e.analyticsParams)||{}}async show(e){this.targetEntity=e;const t={[v.STORY]:"пост",[v.COMMENT]:"комментарий"}[e];return this.openTime=Date.now(),this.sendAnalyticsEvent("form_show"),new Promise((e=>{var s,o,n,a;this.resolver=e,this.box=new i.LD({isModalMenu:!0,width:360,header:"Подтверждение аккаунта",isHeaderLeftAlign:!0,destroyAfterHide:!0,content:(o={entityName:t,resendSmsBlock:p.X.getTemplate()},a="",a+='<div class="account-confirm">\n    <div>\n        Чтобы добавить '+(0,r.escape)(o.entityName)+', вам нужно подтвердить свой аккаунт. Сделать это можно, привязав одну из соцсетей или\n        при помощи номера телефона.\n    </div>\n    <div class="account-confirm__social-buttons">\n        <a\n            class="tool auth__provider social-icon social-icon_color social-icon_wide"\n            data-type="ya"\n            data-role="ya"\n        >\n            <span class="auth__provider-logo">\n                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon--social__ya icon--social__ya_tool"><use xlink:href="#icon--social__ya"></use></svg>\n            </span>\n            <span class="auth__provider-text">Войти с Яндекс ID</span>\n        </a>\n        <a\n            class="tool auth__provider social-icon social-icon_color social-icon_wide"\n            data-type="vk"\n            data-role="vk"\n        >\n            <span class="auth__provider-logo">\n                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon--social__vk icon--social__vk_tool"><use xlink:href="#icon--social__vk"></use></svg>\n            </span>\n            <span class="auth__provider-text">Войти через VK ID</span>\n        </a>\n    </div>\n    <div class="account-confirm__social-error"></div>\n    <div class="section-hr">\n        <div class="section-hr__title">или</div>\n    </div>\n    <div class="account-confirm__input input input_box input_small">\n        <div class="input__box">\n            <input type="tel" class="input__input" autocomplete="tel" placeholder="Номер телефона" name="phone"\n                   required/>\n        </div>\n    </div>\n    <div class="account-confirm__input account-confirm__input_sms input input_box input_small">\n        <div class="input__box">\n            <input type="text" maxlength="4" minlength="4" class="input__input" placeholder="Код из sms" name="sms"\n                   required/>\n        </div>\n    </div>\n    <div class="account-confirm__send-telegram">\n       <i class="hint" aria-label="Для получения кода, на данном устройстве должно быть установлено приложение &laquo;Телеграм&raquo;"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__info"><use xlink:href="#icon--ui__info"></use></svg></i>\n       <a href="#" target="_blank">Отправить код в Telegram</a>\n    </div>\n\n    '+(null==(n=o.resendSmsBlock)?"":n)+'\n\n    <div class="account-confirm__buttons">\n        <button class="pkb-normal-btn" data-role="next">Далее</button>\n        <button class="pkb-normal-btn" data-role="confirm">Подтвердить</button>\n        <button class="pkb-normal-btn pkb-normal-btn_gray" data-role="cancel">Отмена</button>\n    </div>\n</div>')}),this.box.show();const l=this.box.content[0];null===(s=this.box.$els.overlay)||void 0===s||s.on("click",(()=>this.sendAnalyticsEvent("click",{button:"empty_space"}))),this.initButtons(l),this.initPhoneElement(l),this.initSmsCodeElement(l),this.handleSocialButtons(l)}))}async submitPhone(e){var t;if(this.smsSessionId="",!this.phone)return;if(!(await this.phone.checkValidity()))return;try{this.smsSessionId=await c.n.addPhone(this.phoneInput.value)}catch(i){return void this.phone.setCustomValidity(i.message,!0)}this.phone.disabled=!0,null===(t=e.querySelector(".account-confirm"))||void 0===t||t.classList.add("account-confirm_phone-entered");const s=e.querySelector(".account-confirm__send-telegram a");s&&(s.href=`tg://resolve?domain=pikabu_access_code_bot&start=${this.smsSessionId}`,s.addEventListener("click",(()=>this.sendAnalyticsEvent("click",{button:"tg"})))),new p.X({el:e.querySelector(".resend-sms"),sessionId:this.smsSessionId}).render()}async submitSmsCode(){if(this.sendAnalyticsEvent("click",{button:"confirm_account"}),!this.phone||!this.smsCode||""===this.smsSessionId)return;if(!(await this.phone.checkValidity()))return;const e=this.smsCode.value;try{this.smsSessionId=await c.n.addPhoneConfirm(this.smsSessionId,e)}catch(t){return this.sendAnalyticsEvent("error_occurred",{type:"simplified_confirmation_wrong_code"}),void this.smsCode.setCustomValidity(t.message,!0)}this.sendAnalyticsEvent("approve_account",{type:"phone"}),this.complete(!0)}initButtons(e){var t,s,i;null===(t=e.querySelector('button[data-role="next"]'))||void 0===t||t.addEventListener("click",(()=>{this.sendAnalyticsEvent("click",{button:"next_to_confirm_account"}),this.submitPhone(e)})),null===(s=e.querySelector('button[data-role="confirm"]'))||void 0===s||s.addEventListener("click",(()=>{this.submitSmsCode()})),null===(i=e.querySelector('button[data-role="cancel"]'))||void 0===i||i.addEventListener("click",(()=>{this.sendAnalyticsEvent("click",{button:"cancel"}),this.complete(!1)}))}async initPhoneElement(e){const t=e.querySelector('button[data-role="next"]'),s=e.querySelector('input[name="phone"]'),i=null==s?void 0:s.closest(".input");s&&i&&(s.addEventListener("input",(()=>{this.sendAnalyticsEvent("input_start",{content_type:"simplified_account_confirmation_phone"})}),{once:!0}),t&&(t.disabled=!0,s.oninput=s.onpaste=s.onchange=s.onkeyup=()=>{t.disabled=""===s.value}),this.phoneInput=new h.a({el:s}),await this.phoneInput.initRusMaskAndFocus(),this.phone=this.phoneInput.input,this.phone.validationEvent=a.km.MANUAL)}initSmsCodeElement(e){const t=e.querySelector('button[data-role="confirm"]'),s=e.querySelector('input[name="sms"]'),i=null==s?void 0:s.closest(".input");if(!s||!i)return;s.addEventListener("input",(()=>{this.sendAnalyticsEvent("input_start",{content_type:"simplified_account_confirmation_sms"})}),{once:!0}),t&&(t.disabled=!0,s.oninput=s.onpaste=s.onchange=s.onkeyup=()=>{t.disabled=""===s.value});const o=u.S.getInstance().get("UIInput"),r=u.S.getInstance().get("Sanitizers");this.smsCode=new o({el:i,validationHint:{direction:l.Lh.RIGHT,alignment:l.SE.CENTER},sanitizerRules:[r.whitelist("0-9")]})}handleSocialButtons(e){e.querySelectorAll(".account-confirm__social-buttons .social-icon").forEach((t=>{const s=String(t.dataset.type);t.addEventListener("click",(t=>{t.preventDefault(),this.sendAnalyticsEvent("click",{button:(0,n.Lq)(s)}),this.linkSocialNetwork(e,s)}))}))}async linkSocialNetwork(e,t){const{result:s,message:i}=await(new n.Sq).link(t),o=e.querySelector(".account-confirm__social-error");o&&(o.textContent=s?"":i),s&&(this.sendAnalyticsEvent("approve_account",{type:(0,n.Lq)(t)}),this.complete(!0))}complete(e){var t;o.core.initParams.isConfirmed=e,e&&document.querySelectorAll('[data-role="account-confirm"]').forEach((e=>e.remove())),this.resolver&&this.resolver(e),null===(t=this.box)||void 0===t||t.hide()}showError(e){this.box&&this.box.content.find(".account-confirm__block_error").text(e)}sendAnalyticsEvent(e,t){var s;d.cp.getInstance().sendEvent(e,m(m({component_name:"popup",type:"match_account","view_time!empty":this.openTime&&"form_show"!==e?Math.round(Date.now()-this.openTime):null,reason:this.targetEntity===v.STORY?"publish":null!==(s=this._analyticsParams)&&void 0!==s&&s.comment_id?"reply":"comment"},this._analyticsParams),t))}}},12953:(e,t,s)=>{"use strict";s.d(t,{eR:()=>I.CookieStorage,ZF:()=>P.ZF,core:()=>se,default:()=>se});s(88674),s(74916),s(66992),s(33948),s(41817);const i=new(s(42359).x)({LOG:7,INFO:6,WARN:4,ERROR:3});let o;const r=Symbol();class n{constructor(e){if(e!==r)throw new Error("Cannot construct singleton");this._transports=[],this._startTime=Date.now()}addTransport(e){return this._transports.push(e),e}_sendToTransports(e,...t){let s=Date.now(),i=this._startTime-s;this._transports.forEach((o=>{e<=o.level&&o.message({date:s,afterStart:i,level:e,data:t||[]})}))}error(e,...t){this._sendToTransports(i.ERROR,e,...t)}warn(e,...t){this._sendToTransports(i.WARN,e,...t)}info(e,...t){this._sendToTransports(i.INFO,e,...t)}log(e,...t){this._sendToTransports(i.LOG,e,...t)}static get instance(){return o||(o=new n(r),o)}}class a{constructor(e=i.LOG){this._currentLevel=e}get level(){return this._currentLevel}set level(e){this._currentLevel=i[e]||this._currentLevel||i.ERROR}message(e){}}var l=s(36005),c=s(30381),d=s.n(c);const u=new Set(["font-weight: bold; color: #F99157;","font-weight: bold; color: #FAC863;","font-weight: bold; color: #99C794;","font-weight: bold; color: #5FB3B3;","font-weight: bold; color: #6699CC;","font-weight: bold; color: #C594C5;","font-weight: bold; color: #AB7967;"]);class p extends a{constructor(e){super(e),this._colorQueue=u.values(),this._entries=new Map}_getColorByEntry(e){return this._entries.has(e)||this._entries.set(e,this._nextColor),this._entries.get(e)}get _nextColor(){const{value:e,done:t}=this._colorQueue.next();return t&&(this._colorQueue=u.values()),e}message(e){const t=[...e.data],s=d()(e.date).format("hh:mm:ss"),i=e.level.toString().toLowerCase(),o=[`%c[${s}]`,"font-weight: bold; color: #5FB3B3;"];if(e.data.length>1&&(0,l.isString)(e.data[0])){let e=t.shift();e=e.padStart(10-(10-e.length)/2).padEnd(10),o[0]+=` %c:${e}:`,o.push(this._getColorByEntry(e))}console[i].apply(console,o.concat(t))}}var h=s(84947);class _ extends a{constructor(e,t){super(e),this._sendHandler=t}message(e){"api"===e.data[0]&&e.data[1]instanceof h.H?this._sendHandler(e.data[1],4):this._sendHandler(new Error(e.data.join(" ")),4)}}const m=n.instance;s(24603),s(15306);class g{constructor(e,t=!1,s=".",i=!1){this.splitCharacter=s,this._createIfNotExist=i,e&&t?this._tree=e:(this._tree={},e&&this.load(e))}index(e,t,s,i=!1){if((0,l.isString)(t))return this.index(e,t.split(this.splitCharacter),s,i);if(t[0]&&(0,l.isUndefined)(e[t[0]])){if((0,l.isUndefined)(s)&&!i)return;e[t[0]]={}}return 1!==t.length||(0,l.isUndefined)(s)?0===t.length?e:this.index(e[t[0]],t.slice(1),s,i):e[t[0]]=s}load(e){return this._merge(this._tree,e),this}_merge(e,t){return(0,l.forEach)(t,((s,i)=>{let o=(0,l.isObject)(s)&&!(0,l.isFunction)(s),r=(0,l.isArray)(s),n=(0,l.isEmpty)(s);if(!o||!n||r||(0,l.isUndefined)(e[i]))try{e[i]=o&&!r?this._merge(e[i],s):s}catch(a){e[i]=t[i]}})),e}set(e,t){return this.index(this._tree,e,t)}get(e,t){return e?this.index(this._tree,e,void 0,(0,l.isBoolean)(t)?t:this._createIfNotExist):this._tree}_clear(e){for(let t in e)if(e.hasOwnProperty(t)){let s=e[t],i=typeof s;if(!("object"!==i||null===s||s instanceof Array||s instanceof String||s instanceof Number)){this._clear(e[t]);continue}"string"!==i&&"number"!==i&&(e[t]=null),delete e[t]}}clear(){this._clear(this._tree)}toString(e,t){let s;try{s=JSON.stringify(this._tree,e,t)}catch(i){s=this._tree}return s}toJson(e=null,t){let s;try{s=JSON.stringify(this._tree,e,t)}catch(i){s="{}"}return s}static needPlane(e){return(0,l.isObject)(e)&&!(0,l.isArray)(e)}toPlane(e,t,s){let i={};return(0,l.isString)(s)||(s=this.splitCharacter),(0,l.isFunction)(t)||(t=g.needPlane),(0,l.isString)(e)&&e.length>0?e=this.get(e):e||(e=this._tree),!(!e||(0,l.isEmpty)(e)||(0,l.isArray)(e))&&((0,l.forEach)(e,((e,o)=>{if(t(e))return(0,l.forEach)(this.toPlane(e,t,s),((e,t)=>{i[`${o}${s}${t}`]=e}));i[o]=e})),i)}toPlaneMap(...e){let t=new Map;return(0,l.forEach)(this.toPlane(...e),((e,s)=>{t.set(s,e)})),t}fromPlane(e,t){let s;return(0,l.isString)(t)||(t=this.splitCharacter),s=new RegExp(t+"+","g"),!(0,l.isObject)(e)||(0,l.isArray)(e)||(0,l.forEach)(e,((e,i)=>{this.splitCharacter!==t&&(i=i.replace(s,this.splitCharacter)),this.set(i,e)})),this}static create(...e){let t=new g(...e),s=function(e,s){return(0,l.isUndefined)(s)?t.get(e):t.set(e,s)};return s.load=t.load.bind(t),s.toPlane=t.toPlane.bind(t),s.toString=t.toJson.bind(t),s.toPlaneMap=t.toPlaneMap.bind(t),s.clear=t.clear.bind(t),s}}var v=s(16253),f=s(89532),y=s(35924),b=s(90477);const w=s(19755),k=Symbol();let S;class O extends v.vp{constructor(e){if(super(!0),this._options={searchParams:void 0,url:new b.Lo({search:void 0,hash:void 0,path:void 0,pathname:void 0})},e!==k)throw new Error("Cannot construct singleton");this._addHook("popstate",w(window),"popstate.history",(e=>{this.emit("popstate",e.originalEvent.state,e)}))}_addHook(e,t,s,i){this.hook.on(e,(e=>{e===v.ZK.FIRST_ON?t.on(s,i):e===v.ZK.LAST_OFF&&t.off(s,i)}))}init(){this.listenTo(this,"popstate",this._loadUrl),this._loadUrl()}back(){O.history.back()}go(e){O.history.go(e)}redirect(e){O.location.href=e}forward(){O.history.forward()}pushUrl(e=null,t=!1){return this.pushState(void 0,"",e,t)}pushState(e=void 0,t="",s=null,i=!1){O.history.pushState(e,t,s),i?this._loadUrl():this.url.update(O.extractFromUrl(s))}replaceUrl(e=null,t=!1,s=!1){this.replaceState(void 0,"",e,t,s)}replaceState(e=void 0,t="",s=null,i=!1,o=!1){O.history.replaceState(e,t,s),i?this._loadUrl(o):this.url.update(O.extractFromUrl(s))}_loadUrl(e=!1){this.url.update(O.extractFromUrl()),e||this.url.diff("current").length?(this.url.save("current"),m.log("history","change",this.pathname,this.hash),this.emit("route",this)):m.log("history","prevent rerouting")}removeHash(){window.history.pushState("",document.title,window.location.pathname+window.location.search)}static extractFromUrl(e){let t=(0,l.isString)(e)?f.c.urlToLocation(e):O.location;return{hostname:t.hostname,search:t.search.replace(/^\?/,""),pathname:t.pathname,path:t.pathname+t.search,hash:t.hash.replace(/^#/,"")}}get url(){return this._options.url}get state(){return history.state}get pathname(){return this.url.data.pathname}get hash(){return this.url.data.hash}get path(){return this.url.data.path}get hostname(){return this.url.data.hostname}get searchParams(){let e=this._options.searchParams,t=this.url.data.search;return e?(t===e.lastSearch||(e=this._options.searchParams=new y._(t),e.lastSearch=t),e):this._options.searchParams=new y._(t)}get location(){return O.location}static get location(){return window.location}static get history(){return window.history}static get instance(){return S||(S=new O(k),S)}}var E=s(59639);const C="serviceWorker"in navigator&&E.N;class x{constructor(){this._commands=new Map,this._isReady=!1}get target(){return this._target}set target(e){this._target!==e&&(this._target=e)}processMessageEvent(e,t){const{command:s,data:i}=e.data,o=this._commands.get(s);if("function"!=typeof o)throw new Error(`not found command "${s}"`);return Boolean(t)?o(t,i):o(i)}send(e,t,s=this.target){if(!this.isReady)throw new Error("channel SW<>Client not ready");null!==this.target&&s.postMessage({command:e,data:t})}query(e,t,s=this.target){return this.isReady?new Promise(((i,o)=>{let r=new MessageChannel,n=setTimeout((()=>{r.port1.close(),r.port2.close(),o(new Error("timeout await response for query "+e))}),3e3);r.port1.addEventListener("message",(e=>{i(e.data),clearTimeout(n)})),r.port1.start(),s.postMessage({command:e,data:t},[r.port2])})):Promise.reject(new Error("channel SW<>Client not ready"))}addCommand(e,t){return this._commands.set(e,t),this}get isReady(){return this._isReady}set isReady(e){this._isReady!==e&&(this._isReady=e)}}class T extends x{constructor(e,t,s){super(),C?(this._currentUsedController=void 0,this._detectChangeTi=void 0,this._swUrl=e,this._sessionId=s,this._expectedSWVersion=t,this.addCommand("h",(()=>{this.isReady=!0,se.emit("sw-ready")})),this._init()):"serviceWorker"in navigator&&!E.N&&null!==navigator.serviceWorker.controller&&this._unregister()}noop(){return this}async _onMessage(e){let t=e.ports[0];try{let s=await this.processMessageEvent(e);t&&t.postMessage(s)}catch(s){m.warn("sw","incoming message",s)}}_init(){navigator.serviceWorker.addEventListener("message",this._onMessage.bind(this)),navigator.serviceWorker.addEventListener("controllerchange",(()=>{clearTimeout(this._detectChangeTi),this._onReady("controllerchange")})),this._swUrl?this._register(this._swUrl):this._unregister().catch((e=>m.error("sw",e)))}_register(e){navigator.serviceWorker.register(e,{scope:"/",updateViaCache:"none"}).then((()=>navigator.serviceWorker.ready)).then((e=>{null!==e.installing&&null!==e.active||(m.info("sw","ready but wait"),this._detectChangeTi=setTimeout((()=>{this._onReady()}),500))})).catch((e=>m.error("sw",e)))}async _unregister(){if(this.isReady=!1,!navigator.serviceWorker.controller)return;navigator.serviceWorker.controller.postMessage({command:"destroy"});(await navigator.serviceWorker.getRegistrations()).forEach((e=>e.unregister())),m.info("sw","remove sw")}_updateCurrentWorker(){this.query("version").then((e=>{e!==this._expectedSWVersion&&navigator.serviceWorker.getRegistration().then((e=>e.update()))})).catch((()=>{navigator.serviceWorker.getRegistration().then((e=>e.update()))}))}_onReady(e="ready"){let t=this._currentUsedController;t&&"redundant"!==t.state&&t!==navigator.serviceWorker.controller&&t.postMessage({command:"buy"}),this._currentUsedController=t=navigator.serviceWorker.controller,m.info("sw","worker ready to use","from Event:",e,t),this.target=t,this.isReady=!0,this.send("h",this._sessionId),this._updateCurrentWorker(),clearInterval(this._keepAliveTimer),this._keepAliveTimer=setInterval((()=>{t&&"redundant"!==t.state&&t.postMessage({command:"ping"})}),9e3)}}var I=s(96637),P=s(44497);const A=s(75493);class D{static now(){return A.now()}static mark(e){A.mark(e)}static measure(e,t,s){A.measure(e,t,s)}static getEntry(e,t){return(0,l.last)(D.getEntriesByName(e,t?t.valueOf():void 0))}static getEntryDuration(e,t,s=!1){let i=D.getEntry(e,t);return!!i&&D.getFixedTime(i.duration,s)}static getEntryElapsed(e,t,s=!1){let i=D.getEntry(e,t),o=D.now();return!!i&&D.getFixedTime(o-i.startTime,s)}static getFixedTime(e,t=3){return(0,l.isNumber)(e)&&(0,l.isNumber)(t)?Number(e.toFixed(t)):e}static getEntries(){return A.getEntries()}static getEntriesByType(e){return A.getEntriesByType(e?e.toString():e)}static getEntriesByName(e,t){return A.getEntriesByName(e,t?t.toString():t)}static clearMarks(e){A.clearMarks(e)}static clearMeasures(e){A.clearMeasures(e)}}var M=s(97099);const R=/\^([\w.:-]+)(?:\(([^)\r]*)\))?/g,N=/\^([\w.:-]+)(?:\(([^)\r]*)\))?/,B=/'([^')\r]*)'/g;class L{constructor(e){(0,l.isObject)(e)&&this.load(e)}load(...e){return this.locales.load(...e),this}clear(){return this.locales.clear(),this}format(e,...t){let s=this.locales.get(e)||e;if(Array.isArray(s)&&(s=t.length>0?3===s.length?f.c.pluralNounRU(t[0],s):f.c.pluralAdjectiveRU(t[0],s):s[0]||e),"string"==typeof s)s=f.c.format(s,...t);else{if(!(0,l.isFunction)(s))return e;s=s(...t)||e}return!Array.isArray(s)&&N.test(s)?s.replace(R,((e,t,s)=>(s=s?L._clearArguments(s):[],this.format(t,...s)))):s}static _clearArguments(e){return(0,l.map)(e.match(B)||[],(e=>e.substr(1,e.length-2)))}get locales(){let e=this._locales;return this._locales||(e=this._locales=new g),e}}var j=s(12950),$=s(40138),U=s(36005);class F{constructor(e){this._observers=new Set,this._waitingCommand=new Map,this._isConnected=!1,this._isConnecting=!1,this._getConnectionUrl=e,this._lastToken=1,this._amountConnectionErrors=0,this._amountIAKErrors=0,this._isFirstMessage=!0,this._isNextConnectionToLogger=!1,this._onCloseBound=this._onClose.bind(this),this._onErrorBound=this._onError.bind(this),this._onMessageBound=this._onMessage.bind(this)}async connect(){if(this._isConnecting||this.isConnected||this._reconnectTi)return this;this._isConnecting=!0,this._stopKeepAlive();const e=this.connectionId;try{const t=await this._getConnectionUrl(this._isNextConnectionToLogger);if(this.connectionId!==e)return this;m.info("ws","connect",t);const s=this._connection=new WebSocket(t);s.addEventListener("error",this._onErrorBound),s.addEventListener("close",this._onCloseBound),s.addEventListener("message",this._onMessageBound)}catch(t){if(m.error("WebSocket, some problem with start up connection",t),this._isConnecting=!1,t instanceof Error&&t.message&&"disallow ws"===t.message)return this.reconnect(36e4),this;this.reconnect(12e4)}return this}close(){if(this._connection){const e=this._connection;delete this._connection,e.removeEventListener("error",this._onErrorBound),e.removeEventListener("close",this._onCloseBound),e.removeEventListener("message",this._onMessageBound);const t=e.readyState;t!==WebSocket.CLOSED&&t!==WebSocket.CLOSING&&e.close()}return this.stopReconnect(),this._rejectAllWaitingCommands(),this._isFirstMessage=!0,this.isConnected=!1,this._isConnecting=!1,this._stopKeepAlive(),delete this._connectionId,this}reconnect(e){return this.isConnected||(e||(e=15*Math.min(Math.max(1,++this._amountConnectionErrors),2e3)*1e3),m.info("ws","reconnect",e),this.stopReconnect(),this._reconnectTi=setTimeout((()=>{this.stopReconnect(),this.connect()}),e+Math.floor(4e3*Math.random()))),this}stopReconnect(){return clearTimeout(this._reconnectTi),delete this._reconnectTi,this}noop(){return this}_stopKeepAlive(){this._keepAliveTi&&(clearTimeout(this._keepAliveTi),delete this._keepAliveTi)}_refreshKeepAlive(){const e=async(t=!1)=>{t||await this.query("ping"),clearTimeout(this._keepAliveTi),this._keepAliveTi=setTimeout(e,55e3)};e(!0)}_rejectAllWaitingCommands(){this._waitingCommand.forEach((({reject:e})=>e(new Error("did not wait for an answer, the connection is lost")))),this._waitingCommand.clear()}_onOpen(){m.log("ws","ready"),this._lastToken=1,this._isConnecting=!1,this._isNextConnectionToLogger=!1,this.isConnected=!0,this._amountConnectionErrors=0,this._refreshKeepAlive()}_onError(e){m.error("connection",e)}_onClose(e){switch(this.close(),4002===e.code&&this._observers.forEach((e=>e.onFUSW&&e.onFUSW())),m.info("ws","close "+e.code),e.code){case 4001:this._isNextConnectionToLogger=!0,this._amountIAKErrors++,this.reconnect(this._amountIAKErrors>=10?36e5:12e4);break;case 1012:this.reconnect(5e3);break;default:this.reconnect()}}_onMessage(e){if(this._isFirstMessage)return"h;1"===e.data?(this._onOpen(),void(this._isFirstMessage=!1)):void 0;const t=e.data.split(";"),s=t[0],i=t[1],o=s+";"+i;if(this._waitingCommand.has(o)){const e=this._waitingCommand.get(o);e&&(e.resolve(t.slice(2)),this._waitingCommand.delete(o))}else this._observers.forEach((e=>e.onMessageNoOneWaiting(s,t.slice(2))))}addObserver(e){this._observers.add(e)}send(e,t){if(!this._connection||this._connection.readyState===WebSocket.CLOSED||this._connection.readyState===WebSocket.CLOSING||!this.isConnected)throw new Error(`Unable to send "${e}", connection failed`);let s=e+";"+this.generateToken;t&&t.length>0&&(s+=";"+t.join(";")),this._refreshKeepAlive(),this._connection.send(s)}async query(e,t){if(!this._connection||this._connection.readyState===WebSocket.CLOSED||this._connection.readyState===WebSocket.CLOSING||!this.isConnected)throw new Error(`Unable to send "${e}", connection failed`);const s=this.generateToken;let i=e+";"+s;return t&&t.length>0&&(i+=";"+t.map((e=>(" "+String(e)).slice(1))).join(";")),i=(" "+i).slice(1),new Promise(((t,o)=>{this._waitingCommand.set(e+"=;"+s,{resolve:t,reject:o}),this._refreshKeepAlive(),this._connection.send(i),i=""}))}get isConnected(){return this._isConnected}set isConnected(e){this._isConnected!==e&&(this._isConnected=e,this._observers.forEach((t=>t.onConnectionStateChange&&t.onConnectionStateChange(e))))}get connectionId(){return this._connectionId?this._connectionId:this._connectionId=Symbol("connectionId")}get generateToken(){return this._lastToken++}}class V extends v.vp{constructor(e=!1){if(super(!0),this._isReady=!1,this._hasListenState=void 0,this._hasListenMessage=void 0,this._commandsBuffer=null,e)return;const t=se.initParams.csrfToken;this.hook.on("ready",((e,s)=>{if(e===v.ZK.ON&&this.isReady)return void s(!0);const i=se.sw.isReady;e===v.ZK.FIRST_ON?(this._hasListenState=!0,i&&se.sw.send("ws-listen-state",{on:!0,xhrToken:t})):e===v.ZK.LAST_OFF&&(this._hasListenState=!1,i&&se.sw.send("ws-listen-state",{on:!1,xhrToken:t}))})),this.hook.on("message",(e=>{const s=se.sw.isReady;e===v.ZK.FIRST_ON?(this._hasListenMessage=!0,s&&se.sw.send("ws-listen-message",{on:!0,xhrToken:t})):e===v.ZK.LAST_OFF&&(this._hasListenMessage=!1,s&&se.sw.send("ws-listen-message",{on:!1,xhrToken:t}))})),se.sw.addCommand("ws-state",(e=>{this.isReady=Boolean(e)})),se.sw.addCommand("ws-message",(e=>{this.emit("message",e.command,...e.args)})),se.on("sw-ready",(async()=>{this.isReady=await se.sw.query("ws-is-ready"),"boolean"==typeof this._hasListenState&&se.sw.send("ws-listen-state",{on:this._hasListenState,xhrToken:t}),"boolean"==typeof this._hasListenMessage&&se.sw.send("ws-listen-message",{on:this._hasListenMessage,xhrToken:t}),this._commandsBuffer&&this._commandsBuffer.length&&this._commandsBuffer.forEach((([e,s])=>{se.ws.send("ws-send-w",{command:e,args:s,xhrToken:t})}))}))}send(e,...t){C&&se.sw.send("ws-send",{command:e,args:t,xhrToken:se.initParams.csrfToken})}sendW(e,...t){if(C)return se.sw.isReady?void se.sw.send("ws-send-w",{command:e,args:t,xhrToken:se.initParams.csrfToken}):(this._commandsBuffer||(this._commandsBuffer=[]),void this._commandsBuffer.push([e,t]))}query(e,...t){return C?se.sw.query("ws-query",{command:e,args:t,xhrToken:se.initParams.csrfToken}):Promise.resolve()}get isReady(){return this._isReady}set isReady(e){this._isReady!==e&&(this._isReady=e,e&&this.emit("ready"))}}var H=s(2355);class Z extends V{constructor(){super(!0),this._wsLastUsedTime=0,this.hook.on("ready",((e,t)=>{if(e===v.ZK.ON&&this.isReady)return this.ws.noop(),void t(!0);e===v.ZK.FIRST_ON?(this.ws.noop(),this._hasListenState=!0):e===v.ZK.LAST_OFF&&(this._hasListenState=!1,this._tryCloseConnection())})),this.hook.on("message",(e=>{e===v.ZK.FIRST_ON?(this.ws.noop(),this._hasListenMessage=!0):e===v.ZK.LAST_OFF&&(this._hasListenMessage=!1,this._tryCloseConnection())})),this.listenTo(se.ui,"visibilitychange",(()=>{H.E.isShown?(this._hasListenMessage||this._hasListenState)&&this.ws.noop():this._tryCloseConnection(!0)}))}send(e,...t){this.ws.send(e,t)}sendW(e,...t){this.isReady?this.ws.send(e,t):(this._commandsBuffer||(this._commandsBuffer=[]),this._commandsBuffer.push([e,t]))}query(e,...t){return this.ws.query(e,t)}async _onWSConnectionStateChange(e){this.isReady=Boolean(e),e&&this._commandsBuffer&&this._commandsBuffer.length&&this._commandsBuffer.forEach((([e,t])=>{this.ws.send(e,t)}))}async _onWSMessageNoOneWaiting(e,t){"fcr"!==e?"fusw"!==e&&this.emit("message",e,...t):window.location.reload()}async _tryCloseConnection(e=!1){this._ws&&this._ws.isConnected&&(!e&&Date.now()-6e4<this._wsLastUsedTime||this._hasListenState||this._hasListenMessage||(this.ws.close(),clearInterval(this._tryCloseConnectionTimeout),delete this._tryCloseConnectionTimeout))}get ws(){if(this._wsLastUsedTime=Date.now(),this._tryCloseConnectionTimeout||(this._tryCloseConnectionTimeout=setInterval(this._tryCloseConnection.bind(this),5e3)),this._ws)return this._ws.connect(),this._ws;let e=this._ws=new F(this.getConnectionUrl.bind(this));return e.addObserver({onConnectionStateChange:this._onWSConnectionStateChange.bind(this),onMessageNoOneWaiting:this._onWSMessageNoOneWaiting.bind(this)}),e.connect(),e}async getConnectionUrl(e=!1){const t=`&swv=${se.initParams.swVersion}`,{response:s,data:i}=await j.cf.get(`/ajax/ws_actions.php?action=request-access${t}${e?"&l=1":""}`);if(!s.result)throw new Error("disallow ws");return`${i.host}/?pl=${i.access_key}${t}`}}var z=s(95593);const q="BroadcastChannel"in window;class W extends x{constructor(){super(),q&&(this._isReady=!0,this._target=new BroadcastChannel("pikabu_channel"),this._target.addEventListener("message",(e=>{this.processMessageEvent(e)})))}}var G=s(42107),Y=s(34608),K=s(96883),X=s(45528);s(24819);const J=s(19755),Q=s(30381),ee=s(65470);let te,se;class ie extends v.vp{constructor(){if(te)return te;if(super(),te=this,this._uuid=Date.now(),this._initParams=void 0,this._storage={focused:void 0,activeFeedRestoreStateMode:!1},Q.locale("ru"),Q.relativeTimeThreshold("h",24),Q.updateLocale("ru",{relativeTime:{d:"1 день"}}),this._logger=m,this._consoleTransport=new p,this._consoleTransport.level=i.WARN,this._logger.addTransport(this._consoleTransport),"function"==typeof window.plog){const e=window.plog;delete window.plog,this._logger.addTransport(new _(i.ERROR,e))}this.config=g.create({applicationType:"desktop",animations:["https://cs.pikabu.ru/apps/ub/5.0.1/animations/",[""],[["comments-spinner",104,40,0,0],["eleventh-birthday",14,24,0],["image-upload",40,60,0,0],["signin",56,28,0,0],["signup",68,28,0,0],["stories-restore",150,150,0,0],["stories-search",126,64,0,0],["stories-spinner",132,64,0,0],["story-publish",96,28,0,0],["video-convert",114,100,0,0],["video-upload",96,250,0,0]]],freeze:{"page-quarantine":{"ring.mp3":"/apps/ub/5.0.1/desktop/page-quarantine/ring.mp3"}},grecaptchaKey:"6Lf5DUsUAAAAAGeOi2l8EpSqiAteDx5PGFMYPkQW",grecaptchaV3Key:"6Lf_BzkbAAAAALLyauQDjsAwtlRTahh8WHXbZc-E"}),this.ui=void 0,this.performance=D,this._router=new M.F0,this._history=O.instance,this.listenTo(this._history,"route",(e=>{let t={path:e.pathname,hash:e.hash,pageName:this.initParams.pageName,pageRecordID:this.initParams.pageRecordID},s=Date.now();this.emit("route",t),m.log("router","find route",t),this.routerDispatch(t).then((()=>m.log("router","routed finish",(Date.now()-s).toFixed(3),"ms."))).catch((e=>m.error("route",e)))})),this.listenTo(this._router,"mismatch",(function(){m.log("router","not found match")})),this._i18n=new L(s(252)),this._i18n.load({icon:$.q,user:(e,t)=>function(e){var t,s="",i=U.escape;return s+'<a href="/@'+(null==(t=e.name)?"":t)+'" target="_blank" class="user user_inline"><span class="avatar avatar_small">'+(null==(t=e.avatar?'<img src="'+e.avatar+'">':'<span class="avatar__default"></span>')?"":t)+'</span><span class="user__nick">'+i(e.name)+"</span></a>"}({name:e,avatar:t})}),window.pkb=window.pkb||{},this.global=g.create(window.pkb,!0),this._refreshSession(),this._autoReloadAfterLogout(),this.ready=new Promise((e=>{J((()=>{document.querySelectorAll(".app__config").forEach((e=>{const t=e.getAttribute("data-entry")||"common";try{let s=JSON.parse(e.innerHTML||"[]");"initParams"===t?this._initParams=s:this.config("modules."+t,s)}catch(s){this.logger.error("config",t,"problem with decoding")}})),(0,Y.Pf)().then((e=>(0,Y.RB)(e))),this.environment===P.Gv.PRODUCTION&&(this._consoleTransport.level=i.ERROR,console&&console.log("%c+",'font-size: 1px; padding: 150px 87px; line-height: 0; background: url("https://cs.pikabu.ru/assets/images/dev.png"); background-size: 175px 300px; color: transparent;')),this.sw.noop(),e()}))}));const e=window.PkbAnalytics;K.d.initialize({gatewayUrl:/^testing\d+\.pikabu\.ru$/.test(location.hostname)?"/anl":"https://cs44.pikabu.ru",source:e.source,aid:e.userID,uid:e.unauthorizedId,uts:e.unauthorizedTs,exps:JSON.stringify(e.experiments),fp:e.fp}),this._initWebVitals()}_initWebVitals(){(0,X.Yn)((({name:e,value:t,id:s,attribution:i})=>{const{eventEntry:o,eventTarget:r,eventType:n,loadState:a}=i;G.cp.getInstance().google.action(e,{metric_id:s,metric_inp_value:t,metric_inp_event_target:r,metric_inp_event_type:n,metric_inp_load_state:a,metric_inp_start_time:o.startTime,metric_inp_processing_start:o.processingStart,metric_inp_processing_end:o.processingEnd,metric_inp_duration:o.duration,metric_inp_interaction_id:o.interactionId}),t>=200&&G.cp.getInstance().sendEvent("inp_event",{target:r,type:n,content_type:a,time:Math.round(o.startTime),score:t})}))}navigate(e,t,s,i=!1){m.warn("history","use deprecated method core.navigate, please use core.history.pushState"),this.history.pushState(e,t,s,i)}replaceState(e,t,s,i=!1){m.warn("history","use deprecated method core.replaceState, please use core.history.replaceState"),this.history.replaceState(e,t,s,i)}use(e,t){return this._router.use(e,t),this}logout(){return j.cf.post("/ajax/logout.php").then((function({response:e,data:t}){Boolean(navigator.credentials)&&navigator.credentials.preventSilentAccess(),G.cp.getInstance().sendEvent("log_out"),e.result&&(window.location.href=t.url)})),!0}i18n(e,...t){return this._i18n.format(e,...t)}checkAccessUserActions(e=!0,t={}){return this.isUserAuthorized?this.isLostAccount?(e&&this.ui.toasts.showWarningMessage(P.ZF.LOST_ACCOUNT),!1):this.isUserBanned?(e&&this.ui.toasts.showWarningMessage(P.ZF.BANNED),!1):!this.isFullyBanned||(e&&this.ui.toasts.showWarningMessage(P.ZF.FULLY_BANNED),!1):(e&&this.ui.authRequired(t),!1)}checkUserAuth(e=!0){return!!this.isUserAuthorized||(e&&this.ui.authRequired(),!1)}icon(e,...t){return(0,$.q)(e,...t)}initSW(){this._sw=new T(this.initParams.swUrl,this.initParams.swVersion,this.initParams.csrfToken)}_refreshSession(){setInterval((()=>{if(!H.E.isShown)return;const e={};"/"===this.history.pathname&&(e.hot=!0),j.cf.get("/ajax/refresh_session.php",e)}),12e5)}_autoReloadAfterLogout(){this.bc.addCommand("logout",(()=>{O.instance.location.reload()}))}get ua(){return ee}get history(){return this._history}get logger(){return this._logger}get storage(){return this._storage}static get instance(){return te}get initParams(){return this._initParams}get routerDispatch(){return this._routerDispatch?this._routerDispatch:this._routerDispatch=this._router.routers()}get deviceType(){return this._deviceType?this._deviceType:this._deviceType=this.ua.tablet?P.me.TABLET:this.ua.mobile?P.me.MOBILE:P.me.DESKTOP}get isLocalEnvironment(){return this.environment===P.Gv.LOCAL}get applicationType(){if(this._applicationType)return this._applicationType;const e=(this.config("applicationType")||"").toUpperCase();return this._applicationType=(0,z.i)(P.Zq,e)||P.Zq.DESKTOP}get isMobileApp(){return!1}get isDesktopApp(){return!0}get environment(){return P.Gv.hasOwnProperty(this.initParams.environment)?this.initParams.environment:P.Gv.PRODUCTION}get userRating(){return parseInt(String(this.initParams.userKarma),10)}get userFirstVisitDate(){var e;return new Date(1e3*(null===(e=I.CookieStorage.get("Uas"))||void 0===e?void 0:e.split(",")[1]))}get isUserAuthorized(){return this.initParams.userID>0&&!this.initParams.isDeleted}get isUserBanned(){return Boolean(this.initParams.isUserBanned)}get isFullyBanned(){return Boolean(this.initParams.isFullyBanned)}get isLostAccount(){return Boolean(this.initParams.isLostAccount)}get isUserModerator(){return Boolean(this.initParams.isUserModerator)}get isInternalStaff(){return Boolean(this.initParams.isInternalStaff)}get searchParams(){return m.warn("history","use deprecated method core.searchParams, please use core.history.searchParams"),this.history.searchParams}get location(){return m.warn("history","use deprecated method core.location, please use core.history.location"),O.location}get uuid(){return this._uuid}get bc(){return this._bc?this._bc:this._bc=new W}get ws(){return this._ws?this._ws:this._ws=se.ua.ios?new Z:new V}get sw(){let e=this._sw;return e||(this.initSW(),e=this._sw),e}}se=new ie},90477:(e,t,s)=>{"use strict";s.d(t,{u$:()=>o,Lo:()=>n,qg:()=>a});s(66992),s(33948);var i=s(16253);s(23031);let o;!function(e){e.ADD="dataSetAdd",e.UPDATE="dataSetUpdate",e.REMOVE="dataRemove",e.CHANGE="dataChange",e.DESTROY="dataDestroy",e.SORT="dataSetSort",e.SAVE_SNAPSHOT="dataSaveSnapshot"}(o||(o={}));var r=s(36005);class n extends i.vp{constructor(e,t=!0,s){var i,o,n,a,l;super(),s&&(this.fieldId=s),this._data=this._createData(e),t&&(this._proxy=(i=this._data,o=this._onChangeData,n=this,a="",l=i,Proxy.revocable(l,{set(e,t,s){if(!(t in e))throw new TypeError("Can't add property create, object is not extensible. Use DataObject.defaults");let i=e[t];return e[t]=s,o.call(n,a+t,s,i),!0},get:(e,t)=>e[t],deleteProperty(e,t){throw new TypeError(`Cannot delete property '${t}' of #<Object>. Use \`${t} = void 0;\``)},defineProperty(){throw new TypeError("Can't add property, object is not extensible. Use DataObject.prototype.defaults")}}))),this._id=(0,r.uniqueId)("data-object"),this._marks=void 0,this._snapshots=void 0}hasSnapshot(e){return this._snapshots&&this._snapshots.has(e)}save(e){this._snapshots||(this._snapshots=new Map),this._snapshots.has(e)&&this._snapshots.delete(e);let t=Object.freeze(Object.assign({},this._data));this._snapshots.set(e,t),this.emit(o.SAVE_SNAPSHOT,e,t)}diff(e){if(!this._snapshots||!this._snapshots.has(e))return(0,r.map)(this._data,((e,t)=>({property:t,type:"add",value:e})));let t=this._data,s=this._snapshots.get(e),i=new Set(Object.keys(s)),o=[];(0,r.forEach)(t,((e,t)=>{s.hasOwnProperty(t)?e!==s[t]&&o.push({property:t,type:"set",value:e}):o.push({property:t,type:"add",value:e}),i.delete(t)}));for(let r of i)o.push({property:r,type:"remove"});return o}_onChangeData(e,t,s){t!==s&&(this.emit(o.CHANGE,this,{[e]:s}),this.emit(e,this,t,s))}_createData(e){return Object.assign(this.fieldId?{[this.fieldId]:void 0}:{},this.defaults||{},e||{})}destroy(e=!1){this.isDestroyed||(this.__destroyed=!0,e||this.emit(o.DESTROY,this),this._proxy&&(this._proxy.revoke(),delete this._proxy.proxy,delete this._proxy),delete this._data,this._marks&&(this._marks.clear(),delete this._marks),this.stopListening(),this.off())}update(e,t=!1,s=!0){let i=!1;return(0,r.forEach)(e,((e,s)=>{let o=this._data[s];o!==e&&(i||(i={}),i[s]=o,this._data[s]=e,t||this.emit(s,this,e,o))})),s||(0,r.forEach)(this._data,((s,o)=>{if((0,r.isUndefined)(e[o])){let e=this._data[o];i||(i={}),i[o]=e,this._data[o]=void 0,t||this.emit(o,this,void 0,e)}})),i&&!t&&this.emit(o.CHANGE,this,i),i}get isDestroyed(){return this.__destroyed}get data(){return this._proxy?this._proxy.proxy:this._data}get plainData(){return this._data}get marks(){return this._marks||(this._marks=new Map),this._marks}get id(){let e=this.data[this.fieldId||"id"];return(0,r.isUndefined)(e)?this._id:e}}n.prototype.fieldId=void 0,n.prototype.defaults=void 0;s(2707);class a extends i.vp{constructor(e=!1,t){super(),this._id=(0,r.uniqueId)("dataset"),this._options={items:[],useCacheIds:e},e&&(this._options.ids=[]),t?this.DataObject=t:void 0===t&&(this.DataObject=n)}add(e,t={silent:!1}){return this.set(e,(0,r.defaults)(t,{merge:!0}))}set(e,t={silent:!1,merge:!1,destroy:!0,uniq:!1}){let s,n,l=this.items,c=[],d=[],u=this.DataObject;return(0,r.isArray)(e)||(e=[e]),e.length||t.merge?(t.uniq&&(e=(0,r.uniq)(e,!1,(e=>e&&this.getIdFromData(e)))),e.length&&e.forEach((e=>{if(!(0,r.isObject)(e))return;if(l.includes(e))return void d.push(e);let s=this.getIdFromData(e);this.hasById(s)?d.push(this.get(s)):(!u||e instanceof this.DataObject||(e=this.prepareData(e)))&&(e instanceof i.vp&&(this.listenTo(e,o.DESTROY,this._onDestroyData),this.listenTo(e,o.CHANGE,((e,t)=>this.emit(o.CHANGE,e,t)))),c.push(e),d.push(e),t.silent||this.emit(o.ADD,this,e))})),s=l.filter((e=>!d.includes(e))),s.length&&(t.merge?(d=s.concat(d),s=void 0):this._remove(s,t)),this._options.items=d,this._options.ids&&(this._options.ids=d.map((e=>this.getIdFromData(e)))),n=a.prepareDelta(c,s),t.silent||this.emit(o.UPDATE,this,n),n):this.clear()}_onDestroyData(e){this.emit(o.UPDATE,this,a.prepareDelta(null,this._removeOne(e,{silent:!1})))}prepareData(e){if(e instanceof n)return e;if(this.DataObject){let t=(0,r.isUndefined)(this.fieldId)||this.DataObject.prototype.fieldId?void 0:this.fieldId;return e=new this.DataObject(e,!0,t)}}getIdFromData(e){if(e instanceof n)return e.id;let t=this.DataObject&&this.DataObject.prototype.fieldId||this.fieldId||"id";return t&&e[t]}static prepareDelta(e,t){let s,i={};return e&&e.length&&(s=i.inserted=e),t&&t.length&&(s=i.removed=t),s?i:null}remove(e,t={silent:!1,destroy:!0}){if(e===this.items||e===this.ids)return this.clear(t);let s;return s=(0,r.isArray)(e)?a.prepareDelta(null,this._remove(e,t)):a.prepareDelta(null,this._removeOne(e)),this.emit(o.UPDATE,this,s),s}_removeOne(e,t){let s,n,a=[],l=this.items,c=l.indexOf(e);return-1===c?(s=this.get(e),c=l.indexOf(s)):s=e,c>-1&&(a=l.splice(c,1),this.useCacheIds&&(n=this.getIdFromData(s),this._options.ids=(0,r.without)(this._options.ids,n)),s instanceof i.vp&&(t&&t.silent||s.emit(o.REMOVE,s),this.stopListening(s)),t&&t.destroy&&(0,r.isFunction)(s.destroy)&&s.destroy()),a}_remove(e,t={silent:!1,destroy:!0}){let s,n=[],a=this.items,l=this.useCacheIds;l&&(s=[]);for(let c,d,u=0,p=e.length;u<p;u++)c=e[u],d=a.indexOf(c),-1===d&&(c=this.get(c),d=a.indexOf(c)),d>-1&&(l&&s.push(this.getIdFromData(c)),n.push(e),a.splice(d,1),c instanceof i.vp&&(t&&t.silent||c.emit(o.REMOVE,c),this.stopListening(c)),t&&t.destroy&&(0,r.isFunction)(c.destroy)&&c.destroy());return n.length?(l&&(this._options.ids=(0,r.without)(this._options.ids,...s)),n):null}get(e){let t=this.items;for(let s,i=0,o=t.length;i<o;i++)if(s=t[i],s===e||this.getIdFromData(s)===e)return s;return null}getMultiple(e){if((0,r.isArray)(e))return e.map((e=>this.get(e)))}has(e){if((0,r.isUndefined)(e))return!1;let t=this.items;if(t.includes(e))return!0;if((0,r.isObject)(e)){let t=this.getIdFromData(e);if((0,r.isUndefined)(t))return!1;e=t}if(this.useCacheIds&&this.ids.includes(e))return!0;for(let s,i=0,o=t.length;i<o;i++)if(s=t[i],this.getIdFromData(s)===e)return!0;return!1}hasById(e){return!(0,r.isUndefined)(e)&&(this.useCacheIds?this._options.ids.includes(e):this.has(e))}findIndex(e,t){return(0,r.findIndex)(this.items,e,t)}firstId(){if(this.size)return this._options.ids?this._options.ids[0]:this.getIdFromData(this.items[0])}lastId(){if(this.size)return this._options.ids?(0,r.last)(this._options.ids):this.getIdFromData(this.items[this.size-1])}swapIndex(e,t){let s=this.items.length;if(e<0||e>s||t<0||s<t)return!1;this.items[e]=this.items.splice(t,1,this.items[e])[0],this._options.ids&&(this.ids[e]=this.ids.splice(t,1,this.ids[e])[0])}swapItem(e,t){return e=this.items[this.get(e)],t=this.items[this.get(t)],!(!e||!t)&&this.swapIndex(this.items.indexOf(e),this.items.indexOf(t))}nextItem(e){let t=this.get(e),s=this.items.indexOf(t);if(t&&-1!==s&&s!==this.size-1)return this.items[++s]}prevItem(e){let t=this.get(e),s=this.items.indexOf(t);if(t&&-1!==s&&0!==s)return this.items[--s]}nextId(e){if((0,r.isUndefined)(e))return;if(this._options.ids){let t=this._options.ids.indexOf(e);if(-1===t||t===this.size-1)return;return this._options.ids[++t]}let t=this.nextItem(e);return t?this.getIdFromData(t):void 0}prevId(e){if((0,r.isUndefined)(e))return;if(this._options.ids){let t=this._options.ids.indexOf(e);if(-1===t||0===t)return;return this._options.ids[--t]}let t=this.prevItem(e);return t?this.getIdFromData(t):void 0}sort(e){this.items.sort(e),this._options.ids&&(this._options.ids=this.items.map((e=>this.getIdFromData(e)))),this.emit(o.SORT,this)}clear(e={silent:!1,destroy:!0}){let t,s=this.items;if(!this.size)return t=a.prepareDelta(),this.emit(o.UPDATE,this,t),t;for(let r,n=0,a=this.items.length;n<a;n++)r=s[n],r instanceof i.vp&&(e&&!e.silent&&r.emit(o.REMOVE,r),this.stopListening(r)),e.destroy&&"object"==typeof r&&"function"==typeof r.destroy&&r.destroy();return this._options.items=[],this._options.ids&&(this._options.ids=[]),t=a.prepareDelta(null,s),this.emit(o.UPDATE,this,t),t}get fieldId(){return this._options.fieldId}set fieldId(e){this._options.fieldId!==e&&(this._options.fieldId=e)}get size(){return this.items.length}get DataObject(){return this._options.DataObject}set DataObject(e){return this._options.DataObject=e}get items(){return this._options.items}get ids(){return this._options.ids}get useCacheIds(){return this._options.useCacheIds}}},19882:(e,t,s)=>{"use strict";s.d(t,{q:()=>n});s(88674);var i=s(12950),o=s(12953);const r="/ajax/donations_actions.php";async function n(e){const{response:t,data:s}=await i.cf.post(r,{action:"get_payment_widget_params",user_id:e.userId,story_id:e.storyId});if(!t.result)throw o.core.logger.error("get_payment_widget_params error",t.message),new Error(t.message);return{layoutId:s.layout_id,invoiceId:s.invoice_id}}},55576:(e,t,s)=>{"use strict";s.d(t,{B:()=>r});s(88674);var i=s(12953);let o;async function r(e){if(!("subscribe"===e.supportType&&!e.giveChoice)||i.default.isUserAuthorized){if(!o){const{createApp:e}=await s(59385);o=e().mount(document.createDocumentFragment())}await o.open(e)}else i.default.ui.authRequired()}},26117:(e,t,s)=>{"use strict";s.d(t,{co:()=>a,a_:()=>u});s(88674),s(41817);var i=s(12953),o=s(12950);function r(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class a{static async getPreviewList(){return o.cf.get(a.ajaxEndpoint,{route:"story-draft/get-list"})}static async checkIsDraftsLimitReached(){const{response:e,data:t}=await o.cf.get(a.ajaxEndpoint,{route:"story-draft/can-add-more"});if(!e.result)throw i.core.ui.toasts.showError(e.message),e.message;return!(null!=t&&t.can_add_more)}static async getById(e){const{response:t,data:s}=await o.cf.get(a.ajaxEndpoint,{route:"story-draft/get-by-id",draft_id:e});if(!t.result)throw i.core.ui.toasts.showError(t.message),t.message;return s}static async generateLastEditorId(){const{response:e,data:t}=await o.cf.get(a.draftEndpoint,{action:"set_last_editor_id"});return e.result?t.id:(console.error(e.message),null)}static async saveDraft(e,t){const s={};"overwrite_oldest"===t?s.overwrite_oldest_draft=1:s.id=t;const{response:l,data:c}=await o.cf.post(a.ajaxEndpoint,function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?r(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):r(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({route:"story-draft/save",data:JSON.stringify(e),parent_story_id:e.parent_story_id},s));if(!l.result)throw i.core.ui.toasts.showError(l.message),l.message;return{draftId:c.draft_id,draftsCount:c.drafts_count}}static async deleteDraft(e){return await o.cf.post(a.ajaxEndpoint,{route:"story-draft/delete",draft_id:e})}static async deleteAllDrafts(){return await o.cf.post(a.ajaxEndpoint,{route:"story-draft/clear-all"})}static async deleteOldestDraft(){const{response:e}=await o.cf.post(a.ajaxEndpoint,{route:"story-draft/delete-oldest-draft"});if(!e.result)throw i.core.ui.toasts.showError(e.message),e.message}static getDraftTime(){return Math.floor(Date.now()/1e3)}}n(a,"draftEndpoint","/ajax/gtpost_actions.php"),n(a,"ajaxEndpoint","/ajax.php");var l=s(88358),c=s(31474),d=s(42107);class u{static async show({analyticsType:e}={}){return e&&d.cp.getInstance().sendEvent("tip_show",{type:e}),await l.nk.confirmModal({content:"Вы создали максимальное количество черновиков. Самый старый из них будет удален. Продолжить?",buttons:[["modal.continue",c.j.SUCCESS,!0],["modal.cancel",c.j.DANGER,!1]]})}}},58453:(e,t,s)=>{"use strict";s.d(t,{B:()=>a});s(66992),s(33948),s(41817);var i=s(23603);function o(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=["пикабу","pikabu","helloirainbow"],n=["#ef5350","#ec407a","#ab47bc","#7e57c2","#5c6bc0","#42a5f5","#29b6f6","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043"];class a{constructor(){o(this,"timerId",0),o(this,"handleClick",(e=>{void 0===this.word&&setTimeout((()=>{this.processClickedDomNode(e)&&(this.splitWordToElements(),this.highlightWord())}),0)}))}init(){i.M.getInstance().observe(r,this.handleClick)}reset(){if(void 0===this.word||!this.wordCont)return;this.timerId>0&&(clearInterval(this.timerId),this.timerId=0);const e=this.wordCont.parentNode;null==e||e.replaceChild(new Text(this.word.word),this.wordCont),null==e||e.normalize(),this.word=void 0,this.wordCont=void 0,this.charElements=void 0}processClickedDomNode(e){const t=window.getSelection();if(!t||t.rangeCount<1)return!1;const s=t.getRangeAt(0);return this.wordCont=document.createElement("span"),this.wordCont.style.cssText="margin: 0; padding: 0;",this.wordCont.setAttribute("data-fancy-text","1"),s.setStart(s.startContainer,s.startOffset-e.wordLeftPart.length),s.setEnd(s.startContainer,s.startOffset+e.word.length),s.surroundContents(this.wordCont),s.collapse(),this.word=e,!0}splitWordToElements(){this.word&&this.wordCont&&(this.wordCont.innerHTML="",this.charElements=this.word.word.split("").map((e=>{var t;const s=document.createElement("span");return s.style.cssText="margin: 0; padding: 0;",s.textContent=e,null===(t=this.wordCont)||void 0===t||t.appendChild(s),s})))}highlightWord(){let e=0;this.timerId=window.setInterval((()=>{if(this.charElements)if(e++>10)this.reset();else for(const e of this.charElements)e.style.color=n[Math.floor(Math.random()*n.length)]}),100)}}},80530:(e,t,s)=>{"use strict";s.d(t,{Y:()=>n});s(66992),s(33948),s(88674),s(84944),s(33792),s(41817);var i=s(23603);function o(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=[{words:["49.5","49,5","49.5см","49,5см"],soundUrl:"https://cs.pikabu.ru/files/funny/oh-my-v2.mp3"},{words:new Array(17).fill(null).map(((e,t)=>"n"+"o".repeat(t+3))),soundUrl:"https://cs.pikabu.ru/files/funny/nooo-v3.mp3"},{words:["icq"],soundUrl:"https://cs.pikabu.ru/files/funny/icq-v3.mp3"}];class n{constructor(){o(this,"playLastTime",0),o(this,"sounds",new Map),o(this,"handleClick",(async e=>{if(this.playLastTime>Date.now()-1e3)return;if(!this.audioContext||!this.gainNode)return;const t=e.word.toLowerCase();for(const i of r)if(i.words.includes(t)){this.sounds.has(i.soundUrl)||await this.loadSound(i.soundUrl);const e=this.sounds.get(i.soundUrl);if(!e)return;try{const t=this.audioContext.createBufferSource();t.buffer=e,t.connect(this.gainNode),t.start()}catch(s){}this.playLastTime=Date.now();break}}))}init(){try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=.4,this.gainNode.connect(this.audioContext.destination)}catch(e){return void console.error("AudioContext is not supported")}i.M.getInstance().observe(r.map((e=>e.words)).flat(),this.handleClick)}async loadSound(e){if(!this.audioContext)return;const t=await(await fetch(e)).arrayBuffer();this.sounds.set(e,await this.audioContext.decodeAudioData(t))}}},23603:(e,t,s)=>{"use strict";s.d(t,{M:()=>r});s(66992),s(33948),s(84944),s(33792),s(85827),s(74916),s(41817);function i(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const o=["comment__content","story-block_type_text","profile__nick"];class r{constructor(){i(this,"isActive",!0),i(this,"targetWordsCache",[]),i(this,"observers",[]),i(this,"handleClick",(e=>{if(!this.isActive)return;const t=this.getClickedWord(e);if(null===t)return;const s=t.word.toLowerCase();for(const i of this.observers)i.words.includes(s)&&i.callback(t)}))}static getInstance(){return r.self||(r.self=new r,r.self.init()),r.self}stopObserving(){this.isActive=!1}resumeObserving(){this.isActive=!0}observe(e,t){this.observers.push({words:e,callback:t}),this.updateTargetsWordsCache()}init(){document.addEventListener("click",(e=>{this.isActive&&e.target&&this.handleClick(e.target)}))}updateTargetsWordsCache(){this.targetWordsCache=[...new Set(this.observers.map((e=>e.words.map((e=>e.toLowerCase())))).flat())]}getClickedWord(e){var t,s;if(!(e instanceof HTMLElement))return null;const i=window.getSelection();if(!i||i.rangeCount<1)return null;const r=i.getRangeAt(0),n=i.anchorNode;if(!e.contains(n))return null;if(!n||n.nodeType!==Node.TEXT_NODE||r.startOffset!==r.endOffset||r.startContainer!==r.endContainer||null!==(t=n.parentElement)&&void 0!==t&&t.closest("[contenteditable], A, SVG")||null===(s=n.parentElement)||void 0===s||!s.closest("."+o.join(", .")))return null;const a=n.nodeValue;if(!a||!this.targetWordsCache.some((e=>a.toLowerCase().includes(e))))return null;const l=this.targetWordsCache.reduce(((e,t)=>Math.max(e,t.length)),0),c=Math.max(0,r.startOffset-l),d=[/[\s!"'(),.:;?-]/,/[\s!"'():;?-]/];let u,p,h;for(const o of d)if(p=a.substr(c,r.startOffset-c).split(o).pop()||"",h=a.substr(r.startOffset,l).split(o).shift()||"",u=p+h,this.targetWordsCache.includes(u.toLowerCase()))return{word:u,wordLeftPart:p,wordRightPart:h};return null}}},42359:(e,t,s)=>{"use strict";s.d(t,{x:()=>o});s(66992),s(33948),s(41817);var i=s(65901);class o{constructor(e){let t=0;for(let s of Object.keys(e)){let o=e[s],r=new i.T(s,o,t++);Object.defineProperty(this,s,{value:r,configurable:!1,writable:!1,enumerable:!0}),s!==o&&Object.defineProperty(this,o,{value:r,configurable:!1,writable:!1,enumerable:!1})}Object.freeze(this)}keys(){return Object.keys(this)}values(){return this.keys().map((e=>this[e].valueOf()))}entries(){return this.keys().map((e=>this[e]))}has(e,t=!1){return!(!e||"function"!=typeof e.toString)&&this.hasOwnProperty(t?e.toString().toUpperCase():e.toString())}[Symbol.iterator](){let e=this.keys().map((e=>this[e]))||[],t={next:()=>{let t=e.shift();return{done:void 0===t,value:t}}};return t[Symbol.iterator]=()=>t,t}static create(e){return new o(e)}}},65448:(e,t,s)=>{"use strict";s.d(t,{xs:()=>o.x,pt:()=>r,Tf:()=>i.T});var i=s(65901),o=s(42359);class r{static header(e){return e instanceof i.T?["span",{style:"font-weight: bold;"},e.toString()]:null}static hasBody(e){return!1}static body(e){return["span",{},e.valueOf()]}}},65901:(e,t,s)=>{"use strict";s.d(t,{T:()=>i});class i{constructor(e,t,s){Object.defineProperty(this,"_name",{value:e,configurable:!1,writable:!1,enumerable:!1}),void 0!==t&&Object.defineProperty(this,"_value",{value:t,configurable:!1,writable:!1,enumerable:!1}),void 0!==s&&Object.defineProperty(this,"_index",{value:s,configurable:!1,writable:!1,enumerable:!1}),Object.freeze(this)}get name(){return this._name}get value(){return this._value}get index(){return this._index}toString(){return this._name}valueOf(){return this._value}toJSON(){return this.toString()}}},44497:(e,t,s)=>{"use strict";let i,o,r,n,a;s.d(t,{Gv:()=>n,ZF:()=>a,Zq:()=>o,me:()=>r}),function(e){e.FRAME="frame",e.MARK="mark",e.MEASURE="measure",e.NAVIGATION="navigation",e.RESOURCE="resource",e.SERVER="server"}(i||(i={})),function(e){e.UNIVERSAL="universal",e.MOBILE="mobile",e.DESKTOP="desktop",e.AMP="amp"}(o||(o={})),function(e){e[e.DESKTOP=0]="DESKTOP",e[e.MOBILE=1]="MOBILE",e[e.TABLET=2]="TABLET",e[e.SPIDER=3]="SPIDER"}(r||(r={})),function(e){e[e.PRODUCTION=225]="PRODUCTION",e[e.TESTING=226]="TESTING",e[e.LOCAL=227]="LOCAL",e[e.CI=228]="CI"}(n||(n={})),function(e){e.AUTHORIZATION_REQUIRED="AUTHORIZATION_REQUIRED",e.AUTHORIZATION_REQUIRED_NO_LINKS="AUTHORIZATION_REQUIRED_NO_LINKS",e.LOST_ACCOUNT="LOST_ACCOUNT",e.BANNED="BANNED",e.NEED_MORE_RATING="NEED_MORE_RATING",e.FULLY_BANNED="FULLY_BANNED"}(a||(a={}))},53561:(e,t,s)=>{"use strict";s.d(t,{X:()=>o,b:()=>i});const i="_eventAll",o=/\s+/},16253:(e,t,s)=>{"use strict";s.d(t,{ZK:()=>o.Z,bB:()=>i.b,vp:()=>o.v});var i=s(53561),o=s(2439)},8117:(e,t,s)=>{"use strict";s.d(t,{t:()=>r});s(88674),s(66992),s(33948);var i=s(98858),o=s(96637);async function r(e,t=0,s=0){const r=new i.Np(e);if(t&&s){const n=await i.nO.getInfo(e),a=n.exif&&n.exif.Orientation&&n.exif.Orientation>4,l=a?n.height:n.width,c=a?n.width:n.height,[d,u]=o.Utils.getDimension(l,c,t,s,"cover");r.resize(d,u)}return r.rotate("auto"),r.get()}},77247:()=>{var e,t;e=function(e,t,s){var i=e,o=t||0,r=0;this.getRawData=function(){return i},"string"==typeof e&&(r=s||i.length,this.getByteAt=function(e){return 255&i.charCodeAt(e+o)},this.getBytesAt=function(e,t){for(var s=[],r=0;r<t;r++)s[r]=255&i.charCodeAt(e+r+o);return s}),this.getLength=function(){return r},this.getSByteAt=function(e){return 127<(e=this.getByteAt(e))?e-256:e},this.getShortAt=function(e,t){var s=t?(this.getByteAt(e)<<8)+this.getByteAt(e+1):(this.getByteAt(e+1)<<8)+this.getByteAt(e);return 0>s&&(s+=65536),s},this.getSShortAt=function(e,t){var s=this.getShortAt(e,t);return 32767<s?s-65536:s},this.getLongAt=function(e,t){var s=this.getByteAt(e),i=this.getByteAt(e+1),o=this.getByteAt(e+2),r=this.getByteAt(e+3);return 0>(s=t?(((s<<8)+i<<8)+o<<8)+r:(((r<<8)+o<<8)+i<<8)+s)&&(s+=4294967296),s},this.getSLongAt=function(e,t){var s=this.getLongAt(e,t);return 2147483647<s?s-4294967296:s},this.getStringAt=function(e,t){for(var s=[],i=this.getBytesAt(e,t),o=0;o<t;o++)s[o]=String.fromCharCode(i[o]);return s.join("")},this.getCharAt=function(e){return String.fromCharCode(this.getByteAt(e))},this.toBase64=function(){return window.btoa(i)},this.fromBase64=function(e){i=window.atob(e)}},t={},function(){function e(e){if(255!=e.getByteAt(0)||216!=e.getByteAt(1))return!1;for(var t=2,s=e.getLength();t<s;){if(255!=e.getByteAt(t))return r&&console.log("Not a valid marker at offset "+t+", found: "+e.getByteAt(t)),!1;var i=e.getByteAt(t+1);if(22400==i||225==i)return r&&console.log("Found 0xFFE1 marker"),o(e,t+4,e.getShortAt(t+2,!0));t+=2+e.getShortAt(t+2,!0)}}function s(e,t,s,o,n){for(var a=e.getShortAt(s,n),l={},c=0;c<a;c++){var d=s+12*c+2,u=o[e.getShortAt(d,n)];!u&&r&&console.log("Unknown tag: "+e.getShortAt(d,n)),l[u]=i(e,d,t,s,n)}return l}function i(e,t,s,i,o){var r=e.getShortAt(t+2,o);switch(i=e.getLongAt(t+4,o),s=e.getLongAt(t+8,o)+s,r){case 1:case 7:if(1==i)return e.getByteAt(t+8,o);for(s=4<i?s:t+8,t=[],r=0;r<i;r++)t[r]=e.getByteAt(s+r);return t;case 2:return e.getStringAt(4<i?s:t+8,i-1);case 3:if(1==i)return e.getShortAt(t+8,o);for(s=2<i?s:t+8,t=[],r=0;r<i;r++)t[r]=e.getShortAt(s+2*r,o);return t;case 4:if(1==i)return e.getLongAt(t+8,o);for(t=[],r=0;r<i;r++)t[r]=e.getLongAt(s+4*r,o);return t;case 5:if(1==i)return e.getLongAt(s,o)/e.getLongAt(s+4,o);for(t=[],r=0;r<i;r++)t[r]=e.getLongAt(s+8*r,o)/e.getLongAt(s+4+8*r,o);return t;case 9:if(1==i)return e.getSLongAt(t+8,o);for(t=[],r=0;r<i;r++)t[r]=e.getSLongAt(s+4*r,o);return t;case 10:if(1==i)return e.getSLongAt(s,o)/e.getSLongAt(s+4,o);for(t=[],r=0;r<i;r++)t[r]=e.getSLongAt(s+8*r,o)/e.getSLongAt(s+4+8*r,o);return t}}function o(e,i){if("Exif"!=e.getStringAt(i,4))return r&&console.log("Not valid EXIF data! "+e.getStringAt(i,4)),!1;var o,n=i+6;if(18761==e.getShortAt(n))o=!1;else{if(19789!=e.getShortAt(n))return r&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;o=!0}if(42!=e.getShortAt(n+2,o))return r&&console.log("Not valid TIFF data! (no 0x002A)"),!1;if(8!=e.getLongAt(n+4,o))return r&&console.log("Not valid TIFF data! (First offset not 8)",e.getShortAt(n+4,o)),!1;var a=s(e,n,n+8,t.TiffTags,o);if(a.ExifIFDPointer){var l,c=s(e,n,n+a.ExifIFDPointer,t.Tags,o);for(l in c){switch(l){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":c[l]=t.StringValues[l][c[l]];break;case"ExifVersion":case"FlashpixVersion":c[l]=String.fromCharCode(c[l][0],c[l][1],c[l][2],c[l][3]);break;case"ComponentsConfiguration":c[l]=t.StringValues.Components[c[l][0]]+t.StringValues.Components[c[l][1]]+t.StringValues.Components[c[l][2]]+t.StringValues.Components[c[l][3]]}a[l]=c[l]}}if(a.GPSInfoIFDPointer)for(l in o=s(e,n,n+a.GPSInfoIFDPointer,t.GPSTags,o))"GPSVersionID"===l&&(o[l]=o[l][0]+"."+o[l][1]+"."+o[l][2]+"."+o[l][3]),a[l]=o[l];return a}var r=!1;t.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},t.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},t.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},t.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}},t.getData=function(t,s){return!!t.complete&&(t.exifdata?s&&s():BinaryAjax(t.src,(function(i){i=e(i.binaryResponse),t.exifdata=i||{},s&&s()})),!0)},t.getTag=function(e,t){if(e.exifdata)return e.exifdata[t]},t.getAllTags=function(e){if(!e.exifdata)return{};e=e.exifdata;var t,s={};for(t in e)e.hasOwnProperty(t)&&(s[t]=e[t]);return s},t.pretty=function(e){if(!e.exifdata)return"";e=e.exifdata;var t,s="";for(t in e)e.hasOwnProperty(t)&&(s="object"==typeof e[t]?s+(t+" : [")+e[t].length+" values]\r\n":s+(t+" : ")+e[t]+"\r\n");return s},t.readFromBinaryFile=function(t){return e(t)}}(),FileAPI.support.exif=!0,FileAPI.addInfoReader(/^image/,(function(s,i){if(!s.__exif){var o=s.__exif=FileAPI.defer(),r=s;if(r instanceof Blob&&r.size>131072)try{var n=Math.min(r.size,131072);r=(r.slice||r.mozSlice||r.webkitSlice).call(r,0,n)}catch(a){FileAPI.log("exception "+a)}FileAPI.readAsBinaryString(r,(function(s){if("load"==s.type){var i=s.result,n=new e(i,0,r.size),a=t.readFromBinaryFile(n);o.resolve(!1,{exif:a||{}})}else"error"==s.type&&o.resolve("read_as_binary_string_exif")}))}s.__exif.then(i)}))},98858:(e,t,s)=>{"use strict";s.d(t,{HP:()=>r,nO:()=>n,Np:()=>a});s(77247),s(74916),s(88674),s(66992),s(3462),s(33824),s(41817);function i(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}s(29917);const o=window.FileAPI,r=/image\/(png|jpeg|gif|webp)/;class n{static getImageFiles(e){return o.getFiles(e).filter((e=>e instanceof Blob&&r.test(e.type)))}static getInfo(e){return new Promise(((t,s)=>{o.getInfo(e,((e,i)=>{if(e)return s(e);t(i)}))}))}static filterFiles(e,t){return new Promise((s=>{o.filterFiles(e,t,s)}))}static isAnimatedGif(e,t){return new Promise(((s,i)=>{if("image/gif"!==e.type)return s(!1);o.readAsArrayBuffer(e,(function(e){if("load"===e.type){let t,i,o=new Uint8Array(e.result),r=o.length,n=0,a=0;if(71!==o[0]||73!==o[1]||70!==o[2]||56!==o[3])return s(!1);for(t=0,i=r-9;a<2e5;++t)0!==o[t]||33!==o[t+1]||249!==o[t+2]||4!==o[t+3]||0!==o[t+8]||44!==o[t+9]&&33!==o[t+9]?a++:n++;return s(n>1)}"progress"===e.type?t&&t(e.loaded/e.total*100):i()}))}))}static isSupportedImage(e){return e instanceof Blob&&r.test(e.type)}}i(n,"File",o),i(n,"Image",o.Image);class a extends o.Image{get(){return new Promise(((e,t)=>{super.get(((s,i)=>{if(s)return t(s);e(i)}))}))}}s(8117)},78370:(e,t,s)=>{"use strict";s.d(t,{k:()=>u});s(88674),s(41817);var i=s(16071),o=s(53056),r=s(85679),n=s(12950),a=s(12953);function l(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function c(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?l(Object(s),!0).forEach((function(t){d(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function d(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class u{static async add(e){return n.cf.post(u.ajaxEndpoint,c({route:`${u.routePrefix}/add`},e))}static async edit(e){return n.cf.post(u.ajaxEndpoint,c({route:`${u.routePrefix}/edit`},e))}static async close(e){return n.cf.post(u.ajaxEndpoint,{route:`${u.routePrefix}/close`,id:e})}static async getStoryFundraising(e){var t;const s=null!==(t=Number(o.m.get(i.k)))&&void 0!==t?t:0,l=Date.now()-s<=5*r.g4?"":a.core.initParams.statUrl;return n.cf.get(l+"/cache.php?route=fr-widget",{id:e},{crossDomain:!0})}}d(u,"ajaxEndpoint","/ajax.php"),d(u,"routePrefix","fundraising-campaigns")},16071:(e,t,s)=>{"use strict";s.d(t,{k:()=>i});const i="pkb_ltfw"},53035:(e,t,s)=>{"use strict";s.d(t,{k:()=>m.k,$Q:()=>v.$Q,Oe:()=>v.Oe,Ao:()=>v.Ao,Ll:()=>f});s(88674),s(41817);var i=s(14032),o=s(19882),r=s(12953);const n=["userId","storyId","amount"],a=["invoiceId","layoutId","amount"];function l(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function c(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?l(Object(s),!0).forEach((function(t){d(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function d(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function u(e,t){if(null==e)return{};var s,i,o=function(e,t){if(null==e)return{};var s,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)s=r[i],t.indexOf(s)>=0||(o[s]=e[s]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)s=r[i],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(o[s]=e[s])}return o}async function p(e){let{userId:t,storyId:s,amount:l}=e,d=u(e,n);const p=await(0,o.q)({userId:t,storyId:s});p&&await async function(e){let{invoiceId:t,layoutId:s,amount:o}=e,n=u(e,a);try{await(0,i.vU)(c(c({invoiceId:t,layoutId:s,amount:o},n),{},{onFail:e=>{var t;r.core.logger.error("cloud tips widget",e),null===(t=n.onFail)||void 0===t||t.call(n,e)}})),setTimeout((()=>{r.core.ui.isPageScrollable=!1,(0,i.lZ)((()=>{r.core.ui.isPageScrollable=!0}))}))}catch(l){throw r.core.logger.error("cloud tips widget",l),new Error("Ошибка! Не удалось перейти к оплате")}}(c({invoiceId:p.invoiceId,layoutId:p.layoutId,amount:l},d))}var h=s(53056),_=s(16071),m=s(78370),g=s(33877),v=s(3780);async function f({userId:e,storyId:t,fundraisingId:s,progressbar:o}){try{const r=e=>{(0,i.Wi)(e)&&(h.m.set(_.k,Date.now()),m.k.getStoryFundraising(s).then((async({response:e,data:t})=>{if(!e.result)throw new Error(e.message);const{active:s,targetAmount:i,currentAmount:r}=(0,v.Ao)(t);if(!s)throw new Error("Виджет не активен");return await(0,g.g)(800),o.update(i,r),!0})).catch((e=>{console.error(e)})))};await p({userId:e,storyId:t,onSuccess:r})}catch(n){r.core.ui.toasts.showError(n instanceof Error?n.message:n)}}},3780:(e,t,s)=>{"use strict";s.d(t,{$Q:()=>o,Oe:()=>r,Ao:()=>n});s(74916),s(15306),s(41817);var i=s(72346);function o(e){return Number(String(e).replace(/\s/g,""))}function r(e){const t=i.o.unescape();return{id:e.id,title:t(e.title),currentAmount:e.current_amount,targetAmount:e.target_amount,description:t(e.description)}}function n(e){const t=i.o.unescape(),s=e.is_active;return{id:e.id,title:t(e.title),currentAmount:e.current_amount,targetAmount:e.target_amount,description:s?t(e.description):"",progress:e.progress,active:s}}},77416:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n,y:()=>n});s(74916),s(66992),s(33948),s(24603);var i=s(96637),o=s(72044),r=s(36005);class n{static add(e,t,s="highlight",i=null){if(((0,r.isString)(t)||(0,r.isArray)(t))&&!t.length)return;let a=n._prepareRegExp(t),l=function(e){let t,o,r,n,c,d,u,p=0;if(3===e.nodeType){if(r=e.data.match(a),r&&e.data.length>0){if(i){const e=i(r);t=r.index+e.startPos,o=e.length}else t=r.index,o=r[0].length;n=document.createElement("span"),n.className=s,c=e.splitText(t),d=c.splitText(o),u=c.cloneNode(!0),n.appendChild(u),c.parentNode.replaceChild(n,c),p=1}}else if(1===e.nodeType&&e.childNodes&&!/(script|style)/i.test(e.tagName)&&(e.className!==s||"SPAN"!==e.tagName)&&!e.getAttribute("data-skip-highlight"))for(let s=0;s<e.childNodes.length;++s)s+=l(e.childNodes[s]);return p};o.Zv.isJQuery(e)?e.each(((e,t)=>l(t))):l(e)}static remove(e,t="highlight"){let s=(e=o.Zv.isJQuery(e)?e.get(0):e).querySelectorAll(`span.${t}`);if(s.length)for(let i of s){if(!i.parentNode)continue;let e=i.parentNode;e.replaceChild(i.firstChild,i),e.normalize()}}static _prepareRegExp(e){return(0,r.isString)(e)?new RegExp(i.Utils.escapeStringRegExp(e),"i"):(0,r.isArray)(e)?new RegExp(e.map(i.Utils.escapeStringRegExp).join("|"),"i"):e}}},95411:(e,t,s)=>{"use strict";s.d(t,{FM:()=>_,SV:()=>m});s(66992),s(33948),s(74916),s(15306);var i=s(42359),o=s(42107),r=s(96637),n=s(36005);const a=s(19755),l=s(65470),c=/\s+/,d={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},u={option:"alt",command:"meta",cmd:l.mac?"meta":"ctrl"};let p={},h={SHIFT:[1,"shiftKey"],CTRL:[2,"ctrlKey"],ALT:[8,"altKey"],META:[16,"metaKey"]},_={KEYDOWN:"keydown",KEYPRESS:"keypress",KEYUP:"keyup"};(0,n.each)({back:8,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,lwin:91,win:91,rwin:92,contextmenu:93,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,subtract:109,decimal:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scroll:145,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},(function(e,t){p[e]=t})),_=new i.x(_);class m{constructor(e){this._handleKeyEvent=this._handleKeyEvent.bind(this),this._work=!0,this._winDown=!1,this.$el=a(e),this._workInInput=m.isInput(this.$el[0]),this._handlers=void 0,this._workDebounce=(0,n.debounce)((()=>{this._stopDebounce||(this._work=!0)}),200),document.addEventListener("visibilitychange",(()=>{"visible"===document.visibilityState?(this._stopDebounce=!1,this._workDebounce()):"hidden"===document.visibilityState&&(this._work=!1,this._stopDebounce=!0)})),this._winDebounce=(0,n.debounce)((()=>{this._winDown=!1}),5e3),this._handleKeyEventBound=this._handleKeyEvent.bind(this)}_addListeners(){this.$el.on("keypress keydown keyup",this._handleKeyEventBound)}_removeListeners(){this.$el.off("keypress keydown keyup",this._handleKeyEventBound)}static isInput(e){return r.Utils.isInput(e)}_handleKeyEvent(e){if(!this._handlers||!this._handlers.size)return!0;if(m.isInput(e.target)&&!this._workInInput||a(e.target).parents('article[data-ad-type="feed"]').length)return!0;let t,s,i=0,r=(0,n.isNumber)(e.which)?Number(e.which):e.keyCode,c=_[(e.type||"").toUpperCase()];if(t=c!==_.KEYPRESS&&p[r]?p[r]:String.fromCharCode(r).toLowerCase(),l.windows&&("win"!==t&&"lwin"!==t&&"rwin"!==t||(c===_.KEYDOWN?(this._winDown=!0,this._winDebounce()):c===_.KEYUP&&(this._winDown=!1)),this._winDown&&(i+=32)),!this._handlers.has(t))return!0;i=(0,n.reduce)(h,((t,s)=>t+(e[s[1]]?s[0]:0)),i);for(let n of this._handlers.get(t))if(n.type===c&&(n.repeat||!e.originalEvent.repeat)&&(!0===n.always||this._work)&&(n.ignoreModifiers||i===n.modifiers||c===_.KEYPRESS)&&(!n.closest||(s||(s=a(e.target)),s.closest(n.closest).length))&&(a(e.target).parents(".input_comment-reply").length||o.cp.getInstance().sendEvent("hotkey_use",{"type!empty":t}),!1===n.callback.call(n.context,e,t))){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation();break}return!0}on(e,t,s){if(!m.prepare(this,"on",e,t,s)||!t||!e)return this;s=m.prepareOptions(s);let i,o=this._cleanKeys(e);return o.key?(this._handlers||(this._handlers=new Map,this._addListeners()),this._handlers.has(o.key)?i=this._handlers.get(o.key):this._handlers.set(o.key,i=[]),i.push((0,n.extend)(o,s,{callback:t})),this):this}once(e,t,s){if(!m.prepare(this,"on",e,t,s)||!t||!e)return this;let i=this,o=function(){i.off(e,o),t.apply(this,arguments)};return o._callback=t,this.on(e,o,s)}static prepareOptions(e){if((0,n.isObject)(e)){if(e._prepared)return e;_.has(e)&&(e={type:_[e]})}else e={};return(0,n.defaults)(e,{type:_.has(e.type)?_[e.type]:_.KEYUP,always:!1,repeat:!0,closest:!1,_prepared:!0})}static prepare(e,t,s,i,o){if(!s)return!0;if((0,n.isArray)(s))return o=m.prepareOptions(o),s.forEach((s=>{e[t].call(e,s,i,o)})),!1;if((0,n.isObject)(s))return o=m.prepareOptions(i),(0,n.forEach)(s,((s,o)=>{e[t].call(e,o,s,i)})),!1;if(c.test(s)){o=m.prepareOptions(o);for(let r of s.split(c))e[t].call(e,r,i,o);return!1}return!0}off(e,t,s){let i,o;if(!this._handlers||!m.prepare(this,"off",e,t,s))return this;if(o=(0,n.isObject)(s)&&s.context,!e&&!t&&!o)return this._handlers.clear(),this._handlers=void 0,this._removeListeners(),this;i=(e=this._cleanKeys(e).key)?[e]:this._handlers.keys();for(let r of i){let e,s=this._handlers.get(r);if(s){if(this._handlers.set(r,e=[]),t||o)for(let i of s)(t&&t!==i.callback&&t!==i.callback._callback||o&&o!==i.context)&&e.push(i);e.length||this._handlers.delete(r)}}return this._handlers.size||(this._handlers=void 0,this._removeListeners()),this}_cleanKeys(e){let t,s={key:!1,modifiers:0};return e&&(0,n.isString)(e)?(t=[],(0,n.forEach)(e.toLowerCase().split("+"),(function(e){e=e.replace(/\s/g,""),u[e]&&(e=u[e]),d[e]&&(e=d[e],t.push(h.SHIFT)),h[e.toUpperCase()]?t.push(h[e.toUpperCase()]):s.key=e})),s.modifiers=(0,n.reduce)((0,n.compact)(t),((e,t)=>e+t[0]),0),s):s}}},40138:(e,t,s)=>{"use strict";s.d(t,{q:()=>i});s(85827);function i(e,...t){return e="icon--"+e,Array.isArray(t)&&1===t.length&&Array.isArray(t[0])&&(t=t[0]),Array.isArray(t)||(t=[t]),`<svg xmlns="http://www.w3.org/2000/svg" class="icon ${t.reduce(((t,s)=>t+` ${e}_${s}`),e)}"><use xlink:href="#${e}"></use></svg>`}},87540:(e,t,s)=>{"use strict";s.d(t,{Ni:()=>l,WV:()=>n,oY:()=>r,sD:()=>c,z9:()=>o});s(88674),s(66992),s(33948);var i=s(12950);async function o(e){const{data:t}=await i.cf.postOrFail("/ajax.php",{route:"author-moderation/get-list",page:e});return t}async function r(e){const{response:t}=await i.cf.postOrFail("/ajax.php",{route:"author-moderation/cancel-ban",user_id:e});return t.result}async function n(e,t){const{response:s}=await i.cf.postOrFail("/ajax.php",{route:"author-moderation/recover-ban",user_id:e,ban_end_at:t});return s.result}const a=new Map;async function l(e){if(!a.has(e)){const{data:t}=await i.cf.postOrFail("/ajax.php",{route:"author-moderation/get-ban-counter",user_id:e});a.set(e,t.count)}return a.get(e)}async function c(e,t){const{response:s}=await i.cf.postOrFail("/ajax.php",{route:"author-moderation/ban",comment_id:e,type:t?2:1});return s.result}},33662:(e,t,s)=>{"use strict";s.d(t,{RO:()=>o,AJ:()=>a,BF:()=>n,jj:()=>m,fv:()=>c,Hc:()=>l});var i=s(65448);const o=new i.xs({WEEK:"week",MONTH:"month",THREE_MONTHS:"3-months",FOREVER:"forever",KEEP_EXISTING:"keep-existing"}),r=new i.xs({TAG:"tag",USER:"user",COMMUNITY:"community"}),n=new i.xs({ALL:"all",TAGS_SIMPLE:"simple-tag",USERS_SIMPLE:"simple-user",KEYWORDS_SIMPLE:"simple-keyword",COMMUNITIES_SIMPLE:"simple-community",TAGS_CONVOLUTED:"convoluted-tag",AUTHORS_CONVOLUTED:"convoluted-user",KEYWORDS_CONVOLUTED:"convoluted-keyword",COMMUNITIES_CONVOLUTED:"convoluted-community"}),a=new i.xs({STORIES:"ignore-changed:stories",COMMENTS:"ignore-changed:comments"}),l=3,c=25;s(66992),s(33948),s(88674);var d=s(12953),u=s(12950),p=s(90312),h=s(36005);const _="/ajax/ignore_actions.php";class m{static prepareRule(e){let t=e=>(0,h.isUndefined)(e.id)?e:e.id,s=(0,h.chain)(e).pick("id","authors","communities","tags","keywords","l","screen_id","story_id").mapObject((e=>(0,h.isArray)(e)?e.map(t):e)).mapObject((e=>String(e))).value();return e.period!==o.KEEP_EXISTING&&(s.period=e.period instanceof i.Tf&&o.has(e.period)?e.period.valueOf():o.FOREVER.valueOf()),s}static sendIgnoreAnaylytics(e,t="",s="user"){var i;const r=e.tags.length>0&&("string"==typeof e.tags?e.tags:e.tags.join(",")),n=e.authors.length>0&&e.authors.map((e=>e.id)).join(","),a=e.communities.length>0&&e.communities.map((e=>e.id)).join(","),l=e.story_id?null===(i=d.core.ui.activeStoriesFeed)||void 0===i?void 0:i.stories.get(e.story_id):null;p.c.getInstance().sendEvent("add_to_ignore_list",{"tag_id!empty":r,"author_id!empty":n,"community_id!empty":a,"type!empty":t,"ignore_type!empty":s,"post_id!empty":e.story_id,"component_name!empty":e.component_name,size:e.l?0:e.period===o.FOREVER?-1:e.period===o.WEEK?7:e.period===o.MONTH?30:e.period===o.THREE_MONTHS?91:null,screen_index:l?l.screenIndex:0}),e.l&&p.c.getInstance().sendEvent("less_similar_content_requested",{"tag_id!empty":r,"type!empty":"ignore","post_id!empty":e.story_id,screen_index:l?l.screenIndex:0})}static async addRule(e,t="",s=""){m.sendIgnoreAnaylytics(e,t,s);let{data:i}=await u.cf.postOrFail(_,(0,h.extend)(m.prepareRule(e),{action:"add_rule"}));return i}static async updateRule(e,t,s){m.sendIgnoreAnaylytics(e,"","");let i=m.prepareRule(e);if(!i||(0,h.isUndefined)(i.id))throw d.core.logger.error("ignore","некорректный формат правила"),new Error;let{data:o}=await u.cf.postOrFail(_,(0,h.extend)(i,{action:"update_rule"}));return o}static async removeRule(e){if((0,h.isUndefined)(e))throw d.core.logger.error("ignore","нужно указать id"),new Error;let{response:t}=await u.cf.postOrFail(_,{action:"remove_rule",id:Number(e)});return t.result}static async getIgnoreRules(e={}){let{type:t,term:s,searchById:i}=e,o=(0,h.extend)(e,{action:"filter_rules",search_by_id:Number(Boolean(i)),type:(0,h.isUndefined)(t)?n.ALL.valueOf():t.valueOf(),term:s&&s.valueOf()}),{data:r}=await u.cf.postOrFail(_,o);return r}static async getTagIgnore(e){return m.getIgnoreRules({type:n.TAGS_SIMPLE,search:e})}static async getUserIgnore(e){return m.getIgnoreRules({term:r.USER,searchById:!0,match:e,simple_rules_only:!0})}static async getCommunityIgnore(e){return m.getIgnoreRules({term:r.COMMUNITY,searchById:!0,match:e,simple_rules_only:!0})}static async addCommentsIgnore(e,t,s){if((0,h.isUndefined)(e))throw d.core.logger.error("ignore","нужно указать id"),new Error;const i={authors:[{id:e}],tags:[],communities:[],keywords:[],period:o.WEEK};m.sendIgnoreAnaylytics(i,t,s);let{response:r}=await u.cf.postOrFail(_,{action:"ignore_in_comments",id:Number(e)});return r.result}static async removeCommentsIgnore(e){if((0,h.isUndefined)(e))throw d.core.logger.error("ignore","нужно указать id"),new Error;let{response:t}=await u.cf.postOrFail(_,{action:"unignore_in_comments",id:Number(e)});return t.result}static async getCommentsIgnoreRules(e={}){let{data:t}=await u.cf.postOrFail(_,(0,h.extend)(e,{action:"list_ignored_in_comments"}));return t}static async clearAll(){let{response:e}=await u.cf.postOrFail(_,{action:"clear_all"});return e.result}}},76224:(e,t,s)=>{"use strict";s.d(t,{T:()=>o,_:()=>i});const i=2e3,o="pkb:lazy-script-init"},22359:(e,t,s)=>{"use strict";s.d(t,{Tu:()=>i.T,bi:()=>o.b});var i=s(76224),o=s(68434)},68434:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{b:()=>LazyScriptInit});var core_js_modules_es_array_iterator_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(66992),core_js_modules_es_array_iterator_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_iterator_js__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(33948),core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_1__),common_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(12953),common_events__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(16253),common_utils_detect_intersection_observer__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5603),common_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(96637),_consts__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(76224);const $=__webpack_require__(19755);class LazyScriptInit extends common_events__WEBPACK_IMPORTED_MODULE_3__.vp{constructor(){super(),common_utils_detect_intersection_observer__WEBPACK_IMPORTED_MODULE_4__.v&&(this._watchList=new WeakSet,this._targetsMap=new WeakMap,this._observersByDistance=new Map,this.listenTo(common_core__WEBPACK_IMPORTED_MODULE_2__.core,_consts__WEBPACK_IMPORTED_MODULE_6__.T,this._searchTargets.bind(this)),this.listenTo(common_utils__WEBPACK_IMPORTED_MODULE_5__.PostMessage.instance,location.hostname,(e=>{var t;(null===(t=e.data)||void 0===t?void 0:t.event)===_consts__WEBPACK_IMPORTED_MODULE_6__.T&&this._searchTargets()})),this._searchTargets())}_searchTargets(){$('script[type="lazy-js"], script[data-event="script-in-view"]').each(((e,t)=>{if(this._watchList.has(t))return;let s,i=parseInt(t.dataset.distance)||_consts__WEBPACK_IMPORTED_MODULE_6__._;t.hasAttribute("data-target-id")&&""!==t.dataset.targetId&&(s=document.getElementById(t.dataset.targetId)),t.hasAttribute("data-closest")&&""!==t.dataset.closest&&(s=(s||t).closest(t.dataset.closest)||s),"script-in-view"===t.dataset.event&&(s=t.parentElement,i=0),s?(this._watchList.add(t),this._targetsMap.set(s,t),this._getObserver(i).observe(s)):common_core__WEBPACK_IMPORTED_MODULE_2__.core.logger.error("lazy-js","cannot find target element")}))}_getObserver(e){let t=this._observersByDistance.get(e);return t||(t=new IntersectionObserver(this._processIntersections.bind(this,e),{rootMargin:`${e}px 0px`}),this._observersByDistance.set(e,t)),t}_processIntersections(e,t){let s=this._observersByDistance.get(e);if(s)for(let i of t)i.isIntersecting&&(s.unobserve(i.target),this._processTarget(i.target))}_processTarget(targetEl){if(!this._targetsMap.has(targetEl))return;let scriptEl=this._targetsMap.get(targetEl);this._targetsMap.delete(targetEl),"script-in-view"===scriptEl.dataset.event?$(scriptEl).replaceWith((function(){return atob(this.textContent)})):eval(scriptEl.textContent)}}},46126:(e,t,s)=>{"use strict";let i;s.d(t,{y:()=>i}),function(e){e[e.DELETE_POST=0]="DELETE_POST",e[e.DELETE_COMMENT=1]="DELETE_COMMENT",e[e.BAN_POST=2]="BAN_POST",e[e.BAN_COMMENT=3]="BAN_COMMENT",e[e.HIDE_COMMENT=4]="HIDE_COMMENT",e[e.SHOW_COMMENT=5]="SHOW_COMMENT",e[e.DELETE_POST_404=6]="DELETE_POST_404"}(i||(i={}))},66422:(e,t,s)=>{"use strict";s.d(t,{c:()=>n,D:()=>f});s(88674);var i=s(12950),o=s(47442),r=s(46126);class n{static async getInfo(e,t,s="N",o="",n){const a=e===r.y.BAN_POST||e===r.y.DELETE_POST||e===r.y.DELETE_POST_404,l={provide_reasons:s,dataType:"json",action:"get_info",check_ban:t,[a?"check_story_ban":"check_comment_ban"]:o,target_id:o,target_type:a?1:2};n&&(l.from_admoder=1);let{data:c}=await i.cf.postOrFail("/ajax/moderator_actions.php",l);return c}static async moderatorAction(e){let{data:t}=await i.cf.postOrFail("/ajax/moderator_actions.php",e);return t}}var a=s(12953),l=s(88358),c=s(63907);class d{static async getGroups(){let{data:e}=await i.cf.postOrFail("/ajax/smm_actions.php",{action:"get_groups_list"});return e}static async markStoryShare(e,t){let s={action:"save_status",story_id:e,group_id:t,state:1,comment:""},{data:o}=await i.cf.postOrFail("/ajax/smm_actions.php",s);return o}}var u=s(36005);var p=s(36005);var h=s(31474),_=s(94620),m=s(63326),g=s(96637);const v=s(19755);class f extends c.u1{constructor(){super(),this._reasons={},this._lastBox=null,this._lastTargetKey=null}showDeleteStoryDialog(e,t,s){this._createBox(e,r.y.DELETE_POST,t,s)}showDeleteCommentDialog(e,t,s){this._createBox(e,r.y.DELETE_COMMENT,t,s)}showBanUserDialog(e,t,s,i){this._createBox(e,1===i?2:3,t,s)}moveStoryToCommonFeed(e){let t={action:"move_to_common_feed",story_id:e},s=new l.LD({content:v((0,_.Z)(a.core.i18n("moderator-tools.modal-box.move-to-common.title")))});s.addCloseButtonIntoFooter(a.core.i18n("moderator-tools.modal-box.move-to-common.button-cancel")),s.addButtonIntoFooter(a.core.i18n("moderator-tools.modal-box.move-to-common.button-confirm"),(async()=>{n.moderatorAction(t).then((()=>{this.trigger("complete")}),(e=>{a.core.ui.toasts.showError(e||a.core.i18n("moderator-tools.errors.request"))})),s.hide()}),h.j.DANGER),s.show()}_createBox(e,t,s,i=0,o=!1){this._lastTarget=v(e);const l=String(t)+"_"+String(s)+"_"+String(i);let c=f._lastBox;if(c&&c.isShown&&f._lastTargetKey===l)return this._lastTargetKey="",void c.hide();this._closeCurrentBox(),f._lastTargetKey=l,this._processed=!1;const d={current_ban:null,ban_count_info:null,ban_for_story:0,ban_for_comment:0,message:""};if(void 0!==this._reasons[t]&&t!==r.y.BAN_POST&&t!==r.y.BAN_COMMENT)return;const u=void 0===this._reasons[t]?"Y":"N",p=[r.y.BAN_POST,r.y.BAN_COMMENT].includes(t);n.getInfo(t,s,u,i).then((o=>{if(void 0!==o.reasons&&(this._reasons=o.reasons),void 0!==o.ban&&(d.current_ban=o.ban),void 0!==o.ban_count_info&&(d.ban_count_info=o.ban_count_info),void 0!==o.ban_for_story&&(d.ban_for_story=o.ban_for_story),void 0!==o.ban_for_comment&&(d.ban_for_comment=o.ban_for_comment),p&&null!==d.current_ban&&d.current_ban.status)return void this._showBanInfo(this._lastTarget,d.current_ban);if(p&&(d.ban_for_story||d.ban_for_comment)){if(1===d.ban_for_story)return void a.core.ui.toasts.showError(a.core.i18n("moderator-tools.errors.user-post-punished"));if(2===d.ban_for_story)return void(d.message+=a.core.i18n("moderator-tools.errors.user-post-forgiven"));if(1===d.ban_for_comment)return void a.core.ui.toasts.showError(a.core.i18n("moderator-tools.user-comment-punished"));2===d.ban_for_comment&&(d.message+=a.core.i18n("moderator-tools.errors.user-comment-forgiven"))}c=this._createBalloonBox(t,(e=>{this._doAction(t,s,i,e)}),d),f._lastBox=c,this.listenTo(f._lastBox,"hide",(()=>{f._lastBox=null,f._lastBox="",this._processed||this.trigger("cancel")})),c.isShown||(c.target=e,c.show())}),(e=>{a.core.ui.toasts.showError(e||a.core.i18n("moderator-tools.errors.request"))}))}setStoryAdultFlag(e,t,s){this._setStoryFlag("set_adult",e,t,s)}setStoryAuthorsFlag(e,t,s){this._setStoryFlag("set_authors",e,t,s)}setStoryVisibilityFlag(e,t,s){this._setStoryFlag("set_story_visibility",e,t,s)}restoreStory(e){let t={action:"restore_story",story_id:e};n.moderatorAction(t).then((()=>{this.emit("complete")}),(e=>{a.core.ui.toasts.showError(e||a.core.i18n("moderator-tools.errors.request"))}))}restoreComment(e){let t={action:"restore_comment",comment_id:e};n.moderatorAction(t).then((()=>{this.emit("complete")}),(e=>{a.core.ui.toasts.showError(e||a.core.i18n("moderator-tools.errors.request"))}))}getCommentRestoreHistory(e){let t={action:"get_comment_restore_history",comment_id:e};n.moderatorAction(t).then((e=>{this.emit("complete",e)}),(e=>{a.core.ui.toasts.showError(e||a.core.i18n("moderator-tools.errors.request"))}))}_setStoryFlag(e,t,s,i){this._lastTarget=v(t),this._processed=!1,f._lastTargetKey="",this._closeCurrentBox();let o={action:e,story_id:s,flag:i?"1":"0"};n.moderatorAction(o).then((()=>{this._closeCurrentBox(),this.emit("complete")}),(e=>{a.core.ui.toasts.showError(e||a.core.i18n("moderator-tools.errors.request"))}))}_doAction(e,t,s,i,o){let l,c=this._reasons[e],d="";switch(e){case r.y.DELETE_POST:d="remove_story";break;case r.y.DELETE_COMMENT:d="remove_comment";break;case r.y.BAN_POST:d="ban_for_story";break;case r.y.BAN_COMMENT:d="ban_for_comment";break;case r.y.DELETE_POST_404:d="remove_story_404";break;default:return}const u=e===r.y.BAN_POST||e===r.y.BAN_COMMENT;l={action:d,item_id:u?t:s,item_subid:u?s:t,reason_id:i,from_admoder:o?1:void 0},n.moderatorAction(l).then((t=>{this._processed=!0,this._closeCurrentBox(),this.emit("complete",c&&c[i]?c[i].name:""),2!==Number(e)&&3!==Number(e)||t.status&&this._showBanInfo(this._lastTarget,t)}),(e=>{a.core.ui.toasts.showError(e||a.core.i18n("moderator-tools.errors.request")),this._closeCurrentBox()}))}_closeCurrentBox(){let e=f._lastBox;e&&e.isShown&&(e.hide(),f._lastBox=null)}_showBanInfo(e,t){if(!e)return;let s,i={moderatorName:t.moderator_name,reason:t.reason,timeEnd:t.time_end};var o,r,n;this._closeCurrentBox(),s=v((o=i,r="",n=u.escape,Array.prototype.join,r+='<div class="mt__box">\n\t<div class="mt__text">Пользователь забанен модератором <b>'+n(o.moderatorName)+"</b></div>\n\t",o.reason&&o.timeEnd&&(r+='\n\t<div class="mt__footer">\n\t\t<div class="mt__text_sm">\n\t\t\t<b>Причина:</b> '+n(o.reason)+'\n\t\t</div>\n\t\t<div class="mt__text_sm">\n\t\t\t<b>Время:</b> до '+n(o.timeEnd)+"\n\t\t</div>\n\t</div>\n\t"),r+="\n</div>\n")),this._lastBox=new l._({target:e,content:s}),this._lastBox.show()}takeModCall(e,t){let s={call_id:e,action:"take_call",flag:t?0:1};n.moderatorAction(s).then((()=>{this.emit("complete")}),(e=>{this.emit("cancel"),a.core.ui.toasts.add("takeError",{theme:o.K.DANGER,content:e.message||a.core.i18n("moderator-tools.errors.request")})}))}approveModCall(e,t){let s={call_id:e,action:"check_call",flag:t?0:1};n.moderatorAction(s).then((()=>{this.emit("complete")}),(e=>{this.emit("cancel"),a.core.ui.toasts.add("approveError",{theme:o.K.DANGER,content:e.message||a.core.i18n("moderator-tools.errors.request")})}))}modCallCheckedList(e){let t={action:"is_checked_list",ids:e};n.moderatorAction(t).then((e=>{this.emit("complete",e)}),(e=>{this.emit("cancel"),a.core.ui.toasts.showError(e||a.core.i18n("moderator-tools.errors.request"))}))}markStoryShared(e){d.getGroups().then((t=>{const s=v((i={socials:t,title:a.core.i18n("moderator-tools.modal-box.mark-shared.title")},o="",r=p.escape,Array.prototype.join,o+='<div class="mt__popup-cnt mt__popup-cnt_center">\n    <h4>'+r(i.title)+'</h4>\n        <div class="select">\n            <select data-role="listbox">\n                ',i.socials.forEach((e=>{o+='\n                    <option value="'+r(e.id)+'">'+r(e.name)+"</option>\n                "})),o+='\n            </select>\n            <div class="select__icon fa fa-angle-down"></div>\n        </div>\n</div>\n'));var i,o,r;const n=s.find("select"),c=new l.LD({content:s});c.footer.addClass("popup__footer_center"),c.addCloseButtonIntoFooter(a.core.i18n("moderator-tools.modal-box.mark-shared.button-cancel")),c.addButtonIntoFooter(a.core.i18n("moderator-tools.modal-box.mark-shared.button-confirm"),(async()=>{const t=n.val();d.markStoryShare(e,t).then((()=>{this.emit("complete"),c.hide()}),(e=>{a.core.ui.toasts.showError(e||a.core.i18n("moderator-tools.errors.request"))}))}),h.j.SUCCESS),c.show()}),(e=>{a.core.ui.toasts.showError(e||a.core.i18n("moderator-tools.errors.request"))}))}_showTagsHistory(e,t){let s={action:"get_tags_history",story_id:e},i=t.find('[data-role="tags-history"]');n.moderatorAction(s).then((e=>{e.length&&(e.map((e=>{e.addedTags=[],e.removedTags=[],e.oldTags=[],e.tags_old=e.tags_old.split(", "),e.tags_new=e.tags_new.split(", "),e.tags_new.forEach((t=>{v.inArray(t,e.tags_old)>-1?e.oldTags.push(t):e.addedTags.push(t)})),e.tags_old.forEach((t=>{-1===v.inArray(t,e.tags_new)&&e.removedTags.push(t)}))})),i.append((0,m.Z)(e)))}),(e=>{a.core.ui.toasts.showError(e||a.core.i18n("moderator-tools.errors.request"))}))}_createBanInformation(e){const t=e.bans_count||0,s=e.deleted_comments_after_last_ban_end||0,i=e.deleted_stories_after_last_ban_end||0;if(!t&&!s&&!i)return"";let o="";return s&&(o+=`<b>${s}</b> ${g.Utils.pluralNounRU(s,["комментарий","комментария","комментариев"])}`),i&&(o+=(o.length?" и ":"")+`<b>${i}</b> ${g.Utils.pluralNounRU(i,["пост","поста","постов"])}`),`Пользователь был заблокирован <b>${t}</b> раз<br>`+(o?`После последней блокировки было удалено ${o}`:"")}}},49912:(e,t,s)=>{"use strict";s.d(t,{t:()=>i});const i=new(s(65448).xs)({INFO:1,DELETED_STORY:2,BAN:3,AWARD:4,NEWS:5})},80037:(e,t,s)=>{"use strict";s.d(t,{I:()=>o});var i=s(90312);function o(e){if(!e.is_new||"author_moderation"!==e.type)return;const t=(new DOMParser).parseFromString(e.text,"text/html").body.children[0],s=null==t?void 0:t.getAttribute("data-ignore-type");s&&i.c.getInstance().sendEvent("notification_showed",{type:"user_banned",content_type:s})}},16226:(e,t,s)=>{"use strict";s.d(t,{O5:()=>n,VC:()=>a,eT:()=>r,lr:()=>o});var i=s(65448);const o=new i.xs({VK:"vk",GOOGLE:"google",YA:"ya"}),r=new i.xs({WAIT:0,BAD:1,GOOD:2}),n=new i.xs({PASSWORD:"password",PHONE:"phone",EMAIL:"email",NICKNAME:"nickname"}),a=new i.xs({BELL:"bell",PUSH:"push"})},88611:(e,t,s)=>{"use strict";s.d(t,{G:()=>o});var i=s(65448);let o={PORTRAIT_PRIMARY:"portrait-primary",PORTRAIT_SECONDARY:"portrait-secondary",LANDSCAPE_PRIMARY:"landscape-primary",LANDSCAPE_SECONDARY:"landscape-secondary"};o=new i.xs(o)},71648:(e,t,s)=>{"use strict";s.d(t,{E:()=>l});var i=s(88611);let o;const r=window.screen,n="function"==typeof window.ScreenOrientation&&r&&r.orientation instanceof window.ScreenOrientation&&"string"==typeof r.orientation.type,a=["orientationchange","mozorientationchange","msorientationchange"];class l{static get type(){if(n)return i.G[r.orientation.type];if(r&&(r.msOrientation||r.mozOrientation))return i.G[(r.msOrientation||r.mozOrientation).type];if(window.orientation)switch(window.orientation){case 180:return i.G.PORTRAIT_SECONDARY;case 90:return i.G.LANDSCAPE_PRIMARY;case-90:return i.G.LANDSCAPE_SECONDARY;default:return i.G.PORTRAIT_PRIMARY}return l.getMql().matches?i.G.LANDSCAPE_PRIMARY:i.G.PORTRAIT_PRIMARY}static get isLandscape(){let e=l.type;return e===i.G.LANDSCAPE_PRIMARY||e===i.G.LANDSCAPE_SECONDARY}static get isPortait(){let e=l.type;return e===i.G.PORTRAIT_PRIMARY||e===i.G.PORTRAIT_SECONDARY}static get angle(){return n?r.orientation.angle:0}static get supportedOrientationEvent(){return void 0!==l.findDelegation().delegate}static findDelegation(){if(o)return o;for(let e=0;e<a.length;e++)if(null===r["on"+a[e]])return o={delegate:r,event:a[e]};return o=null===window.onorientationchange?{delegate:window,event:"orientationchange"}:{}}static getMql(){return"function"!=typeof window.matchMedia?{}:window.matchMedia("(orientation: landscape)")}}},23031:()=>{"use strict";"undefined"==typeof Proxy&&(window.Proxy=function(e){let t,s=null;return t=function(e,t){if(!isObject(e)||!isObject(t))throw new TypeError("Cannot create proxy with a non-object as target or handler");let i=function(){};s=function(){i=function(e){throw new TypeError(`Cannot perform '${e}' on a proxy that has been revoked`)}};let o=t;t={get:null,set:null,apply:null,construct:null,deleteProperty:null,defineProperty:null};for(let s in o){if(!(s in t))throw new TypeError(`Proxy polyfill does not support trap '${s}'`);t[s]=o[s]}"function"==typeof o&&(t.apply=o.apply.bind(o));let r=this,n=!1,a="function"==typeof e;(t.apply||t.construct||a)&&(r=function(){let s=this&&this.constructor===r;if(i(s?"construct":"apply"),s&&t.construct)return t.construct.call(this,e,arguments);if(!s&&t.apply)return t.apply(e,this,arguments);if(a){if(s){let t,s=Array.prototype.slice.call(arguments);return s.unshift(e),t=e.bind.apply(e,s),new t}return e.apply(this,arguments)}throw new TypeError(s?"not a constructor":"not a function")},n=!0);let l=t.get?function(e){return i("get"),t.get(this,e,r)}:function(e){return i("get"),this[e]},c=t.set?function(e,s){i("set"),t.set(this,e,s,r)}:function(e,t){i("set"),this[e]=t},d=Object.getOwnPropertyNames(e),u={};d.forEach((function(t){if(n&&t in r)return;let s={enumerable:!!Object.getOwnPropertyDescriptor(e,t).enumerable,get:l.bind(e,t),set:c.bind(e,t)};Object.defineProperty(r,t,s),u[t]=!0}));let p=!0;if(Object.setPrototypeOf?Object.setPrototypeOf(r,Object.getPrototypeOf(e)):r.__proto__?r.__proto__=e.__proto__:p=!1,t.get||!p)for(let s in e)u[s]||Object.defineProperty(r,s,{get:l.bind(e,s)});return Object.seal(r),r},t.revocable=function(e,i){return{proxy:new t(e,i),revoke:s}},t}())},24819:()=>{window.requestIdleCallback=window.requestIdleCallback||function(e){return setTimeout((function(){const t=Date.now();e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})}),1)},window.cancelIdleCallback=window.cancelIdleCallback||function(e){clearTimeout(e)}},9975:(e,t,s)=>{"use strict";s.d(t,{I:()=>n});s(74916);const i="undefined"==typeof window?{}:window.document,o="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element;let r=function(){let e={},t=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]];for(let s,o=0,r=t.length;o<r;o++)if(s=t[o],s&&s[1]in i){for(o=0;o<s.length;o++)e[t[0][o]]=s[o];return e}return!1}();class n{static get isSupported(){return!1!==r}static request(e){let t=r.requestFullscreen;return e=e||i.documentElement,/5\.1[.\d]* Safari/.test(navigator.userAgent)?e[t]():!0===o?e[t](Element.ALLOW_KEYBOARD_INPUT):e[t]()}static exit(){i[r.exitFullscreen]()}static toggle(e){n.isFullScreen?this.exit():this.request(e)}static get onChangeEventName(){return r.fullscreenchange}static get onErrorEventName(){return r.fullscreenerror}static get isFullScreen(){return Boolean(i[r.fullscreenElement])}static get element(){return i[r.fullscreenElement]}static get enabled(){return Boolean(i[r.fullscreenEnabled])}}},35924:(e,t,s)=>{"use strict";s.d(t,{_:()=>c});s(66992),s(33948),s(74916),s(15306);var i=s(36005);const o=/[!'\(\)~]|%20|%00/g,r=/\+/g,n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"},a=e=>n[e],l={"%E0":"%D0%B0","%E1":"%D0%B1","%E2":"%D0%B2","%E3":"%D0%B3","%E4":"%D0%B4","%E5":"%D0%B5","%B8":"%D1%91","%E6":"%D0%B6","%E7":"%D0%B7","%E8":"%D0%B8","%E9":"%D0%B9","%EA":"%D0%BA","%EB":"%D0%BB","%EC":"%D0%BC","%ED":"%D0%BD","%EE":"%D0%BE","%EF":"%D0%BF","%F0":"%D1%80","%F1":"%D1%81","%F2":"%D1%82","%F3":"%D1%83","%F4":"%D1%84","%F5":"%D1%85","%F6":"%D1%86","%F7":"%D1%87","%F8":"%D1%88","%F9":"%D1%89","%FC":"%D1%8C","%FB":"%D1%8B","%FA":"%D1%8A","%FD":"%D1%8D","%FE":"%D1%8E","%FF":"%D1%8F","%C0":"%D0%90","%C1":"%D0%91","%C2":"%D0%92","%C3":"%D0%93","%C4":"%D0%94","%C5":"%D0%95","%A8":"%D0%81","%C6":"%D0%96","%C7":"%D0%97","%C8":"%D0%98","%C9":"%D0%99","%CA":"%D0%9A","%CB":"%D0%9B","%CC":"%D0%9C","%CD":"%D0%9D","%CE":"%D0%9E","%CF":"%D0%9F","%D0":"%D0%A0","%D1":"%D0%A1","%D2":"%D0%A2","%D3":"%D0%A3","%D4":"%D0%A4","%D5":"%D0%A5","%D6":"%D0%A6","%D7":"%D0%A7","%D8":"%D0%A8","%D9":"%D0%A9","%DC":"%D0%AC","%DB":"%D0%AB","%DA":"%D0%AA","%DD":"%D0%AD","%DE":"%D0%AE","%DF":"%D0%AF"};class c{constructor(e){this._params=new Map,(0,i.isString)(e)&&this.fromParamsString(e)}fromParamsString(e){"?"===e.charAt(0)&&(e=e.slice(1));for(let t,s,i=e.split("&"),o=0,r=i.length;o<r;o++)s=i[o],t=s.indexOf("="),t>-1?this.append(c.decode(s.slice(0,t)),c.decode(s.slice(t+1))):s.length&&this.append(c.decode(s),"");return this}static cp1251ToUTF8(e){let t,s="",i=e.length,o=0;for(;o<i;){t=0;for(let i in l)e.substring(o,o+3)===i&&(s+=l[i],o+=3,t=1);t||(s+=e.substring(o,o+1),o++)}return s}static decode(e){try{return decodeURIComponent(e.replace(r," "))}catch(t){}try{return e=c.cp1251ToUTF8(e),decodeURIComponent(e.replace(r," "))}catch(t){return e}}static encode(e){return encodeURIComponent(e).replace(o,a)}append(e,t){this.has(e)?this._params.get(e).push(String(t)):this.set(e,[String(t)])}has(e){return this._params.has(e)}set(e,t){this._params.set(e,[String(t)])}get(e){return this.has(e)?this._params.get(e)[0]:null}getAll(e){return this.has(e)?this._params.get(e):[]}entries(){return this._params.entries()}delete(e){this._params.delete(e)}clear(){return this._params.clear(),this}toString(){let e=[];for(let[t,s]of this.entries()){let i=c.encode(t);for(let t=0;t<s.length;t++)e.push(i+"="+c.encode(s[t]))}return e.join("&")}}},2355:(e,t,s)=>{"use strict";s.d(t,{E:()=>r});const i="undefined"==typeof window?{}:window.document;let o=function(){let e={},t=[["visibilityState","visibilitychange","hidden"],["webkitVisibilityState","webkitvisibilitychange","webkitHidden"],["msVisibilityState","msvisibilitychange","msHidden"]];for(let s,o=0,r=t.length;o<r;o++)if(s=t[o],s&&s[0]in i){for(o=0;o<s.length;o++)e[t[0][o]]=s[o];return e}return!1}();class r{static get isSupported(){return!1!==o}static get hidden(){return!!r.isSupported&&i[o.hidden]}static get isShown(){return!r.isSupported||!i[o.hidden]}static get visibilityState(){return r.isSupported?i[o.visibilityState]:"visible"}static get onChangeEventName(){return o&&o.visibilitychange}}},99867:(e,t,s)=>{"use strict";s.d(t,{sA:()=>P,J1:()=>x});s(88674),s(41817);var i=s(12953),o=s(43241),r=s(81780),n=s(88358),a=s(40138),l=s(96637),c=s(47442),d=s(90312),u=s(53056),p=s(63748);function h(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function _(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?h(Object(s),!0).forEach((function(t){m(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):h(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function m(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const g="pkb_prf_ntf";class v{static getInstance(){return v.instance||(v.instance=new v)}getConfig(){const e=u.m.get(g),t=e||{hintShownCount:0,wasAlreadyShown:!1};return(0,p.K)(e)||u.m.set(g,t),t}setValue(e,t){u.m.set(g,_(_({},this.getConfig()),{},{[e]:t}))}get hintShownCount(){return this.getConfig().hintShownCount}set hintShownCount(e){this.setValue("hintShownCount",e)}get wasAlreadyShown(){return this.getConfig().wasAlreadyShown}set wasAlreadyShown(e){this.setValue("wasAlreadyShown",e)}}var f=s(31200),y=s(5568),b=s(15112);function w(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const k="data-notification-subs";class S extends o.u{constructor(e){super(e),w(this,"_loading",!1),w(this,"userId",""),w(this,"hintAlignment",n.SE.CENTER),w(this,"handleBellClick",(async()=>{var e,t,s;null===(e=this._balloon)||void 0===e||e.hide(),!i.default.initParams.isDeleted&&i.default.isUserAuthorized?this.loading||(this.loading=!0,this.emit("subscribing"),null!==(t=this.store)&&void 0!==t&&t.subscribe.user[String(this.userId)]?await this.toggleNotificationSubscription():await this.subscribeOnUserAndNotification(),this.loading=!1,null===(s=this._hint)||void 0===s||s.hide(),this.emit("subscribingEnds")):i.default.ui.authRequired()})),this.render()}render(){if(this.isRendered||!this.el)return this;this.el.addEventListener("click",(()=>{this.handleBellClick()})),this.userId=String(this._options.user.id);const e=(0,y.pv)(this.userId);void 0===e.isSubscribedOnUserNotification?(0,y.g7)(this.userId,{isSubscribedOnUserNotification:"1"===this.el.getAttribute(k)}):this.el.setAttribute(k,e.isSubscribedOnUserNotification?"1":"0"),this.initHint(),this.showBalloonOnRender();const t=(0,y.mv)(this.userId,(e=>{this.isSubscribedOnNotification=Boolean(e.isSubscribedOnUserNotification)}));return this.listenToOnce(this,r.e.UNMOUNTED,(()=>{t()})),super.render(),this}async showBalloon(){var e;null===(e=await this.getBalloon())||void 0===e||e.show(),this._hint&&(this._hint.disabled=!0)}async showBalloonOnRender(){this._options.showBalloonOnRender&&(v.getInstance().wasAlreadyShown||this.isSubscribedOnNotification||(await this.showBalloon(),v.getInstance().wasAlreadyShown=!0))}showBalloonCertainTimes(){const e=v.getInstance().hintShownCount;e<2&&(this.showBalloon(),v.getInstance().hintShownCount=e+1)}async subscribeOnUserAndNotification(){try{var e;await(null===(e=this.store)||void 0===e?void 0:e.toggleSubscribe("user",String(this.userId),{},!0)),await this._options.user.notificationSubscribe(!0),i.default.ui.toasts.add({content:i.default.i18n("profile.success-msg"),closeAfter:4e3}),(0,y.g7)(this.userId,{isSubscribedOnUserNotification:!0}),await l.Utils.delay(50),d.c.getInstance().sendEvent("subscribe_to_notification",{"author_id!empty":this.userId,"type!empty":this._options.profileType})}catch(t){this.handleSubscriptionError(t)}}async toggleNotificationSubscription(){try{const e=!(0,y.pv)(this.userId).isSubscribedOnUserNotification;await this._options.user.notificationSubscribe(e),e&&i.default.ui.toasts.add({content:i.default.i18n("profile.success-msg"),closeAfter:4e3}),d.c.getInstance().sendEvent(e?"subscribe_to_notification":"unsubscribe_from_notification",{"author_id!empty":this.userId,"type!empty":this._options.profileType}),(0,y.g7)(this.userId,{isSubscribedOnUserNotification:e})}catch(e){this.handleSubscriptionError(e)}}handleSubscriptionError(e){i.default.ui.toasts.add({theme:c.K.RED,content:(null==e?void 0:e.message)||e})}initHint(){!this._hint&&this._options.showHint&&(this._hint=new n.gR({target:this.el,content:this.getBalloonContent(!1),destroyAfterHide:!1,direction:n.Lh.TOP,alignment:this.hintAlignment,autoCloseOutsideClick:!1}),this.isSubscribedOnNotification&&(this._hint.disabled=!0))}getBalloonContent(e=!0){return`\n\t\t\t<div class="popup__hint popup__hint_profile-notification">\n\t\t\t\t${e?`<button data-role="close" class="button_link popup__icon-close">\n\t\t\t\t\t\t${(0,a.q)("ui__close","popup")}\n\t\t\t\t</button>`:""}\n\t\t\t\t<p>${i.default.i18n("profile.hint")}</p>\n\t\t\t</div>\n\t\t`}async getBalloon(){return this._balloon||(this._balloon=await(0,f.aM)({target:this.el,id:"author-notification-subscribe",text:i.default.i18n("profile.hint"),direction:n.Lh.TOP,alignment:this.hintAlignment,autoCloseOutsideClick:!0,wrapperExtraClass:"popup_feature-notification",leftPosition:"",shownCheckStrategy:{getIsShown:()=>!1,setIsShown:()=>{}},btnConfig:{label:"Понятно",handler:()=>{this._balloon.hide()}},overlapSidebars:!0}),this.listenToOnce(this._balloon,r.e.DESTROYED,(()=>{this._hint&&(this._hint.disabled=!1)}))),this._balloon}get isSubscribedOnNotification(){return Boolean((0,y.pv)(this.userId).isSubscribedOnUserNotification)}set isSubscribedOnNotification(e){this.el&&this.el.setAttribute(k,e?"1":"0"),this._hint&&(this._hint.disabled=Boolean(e))}get loading(){return this._loading}set loading(e){this._loading!==e&&(this._loading=e)}get store(){if(this._store)return this._store;try{return this._store=(0,b.S)(),this._store}catch(e){return}}}function O(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function E(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?O(Object(s),!0).forEach((function(t){C(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):O(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function C(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class x extends o.u{constructor(e){super(e),C(this,"userId",""),C(this,"subsribeEndedHandler",(({isSubscribed:e})=>{const t=E({},(0,y.pv)(this.userId));e?this.notificationBell.showBalloonCertainTimes():t.isSubscribedOnUserNotification=!1,(0,y.g7)(this.userId,t)})),this.initSubscriptionNotificationBell()}initSubscriptionNotificationBell(){const{notificationBellOptions:e}=this._options;e.el&&(this.userId=String(this._options.notificationBellOptions.user.id),i.core.ui.attachSubscribeButtons(e.el.parentElement),this.notificationBell=new S(E({},e)),i.core.listenTo(i.core,"subscribeEnded",this.subsribeEndedHandler),this.listenToOnce(this.emitter,r.e.DESTROYED,(()=>{i.core.stopListening(i.core,"subscribeEnded",this.subsribeEndedHandler)})))}destroy(){var e;super.destroy(),null===(e=this.notificationBell)||void 0===e||e.destroy()}}var T=s(29883),I=s(82800);class P extends o.u{constructor(e){super(e),this.el&&(this.createSeriesBtn=this.el.querySelector(".profile-series__add-btn"),this.settingsIcon=this.el.querySelector(".profile-series__settings"),this.show())}show(){return this.initCarousel(),this.initListeners(),this.showStorySeriesSettingsNotification(),super.show(),this}initListeners(){var e,t;null===(e=this.createSeriesBtn)||void 0===e||e.addEventListener("click",(()=>{this.storySeriesEdtior.showEditor()})),null===(t=this.settingsIcon)||void 0===t||t.addEventListener("click",(()=>{this.showSettings(),d.c.getInstance().sendEvent("post_series_edit_button_tapped",{size:this.carousel.getItemsSize()})}))}initCarousel(){var e;null!==(e=this.el)&&void 0!==e&&e.classList.contains("carousel")&&(this.carousel=new T.qv({el:this.el}),this.listenTo(this.carousel,"add",(()=>{this.storySeriesEdtior.showEditor()})),this.listenTo(this.carousel,"edit",(e=>{d.c.getInstance().sendEvent("click",{type:"post_series_edit",post_series_id:e.id}),this.storySeriesEdtior.showEditor(e)})))}async showSettings(){if(!this.storySeriesSettings){var e;const{createApp:t}=await s(54835);this.storySeriesSettings=t({seriesCount:this.carousel.getItemsSize(),sort:Number(null===(e=this.settingsIcon)||void 0===e?void 0:e.dataset.order)||void 0,handleSeriesEdit:e=>this.storySeriesEdtior.showEditor(e)}).mount(document.createDocumentFragment())}this.storySeriesSettings.show()}async showStorySeriesSettingsNotification(){if(!this.settingsIcon)return;const e=await(0,f.kd)({id:"series-settings",autoCloseIfTargetNotVisible:!0,autoCloseOutsideClick:!1,target:this.settingsIcon,theme:I.xb.GREEN,direction:I.Lh.TOP,text:"Сейчас серии на вашей странице сортируются автоматически.\n\t\t\tНажмите сюда, чтобы настроить порядок серий вручную"});null==e||e.on(r.e.MOUNTED,(()=>{d.c.getInstance().sendEvent("tip_show",{type:"post_series_edit"})}))}get storySeriesEdtior(){return this._storySeriesEdtior||(this._storySeriesEdtior=new T.jD,this.listenTo(this._storySeriesEdtior,"edit",(()=>window.location.reload()))),this._storySeriesEdtior}}},5568:(e,t,s)=>{"use strict";s.d(t,{g7:()=>r,mv:()=>n,pv:()=>o});const i=new(s(48270).L)({}),o=e=>{const t=i.data[e];return t||(i.update({[e]:{}}),i.data[e])},r=(e,t)=>{i.update({[e]:t})},n=(e,t)=>{const s=(s,i,o)=>{null===e?t(o,i):i===e&&t(o)};return i.listenTo(i,"dataChangeProperty",s),()=>{i.stopListening(i,"dataChangeProperty",s)}}},27746:(e,t,s)=>{"use strict";s.d(t,{a:()=>l});s(88674),s(41817);var i=s(70017),o=s(12950),r=s(53056);function n(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const a="pkb_rud";class l{constructor(){n(this,"timerId",0),n(this,"storageValue",""),n(this,"handleLocalStorageChange",(e=>{if(e.key===a&&e.newValue){if(e.newValue===`"${this.storageValue}"`)return;console.log("[QA]: restart RUD"),this.runReUpdateCookieTimer()}})),l.checkCookie()?this.runReUpdateCookieTimer():this.runUpdateCookieTimer(1e4),window.addEventListener("storage",this.handleLocalStorageChange)}static checkCookie(){return void 0!==i.e.get("abccv")}runReUpdateCookieTimer(){this.runUpdateCookieTimer(6e5+2*Math.random()*60*1e3)}runUpdateCookieTimer(e){window.clearTimeout(this.timerId),this.timerId=window.setTimeout((()=>{this.updateCookie()}),e)}async updateCookie(){window.clearTimeout(this.timerId),this.storageValue=String(Date.now()),r.m.set(a,this.storageValue),await o.cf.get("/ajax.php?route=register_long_view"),this.runReUpdateCookieTimer()}}},93971:(e,t,s)=>{"use strict";s.d(t,{G:()=>o});s(88674);var i=s(12950);async function o(e){return await i.cf.postOrFail("/ajax/gtstory-actions/get_recommended_tags-and-communities",e)}},73429:(e,t,s)=>{"use strict";s.d(t,{Y:()=>l,b:()=>p});s(88674),s(41817);var i=s(12950);s(12953);const o="/ajax/reputation.php";function r(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?r(Object(s),!0).forEach((function(t){a(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):r(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function a(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class l{static async getMentions(e="",t,s=0,r){0!==s&&r||(r=Date.now());const{data:a}=await i.cf.postOrFail(o,{action:"get_mentions",time:r,offset:s,label_id:t,object_type:e});return n(n({},a),{timestamp:r})}static getMentionsCSV(e="",t,s){let i=`/reputation/export-mentions?time=${s}`;e&&(i+=`&object_type=${e}`),t&&(i+=`&label_id=${t}`),window.open(i,"_blank")}static async getSidebarCounters(){const{data:e}=await i.cf.postOrFail(o,{action:"get_sidebar_counters"});return e}static async markAsRead(e=[]){const{response:t}=await i.cf.postOrFail(o,{action:"mark_as_read",mentions:e});return t.result}static async markAllAsRead(e=""){const{response:t}=await i.cf.postOrFail(o,{action:"mark_all_as_read",object_type:e});return t.result}static async saveFeedback(e){const{response:t}=await i.cf.postOrFail(o,n({action:"save_feedback"},e));return t.result}}var c=s(42930);function d(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function u(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class p{static get(){return h("get_labels",{},!0)}static add(e){return h("add_label",{name:e},!0).then((e=>e.label_id))}static rename(e,t){return h("rename_label",{id:e,name:t})}static delete(e){return h("delete_label",{id:e})}static stick(e,t){return h("stick_label",{object_id:e.id,object_type:e.type,id:t})}static unstick(e){return h("unstick_label",{object_id:e.id,object_type:e.type,id:e.labelId})}static clear(){return h("clear_labels")}static popup(e){return new c.D({target:e}).show().result()}}async function h(e,t={},s=!1){const{response:r,data:n}=await i.cf.postOrFail(o,function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?d(Object(s),!0).forEach((function(t){u(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({action:e},t));return s?n:r.result}},99252:(e,t,s)=>{"use strict";s.d(t,{AU:()=>l,Fw:()=>o,Wi:()=>i,fz:()=>r,ho:()=>a,r2:()=>n});s(41817);const i=200,o=413,r="abort",n=Symbol(),a=162,l=163},12950:(e,t,s)=>{"use strict";s.d(t,{ff:()=>y,r2:()=>n.r2,Wi:()=>n.Wi,cf:()=>g});s(66992),s(33948),s(88674),s(41817);var i=s(16253),o=s(12953),r=s(35924),n=s(99252),a=s(84947),l=s(36005),c=s(98859),d=s(14025);s(29917);const u=s(19755);let p=FileAPI.getXHR;FileAPI.getXHR=()=>{let e=p(),t=e.open;return e.open=(s,i,...o)=>{e.__requestURL=i,t.call(e,s,i,...o)},e};let h,_={status:n.Wi,message:"ok",messageCode:0,result:!1};function m(e,t){null==t||t.addEventListener("abort",(()=>{e.abort()}),{once:!0})}u.ajaxPrefilter(((e,t,s)=>{t.signal&&(m(s,null==t?void 0:t.signal),delete t.signal)}));class g{static mock(...e){h=h||new i.vp,h.on(...e)}static unmock(e){if(!h||!e.length)return!1;h.off(...e)}static response(e,t,s){return{response:{status:e,result:s=(0,l.isBoolean)(s)?s:!(0,l.isUndefined)(t)},data:t}}static async fetchMock(e){if(!h)return!1;let t,s=h.listeners(e.url);if(!(0,l.isArray)(s))return!1;for(let i of s)if(t=await i.callback(e),(0,l.isObject)(t))return o.core.logger.log("request","mock",e.url),{response:(0,l.defaults)(t.response||{},{isMock:!0},_),data:t.data||{}};return!1}static fetchAJAX(e){let t,s=(0,l.defaults)({},_);return new Promise((i=>{u.ajax(e.url,e).then(((e,r,n)=>{if(s.status=n.status,s.message=r,(0,l.isObject)(e)){if("string"==typeof e.cookie_names&&c.O){const t=e.cookie_names.split(",").filter((e=>void 0===o.eR.get(e)));t.length>0&&o.core.logger.error("api",new Error(`not found cookie: ${t.join(", ")}`))}e.messageCode=e.message_code,delete e.message_code,t=e.data,delete e.data,(0,l.extend)(s,e)}else s.message=o.core.i18n("request.500"),s.messageCode=0,s.result=!1,t=e;i({response:s,data:t})}),(r=>{switch(s.status=r.status,s.requestURL=e.url,!0){case 4===r.readyState&&200===r.status:s.message=o.core.i18n("request.400");break;case 0===r.readyState&&r.statusText!==n.fz:s.message=o.core.i18n("request.network-error");break;case r.responseJSON&&Boolean(r.responseJSON.message):s.message=r.responseJSON.message;break;case r.statusText===n.fz:s.message=n.fz,s.messageCode=n.r2;break;default:s.message=o.core.i18n("request.400")}i({response:s,data:t})}))}))}static fetchFileAPI(e){let t,s=(0,l.defaults)({},_);return new Promise((i=>{(0,l.isObject)(e.xhrFields)&&e.xhrFields.withCredentials&&(FileAPI.withCredentials=!0);m(FileAPI.upload((0,l.extend)({},e||{},{headers:{"X-Csrf-Token":o.core.initParams.csrfToken},filecomplete:(e,r)=>{let a;if(s.status=r.status,null!=r&&r.xhr&&(s.requestURL=r.xhr.__requestURL),r.status===n.Fw)s.message=o.core.i18n("request.413");else s.message=r.statusText;if(r.statusText===n.fz&&(s.messageCode=n.r2),e)return i({response:s,data:t}),!1;try{a=JSON.parse(r.response)}catch(c){o.core.logger.error("request",c)}return a&&((0,l.isObject)(a)?(a.messageCode=a.message_code,delete a.message_code,t=a.data,delete a.data,(0,l.extend)(s,a)):(s.message=o.core.i18n("request.500"),s.messageCode=0,s.result=!1)),i({response:s,data:t}),!0}})),e.signal)}))}static async fetch(e){let t=await g.fetchMock(e);if(t)return t;if(e&&e.useFileAPI)return await g.fetchFileAPI(e);const s=await g.fetchAJAX(e);return s.response.result||"text/csv"===e.dataType||o.core.logger.error("api",new a.H(s.response.requestURL||s.response.message,s.response.status)),d.DT.checkNewAchievementsFromCookie(),s}static convertURLSearchParams(e){let t={};for(let[s,i]of e.entries()){t[r._.encode(s)]=i.length<2?i[0]:i}return t}static _prepareOptions(e,t,s,i){return(s=s||{})instanceof r._&&(s=g.convertURLSearchParams(s)),i=(0,l.defaults)(i||{},{url:t,type:e,data:s,dataType:"JSON"}),(s instanceof FormData||"FormData"===s[Symbol.toStringTag])&&(i.processData=!1,i.contentType=!1),i.withCredentials&&(i.xhrFields=(0,l.extend)(i.xhrFields||{},{withCredentials:!0})),i}static get(e,t,s){return s=s||{},g._prepareOptions("get",e,t,s),g.fetch(s)}static async getOrFail(e,t,s){const{response:i,data:o}=await g.get(e,t,s);if(!i.result)throw new Error(i.message);return{response:i,data:o}}static post(e,t={},s){return s=s||{},g._prepareOptions("post",e,t,s),g.fetch(s)}static async postOrFail(e,t,s){const{response:i,data:o}=await g.post(e,t,s);if(!i.result)throw new Error(i.message);return{response:i,data:o}}static upload(e,t={},s,i){if(i=i||{},!s)throw new Error("not specified files to upload");if(0!==e.indexOf("http")&&o.core.initParams.uploadServerUrl.length&&(e=o.core.initParams.uploadServerUrl+e),(0,l.isUndefined)(i.withCredentials)&&(i.withCredentials=!0),i.useFileAPI=!!(0,l.isUndefined)(i.useFileAPI)||i.useFileAPI,i.useFileAPI){let e=(t=(0,l.defaults)(t||{},{uid:0})).uid;i.files={[e]:s}}else{i.cache=!1;let e=t;e instanceof FormData||(e=new FormData,(0,l.forEach)(t,((t,s)=>e.append(s,t))));let o=e.get("uid");((0,l.isNull)(o)||(0,l.isUndefined)(o))&&(e.set("uid",0),o=0),s instanceof Blob?e.set(o,s,"imgae.png"):e.set(o,s),t=e}return g._prepareOptions("post",e,t,i),g.fetch(i)}static async uploadOrFail(e,t={},s,i){const{response:o,data:r}=await g.upload(e,t,s,i);if(!o.result)throw new Error(o.message);return{response:o,data:r}}}const v="/ajax/upload_file.php",f=!1;class y{static async post(...e){return y._request(g.post,...e)}static async upload(...e){return y._request(g.upload,...e)}static async _request(e,...t){if(!1===f)return await e(v,...t);let s=(0,l.uniqueId)();o.core.performance.mark(s);let i=await e(v,...t),{status:r,requestURL:n}=i.response;if(200!==r){let e=o.core.performance.getEntryElapsed(s,void 0,0);await y.logUploadError({duration:e,requestURL:n,status:r})}return i}static async logUploadError(e){let{requestURL:t,duration:s,status:i}=e;g.post(f,{request_url:t,duration:s,status:i})}}},97099:(e,t,s)=>{"use strict";s.d(t,{T3:()=>u,F0:()=>h,GR:()=>p});s(88674);var i=s(36005);s(74916);var o=s(96637);const r=s(51068);class n{constructor(e,t){this._paramNames=[],this._stack=Array.isArray(t)?t:[t],this._path=e,"/"===this._path.charAt(0)&&(this._regexp=r.pathToRegexp(e,this._paramNames))}match(e){return this._regexp?this._regexp.test(e.path):e.pageName===this._path}params(e,t,s){let i=s||{};for(let r=t.length,n=0;n<r;n++)if(this._paramNames[n]){let e=t[n];i[this._paramNames[n].name]=e?o.Utils.safeDecodeURIComponent(e):e}return i}captures(e){return this._regexp?e.match(this._regexp).slice(1):[]}get stack(){return this._stack}}s(66992),s(33948),s(41817),s(85827);var a=s(16253),l=s(63907),c=s(1262),d=s(34524);class u extends l.u1{constructor(e,t){super(),this.parent=e,this.ctx=void 0}route(e,t){return this.ctx=e,this.show(),t()}show(){return this.isShown||(this.parent&&this.parent!==this&&this.parent instanceof u&&this.parent.onMatch(this.ctx,this),this._setBrowserSessionTS(),super.show(),this.$el&&this.$el.show(),this._options.isShown=!0,c.User.sendUserParams()),this}hide(){return this.isShown?(super.hide(),this._options.isShown=!1,this.$el&&this.$el.hide(),this):this}render(){if(this.isRendered)return this;super.render()}_setBrowserSessionTS(){d.x.get(d.q)||d.x.set(d.q,Date.now())}}class p extends u{constructor(e){super(e),this._currentPage=!1,this._router=new h(this),this.listenTo(this._router,"mismatch",this.onMismatch)}use(e,t){return this._router.use(e,t)}routers(){return this._router.routers()}showPage(e){this._currentPage!==e&&this.hidePage(this._currentPage),this._currentPage=e}hidePage(e){return e&&this._currentPage!==e?(e.hide(),this):this._currentPage?(this._currentPage.hide(),this._currentPage=!1,this):this}onMatch(e,t){this.ctx=e,this.isShown||this.show(),this!==t&&this.showPage(t)}onMismatch(){if(!this.isShown)return this;this.hidePage(),this.hide()}append(e){return!!this.$el&&(this.$el.append(e),this)}get router(){return this._router}}class h extends a.vp{constructor(e){super(),this.stack=[],this._pageMaster=e,this._symbols=new Map,this._symbolsInstance=new Map}use(e,t){if(t&&"string"==typeof e&&(e={[e]:t}),e instanceof h||e instanceof p||"function"==typeof e)return this.stack.push(e),this;for(let[s,i]of Object.entries(e)){i=Array.isArray(i)?i:[i];for(let[t,s]of i.entries()){if("object"!=typeof s&&"function"!=typeof s)throw new Error("router expects an object or function as a handler. look at boot.js");s.prototype instanceof u&&!(s.prototype instanceof p)&&(i[t]=this.getSymbol(s))}let e=new n(s,i);this.stack.push(e)}return this}getSymbol(e){return this._symbols.has(e)||this._symbols.set(e,Symbol()),this._symbols.get(e)}getInstance(e){if(this._symbolsInstance.has(e))return this._symbolsInstance.get(e);for(let[t,s]of this._symbols.entries())s===e&&this._symbolsInstance.set(e,new t(this._pageMaster,e));return this._symbolsInstance.get(e)}matchOnly(e){let t=(0,i.some)(this.stack,(t=>t instanceof h?t.matchOnly(e):t instanceof p?t.router.matchOnly(e):!!t.match(e)));return t||this.emit("mismatch"),t}match(e){let t=this.stack,s={route:!1};for(let i=t.length,o=0;o<i;o++){let i=t[o];i instanceof h?i.matchOnly(e)&&((s.stack=s.stack||[]).push(i),s.route=!0):i instanceof p?i.router.matchOnly(e)&&((s.stack=s.stack||[]).push(i),s.route=!0):i instanceof n?i.match(e)&&((s.stack=s.stack||[]).push(i),s.route=!0):(s.stack=s.stack||[]).push(i)}return s.route||this.emit("mismatch"),s}routers(){let e=this;return function(t,s){let r,a=t.path,l=e.match(t);return t.matched?t.matched.push.apply(t.matched,l.stack):t.matched=l.stack,l.route&&l.stack.length?(r=l.stack.reduce((function(s,i){return i instanceof h?(s.push(i.routers()),s):i instanceof p?(e.emit("match",t,i),s.push(i.router.routers()),s):i instanceof n?(s.push((function(e,t){return e.captures=i.captures(a),e.params=i.params(a,e.captures,e.params),t()})),i.stack.forEach((i=>{if(o.Utils.isSymbol(i)){let o=e.getInstance(i);e.emit("match",t.path,o),s.push(o)}else s.push(i)})),s):(s.push(i),s)}),[]),function(e){if(!Array.isArray(e))throw new TypeError("Middleware stack must be an array!");return function(t,s){let o=-1;return function r(n){if(n<=o)return Promise.reject(new Error("next() called multiple times"));o=n;let a=e[n]||s;if(!a)return Promise.resolve();try{return(0,i.isObject)(a)&&(0,i.isFunction)(a.route)&&(a=a.route.bind(a)),Promise.resolve(a(t,(function(){return r(n+1)})))}catch(l){return Promise.reject(l)}}(0)}}(r)(t,s)):(0,i.isFunction)(s)?s():Promise.resolve()}}}},72346:(e,t,s)=>{"use strict";s.d(t,{o:()=>g});s(24603),s(74916),s(15306);const i={amp:/&/g,lt:/</g,gt:/>/g,apos:/'/g,quot:/"/g,chars:/[&<>"']/},o=/&quot;/g,r=/&#39;/g,n=/&lt;/g,a=/&gt;/g,l=/&amp;/g,c=/&nbsp;/g,d={space:/[\s\uFEFF\xA0][\s\uFEFF\xA0]+/g,lr:/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,l:/^[\s\uFEFF\xA0]+/g,r:/[\s\uFEFF\xA0]+$/g},u=/[^0-9A-Za-zА-Яа-яЁё`’!&?:\-+_;," ()№]+/g,p=/[^0-9A-Za-zА-Яа-яЁё`’!&?:\-+_;,"*]+/g,h=/(?!\*$)\*/g,_=/<[^>]*>/g,m=/(https?:\/\/)[^\s"'`\]\[{}<>^|]+/gi;class g{static blacklist(e){let t=new RegExp("["+e+"]+","g");return e=>e.replace(t,"")}static whitelist(e){let t=new RegExp("[^"+e+"]+","g");return e=>e.replace(t,"")}static toTag(){return e=>e.replace(u,"")}static toKeyword(){return e=>e.replace(p,"").replace(h,"")}static toInt(e=10){return t=>parseInt(t,e)}static toFloat(){return e=>parseFloat(e)}static toBoolean(e){return t=>e?"true"===t||"1"===t:"0"!==t&&"false"!==t&&""!==t}static toLowerCase(){return e=>e.toLowerCase()}static toUpperCase(){return e=>e.toUpperCase()}static trim(e){let t=e?new RegExp("^["+e+"]+|["+e+"]+$","g"):d.lr;return e=>e.replace(t,"")}static ltrim(e){let t=e?new RegExp("^["+e+"]+","g"):d.l;return e=>e.replace(t,"")}static rtrim(e){let t=e?new RegExp("["+e+"]+$","g"):d.r;return e=>e.replace(t,"")}static singleSpace(){return e=>e.replace(d.space," ")}static escape(){return e=>i.chars.test(e)?e.replace(i.amp,"&amp;").replace(i.lt,"&lt;").replace(i.gt,"&gt;").replace(i.apos,"&#39;").replace(i.quot,"&quot;"):e}static unescape(){return e=>e.replace(l,"&").replace(n,"<").replace(a,">").replace(r,"'").replace(o,'"').replace(c," ")}static clearHTMLTags(){return e=>e.replace(_,"")}static clearEmoji(){return e=>e.replace(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{2600}-\u{26FF}]/gu,"")}static clearURLs(){return e=>e.replace(m,"")}static clearExtraExcludingSpaces(e){return t=>t.replace(/\s+/g,"").length>e?t.slice(0,-1):t}}},65035:(e,t,s)=>{"use strict";s.d(t,{mJ:()=>m,mB:()=>r,k0:()=>l,YD:()=>g,bF:()=>n});s(88674);var i=s(12953),o=s(12950);class r{constructor(){}static async getList(e,t,s){if(!e||"string"!=typeof e)throw new Error("Ignore list type was not specified or has an invalid type");let i,r,n;switch(e){case"users":i="get_users_ignore_list",r="from_id";break;case"tags":i="get_tags_ignore_list",r="from_tag";break;case"communities":i="get_communities_ignore_list",r="from_id"}n=s?`/ajax/users_actions.php?action=${i}&search=${t}&${r}=${s}`:`/ajax/users_actions.php?action=${i}&search=${t}`;let{data:a}=await o.cf.getOrFail(n);return{list:a.list,total:a.total,hasMore:a.has_more,allRecordsCount:a.all_records_count}}}class n{constructor(){}static async getList(e,t,s){if(!e||"string"!=typeof e)throw new Error("Subs list type was not specified or has an invalid type");let i,r,n;switch(e){case"users":i="get_users_subs_list",r="from_id";break;case"tags":i="get_tags_subs_list",r="from_tag";break;case"communities":i="get_communities_subs_list",r="from_id";break;case"reply-stories":i="get_comstories_subs_list",r="from_id"}n=s?`/ajax/users_actions.php?action=${i}&search=${t}&${r}=${s}`:`/ajax/users_actions.php?action=${i}&search=${t}`;let{data:a}=await o.cf.getOrFail(n);return{list:a.list,total:a.total,hasMore:a.has_more,allRecordsCount:a.all_records_count}}}var a=s(36005);class l{static async getList(e,t){if("users"===t){let{response:t,data:s}=await o.cf.get("/ajax/users_actions.php",{action:"droplist",q:e});return t.result||(s=[]),s}if("tags"===t){let t,{response:s,data:i}=await o.cf.get("/ajax/tags_actions.php",{action:"tagsline",value:e});return t=s.result?i.tags.map((e=>({label:e[0],info:e[1]}))):[],t}if("communities"===t){let{response:t,data:s}=await o.cf.get("/ajax/gtpost_actions.php",{action:"search_communities",name:e});return t.result?(s.communities&&(s=s.communities),s=(0,a.isArray)(s)?s:[],s.forEach((e=>e.id=Number(e.id)))):s=[],s}return[]}}s(74916),s(15306),s(41817);var c=s(90312),d=s(90477),u=s(73736);function p(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function h(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?p(Object(s),!0).forEach((function(t){_(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):p(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function _(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const m=0;class g{static async setCategoriesOrder(e){await o.cf.postOrFail("/ajax/stories_actions.php",{action:"reorder_save_categories",order:e.join(","),dataType:"json"})}static async renameCategory(e,t){await o.cf.postOrFail("/ajax/stories_actions.php",{action:"rename_save_category",cat_id:t,name:e,dataType:"json"}),this.categories.get(t).data.name=e}static async add(e,t={}){let{data:s}=await o.cf.postOrFail("/ajax/stories_actions.php",{action:"create_save_category",name:e});return c.c.getInstance().sendEvent("save_category_create",h(h({},t),{},{folder_id:s.id,folder:e})),this.categories.add({id:s.id,name:e,count:0,is_shared:!1}),Number(s.id)}static async deleteCategory(e,t){await o.cf.postOrFail("/ajax/stories_actions.php",{action:"delete_save_category",cat_id:e,move_to_cat_id:t,dataType:"json"});const s=this.categories.get(e);this.categories.remove(e),"number"==typeof t&&t>=0&&(this.categories.get(t).data.count+=s.data.count)}static async changeSettings(e){await o.cf.postOrFail("/ajax/users_actions.php",{action:"change_settings",hide_save_stories_menu:e?"1":"0",dataType:"json"})}static async addOrRemoveStory(e,t,s=0,r="",n={}){let a={action:"save_story"+(e?"+":"-"),story_id:t,dataType:"json"};e&&(a.cat_id=s,a.cat_name=r),e&&(c.c.getInstance().sendEvent("save_post2",h(h({},n),{},{folder:r},i.default.ui.actionBarShown&&{action_bar:"1"})),u.dV.send("savePost",h(h({},n),{},{folder:r},i.default.ui.actionBarShown&&{action_bar:"1"})));let{data:l}=await o.cf.postOrFail("/ajax/stories_actions.php",a);if(e){const e=l.prev_cat_id;if("number"==typeof e){const t=this.categories.get(e);t&&t.data.count--}}const d=l.cat_id,p=this.categories.get(d);return p&&(p.data.count+=e?1:-1),Number(d)}static isCategoryNameAvailable(e,t=-1){const s=e=>e.trim().toLowerCase().replace(/^\s+|\s+$/g,""),i=s(e);return!this.categories.items.some((e=>s(e.data.name)===i&&e.id!==t))}static get categories(){return this._categories||(this._categories=new d.qg,this._categories.add(i.default.config("modules.stories-save-cats")||i.default.config("modules.settings.save-categories.categories"))),this._categories}}s(60320)},60320:(e,t,s)=>{"use strict";s.d(t,{F:()=>r});s(88674);var i=s(12950),o=s(26947);class r{static async search(e=""){const t=o.h.getInstance("searchProfessions");if(t.has(e))return t.get(e);const{response:s,data:r}=await i.cf.post("/ajax/occupations_actions.php",{action:"get_by_name",name:e});return t.set(e,s.result?r:[]),r}static async save(e=""){const{data:t}=await i.cf.post("/ajax/occupations_actions.php",{action:"assign",name:e});return t}static hasSearchCache(e=""){const t=o.h.getInstance("searchProfessions");return t.has(e)&&!(t.get(e)instanceof Promise)}}},57443:(e,t,s)=>{"use strict";s.d(t,{c:()=>O});s(88674),s(41817);var i=s(12950),o=s(12953),r=s(88358),n=s(31474),a=s(47442),l=s(16226),c=s(53056);function d(e){return'<div class="delete-modal">\n\t<p>Введите пароль от аккаунта</p>\n\t<div class="input input_box input_section delete-modal__input">\n\t\t<span class="input__box">\n\t\t\t<input class="input__input" type="password" placeholder="Пароль" name="password" value="" autocomplete="off">\n\t\t</span>\n\t</div>\n</div>\n','<div class="delete-modal">\n\t<p>Введите пароль от аккаунта</p>\n\t<div class="input input_box input_section delete-modal__input">\n\t\t<span class="input__box">\n\t\t\t<input class="input__input" type="password" placeholder="Пароль" name="password" value="" autocomplete="off">\n\t\t</span>\n\t</div>\n</div>\n'}function u(e){var t,s="";return s+='<div class="delete-modal">\n\t<p>Введите код из смс-сообщения</p>\n\t<div class="input input_box input_section delete-modal__input">\n\t\t<span class="input__box">\n\t\t\t<input class="input__input" type="text" placeholder="Код" name="code" value="" autocomplete="off">\n\t\t</span>\n\t</div>\n\t'+(null==(t=e.sendTelegramLink)?"":t)+"\n\t"+(null==(t=e.resendSmsBlock)?"":t)+"\n</div>\n"}var p=s(88690);function h(e){var t="";Array.prototype.join;return t+='<div class="delete-modal delete-modal_social">\n\t<p>Для удаления аккаунта необходимо повторно авторизоваться</p>\n\t<div class="delete-modal__social-icons">\n\t\t<div class="auth__providers">\n\t\t\t',e.vk&&(t+='\n\t\t\t\t<a\n\t\t\t\t\tclass="tool auth__provider  social-icon_color social-icon_wide"\n\t\t\t\t\tdata-type="vk"\n\t\t\t\t\tdata-role="vk"\n\t\t\t\t>\n\t\t\t\t\t<span class="auth__provider-logo">\n\t\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--social__vk icon--social__vk_tool"><use xlink:href="#icon--social__vk"></use></svg>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class="auth__provider-text">Войти через VK ID</span>\n\t\t\t\t</a>\n\t\t\t'),t+="\n\t\t\t",e.google&&(t+='\n\t\t\t\t<a\n\t\t\t\t\tclass="tool auth__provider  social-icon_color social-icon_wide"\n\t\t\t\t\tdata-type="google"\n\t\t\t\t\tdata-role="google"\n\t\t\t\t>\n\t\t\t\t\t<span class="auth__provider-logo">\n\t\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--social__google icon--social__google_tool"><use xlink:href="#icon--social__google"></use></svg>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class="auth__provider-text">Войти через Google</span>\n\t\t\t\t</a>\n\t\t\t'),t+="\n\t\t\t",e.ya&&(t+='\n\t\t\t\t<a\n\t\t\t\t\tclass="tool auth__provider  social-icon_color social-icon_wide"\n\t\t\t\t\tdata-type="ya"\n\t\t\t\t\tdata-role="ya"\n\t\t\t\t>\n\t\t\t\t\t<span class="auth__provider-logo">\n\t\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--social__ya icon--social__ya_tool"><use xlink:href="#icon--social__ya"></use></svg>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class="auth__provider-text">Войти с Яндекс ID</span>\n\t\t\t\t</a>\n\t\t\t'),t+="\n\t\t</div>\n\t</div>\n</div>\n"}var _=s(28650),m=s(19755),g=s.n(m);function v(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function f(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?v(Object(s),!0).forEach((function(t){y(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):v(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function y(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const b="/ajax/users_actions.php",w="rm_acc_scl",k={isHeaderLeftAlign:!0,wrapperExtraClass:"popup_remove-account"};var S;!function(e){e[e.PHONE=1]="PHONE",e[e.PASSWORD=2]="PASSWORD",e[e.SOCIAL=3]="SOCIAL"}(S||(S={}));class O{static async removeAccount(e,t={}){const{response:s}=await i.cf.postOrFail(b,f({action:"remove_profile",confirm_type:e},t));return s.result}static async restoreAccount(){const{response:e}=await i.cf.post(b,{action:"restore_profile"});if(!e.result)throw o.default.ui.toasts.showError(e.message),new Error(e.message);return e.result}static async requestAccountRemoval(){const{response:e,data:t}=await i.cf.post(b,{action:"request_remove_profile"});if(!e.result)throw o.default.ui.toasts.showError(e.message),new Error(e.message);return t}static showRemoveAccountPopup(){const e=new r.LD({content:'<div class="delete-modal delete-modal_info">\n\t<h3 class="delete-modal__title">Вы действительно хотите удалить аккаунт? Его можно восстановить в течение 6 месяцев</h3>\n\t<p>Перед удалением аккаунта не&nbsp;забудьте повторно ознакомиться с&nbsp;правилами сайта:</p>\n\t<ul class="delete-modal__list">\n\t\t<li class="delete-modal__item"><a href="https://pikabu.ru/information/rules#10" target="_blank">Мультиаккаунты</a></li>\n\t\t<li class="delete-modal__item"><a href="https://pikabu.ru/information/rules#12" target="_blank">Юридическая информация</a></li>\n\t\t<li class="delete-modal__item"><a href="https://pikabu.ru/information/terms" target="_blank">Политика конфиденциальности</a></li>\n\t</ul>\n</div>\n',wrapperExtraClass:"popup_remove-account popup_remove-account-thin"});e.addButtonIntoFooter(o.default.i18n("page-settings.save-categories.yes"),(async()=>{await O.showConfirmRemoveAccountPopup(),e.hide()}),n.j.DANGER),e.addCloseButtonIntoFooter(o.default.i18n("page-settings.save-categories.no")),e.show()}static async showConfirmRemoveAccountPopup(){const{confirm_type:e,session_id:t}=await O.requestAccountRemoval();if(e===S.PHONE&&!t)return;const s=O.getConfirmRemoveAccountPopup(e,t);s&&(s.header="Удалить аккаунт",s.show(),e===S.SOCIAL?s.el.querySelectorAll(".auth__provider").forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault(),c.m.set(w,1),o.default.history.location.href="/oauth.php?type="+e.dataset.type+"&ref="+encodeURIComponent(location.href)}),{once:!0})})):(s.addButtonIntoFooter(o.default.i18n("page-settings.save-categories.yes"),(async()=>{const i=O.getConfirmRemovalParams(s,e,t);try{await O.removeAccount(e,i)&&(o.default.history.location.href="/"),s.hide()}catch(r){if(s.$els.header){s.$els.toasts||s.$els.header.after(s.$els.toasts=g()(document.createElement("div")).addClass("popup__toasts"));new a.O({$parent:s.$els.toasts,content:r.message,theme:a.K.DANGER}).show()}else o.default.ui.toasts.showError(r.message)}}),n.j.DANGER),s.addCloseButtonIntoFooter(o.default.i18n("page-settings.save-categories.close")),setTimeout((()=>{var e;null===(e=s.el.querySelector("input"))||void 0===e||e.focus()}),100)))}static getConfirmRemoveAccountPopup(e,t){var s;const{PHONE:i,PASSWORD:n,SOCIAL:a}=S,c=null!==(s={[i]:u,[n]:d,[a]:h}[e])&&void 0!==s?s:()=>"",m={};if(e===i)m.resendSmsBlock=_.X.getTemplate(),m.sendTelegramLink=o.default.isMobileApp?(0,p.Z)(t):null;else if(e===a){const e=o.default.config("modules.settings.security");m.vk=e.oauth[l.lr.VK.valueOf()],m.google=e.oauth[l.lr.GOOGLE.valueOf()],m.ya=e.oauth[l.lr.YA.valueOf()]}const g=new r.LD(f({content:c(m)},k));return o.default.isDesktopApp&&g.addCustomIntoFooter((0,p.Z)(t)),e===i&&new _.X({el:g.content.get(0).querySelector(".resend-sms"),sessionId:t}).render(),g}static getConfirmRemovalParams(e,t,s){var i,o;return s&&t===S.PHONE?{session_id:s,confirm_code:null===(i=e.el.querySelector('input[name="code"]'))||void 0===i?void 0:i.value}:t===S.PASSWORD?{password:null===(o=e.el.querySelector('input[name="password"]'))||void 0===o?void 0:o.value}:{}}static async checkSocialAccountRemoval(){if(!c.m.get(w))return;c.m.remove(w);const e=new r.LD(f({content:'<div class="delete-modal">\n\t<p>Завершение удаления аккаунта...</p>\n</div>\n',autoCloseOutsideClick:!1,autoClosePressEscape:!1},k));e.header="Удалить аккаунт",e.show();try{await O.removeAccount(S.SOCIAL)?o.default.history.location.href="/":e.hide()}catch(t){e.hide(),o.default.ui.toasts.showError(t)}}}},62956:(e,t,s)=>{"use strict";s.d(t,{Sq:()=>o,Lq:()=>r});s(88674);let i;!function(e){e.VK="vk",e.FACEBOOK="fb",e.TWITTER="tw",e.GOOGLE="google"}(i||(i={}));class o{async link(e){return new Promise((t=>{const s=screen.width/2-512,i=screen.height/2-350;window.pkbOAuthCallback=e=>{window.pkbOAuthCallback=null,t(e)},window.open(`/oauth.php?type=${e}&ref=js`,"oauth",`left=${s},top=${i},width=1024,height=700,popup=yes`)}))}}function r(e){const t={facebook:"fb",twitter:"tw",ya:"yandex"}[e];return null!=t?t:e}},4144:(e,t,s)=>{"use strict";s.d(t,{A0:()=>d,Ag:()=>c,Mz:()=>u,Oq:()=>l,R$:()=>_,U5:()=>a,VE:()=>w,W5:()=>o,XA:()=>g,fo:()=>p,kY:()=>m,of:()=>h,ok:()=>y,q1:()=>i,qC:()=>f,qn:()=>b,sC:()=>r,wE:()=>n,wn:()=>v});s(91904);const i=20,o=1500,r="pkb_svce",n="pkb_ssvc",a=100,l=1200,c=120,d="vn_buff",u=3e3,p="pkb_nhvn",h="pkb_nhvh",_="pkb_sve",m="pkb_ave",g=1200,v="last-story",f="story-skeleton",y=["cedit","story","community-queue"],b=5e3,w=9},72666:(e,t,s)=>{"use strict";s.d(t,{DV:()=>o,kc:()=>r,rg:()=>n,y$:()=>a});var i=s(65448);new i.xs({NEW:0,HOT:1,BEST:2,MOST_SAVED:3});const o=new i.xs({NEW:"new",HOT:"hot",BEST:"best",RECOMMEND:"recommend",VISITED:"visited",SUBS:"subs",MOST_SAVED:"most-saved",COMMUNITIES:"communities",DISPUTED:"disputed",COMMUNITY_SEARCH:"community-search",COMMUNITY:"community",COMPANIES:"companies",SERIES:"series",SEARCH:"search",PROFILE:"profile",BROWSING_IMAGES:"images",BROWSING_SERIES:"series-stories",BROWSING_TEXT:"text",BROWSING_VIDEOS:"videos",BROWSING_NSFW:"nsfw",BROWSING_UNIQUE:"unique",BROWSING_MY:"my",BROWSING_ANSWERS:"answers",BROWSING_VIRUS:"virus",BROWSING_VIEWED:"viewed",BROWSING_SHORT:"short",BROWSING_ANONYMOUS:"anonymous",BROWSING_DLINNOPOST:"dlinnopost",CHISTOMEN:"chistomen",EXPERTS:"experts",COMSTORIES:"comstories"}),r=new i.xs({VISITED_STORIES_SHOW:0,VISITED_STORIES_COLLAPSE:1,VISITED_STORIES_HIDE:2}),n=new i.xs({VISITED_STORIES_SHOW:"show",VISITED_STORIES_COLLAPSE:"collapse",VISITED_STORIES_HIDE:"hide"}),a=new i.xs({TIME:"time",ACTUAL:"act"});new i.xs({ALL:0,POSITIVE:1}),new i.xs({USERS:1,TAGS:2,COMMUNITIES:4})},28524:(e,t,s)=>{"use strict";s.d(t,{n:()=>et,Z:()=>et});s(88674),s(66992),s(33948),s(74916),s(15306),s(41817);var i=s(12953),o=s(72044),r=s(63907),n=s(10553),a=s(35924),l=(s(92927),s(72666)),c=s(36005),d=s(4144),u=s(90477),p=s(12950),h=s(96637),_=s(89770),m=s(29845),g=s(62165),v=s(91904),f=s(4081);class y{constructor(e){this._stories=e.stories,this._disabledWatch="community-queue"===e.feedName||"story-preview"===e.feedName,this._checkStoriesViewedBound=this._checkStoriesViewed.bind(this),this._npsSurvey=v.V.isUserInExperiment(v.t.CONTENT_NPS)?f.u.getInstance():null}update(e=!1){if(!this._disabledWatch)return e?(this._stop(),void this._checkStoriesViewed()):void(this._watchIdle||(this._watchIdle=setInterval(this._checkStoriesViewedBound,d.W5)))}_checkStoriesViewed(e=!1){if(this._disabledWatch)return;let t=0;for(const i of this._stories.items){let o=i.isVisited,r=i.isViewed,n=i.isAdShortRead,a=i.isAdViewed,l=i.isBlogStoryViewed,c=i.isBlogStoryRead,d=i.isFullStoryReading;if(!i||i.isDestroyed||o&&r&&a&&n&&l&&c&&d)continue;let u=!0;var s;if(!o&&i.checkVisited()&&(i.isVisited=o=!0,_.C.setVisited({storyId:i.id,authorId:i.authorId,isSubscribed:i.isSubscribed},e),u=!1),!r&&i.checkViewed())i.isViewed=r=!0,m.N.setViewed({storyId:i.id,authorId:i.authorId,isSubscribed:i.isSubscribed},u),null===(s=this._npsSurvey)||void 0===s||s.registerStoryView(i.id);!a&&i.checkAdViewed()&&(i.isAdViewed=a=!0),!n&&i.checkAdShortRead()&&(i.isAdShortRead=n=!0),!l&&i.checkBlogStoryViewed()&&(i.isBlogStoryViewed=l=!0),!c&&i.checkBlogStoryRead()&&(i.isBlogStoryRead=c=!0),i.isBlogStory&&i.viewRatio>=50&&!d&&g.r.instance.logRatioReading(i,i.viewRatio),o&&r&&a&&n&&l&&c&&d||i.isCollapsed||t++}t||this._stop()}setVisit(e){let t=!0;e.isVisited||(e.isVisited=!0,!this._disabledWatch&&_.C.setVisited({storyId:e.id,authorId:e.authorId,isSubscribed:e.isSubscribed}),t=!1),e.isViewed||(e.isViewed=!0,!this._disabledWatch&&m.N.setViewed({storyId:e.id,authorId:e.authorId,isSubscribed:e.isSubscribed},t))}_stop(){this._watchIdle&&(clearInterval(this._watchIdle),delete this._watchIdle)}forceSaveWhenGoing(){if(this._disabledWatch)return this;this._stop(),this._checkStoriesViewed()}forceSave(){if(this._disabledWatch)return this;this._stop(),this._checkStoriesViewed(!0),_.C.forceSave()}extractUnsavedIds(){return this._disabledWatch?[]:(this._stop(),this._checkStoriesViewed(!0),_.C.extractUnsavedIds())}}var b=s(10703),w=s(91920),k=s(88549),S=s(92934),O=s(90312),E=s(58330),C=s(56927),x=s(22359),T=s(1262),I=s(5603),P=s(7099),A=s(88810),D=s(27409),M=s(14025),R=s(43241),N=s(36005);var B=s(36005);var L=s(39965),j=s(39334),$=s(32677),U=s(42107),F=s(53056),V=s(19755),H=s.n(V),Z=s(9003);function z(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function q(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const W={0:{code:"subs",caption:"Новое в ваших подписках",footerButtonCaption:"Перейти в подписки",footerButtonLink:"/subs",analyticsType:"new_in_subs"},1:{code:"raw",caption:"Вам может быть интересно",analyticsType:"raw_communities"},2:{code:"rec",caption:"Рекомендуемые сообщества",analyticsType:"recommended_communities"},4:{code:"tag",caption:"Рекомендуемые сообщества",analyticsType:"communities_with_tag"}},G={best:6,hot:6,new:6,tag:0};class Y extends R.u{constructor(e,t,s={}){super(),this.feedName=e,this.stories=t,this.queryParams=s,this.init()}init(){if("tag"===this.feedName){const e=document.querySelector('.carousel.recommended-communities[data-type="tag"]');if(e)return void this.initCarouselByDom(e,4)}this.feedName in G&&this.stories.items.length>=G[this.feedName]&&this.initCarouselLoadObserver()}initCarouselLoadObserver(){if(G[this.feedName]>0){const e=new IntersectionObserver((t=>{t.forEach((t=>{t.isIntersecting&&(e.unobserve(t.target),this.loadCarousel(t.target))}))}),{rootMargin:"1000px"});e.observe(this.stories.items[G[this.feedName]-1].el)}else{var e,t;const s=null===(e=this.stories.items[0])||void 0===e||null===(t=e.el.parentElement)||void 0===t?void 0:t.previousSibling;s&&this.loadCarousel(s)}}initCarouselByDom(e,t){let s;switch(t){case 2:case 1:case 4:s=new L.k(e);break;default:return}s&&this.initCarouselBlock(4,s)}async loadCarousel(e){const{response:t,data:s}=await p.cf.post("/ajax.php?route=recommendations/feed-block",function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?z(Object(s),!0).forEach((function(t){q(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):z(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({feed_mode:this.feedName},this.queryParams));if(!t||200!==t.status||!s||"number"!=typeof s.type)return;const i=this.getCarouselBlock(s,e);i&&this.initCarouselBlock(s.type,i)}getCarouselBlock(e,t){switch(e.type){case 0:return this.getNewStoriesCarouselBlock(e,t);case 2:case 1:case 4:return this.getRecommendedCommunitiesCarouselBlock(e,t);default:return}}initCarouselBlock(e,t){var s;(this.el=t.el,i.core.isUserAuthorized||!F.m.get(`pkb_crslhide_${e}`))?(this.addListenersToCarouselBlock(e,t),this.initCarouselContextMenu(e,t)):null===(s=this.el)||void 0===s||s.remove()}getNewStoriesCarouselBlock(e,t){for(const s of e.rec)s.story_text=this.cleanText(s.story_text),s.title=this.cleanText(s.title);const i=H()(function(e){var t,i="",o=B.escape;Array.prototype.join;const r=s(30381);return i+='\n<section class="carousel carousel_small carousel_short-stories">\n\t<div class="carousel__header">\n\t\t<h2 class="carousel__title">'+o(e.caption)+'</h2>\n\t\t<div class="dots-menu carousel__dots"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__dots"><use xlink:href="#icon--ui__dots"></use></svg></div>\n\t</div>\n\t<div class="carousel__main">\n\t\t',e.showArrows&&(i+='\n\t\t\t<button type="button" class="carousel__scroll button carousel__scroll_left carousel__scroll_hidden">\n\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-left"><use xlink:href="#icon--ui__arrow-left"></use></svg>\n\t\t\t</button>\n\t\t'),i+='\n\t\t<div class="carousel__content">\n\t\t\t<div class="carousel__helper">\n\t\t\t\t',e.items.forEach(((s,n)=>{i+='\n\t\t\t\t\t<article\n\t\t\t\t\t\tdata-story-id="'+o(s.id)+'"\n\t\t\t\t\t\tdata-author-id="'+o(s.author_id)+'"\n\t\t\t\t\t\tdata-pluses="'+o(s.story_pluses)+'"\n\t\t\t\t\t\tclass="carousel__item short-story'+o(s.story_text?"":" short-story_no-text")+o(s.story_image_url||s.story_video_preview_url?"":" short-story_no-img")+'"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class="short-story__user-info">\n\t\t\t\t\t\t\t<a class="short-story__user-link user__nick" href="/@'+o(s.author_username)+'" data-profile="true" data-name="'+o(s.author_username)+'" data-id="'+o(s.author_id)+'">\n\t\t\t\t\t\t\t\t<div class="avatar avatar_small avatar_note" data-name="'+o(s.author_username)+'">\n\t\t\t\t\t\t\t\t\t<span class="avatar__inner">\n\t\t\t\t\t\t\t\t\t',s.author_avatar?i+='\n\t\t\t\t\t\t\t\t\t\t<img class="recommended-community__logo" src="'+o(s.author_avatar)+'" alt="'+o(s.author_username)+'" loading="lazy">\n\t\t\t\t\t\t\t\t\t':i+='\n\t\t\t\t\t\t\t\t\t\t<span class="avatar__default"></span>\n\t\t\t\t\t\t\t\t\t',i+='\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<span class="short-story__user-name">'+o(s.author_username)+"</span>\n\t\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t\t",s.community_id>0&&(i+='\n\t\t\t\t\t\t\t\t<a class="short-story__community" data-id="'+o(s.community_id)+'" href="'+o(s.community_url)+'">\n\t\t\t\t\t\t\t\t\t<div class="community-avatar community-avatar_small avatar_small avatar">\n\t\t\t\t\t\t\t\t\t\t<span class="avatar__inner">\n\t\t\t\t\t\t\t\t\t\t',s.community_avatar?i+='\n\t\t\t\t\t\t\t\t\t\t\t<img class="recommended-community__logo" src="'+o(s.community_avatar)+'" alt="'+o(s.community_name)+'" loading="lazy">\n\t\t\t\t\t\t\t\t\t\t':i+='\n\t\t\t\t\t\t\t\t\t\t\t<span class="community-avatar__default"></span>\n\t\t\t\t\t\t\t\t\t\t',i+='\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<span class="short-story__community-name">'+o(s.community_name)+"</span>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t"),i+="\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t",(s.story_image_url||s.story_video_preview_url)&&(i+='\n\t\t\t\t\t\t\t<a href="'+o(e.footerButtonLink)+"?target="+o(s.id)+'"\n\t\t\t\t\t\t\t\ttarget="_blank"\n\t\t\t\t\t\t\t\tclass="short-story__preview'+o(s.story_text?"":" short-story__preview_lg")+'"\n\t\t\t\t\t\t\t\tstyle="background-image: url(\''+o(s.story_video_preview_url||s.story_image_url)+"')\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t",s.story_video_preview_url&&(i+='\n\t\t\t\t\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--player__play"><use xlink:href="#icon--player__play"></use></svg>\n\t\t\t\t\t\t\t\t'),i+="\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t"),i+='\n\t\t\t\t\t\t<div class="short-story__meta">\n\t\t\t\t\t\t\t',s.story_rating_is_hidden?i+='\n\t\t\t\t\t\t\t\t<span class="short-story__rating short-story__rating--hidden"></span>\n\t\t\t\t\t\t\t':s.story_rating>0?i+='\n\t\t\t\t\t\t\t\t<span class="short-story__rating short-story__rating--positive">+'+o(s.story_rating)+"</span>\n\t\t\t\t\t\t\t":s.story_rating<0?i+='\n\t\t\t\t\t\t\t\t<span class="short-story__rating short-story__rating--positive">-'+o(s.story_rating)+"</span>\n\t\t\t\t\t\t\t":s.story_rating<0&&(i+='\n\t\t\t\t\t\t\t\t<span class="short-story__rating">'+o(s.story_rating)+"</span>\n\t\t\t\t\t\t\t"),i+='\n\t\t\t\t\t\t\t<time datetime="'+o(r(1e3*s.creation_date).toISOString())+'" class="caption short-story__date hint">\n\t\t\t\t\t\t\t\t'+(null==(t=r(1e3*s.creation_date).fromNow())?"":t)+'\n\t\t\t\t\t\t\t</time>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<h3 class="short-story__name">\n\t\t\t\t\t\t\t<a class="short-story__name-link" href="'+o(e.footerButtonLink)+"?target="+o(s.id)+'" target="_blank">'+o(s.title)+"</a>\n\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t",s.story_text&&(i+='\n\t\t\t\t\t\t\t<p class="short-story__content'+o(s.story_image_url||s.story_video_preview_url?"":" short-story__content_long")+'">\n\t\t\t\t\t\t\t\t'+o(s.story_text)+"\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t"),i+='\n\n\t\t\t\t\t\t<a href="'+o(e.footerButtonLink)+"?target="+o(s.id)+'" class="short-story__read-more" rel="noopener" target="_blank">Читать полностью</a>\n\t\t\t\t\t</article>\n\t\t\t\t'})),i+="\n\t\t\t</div>\n\t\t</div>\n\t\t",e.showArrows&&(i+='\n\t\t\t<button type="button" class="carousel__scroll button carousel__scroll_right">\n\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-right"><use xlink:href="#icon--ui__arrow-right"></use></svg>\n\t\t\t</button>\n\t\t'),i+='\n\t</div>\n\t<a href="'+o(e.footerButtonLink)+'" class="carousel__follow button button_success">'+o(e.footerButtonCaption)+"</a>\n</section>\n"}({items:e.rec,showArrows:!0,caption:W[e.type].caption,footerButtonCaption:W[e.type].footerButtonCaption,footerButtonLink:W[e.type].footerButtonLink}));return i.insertAfter(t),new j.v({$el:i,analyticsParams:{onStoryClickEvent:"transition_to_tab",onStoryClickType:W[e.type].analyticsType,followBtnClickType:W[e.type].analyticsType,level:$.L.my_lent,componentName:"feed_element"}})}getRecommendedCommunitiesCarouselBlock(e,t){const i=H()(function(e){var t="",i=N.escape;Array.prototype.join;const o=s(12953).core;t+='\n<section class="carousel carousel_small recommended-communities" data-type="'+i(e.type)+'" data-analytics-type="'+i(e.analyticsType)+'">\n\t<div class="carousel__header">\n\t\t<h2 class="carousel__title">'+i(e.caption)+'</h2>\n\t\t<div class="dots-menu carousel__dots"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__dots"><use xlink:href="#icon--ui__dots"></use></svg></div>\n\t</div>\n\t<div class="carousel__main">\n\t\t',e.showArrows&&(t+='\n\t\t\t<button type="button" class="carousel__scroll button carousel__scroll_left carousel__scroll_hidden">\n\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-left"><use xlink:href="#icon--ui__arrow-left"></use></svg>\n\t\t\t</button>\n\t\t'),t+='\n\t\t<div class="carousel__content">\n\t\t\t<div class="carousel__helper">\n\t\t\t\t';for(var r=0;r<e.items.length;r++)t+='\n\t\t\t\t\t<article class="carousel__item recommended-community">\n\t\t\t\t\t\t<a href="'+i(e.items[r].url)+'" class="recommended-community__link" data-id="'+i(e.items[r].id)+'">\n\t\t\t\t\t\t\t',e.items[r].avatar?t+='\n\t\t\t\t\t\t\t\t<img class="recommended-community__logo" src="'+i(e.items[r].avatar)+'" alt="'+i(e.items[r].name)+'">\n\t\t\t\t\t\t\t':t+='\n\t\t\t\t\t\t\t\t<div class="community-avatar community-avatar_big">\n\t\t\t\t\t\t\t\t\t<span class="community-avatar__default"></span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t',t+='\n\t\t\t\t\t\t\t<p class="recommended-community__name">'+i(e.items[r].name)+'</p>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<span class="recommended-community__followers">\n\t\t\t\t\t\t\t'+i(e.items[r].subs_cnt)+" "+i(o.i18n("plural.subs",e.items[r].subs_cnt))+'\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t data-css-class="recommended-community__subscribe"\n\t\t\t\t\t\t\t data-role="subscribe"\n\t\t\t\t\t\t\t data-type="community"\n\t\t\t\t\t\t\t data-id="'+i(e.items[r].id)+'"\n\t\t\t\t\t\t\t data-analytics="'+i(JSON.stringify({type:e.analyticsType,screen_index:r+1}))+'"\n\t\t\t\t\t\t\t data-is-subscribed="false"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</article>\n\t\t\t\t';return t+="\n\t\t\t</div>\n\t\t</div>\n\t\t",e.showArrows&&(t+='\n\t\t\t<button type="button" class="carousel__scroll button carousel__scroll_right">\n\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__arrow-right"><use xlink:href="#icon--ui__arrow-right"></use></svg>\n\t\t\t</button>\n\t\t'),t+"\n\t</div>\n</section>\n"}({items:e.rec,showArrows:!0,type:W[e.type].code,analyticsType:W[e.type].analyticsType,caption:W[e.type].caption}));return i.insertAfter(t),new L.k(i.get(0))}addListenersToCarouselBlock(e,t){this.listenToOnce(t.carousel,"carouselShown",(()=>{U.cp.getInstance().sendEvent("feed_element_showed",{type:W[e].analyticsType,screen_index:G[this.feedName]+1})})),this.listenToOnce(t.carousel,"carouselHidden",(()=>{var s;U.cp.getInstance().sendEvent("feed_element_viewed",{type:W[e].analyticsType,screen_index:G[this.feedName]+1,view_time:null==t||null===(s=t.carousel)||void 0===s?void 0:s.timeViewed})}))}cleanText(e){const t=document.createElement("span");t.innerHTML=e;const s=t.innerText;return t.remove(),s}initCarouselContextMenu(e,t){var s;const o=null===(s=t.carousel.el)||void 0===s?void 0:s.querySelector(".carousel__dots");if(!o)return;const r=new Z.K({el:o,items:[{id:0,title:"Это не интересно"}]});this.listenTo(r,"onItemClick",(()=>{r.closeAllMenus(),t.carousel.hide(),U.cp.getInstance().sendEvent("click",{type:W[e].analyticsType,button:"not_interested",component_name:"feed_element",screen_index:G[this.feedName]+1}),i.core.isUserAuthorized?p.cf.post("/ajax.php?route=recommendations/hide-feed-block",{block_id:e}):F.m.set(`pkb_crslhide_${e}`,1)}))}}var K=s(15909),X=s(75021),J=s(22725),Q=s(12182),ee=s(57852),te=s(88358);const se="pkb_dcap",ie="pkb_nctau",oe="pkb_psausi";var re=s(55151),ne=s(82800),ae=s(83257);class le{constructor(){this.startTime=Date.now(),this.isExpGroupB=v.V.isUserInExperiment(v.t.DISABLE_ADBLOCK_POPUP,"B"),this.isExpGroupC=v.V.isUserInExperiment(v.t.DISABLE_ADBLOCK_POPUP,"C"),this.init()}static getInstance(){return le.instance?le.instance:le.instance=new le}async init(){var e;if(!(await this.isNeedShowAdblockPopup()))return;const t=function(e){var t="";return Array.prototype.join,t+='\n<div class="blk-popup__error" hidden>Блокировщик рекламы не отключен</div>\n<div class="blk-popup">\n    <div class="blk-popup__picture">\n        <img class="picture" src="https://cs14.pikabu.ru/post_img/2022/08/11/8/1660220583174145158.png"/>\n    </div>\n    <div class="blk-popup__content">\n        <div class="message">\n            <div class="message__title">Пожалуйста, отключите блокировщик рекламы</div>\n            ',e.isMobile?t+='\n            <div class="message__text">Это поможет Пикабу развиваться дальше: благодаря рекламе мы оплачиваем сервера и\n                труд команды. Спасибо ❤️</div>\n            ':t+='\n                <div class="message__text">Это поможет Пикабу развиваться дальше: благодаря рекламе мы оплачиваем <br /> сервера и\n                    труд команды. Спасибо ❤️</div>\n            ',t+='\n        </div>\n        <div class="button button_success message__button" data-analytics-type="done">Готово</div>\n    </div>\n    ',e.expGroupB&&(t+='\n        <div class="blk-popup__close-icon">\n            <span class="blk-popup__close-icon-wrapper" data-analytics-type="close"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__close"><use xlink:href="#icon--ui__close"></use></svg></span></div>\n    '),t+="\n</div>"}({expGroupB:this.isExpGroupB,isMobile:!1});this.modal=new te.LD({content:t,autoCloseOutsideClick:!1,direction:ne.Lh.BOTTOM,isModalMenu:!0,wrapperExtraClass:"blk-modal"}),this.modal.show(),U.cp.getInstance().sendEvent("form_init",{type:this.isExpGroupB?"ask_disable_adblock":"ask_disable_adblock_force"}),this.els={popup:this.modal.el.querySelector(".blk-popup"),closeIcon:this.modal.el.querySelector(".blk-popup__close-icon"),closeButton:this.modal.el.querySelector(".message__button"),errorMessage:this.modal.el.querySelector(".blk-popup__error")},F.m.get(ie)&&(this.els.errorMessage.hidden=!1),(null===(e=this.els)||void 0===e?void 0:e.popup)&&this.els.popup.addEventListener("click",(e=>this.handleCloseForm(e))),this.els.popup.offsetHeight&&this.els.popup.offsetWidth&&U.cp.getInstance().sendEvent("form_show",{type:this.isExpGroupB?"ask_disable_adblock":"ask_disable_adblock_force"}),F.m.set(oe,!0)}handleCloseForm(e){var t,s,i;const o=e.target;if(null===(t=o.dataset.analyticsType)||void 0===t||!t.length)return;this.modal.destroy();const r=Date.now()-this.startTime;U.cp.getInstance().sendEvent("click",{button:null===(s=o.dataset)||void 0===s?void 0:s.analyticsType,type:this.isExpGroupB?"ask_disable_adblock":"ask_disable_adblock_force",view_time:r}),U.cp.getInstance().sendEvent("form_close",{button:o.dataset.analyticsType,type:this.isExpGroupB?"ask_disable_adblock":"ask_disable_adblock_force",view_time:r}),F.m.remove(oe),"close"===o.dataset.analyticsType&&(F.m.set(se,Date.now()),F.m.remove(ie)),"done"===(null===(i=o.dataset)||void 0===i?void 0:i.analyticsType)&&(F.m.set(ie,!0),window.location.reload())}async isNeedShowAdblockPopup(){if(!(await(0,ae.Pf)()))return F.m.remove(se),F.m.remove(ie),!1;if(i.default.initParams.isAdsDisableAllowed||i.default.initParams.isAdsDisabled)return F.m.remove(se),F.m.remove(ie),!1;const e=window.PkbAnalytics.unauthorizedTs||0,t=Number(F.m.get(se))||0;if(e>1661847845&&i.default.initParams.isExternalReferer&&!t)return!0;if(Boolean(t)&&Date.now()-t>re.FJ)return!0;return!!Boolean(F.m.get(ie))||Boolean(F.m.get(oe))}}s(85827);var ce=s(66422),de=s(74750);function ue(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class pe{constructor({ctx:e,container:t,template:s}){ue(this,"CheckboxClass",E.S.getInstance().get("UICheckbox")),ue(this,"moderatorTools",new ce.D),ue(this,"strictSpecialTags",[de.x,"Моё"]),ue(this,"specialTags",new Map),ue(this,"allTags",new Map),this.ctx=e,this.container=t,this.template=s;const{$el:i}=this.ctx;this.badge=this.container.find(".story__mod-btn-icon_tags"),this.storyId=i.find(".story").data("story-id"),this.storyTagsContainer=i.find(".story__tags"),this.container.data("tags").split(",").forEach((e=>{const t="[моё]"===e?"Моё":e;this.specialTags.set(t,this.strictSpecialTags.includes(t))})),this.storyTagsContainer.find("[data-tag]").each(((e,t)=>{const s=t.dataset.tag;this.allTags.set(s,this.strictSpecialTags.includes(s))})),this.init()}init(){this.popup=new te._({target:this.container,direction:te.Lh.BOTTOM,alignment:te.SE.CENTER,destroyAfterHide:!1,interactive:!0,autoCloseOutsideClick:!0,hideByScroll:!0}),this.container.on("click",this.popup.toggle.bind(this.popup)),i.core.listenTo(this.popup,r.eM.MOUNTED,this.onPopupMount.bind(this)),i.core.listenTo(this.popup,r.eM.UNMOUNTED,this.toggleActive.bind(this,!1));const e=this.getUpdateTags();this.popup.content.on("change",this.onTagsChange.bind(this,e))}onPopupMount(){this.toggleActive(!0);const e=this.getCheckedTags();this.popup.content=this.template(e),this.popup.content.find("input").each(((e,t)=>new this.CheckboxClass(t)))}getCheckedTags(){const{specialTags:e,allTags:t}=this,s=[...t.keys()],i=s.join(",").toLowerCase().split(","),o=new Map;for(const[r,n]of e){const e=n?s.includes(r):i.includes(r.toLowerCase());o.set(r,e)}return o}toggleActive(e){this.badge.hasClass("story__mod-btn-icon_tags-active")||this.container.toggleClass("story__mod-btn_tags-active",e)}onTagsChange(e,{target:t}){const{updateNsfw:s,updateMy:i,updateOther:o}=e,{value:r,checked:n}=t;if(this.toggleInnerMemory(t),this.toggleDom(t),r===de.x)return s(t,n);if("Моё"===r)return i(t,n);o([...this.allTags.entries()].reduce(((e,[t,s])=>(s||e.push(t),e)),[]))}toggleInnerMemory(e){var t;const{value:s,checked:i}=e,o=s.toLowerCase(),r=null!==(t=this.specialTags.get(s))&&void 0!==t&&t;if(i)this.allTags.set(s,r);else if(r)this.allTags.delete(s);else for(const[n]of this.allTags)if(n.toLowerCase()===o){this.allTags.delete(n);break}}toggleDom(e){const{value:t,checked:s}=e;if(s)if(t!==de.x)if("Моё"!==t)this.storyTagsContainer.append(`<span class="tags__tag" data-tag="${t}">${t}</span>`);else{const e=`<span class="tags__tag tags__tag_highlight" data-tag="${t}">[моё]</span>`;this.allTags.has(de.x)?this.storyTagsContainer.find(`[data-tag="${de.x}"]`).after(e):this.storyTagsContainer.prepend(e)}else this.storyTagsContainer.prepend(`<span class="tags__tag tags__tag_nsfw" data-tag="${t}">${t}</span>`);else{var i;const e=t.toLowerCase(),s=null!==(i=this.specialTags.get(t))&&void 0!==i&&i;this.storyTagsContainer.find("[data-tag]").each(((i,o)=>{var r;const n=null===(r=o.dataset)||void 0===r?void 0:r.tag;(s&&n===t||!s&&(null==n?void 0:n.toLowerCase())===e)&&o.remove()}))}}getUpdateTags(){const e=1e3,t=()=>{this.container.addClass("story__mod-btn_tags-active"),this.badge.addClass("story__mod-btn-icon_tags-active"),i.core.ui.toasts.add({content:"Теги успешно сохранены"})};this.moderatorTools.on("complete",t);return{updateNsfw:(0,S.D)(((e,t)=>{this.moderatorTools.setStoryAdultFlag(e,this.storyId,t)}),e),updateMy:(0,S.D)(((e,t)=>{this.moderatorTools.setStoryAuthorsFlag(e,this.storyId,t)}),e),updateOther:(0,S.D)((e=>{const s={action:"set_story_tags",tag:e.join(","),story_id:this.storyId};ce.c.moderatorAction(s).then(t,(e=>{i.core.ui.toasts.showError(e||i.core.i18n("moderator-tools.errors.request"))}))}),e)}}}var he=s(68505),_e=s(42478),me=s(2439),ge=s(93266);function ve(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function fe(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(s),!0).forEach((function(t){ye(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ve(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function ye(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class be{constructor(){ye(this,"send",(()=>{let e=Promise.resolve();return t=>e=(async({event:t,segment:s,data:i={}})=>{await e;try{ge.D.sendEvent(t,fe(fe({},i),{},{"level!empty":s}))}catch(o){console.log("Can't send analytics event, ",o)}return h.Utils.delay(50)})(t)})())}static getInstance(){return be.instance||(be.instance=new be)}}var we=s(7016);const ke="evaluation",Se={container:ke,content:`${ke}__content`,hidden:`${ke}__hidden`,list:`${ke}__list`,btnGroup:`${ke}__btn-group`,form:`${ke}__form`,formTitle:`${ke}__form-title`,link:`${ke}__link`,actionBtn:'button[data-role="next"]',cancelBtn:'button[data-role="cancel"]',closeBtn:`${ke}__close`,closeBtnInline:`${ke}__close_inline`,emoji:{container:`${ke}-emoji`}};function Oe(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Ee="cancel",Ce="next-step";class xe{constructor({getTemplate:e,asModalMenu:t=!1,autoCloseTS:s=0,addCloseParam:i=!1,addHideEvent:o=!1}){Oe(this,"autoCloseMS",0),Oe(this,"addCloseParam",!1),Oe(this,"addHideEvent",!1),Oe(this,"els",{}),Oe(this,"emitter",new me.v),Oe(this,"evaluation",null),Oe(this,"autoCloseTimer",null),this.getTemplate=e,this.asModalMenu=t,this.autoCloseMS=s,this.addCloseParam=i,this.addHideEvent=o}getContent(e){return this.content||(this.content=this.initTemplate(e),this.initEls(),this.initEventListeners(e),this.autoCloseMS>0&&(this.autoCloseTimer=setTimeout((()=>this.emitCancel()),this.autoCloseMS))),this.content}subscribe(e,t){return this.emitter.on(e,t),this}destroy(){this.autoCloseTimer&&clearTimeout(this.autoCloseTimer),this.emitter.destroy()}onMounted(e){this.evaluation=e;const t=this.evaluation.getContainer();return we.v&&!xe.intersectionObserver&&t&&(xe.intersectionObserver=new IntersectionObserver((e=>{var s;e.some((e=>e.isIntersecting))&&(this.sendAnalytics("form_show"),null===(s=xe.intersectionObserver)||void 0===s||s.unobserve(t))}),{rootMargin:"20px",threshold:0}),xe.intersectionObserver.observe(t)),this}sendAnalytics(e,t={}){if(!this.evaluation)return;const s={event:e,segment:this.evaluation.getSegment(),data:t};be.getInstance().send(s)}emitCancel(){this.emitter.emit(Ee)}emitNextStep(e){this.emitter.emit(Ce,e)}initTemplate(e){return o.Zv.fragment(this.getTemplate(e))}initEls(){this.content&&(this.els.cancelBtn=this.content.querySelector(Se.cancelBtn),this.els.actionBtn=this.content.querySelector(Se.actionBtn))}initEventListeners(e){var t,s;null===(t=this.els.cancelBtn)||void 0===t||t.addEventListener("click",(()=>{this.emitter.emit(Ee)})),null===(s=this.els.actionBtn)||void 0===s||s.addEventListener("click",(()=>{this.emitter.emit(Ce)}))}}Oe(xe,"intersectionObserver",null);class Te{static async getEvaluationQuestion(){const{response:e,data:t}=await p.cf.get("/ajax.php",{route:"csat/get-question"});return e.result||console.error(e.message),t}static async hideEvaluation(e=!1){const t={route:"csat/hide-survey"};e&&(t.close=1);const{response:s,data:i}=await p.cf.post("/ajax.php",t);return s.result||console.error(s.message),i}static async sendAnswer({questionId:e,answerId:t}){const{response:s,data:i}=await p.cf.post("/ajax.php",{route:"csat/set-answer",question_id:e,answer_id:t});return s.result||console.error(s.message),i}}function Ie(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function Pe(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(s),!0).forEach((function(t){Ae(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ie(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Ae(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const De="pkb_evts_counter";class Me extends R.u{constructor(...e){super(...e),Ae(this,"state",{}),Ae(this,"container",null),Ae(this,"modal",null),Ae(this,"segment",null),Ae(this,"nextStep",(()=>{this.container&&this.containerSelector&&this.currentStep?this.setContainerContent(this.currentStep.getContent(this.state)):this.initModalStep(),this.initStepControllerSubscriptions()})),Ae(this,"hanldeNextStepEvent",(e=>{const t=this.getCurrentStepIndex(),s=t+1;this.container&&this.modal&&this.modal.hide(),e&&(this.state=Pe(Pe({},this.state),e)),this.STEPS[t].destroy(),this.setCurrentStep(s),this.nextStep()})),Ae(this,"handleHideElement",(e=>{var t,s;null===(t=this.container)||void 0===t||null===(s=t.querySelector(e))||void 0===s||s.classList.add(Se.hidden)})),Ae(this,"handleAppendElement",(e=>{var t,s;null===(t=this.container)||void 0===t||null===(s=t.querySelector("."+Se.content))||void 0===s||s.append(e)})),Ae(this,"cancelEvaluation",(async()=>{var e,t,s;(this.modal&&this.modal.hide(),null!==(e=this.currentStep)&&void 0!==e&&e.addHideEvent)&&await Te.hideEvaluation(null===(s=this.currentStep)||void 0===s?void 0:s.addCloseParam);null===(t=this.currentStep)||void 0===t||t.destroy()}))}init(){this.isRendered||this.renderWhenReady()}async renderWhenReady(){await(async(e=2e3)=>{if(h.Utils.isInput(document.activeElement)){for(;await h.Utils.delay(100),h.Utils.isInput(document.activeElement););e&&await h.Utils.delay(e)}})(),this.setCurrentStep(0),this.initContainer(),this.nextStep(),this.render(),await this.setLSShownCounter()}getContainer(){return this.container}getState(){return this.state}getSegment(){return this.segment}setCurrentStep(e){this.currentStep=this.STEPS[e]}getCurrentStepIndex(){return this.currentStep?this.STEPS.indexOf(this.currentStep):this.STEPS.length}initStepControllerSubscriptions(){this.currentStep&&this.currentStep.subscribe(Ee,this.cancelEvaluation).subscribe(Ce,this.hanldeNextStepEvent).subscribe("hide-element",this.handleHideElement).subscribe("append-element",this.handleAppendElement)}async setLSShownCounter(){const e=F.m.get(De);if(e){const t=Number(e)+1;if(t>=2)return await Te.hideEvaluation(),void F.m.remove(De);F.m.set(De,t)}else F.m.set(De,1)}initModalStep(){this.currentStep&&(this.modal=new te.LD({destroyAfterHide:!0,hideOverlay:!this.currentStep.asModalMenu,content:this.currentStep.getContent(this.state),isBlockOverflowTouch:!1,isModalMenu:this.currentStep.asModalMenu,isPageScrollable:!1,isBottomWidget:!this.currentStep.asModalMenu,autoCloseOutsideClick:!1}),this.modal.show(),this.modal.content.addClass("popup__content_scrollable"),this.container=this.modal.content[0],this.currentStep.onMounted(this),i.core.ui.isPageScrollable=!this.currentStep.asModalMenu)}initContainer(){var e;!this.container&&this.containerSelector&&(this.container=document.createElement("div"),this.container.classList.add(Se.container),null===(e=document.querySelector(this.containerSelector))||void 0===e||e.append(this.container))}setContainerContent(e){var t,s,i,o;0===(null===(t=this.container)||void 0===t?void 0:t.children.length)?this.container.append(e):null===(i=this.container)||void 0===i||i.replaceChild(e,null===(o=this.container)||void 0===o?void 0:o.children[0]);null===(s=this.currentStep)||void 0===s||s.onMounted(this)}}var Re=s(36005);function Ne(e){var t,i="",o=Re.escape;Array.prototype.join;const r=s(12953).core;return i+='\n\n<div class="evaluation__content">\n    <h3 class="evaluation__title">'+(null==(t=e.title)?"":t)+'</h3>\n    <div class="evaluation__btn-group">\n        ',i+='\n            <button data-role="cancel">'+o(r.i18n("evaluation.btns.notNow"))+"</button>\n        ",i+='\n        <button class="button_success" data-role="next">'+o(r.i18n("evaluation.btns.poll"))+"</button>\n    </div>\n    ",i+="\n</div>"}var Be=s(36005);function Le(e){var t,i="",o=Be.escape;Array.prototype.join;const r=s(12953).core;return i+='\n\n<div class="evaluation__content rate-with-reasons-evaluation-step">\n\t<h3 class="evaluation__title">'+(null==(t=e.title)?"":t)+'</h3>\n\t<div class="evaluation-emoji evaluation__emoji">\n\t\t<ul class="evaluation__list">\n\t\t\t',Object.keys(e.options).reverse().forEach((function(s){i+='\n\t\t\t\t<li data-id="'+(null==(t=s)?"":t)+'" class="evaluation__list-item">'+(null==(t=e.options[s])?"":t)+"</li>\n\t\t\t"})),i+='\n\t\t</ul>\n\t</div>\n\t<div class="evaluation__btn-group evaluation__btn-group_full-width">\n\t\t<button data-role="cancel">'+o(r.i18n("evaluation.btns.close"))+"</button>\n\t</div>\n</div>\n"}var je=s(36005);function $e(e){var t,i="",o=je.escape;Array.prototype.join;const r=s(12953).core;return i+='\n\n<div class="evaluation__content final-thanks-evaluation-step">\n\t<h3 class="evaluation__title evaluation__title_center">'+(null==(t=r.i18n("evaluation.gratitude.title"))?"":t)+'</h3>\n\t<div class="evaluation__btn-group evaluation__btn-group_full-width">\n\t\t<button data-role="cancel">'+o(r.i18n("evaluation.btns.close"))+"</button>\n\t</div>\n</div>\n"}function Ue(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Fe extends xe{constructor(...e){super(...e),Ue(this,"templateData",{title:""})}setTitle(e){return this.templateData.title=e,this}initTemplate(){return super.initTemplate(this.templateData)}}function Ve(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class He extends xe{constructor(...e){super(...e),Ve(this,"title","")}setTitle(e){return this.title=e,this}async initEventListeners(e){var t;null===(t=this.els.cancelBtn)||void 0===t||t.addEventListener("click",(()=>{this.emitCancel()})),await Te.sendAnswer({questionId:e.questionId,answerId:e.currentId})}}function Ze(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class ze extends xe{constructor(...e){super(...e),Ze(this,"templateData",{options:[],title:""})}setTemplateData(e){return this.templateData=e,this}initTemplate(){return super.initTemplate(this.templateData)}initEventListeners(){var e,t;const s=null===(e=this.content)||void 0===e?void 0:e.querySelectorAll(".evaluation__list-item");null==s||s.forEach((e=>{e.addEventListener("click",(()=>{this.emitNextStep({currentId:Number(e.dataset.id)})}))})),null===(t=this.els.cancelBtn)||void 0===t||t.addEventListener("click",(()=>{this.emitCancel()}))}}function qe(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class We extends Me{constructor(...e){super(...e),qe(this,"STEPS",[]),qe(this,"question",null),qe(this,"initTimer",null),qe(this,"state",{questionId:0,currentId:0})}static getInstance(){return We.instance||(We.instance=new We)}init(){this.initTimer=setTimeout((async()=>{this.question=await Te.getEvaluationQuestion(),this.question&&this.question.question&&(this.initSteps(),super.init())}),3e5)}initSteps(){if(!this.question)return;this.state.questionId=this.question.id;const e=new Fe({getTemplate:Ne,addHideEvent:!0,addCloseParam:!0});e.setTitle(this.question.question);const t=new ze({getTemplate:Le,asModalMenu:!1,addHideEvent:!0,addCloseParam:!0});t.setTemplateData({title:this.question.question,options:this.question.answers});const s=new He({getTemplate:$e,autoCloseTS:3e3});s.setTitle(this.question.question),this.STEPS.push(e,t,s)}}var Ge=s(73736),Ye=s(87864);function Ke(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function Xe(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(s),!0).forEach((function(t){Je(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ke(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Je(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Qe=s(19755);class et extends r.u1{constructor(e){super(),o.Zv.isHTMLElement(e)&&(e=Qe(e)),e instanceof Qe&&(e={$el:e});const t=i.core.config("modules.feed-filter")||{},s=t&&t.displayMode?l.kc[t.displayMode]:l.kc.VISITED_STORIES_SHOW;if("profile"===i.core.initParams.pageName&&(t.feedKey="profile"),t.feedKey?this.searchParams=Xe({key:t.feedKey},t.feedParams):this.searchParams=Xe({twitmode:1,of:"v2"},t.feedParams),(0,c.extend)(this._options,{displayModeViewedStories:s,stories:new u.qg(!0),isAjaxLoadMode:i.core.initParams.isAjaxLoadMode,feedEngineVersion:t.feedKey?2:1,requestUrl:window.location.pathname,page:t.page||1,feedName:i.core.initParams.filterName,feedKey:t.feedKey||"",feedRecordId:"",isExpandedMode:i.core.initParams.isExpandedMode,isSubsMode:!1,hiddenStories:0}),this._analyticsInstance=O.c.getInstance(),(0,c.isObject)(e)&&this.setOptions(e),this._initAjaxLoadMode(),this._isUserHaveSubs=this.$el.data("has-subs"),this._showSubsStub=!1,this._viewObserver=new y(this),this._msgBtnIntersactionObserver=null,window.addEventListener("beforeunload",(()=>this._onBeforeUnload())),this.listenTo(i.core.ui,"beforeunload",this._saveBeforeUnload),this.listenTo(i.core.ui,"visibilitychange",(()=>this._windowVisibilityChange())),Ge.dV.addSessionCreationListener((()=>this._sessionRegenerated())),this.listenTo(i.core,"popup-modal-shown",(()=>{setTimeout((()=>{this.stories.items.forEach((e=>{e.onPopupShown()}))}))})),this.listenTo(i.core,"popup-modal-hidden",(()=>{this.stories.items.forEach((e=>{e.onPopupHidden()}))})),void 0===this.loadAnimationName&&(this.loadAnimationName="stories-spinner"),this._loadingAnimation=void 0,this._loadingAnimationBefore=void 0,this._headerHeight=i.core.ui.getHeaderHeight(),this._storiesInViewportThrottle=(0,c.throttle)((e=>{this._storiesInViewport(e)}),100,{leading:!1}),this._initSuggestDisableAdblockPopup(),this.listenToOnce(i.core.ui,"scroll",(()=>this._storiesInViewportThrottle())),this._initAuthModalExtended({mode:"start"}),i.core.ui.activeStoriesFeed=this,(0,he.m)(this,(e=>{e.isIntersecting&&(i.core.ui.activeStoriesFeed=this)})),t.extFeedUrl){const e=this;this._extFeed={sources:[{url:t.extFeedUrl,name:t.extFeedName,screen:"subs"===this.feedName?$.L.my_lent:$.L.new}],lastFeedPageMarker:!1,activeSourceIndex:0,clear(){this.activeSourceIndex=0,this.lastFeedPageMarker=!1},setNextSource(){this.hasNextSource&&(this.stories=[],this.activeSourceIndex++,this.activeSource.feedStartPos=e.storiesBefore.length+e.stories.size,this.activeSource.storiesLoaded=0)},get activeSource(){var e;return null!==(e=this.sources[this.activeSourceIndex-1])&&void 0!==e?e:null},get hasNextSource(){return this.activeSourceIndex<this.sources.length}}}v.V.isUserInExperiment(v.t.CONTENT_NPS)&&["hot","best","new"].includes(this.feedName)&&f.u.getInstance().setFeed(this),i.core.initParams.canShowSurvey&&We.getInstance().init()}_initAjaxLoadMode(){["story","story-preview","community-queue"].includes(this.feedName)&&(this._options.endOfFeed=!0,this._options.isAjaxLoadMode=!1),["quarantine-history","quarantine"].includes(this.feedName)&&(this._options.isAjaxLoadMode=!1)}_initSuggestDisableAdblockPopup(){v.V.isUserInExperiment(v.t.DISABLE_ADBLOCK_POPUP)&&le.getInstance()}_initAuthModalExtended(e={}){const{mode:t}=e;if(i.core.initParams.isDeleted&&"start"!==t)return void i.core.ui.authRequired();if(i.core.isUserAuthorized||!["hot","new","best"].includes(this.feedName))return void h.LocalStorage.remove(J.v);if("start"===t&&!h.LocalStorage.get(J.v))return;const s=i.core.initParams.oauthLogin||"",o=i.core.initParams.providerName||"",r=(0,K.B)({providerName:o,isDesktop:!0}),n={template:X.wK.createElement(r,"root",void 0,this),destroyAfterHide:!0,componentName:"feed_popup",showCloseIcon:!0},{UIAuthModal:a}=this.useRegistry(),l=new a(n),c={reason:"scroll",component_name:"popup"};if(h.LocalStorage.get(J.v)&&s)return l.showSignUpOauth({analyticsParams:c}),void h.LocalStorage.remove(J.v);"start"!==t&&(h.LocalStorage.get(J.p)||(l.showSignUp({analyticsParams:c}),h.LocalStorage.set(J.p,!0)))}_isLastStorySkeletonNeeded(){return!(this.isPaginationMode||this.$el.find("article").length<2||this.endOfFeed||d.ok.includes(this.feedName)||"related"===this.feedName&&i.core.isUserAuthorized||!this._extFeed&&"recommend"!==this.feedName&&this.el.hasAttribute("data-page-last")&&this.page===Math.max(1,parseInt(this.el.getAttribute("data-page-last"),10)||1)||!("search"!==this.feedName&&"community-search"!==this.feedName||this.$el.find(`.${d.wn}`).length))}_isNeedToImitateEndOfFeed(){const e=this.$el.find("article").length;return this.isAjaxLoadMode&&e>0&&e<4&&!this.endOfFeed}_getLastStory(){var e,t;return(null!==(e=this.$els)&&void 0!==e&&e.container?null===(t=this.$els)||void 0===t?void 0:t.container:this.$el.find(".stories-feed__container")).children("article").last()}_addClassLastStory(e){e.find("[id^=adfox]").length||e.hasClass(d.wn)||e.addClass(d.wn)}_addSkeleton(e){const t=e.find(".story__main");e.find("[id^=adfox]").length||t.children().hasClass(d.qC)||t.append((0,P.Z)({isMobile:!1}))}_removeLastStoryClassesAndSkeleton(e){if("cedit"===this.feedName)return void this._removeAllLastStory();const t=e.find(`.${d.qC}`);(e.hasClass(d.wn)||t.length)&&(e.removeClass(d.wn),t.remove(),D.c.getInstance().setTagsRow(e.get(0)))}_removeAllLastStory(){const e=Qe(`.${d.wn}`).toArray();e.length&&(e.forEach((e=>{Qe(e).removeClass(d.wn),Qe(e).find(`.${d.qC}`).remove(),D.c.getInstance().setTagsRow(e)})),this._lastStory=null)}_addObserverToPreloader(e){if(!I.v)return;new IntersectionObserver(((t,s)=>{t.forEach((t=>{t.isIntersecting&&(setTimeout((()=>{this._removeLastStoryClassesAndSkeleton(e)}),d.qn),s.unobserve(t.target))}))}),{threshold:1}).observe(e[0])}render(){if(this.isRendered)return this;if(this.els={storiesCounter:document.querySelector(".stories-search__feed-panel > span")},this._addLastStorySkeleton(),i.core.ua.ios){this._currentScrolling=!1;let e=!1,t=!1;window.document.addEventListener("touchstart",(()=>{this._currentScrolling=e=!0}));const s=()=>{e||t||(this._currentScrolling=!1,this.emit("stop-scrolling"))};window.document.addEventListener("touchend",(()=>{e=!1,s()}));const i=(0,S.D)((()=>{t=!1,s()}),500);window.document.addEventListener("scroll",(()=>{t=!0,i()}))}return this._loadFeedCarousel(),this.isAjaxLoadMode&&i.core.ui.elementWillSoonScrolled(this.el)&&!this.$els.messageSubs.is(":visible")&&this._onDocumentEnd(),super.render(),this}_sessionRegenerated(){this.stories.items.forEach((e=>{e.onSessionRegenerated()}))}_windowVisibilityChange(){const e="visible"===document.visibilityState;this.stories.items.forEach((t=>{t.onWindowFocusChanged(e)}))}_onBeforeUnload(){this.stories.items.forEach((e=>{e._onStoryBeforeUnload()}))}_attachTools(){const{storyStyle:e}=this.useRegistry();this.$el.on("click",".story__rating-plus",this._onToolClick.bind(this,this._voteStory,[w.STORY_VOTE.UP,!0])),this.$el.on("click","."+e.rating.down,this._onToolClick.bind(this,this._voteStory,[w.STORY_VOTE.DOWN,!0])),this.$el.on("click","."+e.collapseButton.button,this._onToolClick.bind(this,this._collapseStory)),this.$el.on("click","."+e.readMore.button,this._onToolClick.bind(this,this._readMore)),this.$el.on("click","."+e.similarBlock,this._onToolClick.bind(this,this._showSimilarStories)),this.$el.on("click",".b-story__show-all",(e=>{e.preventDefault(),Qe(e.currentTarget).hide().prev().css("max-height","").find(".b-story-blocks__hide-wrapper").show()})),this.$el.on("click","."+e.title.el,(t=>{if(t.target.matches("a")||!t.target.classList.contains(e.title.el))return;const s=t.currentTarget.querySelector("a");s&&s.click()})),this.listenTo(i.core,"ui-calendar-feed-popup:submit",(()=>this.$els.loadingBefore.hide()));return this.$el.on("click",".story__emotions",(e=>{const t=this.stories.get(et.getStoryIdByElement(e.target));t&&(t.emotions.popup.target=t.emotions.el,t.emotions.popup.toggle())})),this}_getOptionsFromData(){var e,t;let s,i=this.el.getAttribute("data-page-current");var o,r;i||(s=null===(o=document.querySelector(".stories-feed"))||void 0===o?void 0:o.dataset,i=(null===(r=s)||void 0===r?void 0:r.pageCurrent)||1);let n=this.el.getAttribute("data-feed-key");if(n&&(this.feedKey=n),this.page=Math.max(1,parseInt(i,10)||1),this.el.hasAttribute("data-subs-sort")&&(this._options.isSubsMode=!0),"true"===this.el.getAttribute("data-pagination-mode")||"true"===(null===(e=s)||void 0===e?void 0:e.paginationMode))this._options.isAjaxLoadMode=!1,this._options.lastPage=Math.max(1,parseInt(this.el.getAttribute("data-page-last"),10)||1);else if(this.el.hasAttribute("data-page-last")){const e=Math.max(1,parseInt(this.el.getAttribute("data-page-last"),10)||1);var a;if(this.page===e)this._sendAnalyticsOnEndOfFeed(),null!==(a=this._extFeed)&&void 0!==a&&a.hasNextSource?this._extFeed.lastFeedPageMarker=!0:this.endOfFeed=!0}this.endOfFeed||!this.$els.message.length||!this.$els.message.hasClass(k.F.message.show)||null!==(t=this._extFeed)&&void 0!==t&&t.hasNextSource||(this.endOfFeed=!0,this._sendAnalyticsOnEndOfFeed())}_saveBeforeUnload(){this.viewObserver.forceSave()}_detectNeedScrolling(){let e=i.core.history.searchParams.get("scrollto");return e?"first"===e?this.stories.firstId():this.stories.lastId():0}initLazyLoad(){i.core.emit(x.Tu),C.z.getInstance().init()}parseResponse(e,t){var s,o,r;if(!e.result)throw this._removeAllLastStory(),i.core.logger.error("feed","something went wrong"),Error();null!==(s=this._extFeed)&&void 0!==s&&s.activeSource&&(this._extFeed.activeSource.storiesLoaded+=t.stories.length,t.stories=t.stories.filter((e=>!this.stories.hasById(e.id))),t.title=null,delete t.menu_caption);const n=t.is_feed_overflow||"cedit"!==this.feedName&&t.total>0&&(!(null!==(o=this._extFeed)&&void 0!==o&&o.activeSource)&&this.stories.size+this.storiesBefore.length+t.stories.length>=t.total||(null===(r=this._extFeed)||void 0===r?void 0:r.activeSource)&&this._extFeed.activeSource.storiesLoaded>=t.total),a=!(0,c.isArray)(t.stories)||0===t.stories.length,l=this.isPaginationMode&&!a&&this.page===this._options.lastPage-1;this._showSubsStub=!t.stories.length,t.title&&this._updateTitle(t.title),t.hasOwnProperty("menu_caption")&&this._updateMenuCaption(t.menu_caption),t.hasOwnProperty("no_stories_caption")&&this.$els.message.html(t.no_stories_caption),t&&void 0!==t.has_subscription&&(this._isUserHaveSubs=Boolean(t.has_subscription)),t&&void 0!==t.hidden_stories_count&&t.hidden_stories_count>0&&(this.hiddenStories=t.hidden_stories_count),this.emit("loaded",t,a||n);return{isEndOfFeed:a||n||l,stories:a?[]:this.parseStoriesFromResponse(t),linkingTagBlock:(null==t?void 0:t.linking_tag_block)||""}}parseStoriesFromResponse(e){const t=[],s=this.storiesViewed,o=this.displayModeViewedStories===l.kc.VISITED_STORIES_HIDE,r="visited"===this.feedName;for(let l=0,c=e.stories.length;l<c;l++){var n;const a=e.stories[l],c=Number(a.id);!(this.stories.hasById(c)||this.storiesBefore.includes(c)||this.storiesAfter.includes(c))||r||null!==(n=this._extFeed)&&void 0!==n&&n.activeSource?o&&s.includes(c)&&!r&&1===this._options.feedEngineVersion?(i.core.logger.error("feed","duplication story by localStorage",i.core.history.path),i.core.logger.info("feed","duplication story by localStorage",c)):t.push(a.html):(i.core.logger.error("feed","duplication story by page",i.core.history.path),i.core.logger.info("feed","duplication story by page",c))}if(t.length<5||!Array.isArray(e.adverts)||!e.adverts.length)return t;const a=this.advertsViewed.reverse();for(let l=0,d=e.adverts.length;l<d;l++){const r=e.adverts[l],n=(0,c.isFinite)(r.id)?Number(r.id):0;if(n){if(this.stories.hasById(n)||this.storiesBefore.includes(n)||this.storiesAfter.includes(n)){i.core.logger.error("feed","duplication advert by page");continue}if(("related"!==this.feedName||this.page>1)&&(o&&s.includes(n)||a.includes(n))){i.core.logger.error("feed","duplication advert by localStorage");continue}a.unshift(n)}"before"===r.position?t.unshift(r.html):Number.isFinite(parseInt(r.position))?t.splice(r.position,0,r.html):(t.push(r.html),this.isPaginationMode||([t[t.length-1],t[t.length-2]]=[t[t.length-2],t[t.length-1]]))}return this.advertsViewed=a,t}toggleFooter(e){var t;null!==(t=this.$els.footer)&&void 0!==t&&t.length&&this.$els.footer.toggleClass("footer_show",e)}_sendAnalyticsOnEndOfFeed(){const e=this._isSubsModeAndNoHiddenStories()?this.$els.messageSubs.find('[data-type="empty"]'):this.$els.message,t=e.get(0);i.core.ui.getHeaderHeight();if(this.toggleFooter(!0),t&&I.v&&!this._msgBtnIntersactionObserver){const s=["read_all_posts","more_votes_advice"];this._msgBtnIntersactionObserver=new IntersectionObserver((i=>{if(i.some((e=>e.isIntersecting))){const i=e.data("type"),o=s.includes(i)?i:"read_all_posts";this._analyticsInstance.sendEvent("reach_element",{type:o}),this._msgBtnIntersactionObserver.unobserve(t),"read_all_posts"===o&&["hot","best"].includes(this.feedName)&&M.DT.sendEvent("end")}}),{rootMargin:"0px",threshold:0}),t&&this._msgBtnIntersactionObserver.observe(t)}}_initFeedSeparatorObserver(){if(this._isEndOfMainFeedEventSent)return;if(!this._feedSeparatorObserver){const e="0px";this._feedSeparatorObserver=new IntersectionObserver((e=>{if(e.some((e=>e.isIntersecting))){const e="read_all_posts";this._analyticsInstance.sendEvent("reach_element",{type:e}),this._feedSeparatorObserver.disconnect(),this._isEndOfMainFeedEventSent=!0}}),{rootMargin:e,threshold:0})}const e=this.el.querySelector(".feed-separator");this._feedSeparatorObserver.observe(e)}_markExtFeedStories(e,t,s=0,i=1/0){const o=Array.from(e.querySelectorAll(".story"));for(let r=s;r<o.length&&r<=i;r++){o[r].dataset.extFeed=$.L[t]}}_getExtFeedSeparator(e){return`<div class="section-hr feed-separator" data-role="ext-feed">\n\t\t\t\t\t<div class="section-hr__title">\n\t\t\t\t\t\t${(0,n.t)("ui__approve_20")}\n\t\t\t\t\t\t<span>Всё прочитано</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<p class="section-hr__text">${e}</p>\n\t\t\t</div>`}_sendAnalyticsOnLoadStoriesStarted(e){const t=e=>requestIdleCallback(e,{timeout:1e3});t((()=>this._analyticsInstance.yandex.goal("load_more_posts",{page:e}))),"related"!==this.feedName&&(t((()=>this._analyticsInstance.yandex.hit(`?page=${e}`))),t((()=>this._analyticsInstance.google.pageView())))}_sendAnalyticsOnLoadStoriesEnd(e,t){this._analyticsInstance.sendEvent("post_batch_load",Xe({view_time:(Date.now()-e)/1e3,feed_name:this.feedName},t&&{screen_index:t})),this.endOfFeed&&this._sendAnalyticsOnEndOfFeed()}async loadStories(e=!0){var t,s,r,n;if(this.endOfFeed||this.loadAnimation||this.loadAnimationBefore||this.marks.has("requestDelay"))return!1;if(this.isSubsMode&&!i.core.isUserAuthorized)return this._showSubsStub=!0,void(this.endOfFeed=!0);e||this.page||this.showSkeletonLoader();const c=0===this.stories.items.length&&1===this.page,u=this.requestId,_=Date.now(),m=(null===(t=this.stories.items.find((e=>e.inViewportForAnalytics)))||void 0===t?void 0:t.screenIndex)||c&&1||void 0;if(this.marks.has("requestLastStart")){let e=this.marks.get("requestLastStart"),t=_-e;if(e&&t<5e3){if(this.marks.set("requestDelay",!0),await h.Utils.delay(t),this.marks.delete("requestDelay"),this.requestId!==u)return!1;if(!i.core.ui.elementWillSoonScrolled(this.el))return this.loadAnimation=!1,!1}}this.marks.set("requestLastStart",_);let g=this.page||1;e&&!c&&g++;let f=!1;if(null!==(s=this._extFeed)&&void 0!==s&&s.lastFeedPageMarker){var y;if(!this._extFeed.hasNextSource)return void(this.endOfFeed=!0);null!==(y=this._extFeed)&&void 0!==y&&y.activeSource||1!==this.page||this._isLastStorySkeletonNeeded()||this._createLoadAnimation(!0),this._extFeed.lastFeedPageMarker=!1,this._extFeed.setNextSource(),f=!0,g=this.page=1,this.searchParams.delete("key")}let b=!["search","community-search","profile-search","visited"].includes(this.feedName)||g>1;if(b&&"subs-stories"!==i.core.initParams.pageName&&(this.loadAnimation=!0),this._sendAnalyticsOnLoadStoriesStarted(g),this.displayModeViewedStories===l.kc.VISITED_STORIES_HIDE&&this.viewObserver){const e=this.viewObserver.extractUnsavedIds();e.length&&this.searchParams.set("vnbuff",JSON.stringify(e))}const w=new a._(window.location.search).get("f");w&&this.searchParams.set("f",w),this.searchParams.set("page",g);let k=this.requestUrl;var S;this._options.feedEngineVersion>1&&(k="/ajax"+k,null!==(S=this._extFeed)&&void 0!==S&&S.activeSource&&(k=this._extFeed.activeSource.url));const{response:O,data:E}=await p.cf.post(k,this.searchParams,{cache:!1});if(b){let e=Date.now()-_;e<1e3&&await h.Utils.delay(1e3-e)}if(this.requestId!==u)return!1;let C,x,T;try{const e=this.parseResponse(O,E);C=e.stories,x=e.isEndOfFeed,T=e.linkingTagBlock}catch(A){return i.core.logger.error("stories-feed","some problem with load stories",O),!1}if(x&&null!==(r=this._extFeed)&&void 0!==r&&r.hasNextSource){if(x=!1,this._extFeed.lastFeedPageMarker=!0,f&&0===C.length)return this.abortLoadStories(),this.loadStories();this._onDocumentEnd()}var I;null!==(n=this._extFeed)&&void 0!==n&&n.activeSource&&this._loadingAnimation&&(null===(I=this._loadingAnimation)||void 0===I||I.destroy(),this._loadingAnimation=null);if(this.endOfFeed=x,this._options.feedEngineVersion>1&&E.key&&E.key!==this.feedKey&&(this.feedKey=E.key),this.hideSkeletonLoader(),Array.isArray(C)&&C.length>0){var P;this._removeAllLastStory(),f&&(this.$els.container.append(this._getExtFeedSeparator(this._extFeed.activeSource.name)),this._initFeedSeparatorObserver());const e=o.Zv.fragment(C.join(""));if(null!==(P=this._extFeed)&&void 0!==P&&P.activeSource&&this._markExtFeedStories(e,this._extFeed.activeSource.screen),6===g&&"companies"!==this.feedName&&v.V.isUserInExperiment(v.t.SPECIALS_FEED_POST_BANNER,"B")&&await(new _e.F).showStoryButton(e.querySelector(".story")),i.core.ui.attachSubscribeButtons(e),this.$els.container.append(e),i.core.logger.log("feed","loadStories"),"BroadcastChannel"in window&&new BroadcastChannel("ad").postMessage("update"),setTimeout((()=>this.initStories())),C.length>1&&2===this.page&&!i.core.isUserAuthorized){const e=new IntersectionObserver((t=>{t.forEach((t=>{var s;t.isIntersecting&&(this._initAuthModalExtended(),e.unobserve(null===(s=this.stories.items[this.stories.items.length-5])||void 0===s?void 0:s.el))}))}),{threshold:.5});setTimeout((()=>{var t;e.observe(null===(t=this.stories.items[this.stories.items.length-5])||void 0===t?void 0:t.el)}))}this._addLastStorySkeleton(),"cedit"!==this.feedName&&setTimeout((()=>{try{this._hideSuperfluousStories(!0)}catch(e){i.core.logger.error("stories-feed","some problem with hide superfluous stories",e)}})),this.assignScreenIndex()}else"subs"===this.feedName||this._isLastStorySkeletonNeeded()||this._removeAllLastStory();if(E&&void 0!==E.paginator&&(this.$els.pagination&&this.$els.pagination.length&&this.$els.pagination.remove(),E.hidden_stories_count!==E.total&&(this.$els.pagination=Qe(E.paginator).insertAfter(this.$el))),Number.isFinite(E.page)?this.page=E.page:(e||1===g)&&(this.page=g),setTimeout((()=>{v.V.isUserInExperiment(v.t.BROWSING_PAGE_V2)&&this.stories.size>d.VE&&"hot"===this.feedName&&this._initBrowsingBlock(this.stories.items[8].el)})),this.els.storiesCounter){const e=i.core.i18n("^page-search.stories('%0')",E.total);this.els.storiesCounter.innerText=`${E.total} ${e}`}return this.loadAnimation=!1,T&&2===this.page&&setTimeout((()=>this._loadLinkingTagBlock(T))),setTimeout((()=>this._loadFeedCarousel())),this._sendAnalyticsOnLoadStoriesEnd(_,m),!0}assignScreenIndex(){if("story"===this.feedName)return;const e=this.storiesBefore.length;this.stories.items.forEach(((t,s)=>{t.screenIndex=e+s+1}))}async loadStoriesByIds(e,t=!0){if(this.loadAnimation||this.loadAnimationBefore||this.marks.has("requestByIdsDelay"))return!1;const s=[],r=[];var n;if(!e&&(e=t?this.storiesBefore.length>d.q1+10?this.storiesBefore.splice(-d.q1):this.storiesBefore.splice(0,this.storiesBefore.length):this.storiesAfter.length>d.q1+10?this.storiesAfter.splice(0,d.q1):this.storiesAfter.splice(0,this.storiesAfter.length),null!==(n=this._extFeed)&&void 0!==n&&n.activeSource)){let i=this.storiesBefore.length;t||(i+=this.stories.size);for(let t=this._extFeed.activeSourceIndex-1;t>=0;t--){const o=this._extFeed.sources[t],n=o.feedStartPos,a=o.feedStartPos+o.storiesLoaded;if(i+e.length>n&&a>=i){const t=Math.max(0,n-i),s=Math.min(e.length,a-i)-1;r.push({source:o,from:t,to:s})}i+e.length>n&&i<=n&&s.push({source:o,pos:n-i})}}if(!e.length)return!1;i.core.logger.info("stories-feed","load ids",e,"append",t?"before":"after");const a=this.requestIdByIds,l=Date.now();let u=i.core.ui.scrollTop-this.stories.get(this.navigationStoryId).offsetTop;if(t?(this.isPageScrollable=!1,this.loadAnimationBefore=!0,this.scrollTo(this.stories.get(this.navigationStoryId).offsetTop+u),this.isPageScrollable=!0):this.loadAnimation=!0,this.marks.has("requestByIdsLastStart")){let e=this.marks.get("requestByIdsLastStart"),t=l-e;if(e&&t<1e3&&(this.marks.set("requestByIdsDelay",!0),await h.Utils.delay(t),this.marks.delete("requestByIdsDelay"),this.requestIdByIds!==a))return!1}this.marks.set("requestByIdsLastStart",l);const{stories:p}=await this.loadSpecificStories(e);if(await h.Utils.delay(1e3-(Date.now()-l)),this.requestIdByIds!==a||!p.length)return!1;for(let i=0;i<p.length;i++)p[i].html=p[i].html.replace(d.wn,"");const _=this.parseStoriesFromResponse({stories:p});if((0,c.isArray)(_)&&_.length){this._hideSuperfluousStories(!t),s.forEach((({source:e,pos:t})=>{_.splice(t,0,this._getExtFeedSeparator(e.name))}));const e=o.Zv.fragment(_.join(""));r.forEach((({source:t,from:s,to:i})=>{this._markExtFeedStories(e,t.screen,s,i)})),t?(this.isPageScrollable=!1,u=i.core.ui.scrollTop-this.stories.get(this.navigationStoryId).offsetTop,this.$els.container.prepend(e),this.scrollTo(this.stories.get(this.navigationStoryId).offsetTop+u),this.isPageScrollable=!0):(this._removeAllLastStory(),this.$els.container.append(e)),s.length&&this._initFeedSeparatorObserver(),setTimeout((()=>this.initStories())),this._addLastStorySkeleton()}return t?this.loadAnimationBefore=!1:this.loadAnimation=!1,!0}_updateTitle(e){}_updateMenuCaption(e){}_hideSuperfluousStories(e=!0){const t=(e?this.amountStoriesBefore:this.amountStoriesAfter)-10;if(t<10)return;const s=e?0:-t,i=e?t:void 0,o=this.stories.items.slice(s,i);if(!o.length)return;const r=this._getPlayingVideoPostID();if(r>0&&o.some((e=>e.id===r)))return;const n=this.navigationStoryId,a=this.stories.items[e?t:this.stories.items.length-t-1];if(e&&a instanceof w.Story){const e=a.offsetTop-this.$els.container.get(0).offsetTop-this.$els.loadingBefore.height()-15,t=Qe(`<div style="height: ${e}px"></div>`).insertAfter(a.$el),s=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&(this.scrollTo(t.offset().top),s.unobserve(t.get(0)),s.disconnect(),t.remove())}))}));s.observe(t.get(0))}const l=a.$el.get(0),c=e?"previousSibling":"nextSibling";for(;l[c];)l[c].remove();const d=o.map((e=>e.id));e?this.storiesBefore.push(...d):this.storiesAfter.unshift(...d),this.stories.remove(d),this.$els.loadingBefore.toggle(this.storiesBefore.length>0),this.navigationStoryId=n}abortLoadStories(){return this.loadAnimation=!1,this.loadAnimationBefore=!1,delete this._options.requestId,delete this._options.requestIdByIds,this.marks.delete("requestLastStart"),this.marks.delete("requestDelay"),this}async loadSpecificStories(e,t="",s){const{response:o,data:r}=await p.cf.post("/ajax/stories_actions.php",{action:"load_stories",ids:e,page:s,filterName:t,feed_mode:this.feedName});o.result||(i.core.ui.toasts.showError(),i.core.logger.error("feed",o.message));const{stories:n=[],adverts:a=[]}=r||{};return{stories:n,adverts:a}}clear(){var e;return this.viewObserver.update(!0),this.abortLoadStories(),this.page=0,this.stories.clear(),this.hiddenStoriesVisibility=!1,this.$els.container.empty(),this.$els.pagination.length&&this.$els.pagination.hide(),this.$els.loadingBefore&&this.$els.loadingBefore.length&&this.$els.loadingBefore.hide(),this.feedKey="",this.navigationStoryId=0,this.endOfFeed=!1,delete this._options.storiesAfter,delete this._options.storiesBefore,null===(e=this._extFeed)||void 0===e||e.clear(),this}_onDocumentEnd(e=!0){this.marks.has("scrolling")||(this._onDocumentEndThrottle||(this._onDocumentEndThrottle=(0,c.throttle)((()=>{if(!(this.$el.is(":visible")&&this.isShown||"related"===this.feedName))return;i.core.ua.firefox&&!1&&document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur(),this.storiesAfter.length?this.loadStoriesByIds(null,!1):this.loadStories(e)}),100)),this._onDocumentEndThrottle())}_storiesInViewport(e){return this}_attachScroll(){return this.listenTo(i.core.ui,"document-scroll",this._feedScrolling),this.listenTo(i.core.ui,"orientationchange",this._onOrientationChange),this}_feedScrolling(e){return this.marks.has("scrolling")||(this._storiesInViewportThrottle(e),this.isAjaxLoadMode&&i.core.ui.elementWillSoonScrolled(this.el)&&this._onDocumentEnd()),this}async _onOrientationChange(){!this.stories.size||this.focused}initStories(){return this}_initStoriesCommon(e){setTimeout((()=>{i.core.ui.player.init(this.$els.container,{context:{isPreview:"story-preview"===this.feedName}})}));let t=(0,c.map)(this.$els.container.find(`> .${e.item}`),(e=>{let t=parseInt(e.getAttribute("data-story-id"),10),s=e.getAttribute("data-vid"),i=new Date(1e3*e.getAttribute("data-timestamp")),o=!!s&&s.charCodeAt(0)-65<=i.getUTCHours();if(this.useEmptyIds||!isNaN(t)&&0!==t&&!o)return this.stories.hasById(t)?this.stories.get(t):new this.stories.DataObject(t,e,this.referrerStoryId);Q.Q.instance.watch(e,ee.L.FEED)}));return this.stories.set(t,{uniq:!0}),!this.stories.size||this.navigationStoryId&&this.stories.hasById(this.navigationStoryId)||(this.navigationStoryId=this.mouseStoryId=0),this.initLazyLoad(),this._initStats(),this.assignScreenIndex(),this}collapsedViewedStories(e){return this.stories.items.forEach((t=>{t.isVisited&&(t.isCollapsed=e)})),this._storiesInViewport(),this}removeBoundaryAdBlocks(e){let t=this.$el.find(".story");if(e){let e=0,s=0;for(;e<10&&s<t.length;){const i=t[s],o=parseInt(i.dataset.storyId||0,10);this.stories.has(o)?e++:i.remove(),s++}return}const s=this.stories.lastId();s?this.stories.get(s).$el.nextAll(".story").remove():this.$el.find(".story").remove()}static getStoryIdByElement(e){const{storyStyle:t}=E.S.getInstance().get();if(!o.Zv.isHTMLElement(e))throw new Error("expected HTMLElement");const s=e.closest(`.${t.item}`);return s?parseInt(s.getAttribute("data-story-id")||0,10):null}_voteStory(e,t,s=!1){return i.core.isUserAuthorized?i.core.isLostAccount?(i.core.ui.toasts.showWarningMessage(i.ZF.LOST_ACCOUNT),this):e?(e.voteDirection(t,s),this.viewObserver.setVisit(e),this):this:(setTimeout((()=>{var s;i.core.ui.authRequired({analyticsParams:{reason:t===w.STORY_VOTE.UP?"plus":"minus",author_id:e.authorId,post_id:e.id,"community_id!empty":null===(s=e.el.dataset)||void 0===s?void 0:s.communityId,screen_index:e.screenIndex,"rating!empty":e.rating}}),O.c.getInstance().sendEvent("click",{type:"post_rate",user_rate:t.value,post_id:e.id})})),this)}async _collapseStory(e,t){return e?((t="boolean"==typeof t?t:!e.isCollapsed)?(e.offsetTop-i.core.ui.scrollTop<0&&(e.highlight("yellow",!0,!0),await this.scrollTo(e.offsetTop-10,!1)),this.isExpandedMode&&this.viewObserver.setVisit(e)):this.isExpandedMode||(this.navigationStoryId=e.id),e.isCollapsed=t,t||this.isExpandedMode||this.viewObserver.setVisit(e),t||"cedit"!==this.feedName||D.c.getInstance().setTagsRow(e.el),this):this}changeStory(e){if(e=Number(e),!this.stories.hasById(e))return this;if(this.navigationStoryId&&this.navigationStoryId!==e){let e=this.stories.get(this.navigationStoryId);e&&(this.isExpandedMode?i.core.ui.player.stop(e.$el):e.isCollapsed=!0,e.scrollMode=!1)}const t=this.stories.get(e);t.setCurrentPlayer(),t.isCollapsed=!1,this.isExpandedMode||this.viewObserver.setVisit(t),this.navigationStoryId=this.mouseStoryId=e,this.amountStoriesAfter<4&&this.isAjaxLoadMode&&this._onDocumentEnd()}async scrollToStory(e,t=600){let s=5;const o=e instanceof w.Story?e:this.stories.get(e);if(o){this.marks.set("scrolling",!0);do{await i.core.ui.scrollTo(o.offsetTop-20,!1),await h.Utils.delay(t);const e=i.core.ui.scrollTop,s=o.offsetTop;if(h.Utils.equalNumbers(e,s,50))break}while(s--);this.marks.delete("scrolling")}}_showRestoreMessage(e){return e&&!this._restoreBox&&(this._restoreBox=new o.LD({indent:!0,autoCloseOutsideClick:!1,autoClosePressEscape:!1}),this._restoreAnimation=i.core.ui.player.createAnimation("stories-restore",{$parent:this._restoreBox.content})),e?(this._restoreBox.show(),this._restoreBox.$els.container.addClass("popup__container_transparent"),this._restoreAnimation.play(),this.marks.set("scrolling",!0),this):(this._restoreAnimation.stop(),this._restoreBox.hide(),this.marks.delete("scrolling"),this)}_isSubsModeAndNoHiddenStories(){return this.isSubsMode&&this.$els.messageSubs.length&&this._showSubsStub&&!this.hiddenStories}_updateEndOfFeed(e){return this._removeAllLastStory(),this._isSubsModeAndNoHiddenStories()?(this.$els.messageSubs.toggle(e).find("."+k.F.messageSubs.innerBlock).hide().filter(`[data-type="${this._isUserHaveSubs?"empty":"no-subs"}"]`).show(),this.$els.message.hide(),this):(this.$els.messageSubs.hide(),this.$els.message.toggle(e),this)}_createLoadAnimation(e=!1){return this.$els.spinner.length&&("cedit-feed"===i.core.initParams.pageName||e)&&this.loadAnimationName?(this._loadingAnimation&&this._loadingAnimation.destroy(),this._loadingAnimation=i.core.ui.player.createAnimation(this.loadAnimationName,{$parent:this.$els.spinner}),this):this}_createLoadAnimationBefore(){const e=this.loadAnimationName;return this.$els.spinnerBefore.length&&e&&(this._loadingAnimationBefore&&this._loadingAnimationBefore.destroy(),this._loadingAnimationBefore=i.core.ui.player.createAnimation(e,{$parent:this.$els.spinnerBefore})),this}_getPlayingVideoPostID(){let e=(0,c.find)(Qe('.player[data-type="video"]'),(e=>{let t=b.XM.getPlayerFromElement(e);return t&&t.isPlayed}));return e?Number(e.dataset.storyId):0}_initStats(){const{storyStyle:e}=E.S.getInstance().get(),t=this._mapStoryElementForStats=this._mapStoryElementForStats||new WeakMap;this.stories.items.filter((s=>!s.$viewedCount.hasClass(e.viewed.loaded)&&!t.has(s))).forEach((e=>{t.set(e.el,e),this.intersectionObserverStats.observe(e.el)}))}async _initBrowsingBlock(e){if(this._browsingBlockInserted)return;this._browsingBlockInserted=!0;const{createApp:t}=await s(94450);await(0,h.yieldToMain)();const i=document.createElement("div");e.insertAdjacentElement("afterend",i),await t().mount(i)}get intersectionObserverStats(){if(this._intersectionObserverStats)return this._intersectionObserverStats;const e=(0,c.throttle)((e=>{M.DT.sendEvent("read100",{ids:[e]})}),1e3),t=this._mapStoryElementForStats=this._mapStoryElementForStats||new WeakMap;return this._intersectionObserverStats=new IntersectionObserver((s=>{s.forEach((s=>{if(!s.isIntersecting)return;const i=t.get(s.target);i&&!i.isDestroyed&&(this._intersectionObserverStats.unobserve(s.target),this._loadStats(i),"subs"===this.feedName&&e(i.id))}))}))}_loadStats(e){e&&(e.id?(e.$viewedCount.addClass("anim-on"),m.N.getViewAndEmotionsCount({storyId:e.id,authorId:e.authorId,isSubscribed:e.isSubscribed}).then((t=>{var s,i;this.isDestroyed||e.isDestroyed||(e.viewedCount=Number(t.views[0]),null===(s=e.emotions)||void 0===s||null===(i=s.updateEmotionsCounters)||void 0===i||i.call(s,t.emotions),e.$viewedCount.removeClass("anim-on"))}))):e.viewedCount=0)}_addLastStorySkeleton(){this._isNeedToImitateEndOfFeed()&&this._onDocumentEnd(),this._isLastStorySkeletonNeeded()?(this._lastStory=this._getLastStory(),this._lastStory.hasClass(d.wn)||this._addClassLastStory(this._lastStory),this._addSkeleton(this._lastStory),this._isNeedToImitateEndOfFeed()&&this._onDocumentEnd(),this._addObserverToPreloader(this._lastStory)):this._removeAllLastStory()}_loadLinkingTagBlock(e){var t;if(!e||"search"!==this.feedName)return;const s=null===(t=this.stories.items[14])||void 0===t?void 0:t.el;s&&s.insertAdjacentHTML("afterend",e)}_loadFeedCarousel(){1===this.page&&("search"!==this.feedName&&(this._feedCarousel=new Y(this.feedName,this.stories)))}async _sendReadMoreEvent(e){O.c.getInstance().sendEvent("click_show_full_post",Xe(Xe(Xe({},e.analyticsData),{},{user_rate:1},void 0!==e.relevanceCoefficient&&{rec_score:e.relevanceCoefficient}),e.recommendationAlgorithm>0&&{rec_algorithm:e.recommendationAlgorithm}));const{response:t}=await p.cf.post("/ajax.php",{route:"user/evf",s:e.id,u:e.authorId,is:e.isSubscribed?1:0});t.result||i.core.logger.error("stories-feed","some problem with full view event registration")}initModerationSpecialTags(e){new pe(e)}showSkeletonLoader(){const e=(0,Ye.m)((0,A.Z)());e.classList.add("section","is-active","anim-on"),this.$els.container.append(e);{const t=i.core.ui.$els.sidebar.innerHeight();let s=0;for(;t>=s+e.offsetHeight;)this.$els.container.append(e.cloneNode(!0)),s=i.core.ui.$els.main.innerHeight()}this._analyticsInstance.sendEvent("loader_showed",{})}hideSkeletonLoader(){this.$els.container.find(`.${d.qC}`).remove()}get requestId(){return this._options.requestId?this._options.requestId:this._options.requestId=Symbol("feedRequestId")}get requestIdByIds(){return this._options.requestIdByIds?this._options.requestIdByIds:this._options.requestIdByIds=Symbol("feedRequestIdByIds")}get navigationStoryId(){return this._options.navigationStoryId}set navigationStoryId(e){if(e="number"==typeof e?e:parseInt(e,10),this.navigationStoryId===e)return this.navigationStoryId;if(e&&this.stories.size){let t=this.stories.ids.indexOf(e);this._options.amountStoriesBefore=t,this._options.amountStoriesAfter=this.stories.ids.length-t}else this._options.amountStoriesBefore=this._options.amountStoriesAfter=0;return i.core.logger.log("stories-feed","current navigation id",e),this._options.navigationStoryId=e}get amountStoriesBefore(){return this._options.amountStoriesBefore}get amountStoriesAfter(){return this._options.amountStoriesAfter}get mouseStoryId(){return this._options.mouseStoryId}set mouseStoryId(e){return e="number"==typeof e?e:parseInt(e,10),this.mouseStoryId===e?this.mouseStoryId:(i.core.logger.log("stories-feed","current mouse id",e),this._options.mouseStoryId=e)}get page(){return this._options.page}set page(e){this._options.page="number"==typeof e?e:parseInt(e,10)}get feedKey(){return this._options.feedKey}set feedKey(e){this._options.feedKey=String(e),this._options.feedEngineVersion>1&&(this.searchParams.delete("twitmod"),this.searchParams.delete("of"),this.searchParams.set("key",this._options.feedKey))}get requestUrl(){return this._options.requestUrl}set requestUrl(e){this._options.requestUrl=String(e)}get searchParams(){return this._options.searchParams||(this._options.searchParams=new a._),this._options.searchParams}set searchParams(e){if(e instanceof a._)return this._options.searchParams=e;let t=this.searchParams;if("string"==typeof e)return t.fromParamsString(e);if("object"==typeof e&&!Array.isArray(e))return t.clear(),(0,c.forEach)(e,((e,s)=>t.set(s,e))),t;throw new Error("Bad query value")}get endOfFeed(){return this._options.endOfFeed}set endOfFeed(e){this._options.endOfFeed!==(e=Boolean(e))&&(this._options.endOfFeed=e,this._updateEndOfFeed(e))}get stories(){return this._options.stories}get isAjaxLoadMode(){return this._options.isAjaxLoadMode}get isPaginationMode(){return!this._options.isAjaxLoadMode}get viewObserver(){return this._viewObserver}get loadAnimationName(){return this._options.loadAnimationName}set loadAnimationName(e){this._options.loadAnimationName!==(e=(0,c.isBoolean)(e)?!!e&&"stories-spinner":e)&&(this._options.loadAnimationName=e,this.isRendered&&(e?this._createLoadAnimation():!e&&this._loadingAnimation&&this._loadingAnimation.destroy()))}get loadAnimation(){return this._options.loadAnimation}set loadAnimation(e){var t;const s=this._options.loadAnimation;if((e=Boolean(e))===s)return e;this._loadingAnimation&&this.loadAnimationName&&this._loadingAnimation.togglePlay(e),null===(t=document.querySelector(`.${d.qC}`))||void 0===t||t.classList.toggle("is-active",e),this._options.loadAnimation=e}get loadAnimationBefore(){return this._options.loadAnimationBefore}set loadAnimationBefore(e){this._options.loadAnimationBefore!==(e=Boolean(e))&&(this.loadAnimationName&&this._loadingAnimationBefore&&this._loadingAnimationBefore.togglePlay(e),this._options.loadAnimationBefore=e)}get storiesBefore(){return this._options.storiesBefore?this._options.storiesBefore:this._options.storiesBefore=[]}get storiesAfter(){return this._options.storiesAfter?this._options.storiesAfter:this._options.storiesAfter=[]}get storiesViewed(){const e=h.LocalStorage.get(d.R$)||[];return Array.isArray(e)&&0!==e.length?e:[]}set storiesViewed(e){h.LocalStorage.set(d.R$,[...new Set(e)].slice(0,1e3))}get advertsViewed(){const e=h.LocalStorage.get(d.kY);if(!(0,c.isObject)(e)||"number"!=typeof e.t||!Array.isArray(e.i)||e.t+d.XA<Date.now()/1e3)return[];const t=e.i;return Array.isArray(t)&&0!==t.length?t:[]}set advertsViewed(e){h.LocalStorage.set(d.kY,{t:Date.now()/1e3,i:e.slice(0,1e3)})}get feedName(){return this._options.feedName||""}set feedName(e){this._options.feedName=e}get customFeed(){return this._options.customFeed}set customFeed(e){e&&this._analyticsInstance.yandex.goal("feed_opening",{feed:e}),this._options.customFeed=e}get isSubsMode(){return this._options.isSubsMode}set isSubsMode(e){this._options.isSubsMode=e}get feedRecordId(){return this._options.feedRecordId}set feedRecordId(e){this._options.feedRecordId!==e&&(this._options.feedRecordId=e)}get isExpandedMode(){return this._options.isExpandedMode}set isExpandedMode(e){this._options.isExpandedMode=Boolean(e)}get displayModeViewedStories(){return this._options.displayModeViewedStories||l.kc.VISITED_STORIES_SHOW}set displayModeViewedStories(e){const t=this._options.displayModeViewedStories;if(!(e=l.kc[e])||e===t)return e;this._options.displayModeViewedStories=e,void 0!==t&&(h.CookieStorage.set("autohide_news",e.valueOf(),{expires:365}),h.CookieStorage.set("set_autohide_news",e.valueOf(),{expires:365}),T.User.sendSettingsChangeAnalytics("viewed_post",t,e),this.clear().loadStories(!1))}get adultVisible(){return this._options.adultVisible}set adultVisible(e){const t=this._options.adultVisible;e=Boolean(e),t!==e&&(this._options.adultVisible=e,void 0!==t&&T.User.switchAdult(e).then((()=>{T.User.sendSettingsChangeAnalytics("show_porno",t,e),this.clear().loadStories(!1)})))}get focused(){return i.core.storage.focused===this.eid}set focused(e){this.focused!==(e=Boolean(e))&&(i.core.logger.log("feed","focus in",this.eid),i.core.storage.focused=e?this.eid:void 0)}get useEmptyIds(){return this._options.useEmptyIds}set useEmptyIds(e){this._options.useEmptyIds!==(e=Boolean(e))&&(this._options.useEmptyIds=e)}get isPageScrollable(){return i.core.ui.isPageScrollable}set isPageScrollable(e){i.core.ui.isPageScrollable=e}get hiddenStories(){return this._options.hiddenStories}set hiddenStories(e){let t=this._options.hiddenStories;if(this.displayModeViewedStories!==l.kc.VISITED_STORIES_HIDE||!e)return this.hiddenStoriesVisibility=!1,void(this._options.hiddenStories=e);if(t!==e){if(this._options.hiddenStories=e,this.$els.hiddenCounter.length){let t,s;this.$els.hiddenCounter.children().length?(t=this.$els.hiddenCounter.find("a"),s=this.$els.hiddenCounter.find("span.label-hidden"),t.length&&s.length?(t.text(i.core.i18n("stories-feed.display-mode.hidden-detail_short",e)),s.text(i.core.i18n("stories-feed.display-mode.hidden-short",e))):(t=this.$els.hiddenCounter.children(),t.text(i.core.i18n("stories-feed.display-mode.hidden-detail",e)))):(t=this.$els.hiddenCounter,t.text(i.core.i18n("stories-feed.display-mode.hidden-detail",e))),this.hiddenStoriesVisibility=!0}}else this.hiddenStoriesVisibility=!0}set hiddenStoriesVisibility(e){!this.$els.hiddenCounter.length||e&&this.$els.hiddenCounter.is(":empty")||(this._hiddenStoriesVisibility=e,this.$els.hiddenCounter.toggleClass(k.F.hiddenCounter.shown,e))}get referrerStoryId(){return this._options.referrerStoryId}set referrerStoryId(e){this._options.referrerStoryId=e}}},82580:(e,t,s)=>{"use strict";s.d(t,{kc:()=>i.kc,of:()=>o.of,fo:()=>o.fo,DV:()=>i.DV,_h:()=>I,nT:()=>A.n,mC:()=>P,FG:()=>r.F});var i=s(72666),o=s(4144),r=s(88549),n=(s(74916),s(88674),s(66992),s(33948),s(41817),s(63907)),a=s(12953),l=s(90477),c=s(41574),d=s(30381),u=s.n(d),p=s(19755),h=s.n(p),_=s(15078),m=s(90312),g=s(32677),v=(s(85827),s(43241)),f=s(51540),y=s(42107),b=s(96883);function w(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const k=r.F.subscriptionsFilter;class S extends v.u{constructor(e){var t;super(e),w(this,"isExpanded",!1),this.el&&(this.initEventListeners(),this.initExpandButtonHandler(),this.itemAll=null===(t=this.el)||void 0===t?void 0:t.querySelector(".subscriptions-filter__item"))}initExpandButtonHandler(){var e;const t=this.showExpandButtonThrottle=(0,f.P)(this.showExpandButton.bind(this),100);this.resizeObserver=new ResizeObserver(t),this.resizeObserver.observe(this.el),this.showExpandButton(),this.setExpandButtonText(),null===(e=this.el)||void 0===e||e.classList.remove(k.filterSkeleton)}initEventListeners(){["click","auxclick"].forEach((e=>{var t;null===(t=this.el)||void 0===t||t.addEventListener(e,(e=>{if(0!==e.button&&1!==e.button)return;const t=1===e.button;t||e.preventDefault();const s=e.target.closest("."+k.item);s&&this.onItemClick(s,!t);const i=e.target.closest("."+k.tab);i&&this.onTabClick(i,!t)}))}))}onItemClick(e,t){if(e&&!this.isActive(e)){t&&this.setActive(e);const{t:s,i}=e.dataset,o=e.getAttribute("href");this.sendAnalytics(s,i),o&&t&&this._options.onItemClick(o)}}onTabClick(e,t){var s,i;if(!e||this.isActiveTab(e))return;t&&this.setActiveTab(e);const{t:o}=e.dataset,r=e.getAttribute("href"),n=this.itemAll;n&&r&&(n.setAttribute("href",r),this.setActive(n)),null===(s=this.el)||void 0===s||s.querySelectorAll("."+k.item).forEach((e=>{e.hidden=Boolean(e.dataset.t&&o&&o!==e.dataset.t)})),this.setExpandButtonText(),null===(i=this.showExpandButtonThrottle)||void 0===i||i.call(this),b.d.send("transitionToSubsTab",{type:"community"===o?"communities":"user"===o?"authors":"tag"===o?"tags":"all"}),r&&t&&this._options.onTabClick(r)}sendAnalytics(e,t){let s;if(e){let i;i="tag"===e?"tag_id":"user"===e?"author_id":"community_id",s={type:"sub",[i]:t}}else s={type:"sub_all"};y.cp.getInstance().sendEvent("filter",s)}isActive(e){return e.classList.contains(k.itemActive)}setActive(e){var t,s;null===(t=this.el)||void 0===t||null===(s=t.querySelector("."+k.itemActive))||void 0===s||s.classList.remove(k.itemActive),e.classList.add(k.itemActive)}isActiveTab(e){return e.classList.contains(k.tabActive)}setActiveTab(e){var t,s;null===(t=this.el)||void 0===t||null===(s=t.querySelector("."+k.tabActive))||void 0===s||s.classList.remove(k.tabActive),e.classList.add(k.tabActive)}showExpandButton(){var e;if(this.isExpanded)return;let t=this.expandButton;const s=null===(e=this.el)||void 0===e?void 0:e.lastElementChild;if("none"===window.getComputedStyle(s).display)return;if(s.scrollHeight>s.offsetHeight){t?s.append(t):(t=this.createExpandButton(),s.append(t),this.expandButton=t);const e=t.offsetWidth+20;t.style.setProperty("display","none");const i=s.getBoundingClientRect(),o=i.width/2,r=Array.from(s.children).filter((e=>e!==t&&e.offsetTop>0&&e.offsetTop<i.height));if(r.length<2)return;const n=r.reduce(((e,t)=>e+Math.max(0,t.getBoundingClientRect().width-o)),0),a=r[r.length-1],l=parseInt(window.getComputedStyle(s).paddingRight,10);let c=i.right-l-a.getBoundingClientRect().right+n,d=r.length-1;for(;c<e&&r[d];)c+=r[d].offsetWidth+20,d--;const u=r[d];t.previousElementSibling===u||u.insertAdjacentElement("afterend",t),t.style.removeProperty("display")}else{var i;null===(i=t)||void 0===i||i.remove()}}createExpandButton(){const e=document.createElement("button");return e.classList.add("subscriptions-filter__show-more"),e.addEventListener("click",this.expand.bind(this)),e}setExpandButtonText(){var e;if(!this.expandButton)return;const t=this.getCurrentType(),s=".subscriptions-filter__item"+(t?`[data-t="${t}"]`:""),i=(null===(e=this.el)||void 0===e?void 0:e.querySelectorAll(s).length)||0;this.expandButton.innerHTML=`Показать все (${i})`}expand(){var e,t,s;null===(e=this.expandButton)||void 0===e||e.remove(),null===(t=this.el)||void 0===t||t.classList.remove("subscriptions-filter_collapsed"),this.isExpanded=!0,null===(s=this.resizeObserver)||void 0===s||s.disconnect()}getCurrentType(){var e,t;return null===(e=this.el)||void 0===e||null===(t=e.querySelector(".subscription-tab_active"))||void 0===t?void 0:t.dataset.t}}s(91904),s(31200),s(82800),s(72044),s(75130);var O=s(36005),E=s(73736),C=s(12950);function x(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function T(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const I=["today","month","week","all"];class P extends n.u1{render(){return this.$els={target:this.$(".button-filter"),menuItems:this.$(".menu__item"),linkAll:this.$('.menu__item[type="all"]'),linkSubs:this.$('.menu__item[type="subs"]'),calendarCustom:{el:void 0,title:void 0}},this.feedType===i.DV.SUBS&&this._initSubscriptionsFilter(),this.feedType===i.DV.COMMUNITY&&this._update(),super.render(),this}_initSubscriptionsFilter(){const e=document.querySelector(".subscriptions-filter");e&&new S({el:e,onItemClick:e=>{a.default.history.replaceUrl(e),this._updateFeed(e)},onTabClick:e=>{a.default.history.replaceUrl(e),this._updateFeed(e)}})}_reset(){}_update(){this.filter.update({date:this.feedDateFilterParameters.defaultDate,dateCaption:""}),this._updateMenuItems(),this._updateFeed(a.default.history.pathname)}_updateFeed(e=a.default.history.pathname){if(!this.isRendered)return;const t=Boolean(this.filter.data.isSortedByTime);this._options.inlineFiltersMode||this.$els.target.toggleClass("button-filter_dot-visible","hot"===this.feedName&&t),e&&(this.feed.requestUrl=e),this.feed.clear(),this.feed.loadStories(!1)}_updateMenuItems(){var e;const t=this.feedName;null===(e=this.$els.menuItems)||void 0===e||e.each(((e,s)=>{const i=h()(s);switch(i.attr("type")){case"all":i.attr("href","hot"===t?"/":"/"+t);break;case"subs":i.attr("href","/"+t+"/subs");break;case"custom":const e=i.attr("data-name");i.attr("href","/"+t+"/feed/"+e)}const o=i.attr("href")===a.default.history.pathname;i.toggleClass("menu__item_current",o)}))}_changeProfileSort(e){const t=a.default.history.pathname.match(/\/([^\/]+)(?:\/(mine|rating|time))?(?:\/(asc))?$/);if(!t)return;const s=t[1],i=t[2]||"time",o="/"+s+(e||"time"!==i?"/"+i:"")+(e?"/asc":"");a.default.history.replaceUrl(o),this._updateFeed()}_changeSortByTime(){if("hot"!==this.feedName)return;const e=Boolean(this.filter.data.isSortedByTime),t=e?i.y$.TIME:i.y$.ACTUAL;this.feed.searchParams.set("f",t.value),m.c.getInstance().sendEvent("filter",{filter_type:e?"new":"actual"}),this._updateFeed()}_getRange(){const e=this.calendar.selectedDates,t=(0,c.g)(e.start,e.end,this.calendar.getMinDate());return e.startDate=u()(e.start).format("DD-MM-YYYY"),e.endDate=u()(e.end).format("DD-MM-YYYY"),e.type=t||(this.calendar.isFullRangeSelected?"all":void 0),e}_isDefaultRange(e){return this.feedType===i.DV.NEW||this.feedType===i.DV.BEST?"today"===e.type:"all"===e.type}_onSelectRange(){var e;const t=this._getRange();let s=I.includes(t.type)?"Выбрать дату":t.caption;if(this.feedType===i.DV.HOT){const e=this._getUrlByDate("best",t);return a.default.history.redirect(e),!1}null===(e=this.$els.calendarCustom.el)||void 0===e||e.toggleClass("stories-feed-filter__field_current",!t.type),this._options.shortCalendarCustomTitle&&t.start&&t.end&&(s=this._getCalendarCustomShortTitle(t.start.toDateString(),t.end.toDateString()));const o=this._getUrlByDate(this.feedType.valueOf(),t);return a.default.history.replaceUrl(o),this._updateFeed(o),!0}_getCalendarCustomShortTitle(e,t){const s="DD.MM.YYYY";let i=u()(new Date(e)).format(s);return t&&e!==t&&(i+=" - "+u()(new Date(t)).format(s)),i}_getUrlByDate(e,t){const s=e===i.DV.SERIES.valueOf()?this._options.baseUrl:"/"+e;return t.type===this.feedDateFilterParameters.defaultDate?s:t.type&&"random"!==t.type&&this.feedDateFilterParameters.useUrlShortcuts?s+"/"+t.type:(0,O.isNull)(t.start)&&(0,O.isNull)(t.end)?s:s+"/"+(t.startDate===t.endDate?t.startDate:t.startDate+"_"+t.endDate)}_isRange(e){return["all","month","week","today","random"].includes(e)}_isNeedShowHint(){return!_.m.get(o.fo,!1)&&this.$els.target&&this.$els.target.data("hide-visited")}_onChangeFilter(){}async _requestFeedRandomDates(){if(this.feedType!==i.DV.COMPANIES)return;const{response:e,data:t}=await C.cf.get("/ajax/advert-blogs/random-date");if(!e.result)throw a.default.ui.toasts.showError(e.message),new Error(e.message);return t.dates}get calendar(){if(this._options.calendar)return this._options.calendar;const{datesRangeMode:e,minDate:t}=this.feedDateFilterParameters,s=this._options.calendar=new c.E({width:Math.min(550,window.innerWidth),datesRangeMode:e,showButtonsPanel:!1});t&&(s.limitStart=t);const i=this.filter.data.date;if(this._isRange(i))this.calendar.setRangeByType("all"===i?"all_time":i,e);else{const[e,t]=i.split(",");this.calendar.setDate(e,t)}return this.listenToOnce(s,n.eM.DESTROYED,(()=>delete this._options.calendar)),e||this.listenTo(s,"select",(0,O.debounce)(this._onSelectRange,10)),s}get filter(){let e=this._options.filter;if(e)return e;let t=a.default.config("modules.feed-filter")||{};return a.default.isUserAuthorized&&(this.feed.adultVisible=t.isAdultVisible),this.feed.displayModeViewedStories=i.kc[t.displayMode],e=this._options.filter=new l.Lo(function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?x(Object(s),!0).forEach((function(t){T(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):x(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({feedName:this.feedType.valueOf(),isUserAuthorized:a.default.isUserAuthorized},t)),this.listenTo(e,l.u$.CHANGE,(0,O.debounce)(this._onChangeFilter.bind(this),100)),e}get feed(){return this._options.feed}set feed(e){this._options.feed!==e&&(this._options.feed=e)}get feedName(){return this.feed.feedName}set feedName(e){e!==this.feed.feedName&&(this.feed.feedName=e,this._reset(),this._update())}get customFeed(){return this.feed.customFeed}set customFeed(e){e!==this.feed.customFeed&&(this.feed.customFeed=e,this._reset(),this._update())}get feedType(){return i.DV[this.feed.feedName]}get isDisableCalendar(){return this._options.isDisableCalendar}set isDisableCalendar(e){this._options.isDisableCalendar!==e&&(this._options.isDisableCalendar=e)}get isSubsMode(){return this._options.isSubsMode}set isSubsMode(e){let t=this._options.isSubsMode;if(t===e)return;if(this._options.isSubsMode=e,void 0===t)return;this.feed.isSubsMode=e,this.filter.update({date:this.feedDateFilterParameters.defaultDate,dateCaption:""}),this._reset(),this._updateMenuItems();const s=this.isSubsMode?"my_feed":this.feedName,i=g.L[s];i&&(m.c.getInstance().sendEvent("transition_to_tab",{level:i}),E.dV.send("transitionToTab",{level:i})),this._updateFeed(a.default.history.pathname)}get feedDateFilterParameters(){if(this._options.feedDateFilterParameters)return this._options.feedDateFilterParameters;const e=![i.DV.NEW,i.DV.MOST_SAVED,i.DV.COMPANIES,i.DV.SERIES].includes(this.feedType);let t,s="today",o=!0;return[i.DV.COMPANIES,i.DV.SERIES].includes(this.feedType)&&(s="all",o=!1),this._options.feedDateFilterParameters={datesRangeMode:e,defaultDate:s,useUrlShortcuts:o,minDate:t},this._options.feedDateFilterParameters}}var A=s(28524)},29845:(e,t,s)=>{"use strict";s.d(t,{N:()=>m});s(41817),s(88674),s(66992),s(33948);var i=s(16253),o=s(12950),r=s(96637),n=s(36005),a=s(4144),l=s(12953),c=s(27885),d=s(14025),u=s(20817);const p="story-visited";let h;const _=Symbol();class m{constructor(e){if(e!==_)throw new Error("Cannot construct singleton");this._emitter=new i.vp,this._syncDebounce=(0,n.throttle)(this._sync,15e3,{leading:!1}),window.addEventListener("storage",(e=>{e.key===a.sC&&e.newValue&&this._load()})),this._sync()}static get instance(){return h||(h=new m(_),h)}static getViewAndEmotionsCount(e){return m.instance.getViewAndEmotionsCount(e)}static isViewed(e){m.instance.isViewed(e)}static setViewed(e,t=!0){d.PG.setViewed(e.storyId),m.instance.setViewed(e,t)}get storage(){return this._storage||this._load(),this._storage}async getViewAndEmotionsCount(e){let t=this.storage.get(e.storyId);if(t&&t.views&&t.views[0]>-1)return t;const{response:s,data:i}=await o.cf.get(l.core.initParams.statUrl+`/counters/story/${e.storyId}`,{},{crossDomain:!0});return t=t||{views:[-1,-1,-1],emotions:{}},t.views[0]=s.result&&i&&i.v?i.v:0,t.views[1]=(0,u.N)(),t.emotions=s.result&&i&&i.e?i.e:{},t.stat=this._getStoryStatisticsData(e),this.storage.set(e.storyId,t),this._save(),t}isViewed(e){const t=this.storage.get(e);return Boolean(t&&t.views&&t.views[2]>-1)}setViewed(e,t=!0){if(this._emitter.emit(p,e.storyId),this.isViewed(e.storyId))return;const s=this.storage.get(e.storyId)||{views:[-1,-1,-1]};if(s.views[2]=(0,u.N)(),s.stat=this._getStoryStatisticsData(e),this.storage.set(e.storyId,s),this._save(),!t)return;const i=r.LocalStorage.get(a.wE)||[];-1===i.indexOf(e.storyId)&&(i.push(e.storyId),r.LocalStorage.set(a.wE,i),this._syncDebounce())}onStoryViewed(e){return this._emitter.on(p,e),()=>this._emitter.off(p,e)}clearStoryCache(e){this.storage.delete(e),this._save()}_sync(){let e=r.LocalStorage.get(a.wE);Array.isArray(e)&&e.length&&(e.length>a.U5?(e=e.slice(0,a.U5),r.LocalStorage.set(a.wE,e.slice(a.U5))):r.LocalStorage.remove(a.wE),o.cf.post("/ajax/save_visited_stories.php",{t:"viewed",ids:e.join(","),st:e.map((e=>{const t=this.storage.get(e);return t?[e,t.stat.ai,t.stat.is].join(","):null})).filter(Boolean).join(";")}))}_load(){const e=r.LocalStorage.get(a.sC),t=this._storage=new Map,s=(0,u.N)();if("object"!=typeof e||!e)return;let i;try{i=JSON.parse((0,c.rr)(e,{to:"string"}))}catch(o){return void console.warn(o)}if(Array.isArray(i))for(const[r,n]of i){if("number"!=typeof r||!Array.isArray(n.views)||3!==n.views.length)continue;let[e,i,o]=n.views;(-1===e||s-i>a.Ag)&&(e=-1,i=-1),s-o>a.Oq&&(o=-1),-1===i&&-1===o&&-1===e||t.set(r,{views:[e>=0?e:-1,i||-1,o||-1],emotions:n.emotions,stat:n.stat})}}_save(){if(!this._storage)return;const e=(0,c.Wt)(JSON.stringify(Array.from(this._storage.entries())));r.LocalStorage.set(a.sC,e)}_getStoryStatisticsData(e){return{ai:e.authorId,is:e.isSubscribed?1:0}}}},89770:(e,t,s)=>{"use strict";s.d(t,{C:()=>u});s(41817),s(66992),s(33948),s(88674);var i=s(96637),o=s(4144),r=s(12953),n=s(12950),a=s(15078),l=s(36005);let c;const d=Symbol();class u{constructor(e){if(e!==d)throw new Error("Cannot construct singleton");this._storiesToSync=new Map,this._syncThrottle=(0,l.throttle)(this._sync.bind(this),o.Mz,{leading:!1})}async _sync(e=!1){this._abortSync();let t=new Map(this._storiesToSync);if(!t.size)return this;if(this._storiesToSync.clear(),e)this._syncByCookie([...t.keys()]);else{this._storiesToSyncPending=t;try{await this._syncByAjax(t)}catch(i){var s;null===(s=this._storiesToSyncPending)||void 0===s||s.forEach(((e,t)=>this._storiesToSync.set(t,e)))}finally{this._storiesToSyncPending=null}}return this}_syncByCookie(e){Array.isArray(e)&&e.length?i.CookieStorage.set(o.A0,e,{expires:365}):i.CookieStorage.remove(o.A0)}async _syncByAjax(e){i.CookieStorage.get("pcid")||r.core.logger.error("save","id not found visited");const t=[...e.keys()],{response:s}=await n.cf.post("/ajax/save_visited_stories.php",{t:"visited",ids:t.join(","),st:[...e.values()].join(";")});if(!s.result)throw r.core.logger.error("stories-feed","some trouble with update visited news",r.core.history.path),new Error;{r.core.logger.log("stories-feed","good save visited stories",t);const e=a.m.get(o.R$)||[];a.m.set(o.R$,[...t,...e].slice(0,1e3))}}_abortSync(){var e;this._syncThrottle.cancel(),null===(e=this._storiesToSyncPending)||void 0===e||e.forEach(((e,t)=>this._storiesToSync.set(t,e))),this._storiesToSyncPending=null}setVisited(e,t=!1){this._storiesToSync.set(e.storyId,[e.storyId,e.authorId,e.isSubscribed?1:0].join(",")),t||this._syncThrottle()}forceSave(){this._sync(!0)}extractUnsavedIds(){this._abortSync();const e=[...this._storiesToSync.keys()];return e.length?e:[]}static get instance(){return c||(c=new u(d),c)}static setVisited(e,t=!1){this.instance.setVisited(e,t)}static forceSave(){this.instance.forceSave()}static extractUnsavedIds(){return this.instance.extractUnsavedIds()}}},88549:(e,t,s)=>{"use strict";s.d(t,{F:()=>i});const i={item:"stories-feed",container:"stories-feed__container",spinner:"stories-feed__spinner",spinnerBefore:"stories-feed__spinner-before",loadingBefore:"stories-feed__load-before",pagination:"stories-feed-pagination",emailForm:"email-block",relatedStoriesAdv:"stories-feed__related-stories-adv",message:{item:"stories-feed__message",show:"stories-feed__message_show"},messageSubs:{item:"stories-feed__subs-message",show:"stories-feed__subs-message_show",innerBlock:"stories-feed__subs-message-b"},hiddenCounter:{item:"hidden-counter",shown:"hidden-counter_shown"},filter:{hideVisitedMark:"button-filter_hide-visited",fields:{hideVisited:'stories-feed-filter__field[data-role="hide-visited"]'},fieldHighlight:"stories-feed-filter__field_highlight"},subscriptionsFilter:{tab:"subscription-tab",tabActive:"subscription-tab_active",filterSkeleton:"subscriptions-filter_skeleton",item:"subscriptions-filter__item",itemActive:"subscription-item_active"}}},74436:(e,t,s)=>{"use strict";s.d(t,{o:()=>u});s(88674);var i=s(63907),o=s(72346),r=s(12950),n=s(12953),a=s(96637),l=s(90312),c=s(95374),d=s(27929);s(19755);class u extends i.u1{constructor(e){super(e),a.LocalStorage.get("pkb_subscr")||a.LocalStorage.get("pkb_subscr_counter")>2?this.$el.hide():(this._formClass=this._options.formClass,this._inputClass=this._options.inputClass,this._intersectionCounter=a.LocalStorage.get("pkb_subscr_counter"),this._isIntersection=!1,this.listenTo(new this._formClass(this.$el),"submit",this._onSubmitForm),this._emailInput=new this._inputClass({$el:this.$(".input"),sanitizerRules:[o.o.trim()],addClearButton:!1}),this._currentInputValue=this._emailInput.$el.data("email"),this.listenTo(this._emailInput,"change",(()=>{this._currentInputValue=this._emailInput.value})),this.$els={done:this.$(".email-form_done"),main:this.$(".email-form_block"),close:this.$(".email-form_close")},this.$els.close.on("click",(async()=>{if(n.core.isUserAuthorized){const{response:e}=await r.cf.post("/ajax.php",{route:"email-broadcasting/hide"});if(!e.result)return n.core.ui.toasts.showError(e.message),!1}else a.LocalStorage.set("pkb_subscr",!0);this.$el.hide(),l.c.getInstance().sendEvent("click",{button:"subscribe_mailing_list_close"})})))}async _onSubmitForm(e){if(e.preventDefault(),!c.c.required()(this._currentInputValue)||!c.c.email()(this._currentInputValue))return n.core.ui.toasts.showError("Некорректный email"),void l.c.getInstance().sendEvent("error_occured",{button:"subscribe_mailing_list",email:this._currentInputValue});this.sendEmailForm(this._currentInputValue)}async sendEmailForm(e){const t=await(0,d.L)(e);return t.result?(this.$els.main.hide(),this.$els.done.show(),a.LocalStorage.set("pkb_subscr",!0),l.c.getInstance().sendEvent("click",{button:"subscribe_mailing_list",email:e}),!0):(n.core.ui.toasts.showError(t.message),l.c.getInstance().sendEvent("error_occured",{button:"subscribe_mailing_list",email:e}),!1)}}},3436:(e,t,s)=>{"use strict";s.d(t,{b:()=>o});s(88674);var i=s(12950);class o{static async share(e,t){let s={action:e?"share":"unshare",category_id:t},{data:o}=await i.cf.postOrFail("/ajax/saved_category_sharing.php",s);return o}static async getSavedCategoryId(e){let{data:t}=await i.cf.postOrFail("/ajax.php",{route:"bookmarks/get-category",story_id:e});return t.category_id}}},93172:(e,t,s)=>{"use strict";s.d(t,{v:()=>c});s(66992),s(33948),s(41817);var i=s(96637),o=s(90312),r=s(69288);function n(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function a(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const l="pkb_ssess";class c{static convertSearchParams(e){var t,s,i,o;const n={},a={};e.rating&&(n.rating=r.et[e.rating-1]),null!==(t=e.user)&&void 0!==t&&t.id&&(n.author_id=e.user.id),null!==(s=e.community)&&void 0!==s&&s.id&&(n.community_id=e.community.id),null!==(i=e.tags)&&void 0!==i&&i.length&&(n.tags=Array.isArray(e.tags)?e.tags.join(","):e.tags),null!==(o=e.excludeTags)&&void 0!==o&&o.length&&(n.no_tags=Array.isArray(e.excludeTags)?e.excludeTags.join(","):e.excludeTags);const l=[e.dateFrom,e.dateTo].filter(Boolean);if(l.length&&(1===l.length&&l.push(l[0]),a.period=`${l[0]} - ${l[1]}`),e.type){const t=e.type,s=[];Object.entries(r.hR).forEach((([e,i])=>{t&i&&s.push(e.toLowerCase())})),s.length&&(a.post_type=s.join(","))}return Object.keys(a).length>0&&(n.search_filters_list=JSON.stringify(a)),n}static createSearchSession(){const e=c.createSearchKey();return i.SessionStorage.set(l,e),new c(e)}static retrieveSearchSession(){let e=parseInt(i.SessionStorage.get(l),10);return e?i.SessionStorage.remove(l):e=c.createSearchKey(),new c(e)}static createSearchKey(){return Math.trunc(Date.now()/1e3)}constructor(e){this.key=e}sendSearchEvent(e,t){const s=t?c.convertSearchParams(t):void 0;o.c.getInstance().sendEvent("search",function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?n(Object(s),!0).forEach((function(t){a(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):n(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({search_input:e,screen_search:this.key},s))}}},69288:(e,t,s)=>{"use strict";s.d(t,{$F:()=>a,ch:()=>c,et:()=>r,h1:()=>l,hR:()=>n,t0:()=>d});var i=s(74750),o=s(67133);const r=[-100,0,25,100,250,500,1e3,2500,5e3,1e4],n={ANY:0,TEXT:2,IMAGE:4,VIDEO:8,MINE:16,NSFW:32},a="Моё",l=i.x,c={[a]:n.MINE,[l]:n.NSFW},d={[o.v.FRESH.valueOf()]:"new",[o.v.HOT.valueOf()]:"best",[o.v.RELEVANCE.valueOf()]:"relevant"}},67133:(e,t,s)=>{"use strict";s.d(t,{v:()=>o,x:()=>r});var i=s(65448);const o=new i.xs({FRESH:1,HOT:2,RELEVANCE:3}),r=new i.xs({COMMUNITY:"community",USER:"user",TAG:"tag",ALL:"all",VISITED:"visited"})},26938:(e,t,s)=>{"use strict";s.d(t,{DX:()=>a,VQ:()=>n,kc:()=>h});s(66992),s(33948),s(88674),s(2707);var i=s(63907),o=s(90477),r=s(65448);const n=new r.xs({STORY:0,EDITOR:1,MANUAL:2}),a=new r.xs({EMPTY:0,WAIT:1,READY:2,ERROR:3});var l=s(91920),c=s(12950);var d=s(96637),u=s(36005);class p extends o.Lo{constructor(e,t){if(super(e,!0),this._similarStories=t,this.data.block){if(this.listenTo(this.data.block,o.u$.DESTROY,(()=>{this.destroy()})),this.data.type===l.STORY_BLOCK_TYPE.IMAGE){const{url:e}=this.data.block.data;e?this._onResolveImageUrl(this.data.block,e):this.listenTo(this.data.block,"url",(0,u.debounce)(this._onResolveImageUrl.bind(this),1e3))}else this.data.type===l.STORY_BLOCK_TYPE.VIDEO_FILE?(this.listenTo(this.data.block,o.u$.CHANGE,(0,u.debounce)(this._updateFragments.bind(this),100)),this._updateFragments()):this._updateFragments();this.marks.set("isChangeable",!0)}else this.data.type!==l.STORY_BLOCK_TYPE.TEXT&&this.data.fragments?(this.data.error=!1,this.data.ready=!0):(this.listenTo(this,"body",this._onUpdateTextBody.bind(this,!1)),this._onUpdateTextBody(!0),this.marks.set("isChangeable",!0))}destroy(e=!1){return this.data.type===l.STORY_BLOCK_TYPE.IMAGE&&this._onImageSourceRemoval(this.data.block.data.url),super.destroy(e)}_onUpdateTextBody(e=!1){if(d.Utils.getTextContent(this.data.body).length<5)return this.data.fragments=[],this.data.ready=!0,void(this.data.error=!1);if(this.data.ready=!1,e)return void this._updateFragments();let t=this.marks.get("text-debounce");t||(t=(0,u.debounce)(this._updateFragments.bind(this),5e3),this.marks.set("text-debounce",t)),t()}_onResolveImageUrl(e,t){const s=this._getSameImageSources(t),i=s.filter((e=>!e.isDestroyed)).length>0;s.push(this),i?(this.marks.set("isSuspended",!0),this.data.ready=!0):this._updateFragments()}_onImageSourceRemoval(e){if(this.isSuspended)return;const t=this._getSameImageSources(e);for(const s of t)if(s.isSuspended&&!Object.is(this,s)){s.relaunchSearch();break}}_getSameImageSources(e){const{imageSources:t}=this._similarStories;return t.has(e)||t.set(e,[]),t.get(e)}_updateFragments(){this.isDestroyed||(this.isReady&&(this.data.ready=!1),this.resetPagination(),this._getDuplications())}dropErrorFlag(){this.isError&&(this.data.error=!1)}async relaunchSearch(){this.marks.set("isSuspended",!1),this.isDestroyed||(this.isReady&&(this.data.ready=!1),this.resetPagination(),await this._getDuplications())}_createData(e){return e.type=l.STORY_BLOCK_TYPE[e.type],(0,u.isArray)(e.fragments)&&e.fragments.sort(((e,t)=>t.relevance-e.relevance)).forEach((e=>e.type=l.STORY_BLOCK_TYPE[e.type])),super._createData(e)}async _getDuplications(){let e;if(this.data.block){let t=this.data.block;e=this.data.type===l.STORY_BLOCK_TYPE.VIDEO_FILE?{fid:t.data.fid,type:l.STORY_BLOCK_TYPE.VIDEO_FILE.valueOf()}:t.serialize()}else{if(this.data.type!==l.STORY_BLOCK_TYPE.TEXT||!this.data.body)return this.data.ready=!0,void(this.data.error=!1);e={type:l.STORY_BLOCK_TYPE.TEXT.valueOf(),body:this.data.body}}e.action="find_duplicates",this.data.storyId&&(e.story_id=this.data.storyId);let{response:t,data:s}=await c.cf.post("/ajax/stories_actions.php",e);if(this.isDestroyed)return;if(!t.result)return this.data.fragments=[],this.data.ready=!1,void(this.data.error=!0);let i=(0,u.isArray)(s)?s:[];this.data.fragments=i.filter(this._similarStories.filterFragments).sort(((e,t)=>t.relevance-e.relevance)).map((e=>(e.type=l.STORY_BLOCK_TYPE[e.type],e))),this.data.ready=!0,this.data.error=!1}resetPagination(){return this.marks.delete("finished"),this.marks.delete("last"),this}getPartOfFragments(e){let t,s=this.data.fragments,i=this.marks.get("last")||0,o=i+e;return s&&s.length&&!this.marks.has("finished")?(t=s.slice(i,o),this.marks.set("last",o),o>=s.length&&this.marks.set("finished",!0),t):[]}get isChangeable(){return this.marks.has("isChangeable")}get isSuspended(){return this.marks.has("isSuspended")}get isFinished(){return this.marks.has("finished")}get isEmpty(){return!(0,u.isArray)(this.data.fragments)||0===this.data.fragments.length}get isReady(){return this.data.ready}get isError(){return this.data.error}}p.prototype.defaults={type:void 0,fragments:void 0,block:void 0,storyId:void 0,ready:!1,error:!1};class h extends i.u1{constructor(e){super(e),this._currentSource=-1,this._options.imageSources=new Map,this._options.fragmentsLinePerPage=5,this._options.fragmentSize={[l.STORY_BLOCK_TYPE.VIDEO]:1,[l.STORY_BLOCK_TYPE.IMAGE]:1,[l.STORY_BLOCK_TYPE.VIDEO_FILE]:1,[l.STORY_BLOCK_TYPE.TEXT]:3},this._options.sources=new o.qg(!1,p),this.sources.prepareData=e=>e instanceof o.Lo?e:new p(e,this),this._isImageSearchDisabled=e.isImageSearchDisabled||!1,this.listenTo(this.sources,o.u$.UPDATE,this._onUpdateSources)}_onUpdateSources(e,t){t&&t.inserted&&t.inserted.filter((e=>e.isChangeable)).forEach((e=>{this.listenTo(e,"ready",this._onUpdateSourcesState),this.listenTo(e,"error",this._onUpdateSourcesState),this.listenTo(e,o.u$.DESTROY,this._onSourceRemoval.bind(this))})),this._onUpdateSourcesState()}_onUpdateBlocks(e,t){t&&t.inserted&&t.inserted.filter((e=>e.data.type===l.STORY_BLOCK_TYPE.IMAGE||e.data.type===l.STORY_BLOCK_TYPE.VIDEO||e.data.type===l.STORY_BLOCK_TYPE.VIDEO_FILE)).forEach((e=>{this._isImageSearchDisabled&&e.data.type===l.STORY_BLOCK_TYPE.IMAGE||this.sources.add({type:e.data.type,block:e})}))}async relaunchErrorSources(){let e=[];for(let t of this.sources.items)t.dropErrorFlag(),e.push(t);for(let t of e)await t.relaunchSearch()}_onSourceRemoval(){this.state=a.WAIT,this._onUpdateSourcesState()}_onUpdateSourcesState(){if(!this.sources.size)return void(this.state=a.EMPTY);if(this.sources.items.some((e=>e.isError)))this.state=a.ERROR;else if(this.sources.items.every((e=>e.isReady))){let e=this.sources.items.every((e=>e.isEmpty));this.state=e?a.EMPTY:a.READY}else this.state=a.WAIT}getPageFragments(e=!1){e&&(this.sources.items.forEach((e=>e.resetPagination())),this._currentSource=-1);let t=this._getFragments(this.fragmentsLinePerPage*this.fragmentsLineSize);return t.length>0&&(t.sort(((e,t)=>t.relevance-e.relevance)),t=(0,u.sortBy)(t,((e,t)=>e.type===l.STORY_BLOCK_TYPE.TEXT?t.type===l.STORY_BLOCK_TYPE.TEXT?0:-1:1))),t}_getFragments(e){let t,s,i,o,r,n=0,a=0,l=[],c=this.fragmentsLineSize,d=this.sources.size,u=1e3;for(;e>0&&n+a<d&&u;)if(u--,this._currentSource++,this._currentSource>=d&&(n=a=0,this._currentSource=0),o=this.sources.items[this._currentSource],o.isFinished)n++;else if(i=o.data.type,r=this.fragmentSize[i],e<r){if(a+n+1>d)break;a++}else s=Math.ceil(c/r),s*r>e&&(s=Math.floor(e/r)),t=o.getPartOfFragments(s),t&&0!==t.length&&!o.isFinished||n++,t&&t.length&&(l=l.concat(t),e-=t.length*r);return l}async getStoryDuplications(){if(!this.storyId)return;this.marks.set("get-story-duplications",this.storyId);let{response:e,data:t}=await c.cf.post("/ajax/stories_actions.php",{action:"get_duplicates",story_id:this.storyId});this.isDestroyed||this.marks.get("get-story-duplications")!==this.storyId||(e.result&&(0,u.isObject)(t)&&Object.keys(t).length?this.addSources(t):this.state=a.EMPTY)}addSources(e,t=!0){if((0,u.isObject)(e)&&!(0,u.isArray)(e)){let t=Object.keys(e);if(!t.length)return this;if((0,u.isArray)(e[t[0]]))e=(0,u.map)(e,(e=>e));else{if(!t.includes("type"))return this;e=[[e]]}}return(0,u.isArray)(e)&&e.length?((0,u.isArray)(e[0])||(e=[e]),e=e.filter((e=>(0,u.isArray)(e)&&e.length)).map((e=>({type:l.STORY_BLOCK_TYPE[e[0].type||"text"],fragments:e,ready:t}))),this.sources.add(e),this):this}_updateState(e){}_updateType(e){}get filterFragments(){let e=this._options.filterFragments;return(0,u.isFunction)(e)||(e=this._options.filterFragments=()=>!0),e}set filterFragments(e){this._options.filterFragments=e}set textBlock(e){this._textSource||(this._textSource=new p({type:l.STORY_BLOCK_TYPE.TEXT,body:e},this),this.sources.add(this._textSource)),this._textSource.data.body=e}get type(){return this._options.type||n.STORY}set type(e){let t=this._options.type;(e=n[e])&&e!==t&&(this._options.type=e,this.isRendered&&this._updateType(e))}get blocks(){return this._options.blocks}set blocks(e){this._options.blocks!==e&&(this._options.blocks=e,e&&this.listenTo(e,o.u$.UPDATE,this._onUpdateBlocks),this.isRendered&&this._updateType(this.type))}get storyId(){return this._options.storyId}set storyId(e){this._options.storyId!==(e=Number(e))&&(this._options.storyId=e,this.type===n.STORY&&e&&this.isRendered&&this._updateType(this.type))}get state(){return this._options.state||a.READY}set state(e){let t=this._options.state;(e=a[e])&&e!==t&&(this._options.state=e,this._updateState(e),this.emit("state",e))}get sources(){return this._options.sources}get imageSources(){return this._options.imageSources}get fragmentsLinePerPage(){return this._options.fragmentsLinePerPage}get fragmentSize(){return this._options.fragmentSize}get fragmentsLineSize(){return(0,u.reduce)(this.fragmentSize,((e,t)=>e<t?t:e),0)}}},77105:(e,t,s)=>{"use strict";s.d(t,{IA:()=>h,Jc:()=>p,K0:()=>n,QQ:()=>a,RI:()=>d,RX:()=>o,S8:()=>u,TO:()=>_,Xm:()=>l,Z7:()=>m,dT:()=>c,q7:()=>i,uW:()=>r});const i="_sb_id",o=15e3,r=1e3,n=5e3,a=1e4,l="pkb_SEd",c=/(?:https?:\/\/)?(?:[-a-z0-9]+\.)?pikabu\.(ru|lh|local)\/story.+_[0-9]{1,10}\?cid=/g,d=2,u=140,p=160,h=2,_=["Вопрос","Спроси Пикабу"],m=4856},17393:(e,t,s)=>{"use strict";let i;s.d(t,{A:()=>i,t:()=>o}),function(e){e[e.ERROR_UNKNOWN=1]="ERROR_UNKNOWN",e[e.ERROR_TITLE_RANGE=2]="ERROR_TITLE_RANGE",e[e.ERROR_TITLE_SYMBOL=3]="ERROR_TITLE_SYMBOL",e[e.ERROR_TITLE_CONTAIN_LINK=4]="ERROR_TITLE_CONTAIN_LINK",e[e.ERROR_TITLE_FORBIDDEN_DOMAIN=5]="ERROR_TITLE_FORBIDDEN_DOMAIN",e[e.ERROR_TITLE_FORBIDDEN_WORDS=6]="ERROR_TITLE_FORBIDDEN_WORDS",e[e.ERROR_TAG_NEED_MORE=7]="ERROR_TAG_NEED_MORE",e[e.ERROR_TAG_NEED_LESS=8]="ERROR_TAG_NEED_LESS",e[e.ERROR_TAG_STRING_LENGTH=9]="ERROR_TAG_STRING_LENGTH",e[e.ERROR_TAG_EXISTING_COUNT=10]="ERROR_TAG_EXISTING_COUNT",e[e.ERROR_TAG_FORBIDDEN_DOMAIN=11]="ERROR_TAG_FORBIDDEN_DOMAIN",e[e.ERROR_TAG_FORBIDDEN_WORDS=12]="ERROR_TAG_FORBIDDEN_WORDS",e[e.ERROR_IMAGE_PENDING=13]="ERROR_IMAGE_PENDING",e[e.ERROR_VIDEO_PENDING=14]="ERROR_VIDEO_PENDING",e[e.ERROR_CAROUSEL_PENDING=15]="ERROR_CAROUSEL_PENDING",e[e.ERROR_AUTHOR_BANNED=16]="ERROR_AUTHOR_BANNED",e[e.ERROR_LINK_MISSING=17]="ERROR_LINK_MISSING",e[e.ERROR_LINK_NOT_VALID=18]="ERROR_LINK_NOT_VALID",e[e.ERROR_TEXT_BOLD=19]="ERROR_TEXT_BOLD",e[e.ERROR_TEXT_BLOCK_LENGTH=20]="ERROR_TEXT_BLOCK_LENGTH",e[e.ERROR_TEXT_FORBIDDEN_DOMAIN=21]="ERROR_TEXT_FORBIDDEN_DOMAIN",e[e.ERROR_TEXT_LENGTH=22]="ERROR_TEXT_LENGTH",e[e.ERROR_TEXT_DESC_LENGTH=23]="ERROR_TEXT_DESC_LENGTH",e[e.ERROR_TEXT_USER_CALLS=24]="ERROR_TEXT_USER_CALLS",e[e.ERROR_TEXT_CONFLICT_WITH_COMMENT_IGNORE=25]="ERROR_TEXT_CONFLICT_WITH_COMMENT_IGNORE",e[e.ERROR_TEXT_CONFLICT_WITH_INVERT_COMMENT_IGNORE=26]="ERROR_TEXT_CONFLICT_WITH_INVERT_COMMENT_IGNORE",e[e.ERROR_VIDEO_COUB=27]="ERROR_VIDEO_COUB",e[e.ERROR_VIDEO_NOT_VALID=28]="ERROR_VIDEO_NOT_VALID",e[e.ERROR_VIDEO_FORBIDDEN_CHANNEL=29]="ERROR_VIDEO_FORBIDDEN_CHANNEL",e[e.ERROR_COMMON_NOT_USER=30]="ERROR_COMMON_NOT_USER",e[e.ERROR_COMMON_NOT_ANONYMOUS=31]="ERROR_COMMON_NOT_ANONYMOUS",e[e.ERROR_COMMON_NSFW=32]="ERROR_COMMON_NSFW",e[e.ERROR_COMMON_FORBIDDEN_ANONYMOUS=33]="ERROR_COMMON_FORBIDDEN_ANONYMOUS",e[e.ERROR_COMMON_BANNED=34]="ERROR_COMMON_BANNED",e[e.ERROR_COMMON_RAITING_LIMIT=35]="ERROR_COMMON_RAITING_LIMIT",e[e.ERROR_COMMON_DAY_LIMIT=36]="ERROR_COMMON_DAY_LIMIT",e[e.ERROR_COMMON_TIME_LIMIT=37]="ERROR_COMMON_TIME_LIMIT",e[e.ERROR_COMMON_STORY_DELETED=38]="ERROR_COMMON_STORY_DELETED",e[e.ERROR_COMMON_ANOTHER_AUTHOR=39]="ERROR_COMMON_ANOTHER_AUTHOR",e[e.ERROR_COMMON_NOT_EDITABLE=40]="ERROR_COMMON_NOT_EDITABLE",e[e.ERROR_BLOCKS_MEDIA_MAX=41]="ERROR_BLOCKS_MEDIA_MAX",e[e.ERROR_COMMON_TIME_EDITABLE=42]="ERROR_COMMON_TIME_EDITABLE",e[e.ERROR_COMMON_RATING_EDITABLE=43]="ERROR_COMMON_RATING_EDITABLE",e[e.ERROR_COMMON_REMOVED_BY_MODERATOR=44]="ERROR_COMMON_REMOVED_BY_MODERATOR",e[e.ERROR_COMMON_DELETED_FULLY=45]="ERROR_COMMON_DELETED_FULLY",e[e.ERROR_COMMON_NUMBER_EDITS=46]="ERROR_COMMON_NUMBER_EDITS",e[e.ERROR_COMMON_STORY_TRANSITED=47]="ERROR_COMMON_STORY_TRANSITED",e[e.ERROR_COMMON_STORY_ADVERT=48]="ERROR_COMMON_STORY_ADVERT",e[e.ERROR_COMMON_ADVERT_FORMAT=49]="ERROR_COMMON_ADVERT_FORMAT",e[e.ERROR_COMMON_LOCKED_COMMUNITY=50]="ERROR_COMMON_LOCKED_COMMUNITY",e[e.ERROR_COMMON_NOT_COMMUNITY=51]="ERROR_COMMON_NOT_COMMUNITY",e[e.ERROR_COMMON_SPECIAL_COMMUNITY=52]="ERROR_COMMON_SPECIAL_COMMUNITY",e[e.ERROR_COMMON_BLOCKED_COMMUNITY=53]="ERROR_COMMON_BLOCKED_COMMUNITY",e[e.ERROR_COMMON_NOT_ANONYMOUS_ADD=54]="ERROR_COMMON_NOT_ANONYMOUS_ADD",e[e.ERROR_COMMON_BLOCKED_IN_COMMUNITY=55]="ERROR_COMMON_BLOCKED_IN_COMMUNITY",e[e.ERROR_COMMON_RATING_IN_COMMUNITY=56]="ERROR_COMMON_RATING_IN_COMMUNITY",e[e.ERROR_COMMON_DISALLOW_ADD=57]="ERROR_COMMON_DISALLOW_ADD",e[e.ERROR_BLOCKS_MIN=58]="ERROR_BLOCKS_MIN",e[e.ERROR_BLOCKS_MAX=59]="ERROR_BLOCKS_MAX",e[e.ERROR_BLOCKS_CAN_NOT_ADD=60]="ERROR_BLOCKS_CAN_NOT_ADD",e[e.ERROR_BLOCKS_IMAGE_NOT_FOUND=61]="ERROR_BLOCKS_IMAGE_NOT_FOUND",e[e.ERROR_BLOCKS_IMAGE_SIZE=62]="ERROR_BLOCKS_IMAGE_SIZE",e[e.ERROR_BLOCKS_IMAGE_HEIGHT_LIMIT=63]="ERROR_BLOCKS_IMAGE_HEIGHT_LIMIT",e[e.ERROR_BLOCKS_FILE_SIZE=64]="ERROR_BLOCKS_FILE_SIZE",e[e.ERROR_BLOCKS_VIDEO_RATING=65]="ERROR_BLOCKS_VIDEO_RATING",e[e.ERROR_BLOCKS_VIDEO_INFO=66]="ERROR_BLOCKS_VIDEO_INFO",e[e.ERROR_BLOCKS_VIDEO_FORMAT=67]="ERROR_BLOCKS_VIDEO_FORMAT",e[e.ERROR_BLOCKS_VIDEO_NOT_FOUND=68]="ERROR_BLOCKS_VIDEO_NOT_FOUND",e[e.ERROR_COMMON_UNKNOWN_FORMAT=69]="ERROR_COMMON_UNKNOWN_FORMAT",e[e.ERROR_COMMON_ICON_LINK=70]="ERROR_COMMON_ICON_LINK",e[e.ERROR_COMMON_NOT_TRANSITION=71]="ERROR_COMMON_NOT_TRANSITION",e[e.ERROR_COMMON_COMMUNITY_RATING=72]="ERROR_COMMON_COMMUNITY_RATING",e[e.ERROR_IMAGE_NOT_UPLOADED=73]="ERROR_IMAGE_NOT_UPLOADED",e[e.ERROR_COMMON_BAD_NETWORK=74]="ERROR_COMMON_BAD_NETWORK",e[e.ERROR_TAG_MIN_TAG=75]="ERROR_TAG_MIN_TAG",e[e.ERROR_BLOG_LINKS=76]="ERROR_BLOG_LINKS",e[e.ERROR_TAG_MAX_TAG=77]="ERROR_TAG_MAX_TAG",e[e.ERROR_ADVERT_INFO=78]="ERROR_ADVERT_INFO",e[e.ERROR_BLOCKS_IMAGE_TITLE_MAX_LENGTH=79]="ERROR_BLOCKS_IMAGE_TITLE_MAX_LENGTH"}(i||(i={}));const o={[i.ERROR_UNKNOWN]:"error_unknown",[i.ERROR_TITLE_RANGE]:"error_title_range",[i.ERROR_TITLE_SYMBOL]:"error_title_symbol",[i.ERROR_TITLE_CONTAIN_LINK]:"error_title_contain_link",[i.ERROR_TITLE_FORBIDDEN_DOMAIN]:"error_title_forbidden_domain",[i.ERROR_TITLE_FORBIDDEN_WORDS]:"error_title_forbidden_words",[i.ERROR_TAG_NEED_MORE]:"error_tag_need_more",[i.ERROR_TAG_NEED_LESS]:"error_tag_need_less",[i.ERROR_TAG_STRING_LENGTH]:"error_tag_string_length",[i.ERROR_TAG_EXISTING_COUNT]:"error_tag_existing_count",[i.ERROR_TAG_FORBIDDEN_DOMAIN]:"error_tag_forbidden_domain",[i.ERROR_TAG_FORBIDDEN_WORDS]:"error_tag_forbidden_words",[i.ERROR_IMAGE_PENDING]:"image_pending",[i.ERROR_VIDEO_PENDING]:"video_pending",[i.ERROR_CAROUSEL_PENDING]:"carousel_pending",[i.ERROR_AUTHOR_BANNED]:"error_author_banned",[i.ERROR_LINK_MISSING]:"error_link_missing",[i.ERROR_LINK_NOT_VALID]:"error_link_not_valid",[i.ERROR_TEXT_BOLD]:"error_text_bold",[i.ERROR_TEXT_BLOCK_LENGTH]:"error_text_block_length",[i.ERROR_TEXT_FORBIDDEN_DOMAIN]:"error_text_forbidden_domain",[i.ERROR_TEXT_LENGTH]:"error_text_length",[i.ERROR_TEXT_DESC_LENGTH]:"error_text_desc_length",[i.ERROR_TEXT_USER_CALLS]:"error_text_user_calls",[i.ERROR_TEXT_CONFLICT_WITH_COMMENT_IGNORE]:"error_text_conflict_with_comment_ignore",[i.ERROR_TEXT_CONFLICT_WITH_INVERT_COMMENT_IGNORE]:"error_text_conflict_with_invert_comment_ignore",[i.ERROR_VIDEO_COUB]:"error_video_coub",[i.ERROR_VIDEO_NOT_VALID]:"error_video_not_valid",[i.ERROR_VIDEO_FORBIDDEN_CHANNEL]:"error_video_forbidden_channel",[i.ERROR_COMMON_NOT_USER]:"error_common_not_user",[i.ERROR_COMMON_NOT_ANONYMOUS]:"error_common_not_anonymous",[i.ERROR_COMMON_NSFW]:"error_common_not_nsfw",[i.ERROR_COMMON_FORBIDDEN_ANONYMOUS]:"error_common_forbidden_anonymous",[i.ERROR_COMMON_BANNED]:"error_common_banned",[i.ERROR_COMMON_RAITING_LIMIT]:"error_common_rating_limit",[i.ERROR_COMMON_DAY_LIMIT]:"error_common_day_limit",[i.ERROR_COMMON_TIME_LIMIT]:"error_common_time_limit",[i.ERROR_COMMON_STORY_DELETED]:"error_common_story_deleted",[i.ERROR_COMMON_ANOTHER_AUTHOR]:"error_common_another_author",[i.ERROR_COMMON_NOT_EDITABLE]:"error_common_not_editable",[i.ERROR_BLOCKS_MEDIA_MAX]:"error_blocks_media_max",[i.ERROR_COMMON_TIME_EDITABLE]:"error_common_time_editable",[i.ERROR_COMMON_RATING_EDITABLE]:"error_common_rating_editable",[i.ERROR_COMMON_REMOVED_BY_MODERATOR]:"error_common_removed_by_moderator",[i.ERROR_COMMON_DELETED_FULLY]:"error_common_deleted_fully",[i.ERROR_COMMON_NUMBER_EDITS]:"error_common_number_edits",[i.ERROR_COMMON_STORY_TRANSITED]:"error_common_story_transited",[i.ERROR_COMMON_STORY_ADVERT]:"error_common_story_advert",[i.ERROR_COMMON_ADVERT_FORMAT]:"error_common_advert_format",[i.ERROR_COMMON_LOCKED_COMMUNITY]:"error_common_locked_community",[i.ERROR_COMMON_NOT_COMMUNITY]:"error_common_not_community",[i.ERROR_COMMON_SPECIAL_COMMUNITY]:"error_common_special_community",[i.ERROR_COMMON_BLOCKED_COMMUNITY]:"error_common_blocked_community",[i.ERROR_COMMON_NOT_ANONYMOUS_ADD]:"error_common_not_anonymous_add",[i.ERROR_COMMON_BLOCKED_IN_COMMUNITY]:"error_common_blocked_in_community",[i.ERROR_COMMON_RATING_IN_COMMUNITY]:"error_common_rating_in_community",[i.ERROR_COMMON_DISALLOW_ADD]:"error_common_disalow_add",[i.ERROR_BLOCKS_MIN]:"error_blocks_min",[i.ERROR_BLOCKS_MAX]:"error_blocks_max",[i.ERROR_BLOCKS_CAN_NOT_ADD]:"error_blocks_can_not_add",[i.ERROR_BLOCKS_IMAGE_NOT_FOUND]:"error_blocks_image_not_found",[i.ERROR_BLOCKS_IMAGE_SIZE]:"error_blocks_image_size",[i.ERROR_BLOCKS_IMAGE_HEIGHT_LIMIT]:"error_blocks_image_height_limit",[i.ERROR_BLOCKS_FILE_SIZE]:"error_blocks_file_size",[i.ERROR_BLOCKS_VIDEO_RATING]:"error_blocks_video_rating",[i.ERROR_BLOCKS_VIDEO_INFO]:"error_blocks_video_info",[i.ERROR_BLOCKS_VIDEO_FORMAT]:"error_blocks_video_format",[i.ERROR_BLOCKS_VIDEO_NOT_FOUND]:"error_blocks_video_not_found",[i.ERROR_COMMON_UNKNOWN_FORMAT]:"error_common_unknown_format",[i.ERROR_COMMON_ICON_LINK]:"error_common_icon_link",[i.ERROR_COMMON_NOT_TRANSITION]:"error_common_not_transition",[i.ERROR_COMMON_COMMUNITY_RATING]:"error_common_community_rating",[i.ERROR_IMAGE_NOT_UPLOADED]:"error_image_not_uploaded",[i.ERROR_COMMON_BAD_NETWORK]:"error_common_bad_network",[i.ERROR_TAG_MIN_TAG]:"error_tag_min_tags",[i.ERROR_TAG_MAX_TAG]:"error_tag_max-tags",[i.ERROR_BLOG_LINKS]:"blog_links",[i.ERROR_ADVERT_INFO]:"error_advert_info",[i.ERROR_BLOCKS_IMAGE_TITLE_MAX_LENGTH]:"error_image_title"}},94242:(e,t,s)=>{"use strict";s.d(t,{v:()=>a});s(41817);var i=s(79025),o=s(29460),r=s(12953);function n(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class a{constructor(){n(this,"swCountdownTimer",new i.A),n(this,"_secondsToUnlockLeft",0),n(this,"isRunning",!1)}static getInstance(){return a.instance||(a.instance=new a)}run({el:e,onSuccess:t}){return this.isRunning||!e?this:(this.secondsToUnlockLeft=r.core.config("modules.story-editor.lockSecondsLeft")||0,0===this.secondsToUnlockLeft||(this.isRunning=!0,this.swCountdownTimer.start(this.secondsToUnlockLeft,(s=>{this.secondsToUnlockLeft=s,0===s&&t(),e.textContent=(0,o.k)(s)}))),this)}get secondsToUnlockLeft(){return this._secondsToUnlockLeft}set secondsToUnlockLeft(e){this._secondsToUnlockLeft=e}}},62165:(e,t,s)=>{"use strict";s.d(t,{r:()=>l});s(66992),s(33948),s(60285),s(41637),s(41817);var i,o=s(12953),r=s(12950);function n(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function a(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(e){e.READ="r",e.VIEW="v",e.CONTENT="c"}(i||(i={}));class l{constructor(){}static getInstance(){return l._instance||(l._instance=new l),l._instance}static get instance(){return l.getInstance()}logStoryPageOpen(e){if(!e.isStoryPage)return;if(this.isTransitionFromAdvertStory(e))return;let t={};if(document.referrer)try{t={rd:new URL(document.referrer).hostname}}catch(s){o.core.logger.error("statisic","problem with document referrer")}this.send(e,i.READ,t)}logViewing(e){this.isTransitionFromAdvertStory(e)||this.send(e,i.VIEW)}logReading(e){this.isTransitionFromAdvertStory(e)||e.isLongStory||e.isStoryPage||this.send(e,i.READ)}logRatioReading(e,t){this.isTransitionFromAdvertStory(e)||e.isFullStoryReading||(e.isHalfStoryReading||(this.send(e,i.READ,{p:50}),e.isHalfStoryReading=!0),100===t&&(this.send(e,i.READ,{p:100}),e.isFullStoryReading=!0))}logVideoClick(e){this.send(e,i.CONTENT,{lh:"v"})}logReadMoreClick(e){e.isStoryPage||this.send(e,i.CONTENT,{lh:"sm"})}send(e,t,s){const i=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?n(Object(s),!0).forEach((function(t){a(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):n(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({t,s:e.id,h:"hot-stories"===o.core.initParams.pageName?1:void 0,isp:Number(e.isStoryPage),m:void 0},s);r.cf.post("/ajax.php?route=advert-blogs/stat",i)}isTransitionFromAdvertStory(e){return e.isStoryPage&&Boolean(o.core.storage.isTransitionFromAdvertStory)}}},27409:(e,t,s)=>{"use strict";s.d(t,{c:()=>p});s(41817),s(66992),s(33948);var i=s(91920),o=s(10553),r=s(54702),n=s(12953),a=s(44361),l=s(68505);function c(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}let d;const u=Symbol();class p{constructor(e){if(c(this,"processed",new WeakSet),e!==u)throw new Error("Cannot construct singleton")}static getInstance(){return d||(d=new p(u)),d}setTagsRow(e){if(this.processed.has(e))return;const t=e.querySelector(`.${r.B.tags.wrapper}`);if(!t||!t.classList.contains(r.B.tags.skeleton))return;this.processed.add(e);const s=(0,l.m)(t,(e=>{e.isIntersecting&&(s(),this.addTagsExpandButton(t),this.removeTagsSkeleton(t))}),{rootMargin:"300px 0px"})}addTagsExpandButton(e){var t;if(n.default.initParams.tags_fold_mode!==a.yX.PARTIAL.value)return;if(null===(t=e.querySelector(`.${r.B.tags.moreButton}`))||void 0===t||t.remove(),!this.isNeedToHideTags(e))return;const s=e.querySelector("."+r.B.tags.collapsedTagsContainer);if(!s)return;const i=this.findTagBeforeCut(s);i?i.after(this.createMoreButton()):this.unwrapCollapsedTags(s)}findTagBeforeCut(e){const t=e.offsetHeight,s=Array.from(e.children),o=[];for(const i of s){if(i.offsetTop>=t)break;o.push(i)}let r=o[o.length-1];const n=r.offsetLeft+this.getWidthWithMargin(r);if(e.offsetWidth<=n+i.MORE_BUTTON_WIDTH_WITH_MARGINS&&(r=r.previousElementSibling),!r)return null;const a=s.indexOf(r);if(a+1<i.DESIRED_MIN_COUNT_TAGS){const t=e.offsetWidth-(r.offsetLeft+this.getWidthWithMargin(r))-i.MORE_BUTTON_WIDTH_WITH_MARGINS;for(let e=a+1;e<s.length;e++){const i=s[e];if(t>this.getWidthWithMargin(i)+1){r.after(i),r=i;break}}}return r}isNeedToHideTags(e){return e.scrollHeight>e.offsetHeight}getWidthWithMargin(e){return e.offsetWidth+parseInt(window.getComputedStyle(e).getPropertyValue("margin-right"),10)+parseInt(window.getComputedStyle(e).getPropertyValue("margin-left"),10)}createMoreButton(){const e=document.createElement("button");return e.innerHTML=`${(0,o.t)("ui__tags-cut")}`,e.classList.add("tags-cut","tags__tag","hint"),e.setAttribute("aria-label","Показать все теги"),e.dataset.analyticsType="post_popup",e.addEventListener("click",(()=>{const t=e.parentElement;e.remove(),this.unwrapCollapsedTags(t)})),e}unwrapCollapsedTags(e){var t,s,i,o;if(!e.classList.contains(r.B.tags.collapsedTagsContainer))return;const n=e.nextElementSibling;if(null===(t=e.closest("."+r.B.tags.wrapper))||void 0===t||t.classList.remove(r.B.tags.wrapperCollapsed),e.replaceWith(...Array.from(e.childNodes)),null!=n&&n.classList.contains("story__tags-tools")&&0===n.offsetLeft&&null!==(s=n.previousElementSibling)&&void 0!==s&&s.classList.contains("tags__tag")&&(null!==(i=null===(o=n.parentElement)||void 0===o?void 0:o.childElementCount)&&void 0!==i?i:0)>2){const e=document.createElement("div");e.classList.add("story__tags-line-break"),n.previousElementSibling.before(e)}}removeTagsSkeleton(e){e.classList.remove(r.B.tags.skeleton)}}},91920:(e,t,s)=>{"use strict";s.r(t),s.d(t,{BLOG_STORY_READ_TIMEOUT:()=>f,BLOG_STORY_VIEW_TIMEOUT:()=>v,DESIRED_MIN_COUNT_TAGS:()=>O,MORE_BUTTON_WIDTH_WITH_MARGINS:()=>S,READING_LEVEL:()=>c,SHORT_CONTENT_TYPES:()=>b,STORY_AD_SHORT_VIEWED_TIMEOUT:()=>m,STORY_AD_VIEWED_TIMEOUT:()=>_,STORY_BLOCK_TYPE:()=>a,STORY_HEIGHT_DELTA:()=>p,STORY_SLICE_TYPE:()=>n,STORY_TYPE:()=>l,STORY_VIEWED_TIMEOUT:()=>h,STORY_VISITED_TIMEOUT:()=>g,STORY_VOTE:()=>r,Story:()=>Xe,TAGS_MASK_MAP:()=>y,VIEWPORT_LIMIT:()=>w,VIEWPORT_START:()=>k,storyStyle:()=>x.B});s(41817),s(66992),s(33948),s(88674),s(60285),s(41637);var i=s(12953),o=s(65448);const r=new o.xs({UP:1,NONE:0,DOWN:-1}),n=new o.xs({NONE:0,BY_BLOCK:1,BY_HEIGHT:2}),a=new o.xs({TEXT:"text",IMAGE:"image",VIDEO:"video",VIDEO_INPUT:"video-input",VIDEO_UPLOAD:"video-upload",VIDEO_FILE:"video_file"}),l=new o.xs({LINK:1,TEXT:2,IMAGE:4,VIDEO:8,TGP:16,CUSTOM_HTML:32}),c=new o.xs({NOT_READ:0,BEGIN_READING:1,HALF_READING:2,FULL_READING:3});var d=s(36005),u=s(74750);const p=200,h=.1,_=1,m=3,g=.1,v=.1,f=3,y=[{name:"Моё",value:1},{name:u.x,value:2},{name:"Негатив",value:4},{name:"Политика",value:8}],b={video:"v",videofile:"vf",text:"t",gif:"g",image:"i",imageTitles:"c",carousel:"ic"},w=.5,k=150,S=32,O=3;var E=s(12950),C=s(26251),x=s(54702),T=s(29845),I=s(90312),P=s(93266),A=s(96637),D=s(71556);function M(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class R{constructor({observedElement:e,callback:t,observeCondition:s,percent:i,delayBetweenCheckCalls:o,delayBetweenCallbackCalls:r}){M(this,"inited",!1),this.observedElement=e,this.callback=t,this.observeCondition=s,this.percent=null!=i?i:[50,100],this.delayBetweenCheckCalls=null!=o?o:500,this.delayBetweenCallbackCalls=null!=r?r:2e3;const n={leading:!1};this.onScrollThrottle=(0,d.throttle)(this.onScroll.bind(this),this.delayBetweenCheckCalls,n),this.onScrollMatchThrottle=(0,d.throttle)(this.onScrollMatch.bind(this),this.delayBetweenCallbackCalls,n)}observe(){this.inited||(this.inited=!0,this.onScroll(),document.addEventListener("scroll",this.onScrollThrottle))}unobserve(){this.inited&&(this.inited=!1,document.removeEventListener("scroll",this.onScrollThrottle))}onScroll(){if(!this.percent.length)return void this.unobserve();const[e,t]=this.getViewRange();this.isStoryOutViewport(e,t)||this.percent.forEach((s=>{s>=e&&s<=t&&this.onScrollMatchThrottle(s)}))}onScrollMatch(e){const[t,s]=this.getViewRange();if(this.isStoryOutViewport(t,s)||this.isNotMatchedPercent(e,t,s))return;const i=this.percent.indexOf(e);-1!==i&&this.observeCondition()&&(this.percent.splice(i,1),this.callback(e))}getViewRange(){const e=this.observedElement;if(!e)return[];const{windowHeight:t}=i.default.ui,{top:s,bottom:o,height:r}=e.getBoundingClientRect();if(t-s<0||o<0)return[];const n=s>0?s:0,a=o<=t?t-o:0,l=Math.round(t-n-a),c=100/r,d=s<0?-s:0,u=s>0?l:l-s;return[Math.round(c*d),Math.round(c*u)]}isNotMatchedPercent(e,t,s){return e<t||e>s}isStoryOutViewport(e,t){return null==e||!t}}var N=s(49463),B=s(20610),L=s(10703),j=s(62165),$=s(2889),U=s(20446),F=s(32677),V=s(90647);const H=[F.L.hot,F.L.best,F.L.new,F.L.my_lent,F.L.post,F.L.user,F.L.community,F.L.tags];class Z{static async getInstance(){return Z.instance||(Z.instance=new Z,this.initPromise=Z.instance.init()),this.initPromise&&(await this.initPromise,this.initPromise=void 0),Z.instance}async init(){const e=F.L[i.core.ui.screen];H.includes(e)&&(this.screenKey=e),this.db=await this.openDb()}async view(e){var t;const s=["views"];this.screenKey&&s.push(`screen${this.screenKey}`);const i=this.db.transaction(s,"readwrite"),o=i.objectStore("views"),r=null!==(t=await o.get(e))&&void 0!==t?t:[];if(!this.screenKey||r.includes(this.screenKey))return r;await o.put([...r,this.screenKey],e);const n=i.objectStore(`screen${this.screenKey}`);if(await n.put(e),await n.count()>5e3){const e=await n.openCursor();if(e){var a;const t=e.value;e.delete();const s=(null!==(a=await o.get(t))&&void 0!==a?a:[]).filter((e=>e!==this.screenKey));0===s.length?await o.delete(t):await o.put(s,t)}}return r}openDb(){return(0,V.X3)("viewed-stories",1,{upgrade(e){e.createObjectStore("views"),H.forEach((t=>{e.createObjectStore(`screen${t}`,{autoIncrement:!0})}))}})}}var z=s(96883),q=s(52764),W=(s(74916),s(15306),s(43241)),G=s(58330),Y=(s(85827),s(2439));class K{static async getVotedCount(e,t){const{response:s,data:o}=await E.cf.get(i.core.initParams.statUrl+`/counters/story-poll/${e}/${t}`);if(!s.result)throw s.message;return o.count_voters||0}static async getStatus(e,t,s){const{response:i,data:o}=await E.cf.get("/ajax.php",{route:"story-poll/status",block_id:e,story_id:t,vote_id:s});if(!i.result)throw i.message;return o}static async vote(e,t,s){const{response:i,data:o}=await E.cf.post("/ajax.php",{route:"story-poll/vote",block_id:e,story_id:t,option:s});if(!i.result)throw i.message;return o}static async revote(e,t,s){const{response:i,data:o}=await E.cf.post("/ajax.php",{route:"story-poll/revote",block_id:e,story_id:t,option:s});if(!i.result)throw i.message;return o}static async getResults(e,t){const{response:s,data:i}=await E.cf.get("/ajax.php",{route:"story-poll/results",block_id:e,story_id:t});if(!s.result)throw s.message;return i}}function X(e){return e.map((e=>({rate:e.rate,count:e.count,id:e.option_id})))}var J=s(53056),Q=s(85679);function ee(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function te(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(s),!0).forEach((function(t){se(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ee(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function se(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const ie="pkb_plid";class oe extends Y.v{constructor(e){super(),se(this,"_voteId",null),se(this,"_loading",!1),se(this,"_totalLoading",!1),se(this,"_totalCount",0),se(this,"_pollOptions",[]),this.options=e}get voteId(){return this._voteId}set voteId(e){this._voteId=e,this.emit("voted",this.voted)}get loading(){return this._loading}set loading(e){this._loading=e,this.emit("loading",e)}get totalLoading(){return this._totalLoading}set totalLoading(e){this._totalLoading=e,this.emit("totalLoading",e)}get totalCount(){return this._totalCount}set totalCount(e){this._totalCount=e,this.emit("totalCountFetched",e)}get pollOptions(){return this._pollOptions}set pollOptions(e){this._pollOptions=e,this.emit("optionsFetched",e)}get voted(){return null!==this.voteId}init(){i.core.isUserAuthorized?this.fetchStatus():this.fetchTotalCount()}async fetchStatus(){try{this.loading=!0,this.totalLoading=!0;const e=this.getLSVoteId(),t=await K.getStatus(this.options.blockId,this.options.story.id,e);this.voteId=e||t.vote,this.voted&&(this.pollOptions=X(t.results)),this.totalCount=t.count_voters}catch(e){console.error(e),i.core.ui.toasts.showError(e)}finally{this.totalLoading=!1,this.loading=!1}}async fetchTotalCount(){try{this.loading=!0,this.totalLoading=!0,this.totalCount=await K.getVotedCount(this.options.blockId,this.options.story.id)}catch(e){console.error(e),i.core.ui.toasts.showError(e)}finally{this.totalLoading=!1,this.loading=!1}}async fetchResults(){try{const e=await K.getResults(this.options.blockId,this.options.story.id);this.pollOptions=X(e)}catch(e){console.error(e),i.core.ui.toasts.showError(e)}finally{this.totalLoading=!1}}async vote(e){try{this.loading=!0,this.totalLoading=!0;const t=await K.vote(this.options.blockId,this.options.story.id,e);this.voteId=e,this.setLSVoteId(e);const s=X(t.results),i=s.reduce(((e,t)=>e+t.count),0);this.pollOptions=s,this.totalCount=i}catch(t){console.error(t),i.core.ui.toasts.showError(t)}finally{this.loading=!1,this.totalLoading=!1}}setLSVoteId(e){const t=this.getLSVotedData();J.m.set(ie,te(te({},t),{},{[this.getLSVotedPollId()]:{id:e,ts:Date.now()}}))}getLSVoteId(){const e=this.getLSVotedData(),t=this.getLSVotedPollId(),s=e[t];return s?Date.now()-s.ts>=2*Q.g4?(delete e[t],J.m.set(ie,e),null):s.id:null}getLSVotedData(){var e;return null!==(e=J.m.get(ie))&&void 0!==e?e:{}}getLSVotedPollId(){return this.options.story.id+"_"+this.options.blockId}}var re=s(42107),ne=s(68505),ae=s(92514);function le(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function ce(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?le(Object(s),!0).forEach((function(t){de(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):le(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function de(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class ue extends W.u{constructor(e){super(e),de(this,"isPreview",!1),de(this,"els",{options:null,total:null,totalCount:null,footer:null,revote:null}),this.init()}set resultsShown(e){var t;null===(t=this.el)||void 0===t||t.classList.toggle("story-poll_results",e)}get resultsShown(){var e;return Boolean(null===(e=this.el)||void 0===e?void 0:e.classList.contains("story-poll_results"))}init(){if(!this.el)return;const e=(0,ne.m)(this,(t=>{if(!t.isIntersecting)return;e();const s=t.target;this.isPreview="1"===s.getAttribute("data-preview"),this.els.footer=s.querySelector(".story-poll__footer"),this.els.options=s.querySelector(".story-poll__options"),this.els.total=s.querySelector(".story-poll__total"),this.els.totalCount=s.querySelector(".story-poll__total > span"),this.els.revote=s.querySelector(".story-poll__action_revote"),this.isPreview||(this.initService(),this.initRevote(),this.initShowResultsBtn()),this.initRadio()}),{threshold:[0,1]})}initService(){var e,t;this.service=new oe({story:this._options.story,blockId:(null===(e=this.el)||void 0===e?void 0:e.dataset.id)||""}),this.listenTo(this.service,"voted",(e=>{var t;return null===(t=this.el)||void 0===t?void 0:t.classList.toggle("story-poll_voted",e)})),this.listenTo(this.service,"optionsFetched",(e=>this.updateOptions(e))),this.listenTo(this.service,"loading",(e=>{var t;return null===(t=this.el)||void 0===t?void 0:t.classList.toggle("story-poll_loading",e)})),this.listenTo(this.service,"totalLoading",(e=>{var t;null===(t=this.els.total)||void 0===t||t.classList.toggle("story-poll__total_loading",e)})),this.listenTo(this.service,"totalCountFetched",(e=>this.setTotalCount(e))),null===(t=this.el)||void 0===t||t.classList.add("anim-on"),this.service.init()}initRevote(){this.els.revote&&this.els.revote.addEventListener("click",(e=>{var t;if(e.preventDefault(),!this.service.voted)return;null===(t=this.el)||void 0===t||t.classList.remove("story-poll_voted");const s=this.service.pollOptions.find((e=>e.id===this.service.voteId));re.cp.getInstance().sendEvent("click",ce({type:"survey_post",button:"revote","size!undefined":null==s?void 0:s.count,length:this.service.totalCount},this._options.story.analyticsData)),this.service.voteId=null}))}initRadio(){var e;const t=G.S.getInstance().get("UIRadio");null===(e=this.el)||void 0===e||e.querySelectorAll("input").forEach((e=>{if(!e)return;const s=new t(e);this.listenTo(s,"change",(async t=>{if(t&&!i.core.isUserAuthorized)return i.core.ui.authRequired(),void requestAnimationFrame((()=>s.checked=!1));if(this.isPreview||!t||this.service.loading||this.service.voted)return;const o=Number(e.value);await this.service.vote(o);const r=this.service.pollOptions.findIndex((e=>e.id===o)),n=this.service.pollOptions[r];re.cp.getInstance().sendEvent("survey_vote_added",ce({type:"survey_post","level!empty":r+1,"size!undefined":null==n?void 0:n.count,length:this.service.totalCount},this._options.story.analyticsData)),s.checked=!1}))}))}updateOptions(e){this.els.options&&e.forEach((e=>{var t;const s=(0,ae.m9)(e.rate),i=null===(t=this.els.options)||void 0===t?void 0:t.querySelector(`[data-id="${e.id}"]`),o=i.querySelector(".story-poll-option__count");i.classList.toggle("story-poll-option_voted",e.id===this.service.voteId),i.style.setProperty("--width",s.replace(",",".").replace(/\s/g,"")),o&&(o.textContent=s+` (${e.count})`)}))}initShowResultsBtn(){var e;if(!this.el)return;const t=async()=>{if(this._options.story.authorId!==i.core.initParams.userID)return;const e=this.resultsShown;e||await this.service.fetchResults(),this.resultsShown=!e,re.cp.getInstance().sendEvent("click",ce({button:this.resultsShown?"view_result":"hide_result",type:"survey_post",length:this.service.totalCount},this._options.story.analyticsData))};null===(e=this.el.querySelector(".story-poll__action_results"))||void 0===e||e.addEventListener("click",(e=>{e.preventDefault(),t()}))}setTotalCount(e){this.els.totalCount&&(this.els.totalCount.textContent=(0,ae.uf)(e))}}var pe=s(55576),he=s(53035),_e=s(41381),me=s(36005);function ge(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function ve(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(s),!0).forEach((function(t){fe(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ge(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function fe(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const ye=new WeakMap;class be extends W.u{constructor(e){super(e),this.show()}show(){if(this.isShown||!this.el)return this;const e=(0,ne.m)(this,(t=>{t.isIntersecting&&(this.getFundraisingInfo(Number(t.target.getAttribute("data-id"))),e())}),{threshold:[0,1]});return this}async getFundraisingInfo(e){if(this.el)try{const t=this._options.story;ye.has(t)||ye.set(t,he.k.getStoryFundraising(e));const{response:s,data:o}=await ye.get(t);if(!s.result)throw new Error(s.message);const r=(0,he.Ao)(o);this.el.firstElementChild&&this.el.removeChild(this.el.firstElementChild);const n=document.createElement("div");n.classList.add("fundraising-widget");const a=i.core.initParams.userID===this._options.story.authorId,l=Boolean(r.active&&r.currentAmount&&r.targetAmount&&r.currentAmount>=r.targetAmount);if(n.innerHTML=r.active?function(e){var t,s="",i=me.escape;return Array.prototype.join,e.completed&&(s+='\n\t<div class="fundraising-widget__completed-header">\n\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__cookie-thumbs-up"><use xlink:href="#icon--ui__cookie-thumbs-up"></use></svg> Сбор завершён!\n\t</div>\n'),s+='\n<h3 class="fundraising-widget__title">'+(null==(t=e.title)?"":t)+"</h3>\n",e.description&&(s+='\n\t<p class="fundraising-widget__description">'+(null==(t=e.description)?"":t)+"</p>\n"),s+='\n<div class="fundraising-progressbar fundraising-widget__progressbar'+i(e.completed?" fundraising-widget__progressbar_completed":"")+'"></div>\n',e.completed||(s+='\n\t<button\n\t\tclass="pkb-normal-btn pkb-normal-btn_with-icon fundraising-widget__donate-btn"\n\t\t'+i(e.actionDisabled?" disabled":"")+'\n\t>\n\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__rub_20"><use xlink:href="#icon--ui__rub_20"></use></svg>\n\t\t<span>Поддержать</span>\n\t</button>\n'),s}(ve(ve({},r),{},{actionDisabled:a,completed:l})):function(e){var t,s="";return s+'<div class="fundraising-widget__closed-text">\n\t<h4 class="fundraising-widget__closed-title">'+(null==(t=e.title)?"":t)+'</h4>\n\t<p class="fundraising-widget__closed-msg">Автор закрыл целевой сбор</p>\n</div>\n<div class="fundraising-widget__closed-img"></div>\n'}({title:o.title}),r.active){const t=new _e.D({el:n.querySelector(".fundraising-widget__progressbar"),value:r.currentAmount,max:r.targetAmount,completed:l});if(t.create(),!a&&!l){const s=n.querySelector(".fundraising-widget__donate-btn"),o=()=>{i.core.initParams.isDeleted?i.core.ui.authRequired():this.openWidget(e,t)};null==s||s.addEventListener("click",o),null==s||s.addEventListener("auxclick",o)}}this.el.appendChild(n)}catch(t){i.core.logger.error("story-fundraising-widget","Не удалось отрендерить виджет",t)}}async openWidget(e,t){const s=this._options.story.getDonationBtnParams();I.c.getInstance().sendEvent("click",ve({button:"author_donation"},s.analyticsParams)),await(0,he.Ll)({userId:s.author.id,storyId:s.storyId,fundraisingId:e,progressbar:t})}}var we=s(49222);var ke=s(70017);let Se="";var Oe=s(31200),Ee=s(86455),Ce=s(82800),xe=s(88358),Te=s(10553);const Ie="aria-label";var Pe,Ae,De,Me;!function(e){e.ALLOWED="allowed",e.ENQUEUED="enqueued",e.RUNNING="running",e.FINISHED="finished"}(Pe||(Pe={}));class Re{constructor({storyId:e,storyNode:t}){this.el=t.querySelector(".story-boost-badge"),this.storyId=e,this.storyNode=t,this.el&&(this.init(),this.initTooltip())}initTooltip(){Re.isTooltipInitialised||(Re.isTooltipInitialised=!0,(0,Oe.kd)({id:"story-boost",target:this.el,text:"Вы&nbsp;попали в&nbsp;список топовых авторов и&nbsp;теперь вам доступен Пикабуст:\n\t\t\tв&nbsp;течение 30&nbsp;дней вы&nbsp;можете отправить два своих поста сразу в&nbsp;Горячее,\n\t\t\tчтобы их&nbsp;заметили как можно больше пользователей. Пикабуст можно включить сейчас\n\t\t\tили сделать это позже. Опция доступна для постов не&nbsp;старше суток",theme:Ce.xb.GREEN,hideByScroll:!1,endDateString:"",wrapperExtraClass:"popup_feature-notification author-content",onMounted:()=>re.cp.getInstance().sendEvent("tip_show",{type:"pikaboost"})}))}init(){switch(this.el.dataset.status){case Pe.ALLOWED:this.initBoost();break;case Pe.ENQUEUED:this.initLoader();break;case Pe.RUNNING:this.initCountdown();break;case Pe.FINISHED:this.initNotification()}}initBoost(){this.el.classList.remove("hint"),this.el.removeAttribute(Ie),this.el.innerHTML=`Пикабуст ${(0,Te.t)("ui__startup")}`,this.el.addEventListener("click",(async()=>{re.cp.getInstance().sendEvent("pikaboost_popup_showed",{post_id:this.storyId});await this.confirmBoost()?(re.cp.getInstance().sendEvent("pikaboost_start_popup_button_tapped",{post_id:this.storyId}),await this.boost()):re.cp.getInstance().sendEvent("pikaboost_popup_closed",{post_id:this.storyId})})),this.el.hidden=!1}async confirmBoost(){var e,t;let s=null===(e=this.storyNode.querySelector(`.${x.B.title.link}`))||void 0===e||null===(t=e.textContent)||void 0===t?void 0:t.trim();return s=s?`«${s}»`:"",await xe.nk.confirmModal({header:"Вы действительно хотите включить Пикабуст?",isHeaderLeftAlign:!0,content:`Будет включен бустинг поста ${s} в Горячем.<br>\n\t\t\t\t\t<strong>Останется бустов: ${i.core.initParams.availableStoryBoosts-1}</strong>`,buttons:[["Включить",Ee.j.SUCCESS,!0],["Отмена",Ee.j.DEFAULT,!1]],wrapperExtraClass:"story-boost-confirm"})}async boost(){try{await E.cf.postOrFail("/ajax.php",{route:"story/boost",story_id:this.storyId}),i.core.ui.toasts.add({content:"Бустинг поста в Горячем включен"}),i.core.initParams.availableStoryBoosts--,this.el.dataset.status=Pe.ENQUEUED,this.init(),i.core.initParams.availableStoryBoosts||document.querySelectorAll(`.story-boost-badge[data-status=${Pe.ALLOWED}]`).forEach((e=>e.remove()))}catch(e){i.core.ui.toasts.showError(e)}}initLoader(){this.el.classList.add("hint"),this.el.setAttribute(Ie,"Пост готовится к бустингу"),this.el.innerHTML=`Подготовка ${(0,Te.t)("ui__startup")}`,this.el.hidden=!1,this.checkStatus()}async checkStatus(){const{data:e}=await E.cf.postOrFail("/ajax.php",{route:"story-boost/get-boost-status",story_id:this.storyId});if(e.is_running)return this.el.dataset.time=String(e.story_boost_until),this.el.dataset.status=Pe.RUNNING,void this.init();setTimeout((()=>this.checkStatus()),1e4)}initCountdown(){var e;if(null===(e=this.el.dataset)||void 0===e||!e.time)return;const t=Number(this.el.dataset.time);this.el.classList.add("hint"),this.el.setAttribute(Ie,"Действует буст поста в Горячем");const s=()=>{const e=Math.round(t-Date.now()/1e3);if(e<0)return this.el.dataset.status=Pe.FINISHED,void this.init();this.el.innerHTML=`${(0,ae.mr)(e)}${(0,Te.t)("ui__startup")}`,setTimeout(s,1e3)};s(),this.el.hidden=!1}initNotification(){this.el.classList.remove("hint"),this.el.removeAttribute(Ie),this.el.innerHTML=`Закончен ${(0,Te.t)("ui__startup")}`;const e=new IntersectionObserver((([t])=>{t.isIntersecting&&(this.readNotification(),e.disconnect())}));this.el.hidden=!1,e.observe(this.el)}async readNotification(){await E.cf.postOrFail("/ajax.php",{route:"story-boost/hide-completed-notification",story_id:this.storyId})}}Ae=Re,Me=!1,(De=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(De="isTooltipInitialised"))in Ae?Object.defineProperty(Ae,De,{value:Me,enumerable:!0,configurable:!0,writable:!0}):Ae[De]=Me;var Ne=s(23627),Be=s(47994),Le=s(8233);class je extends W.u{constructor(e){super(e),this.show()}show(){return this.el?(new Ne.z({el:this.el,story:this._options.story,mode:Be.lL.STORY_TOP}).show().initComments(),this.initReadMoreLink(),this):this}async initReadMoreLink(){if(await(0,Le.y)(),!this.el)return;const e=this.el.querySelector(".comment__content"),t=this.el.querySelector(".comment__all-comments");t&&e&&(e.clientHeight<e.scrollHeight&&(t.innerText="Читать дальше"),t.classList.remove("comment__all-comments_skeleton"))}}var $e=s(91904),Ue=s(19755),Fe=s.n(Ue),Ve=s(51540),He=s(10850);function Ze(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class ze extends W.u{static hideAllOverlays(){"story"===i.core.initParams.pageName&&$e.V.isUserInExperiment($e.t.ADULT_CONTENT_UNDER_POST)&&(ze.isAllOverlaysHidden=!0)}constructor(e){super(e),Ze(this,"overlayObserver",null),this.init()}init(){this.el&&(ze.isAllOverlaysHidden?this.removeOverlay():(this.el.classList.add(x.B.adultOverlay.show),this.overlayObserver=this.initResizeObserver(),this.overlayObserver.observe(this.el),this.handleNsfwGlobalRemoved(),this.initOverlayClick()))}handleNsfwGlobalRemoved(){"story"!==i.core.initParams.pageName&&i.core.ui.on("remove-story-nsfw-overlay",(async e=>{await(0,Le.y)(),e!==this._options.storyId&&(this.removeOverlay(),this._options.isStoryPage&&i.core.ui.emit("remove-story-nsfw-overlay",e))}))}initResizeObserver(){return new ResizeObserver((0,Ve.P)((()=>{this.el&&(this.el.classList.toggle(x.B.adultOverlay.sticky,this.el.clientHeight>i.core.ui.windowHeight),this.el.classList.toggle(x.B.adultOverlay.small,this.el.clientHeight<247))}),100))}initOverlayClick(){var e,t;!this.el||null===(e=this._options.storyConentEl)||void 0===e||!e.classList.contains(x.B.content.overlayed)||null!==(t=this._options.storyConentEl)&&void 0!==t&&t.classList.contains(x.B.content.overlayPermanent)||this.el.addEventListener("click",(async()=>{await this.getNsfwPromptResult()&&(this.emit("removeClick"),this.removeOverlay(),ze.hideAllOverlays())}))}removeOverlay(){var e,t;this.el&&(this.el.classList.remove(x.B.overlayed),null===(e=this._options.storyConentEl)||void 0===e||e.classList.remove(x.B.content.overlayed),this.el.remove(),null===(t=this.overlayObserver)||void 0===t||t.disconnect())}async getNsfwPromptResult(){var e;if(null===(e=this._options.storyConentEl)||void 0===e||!e.classList.contains(x.B.content.overlayPrompt))return Promise.resolve(!0);return(await He.Z.showAdultPopup(!0)).result}}Ze(ze,"isAllOverlaysHidden",!1);const qe=["time"];function We(e,t){if(null==e)return{};var s,i,o=function(e,t){if(null==e)return{};var s,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)s=r[i],t.indexOf(s)>=0||(o[s]=e[s]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)s=r[i],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(o[s]=e[s])}return o}function Ge(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function Ye(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(s),!0).forEach((function(t){Ke(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ge(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Ke(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Xe{constructor(e,t,s){this._options={referrerStoryId:s,id:e||0,el:t,$el:Fe()(t),isLongStory:!1,canVote:!1,inViewport:!1,inViewportForAnalytics:!1,viewingTime:0,viewingTimeForAnalytics:0,elapsedTime:void 0,viewStarted:!1,viewStartedForAnalytics:!1,adViewKey:!1,adId:!1,authorId:0,tags:[],screenIndex:0,topViewBound:void 0,bottomViewBound:void 0,isStoryPage:!1},this._timeoutList=void 0,this._lastViewStarted=void 0,this._lastViewStartedForAnalytics=void 0,this._lastElapsed=void 0,this._unfocusedView=0,this._unfocusedViewForAnalytics=0,this._lastBlurTime=void 0,this._lastBlurTimeForAnalytics=void 0,this._totalViewTime=0,this._totalViewTimeForAnalytics=0,this._firstViewTime=0,this._firstViewTimeForAnalytics=0,this._contentBlocksCount=new Map,this._readingLevelCounter=c.NOT_READ,this._adultOverlay=void 0,this._calculateContentBlocks(),this._options.contentBlock=this.el.querySelector(`.${x.B.content.item}, .story__description`),this.donationButton=this.$el.find(`.${x.B.donate}`),this._donationAnalyticsParam=(0,q.v)(this.el,this.donationButton.get(0)),this.$el.find(`.${x.B.blocks.text} a`).on("click",(e=>{const t=e.currentTarget.getAttribute("href");I.c.getInstance().sendEvent("click_post_link",Ye(Ye({},A.Utils.omit(this.analyticsData,"type_i8")),{},{post_link:t}))})),this.$el.find(`.${x.B.user.link}`).on("click auxclick",(e=>{if(0!==e.button&&1!==e.button)return;const t=void 0!==this.adId&&this.adId;I.c.getInstance().sendEvent("transition_to_author",Ye({post_id:this.id,author_id:this.authorId,type:"from_post",content_type:this.contentTypes,"promo_id!empty":t,"type_i8!empty":this.subsCode,post_donation:this.donationAnalyticsParam},this.el.dataset.extFeed&&{component_name:"extension",screen:this.el.dataset.extFeed}))})),this.$el.find(`.${x.B.community.link}`).on("click auxclick",(e=>{if(0!==e.button&&1!==e.button)return;const t=Number(e.currentTarget.dataset.id);I.c.getInstance().sendEvent("transition_to_community",Ye(Ye({post_id:this.id,type:"from_post",community_id:t,post_donation:this.donationAnalyticsParam},this.subsCode&&{type_i8:this.subsCode}),this.el.dataset.extFeed&&{component_name:"extension",screen:this.el.dataset.extFeed}))})),this.$el.find(`.${x.B.to}`).on("click auxclick",(e=>{0!==e.button&&1!==e.button||this.sendGoToCommentsAnalytics()})),this.$el.find(`.${x.B.title.link}`).on("click auxclick",(e=>{0!==e.button&&1!==e.button||I.c.getInstance().sendEvent("transition_to_post",Ye(Ye({},this.analyticsData),{},{transition_source:"post_title","rec_score!undefined":this.relevanceCoefficient},this.recommendationAlgorithm>0&&{rec_algorithm:this.recommendationAlgorithm}))})),this.$el.find(".story__social-flag").on("click auxclick",(e=>{0!==e.button&&1!==e.button||I.c.getInstance().sendEvent("click",{type:"post_published_"+e.target.dataset.social})})),this.$el.find(".tags__tag").on("click auxclick",(e=>{if(0!==e.button&&1!==e.button)return;const t=e.currentTarget;I.c.getInstance().sendEvent("transition_to_tag",Ye(Ye({},A.Utils.omit(this.analyticsData,"type_i8")),{},{type:"from_post",tag_id:t.dataset.tag,tags:this.tags}))})),this.$el.find(`.${x.B.copy}`).on("click",(e=>{e.preventDefault();const t=e.target.dataset.url;A.Utils.copyToClipboard(decodeURIComponent(t)),i.default.ui.toasts.add("story-link-copy",{content:i.default.i18n("stories-feed.copied")}),I.c.getInstance().sendEvent("content_shared",Ye(Ye({},this.analyticsData),{},{type:"copy_link"}))})),this.$el.find(`.${x.B.series} a`).on("click auxclick",(()=>{I.c.getInstance().sendEvent("transition_to_post_series",Ye(Ye({},this.analyticsData),{},{type:"post_header",post_series_id:this._options.seriesId}))})),this.$el.find(`.${x.B.seriesNav} a`).on("click auxclick",(e=>{const t=e.target.dataset;I.c.getInstance().sendEvent("transition_to_post",{type:"next"===t.type?"post_series_next_post":"post_series_prev_post",post_id:t.seriesStoryId,post_series_id:this._options.seriesId})})),this.$el.find(".story__experts-badge").on("click auxclick",(e=>{0!==e.button&&1!==e.button||I.c.getInstance().sendEvent("transition_to_tab",{transition_source:"label",type:"experts",level:70})})),this.$el.find(".story__title-comstories").on("click auxclick",(e=>{var t;0!==e.button&&1!==e.button||I.c.getInstance().sendEvent("transition_to_post_answers",Ye(Ye({},this.analyticsData),{},{type:"horn",size:null===(t=e.currentTarget.textContent)||void 0===t?void 0:t.trim()}))})),this.$el.find(`.${x.B.blocks.text} .${x.B.spoiler}`).on("click",(e=>e.currentTarget.classList.remove(x.B.spoiler))),this._initMonetization(),this.el.querySelectorAll(".tags__tag").forEach((e=>{e.dataset.analyticsType="post_popup"})),this._initCompanyBlogBadgeAnalytics(),this._initAdultOverlay(),this._saveTagsListFromElement(),this._initParentLinkAnalytics(),this._initSubscribeToCommunityBtn(),this.emotions,this._initAnswerAnalyticsFromSpecialsPromo(),this._initSurveys(),this._initCarousels(),this._initStoryTopComment(),this._getOptionsFromData(),this._init()}removeNsfwOverlay(){const e=this.el.querySelector(`.${x.B.adultOverlay.el}`);if(!e)return;const t=this.el.querySelector(`.${x.B.content.item}`);this.el.classList.remove(x.B.overlayed),t.classList.remove(x.B.content.overlayed),e.remove()}_init(){this.isAdStory&&this._setAdLinksToken(),new Re({storyId:this.id,storyNode:this.el}),this.isAdSlot&&I.c.getInstance().sendEvent("ad_load",Ye(Ye({},this.analyticsData),{},{type:"feed",content_type:"partner_material"}))}_initAdultOverlay(){if(!this.el.classList.contains(x.B.overlayed))return;const e=this.el.querySelector(`.${x.B.adultOverlay.el}`);e&&(this.adultOverlay=new ze({el:e,storyId:this.id,isStoryPage:this.isStoryPage,storyConentEl:this.el.querySelector(`.${x.B.content.item}`)}),i.default.listenToOnce(this.adultOverlay,"removeClick",(()=>{i.default.ui.emit("remove-story-nsfw-overlay",this.id),this.isCollapsed&&(this.isCollapsed=!1)})))}_initCompanyBlogBadgeAnalytics(){var e;const t=null===(e=this.el)||void 0===e?void 0:e.querySelector(".story__company-blog-badge");if(!t)return;const s=()=>{I.c.getInstance().sendEvent("click",{type:"company_blog_label",post_id:this.id})};t.addEventListener("click",s),t.addEventListener("auxclick",(e=>{1===e.button&&s()}))}_initContentShowObserver(){let e,t;if(this.isCollapsed){e=new IntersectionObserver((e=>{e.every((e=>!e.isIntersecting))?this._stopKeepTrackContentViewedTime("scroll"):o()}),{rootMargin:"0px",threshold:1});const t=this.el.querySelector("."+x.B.header),s=this.el.querySelector("."+x.B.tags.wrapper);if(!t||!s)return;e.observe(t),e.observe(s)}else{if(!this.contentInner)return;t=new IntersectionObserver((([e])=>{e.isIntersecting?o():this._stopKeepTrackContentViewedTime("scroll")}),{rootMargin:"0px",threshold:0}),t.observe(this.contentInner)}const s=2===i.default.initParams.storiesDisplayMode?1:0,o=async()=>{if(this.isAdSlot)return void I.c.getInstance().sendEvent("show_ad",Ye(Ye({},this.analyticsData),{},{type:"feed",content_type:"partner_material"}));const e=await(await Z.getInstance()).view(Number(this.id));P.D.sendEvent("content_showed",Ye(Ye(Ye(Ye({},this.analyticsData),{},{length:this.el.dataset.textLength,rec_score:this.relevanceCoefficient,hide_visited:s,feeds:e},this.recommendationAlgorithm>0&&{rec_algorithm:this.recommendationAlgorithm}),this.isLongStory&&{show_full_post:this.isCollapsedLongStory?0:1}),this.isAdNormalView&&{type:"partner_material"})),this._startKeepTrackContentViewedTime()}}_getOptionsFromData(){var e;const t=this.el.dataset;this._options.isBlogStory=Boolean(t.blog),this._options.isStoryPage="true"===t.page,this._options.isLongStory="true"===t.storyLong,this._options.sliceType=n[t.sliceType]||n.NONE,this.isLongStory&&(this._options.isCollapsedLongStory=this.$readMore&&"none"!==this.$readMore.style.display);const s=t.vid?parseInt(t.vid.slice(1),10):void 0,o=t.vkey&&"sdVk"!==t.vkey?t.vkey:void 0;if(this._options.adId=!(!(0,d.isFinite)(s)||s===this.id)&&s,this._options.adViewKey=o,this._options.isCustomAdvert=Boolean(t.ca),this._options.isAdShortRead=!0,this._options.isAdViewed=!0,this._options.isBlogStoryViewed=!0,this._options.isBlogStoryRead=!0,this.isAdStory?(this._options.isAdShortRead=C.o.isShortRead(o,this.referrerStoryId),this._options.isAdViewed=C.o.isViewed(o,this.referrerStoryId)):this.isBlogStory&&(this._options.isBlogStoryViewed=!1,this._options.isBlogStoryRead=!1),this.referrerStoryId&&(this.el.dataset.rsid=String(this.referrerStoryId)),this.authorId=t.authorId||0,this.authorName=null!==(e=t.authorName)&&void 0!==e?e:"",this.commentsCount=t.comments||0,this.recommendationAlgorithm=t.recomAlgo||void 0,this.relevanceCoefficient=t.recomCoef||void 0,this.algorithm=t.recomAlgo||void 0,this.score=t.recomCoef||void 0,this.isSubscribed=t.hasAuthorSubs||void 0,this.isExperts=t.isExperts||void 0,this._options.isCollapsed=this.el.classList.contains(x.B.collapse),this._options.canVote="true"===t.canVote,this._options.isCommentsDisabled=null===this.el.querySelector("."+x.B.comments.count),this._options.isVisited="true"===t.visited,this._options.isViewed=T.N.isViewed(this.id),this._options.seriesId=Number(t.seriesId)||0,this._options.seriesStoriesCount=Number(t.seriesStoriesCount)||0,this._options.contextActions=t.contextMenu?t.contextMenu.split(","):[],this._options.contextActions.includes("report")){i.default.initParams.reportReasons.filter((e=>e.type===B.f0.post)).length||(this._options.contextActions=this._options.contextActions.filter((e=>"report"!==e)))}return this._options.subsCode=t.subsCode?Number(t.subsCode):void 0,setTimeout((()=>{this._autoCorrectCollapsed()})),this.setOptions({vote:r[parseInt(t.vote,10)],rating:t.rating,isSaved:"true"===t.saved}),this._options.isStoryPage&&this._sendSaveRead(),this.isBlogStory&&this.$el.find(`.${x.B.blocks.video}`).one("click",(()=>{j.r.instance.logVideoClick(this)})),this._initReadingAnalytics(),this}async _sendSaveRead(){if(this.isAdStory){const t={advert_id:this._options.adId,rsid:this.relevanceCoefficient};if(document.referrer)try{t.rd=new URL(document.referrer).hostname}catch(e){}E.cf.post("/ajax/save_read.php",t)}else this.isBlogStory&&j.r.instance.logStoryPageOpen(this)}_saveTagsListFromElement(){const e=this.el.querySelectorAll(".tags__tag");e.length>0&&(this._options.tags=Array.from(e).map((e=>e.dataset.tag)))}_calculateContentBlocks(){const e={video:0,videofile:0,text:0,gif:0,image:0,fundraising:0,imageTitles:0,poll:0,carousel:0};this.$el.find(`.${x.B.block}`).each(((t,s)=>{if(s.classList.contains(x.B.blocks.video)){return Fe()(s).children('[data-type="video"]').length>0?void this._contentBlocksCount.set("video",++e.video):void this._contentBlocksCount.set("videofile",++e.videofile)}if(s.classList.contains(x.B.blocks.image)){const t=Fe()(s).children('[data-type="gifx"]').length>0;return Fe()(s).children(".story-block__title").length>0&&this._contentBlocksCount.set("imageTitles",++e.imageTitles),t?void this._contentBlocksCount.set("gif",++e.gif):void this._contentBlocksCount.set("image",++e.image)}s.classList.contains(x.B.blocks.fundraising)?this._contentBlocksCount.set("fundraising",++e.fundraising):s.classList.contains(x.B.blocks.poll)?this._contentBlocksCount.set("poll",++e.poll):s.classList.contains(x.B.blocks.carousel)?this._contentBlocksCount.set("carousel",++e.carousel):this._contentBlocksCount.set("text",++e.text)}))}_autoCorrectCollapsed(){if(this.isAdNormalView||!this.isLongStory||this.sliceType===n.NONE||!this.isCollapsedLongStory)return;let e=this.contentInner;if(!e)return;let t=e.offsetWidth,s=e.offsetHeight,i=e.scrollHeight;if(this.sliceType===n.BY_BLOCK&&(i+=this.hiddenBlocksHeight,this.$el.find(`.${x.B.blocks.video}`).each(((e,s)=>{i+=s.offsetHeight<50?t/1.7777777777777777:0}))),0===s||i-p>s)return;this._options.isCollapsedLongStory=!1,this._updateCollapsedLongStory(!1),this._options.sliceType=n.NONE,this._options.isLongStory=!1;const o=this.$readMore;o&&(o.style.display="none")}setOptions(e){return(0,d.isObject)(e)?((0,d.forEach)(e,((e,t)=>{this[t]=e})),this):this}destroy(){var e;this.__destroyed=!0,this.cancelTimeout(),null===(e=this._options._carousels)||void 0===e||e.forEach((e=>e.destroy()));for(let t in this._options)this._options.hasOwnProperty(t)&&delete this._options[t];delete this._options}voteDirection(e,t=!1){if(requestIdleCallback((()=>{I.c.getInstance().yandex.goal("vote-for-story"),I.c.getInstance().yandex.goal(e.value>0?"tap-post-plus":"tap-post-minus"),I.c.getInstance().google.event(e.value>0?"like":"dislike","post")})),t&&(e<r.DOWN||e>r.UP))return this;let s=null,o="";this.vote===r.NONE?o=e===r.UP?"content_liked":"content_disliked":(o="content_rating_canceled",s=this.vote===r.UP?1:-1),I.c.getInstance().sendEvent(o,Ye(Ye(Ye(Ye(Ye(Ye(Ye(Ye({post_id:this.id,author_id:this.authorId},s&&{type:s}),{},{time:this.getViewTimeMS(),comments:this.commentsCount},void 0!==this.relevanceCoefficient&&{rec_score:this.relevanceCoefficient}),this.recommendationAlgorithm>0&&{rec_algorithm:this.recommendationAlgorithm}),this.screenIndex>0&&{screen_index:this.screenIndex}),this.subsCode&&{type_i8:this.subsCode}),{},{post_donation:this.donationAnalyticsParam},this.isFromRecommendations&&{component_name:"post_recs"}),this.el.dataset.extFeed&&{component_name:"extension",screen:this.el.dataset.extFeed}),i.default.ui.actionBarShown&&{action_bar:"1"}));const n=e!==this.vote?e:e===r.UP?r.DOWN:r.UP;return this.vote=this.vote+n.valueOf(),this}timeout(e,t,s,i=!0,...o){i&&this.cancelTimeout(e);let r=this._timeoutList;r||(this._timeoutList=r=new Map);let n=()=>{s.apply(this,o),r.delete(e)};return r.set(e,{callback:n,handler:setTimeout(n,t)}),this}cancelTimeout(...e){if(!this._timeoutList||!this._timeoutList.size)return this;if(e.length)e.forEach((e=>{this._timeoutList.has(e)&&(clearTimeout(this._timeoutList.get(e).handler),this._timeoutList.delete(e))}));else{for(let{handler:e}of this._timeoutList.values())clearTimeout(e);this._timeoutList.clear()}return this}updateViewBounds(){let e,t;this._options.contentBlock?(e=this._options.contentBlock.offsetTop,t=this._options.contentBlock.offsetHeight):(e=0,t=0);const s=this.offsetTop+e,o=Math.max(i.default.ui.scrollTop-s,0);(o<this._options.topViewBound||void 0===this._options.topViewBound)&&(this._options.topViewBound=o);const r=Math.min(i.default.ui.scrollTop+i.default.ui.windowHeight-s,t);(r>this._options.bottomViewBound||void 0===this._options.bottomViewBound)&&(this._options.bottomViewBound=r)}getViewTimeMS(){return void 0!==this._lastViewStarted?this._totalViewTime+Date.now()-this._lastViewStarted-this._unfocusedView:this._totalViewTime}async _syncVote(){if(this.vote===this.voteSync)return;const{response:e,data:t}=await E.cf.post("/ajax/vote_story.php",{story_id:this.id,vote:this.vote.valueOf()});e.result?(this.voteSync=this.vote,t&&t.is_show_subscribe_block&&this._createSubscribeAuthorPopup()):(this.vote=this.voteSync,e.message&&i.default.ui.toasts.showError(e.message))}onWindowFocusChanged(e){if(!e)return this._stopKeepTrackContentViewedTime("close"),this._sendShowPostEvent(!0),this._lastBlurTime=Date.now(),void(this._lastBlurTimeForAnalytics=Date.now());this._unfocusedView+=isNaN(Date.now()-this._lastBlurTime)?0:Date.now()-this._lastBlurTime,this._unfocusedViewForAnalytics+=isNaN(Date.now()-this._lastBlurTimeForAnalytics)?0:Date.now()-this._lastBlurTimeForAnalytics,this._lastBlurTime=void 0,this._lastBlurTimeForAnalytics=void 0,this._isInFocusForContentViewed()&&this._startKeepTrackContentViewedTime()}_onStoryBeforeUnload(){this._stopKeepTrackContentViewedTime("close")}onSessionRegenerated(){this._resetShowPostInfo(),this._resetShowPostInfoForAnalytics()}_resetShowPostInfo(){void 0!==this._lastViewStarted&&(this._lastViewStarted=Date.now(),0===this._firstViewTime&&this.isStoryPage&&(this._firstViewTime=this._lastViewStarted),this._unfocusedView=0,void 0!==this._lastBlurTime&&(this._lastBlurTime=this._lastViewStarted))}_resetShowPostInfoForAnalytics(){void 0!==this._lastViewStartedForAnalytics&&(this._lastViewStartedForAnalytics=Date.now(),0===this._firstViewTimeForAnalytics&&this.isStoryPage&&(this._firstViewTimeForAnalytics=this._lastViewStartedForAnalytics),this._unfocusedViewForAnalytics=0,void 0!==this._lastBlurTimeForAnalytics&&(this._lastBlurTimeForAnalytics=this._lastViewStartedForAnalytics))}_sendShowPostEvent(e=!1){this.isDestroyed||this.isAdSlot||(!e&&this._options.viewStarted&&this.timeout("view-time",2e3,this._sendShowPostEvent),void 0!==this._lastViewStarted&&void 0===this._lastBlurTime&&I.c.getInstance().sendEvent("show_post",this.getShowPostAnalyticsData()))}getShowPostAnalyticsData(){const e=this.analyticsData,{time:t}=e,s=We(e,qe),i=Ye(Ye(Ye(Ye(Ye({create_at:this.isStoryPage?this._firstViewTime:this._lastViewStarted,view_time:this.isStoryPage?N.Z.getInstance().getViewTime(`story-${this.id}`):(this._totalViewTime+Date.now()-this._lastViewStarted-this._unfocusedView)/1e3,view_ratio:this.viewRatio},this.isLongStory&&{show_full_post:this.isCollapsedLongStory?0:1}),s),{},{"rec_score!undefined":this.relevanceCoefficient},this.recommendationAlgorithm>0&&{rec_algorithm:this.recommendationAlgorithm}),this.el.dataset.extFeed&&{component_name:"extension",screen:this.el.dataset.extFeed}),this.isAdNormalView&&{type:"partner_material"});if(this._contentBlocksCount.get("videofile")>0){const e=L.FW.getVolumePercents();i.sound_on=Boolean(e),i.sound_volume=e}return i}getDonationBtnParams(){return this.donationButton.length?{storyId:this.id,author:{id:this.authorId,name:this.authorName,avatar:this.donationButton.attr("data-avatar"),approved:this.donationButton.attr("data-user-approved")},analyticsParams:Ye(Ye({},this.analyticsData),{},{"subscribers!undefined":this.donationButton.attr("data-subs-count"),"rating!undefined":this.donationButton.attr("data-karma")})}:{}}checkVisited(){return this.isVisited||this.viewingTime>=g}checkVisitedForAnalytics(){return this.isVisited||this.viewingTimeForAnalytics>=g}checkViewed(){return this.isViewed||this.viewingTime>=h}checkViewedForAnalytics(){return this.isViewed||this.viewingTimeForAnalytics>=h}checkAdViewed(){return this.isAdViewed||this.viewingTime>=_}checkAdShortRead(){return this.isAdShortRead||this.viewingTime>=m}checkBlogStoryRead(){return this.isBlogStoryRead||this.viewingTime>=f}checkBlogStoryViewed(){return this.isBlogStoryViewed||this.viewingTime>=v}_updateRating(){}_updateCollapsed(e){}_updateCollapsedLongStory(e){}_updateViewedCount(e){const t=(0,ae.uf)(e),s=A.Utils.reduceNumber(e);this.$viewedCount.text(s).parent().attr("aria-label",t+" "+i.default.i18n("plural.views",e)),this.$viewedCount.data("hint")&&this.$viewedCount.data("hint").destroy()}_updateSaved(e){}_initParentLinkAnalytics(){const e=this.$el.find(`.${x.B.parentLink}`);e.length&&e.on("click auxclick",(e=>{0!==e.button&&1!==e.button||I.c.getInstance().sendEvent("transition_to_post",Ye(Ye({},this.analyticsData),{},{transition_source:"parent_post"}))}))}_initReadingAnalytics(){!this.isDestroyed&&Boolean(this.adId)&&this.isLongStory&&(this._options.readingObserverPostCollapsed||(this._options.readingObserverPostCollapsed=new R({observedElement:this.el.querySelector(".story__content-inner"),percent:[1],callback:()=>{this._readingLevelCounter=c.BEGIN_READING},observeCondition:()=>!this.isDestroyed&&Boolean(this.adId)&&this.isLongStory&&this.isCollapsedLongStory})),this._options.readingObserverPostCollapsed.observe())}_setReadingObserverPostOpened(e){this._options.readingObserverPostOpened||e||(this._options.readingObserverPostOpened=new R({observedElement:this.el.querySelector(".story__content-inner"),percent:this._readingLevelCounter===c.BEGIN_READING?[50,100]:[1,50,100],callback:()=>{switch(this._readingLevelCounter){case c.NOT_READ:this._readingLevelCounter=c.BEGIN_READING;break;case c.BEGIN_READING:this._readingLevelCounter=c.HALF_READING,E.cf.post("/ajax/save_read.php",{advert_id:this.adId,p:50});break;case c.HALF_READING:this._readingLevelCounter=c.FULL_READING,E.cf.post("/ajax/save_read.php",{advert_id:this.adId,p:100})}},observeCondition:()=>!this.isDestroyed&&Boolean(this.adId)&&this.isLongStory&&!this.isCollapsedLongStory}),this._options.readingObserverPostOpened.observe())}_initLabelRecommendedAnalytics(){this.$el.find(".story__rec, .story__label_rec").length&&this.$el.on("click auxclick",".story__rec, .story__label_rec",(()=>{const e={level:41,type:"post_header_recommended",post_id:this.id,rec_score:this.relevanceCoefficient,rec_algorithm:this.recommendationAlgorithm,screen_index:this.screenIndex,comments:this.commentsCount,author_id:this.authorId,"type_i8!undefined":this.subsCode};I.c.getInstance().sendEvent("transition_to_tab",e),z.d.send("transitionToTab",{level:41,type:"post_header_recommended",postId:this.id,recScore:this.relevanceCoefficient,recAlgorithm:this.recommendationAlgorithm,screenIndex:this.screenIndex,comments:this.commentsCount,authorId:this.authorId,typeI8:this.subsCode})}))}_initAnswerAnalyticsFromSpecialsPromo(){this.el.querySelector('iframe[src^="https://specials.pikabu.ru"]')&&window.addEventListener("message",(function(e){var t;if("https://specials.pikabu.ru"!==e.origin)return;let s;try{s=JSON.parse(e.data)}catch(i){}"promo_quiz_click"===(null===(t=s)||void 0===t?void 0:t.event)&&I.c.getInstance().sendEvent("click",{type:"promo_quiz_click"})}))}_createSubscribeAuthorPopup(){}_initSubscribeToCommunityBtn(){const e=this.el.querySelector(".story__community-subscribe");if(!(e instanceof HTMLButtonElement))return;i.default.listenTo(i.default,"subscribeEnded",(s=>{"community"===s.type&&s.id===e.dataset.cid&&s.isSubscribed&&t()}));const t=()=>{var t;const i=`.story .story__community-subscribe[data-cid="${e.dataset.cid}"]`;null===(t=document.querySelectorAll(i))||void 0===t||t.forEach((e=>{e.disabled=!0,e.lastChild.textContent="Вы подписаны"})),e.removeEventListener("click",s)},s=({currentTarget:e})=>{const s=e.dataset.cid;i.default.initParams.isDeleted?i.default.ui.authRequired():!e.disabled&&s&&(t(),new $.S1(s).subscribe(!0,Ye({type:"post_header",post_id:this.id,author_id:this.authorId},this.el.dataset.extFeed&&{component_name:"extension",screen:this.el.dataset.extFeed})))};e.addEventListener("click",s)}_initMonetization(){const e=this.donationButton.get(0);null==e||e.addEventListener("click",(()=>this.makeDonation(e)));const t=this.el.querySelector(`.${x.B.subscribeButton}`);null==t||t.addEventListener("click",(()=>{I.c.getInstance().sendEvent("paid_author_subscription_button_tapped",{component_name:"paid_post",author_id:this.authorId,size:100*t.dataset.cost,post_id:this.id}),(0,pe.B)({authorId:this.authorId,supportType:"subscribe",storyId:this.id})}));const s=this.el.querySelector(`.${x.B.subscribeHelpLink}`);null==s||s.addEventListener("click",(()=>{I.c.getInstance().sendEvent("click",{button:"paid_author_subscription_about",component_name:"paid_post",post_id:this.id})}))}makeDonation(e){i.default.initParams.isDeleted?i.default.ui.authRequired():(I.c.getInstance().sendEvent("author_donation_button_tapped",Ye({component_name:"post",type:"author_support",subscribers:e.dataset.subsCount},i.default.ui.actionBarShown&&{action_bar:"1"})),(0,pe.B)({authorId:this.authorId,supportType:"donate",giveChoice:!0,storyId:this.id}))}_initFundraising(){const e=this.$el.find(`.${x.B.blocks.fundraising}`);e.length&&e.each(((e,t)=>{new be({el:t,story:this})}))}_startKeepTrackContentViewedTime(){this.isAdSlot||(this._contentViewPostStarted=Date.now())}_stopKeepTrackContentViewedTime(e){this.isDestroyed||!this._contentViewPostStarted||this.isAdSlot||(P.D.sendEvent("content_viewed",Ye(Ye({},this.getShowPostAnalyticsData()),{},{view_time:Date.now()-this._contentViewPostStarted,create_at:this._contentViewPostStarted,reason:e})),this._contentViewPostStarted=null)}_isInFocusForContentViewed(){if(!this._options.contentBlock)return!1;const{top:e,bottom:t}=this._options.contentBlock.getBoundingClientRect();return e<=i.default.ui.windowHeight&&t>=0}sendGoToCommentsAnalytics(){I.c.getInstance().sendEvent("transition_to_post",Ye(Ye(Ye({},this.analyticsData),{},{transition_source:"comments_button","rec_score!undefined":this.relevanceCoefficient},this.recommendationAlgorithm>0&&{rec_algorithm:this.recommendationAlgorithm}),i.default.ui.actionBarShown&&{action_bar:"1"}));const e=this.tagsMask;I.c.getInstance().sendEvent("go_to_comments_button_tapped",Ye(Ye(Ye({},this.analyticsData),e>0&&{tags_mask:e}),i.default.ui.actionBarShown&&{action_bar:"1"}))}_setAdLinksToken(){this.el.querySelectorAll('a[href*="cpm_token"]').forEach((e=>{const t=new URL(e.href);t.searchParams.set("cpm_token",(Se||(Se=function(e,t=0){let s,i,o,r;const n=3&e.length,a=e.length-n;s=t;const l=3432918353,c=461845907;for(r=0;r<a;)o=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24,++r,o=(65535&o)*l+(((o>>>16)*l&65535)<<16)&4294967295,o=o<<15|o>>>17,o=(65535&o)*c+(((o>>>16)*c&65535)<<16)&4294967295,s^=o,s=s<<13|s>>>19,i=5*(65535&s)+((5*(s>>>16)&65535)<<16)&4294967295,s=27492+(65535&i)+((58964+(i>>>16)&65535)<<16);switch(o=0,n){case 3:o^=(255&e.charCodeAt(r+2))<<16;case 2:o^=(255&e.charCodeAt(r+1))<<8;case 1:o^=255&e.charCodeAt(r),o=(65535&o)*l+(((o>>>16)*l&65535)<<16)&4294967295,o=o<<15|o>>>17,o=(65535&o)*c+(((o>>>16)*c&65535)<<16)&4294967295,s^=o}return s^=e.length,s^=s>>>16,s=2246822507*(65535&s)+((2246822507*(s>>>16)&65535)<<16)&4294967295,s^=s>>>13,s=3266489909*(65535&s)+((3266489909*(s>>>16)&65535)<<16)&4294967295,s^=s>>>16,s>>>0}(i.core.initParams.aqpt+ke.e.get("pcid")).toString()),Se)),e.href=t.toString()}))}async _initSurveys(){const e=this.$el.find(".story-poll");e.length&&e.each(((e,t)=>{new ue({el:t,story:this})}))}_initCarousels(){this._contentBlocksCount.has("carousel")&&this.el.querySelectorAll(".carousel_images").forEach((e=>{this._options._carousels||(this._options._carousels=[]);const t=new we.b({el:e});this._options._carousels.push(t)}))}_initStoryTopComment(){if(!$e.V.isUserInExperiment($e.t.COMMENT_POSITION_ON_TAG_PAGE)&&!$e.V.isUserInExperiment($e.t.COMMENT_POSITION_ON_HOT_PAGE)&&!$e.V.isUserInExperiment($e.t.COMMENT_POSITION_ON_POST_PAGE))return;const e=this.el.querySelector(".story-top-comment");e&&new je({el:e,story:this})}onPopupShown(){this._stopKeepTrackContentViewedTime("popup")}onPopupHidden(){this._isInFocusForContentViewed()&&this._startKeepTrackContentViewedTime()}get isDestroyed(){return this.__destroyed}get isHidden(){return this.$el.is(":hidden")}get isCommentsDisabled(){return this._options.isCommentsDisabled}get offsetTop(){return this.el.offsetTop}get offsetHeight(){return this.el.offsetHeight}get vote(){return this._options.vote}set vote(e){let t=this._options.vote;(e=r[e]||r.NONE)&&this.canVote&&(this._options.vote=e,t?(e!==this.voteSync&&(this._voteDebounce||(this._lastElapsed=this.viewingTime,this._voteDebounce=(0,d.debounce)(this._syncVote.bind(this),700)),this._voteDebounce(e)),this._updateRating()):this.voteSync=e)}get subsCode(){return this._options.subsCode}get rating(){return this._options.rating}set rating(e){const t=this._options.rating;void 0===e||isNaN(e)||t===e||(!this.vote||t||this.vote===r.DOWN?this._options.rating=e:this._options.rating=e-this.vote.valueOf())}get voteSync(){return this._options.voteSync}set voteSync(e){this._options.voteSync=r[e]||r.NONE}get isVisited(){return this._options.isVisited}set isVisited(e){const t=this._options.isVisited;t!==e&&!0!==t&&(this._options.isVisited=e)}get isViewed(){return this._options.isViewed}set isViewed(e){const t=this._options.isViewed;t!==e&&!0!==t&&(this._options.isViewed=e)}get isAdViewed(){return this._options.isAdViewed}set isAdViewed(e){const t=this._options.isAdViewed;t!==e&&!0!==t&&(this._options.isAdViewed=e,this.isAdStory&&C.o.setViewed(this.adViewKey,this.referrerStoryId))}get isAdShortRead(){return this._options.isAdShortRead}set isAdShortRead(e){let t=this._options.isAdShortRead;t!==e&&!0!==t&&(this._options.isAdShortRead=e,this.isAdStory&&(i.default.logger.log("ad","set isAdShortRead to",e,this.id,this.adViewKey),C.o.setShortRead({adViewKey:this.adViewKey,referrerStoryId:this.referrerStoryId,isStoryPage:this.isStoryPage})))}get isBlogStoryRead(){return this._options.isBlogStoryRead}set isBlogStoryRead(e){let t=this._options.isBlogStoryRead;t!==e&&!0!==t&&(this._options.isBlogStoryRead=e)}get isBlogStoryViewed(){return this._options.isBlogStoryViewed}set isBlogStoryViewed(e){let t=this._options.isBlogStoryViewed;t!==e&&!0!==t&&(this._options.isBlogStoryViewed=e,this.isBlogStory&&j.r.instance.logViewing(this))}get viewedCount(){return this._options.viewedCount}set viewedCount(e){this._options.viewedCount===e||!Number.isFinite(e)||e<0||(this._options.viewedCount=e,this._updateViewedCount(e))}get emotions(){if(this._options.emotions)return this._options.emotions;const e=this.$el.find(".story__emotions");return e.length?this._options.emotions=new D.f({story:this,$el:e}):void 0}get isSaved(){return this._options.isSaved}set isSaved(e){const t=this._options.isSaved;t!==e&&(this._options.isSaved=e,void 0!==t&&this._updateSaved(e))}get id(){return this._options.id}get adId(){return this._options.adId}get adViewKey(){return this._options.adViewKey}get referrerStoryId(){return this._options.referrerStoryId}get el(){return this._options.el}get $el(){return this._options.$el}get $readMore(){return this._options.$readMore||(this._options.$readMore=this.el.querySelector("."+x.B.readMore.button)),this._options.$readMore}get isLongStory(){return this._options.isLongStory}get sliceType(){return this._options.sliceType}get canVote(){return this._options.canVote}get isCollapsed(){return this._options.isCollapsed}set isCollapsed(e){if(e=Boolean(e),this._options.isCollapsed===e)return e;this.viewStarted=!e&&this.inViewport,this.viewStartedForAnalytics=!e&&this.inViewportForAnalytics,this._updateCollapsed(e),this._options.isCollapsed=e}get isCollapsedLongStory(){return this._options.isCollapsedLongStory}set isCollapsedLongStory(e){let t=this._options.isCollapsedLongStory;e=Boolean(e),this.isLongStory&&t!==e&&(this._setReadingObserverPostOpened(e),this._options.isCollapsedLongStory=e,setTimeout((()=>{this.isDestroyed||this._updateCollapsedLongStory(e)})),this._initReadingAnalytics(),e||(this.isAdStory?!this.referrerStoryId&&"story"===i.default.initParams.pageName||C.o.isClickReadMore(this.id)||C.o.setClickReadMore(this.id,this.adId,this.referrerStoryId):this.isBlogStory&&j.r.instance.logReadMoreClick(this)))}get inViewport(){return this._options.inViewport}set inViewportForAnalytics(e){e=Boolean(e),this._options.inViewportForAnalytics!==e&&(this.viewStartedForAnalytics=e&&!this.isCollapsed,this._options.inViewportForAnalytics=e)}get inViewportForAnalytics(){return this._options.inViewportForAnalytics}set inViewport(e){e=Boolean(e),this._options.inViewport!==e&&(this.viewStarted=e&&!this.isCollapsed,this._options.inViewport=e,this.$el.find('script[type="text/string"][data-event="in-view"], script[data-event="story-in-view"]').replaceWith((function(){return atob(this.textContent)})))}get viewStarted(){return this._options.viewStarted}get viewStartedForAnalytics(){return this._options.viewStartedForAnalytics}set viewStarted(e){this._options.viewStarted!==(e=Boolean(e))&&(this._options.viewStarted=e,e?(this._lastViewStarted=Date.now(),0===this._firstViewTime&&this.isStoryPage&&(this._firstViewTime=this._lastViewStarted),this._unfocusedView=0,void 0!==this._lastBlurTime&&(this._lastBlurTime=this._lastViewStarted),this.timeout("view-time",2e3,this._sendShowPostEvent)):this._lastViewStarted&&(this.cancelTimeout("view-time"),this._sendShowPostEvent(!0),this._options.viewingTime+=Math.round((Date.now()-this._lastViewStarted)/1e3),this.isStoryPage&&(this._totalViewTime+=Date.now()-this._lastViewStarted-this._unfocusedView),this._lastViewStarted=void 0))}set viewStartedForAnalytics(e){this._options.viewStartedForAnalytics!==(e=Boolean(e))&&(this._options.viewStartedForAnalytics=e,e?(this._lastViewStartedForAnalytics=Date.now(),0===this._firstViewTimeForAnalytics&&this.isStoryPage&&(this._firstViewTimeForAnalytics=this._lastViewStartedForAnalytics),this._unfocusedViewForAnalytics=0,void 0!==this._lastBlurTimeForAnalytics&&(this._lastBlurTimeForAnalytics=this._lastViewStartedForAnalytics)):this._lastViewStartedForAnalytics&&(this._options.viewingTimeForAnalytics+=Math.round((Date.now()-this._lastViewStartedForAnalytics)/1e3),this.isStoryPage&&(this._totalViewTimeForAnalytics+=Date.now()-this._lastViewStartedForAnalytics-this._unfocusedViewForAnalytics),this._lastViewStartedForAnalytics=void 0))}get viewingTime(){return this._lastViewStarted?this._options.viewingTime+Number(((Date.now()-this._lastViewStarted)/1e3).toFixed(1)):this._options.viewingTime}get viewingTimeForAnalytics(){return this._lastViewStartedForAnalytics?this._options.viewingTimeForAnalytics+Number(((Date.now()-this._lastViewStartedForAnalytics)/1e3).toFixed(1)):this._options.viewingTimeForAnalytics}get elapsedTime(){return this._options.elapsedTime?this._options.elapsedTime:this._lastElapsed?this._options.elapsedTime=this._lastElapsed:this._options.elapsedTime}get progressReading(){return this._options.progressReading}set progressReading(e){this._options.progressReading=e}get isMetrikaVisited(){return this._options.metrikaVisited}set isMetrikaVisited(e){this._options.metrikaVisited=Boolean(e)}get authorId(){return this._options.authorId}set authorId(e){this._options.authorId=Number(e)}get authorName(){return this._options.authorName}set authorName(e){this._options.authorName=e}get contentTypes(){let e=[];for(const[t,s]of this._contentBlocksCount.entries())s>0&&e.push(`${b[t]}:${s}`);return e.join("+")}get commentsCount(){return this._options.commentsCount}set commentsCount(e){this._options.commentsCount=Number(e)}get recommendationAlgorithm(){return this._options.recommendationAlgorithm}set recommendationAlgorithm(e){isNaN(e)||(this._options.recommendationAlgorithm=Number(e))}get relevanceCoefficient(){return this._options.relevanceCoefficient}set relevanceCoefficient(e){isNaN(e)||(this._options.relevanceCoefficient=Number(e))}get screenIndex(){return this._options.screenIndex}set screenIndex(e){this._options.screenIndex=Number(e)}get tags(){return this._options.tags.join(",")}get tagsList(){return this._options.tags||[]}get tagsMask(){let e=0;return y.forEach((t=>{this._options.tags.includes(t.name)&&(e+=t.value)})),e}get analyticsData(){const e=void 0!==this.adId&&this.adId,t=this.tagsMask;return Ye(Ye(Ye(Ye(Ye(Ye(Ye({post_id:this.id,author_id:this.authorId,"rating!empty":this.rating,algorithm:this.algorithm,time:this.getViewTimeMS(),score:this.score},t>0&&{tags_mask:t}),{},{comments:this.commentsCount,content_type:this.contentTypes},e&&{promo_id:e}),this.screenIndex>0&&{screen_index:this.screenIndex}),this.subsCode&&{type_i8:this.subsCode}),{},{post_donation:this.donationAnalyticsParam},this.isFromRecommendations&&{component_name:"post_recs"}),this.el.dataset.extFeed&&{component_name:"extension",screen:this.el.dataset.extFeed}),this.isAdNormalView&&{type:"partner_material"})}get donationAnalyticsParam(){return this._donationAnalyticsParam}get viewRatio(){if(void 0===this._options.topViewBound||void 0===this._options.bottomViewBound)return 0;const e=this._options.bottomViewBound-this._options.topViewBound,t=this.el.querySelector(".story__content-inner, .story__description"),s=(t?t.scrollHeight:0)+this.hiddenBlocksHeight;return Math.min(100,Math.max(0,Math.round(100*e/s)))}get isStoryPage(){return this._options.isStoryPage}get date(){if(!this._options.date){var e;const t=null===(e=this.el.querySelector(`.${x.B.datetime}`))||void 0===e?void 0:e.getAttribute("datetime");this._options.date=new Date(t)}return this._options.date}get isBlogStory(){return this._options.isBlogStory}get isAdStory(){return Boolean(this._options.adId)}get isAdNormalView(){return this._options.isCustomAdvert&&(!this.isAdStory||this.isStoryPage)}get isAdSlot(){return this.isAdStory&&!this.isStoryPage}get contentInner(){return this._options.contentInner||(this._options.contentInner=this.el.querySelector(`.${x.B.contentInner.item}`)),this._options.contentInner}get isFromRecommendations(){return!this.el.dataset.subsCode&&!this.isAdStory&&!this.el.dataset.adType&&"true"!==this.el.dataset.isFixedStory&&i.default.ui.screen===U.dt.MY_LENT}get shouldShowNsfwPrompt(){var e;const t=this.el.querySelector(`.${x.B.content.item}`);return null!==(e=null==t?void 0:t.classList.contains(x.B.content.overlayPrompt))&&void 0!==e&&e}get hiddenBlocksHeight(){return this.isCollapsedLongStory&&this.sliceType===n.BY_BLOCK?(void 0===this._options.hiddenBlocksHeight&&(this._options.hiddenBlocksHeight=this.$el.find(`.${x.B.hiddenBlocksWrapper}`).height()||0),this._options.hiddenBlocksHeight):0}get adultOverlay(){return this._adultOverlay}set adultOverlay(e){this._adultOverlay=e}}},54702:(e,t,s)=>{"use strict";s.d(t,{B:()=>i});const i={item:"story",collapse:"story_collapse",overlayed:"story_overlayed",main:"story__main",tipAnchor:"story__tip-anchor",title:{el:"story__title",link:"story__title-link",visited:"story__title-link_visited"},header:"story__header",dots:{button:"story__dots",active:"story__dots_active"},datetime:"story__datetime",to:"story__to-comments",user:{info:"story__user-info",link:"story__user-link"},copy:"story__copy-link",community:{link:"story__community-link"},tags:{wrapper:"story__tags",wrapperCollapsed:"story__tags_collapsed",skeleton:"story__tags_skeleton",collapsedTagsContainer:"story__collapsed-tags-container",tag:"tags__tag",moreButton:"tags-cut",tool:"tool"},comments:{count:"story__comments-link"},content:{item:"story__content",show:"story__content_show",overlayed:"story__content_overlayed",overlayPermanent:"story__content_overlay-permanent",overlayPrompt:"story__content_overlay-prompt"},contentInner:{item:"story__content-inner",sliceByHeight:"story__content-inner_slice-by-height",sliceByBlock:"story__content-inner_slice-by-block"},cut:"story__cut",hiddenBlocksWrapper:"story__hidden-blocks",collapseButton:{button:"collapse-button",active:"collapse-button_active"},scrollTools:{item:"story__scroll",enabled:"story__scroll_enabled",disabled:"story__scroll_disabled"},highlight:{blink:"story__main_highlight_blink",item:"story__main_highlight_"},readMore:{button:"story__read-more",collapsed:"story__read-more_collapsed",label:"story__read-more-label"},block:"story-block",blocks:{image:"story-block_type_image",video:"story-block_type_video",text:"story-block_type_text",fundraising:"story-block_type_fundraising",poll:"story-block_type_poll",carousel:"story-block_type_carousel"},viewed:{count:"story__views-count",loaded:"story__views-count_loaded"},moderator:{button:"story__mod",active:"story__mod_active"},parentLink:"story__parent-link",addCommentForm:{form:"story-add-comment",hidden:"story-add-comment_hidden",input:"story-add-comment__input",submit:"story-add-comment__submit",mention:"story-add-comment__mention"},adultOverlay:{el:"story__adult-overlay",show:"story__adult-overlay_show",sticky:"story__adult-overlay_sticky",small:"story__adult-overlay_small"},donate:"story__donate",series:"story__series",seriesNav:"story-block__series-nav",spoiler:"pkb-spoiler",subscribeButton:"story-stub__btn",subscribeHelpLink:"story-stub__link"}},52764:(e,t,s)=>{"use strict";s.d(t,{v:()=>o});var i=s(54702);function o(e,t){if(!e)return 0;let s=t||e.querySelector(i.B.donate)?1:0;return s>0&&e.querySelector(i.B.blocks.fundraising)&&(s=2),s}},49463:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});s(2707),s(84944),s(33792);var i=s(2439),o=s(51540),r=s(91920),n=s(12953);class a extends i.v{static getInstance(){return a._instance?a._instance:a._instance=new a}constructor(){super(),this._items={},this._focusedElement=null,this._viewTimes={},this._firstViewTimes={},this._viewStart=null;const e=(0,o.P)((()=>this._checkViewport()),100);document.addEventListener("scroll",e),this.listenTo(this,"viewport-change",e),document.addEventListener("visibilitychange",(()=>{"visible"===document.visibilityState?e():"hidden"===document.visibilityState&&(this.focusedElement=null)}))}addItems(e){Object.assign(this._items,e),Object.keys(e).forEach((e=>{this._viewTimes[e]=0})),this._checkViewport()}_checkViewport(){const e=Object.keys(this._items).map((e=>this._items[e].map((t=>{const s=t.getBoundingClientRect();return{element:e,rect:s}})))).flat().filter((e=>e.rect.bottom>r.VIEWPORT_START&&e.rect.top<r.VIEWPORT_LIMIT*n.core.ui.windowHeight)).sort(((e,t)=>e.rect.bottom<=t.rect.bottom?1:-1));this.focusedElement=e.length?e[0].element:null}get focusedElement(){return this._focusedElement}set focusedElement(e){if(this._focusedElement===e)return;const t=(new Date).getTime();e&&!this._firstViewTimes[e]&&(this._firstViewTimes[e]=t),this._focusedElement&&this._viewStart&&(this._viewTimes[this._focusedElement]+=Number(((t-this._viewStart)/1e3).toFixed(3))),this._viewStart=e?t:null,this._focusedElement=e,this.emit("focused-element-change",e)}getViewAddTime(e){return this._viewStart&&this.focusedElement===e?((new Date).getTime()-this._viewStart)/1e3:0}getViewTime(e){return Number((this._viewTimes[e]+this.getViewAddTime(e)).toFixed(3))}getViewTimeMS(e){return 1e3*Number(this._viewTimes[e]+this.getViewAddTime(e))}getFirstViewTime(e){return this._firstViewTimes[e]||(new Date).getTime()}}},74750:(e,t,s)=>{"use strict";s.d(t,{x:()=>i});const i="18+"},19359:(e,t,s)=>{"use strict";s.d(t,{NP:()=>n,a8:()=>a,ll:()=>o,yX:()=>r});var i=s(65448);const o=new i.xs({ALL:"all",STORY:"story",SEARCH:"search"}),r=new i.xs({ALL:2,PARTIAL:0,NONE:1}),n=new i.xs({[r.ALL.valueOf()]:"show_all",[r.PARTIAL.valueOf()]:"hide_part",[r.NONE.valueOf()]:"hide"}),a=new i.xs({ADD:1,DELETE:-1,CANCEL:0})},44361:(e,t,s)=>{"use strict";s.d(t,{Gm:()=>S,yX:()=>r.yX,ll:()=>r.ll,zG:()=>E,lX:()=>h,Hx:()=>d});s(88674),s(41817);var i=s(12950),o=s(26947),r=s(19359);function n(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function a(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?n(Object(s),!0).forEach((function(t){l(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):n(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function l(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class c{static async _getDroplist(e,t){const s=performance.now();let o={};try{o=await i.cf.get("/ajax/tags_actions.php",a({action:"droplist",value:e},t))}catch(n){console.error(n)}const r=Math.floor(performance.now()-s);if(r>1e3)try{i.cf.post("/ajax/slow_log.php",{t:r,value:e})}catch(n){console.error(n)}return o}static async getMarkupByName(e=""){let t="/tag?q=";""!==e&&(t+=encodeURIComponent(e));let{data:s}=await i.cf.getOrFail(t,{ajax_mode:"1"});return s.html}static async getListByName(e="",t=0,s=0){let o={action:"search",type:"name",page:s,value:e,min_stories:t},{data:r}=await i.cf.getOrFail("/ajax/tags_merge_actions.php",o);return{total:r.total,tags:r.result}}static async getBannedByName(e=0,t=""){const s={action:"getbadtags",fromRec:e,search:t};let{data:o}=await i.cf.postOrFail("/ajax/tags_merge_actions.php",s);return o.result}static async searchMerge(e=""){e=e.trim().toLowerCase();let t=o.h.getInstance("searchTags");const s=c._getCacheKeyName(e);if(t.has(s))return t.get(s);const{response:i,data:r}=await c._getDroplist(e);return t.set(e,i.result?r.map((e=>({name:e[0],count:Number(e[1])}))):[])}static async searchTagsLine(e="",t=!1){let s=o.h.getInstance("searchTags");const r=c._getCacheKeyName(e);if(s.has(r))return s.get(r);let n=i.cf.get("/ajax/tags_actions.php",a({action:"tagsline",value:e},t&&{filter:"1"}));return n=n.then((t=>s.set(e,t.response.result?t.data.tags.map((e=>({name:e[0],count:Number(e[1])}))):[]))),n}static async search(e="",t=r.ll.ALL){let s=o.h.getInstance("searchTags");const i=c._getCacheKeyName(e,t);if(s.has(i))return s.get(i);const{response:n,data:a}=await c._getDroplist(e,{filter:t.value});return s.set(e,n.result?a.map((e=>({name:e[0],count:Number(e[1])}))):[])}static hasSearchCache(e="",t=r.ll.ALL){let s=o.h.getInstance("searchTags");const i=c._getCacheKeyName(e,t);return s.has(i)&&!(s.get(i)instanceof Promise)}static _getCacheKeyName(e,t=r.ll.ALL){return t===r.ll.ALL?e:`${e}:${t.value}`}}const d=c;var u=s(12953),p=s(42107);const h=class{static async sendSuggestion(e,t){if(!e||!e.length||!t)throw new Error("Data is not correct");const s={action:"add",from:e.join(","),to:t};let{data:o}=await i.cf.postOrFail("/ajax/tags_merge_actions.php",s);if(e.forEach(((e,s)=>{p.cp.getInstance().sendEvent("tags_merge_propose",{"tag_from!empty":e,"tag_to!empty":t,create_at:Date.now()+50*s})})),o)return{rules:o.result.rules,total:o.result.total}}static async validateSuggestion(e,t){if(!e||!e.length||!t)throw new Error("Data is not correct");const s={action:"validate",from:e.join(","),to:t};let{data:o}=await i.cf.postOrFail("/ajax/tags_merge_actions.php",s);return o}static async rollbackRule(e){if(!e||"string"!=typeof e&&"number"!=typeof e)throw new Error("Rule id was not specified or has an invalid type");if(!u.default.config("modules.params").isModerator)throw new Error("Action available to moderators only");const t={action:"rollback",id:e};return await i.cf.postOrFail("/ajax/tags_merge_actions.php",t),!0}static async approveRule(e){if(!e||"string"!=typeof e&&"number"!=typeof e)throw new Error("Rule id was not specified or has an invalid type");if(!u.default.config("modules.params").isModerator)throw new Error("Action available to moderators only");const t={action:"approve",id:e};let{data:s}=await i.cf.postOrFail("/ajax/tags_merge_actions.php",t);return s.result}static async disapproveRule(e){if(!e||"string"!=typeof e&&"number"!=typeof e)throw new Error("Rule id was not specified or has an invalid type");if(!u.default.config("modules.params").isModerator)throw new Error("Action available to moderators only");const t={action:"disapprove",id:e};return await i.cf.postOrFail("/ajax/tags_merge_actions.php",t),!0}static async remergeRule(e,t){if(!e||"string"!=typeof e&&"number"!=typeof e)throw new Error("Rule id was not specified or has an invalid type");if(!u.default.config("modules.params").isModerator)throw new Error("Action available to moderators only");const s={action:"remerge",id:e,to:t};return await i.cf.postOrFail("/ajax/tags_merge_actions.php",s),!0}static async cancelRejection(e,t){if(!e||!t)throw new Error("Data is not correct");if(!u.default.config("modules.params").isModerator)throw new Error("Action available to moderators only");const s={action:"cancel_disapprove",from:e,to:t};return await i.cf.postOrFail("/ajax/tags_merge_actions.php",s),!0}static async getRules(e,t=0,s=""){const o={action:"getrules",approved:e?"Y":"N",fromRec:t,search:s};let{data:r}=await i.cf.postOrFail("/ajax/tags_merge_actions.php",o);return r.result}static async banTag(e){if(!e||"string"!=typeof e)throw new Error("Tag name was not specified or has an invalid type");let t={action:"addbadtag",tag:e};return await i.cf.postOrFail("/ajax/tags_merge_actions.php",t),!0}static async unbanTag(e){if(!e||"string"!=typeof e)throw new Error("Tag name was not specified or has an invalid type");let t={action:"cancelbadtag",tag:e};return await i.cf.postOrFail("/ajax/tags_merge_actions.php",t),!0}};s(74916),s(2707);var _=s(96637),m=s(90312),g=s(30381),v=s.n(g),f=s(10850),y=s(74750);function b(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function w(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const k=s(19755),S=",",O=[y.x,"Жесть"];class E{static async ignore(e,t){return await i.cf.postOrFail("/ajax/tags_actions.php",{action:"ignore"+(t?"+":"-"),value:e}),!0}static async subscribe(e,t,s={}){if(O.includes(e)&&t){const e=u.default.initParams.birthday?v()(u.default.initParams.birthday).format("DD.MM.YYYY"):"";if(!e||!f.Z.isAdultAge(e)){if(!(await f.Z.showAdultPopup(!0)).result)return!1}}return e===y.x&&u.default.emit("subscribe-nsfw-tag",t),m.c.getInstance().sendEvent(t?"subscribe_to_tag":"unsubscribe",function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?b(Object(s),!0).forEach((function(t){w(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):b(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({tag_id:e,size:e.toString().split(S).length,"post_id!empty":"story"===u.default.initParams.pageName?u.default.initParams.pageRecordID:""},s)),await i.cf.postOrFail("/ajax/tags_actions.php",{action:"subs"+(t?"+":"-"),value:e}),!0}static async info(){let{data:e}=await i.cf.postOrFail("/ajax/tags_actions.php",{action:"info"});return e}static getListSubsIgnore(e=!1){let t=_.MemoryCacheStorage.getInstance("tags-info");if(!e&&t.has("info"))return t.get("info");let s=i.cf.get("/ajax/tags_actions.php",{action:"info"});return s=s.then((e=>t.set("info",e.response.result?e.data:{subs:[],ignore:[]}))),t.set("info",s)}static async getTagStatus(e){return(await i.cf.get("/ajax/tags_actions.php",{action:"tag-info",tag:this.normalizeTag(e)})).data}static async checkTagStatus(e){let t=await this.info(),s=k.inArray(e,t.subs)>-1,i=k.inArray(e,t.ignore)>-1;return{ignore:!i,unignore:i,subscribe:!s,unsubscribe:s}}static normalizeTag(e){return e.split(S).sort(((e,t)=>e.localeCompare(t))).join(S)}}},29939:(e,t,s)=>{"use strict";s.d(t,{v:()=>o,j:()=>h});s(74916),s(15306),s(66992),s(33948),s(88674);var i=s(12953);const o=new(s(65448).xs)({IMAGE:"image",VIDEO:"video"});var r=s(10703),n=s(89532);let a;const l=s(19755),c=/(https?:\/\/)[^\s"'`\]\[{}<>^|]+/gi,d=/pikabu\.(ru|lh|dev)\/story\/[^\s"'`\]\[{}<>^|]+/gi,u=/^https?:\/\//,p=/&nbsp;$/;class h{constructor(e="main"){if(this._prefix=e,"main"===this.prefix&&a)return a}add(e){Array.isArray(e)?e.forEach((e=>this.storage.add(e))):this.storage.add(e)}clear(){this.hasStorage()&&this.storage.clear()}remove(e){this.hasStorage()&&this.storage.delete(e)}has(e){return!!this.hasStorage()&&(!!this.storage.has(e)||(e=e.replace(u,""),[...this.storage].some((t=>t.replace(u,"")===e))))}hasStorage(e){const t=e&&e.length?e:this.prefix;return Boolean(i.core.storage.urlsExtracted&&i.core.storage.urlsExtracted[t])}static extract(e,t=c,s=!0){let i,o=[];for(t=t||c,s&&(e=n.c.getTextContent(e));null!==(i=t.exec(e));)o.push(i[0].replace(p,""));return o}static extractStoryURL(e){return h.extract(e,d)}async extractImageURLs(e,t=[]){const s=[],i=h.extract(e).filter((e=>!this.has(e)&&-1===t.indexOf(e)));for(const o of i)"string"==typeof o&&(await this.isImageURL(o)?s.push(o):this.add(o));return s}async extractImageVideoUrls(e,t=[]){let s=[],i=h.extract(e);i=i.filter((e=>!this.has(e)&&-1===t.indexOf(e)));for(const r of i)"string"==typeof r&&(this.isVideoURL(r)?s.push({url:r,type:o.VIDEO}):await this.isImageURL(r)?s.push({url:r,type:o.IMAGE}):this.add(r));return s}isImageURL(e){return new Promise((t=>{l(document.createElement("img")).on("error",(()=>t(!1))).on("load",(()=>t(!0))).attr("src",e)[0].complete&&t(!0)}))}isVideoURL(e){return Boolean(r.tv.getProviderTypeBySource(e))}static getPrefixedStorage(e){return i.core.storage.urlsExtracted||(i.core.storage.urlsExtracted=[]),i.core.storage.urlsExtracted[e]||(i.core.storage.urlsExtracted[e]=new Set),i.core.storage.urlsExtracted[e]}static get instance(){return a||(a=new h),a}get storage(){return i.core.storage.urlsExtracted||(i.core.storage.urlsExtracted=[]),i.core.storage.urlsExtracted[this.prefix]||(i.core.storage.urlsExtracted[this.prefix]=new Set),i.core.storage.urlsExtracted[this.prefix]}get prefix(){return this._prefix}}},71503:(e,t,s)=>{"use strict";s.d(t,{$$:()=>c,FC:()=>l,Ll:()=>n,V:()=>a,_y:()=>o,dX:()=>u,j$:()=>r,oN:()=>i,tK:()=>d});const i="_nuser",o=12e4,r="group",n="1930-01-01",a=Object.freeze({about:"about",gender:"sex",newst:"post_rating_from_show",commentst:"comment_rating_from_show",is_twitmode:"page_view",is_scrollmode:"post_content_hide",is_full_story_view:"long_post_show_full",show_porno:"nsfw_show",is_horror:"tag_nasty_post_show",is_tags_at_top_dv:"tags_on_top_show",is_video_autoplay_mode:"autoplay_gif_and_video",show_related_stories:"similar_posts_under_comments_show",max_comments_branch_depth:"comments_level_from_collapse",hide_gifs:"gif_comments_pause",default_com_view:"comments_sort",scroll_top:"back_to_top_show",is_ads_disabled:"ad_turn_off",viewed_post:"viewed_post",tags_fold_mode:"tags_display",color_theme:"color_theme",site_color:"site_color",politics_show:"politics_show",nickname:"nickname",birthdate:"birthdate",birthdate_display_mode:"show_birthdate",is_subs_hidden:"hide_followers",about_top_author:"about_top_author"}),l=Object.freeze({birthdate:"birthdate",gender:"gender",is_twitmode:"isUsedAjaxLoad",is_scrollmode:"isUsedScrollMode",is_full_story_view:"isFullStoryView",show_porno:"isAdultVisible",is_horror:"isHorrorVisible",is_tags_at_top_dv:"isTagsAtTop",is_video_autoplay_mode:"isVideoAutoplayMode",show_related_stories:"isShowRelatedStories",tags_fold_mode:"tagsFoldMode",max_comments_branch_depth:"maxCommentsBranchDepth",hide_gifs:"isAnimPreviewComment",default_com_view:"defaultCommentsViewMode",is_subs_hidden:"isSubsHidden",scroll_top:"isUsedScrollTopButton",is_ads_disabled:"isDisableAdsAllowed",birthdate_display_mode:"birthdateDisplayMode",is_twitmode_mv:"isUsedAjaxLoad",is_full_story_view_mv:"isFullStoryView",is_tags_at_top_mv:"isTagsAtTop"}),c=1383332,d=3661138,u={isVideoAutoplayMode:"autoplay",isFullStoryView:"show_long_post",isHorrorVisible:"negative_tag",showRelatedStories:"show_similar_posts",isTagsAtTop:"show_tags_up"}},79902:(e,t,s)=>{"use strict";let i;s.d(t,{D:()=>i}),function(e){e.STORY="story",e.COMMENT="comment"}(i||(i={}))},1262:(e,t,s)=>{"use strict";s.r(t),s.d(t,{ANONYMOUS_USER_ID:()=>l.tK,GROUP_AVATAR_CODE:()=>l.j$,PREDEFINED_USERS_TYPE:()=>n.D,SETTINGS_MIN_BIRTHDATE:()=>l.Ll,SETTINGS_TIMEOUTE:()=>l._y,SUPPORT_TECH_USER_ID:()=>l.$$,USER_SETTINGS_ANALYTICS_FLAGS:()=>l.dX,USER_SETTINGS_ANALYTICS_MAP:()=>l.V,USER_SETTINGS_CONFIG_MAP:()=>l.FC,USER_SIGNUP_COOKIE_KEY:()=>l.oN,User:()=>i.n,Users:()=>a});var i=s(51294),o=(s(88674),s(12950)),r=s(26947),n=(s(65448),s(79902));class a{static async search(e=""){let t=r.h.getInstance("droplistUsers");if(t.has(e))return t.get(e);let s=o.cf.get("/ajax/users_actions.php",{action:"droplist",q:e});return s=s.then((s=>t.set(e,s.response.result?s.data:[]))),t.set(e,s)}static async predefinedInStory(e,t){let s=r.h.getInstance("droplistPredefinedUsers"),i=String(e);if(s.has(i))return s.get(i);let n=o.cf.get("/ajax/users_actions.php",{type:t&&t.valueOf(),q:"",action:"droplist",story_id:e});return n=n.then((e=>s.set(i,e.response.result?e.data:[]))),s.set(i,n)}static hasSearchCache(e=""){let t=r.h.getInstance("droplistUsers");return t.has(e)&&!(t.get(e)instanceof Promise)}}var l=s(71503)},51294:(e,t,s)=>{"use strict";s.d(t,{n:()=>S});s(66992),s(33948),s(88674),s(74916),s(15306),s(24603),s(41817);var i=s(12950),o=s(36005);class r{static set(e,t,s){if("number"==typeof(s=(0,o.extend)({path:"/"},s)).expires){let e=new Date;e.setMilliseconds(e.getMilliseconds()+864e5*s.expires),s.expires=e}if(!(0,o.isString)(t)&&!(0,o.isNumber)(t))try{let e=JSON.stringify(t);/^[{\[]/.test(e)&&(t=e)}catch(i){t=t.toString()}return t=encodeURIComponent(String(t)).replace(/'/g,"%27").replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/'/g,"%27").replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),document.cookie=[e,"=",t,s.expires?"; expires="+s.expires.toUTCString():"",s.path?"; path="+s.path:"",s.domain?"; domain="+s.domain:"",s.secure?"; secure":""].join("")}static get(e,t=!1){let s,i=document.cookie?document.cookie.split("; "):[],o=/(%[0-9A-Z]{2})+/g,r=0;for(e||(s={});r<i.length;r++){let a=i[r].split("="),l=a.slice(1).join("=");'"'===l.charAt(0)&&(l=l.slice(1,-1));try{let i=a[0].replace(o,decodeURIComponent);if(l=l.replace(o,decodeURIComponent),t)try{l=JSON.parse(l)}catch(n){l=void 0}if(e===i){s=l;break}e||(s[i]=l)}catch(n){}}return s}static remove(e,t){return r.set(e,"",(0,o.extend)(t||{},{expires:-1}))}}function n(e,t){this.constructor.prototype.__proto__=Error.prototype,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.param=e,this.message=t}var a=s(71503),l=s(96637),c=s(12953),d=s(72346),u=s(90312),p=s(94786),h=s(72666),_=s(19359),m=(s(20446),s(49412)),g=(s(93266),s(83257)),v=s(73736);s(91904);function f(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function y(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?f(Object(s),!0).forEach((function(t){b(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):f(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function b(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const w=d.o.escape(),k={default:e=>e,nsfw_show:e=>1===Number(e)?1:0,politics_show:e=>1===Number(e)?1:0,viewed_post:e=>h.rg[e.toString()].valueOf(),tags_display:e=>_.NP[Number(e)].valueOf(),comments_level_from_collapse:e=>0===e?10:e,site_color:e=>m.f0[e.toString()].valueOf(),color_theme:e=>m.PH[e.toString()].valueOf()};class S{constructor(e){this._id=Number(e)}static sendUserParamsOnSessionStart(){var e;null!==(e=window.PkbAnalytics)&&void 0!==e&&e.newSessionStarted&&!this._onSessionStartEventWasSend&&(this._onSessionStartEventWasSend=!0,this.sendUserParams())}static sendUserParams(){const e=c.core.initParams,t={adblock:0};if((null==e?void 0:e.userID)>0){var s;t.rating=Math.floor(e.userKarma),t.nsfw=e.isAdultVisible?1:0,t.hideVisited=2===e.storiesDisplayMode?1:0,t.colorTheme=c.core.ui.themeSettings.data.dark?m.PH.DARK.valueOf():m.PH.LIGHT.valueOf(),t.siteColor=c.core.ui.themeSettings.data.theme.valueOf(),t.settings=[];for(const[s,i]of Object.entries(a.dX))s in e&&t.settings.push(i);if("hot-stories"===e.pageName){(c.core.config("modules.feed-filter")||{}).isSortedByTime&&t.settings.push("sort_by_time")}t.bell=e.notificationCount,t.subs=(null===(s=document.querySelector("#menu-subs span"))||void 0===s?void 0:s.textContent.trim())||"0"}(0,g.Pf)().then((e=>{t.adblock=e?1:0,v.dV.send("userParams",t)}))}static sendSettingsChangeAnalytics(e,t,s){const i=a.V[e],o=k[i]||k.default;i&&u.c.getInstance().sendEvent("user_setting_change",y(y({type:i},void 0!==t&&{value_old:o(t)}),void 0!==s&&{value_new:o(s)}))}static _postUserAction(e){return i.cf.post("/ajax/users_actions.php",e)}async subscribe(e,t={}){u.c.getInstance().sendEvent(e?"subscribe_to_author":"unsubscribe",y({author_id:this._id},t)),await i.cf.postOrFail("/ajax/user_sub.php",{state:Number(!e),user_id:this._id})}async notificationSubscribe(e){await i.cf.postOrFail("/ajax.php",{route:"user-notification-subs",user_id:this._id,is_notify:e?1:0})}async ignore(e){const{response:t}=await this._postUserAction({action:"ignore"+(e?"+":"-"),id:this._id});if(!t.result)throw new Error(t.message)}async block(e){await i.cf.postOrFail("/ajax/moderator_actions.php",{action:"block_new_user",user_id:this._id,reason_id:e})}async note(e){const{response:t}=await S._postUserAction({action:e?"note+":"note-",message:e,id:this._id});if(!t.result)throw new Error(t.message);return!0}async about(e){const{response:t}=await S._postUserAction({action:"update_about",about:e});if(!t.result)throw new Error(t.message);return!0}async topAuthorDescription(e){const{response:t}=await S._postUserAction({action:"update_top_author_description",description:e});if(!t.result)throw new Error(t.message);return!0}static async switchAdult(e){return this._postUserAction({action:"switch_adult",mode:e?"on":"off"})}static async register(e){let t=await i.cf.post("/ajax/register.php",e);return t.response.result&&S._processSuccessfulSignup(),t}static async registerOAuth(e,t){const{response:s,data:o}=await i.cf.post("/ajax/register_actions.php",{action:"oauth",username:e,"g-recaptcha-response":t});if(!s.result){const e=s.message||c.core.i18n("errors.response");throw o&&o.param?new n(o.param,e):new Error(e)}return!0}static registerInit(e){return i.cf.post("/ajax/register_actions.php",(0,o.defaults)(e,{action:"init"}))}static async registerSubmit(e){let t=await i.cf.post("/ajax.php?route=signup",e);return t.response.result&&S._processSuccessfulSignup(),t}static async registerSubmitBySmsCode(e,t){let s=await i.cf.post("/ajax/register_actions.php",{action:"code",register_id:e,code:t});return s.response.result&&S._processSuccessfulSignup(),s}static async restorePasswordConfirm(e,t,s){return await i.cf.post("/ajax/restore_passwd.php",{action:"set_password",session_id:e,confirm_code:t,p:s})}static async authorizeSpecAccount(e,t,s){const{data:o}=await i.cf.get("/ajax/get_nonce.php"),r=Math.random(),n=p.V8.hashStr(String(o.nonce+r+e.password));return await i.cf.post("/ajax/auth.php",y(y({},"oauth"===e.mode&&{mode:"oauth"}),{},{username:e.username,password:e.password,session_id:t,confirmation_code:s,cnonce:r,hash:n}))}static async authorize(e){const{data:t}=await i.cf.get("/ajax/get_nonce.php"),s=Math.random(),r=p.V8.hashStr(String(t.nonce+s+e.password));return await i.cf.post("/ajax/auth.php",(0,o.defaults)(e,{mode:"login",cnonce:s,hash:r}))}static async logout(e=!1){let{response:t,data:s}=await i.cf.post("/ajax/logout.php",!0===e?{type:"global"}:void 0);return!!t.result&&(u.c.getInstance().sendEvent("log_out",{type:"log_out"}),c.core.ua.safari||(Boolean(navigator.credentials)&&await navigator.credentials.preventSilentAccess(),c.core.bc.send("logout")),window.location.href=s.url,!0)}static async saveSettings(e){return(await this._postUserAction(e)).response.result}static async addPhone(e){const t=await this._postUserAction({action:"add_phone",phone:e});if(!t.response.result){let e=t.response.message||c.core.i18n("errors.response");throw t.data&&t.data.param?new n(t.data.param,e):new Error(e)}return t.data.session_id}static async addPhoneConfirm(e,t){const s=await this._postUserAction({action:"add_phone_confirm",session_id:e,confirm_code:t});if(!s.response.result)throw new Error(s.response.message||c.core.i18n("errors.response"));return!0}static async changePhone(e,t){const s=await this._postUserAction({action:"change_phone",password:t,new_phone:e});if(!s.response.result){const e=s.response.message||c.core.i18n("errors.response");throw s.data&&s.data.param?new n(s.data.param,e):new Error(e)}return s.data.session_id}static async changePhoneConfirm(e,t){const s=await this._postUserAction({action:"change_phone_confirm",session_id:e,confirm_code:t});if(!s.response.result)throw new Error(s.response.message||c.core.i18n("errors.response"));return!0}static async cancelChangePhone(e){const t=await this._postUserAction({action:"cancel_phone_change",password:e});if(!t.response.result){const e=t.response.message||c.core.i18n("errors.response");throw t.data&&t.data.param?new n(t.data.param,e):new Error(e)}return t.data.session_id}static async cancelChangePhoneConfirm(e,t){const s=await this._postUserAction({action:"cancel_phone_change_confirm",session_id:e,confirm_code:t});if(!s.response.result)throw new Error(s.response.message||c.core.i18n("errors.response"));return!0}static async changeEmail(e,t){const s=await this._postUserAction({action:"change_email",password:t,email:e});if(!s.response.result){const e=s.response.message||c.core.i18n("errors.response");throw s.data&&s.data.param?new n(s.data.param,e):new Error(e)}return!0}static async changeNickname(e,t){const s=await this._postUserAction({action:"change_nickname",password:t,nickname:e});if(!s.response.result){const e=s.response.message||c.core.i18n("errors.response"),t=s.data.analytics_code;throw t&&u.c.getInstance().sendEvent("error_occurred",{type:t}),s.data&&s.data.param?new n(s.data.param,e):new Error(e)}return!0}static async changePassword(e,t){const s=await this._postUserAction({action:"change_password",password_current:t,password_new:e});if(!s.response.result){const e=s.response.message||c.core.i18n("errors.response");throw s.data&&s.data.param?new n(s.data.param,e):new Error(e)}return!s.data.session_id||s.data.session_id}static async changePasswordConfirm(e,t){const s=await this._postUserAction({action:"change_password_confirm",session_id:e,confirm_code:t});if(!s.response.result)throw new Error(s.response.message||c.core.i18n("errors.response"));return!0}static async removeOAuth(e){return(await i.cf.get("/oauth.php",{type:e.valueOf(),remove:1})).response.result}static async isUserAvailable(e){e=e.trim();let t=l.MemoryCacheStorage.getInstance("availableUserNames");if(t.has(e))return t.get(e);let s=i.cf.post("/ajax.php",{route:"signup/check-username",username:e});return s=s.then((s=>{const o=s.data.available_usernames||[];return t.set(e,{message:s.response.status===i.Wi&&s.response.message,availableUserNames:o})})),t.set(e,s)}static async isEmailAvailable(e){e=e.trim();let{response:t}=await i.cf.post("/ajax.php",{route:"signup/check-email",email:e});return t.result}static getMiniProfile(e){if("DELETED"===(e=e.trim()))return'<p class="hint__text">Упс.. Этот пользователь не найден</p>';let t=l.MemoryCacheStorage.getInstance("profileUser");if(t.has(e))return t.get(e);let s=i.cf.post("/ajax/user_info.php",{action:"get_short_profile",user_name:e});return s=s.then((s=>s.response.status===i.Wi?s.response.result?t.set(e,s.data.html):"<div>&nbsp;"+s.response.message+"&nbsp;</div>":t.set(e,!1))),t.set(e,s)}static flushMiniProfilesCache(e){let t="profileUser";if(e){l.MemoryCacheStorage.getInstance(t).remove(e)}else l.MemoryCacheStorage.remove(t)}static changeMiniProfileNote(e,t){e=e.trim();let s=l.MemoryCacheStorage.getInstance("profileUser");if(s.has(e)){let i=document.createElement("div");i.innerHTML=s.get(e).trim(),i.querySelectorAll(".profile__note-inner")[0].innerHTML=t,s.set(e,i.innerHTML)}}static async restorePassword(e){const{data:t}=await i.cf.postOrFail("/ajax/restore_passwd.php",e);return t}static async dropBackground(){const{response:e}=await this._postUserAction({action:"drop_background"});if(!e.result)throw new Error(e.message)}static async getNotifications(e=1){const{response:t,data:s}=await this._postUserAction({action:"get_notifications",limit:e});if(!t.result)throw new Error(t.message);return s}static async removeNotifications(){const{response:e}=await this._postUserAction({action:"remove_notifications"});if(!e.result)throw new Error(e.message)}static noteValueToHtml(e,t={}){if(!e||""===e.trim())return"";t=(0,o.extend)({newLineToBr:!0,commentLinks:!1,cropLinks:!1,noFollow:!1,unEscapeTags:!0},t);let s=e.trim();return t.unEscapeTags&&(s=w(s)),t.newLineToBr&&(s=s.replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br/>$2")),this.parselinks(s,t)}static parselinks(e,t={}){let s=e,i=e.match(/(https?:\/\/)?([-.a-zA-Z0-9]+)(\.[a-z]{2,5})(\/)?([-\/@\w+]*)?\??([-\/\w=%&.;+]*)?#?\/?([\/\w\-]*)?\??([-\/\w=%&.;+]*)?/gm);if(!i)return s;i=(0,o.uniq)(i);for(let o=0;o<i.length;o++){const e=/^https?:\/\//.test(i[o])?i[o]:`http://${i[o]}`;let r=0,n='target="_blank"';t.commentLinks&&(r=i[o].match(/(cid=([0-9]+))/),r=null!==r?Number(r[2]):0);let a=r>0?`#comment_${r}`:i[o];t.cropLinks&&a.length>62&&(a=a.slice(0,59)+"…"),t.noFollow&&(n+=' rel="nofollow"'),i[o]=l.Utils.escapeRegExp(i[o]);const c=new RegExp(`(^|[\\s{[(,;])(${i[o]})($|[\\s}\\])<,;])`,"gm");let d=0;for(;c.test(s)&&++d<50;)s=s.replace(c,`$1<a href="${e}" ${n}>${a}</a>$3`)}return s}static _processSuccessfulSignup(){r.set(a.oN,1,{expires:365})}get id(){return this._id}}b(S,"_onSessionStartEventWasSend",!1)},60387:(e,t,s)=>{"use strict";s.d(t,{V:()=>i});s(88674);async function i(e,t,s="--transform-transition-default"){return new Promise((i=>{if(!e||!t)return void i();const o=e.getBoundingClientRect(),r=t.getBoundingClientRect(),n=r.bottom-o.bottom,a=o.top-r.top;e.style.setProperty("transition",`var(${s})`),t.style.setProperty("transition",`var(${s})`),e.style.setProperty("transform",`translateY(${n}px)`),t.style.setProperty("transform",`translateY(${a}px)`),e.addEventListener("transitionend",(function s(o){o.target===o.currentTarget&&(e.removeEventListener("transitionend",s),i(),e.style.removeProperty("transition"),t.style.removeProperty("transition"),e.style.removeProperty("transform"),t.style.removeProperty("transform"))}))}))}},24431:(e,t,s)=>{"use strict";s.d(t,{m:()=>i});const i=(e,t,s,i)=>(e/=i/2)<1?s/2*e*e+t:-s/2*(--e*(e-2)-1)+t},81528:(e,t,s)=>{"use strict";s.d(t,{I:()=>i});s(66992),s(33948);function i(e){let[t,s,i]=e,o={};for(let[r,n,a,...l]of i){let e={width:n,height:a};l.forEach(((i,o)=>{let[n,a]=Array.isArray(i)?i:[i,i],l=o+1,c=1===l?"":`@${l}x`;e[l]={GIF:t+s[n]+r+c+".gif",APNG:t+s[a]+r+c+".png"}})),o[r]=e}return o}},26947:(e,t,s)=>{"use strict";s.d(t,{h:()=>o});s(66992),s(33948),s(88674);const i=new Map;class o{constructor(){this._lastAction=Date.now(),this._cacheData=new Map}get(e){return this._lastAction=Date.now(),this._cacheData.get(e)}set(e,t){return this._lastAction=Date.now(),this._cacheData.set(e,t),t}has(e){return this._lastAction=Date.now(),this._cacheData.has(e)}remove(e){return this._lastAction=Date.now(),this._cacheData.delete(e)}removeUnused(){this._cacheData.forEach(((e,t)=>{e instanceof Promise||this._cacheData.delete(t)}))}get lastAction(){return this._lastAction}get size(){return this._cacheData.size}static getInstance(e="main"){if(i.has(e))return i.get(e);let t=new o;return i.set(e,t),t}static remove(e){return i.delete(e)}static removeUnused(e){i.forEach(((t,s)=>{e&&t.lastAction<e||(t.removeUnused(),t.size||i.delete(s))}))}}},50071:(e,t,s)=>{"use strict";s.d(t,{A:()=>l,k:()=>r});s(88674);var i=s(12953);const o=["i-overlay_show","no-scroll"],r=e=>!i.core.ui.$els.app.get(0).contains(e),n=()=>o.some((e=>document.body.classList.contains(e)));let a=null;const l=async()=>{if(a)return a;if(!n())return;let e;a=new Promise((t=>{e=t}));const t=new MutationObserver((()=>{n()||(t.disconnect(),a=null,e())}));return t.observe(document.body,{attributes:!0}),a}},5603:(e,t,s)=>{"use strict";s.d(t,{v:()=>i});const i="IntersectionObserver"in window},1206:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});const i=(e,t={})=>{const s=t.scrollRatio||1;let i=!1;const o=e=>{var s;e!==i&&(i=e,null===(s=t.onGrab)||void 0===s||s.call(t,i))};let r=!1,n=!1;const a=e=>{var s;e!==n&&(n=e,null===(s=t.onDrag)||void 0===s||s.call(t,n),n?r=!0:requestAnimationFrame((()=>{r=!1})))};let l,c;const d=()=>{e&&i&&(e.removeEventListener("pointermove",p),o(!1),a(!1))},u=t=>{e&&e.scrollWidth!==e.clientWidth&&(o(!0),l=t.pageX-e.offsetLeft,c=e.scrollLeft,e.addEventListener("pointermove",p))},p=t=>{if(!e||!i)return;const o=t.pageX-e.offsetLeft-l;!e.hasPointerCapture(t.pointerId)&&Math.abs(o)>=4&&(e.setPointerCapture(t.pointerId),a(!0)),e.scrollLeft=c-o*s},h=e=>{e.preventDefault(),e.stopPropagation()},_=e=>{e.preventDefault()},m=e=>{r&&(e.preventDefault(),e.stopPropagation())};return e.addEventListener("pointerdown",u),e.addEventListener("pointerleave",d),e.addEventListener("pointercancel",d),e.addEventListener("pointerup",d),e.addEventListener("dragstart",h),e.addEventListener("touchmove",_),e.addEventListener("click",m,{capture:!0}),()=>{d(),e.removeEventListener("pointerdown",u),e.removeEventListener("pointerleave",d),e.removeEventListener("pointercancel",d),e.removeEventListener("pointerup",d),e.removeEventListener("dragstart",h),e.removeEventListener("pointermove",p),e.removeEventListener("touchmove",_),e.removeEventListener("click",m,{capture:!0})}}},9980:(e,t,s)=>{"use strict";s.d(t,{k:()=>_});s(41817),s(88674);var i=s(12953),o=s(96637),r=s(90312),n=s(36005);function a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function l(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?a(Object(s),!0).forEach((function(t){c(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function c(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}let d,u=null;const p=s(19755),h=Symbol();class _{constructor(e){if(e!==h)throw new Error("Cannot construct singleton");this._prepare=void 0,this._options={isRendered:!1,siteKey:void 0,wrapper:void 0,lastToken:void 0,grecaptcha:void 0},this._isAnalyticsSend=!1}async render(e={}){return this._options.isRendered||i.core.initParams.withoutCaptcha?this:(await _.initScript(),this._options.grecaptcha=grecaptcha,this.grecaptcha?(window.onCaptchaCallback||(window.onCaptchaCallback=e=>{this._options.lastToken=e}),this.grecaptcha.ready((()=>{"number"!=typeof this._grecaptchaID&&(this._grecaptchaID=this.grecaptcha.render(this.wrapper,l(l({},e),{},{sitekey:this.siteKey,size:"invisible",callback:"onCaptchaCallback",badge:"bottomleft"})))})),this._options.isRendered=!0,this):(i.core.logger.error("GReCaptcha","cant init"),this))}reset(){return i.core.initParams.withoutCaptcha||this.grecaptcha.reset(),this}async getToken(e="undefined_place"){var t;if(i.core.initParams.withoutCaptcha)return!0;if(!this.grecaptcha)return i.core.ui.toasts.showError("auth.norecaptcha"),!1;let s=480;for(this._options.lastToken=void 0,this.wrapper.classList.remove("footer__captcha_static"),this.wrapper.style.display="none",this.grecaptcha.execute(this._grecaptchaID),null===(t=this.reCaptchaContainer)||void 0===t||t.classList.add("grecaptcha__container");!this.lastToken&&--s>0;)this._getTokenWithPicture||await this._checkPictureForToken(e),await o.Utils.delay(500);return await this._sendCaptchaAnalytics(e),this.wrapper.classList.add("footer__captcha_static"),this.wrapper.style.display="block",Boolean(this.lastToken)}async _checkPictureForToken(e){var t;"visible"===(null===(t=this.reCaptchaContainer)||void 0===t?void 0:t.style.visibility)&&(this._pictureTokenTimeStart=new Date,this._getTokenWithPicture=!0,r.c.getInstance().sendEvent("captcha_manual_show",{type:e}))}async _sendCaptchaAnalytics(e){if(!this._isAnalyticsSend&&this._getTokenWithPicture&&this.lastToken){const t=new Date-this._pictureTokenTimeStart;r.c.getInstance().sendEvent("captcha_manual_pass",{type:e,viewTime:t}),this._isAnalyticsSend=!0}}get grecaptcha(){return this._options.grecaptcha}setOptions(e){return(0,n.isObject)(e)?((0,n.forEach)(e,((e,t)=>{this[t]=e})),this):this}get siteKey(){return this._options.siteKey}set siteKey(e){this._options.siteKey=String(e)}get wrapper(){let e=this._options.wrapper;return e||(e=this._options.wrapper=document.createElement("div"),e.classList.add("captcha"),document.querySelector("body").appendChild(e)),e}set wrapper(e){let t=this._options.wrapper;e instanceof p&&(e=e[0]),e&&t!==e&&(this._options.wrapper=e)}get lastToken(){return this._options.lastToken}get reCaptchaContainer(){var e,t;return null===(e=document.querySelector('iframe[src*="google.com/recaptcha/api2/bframe"]'))||void 0===e||null===(t=e.parentNode)||void 0===t?void 0:t.parentNode}static get instance(){return d||(d=new _(h),d)}static initScript(){return u||(u=new Promise(((e,t)=>{const s=document.createElement("script");s.src="https://www.google.com/recaptcha/api.js?render=explicit",s.setAttribute("async","async"),s.setAttribute("defer","defer"),s.addEventListener("load",(()=>{grecaptcha.ready(e)})),s.addEventListener("error",t),document.body.appendChild(s)})),u)}}},38654:(e,t,s)=>{"use strict";s.d(t,{K:()=>c});s(41817),s(88674);var i=s(12953),o=s(12950),r=s(9980);const n=i.core.config("grecaptchaV3Key");let a;const l=Symbol();class c{constructor(e){if(e!==l)throw new Error("Cannot construct singleton");this._prepare=void 0,this._options={isRendered:!1,lastTokenV3:void 0,grecaptcha:void 0}}async render(){return this._options.isRendered?this:(this._options.isRendered=!0,await r.k.initScript(),grecaptcha?(grecaptcha.ready((()=>{if("number"==typeof this._captchaID)return;const e=this._getWrapper();this._captchaID=grecaptcha.render(e,{sitekey:n,size:"invisible",badge:"bottomleft"})})),this._options.grecaptcha=grecaptcha,this):(i.core.logger.error("GReCaptchaV3","cant init"),this))}_getWrapper(){let e=document.querySelector(".footer__captcha_v3");if(e||(e=document.querySelector(".sidebar-block__captcha"),e&&(e.style.display="block")),e||(e=document.querySelector(".auth__captcha_v3")),e||(e=document.querySelector(".story-editor__captcha"),e&&(e.style.display="none")),!e){const t=document.createElement("div");t.setAttribute("class","footer__captcha_v3 footer__captcha_nofooter"),t.setAttribute("style","visibility: hidden"),document.querySelector(".app").append(t),e=t}return e}reset(){return this.grecaptcha.reset(),this}async getTokenV3(e="undefined_action"){return this._options.isRendered||await this.render(),this.lastTokenV3&&!this._isTokenExpired()?new Promise((e=>{e(this.lastTokenV3)})):new Promise((t=>{this.grecaptcha.ready((async()=>{let s;try{s=await this.grecaptcha.execute(this._captchaID,{action:e})}catch(i){console.error(null==i?void 0:i.message)}this._options.lastTokenV3=s,this._options.timeLastTokenV3=Date.now(),t(s)}))}))}async getScore(e="undefined_action"){if(this._lastScoreV3&&!this._isTokenExpired())return this._lastScoreV3;this.lastTokenV3&&!this._isTokenExpired()||await this.getTokenV3(e);const{response:t,data:s}=await o.cf.get("/ajax.php?route=captcha/get_score",{token:this.lastTokenV3});return t.result&&s?(this._lastScoreV3=s.score,this._lastScoreV3):(console.error("There is a problem with getting response from server with grecaptchaV3 score"),-1)}_isTokenExpired(){return Date.now()-this.timeLastTokenV3>11e4}get grecaptcha(){return this._options.grecaptcha}get lastTokenV3(){return this._options.lastTokenV3}get timeLastTokenV3(){return this._options.timeLastTokenV3}static getInstance(){return a||(a=new c(l),a)}}},96637:(e,t,s)=>{"use strict";s.r(t),s.d(t,{CookieStorage:()=>v.e,LocalStorage:()=>m.m,MemoryCacheStorage:()=>f.h,PASSWORD_STRENGTH:()=>i,PasswordStrength:()=>c,PostMessage:()=>_,SESSION_STARTED_TS_KEY:()=>g.q,SessionStorage:()=>g.x,Utils:()=>o.c,yieldToMain:()=>y.y});const i=new(s(65448).xs)({INVALID:0,WEEK:1,GOOD:2,STRONG:3});var o=s(89532);s(74916);const r=/\d.*?\d.*?\d/,n=/[!@#$%^&*?_~].*?[!@#$%^&*?_~]/,a=/([a-z].*[A-Z])|([A-Z].*[a-z])/,l=/[!@#$%^&*?_~]/;class c{static test(e,t){let s=0;return this.status=i.INVALID,s=e.length<6?-100:4*e.length,e.match(r)&&(s+=5),e.match(n)&&(s+=5),e.match(a)&&(s+=10),e.match(/[a-z]/i)&&e.match(/[0-9]/)&&(s+=15),e.match(/[0-9]/)&&e.match(l)&&(s+=15),e.match(/[a-z]/i)&&e.match(l)&&(s+=15),e.match(/^[a-z]+$/i)&&(s+=-15),e.match(/^\d+$/i)&&(s+=-15),e===t?s+=-100:-1!==e.indexOf(t)&&(s+=-15),s+=-15*c.sequences(e),s+=-15*c.sequences(c.reversed(e)),s+=-4*c.repetitions(e,2),s+=-3*c.repetitions(e,3),s+=-2*c.repetitions(e,4),s<0&&(s=0),s>100&&(s=100),s<15&&(this.status=i.WEEK),s>=15&&s<60&&(this.status=i.GOOD),s>=60&&(this.status=i.STRONG),this.status}static sequences(e){let t,s,i=0,o=0,r=[],n=e.length;for(let a=0;a<n;a++)s=e.charCodeAt(a),t=r[r.length-1],r.push(s),t&&(s===t+1||t===s?o+=1:o=0),2===o&&(i+=1);return i}static repetitions(e,t){let s,i,o,r=0,n={},a=e.length;for(let l=0;l<a;l++)if(s=e.substr(l,t),i=0,o=e,!(n[s]||s.length<t)){for(n[s]=!0;-1!==(l=o.indexOf(s));)i+=1,o=o.substr(l+1);i>1&&(r+=1)}return r}static reversed(e){let t="";for(let s=e.length-1;s>=0;s--)t+=e.charAt(s);return t}}s(15306);var d=s(16253);let u;const p=s(19755),h=/^https?:\/\//;class _{static get instance(){return u||(u=new d.vp,p(window).on("message",(e=>{let t=e.originalEvent;u.emit((t.origin||"").replace(h,""),t)})),u)}static send(e,t,s){t&&(e="string"==typeof e?e:p.param(e),(s=s||window.parent).postMessage(e,t.replace(/([^:]+:\/\/[^\/]+).*/,"$1")))}}var m=s(53056),g=s(34524),v=s(70017),f=s(26947),y=s(8233)},39037:(e,t,s)=>{"use strict";function i(){try{return window.self!==window.top}catch(e){return!0}}s.d(t,{Z:()=>i})},15078:(e,t,s)=>{"use strict";s.d(t,{m:()=>i.m});var i=s(53056)},16819:(e,t,s)=>{"use strict";s.d(t,{v:()=>i});s(88674),s(66992),s(33948);class i{async init(){this.IMask=(await s.e(341).then(s.bind(s,58548))).default}async createMask(e,t){return this.IMask||await this.init(),this.IMask(e,t)}}},46068:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});s(88674),s(66992),s(33948),s(86535),s(99244),s(84944),s(33792);async function i({accept:e,multiple:t=!1}){if("showOpenFilePicker"in window&&(()=>{try{return window.self===window.top}catch(e){return!1}})()){const s={multiple:t};e&&(s.types=[{description:"Files",accept:e}]);const i=await window.showOpenFilePicker(s),o=await Promise.all(i.map((e=>e.getFile())));return t?o:o[0]}return new Promise((s=>{const i=document.createElement("input");i.style.display="none",i.type="file",document.body.append(i),t&&(i.multiple=!0),e&&(i.accept=Object.entries(e).flatMap((e=>e.flat())).join(",")),i.addEventListener("change",(()=>{i.remove(),i.files?s(t?Array.from(i.files):i.files[0]):s(t?[]:void 0)})),"showPicker"in HTMLInputElement.prototype?i.showPicker():i.click()}))}},92927:(e,t,s)=>{"use strict";s.d(t,{$:()=>i});s(88674);class i{static request(e){return e?requestAnimationFrame(e):new Promise((e=>requestAnimationFrame(e)))}static requestThrottle(e){let t=!1;return function(){t||(t=!0,requestAnimationFrame((()=>{t=!1,e.apply(this,arguments)})))}}static cancel(e){cancelAnimationFrame(e)}}},12052:(e,t,s)=>{"use strict";s.d(t,{V:()=>a});s(41817);var i=s(12953);function o(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const r=(e,t)=>{if(e&&e!==t)return e.scrollHeight>e.clientHeight?e:r(e.parentElement,t)};let n;!function(e){e.TOP="top",e.RIGHT="right",e.BOTTOM="bottom",e.LEFT="left"}(n||(n={}));class a{constructor(e){o(this,"lastPullDistance",0),o(this,"handlePointerDown",(e=>{this.handleStart(e.clientX,e.clientY,e.target),document.addEventListener("pointermove",this.handlePointerMove),document.addEventListener("pointerup",this.handleUp)})),o(this,"handleTouchStart",(e=>{1===e.touches.length&&(this.handleStart(e.touches[0].clientX,e.touches[0].clientY,e.target),document.addEventListener("touchmove",this.handleTouchMove),document.addEventListener("touchend",this.handleUp))})),o(this,"handleTouchStartIOS",(e=>{i.core.ua.ios&&e.touches.length>0&&(e.touches[0].pageX<=20||e.touches[0].pageX>=window.innerWidth-20)&&e.preventDefault()})),o(this,"handlePointerMove",(e=>{this.processMove(e.clientX,e.clientY)})),o(this,"handleTouchMove",(e=>{this.processMove(e.touches[0].clientX,e.touches[0].clientY)})),o(this,"handleTouchMovePreventDefault",(e=>{if(this.options.allowTouchScroll&&!this.currentSwipeDir&&this.startPosition){const t=e.touches[0].clientY-this.startPosition.y,s=e.touches[0].clientX-this.startPosition.x;if(this.checkScroll(s,t))return void this.cancelSwipe()}(!this.options.ignoreVertical||"top"!==this.currentSwipeDir&&"bottom"!==this.currentSwipeDir)&&(!this.options.ignoreHorizontal||"left"!==this.currentSwipeDir&&"right"!==this.currentSwipeDir)?e.preventDefault():this.cancelSwipe()})),o(this,"handleUp",(()=>{try{var e,t;const s=Boolean(this.options.triggerOnPointerUp)&&this.checkIsSwiped(this.lastPullDistance);s&&this.callSwipeSuccessHandlers(),null===(e=this.options)||void 0===e||null===(t=e.onFinish)||void 0===t||t.call(e,s,this.currentSwipeDir)}finally{this.cancelSwipe()}})),this.options=e,this.options.allowTouchScroll&&!("ontouchstart"in window)&&(this.options.allowTouchScroll=!1),e.target.draggable=!1,e.target.addEventListener("touchmove",this.handleTouchMovePreventDefault,{passive:!1}),i.core.ua.ios&&e.target.addEventListener("touchstart",this.handleTouchStartIOS),"PointerEvent"in window?e.target.addEventListener("pointerdown",this.handlePointerDown,{capture:!0}):e.target.addEventListener("touchstart",this.handleTouchStart,{capture:!0})}destroy(){this.cancelSwipe(),this.options.target.removeEventListener("pointerdown",this.handlePointerDown,{capture:!0}),this.options.target.removeEventListener("touchstart",this.handleTouchStart,{capture:!0}),this.options.target.removeEventListener("touchmove",this.handleTouchMovePreventDefault),i.core.ua.ios&&this.options.target.removeEventListener("touchstart",this.handleTouchStartIOS),this.options.target.draggable=!0}cancelSwipe(){this.currentSwipeDir=void 0,this.lastPullDistance=0,document.removeEventListener("pointermove",this.handlePointerMove),document.removeEventListener("pointerup",this.handleUp),document.removeEventListener("touchmove",this.handleTouchMove),document.removeEventListener("touchend",this.handleUp)}handleStart(e,t,s){var i,o;this.startPosition={x:e,y:t},null===(i=this.options)||void 0===i||null===(o=i.onStart)||void 0===o||o.call(i),this.options.allowTouchScroll&&(this.scrollableElement=r(s,this.options.target))}checkScroll(e,t){const s=this.scrollableElement;return!!s&&(t>0&&s.scrollTop>0||t<0&&s.scrollHeight>s.scrollTop+s.clientHeight||e>0&&s.scrollWidth>s.scrollLeft+s.clientWidth||e<0&&s.scrollLeft>0)}processMove(e,t){if(!this.startPosition)return;const s=e-this.startPosition.x,i=t-this.startPosition.y;if(void 0===this.currentSwipeDir&&!this.detectSwipeDirection(s,i))return;const o=this.getPullDistance(s,i);this.lastPullDistance=o;try{this.callPullHandlers(o);var r,n;if(!this.options.triggerOnPointerUp&&this.checkIsSwiped(o))this.callSwipeSuccessHandlers(),null===(r=this.options)||void 0===r||null===(n=r.onFinish)||void 0===n||n.call(r,!0,this.currentSwipeDir),this.cancelSwipe()}catch(a){this.cancelSwipe(),console.error(a)}}callPullHandlers(e){var t,s,i,o,r,a,l,c,d,u;if(this.currentSwipeDir)switch(null===(t=this.options)||void 0===t||null===(s=t.onPull)||void 0===s||s.call(t,this.currentSwipeDir,e),this.currentSwipeDir){case n.LEFT:null===(i=this.options)||void 0===i||null===(o=i.onPullLeft)||void 0===o||o.call(i,e);break;case n.RIGHT:null===(r=this.options)||void 0===r||null===(a=r.onPullRight)||void 0===a||a.call(r,e);break;case n.TOP:null===(l=this.options)||void 0===l||null===(c=l.onPullTop)||void 0===c||c.call(l,e);break;case n.BOTTOM:null===(d=this.options)||void 0===d||null===(u=d.onPullBottom)||void 0===u||u.call(d,e)}}callSwipeSuccessHandlers(){var e,t,s,i,o,r,a,l,c,d;if(this.currentSwipeDir)switch(null===(e=this.options)||void 0===e||null===(t=e.onSwipe)||void 0===t||t.call(e,this.currentSwipeDir),this.currentSwipeDir){case n.LEFT:null===(s=this.options)||void 0===s||null===(i=s.onLeft)||void 0===i||i.call(s);break;case n.RIGHT:null===(o=this.options)||void 0===o||null===(r=o.onRight)||void 0===r||r.call(o);break;case n.TOP:null===(a=this.options)||void 0===a||null===(l=a.onTop)||void 0===l||l.call(a);break;case n.BOTTOM:null===(c=this.options)||void 0===c||null===(d=c.onBottom)||void 0===d||d.call(c)}}getPullDistance(e,t){switch(this.currentSwipeDir){case n.LEFT:return-e;case n.RIGHT:return e;case n.TOP:return-t;case n.BOTTOM:return t}return 0}checkIsSwiped(e){var t,s,i,o,r,a;return this.currentSwipeDir===n.LEFT||this.currentSwipeDir===n.RIGHT?"number"==typeof this.options.distanceX?e>=this.options.distanceX:null!==(t=null===(s=(i=this.options).distanceX)||void 0===s?void 0:s.call(i,e,this.currentSwipeDir))&&void 0!==t&&t:(this.currentSwipeDir===n.TOP||this.currentSwipeDir===n.BOTTOM)&&("number"==typeof this.options.distanceY?e>=this.options.distanceY:null!==(o=null===(r=(a=this.options).distanceY)||void 0===r?void 0:r.call(a,e,this.currentSwipeDir))&&void 0!==o&&o)}detectSwipeDirection(e,t){const s=Math.max(Math.abs(e),Math.abs(t));return!(s<10)&&((!this.options.allowTouchScroll||!this.checkScroll(e,t))&&(Math.abs(e)===s?this.currentSwipeDir=e>0?n.RIGHT:n.LEFT:this.currentSwipeDir=t>0?n.BOTTOM:n.TOP,!0))}}},20817:(e,t,s)=>{"use strict";function i(){return Math.floor(Date.now()/1e3)}function o(e){let t=Math.floor(e);const s=Math.floor(t/3600);t-=3600*s;const i=Math.floor(t/60);return t-=60*i,[s,i,t].filter(((e,t)=>0!==t||0!==e)).map((e=>String(e).padStart(2,"0"))).join(":")}s.d(t,{N:()=>i,i:()=>o})},66677:(e,t,s)=>{"use strict";s.d(t,{Kg:()=>o,Ni:()=>i,RI:()=>r});const i=(()=>{if("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch)return!0;const e=["webkit","moz","o","ms"].map((e=>`(-${e}-touch-enabled)`));e.unshift("(touch-enabled)");const t=e.join(",");return s=t,window.matchMedia(s).matches;var s})(),o={POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_UP:"pointerup pointercancel".split(" ")},r=e=>({clientX:e.clientX,clientY:e.clientY,type:e.pointerType||"touch"})},89532:(e,t,s)=>{"use strict";s.d(t,{c:()=>h});s(74916),s(15306),s(66992),s(33948),s(88674),s(2707),s(85827),s(41817);var i=s(35924),o=s(72346),r=(s(12953),s(36005));function n(e,t){if(null==e)return{};var s,i,o=function(e,t){if(null==e)return{};var s,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)s=r[i],t.indexOf(s)>=0||(o[s]=e[s]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)s=r[i],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(o[s]=e[s])}return o}function a(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}const l=s(30381),c=s(65470),d=/%(\d+)/g,u=[2,0,1,1,1,2],p=["Бит","КБ","МБ","ГБ","ТБ","ПБ","ЭБ","ЗБ","ИБ"];class h{static getTextContent(e){let t=document.createElement("div");return t.innerHTML=String(e).replace(/<p>/g,"<p>\n").replace(/<br>/g,"<br> "),t.textContent}static formatBytes(e,t=2,s=!0){let i=s?1e3:1024;if("number"!=typeof e&&(e=1024*i*10),0===e)return"0 "+p[0];let o=Math.floor(Math.log(e)/Math.log(i));return parseFloat((e/Math.pow(i,o)).toFixed(t))+" "+p[o]}static formatUsernamesList(e){let t=e.length>2?", ":" и ",s=o.o.escape();return e.map((e=>`<strong>${s(e)}</strong>`)).join(t)}static formatListOr(e){return h.formatList(e,"или")}static formatList(e,t="и"){var s;if(e.length<=1)return null!==(s=e[0])&&void 0!==s?s:"";const i=[...e],o=i.pop();return i.join(", ")+` ${t} `+o}static safeDecodeURIComponent(e){return i._.decode(e)}static random(e,t,s=!0){"boolean"!=typeof t&&Number.isFinite(t)||(s=t,t=e,e=0);let i=Number.isFinite(e)?e:0,o=Number.isFinite(t)?t:1,r=Math.random()*(o-i);return!0===s&&(i=Math.ceil(i),o=Math.floor(o)),i+(!0===s?Math.floor(r):r)}static randomOption(e){return e[this.random(0,e.length)]}static randomArray(e,t){return(0,r.shuffle)(e).slice(0,t)}static delay(e,t){return e<0?t:new Promise((s=>{setTimeout(s,e,t)}))}static equalNumbers(e,t,s=0){return e===t||e-s<=t&&e+s>=t}static pluralNounRU(e,t){return e=Math.abs(parseInt(e,10)),!(0,r.isArray)(t)||t.length,t[e%100>4&&e%100<20?2:u[e%10<5?e%10:5]]}static preparePhone(e){if(!e.length)return e;let t=Number(e.charAt(0));return 11!==e.length||7!==t&&8!==t||(e="+7"+e.slice(1)),10===e.length&&"+"!==e.charAt(0)&&(e="+7"+e),"+"!==e.charAt(0)&&(e="+"+e),e}static maskPhone(e){if(!(0,r.isString)(e)||!e.length)return"";let t=e.length,s=t>12?3:2,i=t-2-s;return e.slice(0,s)+"*".repeat(i)+e.slice(-2)}static maskEmail(e){if(!(0,r.isString)(e)||!e.length)return"";let t=e.lastIndexOf("@"),s=Math.round(t/3);return t<0?e:(1===t?"*":e.slice(0,s)+"*".repeat(t-s))+e.slice(t)}static reduceNumber(e){return e>1e3?(e>1e5?Math.floor(e/1e3):(e/1e3).toFixed(e<1e4?1:0).replace(/\.0$/,""))+"K":`${e}`}static pluralAdjectiveRU(e,t){return t[(e=Math.abs(parseInt(e,10)))%10==1&&e%100!=11?0:1]}static format(e,...t){return e.replace(d,(function(e,s){return void 0!==t[s]?`${t[s]}`:e}))}static urlToLocation(e){let t=document.createElement("a");return t.href=e,t}static getQueryParams(e){let t={};return e.replace(/^\?/g,"").replace(/\+/g," ").split("&").forEach((e=>{e=i._.decode(e);let[s,o]=e.split("=");return s&&(t[s]=o||!0),!0})),t}static toEven(e){return e?2*Math.floor(Math.ceil(e)/2):e}static calculateAspectRatioFit(e,t,s,i,o){let n=Math.min(1,s/e,i/t);return[(o=!!(0,r.isUndefined)(o)||o)?h.toEven(e*n):e*n,o?h.toEven(t*n):t*n]}static getDimension(e,t,s,i,o="contain",r=!1,n=!0){let a,l,c="contain"===o;if("cover"===o||c){let o=s/e,r=i/t,n=c?Math.min(o,r):Math.max(o,r);a=e*n,l=t*n}return[a,l].map((e=>(n&&(e=h.toEven(e)),r&&(e=Math.round(e)),e)))}static isOverflowed(e){const t=e.offsetHeight<e.scrollHeight,s=e.offsetWidth<e.scrollWidth;return t||s}static watchHeightStable(e,t=300,s=1e4,i=10){return new Promise((o=>{const n=[],a=setInterval((()=>{const t=e.height();if((0,r.isNumber)(t)&&(n.push(t),!(n.length<15)&&(n.shift(),t>0))){const e=n.sort(((e,t)=>Number(e)-Number(t)));Math.abs(e[0]-e[e.length-1])<i&&(clearInterval(a),o(!0))}}),t);setTimeout((()=>{clearInterval(a),o(!1)}),s)}))}static isSymbol(e){return!!e&&("symbol"==typeof e||!!e.constructor&&("Symbol"===e.constructor.name&&"Symbol"===e[e.constructor.toStringTag]))}static closestNumber(e,t){let s=null,i=null,o=t[0];for(let r=0;r<t.length;r++)s=Math.abs(e-o),i=Math.abs(e-t[r]),i<s&&(o=t[r]);return o}static escapeStringRegExp(e){return e.replace(/[\-\[\]\/{}()*+?.\\^$|]/g,"\\$&")}static copyToClipboard(e){if(!e.length)return;const t=()=>{const t=document.createElement("textarea");if(t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),c.ios&&parseInt(c.osversion,10)<13){const e=document.createRange();e.selectNodeContents(t);const s=window.getSelection();s.removeAllRanges(),s.addRange(e),t.setSelectionRange(0,999999)}else t.select();document.execCommand("copy"),document.body.removeChild(t)};"clipboard"in navigator?navigator.clipboard.writeText(e).catch(t):t()}static timestampToDaysUntil(e,t="D MMMM, H:mm"){let s={};if(e){let i=l.unix(e);s.dateEnds=i.format(t),s.daysUntil=Math.ceil(i.diff(l(),"days",!0))}return s}static allSettled(e){return Promise.all(e.map((e=>{e.then&&e.then((e=>({status:"fulfilled",value:e}))).catch((e=>({status:"rejected",reason:e})))})))}static preloadImage(e){return"string"!=typeof e?Promise.reject(new Error("problem with loading image, not found url")):new Promise(((t,s)=>{const i=new Image;i.src=e,i.onload=t,i.onerror=()=>s(new Error(`problem with loading image '${e}'`))}))}static preloadImageSet(e){return new Promise(((t,s)=>{const i=e.join(","),o=new Image;o.srcset=i,o.onload=t,o.onerror=()=>s(new Error(`problem with loading image-set '${i}'`))}))}static pick(e,...t){return Object.assign({},...t.map((t=>({[t]:e[t]}))))}static omit(e,...t){return t.reduce(((e,t)=>{const{[t]:s}=e;return n(e,[t].map(a))}),e)}static download(e,t,s="text/plain"){const i=document.createElement("a");i.setAttribute("href",`data:${s};charset=utf-8,`+encodeURIComponent(t)),i.setAttribute("download",e),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)}static getStoryIdFromUrl(){var e;const t=null===(e=location.pathname)||void 0===e?void 0:e.match(/^\/story\/\w*_(\d+)/);return t?parseInt(t[1],10):void 0}static escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\\/]/g,"\\$&")}static isInput(e){if(!e||!e.tagName)return!1;const t=e.tagName.toLowerCase();return"textarea"===t||"input"===t||"select"===t||e.isContentEditable}}},8233:(e,t,s)=>{"use strict";s.d(t,{y:()=>i});s(88674);function i(){return new Promise((e=>{setTimeout(e,0)}))}},95374:(e,t,s)=>{"use strict";s.d(t,{c:()=>n});s(24603),s(74916),s(66992),s(33948);var i=s(74750);const o=/^([\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+\.)*[\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+@((((([a-z0-9]{1}[a-z0-9\-]{0,62}[a-z0-9]{1})|[a-z])\.)+[a-z]{2,6})|(\d{1,3}\.){3}\d{1,3}(\:\d{1,5})?)$/i,r=["текст","длиннопост","видео","гифка","coub","ответ на пост","блоги компаний","моё",i.x];class n{static required(){return e=>Boolean(e)}static min(e,t=!1){return s=>!s.length&&t||Number(s)>=Number(e)}static max(e,t=!1){return s=>!s.length&&t||Number(s)<=Number(e)}static filterBuiltInTags(){return e=>-1===r.indexOf(e.toLowerCase())}static minTags(e){return t=>String(t).split(",").filter(n.filterBuiltInTags()).length>=e}static maxTags(e){return t=>String(t).split(",").filter(n.filterBuiltInTags()).length<=e}static matches(e,t,s){return e instanceof RegExp||(e=new RegExp(e,s)),s=>t?!e.test(s):e.test(s)}static email(e){return n.patternMatch(o,!e)}static patternMatch(e,t){if(!(e instanceof RegExp))throw new Error("pattern for Validation.patternMatch to be RegExp, but "+typeof e);return s=>!s.length&&t||e.test(s)}static patternMismatch(e,t){if(!(e instanceof RegExp))throw new Error("pattern for Validation.patternMatch to be RegExp, but "+typeof e);return s=>!s.length&&t||!e.test(s)}static isLength(e,t){return(s,i)=>(i||s).length>=e&&(!t||s.length<=t)}static isNotContainLink(){return(e,t)=>{const s=(t||e).match(/(https?|ftp):\/\/|([a-z0-9\-]{2,})\.([a-z]{2,4})/gi);return!s||s.length<2}}static keywordAsterisk(){return e=>{let t=e.match(/\*/g)||[];return!t.length||1===t.length&&"*"===e.slice(-1)}}static not(e){return(...t)=>!e(...t)}}},75021:(e,t,s)=>{"use strict";s.d(t,{zM:()=>b,wK:()=>f,nq:()=>w,vu:()=>l});s(66992),s(33948),s(85827);var i=s(65448);const o=new i.xs({SET_ATTRIBUTE:0,REMOVE_ATTRIBUTE:1,INSERT_CHILD:2,REMOVE_CHILD:3,UPDATE_CHILD:4,UPDATE_CHILDREN:5,INSERT_BEFORE:6,REPLACE_NODE:7,REMOVE_NODE:8,SAME_NODE:9,UPDATE_THUNK:10,UPDATE_UI_ELEMENT:11}),r=new i.xs({EMPTY:1,TEXT:2,NATIVE:3,UI_ELEMENT:4,THUNK:5});var n=s(36005);class a{static plainProps(e){let t={props:e,events:{}};if((0,n.isObject)(e)&&e.uiOptions){let s=e.uiOptions;delete e.uiOptions,(0,n.forEach)(s,((e,s)=>{t.props[s]=e}))}return(0,n.forEach)(e,((e,s)=>{let i=s.charAt(2);i&&0===s.indexOf("on")&&i===i.toUpperCase()&&(t.events[i.toLowerCase()+s.slice(3)]=e)})),(0,n.isObject)(e.events)&&(t.events=(0,n.extend)(t.events,e.events)),t}}class l{static create(e,t,...s){if(!e)throw new TypeError("element() needs a type.");t=t||{},s=(0,n.reduce)(s||[],l.reduceChildren,[]);let i=(0,n.isString)(t.key)||(0,n.isNumber)(t.key)?t.key:null;if(delete t.key,(0,n.isString)(t.className)&&(t.class=t.className,delete t.className),"object"==typeof e)return l.createThunkElement(e.render,i,t,s,e);if("function"==typeof e&&"isUIElement"in e){let{props:o,events:r}=a.plainProps(t);return l.createUIElement(e,i,o,r,s,e)}return"function"==typeof e?l.createThunkElement(e,i,t,s,e):{type:r.NATIVE,tagName:e,attributes:t,children:s,key:i}}static reduceChildren(e,t){if((0,n.isString)(t)||(0,n.isNumber)(t))e.push(l.createTextElement(t));else if(null===t||!1===t)e.push(l.createEmptyElement());else if(Array.isArray(t))e=[...e,...t.reduce(l.reduceChildren,[])];else{if((0,n.isUndefined)(t))throw new Error("vnode can't be undefined. Did you mean to use null?");e.push(t)}return e}static createTextElement(e){return{type:r.TEXT,nodeValue:e}}static createEmptyElement(){return{type:r.EMPTY}}static createUIElement(e,t,s,i,o,n){return{type:r.UI_ELEMENT,Fn:e,children:o,props:s,events:i,options:n,key:t}}static createThunkElement(e,t,s,i,o){return{type:r.THUNK,fn:e,children:i,props:s,options:o,key:t}}static isThunk(e){return e.type===r.THUNK}static isUIElement(e){return e.type===r.UI_ELEMENT}static isSameUIElement(e,t){return l.isUIElement(e)&&l.isUIElement(t)&&e.Fn===t.Fn}static isText(e){return e.type===r.TEXT}static isEmpty(e){return e.type===r.EMPTY}static isNative(e){return e.type===r.NATIVE}static isSameThunk(e,t){return l.isThunk(e)&&l.isThunk(t)&&e.fn===t.fn}static groupByKey(e){return(0,n.reduce)(e,((e,t,s)=>{if(!(0,n.isUndefined)(t)&&!1!==t){let i=(0,n.isNull)(t)?"_"+s:t.key||"_"+s;e.push({key:String(i),item:t,index:s})}return e}),[])}static createPath(...e){return e.join(".")}}const c={onAbort:"abort",onAnimationStart:"animationstart",onAnimationIteration:"animationiteration",onAnimationEnd:"animationend",onBlur:"blur",onCanPlay:"canplay",onCanPlayThrough:"canplaythrough",onChange:"change",onClick:"click",onContextMenu:"contextmenu",onCopy:"copy",onCut:"cut",onDoubleClick:"dblclick",onDrag:"drag",onDragEnd:"dragend",onDragEnter:"dragenter",onDragExit:"dragexit",onDragLeave:"dragleave",onDragOver:"dragover",onDragStart:"dragstart",onDrop:"drop",onDurationChange:"durationchange",onEmptied:"emptied",onEncrypted:"encrypted",onEnded:"ended",onError:"error",onFocus:"focus",onInput:"input",onInvalid:"invalid",onKeyDown:"keydown",onKeyPress:"keypress",onKeyUp:"keyup",onLoad:"load",onLoadedData:"loadeddata",onLoadedMetadata:"loadedmetadata",onLoadStart:"loadstart",onPause:"pause",onPlay:"play",onPlaying:"playing",onProgress:"progress",onMouseDown:"mousedown",onMouseEnter:"mouseenter",onMouseLeave:"mouseleave",onMouseMove:"mousemove",onMouseOut:"mouseout",onMouseOver:"mouseover",onMouseUp:"mouseup",onPaste:"paste",onRateChange:"ratechange",onReset:"reset",onScroll:"scroll",onSeeked:"seeked",onSeeking:"seeking",onSubmit:"submit",onStalled:"stalled",onSuspend:"suspend",onTimeUpdate:"timeupdate",onTransitionEnd:"transitionend",onTouchCancel:"touchcancel",onTouchEnd:"touchend",onTouchMove:"touchmove",onTouchStart:"touchstart",onVolumeChange:"volumechange",onWaiting:"waiting",onWheel:"wheel"},d="http://www.w3.org/2000/svg",u="http://www.w3.org/1999/xlink",p=["animate","circle","clipPath","defs","ellipse","g","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan","use"],h={xlinkHref:"xlink:href"},_=["cx","cy","d","dx","dy","fill","fillOpacity","fontFamily","fontSize","fx","fy","gradientTransform","gradientUnits","markerEnd","markerMid","markerStart","offset","opacity","patternContentUnits","patternUnits","points","preserveAspectRatio","r","rx","ry","spreadMethod","stopColor","stopOpacity","stroke","strokeDasharray","strokeLinecap","strokeOpacity","strokeWidth","textAnchor","transform","version","viewBox","x1","x2","x","y1","y2","y","xlink:href"],m=["text","search","tel","url","password"];class g{static removeAttribute(e,t,s){let i=c[t];if(i&&(0,n.isFunction)(s))e.removeEventListener(i,s);else switch(t){case"checked":case"disabled":case"selected":e[t]=!1;break;case"innerHTML":case"nodeValue":case"value":e[t]="";break;default:e.removeAttribute(t)}}static setAttribute(e,t,s,i){let o=c[t];if(s!==i){if(o)return(0,n.isFunction)(i)&&e.removeEventListener(o,i),void e.addEventListener(o,s);if(g.isValidAttribute(s))switch(t){case"checked":case"disabled":case"innerHTML":case"nodeValue":e[t]=s;break;case"selected":if(e.selected=s,"OPTION"===e.tagName&&e.parentNode){let t=e.parentNode;t.selectedIndex=(0,n.indexOf)(t.options,e)}break;case"value":g.setValue(e,s);break;default:g.setNativeAttribute(e,t,s)}else g.removeAttribute(e,t,i)}}static naturalSelection(e){return Boolean(e.setSelectionRange&&m.includes(e.type))}static setValue(e,t){if(g.naturalSelection(e)&&e===document.activeElement){let s=e.selectionStart,i=e.selectionEnd;e.value=t,e.setSelectionRange(s,i)}else e.value=t}static setNativeAttribute(e,t,s){h.hasOwnProperty(t)&&(t=h[t]),_.includes(t)?e.setAttributeNS("xlink:href"===t?u:"SVG",t,s):e.setAttribute(t,s)}static isValidAttribute(e){switch(typeof e){case"string":case"number":return!0;case"boolean":return e;default:return!1}}static createNativeElement(e){return p.includes(e)?document.createElementNS(d,e):document.createElement(e)}}let v={};class f{static createElement(e,t,s,i){switch(e.type){case r.TEXT:return f.createTextNode(e);case r.EMPTY:return document.createComment("VPik "+t);case r.UI_ELEMENT:return f.createUI(e,t,s,i);case r.THUNK:return f.createThunk(e,t,s,i);case r.NATIVE:return f.createHTMLElement(e,t,s,i)}}static getCachedElement(e){let t=v[e];return(0,n.isUndefined)(t)&&(t=v[e]=g.createNativeElement(e)),t.cloneNode(!1)}static createTextNode(e){return document.createTextNode((0,n.isString)(e.nodeValue)||(0,n.isNumber)(e.nodeValue)?e.nodeValue:"")}static createUI(e,t,s,i){if((0,n.isNull)(e.key))throw new Error("need key for UIElement");let o;return i.ui&&i.ui instanceof Map||(i.ui=new Map),i.ui.has(e.key)?(o=i.ui.get(e.key),o.setOptions(e.props)):(o=new e.Fn((0,n.extend)({},e.props)),i.ui.set(e.key,o),e.events&&(0,n.forEach)(e.events,((e,t)=>{i.listenTo(o,t,e)}))),e.state={ui:o},o.render().el}static createThunk(e,t,s,i){let{props:o,children:r}=e,{onCreate:n}=e.options,a={children:r,props:o,path:t,dispatch:s,context:i},c=e.fn(a),d=l.createPath(t,c.key||"0"),u=f.createElement(c,d,s,i);return n&&s(n(a)),e.state={vnode:c,model:a},u}static createHTMLElement(e,t,s,i){let{tagName:o,attributes:r,children:a}=e,c=f.getCachedElement(o);for(let n in r)g.setAttribute(c,n,r[n]);return a.forEach(((e,o)=>{if((0,n.isNull)(e)||(0,n.isUndefined)(e))return;let r=l.createPath(t,e.key||"_"+o),a=f.createElement(e,r,s,i);c.appendChild(a)})),c}}var y=s(7050);class b{static node(e,t,s){if((0,n.isUndefined)(e))throw new Error("Left node must not be null or undefined");if(e===t)return[[o.SAME_NODE]];if(!(0,n.isUndefined)(e)&&(0,n.isUndefined)(t))return[[o.REMOVE_NODE,e]];if(!(0,n.isNull)(e)&&(0,n.isNull)(t)||(0,n.isNull)(e)&&!(0,n.isNull)(t))return[[o.REPLACE_NODE,e,t,s]];if(e.type!==t.type)return[[o.REPLACE_NODE,e,t,s]];if(l.isNative(t)){if(e.tagName!==t.tagName)return[[o.REPLACE_NODE,e,t,s]];let i=b.attributes(e,t),r=b.children(e,t,s);return r.length&&i.push(r),i}if(l.isText(t)){let s=[];return e.nodeValue!==t.nodeValue&&s.push([o.SET_ATTRIBUTE,"nodeValue",t.nodeValue,e.nodeValue]),s}if(l.isUIElement(t)){let i=[];return l.isSameUIElement(e,t)?i.push([o.UPDATE_UI_ELEMENT,e,t,s]):i.push([o.REPLACE_NODE,e,t,s]),i}if(l.isThunk(t)){let i=[];return l.isSameThunk(e,t)?e.options&&e.options.notUpdate||i.push([o.UPDATE_THUNK,e,t,s]):i.push([o.REPLACE_NODE,e,t,s]),i}return l.isEmpty(t),[]}static children(e,t,s){let{CREATE:i,UPDATE:r,MOVE:n,REMOVE:a}=y,c=l.groupByKey(e.children),d=l.groupByKey(t.children),u=[];return(0,y.Z)(c,d,((e,t,c,d)=>{let p=c?l.createPath(s,null===c.key?c.index:c.key):null;switch(e){case i:u.push([o.INSERT_CHILD,c.item,d,p]);break;case r:{let e=b.node(t.item,c.item,p);e.length>0&&u.push([o.UPDATE_CHILD,t.index,e]);break}case n:{let e=b.node(t.item,c.item,p);e.push([o.INSERT_BEFORE,d]),u.push([o.UPDATE_CHILD,t.index,e]);break}case a:u.push([o.REMOVE_CHILD,t.index])}}),(e=>e.key)),u.length?[o.UPDATE_CHILDREN,u]:u}static attributes(e,t){let s=[],i=e.attributes,r=t.attributes;for(let n in r)r[n]!==i[n]&&s.push([o.SET_ATTRIBUTE,n,r[n],i[n]]);for(let n in i)n in r||s.push([o.REMOVE_ATTRIBUTE,n,i[n]]);return s}static props(e,t){let s={},i=e.props,o=t.props;for(let r in o)o[r]!==i[r]&&(s[r]=o[r]);for(let r in i)r in o||(s[r]=void 0);return s}}class w{static updateElement(e,t){return(s,i)=>{let r=i.slice(1);switch(i=i[0]){case o.SAME_NODE:return;case o.SET_ATTRIBUTE:g.setAttribute(s,...r);break;case o.REMOVE_ATTRIBUTE:g.removeAttribute(s,...r);break;case o.INSERT_BEFORE:w.insertAtIndex(s.parentNode,...r,s);break;case o.UPDATE_CHILDREN:w.updateChildren(s,...r,e,t);break;case o.UPDATE_THUNK:break;case o.UPDATE_UI_ELEMENT:s=w.updateUIElement(s,...r,e,t);break;case o.REPLACE_NODE:{const[i,o,n]=r;let a,l=s.parentNode;a=f.createElement(o,n,e,t),w.removeUIElement(i,o,e),l&&l.replaceChild(a,s),s=a,w.removeThunks(i,e);break}case o.REMOVE_NODE:w.removeUIElement(...r),w.removeThunks(...r),s.parentNode.removeChild(s),s=null}return s}}static updateChildren(e,t,s,i){let r=(0,n.toArray)(e.childNodes);t.forEach((t=>{let n=t[0],a=t.slice(1);switch(n){case o.INSERT_CHILD:{const[t,o,r]=a;w.insertAtIndex(e,o,f.createElement(t,r,s,i));break}case o.REMOVE_CHILD:{const[t]=a;e.removeChild(r[t]);break}case o.UPDATE_CHILD:{const[e,t]=a;let o=w.updateElement(s,i);t.forEach((t=>o(r[e],t)));break}}}))}static updateUIElement(e,t,s,i,o,r){let n=b.props(t,s);return t.state.ui.setOptions(n),s.state=t.state,e}static updateThunk(e,t,s,i,o,r){let{props:a,children:c}=s,{onUpdate:d}=s.options,u=t.state.vnode,p={children:c,props:a,path:i,dispatch:o,context:r},h=s.fn(p),_=b.node(u,h,l.createPath(i,"0"));return e=(0,n.reduce)(_,w.updateElement(o,r),e),d&&o(d(p)),s.state={vnode:h,model:p},e}static removeUIElement(e,t){l.isUIElement(e)&&(e.state.ui.unmount(),delete e.state.ui)}static removeThunks(e,t){for(;l.isThunk(e);){let s=e.options.onRemove;if(!e.state)return;s&&t(s(e.state.model)),e=e.state.vnode}e.children&&(0,n.forEach)(e.children,(e=>w.removeThunks(e,t)))}static insertAtIndex(e,t,s){let i=e.childNodes[t];i?e.insertBefore(s,i):e.appendChild(s)}}},86445:(e,t,s)=>{"use strict";s.d(t,{QU:()=>r,lH:()=>o});var i=s(82222);const o={[i.bF.SHORT_VIDEOS_STORY]:"short_videos",[i.bF.POPULAR_TAGS]:"tags",[i.hR.TOP_COMMENTS]:"comments"},r="shnsfw"},84726:(e,t,s)=>{"use strict";s.r(t),s.d(t,{createApp:()=>l});var i=s(76944),o=s(66252),r=s(2262),n=s(56281);const a=(0,o.aZ)({__name:"nsfw-warning",setup(e){const t=(0,r.iH)(!0);return(e,s)=>((0,o.wg)(),(0,o.j4)(n.Z,{modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=e=>t.value=e),"cancel-url":"/","proceed-url":"/browse/nsfw"},null,8,["modelValue"]))}});function l(){return(0,i.a)(a)}},94450:(e,t,s)=>{"use strict";s.r(t),s.d(t,{createApp:()=>k});var i=s(76944),o=s(66252),r=s(2262),n=s(3577),a=s(49963),l=s(20723),c=s(91904),d=s(82222),u=s(37043),p=s(55946);const h=["onClick","onMouseup"],_=["onClick","onMouseup"],m={key:0},g=(0,o.aZ)({__name:"single-block",setup(e){const t=c.V.getUserExperimentGroup(c.t.BROWSING_PAGE_V2),s="C"===t||"E"===t,{sendEvent:i}=(0,p.z)();function g(){i("transition_to_tab",{type:"explore",transition_source:s?"more_content":"banner"})}return(e,t)=>(0,r.SU)(s)?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,n.C_)(e.$style.container)},[(0,o._)("h3",null,[(0,o.Uk)(" Больше контента на странице "),(0,o._)("a",{href:"/browse",onClick:(0,a.iM)(g,["left"]),onMouseup:(0,a.iM)(g,["middle"])},"Обзор",40,h)]),(0,o.Wm)(l.Z,{block:(0,r.SU)(d.eQ).CARDS_BY_FILTERS},null,8,["block"])],2)):((0,o.wg)(),(0,o.iD)("a",{key:1,class:(0,n.C_)(e.$style.br),href:"/browse",onClick:(0,a.iM)(g,["left"]),onMouseup:(0,a.iM)(g,["middle"])},[(0,o._)("div",{class:(0,n.C_)(e.$style.caption)},[(0,o.Uk)(" Больше контента "),e.IS_MOBILE?((0,o.wg)(),(0,o.iD)("br",m)):(0,o.kq)("v-if",!0),(0,o.Uk)("на странице Обзор ")],2),(0,o.Wm)(u.Z,{label:"Посмотреть",size:"small"})],42,_))}});var v=s(67198),f=s.n(v),y=s(83744);const b={};b.$style=f();const w=(0,y.Z)(g,[["__cssModules",b]]);function k(){return(0,i.a)(w)}},7233:(e,t,s)=>{"use strict";s.d(t,{o:()=>u});s(88674),s(66992),s(33948),s(41817);var i=s(69876),o=s(82222),r=s(12953),n=s(12950);function a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function l(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?a(Object(s),!0).forEach((function(t){c(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function c(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const d=r.core.config("modules.browsing"),u=(0,i.Q_)("browsing",{state:()=>l(l({},d),{},{pageNumbers:{[o.hR.TOP_COMMENTS]:1},loading:{[o.hR.TOP_COMMENTS]:!1},canLoadMore:{[o.hR.TOP_COMMENTS]:!0},browsingCards:{[o.eQ.CARDS_BY_CONTENT]:[{url:"/browse/text-stories",title:"Текстовые",code:"text"},{url:"/browse/image-stories",title:"Картинки",code:"images"},{url:"/browse/video-stories",title:"Видео",code:"videos"},{url:"/browse/nsfw",title:"18+",code:"nsfw"}],[o.eQ.CARDS_AUTHORS]:[{url:"/browse/top-authors-stories",title:"Топовые авторы",code:"top_authors"},{url:"/browse/original-stories",title:"[моё]",code:"my"},{url:"/browse/reply-stories",title:"Посты-ответы",code:"answers"}],[o.eQ.CARDS_BY_FILTERS]:[{url:"/disputed",title:"Обсуждаемое",code:"discussed"},{url:"/most-saved",title:"Сохраняемое",code:"saved"},{url:"/browse/viral-stories",title:"Вирусное",code:"virus"},{url:"/browse/most-viewed-stories",title:"Просматриваемое",code:"viewed"}],[o.eQ.CARDS_BY_FORMAT]:[{url:"/browse/short-stories",title:"Короткие",code:"short"},{url:"/browse/series-stories",title:"Серии",code:"series"},{url:"/browse/anonymous",title:"Анонимные",code:"anonymous"},{url:"/browse/long-stories",title:"Длиннопосты",code:"dlinnopost"}]}}),actions:{async loadTopComments(){if(this.browsingParams)try{this.loading[o.hR.TOP_COMMENTS]=!0;const{response:e,data:t}=await async function(e){return await n.cf.post("/ajax/browse/top-comments",{page:e})}(++this.pageNumbers[o.hR.TOP_COMMENTS]);e.result&&t&&this.comments.push(...t),t.length<5&&(this.canLoadMore[o.hR.TOP_COMMENTS]=!1)}finally{this.loading[o.hR.TOP_COMMENTS]=!1}}}})},82222:(e,t,s)=>{"use strict";let i,o,r,n;s.d(t,{U_:()=>o,bF:()=>i,eQ:()=>n,hR:()=>r}),function(e){e[e.SHORT_VIDEOS_STORY=1]="SHORT_VIDEOS_STORY",e[e.POPULAR_TAGS=2]="POPULAR_TAGS"}(i||(i={})),function(e){e[e.UNIQUE=3]="UNIQUE",e[e.MY=4]="MY",e[e.REPLIES=5]="REPLIES"}(o||(o={})),function(e){e[e.TOP_COMMENTS=10]="TOP_COMMENTS",e[e.TOP_COMMUNITIES=11]="TOP_COMMUNITIES"}(r||(r={})),function(e){e[e.CARDS_BY_CONTENT=20]="CARDS_BY_CONTENT",e[e.CARDS_AUTHORS=21]="CARDS_AUTHORS",e[e.CARDS_BY_FILTERS=22]="CARDS_BY_FILTERS",e[e.CARDS_BY_FORMAT=23]="CARDS_BY_FORMAT"}(n||(n={}))},66338:(e,t,s)=>{"use strict";s.r(t),s.d(t,{createApp:()=>_i});s(41817);var i=s(76944),o=(s(66992),s(33948),s(88674),s(74916),s(15306),s(66252)),r=s(3577),n=s(2262),a=s(49963),l=s(66309),c=s(41218),d=s(70204),u=s(22521);const p=Symbol(),h="pkb_comstory",_="pkb_anon_comm_conf",m={videoUrl:"video-url",imageUrl:"image-url",imageFile:"image-file",uploadedImage:"uploaded-image"};var g=s(47994),v=s(53056),f=s(69023),y=s(37043),b=s(50542),w=s(93356);var k=s(12953);const S=["innerHTML"],O=(0,o.aZ)({__name:"hidden-by-note-view",props:{ignoreTypes:{}},setup(e){const t=e,{authorUserName:s,storyAuthorUserName:i}=(0,w.D3)(p),n=(0,o.Fl)((()=>{const e=t.ignoreTypes.includes(g.IV.AUTHOR_OF_COMMENT_IGNORES_YOU),o=t.ignoreTypes.includes(g.IV.AUTHOR_OF_STORY_IGNORES_YOU),r=[];return e&&r.push(s),o&&i!==s&&r.push(i),[...new Set(r)].filter((e=>"DELETED"!==e))})),a=(0,o.Fl)((()=>{return n.value.length?k.core.i18n("comments.hidden.reply-note",n.value.length,(e=n.value,[...e].map((e=>`<b>${e}</b>`)).join(e.length>1?" и ":", "))):void 0;var e}));return(e,t)=>a.value?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,r.C_)(e.$style.host),innerHTML:a.value},null,10,S)):(0,o.kq)("v-if",!0)}});var E=s(30602),C=s.n(E),x=s(83744);const T={};T.$style=C();const I=(0,x.Z)(O,[["__cssModules",T]]);var P=s(72658),A=s(90008),D=s(55317);const M=[(0,o._)("path",{fill:"currentColor",d:"M24 10h9v1h-9zM36 10h5v1h-5zM43 10h9v1h-9zM44 14h8v1h-8zM32 14h10v1H32zM24 18h18v1H24zM24 14h6v1h-6zM24 6h6v1h-6zM32 6h13v1H32zM47 6h5v1h-5z"},null,-1),(0,o._)("path",{stroke:"currentColor",d:"M19.299 18.13C19.299 22.015 13 23 13 23h39.95c2.775 0 4.05-2.084 4.05-3.602V5.688c0-3.11-2.7-3.751-4.05-3.683H23.349c-3.096 0-3.99 2.019-4.05 3.028V18.13Z"},null,-1)],R=[(0,o._)("path",{fill:"currentColor",d:"M0 0h2v1H0zM19 0h7v1h-7zM42 0h2v1h-2zM49 0h2v1h-2zM66 0h8v1h-8zM91 0h2v1h-2zM103 0h1v1h-1zM129 0h4v1h-4zM160 0h1v1h-1z"},null,-1)],N=[(0,o._)("path",{fill:"currentColor",d:"M0 0h1v1H0zM19 0h3v1h-3zM43 0h1v1h-1zM46 0h1v1h-1zM64 0h2v1h-2zM68 0h3v1h-3zM83 0h7v1h-7zM91 0h1v1h-1zM108 0h2v1h-2zM114 0h2v1h-2zM137 0h7v1h-7zM167 0h2v1h-2z"},null,-1)],B=[(0,o._)("path",{fill:"currentColor",d:"M0 0h3v1H0zM13 0h10v1H13zM37 0h2v1h-2zM119 0h3v1h-3zM139 0h11v1h-11zM169 0h3v1h-3z"},null,-1)],L=[(0,o._)("path",{fill:"currentColor",d:"M0 0h3v1H0zM16 0h10v1H16zM39 0h4v1h-4zM61 0h3v1h-3zM98 0h3v1h-3zM85 0h1v1h-1zM118 0h10v1h-10zM148 0h3v1h-3z"},null,-1)],j=[(0,o._)("path",{fill:"currentColor",d:"M0 0h2v1H0zM9 0h8v1H9zM30 0h2v1h-2z"},null,-1)];var $=s(25392),U=s.n($);const F={},V={};V.$style=U();const H=(0,x.Z)(F,[["render",function(e,t){return(0,o.wg)(),(0,o.iD)("div",{class:(0,r.C_)(e.$style.host)},[((0,o.wg)(),(0,o.iD)("svg",{class:(0,r.C_)(e.$style.message),xmlns:"http://www.w3.org/2000/svg",fill:"none",width:"58",height:"24"},M,2)),(0,o._)("div",{class:(0,r.C_)(e.$style.strokes)},[((0,o.wg)(),(0,o.iD)("svg",{class:(0,r.C_)([e.$style.str,e.$style.str_1]),xmlns:"http://www.w3.org/2000/svg",fill:"none",width:"161",height:"1"},R,2)),((0,o.wg)(),(0,o.iD)("svg",{class:(0,r.C_)([e.$style.str,e.$style.str_2]),xmlns:"http://www.w3.org/2000/svg",fill:"none",width:"169",height:"1"},N,2)),((0,o.wg)(),(0,o.iD)("svg",{class:(0,r.C_)([e.$style.str,e.$style.str_3]),xmlns:"http://www.w3.org/2000/svg",fill:"none",width:"172",height:"1"},B,2)),((0,o.wg)(),(0,o.iD)("svg",{class:(0,r.C_)([e.$style.str,e.$style.str_4]),xmlns:"http://www.w3.org/2000/svg",fill:"none",width:"151",height:"1"},L,2))],2),(0,o._)("div",{class:(0,r.C_)([e.$style.strokes,e.$style.strokesBottom])},[((0,o.wg)(),(0,o.iD)("svg",{class:(0,r.C_)([e.$style.str,e.$style.str_5]),xmlns:"http://www.w3.org/2000/svg",fill:"none",width:"32",height:"1"},j,2))],2)],2)}],["__cssModules",V]]);var Z=s(7284),z=s(35653),q=s(57557),W=s.n(q);const G=(0,o.aZ)({__name:"pkb-tooltip-rich",props:{active:{type:Boolean},for:{},alignment:{},direction:{},theme:{},wrapperClass:{},container:{},closeOnClickOutside:{type:Boolean,default:!0},withAnimation:{type:Boolean,default:!0},showArrow:{type:Boolean},targetAlignment:{},title:{},mainButtonLabel:{default:"Понятно"},closeOnMainButtonClick:{type:Boolean,default:!0},secondaryButtonLabel:{}},emits:["update:active","mainButtonClick","secondaryButtonClick"],setup(e,{emit:t}){const s=e,i=t,n=()=>{i("mainButtonClick"),s.closeOnMainButtonClick&&i("update:active",!1)},a=(0,o.Fl)((()=>"red"===s.theme?"gray":"dark"===s.theme?"negative":"normal")),l=(0,o.Fl)((()=>"green"===s.theme?"normal":"gray")),c=(0,o.Fl)((()=>"green"===s.theme)),d=["title","closeOnMainButtonClick","mainButtonLabel","secondaryButtonLabel"],u=(0,o.Fl)((()=>W()(s,d)));return(e,t)=>((0,o.wg)(),(0,o.j4)(z.Z,(0,o.dG)(u.value,{class:e.$style.container,"onUpdate:active":t[1]||(t[1]=t=>e.$emit("update:active",t))}),{default:(0,o.w5)((()=>[e.$slots.title||e.title?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,r.C_)([e.$style.title,e.$style[`title_${e.theme}`]])},[e.$slots.title?(0,o.WI)(e.$slots,"title",{key:0}):((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[(0,o.Uk)((0,r.zw)(e.title),1)],64))],2)):(0,o.kq)("v-if",!0),(0,o._)("div",{class:(0,r.C_)([e.$style.content,e.$style[`content_${e.theme}`]])},[(0,o.WI)(e.$slots,"default")],2),(0,o._)("div",{class:(0,r.C_)(e.$style.buttons)},[(0,o.Wm)(y.Z,{size:"small",theme:a.value,class:(0,r.C_)(e.$style.button_main),onClick:n},{default:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(e.mainButtonLabel),1)])),_:1},8,["theme","class"]),e.secondaryButtonLabel?((0,o.wg)(),(0,o.j4)(y.Z,{key:0,size:"small",theme:l.value,outline:c.value,onClick:t[0]||(t[0]=t=>e.$emit("secondaryButtonClick"))},{default:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(e.secondaryButtonLabel),1)])),_:1},8,["theme","outline"])):(0,o.kq)("v-if",!0)],2)])),_:3},16,["class"]))}});var Y=s(36865),K=s.n(Y);const X={};X.$style=K();const J=(0,x.Z)(G,[["__cssModules",X]]);var Q=s(91181),ee=s(75130),te=s(55946);const se=(0,o._)("p",null," Содержательный комментарий — это хорошо. А отдельный пост‑ответ — ещё лучше. Он появится в лентах и получит больше внимания. ",-1),ie=(0,o.aZ)({__name:"submit-btn-view",props:{locked:{type:Boolean},comstoryAvailable:{type:Boolean}},emits:["submit","submit:comstory","publish:comstory"],setup(e,{expose:t,emit:s}){const{sendEvent:i}=(0,te.z)(),{loading:l,textContent:c,storyId:d,storyAuthorId:u,commentId:_}=(0,w.D3)(p),m=e,g=(0,n.iH)(),f=(0,n.iH)(),b=(0,n.iH)(!1),k=(0,n.iH)(!Boolean(v.m.get(h))),S=(0,n.iH)(),O=(0,n.iH)(!1),E=s;if(m.comstoryAvailable&&k.value){const e=(0,o.m0)((()=>{if(!k.value)return O.value=!1,void e();O.value?(S.value.updatePosition(),c.value.length<300&&(O.value=!1)):c.value.length>=300&&(O.value=!0)}))}function C(){k.value=!1}const x=new ee.U,T=(0,n.iH)(!1);return t({closeHint:C}),(e,t)=>((0,o.wg)(),(0,o.iD)("div",{ref_key:"hostEl",ref:g,class:(0,r.C_)(e.$style.host)},[(0,o.Wm)(y.Z,(0,o.dG)(e.$attrs,{class:{[e.$style.mainBtn_radius]:m.comstoryAvailable},label:"Отправить",size:"small",wide:"","data-test":"comment-reply-submit",disabled:m.locked,onClick:t[0]||(t[0]=e=>function(){if(!x.get("isComstoryPopupShown")&&m.comstoryAvailable&&c.value.length>=600)return T.value=!0,x.set("isComstoryPopupShown",!0),void i("post_answer_popup_showed",{post_id:d,author_id:u});E("submit")}())}),{default:(0,o.w5)((()=>[(0,n.SU)(l)?((0,o.wg)(),(0,o.j4)(H,{key:0})):(0,o.kq)("v-if",!0)])),_:1},16,["class","disabled"]),m.comstoryAvailable?((0,o.wg)(),(0,o.j4)(Z.Z,{key:0,ref_key:"extraBtnEl",ref:f,class:(0,r.C_)(e.$style.extraBtn),icon:"more_16",size:"small","data-test":"comment-reply-extra",onClick:t[1]||(t[1]=(0,a.iM)((e=>b.value=!0),["stop"]))},null,8,["class"])):(0,o.kq)("v-if",!0),m.comstoryAvailable?((0,o.wg)(),(0,o.j4)(J,{key:1,ref_key:"comstoryHintRef",ref:S,active:O.value,for:f.value,direction:"bottom","onUpdate:active":t[2]||(t[2]=e=>(v.m.set(h,1),void C()))},{default:(0,o.w5)((()=>[(0,o.Uk)(" Похоже, вы написали большой комментарий! Его можно опубликовать в виде поста-ответа. ")])),_:1},8,["active","for"])):(0,o.kq)("v-if",!0),e.IS_MOBILE?((0,o.wg)(),(0,o.j4)(P.Z,{key:2,modelValue:b.value,"onUpdate:modelValue":t[4]||(t[4]=e=>b.value=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(A.Z,{label:"Ответить постом",onClick:t[3]||(t[3]=e=>E("submit:comstory"))})])),_:1},8,["modelValue"])):(0,o.kq)("v-if",!0),e.IS_DESKTOP?((0,o.wg)(),(0,o.j4)(D.Z,{key:3,for:g.value,active:b.value,width:"auto","relative-position":"right","onClick:outside":t[6]||(t[6]=e=>b.value=!1)},{default:(0,o.w5)((()=>[(0,o.Wm)(A.Z,{label:"Ответить постом",onClick:t[5]||(t[5]=e=>E("submit:comstory"))})])),_:1},8,["for","active"])):(0,o.kq)("v-if",!0),(0,o.Wm)(Q.Z,{modelValue:T.value,"onUpdate:modelValue":t[9]||(t[9]=e=>T.value=e),title:"Ну а может лучше пост-ответ?","cross-button":"",class:(0,r.C_)(e.$style.popup),onClose:t[10]||(t[10]=e=>{i("post_answer_popup_closed",{post_id:d,author_id:u})})},{footer:(0,o.w5)((()=>[(0,o._)("div",{class:(0,r.C_)(e.$style.popupActions)},[(0,o.Wm)(y.Z,{label:"Пост-ответ",onClick:t[7]||(t[7]=e=>(T.value=!1,void E("publish:comstory")))}),(0,o.Wm)(y.Z,{theme:"gray",label:"Комментарий",onClick:t[8]||(t[8]=e=>(T.value=!1,i("leave_comment",{type:"post_answer_popup",post_id:d,author_id:u,comment_id:_}),void E("submit")))})],2)])),default:(0,o.w5)((()=>[se])),_:1},8,["modelValue","class"])],2))}});var oe=s(77741),re=s.n(oe);const ne={};ne.$style=re();const ae=(0,x.Z)(ie,[["__cssModules",ne]]);var le=s(40094),ce=s(89661),de=s(98858);const ue=(0,o.aZ)({__name:"thumb-view",props:{thumb:{}},emits:["delete"],setup(e,{emit:t}){const s=e,i=t,l=(0,n.iH)(),c=(0,n.iH)(""),d=(0,o.Fl)((()=>s.thumb.type===m.videoUrl?s.thumb.duration:"")),u=s.thumb.type===m.imageFile;if(u){const{preview:e}=function(e,t){const s=(0,n.iH)();return(0,o.bv)((async()=>{const i=new de.Np(e),o=await i.preview(t).get();s.value=o})),{preview:s}}(s.thumb.src,92);(0,o.YP)(e,(e=>{var t;e instanceof HTMLCanvasElement&&(null===(t=l.value)||void 0===t||t.appendChild(e))}))}else c.value=s.thumb.src;return(e,t)=>{const n=(0,o.Q2)("tooltip");return(0,o.wg)(),(0,o.iD)("div",{class:(0,r.C_)([e.$style.host,{[e.$style.host_error]:s.thumb.error}]),style:(0,r.j5)({"--preview-size":"92px"})},[(0,o._)("button",{class:(0,r.C_)(e.$style.close),onClick:t[0]||(t[0]=(0,a.iM)((e=>i("delete",s.thumb)),["prevent"]))},[(0,o.Wm)(le.Z,{name:"close",size:8})],2),u?((0,o.wg)(),(0,o.iD)("div",{key:0,ref_key:"previewEl",ref:l,class:(0,r.C_)(e.$style.preview)},null,2)):((0,o.wg)(),(0,o.iD)("div",{key:1,class:(0,r.C_)(e.$style.preview),style:(0,r.j5)({"background-image":`url(${c.value})`})},null,6)),d.value?((0,o.wg)(),(0,o.iD)("span",{key:2,class:(0,r.C_)(e.$style.duration)},(0,r.zw)(d.value),3)):(0,o.kq)("v-if",!0),null!==s.thumb.progress?((0,o.wg)(),(0,o.iD)("div",{key:3,class:(0,r.C_)(e.$style.loader)},[(0,o.Wm)(ce.Z,{progress:s.thumb.progress,size:30},null,8,["progress"])],2)):(0,o.kq)("v-if",!0),s.thumb.error?(0,o.wy)(((0,o.wg)(),(0,o.iD)("i",{key:4,class:(0,r.C_)(["fa fa-exclamation-triangle",e.$style.errorIcon])},null,2)),[[n,s.thumb.error]]):(0,o.kq)("v-if",!0)],6)}}});var pe=s(48557),he=s.n(pe);const _e={};_e.$style=he();const me=(0,x.Z)(ue,[["__cssModules",_e]]);var ge=s(12665);const ve=(0,o.aZ)({__name:"thumbs-view",props:{thumbs:{}},emits:["delete:thumb"],setup(e,{emit:t}){const s=e,i=t,l=(0,n.iH)(),c=(0,a.fb)();return(0,ge.nB)(l,s.thumbs,{sort:!0,animation:200,delay:10,ghostClass:c.item_ghost,chosenClass:c.item_chosen,forceFallback:!0}),(e,t)=>s.thumbs.length?((0,o.wg)(),(0,o.iD)("div",{key:0,ref_key:"hostEl",ref:l,class:(0,r.C_)(e.$style.host)},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.thumbs,(e=>((0,o.wg)(),(0,o.j4)(me,{key:e.id,thumb:e,onDelete:t[0]||(t[0]=e=>i("delete:thumb",e))},null,8,["thumb"])))),128))],2)):(0,o.kq)("v-if",!0)}});var fe=s(81455),ye=s.n(fe);const be={};be.$style=ye();const we=(0,x.Z)(ve,[["__cssModules",be]]);s(24603);var ke=s(85651);const Se=(0,o.aZ)({__name:"alert-view",props:{withCloseIcon:{type:Boolean}},emits:["close"],setup(e,{emit:t}){const s=e,i=t;return(e,t)=>((0,o.wg)(),(0,o.j4)(ke.Z,{class:(0,r.C_)(e.$style.host),theme:"yellow"},{default:(0,o.w5)((()=>[s.withCloseIcon?((0,o.wg)(),(0,o.j4)(le.Z,{key:0,name:"close_16",class:(0,r.C_)(e.$style.close),onClick:t[0]||(t[0]=e=>i("close",e))},null,8,["class"])):(0,o.kq)("v-if",!0),(0,o.WI)(e.$slots,"default")])),_:3},8,["class"]))}});var Oe=s(16070),Ee=s.n(Oe);const Ce={};Ce.$style=Ee();const xe=(0,x.Z)(Se,[["__cssModules",Ce]]),Te=(0,o._)("br",null,null,-1),Ie=(0,o._)("a",{href:"/@moderator",target:"_blank"},"@moderator",-1),Pe=(0,o._)("br",null,null,-1),Ae=(0,o._)("a",{href:"/@SupportTech",target:"_blank"},"@SupportTech",-1),De=(0,o._)("br",null,null,-1),Me=(0,o._)("a",{href:"/@SupportTech",target:"_blank"},"@SupportTech",-1),Re=(0,o._)("br",null,null,-1),Ne=(0,o._)("a",{href:"/@moderator",target:"_blank"},"@moderator",-1),Be=(0,o._)("br",null,null,-1),Le=(0,o._)("a",{href:"/@SupportCommunity",target:"_blank"},"@SupportCommunity",-1),je=(0,o._)("br",null,null,-1),$e=(0,o._)("a",{href:"/@moderator",target:"_blank"},"@moderator",-1),Ue=(0,o._)("a",{href:"/@SupportTech",target:"_blank"},"@SupportTech",-1),Fe=(0,o._)("br",null,null,-1),Ve=(0,o._)("a",{href:"/@editors",target:"_blank"},"@editors",-1),He=(0,o._)("br",null,null,-1),Ze=(0,o._)("a",{href:"/@moderator",target:"_blank"},"@moderator",-1),ze=(0,o._)("a",{href:"/@SupportTech",target:"_blank"},"@SupportTech",-1),qe=(0,o._)("br",null,null,-1),We=(0,o._)("a",{href:"/@moderator",target:"_blank"},"@moderator",-1),Ge=(0,o._)("br",null,null,-1),Ye=(0,o._)("a",{href:"/@SupportTech",target:"_blank"},"@SupportTech",-1),Ke=(0,o._)("br",null,null,-1),Xe=(0,o._)("a",{href:"/@SupportCommunity",target:"_blank"},"@SupportCommunity",-1),Je=(0,o._)("br",null,null,-1),Qe=(0,o._)("a",{href:"/@SupportTags",target:"_blank"},"@SupportTags",-1),et=(0,o._)("a",{href:"/@editors",target:"_blank"},"@editors",-1),tt=(0,o._)("br",null,null,-1),st=(0,o.aZ)({__name:"special-users-mentions-msg-view",props:{textContent:{}},setup(e){const t=["moderator","SupportTech","SupportCommunity","SupportTags","editors"],s=e,i=(0,n.iH)(!1),r=(0,n.iH)(""),a=(0,c.B_)((()=>s.textContent),(e=>{if(i.value)return;const s=t.filter((t=>new RegExp(`@${t}([^a-zA-Zа-яА-ЯёЁ0-9_]|$)`).test(e)));s.length?r.value=s.length>1?"all":s[0]:r.value=""}),{debounce:500});return(e,t)=>!i.value&&r.value?((0,o.wg)(),(0,o.j4)(xe,{key:0,"with-close-icon":"",onClose:t[0]||(t[0]=e=>(i.value=!0,void a()))},{default:(0,o.w5)((()=>["moderator"===r.value?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.Uk)(" Вы призываете модератора. "),Te,(0,o.Uk)("Обратите внимание, "),Ie,(0,o.Uk)(" решает вопросы, связанные с нарушениями правил. "),Pe,(0,o.Uk)("Если проблема носит технический характер, позовите "),Ae,(0,o.Uk)(". ")],64)):"SupportTech"===r.value?((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[(0,o.Uk)(" Вы призываете техническую поддержку. "),De,(0,o.Uk)("Обратите внимание, "),Me,(0,o.Uk)(" помогает разобраться с багами и отвечает на технические вопросы по будням. "),Re,(0,o.Uk)("Если вы не уверены, что проблема носит технический характер, лучше позовите "),Ne,(0,o.Uk)(". ")],64)):"SupportCommunity"===r.value?((0,o.wg)(),(0,o.iD)(o.HY,{key:2},[(0,o.Uk)(" Вы призываете аккаунт поддержки сообществ. "),Be,(0,o.Uk)("Обратите внимание, "),Le,(0,o.Uk)(" помогает решить вопросы, связанные с сообществами на Пикабу. "),je,(0,o.Uk)("Если ваш вопрос связан с нарушениями правил сайта, лучше позовите "),$e,(0,o.Uk)(", если с техническими проблемами, позовите "),Ue,(0,o.Uk)(". ")],64)):"SupportTags"===r.value||"editors"===r.value?((0,o.wg)(),(0,o.iD)(o.HY,{key:3},[(0,o.Uk)(" Вы призываете команду редакторов тегов. "),Fe,(0,o.Uk)("Обратите внимание, "),Ve,(0,o.Uk)(" могут помочь в редактировании тегов, одобрении новых. "),He,(0,o.Uk)("Если ваш вопрос связан с нарушениями правил сайта, лучше позовите "),Ze,(0,o.Uk)(", если с техническими проблемами, позовите "),ze,(0,o.Uk)(". ")],64)):((0,o.wg)(),(0,o.iD)(o.HY,{key:4},[(0,o.Uk)(" Кажется, вы сомневаетесь, кого лучше призвать. "),qe,We,(0,o.Uk)(" решает вопросы, связанные с нарушениями правил. "),Ge,Ye,(0,o.Uk)(" помогает разобраться с багами и отвечает на технические вопросы. "),Ke,Xe,(0,o.Uk)(" помогает решить вопросы, связанные с сообществами на Пикабу. "),Je,Qe,(0,o.Uk)(" и "),et,(0,o.Uk)(" могут помочь в редактировании тегов, одобрении новых. "),tt,(0,o.Uk)("Пожалуйста, постарайтесь призывать одного конкретного специалиста по вопросу. ")],64))])),_:1})):(0,o.kq)("v-if",!0)}});var it=s(10920),ot=s(33877),rt=s(89275);const nt=(0,s(69876).Q_)("comment-reply",{actions:{decrementAvailableNumberOfCommentsForToday(){const e=(0,rt.o)();void 0!==e.initParams.availableNumberOfCommentsForToday&&e.initParams.availableNumberOfCommentsForToday--}},getters:{availableNumberOfCommentsForToday(){var e;return null!==(e=(0,rt.o)().initParams.availableNumberOfCommentsForToday)&&void 0!==e?e:1/0},hasCommentLimitBeenReached(){return(0,rt.o)().initParams.isSlowModeEnabled&&this.availableNumberOfCommentsForToday<=0}}});var at=s(97323),lt=(s(97314),s(13218)),ct=s.n(lt),dt=s(44760),ut=s(12950),pt=s(81763),ht=s.n(pt),_t=s(53536),mt=s(46068),gt=s(20817),vt=s(29939),ft=s(10703),yt=s(96637);function bt(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function wt(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?bt(Object(s),!0).forEach((function(t){kt(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):bt(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function kt(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function St(){const e=(0,rt.o)(),t=(0,n.iH)([]),s=[];function i(){return!(t.value.length>=10)||(k.core.ui.toasts.showError("Запрещено загружать более 10 изображений"),!1)}const r={canHandle:e=>"file"in e&&"image"===e.type,handle:e=>({type:m.imageFile,src:e.file})},a={canHandle:e=>"url"in e&&"image"===e.type,handle:e=>({type:m.uploadedImage,src:e.url.replace("big_size_comm_an","previews_gif_comm"),uploadedFileName:e.uploadedFileName})},l={canHandle:e=>"source"in e&&"video"===e.type&&"url"in e&&"number"==typeof e.duration,handle:e=>({type:m.videoUrl,src:e.source,duration:(0,gt.i)(e.duration),url:e.url})},c={canHandle:e=>"url"in e&&e.type===vt.v.IMAGE,handle:e=>({type:m.imageUrl,src:e.url})};const d={canHandle:e=>"url"in e&&e.type===vt.v.VIDEO,handle:async e=>{const t=e.url,i=ft.tv.getVideoDetails(t);s.push(i);const o=s.length-1,{response:r,data:n}=await i;if(r.result||k.core.ui.toasts.showError(k.core.i18n(r.message)),s.splice(o,1),function(e){return ct()(e)&&"thumb"in e&&"string"==typeof e.thumb&&"duration"in e&&"number"==typeof e.duration&&(!("is_nsfw"in e)||"is_nsfw"in e&&!e.is_nsfw)}(n)&&!h(m.videoUrl,n.url))return{type:m.videoUrl,src:n.thumb,duration:(0,gt.i)(n.duration),url:n.url}}};function u(e){e.slice(0,10-t.value.length).forEach((async e=>{const s=[r,a,d,c,l].find((t=>t.canHandle(e)));if(s){const i=await s.handle(e);i&&t.value.push(wt(wt({},i),{},{error:null,progress:null,id:Math.floor(yt.Utils.random(0,1e3)*Date.now()).toString(16)}))}}))}function p(s){if(!i())return;const o=(0,_t.u1)(s).filter((({type:e})=>"image"===e)).filter((({type:s,file:i})=>s?i.size>e.initParams.maxImageFileSize?(k.core.ui.toasts.showError(`Размер ${i.name} должен быть не более ${e.initParams.maxImageFileSize/1024/1024}MB`),!1):!function({type:e,file:s}){return t.value.some((t=>t.src instanceof File&&"video"===e&&t.type===m.videoUrl&&t.src.name===s.name&&t.src.size===s.size))}({type:s,file:i}):(k.core.ui.toasts.showError(`${i.name} имеет неподдерживаемый формат изображения.\n\t\t\t\t\t\tДоступные форматы: PNG, JPEG, GIF, WEBP`),!1)));o.length&&u(o)}function h(e,s){return t.value.some((t=>t.type===e&&("string"==typeof t.src&&t.src===s||t.type===m.videoUrl&&t.url===s||"origin"in t&&t.origin===s)))}const _=(0,dt.Z)((async(e,t)=>await ut.ff.upload({type:"comment_image",uid:0},e,{progress:e=>null==t?void 0:t(e.loaded/e.total)})),3);function g(){return t.value.filter((e=>(m.imageUrl===e.type||m.imageFile===e.type)&&null===e.progress)).map((async e=>{const{data:s,response:i}=e.src instanceof Blob?await _(e.src,(t=>{e.progress=t})):await async function(e){const t=setInterval((()=>{ht()(e.progress)||(e.progress=0),e.progress+=.05,e.progress>=1&&clearInterval(t)}),1e3),s=await ut.ff.post({type:"comment_image",url:e.src});return clearInterval(t),e.progress=null,s}(e);if(i.result&&s.tmp_file_url){const i=t.value.findIndex((t=>e.id===t.id));i>-1&&(t.value[i]={id:e.id,type:m.uploadedImage,src:s.tmp_file_url,uploadedFileName:s.tmp_file_name,error:null,progress:null,origin:e.src})}else e.error=i.message||"Возникла ошибка при загрузке изображения";return e.progress=null,!0}))}return{addFiles:p,addLinks:function(e){if(!i())return;const t=new Set,s=e.filter((e=>!t.has(e.url)&&(t.add(e.url),!0))).filter((e=>{const t=function(e){return{[vt.v.IMAGE]:m.imageUrl,[vt.v.VIDEO]:m.videoUrl}[e]}(e.type);return!!t&&!h(t,e.url)}));s.length&&u(s)},addUploaded:function(e){u(e)},addAttachedImages:async function(){p(await(0,mt.Z)({accept:{"image/*":_t.We.map((e=>`.${e}`))},multiple:!0}))},thumbs:t,upload:function(){return Promise.allSettled([...s,...g()])},clear:function(){t.value=[]},deleteThumb:function(e){t.value=t.value.filter((t=>t!==e))},isLimitReached:(0,o.Fl)((()=>t.value.length>=10))}}var Ot=s(30381),Et=s.n(Ot);function Ct(e){return e?new Promise((t=>{const s=new Image;s.addEventListener("error",(()=>t(!1))),s.addEventListener("load",(()=>t(!0))),s.src=e,s.complete&&t(!0)})):Promise.resolve(!1)}function xt(e){return Boolean("string"!=typeof e&&"image"===e.type&&e.url&&"string"==typeof e.uploadedFileName)}s(85827);var Tt=s(76137);function It(e,t){return 0===t.length?e:t.reduce(((e,t)=>{if(t.type===m.imageFile)return e;const s=t.type===m.uploadedImage?t.origin:t.src;if("string"!=typeof s)return e;const i=(0,Tt.f)(s);return e.replace(new RegExp(i,"g"),"")}),e)}function Pt(e){const t=e.map((e=>e.type===m.uploadedImage?{type:"image",url:e.src,uploadedFileName:e.uploadedFileName}:e.type===m.videoUrl&&{type:"video",src:e.src,url:e.url,duration:e.duration})).filter(Boolean);return JSON.stringify(t)}function At(e){return e.map((e=>e.type===m.videoUrl?{type:"video",url:e.url}:e.type===m.imageFile?e.src:e.type===m.imageUrl?{type:"image-url",url:e.src}:!(e.type!==m.uploadedImage||!e.origin)&&(e.origin instanceof Blob?e.origin:{type:"image-url",url:e.origin}))).filter((e=>!1!==e))}function Dt(e){return e.replace(/<br><\/p><p>/g,"</p><p><br></p><p>").replace(/<br><\/p><\/blockquote>/g,"</p><p><br></p></blockquote>").replace(/<p><\/p>/g,"<p><br></p>")}function Mt(e){return e.map((e=>xt(e)||function(e){return Boolean("string"!=typeof e&&"video"===e.type&&e.url&&e.duration&&e.source)}(e)?e:"string"==typeof e?{type:"image",url:e,uploadedFileName:""}:null)).filter((e=>null!==e))}function Rt(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function Nt(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Rt(Object(s),!0).forEach((function(t){Bt(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Rt(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Bt(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Lt({disabled:e,editorContent:t,commentId:s,storyId:i,parentId:r,thumbs:a}){const l=(0,n.iH)(""),c=(0,o.Fl)((()=>it.yK.drafts({storyId:i}))),{data:d,isLoading:u}=(0,it.Bb)({queryKey:c,enabled:(0,o.Fl)((()=>!e.value))}),p=(0,o.Fl)((()=>{var e;return null===(e=d.value)||void 0===e?void 0:e[s]}));(0,o.YP)(p,(async e=>{e&&(l.value="",await(0,o.Y3)(),l.value=Et()(e.date).format("HH:mm"))}),{immediate:!0});const h=(0,o.Fl)((()=>Boolean(p.value&&p.value.desc===t.value&&p.value.images===Pt(a.value))));const{mutateAsync:_}=(0,it._F)();return{draft:p,isLoading:u,isSaved:h,updatedAt:l,remove:function(){w.Eh.setQueryData(c,(e=>{var t;return null==e||delete e[s],null!==(t=Nt({},e))&&void 0!==t?t:void 0}))},save:async function(){const e=Pt(a.value),o=Dt(t.value);var n;p.value&&p.value.desc===o&&p.value.images===e||(await _({parentId:r,storyId:i,images:e,content:o}),n={date:(new Date).toISOString(),images:e,desc:o},w.Eh.setQueryData(c,(e=>e?Nt(Nt({},e),{},{[s]:n}):void 0)))}}}const jt=[],$t=[];function Ut(e){const t=(0,n.iH)(!1),s=(0,n.iH)(""),i=(0,n.iH)(),r=(0,c.Dp)(e.text,500),a=(0,o.Fl)((()=>r.value.length<=2)),l=(0,o.Fl)((()=>{var e;return!p.value||Date.now()-((null===(e=_.value)||void 0===e?void 0:e.requestStartedAt)||0)>=1e4})),d=(0,o.Fl)((()=>100*function(e,t){if(e===t)return 0;const s=e;e.length>t.length&&(e=t,t=s);let i=e.length,o=t.length;for(;i>0&&e.charCodeAt(~-i)===t.charCodeAt(~-o);)i--,o--;let r,n,a,l,c=0;for(;c<i&&e.charCodeAt(c)===t.charCodeAt(c);)c++;if(i-=c,o-=c,0===i)return o;let d=0,u=0;for(;d<i;)$t[d]=e.charCodeAt(c+d),jt[d]=++d;for(;u<o;)for(r=t.charCodeAt(c+u),a=u++,n=u,d=0;d<i;d++)l=r===$t[d]?a:a+1,a=jt[d],n=jt[d]=a>n?l>n?n+1:l:l>a?a+1:l;return n||0}(s.value,r.value)/Math.max(s.value.length,r.value.length)>=10)),u=(0,o.Fl)((()=>it.yK.offenisveCheck({text:r.value,storyId:e.storyId,commentId:e.commentId}))),{isSuccess:p,isError:h,data:_}=(0,it.mk)({queryKey:u,enabled:(0,o.Fl)((()=>!a.value&&l.value&&d.value&&void 0===i.value))}),m=()=>{clearTimeout(i.value),i.value=void 0};return(0,o.YP)(p,(e=>{var o,n,l;if(!e||h.value)return;t.value=null!==(o=null===(n=_.value)||void 0===n?void 0:n.offensive)&&void 0!==o&&o,m(),s.value=a.value?"":r.value;const c=Date.now();i.value=setTimeout(m,Math.max(0,1e4-(c-((null===(l=_.value)||void 0===l?void 0:l.requestStartedAt)||c))))}),{immediate:!0}),(0,o.Fl)((()=>!h.value&&!a.value&&t.value))}var Ft=s(78699),Vt=s(32995);const Ht=(0,o._)("a",{href:"/information/rules",target:"_blank"},"правила Пикабу",-1),Zt=(0,o.aZ)({__name:"offensive-msg-view",props:{active:{type:Boolean}},setup(e){const t=e;return(e,s)=>((0,o.wg)(),(0,o.j4)(Vt.Z,{active:t.active},{default:(0,o.w5)((()=>[(0,o.Wm)(xe,null,{default:(0,o.w5)((()=>[(0,o.Uk)(" Возможно, ваш комментарий носит оскорбительный характер. Будьте вежливы к собеседнику и соблюдайте "),Ht])),_:1})])),_:1},8,["active"]))}});function zt(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function qt(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?zt(Object(s),!0).forEach((function(t){Wt(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):zt(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Wt(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Gt=(0,o.aZ)({__name:"duplicate-report-msg-view",props:{text:{},analyticsParams:{}},emits:["report"],setup(e,{emit:t}){const s=e,i=(0,n.iH)(!1),{sendEvent:r}=(0,te.z)(),l=t;return(0,c.B_)((()=>s.text),(e=>{i.value=[/(https?:\/\/)?pikabu\.(ru|lh|dev)/i.test(e),/([^\wа-яё]|^)@moderator([^\wа-яё]|$)/i.test(e),/([^\wа-яё]|^)(баян|боян|повтор)/i.test(e)].reduce(((e,t)=>e+Number(t)),0)>=2,i.value&&r("tip_show",qt(qt({},s.analyticsParams),{},{component_name:"comments",type:"bayan_hint"}))}),{debounce:1e3}),(e,t)=>i.value?((0,o.wg)(),(0,o.j4)(xe,{key:0},{default:(0,o.w5)((()=>[(0,o.Uk)(" Возможно, вы хотите сообщить нам о посте-баяне. Пожалуйста, используйте для этого кнопку"),(0,o._)("a",{onClick:t[0]||(t[0]=(0,a.iM)((e=>l("report")),["prevent"]))},"«Я видел это раньше»"),(0,o.Uk)(" в контекстном меню поста. ")])),_:1})):(0,o.kq)("v-if",!0)}}),Yt=Gt;var Kt=s(90647);let Xt;!function(e){e.RU="ru",e.EN="en"}(Xt||(Xt={}));const Jt="valid-substrings",Qt="https://cs.pikabu.ru/files/assets/valid-substrings/";class es{static async loadFromAssets(){es.substrings[Xt.EN]=await(await fetch(Qt+Xt.EN+".json")).json(),es.substrings[Xt.RU]=await(await fetch(Qt+Xt.RU+".json")).json()}async load(){try{await this.loadFromIDB()}catch(e){console.error("Cannot load valid strings dictionary from IndexedDB"),console.error(e)}if(!(es.substrings[Xt.EN].length>0&&es.substrings[Xt.RU].length>0)){try{await es.loadFromAssets()}catch(e){console.error("Cannot load valid strings dictionary from assets"),console.error(e)}try{await this.saveToDb()}catch(e){console.error("Cannot save valid strings dictionary into IndexedDB"),console.error(e)}}}getSubstrings(e){return es.substrings[e]}async loadFromIDB(){const e=(await this.getDb()).transaction(Jt,"readonly").objectStore(Jt);es.substrings[Xt.EN]=await e.get(Xt.EN)||[],es.substrings[Xt.RU]=await e.get(Xt.RU)||[]}async saveToDb(){const e=(await this.getDb()).transaction(Jt,"readwrite").objectStore(Jt);await e.put(es.substrings[Xt.EN],Xt.EN),await e.put(es.substrings[Xt.RU],Xt.RU)}async getDb(){return void 0!==this.db||(this.db=await(0,Kt.X3)("lang-dict",2,{upgrade(e){e.objectStoreNames.contains(Jt)||e.createObjectStore(Jt)}})),this.db}}var ts,ss,is;ts=es,ss="substrings",is={[Xt.EN]:[],[Xt.RU]:[]},(ss=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(ss))in ts?Object.defineProperty(ts,ss,{value:is,enumerable:!0,configurable:!0,writable:!0}):ts[ss]=is;const os={[Xt.RU]:'йцукенгшщзхъфывапролджэячсмитьбю.ЙЦУКЕНГШЩЗХЪФЫВАПРОЛДЖЭЯЧСМИТЬБЮ,ёЁ"№;:?',[Xt.EN]:"qwertyuiop[]asdfghjkl;'zxcvbnm,./QWERTYUIOP{}ASDFGHJKL:\"ZXCVBNM<>?`~@#$^&"};class rs{translate(e,t,s){const i=os[s].split(""),o={};os[t].split("").forEach(((e,t)=>o[e]=i[t]));let r="";for(const n of e.split(""))r+=o[n]||n;return r}}const ns=[/[a-z].*[а-яё]|[а-яё].*[a-z]/,/[а-яё]/,/https?:\/\//,/\bnsfw|btw|lol\b/,/[\s.](jpe?g|png|bmp|mp4|web[mp]|exe|html|css|js)\b/,/[a-z]-?\d/,/[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55\u{1F004}\u{1F0CF}\u{1F18E}\u{1F191}-\u{1F19A}\u{1F1E6}-\u{1F1FF}\u{1F201}\u{1F21A}\u{1F22F}\u{1F232}-\u{1F236}\u{1F238}-\u{1F23A}\u{1F250}\u{1F251}\u{1F300}-\u{1F320}\u{1F32D}-\u{1F335}\u{1F337}-\u{1F37C}\u{1F37E}-\u{1F393}\u{1F3A0}-\u{1F3CA}\u{1F3CF}-\u{1F3D3}\u{1F3E0}-\u{1F3F0}\u{1F3F4}\u{1F3F8}-\u{1F43E}\u{1F440}\u{1F442}-\u{1F4FC}\u{1F4FF}-\u{1F53D}\u{1F54B}-\u{1F54E}\u{1F550}-\u{1F567}\u{1F57A}\u{1F595}\u{1F596}\u{1F5A4}\u{1F5FB}-\u{1F64F}\u{1F680}-\u{1F6C5}\u{1F6CC}\u{1F6D0}-\u{1F6D2}\u{1F6D5}-\u{1F6D7}\u{1F6DC}-\u{1F6DF}\u{1F6EB}\u{1F6EC}\u{1F6F4}-\u{1F6FC}\u{1F7E0}-\u{1F7EB}\u{1F7F0}\u{1F90C}-\u{1F93A}\u{1F93C}-\u{1F945}\u{1F947}-\u{1F9FF}\u{1FA70}-\u{1FA7C}\u{1FA80}-\u{1FA88}\u{1FA90}-\u{1FABD}\u{1FABF}-\u{1FAC5}\u{1FACE}-\u{1FADB}\u{1FAE0}-\u{1FAE8}\u{1FAF0}-\u{1FAF8}]/u],as={[Xt.RU]:["d","yf","ns","pf","ghj",",tp","ds","hfp","yt","yj",",kz","z","jy","jyb","jyf","nt"],[Xt.EN]:["ши","ащк","еру","ща","иу","шы"]},ls=/^[b-df-hj-np-tv-xzбвгджзйклмнпрстфхцчшщъь]+$/i;class cs{async correct(e){let t=e.trim().toLowerCase();if(t.length<6)return e;if(ns.some((e=>e.test(t))))return e;let s=Xt.EN,i=Xt.RU;/[а-яё]/.test(t)&&(s=Xt.RU,i=Xt.EN);let o=this.splitTextOnChunks(t);if(0===o.length)return e;if(!(await this.detectInvalidInputByChunks(o,s)))return e;const r=(new rs).translate(e,s,i);return t=r.trim().toLowerCase(),o=this.splitTextOnChunks(t),await this.detectInvalidInputByChunks(o,i)?e:r}async detectInvalidInputByChunks(e,t){if(as[t].some((t=>e.includes(`(${t})`))))return!0;const s=(await this.getValidSubstrDict()).getSubstrings(t);for(const i of e)if("("!==i[0]&&!s.includes(i))return!0;return!1}splitTextOnChunks(e){const t=[];return e.split(/\s+/).forEach((e=>{if(e.length<=3)return 3===e.length&&ls.test(e)&&t.push(e),void t.push("("+e+")");for(let s=0;s<=e.length-3;s++){const i=e.substr(s,3);ls.test(i)&&t.push(i)}})),t}async getValidSubstrDict(){return void 0!==this.validSubstrDict||(this.validSubstrDict=new es,await this.validSubstrDict.load()),this.validSubstrDict}}const ds=(0,o.aZ)({__name:"invalid-input-msg-view",props:{text:{}},emits:["apply"],setup(e,{expose:t,emit:s}){const i=e,a=s,l=new cs,c=(0,n.iH)(""),d=(0,o.YP)((()=>i.text),(async e=>{const t=e.replace(/\n+/g,"\n"),s=await l.correct(t);c.value=s===t?"":s}));function u(){c.value=""}return t({clear:u}),(e,t)=>c.value?((0,o.wg)(),(0,o.j4)(xe,{key:0,"with-close-icon":"",onClose:t[1]||(t[1]=e=>(u(),void d()))},{default:(0,o.w5)((()=>[(0,o.Uk)(" Возможно, вы имели в виду: "),(0,o._)("span",{class:(0,r.C_)(e.$style.correctedText),onClick:t[0]||(t[0]=e=>a("apply",c.value.trim()))},(0,r.zw)(c.value),3)])),_:1})):(0,o.kq)("v-if",!0)}});var us=s(4155),ps=s.n(us);const hs={};hs.$style=ps();const _s=(0,x.Z)(ds,[["__cssModules",hs]]);var ms=s(79431);const gs=(0,o.aZ)({__name:"unsupported-browser-msg-view",setup(e){const t=(0,n.iH)(!1);return(0,o.bv)((async()=>{t.value=!(await ms.NM.has(ms.hA.COMMENT_REPLY_UNSUPPORTED_BROWSER))})),(e,s)=>t.value?((0,o.wg)(),(0,o.j4)(xe,{key:0,"with-close-icon":"",onClose:s[0]||(s[0]=e=>(t.value=!1,void ms.NM.add(ms.hA.COMMENT_REPLY_UNSUPPORTED_BROWSER)))},{default:(0,o.w5)((()=>[(0,o.Uk)(" Вы используете устаревшую версию браузера, которая не поддерживает форматирование текста ")])),_:1})):(0,o.kq)("v-if",!0)}}),vs=(0,o.aZ)({__name:"disabled-msg-view",setup(e){const t=(0,rt.o)();return(e,s)=>((0,o.wg)(),(0,o.j4)(xe,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)((0,n.SU)(t).initParams.slowModeText),1)])),_:1}))}}),fs=(0,o.aZ)({__name:"error-message-view",props:{message:{}},setup(e){const t=e;return(e,s)=>((0,o.wg)(),(0,o.j4)(xe,{theme:"red"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(t.message),1)])),_:1}))}}),ys=(0,o.aZ)({__name:"draft-date-view",props:{date:{}},setup(e){const t=e;return(e,s)=>((0,o.wg)(),(0,o.j4)(a.uT,{name:e.$style.host},{default:(0,o.w5)((()=>[t.date?((0,o.wg)(),(0,o.iD)("span",{key:0,class:(0,r.C_)(e.$style.host)}," Сохранено в "+(0,r.zw)(t.date),3)):(0,o.kq)("v-if",!0)])),_:1},8,["name"]))}});var bs=s(23024),ws=s.n(bs);const ks={};ks.$style=ws();const Ss=(0,x.Z)(ys,[["__cssModules",ks]]);var Os=s(62728);const Es=["disabled"],Cs=(0,o.aZ)({__name:"attach-files-btn-view",props:{disabled:{type:Boolean}},emits:["attach"],setup(e,{emit:t}){const s=e,i=t,a=(0,rt.o)(),l=(0,o.Fl)((()=>!s.disabled));return(e,t)=>{const c=(0,o.Q2)("tooltip");return(0,n.SU)(a).initParams.isConfirmed?(0,o.wy)(((0,o.wg)(),(0,o.iD)("span",{key:0,disabled:l.value,class:(0,r.C_)(e.$style.host)},[(0,o.Wm)(Os.Z,{class:(0,r.C_)(e.$style.icon),"icon-size":20,disabled:s.disabled,"icon-name":"photo_20",size:"large",onClick:t[0]||(t[0]=e=>i("attach"))},null,8,["class","disabled"])],10,Es)),[[c,"Достигнуто максимальное количество изображений"]]):(0,o.kq)("v-if",!0)}}});var xs=s(18517),Ts=s.n(xs);const Is={};Is.$style=Ts();const Ps=(0,x.Z)(Cs,[["__cssModules",Is]]),As=(0,o.aZ)({__name:"mention-btn-view",setup:e=>(e,t)=>e.IS_MOBILE?((0,o.wg)(),(0,o.j4)(Os.Z,{key:0,"icon-size":20,"icon-name":"mention",size:"large"})):(0,o.kq)("v-if",!0)}),Ds=(0,o.aZ)({__name:"controls-view",props:{disabled:{type:Boolean}},setup(e){const t=e;return(e,s)=>((0,o.wg)(),(0,o.iD)("div",{class:(0,r.C_)([e.$style.host,{[e.$style.host_disabled]:t.disabled}])},[(0,o.WI)(e.$slots,"hidden-by-note"),e.IS_DESKTOP?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.WI)(e.$slots,"submit-btn"),(0,o._)("span",{class:(0,r.C_)(e.$style.attachBtn)},[(0,o.WI)(e.$slots,"attach-btn")],2),(0,o._)("div",{class:(0,r.C_)(e.$style.switch)},[(0,o.WI)(e.$slots,"official-switch")],2),(0,o._)("span",{class:(0,r.C_)(e.$style.draftDate)},[(0,o.WI)(e.$slots,"draft-date")],2),(0,o._)("div",{class:(0,r.C_)(e.$style.anonymous)},[(0,o.WI)(e.$slots,"anonymous-switch")],2)],64)):(0,o.kq)("v-if",!0),e.IS_MOBILE?((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[(0,o._)("span",{class:(0,r.C_)(e.$style.attachBtn)},[(0,o.WI)(e.$slots,"attach-btn")],2),(0,o.WI)(e.$slots,"mention-btn"),(0,o._)("div",{class:(0,r.C_)(e.$style.switch)},[(0,o.WI)(e.$slots,"official-switch")],2),(0,o._)("div",{class:(0,r.C_)(e.$style.anonymous)},[(0,o.WI)(e.$slots,"anonymous-switch")],2),(0,o._)("div",{class:(0,r.C_)(e.$style.btns)},[(0,o.WI)(e.$slots,"cancel-btn"),(0,o.WI)(e.$slots,"submit-btn")],2)],64)):(0,o.kq)("v-if",!0)],2))}});var Ms=s(72869),Rs=s.n(Ms);const Ns={};Ns.$style=Rs();const Bs=(0,x.Z)(Ds,[["__cssModules",Ns]]);var Ls=s(14949);const js=(0,o.aZ)({__name:"anonymous-confirm-popup",emits:["update:modelValue","update:anonymous","update:confirmed"],setup(e,{emit:t}){const s=t,i=(0,n.iH)(!0),a=(0,n.iH)(!1),{sendEvent:l}=(0,te.z)();function c(e){s("update:anonymous",e),a.value&&v.m.set(_,1),l("popup_close",{type:"anonymous_comment",content_type:a.value?"mark_active":"mark_inactive"}),s("update:confirmed",!0),s("update:modelValue",!1)}return(0,o.bv)((()=>{l("popup_show",{type:"anonymous_comment"})})),(0,o.YP)(i,(()=>{i.value||s("update:modelValue",!1)})),(e,t)=>((0,o.wg)(),(0,o.j4)((0,o.LL)(e.IS_MOBILE?Ls.Z:Q.Z),{modelValue:i.value,"onUpdate:modelValue":t[3]||(t[3]=e=>i.value=e),class:(0,r.C_)(e.$style.popup),active:i.value,title:"Ответить от своего имени?","cross-button":e.IS_DESKTOP,"header-size":"large","onUpdate:active":t[4]||(t[4]=e=>i.value=Boolean(e))},{footer:(0,o.w5)((()=>[(0,o._)("div",{class:(0,r.C_)(e.$style.buttons)},[(0,o.Wm)(y.Z,{label:"Ответить анонимно",outline:"",wide:"",size:e.IS_DESKTOP?"medium":"large",onClick:t[1]||(t[1]=e=>c(!0))},null,8,["size"]),(0,o.Wm)(y.Z,{label:"Ответить от своего имени",wide:"",size:e.IS_DESKTOP?"medium":"large",onClick:t[2]||(t[2]=e=>c(!1))},null,8,["size"])],2)])),default:(0,o.w5)((()=>[(0,o._)("p",{class:(0,r.C_)(e.$style.caption)}," Переключатель «ответить анонимно» неактивен. Если отправить ответ от имени вашего аккаунта, изменить это после публикации не получится. ",2),(0,o.Wm)(f.Z,{modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),class:(0,r.C_)(e.$style.switcher),label:"Больше не показывать",size:"large","revert-label":!0},null,8,["modelValue","class"])])),_:1},40,["modelValue","class","active","cross-button"]))}});var $s=s(6815),Us=s.n($s);const Fs={};Fs.$style=Us();const Vs=(0,x.Z)(js,[["__cssModules",Fs]]);var Hs=s(58364),Zs=s(76318),zs=s(96448),qs=s(55063),Ws=s(15067),Gs=s(9855),Ys=s(11812),Ks=s(80788),Xs=s(54407),Js=s(98658);const Qs=[s(39631).Z,Js.Z,Ys.Z,Ks.Z,Xs.Z],ei=[qs.Z,Ws.Z,Gs.Z],ti=[Hs.Z.configure({newGroupDelay:100}),zs.Z],si=[Zs.ZP,...Qs,...ei,...ti];var ii=s(89536),oi=s(47442),ri=s(99252);const ni=(0,o.aZ)({__name:"app",props:{root:{type:Boolean},commentId:{},storyId:{default:0},parentId:{default:0},parentIds:{},storyAuthorId:{},storyAuthorUserName:{},authorUserName:{},official:{type:Boolean},ignoreTypes:{},baseAnalyticsParams:{},canPostAdCaptions:{type:Boolean},canReplyAnonymously:{type:Boolean},handleCloseComment:{},handleAddComment:{},handleEditComment:{},handleDuplicateReportTrigger:{}},setup(e,{expose:t}){const s=e,i=(0,o.Fl)((()=>s.root?"Введите текст комментария":"Введите текст ответа")),h=(0,o.Fl)((()=>[...si,d.Z.configure({placeholder:i.value})])),S=(0,rt.o)(),O=nt(),{sendEvent:E,google:C,yandex:x}=(0,te.z)(),T=(0,n.iH)(!1),P=(0,n.iH)(),A=(0,n.iH)(""),D=(0,n.iH)(s.root?g.tT.CREATE:g.tT.NONE),M=(0,n.iH)(!1),R=(0,n.iH)(!1),N=(0,n.iH)(!1),B=(0,n.iH)(!0),L=(0,n.iH)(!1),j=(0,n.iH)(),$=(0,n.iH)(),U=(0,n.iH)(""),F=(0,n.iH)(!1),V=(0,n.iH)(!1),H=(0,o.Fl)((()=>D.value===g.tT.CREATE)),Z=(0,o.Fl)((()=>D.value===g.tT.EDIT)),z=(0,o.Fl)((()=>!xe.value||H.value&&O.hasCommentLimitBeenReached)),q=(0,o.Fl)((()=>{var e,t;return null!==(e=null===(t=P.value)||void 0===t?void 0:t.textContent)&&void 0!==e?e:""})),W=k.core.ua.ios&&k.core.ua.osversion.split(".")[0]<=13,G=(0,o.Fl)((()=>Y.value?"":It(A.value,ne.value))),Y=(0,o.Fl)((()=>!q.value)),K=(0,ge.sx)(),X=(0,n.iH)(),J=(0,n.iH)(""),{mutateAsync:Q}=(0,it.bN)(),{mutateAsync:ee}=(0,it.us)(),{addFiles:se,addLinks:ie,addUploaded:oe,clear:re,thumbs:ne,addAttachedImages:le,deleteThumb:ce,isLimitReached:de,upload:ue}=St();(0,o.JJ)(p,{root:s.root,mode:D,loading:R,empty:Y,textContent:q,createModeActive:H,editModeActive:Z,authorUserName:s.authorUserName,storyAuthorId:s.storyAuthorId,storyAuthorUserName:s.storyAuthorUserName,storyId:s.storyId,commentId:s.commentId}),(0,o.YP)(D,((e,t)=>{e!==t&&(A.value="",U.value="",re())}),{immediate:!0}),(0,l.S1d)(j,(e=>{e.forEach((e=>{k.core.ui.emit("comment-editor-visibility",e.isIntersecting,s.commentId)}))}));const pe=(0,o.Fl)((()=>it.yK.loadSource({id:s.commentId}))),{data:he,isLoading:_e}=(0,it.Lk)({queryKey:pe,enabled:(0,o.Fl)((()=>T.value&&Z.value))});async function me(){var e;await(0,o.Y3)(),null===(e=P.value)||void 0===e||e.setSelectionAtEnd()}async function ve(){var e,t;(null!==(e=he.value)&&void 0!==e&&e.source||null!==(t=he.value)&&void 0!==t&&t.images)&&(A.value=he.value.source,U.value=he.value.adCaption,oe(Mt(he.value.images)))}(0,o.YP)(_e,(async e=>{e||(ve(),me())}),{immediate:!0});const{draft:fe,isSaved:ye,updatedAt:be,remove:ke,save:Se}=Lt({disabled:(0,o.Fl)((()=>!H.value||O.hasCommentLimitBeenReached||!T.value||!xe.value)),storyId:s.storyId,parentId:s.parentId,commentId:s.commentId,editorContent:G,thumbs:ne});function Oe(){fe.value&&Y.value&&H.value&&(A.value=fe.value.desc||"")}async function Ee(){var e;return"string"==typeof(null===(e=fe.value)||void 0===e?void 0:e.images)&&0===ne.value.length&&(oe(await async function(e){if("string"!=typeof e)return[];const t=[];try{const s=JSON.parse(e);if(!Array.isArray(s))throw new Error("Ошибка парсинга изображений");for(const e of s)("object"!=typeof e||"image"!==e.type||await Ct(e.url)||xt(e))&&t.push(e)}catch(s){console.error(s)}return t}(fe.value.images)),!0)}(0,o.YP)(fe,Oe);const Ce=(0,o.YP)(fe,(async(e,t)=>{e&&!t&&await Ee()&&Ce()}));(0,c.B_)(q,(()=>{R.value||!H.value||Y.value||(A.value=G.value)}),{debounce:100}),(0,c.B_)(A,(async()=>{R.value||!H.value||!fe.value&&Y.value||(await ue(),await Se())}),{debounce:5e3}),(0,c.B_)(q,(e=>{J.value=e}),{debounce:1e4});const{isValidated:xe,validationError:Te}=function({storyId:e,parentId:t,enabled:s}){const i=(0,o.Fl)((()=>it.yK.validate({storyId:e,parentId:t}))),{data:r,isFetched:n}=(0,it.e4)({queryKey:i,enabled:s});return{isValidated:(0,o.Fl)((()=>{var e;return!n.value||Boolean(null===(e=r.value)||void 0===e?void 0:e.result)})),validationError:(0,o.Fl)((()=>{var e,t;return!n.value||null!==(e=r.value)&&void 0!==e&&e.result?"":(null===(t=r.value)||void 0===t?void 0:t.error)||""}))}}({storyId:s.storyId,parentId:s.parentId,enabled:V});function Ie(e){D.value=e}function Pe(e){e.stopImmediatePropagation(),Ae()}async function Ae(){var e;if(R.value||z.value)return;if(!S.initParams.isConfirmed&&!(await new at.R({analyticsParams:s.baseAnalyticsParams}).show(at.J.COMMENT)))return;if(x.goal("tap-comment-send"),C.event("submit","comment"),Y.value&&0===ne.value.length)return void k.core.ui.toasts.showError("Введите текст сообщения или добавьте изображение");const{analyticsParams:t,result:i}=await async function(){let e={},t=!0;!s.canReplyAnonymously||B.value||v.m.get(_)?s.canReplyAnonymously&&B.value&&(e={type:"anonymous_comment",anonymous:"1"}):(L.value=!1,F.value=!0,await new Promise((s=>{(0,c.f8)(F,(()=>{F.value||(e={component_name:"popup_anonymous_comment",anonymous:B.value?"1":"null",content_type:v.m.get(_)?"mark_active":"mark_inactive"},t=L.value,s())}))})));return{analyticsParams:e,result:t}}();if(!i)return;const o=Date.now();R.value=!0,null===(e=X.value)||void 0===e||e.clear(),await ue();const r=function({create:e,content:t,commentId:s,parentId:i,parentIds:o,storyId:r,thumbs:n,official:a,adCaption:l,byAnonymous:c}){const d=n.map((e=>e.type===m.uploadedImage?e.uploadedFileName||e.src:e.type===m.videoUrl?e.url:void 0)).filter(Boolean);return{id:e?void 0:s,images:JSON.stringify(d),desc:Dt(It(t,n)),parent_id:e?i:void 0,parents:e?o.join(","):void 0,story_id:r,is_official:a,by_moderator:!1,ad_caption:l,by_anonymous:c}}({create:H.value,commentId:s.commentId,parentId:s.parentId,parentIds:s.parentIds,storyId:s.storyId,content:A.value,official:N.value,thumbs:ne.value,adCaption:U.value,byAnonymous:s.canReplyAnonymously&&B.value}),n=H.value?Q(r):ee(r);try{const[e]=await Promise.all([n,(0,ot.g)(1e3-(Date.now()-o))]),i=e.html,r=Number(e.commentId);if(Z.value?s.handleEditComment({id:r,content:i}):s.handleAddComment({id:r,content:i,analyticsParams:t}),$.value.closeHint(),S.initParams.isSlowModeEnabled&&O.availableNumberOfCommentsForToday>0&&H.value&&O.decrementAvailableNumberOfCommentsForToday(),H.value?ke():w.Eh.invalidateQueries(pe),s.root)return re(),be.value="",A.value="",void(U.value="");Ie(g.tT.NONE)}catch(a){a instanceof it.Ec&&[ri.ho,ri.AU].includes(a.messageCode)&&E("error_occurred",{type:"attempt_to_comment_during_ban"})}finally{R.value=!1}}(0,o.YP)((()=>{var e;return null===(e=P.value)||void 0===e?void 0:e.isFocused}),(()=>{var e;V.value=Boolean(null===(e=P.value)||void 0===e?void 0:e.isFocused)})),t({lock:function(){Z.value||(T.value&&k.core.ui.toasts.showError("Комментарий больше нельзя отредактировать"),M.value=!0)},show:function(){T.value=!0,s.root||(Z.value?ve():(Oe(),Ee()),O.hasCommentLimitBeenReached||me())},hide:function(){T.value=!1,Z.value&&(A.value="",U.value="",re())},setMode:Ie,getMode:function(){return D.value},isEmpty:function(){return Y.value},isDraftSaved:()=>ye.value,insertBlockquote:function(e){var t,s;null===(t=P.value)||void 0===t||t.insertContent(`<blockquote>${e}</blockquote>`),null===(s=P.value)||void 0===s||s.focus()}});const{isDragging:De}=(0,ge.Uq)({ignoreDragenter:()=>K.isModalOpen}),{isOverDropZone:Me}=(0,l.EO$)(j,(e=>{e&&se(e)})),Re=(0,o.Fl)((()=>De.value&&Me.value));function Ne(e){A.value=e.replace("\n","<br>")}function Be(){E("mark_anonymous_comment",{post_id:s.storyId,author_id:k.core.initParams.userID,type_i8:B.value?"1":null,screen_index:"1"})}const Le=Ut({storyId:s.storyId,commentId:s.commentId,text:q}),je=(0,o.Fl)((()=>s.canReplyAnonymously&&H.value)),$e=(0,o.Fl)((()=>s.root&&s.official&&H.value&&!je.value));return(e,t)=>{var l;const c=(0,o.Q2)("cmd-ctrl-enter");return(0,o.wg)(),(0,o.iD)(o.HY,null,[T.value?(0,o.wy)(((0,o.wg)(),(0,o.iD)("div",{key:0,ref_key:"hostEl",ref:j,class:(0,r.C_)([e.$style.host,{[e.$style.host_focused]:e.IS_MOBILE&&(null===(l=P.value)||void 0===l?void 0:l.isFocused),[e.$style.host_border]:!s.root,[e.$style.host_disabled]:z.value,[e.$style.host_drag]:(0,n.SU)(De)||Re.value,[e.$style.host_drop]:Re.value}]),onKeydown:t[15]||(t[15]=(0,a.D2)((0,a.iM)((e=>{s.root||s.handleCloseComment()}),["prevent"]),["esc"]))},[(0,o._)("div",{class:(0,r.C_)(e.$style.editorContainer)},[(0,n.SU)(W)?((0,o.wg)(),(0,o.j4)(b.Z,{key:1,modelValue:A.value,"onUpdate:modelValue":t[3]||(t[3]=e=>A.value=e),class:(0,r.C_)(e.$style.editor),placeholder:i.value,type:"textarea",borderless:""},null,8,["modelValue","class","placeholder"])):((0,o.wg)(),(0,o.j4)(u.Z,{key:0,ref_key:"editor",ref:P,modelValue:A.value,"onUpdate:modelValue":t[0]||(t[0]=e=>A.value=e),class:(0,r.C_)(e.$style.editor),editable:!z.value,"story-id":s.storyId,extensions:h.value,"onPaste:files":t[1]||(t[1]=e=>(0,n.SU)(se)(e)),"onPaste:links":t[2]||(t[2]=e=>(0,n.SU)(ie)(e))},null,8,["modelValue","class","editable","story-id","extensions"])),s.canPostAdCaptions?((0,o.wg)(),(0,o.iD)("div",{key:2,class:(0,r.C_)(e.$style.marking)},[(0,o.Wm)(b.Z,{modelValue:U.value,"onUpdate:modelValue":t[4]||(t[4]=e=>U.value=e),size:"small",placeholder:"Маркировка рекламы",borderless:""},null,8,["modelValue"])],2)):(0,o.kq)("v-if",!0),e.IS_MOBILE&&H.value?((0,o.wg)(),(0,o.j4)(Ss,{key:3,date:(0,n.SU)(be),"data-test":"comment-reply-draft",class:(0,r.C_)(e.$style.draftDate)},null,8,["date","class"])):(0,o.kq)("v-if",!0),(0,n.SU)(ne).length?((0,o.wg)(),(0,o.j4)(we,{key:4,thumbs:(0,n.SU)(ne),"onDelete:thumb":t[5]||(t[5]=e=>(0,n.SU)(ce)(e))},null,8,["thumbs"])):(0,o.kq)("v-if",!0),(0,n.SU)(xe)?z.value?((0,o.wg)(),(0,o.j4)(vs,{key:6})):(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.j4)(fs,{key:5,message:(0,n.SU)(Te)},null,8,["message"]))],2),(0,o.Wm)(Ft.Z,{class:(0,r.C_)(e.$style.feedbackOffer),text:J.value},null,8,["class","text"]),(0,o.Wm)(Zt,{active:(0,n.SU)(Le)},null,8,["active"]),(0,o.Wm)(st,{"text-content":q.value},null,8,["text-content"]),e.IS_DESKTOP?((0,o.wg)(),(0,o.j4)(_s,{key:0,ref_key:"invalidInputMsgView",ref:X,text:q.value,onApply:Ne},null,8,["text"])):(0,o.kq)("v-if",!0),(0,o.Wm)(Yt,{"analytics-params":s.baseAnalyticsParams,text:q.value,onReport:t[6]||(t[6]=e=>s.handleDuplicateReportTrigger())},null,8,["analytics-params","text"]),(0,n.SU)(W)?((0,o.wg)(),(0,o.j4)(gs,{key:1})):(0,o.kq)("v-if",!0),(0,o.Wm)(Bs,{class:(0,r.C_)(e.$style.controls),disabled:z.value},{"hidden-by-note":(0,o.w5)((()=>[(0,o.Wm)(I,{"ignore-types":s.ignoreTypes},null,8,["ignore-types"])])),"submit-btn":(0,o.w5)((()=>[(0,o.Wm)(ae,{ref_key:"submitBtn",ref:$,locked:M.value,"comstory-available":s.root,onSubmit:t[7]||(t[7]=e=>Ae()),"onSubmit:comstory":t[8]||(t[8]=e=>async function(){if(!R.value)try{await ue(),await ii.c.create({id:s.storyId,content:G.value,media:At(ne.value),beforeRedirect:async()=>{re(),await(0,ot.g)(50)}})}catch(e){k.core.ui.toasts.showError("Не удалось создать пост-ответ"),console.error(e)}}()),"onPublish:comstory":t[9]||(t[9]=e=>async function(){if(R.value)return;let e=!0;try{R.value=!0;const{storyId:e,commentId:t,commentHtml:i,message:o}=await ii.c.publish({id:s.storyId,content:G.value,media:At(ne.value)});E("publish_post",{type:"post_answer_popup",post_id:e}),o?k.core.ui.toasts.add({theme:oi.K.WARNING,content:o,addCloseButton:!1}):s.handleAddComment({id:t,content:i}),ke(),re(),be.value="",A.value="",U.value=""}catch(t){console.error(t),e=!1}finally{R.value=!1}e||(await Ae(),k.core.ui.toasts.add({theme:oi.K.WARNING,content:"При создании поста произошла ошибка - опубликовали в виде комментария.",addCloseButton:!1}))}())},null,8,["locked","comstory-available"])])),"cancel-btn":(0,o.w5)((()=>[!s.root&&e.IS_MOBILE?((0,o.wg)(),(0,o.j4)(y.Z,{key:0,size:"small",label:"Отменить",theme:"gray","data-test":"comment-reply-close",class:(0,r.C_)(e.$style.closeBtn),onClick:t[10]||(t[10]=e=>s.handleCloseComment())},null,8,["class"])):(0,o.kq)("v-if",!0)])),"draft-date":(0,o.w5)((()=>[H.value?((0,o.wg)(),(0,o.j4)(Ss,{key:0,"data-test":"comment-reply-draft",date:(0,n.SU)(be)},null,8,["date"])):(0,o.kq)("v-if",!0)])),"attach-btn":(0,o.w5)((()=>[(0,o.Wm)(Ps,{disabled:(0,n.SU)(de),"data-test":"comment-reply-attach",onAttach:t[11]||(t[11]=e=>(0,n.SU)(le)())},null,8,["disabled"])])),"mention-btn":(0,o.w5)((()=>[(0,n.SU)(W)?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.j4)(As,{key:0,"data-test":"comment-reply-mention",onClick:t[12]||(t[12]=e=>function(){const e=q.value[q.value.length-1];var t;if("@"===e)null===(t=P.value)||void 0===t||t.focus();else if(" "===e){var s;null===(s=P.value)||void 0===s||s.insertContent("@")}else{var i;null===(i=P.value)||void 0===i||i.insertContent(" @")}}())}))])),"official-switch":(0,o.w5)((()=>[$e.value?((0,o.wg)(),(0,o.j4)(f.Z,{key:0,modelValue:N.value,"onUpdate:modelValue":t[13]||(t[13]=e=>N.value=e),label:"Официальный ответ"},null,8,["modelValue"])):(0,o.kq)("v-if",!0)])),"anonymous-switch":(0,o.w5)((()=>[je.value?((0,o.wg)(),(0,o.j4)(f.Z,{key:0,modelValue:B.value,"onUpdate:modelValue":[t[14]||(t[14]=e=>B.value=e),Be],label:"Ответить анонимно",size:"large","revert-label":!0},null,8,["modelValue"])):(0,o.kq)("v-if",!0)])),_:1},8,["class","disabled"])],34)),[[c,Pe]]):(0,o.kq)("v-if",!0),F.value?((0,o.wg)(),(0,o.j4)(Vs,{key:1,modelValue:F.value,"onUpdate:modelValue":t[16]||(t[16]=e=>F.value=e),anonymous:B.value,"onUpdate:anonymous":t[17]||(t[17]=e=>B.value=e),confirmed:L.value,"onUpdate:confirmed":t[18]||(t[18]=e=>L.value=e)},null,8,["modelValue","anonymous","confirmed"])):(0,o.kq)("v-if",!0)],64)}}});var ai=s(8151),li=s.n(ai);const ci={};ci.$style=li();const di=(0,x.Z)(ni,[["__cssModules",ci]]);var ui=s(74689);function pi(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function hi(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function _i(e){return(0,i.a)(di,function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?pi(Object(s),!0).forEach((function(t){hi(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):pi(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},e)).directive("tooltip",ui.u).directive("cmd-ctrl-enter",ui.H)}},31885:(e,t,s)=>{"use strict";s.r(t),s.d(t,{createApp:()=>v});var i=s(76944),o=s(66252),r=s(3577),n=s(2262),a=s(12953),l=s(66309),c=s(63363),d=s(92934);const u=(0,o.aZ)({__name:"app",props:{communityId:{},onDestroy:{type:Function}},emits:["destroy"],setup(e,{expose:t,emit:s}){const i=e,u=s,p=(0,n.iH)(),h=(0,n.iH)(!1);(0,l.S1d)(p,(e=>{e.forEach((e=>{e.isIntersecting||(h.value=!1)}))}));const _=(0,d.D)((()=>u("destroy")),15e3);return t({show:()=>h.value=!0,hide:()=>h.value=!1}),a.core.listenTo(a.core,"video-iframe-enter",(()=>{u("destroy")})),(e,t)=>((0,o.wg)(),(0,o.iD)("div",{ref_key:"hostEl",ref:p,class:(0,r.C_)(e.$style.host)},[(0,o.Wm)(c.Z,{for:p.value,active:h.value,"community-id":i.communityId,onDestroy:(0,n.SU)(_)},null,8,["for","active","community-id","onDestroy"])],2))}});var p=s(22785),h=s.n(p),_=s(83744);const m={};m.$style=h();const g=(0,_.Z)(u,[["__cssModules",m]]);function v(e){return(0,i.a)(g,e)}},18058:(e,t,s)=>{"use strict";s.r(t),s.d(t,{createApp:()=>L});var i=s(76944),o=s(66252),r=s(3577),n=s(2262),a=s(91181),l=s(37043),c=s(12953);const d=(0,o._)("path",{d:"M125.121 49.5759c0 13.1363-9.633 22.8161-21.455 22.8161-11.8224 0-21.4556-9.6798-21.4556-22.8161 0-13.2288 9.6332-22.8161 21.4556-22.8161 11.822 0 21.455 9.5873 21.455 22.8161Zm-9.392 0c0-8.2089-5.583-13.8255-12.063-13.8255-6.4803 0-12.0635 5.6166-12.0635 13.8255 0 8.1266 5.5832 13.8255 12.0635 13.8255 6.48 0 12.063-5.7092 12.063-13.8255Z",fill:"#EA4335"},null,-1),u=(0,o._)("path",{d:"M174.876 49.5759c0 13.1363-9.944 22.8161-22.147 22.8161-12.204 0-22.147-9.6798-22.147-22.8161 0-13.2185 9.943-22.8161 22.147-22.8161 12.203 0 22.147 9.5873 22.147 22.8161Zm-9.695 0c0-8.2089-5.763-13.8255-12.452-13.8255s-12.452 5.6166-12.452 13.8255c0 8.1266 5.763 13.8255 12.452 13.8255s12.452-5.7092 12.452-13.8255Z",fill:"#FBBC05"},null,-1),p=(0,o._)("path",{d:"M237 7v66h-10V7h10Z",fill:"#34A853"},null,-1),h=(0,o._)("path",{d:"m275.197 57.9155 7.392 5.1127C280.204 66.6903 274.454 73 264.52 73 252.201 73 243 63.1195 243 50.5c0-13.3803 9.279-22.5 20.455-22.5 11.254 0 16.758 9.2922 18.557 14.3136l.988 2.5563-28.99 12.4572c2.219 4.5142 5.671 6.817 10.51 6.817 4.85 0 8.214-2.4753 10.677-6.2286Zm-22.752-8.0952 19.379-8.3487c-1.066-2.81-4.273-4.7678-8.047-4.7678-4.84 0-11.576 4.433-11.332 13.1165Z",fill:"#EA4335"},null,-1),_=(0,o._)("path",{d:"M44.8318 44.6057v-9.563h30.713C75.845 36.7094 76 38.6809 76 40.815c0 7.1748-1.8693 16.0468-7.8938 22.3679C62.2465 69.5854 54.7595 73 44.8415 73 26.4582 73 11 57.2886 11 38 11 18.7114 26.4582 3 44.8415 3c10.1698 0 17.4146 4.18699 22.858 9.6443l-6.4313 6.748c-3.9033-3.8415-9.1916-6.8293-16.4364-6.8293-13.4243 0-23.9234 11.3516-23.9234 25.437 0 14.0854 10.4991 25.437 23.9234 25.437 8.7073 0 13.6663-3.6687 16.8432-7.002 2.5764-2.7033 4.2714-6.5651 4.9397-11.8395l-21.7829.0102ZM221 27.3769v40.9174C221 85.1256 211.458 92 200.178 92c-10.619 0-17.01-7.3881-19.42-13.4302l8.377-3.6272c1.491 3.7094 5.146 8.0868 11.033 8.0868 7.221 0 11.695-4.6343 11.695-13.3582v-3.2779h-.336c-2.153 2.7641-6.302 5.1789-11.537 5.1789-10.954 0-20.99-9.9262-20.99-22.6988C179 36.0084 189.036 26 199.99 26c5.225 0 9.374 2.4148 11.537 5.0967h.336v-3.7095H221v-.0103Zm-8.455 21.4965c0-8.0252-5.147-13.8926-11.696-13.8926-6.637 0-12.198 5.8674-12.198 13.8926 0 7.943 5.561 13.7282 12.198 13.7282 6.549 0 11.696-5.7852 11.696-13.7282Z",fill:"#4285F4"},null,-1),m=(0,o._)("g",{filter:"url(#a)"},[(0,o._)("ellipse",{cx:"102.5",cy:"49.5",rx:"22.5",ry:"23.5",fill:"#EA4335"}),(0,o._)("path",{d:"M123.5 49.5c0 12.2124-9.463 22-21 22-11.5372 0-21-9.7876-21-22s9.4628-22 21-22c11.537 0 21 9.7876 21 22Z",stroke:"#F1F1F1","stroke-width":"3"})],-1),g=[(0,o._)("path",{d:"M97.1287 50.618c-.2841.1854-.4821-.1307-.4821-.1307s-3.3319-5.0638-3.5636-5.3058c-.3266-.3388-1.0538-.9082-2.0022-.2228-.3954.2847-1.0758.9534-.2799 2.3649.1726.3047 5.3698 8.1573 5.6782 8.5866 0 0 2.4429 3.389 4.0369 4.7835.442.3865.943.8017 1.553 1.1379.609.3359 1.313.6179 2.085.754.77.1449 1.597.1375 2.401-.0064.806-.146 1.582-.4275 2.306-.7823.178-.092.359-.1835.53-.286l.493-.2789c.343-.1977.669-.4123.985-.6333.633-.4415 1.22-.9302 1.752-1.4423.529-.5147.998-1.0607 1.394-1.6174.395-.5567.704-1.1308.928-1.6858.23-.5516.361-1.0885.425-1.5665.079-.4753.055-.8979.035-1.2353-.032-.3393-.085-.5978-.132-.7707-.045-.1726-.07-.2638-.07-.2638-.052-.304-.101-.594-.144-.8553-.122-.737-.266-1.5649-.418-2.4169-.064-.3611-.095-.5243-.095-.5243l.001.0071c-.56-3.1097-1.185-6.3221-1.185-6.3221-.081-.5608-.694-.8586-1.229-.6008-1.544.7428-2.216 2.1056-2.003 3.723l.641 3.6152c.108.4101-.453.7639-.73.4429-.872-1.0087-2.621-3.6742-2.621-3.6742-.8-1.092-5.248-7.6168-5.552-8.0202-.612-.8097-1.472-1.3226-2.2662-.93-.8114.4011-1.1548 1.1818-.618 2.1955.1458.2749 4.6112 7.0405 4.6112 7.0405.26.3911-.2.7991-.496.411 0 0-5.5706-8.3254-5.8201-8.7123-.5647-.8814-1.6573-1.2456-2.4327-.7376-.7572.4952-.918 1.4979-.3469 2.4079.1824.2882 4.0962 6.2135 5.6537 8.6326.104.1624.171.3662-.05.5077-.003.0019-.2326.1763-.434-.1336-.4247-.651-4.6905-7.0179-4.9289-7.364-.5478-.7961-1.3868-1.2756-2.2239-.7419-.7623.4851-1.0536 1.5151-.4304 2.3886l5.1503 7.8076s.1631.2803-.1054.4547Z"},null,-1),(0,o._)("path",{d:"m108.389 46.8515.433.6662s-3.578 2.412-2.293 7.3115c0 0 .17.6219-.202.6547 0 0-.341.1182-.54-.8268 0-.0022-1.345-4.6768 2.602-7.8056Z"},null,-1)],v=(0,o._)("path",{d:"M155.977 41.8544c6.395 0 10.653-.6771 13.033-1.2174 1.203-.273 2.332.7257 2.332 2.0599v13.5066c0 .9715-.612 1.8189-1.483 2.0449-2.135.5545-6.638 1.4234-13.882 1.4234s-11.746-.8689-13.882-1.4234c-.87-.226-1.482-1.0734-1.482-2.0449V42.6969c0-1.3342 1.129-2.3329 2.332-2.0599 2.379.5403 6.638 1.2174 13.032 1.2174Z",fill:"#56437C"},null,-1),f=(0,o._)("path",{d:"M168.019 68.836c8.536-7.7973 8.788-29.9906 3.227-36.2746-7.599-8.5883-31.97-9.0971-38.519.565-6.608 9.7496-3.786 32.4824 3.436 36.6139 8.042 4.6007 26.093 4.3595 31.856-.9043Z",fill:"#F7B529"},null,-1),y=(0,o._)("path",{d:"M163.872 36.0056c1.739 1.2827.326 2.727-.958 2.433-3.362-.7695-6.121-1.1972-9.557-1.9578-1.953-.4322-1.441-3.6487 1.561-3.3744 3.124.2851 7.6 1.9009 8.954 2.8992ZM133.841 36.0056c-1.475 1.2827-.276 2.727.813 2.433 2.852-.7695 5.193-1.1972 8.107-1.9578 1.657-.4322 1.223-3.6487-1.325-3.3744-2.649.2851-6.447 1.9009-7.595 2.8992Z",fill:"#713C35"},null,-1),b=(0,o._)("path",{d:"M153.514 58.0767c-.11.6762.841 1.1524 2.125 1.3979 1.283.2458 2.413.1679 2.522-.5083.11-.6761-.841-1.694-2.125-1.9397-1.283-.2458-2.413.374-2.522 1.0501ZM141.872 58.0767c.11.6762-.841 1.1524-2.125 1.3979-1.283.2458-2.413.1679-2.523-.5083-.109-.6761.842-1.694 2.125-1.9397 1.284-.2458 2.413.374 2.523 1.0501Z",fill:"#EE6E58"},null,-1),w=(0,o._)("path",{d:"M160.633 51.9613c0 3.4195-1.681 4.0869-3.754 4.0869s-3.753-.3763-3.753-4.0869 1.68-6.5355 3.753-6.5355c2.073 0 3.754 3.116 3.754 6.5355Z",fill:"#713C35"},null,-1),k=(0,o._)("path",{d:"M157.043 49.3519c-.394 1.153-1.316 1.8451-2.06 1.5456-.743-.2993-1.027-1.4769-.633-2.6298.395-1.1529 1.317-1.8451 2.06-1.5456.744.2996 1.027 1.4769.633 2.6298Z",fill:"#FFF8CC"},null,-1),S=(0,o._)("path",{d:"M142.26 51.9613c0 3.4195-1.681 4.0869-3.754 4.0869s-3.753-.3763-3.753-4.0869 1.68-6.5355 3.753-6.5355c2.073 0 3.754 3.116 3.754 6.5355Z",fill:"#713C35"},null,-1),O=(0,o._)("path",{d:"M138.67 49.3519c-.394 1.153-1.316 1.8451-2.06 1.5456-.743-.2993-1.027-1.4769-.633-2.6298.394-1.1529 1.316-1.8451 2.06-1.5456.744.2996 1.027 1.4769.633 2.6298Z",fill:"#FFF8CC"},null,-1),E=(0,o._)("path",{d:"m144.028 59.665 3.603.8233 3.603-.8233c.653 0 1.141.645 1.021 1.3416-.173 1.0131-.539 1.9308-1.044 2.6885l-5.734 1.4503c-1.237-.8235-2.161-2.3289-2.47-4.1388-.119-.6966.369-1.3416 1.021-1.3416Z",fill:"#713C35"},null,-1),C=(0,o._)("path",{d:"M144.028 59.665h7.206v.7988c0 .4685-.349.848-.781.848h-5.644c-.431 0-.781-.3795-.781-.848v-.7988Z",fill:"#fff"},null,-1),x=(0,o._)("path",{d:"M147.633 65.8239c-.776 0-1.507-.2473-2.154-.6782.836-1.2067 2.165-1.9875 3.664-1.9875.745 0 1.448.1943 2.07.5371-.868 1.3033-2.15 2.1286-3.58 2.1286Z",fill:"#EE6E58"},null,-1),T=(0,o._)("path",{d:"M157.365 68.4228c8.641.3955 10.411-8.0987 10.411-20.454 0-10.3969 6.038-12.6563 6.794-6.5782 1.382 9.197-.508 21.9263-6.55 27.445-5.763 5.2637-23.815 5.5048-31.857.904.495-1.5308 1.433-2.2348 4.788-1.3921 2.1.5274 2.64 1.7139 5.936 1.8834 3.295.1696 3.544-2.1255 10.478-1.8081Z",fill:"#D57443"},null,-1),I=(0,o._)("defs",null,[(0,o._)("filter",{id:"a",x:"79",y:"25",width:"47",height:"50",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB"},[(0,o._)("feFlood",{"flood-opacity":"0",result:"BackgroundImageFix"}),(0,o._)("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,o._)("feOffset",{dy:"1"}),(0,o._)("feGaussianBlur",{stdDeviation:".5"}),(0,o._)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,o._)("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"}),(0,o._)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_266_203"}),(0,o._)("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,o._)("feOffset",{dx:".2"}),(0,o._)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,o._)("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"}),(0,o._)("feBlend",{in2:"effect1_dropShadow_266_203",result:"effect2_dropShadow_266_203"}),(0,o._)("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,o._)("feOffset"),(0,o._)("feGaussianBlur",{stdDeviation:".5"}),(0,o._)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,o._)("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"}),(0,o._)("feBlend",{in2:"effect2_dropShadow_266_203",result:"effect3_dropShadow_266_203"}),(0,o._)("feBlend",{in:"SourceGraphic",in2:"effect3_dropShadow_266_203",result:"shape"})]),(0,o._)("filter",{id:"b",x:"86.4316",y:"36.3267",width:"32.9907",height:"34.364",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB"},[(0,o._)("feFlood",{"flood-opacity":"0",result:"BackgroundImageFix"}),(0,o._)("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),(0,o._)("feOffset",{dy:"4"}),(0,o._)("feGaussianBlur",{stdDeviation:"2"}),(0,o._)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,o._)("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.2 0"}),(0,o._)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_266_203"}),(0,o._)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_266_203",result:"shape"})])],-1),P=(0,o._)("p",null,[(0,o.Uk)(" В декабре мы "),(0,o._)("strong",null,"отключим вход через Google ID."),(0,o.Uk)(" Это новое требование закона. Чтобы сохранить доступ к аккаунту, привяжите к нему другой способ входа."),(0,o._)("br"),(0,o.Uk)(" Мы написали "),(0,o._)("a",{href:"https://pikabu.ru/go/data_refresh",target:"_blank"},"инструкцию"),(0,o.Uk)(", которая вам поможет. ")],-1),A=(0,o.aZ)({__name:"app",setup(e){const t=(0,n.iH)(!0);function s(){t.value=!1}return(e,i)=>((0,o.wg)(),(0,o.j4)(a.Z,{modelValue:t.value,"onUpdate:modelValue":i[2]||(i[2]=e=>t.value=e),"cross-button":"",style:{width:"343px"}},{default:(0,o.w5)((()=>[((0,o.wg)(),(0,o.iD)("svg",{fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"295",height:"94",class:(0,r.C_)(e.$style.googleLogo)},[d,u,p,h,_,m,(0,o._)("g",{class:(0,r.C_)(e.$style.googleHand),filter:"url(#b)",fill:"#F1F1F1"},g,2),v,f,y,b,w,k,S,O,E,C,x,T,I],2)),P,(0,o._)("footer",{class:(0,r.C_)(e.$style.footer)},[(0,o.Wm)(l.Z,{wide:"",label:"Перейти в настройки",onClick:i[0]||(i[0]=e=>{"user-settings"===c.core.initParams.pageName&&"security"===c.core.config("modules.settings.main").pageMode?s():c.core.history.location.href="/settings/security"})}),(0,o.Wm)(l.Z,{wide:"",theme:"gray",label:"Позже",onClick:i[1]||(i[1]=e=>s())})],2)])),_:1},8,["modelValue"]))}});var D=s(88002),M=s.n(D),R=s(83744);const N={};N.$style=M();const B=(0,R.Z)(A,[["__cssModules",N]]);function L(){return(0,i.a)(B)}},78049:(e,t,s)=>{"use strict";s.d(t,{g:()=>i});const i="pkb_int2"},18978:(e,t,s)=>{"use strict";s.r(t),s.d(t,{createApp:()=>E});var i=s(76944),o=s(66252),r=(s(88674),s(3577)),n=s(49963),a=s(2262),l=s(62357),c=s(91181),d=s(37043),u=s(55946),p=s(50542),h=s(69023),_=s(40094),m=s(27929),g=s(12953);const v=(0,o.aZ)({__name:"email-subscribe-step",emits:["close"],setup(e,{emit:t}){const s=(0,a.iH)(!0),i=(0,a.iH)(g.core.initParams.oauthAutoRegisterEmail||""),v=(0,a.iH)(!1),f=(0,a.iH)(!1),y=(0,a.iH)(),{sendEvent:b}=(0,u.z)(),w=t;async function k(){if(b("get_mailing_popup_continue_button_tapped",{type:"one_tap_registration",type_i8:v.value?"1":null}),!v.value)return void(s.value=!1);if(!i.value)return f.value=!0,void g.core.ui.toasts.showError("Введите ваш E-Mail",{$parent:y.value});const e=await async function(){if(!v.value)return;return await(0,m.L)(i.value)}();null!=e&&e.result?s.value=!1:null!=e&&e.message&&(f.value=!0,g.core.ui.toasts.showError(e.message,{$parent:y.value}))}function S(){b("mark_get_mailing",{type_i8:v.value?"1":null,component_name:"popup_after_one_tap_registration"}),f.value=!1}return(0,o.bv)((()=>{b("get_mailing_popup_showed",{type:"one_tap_registration"})})),(0,o.YP)(s,(()=>{s.value||(b("get_mailing_popup_closed",{type:"one_tap_registration"}),w("close"))})),(e,t)=>((0,o.wg)(),(0,o.j4)((0,o.LL)(e.IS_MOBILE?l.Z:c.Z),{modelValue:s.value,"onUpdate:modelValue":t[3]||(t[3]=e=>s.value=e),class:(0,r.C_)(e.$style.popup),active:s.value,title:"Специально для вас!","cross-button":"","header-size":"large","onUpdate:active":t[4]||(t[4]=e=>s.value=Boolean(e))},{footer:(0,o.w5)((()=>[(0,o._)("div",{class:(0,r.C_)(e.$style.buttons)},[(0,o.Wm)(d.Z,{label:"Продолжить",wide:e.IS_MOBILE,onClick:(0,n.iM)(k,["left"])},null,8,["wide","onClick"])],2)])),default:(0,o.w5)((()=>[e.IS_DESKTOP?((0,o.wg)(),(0,o.iD)("div",{key:0,ref_key:"toasts",ref:y,class:(0,r.C_)(e.$style.toastContainer)},null,2)):(0,o.kq)("v-if",!0),(0,o._)("form",{class:(0,r.C_)(e.$style.form)},[(0,o._)("p",{class:(0,r.C_)(e.$style.caption)}," Каждую неделю мы собираем для вас подборку с лучшими постами, важными новостями и специальными предложениями. Активируйте переключатель ниже, чтобы получать рассылку. Отменить подписку можно в любой момент. ",2),(0,o._)("div",{class:(0,r.C_)(e.$style.image)},null,2),(0,o.Wm)(h.Z,{modelValue:v.value,"onUpdate:modelValue":[t[0]||(t[0]=e=>v.value=e),S],class:(0,r.C_)(e.$style.switcher),label:"Хочу получать рассылку",size:"large","label-size":"large","revert-label":!0},null,8,["modelValue","class"]),(0,o.Wm)(n.uT,{name:e.$style.input},{default:(0,o.w5)((()=>[v.value?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,r.C_)(e.$style.input)},[(0,o.Wm)(p.Z,{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=e=>i.value=e),type:"email",placeholder:"Ваш E-mail",error:f.value,onInput:t[2]||(t[2]=e=>f.value=!1)},{suffix:(0,o.w5)((()=>[f.value?((0,o.wg)(),(0,o.j4)(_.Z,{key:0,name:"exclamation_triangle",class:(0,r.C_)(e.$style.errorIcon)},null,8,["class"])):(0,o.kq)("v-if",!0)])),_:1},8,["modelValue","error"])],2)):(0,o.kq)("v-if",!0)])),_:1},8,["name"])],2)])),_:1},40,["modelValue","class","active"]))}});var f=s(46043),y=s.n(f),b=s(83744);const w={};w.$style=y();const k=(0,b.Z)(v,[["__cssModules",w]]);var S;!function(e){e[e.EMAIL_SUBSCRIBE=1]="EMAIL_SUBSCRIBE"}(S||(S={}));const O=(0,o.aZ)({__name:"app",setup(e){const t=(0,a.iH)(S.EMAIL_SUBSCRIBE);function s(){t.value=null}return(e,i)=>t.value===S.EMAIL_SUBSCRIBE?((0,o.wg)(),(0,o.j4)(k,{key:0,onClose:s})):(0,o.kq)("v-if",!0)}});function E(){return(0,i.a)(O)}},90674:(e,t,s)=>{"use strict";s.r(t),s.d(t,{createApp:()=>S});var i=s(76944),o=s(66252),r=s(3577),n=s(2262),a=s(5707),l=s(37829),c=s(37043),d=s(89661),u=s(57552),p=s(92514),h=s(55680),_=s(42107);const m=(0,o._)("p",null," Инструмент для малого бизнеса и самозанятых. Рассказывайте на Пикабу о своих товарах или услугах и привлекайте новых клиентов. ",-1),g=[(0,o._)("li",null," Галочка верифицированного аккаунта ",-1),(0,o._)("li",null," Попадание во все пользовательские ленты в зависимости от рейтинга ",-1),(0,o._)("li",null," Разрешено добавлять рекламные ссылки ",-1),(0,o._)("li",null," Возможность отключить рекламу на Пикабу ",-1)],v=(0,o.aZ)({__name:"app",setup(e){const t=(0,n.iH)(!0),{data:s,isLoading:i}=(0,h.BN)(1);return(0,o.bv)((()=>{(0,u.g)("show-pikabu-plus-popup","https://yandex.ru/ads/adfox/260477/getCode?p1=cnpjl&p2=frfe&pfc=gmzsx&pfb=subwr&pr=[random]&ptrc=b")})),(e,h)=>((0,o.wg)(),(0,o.j4)(a.Z,{modelValue:t.value,"onUpdate:modelValue":h[1]||(h[1]=e=>t.value=e),"cross-button":"",centered:!0,onClose:h[2]||(h[2]=e=>((0,u.g)("close-pikabu-plus-popup","https://yandex.ru/ads/adfox/260477/getCode?p1=cnpjl&p2=frfe&pfc=gmzsx&pfb=subxn&pr=[random]&ptrc=b"),void _.cp.getInstance().sendEvent("pikabu_plus_popup_closed",{})))},{default:(0,o.w5)((()=>[(0,o.Wm)(l.Z,{class:(0,r.C_)(e.$style.modal)},{header:(0,o.w5)((()=>[(0,o._)("div",{class:(0,r.C_)(e.$style.header)},[(0,o._)("img",{class:(0,r.C_)(e.$style.icon),src:"https://cs14.pikabu.ru/post_img/2024/05/15/7/1715771938153832067.png",alt:"Пикабу+"},null,2),(0,o._)("div",{class:(0,r.C_)(e.$style.title)}," Подписка Пикабу+ ",2)],2)])),default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,r.C_)(e.$style.text)},[m,(0,o._)("ul",{class:(0,r.C_)(e.$style.list)},g,2),(0,o._)("div",{class:(0,r.C_)(e.$style.price)},[!(0,n.SU)(i)&&(0,n.SU)(s)?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.Uk)((0,r.zw)((0,n.SU)(p.xG)((0,n.SU)(s).price))+" в месяц ",1)],64)):(0,o.kq)("v-if",!0),(0,n.SU)(i)?((0,o.wg)(),(0,o.j4)(d.Z,{key:1,size:16})):(0,o.kq)("v-if",!0)],2)],2),(0,o._)("div",{class:(0,r.C_)(e.$style.btns)},[(0,o.Wm)(c.Z,{wide:"",size:e.IS_DESKTOP?"small":"medium",onClick:h[0]||(h[0]=e=>((0,u.g)("click-pikabu-plus-link","https://yandex.ru/ads/adfox/260477/getCode?p1=cnpjl&p2=frfe&pfc=gmzsx&pfb=subxg&pr=[random]&ptrc=b"),_.cp.getInstance().sendEvent("pikabu_plus_popup_button_tapped",{}),void setTimeout((()=>{window.location.href="/information/pikabu-plus"}))))},{default:(0,o.w5)((()=>[(0,o.Uk)(" Оформить подписку ")])),_:1},8,["size"])],2)])),_:1},8,["class"])])),_:1},8,["modelValue"]))}});var f=s(17156),y=s.n(f),b=s(83744);const w={};w.$style=y();const k=(0,b.Z)(v,[["__cssModules",w]]);function S(){return(0,i.a)(k)}},68528:(e,t,s)=>{"use strict";s.r(t),s.d(t,{createApp:()=>Tt});var i=s(76944),o=s(74689),r=(s(88674),s(41817),s(66252)),n=s(3577),a=s(2262),l=s(49963),c=s(41218),d=s(5707),u=s(37829),p=s(37043),h=s(62728),_=s(546),m=s(62357),g=s(43544),v=s(55946),f=s(44813),y=s(50542),b=s(40094),w=s(35653),k=(s(66992),s(33948),s(2707),s(69876));const S={id:0,title:"",coverImageUrl:void 0,storiesCount:0,link:""},O={series:"series",storiesSearch:"storiesSearch",storiesSorting:"storiesSorting"},E={new:1,old:2,custom:3},C={[E.custom]:"в моём порядке",[E.new]:"сначала новые",[E.old]:"сначала старые"},x={[E.custom]:"my_sorting",[E.new]:"first_new",[E.old]:"first_old"};var T=s(76987),I=s(33877),P=s(18446),A=s.n(P);function D(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function M(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?D(Object(s),!0).forEach((function(t){R(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):D(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function R(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const N={query:"",tags:[],from:"",to:""},B=(0,k.Q_)("seriesEditorStore",{state:()=>({initialSeries:S,series:S,activeStep:O.series,isStoriesAddingDisabled:!1,storiesSearch:M({},N),seriesCoverName:void 0,addedStories:new Map,removedStories:new Map,seriesStories:[],sortedStories:[],storiesSort:E.new,isStoriesSortApplyed:!1,isSeriesStepsLinksHidden:!1}),actions:{initSeries(e){this.seriesCoverName=void 0,this.initialSeries=null!=e?e:M({},S),this.series=M({},this.initialSeries)},cancelStoriesSearch(){this.setActiveStep(O.series),this.addedStories.clear(),this.clearStoriesSearch()},clearStoriesSearch(){this.storiesSearch=M({},N)},setActiveStep(e){this.activeStep=e},async sendPostSeriesAddPostAnalytics(e){const{sendEvent:t}=(0,v.z)();let s=0;for(const i of this.addedStories.keys()){const o=e.storiesCount-this.removedStories.size+ ++s;await(0,I.g)(10),t("post_series_add_post",{type:"edit",size:o,post_series_id:e.id,post_id:i})}},async sendPostSeriesDeletePostAnalytics(e){const{sendEvent:t}=(0,v.z)();let s=0;for(const i of this.removedStories.keys()){const o=e.storiesCount+this.addedStories.size-++s;await(0,I.g)(10),t("post_series_delete_post",{type:"edit",size:o,post_series_id:e.id,post_id:i})}},deleteStory(e){if(this.addedStories.has(e.id))return void this.addedStories.delete(e.id);const{sendEvent:t}=(0,v.z)();t("click",{type:"post_series_delete_post"}),this.removedStories.set(e.id,e),this.actualStoriesCount<2&&this.isStoriesSortStepActive&&(this.sortedStories=[],this.setActiveStep(O.series))},setSeriesStories(e){const t=[...this.addedStories.values()];if(!this.isStoriesSortApplyed)return void(this.seriesStories=t.concat(e));const s=t.filter((e=>!this.sortedStories.some((t=>t.id===e.id))));this.isCustomStoriesSort?this.seriesStories=[...s,...this.sortedStories]:this.seriesStories=this.sortStories(this.sortedStories.concat(s),this.storiesSort)},sortStories:(e,t=E.new)=>t===E.custom?e:e.slice().sort(((e,s)=>(t===E.new?-1:1)*(e.id-s.id))),swapStories({from:e,to:t}){const s=this.sortedStories.slice();[s[e],s[t]]=[s[t],s[e]],this.sortedStories=s},initSortedStories(){if(!this.isStoriesSortApplyed){const e=this.seriesStories.filter((e=>!this.removedStories.has(e.id)&&!this.addedStories.has(e.id)));this.initStoriesSort(e)}this.sortedStories=this.sortStories(this.seriesStories.filter((e=>!this.removedStories.has(e.id))),this.storiesSort)},initStoriesSort(e){if(e.every(((t,s)=>0===s||t.id<e[s-1].id)))return void(this.storiesSort=E.new);e.every(((t,s)=>0===s||t.id>e[s-1].id))?this.storiesSort=E.old:this.storiesSort=E.custom}},getters:{isEditingMode(){return 0!==this.series.id},actualStoriesCount(){return this.series.storiesCount+this.addedStories.size-this.removedStories.size},isStoriesLimitExceeded(){const{initParams:{limitStoriesInSeries:e}}=(0,T.o)();return this.actualStoriesCount>=e},seriesChanged(){return!this.isEditingMode||!A()(this.initialSeries,this.series)||this.addedStories.size>0||this.removedStories.size>0},isSeriesStepActive(){return this.activeStep===O.series},isStoriesSearchStepActive(){return this.activeStep===O.storiesSearch},isStoriesSortStepActive(){return this.activeStep===O.storiesSorting},isCustomStoriesSort(){return this.storiesSort===E.custom}}});var L=s(41574);const j=(0,r.aZ)({__name:"input-view",setup(e){const t=B(),s=(0,a.iH)(),i=(0,a.iH)(),o=(0,a.iH)(!1),l=(0,a.iH)(""),c=(0,a.iH)("");let d;return(0,r.bv)((()=>{d=new L.E,d.width=Math.min(552,window.innerWidth),d.datesRangeMode=!0,d.showButtonsPanel=!1,d.on("select",(e=>{l.value=e.startDate,c.value=e.endDate}))})),(e,u)=>((0,r.wg)(),(0,r.j4)(y.Z,{modelValue:(0,a.SU)(t).storiesSearch.query,"onUpdate:modelValue":u[4]||(u[4]=e=>(0,a.SU)(t).storiesSearch.query=e),label:"Начните вводить название поста",class:(0,n.C_)([e.$style.host,{[e.$style.host_active]:l.value&&c.value||o.value}])},{suffix:(0,r.w5)((()=>[(0,r.Wm)(b.Z,{ref_key:"calendarTriggerEl",ref:i,name:"calendar_20",size:16,onClick:u[0]||(u[0]=e=>async function(){o.value=!0,d.show(),await(0,r.Y3)(),d.$el.appendTo(s.value)}())},null,512),(0,r.Wm)(w.Z,{active:o.value,"onUpdate:active":u[3]||(u[3]=e=>o.value=e),for:i.value,direction:"bottom",alignment:"center"},{default:(0,r.w5)((()=>[(0,r._)("div",{ref_key:"calendarEl",ref:s},null,512),(0,r._)("footer",{class:(0,n.C_)(e.$style.calendarFooter)},[(0,r.Wm)(p.Z,{class:(0,n.C_)(e.$style.btn),label:"Показать посты",onClick:u[1]||(u[1]=e=>(t.storiesSearch.from=l.value,t.storiesSearch.to=c.value,void(o.value=!1)))},null,8,["class"]),(0,r.Wm)(p.Z,{class:(0,n.C_)(e.$style.btn),label:"Сбросить даты",theme:"gray",onClick:u[2]||(u[2]=e=>(d.setDate(null,null),o.value=!1,l.value="",c.value="",t.storiesSearch.from="",void(t.storiesSearch.to="")))},null,8,["class"])],2)])),_:1},8,["active","for"])])),_:1},8,["modelValue","class"]))}});var $=s(98277),U=s.n($),F=s(83744);const V={};V.$style=U();const H=(0,F.Z)(j,[["__cssModules",V]]);var Z=s(61258);const z=(0,r.aZ)({__name:"tags-view",setup(e){const t=B();return(e,s)=>((0,r.wg)(),(0,r.iD)("div",{class:(0,n.C_)([e.$style.host,{[e.$style.tags_hasTags]:(0,a.SU)(t).storiesSearch.tags.length}])},[(0,r.Wm)(Z.Z,{modelValue:(0,a.SU)(t).storiesSearch.tags,"onUpdate:modelValue":s[0]||(s[0]=e=>(0,a.SU)(t).storiesSearch.tags=e),borderless:"",size:"large",label:"Введите тег, чтобы найти посты",mode:"btn",class:(0,n.C_)(e.$style.tagsInput),"max-tags":8},null,8,["modelValue","class"])],2))}});var q=s(4223),W=s.n(q);const G={};G.$style=W();const Y=(0,F.Z)(z,[["__cssModules",G]]);var K=s(70197),X=s(24482);const J=(0,r.aZ)({__name:"modal-content-view",setup(e){const t=B();return(e,s)=>((0,r.wg)(),(0,r.iD)("div",{class:(0,n.C_)(e.$style.host)},[e.IS_DESKTOP?((0,r.wg)(),(0,r.j4)(K.Z,{key:0,tab:(0,a.SU)(t).activeStep},{default:(0,r.w5)((()=>[(0,r.Wm)(X.Z,{name:(0,a.SU)(O).series},{default:(0,r.w5)((()=>[(0,r.WI)(e.$slots,"series")])),_:3},8,["name"]),(0,r.Wm)(X.Z,{name:(0,a.SU)(O).storiesSearch},{default:(0,r.w5)((()=>[(0,r.WI)(e.$slots,"stories")])),_:3},8,["name"]),(0,r.Wm)(X.Z,{name:(0,a.SU)(O).storiesSorting},{default:(0,r.w5)((()=>[(0,r.WI)(e.$slots,"stories-sort")])),_:3},8,["name"])])),_:3},8,["tab"])):(0,r.kq)("v-if",!0),e.IS_MOBILE?((0,r.wg)(),(0,r.iD)("div",{key:1,class:(0,n.C_)(e.$style.wrapper)},[(0,r.WI)(e.$slots,"series"),(0,r.Wm)(l.uT,{name:e.$style.step},{default:(0,r.w5)((()=>[(0,a.SU)(t).isStoriesSearchStepActive?((0,r.wg)(),(0,r.iD)("div",{key:0,class:(0,n.C_)(e.$style.step)},[(0,r.WI)(e.$slots,"stories")],2)):(0,r.kq)("v-if",!0)])),_:3},8,["name"]),(0,r.Wm)(l.uT,{name:e.$style.step},{default:(0,r.w5)((()=>[(0,a.SU)(t).isStoriesSortStepActive?((0,r.wg)(),(0,r.iD)("div",{key:0,class:(0,n.C_)(e.$style.step)},[(0,r.WI)(e.$slots,"stories-sort")],2)):(0,r.kq)("v-if",!0)])),_:3},8,["name"])],2)):(0,r.kq)("v-if",!0)],2))}});var Q=s(76854),ee=s.n(Q);const te={};te.$style=ee();const se=(0,F.Z)(J,[["__cssModules",te]]),ie=(0,r.aZ)({__name:"title-input-view",setup(e){const t=B(),{sendEvent:s}=(0,v.z)(),i=(0,r.YP)((()=>t.series.title),(e=>{e&&(s("input_start",{type:"post_series_title"}),i())}));return(e,s)=>((0,r.wg)(),(0,r.iD)("div",{class:(0,n.C_)(e.$style.host)},[(0,r.Wm)(y.Z,{modelValue:(0,a.SU)(t).series.title,"onUpdate:modelValue":s[0]||(s[0]=e=>(0,a.SU)(t).series.title=e),type:"text",label:"Название серии",autocomplete:"off",clearable:"",tabindex:e.IS_MOBILE?"-1":"0","max-length":50},null,8,["modelValue","tabindex"])],2))}});var oe=s(58262),re=s.n(oe);const ne={};ne.$style=re();const ae=(0,F.Z)(ie,[["__cssModules",ne]]);var le=s(55529),ce=s(81780),de=s(12953),ue=s(29281);const pe=(0,r.aZ)({__name:"pkb-image-cropper-modal",props:{modelValue:{type:Boolean},file:{},outputSize:{},type:{},isBlockOverflowTouch:{type:Boolean}},emits:["update:modelValue","upload"],setup(e,{emit:t}){const s=e,i=t;let o;return(0,r.YP)((()=>s.modelValue),(e=>{o||(o=new ue.hA({outputSize:s.outputSize,file:s.file,type:s.type,indent:!0,isBlockOverflowTouch:s.isBlockOverflowTouch,zIndex:(0,le.e)()}),de.core.listenTo(o,"upload",(e=>{i("upload",{url:e.tmp_file_url,name:e.tmp_file_name}),i("update:modelValue",!1)})),de.core.listenTo(o,ce.e.UNMOUNTED,(()=>{i("update:modelValue",!1)}))),e?o.show():o.hide()})),(0,r.YP)((()=>s.file),(e=>{e&&o&&(o.file=e)})),(e,t)=>(0,r.WI)(e.$slots,"default")}});var he=s(53536),_e=s(46068);const me=["src"],ge={key:1,class:"story-series-thumb"},ve=(0,r.aZ)({__name:"image-view",setup(e){const t=B(),s=(0,a.iH)(!1),i=(0,a.iH)(),{sendEvent:o}=(0,v.z)();return(e,l)=>((0,r.wg)(),(0,r.iD)("figure",{class:(0,n.C_)(e.$style.host)},[(0,r.Wm)(pe,{modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=e=>s.value=e),file:i.value,"output-size":[208,172],type:(0,a.SU)(ue.x6).SERIES_COVER,onUpload:l[1]||(l[1]=e=>function({url:e,name:s}){t.series.coverImageUrl=e,t.seriesCoverName=s}(e))},null,8,["modelValue","file","type"]),!(0,a.SU)(t).series.coverImageUrl||Boolean((0,a.SU)(t).seriesCoverName)?((0,r.wg)(),(0,r.iD)("figcaption",{key:0,class:(0,n.C_)(e.$style.cta)}," Загрузите обложку (не обязательно) ",2)):(0,r.kq)("v-if",!0),(0,r._)("div",{class:(0,n.C_)(e.$style.imageWrapper),onClick:l[2]||(l[2]=e=>async function(){o("click",{type:"post_series_image"});try{i.value=await(0,_e.Z)({accept:{"image/*":he.We.map((e=>`.${e}`))}}),s.value=!0}catch(e){}}())},[(0,a.SU)(t).series.coverImageUrl?((0,r.wg)(),(0,r.iD)("img",{key:0,src:(0,a.SU)(t).series.coverImageUrl,class:(0,n.C_)(e.$style.cover)},null,10,me)):((0,r.wg)(),(0,r.iD)("div",ge)),(0,r.Wm)(b.Z,{name:"photo_16",class:(0,n.C_)(e.$style.icon)},null,8,["class"])],2)],2))}});var fe=s(69167),ye=s.n(fe);const be={};be.$style=ye();const we=(0,F.Z)(ve,[["__cssModules",be]]);var ke=s(66309);const Se="Добавить посты в серию",Oe="Настроить порядок постов",Ee=(0,r.aZ)({__name:"steps-links-view",props:{watchIntersection:{type:Boolean}},setup(e){const t=e,s=B(),{sendEvent:i}=(0,v.z)(),o=(0,a.iH)(),c=(0,r.Fl)((()=>!s.isStoriesLimitExceeded&&!s.isStoriesAddingDisabled)),d=(0,r.Fl)((()=>s.seriesStories.length>1));function u(){s.setActiveStep(O.storiesSearch),i("click",{type:"post_series_add_post"})}function h(){s.setActiveStep(O.storiesSorting),i("post_series_popup_sorting_posts_button_tapped",{size:s.series.storiesCount})}return t.watchIntersection&&(0,ke.S1d)(o,(([{isIntersecting:e}])=>{s.isSeriesStepsLinksHidden=!e}),{threshold:1}),(e,t)=>c.value||d.value?((0,r.wg)(),(0,r.iD)("div",{key:0,ref_key:"hostEl",ref:o,class:(0,n.C_)(e.$style.host)},[e.IS_DESKTOP?((0,r.wg)(),(0,r.iD)(r.HY,{key:0},[c.value?((0,r.wg)(),(0,r.iD)("a",{key:0,href:"#",class:(0,n.C_)([e.$style.trigger,e.$style.addStoriesTrigger]),onClick:t[0]||(t[0]=(0,l.iM)((e=>u()),["prevent"]))},[(0,r.Wm)(b.Z,{name:"add_16",class:(0,n.C_)(e.$style.triggerIcon)},null,8,["class"]),(0,r.Uk)(" "+(0,n.zw)(Se))],2)):(0,r.kq)("v-if",!0),d.value?((0,r.wg)(),(0,r.iD)("a",{key:1,href:"#",class:(0,n.C_)([e.$style.trigger,e.$style.sortStoriesTrigger]),onClick:t[1]||(t[1]=(0,l.iM)((e=>h()),["prevent"]))},[(0,r.Wm)(b.Z,{name:"sorting-reverse_16",class:(0,n.C_)(e.$style.triggerIcon)},null,8,["class"]),(0,r.Uk)(" "+(0,n.zw)(Oe))],2)):(0,r.kq)("v-if",!0)],64)):(0,r.kq)("v-if",!0),e.IS_MOBILE?((0,r.wg)(),(0,r.iD)(r.HY,{key:1},[c.value?((0,r.wg)(),(0,r.j4)(p.Z,{key:0,label:Se,outline:"",wide:"",onClick:t[2]||(t[2]=e=>u())})):(0,r.kq)("v-if",!0),d.value?((0,r.wg)(),(0,r.j4)(p.Z,{key:1,class:(0,n.C_)(e.$style.sortStoriesTrigger),label:Oe,theme:"gray",wide:"",onClick:t[3]||(t[3]=e=>h())},null,8,["class"])):(0,r.kq)("v-if",!0)],64)):(0,r.kq)("v-if",!0)],2)):(0,r.kq)("v-if",!0)}});var Ce=s(23108),xe=s.n(Ce);const Te={};Te.$style=xe();const Ie=(0,F.Z)(Ee,[["__cssModules",Te]]);var Pe=s(34828),Ae=s(72189);const De=["innerHTML"],Me=["src"],Re=["src"],Ne=(0,r.aZ)({__name:"story-view",props:{title:{},text:{},images:{},poll:{},fundraising:{},loading:{type:Boolean}},setup(e){const t=e,s=(0,r.Fl)((()=>{var e;return null===(e=t.images)||void 0===e?void 0:e.length})),i=(0,r.Fl)((()=>{var e,s;return null!==(e=null===(s=t.text)||void 0===s?void 0:s.length)&&void 0!==e?e:0})),o=(0,r.Fl)((()=>i.value<=100&&!s.value));return(e,a)=>{var l,c;return(0,r.wg)(),(0,r.iD)("div",{class:(0,n.C_)(e.$style.host)},[t.loading?((0,r.wg)(),(0,r.j4)(Ae.Z,{key:0,ribs:[88,100,73,96,89,100,75],class:(0,n.C_)(e.$style.loader)},null,8,["class"])):((0,r.wg)(),(0,r.iD)(r.HY,{key:1},[(0,r.WI)(e.$slots,"prefix"),(0,r._)("div",{class:(0,n.C_)([e.$style.container,{[e.$style.container_padding]:Boolean(e.$slots.prefix)}])},[(0,r._)("h6",{class:(0,n.C_)(e.$style.title)},[(0,r._)("span",{class:(0,n.C_)({[e.$style.titleTextMargin]:Boolean(e.$slots.icon)})},(0,n.zw)(t.title),3),(0,r.WI)(e.$slots,"icon")],2),(0,r._)("p",{class:(0,n.C_)([e.$style.text,{[e.$style.text_short]:null===(l=t.images)||void 0===l?void 0:l.length}]),innerHTML:t.text},null,10,De),s.value?((0,r.wg)(),(0,r.iD)("div",{key:0,class:(0,n.C_)(e.$style.imgContainer)},[t.text?((0,r.wg)(!0),(0,r.iD)(r.HY,{key:0},(0,r.Ko)(e.images,(t=>((0,r.wg)(),(0,r.iD)("img",{key:t,src:t,class:(0,n.C_)(e.$style.img)},null,10,Me)))),128)):((0,r.wg)(),(0,r.iD)("img",{key:1,src:null===(c=t.images)||void 0===c?void 0:c[0],class:(0,n.C_)([e.$style.img,e.$style.img_single])},null,10,Re))],2)):(0,r.kq)("v-if",!0),o.value?((0,r.wg)(),(0,r.iD)(r.HY,{key:1},[t.poll?((0,r.wg)(),(0,r.iD)("div",{key:0,class:(0,n.C_)(e.$style.extraBlock)},[(0,r.Wm)(b.Z,{name:"poll_20",size:20,class:(0,n.C_)(e.$style.extraBlockIcon)},null,8,["class"]),(0,r._)("span",{class:(0,n.C_)(e.$style.extrBlockTitle)},(0,n.zw)(t.poll),3)],2)):(0,r.kq)("v-if",!0),!t.fundraising||0!==i.value&&t.poll?(0,r.kq)("v-if",!0):((0,r.wg)(),(0,r.iD)("div",{key:1,class:(0,n.C_)(e.$style.extraBlock)},[(0,r.Wm)(b.Z,{name:"rub_20",size:20,class:(0,n.C_)(e.$style.extraBlockIcon)},null,8,["class"]),(0,r._)("span",{class:(0,n.C_)(e.$style.extrBlockTitle)},(0,n.zw)(t.fundraising),3)],2))],64)):(0,r.kq)("v-if",!0)],2)],64))],2)}}});var Be=s(90109),Le=s.n(Be);const je={};je.$style=Le();const $e=(0,F.Z)(Ne,[["__cssModules",je]]),Ue=(0,r.aZ)({__name:"series-view",props:{loading:{type:Boolean}},emits:["delete"],setup(e,{emit:t}){const s=B(),i=(0,a.iH)(!1),o=e,c=t,d=(0,r.Fl)((()=>o.loading&&0!==s.series.storiesCount?s.series.storiesCount:0)),u=(0,r.Fl)((()=>s.series.storiesCount>0||s.seriesStories.length>0&&s.seriesStories.length!==s.removedStories.size));return(e,t)=>{const p=(0,r.Q2)("tooltip");return(0,r.wg)(),(0,r.j4)(l.uT,{name:e.$style.transition},{default:(0,r.w5)((()=>[(0,r._)("div",{class:(0,n.C_)(e.$style.host)},[(0,r.Wm)(ae),(0,r.Wm)(we,{class:(0,n.C_)(e.$style.image)},null,8,["class"]),(0,r.Wm)(Ie,{"watch-intersection":e.IS_DESKTOP},null,8,["watch-intersection"]),(0,r.wy)((0,r._)("div",{class:(0,n.C_)(e.$style.stories)},[o.loading?(0,r.kq)("v-if",!0):((0,r.wg)(!0),(0,r.iD)(r.HY,{key:0},(0,r.Ko)((0,a.SU)(s).seriesStories,(t=>((0,r.wg)(),(0,r.iD)(r.HY,null,[(0,a.SU)(s).removedStories.has(t.id)?(0,r.kq)("v-if",!0):((0,r.wg)(),(0,r.j4)($e,{key:t.id,class:(0,n.C_)(e.$style.story),title:t.title,images:t.previews,text:t.text,poll:t.polls[0],fundraising:t.fundraisings[0]},{icon:(0,r.w5)((()=>[(0,r.wy)((0,r.Wm)(b.Z,{name:"delete_16",class:(0,n.C_)(e.$style.deleteIcon),onClick:e=>(0,a.SU)(s).deleteStory(t)},null,8,["class","onClick"]),[[p,"Удалить пост из серии"]])])),_:2},1032,["class","title","images","text","poll","fundraising"]))],64)))),256)),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(d.value,(t=>((0,r.wg)(),(0,r.j4)($e,{key:t,class:(0,n.C_)(e.$style.story),loading:""},null,8,["class"])))),128))],2),[[l.F8,u.value]]),(0,a.SU)(s).isEditingMode?((0,r.wg)(),(0,r.iD)("div",{key:0,class:(0,n.C_)(e.$style.deleteWrapper)},[(0,r._)("p",null,[(0,r._)("a",{href:"#",class:(0,n.C_)([e.$style.trigger,e.$style.deleteTrigger]),onClick:t[0]||(t[0]=(0,l.iM)((e=>i.value=!0),["prevent"]))},[(0,r.Wm)(b.Z,{name:"delete_16",class:(0,n.C_)(e.$style.triggerIcon)},null,8,["class"]),(0,r.Uk)(" Удалить серию ")],2)]),(0,r._)("p",{class:(0,n.C_)(e.$style.deleteInfo)}," Посты при этом не будут удалены ",2),(0,r.Wm)(Pe.Z,{active:i.value,"onUpdate:active":t[1]||(t[1]=e=>i.value=e),content:"Вы действительно хотите удалить эту серию постов? Посты при этом не будут удалены",onConfirm:t[2]||(t[2]=e=>c("delete"))},null,8,["active"])],2)):(0,r.kq)("v-if",!0)],2)])),_:1},8,["name"])}}});var Fe=s(52901),Ve=s.n(Fe);const He={};He.$style=Ve();const Ze=(0,F.Z)(Ue,[["__cssModules",He]]);s(84944),s(33792);var ze=s(47344);const qe=(0,r._)("br",null,null,-1),We=(0,r.aZ)({__name:"search-stories-view",setup(e){const t=B(),s=(0,T.o)(),{sendEvent:i}=(0,v.z)(),o=(0,a.iH)(),l=(0,c.Nr)((0,r.Fl)((()=>f.ED.searchStoriesPreviews({query:t.storiesSearch.query,tags:t.storiesSearch.tags.join(","),from:t.storiesSearch.from,to:t.storiesSearch.to}))),300),{isInitialLoading:d,data:u,hasNextPage:p,isFetchingNextPage:h,fetchNextPage:_}=(0,f.dO)({queryKey:l,enabled:(0,r.Fl)((()=>t.isStoriesSearchStepActive))}),m=(0,r.Fl)((()=>{var e;return(null===(e=u.value)||void 0===e?void 0:e.pages.flat())||[]})),g=(0,r.Fl)((()=>0===m.value.length)),y=(0,ke.D9i)(m),b=(0,r.Fl)((()=>{var e;return(null===(e=y.value)||void 0===e?void 0:e.length)||4}));return(0,ke.S1d)(o,(()=>{!h.value&&null!=p&&p.value&&(_(),o.value=void 0)}),{rootMargin:"200% 0px"}),(e,l)=>((0,r.wg)(),(0,r.iD)(r.HY,null,[e.IS_MOBILE?((0,r.wg)(),(0,r.j4)(Y,{key:0})):(0,r.kq)("v-if",!0),g.value&&(0,a.SU)(d)?((0,r.wg)(),(0,r.iD)("div",{key:1,class:(0,n.C_)(e.$style.list)},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(b.value,(t=>((0,r.wg)(),(0,r.j4)($e,{key:t,class:(0,n.C_)(e.$style.story),loading:""},null,8,["class"])))),128))],2)):g.value?((0,r.wg)(),(0,r.iD)("p",{key:3,class:(0,n.C_)(e.$style.emptyMessage)},[(0,r.Uk)(" По вашему запросу ничего не найдено."),qe,(0,r.Uk)("Попробуйте ввести другой запрос ")],2)):((0,r.wg)(),(0,r.iD)("div",{key:2,class:(0,n.C_)(e.$style.list)},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(m.value,(o=>((0,r.wg)(),(0,r.j4)($e,{key:o.id,title:o.title,text:o.text,images:o.previews,poll:o.polls[0],fundraising:o.fundraisings[0],class:(0,n.C_)(e.$style.story),loading:(0,a.SU)(d),onClick:e=>function(e){if(!d.value)return t.isStoriesLimitExceeded&&!t.addedStories.has(e.id)?(i("error_occurred",{type:"post_series_max_posts",post_id:e.id,post_series_id:t.series.id}),void de.core.ui.toasts.showError(`В этой серии достигнуто максимальное количество постов (${s.initParams.limitStoriesInSeries})`,{isGlobal:!0})):void(t.addedStories.has(e.id)?t.addedStories.delete(e.id):(i("click",{type:"post_series_choose_post"}),t.addedStories.set(e.id,e)))}(o)},{prefix:(0,r.w5)((()=>[(0,r.Wm)(ze.Z,{class:(0,n.C_)(e.$style.checkbox),"model-value":(0,a.SU)(t).addedStories.has(o.id)},null,8,["class","model-value"])])),_:2},1032,["title","text","images","poll","fundraising","class","loading","onClick"])))),128)),(0,a.SU)(p)?((0,r.wg)(),(0,r.iD)(r.HY,{key:0},[(0,r.Wm)($e,{ref_key:"loaderRef",ref:o,class:(0,n.C_)(e.$style.story),loading:""},null,8,["class"]),e.IS_DESKTOP?((0,r.wg)(),(0,r.j4)($e,{key:0,class:(0,n.C_)(e.$style.story),loading:""},null,8,["class"])):(0,r.kq)("v-if",!0)],64)):(0,r.kq)("v-if",!0)],2))],64))}});var Ge=s(58911),Ye=s.n(Ge);const Ke={};Ke.$style=Ye();const Xe=(0,F.Z)(We,[["__cssModules",Ke]]);var Je=s(36830);function Qe(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function et(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(s),!0).forEach((function(t){tt(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Qe(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function tt(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const st=(0,r.aZ)({__name:"save-btn-view",props:{loading:{type:Boolean}},emits:["edit"],setup(e,{emit:t}){const s=B(),{sendEvent:i}=(0,v.z)(),o=e,n=t,{isLoading:l,mutate:c}=(0,f.kt)(),{isLoading:d,mutate:u}=(0,f.n2)(),{isLoading:h,mutate:_}=(0,f.qi)();function m(e){e&&n("edit",e)}function g(e){_({seriesId:s.series.id,storiesIds:s.seriesStories.filter((e=>!s.removedStories.has(e.id))).map((e=>e.id))},{onSuccess(){(0,Je.g)("Порядок постов успешно сохранен"),m(e)}})}return(e,t)=>(0,a.SU)(s).isSeriesStepActive?((0,r.wg)(),(0,r.j4)(p.Z,{key:0,label:"Сохранить",loading:(0,a.SU)(l)||(0,a.SU)(d)||(0,a.SU)(h)||o.loading,disabled:!(0,a.SU)(s).seriesChanged&&!(0,a.SU)(s).isStoriesSortApplyed,wide:e.IS_MOBILE,onClick:t[0]||(t[0]=e=>{s.seriesChanged||!s.isStoriesSortApplyed?s.isEditingMode?u({series:s.series,cover:s.seriesCoverName,addStoriesIds:[...s.addedStories.keys()],removeStoriesIds:[...s.removedStories.keys()]},{onSuccess:async({series:e})=>{s.sendPostSeriesAddPostAnalytics(e),s.sendPostSeriesDeletePostAnalytics(e),s.isStoriesSortApplyed?g(e):m(e)}}):c({title:s.series.title,cover:s.seriesCoverName,storiesIds:[...s.addedStories.keys()]},{onSuccess:({seriesId:e,seriesTitle:t,seriesUrl:o,storiesCount:r})=>{i("post_series_create",{size:r,post_series_id:e}),m(et(et({},s.series),{},{id:e,title:t,link:o,storiesCount:r}))}}):g(s.series)})},null,8,["loading","disabled","wide"])):((0,r.wg)(),(0,r.j4)(p.Z,{key:1,label:"Применить",wide:e.IS_MOBILE,outline:"",onClick:t[1]||(t[1]=e=>(s.isStoriesSearchStepActive&&(s.clearStoriesSearch(),i("post_series_choose_post_save_button_tapped",{size:s.addedStories.size,list_f32:[...s.addedStories.keys()]})),s.isStoriesSortStepActive&&(s.isStoriesSortApplyed=!0,s.seriesStories=[...s.sortedStories],i("post_series_sorting_posts_save_button_tapped",{size:s.series.storiesCount,type:x[s.storiesSort]})),void s.setActiveStep(O.series)))},null,8,["wide"]))}});var it=s(53329),ot=s(22177),rt=s(32499);const nt=["onClick"],at=(0,r.aZ)({__name:"sorting-select-view",setup(e){const t=B(),s=(0,a.iH)(),i=(0,a.iH)(!1);return(0,r.YP)((()=>t.storiesSort),((e,t)=>{e!==t&&(i.value=!1)})),(e,i)=>((0,r.wg)(),(0,r.iD)("div",{class:(0,n.C_)(e.$style.host)},[(0,r.Uk)(" Сортировать посты "),(0,r.Wm)(rt.Z,null,{trigger:(0,r.w5)((({toggle:i})=>[(0,r._)("a",{ref_key:"dropdownAnchorRef",ref:s,href:"#",class:(0,n.C_)(e.$style.dropdownAnchor),onClick:(0,l.iM)((e=>i()),["prevent"])},[(0,r.Uk)((0,n.zw)((0,a.SU)(C)[(0,a.SU)(t).storiesSort||(0,a.SU)(E).new])+" ",1),(0,r.Wm)(b.Z,{class:(0,n.C_)(e.$style.dropdownIcon),name:"arrow_down_16"},null,8,["class"])],10,nt)])),default:(0,r.w5)((({toggle:s})=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)((0,a.SU)(C),((o,n)=>((0,r.wg)(),(0,r.j4)(it.Z,{key:n,label:o,onClick:e=>{!function(e){const s=Number(e);s===E.new?t.sortedStories=t.sortStories(t.sortedStories,E.new):s===E.old&&(t.sortedStories=t.sortStories(t.sortedStories,E.old)),t.storiesSort=s}(n),s()}},(0,r.Nv)({_:2},[e.IS_DESKTOP?{name:"prefix",fn:(0,r.w5)((()=>[(0,r.Wm)(ot.Z,{modelValue:(0,a.SU)(t).storiesSort,"onUpdate:modelValue":i[0]||(i[0]=e=>(0,a.SU)(t).storiesSort=e),value:Number(n)},null,8,["modelValue","value"])])),key:"0"}:void 0]),1032,["label","onClick"])))),128))])),_:1})],2))}});var lt=s(81221),ct=s.n(lt);const dt={};dt.$style=ct();const ut=(0,F.Z)(at,[["__cssModules",dt]]);var pt=s(96101),ht=s(60387);const _t=(0,r.aZ)({__name:"sorting-stories-view",setup(e){const t=B(),s=(0,a.iH)([]);(0,r.YP)((()=>t.isStoriesSortStepActive),(e=>{e&&t.initSortedStories()}));const i=(0,r.Fl)((()=>t.storiesSort===E.custom));async function o(e,i){const o=(0,ke.NXq)(s.value[e]),r=(0,ke.NXq)(s.value[i]),n=e<i?o:r,a=e<i?r:o;await(0,ht.V)(n,a),t.swapStories({from:e,to:i})}return(e,l)=>{const c=(0,r.Q2)("tooltip");return(0,r.wg)(),(0,r.iD)(r.HY,null,[e.IS_MOBILE?((0,r.wg)(),(0,r.j4)(ut,{key:0})):(0,r.kq)("v-if",!0),(0,r._)("div",{class:(0,n.C_)([e.$style.stories,{[e.$style.stories_swapping]:i.value}])},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)((0,a.SU)(t).sortedStories,((l,d)=>((0,r.wg)(),(0,r.iD)(r.HY,{key:d},[(0,a.SU)(t).removedStories.has(l.id)?(0,r.kq)("v-if",!0):((0,r.wg)(),(0,r.iD)("div",{key:0,ref_for:!0,ref_key:"itemRefs",ref:s,class:(0,n.C_)(e.$style.storyWrapper)},[i.value?((0,r.wg)(),(0,r.iD)("div",{key:0,class:(0,n.C_)(e.$style.swapControls)},[(0,r.Wm)(pt.Z,{icon:"up_18",size:"lg",class:(0,n.C_)(e.$style.swapBtn),disabled:0===d,onClick:e=>o(d,d-1)},null,8,["class","disabled","onClick"]),(0,r.Wm)(pt.Z,{icon:"down_18",size:"lg",class:(0,n.C_)(e.$style.swapBtn),disabled:d===(0,a.SU)(t).sortedStories.length-1,onClick:e=>o(d,d+1)},null,8,["class","disabled","onClick"]),(0,r.Wm)(pt.Z,{icon:"delete_16",size:"lg",class:(0,n.C_)(e.$style.deleteControlBtn),onClick:e=>(0,a.SU)(t).deleteStory(l)},null,8,["class","onClick"])],2)):(0,r.kq)("v-if",!0),(0,r.Wm)($e,{class:(0,n.C_)(e.$style.story),title:l.title,images:l.previews,text:l.text,poll:l.polls[0],fundraising:l.fundraisings[0]},(0,r.Nv)({_:2},[i.value?void 0:{name:"icon",fn:(0,r.w5)((()=>[(0,r.wy)((0,r.Wm)(b.Z,{name:"delete_16",class:(0,n.C_)(e.$style.deleteIcon),onClick:e=>(0,a.SU)(t).deleteStory(l)},null,8,["class","onClick"]),[[c,"Удалить пост из серии"]])])),key:"0"}]),1032,["class","title","images","text","poll","fundraising"])],2))],64)))),128))],2)],64)}}});var mt=s(83195),gt=s.n(mt);const vt={};vt.$style=gt();const ft=(0,F.Z)(_t,[["__cssModules",vt]]);function yt(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function bt(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?yt(Object(s),!0).forEach((function(t){wt(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):yt(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function wt(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const kt={key:1},St=(0,r.aZ)(bt(bt({},{inheritAttrs:!1}),{},{__name:"app",props:{handleSeriesEdited:{type:Function},handleSeriesDeleted:{type:Function}},emits:["edit"],setup(e,{expose:t,emit:s}){const i=B(),{sendEvent:o}=(0,v.z)(),y=e,b=s,w=(0,a.iH)(!1),k=(0,r.Fl)((()=>{if(i.isStoriesSearchStepActive)return"Выбрать посты";if(i.isStoriesSortStepActive){var e;return`Настроить порядок постов в серии «${null!==(e=i.series.title)&&void 0!==e?e:"Без названия"}»`}return i.isEditingMode?"Редактировать серию":"Создать серию"}));function S(){w.value=!1}function E(e){y.handleSeriesEdited(e),b("edit",e),S()}function C(){return i.isStoriesSearchStepActive?(i.setActiveStep(O.series),i.addedStories.clear(),void o("post_series_choose_post_cancel_button_tapped",{size:i.addedStories.size})):i.isStoriesSortStepActive?(i.setActiveStep(O.series),void o("post_series_sorting_cancel_button_tapped",{size:i.series.storiesCount,type:x[i.storiesSort]})):(o("click",{type:"post_series_cancel"}),void S())}t({show:({storySeries:e,isStoriesAddingDisabled:t=!1})=>{i.$reset(),w.value=!0,i.initSeries(e),i.isStoriesAddingDisabled=t,i.isEditingMode||o("click",{type:"post_series_create"})},close:S});const{mutate:T,isLoading:I}=(0,f._O)();async function P(){T(i.series.id,{onSuccess:e=>{e&&(o("post_series_delete",{post_series_id:i.series.id,size:i.series.storiesCount}),y.handleSeriesDeleted())}})}const A=(0,r.Fl)((()=>f.ED.seriesStories(i.series.id))),{data:D,isLoading:M,isFetched:R}=(0,f.Hh)({queryKey:A,enabled:(0,r.Fl)((()=>i.isEditingMode))}),N=(0,c.KS)(500),L=(0,r.Fl)((()=>!!i.isEditingMode&&(!N.value||M.value)));return(0,r.m0)((()=>{i.isEditingMode?R.value&&D.value&&i.isSeriesStepActive&&i.setSeriesStories(D.value):i.setSeriesStories([])})),(e,t)=>((0,r.wg)(),(0,r.iD)(r.HY,null,[e.IS_DESKTOP?((0,r.wg)(),(0,r.j4)(d.Z,{key:0,modelValue:w.value,"onUpdate:modelValue":t[4]||(t[4]=e=>w.value=e)},{default:(0,r.w5)((()=>[(0,r.Wm)(u.Z,null,{header:(0,r.w5)((()=>[(0,r._)("div",{class:(0,n.C_)(e.$style.header)},[(0,r.Wm)(_.Z,{active:!(0,a.SU)(i).isSeriesStepActive,onClick:t[0]||(t[0]=e=>C())},null,8,["active"]),(0,r.Wm)(g.Z,null,{default:(0,r.w5)((()=>[(0,r.Uk)((0,n.zw)(k.value),1)])),_:1}),(0,a.SU)(i).isSeriesStepActive?(0,r.wy)(((0,r.wg)(),(0,r.j4)(Ie,{key:0,class:(0,n.C_)(e.$style.seriesLinks)},null,8,["class"])),[[l.F8,(0,a.SU)(i).isSeriesStepsLinksHidden]]):(0,r.kq)("v-if",!0),(0,a.SU)(i).isStoriesSearchStepActive?((0,r.wg)(),(0,r.iD)("div",{key:1,class:(0,n.C_)(e.$style.searchPanel)},[(0,r.Wm)(H),(0,r.Wm)(Y)],2)):(0,r.kq)("v-if",!0),(0,a.SU)(i).isStoriesSortStepActive?((0,r.wg)(),(0,r.j4)(ut,{key:2})):(0,r.kq)("v-if",!0)],2)])),footer:(0,r.w5)((()=>[(0,r.Wm)(st,{class:(0,n.C_)(e.$style.addBtn),loading:(0,a.SU)(I),onEdit:t[2]||(t[2]=e=>E(e))},null,8,["class","loading"]),(0,r.Wm)(p.Z,{label:"Отмена",theme:"gray",onClick:t[3]||(t[3]=e=>C())})])),default:(0,r.w5)((()=>[(0,r.Wm)(se,null,{series:(0,r.w5)((()=>[(0,r.Wm)(Ze,{loading:L.value,onDelete:t[1]||(t[1]=e=>P())},null,8,["loading"])])),stories:(0,r.w5)((()=>[(0,r.Wm)(Xe)])),"stories-sort":(0,r.w5)((()=>[(0,r.Wm)(ft)])),_:1})])),_:1})])),_:1},8,["modelValue"])):(0,r.kq)("v-if",!0),e.IS_MOBILE?((0,r.wg)(),(0,r.j4)(m.Z,{key:1,active:w.value,"onUpdate:active":t[9]||(t[9]=e=>w.value=e),"cross-btn":!1},{header:(0,r.w5)((()=>[(0,r._)("header",{class:(0,n.C_)(e.$style.header),"cross-btn":!1},[(0,r.Wm)(_.Z,{active:!(0,a.SU)(i).isSeriesStepActive,onClick:t[5]||(t[5]=e=>C())},null,8,["active"]),(0,a.SU)(i).isSeriesStepActive?((0,r.wg)(),(0,r.j4)(h.Z,{key:0,size:"large","icon-name":"close_20","icon-size":20,class:(0,n.C_)(e.$style.closeBtn),onClick:t[6]||(t[6]=e=>C())},null,8,["class"])):(0,r.kq)("v-if",!0),k.value?((0,r.wg)(),(0,r.iD)("h3",kt,(0,n.zw)(k.value),1)):(0,r.kq)("v-if",!0),(0,a.SU)(i).isStoriesSearchStepActive?((0,r.wg)(),(0,r.j4)(H,{key:2})):(0,r.kq)("v-if",!0)],2)])),default:(0,r.w5)((()=>[(0,r.Wm)(se,null,{series:(0,r.w5)((()=>[(0,r.Wm)(Ze,{loading:L.value,onDelete:t[7]||(t[7]=e=>P())},null,8,["loading"])])),stories:(0,r.w5)((()=>[(0,r.Wm)(Xe)])),"stories-sort":(0,r.w5)((()=>[(0,r.Wm)(ft)])),_:1}),(0,r._)("footer",{class:(0,n.C_)(e.$style.footer)},[(0,r.Wm)(st,{loading:(0,a.SU)(I),onEdit:t[8]||(t[8]=e=>E(e))},null,8,["loading"])],2)])),_:1},8,["active"])):(0,r.kq)("v-if",!0)],64))}}));var Ot=s(19050),Et=s.n(Ot);const Ct={};Ct.$style=Et();const xt=(0,F.Z)(St,[["__cssModules",Ct]]);function Tt(e){return(0,i.a)(xt,e).directive("tooltip",o.u)}},63416:(e,t,s)=>{"use strict";s.r(t),s.d(t,{createApp:()=>xd});var i=s(76944),o=(s(88674),s(41817),s(66252)),r=s(49963),n=s(3577),a=s(2262),l=s(12953),c=(s(85827),s(66309)),d=s(40094),u=s(90008),p=s(72658),h=s(10703),_=s(46068),m=s(50542),g=s(37043);const v=(0,o.aZ)({__name:"pkb-divider",props:{label:{}},setup(e){const t=e;return(e,s)=>((0,o.wg)(),(0,o.iD)("div",{class:(0,n.C_)(e.$style.host)},[(0,o._)("span",{class:(0,n.C_)(e.$style.label)},(0,n.zw)(t.label),3)],2))}});var f=s(48665),y=s.n(f),b=s(83744);const w={};w.$style=y();const k=(0,b.Z)(v,[["__cssModules",w]]);var S=s(91181),O=s(53536);const E=["onDrop"],C={key:1},x=(0,o._)("div",null,"До 3 минут / 500 МБ в форматах mp4, webm, mov, avi.",-1),T=(0,o._)("a",{href:"/go/help_post_limits_video#anchor4_limits-add-video",target:"_blank"},"Подробнее о лимитах",-1),I=(0,o.aZ)({__name:"attachment-popup-view",props:{active:{type:Boolean,default:!1}},emits:["update:active","addVideo","addEmbedVideo"],setup(e,{emit:t}){const s=!1,i=e,l=t,c=(0,o.Fl)({get:()=>i.active,set:e=>l("update:active",e)}),d=(0,a.iH)(),u=(0,a.iH)("");async function p(){const e=await(0,_.Z)({accept:{"video/*":O.G1.map((e=>`.${e}`))},multiple:!0});l("addVideo",e),c.value=!1}function v(e){var t,s;const i=Array.from(null!==(t=null===(s=e.dataTransfer)||void 0===s?void 0:s.files)&&void 0!==t?t:[]);l("addVideo",i),c.value=!1}return(0,o.YP)(u,(e=>{e&&h.tv.getProviderTypeBySource(e)&&(l("addEmbedVideo",e),u.value="",setTimeout((()=>l("update:active",!1))))})),(0,o.YP)(c,(e=>{var t;e?null===(t=d.value)||void 0===t||t.focus():u.value=""}),{flush:"post"}),(e,t)=>((0,o.wg)(),(0,o.j4)(S.Z,{modelValue:c.value,"onUpdate:modelValue":t[4]||(t[4]=e=>c.value=e),title:"Добавить видео"},{default:(0,o.w5)((()=>[(0,o.Wm)(m.Z,{ref_key:"urlInputEl",ref:d,modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),label:"Ссылка на Youtube, YouTube Shorts, VK, Rutube, Vimeo",size:(0,a.SU)(s)?"large":"medium"},null,8,["modelValue","size"]),(0,o.Wm)(k,{class:(0,n.C_)(e.$style.divider),label:"или"},null,8,["class"]),(0,o._)("div",{class:(0,n.C_)(e.$style.upload),onDragover:t[3]||(t[3]=(0,r.iM)((()=>{}),["stop","prevent"])),onDrop:(0,r.iM)(v,["stop","prevent"])},[(0,o._)("div",{class:(0,n.C_)(e.$style.uploadNote)},[(0,a.SU)(s)?((0,o.wg)(),(0,o.iD)("a",{key:0,onClick:t[1]||(t[1]=(0,r.iM)((e=>p()),["prevent"]))}," Загрузите своё видео. ")):((0,o.wg)(),(0,o.iD)("div",C," Загрузите своё видео. ")),x,T],2),(0,a.SU)(s)?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.j4)(g.Z,{key:0,label:"Выбрать видео",theme:"gray",size:"small",onClick:t[2]||(t[2]=e=>p())}))],42,E)])),_:1},8,["modelValue"]))}});var P=s(16350),A=s.n(P);const D={};D.$style=A();const M=(0,b.Z)(I,[["__cssModules",D]]);var R=s(96637),N=s(90312),B=s(59870),L=(s(66992),s(33948),s(74916),s(69876)),j=(s(15306),s(91920)),$=s(12950),U=s(77105),F=s(2439),V=s(93971);function H(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function Z(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?H(Object(s),!0).forEach((function(t){z(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):H(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function z(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const q="recommendations-observer-response";class W{constructor(e){z(this,"skipNextNCalls",0),z(this,"minDelay",1e3),z(this,"inProgress",!1),z(this,"wasFirstCall",!1),z(this,"lastTextCount",0),z(this,"lastTagsCount",0),z(this,"lastNsfwSetting",!1),z(this,"emitter",new F.v),z(this,"options",{getEditorPayloadData:()=>null,getEditorTagsLength:()=>0,getTextContent:()=>"",getTitle:()=>"",getNsfwSetting:()=>!1}),this.options=Z(Z({},this.options),e)}call(e={}){this.inProgress||(this.skipNextNCalls?this.skipNextNCalls--:(this.inProgress=!0,this.wasFirstCall&&this.needRequest(e)?this.getRecommendations():!this.wasFirstCall&&this.needFirstRequest(e)?(this.wasFirstCall=!0,this.getRecommendations()):this.inProgress=!1))}listenToResponse(e){this.emitter.listenTo(this.emitter,q,e)}needFirstRequest({delta:e,draftLoaded:t}){return!!t||(this.getTextCount()>=100||(1===this.getTagsCount()||this.hasFilledMedia(null==e?void 0:e.inserted)))}needRequest({delta:e}){return Math.abs(this.getTextCount()-this.lastTextCount)>=100||(this.getTagsCount()!==this.lastTagsCount||(!!this.hasFilledMedia(null==e?void 0:e.inserted)||(this.options.getNsfwSetting()!==this.lastNsfwSetting||this.hasRemovedBlocks(null==e?void 0:e.removed))))}async getRecommendations(){var e;this.lastTextCount=this.getTextCount(),this.lastTagsCount=this.getTagsCount(),this.lastNsfwSetting=this.options.getNsfwSetting();const{response:{result:t},data:s}=await(0,V.G)(this.options.getEditorPayloadData()),i={action:"get_recommended_tags",title:this.options.getTitle(),text:this.options.getTextContent().replace(U.dT,"#").trim()},{response:o,data:r}=await $.cf.post("/ajax/stories_actions.php",i);if(o.result&&null!=r&&null!==(e=r.tags)&&void 0!==e&&e.length){const e=[...r.tags.map((e=>({extra_tag:e,score:0,screen_index:0}))),...s.tags];s.tags=e}t?this.emitter.emit(q,s):N.c.getInstance().sendEvent("error_occurred",{type_i8:6}),setTimeout((()=>this.inProgress=!1),this.minDelay)}getTextCount(){return this.options.getTextContent().length}getTagsCount(){return this.options.getEditorTagsLength()}hasFilledMedia(e){const t=[j.STORY_BLOCK_TYPE.IMAGE.valueOf(),j.STORY_BLOCK_TYPE.VIDEO.valueOf()],s=null==e?void 0:e.find((({data:e})=>t.includes(e.type)||t.includes(e.type.value)));return null!=s}hasRemovedBlocks(e){const t=[j.STORY_BLOCK_TYPE.IMAGE.valueOf(),j.STORY_BLOCK_TYPE.VIDEO.valueOf(),j.STORY_BLOCK_TYPE.TEXT.valueOf()],s=null==e?void 0:e.find((({data:e})=>t.includes(e.type)||t.includes(e.type.value)));return null!=s}}s(38559);var G=s(26117),Y=s(33877),K=s(18446),X=s.n(K),J=s(53056),Q=s(93356),ee=s(30381),te=s.n(ee),se=s(90647);const ie="times";const oe=new class{init(e){this.editor=e,this.startTime=new Date,this.initDB(),window.addEventListener("beforeunload",(()=>{this.sendEvent("draft"),this.save()}))}async initDB(){try{this.db=await(0,se.X3)("EditorTime",1,{upgrade(e){e.createObjectStore(ie,{keyPath:"draftId"})}})}catch(e){console.warn("Could not initialize Indexed DB"),console.warn(e)}}async save(){if(this.db&&this.draftId&&this.startTime)try{const e=this.db.transaction(ie,"readwrite"),t=e.objectStore(ie),s=await t.get(this.draftId);await t.put({draftId:this.draftId,time:Math.round((s?s.time:0)+(new Date).getTime()-this.startTime.getTime())}),await e.done}catch(e){console.warn("Could not save draft's editing time into Indexed DB"),console.warn(e)}}async setDraft(e){if(this.db&&e!==this.draftId)try{if(this.previousTime=0,this.draftId&&(await this.save(),this.startTime=new Date),e){const t=await this.db.get(ie,e);t&&(this.previousTime=t.time)}this.draftId=e}catch(t){console.warn("Could not set draft id editing time into Indexed DB"),console.warn(t)}}sendEvent(e){var t;if(!(this.db&&this.draftId&&this.editor&&this.startTime))return;const s=null===(t=this.editor)||void 0===t?void 0:t.getLength();N.c.getInstance().sendEvent("editor_time",{view_time:Math.round((this.previousTime?this.previousTime:0)+(new Date).getTime()-this.startTime.getTime()),draft_id:this.draftId,type:e,length:s})}};var re,ne=s(94217);function ae(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function le(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(s),!0).forEach((function(t){ce(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ae(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function ce(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(e){e[e.NONE=0]="NONE",e[e.SAVING=1]="SAVING",e[e.LOADING=2]="LOADING"}(re||(re={}));const de=(0,L.Q_)("storyEditorDraft",{state:()=>{var e;const t=l.core.config("modules.story-editor"),s="schedule"===t.type,i=s?(0,Q.wH)():null==t?void 0:t.draft;return i&&(i.tags=(0,Q.id)(i.tags).join(","),s&&(i.schedule_id=t.scheduleId)),{draft:i,count:null==t?void 0:t.draftsCount,limit:null==t?void 0:t.draftsLimit,list:[],listLoading:!1,savedTime:"",blocks:null!==(e=null==i?void 0:i.blocks)&&void 0!==e?e:[],progress:re.NONE}},getters:{isEmpty:e=>{var t,s,i;const o=e.draft;return!o||!(null!==(t=o.blocks)&&void 0!==t&&t.length||null!==(s=o.tags)&&void 0!==s&&s.length||null!==(i=o.title)&&void 0!==i&&i.length||o.is_adult||o.is_anonymous_story||o.is_community)},draftId:e=>{var t;return null===(t=e.draft)||void 0===t?void 0:t.id},isLimitExceeded:e=>e.count>=e.limit,isSaving:e=>e.progress===re.SAVING,isLoading:e=>e.progress===re.LOADING,isSaved(e){const t=Ir();if(t.storyId)return!0;if(t.isEditorEmpty)return!e.draft;if(!e.draft)return!1;const s=e=>Object.fromEntries(Object.entries(null!=e?e:{}).filter((([e,t])=>!["id","story_id","parent_story_id"].includes(e)&&Boolean(t))));return X()(s(t.data),s(this.data))},data(e){var t,s;const i=e.draft;return i?{title:null!==(t=null===(s=i.title)||void 0===s?void 0:s.trim())&&void 0!==t?t:"",blocks:e.blocks,tags:i.tags,is_story_boost:i.is_story_boost,is_author_content:i.is_author_content,is_authors:i.is_authors,is_adult:i.is_adult,is_anonymous_story:i.is_anonymous_story,is_donations_disabled:i.is_donations_disabled,is_comments_disabled:i.is_comments_disabled,is_advert_blogs:i.is_advert_blogs,advert_company:i.advert_company,scheduled_time:i.scheduled_time||null,color_theme:i.theme,community:i.community,is_community:Boolean(i.community),series_id:i.series_id,is_paid_subscription:i.is_paid_subscription,parent_story_id:i.parent_story_id,schedule_id:i.schedule_id}:null}},actions:{clearDraft(){if(null===this.draft)return;const e=Ir();this.draft=null,e.title="",e.storyBlocks=[],e.community=null,e.tags=[],e.theme=0,e.resetSettings(),e.recommendedCommunities=[],e.recommendedTags=[],e.parentStoryId=0,e.recommendationObserver&&e.recommendationObserver.skipNextNCalls++},async getList(){try{this.listLoading=!0;const{response:e,data:t}=await G.co.getPreviewList();if(!e.result)throw e.message;this.list=t.drafts.map((e=>(0,ne.E)(e)))}catch(e){l.core.ui.toasts.showError(e)}finally{this.listLoading=!1}},async deleteAll(){try{this.progress=re.SAVING;const{response:e}=await G.co.deleteAllDrafts();if(!e.result)throw e.message;this.list=[],this.count=0,this.clearDraft()}catch(e){l.core.ui.toasts.showError(e)}finally{this.progress=re.NONE}},async delete(e){if(!e)return!1;try{var t;this.progress=re.SAVING;const{response:s,data:i}=await G.co.deleteDraft(e);if(!s.result)throw s.message;return(null===(t=this.draft)||void 0===t?void 0:t.id)===e&&this.clearDraft(),this.list=this.list.filter((({id:t})=>t!==e)),this.count=i.drafts_count,!0}catch(s){l.core.ui.toasts.showError(s)}finally{this.progress=re.NONE}return!1},async load(e){await oe.setDraft(e),oe.sendEvent("draft"),this.progress=re.LOADING;try{var t,s,i,r;const[{draft:a}]=await Promise.all([G.co.getById(e),(0,Y.g)(300)]),l=Ir(),c={is_story_boost:l.availableStoryBoosts>0&&a.is_story_boost,is_author_content:a.is_author_content,is_authors:!(!this.isEmpty||!l.settings.is_authors)||a.is_authors,is_adult:a.is_adult,is_anonymous_story:null!==(t=a.is_anonymous_story)&&void 0!==t&&t,is_donations_disabled:a.is_donations_disabled,is_comments_disabled:a.is_comments_disabled,advert_company:a.advert_company,is_advert_blogs:a.is_advert_blogs,scheduled_time:a.scheduled_time,series_id:a.series_id,is_paid_subscription:a.is_paid_subscription,parent_story_id:a.parent_story_id,is_not_advert:!1};if(this.draft=le({id:e,title:a.title,blocks:a.blocks,theme:a.color_theme,tags:a.tags.split(",").map((e=>e.trim())).join(",")},c),this.blocks=null!==(s=a.blocks)&&void 0!==s?s:[],await(0,o.Y3)(),l.title=null!==(i=a.title)&&void 0!==i?i:"",l.storyBlocks=this.blocks,l.community=null,l.parentStoryId=a.parent_story_id,a.community_data)try{const e=JSON.parse(a.community_data);l.community=e,this.draft.community=e}catch(n){console.error(n)}return l.settings=c,l.theme=a.color_theme,l.tags=(0,Q.id)(a.tags),null===(r=l.recommendationObserver)||void 0===r||r.call({draftLoaded:Boolean(a)}),l.wasBoosted=!1,this.draft}catch(n){console.error(n)}finally{this.progress=re.NONE}return null},async save(){var e;this.progress=re.SAVING;const t=Ir(),s=Date.now(),i=null===(e=this.draft)||void 0===e?void 0:e.id,o=t.data;let r;try{const{draftId:e,draftsCount:t}=await G.co.saveDraft(le(le({},o),{},{time:Math.floor(s/1e3)}),i);r=e,J.m.remove(U.Xm),await oe.setDraft(e),this.count=t}catch(n){r=i,J.m.set(U.Xm,this.draft),console.error(n)}finally{this.progress=re.NONE}this.savedTime=te()(s).format("HH:mm"),t.title=o.title,this.draft=le({id:r,theme:o.color_theme},o),this.blocks=t.storyBlocks}}});var ue=s(51584),pe=s.n(ue),he=s(42107),_e=s(17393),me=s(3780),ge=s(66090),ve=s(92514),fe=s(94242),ye=s(20817),be=s(72346),we=s(95374),ke=s(2889),Se=s(29939),Oe=s(41218),Ee=s(544),Ce=s(70273);const xe=(e,t=!1)=>({state:s})=>{let i=0;for(let r=0;r<s.doc.childCount;r++){var o;const n=s.doc.child(r),a=n.type.name;if(("image"===a&&n.attrs.src===e||"imagesCarousel"===a&&null!==(o=n.attrs.items)&&void 0!==o&&o.some((t=>t.url===e)))&&(i++,!t||i>1))return!0}return!1},Te=Ce.hj.create({name:"storyEditorCommands",addCommands:()=>({checkImageDuplicate:xe})});var Ie=s(58364),Pe=s(35525),Ae=s(76318),De=s(70204),Me=s(96448);const Re=new Set(["imagesCarousel","image"]);var Ne=s(2376),Be=s(16560);function Le(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const je=Ce.hj.create({name:"dropCursor",addOptions:()=>({getDropPosition:(e,t)=>{var s,i;return null!==(s=null===(i=t.posAtCoords({left:e.clientX,top:e.clientY}))||void 0===i?void 0:i.pos)&&void 0!==s?s:null}}),addProseMirrorPlugins(){return[new Ne.Sy({key:new Ne.H$(this.name),view:e=>new $e(e,this.options.getDropPosition)})]}});class $e{constructor(e,t){Le(this,"width",4),Le(this,"cursorPos",null),Le(this,"element",null),Le(this,"timeout",-1),this.editorView=e,this.getDropPosition=t,this.handlers=["dragover","dragend","drop","dragleave"].map((t=>{const s=e=>{this[t](e)};return e.dom.addEventListener(t,s),{name:t,handler:s}}))}destroy(){this.handlers.forEach((({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t)))}update(e,t){null!==this.cursorPos&&t.doc!==e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){var t,s;e!==this.cursorPos&&(this.cursorPos=e,null===e?(null===(t=this.element)||void 0===t||null===(s=t.parentNode)||void 0===s||s.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){const e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent;let s;const i=this.editorView.dom,o=i.getBoundingClientRect(),r=o.width/i.offsetWidth,n=o.height/i.offsetHeight;if(t){const t=e.nodeBefore,i=e.nodeAfter;if(t||i){const e=this.editorView.nodeDOM(this.cursorPos-(t?t.nodeSize:0));if(e){const o=e.getBoundingClientRect();let r=t?o.bottom:o.top;if(t&&i){r=(r+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2}const a=this.width/2*n;s={left:o.left,right:o.right,top:r-a,bottom:r+a}}}}if(!s){const e=this.editorView.coordsAtPos(this.cursorPos),t=this.width/2*r;s={left:e.left-t,right:e.left+t,top:e.top,bottom:e.bottom}}const a=this.editorView.dom.offsetParent;let l,c;if(this.element||(this.element=a.appendChild(document.createElement("div")),this.element.className="pm-dropcursor",this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.element.style.backgroundColor="currentColor"),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t),!a||a===document.body&&"static"===getComputedStyle(a).position)l=-scrollX,c=-scrollY;else{const e=a.getBoundingClientRect(),t=e.width/a.offsetWidth,s=e.height/a.offsetHeight;l=e.left-a.scrollLeft*t,c=e.top-a.scrollTop*s}const d=t?16:0;this.element.style.left=(s.left-l+d)/r+"px",this.element.style.top=(s.top-c)/n+"px",this.element.style.width=(s.right-s.left-2*d)/r+"px",this.element.style.height=(s.bottom-s.top)/n+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout((()=>this.setCursor(null)),e)}dragover(e){var t;if(!this.editorView.editable)return;let s=this.getDropPosition(e,this.editorView);const i=null===(t=e.srcElement)||void 0===t?void 0:t.closest('[data-drop="false"]');if(null===s||i)this.setCursor(null);else{if(this.editorView.dragging&&this.editorView.dragging.slice){const e=(0,Be.nj)(this.editorView.state.doc,s,this.editorView.dragging.slice);null!==e&&(s=e)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){e.target!==this.editorView.dom&&this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const Ue=["paragraph"],Fe=["left","center","right"],Ve="left",He=Ce.hj.create({name:"textAlign",addGlobalAttributes:()=>[{types:Ue,attributes:{textAlign:{default:Ve,parseHTML:e=>e.style.textAlign||Ve,renderHTML:e=>e.textAlign===Ve?{}:{style:`text-align: ${e.textAlign}`}}}}],addCommands(){return{setTextAlign:e=>({commands:t})=>!!Fe.includes(e)&&Ue.every((s=>t.updateAttributes(s,{textAlign:e}))),unsetTextAlign:()=>({commands:e})=>Ue.every((t=>e.resetAttributes(t,this.name)))}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right")}}}),Ze=new Set;function ze(){const e=(Date.now()/1e3).toFixed();let t,s=0;do{t=`${e}${s.toString().padStart(2,"0")}`,s++}while(Ze.has(t));return Ze.add(t),t}function qe(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function We(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(s),!0).forEach((function(t){Ge(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):qe(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Ge(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Ye=["paragraph","blockquote","bulletList","embedVideo","embedVideoLoader","headingFirst","headingSecond","image","orderedList","video","videoLoader","imagesCarousel","poll","fundraising","separator","highlight","update"],Ke=new Set(Ye),Xe=Ce.hj.create({name:"id",addGlobalAttributes:()=>[{types:Ye,attributes:{id:{default:null,rendered:!1,keepOnSplit:!1}}}],addProseMirrorPlugins:()=>[new Ne.Sy({key:new Ne.H$("id"),appendTransaction:(e,t,s)=>{if(s.doc===t.doc)return;const i=s.tr;let o=!1;const r=new Set;return s.doc.descendants(((e,t,n)=>{if(e.isBlock&&n===s.doc&&Ke.has(e.type.name)){const s=e.attrs.id;s&&!r.has(s)?r.add(s):(i.setNodeMarkup(t,void 0,We(We({},e.attrs),{},{id:ze()})),o=!0)}})),o?i:null}})]});var Je=s(99667);const Qe=Ce.hj.create({name:"trailingNode",addProseMirrorPlugins(){const e=this.editor.schema.nodes[Je.Z.name];return[new Ne.Sy({key:new Ne.H$(this.name),appendTransaction:(t,s,i)=>{const{doc:o,tr:r}=i,n=i.doc.lastChild;if(!n)return;if(!et(n))return r.insert(o.content.size,e.create());const a=i.doc.maybeChild(i.doc.childCount-2),l=s.doc.maybeChild(s.doc.childCount-2);return a&&et(a)&&a!==l&&n===s.doc.lastChild&&i.doc.childCount-s.doc.childCount==1?r.delete(o.content.size-n.nodeSize,o.content.size):void 0}})]}});function et(e){return e.type.name===Je.Z.name&&!e.textContent&&!e.content.size}const tt=Ce.hj.create({name:"imageCaptionPaste",addProseMirrorPlugins(){return[new Ne.Sy({key:new Ne.H$(this.name),props:{handlePaste:(e,t,s)=>{const i=e.state.selection;if(i.$from.parent===i.$to.parent&&Re.has(i.$from.parent.type.name)){let e="";return s.content.forEach((t=>{e+=t.textContent})),e?(this.editor.commands.insertContent(e),!0):!0}}}})]}});s(83753);const st=new Set(["highlight","blockquote"]),it=Ce.hj.create({name:"blankLineAtStartRemover",addProseMirrorPlugins(){return[new Ne.Sy({key:new Ne.H$(this.name),appendTransaction:(e,t,s)=>{var i,o,r;if(s.doc===t.doc||e.length<2)return;const n=e[0],a=null===(i=n.steps[0])||void 0===i?void 0:i.toJSON();if(!a||"replaceAround"!==a.stepType||!st.has(null===(o=a.slice)||void 0===o||null===(r=o.content[0])||void 0===r?void 0:r.type))return;if(e.find((e=>e.getMeta("appendedTransaction")===n)))try{var l,c;const e=this.editor.state.doc.nodeAt(a.to);if(!e)return;if(""===e.textContent)return s.tr.delete(a.to,a.to+e.nodeSize);if("hardBreak"===(null===(l=e.toJSON())||void 0===l||null===(c=l.content[0])||void 0===c?void 0:c.type))return s.tr.delete(a.to,a.to+2)}catch(d){console.error(d)}}})]}}),ot=l.core.config("modules.story-editor.MAX_IMAGE_TITLE_LENGTH"),rt=new Set(["image","imagesCarousel"]),nt=Ce.hj.create({name:"limitNodeLength",addProseMirrorPlugins:()=>[new Ne.Sy({key:new Ne.H$("limitNodeLength"),filterTransaction:e=>{if(!e.docChanged)return!0;const t=e.selection.$head.node(1);if(!t)return!0;if(!rt.has(t.type.name))return!0;const s=t.textContent.length;if(s<=ot)return!0;const i=e.getMeta("paste"),o="drop"===e.getMeta("uiEvent");if(i||o){const t=e.selection.$head.pos,i=s-ot;return e.deleteRange(t-i,t),!0}return!1}})]}),at=Ce.hj.create({name:"imageCaptionHandler",addKeyboardShortcuts:()=>({Enter:({editor:e})=>{const t=e.state.selection;return!(t.$from.parent!==t.$to.parent||!Re.has(t.$from.parent.type.name))&&e.commands.command((({state:e,dispatch:t})=>{const s=e.tr.deleteSelection().split(e.selection.from,1,[{type:e.schema.nodes.paragraph}]).scrollIntoView();return null==t||t(s),!0}))},Delete:({editor:e})=>{const t=e.state.selection;if(!t.empty)return!1;const s=(e=>{if(e.nodeAfter)return{node:e.nodeAfter,pos:e.after()};for(let t=e.depth;t>=1;t--){const s=e.after(t),i=e.doc.nodeAt(s);if(i)return{node:i,pos:s}}return null})(t.$to);if(s&&!t.$from.nodeAfter&&!t.$from.nodeBefore&&Re.has(t.$from.parent.type.name)){if(["headingFirst","headingSecond","paragraph"].includes(s.node.type.name))return e.commands.command((({tr:e,dispatch:s})=>(e.join(t.from+1),null==s||s(e),!0)));{let t=-1;s.node.descendants(((e,s)=>{if("text"===e.type.name&&(t=s),-1!==t)return!1}));return!!(-1!==t&&e.commands.command((({state:e,dispatch:i})=>{const o=e.doc.resolve(s.pos+t+1),r=o.blockRange(o),n=r&&(0,Be.k9)(r);return!(!r||null===n)&&(null==i||i(e.tr.lift(r,n).scrollIntoView()),!0)})))||e.commands.deleteRange({from:s.pos,to:s.pos+s.node.nodeSize})}}return!1},Backspace:({editor:e})=>{var t,s;const i=e.state.selection;return i.empty&&0===i.$from.parentOffset&&Re.has(i.$from.parent.type.name)?e.commands.setNodeSelection(i.from-1):!!(i.empty&&0===i.$from.parentOffset&&i.$from.parent.isTextblock&&Re.has(null!==(t=null===(s=e.state.doc.resolve(i.from-1).nodeBefore)||void 0===s?void 0:s.type.name)&&void 0!==t?t:""))&&e.commands.command((({tr:e,dispatch:t})=>(e.join(i.from-1),null==t||t(e),!0)))}})});function lt(e){const{doc:t,selection:s}=e.state;let i=-1;t.nodesBetween(s.$head.after(1),t.content.size,((e,t)=>("paragraph"===e.type.name&&-1===i&&(i=t),!1))),i>=0&&setTimeout((()=>{e.commands.focus(i+1,{scrollIntoView:!1})}))}const ct=Ce.hj.create({name:"dropHandler",addOptions:()=>({getDropPosition:(e,t)=>{var s,i;return null!==(s=null===(i=t.posAtCoords({left:e.clientX,top:e.clientY}))||void 0===i?void 0:i.pos)&&void 0!==s?s:null}}),addProseMirrorPlugins(){const e=e=>(e.stopPropagation(),e.preventDefault()),t=t=>{var s,i;if(!this.editor.view.editable)return!1;const o=(0,O.u1)(Array.from(null!==(s=null===(i=t.dataTransfer)||void 0===i?void 0:i.files)&&void 0!==s?s:[])).map((({file:e,type:t})=>"image"===t?{type:"image",attrs:{source:e}}:"video"===t?{type:"videoLoader",attrs:{source:e}}:void 0)).filter(Boolean);if(!o.length)return!1;e(t);const r=this.options.getDropPosition(t,this.editor.view);return null!==r&&(this.editor.chain().insertContentAt(r,o).focus().run(),lt(this.editor)),!0};return[new Ne.Sy({key:new Ne.H$(this.name),props:{handleDrop:(e,s)=>t(s)},view:()=>(window.addEventListener("dragover",e),window.addEventListener("drop",t),{destroy:()=>{window.removeEventListener("dragover",e),window.removeEventListener("drop",t)}})})]}}),dt=Ce.hj.create({name:"draggingNodePreview",addOptions:()=>({draggingContainerClass:"dragging-node-preview"}),addProseMirrorPlugins(){const e=new Image;e.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";const t=t=>{var s,i,o;if(null===(s=t.target)||void 0===s||null===(i=s.closest)||void 0===i||!i.call(s,"[data-drag-handle]"))return;null===(o=t.dataTransfer)||void 0===o||o.setDragImage(e,0,0);const r=t.target.closest("[data-node-view-wrapper]"),n=r.getBoundingClientRect(),a=t.x-n.x,l=t.y-n.y,c=e=>{0===e.x&&0===e.y||(d.style.transform=`translate(${e.x-a}px, ${e.y-l}px)`)},d=document.createElement("div");d.classList.add(this.options.draggingContainerClass),d.append(r.cloneNode(!0)),d.style.width=`${n.width}px`,c(t),document.body.appendChild(d),document.addEventListener("dragover",c,{capture:!0}),r.addEventListener("dragend",(()=>{document.removeEventListener("dragover",c,{capture:!0}),d.remove()}),{once:!0})};return[new Ne.Sy({key:new Ne.H$(this.name),view:()=>(this.editor.view.dom.addEventListener("dragstart",t),{destroy:()=>{this.editor.view.dom.removeEventListener("dragstart",t)}})})]}}),ut=Ce.NB.create({name:"doc",topNode:!0,content:"block+"});var pt=s(76841);const ht=(0,o.aZ)({__name:"node-heading-first-view",props:Ee.Un,setup(e){const t=e;return(e,s)=>((0,o.wg)(),(0,o.j4)(pt.Z,(0,n.vs)((0,o.F4)(t)),{default:(0,o.w5)((()=>[(0,o.Wm)((0,a.SU)(Ee.ms),{as:"h2",class:(0,n.C_)(e.$style.host)},null,8,["class"])])),_:1},16))}});var _t=s(8524),mt=s.n(_t);const gt={};gt.$style=mt();const vt=(0,b.Z)(ht,[["__cssModules",gt]]),ft=Ce.NB.create({name:"headingFirst",group:"block",content:"inline*",marks:"",draggable:!0,selectable:!1,defining:!0,parseHTML:()=>[{tag:"h2"}],renderHTML:({HTMLAttributes:e})=>["h2",e,0],addNodeView:()=>(0,Ee.uf)(vt),addCommands(){return{toggleHeadingFirst:e=>({commands:t})=>t.pkbToggleNode({nodeName:this.name,force:e,disablingNodeNames:["highlight","blockquote","orderedList","bulletList"]})}},addKeyboardShortcuts(){return{"Mod-Alt-1":()=>this.editor.commands.toggleHeadingFirst()}}}),yt=(0,o.aZ)({__name:"node-heading-second-view",props:Ee.Un,setup(e){const t=e;return(e,s)=>((0,o.wg)(),(0,o.j4)(pt.Z,(0,n.vs)((0,o.F4)(t)),{default:(0,o.w5)((()=>[(0,o.Wm)((0,a.SU)(Ee.ms),{as:"h3",class:(0,n.C_)(e.$style.host)},null,8,["class"])])),_:1},16))}});var bt=s(86996),wt=s.n(bt);const kt={};kt.$style=wt();const St=(0,b.Z)(yt,[["__cssModules",kt]]),Ot=Ce.NB.create({name:"headingSecond",group:"block",content:"inline*",marks:"",draggable:!0,selectable:!1,defining:!0,parseHTML:()=>[{tag:"h3"}],renderHTML:({HTMLAttributes:e})=>["h3",e,0],addNodeView:()=>(0,Ee.uf)(St),addCommands(){return{toggleHeadingSecond:e=>({commands:t})=>t.pkbToggleNode({nodeName:this.name,force:e,disablingNodeNames:["highlight","blockquote","orderedList","bulletList"]})}},addKeyboardShortcuts(){return{"Mod-Alt-2":()=>this.editor.commands.toggleHeadingSecond()}}});s(60285),s(41637);var Et=s(89661),Ct=s(32881),xt=s(12665);const Tt=(0,o.aZ)({__name:"pkb-progress-overlay",props:{size:{default:32},progress:{default:.25},fullscreen:{type:Boolean}},setup(e){const t=e;return(0,xt.XW)((()=>t.fullscreen)),(e,s)=>((0,o.wg)(),(0,o.iD)("div",{class:(0,n.C_)({[e.$style.host]:!0,[e.$style.host_fullscreen]:t.fullscreen})},[(0,o.Wm)(Ct.Z),(0,o.Wm)(Et.Z,{size:t.size,progress:t.progress},null,8,["size","progress"])],2))}});var It=s(29246),Pt=s.n(It);const At={};At.$style=Pt();const Dt=(0,b.Z)(Tt,[["__cssModules",At]]),Mt=["src"],Rt=(0,o.aZ)({__name:"node-image-loader-view",props:{source:{},progress:{default:0}},setup(e){const t=e,s=(0,a.iH)();return(0,o.m0)((()=>{URL.revokeObjectURL(s.value),s.value="string"==typeof t.source?t.source:URL.createObjectURL(t.source)})),(0,o.Ah)((()=>URL.revokeObjectURL(s.value))),(e,i)=>((0,o.wg)(),(0,o.iD)("div",{class:(0,n.C_)(e.$style.host)},[(0,o._)("img",{class:(0,n.C_)(e.$style.image),src:s.value,alt:""},null,10,Mt),(0,o.Wm)(Dt,{progress:t.progress},null,8,["progress"])],2))}});var Nt=s(47567),Bt=s.n(Nt);const Lt={};Lt.$style=Bt();const jt=(0,b.Z)(Rt,[["__cssModules",Lt]]),$t=(0,o.aZ)({__name:"node-image-caption-view",props:{placeholder:{},editor:{},node:{},decorations:{},selected:{type:Boolean},extension:{},getPos:{type:Function},updateAttributes:{type:Function},deleteNode:{type:Function}},setup(e){const t=e,s=Ir(),i=(0,o.Fl)((()=>t.node.textContent.length)),r=(0,o.Fl)((()=>s.MAX_IMAGE_TITLE_LENGTH-i.value));return(e,s)=>((0,o.wg)(),(0,o.iD)("div",{class:(0,n.C_)(e.$style.host)},[i.value?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,n.C_)(e.$style.placeholder),contenteditable:"false"},(0,n.zw)(t.placeholder),3)),(0,o.WI)(e.$slots,"default"),r.value<=20?((0,o.wg)(),(0,o.iD)("div",{key:1,class:(0,n.C_)(e.$style.counter)},(0,n.zw)(r.value),3)):(0,o.kq)("v-if",!0)],2))}});var Ut=s(98871),Ft=s.n(Ut);const Vt={};Vt.$style=Ft();const Ht=(0,b.Z)($t,[["__cssModules",Vt]]),Zt=["width","viewBox"],zt=["src"],qt=(0,o.uE)('<div class="player__play"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--player__play"><use xlink:href="#icon--player__play"></use></svg></div><div class="player__state" data-type="loading"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__progress-circle icon--ui__progress-circle_player"><use xlink:href="#icon--ui__progress-circle"></use></svg></div><div class="player__state player__state_show" type="unstarted"> GIF </div>',3),Wt=(0,o.aZ)({__name:"pkb-player-gif",props:{source:{},thumb:{},width:{},height:{}},setup(e){const t=e;return(e,s)=>s[0]||((0,o.qZ)(-1),s[0]=(0,o._)("div",{ref:e=>function(e){if(e)return new h.f7({el:e,dimensionMode:h.mW.STORY,playAfterInitialization:!1})}(e),class:"player","data-type":"gifx","data-probe":"true","data-width":t.width,"data-height":t.height,"data-source":t.source},[((0,o.wg)(),(0,o.iD)("svg",{class:"player__svg-stretch","aria-hidden":"true",width:t.width,height:"100%",viewBox:`0 0 ${t.width} ${t.height}`},null,8,Zt)),(0,o._)("img",{class:"player__preview",src:t.thumb,alt:""},null,8,zt),qt],8,["data-width","data-height","data-source"]),(0,o.qZ)(1),s[0])}});var Gt=s(34828),Yt=s(96101);const Kt=(0,o.aZ)({__name:"pkb-pop-up-btn",props:{icon:{default:void 0},active:{type:Boolean},disabled:{type:Boolean}},setup:e=>(e,t)=>((0,o.wg)(),(0,o.iD)("button",{class:(0,n.C_)([e.$style.host,{[e.$style.host_active]:e.active}])},[e.icon?((0,o.wg)(),(0,o.j4)(d.Z,{key:0,class:(0,n.C_)(e.$style.icon),name:e.icon,size:16},null,8,["class","name"])):(0,o.kq)("v-if",!0)],2))});var Xt=s(4264),Jt=s.n(Xt);const Qt={};Qt.$style=Jt();const es=(0,b.Z)(Kt,[["__cssModules",Qt]]);function ts(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function ss(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ts(Object(s),!0).forEach((function(t){is(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ts(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function is(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const os=(0,o.aZ)(ss(ss({},{inheritAttrs:!1}),{},{__name:"pkb-fullscreen-popup",props:{active:{type:Boolean},inline:{type:Boolean}},emits:["update:active","close","open"],setup(e,{emit:t}){const s=e,i=t;function r(){i("update:active",!1),i("close")}return(0,xt.XW)((()=>s.active)),(e,t)=>((0,o.wg)(),(0,o.j4)(o.lR,{to:"body",disabled:s.inline},[s.active?((0,o.wg)(),(0,o.iD)("div",(0,o.dG)({key:0},e.$attrs,{class:e.$style.host}),[(0,o._)("div",{class:(0,n.C_)(e.$style.content)},[(0,o.WI)(e.$slots,"default"),(0,o.Wm)(es,{class:(0,n.C_)(e.$style.closeButton),icon:"close_16",onClick:r},null,8,["class"])],2)],16)):(0,o.kq)("v-if",!0)],8,["disabled"]))}}));var rs=s(75182),ns=s.n(rs);const as={};as.$style=ns();const ls=(0,b.Z)(os,[["__cssModules",as]]);function cs(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function ds(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?cs(Object(s),!0).forEach((function(t){us(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):cs(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function us(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const ps=["src"],hs=["disabled"],_s=(0,o.aZ)({__name:"image-editor-view",props:{active:{type:Boolean},src:{}},emits:["update:active","cropped"],setup(e,{emit:t}){const i=(0,Q.D3)(B.A1),r=e,u=t,p=(0,a.iH)(),h=(0,a.iH)();let _;const m=(0,a.iH)(!1),v=(0,a.iH)(!1),f={width:0,height:0,top:0,left:0};let y=0,b=0;const w=(0,a.iH)(!1);function k(e){const{height:t,width:s}=_.getContainerData(),i=f.width,o=f.height;(Math.floor(e.detail.ratio*i/s)>=y||Math.floor(e.detail.ratio*o/t)>=b)&&e.preventDefault()}function S(e){const{width:t,height:s}=e.detail;0!==t&&0!==s&&(t<32||s<32)&&requestAnimationFrame((()=>{_.setData(ds(ds({},e.detail),{},{width:t<32?32:t,height:s<32?32:s}))}))}const{width:O}=(0,c.iPe)();function E(){u("update:active",!1),m.value=!1,i.sendEvent("click",{button:"edit_image_close"})}function C(){m.value&&(i.sendEvent("click",{button:"edit_image_crop"}),v.value=!v.value)}function x(){m.value&&(i.sendEvent("click",{button:"edit_image_crop"}),_.rotate(90),w.value=!0)}async function T(){m.value&&(i.sendEvent("click",{button:"edit_image_undo"}),w.value=!1,v.value=!1,_.reset(),f.width<_.getContainerData().width&&(await(0,o.Y3)(),_.setCanvasData(f)))}function I(){m.value&&(i.sendEvent("click",{button:"edit_image_apply"}),_.getCroppedCanvas().toBlob((e=>{e?u("cropped",new File([e],e.type)):(E(),l.core.ui.toasts.showError("Ошибка! Не удалось отредактировать изображение"))})))}return(0,c.ORN)(h,"touchstart",(e=>{const{pageX:t}=e;(t>20||t>=O.value-20)&&e.preventDefault()})),(0,xt.R8)(p,{onMounted(){s.e(341).then(s.t.bind(s,33129,23)).then((({default:e})=>{_=new e(p.value,{dragMode:"move",viewMode:1,autoCropArea:1,restore:!0,responsive:!0,guides:!0,center:!0,highlight:!1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!1,ready:()=>m.value=!0,zoom:k,crop:S})}))},onUnmounted(){m.value&&(_.destroy(),m.value=!1,v.value=!1)}}),(0,o.YP)(v,(e=>{if(e){const e=_.getCanvasData();_.crop(),_.setCropBoxData({top:e.top>=0?e.top:0,width:e.width,height:e.height}),w.value=!0}else _.clear()})),(0,o.YP)(m,(e=>{if(!e)return;_.clear();const{naturalHeight:t,naturalWidth:s}=_.getCanvasData(),i=_.getContainerData();f.width=s,f.height=t,f.top=Math.floor(i.height/2-t/2),f.left=Math.floor(i.width/2-s/2),y=Math.floor(s/32),b=Math.floor(t/32),s<i.width&&_.setCanvasData(f)})),(e,t)=>{const s=(0,o.Q2)("tooltip");return(0,o.wg)(),(0,o.j4)(ls,{active:r.active,onClose:E},{default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,n.C_)(e.$style.host)},[(0,o._)("div",{ref_key:"imageContainerEl",ref:h,class:(0,n.C_)(e.$style.imageContainer)},[m.value?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.j4)(Et.Z,{key:0,class:(0,n.C_)(e.$style.loader),size:32,color:"white"},null,8,["class"])),(0,o._)("img",{ref_key:"imageRef",ref:p,class:(0,n.C_)(e.$style.image),src:r.src},null,10,ps)],2),(0,o._)("div",{class:(0,n.C_)(e.$style.controls)},[(0,o.wy)(((0,o.wg)(),(0,o.iD)("button",{class:(0,n.C_)([e.$style.controlBtn,{[e.$style.controlBtn_active]:v.value}]),onClick:C},[(0,o.Wm)(d.Z,{name:"crop_24",class:(0,n.C_)(e.$style.icon),size:32},null,8,["class"])],2)),[[s,"Обрезать"]]),(0,o.wy)(((0,o.wg)(),(0,o.iD)("button",{class:(0,n.C_)(e.$style.controlBtn),onClick:x},[(0,o.Wm)(d.Z,{name:"turn_24",class:(0,n.C_)(e.$style.icon),size:32},null,8,["class"])],2)),[[s,"Повернуть"]]),(0,o._)("button",{class:(0,n.C_)([e.$style.controlBtn,e.$style.controlBtn_reset]),disabled:!w.value,onClick:T}," Сброс ",10,hs),e.IS_MOBILE?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.j4)(g.Z,{key:0,class:(0,n.C_)(e.$style.apply),disabled:!w.value,label:"Применить",onClick:I},null,8,["class","disabled"]))],2),e.IS_MOBILE?((0,o.wg)(),(0,o.j4)(g.Z,{key:0,class:(0,n.C_)(e.$style.apply),disabled:!w.value,label:"Применить",wide:"",onClick:I},null,8,["class","disabled"])):(0,o.kq)("v-if",!0)],2)])),_:1},8,["active"])}}});var ms=s(93230),gs=s.n(ms);const vs={};vs.$style=gs();const fs=(0,b.Z)(_s,[["__cssModules",vs]]);var ys=s(44813);const bs=["src","width","height"],ws="Возникла ошибка при загрузке изображения",ks=(0,o.aZ)({__name:"node-image-view",props:{editor:{},node:{},decorations:{},selected:{type:Boolean},extension:{},getPos:{type:Function},updateAttributes:{type:Function},deleteNode:{type:Function}},setup(e){const t=e,s=(0,Q.D3)(B.A1),i=(0,a.iH)(),c=(0,a.iH)(!1),d=(0,a.iH)(!1),u=(0,a.iH)(!1);let p;const h=(0,o.Fl)((()=>!t.node.attrs.source));function _(){var e;null===(e=p)||void 0===e||e.abort(),v()}function m(){s.sendEvent("click",{button:"edit_image",component_name:"editor_image"}),d.value=!0,t.editor.commands.blur()}function g(e){t.updateAttributes({source:e,thumb:void 0,src:void 0,largeSrc:void 0,isAnimated:void 0,width:void 0,height:void 0}),d.value=!1}function v(){void 0!==t.getPos()&&t.deleteNode()}function f(){t.editor.commands.setNodeSelection(t.getPos())}return(0,o.YP)(h,(async()=>{if(!h.value)try{await async function(){var e,s,o,r,n,a,l,c;const d=t.node.attrs.source;p=new AbortController;const{response:u,data:h}=await("string"==typeof d?(0,ys.uc)(d,p.signal):(0,ys.Ix)(d,(e=>i.value=e),p.signal));if(!u.result){if(v(),u.messageCode===$.r2)return;throw new Error(u.message)}const _=null!==(e=null!==(s=h.small)&&void 0!==s?s:h.large)&&void 0!==e?e:h.preview;if(!_)throw v(),new Error(ws);if(t.editor.commands.checkImageDuplicate(_.file_url))throw v(),new Error("Изображение уже добавлено в пост");const m=t.getPos(),g={source:void 0,thumb:null!==(o=null===(r=h.preview)||void 0===r?void 0:r.file_url)&&void 0!==o?o:_.file_url,src:_.file_url,largeSrc:null!==(n=null===(a=h.large)||void 0===a?void 0:a.file_url)&&void 0!==n?n:_.file_url,isAnimated:_.is_animated_image,width:null===(l=_.image_size)||void 0===l?void 0:l[0],height:null===(c=_.image_size)||void 0===c?void 0:c[1]};t.editor.chain().command((({tr:e})=>(Object.entries(g).forEach((([t,s])=>{e.step(new Be.Cj(m,t,s))})),e.setMeta("addToHistory",!1),!0))).run()}()}catch(e){l.core.ui.toasts.showError(e.message||ws)}}),{immediate:!0}),(0,o.Ah)((()=>{var e;return null===(e=p)||void 0===e?void 0:e.abort()})),(e,s)=>{const l=(0,o.Q2)("tooltip");return(0,o.wg)(),(0,o.j4)(pt.Z,(0,o.dG)(t,{"content-class":e.$style.wrapper}),{default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,n.C_)({[e.$style.host]:!0,[e.$style.host_selected]:t.selected})},[(0,o._)("figure",{class:(0,n.C_)([e.$style.figure,{[e.$style.figure_focused]:c.value}]),contenteditable:"false",onClick:f},[h.value?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[t.node.attrs.isAnimated?((0,o.wg)(),(0,o.j4)(Wt,{key:0,source:t.node.attrs.src,thumb:t.node.attrs.thumb,width:t.node.attrs.width,height:t.node.attrs.height},null,8,["source","thumb","width","height"])):((0,o.wg)(),(0,o.iD)("img",{key:1,class:(0,n.C_)(e.$style.image),src:t.node.attrs.thumb||t.node.attrs.src,width:t.node.attrs.width,height:t.node.attrs.height,alt:""},null,10,bs))],64)):((0,o.wg)(),(0,o.j4)(jt,{key:1,source:t.node.attrs.source,progress:i.value},null,8,["source","progress"])),t.editor.isEditable?((0,o.wg)(),(0,o.iD)("div",{key:2,class:(0,n.C_)([e.$style.controls,{[e.$style.controls_row]:h.value&&t.node.attrs.height<=80}])},[h.value&&!t.node.attrs.isAnimated?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.wy)((0,o.Wm)(Yt.Z,{icon:"edit_16",theme:"media",onClick:m},null,512),[[l,"Редактировать"]]),(0,o.Wm)(fs,{active:d.value,"onUpdate:active":s[0]||(s[0]=e=>d.value=e),src:t.node.attrs.largeSrc||t.node.attrs.src,onCropped:g},null,8,["active","src"])],64)):(0,o.kq)("v-if",!0),(0,o.wy)((0,o.Wm)(Yt.Z,{icon:"delete_16",theme:"media",onClick:s[1]||(s[1]=(0,r.iM)((e=>u.value=!0),["prevent"])),onTouchend:s[2]||(s[2]=(0,r.iM)((e=>u.value=!0),["prevent"]))},null,512),[[l,"Удалить"]])],2)):(0,o.kq)("v-if",!0)],2),(0,o.Wm)(Ht,(0,o.dG)(t,{placeholder:"Введите описание к изображению (не обязательно)"}),{default:(0,o.w5)((()=>[(0,o.Wm)((0,a.SU)(Ee.ms))])),_:1},16),(0,o.Wm)(Gt.Z,{active:u.value,"onUpdate:active":s[3]||(s[3]=e=>u.value=e),title:"Удалить изображение",content:"Вы действительно хотите удалить изображение?",onConfirm:_},null,8,["active"])],2)])),_:1},16,["content-class"])}}});var Ss=s(58944),Os=s.n(Ss);const Es={};Es.$style=Os();const Cs=(0,b.Z)(ks,[["__cssModules",Es]]),xs=Ce.NB.create({name:"image",group:"block",content:"text*",isolating:!1,draggable:!0,marks:"link",addAttributes:()=>({source:{parseHTML:e=>e.getAttribute("src")},thumb:{},src:{},largeSrc:{},isAnimated:{},width:{},height:{}}),parseHTML:()=>[{tag:"figure",contentElement:e=>{var t;return null!==(t=e.querySelector("figcaption"))&&void 0!==t?t:document.createElement("figcaption")},getAttrs:e=>{const t=e.querySelector("img");return!!t&&{source:t.src}}}],renderHTML:({HTMLAttributes:e})=>["figure",["img",e],["figcaption",0]],addNodeView:()=>(0,Ee.uf)(Cs)}),Ts=(0,o.aZ)({__name:"pkb-player",props:{source:{},thumb:{},duration:{},width:{},height:{},isMuted:{type:Boolean},start:{default:0},end:{default:0},isAdsDisabled:{type:Boolean},isPause:{type:Boolean}},setup(e){const t=e,s=(0,a.iH)();let i;function r(){var e;null===(e=i)||void 0===e||e.destroy(),s.value&&(s.value.innerHTML=`\n\t\t<div\n\t\t\tclass="player"\n\t\t\tdata-type="video-file"\n\t\t\tdata-ratio="${t.width/t.height}"\n\t\t\tdata-duration="${t.duration}"\n\t\t\tdata-source="${t.source}"\n\t\t\tdata-muted="${t.isMuted?"true":"false"}"\n\t\t\tdata-cut="${t.start},${t.end}"\n\t\t\tdata-da="${t.isAdsDisabled?1:0}"\n\t\t>\n\t\t\t\t<svg\n\t\t\t\t\tclass="player__svg-stretch"\n\t\t\t\t\taria-hidden="true"\n\t\t\t\t\tpreserveAspectRatio="xMinYMax meet"\n\t\t\t\t\twidth="${t.width}"\n\t\t\t\t\theight="100%"\n\t\t\t\t\tviewBox="0 0 ${t.width} ${t.height}"\n\t\t\t\t></svg>\n\t\t\t\t<div class="player__play">\n\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--player__play">\n\t\t\t\t\t\t<use xlink:href="#icon--player__play" />\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t\t<div class="player__preview" style="background-image: url('${t.thumb}')"></div>\n\t\t\t\t<div class="player__state" data-type="loading">\n\t\t\t\t\t<svg\n\t\t\t\t\t\txmlns="http://www.w3.org/2000/svg"\n\t\t\t\t\t\tclass="icon icon--ui__progress-circle icon--ui__progress-circle_player"\n\t\t\t\t\t>\n\t\t\t\t\t\t<use xlink:href="#icon--ui__progress-circle" />\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t</div>\n\t`,i=new h.FW({el:s.value.firstElementChild,dimensionMode:h.mW.STORY,context:{isPreview:!0}}))}return(0,o.YP)(t,r),(0,o.bv)(r),(e,t)=>t[0]||((0,o.qZ)(-1),t[0]=(0,o._)("div",{ref_key:"hostEl",ref:s},null,512),(0,o.qZ)(1),t[0])}});var Is=s(35653),Ps=s(51795),As=s(47344),Ds=s(48090);const Ms=(0,o.aZ)({__name:"pkb-video-editor-timeline",props:{modelValue:{},duration:{},cutFrom:{},cutTo:{}},emits:["update:modelValue","update:cutFrom","update:cutTo"],setup(e,{emit:t}){const s=e,i=t,r=(0,a.iH)(),l=(0,a.iH)(),u=(0,a.iH)(),p=(0,a.iH)(s.modelValue),{x:h,elementWidth:_,elementPositionX:m,elementPositionY:g,isOutside:v}=(0,c.jYR)(r),f=(0,o.Fl)((()=>{if(h.value<m.value)return m.value;const e=m.value+_.value;return h.value>e?e:h.value})),y=(0,o.Fl)((()=>{const e=(f.value-m.value)/_.value;return Number((e*s.duration).toFixed(6))})),b=(0,o.Fl)((()=>`${x(y.value)} (${x(s.cutTo-s.cutFrom)})`)),{isDragging:w}=(0,c.O1d)(r,{onStart:()=>E(),onMove:()=>E(!0),onEnd:()=>E()}),{isDragging:k}=(0,c.O1d)(l,{onStart:()=>i("update:cutFrom",y.value),onMove:()=>i("update:cutFrom",y.value),onEnd:()=>i("update:cutFrom",y.value)}),{isDragging:S}=(0,c.O1d)(u,{onStart:()=>i("update:cutTo",y.value),onMove:()=>i("update:cutTo",y.value),onEnd:()=>i("update:cutTo",y.value)}),O=(0,o.Fl)((()=>!v.value||w.value||k.value||S.value));function E(e=!1){p.value=y.value,e||i("update:modelValue",p.value)}function C(e){const t=e/s.duration;return t?100*t+"%":"0"}function x(e){return[Math.floor(e/60),Math.floor(e)%60].map((e=>String(e).padStart(2,"0"))).join(":")}return(0,o.YP)((()=>s.modelValue),(e=>{w.value||(p.value=e)})),(e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:(0,n.C_)(e.$style.host),style:(0,n.j5)({"--progress":C(p.value)})},[(0,o._)("div",{ref_key:"barEl",ref:r,class:(0,n.C_)(e.$style.bar)},null,2),(0,o._)("div",{class:(0,n.C_)(e.$style.progress)},null,2),(0,o._)("div",{class:(0,n.C_)(e.$style.thumb)},null,2),(0,o._)("div",{ref_key:"startHandleEl",ref:l,class:(0,n.C_)([e.$style.crop,e.$style.crop_start]),style:(0,n.j5)({"--progress":C(s.cutFrom)})},[(0,o.Wm)(d.Z,{name:"crop_16",size:8})],6),(0,o._)("div",{ref_key:"endHandleEl",ref:u,class:(0,n.C_)([e.$style.crop,e.$style.crop_end]),style:(0,n.j5)({"--progress":C(s.cutTo)})},[(0,o.Wm)(d.Z,{name:"crop_16",size:8})],6),((0,o.wg)(),(0,o.j4)(o.lR,{to:"body"},[O.value?((0,o.wg)(),(0,o.j4)(Ds.Z,{key:0,class:(0,n.C_)(e.$style.hint),x:f.value,y:(0,a.SU)(g)},{default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,n.C_)(e.$style.hintContent)},(0,n.zw)(b.value),3)])),_:1},8,["class","x","y"])):(0,o.kq)("v-if",!0)]))],6))}});var Rs=s(29644),Ns=s.n(Rs);const Bs={};Bs.$style=Ns();const Ls=(0,b.Z)(Ms,[["__cssModules",Bs]]),js=["poster"],$s=(0,o.aZ)({__name:"pkb-video-editor",props:{source:{},cutFrom:{},cutTo:{},isMuted:{type:Boolean},hasAudio:{type:Boolean}},emits:["click:close","cut"],setup(e,{emit:t}){const s=Ir(),i=s.LIMIT_INPUT_MIN_DURATION,r=s.LIMIT_OUTPUT_MAX_DURATION,l=e,u=t;(0,xt.XW)();const p=(0,a.iH)(),_=(0,a.iH)(!1),{volume:m,playing:v,currentTime:f,muted:y,duration:b}=(0,c.ORZ)(p,{src:{src:`${l.source}.mp4`,type:"video/mp4"}}),w=(0,a.iH)(0),k=(0,a.iH)(0),S=(0,o.Fl)({get:()=>w.value,set(e){e=Math.min(e,b.value-i),e=Math.max(e,0),w.value=e}}),O=(0,o.Fl)({get:()=>k.value,set(e){e=Math.max(e,i),e=Math.min(e,b.value),k.value=e}}),E=(0,o.Fl)((()=>_.value||y.value!==l.isMuted));(0,o.YP)([S,O],(([e,t],[s])=>{_.value=!1;const o=e!==s;t-e<i?o?O.value=e+i:S.value=t-i:t-e>r&&(o?O.value=e+r:S.value=t-r),(f.value<S.value||f.value>=O.value)&&(f.value=S.value)}),{immediate:!0}),(0,o.YP)(f,(()=>{(f.value<S.value||f.value>=O.value)&&(f.value=S.value)})),(0,o.bv)((()=>{m.value=h.FW.parseVolume(),y.value=Boolean(l.isMuted)}));const C=(0,o.YP)(b,(e=>{e&&(S.value=l.cutFrom,O.value=l.cutTo||b.value,C())}));function x(){u("cut",{cutFrom:Math.round(S.value),cutTo:Math.round(O.value),duration:O.value-S.value,isMuted:y.value}),T()}function T(){u("click:close")}return(e,t)=>((0,o.wg)(),(0,o.j4)(o.lR,{to:"body"},[(0,o._)("div",{class:(0,n.C_)(e.$style.host)},[e.IS_DESKTOP?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,n.C_)(e.$style.overlay),onClick:T},null,2)):(0,o.kq)("v-if",!0),e.IS_MOBILE?((0,o.wg)(),(0,o.j4)(Ps.Z,{key:1,class:(0,n.C_)(e.$style.header),title:"Редактировать видео",theme:"dark","onClick:close":T},null,8,["class"])):(0,o.kq)("v-if",!0),(0,o._)("div",{class:(0,n.C_)(e.$style.container)},[(0,o._)("div",{class:(0,n.C_)(e.$style.player)},[(0,o._)("video",{ref_key:"videoEl",ref:p,class:(0,n.C_)(e.$style.video),autoplay:"",crossorigin:"",playsinline:"",loop:"",preload:"auto",poster:`${l.source}.jpg`,onClick:t[0]||(t[0]=e=>v.value=!(0,a.SU)(v))},null,10,js),(0,a.SU)(v)?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,n.C_)(e.$style.play)},[(0,o.Wm)(d.Z,{name:"play-video_12",size:20})],2)),(0,a.SU)(b)?((0,o.wg)(),(0,o.iD)("div",{key:1,class:(0,n.C_)(e.$style.controls)},[e.IS_DESKTOP?((0,o.wg)(),(0,o.iD)("button",{key:0,class:(0,n.C_)(e.$style.controls__play),onClick:t[1]||(t[1]=e=>v.value=!(0,a.SU)(v))},[(0,o.Wm)(d.Z,{name:(0,a.SU)(v)?"pause-video_12":"play-video_12",size:12},null,8,["name"])],2)):(0,o.kq)("v-if",!0),(0,o.Wm)(Ls,{modelValue:(0,a.SU)(f),"onUpdate:modelValue":t[2]||(t[2]=e=>(0,a.dq)(f)?f.value=e:null),"cut-from":S.value,"onUpdate:cutFrom":t[3]||(t[3]=e=>S.value=e),"cut-to":O.value,"onUpdate:cutTo":t[4]||(t[4]=e=>O.value=e),class:(0,n.C_)(e.$style.controls__timeline),duration:(0,a.SU)(b)},null,8,["modelValue","cut-from","cut-to","class","duration"]),e.IS_DESKTOP?((0,o.wg)(),(0,o.j4)(g.Z,{key:1,class:(0,n.C_)(e.$style.controls__cut),size:"small",theme:"gray",label:"Обрезать",onClick:t[5]||(t[5]=e=>_.value=!0)},null,8,["class"])):(0,o.kq)("v-if",!0)],2)):(0,o.kq)("v-if",!0)],2),(0,o._)("div",{class:(0,n.C_)(e.$style.panel)},[l.hasAudio?((0,o.wg)(),(0,o.j4)(As.Z,{key:0,modelValue:(0,a.SU)(y),"onUpdate:modelValue":t[6]||(t[6]=e=>(0,a.dq)(y)?y.value=e:null),class:(0,n.C_)(e.$style.mute),label:e.IS_MOBILE?"Удалить звук":"Удалить звук из видео"},null,8,["modelValue","class","label"])):(0,o.kq)("v-if",!0),(0,o._)("div",{class:(0,n.C_)(e.$style.buttons)},[e.IS_MOBILE?((0,o.wg)(),(0,o.j4)(g.Z,{key:0,size:"small",theme:"gray",label:"Обрезать",onClick:t[7]||(t[7]=e=>_.value=!0)})):(0,o.kq)("v-if",!0),e.IS_DESKTOP?((0,o.wg)(),(0,o.j4)(g.Z,{key:1,label:"Сохранить",disabled:!E.value,onClick:x},null,8,["disabled"])):(0,o.kq)("v-if",!0),e.IS_DESKTOP?((0,o.wg)(),(0,o.j4)(g.Z,{key:2,label:"Отмена",theme:"gray",onClick:T})):(0,o.kq)("v-if",!0)],2)],2)],2),e.IS_MOBILE?((0,o.wg)(),(0,o.iD)("footer",{key:2,class:(0,n.C_)(e.$style.footer)},[(0,o.Wm)(g.Z,{wide:"",label:"Сохранить",disabled:!E.value,onClick:x},null,8,["disabled"])],2)):(0,o.kq)("v-if",!0)],2)]))}});var Us=s(84041),Fs=s.n(Us);const Vs={};Vs.$style=Fs();const Hs=(0,b.Z)($s,[["__cssModules",Vs]]),Zs=(0,o._)("p",null,"Измените интервал проигрывания в редактировании",-1),zs=(0,o.aZ)({__name:"node-video-view",props:Ee.Un,setup(e){const t=Ir().LIMIT_OUTPUT_MAX_DURATION,s=e,i=(0,a.iH)(),l=(0,a.iH)(),c=(0,a.iH)(!1),d=(0,a.iH)(!1),u=(0,a.iH)(!1),p=(0,a.iH)(!1);function h(){d.value=!0,s.editor.commands.blur(),s.editor.commands.setNodeSelection(s.getPos()),c.value=!0,setTimeout((()=>{d.value=!1}),1e3)}function _(e){s.updateAttributes({isMuted:e.isMuted,cutFrom:e.cutFrom,cutTo:e.cutTo,duration:e.duration}),u.value=!1}async function m(){s.editor.commands.blur(),s.editor.commands.pkbDeleteAtomNode(s.getPos())}return(0,o.bv)((()=>{s.node.attrs.duration>t&&(u.value=!0,s.updateAttributes({cutTo:t,duration:t}))})),(e,g)=>{const v=(0,o.Q2)("tooltip");return(0,o.wg)(),(0,o.j4)(pt.Z,(0,n.vs)((0,o.F4)(s)),{default:(0,o.w5)((()=>[(0,o._)("div",{ref_key:"hostEl",ref:i,class:(0,n.C_)({[e.$style.host]:!0,[e.$style.host_selected]:s.selected})},[(0,o.Wm)(Ts,{source:s.node.attrs.source,"is-muted":s.node.attrs.isMuted,thumb:s.node.attrs.thumb,duration:s.node.attrs.duration,width:s.node.attrs.width,height:s.node.attrs.height,start:s.node.attrs.cutFrom,end:s.node.attrs.cutTo,"is-ads-disabled":!0,"is-pause":d.value},null,8,["source","is-muted","thumb","duration","width","height","start","end","is-pause"]),(0,o._)("div",{class:(0,n.C_)(e.$style.controls)},[(0,o.Wm)(Is.Z,{active:u.value,for:l.value,class:(0,n.C_)(e.$style.hint),"wrapper-class":e.$style.hintWrapper,container:i.value,alignment:"start",direction:"left",theme:"red"},{default:(0,o.w5)((()=>[(0,o._)("p",null,"Видео обрезано до "+(0,n.zw)((0,a.SU)(t)/60)+" минут",1),Zs])),_:1},8,["active","for","class","wrapper-class","container"]),(0,o.wy)((0,o.Wm)(Yt.Z,{ref_key:"editButtonEl",ref:l,icon:"edit_16",theme:"media",onPointerdown:(0,r.iM)(h,["prevent"])},null,8,["onPointerdown"]),[[v,"Редактировать"]]),(0,o.wy)((0,o.Wm)(Yt.Z,{icon:"delete_16",theme:"media",onClick:g[0]||(g[0]=(0,r.iM)((e=>p.value=!0),["prevent"])),onTouchend:g[1]||(g[1]=(0,r.iM)((e=>p.value=!0),["prevent"]))},null,512),[[v,"Удалить"]])],2),(0,o.Wm)(Gt.Z,{active:p.value,"onUpdate:active":g[2]||(g[2]=e=>p.value=e),title:"Удалить видео",content:"Вы действительно хотите удалить видео?",onConfirm:m},null,8,["active"]),c.value?((0,o.wg)(),(0,o.j4)(Hs,{key:0,source:s.node.attrs.source,"cut-from":s.node.attrs.cutFrom,"cut-to":s.node.attrs.cutTo,"is-muted":s.node.attrs.isMuted,"has-audio":s.node.attrs.hasAudio,onCut:_,"onClick:close":g[3]||(g[3]=e=>c.value=!1)},null,8,["source","cut-from","cut-to","is-muted","has-audio"])):(0,o.kq)("v-if",!0)],2)])),_:1},16)}}});var qs=s(68378),Ws=s.n(qs);const Gs={};Gs.$style=Ws();const Ys=(0,b.Z)(zs,[["__cssModules",Gs]]),Ks=Ce.NB.create({name:"video",group:"block",draggable:!0,atom:!0,addAttributes:()=>({source:{},fid:{},isMuted:{},cutFrom:{},cutTo:{},thumb:{},duration:{},hasAudio:{},width:{},height:{}}),renderHTML({HTMLAttributes:e}){return[this.name,e]},addNodeView:()=>(0,Ee.uf)(Ys),addCommands(){return{replaceLoadedVideo:({pos:e,attrs:t})=>({tr:s,dispatch:i})=>{if(i){const i=this.type.createAndFill(t);if(!i)return!1;s.replaceWith(e,e+1,i),s.setMeta("addToHistory",!1)}return!0}}}}),Xs=["src",".currentTime"],Js=(0,o.aZ)({__name:"video-loader-view",props:{file:{},progress:{}},emits:["delete"],setup(e,{emit:t}){const s=e,i=t,l=(0,a.iH)(0),c=URL.createObjectURL(s.file),d=(0,o.Fl)((()=>s.progress*l.value)),u=(0,o.Fl)((()=>1===s.progress?"Подготовка видео...":(100*s.progress).toFixed()+"%"));return(0,o.Jd)((()=>{URL.revokeObjectURL(c)})),(e,t)=>{const p=(0,o.Q2)("tooltip");return(0,o.wg)(),(0,o.iD)("div",{class:(0,n.C_)(e.$style.host)},[(0,o._)("video",{ref:e=>function(e){l.value=isNaN(null==e?void 0:e.duration)?0:e.duration}(e),class:(0,n.C_)(e.$style.video),playsinline:"",src:(0,a.SU)(c),".currentTime":d.value},null,10,Xs),(0,o._)("div",{class:(0,n.C_)(e.$style.overlay)},[(0,o._)("div",{class:(0,n.C_)(e.$style.loader)},[(0,o.Wm)(Et.Z,{size:20,color:"white",progress:s.progress,spinner:1===s.progress},null,8,["progress","spinner"]),(0,o._)("span",{class:(0,n.C_)(e.$style.text)},(0,n.zw)(u.value),3)],2)],2),(0,o.wy)((0,o.Wm)(Yt.Z,{class:(0,n.C_)(e.$style.deleteBtn),icon:"delete_16",theme:"media",onClick:t[0]||(t[0]=(0,r.iM)((e=>i("delete")),["prevent"])),onTouchend:t[1]||(t[1]=(0,r.iM)((e=>i("delete")),["prevent"]))},null,8,["class"]),[[p,"Удалить"]])],2)}}});var Qs=s(18874),ei=s.n(Qs);const ti={};ti.$style=ei();const si=(0,b.Z)(Js,[["__cssModules",ti]]),ii=(0,o.aZ)({__name:"node-video-loader-view",props:Ee.Un,setup(e){const t=e,{uploadVideo:s}=(0,o.f3)(B.Nx),i=(0,a.iH)(!1),r=new AbortController,c=(0,a.iH)(0),d=(0,a.iH)(),u=(0,a.iH)();return(0,o.bv)((async()=>{d.value=!0,u.value=!0;const e=await async function(){try{const{response:e,data:i}=await s(t.node.attrs.source,(e=>c.value=e),r.signal);if(e.messageCode===$.r2)return;if(!e.result)throw new Error(e.message);return i}catch(e){const t=e instanceof Error?e.message:e;l.core.ui.toasts.showError(t||"Возникла ошибка при загрузке видео")}}();d.value=!1,u.value&&(e?t.editor.commands.replaceLoadedVideo({pos:t.getPos(),attrs:{fid:e.fid,source:e.src.url.replace(".mp4",""),isMuted:e.is_muted,cutFrom:0,cutTo:0,thumb:e.thumb,duration:e.duration,hasAudio:e.has_audio,width:e.width,height:e.height}}):t.editor.commands.pkbDeleteAtomNode(t.getPos()))})),(0,o.Ah)((()=>{u.value=!1,d.value&&r.abort()})),(e,s)=>((0,o.wg)(),(0,o.j4)(pt.Z,(0,n.vs)((0,o.F4)(t)),{default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,n.C_)(e.$style.host)},[(0,o.Wm)(si,{file:t.node.attrs.source,progress:c.value,onDelete:s[0]||(s[0]=e=>i.value=!0)},null,8,["file","progress"]),(0,o.Wm)(Gt.Z,{active:i.value,"onUpdate:active":s[1]||(s[1]=e=>i.value=e),title:"Удалить видео",content:"Вы действительно хотите удалить видео?",onConfirm:s[2]||(s[2]=e=>(0,a.SU)(r).abort())},null,8,["active"])],2)])),_:1},16))}});var oi=s(59902),ri=s.n(oi);const ni={};ni.$style=ri();const ai=(0,b.Z)(ii,[["__cssModules",ni]]),li=Ce.NB.create({name:"videoLoader",group:"block",atom:!0,addAttributes:()=>({source:{}}),renderHTML({HTMLAttributes:e}){return[this.name,e]},addNodeView:()=>(0,Ee.uf)(ai),addCommands(){return{loadVideo:e=>({tr:t,dispatch:s,state:i})=>{if(s){const s=(Array.isArray(e)?e:[e]).map((e=>this.type.createAndFill({source:e}))).filter((e=>null!==e));t.replaceWith(i.selection.anchor-1,i.selection.anchor,s),t.setSelection(Ne.Bs.create(t.doc,i.selection.anchor))}return!0}}}}),ci=(0,o._)("div",{class:"player__play"},[(0,o._)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon icon--player__play"},[(0,o._)("use",{"xlink:href":"#icon--player__play"})])],-1),di=(0,o._)("div",{class:"player__state","data-type":"loading"},[(0,o._)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon icon--ui__progress-circle icon--ui__progress-circle_player"},[(0,o._)("use",{"xlink:href":"#icon--ui__progress-circle"})])],-1),ui=(0,o.aZ)({__name:"pkb-embed-player",props:{url:{},poster:{},duration:{},ratio:{}},setup(e){const t=e,s=(0,o.Fl)((()=>100/t.ratio+"%"));return(e,i)=>i[0]||((0,o.qZ)(-1),i[0]=(0,o._)("div",{ref:e=>function(e){if(e)return new h.i$({el:e,dimensionMode:h.mW.STORY})}(e),class:"player","data-type":"video","data-probe":"true","data-ratio":t.ratio,"data-duration":t.duration,"data-source":t.url},[(0,o._)("div",{class:"player__stretch",style:(0,n.j5)({paddingBottom:s.value})},null,4),ci,(0,o._)("div",{class:"player__preview",style:(0,n.j5)({backgroundImage:`url(${t.poster})`})},null,4),di],8,["data-ratio","data-duration","data-source"]),(0,o.qZ)(1),i[0])}}),pi=(0,o.aZ)({__name:"node-embed-video-view",props:Ee.Un,setup(e){const t=e,s=(0,a.iH)(!1);async function i(){t.editor.commands.pkbDeleteAtomNode(t.getPos())}return(e,r)=>{const a=(0,o.Q2)("tooltip");return(0,o.wg)(),(0,o.j4)(pt.Z,(0,n.vs)((0,o.F4)(t)),{default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,n.C_)({[e.$style.host]:!0,[e.$style.host_selected]:t.selected})},[(0,o.Wm)(ui,{url:t.node.attrs.url,poster:t.node.attrs.poster,duration:t.node.attrs.duration,ratio:t.node.attrs.ratio},null,8,["url","poster","duration","ratio"]),(0,o._)("div",{class:(0,n.C_)(e.$style.controls)},[(0,o.wy)((0,o.Wm)(Yt.Z,{icon:"delete_16",theme:"media",onClick:r[0]||(r[0]=e=>s.value=!0)},null,512),[[a,"Удалить"]])],2),(0,o.Wm)(Gt.Z,{active:s.value,"onUpdate:active":r[1]||(r[1]=e=>s.value=e),title:"Удалить видео",content:"Вы действительно хотите удалить видео?",onConfirm:i},null,8,["active"])],2)])),_:1},16)}}});var hi=s(21418),_i=s.n(hi);const mi={};mi.$style=_i();const gi=(0,b.Z)(pi,[["__cssModules",mi]]),vi=Ce.NB.create({name:"embedVideo",group:"block",draggable:!0,atom:!0,addAttributes:()=>({url:{},poster:{},duration:{},ratio:{}}),renderHTML({HTMLAttributes:e}){return[this.name,e]},addNodeView:()=>(0,Ee.uf)(gi),addCommands(){return{replaceLoadedEmbedVideo:({pos:e,attrs:t})=>({tr:s,dispatch:i})=>{if(i){const i=this.type.createAndFill(t);if(!i)return!1;s.replaceWith(e,e+1,i),s.setMeta("addToHistory",!1)}return!0}}}}),fi=(0,o.aZ)({__name:"node-embed-video-loader-view",props:Ee.Un,setup(e){const t=e;return(0,o.bv)((()=>async function(){var e;const{response:s,data:i}=await h.tv.getVideoDetails(t.node.attrs.url);if(!s.result)return l.core.ui.toasts.showError(s.message),void t.editor.commands.pkbDeleteAtomNode(t.getPos());if("vk_shorts"===i.type)return void t.editor.commands.replaceUnsupportedVideoURL({pos:t.getPos(),url:t.node.attrs.url});if(null===(e=t.editor.getJSON().content)||void 0===e?void 0:e.some((e=>{var t;return"embedVideo"===e.type&&(null===(t=e.attrs)||void 0===t?void 0:t.url)===i.url})))return l.core.ui.toasts.showError("Видео уже добавлено в пост"),void t.editor.commands.pkbDeleteAtomNode(t.getPos());t.editor.commands.replaceLoadedEmbedVideo({pos:t.getPos(),attrs:{url:i.url,poster:i.thumb,duration:i.duration,ratio:i.ratio}})}())),(e,s)=>((0,o.wg)(),(0,o.j4)(pt.Z,(0,n.vs)((0,o.F4)(t)),{default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,n.C_)(e.$style.host)},[(0,o.Wm)(Et.Z,{size:32})],2)])),_:1},16))}});var yi=s(2420),bi=s.n(yi);const wi={};wi.$style=bi();const ki=(0,b.Z)(fi,[["__cssModules",wi]]),Si=Ce.NB.create({name:"embedVideoLoader",group:"block",atom:!0,addAttributes:()=>({url:{}}),renderHTML({HTMLAttributes:e}){return[this.name,e]},addNodeView:()=>(0,Ee.uf)(ki),addCommands(){return{loadEmbedVideo:e=>({tr:t,dispatch:s,state:i})=>{if(s){const s=(Array.isArray(e)?e:[e]).map((e=>this.type.createAndFill({url:e})));t.replaceWith(i.selection.anchor-1,i.selection.anchor,s),t.setSelection(Ne.Bs.create(t.doc,i.selection.anchor))}return!0},replaceUnsupportedVideoURL:({pos:e,url:t})=>({tr:s,dispatch:i,state:o})=>{if(i){const i=o.schema.nodes.paragraph.createAndFill(null,o.schema.text(t));if(!i)return!1;s.replaceWith(e,e+1,i),s.setSelection(Ne.Bs.create(s.doc,e+i.nodeSize-1)),s.setMeta("addToHistory",!1)}return!0}}}}),Oi=(0,o.aZ)({__name:"node-blockquote-view",props:Ee.Un,setup(e){const t=e;return(e,s)=>((0,o.wg)(),(0,o.j4)(pt.Z,(0,o.dG)(t,{"content-class":e.$style.wrapper}),{default:(0,o.w5)((()=>[(0,o.Wm)((0,a.SU)(Ee.ms),{as:"blockquote"})])),_:1},16,["content-class"]))}});var Ei=s(15929),Ci=s.n(Ei);const xi={};xi.$style=Ci();const Ti=(0,b.Z)(Oi,[["__cssModules",xi]]),Ii=Ce.NB.create({name:"blockquote",group:"block",content:"paragraph+",draggable:!0,selectable:!1,defining:!0,marks:"link bold spoiler strike italic",parseHTML:()=>[{tag:"blockquote",contentElement:e=>{var t;if("P"!==(null===(t=e.firstElementChild)||void 0===t?void 0:t.tagName)){const t=document.createElement("p");t.append(...e.childNodes),e.append(t)}return e}}],renderHTML:({HTMLAttributes:e})=>["blockquote",e,0],addNodeView:()=>(0,Ee.uf)(Ti),addCommands(){return{toggleBlockquote:()=>({commands:e,editor:t,chain:s})=>t.isActive("highlight")?(s().unsetHighlight().wrapIn(this.name),!0):e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-2":()=>this.editor.commands.toggleBlockquote()}}}),Pi=Ce.NB.create({name:"listItem",content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:'span[style*="mso-list:Ignore"]',ignore:!0},{tag:"li"}],renderHTML:({HTMLAttributes:e})=>["li",e,0],addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name),"Mod-Shift-7":()=>this.editor.commands.toggleBulletList(),"Mod-Shift-8":()=>this.editor.commands.toggleOrderedList()}}}),Ai=(0,o.aZ)({__name:"node-bullet-list-view",props:Ee.Un,setup(e){const t=e;function s(e){var t;null!==(t=e.clipboardData)&&void 0!==t&&t.files.length&&e.preventDefault()}return(e,i)=>((0,o.wg)(),(0,o.j4)(pt.Z,(0,o.dG)(t,{"content-class":e.$style.wrapper}),{default:(0,o.w5)((()=>[(0,o.Wm)((0,a.SU)(Ee.ms),{as:"ul",class:(0,n.C_)(e.$style.list),"data-drop":"false",onDrop:i[0]||(i[0]=(0,r.iM)((()=>{}),["stop","prevent"])),onPaste:s},null,8,["class"])])),_:1},16,["content-class"]))}});var Di=s(48902),Mi=s.n(Di);const Ri={};Ri.$style=Mi();const Ni=(0,b.Z)(Ai,[["__cssModules",Ri]]),Bi=Ce.NB.create({name:"bulletList",group:"block list",content:"listItem+",draggable:!0,selectable:!1,marks:"link bold spoiler strike italic marker",parseHTML:()=>[{tag:"ul"}],renderHTML:({HTMLAttributes:e})=>["ul",e,0],addNodeView:()=>(0,Ee.uf)(Ni),addCommands(){return{toggleBulletList:()=>({commands:e})=>e.toggleList(this.name,Pi.name)}}}),Li=(0,o.aZ)({__name:"node-ordered-list-view",props:Ee.Un,setup(e){const t=e;function s(e){var t;null!==(t=e.clipboardData)&&void 0!==t&&t.files.length&&e.preventDefault()}return(e,i)=>((0,o.wg)(),(0,o.j4)(pt.Z,(0,o.dG)(t,{"content-class":e.$style.wrapper}),{default:(0,o.w5)((()=>[(0,o.Wm)((0,a.SU)(Ee.ms),{as:"ol",class:(0,n.C_)(e.$style.list),"data-drop":"false",onDrop:i[0]||(i[0]=(0,r.iM)((()=>{}),["stop","prevent"])),onPaste:s},null,8,["class"])])),_:1},16,["content-class"]))}});var ji=s(34149),$i=s.n(ji);const Ui={};Ui.$style=$i();const Fi=(0,b.Z)(Li,[["__cssModules",Ui]]),Vi=Ce.NB.create({name:"orderedList",group:"block list",content:"listItem+",draggable:!0,selectable:!1,marks:"link bold spoiler strike italic marker",parseHTML:()=>[{tag:"ol"}],renderHTML:({HTMLAttributes:e})=>["ol",e,0],addNodeView:()=>(0,Ee.uf)(Fi),addCommands(){return{toggleOrderedList:()=>({commands:e})=>e.toggleList(this.name,Pi.name)}},addInputRules(){return[(0,Ce.S0)({find:/^1\.\s$/,type:this.type})]}}),Hi=Ce.NB.create({name:"text",group:"inline"}),Zi="pkb-spoiler",zi=Ce.vc.create({name:"spoiler",priority:1100,parseHTML:()=>[{tag:`span.${Zi}`}],renderHTML:()=>["span",{class:Zi},0],addCommands(){return{toggleSpoiler:()=>({commands:e})=>e.pkbToggleMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleSpoiler(),"Mod-Shift-S":()=>this.editor.commands.toggleSpoiler()}}}),qi="pkb-marker",Wi=Ce.vc.create({name:"marker",priority:1100,parseHTML:()=>[{tag:`mark.${qi}`}],renderHTML:()=>["mark",{class:qi},0],addCommands(){return{toggleMarker:()=>({commands:e})=>e.pkbToggleMark(this.name)}},addKeyboardShortcuts(){const e=()=>!this.editor.isActive("highlight")&&!this.editor.isActive("blockquote")&&this.editor.commands.toggleMarker();return{"Mod-Shift-m":e,"Mod-Shift-M":e}},addProseMirrorPlugins(){return[new Ne.Sy({key:new Ne.H$(this.name),appendTransaction:(e,t,s)=>{if(s.doc===t.doc)return;const i=s.tr,o=[this.editor.schema.nodes.highlight,this.editor.schema.nodes.blockquote];let r=!1;return s.doc.descendants(((e,t,s)=>{e.isBlock&&s&&o.includes(s.type)&&(i.removeMark(t,t+e.nodeSize,this.type),i.setMeta("addToHistory",!1),r=!0)})),r?i:null}})]}});var Gi=s(15067),Yi=s(55063),Ki=s(9855);const Xi=s(61445).Z;var Ji=s(85651),Qi=s(81763),eo=s.n(Qi);function to(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function so(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?to(Object(s),!0).forEach((function(t){io(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):to(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function io(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const oo=(0,o._)("span",null,"Опрос",-1),ro=(0,o.aZ)({__name:"node-poll-view",props:Ee.Un,setup(e){const{sendEvent:t}=(0,Q.D3)(B.A1),{poll:{wasPublished:s,MAX_OPTIONS_COUNT:i}}=(0,Q.D3)(B.z),l=e,c=(0,a.iH)(!1),u=(0,a.iH)(),p={type:"survey_post",component_name:"post_editor"};(0,o.bv)((async()=>{l.node.attrs.new&&(await(0,o.Y3)(),setTimeout((()=>{var e;return null===(e=u.value)||void 0===e?void 0:e.focus()}),50))}));const h=(0,o.Fl)({set:e=>{l.updateAttributes({title:e})},get:()=>l.node.attrs.title}),_=(0,o.Fl)((()=>l.node.attrs.options.length>=i));function v(){l.editor.commands.blur(),c.value=!0,t("click",so({button:"delete_survey"},p))}function f(){l.editor.commands.pkbDeleteAtomNode(l.getPos()),t("click",so({button:"delete_survey_approved"},p))}function y(){l.editor.commands.blur(),l.updateAttributes({options:[...l.node.attrs.options,{title:""}]}),t("click",so({button:"add_choice"},p))}return(e,i)=>{const b=(0,o.Q2)("tooltip");return(0,o.wg)(),(0,o.j4)(pt.Z,(0,n.vs)((0,o.F4)(l)),{default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,n.C_)(e.$style.host)},[(0,o._)("header",{class:(0,n.C_)(e.$style.header)},[oo,l.editor.isEditable?(0,o.wy)(((0,o.wg)(),(0,o.j4)(d.Z,{key:0,name:"delete_16",class:(0,n.C_)(e.$style.delete),size:16,onClick:v},null,8,["class"])),[[b,e.IS_MOBILE?"":"Удалить опрос"]]):(0,o.kq)("v-if",!0)],2),(0,a.SU)(s)&&!l.node.attrs.new&&l.editor.isEditable?((0,o.wg)(),(0,o.j4)(Ji.Z,{key:0,theme:"yellow",class:(0,n.C_)(e.$style.alert)},{default:(0,o.w5)((()=>[(0,o.Uk)(" При редактировании опроса текущие результаты голосования будут сброшены ")])),_:1},8,["class"])):(0,o.kq)("v-if",!0),(0,o.Wm)(m.Z,{ref_key:"titleRef",ref:u,modelValue:h.value,"onUpdate:modelValue":i[0]||(i[0]=e=>h.value=e),"max-length":140,label:"Введите заголовок",class:(0,n.C_)(e.$style.title),onFocus:i[1]||(i[1]=e=>{t("click",so({button:"survey_heading"},p))})},null,8,["modelValue","class"]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.node.attrs.options,((s,i)=>((0,o.wg)(),(0,o.j4)(m.Z,{key:i,"model-value":s.title,"max-length":140,label:`Вариант ответа ${i+1}`,class:(0,n.C_)(e.$style.option),onFocus:e=>function(e){t("click",so(so({button:"choice"},p),{},{"level!undefined":eo()(e)?e+1:void 0}))}(i),"onUpdate:modelValue":e=>function(e,t){l.updateAttributes({options:l.node.attrs.options.map(((s,i)=>i===t?so(so({},s),{},{title:e}):s))})}(e,i)},(0,o.Nv)({_:2},[l.node.attrs.options.length>1?{name:"suffix",fn:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(d.Z,{name:"close_16",class:(0,n.C_)(e.$style.delete),size:16,onClick:(0,r.iM)((e=>function(e,s){l.editor.commands.blur(),l.updateAttributes({options:l.node.attrs.options.filter((t=>t!==e))}),t("click",so(so({button:"delete_choice"},p),{},{"level!undefined":eo()(s)?s+1:void 0}))}(s,i)),["stop"])},null,8,["class","onClick"]),[[b,"Удалить вариант"]])])),key:"0"}:void 0]),1032,["model-value","label","class","onFocus","onUpdate:modelValue"])))),128)),(0,o.Wm)(g.Z,{label:"Добавить вариант",class:(0,n.C_)(e.$style.add),disabled:_.value,onClick:(0,r.iM)(y,["stop"])},null,8,["class","disabled","onClick"]),_.value?((0,o.wg)(),(0,o.iD)("div",{key:1,class:(0,n.C_)(e.$style.error)}," Вы добавили максимальное количество вариантов ",2)):(0,o.kq)("v-if",!0),(0,o.Wm)(Gt.Z,{active:c.value,"onUpdate:active":i[2]||(i[2]=e=>c.value=e),title:"Удалить опрос",content:"Вы действительно хотите удалить опрос?",onConfirm:f},null,8,["active"])],2)])),_:1},16)}}});var no=s(86506),ao=s.n(no);const lo={};lo.$style=ao();const co=(0,b.Z)(ro,[["__cssModules",lo]]),uo=Ce.NB.create({name:"poll",group:"block",draggable:!0,atom:!0,addAttributes:()=>({title:{},options:{},new:{}}),renderHTML({HTMLAttributes:e}){return[this.name,e]},addNodeView:()=>(0,Ee.uf)(co)});var po=s(6314);const ho=(0,o.aZ)({__name:"node-fundraising-view",props:Ee.Un,setup(e){const{title:t}=(0,o.f3)(B.yC),s=e,i=(0,o.Fl)((()=>s.node.attrs.title)),r=(0,o.Fl)((()=>s.node.attrs.description)),l=(0,o.Fl)((()=>"Вы уверены, что хотите удалить виджет сбора из поста"+(t.value?` «${t.value}»`:"")+"?")),c=(0,a.iH)(!1);return(e,t)=>{const a=(0,o.Q2)("tooltip");return(0,o.wg)(),(0,o.j4)(pt.Z,(0,o.dG)(s,{"can-focused":!0}),{default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,n.C_)(e.$style.host)},[(0,o._)("header",{class:(0,n.C_)(e.$style.header)},[(0,o._)("h3",null,(0,n.zw)(i.value),1),(0,o.wy)((0,o.Wm)(d.Z,{name:"delete_16",class:(0,n.C_)(e.$style.delete),size:16,onClick:t[0]||(t[0]=e=>c.value=!0)},null,8,["class"]),[[a,e.IS_MOBILE?"":"Удалить сбор"]])],2),r.value?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,n.C_)(e.$style.description)},(0,n.zw)(r.value),3)):(0,o.kq)("v-if",!0),(0,o.Wm)(po.Z,{class:(0,n.C_)(e.$style.progress),value:s.node.attrs.value,max:s.node.attrs.target},null,8,["class","value","max"]),(0,o.Wm)(Gt.Z,{active:c.value,"onUpdate:active":t[1]||(t[1]=e=>c.value=e),title:"Удалить виджет сбора",content:l.value,onConfirm:t[2]||(t[2]=e=>s.editor.commands.pkbDeleteAtomNode(s.getPos()))},null,8,["active","content"])],2)])),_:1},16)}}});var _o=s(914),mo=s.n(_o);const go={};go.$style=mo();const vo=(0,b.Z)(ho,[["__cssModules",go]]),fo=Ce.NB.create({name:"fundraising",group:"block",draggable:!0,atom:!0,addAttributes:()=>({title:{},description:{},value:{},target:{}}),renderHTML({HTMLAttributes:e}){return[this.name,e]},addNodeView:()=>(0,Ee.uf)(vo)});var yo=s(26882);const bo={class:"carousel__main"},wo={key:0,type:"button",class:"carousel__scroll button carousel__scroll_left carousel__scroll_hidden"},ko={class:"carousel__content"},So={class:"carousel__helper"},Oo=["src"],Eo={key:1,type:"button",class:"carousel__scroll button carousel__scroll_right"},Co={class:"carousel__cur-slide"},xo=(0,o.aZ)({__name:"pkb-images-carousel",props:{items:{}},setup(e){const t=e,s=(0,a.iH)(),i=(0,a.iH)();(0,o.bv)((()=>{i.value=new yo.b({el:s.value}),(0,o.Ah)((()=>{var e;null===(e=i.value)||void 0===e||e.destroy()}))})),(0,o.YP)((()=>t.items),(()=>{(0,o.Y3)((()=>{var e;null===(e=i.value)||void 0===e||e.carousel.updateItems()}))}));return(e,t)=>((0,o.wg)(),(0,o.iD)("section",{ref_key:"el",ref:s,class:"carousel carousel_images"},[(0,o._)("div",bo,[(0,a.SU)(true)?((0,o.wg)(),(0,o.iD)("button",wo,[(0,o.Wm)(d.Z,{name:"arrow-left"})])):(0,o.kq)("v-if",!0),(0,o._)("div",ko,[(0,o._)("div",So,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.items,((t,s)=>((0,o.wg)(),(0,o.iD)("article",{key:s,class:"carousel__item"},[(0,o._)("img",{class:(0,n.C_)(e.$style.image),src:t.url,alt:""},null,10,Oo)])))),128))])]),(0,a.SU)(true)?((0,o.wg)(),(0,o.iD)("button",Eo,[(0,o.Wm)(d.Z,{name:"arrow-right"})])):(0,o.kq)("v-if",!0),(0,o._)("div",Co," 1/"+(0,n.zw)(e.items.length),1)])],512))}});var To=s(89559),Io=s.n(To);const Po={};Po.$style=Io();const Ao=(0,b.Z)(xo,[["__cssModules",Po]]),Do=(0,o.aZ)({__name:"carousel-overlay",props:{type:{default:"loading"}},setup:e=>(e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:(0,n.C_)(e.$style.host)},[(0,o.Wm)(Ct.Z),"error"===e.type?((0,o.wg)(),(0,o.j4)(d.Z,{key:0,name:"ic_warning_2_16",class:(0,n.C_)(e.$style.icon_error)},null,8,["class"])):((0,o.wg)(),(0,o.j4)(Et.Z,{key:1,size:32,progress:.25}))],2))});var Mo=s(9553),Ro=s.n(Mo);const No={};No.$style=Ro();const Bo=(0,b.Z)(Do,[["__cssModules",No]]),Lo=(0,o.aZ)({__name:"node-images-carousel-view",props:{editor:{},node:{},decorations:{},selected:{type:Boolean},extension:{},getPos:{type:Function},updateAttributes:{type:Function},deleteNode:{type:Function}},setup(e){const{carouselService:t}=(0,Q.D3)(B.yC),s=e,i=(0,a.iH)(!1);function l(){s.editor.commands.blur(),s.deleteNode()}let c;const d=(0,o.Fl)((()=>s.node.attrs.items));(0,o.wF)((async()=>{c=t.initCarousel(s.node.attrs.id,(0,a.nZ)(),d,(e=>s.updateAttributes({items:e})))}));const u=(0,o.Fl)((()=>{var e;return null===(e=d.value.find((e=>"loading"===e.state||"error"===e.state)))||void 0===e?void 0:e.state}));function p(e){e.target.closest(".carousel__scroll")||s.editor.commands.setNodeSelection(s.getPos())}const h=(0,o.Fl)((()=>d.value.map((e=>{var t,s;return{url:e.url,width:null===(t=e.imgData)||void 0===t?void 0:t.width,height:null===(s=e.imgData)||void 0===s?void 0:s.height}}))));return(e,t)=>{const d=(0,o.Q2)("tooltip");return(0,o.wg)(),(0,o.j4)(pt.Z,(0,n.vs)((0,o.F4)(s)),{default:(0,o.w5)((()=>{var _;return[(0,o._)("div",{class:(0,n.C_)({[e.$style.host]:!0,[e.$style.host_selected]:s.selected})},[(0,o._)("figure",{class:(0,n.C_)(e.$style.figure),contenteditable:"false",onClick:p},[(0,o.Wm)(Ao,{items:h.value},null,8,["items"])],2),(0,o.Wm)(Ht,(0,o.dG)(s,{placeholder:"Введите описание к карусели (не обязательно)"}),{default:(0,o.w5)((()=>[(0,o.Wm)((0,a.SU)(Ee.ms))])),_:1},16),u.value?((0,o.wg)(),(0,o.j4)(Bo,{key:0,type:u.value},null,8,["type"])):(0,o.kq)("v-if",!0),s.editor.isEditable?((0,o.wg)(),(0,o.iD)("div",{key:1,class:(0,n.C_)([e.$style.controls,{[e.$style.controls_row]:e.node.attrs.height<=80}]),contenteditable:"false"},[(0,o.wy)((0,o.Wm)(Yt.Z,{icon:"edit_16",theme:"media",onClick:null===(_=(0,a.SU)(c))||void 0===_?void 0:_.showEditPopup},null,8,["onClick"]),[[d,"Редактировать"]]),(0,o.wy)((0,o.Wm)(Yt.Z,{icon:"delete_16",theme:"media",onPointerdown:t[0]||(t[0]=(0,r.iM)((e=>i.value=!0),["prevent"]))},null,512),[[d,"Удалить"]])],2)):(0,o.kq)("v-if",!0),(0,o.Wm)(Gt.Z,{active:i.value,"onUpdate:active":t[1]||(t[1]=e=>i.value=e),title:"Удалить карусель изображений?",content:"Вы действительно хотите удалить карусель изображений?",onConfirm:l},null,8,["active"])],2)]})),_:1},16)}}});var jo=s(48279),$o=s.n(jo);const Uo={};Uo.$style=$o();const Fo=(0,b.Z)(Lo,[["__cssModules",Uo]]),Vo=Ce.NB.create({name:"imagesCarousel",group:"block",content:"text*",isolating:!1,draggable:!0,marks:"link",addAttributes:()=>({items:{}}),renderHTML({HTMLAttributes:e}){return[this.name,e,0]},addNodeView:()=>(0,Ee.uf)(Fo)}),Ho=(0,o._)("hr",{contenteditable:"false"},null,-1),Zo=(0,o.aZ)({__name:"node-separator-view",props:Ee.Un,setup(e){const t=e;return(e,s)=>((0,o.wg)(),(0,o.j4)(pt.Z,(0,o.dG)(t,{"content-class":[e.$style.wrapper,{[e.$style.wrapper_selected]:t.selected}]}),{default:(0,o.w5)((()=>[Ho])),_:1},16,["content-class"]))}});var zo=s(44409),qo=s.n(zo);const Wo={};Wo.$style=qo();const Go=(0,b.Z)(Zo,[["__cssModules",Wo]]),Yo=Ce.NB.create({name:"separator",group:"block",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:e}){return["hr",(0,Ce.P1)(this.options.HTMLAttributes,e)]},addNodeView:()=>(0,Ee.uf)(Go),addCommands(){return{setSeparator:(e,t)=>({tr:s,dispatch:i})=>(i&&s.replaceWith(e,t,this.type.create()),!0)}},addInputRules(){return[new Ce.VK({find:/^---$/,handler:({state:e,range:t,match:s})=>{const{tr:i}=e,o=t.from,r=t.to;s[0]&&(i.insertText("-"),setTimeout((()=>{this.editor.commands.setSeparator(o-1,r+1)}),100))}})]}}),Ko=(0,o.aZ)({__name:"node-highlight-view",props:Ee.Un,setup(e){const t=e;return(e,s)=>((0,o.wg)(),(0,o.j4)(pt.Z,(0,o.dG)(t,{"content-class":e.$style.wrapper}),{default:(0,o.w5)((()=>[(0,o.Wm)((0,a.SU)(Ee.ms),{as:"div"})])),_:1},16,["content-class"]))}});var Xo=s(87683),Jo=s.n(Xo);const Qo={};Qo.$style=Jo();const er=(0,b.Z)(Ko,[["__cssModules",Qo]]),tr="pkb-highlight-block",sr=Ce.NB.create({name:"highlight",group:"block",content:"paragraph+",draggable:!0,selectable:!1,defining:!0,marks:"link bold spoiler strike italic",parseHTML:()=>[{tag:"div."+tr,contentElement:e=>{var t;if("P"!==(null===(t=e.firstElementChild)||void 0===t?void 0:t.tagName)){const t=document.createElement("p");t.append(...e.childNodes),e.append(t)}return e}}],renderHTML:({HTMLAttributes:e})=>["div",(0,Ce.P1)({class:tr},e),0],addNodeView:()=>(0,Ee.uf)(er),addCommands(){return{toggleHighlight:()=>({editor:e,commands:t,chain:s})=>e.isActive("blockquote")?(s().unsetBlockquote().wrapIn(this.name),!0):t.toggleWrap(this.name),unsetHighlight:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight(),"Mod-Shift-H":()=>this.editor.commands.toggleHighlight()}}});function ir(e,t){var s,i;const o=t.posAtCoords({left:e.clientX,top:e.clientY});if(Boolean(null===(s=e.dataTransfer)||void 0===s?void 0:s.types.includes("Files"))){var r,n,a;const e=null!==(r=null==o?void 0:o.inside)&&void 0!==r?r:-1;return-1===e?t.state.doc.content.size-(null!==(n=null===(a=t.state.doc.lastChild)||void 0===a?void 0:a.nodeSize)&&void 0!==n?n:0):e}return null!==(i=null==o?void 0:o.pos)&&void 0!==i?i:null}const or=[ut,Pe.Z,Pi,Je.Z,ft,Ot,xs,Ks,li,vi,Si,Ii,Bi,Vi,Hi,uo,fo,Vo,Yo,sr,Yi.Z,Gi.Z,Ki.Z,Xi,zi,Wi,Te,Ae.ZP,Xe,Ie.Z.configure({newGroupDelay:100}),je.configure({getDropPosition:ir}),ct.configure({getDropPosition:ir}),dt,He,Qe,tt,it,nt,at,De.Z.configure({placeholder:"Используйте Shift + Enter для перехода на новую строку без отступа"}),Me.Z],rr=[ut,Pe.Z,Je.Z,Hi,Yi.Z,Gi.Z,Ki.Z,Xi,Te,Ae.ZP,Xe,Ie.Z,je,dt,Qe,De.Z.configure({placeholder:"Здесь можно написать дополнение к посту"})],nr="\x3c!--StartFragment--\x3e",ar="\x3c!--EndFragment--\x3e";function lr(e){const t=function(e){let t=e.indexOf(nr);if(-1===t)return;t+=nr.length;const s=e.indexOf(ar,t);return-1===s?e.slice(t):e.slice(t,s)}(e);if(!t)return e;const s=(new DOMParser).parseFromString(t,"text/html");return[...s.querySelectorAll("p.MsoListParagraphCxSpFirst")].map((e=>{const t=[e];let s=e.nextElementSibling;for(;s&&s.matches(".MsoListParagraphCxSpMiddle,.MsoListParagraphCxSpLast");)t.push(s),s=s.nextElementSibling;return t})).forEach((e=>{const[t]=e,i=s.createElement(t.querySelector('span[style*="mso-bidi-theme-font"]')?"ol":"ul");t.parentNode.insertBefore(i,t),i.append(...e),e.map((e=>{const t=s.createElement("li");return t.innerHTML=e.innerHTML.replace(/<!\[if !supportLists]>.*<!\[endif]>/,""),e.replaceWith(t),t}))})),s.body.innerHTML}s(84944),s(33792),s(86535),s(99244);function cr(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function dr(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?cr(Object(s),!0).forEach((function(t){ur(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):cr(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function ur(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const pr=e=>(0,Ce.ar)({type:"doc",content:[e]},or),hr=e=>(0,Ce.ar)(e,or),_r=e=>"paragraph"===e.type&&!(e=>(0,Ce._4)(e,or))(e).trim();function mr(e){var t;if(!e.attrs)return[];if(["embedVideoLoader","videoLoader"].includes(null!==(t=e.type)&&void 0!==t?t:""))return[];const s=e.attrs.id;if("image"===e.type){return!e.attrs.source?{id:s,type:"image",title:hr(e),url:e.attrs.src,size:[e.attrs.width,e.attrs.height]}:[]}if("video"===e.type)return{id:s,type:"video_file",fid:e.attrs.fid,is_muted:e.attrs.isMuted,cut_from:e.attrs.cutFrom,cut_to:e.attrs.cutTo,info:{src:{url:e.attrs.source+".mp4"},thumb:e.attrs.thumb,duration:e.attrs.duration,has_audio:e.attrs.hasAudio,width:e.attrs.width,height:e.attrs.height}};if("embedVideo"===e.type)return{id:s,type:"video",url:e.attrs.url};if("poll"===e.type)return{id:s,type:"poll",title:e.attrs.title,options:e.attrs.options.map((e=>e.title))};if("fundraising"===e.type)return{id:s,cid:e.attrs.cid,type:"fundraising"};if("imagesCarousel"===e.type){const t=e.attrs.items.filter((e=>"loaded"===e.state)).map((e=>({id:e.id,type:"image",url:e.url,carousel_id:s})));return 0===t.length?[]:[{id:s,type:"carousel",title:hr(e),blocks:t.map((e=>e.id))},...t]}return"separator"===e.type?{id:s,type:"separator"}:{id:s,type:"text",body:pr(e)}}class gr{constructor(){ur(this,"prevNodesData",new Map)}convert(e){const t=[];return e.content.forEach((e=>{const s=this.getNodeData(e);t.push([e,s])})),this.prevNodesData=new Map(t),this.getStoryBlocks(t)}getStoryBlocks(e){let t=0;for(let s=e.length-1;s>=0&&e[s][1].isEmptyTextBlock;s--)t++;return(t>0?e.slice(0,-1*t):e).map((([e,t])=>t.storyBlocks)).flat()}getNodeData(e){if(this.prevNodesData.has(e))return this.prevNodesData.get(e);const t=e.toJSON();return{storyBlocks:mr(t),isEmptyTextBlock:_r(t)}}}const vr=()=>{const e=new gr;return function(t,s=!1){return s?function(e){var t;const s=null===(t=e.content)||void 0===t?void 0:t.slice(0,-1);if(null==s||!s.length)return[];const i=dr(dr({},s[0]),{},{content:s.flatMap((e=>{var t;return[...null!==(t=e.content)&&void 0!==t?t:[],{type:"hardBreak"}]})).slice(0,-1)});return _r(i)?[]:[mr(i)].flat()}(t.toJSON()):e.convert(t)}},fr=e=>{var t,s;return e&&"<p><br></p>"!==e?null!==(t=null===(s=(0,Ce.AW)(e,or))||void 0===s?void 0:s.content)&&void 0!==t?t:[]:[{type:"paragraph",content:[]}]},yr=e=>{var t;const[s]=fr(e);return null!==(t=null==s?void 0:s.content)&&void 0!==t?t:[]};function br(e){let t=[];return t=null!=e&&e.length?e.map((t=>{var s,i,o,r,n,a,l,c,d,u,p,h;if("text"===t.type)return null!==(i=null===(o=fr(t.body))||void 0===o?void 0:o.map((e=>(e.attrs||(e.attrs={}),e.attrs.id=t.id,e))))&&void 0!==i?i:[];if("image"===t.type){var _,m;if(t.carousel_id)return[];const[e,s]=(null!==(_=t.size)&&void 0!==_?_:[]).map(Number);return{type:"image",attrs:{id:t.id,thumb:t.url_preview,src:t.url,largeSrc:t.url_large,isAnimated:t.is_animated_image,width:e,height:s},content:yr(null!==(m=t.title)&&void 0!==m?m:"")}}if("video_file"===t.type)return{type:"video",attrs:{id:t.id,fid:t.fid,source:null===(r=(null===(n=t.info)||void 0===n?void 0:n.src.url)||(null===(a=t.info)||void 0===a||null===(l=a.mp4)||void 0===l?void 0:l.url))||void 0===r?void 0:r.replace(".mp4",""),isMuted:t.is_muted,cutFrom:t.cut_from,cutTo:t.cut_to,thumb:null===(c=t.info)||void 0===c?void 0:c.thumb,duration:null===(d=t.info)||void 0===d?void 0:d.duration,hasAudio:null===(u=t.info)||void 0===u?void 0:u.has_audio,width:null===(p=t.info)||void 0===p?void 0:p.width,height:null===(h=t.info)||void 0===h?void 0:h.height}};if("video"===t.type)return{type:"embedVideo",attrs:{id:t.id,url:t.url,poster:t.url_preview,duration:t.duration,ratio:t.ratio}};if("poll"===t.type)return{type:"poll",attrs:{id:t.id,title:t.title,options:t.options.map((e=>({title:e})))}};if("fundraising"===t.type&&null!==(s=t.campaign)&&void 0!==s&&s.is_active){const{id:e,title:s,description:i,targetAmount:o,currentAmount:r}=(0,me.Ao)(t.campaign);return{type:"fundraising",attrs:{id:t.id,cid:e,title:s,description:i,value:r,target:o}}}if("carousel"===t.type){const s=e.filter((e=>"image"===e.type&&e.carousel_id===t.id));return s.length?{type:"imagesCarousel",attrs:{id:t.id,items:s.map((e=>{var t,s;return{id:e.id,url:e.url,imgData:{width:null===(t=e.size)||void 0===t?void 0:t[0],height:null===(s=e.size)||void 0===s?void 0:s[1]},state:"loaded"}}))},content:yr(t.title)}:[]}return"separator"===t.type?{type:"separator",attrs:{id:t.id}}:[]})).flat():[{type:"paragraph",content:[]}],{type:"doc",content:t}}const wr=(0,Oe.Dt)((()=>{const e=Ir(),t=(0,o.Fl)((()=>!e.canEditStory)),s=(0,a.iH)(!1),i=(0,Q.D3)(B.A1),r=vr();let n=e.storyBlocks;const l=(0,Ee.jE)({content:br(e.storyBlocks),extensions:or,editable:!t.value,onUpdate:_,onCreate:_,onFocus:()=>(0,a.oR)(l),onBlur:()=>(0,a.oR)(l),editorProps:{scrollThreshold:{top:47,right:0,bottom:0,left:0},scrollMargin:{top:55,right:8,bottom:8,left:8},handlePaste(e,t,s){var o,r;const n=(0,O.u1)(Array.from(null!==(o=null===(r=t.clipboardData)||void 0===r?void 0:r.files)&&void 0!==o?o:[])).filter((({type:e})=>e));if(n.length)return function(e){const t=e.map((({file:e,type:t})=>("image"!==t&&"video"!==t||i.sendMediaAddedEvent({type:t}),"image"===t?{type:"image",attrs:{source:e}}:"video"===t?{type:"videoLoader",attrs:{source:e}}:void 0)));h(t,{focusNextParagraph:!0})}(n),!0;if(e.state.selection.empty&&s.size){var a;const o=e.state.selection.from;Se.j.instance.extractImageVideoUrls(null===(a=t.clipboardData)||void 0===a?void 0:a.getData("text")).then((e=>{var t,r;if(!e.length)return;let n=s.content.maybeChild(0);if(null!==(t=n)&&void 0!==t&&t.childCount&&(n=n.child(0)),!n)return;1===e.length&&(null===(r=n.textContent)||void 0===r?void 0:r.trim())===e[0].url&&l.value.commands.deleteRange({from:o,to:o+n.nodeSize}),function(e){l.value.commands.insertContent(e.map((e=>e.type===Se.v.IMAGE?(i.sendMediaAddedEvent({type:"image"}),{type:"image",attrs:{source:e.url}}):e.type===Se.v.VIDEO&&(i.sendMediaAddedEvent({type:"video"}),{type:"embedVideoLoader",attrs:{url:e.url}}))).filter(Boolean))}(e)}))}return!1},transformPastedHTML:lr}});const c=(0,o.Fl)((()=>{var e;const t=null===(e=l.value)||void 0===e?void 0:e.state.selection;if(!t.empty)return l.value.state.doc.lastChild;const s=t.$anchor.node(1);return"paragraph"===(null==s?void 0:s.type.name)&&!s.textContent&&!s.content.size?s:l.value.state.doc.lastChild})),d=(0,o.Fl)((()=>{let e=0;return l.value.state.doc.descendants(((t,s)=>(t===c.value&&(e=s),!1))),e})),u=(0,o.Fl)({get:()=>e.theme,set:t=>e.theme=t}),p=(0,o.Fl)((()=>{var e;const t=null===(e=l.value)||void 0===e?void 0:e.state.doc.content;if(!t||l.value.state.doc.childCount>3||t.content.some((e=>{var t;return"paragraph"!==e.type.name||(null===(t=e.firstChild)||void 0===t?void 0:t.marks.length)})))return!1;return!(t.content.reduce(((e,t)=>e+t.content.content.filter((e=>"hardBreak"===e.type.name)).length),l.value.state.doc.childCount-1)>U.IA)&&(e=>{const t=e.replace(U.dT,"#").replace(/\s+/g," ").trim().length;return t>=0&&t<=320})(l.value.state.doc.textContent)}));function h(e,t){null!=t&&t.toFabPosition&&l.value.commands.focus(d.value+1),l.value.commands.insertContent(e),null!=t&&t.focusNextParagraph&&lt(l.value)}function _(){const t=Boolean(u.value),s=r(l.value.state.doc,t);n=s,e.storyBlocks=s}return(0,o.YP)((()=>e.storyBlocks),(e=>{if(n===(0,a.IU)(e))return;const t=br(e);l.value.commands.setContent(t,!1)})),(0,o.YP)(t,(e=>l.value.setEditable(!e))),(0,o.YP)(u,(t=>{t||e.storyBlocks.length||l.value.commands.deleteSelection(),_()})),(0,o.YP)(s,(e=>l.value.setEditable(!e))),(0,o.YP)(p,(e=>{e||(u.value=0)})),{editor:l,fabPosition:d,addContent:h,addFiles:function(e,t){const s=e.map((({file:e,type:t})=>("image"!==t&&"video"!==t||i.sendMediaAddedEvent({type:t}),"image"===t?{type:"image",attrs:{source:e}}:"video"===t?{type:"videoLoader",attrs:{source:e}}:void 0))).filter(Boolean);s.length&&h(s,t)},disabled:t,theme:u,isBlocksReorderingMode:s,isThemeAllowed:p}}));function kr(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function Sr(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?kr(Object(s),!0).forEach((function(t){Or(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):kr(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Or(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Er="Опрос",Cr=l.core.config("modules.story-editor"),xr=be.o.clearHTMLTags(),Tr=be.o.unescape(),Ir=(0,L.Q_)("storyEditor",{state:()=>{var e,t,s,i,o,r,n,a;const c=(0,Q.wH)(),d=(0,Q.id)(c.tags),u=Cr.isTopAuthor&&!Cr.storyId&&Cr.story&&"ca"!==Cr.type;return Sr(Sr({},Cr),{},{title:null!==(e=c.title)&&void 0!==e?e:"",storyBlocks:null!==(t=c.blocks)&&void 0!==t?t:[],storyUpdateBlocks:c.upd?[{id:0,type:"text",body:c.upd}]:[],updPosition:null!==(s=c.upd_position)&&void 0!==s?s:0,theme:null!==(i=c.color_theme)&&void 0!==i?i:0,tags:d,recommendedTags:[],settings:{is_story_boost:c.is_story_boost||!1,is_author_content:u||c.is_author_content||!1,is_authors:u||c.is_authors||!1,is_adult:c.is_adult||!1,is_anonymous_story:c.is_anonymous_story||!1,is_donations_disabled:c.is_donations_disabled||!1,is_comments_disabled:c.is_comments_disabled||!1,advert_company:null!==(o=c.advert_company)&&void 0!==o?o:"",is_advert_blogs:c.is_advert_blogs||!1,scheduled_time:null!==(r=c.scheduled_time)&&void 0!==r?r:null,series_id:c.series_id,is_paid_subscription:c.is_paid_subscription||!1,is_not_advert:(null==Cr?void 0:Cr.storyId)>0&&!c.advert_company},recommendationObserver:null,recommendedCommunities:[],community:c.community_data?JSON.parse(c.community_data):null,communities:new Map,locked:!1,isSavingInProgress:!1,isPreviewInProgress:!1,isScheduledTimePristine:!0,availableStoryBoosts:null!==(n=l.core.initParams.availableStoryBoosts)&&void 0!==n?n:0,publishError:null,fundraising:null!==(a=Cr.fundraisingCampaign)&&void 0!==a&&a.id?(0,me.Oe)(Cr.fundraisingCampaign):void 0,loading:{setSubscriptionCost:!1},notificationsAllowed:!1,wasBoosted:Boolean(Cr.storyId&&c.is_story_boost)})},getters:{wasPublished:e=>Boolean(e.storyId),wasScheduled:e=>Boolean(e.scheduleId),willBeScheduled:e=>Boolean(e.settings.scheduled_time),isNew(){return!this.wasPublished&&!this.wasScheduled},data(e){var t;let s;return e.isUpdatesOnlyAllowed&&(s=e.storyUpdateBlocks.map((e=>e.body)).join("")),{title:e.title.trim(),blocks:e.storyBlocks,upd:s||void 0,upd_position:e.isUpdatesOnlyAllowed?e.updPosition:void 0,tags:e.tags.join(","),is_story_boost:e.settings.is_story_boost,is_author_content:e.settings.is_author_content,is_authors:e.settings.is_authors,is_adult:e.settings.is_adult,is_anonymous_story:e.settings.is_anonymous_story,is_donations_disabled:e.settings.is_donations_disabled,is_comments_disabled:e.settings.is_comments_disabled,is_advert_blogs:e.settings.is_advert_blogs,advert_company:e.settings.advert_company,scheduled_time:e.settings.scheduled_time||null,story_id:e.storyId,parent_story_id:e.parentStoryId,color_theme:e.theme,community:null===(t=e.community)||void 0===t?void 0:t.id,is_community:Boolean(e.community),series_id:e.settings.series_id,is_paid_subscription:e.settings.is_paid_subscription,is_not_advert:e.settings.is_not_advert,schedule_id:e.scheduleId}},isNormal:e=>"normal"===e.type,isScheduled:e=>"schedule"===e.type,isCustomAdverts:e=>"ca"===e.type,isPDSAdvertBlogs:e=>"ab"===e.type,isExperts:e=>"experts"===e.type,isPDS(){return this.isCustomAdverts||this.isPDSAdvertBlogs},needToFollowDuplicationEditor(){return this.isNormal&&Boolean(this.pageId)},isCharsLimitExceeded(){return this.plainTextContent.length>this.LIMIT_MAX_TEXT_BLOCKS_LENGTH},isBlocksLimitExceeded(){return this.storyBlocks.filter((e=>!("carousel_id"in e))).length>this.LIMIT_MAX_BLOCKS_COUNT},mediaCount(){return this.storyBlocks.filter((e=>["image","video","video_file"].includes(e.type))).length},complexBlocksCount(){return this.storyBlocks.filter((e=>B.ju.has(e.type))).length},mediaItemsLimit(){return this.hasImagesCarousel?this.LIMIT_MAX_MEDIA_BLOCKS_WITH_CAROUSEL_COUNT:this.LIMIT_MAX_MEDIA_BLOCKS_COUNT},isMediaLimitExceeded(){return this.mediaCount>this.mediaItemsLimit},isSomeLimitExceeded(){return this.isCharsLimitExceeded||this.isBlocksLimitExceeded||this.isMediaLimitExceeded},isContentEmpty(){return 0===this.mediaCount&&0===this.complexBlocksCount&&!this.plainTextContent},isEditorEmpty(e){return!e.title&&this.isContentEmpty},isScheduledTimeValid:e=>{if(!e.settings.scheduled_time)return!0;const t=e.settings.scheduled_time-(0,ye.N)(),s=t>=240;return t>0&&(e.isScheduledTimePristine||s)},textContent(){var e;return null!==(e=this.storyBlocks.filter((e=>"text"===e.type)).reduce(((e,t)=>e+(t.body||"")),""))&&void 0!==e?e:""},plainTextContent(){return Tr(xr(this.textContent))},isAnswer:e=>Boolean(e.parentStoryId),hasImagesCarousel(){return this.storyBlocks.some((e=>"carousel"===e.type))},publishPayload(e){var t;const s=de(),i={action:"publish",time:Date.now().toString().substring(0,10),data:JSON.stringify(this.data),story_id:e.storyId,parent_story_id:e.parentStoryId,draft_id:null===(t=s.draft)||void 0===t?void 0:t.id};return"ab"===e.type&&(i.author_id=e.authorId),["normal","experts","schedule"].includes(e.type)||(i.save_mode=e.type,i.action="validate",i.save_target_id=e.saveTargetId),i},recommendedCommunity:e=>t=>e.recommendedCommunities.find((({id:e})=>e===t)),submitButtonLabel(){return!this.willBeScheduled&&!this.isCustomAdverts&&!this.isPDSAdvertBlogs?"Опубликовать пост":"Сохранить пост"},readonlyTags(){const e=[];return this.storyBlocks.some((e=>"poll"===e.type))&&e.push(Er),U.TO.every((e=>this.tags.includes(e)))&&e.push(...U.TO),e},canSaveDraft(){const e=de();return Boolean(e.draftId||!e.isLimitExceeded||this.isPDS)},isUsersOwnStory:e=>l.core.initParams.userID===e.authorId,canEditStory(e){return!!this.canSaveDraft&&(l.core.isUserModerator&&this.isUsersOwnStory?!e.isUpdatesOnlyAllowed:l.core.isUserModerator||!e.isUpdatesOnlyAllowed)},canEditUpdate:e=>e.isUpdatesOnlyAllowed&&!e.theme},actions:{sendAnalyticsOnError(e){he.cp.getInstance().sendEvent("error_occurred",{type_i8:he.kH.STORY_EDITOR,type:_e.t[e]})},validate(){this.validateTitle(),this.validateTags(),this.validateContent(),this.validateLoadingContent(),this.validateLimits(),this.validateAdvertCompany()},validateLockTime(){const e=fe.v.getInstance().secondsToUnlockLeft;if(e>0)throw Error(`Допускается добавлять не более одного поста в течение\n\t\t\t\t\t${String(this.lockTimeInMinutes)} минут. Вы сможете добавить новый пост через\n\t\t\t\t\t${(0,ve.kT)(e)}`)},validateTitle(){const e=this.isAnswer?U.Jc:U.S8;if(!we.c.isLength(U.RI,e)(this.title))throw this.publishError=_e.A.ERROR_TITLE_RANGE,this.sendAnalyticsOnError(_e.A.ERROR_TITLE_RANGE),Error(`Укажите заголовок: от ${U.RI} до ${e} символов`);if(!we.c.isNotContainLink()(this.title))throw this.publishError=_e.A.ERROR_TITLE_CONTAIN_LINK,this.sendAnalyticsOnError(_e.A.ERROR_TITLE_CONTAIN_LINK),Error("Заголовок поста не должен содержать ссылку. Пожалуйста, уберите ссылку из заголовка")},validateTags(){const e=this.tags.join(","),t=this.LIMIT_MIN_TAGS_COUNT;if(!we.c.minTags(t)(e))throw this.publishError=_e.A.ERROR_TAG_MIN_TAG,this.sendAnalyticsOnError(_e.A.ERROR_TAG_MIN_TAG),Error(`Укажите минимум ${t} ${R.Utils.pluralNounRU(t,["тега","тега","тегов"])} из предлагаемых при вводе тега`);if(!we.c.maxTags(this.LIMIT_MAX_TAGS_COUNT)(e))throw this.publishError=_e.A.ERROR_TAG_MAX_TAG,this.sendAnalyticsOnError(_e.A.ERROR_TAG_MAX_TAG),Error("Превышен максимальный лимит тегов")},validateLimits(){if(this.isCharsLimitExceeded)throw this.publishError=_e.A.ERROR_TEXT_LENGTH,this.sendAnalyticsOnError(_e.A.ERROR_TEXT_LENGTH),Error();if(this.isBlocksLimitExceeded)throw this.publishError=_e.A.ERROR_BLOCKS_MAX,this.sendAnalyticsOnError(_e.A.ERROR_BLOCKS_MAX),Error();if(this.isMediaLimitExceeded)throw this.publishError=_e.A.ERROR_BLOCKS_MEDIA_MAX,this.sendAnalyticsOnError(_e.A.ERROR_BLOCKS_MEDIA_MAX),Error()},validateLoadingContent(){const{editor:e}=wr(),t=e.value.getJSON().content;if(!t)return;const s=t.some((e=>{var t;return"image"===e.type&&(null===(t=e.attrs)||void 0===t?void 0:t.source)})),i=t.some((e=>"videoLoader"===e.type)),o=t.some((e=>{var t;return"imagesCarousel"===e.type&&(null===(t=e.attrs)||void 0===t?void 0:t.items.some((e=>"loaded"!==e.state)))}));if(s||i||o){let e;throw e=s?_e.A.ERROR_IMAGE_PENDING:i?_e.A.ERROR_VIDEO_PENDING:_e.A.ERROR_CAROUSEL_PENDING,this.publishError=e,this.sendAnalyticsOnError(e),Error("Некоторые файлы еще загружаются. Пожалуйста, подождите")}},validateContent(){if(this.isContentEmpty)throw this.publishError=_e.A.ERROR_BLOCKS_MIN,this.sendAnalyticsOnError(_e.A.ERROR_BLOCKS_MIN),Error("Укажите содержимое поста");if(this.shouldShowAdvertBlogsFlag&&!this.settings.is_advert_blogs&&Se.j.extract(this.textContent,"",!1).length)throw this.publishError=_e.A.ERROR_BLOG_LINKS,this.sendAnalyticsOnError(_e.A.ERROR_BLOG_LINKS),Error("Нельзя добавить пост со ссылками вне блога")},validateAdvertCompany(){if(this.shouldShowAdvertBlogsFlag&&this.isNormal&&!this.settings.is_not_advert&&this.settings.is_advert_blogs&&!we.c.required()(this.settings.advert_company))throw this.publishError=_e.A.ERROR_ADVERT_INFO,this.sendAnalyticsOnError(_e.A.ERROR_ADVERT_INFO),Error("Укажите рекламируемое юрлицо")},async publishStory(){try{this.isSavingInProgress=!0,this.validate(),this.validateLockTime();const e=await $.cf.post("/ajax/gtpost_actions.php",this.publishPayload);return e.response.result&&(oe.sendEvent("publication"),await oe.setDraft(),"function"==typeof parent.__setStoryData&&parent.__setStoryData(this.data)),e}finally{this.isSavingInProgress=!1}},async getLastPageId(){try{const{data:e}=await $.cf.getOrFail("/ajax/gtpost_actions.php",{action:"get_last_page_id"});return e.id}catch(e){return console.error(e),null}},async getPreview(){try{this.isPreviewInProgress=!0;const{data:e}=await $.cf.postOrFail("/preview.php",{f:"json",type:"story",data:JSON.stringify(this.data)});return e.html}catch(e){throw console.error(e),new Error(e instanceof Error?e.message:"Не удалось загрузить превью")}finally{this.isPreviewInProgress=!1}},initRecommendationObserver(){this.recommendationObserver||(this.recommendationObserver=new W({getEditorTagsLength:()=>this.tags.length,getEditorPayloadData:()=>this.publishPayload,getTitle:()=>this.title,getTextContent:()=>this.plainTextContent,getNsfwSetting:()=>this.settings.is_adult}),this.recommendationObserver.listenToResponse((({communities:e,tags:t})=>{this.recommendedCommunities=e,this.recommendedTags=t.map((e=>e.extra_tag))})))},async searchCommunities(e=""){return e=e.toLowerCase().trim(),this.communities.has(e)||this.communities.set(e,await ke.yV.search(e)),this.communities.get(e)||[]},handleBlocksUpdate(e){var t,s,i,o,r;null===(t=this.recommendationObserver)||void 0===t||t.call({delta:{inserted:null===(s=e.inserted)||void 0===s?void 0:s.map((e=>({type:e.type,data:e}))),removed:null===(i=e.removed)||void 0===i?void 0:i.map((e=>({type:e.type,data:e})))}}),null!==(o=e.inserted)&&void 0!==o&&o.some((e=>"poll"===e.type))&&this.setSurveyTag(),null!==(r=e.removed)&&void 0!==r&&r.some((e=>"poll"===e.type))&&this.removeSurveyTag()},resetSettings(){Object.keys(this.settings).forEach((e=>{pe()(this.settings[e])&&(this.settings[e]=!1)})),this.settings.scheduled_time=null,this.settings.advert_company="",this.settings.series_id=0},setLocalStorageEditorId(){this.needToFollowDuplicationEditor&&J.m.set(U.q7,this.pageId)},async setSubscriptionCost(e){this.loading.setSubscriptionCost=!0;try{const t=await ge.wC(e);return t.response.result&&(this.subscriptionCost=e),t}finally{this.loading.setSubscriptionCost=!1}},setSurveyTag(){this.tags.includes(Er)||this.tags.push(Er)},removeSurveyTag(){this.storyBlocks.every((e=>"poll"!==e.type))&&(this.tags=this.tags.filter((e=>e!==Er)))}}}),Pr=["onTouchend"],Ar=(0,o.aZ)({__name:"floating-menu-view",props:{editor:{},position:{}},setup(e){const t=e,s=Ir(),{carouselService:i,addFiles:h,addContent:m}=(0,Q.D3)(B.yC),{fundraising:g}=(0,Q.D3)(B.z),v=(0,a.iH)(),f=(0,Q.D3)(B.A1),y=(0,a.iH)(!1),b=(0,a.iH)(!1),w=l.core.ua.ios||l.core.ua.android;async function k(e){const t=(0,O.u1)(e);if(!t.some((({type:e})=>"video"===e))){const e=s.LIMIT_MAX_FILE_SIZE,t=R.Utils.formatBytes(e);l.core.ui.toasts.showError(`Недопустимый формат файла.\n\t\t\tТребования к видео: ${R.Utils.formatListOr(O.G1)} не более ${t}.`)}h(t,{toFabPosition:!0,focusNextParagraph:!0})}async function S(e){f.sendMediaAddedEvent({type:"video"}),t.editor.chain().loadEmbedVideo(e).focus().run()}async function E(){A();const e=await(0,_.Z)({accept:{"image/*":O.We.map((e=>`.${e}`))},multiple:!0}),t=(0,O.u1)(e);if(!t.some((({type:e})=>"image"===e))){const e=s.LIMIT_IMAGES_BYTES,t=Math.floor(e/1e3/1e3);return l.core.ui.toasts.showError(`Недопустимый формат файла.\n\t\t\tТребования к изображению: ${R.Utils.formatListOr(O.We)} не более ${t} МБ.`),void N.c.getInstance().sendEvent("error_occured",{type:"post_create_drag_and_drop_bad_image"})}h(t,{toFabPosition:!0,focusNextParagraph:!0})}function C(){A(),i.showAddPopup()}function x(){A(),y.value=!0}function T(){A(),m({type:"poll",attrs:{new:!0,title:"",options:[{title:""},{title:""}]}},{toFabPosition:!0}),f.sendEvent("click",{button:"add_survey",type:"survey_post",component_name:"post_editor"})}function I(){if(A(),!g.campaign)return;const{title:e,description:t,currentAmount:s,targetAmount:i}=g.campaign;m({type:"fundraising",attrs:{title:e,description:t,value:s,target:i}},{toFabPosition:!0,focusNextParagraph:!0})}function P(){A(),m({type:"separator"},{toFabPosition:!0,focusNextParagraph:!0})}function A(){b.value=!1}function D(e){b.value=e,e&&w&&t.editor.commands.blur()}return w&&(0,c.i9H)(v,(()=>{b.value=!1})),(e,t)=>{const s=(0,o.Q2)("tooltip");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",{ref_key:"hostEl",ref:v,class:(0,n.C_)(e.$style.host),onMouseover:t[12]||(t[12]=e=>D(!0)),onMouseleave:t[13]||(t[13]=e=>D(!1))},[e.IS_MOBILE?((0,o.wg)(),(0,o.iD)("button",{key:0,type:"button",class:(0,n.C_)(e.$style.button),onClick:t[0]||(t[0]=e=>b.value=!0)},[(0,o.Wm)(d.Z,{name:"add_16"})],2)):((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[(0,o._)("button",{type:"button",class:(0,n.C_)(e.$style.button),onTouchend:t[1]||(t[1]=(0,r.iM)((e=>D(!b.value)),["prevent"]))},[(0,o.Wm)(d.Z,{name:"add_8",size:8})],34),(0,o._)("div",{class:(0,n.C_)([e.$style.menu,{[e.$style.menu_visible]:b.value}])},[(0,o.wy)(((0,o.wg)(),(0,o.iD)("button",{type:"button",class:(0,n.C_)(e.$style.menuButton),onTouchend:t[2]||(t[2]=(0,r.iM)((e=>E()),["prevent"])),onClick:t[3]||(t[3]=e=>E())},[(0,o.Wm)(d.Z,{name:"photo_20",size:20})],34)),[[s,"Добавить фото"]]),(0,o.wy)(((0,o.wg)(),(0,o.iD)("button",{type:"button",class:(0,n.C_)(e.$style.menuButton),onTouchend:(0,r.iM)(C,["prevent"]),onClick:C},[(0,o.Wm)(d.Z,{name:"ic_round-collections",size:20})],42,Pr)),[[s,"Добавить карусель изображений"]]),(0,o.wy)(((0,o.wg)(),(0,o.iD)("button",{type:"button",class:(0,n.C_)(e.$style.menuButton),onTouchend:t[4]||(t[4]=(0,r.iM)((e=>x()),["prevent"])),onClick:t[5]||(t[5]=e=>x())},[(0,o.Wm)(d.Z,{name:"play_20",size:20})],34)),[[s,"Добавить видео"]]),(0,o.wy)(((0,o.wg)(),(0,o.iD)("button",{type:"button",class:(0,n.C_)(e.$style.menuButton),onTouchend:t[6]||(t[6]=(0,r.iM)((e=>P()),["prevent"])),onClick:t[7]||(t[7]=e=>P())},[(0,o.Wm)(d.Z,{name:"divider_20",size:20})],34)),[[s,"Разделитель"]]),(0,o.wy)(((0,o.wg)(),(0,o.iD)("button",{type:"button",class:(0,n.C_)(e.$style.menuButton),onTouchend:t[8]||(t[8]=(0,r.iM)((e=>T()),["prevent"])),onClick:t[9]||(t[9]=e=>T())},[(0,o.Wm)(d.Z,{name:"poll_circle_20",size:20})],34)),[[s,"Добавить опрос"]]),(0,a.SU)(g).campaign?(0,o.wy)(((0,o.wg)(),(0,o.iD)("button",{key:0,type:"button",class:(0,n.C_)(e.$style.menuButton),onTouchend:t[10]||(t[10]=(0,r.iM)((e=>I()),["prevent"])),onClick:t[11]||(t[11]=e=>I())},[(0,o.Wm)(d.Z,{name:"coin_circle_20",size:20})],34)),[[s,"Виджет целевого сбора"]]):(0,o.kq)("v-if",!0)],2)],64))],34),((0,o.wg)(),(0,o.j4)(o.lR,{to:"body"},[(0,o.Wm)(M,{active:y.value,"onUpdate:active":t[14]||(t[14]=e=>y.value=e),onAddVideo:k,onAddEmbedVideo:S},null,8,["active"])])),e.IS_MOBILE?((0,o.wg)(),(0,o.j4)(p.Z,{key:0,modelValue:b.value,"onUpdate:modelValue":t[20]||(t[20]=e=>b.value=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(u.Z,{icon:"photo_20",label:"Изображение",onClick:t[15]||(t[15]=e=>E())}),(0,o.Wm)(u.Z,{icon:"ic_round-collections",label:"Карусель изображений",onClick:C}),(0,o.Wm)(u.Z,{icon:"play_20",label:"Видео",onClick:t[16]||(t[16]=e=>x())}),(0,o.Wm)(u.Z,{icon:"divider_20",label:"Разделитель",onClick:t[17]||(t[17]=e=>P())}),(0,o.Wm)(u.Z,{icon:"poll_circle_20",label:"Опрос",onClick:t[18]||(t[18]=e=>T())}),(0,a.SU)(g).campaign?((0,o.wg)(),(0,o.j4)(u.Z,{key:0,icon:"coin_circle_20",label:"Виджет целевого сбора",onClick:t[19]||(t[19]=e=>I())})):(0,o.kq)("v-if",!0)])),_:1},8,["modelValue"])):(0,o.kq)("v-if",!0)],64)}}});var Dr=s(26666),Mr=s.n(Dr);const Rr={};Rr.$style=Mr();const Nr=(0,b.Z)(Ar,[["__cssModules",Rr]]);var Br=s(43339),Lr=s(69023),jr=s(31200);const $r=(0,o._)("br",null,null,-1),Ur="pkb-rich-editor-theme-switch:hint",Fr=(0,o.aZ)({__name:"editor-theme-switch",setup(e){const{editor:t,theme:s,isThemeAllowed:i}=wr(),r=(0,a.iH)(!1),l=(0,o.Fl)({get:()=>Boolean(s.value),set(e){s.value=e?1:0}}),c=(0,jr.jE)().some((({id:e})=>e===Ur));if(!c){const e=(0,o.YP)((()=>{var e;return i.value&&(null===(e=t.value)||void 0===e?void 0:e.state.doc.textContent.length)>=20}),(t=>{t&&(r.value=!0,(0,jr.Ri)(Ur),e())}))}return(e,s)=>{var c,d;return(0,o.wg)(),(0,o.iD)("div",{class:(0,n.C_)(e.$style.host)},[(0,o.Wm)(Lr.Z,{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=e=>l.value=e),disabled:!(null!==(c=(0,a.SU)(t))&&void 0!==c&&c.isEditable&&(0,a.SU)(i)),label:"Спецоформление"},null,8,["modelValue","disabled"]),(0,o.Wm)(Br.Z,{active:r.value,"onUpdate:active":s[1]||(s[1]=e=>r.value=e),class:(0,n.C_)(e.$style.hint),disabled:!(null!==(d=(0,a.SU)(t))&&void 0!==d&&d.isEditable),"tooltip-container":e.IS_MOBILE?".main__content":void 0,direction:"bottom"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Короткие текстовые посты (до 320 символов) могут быть показаны в специальном оформлении. Пикабушники лучше замечают такие посты в ленте и больше плюсуют их. "),$r,(0,o.Uk)("Выберите между специальным и стандартным видом и узнайте, как будет выглядеть ваш пост. ")])),_:1},8,["active","class","disabled","tooltip-container"])],2)}}});var Vr=s(25743),Hr=s.n(Vr);const Zr={};Zr.$style=Hr();const zr=(0,b.Z)(Fr,[["__cssModules",Zr]]),qr=(0,o.aZ)({__name:"theme-view",props:{modelValue:{type:Number,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const s=e,i=t,{theme:l}=(0,Q.D3)(B.yC),c=(0,o.Fl)({get:()=>s.modelValue,set(e){i("update:modelValue",e)}});return(e,t)=>((0,o.wg)(),(0,o.iD)("div",null,[(0,a.SU)(l)?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,n.C_)(e.$style.color)},[(0,o._)("div",{class:(0,n.C_)(e.$style.title)}," Цвет фона специального оформления ",2),(0,o._)("div",{class:(0,n.C_)(e.$style.buttons)},[(0,o._)("label",{class:(0,n.C_)(e.$style.label)},[(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>c.value=e),class:(0,n.C_)([e.$style.button,e.$style.button_7]),type:"radio",value:7},null,2),[[r.G2,c.value]])],2),(0,o._)("label",{class:(0,n.C_)(e.$style.label)},[(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>c.value=e),class:(0,n.C_)([e.$style.button,e.$style.button_1]),type:"radio",value:1},null,2),[[r.G2,c.value]])],2),(0,o._)("label",{class:(0,n.C_)(e.$style.label)},[(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>c.value=e),class:(0,n.C_)([e.$style.button,e.$style.button_4]),type:"radio",value:4},null,2),[[r.G2,c.value]])],2),(0,o._)("label",{class:(0,n.C_)(e.$style.label)},[(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>c.value=e),class:(0,n.C_)([e.$style.button,e.$style.button_5]),type:"radio",value:5},null,2),[[r.G2,c.value]])],2),(0,o._)("label",{class:(0,n.C_)(e.$style.label)},[(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>c.value=e),class:(0,n.C_)([e.$style.button,e.$style.button_6]),type:"radio",value:6},null,2),[[r.G2,c.value]])],2),(0,o._)("label",{class:(0,n.C_)(e.$style.label)},[(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>c.value=e),class:(0,n.C_)([e.$style.button,e.$style.button_2]),type:"radio",value:2},null,2),[[r.G2,c.value]])],2),(0,o._)("label",{class:(0,n.C_)(e.$style.label)},[(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>c.value=e),class:(0,n.C_)([e.$style.button,e.$style.button_3]),type:"radio",value:3},null,2),[[r.G2,c.value]])],2)],2)],2)):(0,o.kq)("v-if",!0),(0,a.SU)(false)?((0,o.wg)(),(0,o.j4)(zr,{key:1,class:(0,n.C_)(e.$style.shortText)},null,8,["class"])):(0,o.kq)("v-if",!0)]))}});var Wr=s(31134),Gr=s.n(Wr);const Yr={};Yr.$style=Gr();const Kr=(0,b.Z)(qr,[["__cssModules",Yr]]);var Xr=s(62728);const Jr=["disabled","value"],Qr=(0,o.aZ)({__name:"title-view",props:{modelValue:{},fixed:{type:Boolean},disabled:{type:Boolean}},emits:["update:modelValue","reset"],setup(e,{expose:t,emit:s}){const i=e,l=s,c=(0,a.iH)();function d(){const e=c.value;e&&(e.style.height="auto",e.style.height=`${e.scrollHeight}px`)}function u(e){const t=e.target;if(/\n/g.test(t.value)){const e=t.value.length-t.selectionEnd;t.value=t.value.replace(/\n/g,"");const s=t.value.length-e;t.setSelectionRange(s,s)}l("update:modelValue",t.value)}return(0,o.YP)((()=>i.modelValue),d,{flush:"post"}),(0,o.bv)(d),t({focus:function(){var e;null===(e=c.value)||void 0===e||e.focus()},scrollIntoView:function(){var e;null===(e=c.value)||void 0===e||e.scrollIntoView(!1)}}),(e,t)=>((0,o.wg)(),(0,o.iD)("div",null,[i.fixed?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,n.C_)([e.$style.content,e.$style.content_fixed])},[(0,o._)("div",{class:(0,n.C_)(e.$style.fixedTitle)},(0,n.zw)(i.modelValue),3),(0,o.Wm)(Xr.Z,{class:(0,n.C_)(e.$style.reset),"icon-name":"close_16",theme:"gray",onClick:t[0]||(t[0]=e=>!i.disabled&&l("reset"))},null,8,["class"])],2)):((0,o.wg)(),(0,o.iD)("textarea",{key:1,ref_key:"textarea",ref:c,rows:"1",class:(0,n.C_)(e.$style.content),disabled:i.disabled,placeholder:"Заголовок",autofocus:"",value:i.modelValue,onInput:u,onKeydown:t[1]||(t[1]=(0,r.D2)((0,r.iM)((()=>{}),["prevent"]),["enter"]))},null,42,Jr))]))}});var en=s(3962),tn=s.n(en);const sn={};sn.$style=tn();const on=(0,b.Z)(Qr,[["__cssModules",sn]]);var rn=s(72189);const nn="Возникла ошибка при загрузке изображения",an=120;function ln(e,t){const s=Ir(),i=(0,Q.D3)(B.A1),r=(0,a.iH)(!1),n=(0,a.iH)([]);let c;(0,o.Ah)((()=>{var e,t;[...n.value,...null!==(e=null===(t=c)||void 0===t?void 0:t.items.value)&&void 0!==e?e:[]].forEach((e=>{var t;null===(t=e.dispose)||void 0===t||t.call(e)}))}));const d=t=>{const s=(0,o.YP)(t,(()=>{"loaded"===t.state&&(n.value.some((e=>e!==t&&e.url===t.url))||e.value.commands.checkImageDuplicate(t.url,!r.value))&&(n.value.splice(n.value.indexOf(t),1),l.core.ui.toasts.showError("Изображение уже добавлено")),"loading"!==t.state&&s()}),{deep:!0})};async function u(){let e=await async function(e){const t=await(0,_.Z)({accept:{"image/*":O.We.map((e=>`.${e}`))},multiple:!0}).catch((()=>[]));if(!t.length)return[];const s=(0,O.u1)(t),i=s.some((({type:e})=>"image"!==e));if(i){const t=R.Utils.formatBytes(e);l.core.ui.toasts.showError(`Недопустимый формат файла.\n\t\t\tТребования к изображению: ${R.Utils.formatListOr(O.We)} не более ${t}.`)}return s.map((e=>e.file))}(s.LIMIT_IMAGES_BYTES);if(n.value.length+e.length>30){l.core.ui.toasts.showError("Карусель может содержать не более 30 изображений");const t=30-n.value.length;e=e.slice(0,t)}e.forEach((e=>{const t=cn(e);n.value.push(t),d(t)}))}return{popup:(0,a.qj)({isShown:r,type:(0,o.Fl)((()=>r.value&&c?"edit":"add")),items:n,onAddItems:u,onApply:()=>{c?c.updateItems(n.value):(i.sendMediaAddedEvent({type:"carousel"}),t({type:"imagesCarousel",attrs:{items:n.value}},{focusNextParagraph:!0,toFabPosition:!0})),n.value=[],r.value=!1,c=void 0},onClose:()=>{n.value.filter((e=>{var t;return!(null!==(t=c)&&void 0!==t&&t.items.value.includes(e))})).forEach((e=>{var t;return null===(t=e.dispose)||void 0===t?void 0:t.call(e)})),n.value=[],r.value=!1,c=void 0},onRemoveItem:e=>{var t;const s=n.value[e];if(s){var i;if(null===(t=c)||void 0===t||!t.items.value.includes(s))null===(i=s.dispose)||void 0===i||i.call(s);n.value.splice(e,1)}},onMoveItem:(e,t)=>{n.value.splice(t,0,n.value.splice(e,1)[0])},onUpdateImage:(e,t)=>{var s;const i=n.value[e];if(!i)return;var o;null!==(s=c)&&void 0!==s&&s.items.value.includes(i)||(null===(o=i.dispose)||void 0===o||o.call(i));const r=cn(t);n.value[e]=r,d(r)}}),showAddPopup:async function(){r.value||(await u(),0!==n.value.length&&(r.value=!0))},initCarousel:(e,t,s,i)=>(t.run((()=>{(0,a.EB)((()=>{s.value.forEach((e=>{var t;return null===(t=e.dispose)||void 0===t?void 0:t.call(e)}))})),(0,o.YP)(s,((e,t)=>{const s=e.filter((e=>!(null!=t&&t.includes(e)))),i=null==t?void 0:t.filter((t=>!e.includes(t)));s.forEach((e=>{var t;"aborted"!==e.state&&"error"!==e.state||(null===(t=e.reload)||void 0===t||t.call(e))})),null==i||i.forEach((e=>{var t;return null===(t=e.dispose)||void 0===t?void 0:t.call(e)}))}),{immediate:!0})})),{showEditPopup:function(){n.value=[...s.value],r.value=!0,c={nodeId:e,items:s,updateItems:e=>{(s.value.length!==e.length||s.value.some(((t,s)=>e[s]!==t)))&&i(e)}}}})}}const cn=e=>{let t=new AbortController;const s=(0,a.qj)({id:ze(),source:e,dispose:()=>{"loading"!==s.state&&"error"!==s.state||URL.revokeObjectURL(s.url),"loading"===s.state&&(t.abort(),Object.assign(s,{state:"aborted"}))},reload:()=>{"error"!==s.state&&"aborted"!==s.state||(t=new AbortController,i())}}),i=()=>{Object.assign(s,{url:e instanceof File?URL.createObjectURL(e):e,state:"loading"}),async function(e,t,s){try{var i,o;const{response:r,data:n}=await(e instanceof File?(0,ys.Ix)(e,s,t):(0,ys.uc)(e,t));if(!r.result||r.messageCode===$.r2)throw new Error(r.message||nn);const a=null!==(i=null!==(o=n.small)&&void 0!==o?o:n.large)&&void 0!==i?i:n.preview;if(!a)throw new Error(nn);if(a.is_animated_image)throw new Error("Нельзя добавлять анимированные изображения в карусель");if(a.image_size[1]<an)throw new Error("Высота изображения должна быть не менее 120 пикселей");return{src:a.file_url,width:a.image_size[0],height:a.image_size[1]}}catch(r){if(t.aborted)return null;const e=r instanceof Error?r.message:r;throw l.core.ui.toasts.showError(e||nn),r}}(e,t.signal).then((e=>{e?(URL.revokeObjectURL(s.url),Object.assign(s,{state:"loaded",imgData:e,url:e.src,source:void 0,abort:void 0,reload:void 0})):t.signal.aborted||(s.state="error")})).catch((()=>{s.state="error"}))};return i(),s};var dn=s(51474),un=s(62357);const pn=["src"],hn=(0,o.aZ)({__name:"popup-image-item",props:{item:{}},emits:["loaded","remove","edit","error"],setup(e,{emit:t}){const s=t;return(e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:(0,n.C_)(e.$style.host)},[(0,o._)("img",{src:e.item.url},null,8,pn),(0,o._)("div",{class:(0,n.C_)([e.$style.buttons,"not-draggable"])},["loading"===e.item.state?((0,o.wg)(),(0,o.j4)(Et.Z,{key:0,color:"white"})):"loaded"===e.item.state?((0,o.wg)(),(0,o.j4)(d.Z,{key:1,name:"checkmark_16",class:(0,n.C_)(e.$style.icon_success)},null,8,["class"])):((0,o.wg)(),(0,o.j4)(d.Z,{key:2,name:"ic_warning_2_16",class:(0,n.C_)(e.$style.icon_error)},null,8,["class"])),(0,o._)("button",{onClick:t[0]||(t[0]=e=>s("edit"))},[(0,o.Wm)(d.Z,{name:"edit_16"})]),(0,o._)("button",{onClick:t[1]||(t[1]=e=>s("remove"))},[(0,o.Wm)(d.Z,{name:"delete_16"})])],2)],2))}});var _n=s(88506),mn=s.n(_n);const gn={};gn.$style=mn();const vn=(0,b.Z)(hn,[["__cssModules",gn]]),fn=(0,o.aZ)({__name:"carousel-edit-popup",props:{popup:{}},emits:["close"],setup(e){const t=e,s=(0,a.iH)(),i=(0,a.iH)(),l=(0,a.iH)(),c=(0,a.iH)(!1);function d(e){c.value=!0,l.value=e}function u(){void 0!==l.value&&(t.popup.onRemoveItem(l.value),l.value=void 0)}function p(e){const s=t.popup.items[e];i.value={index:e,url:s.url}}const h=(0,r.fb)();(0,o.bv)((()=>{const e=new dn.ZP(s.value,{ghostClass:h.item_ghost,chosenClass:h.item_chosen,dragClass:h.item_dragging,filter:".not-draggable",preventOnFilter:!1,animation:200,delay:0,onEnd:e=>{e.preventDefault();let{newIndex:s,oldIndex:i}=e;t.popup.onMoveItem(i,s)}});(0,o.Ah)((()=>{e.destroy()}))}));const _=(0,o.Fl)((()=>0===t.popup.items.length||t.popup.items.some((e=>"error"===e.state)))),m=(0,o.Fl)((()=>t.popup.items.length>=30)),v=(0,o.Fl)((()=>t.popup.items.every((e=>"loaded"===e.state)))),f="edit"===t.popup.type?"Редактирование карусели":"Добавить карусель",y=(0,a.iH)(!0);(0,o.YP)((()=>t.popup.isShown),(e=>{e||(y.value=!1)}));const b=(0,o.Fl)((()=>{const e=`${t.popup.items.length}/30`;return`${"edit"===t.popup.type?"Применить":"Добавить"} (${e})`}));return(e,t)=>((0,o.wg)(),(0,o.iD)(o.HY,null,[e.IS_MOBILE?((0,o.wg)(),(0,o.j4)(un.Z,{key:0,active:y.value,title:"Карусель изображений",class:(0,n.C_)(e.$style.popup),"onUpdate:active":t[0]||(t[0]=t=>e.popup.onClose()),onTransitionOut:t[1]||(t[1]=t=>e.$emit("close"))},{footer:(0,o.w5)((()=>[(0,o.Wm)(g.Z,{label:b.value,disabled:_.value,wide:"",onClick:e.popup.onApply},null,8,["label","disabled","onClick"])])),default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,n.C_)(e.$style.content)},[(0,o._)("div",{class:(0,n.C_)(e.$style.info)}," Перетащите изображения, чтобы изменить порядок отображения в карусели. Максимальное число фотографий – 30. ",2),(0,o._)("div",{ref_key:"itemsEl",ref:s,class:(0,n.C_)(e.$style.items)},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.popup.items,((t,s)=>((0,o.wg)(),(0,o.j4)(vn,{key:t.id,item:t,class:(0,n.C_)(e.$style.item),onRemove:e=>d(s),onEdit:e=>p(s)},null,8,["item","class","onRemove","onEdit"])))),128))],2)],2),(0,o._)("div",{class:(0,n.C_)(e.$style.addMoreBtn)},[(0,o.Wm)(g.Z,{label:"Загрузить еще",theme:"gray",icon:"add_16",wide:"",disabled:m.value,onClick:e.popup.onAddItems},null,8,["disabled","onClick"])],2)])),_:1},8,["active","class"])):((0,o.wg)(),(0,o.j4)(S.Z,{key:1,modelValue:y.value,"onUpdate:modelValue":t[2]||(t[2]=e=>y.value=e),title:(0,a.SU)(f),style:{width:"700px"},"cross-button":"",onClose:t[3]||(t[3]=t=>e.popup.onClose()),onTransitionOut:t[4]||(t[4]=t=>e.$emit("close"))},{footer:(0,o.w5)((()=>[(0,o._)("div",{class:(0,n.C_)(e.$style.footer)},[(0,o.Wm)(g.Z,{label:"Загрузить еще",theme:"gray",icon:"add_16",disabled:m.value,onClick:e.popup.onAddItems},null,8,["disabled","onClick"]),(0,o.Wm)(g.Z,{label:b.value,disabled:_.value,loading:!v.value,onClick:e.popup.onApply},null,8,["label","disabled","loading","onClick"])],2)])),default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,n.C_)(e.$style.content)},[(0,o._)("div",{class:(0,n.C_)(e.$style.info)}," Перетащите изображения, чтобы изменить порядок отображения в карусели. Максимальное число фотографий – 30. ",2),(0,o._)("div",{ref_key:"itemsEl",ref:s,class:(0,n.C_)(e.$style.items)},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.popup.items,((t,s)=>((0,o.wg)(),(0,o.j4)(vn,{key:t.id,item:t,class:(0,n.C_)(e.$style.item),onRemove:e=>d(s),onEdit:e=>p(s)},null,8,["item","class","onRemove","onEdit"])))),128))],2)],2)])),_:1},8,["modelValue","title"])),(0,o.Wm)(Gt.Z,{active:c.value,"onUpdate:active":t[5]||(t[5]=e=>c.value=e),title:"Удалить изображение?",content:"Вы действительно хотите удалить изображение?",onConfirm:u},null,8,["active"]),void 0!==i.value?((0,o.wg)(),(0,o.j4)(fs,{key:2,active:"",src:i.value.url,"onUpdate:active":t[6]||(t[6]=e=>i.value=void 0),onCropped:t[7]||(t[7]=t=>{e.popup.onUpdateImage(i.value.index,t),i.value=void 0})},null,8,["src"])):(0,o.kq)("v-if",!0)],64))}});var yn=s(52771),bn=s.n(yn);const wn={};wn.$style=bn();const kn=(0,b.Z)(fn,[["__cssModules",wn]]);function Sn(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function On(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Sn(Object(s),!0).forEach((function(t){En(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Sn(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function En(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Cn=(0,o.aZ)(On(On({},{inheritAttrs:!1}),{},{__name:"story-editor-view",props:{title:{default:""},loading:{type:Boolean},fixedTitle:{type:Boolean},media:{default:()=>[]},notificationsAllowed:{type:Boolean},blocksConfigs:{}},emits:["update:title","reset:title","event"],setup(e,{expose:t,emit:s}){(0,r.sj)((e=>({"6c488b65":M.value,e022f120:R.value})));const i=e,l=s,{editor:d,fabPosition:u,addContent:p,addFiles:h,disabled:_,theme:m,isBlocksReorderingMode:g,isThemeAllowed:v}=wr(),f=Ir(),y=(0,a.iH)(),b=(0,a.iH)(),w=(0,o.Fl)({get(){var e;return null!==(e=i.title)&&void 0!==e?e:""},set(e){l("update:title",e)}}),k=(0,o.Fl)((()=>d.value&&!m.value&&d.value.state.doc.childCount<=1&&!d.value.state.doc.textContent));function S(e){var t;("keyup"===e.type&&13===e.keyCode||"beforeinput"===e.type&&(null===(t=e.data)||void 0===t?void 0:t.endsWith("\n")))&&d.value.chain().insertContentAt(0,k.value?null:{type:"paragraph"}).focus("start").run()}function O(e){const t=e.target;if("INPUT"===t.nodeName||"TEXTAREA"===t.nodeName)return;const{empty:s,head:i}=d.value.state.selection,o=d.value.state.selection.$cursor;var r;s&&1===i&&("paragraph"!==o.parent.type.name||o.parent.content.size||d.value.commands.pkbDeleteAtomNode(0),null===(r=b.value)||void 0===r||r.focus())}const E=(0,o.Fl)((()=>f.isExperts?".popup__content":".app")),{x:C,y:x}=(f.isExperts,(0,c.baj)()),T=(0,xt.XL)(y),I=(0,xt.XL)(document.querySelector(E.value)),P=(0,o.Fl)((()=>{const e=d.value.view.coordsAtPos(u.value);if(!e.top)return null;const t=0+e.top-I.y.value,s=0+T.x.value-I.x.value;return{"--anchor-top":`${t}px`,"--anchor-left":`${s}px`,"--anchor-right":`${s+T.width.value}px`}}));(0,o.YP)((()=>i.media),(e=>{if(!e.length)return;const t=e.map((e=>{return"image"===(t=e).type&&t.file instanceof File?{type:"image",attrs:{source:e.file}}:"image-url"===e.type&&e.url?{type:"image",attrs:{source:e.url}}:"video"===e.type&&e.url?{type:"embedVideoLoader",attrs:{url:e.url}}:void 0;var t}));d.value.chain().insertContentAt(d.value.state.doc.content.size-1,t).focus().run()}),{immediate:!0});const A=ln(d,p),D=(0,a.iH)(!1);(0,o.YP)((()=>A.popup.isShown),(e=>{e&&(D.value=!0)})),(0,o.JJ)(B.yC,{editor:d,isBlocksReorderingMode:g,theme:m,title:w,isThemeAllowed:v,isNotificationsAllowed:(0,o.Fl)((()=>i.notificationsAllowed)),carouselService:A,addFiles:h,addContent:p}),(0,o.JJ)(B.z,{fundraising:{campaign:i.blocksConfigs.fundraising.campaign},poll:{MAX_OPTIONS_COUNT:i.blocksConfigs.poll.MAX_OPTIONS_COUNT,wasPublished:i.blocksConfigs.poll.wasPublished}});const M=(0,o.Fl)((()=>{var e,t;const s=null!==(e=null===(t=d.value)||void 0===t?void 0:t.state.doc.textContent.length)&&void 0!==e?e:0;return s<=100?"36px":s>180?"18px":"28px"})),R=(0,o.Fl)((()=>({"18px":"32px","28px":"36px","36px":"48px"}[M.value])));return t({focus:function(){d.value.chain().focus().run()},scrollTitleIntoView:function(){var e;null===(e=b.value)||void 0===e||e.scrollIntoView()},focusTitle:function(){var e;null===(e=b.value)||void 0===e||e.focus()}}),(e,t)=>((0,o.wg)(),(0,o.iD)(o.HY,null,[(0,a.SU)(d)?((0,o.wg)(),(0,o.iD)("div",(0,o.dG)({key:0,ref_key:"hostEl",ref:y,class:{[e.$style.host]:!0,[e.$style.host_disabled]:(0,a.SU)(_)}},e.$attrs,{onLoadCapture:t[3]||(t[3]=e=>(0,a.SU)(T).update())}),[i.loading?((0,o.wg)(),(0,o.j4)(rn.Z,{key:0,class:(0,n.C_)(e.$style.skeleton),ribs:e.IS_MOBILE?[92,100,87,100,98,61,100]:[88,100,73,96,91,100,75]},null,8,["class","ribs"])):((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[(0,o.Wm)(on,{ref_key:"titleEl",ref:b,modelValue:w.value,"onUpdate:modelValue":t[0]||(t[0]=e=>w.value=e),fixed:i.fixedTitle,disabled:(0,a.SU)(_),onReset:t[1]||(t[1]=e=>l("reset:title")),onKeyup:S,onBeforeinput:S},null,8,["modelValue","fixed","disabled"]),(0,o.Wm)((0,a.SU)(Ee.kg),{editor:(0,a.SU)(d),class:(0,n.C_)({[e.$style.content]:!0,[e.$style.content_short]:(0,a.SU)(m),[e.$style[`content_short-${(0,a.SU)(m)}`]]:(0,a.SU)(m)}),onKeydown:(0,r.D2)(O,["backspace"])},null,8,["editor","class","onKeydown"]),e.IS_MOBILE||(0,a.SU)(v)?((0,o.wg)(),(0,o.j4)(Kr,{key:0,modelValue:(0,a.SU)(m),"onUpdate:modelValue":t[2]||(t[2]=e=>(0,a.dq)(m)?m.value=e:null)},null,8,["modelValue"])):(0,o.kq)("v-if",!0)],64)),((0,o.wg)(),(0,o.j4)(o.lR,{to:E.value},[!(0,a.SU)(_)&&P.value?(0,o.wy)(((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,n.C_)(e.$style.fab),style:(0,n.j5)(P.value)},[(0,o.Wm)(Nr,{editor:(0,a.SU)(d),position:(0,a.SU)(u)},null,8,["editor","position"])],6)),[[r.F8,!(0,a.SU)(m)&&!(0,a.SU)(g)]]):(0,o.kq)("v-if",!0)],8,["to"]))],16)):(0,o.kq)("v-if",!0),D.value?((0,o.wg)(),(0,o.j4)(kn,{key:1,popup:(0,a.SU)(A).popup,onClose:t[4]||(t[4]=e=>D.value=!1)},null,8,["popup"])):(0,o.kq)("v-if",!0)],64))}}));var xn=s(52934),Tn=s.n(xn);const In={};In.$style=Tn();const Pn=(0,b.Z)(Cn,[["__cssModules",In]]),An=(0,Oe.Dt)((()=>{const e=Ir(),t=vr(),s=(0,Ee.jE)({content:br(e.storyUpdateBlocks),extensions:rr,onUpdate:({editor:s})=>{e.storyUpdateBlocks=t(s.state.doc)},onFocus:()=>(0,a.oR)(s),onBlur:()=>(0,a.oR)(s)}),i=(0,o.Fl)({get:()=>1===e.updPosition,set:t=>e.updPosition=t?1:0});return{editor:s,isAtStart:i}})),Dn=(0,o.aZ)({__name:"upd-editor-view",setup(e){const{editor:t,isAtStart:s}=An();return(e,i)=>(0,a.SU)(t)?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,n.C_)(e.$style.host)},[(0,o._)("h3",{class:(0,n.C_)(e.$style.title)}," UPD: ",2),(0,o._)("div",{class:(0,n.C_)(e.$style.wrapper)},[(0,o.Wm)((0,a.SU)(Ee.kg),{editor:(0,a.SU)(t)},null,8,["editor"]),(0,o.Wm)(As.Z,{modelValue:(0,a.SU)(s),"onUpdate:modelValue":i[0]||(i[0]=e=>(0,a.dq)(s)?s.value=e:null),contenteditable:"false",class:(0,n.C_)(e.$style.checkbox),label:"Опубликовать в начале поста"},null,8,["modelValue","class"])],2)],2)):(0,o.kq)("v-if",!0)}});var Mn=s(81418),Rn=s.n(Mn);const Nn={};Nn.$style=Rn();const Bn=(0,b.Z)(Dn,[["__cssModules",Nn]]),Ln=[(0,o._)("circle",{cx:"2",cy:"2",r:"2",fill:"currentColor"},null,-1)],jn=(0,o.aZ)({__name:"limit-view",setup(e,{expose:t}){const s=Ir(),{editor:i}=wr(),{editor:r}=An(),l=(0,a.iH)(),c=s.LIMIT_MAX_TEXT_BLOCKS_LENGTH,d=s.LIMIT_MAX_BLOCKS_COUNT,u=Math.round(.8*c),p=Math.round(.8*d),h=(0,o.Fl)((()=>Math.round(.8*s.mediaItemsLimit))),_=(0,o.Fl)((()=>{var e,t;return null!==(e=null===(t=r.value)||void 0===t?void 0:t.state.doc.textContent.length)&&void 0!==e?e:0})),m=(0,o.Fl)((()=>{var e;return(null===(e=i.value)||void 0===e?void 0:e.state.doc.textContent.length)+_.value})),g=(0,o.Fl)((()=>{var e;return(null===(e=i.value)||void 0===e?void 0:e.state.doc.childCount)+(_.value?1:0)})),v=(0,o.Fl)((()=>{var e;let t=0;return null===(e=i.value)||void 0===e||e.state.doc.content.forEach((e=>{"imagesCarousel"===e.type.name?t+=e.attrs.items.length:B.w_.has(e.type.name)&&t++})),t})),f=(0,o.Fl)((()=>{const e=[];return m.value>=u&&e.push({key:"chars",isExceeded:m.value>c,text:`${m.value}/${c} символов`}),g.value>=p&&e.push({key:"nodes",isExceeded:g.value>d,text:`${g.value}/${d} блоков`}),v.value>=h.value&&e.push({key:"media",isExceeded:v.value>s.mediaItemsLimit,text:`${v.value}/${s.mediaItemsLimit} медиа`}),e}));return(0,o.YP)((()=>g.value>d),((e,t)=>{e!==t&&he.cp.getInstance().sendEvent(e?"tip_show":"tip_close",{type:"editor_blocks_limit"})})),t({scrollIntoView:function(e){var t;null===(t=l.value)||void 0===t||t.scrollIntoView(e)}}),(e,t)=>f.value.length?((0,o.wg)(),(0,o.iD)("div",{key:0,ref_key:"hostEl",ref:l,class:(0,n.C_)(e.$style.host)},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(f.value,((t,s)=>((0,o.wg)(),(0,o.iD)(o.HY,{key:t.key},[s?((0,o.wg)(),(0,o.iD)("svg",{key:0,class:(0,n.C_)(e.$style.divider),width:"4",height:"4",viewBox:"0 0 4 4",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ln,2)):(0,o.kq)("v-if",!0),(0,o._)("div",{class:(0,n.C_)({[e.$style.limit]:!0,[e.$style.limit_exceeded]:t.isExceeded})},(0,n.zw)(t.text),3)],64)))),128))],2)):(0,o.kq)("v-if",!0)}});var $n=s(93160),Un=s.n($n);const Fn={};Fn.$style=Un();const Vn=(0,b.Z)(jn,[["__cssModules",Fn]]);var Hn=s(61258);const Zn=(0,o._)("span",null,"Рекомендованные теги:",-1),zn=["onClick"],qn=(0,o.aZ)({__name:"pkb-editor-tags",props:{modelValue:{},disabled:{type:Boolean},readonlyTags:{default:void 0},label:{default:"От 2 до 20 тегов через запятую"}},emits:["update:modelValue"],setup(e,{expose:t,emit:s}){const i=e,r=s,l=(0,Q.D3)(B.A1),c=(0,a.iH)(),d=(0,a.iH)(),u=(0,o.Fl)({get:()=>i.modelValue,set(e){r("update:modelValue",e)}}),p=Ir();return t({focus:function(){var e;null===(e=d.value)||void 0===e||e.focus()},scrollIntoView:function(e){var t;null===(t=c.value)||void 0===t||t.scrollIntoView(e)}}),(e,t)=>((0,o.wg)(),(0,o.iD)("div",{ref_key:"hostEl",ref:c,class:(0,n.C_)(e.$style.host)},[(0,o.Wm)(Hn.Z,{ref_key:"inputTag",ref:d,modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),borderless:"",size:"large",label:i.label,disabled:i.disabled,"readonly-tags":i.readonlyTags,onAddTag:t[1]||(t[1]=e=>(0,a.SU)(l).sendTagAddedEvent())},null,8,["modelValue","label","disabled","readonly-tags"]),(0,a.SU)(p).recommendedTags.length?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,n.C_)(e.$style.recommended)},[Zn,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,a.SU)(p).recommendedTags,(t=>((0,o.wg)(),(0,o.iD)("span",{key:t,class:(0,n.C_)(e.$style.tag),onClick:e=>function(e){if(i.disabled)return;const t=p.recommendedTags.indexOf(e);-1!==t&&(u.value.push(e),p.recommendedTags.splice(t,1),l.sendTagAddedEvent())}(t)},(0,n.zw)(t),11,zn)))),128))],2)):(0,o.kq)("v-if",!0)],2))}});var Wn=s(51820),Gn=s.n(Wn);const Yn={};Yn.$style=Gn();const Kn=(0,b.Z)(qn,[["__cssModules",Yn]]);var Xn=s(78699),Jn=s(92934),Qn=s(89536);function ea(e){return"image"===e.type?Boolean(e.url):"video_file"===e.type?Boolean(e.fid):"video"!==e.type||Boolean(e.url)}function ta(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class sa{constructor({scrollZoneSize:e,maxSpeed:t}){ta(this,"speedRate",0),ta(this,"time",0),ta(this,"isScrolling",!1),ta(this,"handleDragend",(()=>{this.setSpeedRate(0),document.removeEventListener("dragover",this.handleMove),document.removeEventListener("dragend",this.handleDragend,{capture:!0})})),ta(this,"handleMove",(e=>{const t=e.y,s=window.innerHeight-e.y;t&&t<this.scrollZoneSize?this.setSpeedRate(t/this.scrollZoneSize-1):s<this.scrollZoneSize?this.setSpeedRate(1-s/this.scrollZoneSize):this.setSpeedRate(0)})),ta(this,"handleFrame",(e=>{const t=e-this.time;this.time=performance.now();const s=this.speedRate*this.maxSpeed;window.scrollBy(0,s/1e3*t),this.isScrolling&&(this.requestId=requestAnimationFrame(this.handleFrame))})),this.scrollZoneSize=e,this.maxSpeed=t,this.init()}init(){document.addEventListener("dragstart",(()=>{document.addEventListener("dragover",this.handleMove),document.addEventListener("dragend",this.handleDragend,{capture:!0})}))}setSpeedRate(e){this.speedRate=e,this.speedRate?this.startScroll():this.stopScroll()}startScroll(){this.isScrolling||(this.isScrolling=!0,this.time=performance.now(),this.requestId&&cancelAnimationFrame(this.requestId),this.requestId=requestAnimationFrame(this.handleFrame))}stopScroll(){this.isScrolling=!1}}var ia=s(13218),oa=s.n(ia),ra=s(76122);const na=(0,o.aZ)({__name:"pkb-editor-controls",setup:e=>(e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:(0,n.C_)(e.$style.host)},[(0,o.WI)(e.$slots,"default")],2))});var aa=s(97226),la=s.n(aa);const ca={};ca.$style=la();const da=(0,b.Z)(na,[["__cssModules",ca]]);var ua=s(29333),pa=s(49170),ha=s(79902),_a=s(15917),ma=s(29818);const ga=(0,o.aZ)({__name:"editor-menu",setup(e){const{editor:t,theme:s,isBlocksReorderingMode:i}=wr(),{editor:r}=An(),d=(0,a.iH)();(0,o.YP)([()=>{var e;return null===(e=t.value)||void 0===e?void 0:e.isFocused},()=>{var e;return null===(e=r.value)||void 0===e?void 0:e.isFocused}],(([e,s])=>{e?d.value=t.value:s&&(d.value=r.value)}));const h=(0,o.Fl)((()=>d.value===t.value));function _({transaction:e}){e.getMeta("inputLink")&&(S.value=!0)}(0,o.YP)(d,((e,t)=>{null==t||t.off("transaction",_),null==e||e.on("transaction",_)}));const m=l.core.isInternalStaff,g=(0,o.Fl)({get:()=>Boolean(s.value),set(e){s.value=e?1:0}}),v=(0,ma.o)(d),{mentions:f,insertUserMention:y,mention:b}=(0,_a.$)({editor:d,type:ha.D.COMMENT}),w=(0,a.iH)(!1),k=(0,a.iH)(!1),S=(0,a.iH)(!1),O=(0,a.iH)(),E=(0,a.iH)();function C(){k.value=!1,i.value=!0}const{width:x}=(0,c.iPe)(),T=(0,o.Fl)((()=>x.value>1230?12:x.value>1058?10:x.value>980?9:5)),I=(0,o.Fl)((()=>{var e;return Boolean(!(null!==(e=d.value)&&void 0!==e&&e.isEditable))})),P=(0,o.Fl)((()=>{var e,t;return(null===(e=d.value)||void 0===e?void 0:e.isActive("headingFirst"))||(null===(t=d.value)||void 0===t?void 0:t.isActive("headingSecond"))})),A=(0,o.Fl)((()=>{var e,t;return(null===(e=d.value)||void 0===e?void 0:e.isActive("bulletList"))||(null===(t=d.value)||void 0===t?void 0:t.isActive("orderedList"))})),D=(0,o.Fl)((()=>{var e,t;return(null===(e=d.value)||void 0===e?void 0:e.isActive("image"))||(null===(t=d.value)||void 0===t?void 0:t.isActive("imagesCarousel"))})),M=(0,o.Fl)((()=>{var e,t;return(null!==(e=null===(t=d.value)||void 0===t?void 0:t.state.doc.childCount)&&void 0!==e?e:0)<3})),R=(0,o.Fl)((()=>{var e,t,s,o,r,n,a,l,c,u,p,_,v,f,y,b,k,S,E,x,T,R,N,B,L,j,$,U,F,V,H,Z,z,q,W,G,Y,K,X,J,Q,ee,te;return[{ref:e=>O.value=e,icon:"heading_16",label:"Заголовок",isActive:w.value,isDisabled:I.value||D.value||!(null!==(e=d.value)&&void 0!==e&&null!==(t=(s=e.can()).toggleHeadingFirst)&&void 0!==t&&t.call(s))&&!(null!==(o=d.value)&&void 0!==o&&null!==(r=(n=o.can()).toggleHeadingSecond)&&void 0!==r&&r.call(n)),onClick:()=>w.value=!w.value,isHidden:g.value,testId:"editor-ctrl-heading"},{icon:"bold_16",label:"Жирный (Ctrl+B)",isActive:null===(a=d.value)||void 0===a?void 0:a.isActive("bold"),isDisabled:I.value||!(null!==(l=d.value)&&void 0!==l&&null!==(c=(u=l.can()).toggleBold)&&void 0!==c&&c.call(u))||P.value,onClick:()=>{var e,t;null===(e=d.value)||void 0===e||e.commands.toggleBold(),null===(t=d.value)||void 0===t||t.chain().focus().run()},testId:"editor-ctrl-bold"},{icon:"italic_16",label:"Курсивный (Ctrl+I)",isActive:null===(p=d.value)||void 0===p?void 0:p.isActive("italic"),isDisabled:I.value||!(null!==(_=d.value)&&void 0!==_&&null!==(v=(f=_.can()).toggleItalic)&&void 0!==v&&v.call(f))||P.value,onClick:()=>{var e,t;null===(e=d.value)||void 0===e||e.commands.toggleItalic(),null===(t=d.value)||void 0===t||t.chain().focus().run()},testId:"editor-ctrl-italic"},{icon:"strikethrough_16",label:"Перечёркнутый (Ctrl+Shift+X)",isActive:null===(y=d.value)||void 0===y?void 0:y.isActive("strike"),isDisabled:I.value||!(null!==(b=d.value)&&void 0!==b&&null!==(k=(S=b.can()).toggleStrike)&&void 0!==k&&k.call(S))||P.value,onClick:()=>{var e,t;null===(e=d.value)||void 0===e||e.commands.toggleStrike(),null===(t=d.value)||void 0===t||t.chain().focus().run()},testId:"editor-ctrl-strike"},{icon:"link_16",label:"Ссылка (Ctrl+K)",isActive:null===(E=d.value)||void 0===E?void 0:E.isActive("link"),isDisabled:I.value||!(null!==(x=d.value)&&void 0!==x&&null!==(T=(R=x.can()).setLink)&&void 0!==T&&T.call(R))||P.value,onClick:()=>{var e;return null===(e=d.value)||void 0===e?void 0:e.commands.inputLink()},testId:"editor-ctrl-link"},{icon:"quote_16",label:"Цитата (Ctrl+Shift+2)",isActive:null===(N=d.value)||void 0===N?void 0:N.isActive("blockquote"),isDisabled:I.value||!(null!==(B=d.value)&&void 0!==B&&null!==(L=(j=B.can()).toggleBlockquote)&&void 0!==L&&L.call(j))||P.value,onClick:()=>{var e,t;null===(e=d.value)||void 0===e||e.commands.toggleBlockquote(),null===(t=d.value)||void 0===t||t.chain().focus().run()},isHidden:g.value,testId:"editor-ctrl-quote"},{icon:"text-block_16",label:"Врезка (Ctrl+Shift+H)",isActive:null===($=d.value)||void 0===$?void 0:$.isActive("highlight"),isDisabled:I.value||!(null!==(U=d.value)&&void 0!==U&&null!==(F=(V=U.can()).toggleHighlight)&&void 0!==F&&F.call(V))||P.value,onClick:()=>{var e,t;null===(e=d.value)||void 0===e||e.commands.toggleHighlight(),null===(t=d.value)||void 0===t||t.chain().focus().run()},isHidden:g.value,testId:"editor-ctrl-highlight"},{icon:"highlight_16",label:"Маркер (Ctrl+Shift+M)",isActive:null===(H=d.value)||void 0===H?void 0:H.isActive("marker"),isDisabled:I.value||!(null!==(Z=d.value)&&void 0!==Z&&null!==(z=(q=Z.can()).toggleMarker)&&void 0!==z&&z.call(q))||P.value,onClick:()=>{var e,t;null===(e=d.value)||void 0===e||e.commands.toggleMarker(),null===(t=d.value)||void 0===t||t.chain().focus().run()},isHidden:g.value,testId:"editor-ctrl-marker"},{icon:"tab_16",label:"Изменить уровень списка",isDisabled:I.value,onClick:()=>{var e;return null===(e=d.value)||void 0===e?void 0:e.chain().sinkListItem("listItem").focus().run()},isHidden:!0,testId:"editor-ctrl-tab"},{icon:"eye_hide_16",label:"Скрыть под спойлер (Ctrl+Shift+S)",isActive:null===(W=d.value)||void 0===W?void 0:W.isActive("spoiler"),isDisabled:I.value||!(null!==(G=d.value)&&void 0!==G&&null!==(Y=(K=G.can()).toggleSpoiler)&&void 0!==Y&&Y.call(K))||P.value,onClick:()=>{var e;return null===(e=d.value)||void 0===e?void 0:e.commands.toggleSpoiler()},testId:"editor-ctrl-spoiler"},{isSeparated:!0,icon:"list_format_16",label:"Ненумерованный список (Ctrl+Shift+7)",isActive:null===(X=d.value)||void 0===X?void 0:X.isActive("bulletList"),isDisabled:I.value||!h.value,onClick:()=>{var e;return null===(e=d.value)||void 0===e?void 0:e.chain().toggleBulletList().focus().run()},isHidden:g.value,testId:"editor-ctrl-ul"},{icon:"number_list_16",label:"Нумерованный список (Ctrl+Shift+8)",isActive:null===(J=d.value)||void 0===J?void 0:J.isActive("orderedList"),isDisabled:I.value||!h.value,onClick:()=>{var e;return null===(e=d.value)||void 0===e?void 0:e.chain().toggleOrderedList().focus().run()},isHidden:g.value,testId:"editor-ctrl-ol"},{isSeparated:!0,icon:"move_20",label:"Изменить порядок блоков",isDisabled:I.value||M.value||!h.value,onClick:()=>C(),isHidden:i.value||g.value,testId:"editor-ctrl-dnd-start"},{isSeparated:!0,icon:"checkmark_16",label:"Применить порядок блоков",isDisabled:!1,onClick:()=>i.value=!1,isHidden:!i.value,testId:"editor-ctrl-dnd-apply"},{isSeparated:!0,icon:"left_alignment_16",label:"По левому краю",isActive:null===(Q=d.value)||void 0===Q?void 0:Q.isActive({textAlign:"left"}),isDisabled:I.value||P.value||A.value||!h.value,onClick:()=>{var e;return null===(e=d.value)||void 0===e?void 0:e.commands.setTextAlign("left")},isHidden:g.value||!m,testId:"editor-ctrl-align-left"},{icon:"center_alignment_16",label:"По центру",isActive:null===(ee=d.value)||void 0===ee?void 0:ee.isActive({textAlign:"center"}),isDisabled:I.value||P.value||A.value||!h.value,onClick:()=>{var e;return null===(e=d.value)||void 0===e?void 0:e.commands.setTextAlign("center")},isHidden:g.value||!m,testId:"editor-ctrl-align-center"},{icon:"right_alignment_16",label:"По правому краю",isActive:null===(te=d.value)||void 0===te?void 0:te.isActive({textAlign:"right"}),isDisabled:I.value||P.value||A.value||!h.value,onClick:()=>{var e;return null===(e=d.value)||void 0===e?void 0:e.commands.setTextAlign("right")},isHidden:g.value||!m,testId:"editor-ctrl-align-right"},{isSeparated:!0,icon:"move_20",label:"Изменить порядок блоков",isDisabled:I.value||M.value,onClick:()=>C(),isHidden:!0,testId:"editor-ctrl-dnd-start"}].filter((e=>!e.isHidden))})),N=(0,o.Fl)((()=>R.value.slice(0,T.value))),B=(0,o.Fl)((()=>R.value.slice(T.value)));function L(){var e;null===(e=d.value)||void 0===e||e.commands.toggleHeadingFirst(),w.value=!1}function j(){var e;null===(e=d.value)||void 0===e||e.commands.toggleHeadingSecond(),w.value=!1}return(e,t)=>{const s=(0,o.Q2)("tooltip");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(da,(0,n.vs)((0,o.F4)(e.$attrs)),{default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,n.C_)(e.$style.buttons)},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(N.value,(t=>(0,o.wy)(((0,o.wg)(),(0,o.j4)(Yt.Z,{key:t.icon,ref_for:!0,ref:t.ref,"data-test":t.testId,icon:t.icon,active:t.isActive,disabled:Boolean(t.isDisabled),class:(0,n.C_)({[e.$style.button]:!0,[e.$style.button_separated]:t.isSeparated}),onClick:t.onClick},null,8,["data-test","icon","active","disabled","class","onClick"])),[[s,t.label]]))),128))],2),e.IS_MOBILE&&(0,a.SU)(i)?((0,o.wg)(),(0,o.j4)(Yt.Z,{key:0,"data-test":"editor-ctrl-dnd-apply",icon:"checkmark_16",class:(0,n.C_)(e.$style.moreButton),onClick:t[0]||(t[0]=e=>i.value=!1)},null,8,["class"])):B.value.length?((0,o.wg)(),(0,o.j4)(Yt.Z,{key:1,ref_key:"buttonMoreEl",ref:E,"data-test":"editor-ctrl-more",icon:"more_16",class:(0,n.C_)(e.$style.moreButton),onClick:t[1]||(t[1]=e=>k.value=!k.value)},null,8,["class"])):(0,o.kq)("v-if",!0),e.IS_MOBILE?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.j4)(zr,{key:2,class:(0,n.C_)(e.$style.shortText)},null,8,["class"]))])),_:1},16),e.IS_MOBILE?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.Wm)(p.Z,{modelValue:w.value,"onUpdate:modelValue":t[2]||(t[2]=e=>w.value=e)},{default:(0,o.w5)((()=>{var t,s;return[(0,o.Wm)(u.Z,{class:(0,n.C_)(e.$style.heading1),label:"Заголовок 1",active:null===(t=d.value)||void 0===t?void 0:t.isActive("headingFirst"),"data-test":"editor-ctrl-h1",onClick:L},null,8,["class","active"]),(0,o.Wm)(u.Z,{class:(0,n.C_)(e.$style.heading2),label:"Заголовок 2",active:null===(s=d.value)||void 0===s?void 0:s.isActive("headingSecond"),"data-test":"editor-ctrl-h2",onClick:j},null,8,["class","active"])]})),_:1},8,["modelValue"]),B.value.length?((0,o.wg)(),(0,o.j4)(p.Z,{key:0,modelValue:k.value,"onUpdate:modelValue":t[3]||(t[3]=e=>k.value=e)},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(B.value,((t,s)=>((0,o.wg)(),(0,o.iD)(o.HY,{key:t.icon},[t.isSeparated&&s?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,n.C_)(e.$style.divider)},null,2)):(0,o.kq)("v-if",!0),(0,o.Wm)(u.Z,{label:t.label,icon:t.icon,active:t.isActive,disabled:Boolean(t.isDisabled),"data-test":t.testId,onClick:e=>{k.value=!1,t.onClick()}},null,8,["label","icon","active","disabled","data-test","onClick"])],64)))),128))])),_:1},8,["modelValue"])):(0,o.kq)("v-if",!0)],64)):((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[(0,o.Wm)(Is.Z,{active:w.value,"onUpdate:active":t[4]||(t[4]=e=>w.value=e),for:O.value,direction:"bottom",alignment:"start",class:(0,n.C_)(e.$style.tooltipCard)},{default:(0,o.w5)((()=>{var t,s;return[(0,o.Wm)(u.Z,{class:(0,n.C_)(e.$style.heading1),label:"Заголовок 1",active:null===(t=d.value)||void 0===t?void 0:t.isActive("headingFirst"),"data-test":"editor-ctrl-h1","onUpdate:active":L},null,8,["class","active"]),(0,o.Wm)(u.Z,{class:(0,n.C_)(e.$style.heading2),label:"Заголовок 2",active:null===(s=d.value)||void 0===s?void 0:s.isActive("headingSecond"),"data-test":"editor-ctrl-h2","onUpdate:active":j},null,8,["class","active"])]})),_:1},8,["active","for","class"]),B.value.length?((0,o.wg)(),(0,o.j4)(Is.Z,{key:0,active:k.value,"onUpdate:active":t[5]||(t[5]=e=>k.value=e),for:E.value,direction:"bottom",class:(0,n.C_)(e.$style.tooltipBtn)},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(B.value,(t=>(0,o.wy)(((0,o.wg)(),(0,o.j4)(Yt.Z,{key:t.icon,ref_for:!0,ref:t.ref,"data-test":t.testId,icon:t.icon,active:t.isActive,disabled:Boolean(t.isDisabled),class:(0,n.C_)({[e.$style.button]:!0,[e.$style.button_separated]:t.isSeparated}),onClick:e=>{t.onClick(),k.value=!1}},null,8,["data-test","icon","active","disabled","class","onClick"])),[[s,t.label]]))),128))])),_:1},8,["active","for","class"])):(0,o.kq)("v-if",!0)],64)),d.value?((0,o.wg)(),(0,o.j4)(ua.Z,{key:2,active:S.value,"onUpdate:active":t[6]||(t[6]=e=>S.value=e),editor:d.value},null,8,["active","editor"])):(0,o.kq)("v-if",!0),d.value?((0,o.wg)(),(0,o.j4)(pa.Z,{key:3,disabled:!d.value.isFocused,mentions:(0,a.SU)(f),"selection-x":(0,a.SU)(v).x,"selection-y":(0,a.SU)(v).y,"selection-height":(0,a.SU)(v).height,"selection-text":(0,a.SU)(b),onInsert:t[7]||(t[7]=e=>(0,a.SU)(y)(e.name))},null,8,["disabled","mentions","selection-x","selection-y","selection-height","selection-text"])):(0,o.kq)("v-if",!0)],64)}}});var va=s(78378),fa=s.n(va);const ya={};ya.$style=fa();const ba=(0,b.Z)(ga,[["__cssModules",ya]]);var wa=s(74750);const ka=(0,o.aZ)({__name:"editor-view",setup(e){const t=Ir(),s=de(),i=(0,a.iH)([]),r=(0,a.iH)(),c=(0,a.iH)(),d=(0,a.iH)(),u=(0,a.iH)("");(0,o.bv)((async()=>{new sa({scrollZoneSize:100,maxSpeed:3e3}),t.setLocalStorageEditorId(),t.initRecommendationObserver(),oe.init({getLength:()=>{var e,s;return null!==(e=null===(s=t.storyBlocks)||void 0===s?void 0:s.length)&&void 0!==e?e:0}});try{var e;const t=null!==(e=await Qn.c.getMedia())&&void 0!==e?e:[],s=e=>oa()(e)&&"type"in e&&"video"===e.type&&"url"in e&&"string"==typeof e.url,o=e=>oa()(e)&&"type"in e&&"image-url"===e.type&&"url"in e&&"string"==typeof e.url;i.value=t.reduce(((e,t)=>(t instanceof File?e.push((0,O.f3)(t)):(s(t)||o(t))&&e.push(t),e)),[])}catch(s){console.warn("Could not initialize comstory images"),console.warn(s)}finally{Qn.c.cleanMedia()}t.draft&&h()})),(0,o.JJ)(B.Nx,{uploadImage:ys.Ix,loadImageByUrl:ys.uc,uploadVideo:ys.$x});const p=(0,Jn.D)((()=>{var e;null===(e=t.recommendationObserver)||void 0===e||e.call()}),U.uW),h=(0,Jn.D)((()=>{t.isPDS||(u.value=[t.tags,t.title,R.Utils.getTextContent(t.textContent)].join())}),U.QQ),_=(0,Jn.D)(((e,s)=>{e.includes(wa.x)&&!t.settings.is_adult&&(t.settings.is_adult=!0),e.includes("Моё")&&!t.settings.is_authors&&(t.settings.is_authors=!0),!e.includes(wa.x)&&s.includes(wa.x)&&t.settings.is_adult&&(t.settings.is_adult=!1),!e.includes("Моё")&&s.includes("Моё")&&t.settings.is_authors&&(t.settings.is_authors=!1)}),100),m=(0,Jn.D)((()=>{!t.settings.is_adult&&t.tags.includes(wa.x)&&(t.tags=t.tags.filter((e=>e!==wa.x))),!t.settings.is_authors&&t.tags.includes("Моё")&&(t.tags=t.tags.filter((e=>"Моё"!==e)))}),100);(0,o.YP)((()=>t.storyBlocks),((e,s)=>{const i=function(e,t=[]){const s=[...t];return{inserted:e.filter((e=>{const t=s.findIndex((t=>(null==t?void 0:t.id)===(null==e?void 0:e.id))),i=-1!==t;return i&&s.splice(t,1),!i})).filter(ea),removed:s.filter(ea)}}(e,s);i.inserted.length||i.removed.length?t.handleBlocksUpdate(i):p()})),(0,o.YP)((()=>t.settings.is_adult),(()=>{p(),m()})),(0,o.YP)((()=>t.settings.is_authors),m),(0,o.YP)((()=>t.tags),((e,t)=>{p(),h(),_(e,t)})),(0,o.YP)((()=>t.plainTextContent),h),(0,o.YP)((()=>t.publishError),(e=>{var s,i,o,n,a,l;e===_e.A.ERROR_BLOCKS_MIN&&(null===(s=c.value)||void 0===s||s.focus());e!==_e.A.ERROR_TAG_MIN_TAG&&e!==_e.A.ERROR_TAG_MAX_TAG||(null===(i=r.value)||void 0===i||i.scrollIntoView({block:"center"}),null===(o=r.value)||void 0===o||o.focus());e!==_e.A.ERROR_TITLE_RANGE&&e!==_e.A.ERROR_TITLE_CONTAIN_LINK||(null===(n=c.value)||void 0===n||n.scrollTitleIntoView(),null===(a=c.value)||void 0===a||a.focusTitle());e&&[_e.A.ERROR_TEXT_LENGTH,_e.A.ERROR_BLOCKS_MAX,_e.A.ERROR_BLOCKS_MEDIA_MAX].includes(e)&&(null===(l=d.value)||void 0===l||l.scrollIntoView({block:"center"}));t.publishError=null}));const{offsetTop:g}=(0,xt.PL)(),v=(0,o.Fl)((()=>l.core.ua.ios?"":{top:`${g.value}px`})),f={fundraising:{campaign:t.fundraising},poll:{MAX_OPTIONS_COUNT:t.MAX_POLLS_OPTIONS,wasPublished:t.wasPublished}};return(e,l)=>((0,o.wg)(),(0,o.j4)(ra.Z,{class:(0,n.C_)(e.$style.host),disabled:(0,a.SU)(t).locked},{default:(0,o.w5)((()=>[(0,o.Wm)(ba,{class:(0,n.C_)(e.$style.menu),style:(0,n.j5)(v.value)},null,8,["class","style"]),(0,o.Wm)(Pn,{ref_key:"storyEditor",ref:c,title:(0,a.SU)(t).title,"onUpdate:title":[l[0]||(l[0]=e=>(0,a.SU)(t).title=e),l[1]||(l[1]=e=>async function(){var e,s;if(!t.isNew)return;t.title||(t.parentStoryId=0);const i=Se.j.extractStoryURL(t.title).shift();if(!i)return void h();const o=await Qn.c.getInheritablePropsByUrl(i);o&&(t.title=be.o.unescape()(o.title),t.community=o.community_data?JSON.parse(o.community_data):null,t.parentStoryId=o.parent_story_id,t.tags=null!==(e=null===(s=o.tags)||void 0===s?void 0:s.split(",").map((e=>e.trim())))&&void 0!==e?e:[],t.settings.is_adult=o.is_adult)}())],loading:(0,a.SU)(s).isLoading,"fixed-title":Boolean((0,a.SU)(t).parentStoryId),media:i.value,"blocks-configs":f,"notifications-allowed":(0,a.SU)(t).notificationsAllowed,"data-theme":Boolean((0,a.SU)(t).theme),"onReset:title":l[2]||(l[2]=e=>(t.title="",void(t.parentStoryId=0)))},null,8,["title","loading","fixed-title","media","notifications-allowed","data-theme"]),(0,a.SU)(t).canEditUpdate?((0,o.wg)(),(0,o.j4)(Bn,{key:0})):(0,o.kq)("v-if",!0),(0,a.SU)(t).theme?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.j4)(Vn,{key:1,ref_key:"limitEl",ref:d},null,512)),(0,o.Wm)(Kn,{ref_key:"editorTags",ref:r,modelValue:(0,a.SU)(t).tags,"onUpdate:modelValue":l[3]||(l[3]=e=>(0,a.SU)(t).tags=e),disabled:!(0,a.SU)(t).canEditStory,"readonly-tags":(0,a.SU)(t).readonlyTags,label:`\n\t\t\t\tОт ${(0,a.SU)(t).LIMIT_MIN_TAGS_COUNT}\n\t\t\t\tдо ${(0,a.SU)(t).LIMIT_MAX_TAGS_COUNT} тегов через запятую\n\t\t\t`},null,8,["modelValue","disabled","readonly-tags","label"]),(0,o.Wm)(Xn.Z,{class:(0,n.C_)(e.$style.feedbackOffer),text:u.value},null,8,["class","text"])])),_:1},8,["class","disabled"]))}});var Sa=s(88490),Oa=s.n(Sa);const Ea={};Ea.$style=Oa();const Ca=(0,b.Z)(ka,[["__cssModules",Ea]]);var xa=s(75130);const Ta=(0,o.aZ)({__name:"community-value-message",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const s=e,i=t,r=Ir(),a=(0,o.Fl)({get:()=>Boolean(s.modelValue),set(e){r.locked||((new xa.U).set("isStoryEditorComValueHidden",!0),i("update:modelValue",e))}});return(e,t)=>a.value?((0,o.wg)(),(0,o.iD)("p",{key:0,class:(0,n.C_)(e.$style.host)},[(0,o._)("span",{class:(0,n.C_)([e.$style.cookie,"sprite sprite--ui__cookie_wink"])},null,2),(0,o._)("span",{class:(0,n.C_)(e.$style.header)}," Посты в сообществах реже получают минусы. Целых 93% из них имеют больше плюсов, чем минусов, и увереннее получают отклик сразу после публикации. ",2),(0,o._)("button",{title:"Скрыть",type:"button",class:(0,n.C_)(e.$style.close),onClick:t[0]||(t[0]=e=>a.value=!1)},[(0,o.Wm)(d.Z,{name:"close",size:16})],2)],2)):(0,o.kq)("v-if",!0)}});var Ia=s(58007),Pa=s.n(Ia);const Aa={};Aa.$style=Pa();const Da=(0,b.Z)(Ta,[["__cssModules",Aa]]);var Ma=s(26451),Ra=s(55317),Na=s(6564),Ba=s(34273);const La=(0,o.aZ)({__name:"pkb-community-details",setup:e=>(e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:(0,n.C_)(e.$style.host)},[(0,o.WI)(e.$slots,"default")],2))});var ja=s(47024),$a=s.n(ja);const Ua={};Ua.$style=$a();const Fa=(0,b.Z)(La,[["__cssModules",Ua]]),Va=["onClick"],Ha=(0,o.aZ)({__name:"pkb-community-selection",props:{communityId:{},communityName:{},communityLink:{},avatarSrc:{default:void 0},mode:{default:"add"},btnSize:{default:"medium"},hideBtn:{type:Boolean},compactBtn:{type:Boolean}},emits:["itemClick","linkClick","btnRemoveClick"],setup(e,{expose:t,emit:s}){const i=e,l=s,c=(0,a.iH)(),u=(0,o.Fl)((()=>"add"===i.mode)),p={add:{label:"Добавить",icon:"add_16",theme:"normal"},remove:{label:"Убрать",icon:"hide_16",theme:"gray"}},h=(0,o.Fl)((()=>i.hideBtn||i.compactBtn?"":p[i.mode].label));function _(){u.value?l("itemClick",i.communityId):l("btnRemoveClick",i.communityId)}function m(){l("linkClick",i.communityId),window.open("/community/"+i.communityLink,"_blank")}return t({focus:function(){null==c||c.value.focus()}}),(e,t)=>((0,o.wg)(),(0,o.iD)("div",{ref_key:"hostEl",ref:c,class:(0,n.C_)([e.$style.host,{[e.$style.host_add]:u.value}]),onClick:t[0]||(t[0]=(0,r.iM)((e=>l("itemClick",i.communityId)),["prevent"]))},[(0,o.Wm)(Ba.Z,{"community-name":i.communityName,url:i.avatarSrc,size:40,class:(0,n.C_)(e.$style.avatar)},null,8,["community-name","url","class"]),(0,o._)("div",{class:(0,n.C_)(e.$style.info)},[(0,o._)("h4",{class:(0,n.C_)(e.$style.title)},[(0,o._)("span",null,(0,n.zw)(i.communityName),1),(0,o._)("a",{class:(0,n.C_)(e.$style.link),rel:"noopener",target:"_blank",onClick:(0,r.iM)(m,["stop","prevent"])},[(0,o.Wm)(d.Z,{name:"new-tab_16",class:(0,n.C_)(e.$style.linkIcon),size:16},null,8,["class"])],10,Va)],2),(0,o.Wm)(Fa,null,{default:(0,o.w5)((()=>[(0,o.WI)(e.$slots,"details")])),_:3})],2),e.hideBtn?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.j4)(g.Z,{key:0,class:(0,n.C_)(e.$style.button),label:h.value,theme:p[i.mode].theme,icon:p[i.mode].icon,size:i.btnSize,onClick:_},null,8,["class","label","theme","icon","size"]))],2))}});var Za=s(89140),za=s.n(Za);const qa={};qa.$style=za();const Wa=(0,b.Z)(Ha,[["__cssModules",qa]]);var Ga=s(23279),Ya=s.n(Ga);const Ka=(0,o._)("span",null,"•",-1),Xa=(0,o._)("span",null,"•",-1),Ja=(0,o.aZ)({__name:"pkb-input-comunity",props:{label:{},size:{default:"medium"}},emits:["showDropdown","chooseCommunity"],setup(e,{expose:t,emit:s}){const i=s,l=e,c=(0,a.iH)([]),d=(0,a.iH)([]),u=(0,a.iH)(!1),p=(0,a.iH)(""),h=(0,a.iH)(),_=(0,a.iH)(!1),v=(0,a.iH)(!1),f=(0,a.iH)([]),y=(0,o.Fl)((()=>p.value.length>=2)),b=new Map;async function w(e=""){return e=e.toLowerCase().trim(),b.has(e)||b.set(e,await ke.yV.search(e)),b.get(e)||[]}async function k(){var e;0===(null===(e=c.value)||void 0===e?void 0:e.length)&&(c.value=await w()),d.value=[...c.value]}function S(e){i("chooseCommunity",e),i("showDropdown",!1),p.value="",u.value=!1,d.value=[]}function O(){y.value?_.value=!0:k()}function E(){k(),u.value=!0}function C(){var e;null===(e=h.value)||void 0===e||e.focus()}return(0,o.YP)(p,Ya()((async()=>{y.value?async function(e){v.value=!0,d.value=await w(e),v.value=!1}(p.value):_.value=!1}),300)),(0,o.YP)(d,(e=>{_.value=e.length>0,i("showDropdown",_.value)})),t({focusInput:C}),(e,t)=>e.IS_MOBILE?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.Wm)(g.Z,{wide:"",label:l.label,outline:"",onClick:E},null,8,["label"]),(0,o.Wm)(Na.Z,{modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=e=>p.value=e),active:u.value,"onUpdate:active":t[1]||(t[1]=e=>u.value=e),empty:y.value&&!d.value.length,loading:v.value,"show-list-with-empty-input":c.value.length>0,tip:"Пожалуйста, начните вводить название сообщества, а затем выберите из списка"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(d.value,((t,s)=>((0,o.wg)(),(0,o.j4)(Wa,{key:t.id||s,class:(0,n.C_)(e.$style.searchItem),"community-id":t.id,"community-name":t.name,"community-link":t.link,"avatar-src":t.avatar,"btn-size":"small",onClick:e=>S(t)},{details:(0,o.w5)((()=>[(0,o._)("span",null,(0,n.zw)(t.stories),1),Ka,(0,o._)("span",null,(0,n.zw)(t.subs),1)])),_:2},1032,["class","community-id","community-name","community-link","avatar-src","onClick"])))),128))])),_:1},8,["modelValue","active","empty","loading","show-list-with-empty-input"])],64)):((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[(0,o.Wm)(m.Z,{ref_key:"inputEl",ref:h,modelValue:p.value,"onUpdate:modelValue":t[2]||(t[2]=e=>p.value=e),label:l.label,size:l.size,clearable:"",loading:v.value,onFocus:O,onKeydown:[t[3]||(t[3]=(0,r.D2)((0,r.iM)((e=>{var t;v.value||null===(t=f.value[0])||void 0===t||t.focus()}),["prevent"]),["down"])),t[4]||(t[4]=(0,r.D2)((0,r.iM)((e=>{var t;null===(t=h.value)||void 0===t||t.blur()}),["prevent"]),["esc"]))]},null,8,["modelValue","label","size","loading"]),(0,o.Wm)(Ra.Z,{active:_.value,"onUpdate:active":t[7]||(t[7]=e=>_.value=e),for:h.value,"onClick:outside":t[8]||(t[8]=e=>_.value=!1)},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(d.value,((s,i)=>((0,o.wg)(),(0,o.j4)(Wa,{ref_for:!0,ref_key:"communityRefs",ref:f,key:i,class:(0,n.C_)(e.$style.searchItem),"community-id":s.id,"community-name":s.name,"community-link":s.link,"avatar-src":s.avatar,"hide-btn":"","btn-size":"small",tabindex:"0",onItemClick:e=>S(s),onLinkClick:t[5]||(t[5]=e=>_.value=!1),onKeydown:[(0,r.D2)((0,r.iM)((e=>function(e){var t;0!==e?null===(t=f.value[e-1])||void 0===t||t.focus():C()}(i)),["prevent"]),["up"]),(0,r.D2)((0,r.iM)((e=>function(e){var t;null===(t=f.value[e+1])||void 0===t||t.focus()}(i)),["prevent"]),["down"]),t[6]||(t[6]=(0,r.D2)((0,r.iM)((e=>async function(){C(),await(0,o.Y3)(),_.value=!1}()),["prevent"]),["esc"])),(0,r.D2)((0,r.iM)((e=>S(s)),["prevent"]),["enter"])]},{details:(0,o.w5)((()=>[(0,o._)("span",null,(0,n.zw)(s.stories),1),Xa,(0,o._)("span",null,(0,n.zw)(s.subs),1)])),_:2},1032,["class","community-id","community-name","community-link","avatar-src","onItemClick","onKeydown"])))),128))])),_:1},8,["active","for"])],64))}});var Qa=s(20650),el=s.n(Qa);const tl={};tl.$style=el();const sl=(0,b.Z)(Ja,[["__cssModules",tl]]),il=(0,o.aZ)({__name:"search-community",setup(e,{expose:t}){const s=Ir(),i=(0,a.iH)(),r=(0,Q.D3)(B.A1);function n(e){e.is_preview&&s.settings.is_story_boost?l.core.ui.toasts.add({theme:Ma.K.WARNING,content:"Сейчас Пикабуст нельзя применить к посту в сообществе с премодерацией. Но вы сможете сделать это после публикации"}):(s.community=e,r.sendCommunitySelectedEvent({community:e}),e.is_locked&&l.core.ui.toasts.add({theme:Ma.K.WARNING,content:"Вы пытаетесь добавить пост в заблокированное сообщество"}))}return t({focusInput:function(){var e;null===(e=i.value)||void 0===e||e.focusInput()}}),(e,t)=>((0,o.wg)(),(0,o.j4)(sl,{ref_key:"inputEl",ref:i,label:e.IS_MOBILE?"Выбрать сообщество (не обязательно)":"Начните вводить название сообщества (не обязательно)",size:"large",onChooseCommunity:n},null,8,["label"]))}}),ol=il,rl=(0,o._)("span",null,"•",-1),nl=(0,o.aZ)({__name:"recommended-communities",setup(e){const t=Ir(),s=(0,Q.D3)(B.A1);function i(e){const i=t.recommendedCommunity(e);i&&(t.community=i,s.sendCommunitySelectedEvent({community:i,fromRecommended:!0}))}function l(e){N.c.getInstance().sendEvent("transition_to_community",{type:"post_add_rec",community_id:e})}return(e,s)=>(0,o.wy)(((0,o.wg)(),(0,o.iD)("div",{class:(0,n.C_)(e.$style.host)},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,a.SU)(t).recommendedCommunities,(t=>((0,o.wg)(),(0,o.j4)(Wa,{key:t.id,class:(0,n.C_)(e.$style.community),"community-id":t.id,"community-name":t.name,"community-link":t.link,"avatar-src":t.avatar,"btn-size":"small",onItemClick:i,onLinkClick:l},{details:(0,o.w5)((()=>[(0,o._)("span",null,(0,n.zw)(t.stories),1),rl,(0,o._)("span",null,(0,n.zw)(t.subs),1)])),_:2},1032,["class","community-id","community-name","community-link","avatar-src"])))),128))],2)),[[r.F8,(0,a.SU)(t).recommendedCommunities.length]])}});var al=s(90478),ll=s.n(al);const cl={};cl.$style=ll();const dl=(0,b.Z)(nl,[["__cssModules",cl]]);var ul=s(17706);const pl=(0,o._)("span",null,"•",-1),hl=(0,o._)("h4",null,"Правила сообщества",-1),_l=["innerHTML"],ml=(0,o.aZ)({__name:"selected-community",emits:["remove"],setup(e,{emit:t}){const s=t,i=Ir(),l=(0,a.iH)(),c=(0,a.iH)(!1),u=(0,o.Fl)((()=>c.value?"60px":void 0));function p(e){N.c.getInstance().sendEvent("transition_to_community",{type:"post_add_selected",community_id:e})}function h(){i.community=null,s("remove")}return(0,ul.R)(l,{onMounted:()=>{c.value=l.value.offsetHeight>60},onUnmounted:()=>{c.value=!1}}),(e,t)=>(0,a.SU)(i).community?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.Wm)(Wa,{"community-id":(0,a.SU)(i).community.id,"community-name":(0,a.SU)(i).community.name,"avatar-src":(0,a.SU)(i).community.avatar,"community-link":(0,a.SU)(i).community.link,mode:"remove",onBtnRemoveClick:h,onLinkClick:p},{details:(0,o.w5)((()=>[(0,o._)("span",null,(0,n.zw)((0,a.SU)(i).community.stories),1),pl,(0,o._)("span",null,(0,n.zw)((0,a.SU)(i).community.subs),1)])),_:1},8,["community-id","community-name","avatar-src","community-link"]),(0,a.SU)(i).community.rules?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,n.C_)(e.$style.rules)},[hl,(0,o._)("div",{ref_key:"rulesEl",ref:l,class:(0,n.C_)(e.$style.list),style:(0,n.j5)({maxHeight:u.value}),innerHTML:(0,a.SU)(i).community.rules},null,14,_l),c.value?((0,o.wg)(),(0,o.iD)("a",{key:0,class:(0,n.C_)(e.$style.moreBtn),onClick:t[0]||(t[0]=(0,r.iM)((e=>c.value=!1),["prevent"]))},[(0,o.Uk)(" Подробнее "),(0,o.Wm)(d.Z,{class:(0,n.C_)(e.$style.moreIcon),name:"arrow_down_16"},null,8,["class"])],2)):(0,o.kq)("v-if",!0)],2)):(0,o.kq)("v-if",!0)],64)):(0,o.kq)("v-if",!0)}});var gl=s(33441),vl=s.n(gl);const fl={};fl.$style=vl();const yl=(0,b.Z)(ml,[["__cssModules",fl]]),bl=(0,o.aZ)({__name:"story-edit-page-communities",setup(e){const t=Ir(),s=(0,a.iH)(!(new xa.U).get("isStoryEditorComValueHidden")),i=(0,a.iH)();async function n(){var e;await(0,o.Y3)(),null===(e=i.value)||void 0===e||e.focusInput()}return(e,l)=>((0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(yl,{onRemove:n}),(0,o.wy)((0,o._)("div",null,[(0,o.Wm)(Da,{modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=e=>s.value=e)},null,8,["modelValue"]),(0,o.Wm)(ol,{ref_key:"searchCommunities",ref:i},null,512),(0,o.Wm)(dl)],512),[[r.F8,!(0,a.SU)(t).community]])],64))}});var wl=s(9771),kl=s(55946);const Sl=(0,o.aZ)({__name:"list-view",emits:["update:modelValue"],setup(e,{emit:t}){const s=t,{sendEvent:i}=(0,kl.z)(),r=Ir(),l=de(),c=(0,a.iH)(!1),u=(0,a.iH)(null);function p(){s("update:modelValue",!1)}return(0,o.bv)((async()=>{await l.getList(),l.count=l.list.length,i("click",{type:"drafts_create_post",size:l.count}),l.isLimitExceeded&&i("tip_show",{type:"drafts_limit"})})),(e,t)=>((0,o.wg)(),(0,o.iD)("div",null,[(0,a.SU)(l).isLimitExceeded?((0,o.wg)(),(0,o.j4)(Ji.Z,{key:0,theme:"red",class:(0,n.C_)(e.$style.alert)},{default:(0,o.w5)((()=>[(0,o.Uk)(" Вы создали максимальное количество черновиков. Продолжите один из них или удалите неактуальные черновики ")])),_:1},8,["class"])):(0,o.kq)("v-if",!0),(0,o._)("div",{class:(0,n.C_)(e.$style.container)},[(0,a.SU)(l).listLoading?((0,o.wg)(!0),(0,o.iD)(o.HY,{key:1},(0,o.Ko)((0,a.SU)(l).count,(t=>((0,o.wg)(),(0,o.j4)(rn.Z,{key:t,class:(0,n.C_)(e.$style.loader),ribs:e.IS_MOBILE?[88,100,73]:[92,100]},null,8,["class","ribs"])))),128)):((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,a.SU)(l).list,((t,s)=>((0,o.wg)(),(0,o.j4)(wl.Z,{id:t.id,key:t.id,tabindex:"0",loading:u.value===t.id,class:(0,n.C_)(e.$style.draft),title:t.title,"title-class":e.$style.draftTitle,text:t.text,"text-class":e.$style.draftText,"created-at":t.createdAt,"created-interval":t.createdInterval,"img-count":t.imgCount,"video-count":t.videoCount,"polls-count":t.pollsCount,"fundraising-widgets-count":t.fundraisingWidgetsCount,onClick:e=>async function(e,t){e!==u.value&&(p(),await l.load(e),i("draft_post_choose",{size:l.count,draft_id:e,screen_index:t+1}))}(t.id,s),onDelete:e=>async function(e){r.locked?p():l.isLoading||(l.count<=1&&p(),u.value=e,await l.delete(e),u.value=null,i("delete_draft_post",{draft_id:e,type:"drafts_popup"}))}(t.id)},null,8,["id","loading","class","title","title-class","text","text-class","created-at","created-interval","img-count","video-count","polls-count","fundraising-widgets-count","onClick","onDelete"])))),128)),(0,o._)("button",{type:"button",class:(0,n.C_)(e.$style.deleteAll),onClick:t[0]||(t[0]=e=>{l.isLoading||(c.value=!0)})},[(0,o.Wm)(d.Z,{name:"delete_16",size:16,class:(0,n.C_)(e.$style.deleteAllIcon)},null,8,["class"]),(0,o.Uk)(" Удалить все ")],2),(0,o.Wm)(Gt.Z,{active:c.value,"onUpdate:active":t[1]||(t[1]=e=>c.value=e),title:"Удалить все черновики",content:"Вы действительно хотите удалить все черновики? Это действие нельзя будет отменить",onConfirm:t[2]||(t[2]=e=>{l.isLoading||(l.deleteAll(),p())})},null,8,["active"])],64))],2)]))}});var Ol=s(56765),El=s.n(Ol);const Cl={};Cl.$style=El();const xl=(0,b.Z)(Sl,[["__cssModules",Cl]]),Tl=(0,o.aZ)({__name:"story-page-drafts",setup(e){const t=Ir(),s=de(),i=(0,a.iH)(!1),l=(0,o.Fl)((()=>`Черновики (${s.count}/${s.limit})`));async function c(){t.locked||(i.value=!0)}return(0,o.bv)((()=>{const e=!t.isScheduled&&Boolean(null==s?void 0:s.draftId);s.isLimitExceeded&&!e&&c()})),(0,o.YP)((()=>s.count),(e=>{e<=0&&(i.value=!1)})),(0,o.YP)(i,(e=>{t.notificationsAllowed=!e}),{immediate:!0}),(e,u)=>((0,o.wg)(),(0,o.iD)(o.HY,null,[(0,a.SU)(s).count>0?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,n.C_)(e.$style.info)},[e.IS_MOBILE?((0,o.wg)(),(0,o.j4)(un.Z,{key:0,active:i.value,title:l.value,"close-locked":(0,a.SU)(s).isLimitExceeded,"onUpdate:active":u[1]||(u[1]=e=>i.value=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(xl,{modelValue:i.value,"onUpdate:modelValue":u[0]||(u[0]=e=>i.value=e)},null,8,["modelValue"])])),_:1},8,["active","title","close-locked"])):((0,o.wg)(),(0,o.j4)(S.Z,{key:1,modelValue:i.value,"onUpdate:modelValue":u[3]||(u[3]=e=>i.value=e),title:l.value,"close-locked":(0,a.SU)(s).isLimitExceeded,style:{width:"668px"},theme:"gray","cross-button":""},{default:(0,o.w5)((()=>[(0,o.Wm)(xl,{modelValue:i.value,"onUpdate:modelValue":u[2]||(u[2]=e=>i.value=e)},null,8,["modelValue"])])),_:1},8,["modelValue","title","close-locked"])),(0,a.SU)(t).isExperts?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.iD)("button",{key:2,type:"button",class:(0,n.C_)([e.$style.btn,{[e.$style.btn_limit]:(0,a.SU)(s).isLimitExceeded}]),onClick:u[4]||(u[4]=e=>c())},[(0,a.SU)(false)?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.j4)(d.Z,{key:0,name:"edit-page_20",size:20,class:(0,n.C_)(e.$style.icon)},null,8,["class"])),(0,o.Uk)(" "+(0,n.zw)((0,a.SU)(s).count)+"/"+(0,n.zw)((0,a.SU)(s).limit)+" черновиков ",1)],2)),(0,o.Wm)(r.uT,{name:e.$style.saved},{default:(0,o.w5)((()=>[(0,a.SU)(s).savedTime?((0,o.wg)(),(0,o.iD)("span",{key:0,class:(0,n.C_)(e.$style.saved)},[(0,a.SU)(false)?((0,o.wg)(),(0,o.j4)(d.Z,{key:0,name:"edit-page_20",size:20,class:(0,n.C_)(e.$style.icon)},null,8,["class"])):(0,o.kq)("v-if",!0),(0,o.Uk)(" Сохранено в "+(0,n.zw)((0,a.SU)(s).savedTime),1)],2)):(0,o.kq)("v-if",!0)])),_:1},8,["name"])],2)):(0,o.kq)("v-if",!0),(0,o.WI)(e.$slots,"default")],64))}});var Il=s(4535),Pl=s.n(Il);const Al={};Al.$style=Pl();const Dl=(0,b.Z)(Tl,[["__cssModules",Al]]);var Ml=s(37103),Rl=s(58330);const Nl=(0,o.aZ)({__name:"story-edit-page-preview-popup",props:{active:{type:Boolean,default:!1}},emits:["update:active","click:publish"],setup(e,{emit:t}){const s=e,i=t,r=Ir();let c,d=null;const u=(0,a.iH)(),p=(0,a.iH)(!1),h=(0,a.iH)(!1);return(0,o.YP)((()=>s.active),(e=>{e?async function(){if(h.value)return;h.value=!0;try{c=await r.getPreview(),p.value=!0}catch(e){l.core.ui.toasts.showError(e),i("update:active",!1)}finally{h.value=!1}}():p.value=!1})),(0,o.Ah)((()=>{var e,t;null===(e=d)||void 0===e||e.clear(),null===(t=d)||void 0===t||t.destroy()})),(0,o.m0)((()=>{if(!p.value||!u.value)return;const e=Rl.S.getInstance().get("StoriesFeed");d=new e({useEmptyIds:!0,$el:u.value,feedName:"story-preview"}),d.$els.container.html(c);const t=d.$els.container.find('time.story__datetime[data-scheduled="1"]').get(0);t&&t.dateTime&&(t.innerText=te()(t.dateTime).format("DD.MM.YYYY HH:mm")),d.initStories()}),{flush:"post"}),(e,t)=>e.IS_MOBILE?((0,o.wg)(),(0,o.j4)(un.Z,{key:0,active:p.value,title:"Предпросмотр",class:(0,n.C_)(e.$style.popup),"onUpdate:active":t[1]||(t[1]=e=>i("update:active",e))},{default:(0,o.w5)((()=>[(0,o._)("div",{ref_key:"previewEl",ref:u,class:(0,n.C_)(e.$style.content)},null,2),(0,o._)("div",{class:(0,n.C_)(e.$style.footer)},[(0,o.Wm)(g.Z,{label:(0,a.SU)(r).submitButtonLabel,loading:(0,a.SU)(r).isSavingInProgress,wide:"","data-test":"story-preview-publish",onClick:t[0]||(t[0]=e=>i("click:publish"))},null,8,["label","loading"])],2)])),_:1},8,["active","class"])):((0,o.wg)(),(0,o.j4)(S.Z,{key:1,"model-value":p.value,title:"Предпросмотр",style:{width:"748px"},theme:"gray","cross-button":"","onUpdate:modelValue":t[3]||(t[3]=e=>i("update:active",e))},{footer:(0,o.w5)((()=>[(0,o.Wm)(g.Z,{label:(0,a.SU)(r).submitButtonLabel,loading:(0,a.SU)(r).isSavingInProgress,"data-test":"story-preview-publish",onClick:t[2]||(t[2]=e=>i("click:publish"))},null,8,["label","loading"])])),default:(0,o.w5)((()=>[(0,o._)("div",{ref_key:"previewEl",ref:u,class:(0,n.C_)(e.$style.content)},null,2)])),_:1},8,["model-value"]))}});var Bl=s(55066),Ll=s.n(Bl);const jl={};jl.$style=Ll();const $l=(0,b.Z)(Nl,[["__cssModules",jl]]);var Ul=s(97323);const Fl=(0,o.aZ)({__name:"story-edit-page-publish",setup(e){const t=Ir(),s=de(),i=(0,Q.D3)(B.A1),d=(0,a.iH)(!1),h=(0,a.iH)(!1),_=(0,a.iH)(!1),m=(0,a.iH)(!1),v=(0,a.iH)(!1),f=(0,o.Fl)((()=>!t.title&&t.isContentEmpty||!t.isScheduledTimeValid)),y=(0,o.Fl)((()=>t.isEditorEmpty||t.isSomeLimitExceeded));async function b(){if((l.core.initParams.isConfirmed||await(new Ul.R).show(Ul.J.STORY))&&!t.locked){(!t.isPDS&&t.settings.is_not_advert||!t.settings.is_advert_blogs&&!t.isCustomAdverts)&&(t.settings.advert_company="");try{const{response:e,data:s}=await t.publishStory();if(!e.result)throw Error(e.message);if(i.sendStoryPublishedEvent({storyId:s.story_id}),v.value=!0,t.settings.scheduled_time){return!t.scheduleId&&N.c.getInstance().sendEvent("posting_schedule",{draft_id:t.publishPayload.draft_id,scheduled_date:t.settings.scheduled_time}),void l.core.history.redirect(`/@${l.core.initParams.userName}#scheduled-story-alert`)}l.core.history.redirect(s.redirect_url)}catch(e){const t=e instanceof Error?e.message:e;t&&l.core.ui.toasts.showError(t)}}}async function w(){try{(!t.isPDS&&t.settings.is_not_advert||!t.settings.is_advert_blogs&&!t.isCustomAdverts)&&(t.settings.advert_company=""),t.validate(),i.sendStoryPreviewEvent(),h.value=!0}catch(e){const t=e instanceof Error?e.message:e;t&&l.core.ui.toasts.showError(t)}finally{_.value=!1}}async function k(){var e,i;s.isSaving||s.isLoading||y.value||t.locked||(_.value=!1,s.isSaved||(t.isEditorEmpty?s.delete(null===(i=s.draft)||void 0===i?void 0:i.id):(await s.save(),N.c.getInstance().sendEvent("save_draft_post",{draft_id:null===(e=s.draft)||void 0===e?void 0:e.id}))))}function S(){_.value=!1,m.value=Boolean(s.draft)}t.isPDS||(0,c.ORN)(window,"beforeunload",(e=>{if(!v.value&&!s.isSaved)return e.returnValue=!0,"Не вся информация была сохранена. Вы действительно хотите покинуть данную страницу?"})),t.isNew&&(t.isNormal||t.isExperts)&&(0,o.YP)((()=>t.data),(0,Jn.D)((async function(){try{d.value=!0,await k()}finally{d.value=!1}}),U.K0));const O=(0,a.iH)(!1);if(l.core.ua.ios){const e=200,t=window.visualViewport;t&&(0,c.ORN)(t,"resize",(()=>{O.value=window.innerHeight-t.height>=e}))}return(e,i)=>{const l=(0,o.Q2)("tooltip");return(0,o.wg)(),(0,o.iD)(o.HY,null,[e.IS_MOBILE?((0,o.wg)(),(0,o.j4)(ra.Z,{key:0,class:(0,n.C_)([e.$style.card,{[e.$style.card_disabled]:(0,a.SU)(t).locked,[e.$style.card_static]:O.value}]),disabled:(0,a.SU)(t).locked},{default:(0,o.w5)((()=>[(0,a.SU)(t).isPDS?((0,o.wg)(),(0,o.j4)(g.Z,{key:0,wide:"",label:(0,a.SU)(t).submitButtonLabel,loading:(0,a.SU)(t).isSavingInProgress,disabled:f.value,"data-test":"story-publish",onClick:i[0]||(i[0]=e=>b())},null,8,["label","loading","disabled"])):((0,o.wg)(),(0,o.j4)(Dl,{key:1},{default:(0,o.w5)((()=>[((0,o.wg)(),(0,o.j4)((0,o.LL)((0,a.SU)(t).isExperts?g.Z:Ml.Z),{wide:"",label:(0,a.SU)(t).submitButtonLabel,loading:(0,a.SU)(t).isSavingInProgress||(0,a.SU)(t).isPreviewInProgress,disabled:f.value,icon:(0,a.SU)(t).isExperts?void 0:"more_16","data-test":"story-publish",onClick:i[5]||(i[5]=e=>b()),"onClick:extra":i[6]||(i[6]=e=>_.value=!0)},{default:(0,o.w5)((()=>[(0,a.SU)(t).isExperts?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.j4)(p.Z,{key:0,modelValue:_.value,"onUpdate:modelValue":i[4]||(i[4]=e=>_.value=e)},{default:(0,o.w5)((()=>[(0,a.SU)(t).isNew?(0,o.wy)(((0,o.wg)(),(0,o.j4)(u.Z,{key:0,label:"Сохранить черновик",onClick:i[1]||(i[1]=e=>k())},null,512)),[[r.F8,!y.value]]):(0,o.kq)("v-if",!0),(0,a.SU)(t).isNew?(0,o.wy)(((0,o.wg)(),(0,o.j4)(u.Z,{key:1,label:"Удалить черновик",onClick:i[2]||(i[2]=e=>S())},null,512)),[[r.F8,(0,a.SU)(s).draftId]]):(0,o.kq)("v-if",!0),(0,o.Wm)(u.Z,{label:"Предпросмотр",disabled:(0,a.SU)(t).isPreviewInProgress,onClick:i[3]||(i[3]=e=>w())},null,8,["disabled"])])),_:1},8,["modelValue"]))])),_:1},40,["label","loading","disabled","icon"]))])),_:1}))])),_:1},8,["class","disabled"])):((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[(0,a.SU)(t).isNew&&(0,a.SU)(t).isNormal?((0,o.wg)(),(0,o.j4)(ra.Z,{key:0,class:(0,n.C_)(e.$style.card),disabled:(0,a.SU)(t).locked},{default:(0,o.w5)((()=>[(0,o.Wm)(Dl,null,{default:(0,o.w5)((()=>[(0,o.Wm)(Ml.Z,{wide:"",label:"Сохранить черновик",theme:"gray","extra-hint":"Удалить черновик",loading:(0,a.SU)(s).isSaving&&!d.value,disabled:y.value,"extra-disabled":!(0,a.SU)(s).draftId,icon:"delete_16",onClick:i[7]||(i[7]=e=>k()),"onClick:extra":i[8]||(i[8]=e=>S())},null,8,["loading","disabled","extra-disabled"])])),_:1})])),_:1},8,["class","disabled"])):(0,o.kq)("v-if",!0),(0,o.Wm)(ra.Z,{class:(0,n.C_)(e.$style.card),disabled:(0,a.SU)(t).locked},{default:(0,o.w5)((()=>[(0,o.Wm)(g.Z,{wide:!(0,a.SU)(t).isExperts,label:(0,a.SU)(t).submitButtonLabel,loading:(0,a.SU)(t).isSavingInProgress,disabled:f.value,"data-test":"story-publish",onClick:i[9]||(i[9]=e=>b())},null,8,["wide","label","loading","disabled"]),(0,a.SU)(t).isPDS||(0,a.SU)(t).isExperts?(0,o.kq)("v-if",!0):(0,o.wy)(((0,o.wg)(),(0,o.j4)(g.Z,{key:0,wide:"",label:"Предпросмотр",outline:"",loading:(0,a.SU)(t).isPreviewInProgress,class:(0,n.C_)(e.$style.previewButton),onClick:i[10]||(i[10]=e=>w())},null,8,["loading","class"])),[[l,"Посмотреть, как будет выглядеть пост после публикации"]])])),_:1},8,["class","disabled"])],64)),(0,o.Wm)(Gt.Z,{active:m.value,"onUpdate:active":i[11]||(i[11]=e=>m.value=e),title:"Удалить черновик",content:"Вы действительно хотите удалить черновик?",onConfirm:i[12]||(i[12]=e=>function(){var e;if(m.value=!1,t.locked)return;const i=null===(e=s.draft)||void 0===e?void 0:e.id;s.delete(i),_.value=!1,N.c.getInstance().sendEvent("delete_draft_post",{draft_id:i,type:"post_editor"})}())},null,8,["active"]),(0,o.Wm)($l,{active:h.value,"onUpdate:active":i[13]||(i[13]=e=>h.value=e),"onClick:publish":i[14]||(i[14]=e=>b())},null,8,["active"])],64)}}});var Vl=s(79983),Hl=s.n(Vl);const Zl={};Zl.$style=Hl();const zl=(0,b.Z)(Fl,[["__cssModules",Zl]]);var ql=s(47961),Wl=s(3485),Gl=s(50451);const Yl=["disabled"],Kl=["disabled"],Xl=(0,o.aZ)({__name:"pkb-input-time",props:{size:{default:"medium"},modelValue:{},error:{type:[String,Boolean],default:!1},showErrorImmediately:{type:Boolean},disabled:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const s=e,i=t,l=(0,a.iH)(),c=(0,a.iH)(),d=(0,a.iH)(p(Math.floor(s.modelValue/60))),u=(0,a.iH)(h(s.modelValue%60));function p(e){return Math.min(Number(e),23).toString().padStart(2,"0")}function h(e){return Math.min(Number(e),59).toString().padStart(2,"0")}function _(){const e=60*Number(d.value)+Math.min(Number(u.value),59);d.value=p(Math.floor(e/60)),u.value=h(e%60)}function m(e){return e.slice(0,2).replace(/\D/gi,"")}function g(){d.value=m(d.value),u.value=m(u.value),i("update:modelValue",60*Number(d.value)+Number(u.value))}return(e,t)=>((0,o.wg)(),(0,o.j4)(Gl.Z,{size:s.size,error:s.error,"show-error-immediately":s.showErrorImmediately,disabled:s.disabled},{default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,n.C_)(e.$style.wrapper)},[(0,o.wy)((0,o._)("input",{ref_key:"hourEl",ref:l,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),class:(0,n.C_)([e.$style.input,e.$style.input_hour]),disabled:s.disabled,inputmode:"numeric",onInput:t[1]||(t[1]=e=>g()),onFocus:t[2]||(t[2]=e=>l.value.select()),onBlur:t[3]||(t[3]=e=>_())},null,42,Yl),[[r.nr,d.value]]),(0,o.Uk)(" : "),(0,o.wy)((0,o._)("input",{ref_key:"minuteEl",ref:c,"onUpdate:modelValue":t[4]||(t[4]=e=>u.value=e),class:(0,n.C_)([e.$style.input,e.$style.input_minute]),disabled:s.disabled,inputmode:"numeric",onInput:t[5]||(t[5]=e=>g()),onFocus:t[6]||(t[6]=e=>c.value.select()),onBlur:t[7]||(t[7]=e=>_())},null,42,Kl),[[r.nr,u.value]])],2)])),_:1},8,["size","error","show-error-immediately","disabled"]))}});var Jl=s(80089),Ql=s.n(Jl);const ec={};ec.$style=Ql();const tc=(0,b.Z)(Xl,[["__cssModules",ec]]),sc="YYYY-MM-DD",ic=(0,o.aZ)({__name:"story-edit-page-settings-scheduled-story",props:{modelValue:{}},emits:["update:modelValue"],setup(e,{emit:t}){const s=e,i=t,r=Ir(),l=(0,o.Fl)((()=>{const e=1e3*Number(s.modelValue);return new Date(e)})),c=[...Array(11).keys()].map((e=>{const t=new Date;t.setDate(t.getDate()+e);const s=te()(t);return{value:s.format(sc),label:s.format("DD.MM.YYYY (dd)"),disabled:!1}})),d=(0,o.Fl)((()=>{const e=te()(l.value).format(sc);return c.some((t=>t.value===e))?c:[{value:e,label:te()(l.value).format("DD.MM.YYYY (dd)"),disabled:!0},...c]})),u=(0,a.iH)(te()(l.value).format(sc)),p=(0,a.iH)(60*l.value.getHours()+l.value.getMinutes());return(0,o.YP)([u,p],(()=>{const e=new Date,t=d.value.find((e=>e.value===u.value));if(!t)return;const[s,o,n]=t.value.split("-").map(Number);e.setFullYear(s,o-1,n),e.setHours(0,p.value,0,0),r.isScheduledTimePristine=!1,i("update:modelValue",Math.floor(e.getTime()/1e3))})),(e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:(0,n.C_)(e.$style.host)},[(0,o.Wm)(ql.Z,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),class:(0,n.C_)(e.$style.day),size:"small"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(d.value,(e=>((0,o.wg)(),(0,o.j4)(Wl.Z,{key:e.value,label:e.label,value:e.value,disabled:e.disabled},null,8,["label","value","disabled"])))),128))])),_:1},8,["modelValue","class"]),(0,o.Wm)(tc,{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=e=>p.value=e),size:"small",class:(0,n.C_)(e.$style.time),error:!(0,a.SU)(r).isScheduledTimeValid&&"Неверное время публикации"},null,8,["modelValue","class","error"])],2))}});var oc=s(87461),rc=s.n(oc);const nc={};nc.$style=rc();const ac=(0,b.Z)(ic,[["__cssModules",nc]]),lc=(0,o.aZ)({__name:"story-edit-page-settings-hint",setup(e){const t=Ir(),s=(0,a.iH)(),i=(0,a.iH)(!1);return(e,r)=>((0,o.wg)(),(0,o.j4)(Br.Z,{ref_key:"hostEl",ref:s,active:i.value,"onUpdate:active":r[0]||(r[0]=e=>i.value=e),direction:"top",class:(0,n.C_)(e.$style.host),disabled:(0,a.SU)(t).locked,"tooltip-container":e.IS_MOBILE?".main__content":void 0},{default:(0,o.w5)((()=>[(0,o.WI)(e.$slots,"default")])),_:3},8,["active","class","disabled","tooltip-container"]))}});var cc=s(28307),dc=s.n(cc);const uc={};uc.$style=dc();const pc=(0,b.Z)(lc,[["__cssModules",uc]]),hc=(0,o.aZ)({__name:"story-edit-page-settings-story-boost",setup(e){const t=Ir(),{sendEvent:s}=(0,kl.z)(),i=(0,o.Fl)((()=>{var e;return t.wasBoosted||!t.availableStoryBoosts||t.settings.is_adult||t.settings.is_anonymous_story||t.settings.scheduled_time||(null===(e=t.community)||void 0===e?void 0:e.is_preview)}));return(0,o.YP)(i,(e=>{t.wasBoosted&&e&&(t.settings.is_story_boost=!1)})),(0,o.YP)((()=>t.settings.is_story_boost),(e=>{e&&s("mark_pikaboost",{type:"pikaboost"})})),(e,s)=>((0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(As.Z,{modelValue:(0,a.SU)(t).settings.is_story_boost,"onUpdate:modelValue":s[0]||(s[0]=e=>(0,a.SU)(t).settings.is_story_boost=e),"data-test":"setting-story-boost",disabled:i.value||(0,a.SU)(t).locked},{default:(0,o.w5)((()=>[(0,o._)("span",{class:(0,n.C_)(e.$style.label)},[(0,o.Uk)(" Пикабуст "),(0,o._)("span",{class:(0,n.C_)(e.$style.badge)},[(0,o.Wm)(d.Z,{name:"startup"}),(0,o.Uk)(" "+(0,n.zw)((0,a.SU)(t).availableStoryBoosts)+"/2 ",1)],2)],2)])),_:1},8,["modelValue","disabled"]),(0,o.Wm)(pc,null,{default:(0,o.w5)((()=>[(0,o.Uk)(" Вы попали в список топовых авторов и теперь вам доступен Пикабуст: в течение 30 дней вы можете отправить два своих поста сразу в Горячее, чтобы их заметили как можно больше пользователей. Пикабуст можно включить сейчас или сделать это позже. Опция доступна для постов не старше суток ")])),_:1})]))}});var _c=s(8681),mc=s.n(_c);const gc={};gc.$style=mc();const vc=(0,b.Z)(hc,[["__cssModules",gc]]),fc=["onSubmit"],yc=(0,o._)("p",null,"Укажите стоимость ежемесячной подписки на ваши эксклюзивные посты.",-1),bc=(0,o.aZ)({__name:"setting-exclusive-dialog-view",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const s=e,i=t,c=(0,o.Fl)({get:()=>s.modelValue,set:e=>i("update:modelValue",e)}),{sendEvent:d}=(0,kl.z)(),u=Ir(),p=(0,a.iH)(u.subscriptionCost?String(u.subscriptionCost):""),h=(0,o.Fl)((()=>{if(!p.value)return!1;const e=Number(p.value);return e<u.MIN_SUBSCRIPTION_COST?`Стоимость подписки не может быть меньше ${(0,ve.uf)(u.MIN_SUBSCRIPTION_COST)} руб.`:e>u.MAX_SUBSCRIPTION_COST&&`Стоимость подписки не может быть больше ${(0,ve.uf)(u.MAX_SUBSCRIPTION_COST)} руб.`})),_=(0,o.Fl)((()=>p.value&&!h.value));function v(e){return e.replace(/\D/g,"").replace(/^0+/,"").slice(0,4)}async function f(){const e=Number(p.value);if(d("paid_author_subscription_create_button_tapped",{component_name:"post_editor",subscribers:u.userSubsCount,rating:u.userKarma,size:100*e}),!_.value)return;const{response:t}=await u.setSubscriptionCost(e);t.result?(u.settings.is_paid_subscription=!0,c.value=!1):l.core.ui.toasts.showError(t.message,{isGlobal:!0})}function y(){d("error_occurred",{type:"invalid_subscription_cost",type_i8:kl.k.MONETIZATION,component_name:"post_editor"})}function b(){c.value=!1,p.value=u.subscriptionCost?String(u.subscriptionCost):"",d("click",{component_name:"post_editor",button:"paid_author_subscription_form_close"})}return(e,t)=>((0,o.wg)(),(0,o.j4)(S.Z,{modelValue:c.value,"onUpdate:modelValue":t[1]||(t[1]=e=>c.value=e),title:"Платная подписка",onClose:b},{default:(0,o.w5)((()=>[(0,o._)("form",{onSubmit:(0,r.iM)(f,["prevent"])},[yc,(0,o._)("p",{class:(0,n.C_)(e.$style.note)}," Внимание! После сохранения вы не сможете изменить стоимость подписки ",2),(0,o._)("div",{class:(0,n.C_)(e.$style.cost)},[(0,o.Wm)(m.Z,{modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=e=>p.value=e),class:(0,n.C_)(e.$style.input),inputmode:"numeric",label:"Введите сумму",clean:v,error:h.value,onKeyup:(0,r.D2)(f,["enter"]),"onShow:error":y},null,8,["modelValue","class","error","onKeyup"]),(0,o._)("span",{class:(0,n.C_)(e.$style.units)},"рублей",2)],2),(0,o._)("div",{class:(0,n.C_)(e.$style.footer)},[(0,o.Wm)(g.Z,{wide:e.IS_MOBILE,label:"Сохранить",disabled:!_.value,loading:(0,a.SU)(u).loading.setSubscriptionCost,type:"submit"},null,8,["wide","disabled","loading"]),e.IS_DESKTOP?((0,o.wg)(),(0,o.j4)(g.Z,{key:0,theme:"gray",label:"Отменить",onClick:b})):(0,o.kq)("v-if",!0)],2)],40,fc)])),_:1},8,["modelValue"]))}});var wc=s(62171),kc=s.n(wc);const Sc={};Sc.$style=kc();const Oc=(0,b.Z)(bc,[["__cssModules",Sc]]),Ec=(0,o.aZ)({__name:"setting-exclusive-view",setup(e){const t=Ir(),{sendEvent:s}=(0,kl.z)(),i=(0,a.iH)(!1),r=t.wasPublished&&!t.settings.is_paid_subscription,n=(0,o.Fl)((()=>r||t.settings.is_anonymous_story));function l(){t.subscriptionCost||t.settings.is_paid_subscription?t.settings.is_paid_subscription=!t.settings.is_paid_subscription:(i.value=!0,s("paid_author_subscription_form_showed",{component_name:"post_editor"}))}return(e,s)=>((0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(As.Z,{"model-value":(0,a.SU)(t).settings.is_paid_subscription,"data-test":"setting-paid-subscription",label:"Для платных подписчиков",disabled:(0,a.SU)(t).locked||n.value,"onUpdate:modelValue":l},null,8,["model-value","disabled"]),(0,o.Wm)(pc,null,{default:(0,o.w5)((()=>[(0,o.Uk)(" Пост будет виден только тем, кто оформил платную подписку на ваш контент. Другие читатели смогут увидеть его только по прямой ссылке с предложением оформить подписку для просмотра поста. ")])),_:1}),(0,o.Wm)(Oc,{modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=e=>i.value=e)},null,8,["modelValue"])],64))}});var Cc=s(12542),xc=s.n(Cc);const Tc={};Tc.$style=xc();const Ic=(0,b.Z)(Ec,[["__cssModules",Tc]]);s(24603);var Pc=s(29883),Ac=s(76137),Dc=s(53329),Mc=s(82768);const Rc=(0,o.aZ)({__name:"series-list",props:{items:{},selection:{}},emits:["click:add","click:item"],setup(e,{emit:t}){const s=e,i=t;return(e,t)=>((0,o.wg)(),(0,o.iD)("div",null,[s.items.length<(0,a.SU)(l.core).initParams.limitSeriesPerUser?((0,o.wg)(),(0,o.j4)(Dc.Z,{key:0,label:"Создать новую серию",selection:"",onClick:t[0]||(t[0]=e=>i("click:add"))},{prefix:(0,o.w5)((()=>[(0,o.Wm)(d.Z,{size:20,class:(0,n.C_)(e.$style.addIcon),name:"add_20"},null,8,["class"])])),_:1})):(0,o.kq)("v-if",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.items,(e=>((0,o.wg)(),(0,o.j4)(Dc.Z,{key:e.id,label:e.title,selection:s.selection,onClick:t=>i("click:item",e.id)},{prefix:(0,o.w5)((()=>[(0,o.Wm)(Mc.Z,{title:e.title,size:20,url:e.previewCoverImageUrl,preview:""},null,8,["title","url"])])),_:2},1032,["label","selection","onClick"])))),128))]))}});var Nc=s(90977),Bc=s.n(Nc);const Lc={};Lc.$style=Bc();const jc=(0,b.Z)(Rc,[["__cssModules",Lc]]),$c=(0,o.aZ)({__name:"series-selected",props:{series:{}},emits:["remove"],setup(e,{emit:t}){const s=e,i=t,r=(0,o.Fl)((()=>`\n\t\t${s.series.storiesCount} ${R.Utils.pluralNounRU(s.series.storiesCount,["пост","поста","постов"])}\n\t`));return(e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:(0,n.C_)(e.$style.host)},[(0,o.Wm)(Mc.Z,{class:(0,n.C_)(e.$style.avatar),title:s.series.title,size:40,url:s.series.coverImageUrl},null,8,["class","title","url"]),(0,o._)("div",null,[(0,o._)("h4",{class:(0,n.C_)(e.$style.title)},(0,n.zw)(s.series.title),3),(0,o._)("p",{class:(0,n.C_)(e.$style.storiesCount)},(0,n.zw)(r.value),3)]),(0,o.Wm)(g.Z,{class:(0,n.C_)(e.$style.btn),theme:"gray",icon:"hide_16",onClick:t[0]||(t[0]=e=>i("remove"))},null,8,["class"])],2))}});var Uc=s(20022),Fc=s.n(Uc);const Vc={};Vc.$style=Fc();const Hc=(0,b.Z)($c,[["__cssModules",Vc]]),Zc=(0,o.aZ)({__name:"story-edit-page-settings-series",setup(e){const t=Ir(),s=(0,a.iH)([]),i=(0,a.iH)([]),r=(0,a.iH)(""),c=(0,a.iH)(),d=(0,a.iH)(!1),u=(0,a.iH)(),p=(0,a.iH)(!1),h=(0,o.Fl)((()=>s.value.find((e=>e.id===t.settings.series_id))));async function _(){0===s.value.length&&(p.value=!0,s.value=await Pc.nm.getSeriesList(),p.value=!1);const e=new RegExp((0,Ac.f)(r.value),"i");i.value=s.value.filter((t=>e.test(t.title)))}async function v(){await _(),d.value=!0}async function f(){t.locked||(await _(),d.value=!0)}function y(){u.value||(u.value=new Pc.jD({disableStories:!0}),l.core.listenTo(u.value,"edit",(e=>{s.value=[e,...s.value],t.settings.series_id=e.id}))),d.value=!1,u.value.showEditor()}async function b(e){d.value=!1,await(0,o.Y3)(),t.settings.series_id=e}return(0,o.bv)(_),(0,o.YP)(r,Ya()(_,300)),(0,o.YP)(i,(e=>{e.length?d.value=!0:d.value=!1})),(0,o.YP)(h,(e=>{e&&he.cp.getInstance().sendEvent("mark_post_series",{size:e.storiesCount,post_series_id:e.id})})),(e,s)=>((0,o.wg)(),(0,o.iD)("div",{class:(0,n.C_)(e.$style.host)},[h.value?((0,o.wg)(),(0,o.j4)(Hc,{key:1,series:h.value,onRemove:s[5]||(s[5]=e=>(0,a.SU)(t).settings.series_id=0)},null,8,["series"])):((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[e.IS_MOBILE?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.Wm)(g.Z,{wide:"",label:"Выбрать серию",outline:"",onClick:f}),(0,o.Wm)(Na.Z,{modelValue:r.value,"onUpdate:modelValue":s[0]||(s[0]=e=>r.value=e),active:d.value,"onUpdate:active":s[1]||(s[1]=e=>d.value=e),empty:!i.value.length&&i.value.length>=(0,a.SU)(l.core).initParams.limitSeriesPerUser,loading:p.value,"show-list-with-empty-input":"",tip:"Пожалуйста, начните вводить название серии, а затем выберите из списка"},{default:(0,o.w5)((()=>[(0,o.Wm)(jc,{items:i.value,selection:r.value,"onClick:add":y,"onClick:item":b},null,8,["items","selection"])])),_:1},8,["modelValue","active","empty","loading"])],64)):((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[(0,o.Wm)(m.Z,{ref_key:"inputEl",ref:c,modelValue:r.value,"onUpdate:modelValue":s[2]||(s[2]=e=>r.value=e),label:"Введите название серии",size:"large",clearable:"",loading:p.value,disabled:(0,a.SU)(t).locked,onFocus:v},null,8,["modelValue","loading","disabled"]),(0,o.Wm)(Ra.Z,{active:d.value,"onUpdate:active":s[3]||(s[3]=e=>d.value=e),for:c.value,"onClick:outside":s[4]||(s[4]=e=>d.value=!1)},{default:(0,o.w5)((()=>[(0,o.Wm)(jc,{items:i.value,selection:r.value,"onClick:add":y,"onClick:item":b},null,8,["items","selection"])])),_:1},8,["active","for"])],64))],64))],2))}});var zc=s(65755),qc=s.n(zc);const Wc={};Wc.$style=qc();const Gc=(0,b.Z)(Zc,[["__cssModules",Wc]]);var Yc=s(91904);const Kc=(0,o._)("br",null,null,-1),Xc=(0,o._)("br",null,null,-1),Jc=(0,o._)("a",{href:"/communities?t=nsfw",target:"_blank"},"специальных сообществах",-1),Qc=(0,o._)("a",{href:"/experts",target:"_blank"},"ленте экспертов",-1),ed=(0,o._)("br",null,null,-1),td=(0,o._)("strong",null,"Внимание:",-1),sd=(0,o._)("a",{href:"https://pikabu.ru/go/help_donate"},"Подробнее",-1),id=(0,o._)("br",null,null,-1),od=(0,o._)("br",null,null,-1),rd=(0,o.aZ)({__name:"story-edit-page-settings",setup(e){const t=Ir(),s=de(),i=(0,Q.D3)(B.A1),l=t.scheduledStoriesCount>=t.MAX_SCHEDULED_STORIES,c=Yc.V.isUserInExperiment(Yc.t.PAID_SUBS),d=(0,o.Fl)({get:()=>Boolean(t.settings.scheduled_time),set(e){if(!t.locked)if(e){const e=new Date;e.setHours(e.getHours()+1,e.getMinutes(),0,0),t.settings.scheduled_time=Math.floor(e.getTime()/1e3)}else t.settings.scheduled_time=0}}),u=(0,o.Fl)((()=>l||t.settings.is_story_boost)),p=!t.isNew&&t.settings.is_advert_blogs,h=(0,a.iH)(Boolean(t.settings.series_id)),_=(0,o.Fl)((()=>t.isTopAuthor&&!t.isCustomAdverts&&!t.isExperts)),m=(0,o.Fl)((()=>t.shouldShowAdvertBlogsFlag&&!t.isCustomAdverts&&!t.isExperts)),g=(0,o.Fl)((()=>t.settings.is_advert_blogs&&!t.isCustomAdverts&&!t.isExperts)),v=(0,o.Fl)((()=>!t.settings.is_advert_blogs&&!t.isPDS&&!t.isExperts)),f=(0,o.Fl)((()=>!t.settings.is_advert_blogs)),y=(0,o.Fl)((()=>!t.settings.is_advert_blogs&&!t.isPDS&&t.shouldShowAnonymousStoryFlag)),b=(0,o.Fl)((()=>m.value||t.isPDS||t.isDonationsFlagHidden||t.isExperts)),w=(0,o.Fl)((()=>!t.wasPublished&&!t.isPDSAdvertBlogs&&!t.isExperts)),k=(0,o.Fl)((()=>!t.isExperts&&!t.shouldShowAdvertBlogsFlag)),S=(0,o.Fl)((()=>!t.isExperts));(0,o.YP)(h,(e=>{e||(t.settings.series_id=0)})),(0,o.YP)((()=>s.draft),((e,s)=>{(null==e?void 0:e.id)!==(null==s?void 0:s.id)&&(h.value=Boolean(t.settings.series_id))})),(0,o.YP)((()=>t.settings.is_advert_blogs),(e=>{e?(t.settings.is_authors=!1,t.settings.is_adult=!1,t.settings.is_anonymous_story=!1,t.settings.is_donations_disabled=!1,t.community=null):t.settings.is_comments_disabled=!1})),(0,o.bv)((()=>{m.value&&t.isNew&&t.shouldShowAdvertBlogsFlag&&(t.settings.is_advert_blogs=!0)})),(0,o.YP)((()=>t.settings.is_author_content),(e=>{_.value&&e&&(t.settings.is_authors=!0)})),(0,o.YP)((()=>t.settings.is_anonymous_story),(e=>{e&&(h.value=!1,t.settings.series_id=0)})),(0,o.YP)((()=>t.settings.is_adult),(e=>{t.isExperts&&(t.community=e?{id:U.Z7}:null)}));const O=(0,o.Fl)({get:()=>U.TO.every((e=>t.tags.includes(e))),set(e){e?U.TO.forEach((e=>{t.tags.includes(e)||t.tags.push(e)})):t.tags=t.tags.filter((e=>!U.TO.includes(e)))}});return(0,o.YP)((()=>t.settings.is_story_boost),(e=>{e&&(d.value=!1)})),(0,o.YP)(d,(e=>{e&&(t.settings.is_story_boost=!1)})),(e,s)=>((0,o.wg)(),(0,o.iD)(o.HY,null,[_.value?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.Wm)(vc,{class:(0,n.C_)(e.$style.setting)},null,8,["class"]),(0,o._)("div",{class:(0,n.C_)(e.$style.setting)},[(0,o.Wm)(As.Z,{modelValue:(0,a.SU)(t).settings.is_author_content,"onUpdate:modelValue":s[0]||(s[0]=e=>(0,a.SU)(t).settings.is_author_content=e),"data-test":"setting-authors-content",label:"Авторский контент",disabled:(0,a.SU)(t).locked,"data-author-content":""},null,8,["modelValue","disabled"]),(0,o.Wm)(pc,null,{default:(0,o.w5)((()=>[(0,o.Uk)(" Уникальный авторский пост из вашего основного направления творчества. Такой пост будет заметнее в ленте. Снимите эту галочку, если хотите сделать пост на отвлечённую тему. ")])),_:1})],2)],64)):(0,o.kq)("v-if",!0),m.value?((0,o.wg)(),(0,o.iD)("div",{key:1,class:(0,n.C_)(e.$style.setting)},[(0,o.Wm)(As.Z,{modelValue:(0,a.SU)(t).settings.is_advert_blogs,"onUpdate:modelValue":s[1]||(s[1]=e=>(0,a.SU)(t).settings.is_advert_blogs=e),"data-test":"setting-company-blog",label:"Опубликовать в «Блогах компаний»",disabled:(0,a.SU)(p)||(0,a.SU)(t).locked},null,8,["modelValue","disabled"]),(0,o.Wm)(pc,null,{default:(0,o.w5)((()=>[(0,o.Uk)(" Пост появится в общей ленте блогов. ")])),_:1})],2)):(0,o.kq)("v-if",!0),g.value?((0,o.wg)(),(0,o.iD)("div",{key:2,class:(0,n.C_)(e.$style.setting)},[(0,o.Wm)(As.Z,{modelValue:(0,a.SU)(t).settings.is_comments_disabled,"onUpdate:modelValue":s[2]||(s[2]=e=>(0,a.SU)(t).settings.is_comments_disabled=e),"data-test":"setting-disable-comments",label:"Отключить комментарии",disabled:!(0,a.SU)(t).isNew&&!(0,a.SU)(t).isPDSAdvertBlogs||(0,a.SU)(t).locked},null,8,["modelValue","disabled"]),(0,o.Wm)(pc,null,{default:(0,o.w5)((()=>[(0,o.Uk)(" Никто не сможет комментировать ваш пост. ")])),_:1})],2)):(0,o.kq)("v-if",!0),v.value?((0,o.wg)(),(0,o.iD)("div",{key:3,class:(0,n.C_)(e.$style.setting)},[(0,o.Wm)(As.Z,{modelValue:(0,a.SU)(t).settings.is_authors,"onUpdate:modelValue":[s[3]||(s[3]=e=>(0,a.SU)(t).settings.is_authors=e),s[4]||(s[4]=e=>e&&(0,a.SU)(i).sendIsAuthorsChecked())],"data-test":"setting-my",label:"Моё",disabled:(0,a.SU)(t).locked},null,8,["modelValue","disabled"]),(0,o.Wm)(pc,null,{default:(0,o.w5)((()=>[(0,o.Uk)(" Содержание поста создано вами."),Kc,(0,o.Uk)(" Например, вы сделали эту фотографию или написали данный рассказ. ")])),_:1})],2)):(0,o.kq)("v-if",!0),f.value?((0,o.wg)(),(0,o.iD)("div",{key:4,class:(0,n.C_)(e.$style.setting)},[(0,o.Wm)(As.Z,{modelValue:(0,a.SU)(t).settings.is_adult,"onUpdate:modelValue":[s[5]||(s[5]=e=>(0,a.SU)(t).settings.is_adult=e),s[6]||(s[6]=e=>e&&(0,a.SU)(i).sendIsNSFWChecked())],"data-test":"setting-nsfw",label:"Пост содержит 18+ контент",disabled:(0,a.SU)(t).locked||(0,a.SU)(t).wasBoosted},null,8,["modelValue","disabled"]),(0,o.Wm)(pc,null,{default:(0,o.w5)((()=>[(0,o.Uk)(" Например, материал на тему секса."),Xc,(0,o.Uk)(" Публикация таких материалов разрешена только в "),Jc,(0,o.Uk)(". ")])),_:1})],2)):(0,o.kq)("v-if",!0),k.value?((0,o.wg)(),(0,o.iD)("div",{key:5,class:(0,n.C_)(e.$style.setting)},[(0,o.Wm)(As.Z,{modelValue:O.value,"onUpdate:modelValue":[s[7]||(s[7]=e=>O.value=e),s[8]||(s[8]=e=>e&&(0,a.SU)(i).sendIsNSFWChecked())],"data-test":"setting-question",label:"Задать вопрос",disabled:(0,a.SU)(t).locked},null,8,["modelValue","disabled"]),(0,o.Wm)(pc,null,{default:(0,o.w5)((()=>[(0,o.Uk)(" Выберите, если ваш пост — это вопрос на какую-то тему. Он появится в "),Qc,(0,o.Uk)(", а пикабушники помогут найти ответ. ")])),_:1})],2)):(0,o.kq)("v-if",!0),y.value?((0,o.wg)(),(0,o.iD)("div",{key:6,class:(0,n.C_)(e.$style.setting)},[(0,o.Wm)(As.Z,{modelValue:(0,a.SU)(t).settings.is_anonymous_story,"onUpdate:modelValue":s[9]||(s[9]=e=>(0,a.SU)(t).settings.is_anonymous_story=e),"data-test":"setting-anonymous",label:"Опубликовать анонимно",disabled:(0,a.SU)(t).locked||(0,a.SU)(t).settings.is_paid_subscription||h.value},null,8,["modelValue","disabled"]),(0,o.Wm)(pc,null,{default:(0,o.w5)((()=>[(0,o.Uk)(" Другие пользователи не узнают, кто опубликовал пост. Он не появится в вашем профиле и не повлияет на ваш рейтинг. Используйте эту функцию, если не уверены в реакции пикабушников."),ed,td,(0,o.Uk)(" вы не сможете отредактировать пост после публикации, поэтому проверьте его еще раз. ")])),_:1})],2)):(0,o.kq)("v-if",!0),b.value?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.iD)(o.HY,{key:7},[(0,o._)("div",{class:(0,n.C_)(e.$style.setting)},[(0,o.Wm)(As.Z,{modelValue:(0,a.SU)(t).settings.is_donations_disabled,"onUpdate:modelValue":s[10]||(s[10]=e=>(0,a.SU)(t).settings.is_donations_disabled=e),"data-test":"setting-disable-donations",label:"Отключить донаты за пост",disabled:(0,a.SU)(t).isDonationsFlagDisabled||(0,a.SU)(t).locked},null,8,["modelValue","disabled"]),(0,o.Wm)(pc,null,{default:(0,o.w5)((()=>[(0,o.Uk)(" Донаты - денежные поощрения от читателей. "),sd])),_:1})],2),(0,a.SU)(c)?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,n.C_)(e.$style.setting)},[(0,o.Wm)(Ic)],2)):(0,o.kq)("v-if",!0)],64)),w.value&&!(0,a.SU)(t).isCustomAdverts?((0,o.wg)(),(0,o.iD)(o.HY,{key:8},[(0,o._)("div",{class:(0,n.C_)(e.$style.setting)},[(0,o.Wm)(As.Z,{modelValue:d.value,"onUpdate:modelValue":s[11]||(s[11]=e=>d.value=e),"data-test":"setting-scheduled",label:"Отложенная публикация",disabled:u.value||(0,a.SU)(t).locked},null,8,["modelValue","disabled"]),(0,o.Wm)(pc,null,{default:(0,o.w5)((()=>[(0,o.Uk)(" Выберите, если хотите опубликовать пост в назначенное время. ")])),_:1})],2),(0,o._)("div",{class:(0,n.C_)(e.$style.scheduledStory)},[d.value?((0,o.wg)(),(0,o.j4)(ac,{key:0,modelValue:(0,a.SU)(t).settings.scheduled_time,"onUpdate:modelValue":s[12]||(s[12]=e=>(0,a.SU)(t).settings.scheduled_time=e)},null,8,["modelValue"])):(0,o.kq)("v-if",!0),l&&!(0,a.SU)(t).isScheduled?((0,o.wg)(),(0,o.iD)("div",{key:1,class:(0,n.C_)(e.$style.scheduledStoryError)}," У вас 5 отложенных постов. Это максимальное число. ",2)):(0,o.kq)("v-if",!0)],2)],64)):(0,o.kq)("v-if",!0),S.value?((0,o.wg)(),(0,o.iD)("div",{key:9,class:(0,n.C_)(e.$style.setting)},[(0,o.Wm)(As.Z,{modelValue:h.value,"onUpdate:modelValue":s[13]||(s[13]=e=>h.value=e),"data-test":"setting-series",label:"Опубликовать в серию",disabled:(0,a.SU)(t).locked||(0,a.SU)(t).settings.is_anonymous_story},null,8,["modelValue","disabled"])],2)):(0,o.kq)("v-if",!0),m.value&&(0,a.SU)(t).isNormal&&(0,a.SU)(t).settings.is_advert_blogs?((0,o.wg)(),(0,o.iD)("div",{key:10,class:(0,n.C_)(e.$style.setting)},[(0,o.Wm)(As.Z,{modelValue:(0,a.SU)(t).settings.is_not_advert,"onUpdate:modelValue":s[14]||(s[14]=e=>(0,a.SU)(t).settings.is_not_advert=e),"data-test":"setting-not-ad",label:"Пост не является рекламой"},null,8,["modelValue"]),(0,o.Wm)(pc,null,{default:(0,o.w5)((()=>[(0,o.Uk)(" Вы подтверждаете, что данный пост является"),id,(0,o.Uk)(" сугубо информационным и не содержит"),od,(0,o.Uk)(" рекламу в любых ее проявлениях. ")])),_:1})],2)):(0,o.kq)("v-if",!0),(0,o.wy)((0,o.Wm)(Gc,null,null,512),[[r.F8,h.value]])],64))}});var nd=s(1351),ad=s.n(nd);const ld={};ld.$style=ad();const cd=(0,b.Z)(rd,[["__cssModules",ld]]);var dd=s(48218),ud=s(18910),pd=s(39037);const hd=(0,o._)("a",{href:"https://pikabu.ru/story/_4375754",target:"_blank"},"1",-1),_d=(0,o._)("a",{href:"https://pikabu.ru/story/_4443611",target:"_blank"},"2",-1),md=(0,o._)("a",{href:"https://pikabu.ru/story/_4382409",target:"_blank"},"3",-1),gd=(0,o.aZ)({__name:"alerts-view",setup(e){const t=Ir();return(e,s)=>((0,o.wg)(),(0,o.iD)(o.HY,null,[(0,a.SU)(t).isCustomAdverts?((0,o.wg)(),(0,o.j4)(Ji.Z,{key:0,class:(0,n.C_)(e.$style.alert),theme:"yellow"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Рекламный пост должен быть интересным и содержательным. Чем интересней пост, тем лучше читатели к нему отнесутся, и Ваша реклама даст лучший результат. Примеры интересных рекламных постов: "),hd,(0,o.Uk)(", "),_d,(0,o.Uk)(", "),md])),_:1},8,["class"])):(0,o.kq)("v-if",!0),(0,a.SU)(t).locked?((0,o.wg)(),(0,o.j4)(Ji.Z,{key:1,class:(0,n.C_)(e.$style.alert),theme:"red"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Вы начали редактирование поста в другом месте. Если Вы хотите возобновить работу над постом, пожалуйста, перезагрузите страницу ")])),_:1},8,["class"])):(0,o.kq)("v-if",!0),!(0,a.SU)(t).canEditStory&&(0,a.SU)(t).canEditUpdate?((0,o.wg)(),(0,o.j4)(Ji.Z,{key:2,class:(0,n.C_)(e.$style.alert),theme:"yellow"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Вы уже не можете отредактировать этот пост, но можете дополнить его текстом. Используйте для этого специальный блок внизу поста ")])),_:1},8,["class"])):(0,o.kq)("v-if",!0)],64))}});var vd=s(93830),fd=s.n(vd);const yd={};yd.$style=fd();const bd=(0,b.Z)(gd,[["__cssModules",yd]]),wd=(0,o.aZ)({__name:"app",setup(e,{expose:t}){const s=Ir(),i=de(),d=(()=>{const e=de(),t=Ir(),s=he.cp.getInstance(),i=s.sendEvent.bind(s);return{sendEvent:i,sendMediaAddedEvent:({type:s})=>{let o;o="image"===s?"add_picture":"carousel"===s?"add_image_carousel":"add_video",i(o,{draft_id:e.draftId,post_id:t.storyId||void 0})},sendTagAddedEvent:()=>{i("add_tag",{draft_id:e.draftId})},sendStoryPublishedEvent:({storyId:s})=>{const o={post_id:s,draft_id:e.draftId};t.isUpdatesOnlyAllowed&&(o.type="update"),t.isExperts&&(o.type="experts_simple"),i("publish_post",o)},sendImageTitle:()=>{i("add_caption_under_image",{draft_id:e.draftId})},sendIsAuthorsChecked:()=>{i("mark_mine",{draft_id:e.draftId})},sendIsNSFWChecked:()=>{i("mark_nsfw",{draft_id:e.draftId})},sendCommunitySelectedEvent:({community:t,fromRecommended:s})=>{i("mark_public_for_community",{community_id:t.id,draft_id:e.draftId}),s&&i("click",{type:"recommended_community",community_id:t.id,rec_score:t.score,screen_index:t.screen_index})},sendStoryPreviewEvent:()=>{i("post_preview",{draft_id:e.draftId})}}})(),u=(0,a.iH)(!1),p=(0,o.Fl)((()=>!s.isCustomAdverts&&!s.isExperts&&(!(!l.core.isUserModerator&&!l.core.isInternalStaff)||!s.settings.is_advert_blogs)));async function h(){var e,t;s.isNew&&(s.isNormal||s.isExperts)&&(i.isSaving||i.isLoading||s.locked||i.isSaved||(s.isEditorEmpty?i.delete(null===(t=i.draft)||void 0===t?void 0:t.id):(i.save(),he.cp.getInstance().sendEvent("save_draft_post",{draft_id:null===(e=i.draft)||void 0===e?void 0:e.id}))))}return(0,o.JJ)(B.A1,d),function(){const e=Ir();if(!e.needToFollowDuplicationEditor)return;const t=(0,a.iH)(),s=(0,a.iH)(null),i=()=>{var e;s.value&&clearInterval(s.value),null===(e=t.value)||void 0===e||e.call(t)};(0,o.bv)((()=>{t.value=(0,c.ORN)(window,"storage",(t=>{const{key:s,newValue:i}=t,o=null==i?void 0:i.replace(/["']+/g,"");s===U.q7&&o!==e.pageId&&(e.locked=!0)})),s.value=setInterval((()=>{(async()=>{await e.getLastPageId()!==e.pageId&&(e.locked=!0)})()}),U.RX)})),(0,o.Ah)(i),(0,o.YP)((()=>e.locked),(e=>{e&&i()}))}(),(0,o.bv)((()=>{var e;s.isExperts||(null===(e=document.querySelector(".app"))||void 0===e||e.classList.add("app_story-editor"));(0,pd.Z)()&&parent.addEventListener("close",(async()=>{var e,t;if(i.isSaved)return void(null===(e=(t=parent).__closeStoryModal)||void 0===e||e.call(t));var s,o;await dd.g.confirmModal({header:"Подтверждение выхода",content:"Не вся информация была сохранена. Вы действительно хотите выйти из редактора?",buttons:[["modal.cancel"],["Выйти",ud.jM.SUCCESS,!0]]})&&(null===(s=(o=parent).__closeStoryModal)||void 0===s||s.call(o))}))})),t({setTitle:e=>{s.title=e}}),(e,t)=>((0,o.wg)(),(0,o.iD)("div",{onKeydown:[t[5]||(t[5]=(0,r.D2)((0,r.iM)((e=>h()),["ctrl","exact","prevent"]),["s"])),t[6]||(t[6]=(0,r.D2)((0,r.iM)((e=>h()),["ctrl","exact","prevent"]),["ы"]))]},[(0,o.Wm)(bd),(0,o.Wm)(Ca,{class:(0,n.C_)([e.$style.card,e.$style.card_story,{[e.$style.card_brief]:(0,a.SU)(s).isExperts}])},null,8,["class"]),(0,o.Wm)(r.uT,{name:e.$style.card,onBeforeEnter:t[0]||(t[0]=e=>u.value=!0),onAfterEnter:t[1]||(t[1]=e=>u.value=!1),onBeforeLeave:t[2]||(t[2]=e=>u.value=!0),onAfterLeave:t[3]||(t[3]=e=>u.value=!1)},{default:(0,o.w5)((()=>[p.value?((0,o.wg)(),(0,o.j4)(ra.Z,{key:0,class:(0,n.C_)([e.$style.card,{[e.$style.card_brief]:(0,a.SU)(s).isExperts}]),disabled:(0,a.SU)(s).locked||!(0,a.SU)(s).canEditStory},{default:(0,o.w5)((()=>[(0,o.Wm)(bl)])),_:1},8,["class","disabled"])):(0,o.kq)("v-if",!0)])),_:1},8,["name"]),(0,o.Wm)(ra.Z,{class:(0,n.C_)([e.$style.card,{[e.$style.card_brief]:(0,a.SU)(s).isExperts}]),disabled:(0,a.SU)(s).locked||!(0,a.SU)(s).canEditStory},{default:(0,o.w5)((()=>[(0,o.Wm)(cd)])),_:1},8,["class","disabled"]),(0,a.SU)(s).isCustomAdverts||(0,a.SU)(s).isPDSAdvertBlogs&&(0,a.SU)(s).settings.is_advert_blogs||(0,a.SU)(s).shouldShowAdvertBlogsFlag&&(0,a.SU)(s).settings.is_advert_blogs&&!(0,a.SU)(s).settings.is_not_advert?((0,o.wg)(),(0,o.j4)(ra.Z,{key:0,class:(0,n.C_)([e.$style.card,{[e.$style.card_brief]:(0,a.SU)(s).isExperts}])},{default:(0,o.w5)((()=>[(0,o.Wm)(m.Z,{ref:"advertInfo",modelValue:(0,a.SU)(s).settings.advert_company,"onUpdate:modelValue":t[4]||(t[4]=e=>(0,a.SU)(s).settings.advert_company=e),label:"Рекламируемое юрлицо и ИНН",size:"large",disabled:(0,a.SU)(s).locked},null,8,["modelValue","disabled"]),(0,o._)("p",{class:(0,n.C_)(e.$style.description)}," Например: ООО «Ромашка», ИНН: 123456789 ",2)])),_:1},8,["class"])):(0,o.kq)("v-if",!0),(0,a.SU)(false)?((0,o.wg)(),(0,o.j4)(zl,{key:1})):((0,o.wg)(),(0,o.j4)(o.lR,{key:2,to:(0,a.SU)(s).isExperts?".popup_editor .popup__footer":".sidebar__inner"},[(0,o._)("div",{class:(0,n.C_)({[e.$style.sidebar]:!(0,a.SU)(s).isExperts})},[(0,o.Wm)(zl)],2)],8,["to"])),u.value?((0,o.wg)(),(0,o.j4)(Dt,{key:3,fullscreen:""})):(0,o.kq)("v-if",!0)],32))}});var kd=s(10879),Sd=s.n(kd);const Od={};Od.$style=Sd();const Ed=(0,b.Z)(wd,[["__cssModules",Od]]);var Cd=s(74689);function xd(){const e=(0,i.a)(Ed);return e.directive("tooltip",Cd.u),e}},99667:(e,t,s)=>{"use strict";s.d(t,{Z:()=>m});var i=s(544),o=s(66252),r=s(3577),n=s(2262),a=s(76841),l=s(59870);const c=(0,o.aZ)({__name:"node-paragraph-view",props:i.Un,setup(e){const{theme:t}=(0,o.f3)(l.yC,{theme:(0,n.iH)(0)}),s=e,c=(0,o.Fl)((()=>t.value||"left"===s.node.attrs.textAlign?{}:{textAlign:s.node.attrs.textAlign})),d=!s.editor.view.docView.node.resolve(s.getPos()).depth;return(e,l)=>((0,o.wg)(),(0,o.j4)(a.Z,(0,r.vs)((0,o.F4)(s)),{default:(0,o.w5)((()=>[(0,o.Wm)((0,n.SU)(i.ms),{as:"p",style:(0,r.j5)(c.value),class:(0,r.C_)({[e.$style.content]:d,[e.$style.content_short]:d&&(0,n.SU)(t)})},null,8,["style","class"])])),_:1},16))}});var d=s(25948),u=s.n(d),p=s(83744);const h={};h.$style=u();const _=(0,p.Z)(c,[["__cssModules",h]]);const m=s(70273).NB.create({name:"paragraph",group:"block",content:"inline*",draggable:!0,selectable:!1,parseHTML:()=>[{tag:'b[id|="docs-internal-guid"]>p',skip:!0},{tag:"p"}],renderHTML:({HTMLAttributes:e})=>["p",e,0],addNodeView:()=>(0,i.uf)(_),addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}}})},54835:(e,t,s)=>{"use strict";s.r(t),s.d(t,{createApp:()=>ke});var i=s(76944),o=(s(2707),s(66992),s(33948),s(88674),s(41817),s(66252)),r=s(3577),n=s(2262),a=s(52423),l=s(41218),c=s(66309),d=s(5707),u=s(37829),p=s(21495),h=s(43544),_=s(62357),m=s(62728),g=s(37043),v=s(44813),f=s(55946),y=s(69876);const b={lastEdit:1,new:2,old:3,custom:4},w={[b.lastEdit]:"по времени обновления",[b.custom]:"в моём порядке",[b.new]:"сначала новые",[b.old]:"сначала старые"},k={[b.lastEdit]:"last_edit_series",[b.custom]:"my_sorting",[b.new]:"first_new",[b.old]:"first_old"},S=(0,y.Q_)("storySeriesSettingsStore",{state:()=>({customSeriesList:[],sort:void 0,initialSort:void 0,isEditingSort:!1}),getters:{isCustomSorting(){return this.isEditingSort&&this.sort===b.custom}},actions:{resetSortEditing(){this.sort=this.initialSort,this.isEditingSort=!1},editSort(){this.sort||(this.sort=b.lastEdit),this.isEditingSort=!0},swapSeries({from:e,to:t}){const s=this.customSeriesList.slice();[s[e],s[t]]=[s[t],s[e]],this.customSeriesList=s}}});s(97314);var O=s(49963),E=s(96101),C=s(60387),x=s(82768);const T=(0,o.aZ)({__name:"series-avatar-view",props:{title:{},coverUrl:{}},setup(e){const t=e;return(e,s)=>((0,o.wg)(),(0,o.j4)(x.Z,{class:(0,r.C_)(e.$style.avatar),size:(0,n.SU)(56),title:t.title,url:t.coverUrl},null,8,["class","size","title","url"]))}});var I=s(91126),P=s.n(I),A=s(83744);const D={};D.$style=P();const M=(0,A.Z)(T,[["__cssModules",D]]),R=(0,o.aZ)({__name:"series-title-view",props:{title:{}},setup(e){const t=e;return(e,s)=>((0,o.wg)(),(0,o.iD)("figcaption",{class:(0,r.C_)(e.$style.title)},(0,r.zw)(t.title),3))}});var N=s(90254),B=s.n(N);const L={};L.$style=B();const j=(0,A.Z)(R,[["__cssModules",L]]),$=(0,o.aZ)({__name:"series-item-view",setup(e){const t=S();return(e,s)=>((0,o.wg)(),(0,o.iD)("li",{class:(0,r.C_)([e.$style.host,{[e.$style.host_swapping]:(0,n.SU)(t).isCustomSorting}])},[(0,o.WI)(e.$slots,"prefix"),(0,o._)("figure",{class:(0,r.C_)([e.$style.figure,{[e.$style.figure_swapping]:(0,n.SU)(t).isCustomSorting}])},[(0,o.WI)(e.$slots,"default")],2)],2))}});var U=s(29023),F=s.n(U);const V={};V.$style=F();const H=(0,A.Z)($,[["__cssModules",V]]);var Z=s(55331),z=s(96637);const q=(0,o.aZ)({__name:"series-list-view",props:{list:{},seriesCount:{},loading:{type:Boolean}},emits:["edit","swap"],setup(e,{emit:t}){const s=S(),i=(0,n.iH)([]),{sendEvent:a}=(0,f.z)(),l=e,d=t,u=new Set,p=(0,o.Fl)((()=>l.list.filter((e=>e.coverImageUrl&&!u.has(e.coverImageUrl))).map((e=>(e.coverImageUrl&&u.add(e.coverImageUrl),z.Utils.preloadImage(e.coverImageUrl)))))),h=(0,c.CRk)((async()=>!!l.loading||!!p.value.length&&(await Promise.allSettled(p.value),!1)),!0);async function _(e,t){const s=(0,c.NXq)(i.value[e]),o=(0,c.NXq)(i.value[t]);await(0,C.V)(o,s),d("swap",{from:e,to:t})}return(e,t)=>((0,o.wg)(),(0,o.iD)("ul",{class:(0,r.C_)(e.$style.host)},[l.loading||(0,n.SU)(h)?((0,o.wg)(!0),(0,o.iD)(o.HY,{key:0},(0,o.Ko)(l.seriesCount,(t=>((0,o.wg)(),(0,o.j4)(H,{key:t},{default:(0,o.w5)((()=>[(0,o.Wm)(Z.Z,{class:(0,r.C_)(e.$style.loader),width:(0,n.SU)(56)+"px",height:(0,n.SU)(56)+"px"},null,8,["class","width","height"]),(0,o.Wm)(Z.Z,{height:"16px"})])),_:2},1024)))),128)):((0,o.wg)(!0),(0,o.iD)(o.HY,{key:1},(0,o.Ko)(l.list,((t,c)=>((0,o.wg)(),(0,o.j4)(H,{ref_for:!0,ref_key:"itemRefs",ref:i,key:c},{prefix:(0,o.w5)((()=>{var t;return[(0,n.SU)(s).isCustomSorting?((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,r.C_)(e.$style.swapControls)},[(0,o.Wm)(E.Z,{icon:"up_18",size:"lg",class:(0,r.C_)(e.$style.swapBtn),disabled:0===c,onClick:e=>_(c,c-1)},null,8,["class","disabled","onClick"]),(0,o.Wm)(E.Z,{icon:"down_18",size:"lg",class:(0,r.C_)(e.$style.swapBtn),disabled:c===(null===(t=e.list)||void 0===t?void 0:t.length)-1,onClick:e=>_(c,c+1)},null,8,["class","disabled","onClick"])],2)):(0,o.kq)("v-if",!0)]})),default:(0,o.w5)((()=>[(0,o.Wm)(M,{title:t.title,"cover-url":t.coverImageUrl},null,8,["title","cover-url"]),(0,o.Wm)(j,{title:t.title},null,8,["title"]),(0,o.wy)((0,o.Wm)(E.Z,{icon:"edit_20",size:"lg",class:(0,r.C_)(e.$style.editBtn),"icon-size":20,onClick:e=>function(e){d("edit",e),a("post_series_popup_edit_button_tapped",{post_series_id:e.id})}(t)},null,8,["class","onClick"]),[[O.F8,!(0,n.SU)(s).isCustomSorting&&!l.loading]])])),_:2},1024)))),128))],2))}});var W=s(41473),G=s.n(W);const Y={};Y.$style=G();const K=(0,A.Z)(q,[["__cssModules",Y]]);var X=s(40094),J=s(53329),Q=s(22177),ee=s(32499);const te=["onClick"],se=(0,o.aZ)({__name:"sort-select-view",setup(e){const t=S(),s=(0,n.iH)(),i=(0,n.iH)(!1);return(0,o.YP)((()=>t.sort),(async(e,t)=>{e!==t&&(i.value=!1)})),(e,i)=>((0,o.wg)(),(0,o.iD)("span",{class:(0,r.C_)(e.$style.host)},[(0,o.Uk)(" Сортировать "),(0,o.Wm)(ee.Z,null,{trigger:(0,o.w5)((({toggle:i})=>[(0,o._)("a",{ref_key:"dropdownAnchorRef",ref:s,href:"#",class:(0,r.C_)(e.$style.dropdownAnchor),onClick:(0,O.iM)((e=>i()),["prevent"])},[(0,o.Uk)((0,r.zw)((0,n.SU)(w)[(0,n.SU)(t).sort||(0,n.SU)(b).lastEdit])+" ",1),(0,o.Wm)(X.Z,{class:(0,r.C_)(e.$style.dropdownIcon),name:"arrow_down_16"},null,8,["class"])],10,te)])),default:(0,o.w5)((({toggle:s})=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,n.SU)(w),((r,a)=>((0,o.wg)(),(0,o.j4)(J.Z,{key:a,label:r,onClick:e=>{!function(e){t.sort=Number(e)}(a),s()}},(0,o.Nv)({_:2},[e.IS_DESKTOP?{name:"prefix",fn:(0,o.w5)((()=>[(0,o.Wm)(Q.Z,{modelValue:(0,n.SU)(t).sort,"onUpdate:modelValue":i[0]||(i[0]=e=>(0,n.SU)(t).sort=e),value:Number(a)},null,8,["modelValue","value"])])),key:"0"}:void 0]),1032,["label","onClick"])))),128))])),_:1})],2))}});var ie=s(37358),oe=s.n(ie);const re={};re.$style=oe();const ne=(0,A.Z)(se,[["__cssModules",re]]),ae=(0,o.aZ)({__name:"sort-controls-view",emits:["edit"],setup(e,{emit:t}){const s=t,i=S();return(e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:(0,r.C_)(e.$style.host)},[(0,o.Wm)(O.uT,{name:e.$style.slideUp},{default:(0,o.w5)((()=>[(0,n.SU)(i).isEditingSort?((0,o.wg)(),(0,o.j4)(ne,{key:1,class:(0,r.C_)(e.$style.slideUp)},null,8,["class"])):((0,o.wg)(),(0,o.iD)("a",{key:0,href:"#",class:(0,r.C_)([e.$style.edit,e.$style.slideUp]),onClick:t[0]||(t[0]=(0,O.iM)((e=>s("edit")),["prevent"]))},[(0,o.Wm)(X.Z,{name:"sorting-reverse_16",class:(0,r.C_)(e.$style.sortingIcon)},null,8,["class"]),(0,o.Uk)(" Настроить порядок серий ")],2))])),_:1},8,["name"])],2))}});var le=s(16514),ce=s.n(le);const de={};de.$style=ce();const ue=(0,A.Z)(ae,[["__cssModules",de]]);var pe=s(546),he=s(36830);function _e(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function me(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(s),!0).forEach((function(t){ge(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):_e(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function ge(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const ve=(0,o.aZ)(me(me({},{inheritAttrs:!1}),{},{__name:"app",props:{sort:{},seriesCount:{},handleSeriesEdit:{type:Function}},setup(e,{expose:t}){const s=e,i=S(),y=(0,n.iH)(!1),w=(0,n.iH)(!1),O=(0,o.Fl)((()=>i.isEditingSort?"Порядок серий":"Мои серии")),E=(0,a.N)(),{sendEvent:C}=(0,f.z)(),{data:x,isLoading:T}=(0,v.bw)({enabled:y}),{ready:I,start:P}=(0,l.KS)(500,{controls:!0}),{data:A,isInitialLoading:D}=(0,v.Cf)({queryKey:(0,o.Fl)((()=>v.ED.sortedSeries({sort:i.sort}))),enabled:(0,o.Fl)((()=>y.value&&i.isEditingSort&&i.sort!==b.custom))}),M=(0,o.Fl)((()=>!I.value||D.value));(0,o.YP)(D,(e=>{e&&P()}));const R=(0,o.Fl)((()=>i.isCustomSorting?i.customSeriesList:(i.isEditingSort?A.value:x.value)||[]));(0,o.m0)((()=>{i.sort===b.custom&&x.value&&!i.customSeriesList.length&&(i.customSeriesList=[...x.value])}));const N=(0,c.D9i)(A);(0,o.YP)((()=>i.sort),(e=>{e===b.custom&&N.value&&(i.customSeriesList=[...N.value])}));const{mutate:B,isLoading:L}=(0,v.dH)();function j(){i.isEditingSort&&i.sort&&R.value&&(E.setQueryData(v.ED.series(),R.value),i.isEditingSort=!1,w.value=!0,C("post_series_sorting_series_save_button_tapped",{size:s.seriesCount,type:k[i.sort]}))}async function $(){var e;if(L.value||!w.value)return;const t=i.sort===b.custom?null===(e=x.value)||void 0===e?void 0:e.map((e=>e.id)):void 0;C("post_series_popup_save_button_tapped",{size:s.seriesCount}),B({order:i.sort,seriesIds:t},{onSuccess(){y.value=!1,(0,he.g)("Порядок серий успешно сохранен"),window.location.reload()}})}function U(){i.sort&&C("post_series_sorting_series_cancel_button_tapped",{size:s.seriesCount,type:k[i.sort]})}async function F(){if(i.isEditingSort)return i.resetSortEditing(),x.value&&(i.customSeriesList=[...x.value]),void U();y.value=!1,await(0,o.Y3)(),H()}function V(){i.sort=void 0,i.isEditingSort=!1,w.value=!1,i.customSeriesList=[],E.getQueryCache().clear()}function H(){i.isEditingSort?U():C("post_series_popup_cancel_button_tapped",{size:s.seriesCount}),V()}function Z(){i.editSort(),C("post_series_popup_sorting_series_button_tapped",{size:s.seriesCount})}async function z(e){V(),y.value=!1,await(0,o.Y3)(),setTimeout((()=>{s.handleSeriesEdit(e)}),250)}return t({show:()=>{i.sort=i.initialSort=s.sort,y.value=!0}}),(e,t)=>((0,o.wg)(),(0,o.iD)(o.HY,null,[e.IS_DESKTOP?((0,o.wg)(),(0,o.j4)(d.Z,{key:0,modelValue:y.value,"onUpdate:modelValue":t[7]||(t[7]=e=>y.value=e),"cross-button":"",onClose:t[8]||(t[8]=e=>H())},{default:(0,o.w5)((()=>[(0,o.Wm)(u.Z,{class:(0,r.C_)(e.$style.modalCardBody)},{header:(0,o.w5)((()=>[(0,o._)("div",{class:(0,r.C_)(e.$style.header)},[(0,o.Wm)(pe.Z,{active:(0,n.SU)(i).isEditingSort,onClick:t[0]||(t[0]=e=>(0,n.SU)(i).resetSortEditing())},null,8,["active"]),(0,o.Wm)(h.Z,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(O.value),1)])),_:1})],2)])),content:(0,o.w5)((()=>[(0,o.Wm)(p.Z,{class:(0,r.C_)(e.$style.modalCardContent)},{default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,r.C_)(e.$style.content)},[(0,o.Wm)(ue,{onEdit:t[1]||(t[1]=e=>Z())}),(0,o.Wm)(K,{loading:M.value||(0,n.SU)(T),list:R.value,"series-count":s.seriesCount,onEdit:t[2]||(t[2]=e=>z(e)),onSwap:t[3]||(t[3]=e=>(0,n.SU)(i).swapSeries(e))},null,8,["loading","list","series-count"])],2)])),_:1},8,["class"])])),footer:(0,o.w5)((()=>[(0,o._)("footer",{class:(0,r.C_)(e.$style.footer)},[(0,n.SU)(i).isEditingSort?((0,o.wg)(),(0,o.j4)(g.Z,{key:1,label:"Применить",outline:"",onClick:t[5]||(t[5]=e=>j())})):((0,o.wg)(),(0,o.j4)(g.Z,{key:0,label:"Сохранить",loading:(0,n.SU)(L),disabled:!w.value,onClick:t[4]||(t[4]=e=>$())},null,8,["loading","disabled"])),(0,o.Wm)(g.Z,{label:"Отмена",theme:"gray",onClick:t[6]||(t[6]=e=>F())})],2)])),_:1},8,["class"])])),_:1},8,["modelValue"])):(0,o.kq)("v-if",!0),e.IS_MOBILE?((0,o.wg)(),(0,o.j4)(_.Z,{key:1,active:y.value,"onUpdate:active":t[16]||(t[16]=e=>y.value=e),"cross-btn":!1,class:(0,r.C_)(e.$style.drawer),onClose:t[17]||(t[17]=e=>H())},{header:(0,o.w5)((()=>[(0,o._)("div",{class:(0,r.C_)(e.$style.header)},[(0,o.Wm)(pe.Z,{active:(0,n.SU)(i).isEditingSort,onClick:t[9]||(t[9]=e=>(0,n.SU)(i).resetSortEditing())},null,8,["active"]),(0,n.SU)(i).isEditingSort?(0,o.kq)("v-if",!0):((0,o.wg)(),(0,o.j4)(m.Z,{key:0,size:"large","icon-name":"close_20","icon-size":20,class:(0,r.C_)(e.$style.closeBtn),onClick:t[10]||(t[10]=e=>F())},null,8,["class"])),(0,o._)("h3",null,(0,r.zw)(O.value),1)],2)])),default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,r.C_)(e.$style.content)},[(0,o.Wm)(ue,{onEdit:t[11]||(t[11]=e=>Z())}),(0,o.Wm)(K,{loading:M.value||(0,n.SU)(T),list:R.value,"series-count":s.seriesCount,onEdit:t[12]||(t[12]=e=>z(e)),onSwap:t[13]||(t[13]=e=>(0,n.SU)(i).swapSeries(e))},null,8,["loading","list","series-count"])],2),(0,o._)("footer",{class:(0,r.C_)(e.$style.footer)},[(0,n.SU)(i).isEditingSort?((0,o.wg)(),(0,o.j4)(g.Z,{key:1,label:"Применить",wide:"",outline:"",onClick:t[15]||(t[15]=e=>j())})):((0,o.wg)(),(0,o.j4)(g.Z,{key:0,label:"Сохранить",wide:"",loading:(0,n.SU)(L),disabled:!w.value,onClick:t[14]||(t[14]=e=>$())},null,8,["loading","disabled"]))],2)])),_:1},8,["active","class"])):(0,o.kq)("v-if",!0)],64))}}));var fe=s(54689),ye=s.n(fe);const be={};be.$style=ye();const we=(0,A.Z)(ve,[["__cssModules",be]]);function ke(e){return(0,i.a)(we,e)}},48849:(e,t,s)=>{"use strict";s.d(t,{H:()=>o,Y:()=>i});const i="pkb-subscribe-data",o={SUBSCRIBE:"pkb-subscribe",IGNORE:"pkb-ignore",IGNORE_COMMENTS:"pkb-ignore-comments",PESSIMIZE:"pkb-pessimize"}},81815:(e,t,s)=>{"use strict";s.r(t),s.d(t,{createApp:()=>c});var i=s(76944),o=s(74689),r=s(66252),n=s(3577),a=s(88511);const l=(0,r.aZ)({__name:"app",props:{type:{},id:{},isSubscribed:{type:Boolean,default:!1},name:{},avatar:{},isFullBan:{type:Boolean,default:!1},isIgnored:{type:Boolean,default:!1},isIgnoredComments:{type:Boolean,default:!1},isPessimized:{type:Boolean},analytics:{},actions:{},banReason:{},link:{},showText:{type:Boolean,default:!0},showIcon:{type:Boolean,default:!1},wide:{type:Boolean,default:!1},size:{default:"small"},cssClass:{default:""}},setup(e){const t=e;return(e,s)=>((0,r.wg)(),(0,r.j4)(a.Z,(0,n.vs)((0,r.F4)(t)),null,16))}});function c(e){return(0,i.a)(l,e).directive("tooltip",o.u)}},59385:(e,t,s)=>{"use strict";s.r(t),s.d(t,{createApp:()=>be});var i=s(76944),o=(s(88674),s(66252)),r=s(2262),n=s(3577),a=s(49963),l=s(91181),c=s(14949),d=s(20252),u=s(40094),p=s(69876),h=s(66090),_=s(92514);const m=(0,p.Q_)("support-dialog",{state:()=>({authorId:void 0,storyId:void 0,authorName:void 0,avatar:void 0,isApproved:void 0,allowedSupportType:void 0,subscriptionCost:void 0,isSupportDialogActive:!1,isDonationDialogActive:!1,isSubscriptionDialogActive:!1,loading:{fetchSupportOptions:!1,subscribe:!1}}),getters:{subscriptionCostText:e=>{var t;return`${(0,_.xG)(null!==(t=e.subscriptionCost)&&void 0!==t?t:0)}/месяц`}},actions:{async fetchSupportOptions(e,t){this.loading.fetchSupportOptions=!0;try{const s=await h.a8(e,t);return s.response.result&&(this.authorId=e,this.authorName=s.data.name,this.avatar=s.data.avatar,this.isApproved=s.data.is_author_approved,this.allowedSupportType=s.data.allowed_support_type,this.subscriptionCost=s.data.paid_subscription_cost),s}finally{this.loading.fetchSupportOptions=!1}},async subscribe(e){this.loading.subscribe=!0;try{return await h.Ld(this.authorId,e)}finally{this.loading.subscribe=!1}}}}),g=(0,o.aZ)({__name:"author-view",setup(e){const t=m();return(e,s)=>((0,o.wg)(),(0,o.iD)("div",{class:(0,n.C_)(e.$style.host)},[(0,o.Wm)(d.Z,{size:72,url:(0,r.SU)(t).avatar},null,8,["url"]),(0,o._)("div",{class:(0,n.C_)(e.$style.user)},[(0,o._)("span",null,(0,n.zw)((0,r.SU)(t).authorName),1),(0,r.SU)(t).isApproved?((0,o.wg)(),(0,o.j4)(u.Z,{key:0,class:(0,n.C_)(e.$style.icon),name:"approved_16"},null,8,["class"])):(0,o.kq)("v-if",!0)],2)],2))}});var v=s(69683),f=s.n(v),y=s(83744);const b={};b.$style=f();const w=(0,y.Z)(g,[["__cssModules",b]]);var k=s(22177),S=s(37043);const O=(0,o._)("a",{href:"/go/help_paid_subs",target:"_blank"},"подписку на автора",-1),E=(0,o._)("a",{href:"/go/donates_info",target:"_blank"},"Поддержите автора",-1),C=(0,o._)("br",null,null,-1),x=(0,o.aZ)({__name:"support-view",props:{modelValue:{}},emits:["update:modelValue","select","close"],setup(e,{emit:t}){const s=e,i=t,d=(0,o.Fl)({get:()=>s.modelValue,set:e=>i("update:modelValue",e)}),u=m();return(e,t)=>((0,o.wg)(),(0,o.j4)((0,o.LL)(e.IS_MOBILE?c.Z:l.Z),{modelValue:(0,r.SU)(u).isSupportDialogActive,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,r.SU)(u).isSupportDialogActive=e),title:"Поддержать автора",onClose:t[4]||(t[4]=e=>i("close"))},{default:(0,o.w5)((()=>[(0,o._)("form",{class:(0,n.C_)(e.$style.host),onSubmit:t[2]||(t[2]=(0,a.iM)((e=>i("select")),["prevent"]))},[(0,o.Wm)(w),(0,o._)("div",{class:(0,n.C_)(e.$style.options)},[(0,o._)("div",{class:(0,n.C_)(e.$style.option)},[(0,o.Wm)(k.Z,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),label:`Ежемесячная подписка (${(0,r.SU)(u).subscriptionCostText})`,value:"subscribe"},null,8,["modelValue","label"]),(0,o._)("p",{class:(0,n.C_)(e.$style.note)},[(0,o.Uk)(" Оформите "),O,(0,o.Uk)(" и получите доступ к его эксклюзивному контенту. Отменить подписку можно в любой момент в разделе «Монетизация» ")],2)],2),(0,o._)("div",{class:(0,n.C_)(e.$style.option)},[(0,o.Wm)(k.Z,{modelValue:d.value,"onUpdate:modelValue":t[1]||(t[1]=e=>d.value=e),label:"Разовый донат",value:"donate"},null,8,["modelValue"]),(0,o._)("p",{class:(0,n.C_)(e.$style.note)},[E,(0,o.Uk)(" не только плюсом, но и рублем. "),C,(0,o.Uk)("Если автор действительно хорош, он должен знать об этом! ")],2)],2)],2),(0,o.Wm)(S.Z,{class:(0,n.C_)(e.$style.button),wide:e.IS_MOBILE,label:"Перейти к оплате",type:"submit"},null,8,["class","wide"])],34)])),_:1},40,["modelValue"]))}});var T=s(40889),I=s.n(T);const P={};P.$style=I();const A=(0,y.Z)(x,[["__cssModules",P]]);s(74916),s(15306),s(66992),s(33948);var D=s(84864);const M=["src","alt"],R=["src","alt"],N=(0,o.aZ)({__name:"pkb-bank-card-header",props:{issuers:{},bank:{}},setup:e=>((0,o.bv)((()=>{[...Object.values(D.oB).map(D.sT.getIssuerLogoUrl),...Object.values(D.GV).map(D.sT.getBankLogoUrl)].forEach((e=>(new Image).src=e))})),(e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:(0,n.C_)(e.$style.host)},[(0,o.Wm)(a.uT,{"enter-from-class":e.$style.bankLogo_hidden,"leave-to-class":e.$style.bankLogo_hidden},{default:(0,o.w5)((()=>[e.bank?((0,o.wg)(),(0,o.iD)("img",{key:0,class:(0,n.C_)(e.$style.bankLogo),src:(0,r.SU)(D.sT).getBankLogoUrl(e.bank),alt:e.bank},null,10,M)):(0,o.kq)("v-if",!0)])),_:1},8,["enter-from-class","leave-to-class"]),(0,o.Wm)(a.W3,{"leave-active-class":e.$style.issuerLogo_leave_active,"enter-from-class":e.$style.issuerLogo_hidden,"leave-to-class":e.$style.issuerLogo_hidden},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.issuers,(t=>((0,o.wg)(),(0,o.iD)("img",{key:t,class:(0,n.C_)(e.$style.issuerLogo),src:(0,r.SU)(D.sT).getIssuerLogoUrl(t),alt:t},null,10,R)))),128))])),_:1},8,["leave-active-class","enter-from-class","leave-to-class"])],2)))});var B=s(26626),L=s.n(B);const j={};j.$style=L();const $=(0,y.Z)(N,[["__cssModules",j]]);var U=s(50542);const F=(0,o._)("br",null,null,-1),V=(0,o._)("br",null,null,-1),H=(0,o.aZ)({__name:"pkb-bank-card",props:{modelValue:{}},emits:["update:modelValue"],setup(e,{emit:t}){const s=e,i=t,a=(0,r.iH)(),l=(0,r.iH)(),c=(0,r.iH)(),d=(0,o.Fl)({get:()=>s.modelValue,set:e=>i("update:modelValue",e)}),u=(0,o.Fl)((()=>d.value.cardNumber.replace(/\D/g,""))),p=(0,o.Fl)((()=>D.sT.isValidLuhn(u.value))),h=(0,o.Fl)((()=>u.value.slice(0,6))),_=(0,o.Fl)((()=>D.sT.getPossibleIssuers(h.value))),m=(0,r.iH)(),g=e=>e.replace(/\D/g,""),v=e=>{let t=e.replace(/\D/g,"").slice(0,19);return`${t.slice(0,4)} ${t.slice(4,8)} ${t.slice(8,12)} ${t.slice(12)}`.trim()},f=e=>e.replace(/\D/g,"").slice(0,2).replace(/^[2-9]/,"").replace(/^1[3-9]/,"1").replace(/^00/,"0"),y=e=>e.replace(/\D/g,"").slice(0,2),b=e=>e.replace(/\D/g,"").slice(0,3),w=()=>p.value&&a.value.focus(),k=()=>2===d.value.expDateMonth.length&&l.value.focus(),S=()=>2===d.value.expDateYear.length&&c.value.focus();return(0,o.YP)(h,(async e=>m.value=await D.sT.getBank(e))),(e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:(0,n.C_)(e.$style.host)},[(0,o._)("div",{class:(0,n.C_)({[e.$style.front]:!0,[e.$style[`front_${m.value}`]]:m.value})},[(0,o.Wm)($,{issuers:_.value,bank:m.value},null,8,["issuers","bank"]),(0,o._)("div",{class:(0,n.C_)(e.$style.body)},[(0,o._)("div",{class:(0,n.C_)(e.$style.label)}," Номер карты ",2),(0,o.Wm)(U.Z,{modelValue:d.value.cardNumber,"onUpdate:modelValue":[t[0]||(t[0]=e=>d.value.cardNumber=e),w],class:(0,n.C_)(e.$style.fieldNumber),size:"small",placeholder:"XXXX XXXX XXXX XXXX",inputmode:"numeric",autocomplete:"cc-number",clean:g,autofocus:e.IS_DESKTOP,format:v,error:!p.value},null,8,["modelValue","class","autofocus","error"]),(0,o._)("div",{class:(0,n.C_)(e.$style.label)}," Действует до ",2),(0,o._)("div",{class:(0,n.C_)(e.$style.date)},[(0,o.Wm)(U.Z,{ref_key:"monthInputEl",ref:a,modelValue:d.value.expDateMonth,"onUpdate:modelValue":[t[1]||(t[1]=e=>d.value.expDateMonth=e),k],class:(0,n.C_)([e.$style.fieldDate,e.$style.fieldDate_month]),size:"small",placeholder:"ММ",inputmode:"numeric",autocomplete:"cc-exp-month",clean:f},null,8,["modelValue","class"]),(0,o._)("span",{class:(0,n.C_)(e.$style.separator)},"/",2),(0,o.Wm)(U.Z,{ref_key:"yearInputEl",ref:l,modelValue:d.value.expDateYear,"onUpdate:modelValue":[t[2]||(t[2]=e=>d.value.expDateYear=e),S],class:(0,n.C_)([e.$style.fieldDate,e.$style.fieldDate_year]),size:"small",placeholder:"ГГ",inputmode:"numeric",autocomplete:"cc-exp-year",clean:y},null,8,["modelValue","class"])],2)],2)],2),(0,o._)("div",{class:(0,n.C_)(e.$style.back)},[(0,o._)("div",{class:(0,n.C_)(e.$style.label)}," CVV/CVC ",2),(0,o.Wm)(U.Z,{ref_key:"cvvInputEl",ref:c,modelValue:d.value.cvv,"onUpdate:modelValue":t[3]||(t[3]=e=>d.value.cvv=e),class:(0,n.C_)(e.$style.fieldCvv),type:"password",size:"small",placeholder:"000",inputmode:"numeric",autocomplete:"cc-csc",clean:b},null,8,["modelValue","class"]),(0,o._)("div",{class:(0,n.C_)(e.$style.note)},[(0,o.Uk)(" три цифры"),F,(0,o.Uk)(" с обратной"),V,(0,o.Uk)(" стороны карты ")],2)],2)],2))}});var Z=s(74360),z=s.n(Z);const q={};q.$style=z();const W=(0,y.Z)(H,[["__cssModules",q]]),G=["onSubmit"],Y=(0,o._)("a",{href:"https://static.cloudpayments.ru/docs/cloudtips_oferta.pdf",target:"_blank"},"условиями сервиса CloudTips",-1),K=(0,o.aZ)({__name:"card-form-view",emits:["success","error","requestVerification"],setup(e,{emit:t}){const s=t,i=m(),l=(0,r.iH)({cardNumber:"",expDateMonth:"",expDateYear:"",cvv:""}),c=(0,o.Fl)((()=>Boolean(3===l.value.cvv.length&&l.value.expDateYear&&l.value.expDateMonth&&D.sT.isValidLuhn(l.value.cardNumber))));async function d(){try{const{response:e,data:t}=await i.subscribe(l.value);if(!e.result)return void s("error",e.message);if(null!=t&&t.url)return void s("requestVerification",t);s("success")}catch(e){s("error",e.message)}}return(e,t)=>((0,o.wg)(),(0,o.iD)("form",{class:(0,n.C_)(e.$style.host),onSubmit:(0,a.iM)(d,["prevent"])},[(0,o.Wm)(w),(0,o._)("div",{class:(0,n.C_)(e.$style.cost)},(0,n.zw)((0,r.SU)(i).subscriptionCostText),3),(0,o._)("div",{class:(0,n.C_)(e.$style.commission)}," Комиссия не взимается ",2),(0,o.Wm)(W,{modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=e=>l.value=e),class:(0,n.C_)(e.$style.card)},null,8,["modelValue","class"]),(0,o.Wm)(S.Z,{wide:e.IS_MOBILE,class:(0,n.C_)(e.$style.button),loading:(0,r.SU)(i).loading.subscribe,disabled:!c.value,label:"Оплатить",type:"submit"},null,8,["wide","class","loading","disabled"]),(0,o._)("div",{class:(0,n.C_)(e.$style.agreement)},[(0,o.Uk)(" Нажимая кнопку оплаты, вы соглашаетесь с "),Y],2)],42,G))}});var X=s(44187),J=s.n(X);const Q={};Q.$style=J();const ee=(0,y.Z)(K,[["__cssModules",Q]]);var te=s(66309);const se=["name"],ie=["target","action"],oe=["name","value"],re=(0,o.aZ)({__name:"verification-form-view",props:{url:{},params:{}},emits:["success","error"],setup(e,{emit:t}){const s=e,i=t,a=(0,r.iH)(),l=(0,r.iH)();return(0,o.bv)((()=>{var e;return null===(e=l.value)||void 0===e?void 0:e.submit()})),(0,te.ORN)(window,"message",(e=>{var t;e.origin===window.location.origin&&e.source===(null===(t=a.value)||void 0===t?void 0:t.contentWindow)&&(e.data.result?i("success"):i("error",e.data.message))})),(e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:(0,n.C_)(e.$style.host)},[(0,o._)("iframe",{ref_key:"frameEl",ref:a,class:(0,n.C_)(e.$style.frame),name:e.$style.frame},null,10,se),(0,o._)("form",{ref_key:"formEl",ref:l,target:e.$style.frame,method:"POST",action:s.url,hidden:""},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.params,((e,t)=>((0,o.wg)(),(0,o.iD)("input",{key:t,name:t,value:e,type:"hidden"},null,8,oe)))),128))],8,ie)],2))}});var ne=s(17375),ae=s.n(ne);const le={};le.$style=ae();const ce=(0,y.Z)(re,[["__cssModules",le]]);var de=s(36830),ue=s(12953);const pe=(0,o.aZ)({__name:"subscription-view",setup(e){const t=m(),s=(0,r.iH)(!1),i=(0,r.iH)(),n=(0,r.iH)();function d({url:e,params:t}){i.value=e,n.value=t,s.value=!0}function u(){t.isSubscriptionDialogActive=!1,(0,de.g)("Подписка оформлена. Информация о ваших платных подписках доступна в разделе «Монетизация»"),window.location.reload()}function p(e){ue.core.ui.toasts.showError(e,{isGlobal:!0}),s.value=!1}return(e,h)=>((0,o.wg)(),(0,o.j4)((0,o.LL)(e.IS_MOBILE?c.Z:l.Z),{modelValue:(0,r.SU)(t).isSubscriptionDialogActive,"onUpdate:modelValue":h[0]||(h[0]=e=>(0,r.SU)(t).isSubscriptionDialogActive=e),title:"Поддержать автора","cross-button":!e.IS_MOBILE||null},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(ee,{onRequestVerification:d,onSuccess:u,onError:p},null,512),[[a.F8,!s.value]]),s.value?((0,o.wg)(),(0,o.j4)(ce,{key:0,url:i.value,params:n.value,onSuccess:u,onError:p},null,8,["url","params"])):(0,o.kq)("v-if",!0)])),_:1},8,["modelValue","cross-button"]))}});var he=s(14032),_e=s(19882),me=s(12665);const ge=(0,o.aZ)({__name:"donation-view",emits:["success"],setup(e,{emit:t}){const s=m(),i=t;function o(){s.isDonationDialogActive=!1}return(0,me.XW)((()=>s.isDonationDialogActive)),(0,me.gX)((()=>s.isDonationDialogActive),{onActivated(){!async function(){try{const e=await(0,_e.q)({userId:String(s.authorId),storyId:s.storyId?String(s.storyId):void 0});if(!e)return;await(0,he.vU)({invoiceId:e.invoiceId,layoutId:e.layoutId,onSuccess:e=>{(0,he.Wi)(e)&&i("success")},onFail:e=>ue.core.logger.error("cloud tips widget",e)}),(0,he.lZ)(o)}catch(e){ue.core.logger.error("cloud tips widget",e),ue.core.ui.toasts.showError(e.message||"Не удалось перейти к оплате",{isGlobal:!0}),o()}}()}}),()=>{}}});var ve=s(89275),fe=s(55946);const ye=(0,o.aZ)({__name:"app",setup(e,{expose:t}){const{sendEvent:s}=(0,fe.z)(),i=m(),n=(0,ve.o)(),a=(0,r.iH)();let l;function c(){let e;switch(i.isSupportDialogActive=!1,a.value){case"donate":e="author_donation",i.isDonationDialogActive=!0;break;case"subscribe":e="paid_author_subscription",i.isSubscriptionDialogActive=!0;break;case"none":ue.core.ui.toasts.showError("Монетизация этого аккаунта отключена");break;default:ue.core.ui.toasts.showError("Не указан способ поддержки автора")}s("go_to_pay_button_tapped",{type:e,component_name:"author_support",author_id:i.authorId,post_id:i.storyId})}function d(){s("author_support_popup_closed",{reason:"profile"===n.initParams.pageName?"user_profile":"post",author_id:i.authorId,post_id:i.storyId})}return t({open:async e=>{const{response:t}=await i.fetchSupportOptions(e.authorId,e.storyId);if(!t.result)return void ue.core.ui.toasts.showError(t.message);const o="any"===i.allowedSupportType;o||e.giveChoice||e.supportType===i.allowedSupportType?(a.value=o?e.supportType:i.allowedSupportType,i.storyId=e.storyId,l=e.onDonateSuccess,e.giveChoice&&o?(i.isSupportDialogActive=!0,s("author_support_popup_showed",{reason:"profile"===n.initParams.pageName?"user_profile":"post",author_id:i.authorId,post_id:i.storyId})):c()):ue.core.ui.toasts.showError("Данный способ поддержки автора не доступен")}}),(e,t)=>((0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(A,{modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),onSelect:c,onClose:d},null,8,["modelValue"]),(0,o.Wm)(ge,{onSuccess:(0,r.SU)(l)},null,8,["onSuccess"]),(0,o.Wm)(pe)],64))}});function be(){return(0,i.a)(ye)}},24412:(e,t,s)=>{"use strict";s.r(t),s.d(t,{createApp:()=>N});var i=s(76944),o=s(66252),r=s(3577),n=s(2262),a=s(5707),l=s(37829),c=s(37043),d=s(89275),u=s(55946);const p={"clip-path":"url(#clip0_2135_22719)"},h=(0,o._)("mask",{id:"mask0_2135_22719",width:"200",height:"200",x:"0",y:"0",maskUnits:"userSpaceOnUse",style:{"mask-type":"luminance"}},[(0,o._)("path",{fill:"#fff",d:"M200 0H0v200h200V0Z"})],-1),_={mask:"url(#mask0_2135_22719)"},m=(0,o._)("g",{filter:"url(#filter0_f_2135_22719)"},[(0,o._)("path",{fill:"#2BA029",d:"m97.96 118.414-12.433-1.28a6.97 6.97 0 0 1-6.226-6.306L73.2 43.198c-.394-4.366 3.293-8.008 7.653-7.558l38.292 3.943c4.36.45 7.228 4.766 5.952 8.96L105.34 113.51a6.968 6.968 0 0 1-7.38 4.904Z"})],-1),g=(0,o._)("path",{stroke:"#E8EDE8","stroke-width":"6.6",d:"m104.452 63.093 6.4 11.19a4.221 4.221 0 0 0 3.718 2.125l12.89-.16a4.224 4.224 0 0 1 4.25 4.681l-1.4 12.814a4.224 4.224 0 0 0 1.759 3.906l10.522 7.446a4.223 4.223 0 0 1 .687 6.286l-8.664 9.544a4.224 4.224 0 0 0-.873 4.194l4.135 12.209a4.223 4.223 0 0 1-3.138 5.489l-12.619 2.628a4.224 4.224 0 0 0-3.172 2.88l-3.83 12.308a4.224 4.224 0 0 1-5.766 2.596l-11.754-5.291a4.222 4.222 0 0 0-4.258.466l-10.334 7.705a4.222 4.222 0 0 1-6.19-1.288l-6.4-11.19a4.224 4.224 0 0 0-3.718-2.126l-12.89.16a4.223 4.223 0 0 1-4.25-4.681l1.4-12.814a4.223 4.223 0 0 0-1.76-3.906l-10.52-7.446a4.223 4.223 0 0 1-.688-6.286l8.664-9.544a4.224 4.224 0 0 0 .873-4.194L43.39 90.586a4.223 4.223 0 0 1 3.14-5.49l12.618-2.628a4.222 4.222 0 0 0 3.172-2.88l3.83-12.307a4.224 4.224 0 0 1 5.766-2.597l11.754 5.291a4.223 4.223 0 0 0 4.258-.465l10.334-7.706a4.223 4.223 0 0 1 6.19 1.289Z",opacity:".35"},null,-1),v=(0,o._)("path",{fill:"url(#paint0_linear_2135_22719)",d:"m104.454 63.093 6.4 11.19a4.221 4.221 0 0 0 3.718 2.125l12.89-.16a4.224 4.224 0 0 1 4.25 4.681l-1.4 12.814a4.224 4.224 0 0 0 1.759 3.906l10.522 7.446a4.223 4.223 0 0 1 .687 6.286l-8.664 9.544a4.224 4.224 0 0 0-.873 4.194l4.135 12.209a4.223 4.223 0 0 1-3.138 5.489l-12.619 2.628a4.224 4.224 0 0 0-3.172 2.88l-3.83 12.308a4.224 4.224 0 0 1-5.766 2.596l-11.754-5.291a4.222 4.222 0 0 0-4.259.466l-10.333 7.705a4.222 4.222 0 0 1-6.19-1.288l-6.4-11.19a4.224 4.224 0 0 0-3.718-2.126l-12.89.16a4.223 4.223 0 0 1-4.25-4.681l1.4-12.814a4.224 4.224 0 0 0-1.76-3.906l-10.52-7.446a4.224 4.224 0 0 1-.688-6.286l8.664-9.544a4.224 4.224 0 0 0 .873-4.194l-4.136-12.208a4.223 4.223 0 0 1 3.14-5.49l12.618-2.628a4.222 4.222 0 0 0 3.172-2.88l3.83-12.307a4.223 4.223 0 0 1 5.766-2.597l11.754 5.291a4.223 4.223 0 0 0 4.258-.465l10.334-7.706a4.223 4.223 0 0 1 6.19 1.289Z",opacity:".35"},null,-1),f={filter:"url(#filter1_f_2135_22719)"},y={filter:"url(#filter2_f_2135_22719)"},b=(0,o.uE)('<defs><filter id="filter0_f_2135_22719" width="100.232" height="130.849" x="49.17" y="11.602" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feGaussianBlur result="effect1_foregroundBlur_2135_22719" stdDeviation="12"></feGaussianBlur></filter><filter id="filter1_f_2135_22719" width="60.284" height="60.283" x="62.108" y="83.475" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feGaussianBlur result="effect1_foregroundBlur_2135_22719" stdDeviation=".9"></feGaussianBlur></filter><filter id="filter2_f_2135_22719" width="39.171" height="38.593" x="73.053" y="94.858" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood><feBlend in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend><feGaussianBlur result="effect1_foregroundBlur_2135_22719" stdDeviation=".9"></feGaussianBlur></filter><linearGradient id="paint0_linear_2135_22719" x1="40.506" x2="141.539" y1="103.697" y2="124.731" gradientUnits="userSpaceOnUse"><stop stop-color="#DAF7D9"></stop><stop offset=".58" stop-color="#D2F0D0"></stop><stop offset="1" stop-color="#CDEBCC"></stop></linearGradient><clipPath id="clip0_2135_22719"><path fill="#fff" d="M0 0h200v200H0z"></path></clipPath></defs>',1);var w=s(71335),k=s.n(w),S=s(83744);const O={},E={};E.$style=k();const C=(0,S.Z)(O,[["render",function(e,t){return(0,o.wg)(),(0,o.iD)("div",{class:(0,r.C_)(e.$style.host)},[e.IS_MOBILE?((0,o.wg)(),(0,o.iD)("img",{key:0,class:(0,r.C_)(e.$style.confetti),src:"https://s.pikabu.ru/images/top-author-confetti-mv.gif"},null,2)):(0,o.kq)("v-if",!0),e.IS_DESKTOP?((0,o.wg)(),(0,o.iD)("svg",{key:1,class:(0,r.C_)(e.$style.medal),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 200 200"},[(0,o._)("g",p,[h,(0,o._)("g",_,[m,g,v,(0,o._)("g",f,[(0,o._)("path",{class:(0,r.C_)(e.$style.stroke),stroke:"#D3D3D3","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"5",d:"M94.897 87.913c14.186 1.46 24.518 14.165 23.057 28.351-1.461 14.186-14.165 24.517-28.351 23.056-14.186-1.461-24.518-14.165-23.057-28.351 1.461-14.186 14.165-24.517 28.351-23.056Z"},null,2)]),(0,o._)("g",y,[(0,o._)("path",{class:(0,r.C_)(e.$style.star),fill:"#D3D3D3",d:"m94.748 97.245 3.798 10.22a.9.9 0 0 0 .624.56l10.574 2.665a.901.901 0 0 1 .339 1.58l-8.547 6.771a.9.9 0 0 0-.339.767l.732 10.879a.901.901 0 0 1-1.398.811l-9.08-6.036a.901.901 0 0 0-.834-.086l-10.12 4.059a.901.901 0 0 1-1.204-1.079l2.935-10.502a.901.901 0 0 0-.176-.82l-6.987-8.371a.9.9 0 0 1 .654-1.477l10.894-.454a.9.9 0 0 0 .725-.421l5.802-9.232a.901.901 0 0 1 1.608.166Z"},null,2)]),(0,o._)("path",{class:(0,r.C_)(e.$style.stroke),stroke:"#fff","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"5",d:"M94.897 87.163c14.186 1.46 24.518 14.165 23.057 28.351-1.461 14.186-14.165 24.517-28.351 23.056-14.186-1.461-24.518-14.165-23.057-28.351 1.461-14.186 14.165-24.517 28.351-23.056Z"},null,2),(0,o._)("path",{class:(0,r.C_)(e.$style.star),fill:"#fff",d:"m94.748 96.495 3.798 10.22a.9.9 0 0 0 .624.56l10.574 2.665a.901.901 0 0 1 .339 1.58l-8.547 6.771a.9.9 0 0 0-.339.767l.732 10.879a.901.901 0 0 1-1.398.811l-9.08-6.036a.901.901 0 0 0-.834-.086l-10.12 4.059a.901.901 0 0 1-1.204-1.079l2.935-10.502a.901.901 0 0 0-.176-.82l-6.987-8.371a.9.9 0 0 1 .654-1.477l10.894-.454a.9.9 0 0 0 .725-.421l5.802-9.232a.901.901 0 0 1 1.608.166Z"},null,2)])]),b],2)):(0,o.kq)("v-if",!0)],2)}],["__cssModules",E]]),x=(0,o._)("p",null," Теперь вам доступны новые опции: ",-1),T=[(0,o._)("li",null,[(0,o.Uk)(" Специальный блок над постами, рассказывающий о вас пользователям. Заполнить информацию можно в "),(0,o._)("a",{href:"/settings",target:"_blank"},"настройках"),(0,o.Uk)("; ")],-1),(0,o._)("li",null," Самостоятельный буст постов в Горячее; ",-1),(0,o._)("li",null," Приоритетная поддержка от команды Пикабу по всем возникающим вопросам; ",-1),(0,o._)("li",null," Ваши посты будут чаще попадать в наши соцсети. ",-1)],I=(0,o._)("p",null," Статус топового автора выдается на 7 дней, но его можно продлить. Для этого публикуйте не менее 1 поста с тегом [моё] раз в 10 дней, набирайте рейтинг, получайте комментарии и привлекайте подписчиков. А наши алгоритмы рассмотрят вашу кандидатуру в топовые авторы. ",-1),P=(0,o.aZ)({__name:"app",setup(e){const t=(0,d.o)(),{sendEvent:s}=(0,u.z)(),i=(0,n.iH)(!0);return(0,o.bv)((()=>{s("top_author_popup_showed",{})})),(e,n)=>((0,o.wg)(),(0,o.j4)(a.Z,{modelValue:i.value,"onUpdate:modelValue":n[2]||(n[2]=e=>i.value=e),onClose:n[3]||(n[3]=e=>{s("top_author_popup_closed",{})})},{default:(0,o.w5)((()=>[(0,o.Wm)(l.Z,{class:(0,r.C_)(e.$style.body)},{default:(0,o.w5)((()=>[(0,o.Wm)(C),(0,o._)("h2",{class:(0,r.C_)(e.$style.title)}," Поздравляем, вы топовый автор Пикабу! ",2),x,(0,o._)("ul",{class:(0,r.C_)(e.$style.list)},T,2),I,(0,o._)("div",{class:(0,r.C_)(e.$style.btns)},[(0,o.Wm)(c.Z,{class:(0,r.C_)(e.$style.settingsBtn),wide:e.IS_MOBILE,onClick:n[0]||(n[0]=e=>{"user-settings"!==t.initParams.pageName?window.location.href="/settings":i.value=!1})},{default:(0,o.w5)((()=>[(0,o.Uk)(" В настройки ")])),_:1},8,["class","wide"]),e.IS_DESKTOP?((0,o.wg)(),(0,o.j4)(c.Z,{key:0,theme:"gray",onClick:n[1]||(n[1]=e=>i.value=!1)},{default:(0,o.w5)((()=>[(0,o.Uk)(" Закрыть ")])),_:1})):(0,o.kq)("v-if",!0),(0,o._)("a",{href:"/information/a_top",target:"_blank",class:(0,r.C_)(e.$style.help)}," Подробнее о топовых авторах ",2)],2)])),_:1},8,["class"]),e.IS_DESKTOP?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o._)("img",{class:(0,r.C_)([e.$style.confetti,e.$style.confetti_left]),src:"https://s.pikabu.ru/images/top-author-confetti.gif"},null,2),(0,o._)("img",{class:(0,r.C_)([e.$style.confetti,e.$style.confetti_right]),src:"https://s.pikabu.ru/images/top-author-confetti.gif"},null,2)],64)):(0,o.kq)("v-if",!0)])),_:1},8,["modelValue"]))}});var A=s(89556),D=s.n(A);const M={};M.$style=D();const R=(0,S.Z)(P,[["__cssModules",M]]);function N(){return(0,i.a)(R)}},12665:(e,t,s)=>{"use strict";s.d(t,{gX:()=>l,Uq:()=>A,ob:()=>D.o,XL:()=>r,XW:()=>b,Pr:()=>p,nB:()=>I,R8:()=>n.R,PL:()=>w,sx:()=>f});s(41817),s(31200),s(63907),s(72044);var i=s(66309),o=s(2262);function r(e,t){const s=(0,o.iH)(0),r=(0,o.iH)(0),n=(0,o.iH)(0),a=(0,o.iH)(0),l=()=>{const o=(0,i.NXq)(e);if(o){const e=o.getBoundingClientRect();null!=t&&t.absolute?(s.value=window.scrollX+e.x,r.value=window.scrollY+e.y):(s.value=e.x,r.value=e.y),n.value=e.width,a.value=e.height}else s.value=0,r.value=0,n.value=0,a.value=0};return(0,i.yU7)(e,(()=>l())),(0,i.ORN)(window,"scroll",l,{passive:!0}),(0,i.ORN)(window,"resize",l,{passive:!0}),l(),{x:s,y:r,width:n,height:a,update:l}}var n=s(17706),a=s(66252);function l(e,t){let s;const i=()=>{var e,i;null!==(e=s)&&void 0!==e&&e.active&&(s.stop(),null===(i=t.onDeactivated)||void 0===i||i.call(t))};(0,a.YP)(e,(e=>{e?(s=(0,o.B)(),s.run((()=>{var e;return null===(e=t.onActivated)||void 0===e?void 0:e.call(t)}))):i()}),{immediate:!0}),(0,o.EB)(i)}s(66992),s(33948);const c="no-scroll",d="--scrollbar-width",u=new Set;function p(e=!1){const t=(0,o.iH)(e);return u.add(t),_(h()),(0,o.EB)((()=>{u.delete(t),_(h())})),(0,a.Fl)({get:()=>document.body.classList.contains(c),set(e){t.value=e,_(h())}})}function h(){let e=!1;for(const t of u)if(t.value){e=!0;break}return e}function _(e){if(e){{const e=window.innerWidth-document.body.clientWidth;document.body.style.setProperty(d,e+"px")}document.body.classList.add(c)}else document.body.style.removeProperty(d),document.body.classList.remove(c)}var m=s(41218);const g=(0,s(69876).Q_)("modals",{state:()=>({modalsOpenCount:0}),getters:{isModalOpen:e=>e.modalsOpenCount>0},actions:{setModalOpen(){this.modalsOpenCount++},setModalClosed(){this.modalsOpenCount--}}});var v=s(12953);const f=(0,m.Dt)((()=>{const e=g(),t=y(),s=(0,a.Fl)((()=>e.modalsOpenCount+t.value)),i=(0,a.Fl)((()=>s.value>0));return(0,o.qj)({modalsOpenCount:s,isModalOpen:i})})),y=()=>{const e=(0,o.iH)(0),t=()=>{e.value=v.core.ui.overlays.modal.openedPopups};return(0,a.bv)((()=>{t(),v.core.ui.listenTo(v.core.ui.overlays.modal,"show",t),v.core.ui.listenTo(v.core.ui.overlays.modal,"hide",t)})),(0,a.Ah)((()=>{v.core.ui.stopListening(v.core.ui.overlays.modal,"show",t),v.core.ui.stopListening(v.core.ui.overlays.modal,"hide",t)})),e};function b(e){const t=g(),s=p(),i=e=>{v.core.ui.emit("lock-page-scroll",e)};(0,a.bv)((()=>{var o;l(e=null!==(o=e)&&void 0!==o?o:()=>!0,{onActivated(){s.value=!0,t.setModalOpen(),i(!0)},onDeactivated(){s.value=!1,t.setModalClosed(),i(!1)}})}))}const w=(0,m.Dt)((()=>({offsetTop:(0,a.Fl)((()=>0)),offsetLeft:(0,a.Fl)((()=>0))})));var k=s(51474);const S=["document"];function O(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function E(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?O(Object(s),!0).forEach((function(t){C(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):O(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function C(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function x(e,t){if(null==e)return{};var s,i,o=function(e,t){if(null==e)return{};var s,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)s=r[i],t.indexOf(s)>=0||(o[s]=e[s]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)s=r[i],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(o[s]=e[s])}return o}function T(e){return"function"==typeof e?e():(0,o.SU)(e)}function I(e,t,s={}){let r;const{document:n=i.Td$}=s,l=x(s,S),c={onUpdate:e=>{!function(e,t,s){const i=(0,o.dq)(e),r=i?[...T(e)]:T(e);if(s>=0&&s<r.length){const o=r.splice(t,1)[0];(0,a.Y3)((()=>{r.splice(s,0,o),i&&(e.value=r)}))}}(t,e.oldIndex,e.newIndex)}},d=()=>{const t="string"==typeof e?null==n?void 0:n.querySelector(e):(0,i.NXq)(e);t&&void 0===r&&(r=new k.ZP(t,E(E({},c),l)))},u=()=>{var e;null===(e=r)||void 0===e||e.destroy(),r=void 0};return(0,m.u7)(d),(0,m.IY)(u),{stop:u,start:d,option:(e,t)=>{var s,i;if(void 0===t)return null===(s=r)||void 0===s?void 0:s.option(e);null===(i=r)||void 0===i||i.option(e,t)}}}var P=s(92934);function A({ignoreDragenter:e}={}){const t=(0,o.iH)(!1);return(0,a.bv)((()=>{const s=(0,P.D)((()=>{t.value=!1}),100);(0,i.ORN)(document,"dragenter",(s=>{var i;null!=e&&e()||null!==(i=s.dataTransfer)&&void 0!==i&&i.types.includes("Files")&&(t.value=!0)})),(0,i.ORN)(document,"dragleave",(()=>{t.value&&s()})),(0,i.ORN)(document,"dragover",(e=>{t.value&&(e.preventDefault(),e.stopPropagation(),s())}))})),{isDragging:t}}var D=s(29818)},29818:(e,t,s)=>{"use strict";s.d(t,{o:()=>r});var i=s(66252),o=s(66309);function r(e){const{x:t,y:s}=(0,o.baj)();return(0,i.Fl)((()=>{if(!e.value)return{from:0,to:0,x:0,y:0,width:0,height:0};const{from:i,to:o}=e.value.state.selection,r=e.value.view.coordsAtPos(i),n=e.value.view.coordsAtPos(o);return{from:i,to:o,x:t.value+r.left,y:s.value+r.top,width:n.right-r.left,height:n.bottom-r.top}}))}},17706:(e,t,s)=>{"use strict";s.d(t,{R:()=>n});var i=s(2262),o=s(66252),r=s(66309);function n(e,t){let s=null,n=(0,r.NXq)(e);var a;(0,i.dq)(e)?s=(0,o.YP)((()=>(0,r.NXq)(e)),((e,s)=>{var i,o;s&&(null===(i=t.onUnmounted)||void 0===i||i.call(t,s));e&&(n=e,null===(o=t.onMounted)||void 0===o||o.call(t,e))}),{immediate:!0,flush:"post"}):n&&(null===(a=t.onMounted)||void 0===a||a.call(t,n));const l=()=>{var e,i;(null===(e=s)||void 0===e||e(),n)&&(null===(i=t.onUnmounted)||void 0===i||i.call(t,n))};return(0,i.nZ)()&&(0,i.EB)(l),l}},59870:(e,t,s)=>{"use strict";s.d(t,{ju:()=>p,w_:()=>u,gN:()=>d,Nx:()=>n,z:()=>r,yC:()=>o,Eu:()=>i,A1:()=>a,SC:()=>l,BP:()=>c});s(66992),s(33948),s(41817);const i=Symbol(),o=Symbol(),r=Symbol(),n=Symbol(),a=Symbol(),l=Symbol(),c=Symbol(),d=Symbol(),u=new Set(["image","video","videoLoader","embedVideo","embedVideoLoader","imagesCarousel"]),p=new Set(["fundraising","poll"])},74689:(e,t,s)=>{"use strict";s.d(t,{H:()=>l,u:()=>n});var i=s(55529),o=s(88358),r=s(63907);const n={mounted(e,t){if(!t.value)return;let s;e.addEventListener("mouseenter",(n=>{var a,l;if(null!==(a=s)&&void 0!==a&&a.isShown||e.disabled||"true"===e.getAttribute("disabled"))return;const c=document.createElement("div");c.classList.add("popup__hint"),t.modifiers.html?c.innerHTML=t.value:c.textContent=t.value,null!==(l=s)&&void 0!==l||(s=new o.gR({target:e,content:c,direction:o.Lh.TOP,theme:o.xb.DEFAULT,delay:1e3,destroyAfterHide:!0,zIndex:(0,i.e)()})),s.on(r.eM.DESTROYED,(()=>s=void 0)),s.onMouseEnter(n),e.addEventListener("click",(()=>{var e;return null===(e=s)||void 0===e?void 0:e.destroy()}),{once:!0})}))}};s(66992),s(33948);const a=new WeakMap,l={beforeMount(e,t){const s=e=>{(e.metaKey||e.ctrlKey)&&"Enter"===e.key&&t.value(e)};a.set(e,s),e.addEventListener("keydown",s,{capture:!0})},unmounted(e){const t=a.get(e);t&&(e.removeEventListener("keydown",t),a.delete(e))}}},15917:(e,t,s)=>{"use strict";s.d(t,{$:()=>c});s(74916),s(88674);var i=s(66252),o=s(2262),r=s(41218),n=s(16723);const a=2,l="@";function c({editor:e,storyId:t=0,type:s}){const c=(0,i.Fl)((()=>{var t;return Boolean(null===(t=e.value)||void 0===t?void 0:t.isFocused)})),d=(0,o.iH)([]),u=(0,i.Fl)((()=>{var t,s,i;return null!==(t=e.value)&&void 0!==t&&t.state.selection.empty&&null!==(s=null===(i=e.value.state.selection.$anchor.nodeBefore)||void 0===i?void 0:i.text)&&void 0!==s?s:""})),p=(0,r.Dp)(u,500),h=(0,i.Fl)((()=>{var e,t;return null!==(e=null===(t=p.value.match(/@(?!\.)([\d.a-zа-я]{1,30})$/i))||void 0===t?void 0:t[1])&&void 0!==e?e:""})),_=(0,i.Fl)((()=>h.value.length>=a)),{data:m}=(0,n.q)({type:s,storyId:t,enabled:c});(0,i.m0)((()=>{!m.value||_.value&&h.value.length||p.value[p.value.length-1]!==l||(d.value=m.value.filter((e=>e.name.includes(h.value))))}));const g=(0,i.Fl)((()=>n.TZ.searchUsers({query:h.value}))),{data:v}=(0,n.s1)({queryKey:g,enabled:(0,i.Fl)((()=>_.value&&c.value))});return(0,i.YP)(v,(e=>{e&&(d.value=e)})),(0,i.m0)((()=>{!p.value||1===p.value.length&&p.value!==l||!h.value&&p.value.length>1?d.value=[]:m.value&&p.value===l&&(d.value=m.value)})),{mentions:d,mention:h,insertUserMention:async function(t){if(!e.value)return;d.value=[],await(0,i.Y3)();const s=e.value.state.selection.$anchor.pos,o=s-h.value.length;e.value.chain().setTextSelection({from:o,to:s}).insertContent(`${t}, `).focus().run()}}}},54407:(e,t,s)=>{"use strict";s.d(t,{Z:()=>h});var i=s(544),o=s(66252),r=s(2262),n=s(26170);const a=(0,o.aZ)({__name:"node-blockquote-view",props:i.Un,setup(e){const t=e;return(e,s)=>((0,o.wg)(),(0,o.j4)(n.Z,(0,o.dG)(t,{class:e.$style.host}),{default:(0,o.w5)((()=>[(0,o.Wm)((0,r.SU)(i.ms),{as:"blockquote"})])),_:1},16,["class"]))}});var l=s(79915),c=s.n(l),d=s(83744);const u={};u.$style=c();const p=(0,d.Z)(a,[["__cssModules",u]]);const h=s(70273).NB.create({name:"blockquote",group:"block",content:"paragraph+",draggable:!0,selectable:!1,defining:!0,marks:"bold strike italic",parseHTML:()=>[{tag:"blockquote"}],renderHTML:({HTMLAttributes:e})=>["blockquote",e,0],addNodeView:()=>(0,i.uf)(p),addCommands(){return{toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-2":()=>this.editor.commands.toggleBlockquote()}}})},39631:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});const i=s(70273).NB.create({name:"doc",topNode:!0,content:"block+"})},98658:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});const i=s(35525).Z.extend({addKeyboardShortcuts(){return{"Shift-Enter":()=>this.editor.commands.setHardBreak()}}})},80788:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var i=s(544),o=s(70273),r=s(66252),n=s(3577),a=s(2262),l=s(26170);const c=(0,r.aZ)({__name:"node-paragraph-view",props:i.Un,setup(e){const t=e;return(e,s)=>((0,r.wg)(),(0,r.j4)(l.Z,(0,n.vs)((0,r.F4)(t)),{default:(0,r.w5)((()=>[(0,r.Wm)((0,a.SU)(i.ms),{as:"p"})])),_:1},16))}}),d=o.NB.create({name:"paragraph",group:"block",content:"inline*",draggable:!0,selectable:!1,parseHTML:()=>[{tag:'b[id|="docs-internal-guid"]>p',skip:!0},{tag:"p"}],renderHTML:({HTMLAttributes:e})=>["p",e,0],addNodeView:()=>(0,i.uf)(c),addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}}})},11812:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});const i=s(70273).NB.create({name:"text",group:"inline"})},55946:(e,t,s)=>{"use strict";s.d(t,{k:()=>i.kH,z:()=>o});var i=s(42107);function o(){const e=i.cp.getInstance();return{sendEvent:e.sendEvent.bind(e),google:e.google,yandex:e.yandex}}},10920:(e,t,s)=>{"use strict";s.d(t,{Bb:()=>y,Ec:()=>h,Lk:()=>v,_F:()=>b,bN:()=>m,e4:()=>w,mk:()=>f,us:()=>g,yK:()=>_});s(66992),s(33948),s(88674),s(74916),s(15306),s(85827),s(41817);var i=s(67441),o=s(32453),r=s(12950),n=s(6393),a=s(94217),l=s(85679),c=s(12953);function d(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function u(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?d(Object(s),!0).forEach((function(t){p(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function p(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class h extends Error{constructor(e,t){super(),this.message=e,this.messageCode=t}}const _={all:["comments"],drafts:({storyId:e})=>[..._.all,"drafts",{storyId:e}],save:()=>[..._.all,"save"],edit:()=>[..._.all,"edit"],loadSource:({id:e})=>[..._.all,"load-source",{id:e}],offenisveCheck:({text:e,storyId:t,commentId:s})=>[..._.all,"offensive",{text:e,storyId:t,commentId:s}],saveDraft:()=>[..._.all,"save-draft"],validate:({storyId:e,parentId:t})=>[..._.all,"validate",{storyId:e,parentId:t}]},m=()=>(0,i.D)({mutationKey:_.save(),mutationFn:async e=>{const{data:t,response:s}=await r.cf.post(n.WB,u({action:"create"},e));if(!s.result)throw new h(s.message,s.messageCode);return(0,a.E)(t)}}),g=()=>(0,i.D)({mutationKey:_.edit(),mutationFn:async e=>{const{data:t,response:s}=await r.cf.post(n.WB,u({action:"edit"},e));if(!s.result)throw new h(s.message,s.messageCode);return(0,a.E)(t)}}),v=({queryKey:e,enabled:t})=>(0,o.a)({queryKey:e,enabled:t,staleTime:5*l.g4,queryFn:async({queryKey:e})=>{const{id:t}=e[2],{data:s}=await r.cf.getOrFail(n.WB,{action:"get_comment_data",id:t},{cache:!1});return(0,a.E)(s)},select:e=>u(u({},e),{},{source:e.source.replace(/<p><br><\/p>/g,"<p></p>")})}),f=({queryKey:e,enabled:t})=>(0,o.a)({queryKey:e,enabled:t,retry:!1,refetchOnWindowFocus:!1,queryFn:async({queryKey:e,signal:t})=>{const s=Date.now(),{text:i,storyId:o,commentId:a}=e[2],{response:l,data:d}=await r.cf.post(n.WB,{action:"is_offensive",text:i,story_id:o,parent_id:a},{signal:t});if(!l.result)throw c.core.logger.error("can't reach is_offensive service",l.message),new Error;return{offensive:d.result,requestStartedAt:s}}}),y=({queryKey:e,enabled:t})=>(0,o.a)({queryKey:e,enabled:t,staleTime:1/0,queryFn:async({queryKey:e})=>{const{storyId:t}=e[2],{data:s}=await r.cf.postOrFail(n.WB,{action:"get_drafts",story_id:t});return s},select:e=>Object.entries(e).reduce(((e,[t,s])=>(e[t]=u(u({},s),{},{desc:s.desc.replace(/<p><br><\/p>/g,"<p></p>")}),e)),{})}),b=()=>(0,i.D)({mutationKey:_.saveDraft(),mutationFn:async({parentId:e,storyId:t,images:s,content:i})=>(await r.cf.postOrFail(n.WB,{action:"save_draft",images:s,desc:i,story_id:t,parent_id:e}),!0)}),w=({queryKey:e,enabled:t})=>(0,o.a)({queryKey:e,enabled:t,staleTime:30*l.vL,refetchInterval:30*l.vL,refetchOnWindowFocus:!0,queryFn:async({queryKey:e})=>{const{storyId:t,parentId:s}=e[2],{data:i}=await r.cf.postOrFail("/ajax.php",{route:"comment/validate",story_id:t,parent_id:s});return i}})},73850:(e,t,s)=>{"use strict";s.d(t,{DD:()=>T,D_:()=>P,Et:()=>b,H9:()=>I,LK:()=>C,MT:()=>O,ND:()=>k,PW:()=>E,QL:()=>x,RY:()=>S,UX:()=>g,Z:()=>m,aw:()=>_,n$:()=>w,pQ:()=>f,uF:()=>v,v3:()=>y});s(66992),s(33948),s(88674),s(85827),s(41817);var i=s(32453),o=s(67441),r=s(60963),n=s(12950),a=s(94217),l=s(7739),c=s.n(l);s(33662);function d(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function u(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?d(Object(s),!0).forEach((function(t){p(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function p(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const h="/ajax/communities_actions.php",_={all:["community"],info:({id:e})=>[..._.all,"info",{id:e}],searchCommunity:({query:e})=>[..._.all,"search-community",{query:e}],ignoreRules:({id:e})=>[..._.all,"ignore",{id:e}],addIgnoreRules:()=>[..._.all,"add-ignore-rules"],removeIgnoreRules:()=>[..._.all,"remove-ignore-rules"],subscribe:()=>[..._.all,"subscribe"],unsubscribe:()=>[..._.all,"unsubscribe"],moderationHistory:({id:e})=>[..._.all,"moderationHistory",{id:e}],trustedUsers:({id:e})=>[..._.all,"trustedUsers",{id:e}],banList:({id:e,userName:t})=>[..._.all,"banList",{id:e,userName:t}],cancelBan:()=>[..._.all,"cancelBan"],addTrustedUser:()=>[..._.all,"addTrustedUser"],deleteTrustedUser:()=>[..._.all,"deleteTrustedUser"],chiefsAndModerators:({id:e})=>[..._.all,"chiefsAndModerators",{id:e}],deleteModeator:()=>[..._.all,"deleteModeator"],addModeratorOrChief:()=>[..._.all,"addModeratorOrChief"],uploadHeader:()=>[..._.all,"uploadHeader"],dropHeader:()=>[..._.all,"dropHeader"],uploadAvatar:()=>[..._.all,"uploadAvatar"],eitCommunity:()=>[..._.all,"editCommunity"],hideProgress:()=>[..._.all,"hideProgress"]},m=({queryKey:e,enabled:t})=>(0,i.a)({queryKey:e,enabled:t,queryFn:async({queryKey:[e,t,{id:s}]})=>{const{data:i}=await n.cf.postOrFail("/ajax.php",{route:"communities/get-info",id:s});return(0,a.E)(i)}}),g=({queryKey:e,enabled:t})=>(0,i.a)({queryKey:e,enabled:t,queryFn:async({queryKey:[e,t,{query:s}]})=>{const{data:i}=await n.cf.getOrFail("/ajax/gtpost_actions.php",{action:"search_communities",name:s});return i.communities}}),v=()=>(0,o.D)({mutationKey:_.uploadHeader(),mutationFn:async({file:e,communityId:t,save:s=1})=>{const{response:i,data:o}=await n.ff.upload({type:"community_header_bg",save:s,community_id:t},e,{useFileAPI:!1});if(!i.result)throw new Error(i.message);return o}}),f=()=>(0,o.D)({mutationKey:_.uploadHeader(),mutationFn:async({file:e,communityId:t,save:s=1})=>{const{response:i,data:o}=await n.ff.upload({type:"community_avatar",save:s,community_id:t},e,{useFileAPI:!1});if(!i.result)throw new Error(i.message);return o}}),y=()=>(0,o.D)({mutationKey:_.dropHeader(),mutationFn:async({communityId:e})=>{const{response:t,data:s}=await n.cf.post(h,{action:"drop_header_bg",id:e});if(!t.result)throw new Error(t.message);return s}}),b=()=>(0,o.D)({mutationKey:_.eitCommunity(),mutationFn:async({communityId:e,desc:t,hiddenMode:s,minRating:i,pinnedStoryUrl:o,previewMode:r,rules:a,tags:l})=>{const{response:c,data:d}=await n.cf.post(h,{action:"edit",id:e,desc:t,hidden_mode:s,min_rating:i,pinned_story_url:o,preview_mode:r,rules:a,tags:l});if(!c.result)throw new Error(c.message);return d}}),w=({queryKey:e})=>(0,i.a)({queryKey:e,queryFn:async({queryKey:e})=>{const{id:t}=e[2],{response:s,data:i}=await n.cf.post(h,{action:"get_chiefs_and_moderators",id:t});if(!s.result)throw new Error(s.message);return i},select:e=>({chiefs:e.chiefs.map((e=>(0,a.E)(e))),moderators:e.moderators.map((e=>(0,a.E)(e)))})}),k=()=>(0,o.D)({mutationKey:_.deleteModeator(),mutationFn:async({communityId:e,userId:t})=>{const{data:s}=await n.cf.postOrFail(h,{action:"delete_moderator",id:e,user_id:t});return s}}),S=()=>(0,o.D)({mutationKey:_.addModeratorOrChief(),mutationFn:async({communityId:e,isChief:t,userName:s})=>{const{data:i}=await n.cf.postOrFail(h,{action:"add_moderator",user_name:s,add_as_chief:t,id:e});return i}}),O=({queryKey:e})=>(0,r.N)({queryKey:e,queryFn:async({pageParam:e=0,queryKey:t})=>{const{id:s}=t[2],{response:i,data:o}=await n.cf.post(h,{action:"get_history",from_time:e,id:s});if(!i.result)throw new Error(i.message);return{list:o.data,hasMore:o.has_more,lastTime:e}},getNextPageParam:e=>!!e.hasMore&&e.list.reduce(((e,{time:t})=>t<e||0===e?t:e),e.lastTime),select:e=>({pageParams:e.pageParams,pages:e.pages.map((e=>({list:e.list.map((e=>(0,a.E)(e))),hasMore:e.hasMore,lastTime:e.lastTime})))})}),E=({queryKey:e})=>(0,r.N)({queryKey:e,queryFn:async({pageParam:e=0,queryKey:t})=>{const{id:s}=t[2],{response:i,data:o}=await n.cf.post(h,{action:"get_trusted_users_list",from_id:e,id:s});if(!i.result)throw new Error(i.message);return{list:o.data,hasMore:o.has_more}},getNextPageParam:e=>!!e.hasMore&&(e.list[e.list.length-1].user_id||0),select:e=>({pageParams:e.pageParams,pages:e.pages.map((e=>({list:e.list.map((e=>(0,a.E)(e))),hasMore:e.hasMore})))})}),C=({queryKey:e})=>(0,r.N)({queryKey:e,queryFn:async({pageParam:e=0,queryKey:t})=>{const{id:s,userName:i}=t[2],{response:o,data:r}=await n.cf.post(h,{action:"get_ban_list",from_id:e,user_name:i,id:s});if(!o.result)throw new Error(o.message);return{list:r.list,hasMore:r.has_more}},getNextPageParam:e=>!!e.hasMore&&(e.list[e.list.length-1].user_id||0),select:e=>({pageParams:e.pageParams,pages:e.pages.map((e=>{const t=e.list.map((e=>(0,a.E)(e))),s=c()(t,"parentId");return{list:s[0]?Object.values(s[0]).map((e=>{var t;return u(u({},e),{},{children:Object.values(null!==(t=s[e.id])&&void 0!==t?t:[])})})):[],hasMore:e.hasMore}}))})}),x=()=>(0,o.D)({mutationKey:_.cancelBan(),mutationFn:async({communityId:e,userId:t})=>{const{data:s}=await n.cf.postOrFail(h,{action:"cancel_ban",id:e,user_id:t});return s}}),T=()=>(0,o.D)({mutationKey:_.addTrustedUser(),mutationFn:async({communityId:e,userName:t})=>{const{response:s,data:i}=await n.cf.post(h,{action:"add_trusted_user",id:e,user_name:t});if(!s.result)throw new Error(s.message);return i}}),I=()=>(0,o.D)({mutationKey:_.deleteTrustedUser(),mutationFn:async({communityId:e,userId:t})=>{const{response:s,data:i}=await n.cf.post(h,{action:"delete_trusted_user",id:e,user_id:t});if(!s.result)throw new Error(s.message);return i}}),P=()=>(0,o.D)({mutationKey:_.hideProgress(),mutationFn:async({communityId:e})=>n.cf.postOrFail("ajax.php?route=community-actions/hide-progress",{community_id:e})})},27929:(e,t,s)=>{"use strict";s.d(t,{L:()=>o});s(88674);var i=s(12950);async function o(e){const{response:t}=await i.cf.post("/ajax.php",{route:"email-broadcasting/subscribe",email:e});return t}},44813:(e,t,s)=>{"use strict";s.d(t,{aw:()=>D.aw,uc:()=>a,uj:()=>P,ED:()=>b,Ix:()=>n,$x:()=>l,RY:()=>D.RY,DD:()=>D.DD,dH:()=>S,LK:()=>D.LK,QL:()=>D.QL,n$:()=>D.n$,Z:()=>D.Z,kt:()=>C,ND:()=>D.ND,_O:()=>I,H9:()=>D.H9,v3:()=>D.v3,Et:()=>D.Et,n2:()=>x,D_:()=>D.D_,JY:()=>A,MT:()=>D.MT,dO:()=>E,bw:()=>w,Hh:()=>O,qi:()=>T,Cf:()=>k,PW:()=>D.PW,pQ:()=>D.pQ,uF:()=>D.uF});s(88674);var i=s(44760),o=s(12953),r=s(12950);const n=(0,i.Z)((async(e,t,s)=>await r.ff.upload({type:"story_image",save:1,uid:0},e,{progress:e=>null==t?void 0:t(e.loaded/e.total),signal:s})),3),a=async(e,t)=>await r.ff.post({type:"story_image",save:1,url:e},{signal:t}),l=async(e,t,s)=>await r.cf.upload(o.core.initParams.uploadVideoServerUrl+"/ajax/upload_video.php",{uid:"video"},e,{progress:e=>t(e.loaded/e.total),signal:s});s(66992),s(33948),s(2707),s(41817);var c=s(32453),d=s(67441),u=s(60963),p=s(29883),h=s(94217),_=s(42107),m=s(85679),g=s(33877);function v(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function f(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?v(Object(s),!0).forEach((function(t){y(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):v(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function y(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const b={all:["series"],series:()=>[...b.all,"get-series"],allSortedSeries:()=>[...b.all,"get-sorted-series"],sortedSeries:({sort:e})=>[...b.allSortedSeries(),{sort:e}],applySort:()=>[...b.all,"apply-sort"],createSeries:()=>[...b.all,"create"],editSeries:()=>[...b.all,"edit"],sortStories:()=>[...b.all,"sort-stories"],seriesStories:e=>[...b.all,"added-stories",{seriesId:e}],searchStoriesPreviews:e=>[...b.all,"stories-previews",e]},w=({enabled:e})=>(0,c.a)({queryKey:b.series(),enabled:e,staleTime:1/0,queryFn:async()=>{const{data:e}=await r.cf.getOrFail("/ajax.php",{route:"series/user-series"});return e},select:e=>e.map((e=>(0,h.E)(e)))}),k=({queryKey:e,enabled:t})=>(0,c.a)({queryKey:e,enabled:t,staleTime:3*m.g4,queryFn:async({queryKey:e})=>{const{sort:t}=e[2];if(!t)return[];const{data:s}=await r.cf.postOrFail("/ajax.php",{route:"series/sort-series",order:t});return s},select:e=>e.map((e=>(0,h.E)(e)))}),S=()=>(0,d.D)({mutationKey:b.applySort(),mutationFn:async({order:e,seriesIds:t})=>{if(!e)return!1;const{response:s}=await r.cf.post("/ajax.php",{route:"series/set-order",order:e,series_id:t});if(!s.result)throw new Error(s.message||"Не удалось сохранить порядок серий");return!0}}),O=({queryKey:e,enabled:t})=>(0,c.a)({queryKey:e,enabled:t,staleTime:15*m.g4,queryFn:async({queryKey:e})=>{const{seriesId:t}=e[2],{data:s}=await r.cf.getOrFail("/ajax.php",{route:"series/stories-list",series_id:t||void 0});return s.stories}}),E=({queryKey:e,enabled:t})=>(0,u.N)({queryKey:e,staleTime:5*m.g4,refetchOnWindowFocus:!1,enabled:t,queryFn:async({queryKey:e,pageParam:t=1})=>{const{query:s,tags:i,from:o,to:n}=e[2],{response:a,data:l}=await r.cf.get("/ajax.php",{route:"series/search-stories",q:s,p:t,t:i,from:o,to:n});if(await(0,g.g)(300),!a.result)throw new Error(a.message||"Не удалось получить список постов");return l},getNextPageParam:(e,t)=>!(e.length<50)&&t.length+1}),C=()=>(0,d.D)({mutationKey:b.createSeries(),mutationFn:async({title:e,cover:t,storiesIds:s})=>{const{response:i,data:o}=await r.cf.post("/ajax.php",{route:"series/add",title:e,cover:t,story_id:s});if(!i.result)throw i.messageCode===p.RT.SERIES_LIMIT&&_.cp.getInstance().sendEvent("error_occurred",{type:"post_series_max_count"}),new Error(i.message||"Не удалось добавить серию");return f(f({},(0,h.E)(o)),{},{storiesCount:s.length})}}),x=()=>(0,d.D)({mutationKey:b.editSeries(),mutationFn:async({series:e,cover:t,addStoriesIds:s,removeStoriesIds:i})=>{const{response:o}=await r.cf.post("/ajax.php",{route:"series/edit",series_id:e.id,title:e.title,cover:t,add_story_id:s,remove_story_id:i});if(!o.result)throw new Error(404===o.status?"Серия постов не найдена":o.message||"Не удалось добавить серию");return{series:f(f({},e),{},{storiesCount:e.storiesCount+s.length-i.length})}}}),T=()=>(0,d.D)({mutationKey:b.sortStories(),mutationFn:async({seriesId:e,storiesIds:t})=>{const{response:s}=await r.cf.post("/ajax.php",{route:"series/set-stories-order",series_id:e,stories_ids:t});if(!s.result)throw new Error(s.message||"Не удалось настроить порядок серий");return!0}}),I=()=>(0,d.D)({mutationFn:async e=>{const{response:t,data:s}=await r.cf.post("/ajax.php",{route:"series/delete",series_id:e});if(!t.result||!s)throw new Error(t.message||"Не удалось удалить серию");return!0}}),P={all:["reputation"],findMentionsInText:({text:e})=>[...P.all,"findMentionsInText",{text:e}]},A=({queryKey:e,enabled:t})=>(0,c.a)({queryKey:e,enabled:t,queryFn:async({queryKey:e,signal:t})=>{const{text:s}=e[2];if(!s)return[];const{data:i}=await r.cf.postOrFail("/ajax/reputation.php",{action:"check_feedback_mention",text:s},{signal:t});return i.clients}});s(10920);var D=s(73850)},66090:(e,t,s)=>{"use strict";s.d(t,{KH:()=>d,Ld:()=>a,a8:()=>n,r1:()=>l,wC:()=>c,wp:()=>u});s(88674);var i=s(84864),o=s(12950);const r=new i.sT((async e=>{const{response:t,data:s}=await async function(e){return await o.cf.get("/ajax.php",{route:"paid-subscriptions/get-public-id",author_id:e})}(e);if(!t.result)throw new Error(t.message);return s.public_id}));async function n(e,t){return await o.cf.get("/ajax.php",{route:"monetization/author-summary",author_id:e,story_id:t})}async function a(e,t){return await o.cf.post("/ajax.php?route=paid-subscriptions/start",{author_id:e,payload:await r.createCryptogram(t,e)})}async function l(e){return await o.cf.post("/ajax.php?route=paid-subscriptions/cancel",{author_id:e})}async function c(e){return await o.cf.post("/ajax.php?route=paid-subscriptions/create",{cost:e})}async function d(){return await o.cf.post("/ajax.php?route=paid-subscriptions/delete")}async function u(e){return await o.cf.post("/ajax/donations_actions.php",{action:"enable_donations",user_id:e})}},55680:(e,t,s)=>{"use strict";s.d(t,{BN:()=>c,XX:()=>d,qh:()=>u});s(41817);var i=s(32453),o=s(67441),r=s(12950),n=s(2262);function a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function l(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const c=(e,t)=>(0,i.a)({queryKey:["paid-user-form/price",{months:e,promocode:t}],queryFn:()=>r.cf.postOrFail("/ajax.php",{route:"paid-user-form/price",month_count:(0,n.SU)(e),promo_code:(0,n.SU)(t)}),select:e=>e.data});let d;!function(e){e[e.jur=1]="jur",e[e.ip=2]="ip",e[e.phys=3]="phys"}(d||(d={}));const u=()=>(0,o.D)({mutationFn:e=>r.cf.postOrFail("/ajax.php",function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?a(Object(s),!0).forEach((function(t){l(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({route:"paid-user-form/request"},e))})},16723:(e,t,s)=>{"use strict";s.d(t,{TZ:()=>a,q:()=>l,s1:()=>c});s(66992),s(33948),s(88674),s(41817);var i=s(32453),o=s(12950),r=s(94217);const n="/ajax/users_actions.php",a={all:["user"],applySettings:()=>[...a.all,"change_settings"],predefinedUsers:()=>[...a.all,"story-users"],searchUsers:({query:e})=>[...a.all,"search-users",{query:e}]},l=({storyId:e,type:t,enabled:s})=>(0,i.a)({queryKey:a.predefinedUsers(),enabled:s,queryFn:async()=>{const{data:s}=await o.cf.getOrFail(n,{type:t,q:"",action:"droplist",story_id:e});return s},select:e=>e.map((e=>(0,r.E)(e)))}),c=({queryKey:e,enabled:t})=>(0,i.a)({queryKey:e,enabled:t,staleTime:1/0,queryFn:async({queryKey:e})=>{const{query:t}=e[2],{data:s}=await o.cf.getOrFail(n,{q:t,action:"droplist"});return s},select:e=>e.map((e=>(0,r.E)(e)))})},89275:(e,t,s)=>{"use strict";s.d(t,{o:()=>i.o});var i=s(76987)},76987:(e,t,s)=>{"use strict";s.d(t,{o:()=>r});var i=s(69876),o=s(12953);const r=(0,i.Q_)("root",{state:()=>({initParams:o.core.initParams})})},15112:(e,t,s)=>{"use strict";s.d(t,{S:()=>p});s(88674);var i=s(69876),o=s(48849),r=s(44361),n=s(1262),a=s(2889),l=s(96637),c=s(12953),d=s(33662),u=s(53201);const p=(0,i.Q_)("subscribeStore",{state:()=>({subscribe:{community:{},user:{},tag:{},comstory:{}},ignore:{community:{},user:{},tag:{}},ignoreComments:{user:{}},pessimize:{comstory:{}},processing:{community:{},user:{},tag:{},comstory:{}}}),actions:{addButton(e){if(void 0===this.subscribe[e.type][String(e.id)]){const t=e.isSubscribed||!1;this.subscribe[e.type][String(e.id)]=t}if("comstory"!==e.type&&void 0===this.ignore[e.type][String(e.id)]){const t=e.isIgnored||!1;this.ignore[e.type][String(e.id)]=t}if("user"===e.type&&void 0===this.ignoreComments[e.type][String(e.id)]){const t=e.isIgnoredComments||!1;this.ignoreComments[e.type][String(e.id)]=t}if("comstory"===e.type&&void 0===this.pessimize[e.type][String(e.id)]){const t=e.isPessimized||!1;this.pessimize[e.type][String(e.id)]=t}},async toggleSubscribe(e,t,s,i){if(!c.core.isUserAuthorized)return;if(this.processing[e][t]||i===this.subscribe[e][t])return;let d=!0;this.processing[e][t]=!0;const p=Date.now();i=!this.subscribe[e][t];try{if("tag"===e?d=await r.zG.subscribe(t,i,s.value):"user"===e?await new n.User(t).subscribe(i,s.value):"community"===e?await new a.S1(t).subscribe(i,s.value):"comstory"===e&&(await(0,u.t)(Number(t),i),i&&(this.pessimize[e][t]=!1)),!d)return;await l.Utils.delay(500-(Date.now()-p)),this.subscribe[e][t]=i;const h={event:"pkb-subscribe",type:e,id:t,value:i},_="BroadcastChannel"in window&&new BroadcastChannel(o.Y);_&&_.postMessage(h),c.core.emit("subscribeEnded",{type:e,id:t,isSubscribed:i})}finally{this.processing[e][t]=!1}},async getIgnoreRules(e,t){let s;try{if("user"===e)s=await d.jj.getUserIgnore(t);else if("tag"===e){var i;const e=await d.jj.getTagIgnore(t);s=null!==(i=e.rules[0])&&void 0!==i&&i.tags.includes(t)?e.rules:[]}else"community"===e&&(s=await d.jj.getCommunityIgnore(t));return s&&s.length?s.map((e=>"object"==typeof e&&e.id?e.id:Number(e))):[]}catch(o){throw c.core.logger.error(o),o}}},getters:{}})},76318:(e,t,s)=>{"use strict";s.d(t,{ZP:()=>d,lZ:()=>c,FK:()=>l,AG:()=>a,aR:()=>n,Pu:()=>r});var i=s(70273),o=s(99667);const r=({nodeName:e,force:t,disablingNodeNames:s=[]})=>({commands:i,editor:r})=>!0===t?i.setNode(e):!1===t?i.setNode(o.Z.name):s.every((e=>!r.isActive(e)))&&i.toggleNode(e,o.Z.name),n=(e,t={},s={})=>({state:o,commands:r})=>(0,i.yw)(o,e,t)?r.toggleMark(e,t,s):r.pkbSetMark(e,t),a=(e,t={})=>({commands:s,tr:o,state:r})=>{const n=o.selection.$anchor.node(1),a=(0,i.TP)(e,r.schema);return!(null==n||!n.type.allowsMarkType(a))&&s.setMark(e,t)};s(66992),s(33948);const l=(e,t)=>({editor:s,commands:i})=>{const o=s.getJSON();if(!o.content)return!1;const r=o.content.findIndex((t=>{var s;return(null===(s=t.attrs)||void 0===s?void 0:s.id)===e}));if(!o.content[r+t])return!1;const n=o.content.length-1;return r!==n&&r+t!==n&&([o.content[r+t],o.content[r]]=[o.content[r],o.content[r+t]],i.setContent(o))},c=e=>({commands:t})=>t.deleteRange({from:e,to:e+1}),d=i.hj.create({name:"pkbCommands",addCommands:()=>({pkbToggleNode:r,pkbToggleMark:n,pkbSetMark:a,pkbMoveNode:l,pkbDeleteAtomNode:c})})},15067:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});s(74916);const i=s(70273).vc.create({name:"bold",parseHTML:()=>[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!==e.style.fontWeight&&null},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],renderHTML:()=>["b",0],addCommands(){return{toggleBold:()=>({commands:e})=>e.pkbToggleMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}}})},55063:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});const i=s(70273).vc.create({name:"italic",parseHTML:()=>[{tag:"em"},{tag:"i"},{style:"font-style=italic"}],renderHTML:()=>["i",0],addCommands(){return{toggleItalic:()=>({commands:e})=>e.pkbToggleMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}}})},61445:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});s(74916),s(66992),s(33948),s(60285),s(41637);var i=s(70273),o=s(82800),r=s(2376),n=s(29939);const a=i.vc.create({name:"link",priority:1e3,keepOnSplit:!1,inclusive:!1,addAttributes:()=>({href:{default:null}}),addOptions:()=>({hintDirection:o.Lh.BOTTOM}),parseHTML:()=>[{tag:"a",getAttrs:e=>{const t=e.href,s=/^https?:\/\/([^.]+\.)?pikabu\.(ru|lh)/.test(t)&&t===e.textContent;return!(!t||s||t.startsWith("javascript:")||t.startsWith("#")||t.startsWith("about:blank"))&&null}}],renderHTML({HTMLAttributes:e}){let t;const s=/^(?:https?:\/\/)?(?:[^\n/@]+@)?(?:www\.)?([^\n/:]+)[\d:]*/i;if(e.href){const t=e.href.match(s)[0],i=new URL(e.href),o=i.href.split(i.origin)[1];o&&(e.href=t+o)}try{t=decodeURI(e.href)}catch(r){t=e.href}const o=e.href?{class:"hint","aria-label":t,"data-direction":this.options.hintDirection}:{};return["a",(0,i.P1)({target:"_blank",rel:"noopener noreferrer nofollow"},o,e),0]},addCommands(){return{setLink:e=>({chain:t,state:s})=>!s.selection.empty&&t().pkbSetMark(this.name,e).run(),toggleLink:e=>({chain:t})=>t().pkbToggleMark(this.name,e,{extendEmptyMarkRange:!0}).run(),unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).run(),inputLink:()=>({tr:e,dispatch:t,state:s})=>!s.selection.empty&&(t&&(e.setMeta("inputLink",!0),e.setMeta("addToHistory",!1)),!0)}},addKeyboardShortcuts(){return{"Mod-k":()=>this.editor.commands.inputLink(),"Mod-K":()=>this.editor.commands.inputLink()}},addProseMirrorPlugins(){return[(e={editor:this.editor,type:this.type},new r.Sy({key:new r.H$("linkOnPaste"),props:{handlePaste:(t,s,i)=>{if(t.state.selection.empty)return!1;let o="";if(i.content.forEach((e=>o+=e.textContent)),!o)return!1;const[r]=n.j.extract(o);return o===r&&(e.editor.commands.pkbSetMark(e.type,{href:r}),!0)}}}))];var e}})},9855:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});const i=s(70273).vc.create({name:"strike",parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("line-through")&&{}}],renderHTML:()=>["strike",0],addCommands(){return{toggleStrike:()=>({commands:e})=>e.pkbToggleMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}}})},96448:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});s(74916);var i=s(70273),o=s(2376);const r=i.hj.create({name:"msEdgePasteLinksWorkaround",addProseMirrorPlugins(){return[new o.Sy({key:new o.H$("msEdgePasteHandler"),props:{handlePaste:(e,t)=>{var s;const i=null===(s=t.clipboardData)||void 0===s?void 0:s.getData("text/link-preview");if(i)try{const e=JSON.parse(i);if(null!=e&&e.url&&/^https?:\/\/([^.]+\.)?pikabu\.(ru|lh)/.test(e.url))return this.editor.commands.insertContent(e.url),!0}catch(o){console.error("Не удалось конвертировать ссылку",o)}}}})]}})},70204:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var i=s(70273),o=s(2376),r=s(84348);const n=i.hj.create({name:"placeholder",addOptions:()=>({placeholder:""}),addProseMirrorPlugins(){return[new o.Sy({key:new o.H$(this.name),props:{decorations:({doc:e})=>{if(!this.options.placeholder)return;const t=e.firstChild;if(!(e.childCount<=1&&(!t||0===t.content.size))||!t)return;const s=r.p.node(0,t.nodeSize,{"data-placeholder":this.options.placeholder});return r.EH.create(e,[s])}}})]}})},76944:(e,t,s)=>{"use strict";s.d(t,{a:()=>a});var i=s(49963),o=s(69876),r=s(16345);const n=(0,o.WB)();function a(e,t){const s=(0,i.ri)(e,t);return s.config.globalProperties.IS_MOBILE=!1,s.config.globalProperties.IS_DESKTOP=!0,s.use(n),(0,r.h)(s),s}},53536:(e,t,s)=>{"use strict";s.d(t,{G1:()=>a,We:()=>n,f3:()=>u,hJ:()=>l,u1:()=>d});s(74916);var i=s(12953),o=s(98858);const r=/video\/.*/,n=["png","gif","jpeg","jpg","webp"],a=["mp4","webm","mov","avi"];function l(e){const t=i.core.config("modules.story-editor.LIMIT_IMAGES_BYTES");return!(e.size>t)&&(e.type?o.HP.test(e.type):n.includes(p(e)))}function c(e){return l(e)?"image":function(e){const t=i.core.config("modules.story-editor.LIMIT_MAX_FILE_SIZE");return!(e.size>t)&&(e.type?r.test(e.type):a.includes(p(e)))}(e)?"video":void 0}function d(e){return e.map(u)}function u(e){return{file:e,type:c(e)}}function p(e){var t,s;return null!==(t=null===(s=e.name)||void 0===s?void 0:s.toLowerCase().split(".").pop())&&void 0!==t?t:""}},93356:(e,t,s)=>{"use strict";s.d(t,{D3:()=>u,id:()=>i,wH:()=>c,Eh:()=>p.E});const i=e=>{var t;return null!==(t=null==e?void 0:e.split(",").map((e=>e.trim())).filter((e=>""!==e)))&&void 0!==t?t:[]};var o=s(13218),r=s.n(o),n=s(77105),a=s(53056),l=s(12953);const c=()=>{var e,t;const s=l.core.config("modules.story-editor");let i=(null===(e=(t=parent).__getStoryData)||void 0===e?void 0:e.call(t))||(null==s?void 0:s.draft)||(null==s?void 0:s.story);if(!i){const e=a.m.get(n.Xm);r()(e)&&(i=e)}return i||{}};var d=s(66252);function u(e,t,s){const i=(0,d.f3)(e,t,s);if(null==i)throw new Error("Используй provide для инициализации зависимости");return i}var p=s(16345)},16345:(e,t,s)=>{"use strict";s.d(t,{E:()=>d,h:()=>u});var i=s(51122),o=s(56201),r=s(49839),n=s(41908),a=s(85679),l=s(12953);const c=e=>{e instanceof Error&&e.message&&l.core.ui.toasts.showError(e.message,{isGlobal:!0})},d=new r.S({defaultOptions:{queries:{refetchOnWindowFocus:!1,staleTime:15*a.g4}},queryCache:new i.t({onError:c}),mutationCache:new o.L({onError:c})});function u(e){n.P.install(e,{queryClient:d})}},57552:(e,t,s)=>{"use strict";s.d(t,{g:()=>i});s(74916),s(15306);const i=(e,t)=>{var s;null===(s=document.body.querySelector(`img[data-pixel="${e}"]`))||void 0===s||s.remove(),t=t.replace("[random]",Math.ceil(4294967295*Math.random()).toString());document.body.insertAdjacentHTML("beforeend",`<img src="${t}" data-pixel="${e}" style="width: 1px; height: 1px; position: absolute; left: -10000px;" />`)}},64313:(e,t,s)=>{"use strict";s.d(t,{t:()=>r});s(66992),s(33948);var i=s(75021),o=s(36005);let r={render:({props:e})=>{let t="icon--"+e.block,s=t,r=(0,o.isString)(e.modifiers)?e.modifiers.split(" "):e.modifiers||[];return 1===r.length&&(0,o.isArray)(r[0])&&(r=r[0]),r.length&&(r=r.map((e=>(s=s+"_"+e,t+"_"+e)))),r=(0,o.compact)([t,...r,r.length>1?s:""]).join(" "),i.vu.create("svg",{xmlns:"http://www.w3.org/2000/svg",className:"icon "+r},i.vu.create("use",{xlinkHref:"#"+t}))},notUpdate:!0}},76468:(e,t,s)=>{"use strict";s.d(t,{t:()=>r.t,N:()=>o});var i=s(75021);let o={render:({props:e})=>i.vu.create("a",{href:"/@"+e.name,className:"user user_inline"},i.vu.create("span",{className:"avatar avatar_small"},e.avatar?i.vu.create("img",{src:e.avatar}):i.vu.create("span",{className:"avatar__default"})),!0!==e.short&&i.vu.create("span",{className:"user__nick"},e.name)),notUpdate:!0};var r=s(64313)},32038:(e,t,s)=>{"use strict";s.d(t,{F:()=>o});const i=s(19755),o=()=>{function e(e,t){let s=i(".ad-video-cont"),o=i(window),r=o.width(),n=o.height(),a=r/2,l=n/2;if(t&&"function"==typeof t||(t=function(){}),"start"===e)s.css({left:~~(a-0)+"px",top:~~(l-0)+"px",width:"20px",height:"20px",opacity:0});else if("finish"===e)s.stop().animate({left:~~(a-0)+"px",top:~~(l-0)+"px",width:"20px",height:"20px",opacity:0},t);else{let e=Number(s.data("w")),i=Number(s.data("h")),o=Math.min(1,(r-100)/e,(n-100)/i);1!==o&&(e*=o,i*=o),s.css("display","block");let c={left:~~(a-e/2-0)+"px",top:~~(l-i/2+0)+"px",width:e+"px",height:i+"px",opacity:1};s.stop().animate(c,t)}}i("div.ad-video-layer, div.ad-video-close").click((function(t){t.preventDefault(),t.stopPropagation(),i(".ad-video-close").fadeOut(100),i(window).unbind("resize",e),i(".ad-video-box").html(""),e("finish",(function(){i(".ad-video-bg").fadeOut(200)}))})),i("div.ad-video-btn").click((function(t){var s;t.preventDefault(),t.stopPropagation(),e("start"),i(".ad-video-bg").fadeIn(200,(function(){i(".ad-video-close").fadeIn(200),e("show",(function(){let e=i(".ad-video-box");e.append(i("<iframe></iframe>").attr("type","text/html").attr("width","100%").attr("height","100%").attr("src","https://www.youtube.com/embed/"+e.data("id")+"?autoplay=1").attr("frameborder","0"))})),i(window).bind("resize",e)})),null===(s=window.yaCounter174977)||void 0===s||s.reachGoal("showbvideo")}));let t=0,s=setInterval((function(){t++,"string"==typeof window.adBrandingID&&(document.getElementById(window.adBrandingID).offsetHeight>50?(i("div.ad-video-btn").fadeIn(200),clearInterval(s)):t>20&&(clearInterval(s),i("div.ad-video-btn").hide()))}),20)}},41531:(e,t,s)=>{"use strict";s.d(t,{h:()=>a});var i=s(95411),o=s(12953),r=s(36005),n=s(47994);class a{constructor(e){this.ui=e}get currentCommentId(){return this._currentCommentId}set currentCommentId(e){this._currentCommentId!==e&&(this._currentCommentId=e,o.core.logger.log("comments-extension","set current comment",e))}render(){this.ui.mode!==n.lL.STORY_TOP&&(this.initHotkeys(),this.attachDetectFocusIn(),this.attachMouseEnterComment())}initHotkeys(){o.core.ui.hotkeys.on(["w","add"],(()=>{if(!this.currentCommentId||!this.focused)return;const e=this.ui.comments.get(this.currentCommentId);e&&o.core.ui.elementInViewport(e.$el)&&this.ui.vote(e,n.OC.UP)}),{type:i.FM.KEYDOWN,repeat:!1}),o.core.ui.hotkeys.on(["s","subtract"],(()=>{if(!this.currentCommentId||!this.focused)return;const e=this.ui.comments.get(this.currentCommentId);e&&o.core.ui.elementInViewport(e.$el)&&this.ui.vote(e,n.OC.DOWN)}),{type:i.FM.KEYDOWN,repeat:!1})}attachDetectFocusIn(){var e;return null===(e=this.ui.$el)||void 0===e||e.on("mouseenter",(0,r.throttle)((()=>{this.focused=!0,o.core.logger.log("comments-extension","focus in",this.ui.eid)}),50)),this}attachMouseEnterComment(){var e;return null===(e=this.ui.$el)||void 0===e||e.on("mouseenter",".comment__body",(0,r.debounce)((e=>{this.currentCommentId=this.ui.getCommentIdByElement(e.target)}),50)),this}get focused(){return o.core.storage.focused===this.ui.eid}set focused(e){this.focused!==(e=Boolean(e))&&(o.core.storage.focused=e?this.ui.eid:void 0)}}},34414:(e,t,s)=>{"use strict";s(74916);var i=s(12953),o=s(77702),r=s(75130);s(88674),s(41817),s(66992),s(33948);"undefined"!=typeof FormData&&FormData.prototype.keys||function(){const e="object"==typeof window?window:"object"==typeof self?self:this,t=e.FormData,s=e.XMLHttpRequest&&e.XMLHttpRequest.prototype.send,i=e.Request&&e.fetch,o=e.Symbol&&Symbol.toStringTag,r=new WeakMap,n=e=>r.get(e),a=Array.from||(e=>[].slice.call(e));o&&(Blob.prototype[o]||(Blob.prototype[o]="Blob"),"File"in e&&!File.prototype[o]&&(File.prototype[o]="File"));try{new File([],"")}catch(p){e.File=function(e,t,s){const i=new Blob(e,s),r=s&&void 0!==s.lastModified?new Date(s.lastModified):new Date;return Object.defineProperties(i,{name:{value:t},lastModifiedDate:{value:r},lastModified:{value:Number(r)},toString:{value:()=>"[object File]"}}),o&&Object.defineProperty(i,o,{value:"File"}),i}}function l([e,t]){return e instanceof Blob&&(e=new File([e],t,{type:e.type,lastModified:e.lastModified})),e}function c(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");return[String(e)]}function d(e,t,s){if(arguments.length<2)throw new TypeError(`2 arguments required, but only ${arguments.length} present.`);return t instanceof Blob?[String(e),t,void 0!==s?String(s):"string"==typeof t.name?t.name:"Blob"]:[String(e),String(t)]}class u{constructor(e){if(r.set(this,Object.create(null)),!e)return this;for(let t of a(e.elements))if(t.name&&!t.disabled)if("file"===t.type)for(let e of t.files)this.append(t.name,e);else if("select-multiple"===t.type||"select-one"===t.type)for(let e of a(t.options))e.selected&&this.append(t.name,e.value);else"checkbox"===t.type||"radio"===t.type?t.checked&&this.append(t.name,t.value):this.append(t.name,t.value)}append(e,t,s){const i=n(this);i[e]||(i[e]=[]),i[e].push([t,s])}delete(e){delete n(this)[e]}*entries(){const e=n(this);for(let t in e)for(let s of e[t])yield[t,l(s)]}forEach(e,t){for(let[s,i]of this)e.call(t,i,s,this)}get(e){const t=n(this);return t[e]?l(t[e][0]):null}getAll(e){return(n(this)[e]||[]).map(l)}has(e){return e in n(this)}*keys(){for(let[e]of this)yield e}set(e,t,s){n(this)[e]=[[t,s]]}*values(){for(let[e,t]of this)yield t}_asNative(){const e=new t;for(let[t,s]of this)e.append(t,s);return e}_blob(){const e="----formdata-polyfill-"+Math.random(),t=[];for(let[s,i]of this)t.push(`--${e}\r\n`),i instanceof Blob?t.push(`Content-Disposition: form-data; name="${s}"; filename="${i.name}"\r\n`,`Content-Type: ${i.type||"application/octet-stream"}\r\n\r\n`,i,"\r\n"):t.push(`Content-Disposition: form-data; name="${s}"\r\n\r\n${i}\r\n`);return t.push(`--${e}--`),new Blob(t,{type:"multipart/form-data; boundary="+e})}[Symbol.iterator](){return this.entries()}toString(){return"[object FormData]"}}o&&(u.prototype[o]="FormData");if([["append",d],["delete",c],["get",c],["getAll",c],["has",c],["set",d]].forEach((e=>{const t=u.prototype[e[0]];u.prototype[e[0]]=function(){return t.apply(this,e[1].apply(this,a(arguments)))}})),s&&(XMLHttpRequest.prototype.send=function(e){if(e instanceof u){const t=e._blob();this.setRequestHeader("Content-Type",t.type),s.call(this,t)}else s.call(this,e)}),i){const t=e.fetch;e.fetch=function(e,s){return s&&s.body&&s.body instanceof u&&(s.body=s.body._blob()),t(e,s)}}e.FormData=u}();s(41637);var n=s(57215),a=s(97099),l=s(49463),c=s(12950),d=s(47442);function u(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class p{constructor(e,t){u(this,"timerId",0),this.storyId=e,this.alertEl=t,this.sessionKey="incomplete_check_"+e}startChecking(){this.stopChecking(),this.timerId=window.setTimeout((()=>{this.checkCompletion()}),5e3)}stopChecking(){this.timerId>0&&clearTimeout(this.timerId)}async checkCompletion(){this.stopChecking();let e=this.getStatusFromSessionStorage();if(null===e){var t;const{data:s}=await c.cf.get(`/ajax.php?route=story/check-completion&story_id=${this.storyId}`);e=!(null===(t=s.is_incomplete)||void 0===t||t),this.setStatusToSessionStorage(e)}e?(this.alertEl.remove(),new d.O({content:"Ваш пост полностью подготовлен и теперь он виден всем пользователям"}).show()):this.startChecking()}setStatusToSessionStorage(e){window.sessionStorage.setItem(this.sessionKey,`${e?1:0},${Date.now()}`)}getStatusFromSessionStorage(){const e=(window.sessionStorage.getItem(this.sessionKey)||"").match(/^([01]),(\d+)$/);return e?"1"===e[1]||!(parseInt(e[2],10)>=Date.now()-5e3)&&null:null}}var h=s(47069),_=s(91904),m=s(85679),g=(s(10850),s(10553)),v=s(87864),f=s(12182),y=s(57852),b=s(8233),w=s(90312),k=s(43241),S=s(58330),O=s(68505);class E extends k.u{constructor(e){super(e),this.initObserver()}initObserver(){if(!this.el)return;const e=(0,O.m)(this.el,(t=>{t.isIntersecting&&(e(),this.initFeed())}),{rootMargin:"500px 0px"})}initFeed(){if(!this.el)return;if(!i.core.isUserAuthorized&&!this._options.story.isBlogStory)return void this.initInfinityFeed();const e=new(S.S.getInstance().get("StoriesFeed"))({el:this.el,feedName:"related",requestUrl:"/ajax.php?route=get-story-under-comments&story_id="+this._options.story.id,isAjaxLoadMode:!0});new(S.S.getInstance().get("StoriesSocialFeature"))(e);this.listenTo(e,"loaded",(e=>{this.updateMessage(e.stories.length),this.showRelatedTags(e.related_tags),this.showAdsWidget()}))}showRelatedTags(e){if(!this.el)return;const t=this.el.querySelector(".related-stories-feed__tags");if(!t)return;if(0===e.length)return void t.remove();const s=t.querySelector(".tags");s&&(s.innerHTML=e.map((e=>`<a href="/tag/${encodeURIComponent(e)}/hot" class="tags__tag">${e}</a>`)).join(""))}updateMessage(e){if(!this.el||e>0)return;const t=this.el.querySelector(".stories-feed__message-title");t&&(t.innerText="Похожие посты не найдены. Возможно, вас заинтересуют другие посты по тегам:")}showAdsWidget(){if(!this.el)return;const e=this.el.querySelector(".related-stories-feed__ads-widget");e&&(e.style.display="block")}initInfinityFeed(){if(!this.el)return;new(S.S.getInstance().get("StoriesFeed"))({el:this.el,feedName:"related",requestUrl:"/ajax.php?route=related-stories&story_id="+this._options.story.id});const e=(0,O.m)(this.el,(t=>{t.isIntersecting&&(e(),w.c.getInstance().sendEvent("reach_element",{type:"post_feed"}))}),{threshold:[0,1]})}}function C(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function x(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?C(Object(s),!0).forEach((function(t){T(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):C(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function T(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class I extends a.T3{initViewTimeRecorder(){let e={};document.querySelectorAll("article[data-story-id]").forEach((t=>{const s=`story-${t.dataset.storyId}`;e[s]||(e[s]=[]),e[s].push(t)})),l.Z.getInstance().addItems(e)}_initIncompleteStatusChecker(){const e=this.el.querySelector('.section_warning[data-role="incomplete-warning"]');e&&new p(this._storyId,e).startChecking()}render(){if(this.isRendered)return this;const e=this._feed.stories.items[0];!e||e.isAdStory||e.isBlogStory||new h.O;const t=_.V.getUserExperimentGroup(_.t.BROWSING_PAGE_V2);return"B"!==t&&"C"!==t||this._initBrowsingBlock(),this.$el.find(".comstories-section a").on("click auxclick",(t=>{0!==t.button&&1!==t.button||w.c.getInstance().sendEvent("transition_to_post_answers",x(x({},e.analyticsData),{},{type:"under_post",size:t.currentTarget.dataset.count}))})),this.$el.find(".adv-banner__link").on("click auxclick",(()=>{w.c.getInstance().sendEvent("click_post_link",x(x({},this.analyticsData),{},{type:"post_header"}))})),this._initCommentsNsfwOverlay(),this._initCommunityRulesCollapseButton(),this._initUnderCommentsAd(),this._initRelatedStories(),super.render()}async _initBrowsingBlock(){if(i.core.isUserAuthorized||i.core.userFirstVisitDate<(new Date).getTime()-m.mf)return;const e=document.getElementById("similar-stories")||this.$els.relatedTitle.get(0),t=this.$els.commentsContainer.get(0);if(!e&&!t)return;const{createApp:o}=await s(94450),r=document.createElement("div");e?e.insertAdjacentElement("beforebegin",r):t&&t.insertAdjacentElement("afterend",r),await o().mount(r)}_initCommentsNsfwOverlay(){const e=this.$els.commentsContainer.get(0);if(null==e||!e.dataset.nsfwOverlay)return;const t=this._feed.stories.items[0],s=e.querySelector(".story-comments__nsfw-overlay");if(!s)return;const o=()=>{s.remove(),delete e.dataset.nsfwOverlay};i.core.ui.on("remove-story-nsfw-overlay",(e=>{e===t.id&&o()})),i.core.initParams.userID&&s.addEventListener("click",(async()=>{var e,s;await(null===(e=t.adultOverlay)||void 0===e?void 0:e.getNsfwResult())&&(o(),null===(s=t.adultOverlay)||void 0===s||s.removeOverlay())}))}_initCommunityRulesCollapseButton(){const e=this.$(".community-comments__rules-body").get(0);if(null==e||!e.firstElementChild)return;const t="community-comments__rules-body_collapsed",s="community-comments__rules-body_expanded";if(e.firstElementChild.scrollHeight>e.offsetHeight){e.classList.add(t);const i=(0,v.m)(`<button class="community-comments__rules-expand">\n\t\t\t\t\tПодробнее ${(0,g.t)("ui__ic_arrow_down_small","community")}\n\t\t\t\t</button>`);e.insertAdjacentElement("afterend",i),i.addEventListener("click",(()=>{e.classList.remove(t),e.classList.add(s),i.remove()}))}else e.classList.add(s)}_initUnderCommentsAd(){const e=this.$(".page-story__under-comments").get(0);e&&(f.Q.instance.watch(e,y.L.UNDER_COMMENTS),this.listenTo(i.core.ui,"show-more-comments-click",(()=>{setTimeout((()=>{e.style.minHeight=`${e.offsetHeight}px`,f.Q.instance.reload(e)}))})))}async _initRelatedStories(){await(0,b.y)();const e=document.querySelector(".related-stories-feed");e&&new E({el:e,story:this._feed.stories.items[0]})}}var P=s(77289);s(15306),s(27207),s(48702),s(85827);const A=s(19755);class D{constructor(e){this.$page=e||A(".page-story__story .story").first(),this.storyLink=this._getStoryLink(),0!==this.storyLink.length&&(this.$classes={box:"smm-copy-tool",msg:"smm-copy-tool__message"},this._render())}_getStoryLink(){let e=this.$page.data("story-id");return e>0?"pikabu.ru/story/_"+e:""}_render(){const e=this.$page.find(".story__main").first();this.$els={story:e,app:A(".app").first(),title:e.find(".story__title-link"),author:e.find(".story__header a.user__nick"),tags:e.find(".story__tags a.tags__tag"),blocks:e.find(".story-block")},this.$els.author.length||(this.$els.author=e.find(".story__user-info")),this.imageCount=0,this._showedMsg=!1,setTimeout((()=>{this._parseTags(),this._parseBlocks(),this._renderButton()}),2e3)}_renderButton(){var e,t;this.$els.box=A((e={$classes:this.$classes,imageCount:this.imageCount},""+'<div class="'+(null==(t=e.$classes.box)?"":t)+'">\n\t<div class="'+(null==(t=e.$classes.box)?"":t)+'__button-set">\n\t\t<div class="'+(null==(t=e.$classes.box)?"":t)+"__button "+(null==(t=e.$classes.box)?"":t)+'__action" data-type="simple" title="Копировать пост (img: '+(null==(t=e.imageCount)?"":t)+')">\n\t\t\t<div class="'+(null==(t=e.$classes.box)?"":t)+'__button-icon fa fa-clipboard"></div>\n\t\t\t<span>&nbsp;'+(null==(t=e.imageCount)?"":t)+'</span>\n\t\t</div>\n\t\t<div class="'+(null==(t=e.$classes.box)?"":t)+"__button "+(null==(t=e.$classes.box)?"":t)+'__action" data-type="links-only" title="Копировать только ссылку и автора">\n\t\t\t<i class="fa fa-link '+(null==(t=e.$classes.box)?"":t)+'__button-icon" aria-hidden="true"></i>\n\t\t</div>\n\t\t<div class="'+(null==(t=e.$classes.box)?"":t)+"__button "+(null==(t=e.$classes.box)?"":t)+'__sublist-box">\n\t\t\t<i class="'+(null==(t=e.$classes.box)?"":t)+'__button-icon" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__extra"><use xlink:href="#icon--ui__extra"></use></svg></i>\n\t\t\t<ul class="'+(null==(t=e.$classes.box)?"":t)+'__sublist">\n\t\t\t\t<li class="'+(null==(t=e.$classes.box)?"":t)+'__action" data-type="simple" data-type-override="post" title="Копировать как обычный пост">\n\t\t\t\t\t<i class="fa fa-clipboard" aria-hidden="true"></i>\n\t\t\t\t\t<span>Пост</span>\n\t\t\t\t</li>\n\t\t\t\t<li class="'+(null==(t=e.$classes.box)?"":t)+'__action" data-type="simple" data-type-override="longpost" title="Копировать как длиннопост">\n\t\t\t\t\t<i class="fa fa-clipboard" aria-hidden="true"></i>\n\t\t\t\t\t<span>Длиннопост</span>\n\t\t\t\t</li>\n\t\t\t\t<li class="'+(null==(t=e.$classes.box)?"":t)+'__action" data-type="links-only" data-type-override="post" title="Копировать ссылку и автора как обычный пост">\n\t\t\t\t\t<i class="fa fa-link" aria-hidden="true"></i>\n\t\t\t\t\t<span>Пост (ссылка)</span>\n\t\t\t\t</li>\n\t\t\t\t<li class="'+(null==(t=e.$classes.box)?"":t)+'__action" data-type="links-only" data-type-override="longpost" title="Копировать ссылку и автора как длиннопост">\n\t\t\t\t\t<i class="fa fa-link" aria-hidden="true"></i>\n\t\t\t\t\t<span>Длиннопост (ссылка)</span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n\t<div class="'+(null==(t=e.$classes.msg)?"":t)+'">Скопировано в буфер обмена 👍</div>\n</div>')),this.$els.box.on("click",`.${this.$classes.box}__action`,(e=>{let t=A(e.currentTarget);this._copyToClipboard(t.data("type"),t.data("type-override"))})),this.$els.msg=this.$els.box.find(`.${this.$classes.msg}`),this.$els.app.append(this.$els.box)}_parseTags(){this.tags=Array.from(this.$els.tags).map((e=>e.innerText)).filter((e=>e.length>0)),this.isMine=!1,this.longPost=!1;for(let e=0;e<this.tags.length;e++){let t=this.tags[e].toLowerCase();this.isMine||(this.isMine=t.indexOf("моё")>-1),this.longPost||(this.longPost="длиннопост"===t)}}_parseBlocks(){this.blocks=[],this.$els.blocks.each(((e,t)=>{t.classList.contains("story-block_type_text")?this.blocks.push(this._parseText(t)):t.classList.contains("story-block_type_image")?(this.imageCount++,this.blocks.push(this._parseImage(t))):t.classList.contains("story-block_type_video")&&this.blocks.push(this._parseVideo(t))}))}_parseText(e){let t="",s=e.querySelectorAll("a");return s.length>0&&this._fixLinks(s),t=this._parseParagraph(e),{type:"text",data:t.trim()+"\n"}}_parseParagraph(e,t={}){let s=Array.from(e.childNodes),i="",o=0;return s.forEach((e=>{if("#text"===e.nodeName.toLowerCase())i+=e.data.replaceAll(/\s?\n\s?/g," ");else if("#comment"===e.nodeName.toLowerCase())i+=" ";else if("p"===e.nodeName.toLowerCase()||"blockquote"===e.nodeName.toLowerCase())i+=this._parseParagraph(e).trim()+"\n";else if("ol"===e.nodeName.toLowerCase()||"ul"===e.nodeName.toLowerCase())i+=this._parseParagraph(e,t).trimEnd()+"\n";else if("li"===e.nodeName.toLowerCase()){var s;o++;const n=null!==(s=t.depth)&&void 0!==s?s:0,a="".padStart(2*n," ");if("ol"===e.parentElement.nodeName.toLowerCase()){var r;const s=(null!==(r=t.prefix)&&void 0!==r?r:"")+o+".";i+=a+s+" "+this._parseParagraph(e,{depth:n+1,prefix:s}).trimEnd()+"\n"}else i+=a+"- "+this._parseParagraph(e,{depth:n+1}).trimEnd()+"\n"}else e.tagName&&["a","b","i","strong","span"].indexOf(e.tagName.toLowerCase()),i+=e.textContent,e.children&&e.children.length>0?void 0!==e.children[e.children.length-1]&&"br"===e.children[e.children.length-1].tagName.toLowerCase()&&(i+="\n"):"br"===e.tagName.toLowerCase()&&(i+="\n")})),i}_parseImage(e){let t=e.querySelector(".player"),s={type:"",data:""};var i;null!==t?(s.type="image-gif",s.data=t.getAttribute("data-source")):(s.type="image",s.data=e.querySelector("img").src,s.title=null===(i=e.querySelector(".story-block__title"))||void 0===i?void 0:i.innerText);return s}_parseVideo(e){let t=e.querySelector(".player");if(!t)return!1;let s=t.getAttribute("data-type"),i={type:s,data:""};if("video"===s)i.data=this._getVideoUrl(t);else if("video-file"===s){const e=t.getAttribute("data-source");i.data=e+("true"===t.dataset.webm?".webm":"mp4")}return i}_fixLinks(e){e.forEach((e=>{e.href!==e.innerText&&e.href.substring(0,16)===e.innerText.substring(0,16)&&(e.innerText=e.href)}))}_getVideoUrl(e){let t=e.getAttribute("data-source");return-1!==t.indexOf("youtube.com/")?"https://www.youtube.com/watch?v="+t.split("/embed/")[1]:-1!==t.indexOf("vimeo.com/")?"https://vimeo.com/"+t.split("/video/")[1]:-1!==t.indexOf("rutube.ru/")?t.split("/embed/").join("/"):""}_getFormattedPost(e,t){let s="",i="longpost"===t||this.longPost,o="post"===t;if("simple"===e){s+=this._getMainMedia(),s+=this.$els.title.text()+"\n";let e=this.blocks.filter((e=>"text"===e.type||"image"===e.type)).reduce(((e,t)=>(e.push("image"===t.type?t.title:t.data),e)),[]).join("\n\n");s+=e.length?"\n"+e:""}if(s+=s.length>0?"\n\n":"",this.isMine&&!o&&i)s+="Длиннопост от "+this.$els.author.text().trim()+": "+this.storyLink+"\n";else if(!o&&i)s+="Длиннопост: "+this.storyLink+"\n";else if(this.isMine){s+=`Автор на Пикабу: ${this.$els.author.text().trim()}\n`,s+="Комментарии: "+this.storyLink+"\n"}else s+="Комментарии: "+this.storyLink+"\n";return s=s.replaceAll(/\n{3,}/g,"\n\n"),s}_getMainMedia(){let e=this.blocks.filter((e=>e.type.indexOf("video")>-1));return 0===e.length?"":1===e.length?e[0].data+"\n":e.reduce(((e,t)=>(e.push(t.data),e)),[]).join("\n")+"\n"}_copyToClipboard(e,t){let s=this._getFormattedPost(e,t);const i=document.createElement("textarea");i.value=s,i.setAttribute("readonly",""),i.style.position="absolute",i.style.left="-9999px",this.$els.box[0].appendChild(i),i.select(),document.execCommand("copy"),this.$els.box[0].removeChild(i),this._showMessage()}_showMessage(){this._showedMsg||(this._showedMsg=!0,this.$els.msg.addClass(`${this.$classes.msg}_active`),setTimeout((()=>{this.$els.msg.removeClass(`${this.$classes.msg}_active`),this._showedMsg=!1}),3e3))}}var M=s(43148),R=s(20446),N=s(33727),B=s(19755),L=s.n(B),j=s(33877),$=s(23627),U=s(47994);function F(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function V(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?F(Object(s),!0).forEach((function(t){H(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):F(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function H(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class Z extends $.z{constructor(e){super(V(V({},e),{},{mode:U.lL.STORY_AUTHOR}))}render(){return this.isRendered||(super.render(),this.$el&&this.$el.is(":hidden")?(this.$el.show(),this.loadComments().then(this.showEmptyMessage.bind(this)).catch((e=>i.core.logger.error("all-comments",e)))):(this.initComments(),this.showEmptyMessage())),this}async loadComments(){if(!this.$el)return;const e=i.core.ui.player.createAnimation("comments-spinner",{$parent:L()('<div class="comments__spinner"></div>').appendTo(this.$el)}),t=Date.now();e.play();const{response:s,data:o}=await c.cf.post("/ajax/comments_actions.php",{action:"get_story_author_comments",story_id:this._options.storyId});if(await(0,j.g)(500-(Date.now()-t)),e.stop(),e.$parent.remove(),e.destroy(),!s.result)return void i.core.ui.toasts.showError(s.message);const r=this.$el;if(r){o.comments.forEach((e=>r.append(e.html)))}this.initComments()}showEmptyMessage(){this.$el&&!this.$el.find(".comments").length&&this.$el.append(`\n\t\t\t<div class="story-comments__empty-message">\n\t\t\t\t${(0,g.t)("comments__empty")}\n\t\t\t\t<div>Автор не оставил комментариев в своем посте</div>\n\t\t\t</div>\n\t\t`)}}function z(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function q(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?z(Object(s),!0).forEach((function(t){W(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):z(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function W(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class G extends $.z{constructor(e){super(q(q({},e),{},{mode:U.lL.HIDDEN}))}render(){return this.isRendered||(super.render(),this.$el&&this.$el.is(":hidden")?(this.$el.show(),this.loadComments().then(this.showEmptyMessage.bind(this)).catch((e=>i.core.logger.error("all-comments",e)))):(this.initComments(),this.showEmptyMessage())),this}async loadComments(){if(!this.$el)return;const e=i.core.ui.player.createAnimation("comments-spinner",{$parent:L()('<div class="comments__spinner"></div>').appendTo(this.$el)}),t=Date.now();e.play();const{response:s,data:o}=await c.cf.post("/ajax/comments_actions.php",{action:"get_story_hidden_comments",story_id:this._options.storyId});if(await(0,j.g)(500-(Date.now()-t)),e.stop(),e.$parent.remove(),e.destroy(),!s.result)return void i.core.ui.toasts.showError(s.message);const r=this.$el;if(r){o.comments.forEach((e=>r.append(e.html)))}this.initComments()}showEmptyMessage(){this.$el&&!this.$el.find(".comments").length&&this.$el.append(`\n\t\t\t<div class="story-comments__empty-message">\n\t\t\t\t${(0,g.t)("comments__empty")}\n\t\t\t\t<div>Скрытых комментариев нет</div>\n\t\t\t</div>\n\t\t`)}}var Y=s(29086),K=s(72426),X=s(55837),J=s(69483),Q=s(26639),ee=s(34524),te=s(45990);function se(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class ie extends Y.t{constructor(...e){super(...e),se(this,"isDetected",!1)}render(){return this.isRendered||(super.render(),K.X.getInstance().init(this.comments),X.F.getInstance().init(),te.L.getInstance().init(this.comments),this.initComments(),this.detectNeedScrolling()),this}async detectNeedScrolling(){const e=(0,J.z)();if(!e||this.isDetected||"#comments"===window.location.hash)return;if(this.isDetected=!0,history.scrollRestoration="auto",!this.comments.has(e))return;history.scrollRestoration="manual";const t=this.comments.get(e);if(!t)return;t.open(),await(0,j.g)(500);for(let s=0;s<3;s++){await t.scrollTo(),await(0,Q.W)(),t.highlight("green",!0),await(0,j.g)(500);if(i.core.ui.elementInViewport(t.$body,0)){this.detectNeedOpenReplyEditor(t);break}}}async detectNeedOpenReplyEditor(e){"1"===ee.x.get(Y.t.REPLY_FORM_OPEN)&&(ee.x.remove(Y.t.REPLY_FORM_OPEN),await(0,b.y)(),e.replyEditor.show("create"))}}var oe=s(88358);class re{static async getTopStory(e){const t={action:"get_top_story",current_story_id:e},{response:s,data:i}=await c.cf.post("/ajax/stories_actions.php",t);return s.result?i.story:{id:null,html:""}}}var ne=s(81780);s(36005);class ae extends k.u{constructor(e){super(e),this.init()}init(){if(!(this._options.debugParam||i.core.initParams.showTopHotStory&&this._options.popupTarget&&this._options.observerTarget))return;const e=new IntersectionObserver((t=>{t.forEach((t=>{t.isIntersecting&&(e.unobserve(t.target),this.showPopup())}))}));this._options.observerTarget&&e.observe(this._options.observerTarget)}async showPopup(){if(this._popup)return!0;let e;{const t=await re.getTopStory(this._options.storyId);if(!t)return!1;e=t.html}this._popup=new oe._({target:this._options.popupTarget,direction:oe.Lh.TOP,bottomPosition:"16px",hideByScroll:!1,autoCorrectPosition:!1,autoCloseOutsideClick:!1,showArrow:!1,wrapperExtraClass:"popup_allow-overflow",zIndex:7e3,content:e}),this._popup.$els.content.on("click",(()=>{w.c.getInstance().sendEvent("click",this.getAnalyticParams())})),this._popup.$els.content.find(".top-story-popup__close").on("click",(e=>{e.preventDefault(),e.stopPropagation(),this._popup.destroy()})),this.listenTo(this._popup,ne.e.UNMOUNTED,(()=>{w.c.getInstance().sendEvent("banner_closed",this.getAnalyticParams()),document.body.classList.remove("bottom-button-shown")})),this._popup.show(),w.c.getInstance().sendEvent("banner_showed",this.getAnalyticParams()),document.body.classList.add("bottom-button-shown");const t=document.querySelector("footer.footer");if(t){new IntersectionObserver((e=>{e.forEach((e=>{var t,s;e.isIntersecting?null===(t=this._popup)||void 0===t||t.hide():null===(s=this._popup)||void 0===s||s.show()}))})).observe(t)}return!0}async getSpecialsBannerData(){const e={route:"promo-button/get-folder"};this._options.debugParam&&(e.debug_promo_buttons=this._options.debugParam);const{data:t}=await c.cf.getOrFail("/ajax.php",e);return t}getAnalyticParams(){return{type:"top_hot_click"}}}var le=s(92948),ce=s(83257);const de=s(19755);class ue extends I{async route(e,t){this.ctx=e;let s=e.params.type;return this.isRendered||(this.show(),this.$els.commentsSlice.length&&(s="slice")),setTimeout((()=>this._setCommentsView(s))),t()}render(){return this.isRendered||(this.$el=de(".page-story"),this.$els={story:this.$(".page-story__story").eq(0),menu:this.$(".menu"),similarGroup:this.$('.section-group[data-role="similar-group"]'),similarStories:this.$('section[data-role="similar-stories"]'),similarTitle:this.$('.section_header[data-role="similar-title"]').on("click",this._onClickCompare.bind(this)),relatedStories:de(".related-stories-feed"),relatedTitle:de('[data-role="related-title"]'),tags:this.$(".story__tags"),commentsContainer:this.$(".story-comments"),commentsAll:this.$(".story-comments__all"),commentsAuthor:this.$(".story-comments__author"),commentsHidden:this.$(".story-comments__hidden"),commentsSlice:this.$(".story-comments__slice"),authorIgnoreWarning:this.$(".page-story__author-ignore-warning"),adBlockWarning:this.$('section[data-role="adb-warning"]'),adDisclaimer:this.$(".story__sponsor_disclaimer"),commentsNavigator:this.$(".comments-navigator"),promoButton:this.$(".promo-button")},this._storyId=this.$el.data("story-id"),this._minPageHeightForSharings=245,this._similarStories=void 0,this._menu=new M.J(this.$els.menu),this._menu.setLoading(!0),i.core.ui.screen=R.dt.POST,this._handleTransitionFromAdvertStory(),this._initStoryFeed(),this._initSmmTool(),this._initIncompleteStatusChecker(),this.$els.commentsAll.length&&new ae({storyId:this._storyId,popupTarget:this.el,observerTarget:this.$els.relatedStories.get(0)}),this.$els.adBlockWarning.length&&this._checkAd(),i.core.ui.screen=R.dt.POST,this.$el.find(".community-comments__header-left-group a").on("click auxclick",(e=>{0!==e.button&&1!==e.button||w.c.getInstance().sendEvent("transition_to_community",{type:"from_under_post",community_id:(0,le.$)(e.currentTarget)})})),super.render(),this._menu.setLoading(!1),this.initViewTimeRecorder(),this.$els.promoButton.length&&f.Q.instance.watch(this.$els.promoButton,y.L.UNDER_POST),f.Q.instance.watch(de(".ads-under-post"),y.L.UNDER_POST),f.Q.instance.watch(de(".comments__adv"),y.L.COMMENTS),f.Q.instance.watch(de("#adfox_exzen_DV"),y.L.UNDER_RELATED_POSTS)),this}_setCommentsView(e){var t;let s;s="slice"===e?this.sliceComments:"author"===e?this.authorComments:"hidden"===e?this.hiddenComments:this.allComments;const i=this._commentsView;i&&i!==s&&i.hide(),this._commentsView=s,null===(t=s)||void 0===t||t.show()}_onClickCompare(){return this.$els.similarGroup.data("level")<1||(this._initCompare(),this.$els.similarGroup.toggleClass("section-group_collapse")),this}_initStoryFeed(){return this._feed=new n._D({$el:this.$els.story,feedName:"story"}),this}_initSmmTool(){this.$el.data("smmtool")&&new D(this.$el)}async _initCompare(){return this._similarStories||(this._similarStories=new P.Bi({$parent:this.$els.similarStories,type:P.VQ.STORY,storyId:this._storyId}),this._similarStories.show(),this.$(".compare__close").on("click",this._onClickCompare.bind(this))),this._similarStories}get allComments(){if(this._allComments)return this._allComments;if(!this.$els.commentsAll.length)return;const e=this._feed.stories.firstId(),t=this._feed.stories.get(e);return this._allComments=new N.UIAllComments({story:t,$el:this.$els.commentsAll})}get authorComments(){if(this._authorComments)return this._authorComments;const e=this._feed.stories.firstId(),t=this._feed.stories.get(e);return this._authorComments=new Z({story:t,storyId:this._storyId,$el:this.$els.commentsAuthor})}get hiddenComments(){if(this._hiddenComments)return this._hiddenComments;const e=this._feed.stories.firstId(),t=this._feed.stories.get(e);return this._hiddenComments=new G({story:t,storyId:this._storyId,$el:this.$els.commentsHidden})}get sliceComments(){if(this._sliceComments)return this._sliceComments;const e=this._feed.stories.firstId(),t=this._feed.stories.get(e);return this._sliceComments=new ie({story:t,storyId:this._storyId,$el:this.$els.commentsSlice})}async _checkAd(){await(0,ce.Pf)()&&(this.$els.adBlockWarning.removeClass("section_hidden"),this.$els.adDisclaimer.addClass("hidden"))}_handleTransitionFromAdvertStory(){if("cpm"===i.core.history.searchParams.get("from")){const e=new URLSearchParams(i.core.history.location.search);e.delete("from");const t=e.toString(),s=i.core.history.location.pathname+(t?"?"+t:"");i.core.history.replaceUrl(s,!1,!1),i.core.storage.isTransitionFromAdvertStory=!0}}get feed(){return this._feed}}var pe=s(39549);s(52314),s(25432);i.core.use((function(e,t){if(!document.querySelector(".app__warning"))return t()})),i.core.ready.then((()=>{requestAnimationFrame((()=>{document.documentElement.style.setProperty("--animations-state","paused")}))})),i.core.use({"/":pe.h,"/hot/:subs(subs)?/:mode(time|actual)?":pe.h,"/old-hot/:mode(time|actual)?":pe.h,"/best/:subs(subs)?/:data(24h|week|month|all|[0-9--]{10}|[0-9-]{10}_[0-9-]{10})?":pe.h,"/new/:subs(subs)?/:sort(popular)?/:data([0-9--]{10})?":pe.h,"/true-new/:subs(subs)?/:sort(popular)?/:data([0-9--]{10})?":pe.h,"/subs":pe.h,"/subs/(user|community|tag|reply-stories)/:subscription":pe.h,"/subs/exclusive":pe.h,"/(new|best|hot)/feed/:feedName":pe.h,"/browse/([-a-z]+)":pe.h,"/chistomen/:sort(best)?":pe.h,"/experts":pe.h,"/reply-stories/:id(\\d+)":pe.h}),i.core.use("/story/:id/:type(author|hidden)?",ue),i.core.use("/slink/:id/:type(author|hidden)?",ue);s(2707),s(38559);var he=s(96637);function _e(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class me{static init(){this.write(),this.createFunctionForQA()}static getStorage(){var e;return null!==(e=he.LocalStorage.get(this.storageKey))&&void 0!==e?e:{w:{},r:{}}}static write(){const{userID:e,pageName:t}=i.core.initParams,s=0===e,o=["story","community"].includes(t);if(!s||!o)return;const r={story:()=>this.getCommunityId(".story .story__community-link"),community:()=>this.getCommunityId(".community-header")}[t]();r&&this.pushToStorage(r)}static createFunctionForQA(){window.__printVisitedCommunities=()=>{const{w:e,r:t}=this.getStorage(),s=e=>Object.entries(e).map((e=>{const[t,[s,i]]=e;return{"Community Id":t,Visits:s,"Last visit":new Date(i).toString()}}));console.log("Waiting Pool"),console.table(s(e)),console.log("Recommended Pool"),console.table(s(t))}}static getCommunityId(e){var t;const s=Number(null===(t=document.querySelector(e))||void 0===t?void 0:t.dataset.id);return!Number.isNaN(s)&&s>0?s:null}static pushToStorage(e){let{w:t,r:s}=this.getStorage();if(s[e]){const[t]=s[e];s[e]=[t+1,Date.now()]}else if(t[e]){const[i]=t[e];s[e]=[i+1,Date.now()],delete t[e],s=this.sliceByLimit(s)}else t[e]=[1,Date.now()],t=this.sliceByLimit(t);this.setStorage({w:t,r:s})}static sliceByLimit(e){const t=Object.entries(e);if(t.length<=this.maxCommunities)return e;const s=t.sort((([,[,e]],[,[,t]])=>t-e)).slice(0,this.maxCommunities);return Object.fromEntries(s)}static setStorage(e){he.LocalStorage.set(this.storageKey,e)}}_e(me,"storageKey","pkb_cvo"),_e(me,"maxCommunities",10);const ge=s(19755);try{let e=/^https?:\/\/(([sv](\d+)|[^.]+)\.)?pikabu\.(ru|lh)$/,t=()=>Array.prototype.slice.call(document.getElementsByTagName("iframe"));window.addEventListener("message",(function(s){let o=e.test(s.origin);if(o&&"getHeight"===s.data){let e=document.body,t=document.documentElement,i=Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight);s.source.postMessage(JSON.stringify({event:"setHeight",height:i}),s.origin)}else if(o||"https://specials-pikabu.ru"===s.origin){let e;try{e=JSON.parse(s.data)}catch(r){}if("object"!=typeof e||!e.hasOwnProperty("event"))return;switch(e.event){case"init":setTimeout((()=>{s.source.postMessage("getHeight","*"),s.source.document&&(s.source.document.body.style.backgroundColor=i.core.ui.css.colors.bg)}),100);break;case"setHeight":let o=t().find((e=>e.contentWindow===s.source));o&&(o.style.height=Number(e.height||0)+"px")}}})),t().forEach((e=>e.contentWindow.postMessage("getHeight","*"))),window.parent!==window&&window.parent.postMessage('{"event":"init"}',"*")}catch(ve){}i.core.ready.then((function(){ge.ajaxSetup({headers:{"X-Csrf-Token":i.core.initParams.csrfToken}}),i.core.ui=new o.j,i.core.ui.init(),requestAnimationFrame((()=>{i.core.history.init()})),me.init()})).catch((function(e){i.core.logger.error("application",e)})),window.__printClientProps=()=>{const e=new r.U;return{version:e.getVersion(),"cookie name":e.getCookieName(),encoded:e.getCookieValue(),boolean:e.getBoolFieldNames(),"int 8":e.getInt8FieldNames(),"int 16":e.getInt16FieldNames(),"int 32":e.getInt32FieldNames()}}},59297:(e,t,s)=>{"use strict";s.d(t,{$:()=>g});s(88674);var i=s(12953),o=s(88358),r=s(66422),n=s(85823),a=s(18910),l=s(3668),c=s(23703),d=(s(66992),s(33948),s(36005));var u=s(94620),p=s(63326),h=s(36005);var _=s(46126);const m=s(19755);class g extends r.D{constructor(){super()}showDeleteStoryDialog(e,t,s){this._createBox(e,_.y.DELETE_POST,t,s)}showDeleteStory404Dialog(e,t,s){this._createBox(e,_.y.DELETE_POST_404,t,s)}showDeleteCommentDialog(e,t,s){this._createBox(e,_.y.DELETE_COMMENT,t,s)}showBanUserDialog(e,t,s,i,o){const r=1===i?_.y.BAN_POST:_.y.BAN_COMMENT;this._createBox(e,r,t,s,o)}showHideBranchDialog(e,t,s){this._createBox(e,_.y.HIDE_COMMENT,t,s)}showRestoreBranchDialog(e,t,s){this._createBox(e,_.y.SHOW_COMMENT,t,s)}moveStoryToCommonFeed(e){let t={action:"move_to_common_feed",story_id:e,from_admoder:1},s=new o.LD({content:m((0,u.Z)(i.core.i18n("moderator-tools.modal-box.move-to-common.title")))});s.addCloseButtonIntoFooter(i.core.i18n("moderator-tools.modal-box.move-to-common.button-cancel")),s.addButtonIntoFooter(i.core.i18n("moderator-tools.modal-box.move-to-common.button-confirm"),(async()=>{r.c.moderatorAction(t).then((()=>{this.emit("complete")}),(e=>{i.core.ui.toasts.showError(e||i.core.i18n("moderator-tools.errors.request"))})),s.hide()}),a.jM.DANGER),s.show()}_createBox(e,t,s,o,n){this._lastTarget=m(e);const a=String(t)+"_"+String(s)+"_"+String(o);let l=r.D._lastBox;if(l&&l.isShown&&r.D._lastTargetKey===a)return this._lastTargetKey="",void l.hide();this._closeCurrentBox(),r.D._lastTargetKey=a,this._processed=!1;const c={current_ban:null,ban_count_info:null,ban_for_story:0,ban_for_comment:0,bans_count:0,deleted_comments_after_last_ban_end:0,deleted_stories_after_last_ban_end:0,message:""},d=[_.y.HIDE_COMMENT,_.y.SHOW_COMMENT].includes(t),u=[_.y.BAN_POST,_.y.BAN_COMMENT].includes(t);if(d){const s=()=>{this._processed=!0,this._closeCurrentBox(),this.emit("complete")};return l=this._createBalloonBox(t,s,c),r.D._lastBox=l,this.listenTo(r.D._lastBox,"hide",(()=>{r.D._lastBox=null,r.D._lastBox="",this._processed||this.emit("cancel")})),void(l.isShown||(l.target=e,l.show()))}if(this._reasons[t]&&!u)return;const p=void 0===this._reasons[t]?"Y":"N";r.c.getInfo(t,s,p,o,n).then((a=>{if(void 0!==a.reasons&&(this._reasons=a.reasons),void 0!==a.ban&&(c.current_ban=a.ban),void 0!==a.ban_count_info&&(c.ban_count_info=a.ban_count_info),void 0!==a.ban_for_story&&(c.ban_for_story=a.ban_for_story),void 0!==a.ban_for_comment&&(c.ban_for_comment=a.ban_for_comment),void 0!==a.bans_count&&(c.bans_count=a.bans_count),void 0!==a.deleted_comments_after_last_ban_end&&(c.deleted_comments_after_last_ban_end=a.deleted_comments_after_last_ban_end),void 0!==a.deleted_stories_after_last_ban_end&&(c.deleted_stories_after_last_ban_end=a.deleted_stories_after_last_ban_end),u&&null!==c.current_ban&&c.current_ban.status)return void this._showBanInfo(this._lastTarget,c.current_ban);if(u&&(c.ban_for_story||c.ban_for_comment)){if(1===c.ban_for_story)return void i.core.ui.toasts.showError(i.core.i18n("moderator-tools.errors.user-post-punished"));if(1===c.ban_for_comment)return void i.core.ui.toasts.showError(i.core.i18n("moderator-tools.errors.user-comment-punished"));2===c.ban_for_comment&&(c.message+=i.core.i18n("moderator-tools.errors.user-comment-forgiven"))}l=this._createBalloonBox(t,(e=>{this._doAction(t,s,o,e,n)}),c),r.D._lastBox=l,this.listenTo(r.D._lastBox,"hide",(()=>{r.D._lastBox=null,r.D._lastBox="",this._processed||this.emit("cancel")})),l.isShown||(l.target=e,l.show())}),(e=>{i.core.ui.toasts.showError(e||i.core.i18n("moderator-tools.errors.request"))}))}_createBalloonBox(e,t,s){let r,l,c=this._reasons[e.valueOf()],u={};switch(e){default:case _.y.DELETE_POST:u={title:i.core.i18n("moderator-tools.balloon-box.delete-post.title"),buttonName:i.core.i18n("moderator-tools.balloon-box.delete-post.button-name"),buttonName2:i.core.i18n("moderator-tools.balloon-box.delete-post.button-name2"),action:i.core.i18n("moderator-tools.balloon-box.delete-post.action")};break;case _.y.DELETE_POST_404:u={title:"Причина удаления поста до 404",buttonName:"Удалить до 404",buttonName2:"Удалить до 404",action:"удалить пост"};break;case _.y.DELETE_COMMENT:u={title:i.core.i18n("moderator-tools.balloon-box.delete-comment.title"),buttonName:i.core.i18n("moderator-tools.balloon-box.delete-comment.button-name"),buttonName2:i.core.i18n("moderator-tools.balloon-box.delete-comment.button-name2"),action:i.core.i18n("moderator-tools.balloon-box.delete-comment.action")};break;case _.y.BAN_POST:u={title:i.core.i18n("moderator-tools.balloon-box.ban-post.title"),buttonName:i.core.i18n("moderator-tools.balloon-box.ban-post.button-name"),buttonName2:i.core.i18n("moderator-tools.balloon-box.ban-post.button-name2"),action:i.core.i18n("moderator-tools.balloon-box.ban-post.action")};break;case _.y.BAN_COMMENT:u={title:i.core.i18n("moderator-tools.balloon-box.ban-comment.title"),buttonName:i.core.i18n("moderator-tools.balloon-box.ban-comment.button-name"),buttonName2:i.core.i18n("moderator-tools.balloon-box.ban-comment.button-name2"),action:i.core.i18n("moderator-tools.balloon-box.ban-comment.action")};break;case _.y.HIDE_COMMENT:u={title:i.core.i18n("moderator-tools.balloon-box.hide-comment-branch.title"),buttonName:i.core.i18n("moderator-tools.balloon-box.hide-comment-branch.button-name"),buttonName2:i.core.i18n("moderator-tools.balloon-box.hide-comment-branch.button-name2"),action:i.core.i18n("moderator-tools.balloon-box.hide-comment-branch.action")};break;case _.y.SHOW_COMMENT:u={title:i.core.i18n("moderator-tools.balloon-box.show-comment-branch.title"),buttonName:i.core.i18n("moderator-tools.balloon-box.show-comment-branch.button-name"),buttonName2:i.core.i18n("moderator-tools.balloon-box.show-comment-branch.button-name2"),action:i.core.i18n("moderator-tools.balloon-box.show-comment-branch.action")}}if(!c||m.isEmptyObject(c))l=m((p=u,g="",v=h.escape,g+'<form class="mt__box">\n\t<div class="mt__text">Вы действительно хотите '+v(p.action)+'?</div>\n\t<p>\n\t\t<button class="mt__btn button_danger" data-role="yes">Да, '+v(p.buttonName2)+'</button>\n\t\t\x3c!--<button class="button_danger" data-role="no">Отмена</button>--\x3e\n\t</p>\n</form>\n')),l.find("button").on("click",(e=>{e.preventDefault(),"yes"===m(e.target).data("role")?t("0"):r.hide()}));else{u.reasons=c,s.message&&(u.userBanMsg=s.message),s.ban_count_info&&(u.banCountInfo=s.ban_count_info),u.bansData=this._createBanInformation(s),l=m(function(e){var t,s="",i=d.escape;Array.prototype.join,s+='<form class="mt__box">\n\t<div class="mt__list">\n\t\t';var o=0;s+="\n\t\t";for(const[r,n]of Object.entries(e.reasons))s+='\n\t\t<p class="mt__list-item">\n\t\t\t<label>\n\t\t\t\t<input type="radio" '+(null==(t=0==o++?'checked="checked"':"")?"":t)+'    name="mt_reason" value="'+i(r)+'"> '+i(n.name)+"\n\t\t\t</label>\n\t\t</p>\n\t\t";return s+='\n\t</div>\n\t<button class="mt__btn button_danger" data-role="yes">'+i(e.buttonName)+"</button>\n\t",e.userBanMsg&&(s+='\n\t<div class="mt__msg">\n\t\t<i class="fa fa-warning"></i> test'+i(e.userBanMsg)+"\n\t</div>\n\t"),s+="\n\t",e.banCountInfo&&(s+='\n\t<div class="mt__ban-info">\n\t\t<a href="'+i(e.banCountInfo.pds_link)+'" target="_blank">История нарушений '+i(e.banCountInfo.count)+"</a>\n\t</div>\n\t"),s+="\n    ",e.bansData&&(s+='\n    <div class="mt__ban-info">'+(null==(t=e.bansData)?"":t)+"</div>\n    "),s+"\n</form>"}(u)),new n.x(l.closest("form"));let e=new a.y3(l.find("button"));this.listenTo(e,"click",(s=>{s.preventDefault(),e.progress=!0;let i=l.find("input:checked");if(i.length>0){let e=i.val();t(e)}}))}var p,g,v;return r=new o._({content:l})}editTags(e,t){if(!e||!t.length)return!1;let s=t.find('[data-role="edit-tags"]'),o=t.find('[data-role="save-tags"]'),n=new l.K1({$el:s,maxTags:8,minTags:2});n.suggestion=new c.Z6({tagsLine:!0});let d=n.value,u=new a.y3(o);return setTimeout((()=>{n.focus()}),400),this.listenTo(n,"change",(()=>{u.disabled=d===n.value})),this.listenTo(u,"click",(()=>{let t={action:"set_story_tags",tag:n.value,story_id:e};u.progress=!0,r.c.moderatorAction(t).then((()=>{this.emit("complete")}),(e=>{i.core.ui.toasts.showError(e||i.core.i18n("moderator-tools.errors.request")),u.progress=!1}))})),this._showTagsHistory(e,t),!0}_showTagsHistory(e,t){let s={action:"get_tags_history",story_id:e},o=t.find('[data-role="tags-history"]');r.c.moderatorAction(s).then((e=>{e.length&&(e.map((e=>{e.addedTags=[],e.removedTags=[],e.oldTags=[],e.tags_old=e.tags_old.split(", "),e.tags_new=e.tags_new.split(", "),e.tags_new.forEach((t=>{m.inArray(t,e.tags_old)>-1?e.oldTags.push(t):e.addedTags.push(t)})),e.tags_old.forEach((t=>{-1===m.inArray(t,e.tags_new)&&e.removedTags.push(t)}))})),o.append((0,p.Z)(e)))}),(e=>{i.core.ui.toasts.showError(e||i.core.i18n("moderator-tools.errors.request"))}))}}},39549:(e,t,s)=>{"use strict";s.d(t,{h:()=>q});s(2707),s(88674),s(66992),s(33948),s(41637),s(74916);var i=s(97099),o=s(12953),r=s(88358),n=s(65448),a=s(47069),l=s(70017),c=s(86445),d=s(82580),u=s(90312),p=s(77105),h=s(81780),_=s(10553),m=s(75130),g=(s(60285),s(43241)),v=s(31200),f=s(72044),y=s(41773),b=s(96883);class w extends g.u{constructor(e){if(super(e),!e.el||!e.feed)throw new Error;this.els={filterButton:e.el.querySelector(".feed-filter__mode"),themeChips:e.el.querySelector(".feed-filter__chips")},this.modes=o.default.config("modules.feed-filter-modes")||{},this.show()}render(){var e;return this.els.filterButton.addEventListener("click",(e=>{e.preventDefault(),this.selectModePopup||this.initModePopup(),this.selectModePopup.toggle()})),null===(e=this.els.themeChips)||void 0===e||e.addEventListener("click",(e=>{const t=e.target.closest(".feed-filter__chip");t&&this.els.themeChips.contains(t)&&this.onTopicClick(t)})),this.showTopicsTooltip(this.els.themeChips),super.render()}onTopicClick(e){let t=e.dataset.code;const s=this.els.themeChips.querySelector(".feed-filter__chip[data-active]");s&&delete s.dataset.active,s===e?t=void 0:e.dataset.active="1",b.d.send("transitionToTheme",{type:t}),this.updateFeedQuery("topic",t)}initModePopup(){if(this.selectModePopup)return;let e;{const t=`<div class="popup-menu">${Object.entries(this.modes).map((([e,t])=>`<p data-option="${e}" class="popup-menu__item">${t}</p>`)).join("")}</div>`;e=new r._({target:this.els.filterButton,alignment:r.SE.END,content:t,indent:!1})}const t=e.content.get(0);t.addEventListener("click",(s=>{const i=s.target.closest("p[data-option]");if(!i||!t.contains(i))return;const o=i.dataset.option;this.setFeedMode(o),e.hide()})),this.selectModePopup=e}setFeedMode(e){var t;this.updateFeedQuery("mode","all"!==e?e:void 0),this.els.filterButton.firstElementChild&&(this.els.filterButton.firstElementChild.textContent=this.modes[e]);b.d.send("filter",{type:null!==(t={"with-answer":"with_answer","no-answer":"without_answer"}[e])&&void 0!==t?t:e})}updateFeedQuery(e,t){const s=new URL(document.location.toString());t?(this._options.feed.searchParams.set(e,t),s.searchParams.set(e,t)):(s.searchParams.delete(e),this._options.feed.searchParams.delete(e)),o.default.history.replaceState(void 0,"",s),this._options.feed.clear(),this._options.feed.loadStories(!1)}async showTopicsTooltip(e){const t=y.j.HIDE_EXPERTS_TOPICS_TOOLTIP;if(y.E.has(t)||!e)return;const s=await(0,v.aM)({target:e.firstElementChild,title:"Популярные темы",text:"<p>Подборки интересных вопросов<br>и ответов по разным темам</p>",theme:f.xb.GREEN,direction:f.Lh.TOP,alignment:r.SE.CENTER,delay:500,hideByScroll:!1,showOnce:!0,btnConfig:{label:"Класс!",handler:()=>{s.hide(),y.E.set(t,!0)}}});this.listenTo(s,h.e.MOUNTED,(()=>{b.d.send("tipShow",{type:"theme"})})),this.listenTo(s,h.e.UNMOUNTED,(()=>{b.d.send("tipClose",{type:"theme"})}))}}var k=s(89536),S=(s(41817),s(22470)),O=s(42107);function E(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const C="menu__item_current";class x extends g.u{constructor(e){super(e),E(this,"_isCommentsActive",!1),E(this,"_disabled",!1),E(this,"els",{commentsMenuItem:null}),this.show()}render(){return this.el?(this.initMenuItems(),super.render()):this}reset(){return this.el?(this.resetActiveMenuItem(),this):this}resetActiveMenuItem(){var e,t;this.el&&(null===(e=this.el)||void 0===e||null===(t=e.querySelector("."+C))||void 0===t||t.classList.remove(C))}setActiveMenuItem(e){var t;this.isCommentsActive=e.classList.contains("subs-feed-menu__comments"),e.classList.add(C),O.cp.getInstance().sendEvent("transition_to_subs_tab",{type:this.isCommentsActive?"comments":"posts",is_mark:null!==(t=this.els.commentsMenuItem)&&void 0!==t&&t.classList.contains("subs-feed-menu__comments_new")?"1":"0"}),this.emit("change",this.isCommentsActive?"comments":"stories")}initMenuItems(){var e;this.el&&(this.els.commentsMenuItem=this.el.querySelector(".subs-feed-menu__comments"),this.els.commentsMenuItem&&((0,S.D8)(this.els.commentsMenuItem),o.core.initParams.subsCommentsCount>0&&this.toggleCommentsNewBadge(!0)),null===(e=this.$el)||void 0===e||e.on("click",".menu__item",(e=>{e.preventDefault(),e.target instanceof HTMLElement&&!e.target.classList.contains(C)&&!this.disabled&&(this.resetActiveMenuItem(),this.setActiveMenuItem(e.target))})))}toggleCommentsNewBadge(e){this.els.commentsMenuItem&&this.els.commentsMenuItem.classList.toggle("subs-feed-menu__comments_new",e)}set isCommentsActive(e){this._isCommentsActive=e}get isCommentsActive(){return this._isCommentsActive}set disabled(e){this._disabled=e}get disabled(){return this._disabled}}s(85827);var T=s(47994),I=s(48591),P=s(23627),A=s(68505),D=s(33877),M=s(65801),R=s(19755),N=s.n(R);function B(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class L extends g.u{static createElement(){const e=document.createElement("div");e.classList.add("subs-comments-feed"),e.style.display="none";const t=document.createElement("div");t.classList.add("subs-comments-feed__container","comments-feed","comments-part");const s=document.createElement("div");s.classList.add("subs-comments-feed__loader");const i=document.createElement("div");return i.classList.add("subs-comments-feed__empty"),o.core.isUserAuthorized||i.classList.add("subs-comments-feed__empty_visible"),i.innerHTML=`\n\t\t\t<img src="//cs.pikabu.ru/images/subs-empty.svg" alt="Мои подписки">\n\t\t\t<p>\n\t\t\t\tПодписывайтесь на интересные комментарии — и получайте обновления об ответах \n\t\t\t\tв разделе подписок. \n\t\t\t\t${o.core.isUserAuthorized?"":"<br>Чтобы добавить подписку, нужно авторизоваться."}\n\t\t\t</p>\n\t\t\t${o.core.isUserAuthorized?"":'<button class="pkb-normal-btn" data-role="subs-signin">Войти</button>'}\n\t\t`,e.append(t),e.append(s),e.append(i),e}constructor(e){super(e),B(this,"page",1),B(this,"_isLoading",!1),B(this,"commentsCount",0),B(this,"_endOfFeed",!1),B(this,"advertsEls",new Set),B(this,"els",{commentsContainer:null,loader:null,emptyComments:null}),this.init()}show(){if(!this.el)return this;return(()=>{1!==this.page||this.endOfFeed?this.showEl():this.isLoading||(this.showEl(),this.fetchComments())})(),this}hide(){return this.el?(this.el.style.display="none",this):this}async fetchComments(){if(this.el&&!this.isLoading&&o.core.isUserAuthorized){this.isLoading=!0;try{var e;const[{data:o,total:r}]=await Promise.all([(0,I.GG)({page:this.page}),(0,D.g)(500)]);var t,s;if(this.emit("pageLoaded"),0===o.length)return this.endOfFeed=!0,void(null===(t=this.els.emptyComments)||void 0===t||t.classList.add("subs-comments-feed__empty_visible"));if(this.commentsCount+=o.length,this.commentsCount>=r)this.endOfFeed=!0,null===(s=this.loaderIntersectionListener)||void 0===s||s.call(this);this.pagination||this.initPagination(Math.trunc(r/50)+1);const n=document.createElement("template");var i;if(n.innerHTML=this.getFeedHtml(o),null===(e=this.els.commentsContainer)||void 0===e||e.appendChild(n.content),this.initCommentsPart(),this._options.isPaginationMode)null===(i=this.els.commentsContainer)||void 0===i||i.scrollIntoView({block:"start",behavior:"smooth"});else this.page++}catch(r){o.core.ui.toasts.showError(r)}finally{this.isLoading=!1}}}getFeedHtml(e){return e.reduce(((e,t)=>e+=`\n\t\t\t\t<div class="subs-comments-feed__wrapper">\n\t\t\t\t\t${t}\n\t\t\t\t</div>\n\t\t\t`),"")}init(){this.el&&(this.els.commentsContainer=this.el.querySelector(".subs-comments-feed__container"),this.els.loader=this.el.querySelector(".subs-comments-feed__loader"),this.els.emptyComments=this.el.querySelector(".subs-comments-feed__empty"),this.els.loader&&(this._animation=o.core.ui.player.createAnimation("stories-search",{$parent:N()(this.els.loader)})),this.initLoader())}initCommentsPart(){this.els.commentsContainer&&(this.commentsParts||(this.commentsParts=new P.z({el:this.els.commentsContainer,mode:T.lL.SUBS_FEED}).show()),this.commentsParts.addComments())}initPagination(e){var t;this.pagination||1===e||(this.pagination=new M.S({endPage:e}),null===(t=this.el)||void 0===t||t.append(this.pagination.render().el),this.listenTo(this.pagination,"change",(e=>{this.page!==e&&this.els.commentsContainer&&(this.page=e,this.els.commentsContainer.innerHTML="",this.fetchComments())})))}initLoader(){this.els.loader&&(this.loaderIntersectionListener=(0,A.m)(this.els.loader,(({isIntersecting:e})=>{e&&1!==this.page&&this.fetchComments().catch((e=>{console.error(e)}))}),{rootMargin:"200px 0px"}))}showEl(){this.el&&(this.el.style.display="block")}set endOfFeed(e){this._endOfFeed=e,e&&this.emit("endOfFeed")}get endOfFeed(){return this._endOfFeed}set isLoading(e){var t,s;(this._isLoading=e,e)?(this._animation.play(),null===(t=this.pagination)||void 0===t||t.$el.hide()):(this._animation.stop(),null===(s=this.pagination)||void 0===s||s.$el.show())}get isLoading(){return this._isLoading}}var j=s(8233);class $ extends g.u{constructor(e){super(e),this.init()}init(){var e,t;if(!this._options.feed||!this._options.subsFeedMenuEl)return;this.menu=new x({el:this._options.subsFeedMenuEl});const s=this._options.feed.isPaginationMode,i=null===(e=o.core.ui.sidebar)||void 0===e||null===(t=e.el)||void 0===t?void 0:t.querySelector(".sidebar-filters"),r=L.createElement();this._options.feed.el.insertAdjacentElement("afterend",r),this.commentsFeed=new L({el:r,isPaginationMode:s}),this.listenTo(this.menu,"change",(()=>{var e,t,o;this.menu.isCommentsActive?(this._options.feed.hide(),this.commentsFeed.show(),this._options.feed.toggleFooter(s||this.commentsFeed.endOfFeed),null==i||i.setAttribute("hidden","hidden"),null===(t=this._options.$feedPanel)||void 0===t||t.hide()):(this._options.feed.show(),this.commentsFeed.hide(),this._options.feed.toggleFooter(s||this._options.feed.endOfFeed||0===this._options.feed.stories.size),null==i||i.removeAttribute("hidden"),null===(o=this._options.$feedPanel)||void 0===o||o.show());null===(e=this._options.subsFilterEl)||void 0===e||e.classList.toggle("subscriptions-filter_tabs-hidden",this.menu.isCommentsActive)})),this.listenTo(this.commentsFeed,"endOfFeed",(()=>{this.menu.isCommentsActive&&this._options.feed.toggleFooter(!0)})),this.listenToOnce(this.commentsFeed,"pageLoaded",(async()=>{this.menu.toggleCommentsNewBadge(!1),o.core.ui.removeMenuCounter("subs"),await(0,j.y)(),this._options.feed.socialButtons.updateShareButtons()}))}}const U=s(19755);class F extends i.T3{_initSortChistomen(){const e=U(".stories-search__feed-panel > a");if(!e.length)return;const t=new n.xs({FRESH:1,HOT:2}),s=t[o.core.config("modules.searchSort")]||t.FRESH;this.sortPopup=r.nk.popupEnum(e,t,"stories-search.sort-mode",s),e.on("click",(()=>{this.sortPopup.toggle()})),this.listenTo(this.sortPopup,"change",((e,s)=>{s===t.FRESH?window.location.href="/chistomen":s===t.HOT&&(window.location.href="/chistomen/best")}))}_initSignInButton(){o.core.isUserAuthorized||U('[data-role="subs-signin"]').on("click",(()=>{u.c.getInstance().sendEvent("click",{button:"authorization",component_name:"subs_feed_button"}),o.core.ui.authRequired({analyticsParams:{reason:"subs_feed_button"},formType:"signIn"})}))}render(){if(this.isRendered)return this;if("companies"!==this._feed.feedName&&new a.O,this.initNsfwWarning(),this._currentMode===d.DV.EXPERTS){this.initMakeQuestion();const e=new m.U;e.get("isExpertsPageOpened")||e.set("isExpertsPageOpened",!0)}return this._currentMode===d.DV.COMSTORIES&&(this._initNewComstoryBtn(),this._initSortComstories()),super.render()}async initNsfwWarning(){if("browse/nsfw"===o.core.initParams.pageName&&!l.e.get(c.QU)&&!o.core.initParams.isAdultVisible){const{createApp:e}=await s(84726);await e().mount(document.createElement("div"))}}_initFeedSwitcher(){var e;this._currentMode===d.DV.SUBS&&this.el&&new $({feed:this._feed,$feedPanel:"subs"===(null===(e=this.$els.feedPanel)||void 0===e?void 0:e.attr("data-mode"))?this.$els.feedPanel:void 0,subsFilterEl:document.querySelector(".subscriptions-filter"),subsFeedMenuEl:document.querySelector(".subs-feed-menu")})}_getModeFromPath(e){switch(!0){case 0===e.indexOf("/best"):return d.DV.BEST;case 0===e.indexOf("/new"):return d.DV.NEW;case 0===e.indexOf("/rec"):return d.DV.RECOMMEND;case 0===e.indexOf("/subs"):return d.DV.SUBS;case 0===e.indexOf("/visited-stories"):return d.DV.VISITED;case 0===e.indexOf("/companies"):return d.DV.COMPANIES;case 0===e.indexOf("/series"):return d.DV.SERIES;case 0===e.indexOf("/browse/image-stories"):return d.DV.BROWSING_IMAGES;case 0===e.indexOf("/browse/series-stories"):return d.DV.BROWSING_SERIES;case 0===e.indexOf("/browse/text-stories"):return d.DV.BROWSING_TEXT;case 0===e.indexOf("/browse/video-stories"):return d.DV.BROWSING_VIDEOS;case 0===e.indexOf("/browse/nsfw"):return d.DV.BROWSING_NSFW;case 0===e.indexOf("/browse/top-authors-stories"):return d.DV.BROWSING_UNIQUE;case 0===e.indexOf("/browse/original-stories"):return d.DV.BROWSING_MY;case 0===e.indexOf("/browse/reply-stories"):return d.DV.BROWSING_ANSWERS;case 0===e.indexOf("/browse/viral-stories"):return d.DV.BROWSING_VIRUS;case 0===e.indexOf("/browse/most-viewed-stories"):return d.DV.BROWSING_VIEWED;case 0===e.indexOf("/browse/anonymous"):return d.DV.BROWSING_ANONYMOUS;case 0===e.indexOf("/browse/short-stories"):return d.DV.BROWSING_SHORT;case 0===e.indexOf("/browse/long-stories"):return d.DV.BROWSING_DLINNOPOST;case 0===e.indexOf("/browse"):return d.DV.BROWSING;case 0===e.indexOf("/chistomen"):return d.DV.CHISTOMEN;case 0===e.indexOf("/experts"):return d.DV.EXPERTS;case 0===e.indexOf("/reply-stories"):return d.DV.COMSTORIES;default:return d.DV.HOT}}initMakeQuestion(){var e;null===(e=document.querySelector('form[data-role="make-question"]'))||void 0===e||e.addEventListener("click",(e=>{if(e.preventDefault(),!o.core.isUserAuthorized)return void o.core.ui.authRequired();const t=new r.LD({destroyAfterHide:!0,maxWidth:700,minWidth:700,autoClosePressEscape:!0,autoCloseOutsideClick:!0,header:"",content:`<div id="editor-wrapper">\n\t\t\t\t\t<div class="loader">${(0,_.t)("ui__progress-circle")}</div>\n\t\t\t\t</div>`,isFullSize:!1,wrapperExtraClass:"popup_allow-overflow popup_editor"});t.show(),o.core.config.load({modules:{"story-editor":{authorId:o.core.initParams.userID,isTopAuthor:!1,shouldShowAnonymousStoryFlag:!0,isDonationsFlagHidden:!0,isDonationsFlagDisabled:!0,shouldShowAdvertBlogsFlag:!1,isUpdatesOnlyAllowed:!1,story:{tags:p.TO.join(",")},type:"experts"}}}),t.$els.footer.show().css("padding",0),u.c.getInstance().sendEvent("experts_publish_post_popup_showed",{}),setTimeout((async()=>{var e;const{createApp:i}=await s(63416),o=await i(),r=o.mount(document.getElementById("editor-wrapper")),n=null===(e=document.querySelector('input[data-role="make-question-title"]'))||void 0===e?void 0:e.value;n&&r.setTitle(n),t.updatePosition(),t.listenTo(t,h.e.UNMOUNTED,(()=>{null==o||o.unmount(),u.c.getInstance().sendEvent("experts_publish_post_popup_closed",{})}))}),500)}))}_initExpertsFilter(){const e=document.querySelector(".feed-filter_experts");e&&new w({el:e,feed:this._feed})}_initNewComstoryBtn(){var e;null===(e=document.querySelector('[data-role="create-comstory"]'))||void 0===e||e.addEventListener("click",(e=>{u.c.getInstance().sendEvent("click_create_post",{type:"post_answers_feed"}),o.core.isUserAuthorized?(e.currentTarget.classList.add("pkb-normal-btn_loading"),k.c.create({id:Number(e.currentTarget.dataset.storyId)})):o.core.ui.authRequired()}))}_initSortComstories(){const e=U(".stories-search__feed-panel > a");if(!e.length)return;const t=new n.xs({DESC:"desc",ASC:"asc",BEST:"best"}),s=t[new URLSearchParams(window.location.search).get("sort")]||t.DESC;this.sortPopup=r.nk.popupEnum(e,t,{DESC:"Сначала свежие",ASC:"Сначала старые",BEST:"Сначала лучшие"},s),e.on("click",(()=>{this.sortPopup.toggle()})),this.listenTo(this.sortPopup,"change",((e,s)=>{let i="";s===t.ASC?i="?sort=asc":s===t.BEST&&(i="?sort=best"),window.location.href=window.location.pathname+i}))}_onClickMenuRouting(e){const t=e.target.getAttribute("href")||e.target.getAttribute("data-route");o.core.history.location.pathname===t&&(e.preventDefault(),e.stopPropagation(),this._feed.clear().loadStories(!1))}_getBaseUrl(){return"/"+this._currentMode.valueOf()}}var V=s(57215),H=s(20446),Z=s(5673);const z=s(19755);class q extends F{route(e,t){this._isSubsMode="/subs"===e.path||"subs"===e.params.subs,this._currentMode=this._getModeFromPath(e.path),this._isRecommendMode=this._currentMode===V.DV.RECOMMEND,this._customFeed=e.params.feedName,this._customFeed&&(u.c.getInstance().yandex.goal("theme_feed_opening",{theme_feed_opening_url:o.core.history.pathname}),o.core.ui.screen=H.dt.THEME_FEED);let s=H.dt[this._currentMode.toString()];return s||(this._currentMode===V.DV.COMMUNITIES?s=H.dt.COMMUNITIES_FEED:this._currentMode===V.DV.MOST_SAVED?s=H.dt.SAVED:(this._isSubsMode||e.path.startsWith("/subs/"))&&(s=H.dt.MY_LENT)),o.core.ui.screen=s,this.isRendered?(this._feed.viewObserver.forceSaveWhenGoing(),this._isRecommendMode||(this._filter.isSubsMode=this._isSubsMode,this._filter.customFeed=this._customFeed,this._filter.isDisableCalendar=Boolean(this._customFeed),this._filter.feedName=this._currentMode.valueOf()),f.Zv.reloadScripts()):this.show(),"thematic-feed"===e.pageName&&u.c.getInstance().yandex.goal("theme_feed_opening",{theme_feed_opening_url:e.path}),f.Zv.removeOldAds(),t()}destroy(){this.isDestroyed||(this._feed.destroy(),this._calendar.destroy(),super.destroy())}render(){return this.isRendered||(this.$el=z(".stories-feed"),this.$els={feedPanel:z(".feed-panel").on("click",".menu__item_route",this._onClickMenuRouting.bind(this)),feedPanelContainer:z(".feed-panel__container"),headerMenuItems:z(['.header-menu__item > a[href="/"]','.header-menu__item > a[href="/best"]','.header-menu__item > a[href="/new"]','.header-menu__item > a[href="/rec"]'].join(",")),feedNotify:z(".feed-notify")},this._initFeed(),this._initFeedFilterPanel(),this._initFeedSwitcher(),this._currentMode===V.DV.EXPERTS?this._initExpertsFilter():this._currentMode===V.DV.CHISTOMEN?this._initSortChistomen():this._currentMode===V.DV.SUBS&&this._initSignInButton(),this.$els.feedNotify.length&&new Z.h({$el:this.$els.feedNotify,feedType:this._currentMode}),super.render()),this}_initFeed(){this._feed=new V._D({$el:this.$el,feedName:this._currentMode.valueOf(),customFeed:this._customFeed,focused:!0,isSubsMode:"subs"===this.$el.data("subs-sort")}),this.listenTo(this._feed,"loaded",(({title:e})=>{e&&(document.title=e)}))}_initFeedFilterPanel(){var e;!this._isRecommendMode&&this._currentMode!==V.DV.CHISTOMEN&&null!==(e=this.$els.feedPanel)&&void 0!==e&&e.length&&(this._filter=new V.pd({$el:this.$els.feedPanel,feed:this._feed,feedName:this._currentMode.valueOf(),customFeed:this._customFeed,isDisableCalendar:Boolean(this._customFeed),isSubsMode:this._isSubsMode,inlineFiltersMode:!0,baseUrl:this._getBaseUrl()}))}}},33416:(e,t,s)=>{"use strict";s.d(t,{_:()=>C});s(88674),s(74916),s(66992),s(33948),s(41817);var i=s(12953),o=s(82580),r=s(95411),n=s(28831),a=s(91920),l=s(96637),c=s(9975),d=s(59297),u=s(79849),p=s(92927),h=s(77289),_=s(12182),m=s(57852),g=s(90312);function v(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class f{constructor(){v(this,"_mainStory",null),v(this,"_isMainStoryInViewport",!1),v(this,"_relatedStoriesInViewport",[])}static getInstance(){return f.instance?f.instance:f.instance=new f}setViewportForAnalytics(e,t){if(!e||!e.length&&"related"!==t)return;const s="story"===t,i="related"===t;s||i?this._findStoryInViewportOnStoryPage(e,s,i):this._findStoryinViewportOnFeed(e)}_checkStoryForViewport(e){const t=i.core.ui.scrollTop,s=i.core.ui.windowHeight*a.VIEWPORT_LIMIT,o=e.offsetTop-t;return o+e.offsetHeight>=a.VIEWPORT_START&&o<s}_findStoryInViewportOnStoryPage(e,t,s){if(t&&(this._mainStory=e[0],this._isMainStoryInViewport=this._checkStoryForViewport(this._mainStory),this._isMainStoryInViewport||(this._mainStory.inViewportForAnalytics=!1)),s){if(e&&0===e.length)return void(this._mainStory.inViewportForAnalytics=this._isMainStoryInViewport);if(this._relatedStoriesInViewport=e.filter((e=>this._checkStoryForViewport(e))),0===this._relatedStoriesInViewport.length)return e.forEach((e=>e.inViewportForAnalytics=!1)),void(this._mainStory.inViewportForAnalytics=this._isMainStoryInViewport);{this._mainStory.inViewportForAnalytics=!1;const t=this._relatedStoriesInViewport[this._relatedStoriesInViewport.length-1];for(const s of e)s.inViewportForAnalytics=s===t}}}_findStoryinViewportOnFeed(e){const t=e.filter((e=>this._checkStoryForViewport(e))),s=t[t.length-1];for(const i of e)i!==s&&(i.inViewportForAnalytics=!1);s&&(s.inViewportForAnalytics=!0)}}var y=s(36005),b=s(36005);function w(e){var t,s="",i=b.escape;Array.prototype.join;return s+='<div class="special-tags-popup">\n    ',e.forEach(((e,o)=>{s+='\n        <label class="special-tags-popup__item">\n            <input type="checkbox" class="checkbox special-tags-popup__checkbox" value="'+i(o)+'"'+(null==(t=e?"checked":"")?"":t)+'>\n            <span class="special-tags-popup__text">'+i("Моё"===o?"[моё]":o)+"</span>\n        </label>\n    "})),s+="\n</div>"}s(83257),s(91904);function k(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function S(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?k(Object(s),!0).forEach((function(t){O(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):k(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function O(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const E=s(19755);class C extends o.nT{constructor(e){if(super(e),this.stories.DataObject=n.s6,this._firstJump=i.core.ui.scrollTop<50,this.show(),this.isPaginationMode&&"story"!==this.feedName){let e=this._detectNeedScrolling();e&&this.changeStory(e)}this._storiesInViewport()}render(){return this.isRendered||(this.$els={container:this.$("."+o.FG.container),spinner:this.$("."+o.FG.spinner),spinnerBefore:this.$("."+o.FG.spinnerBefore),loadingBefore:this.$("."+o.FG.loadingBefore).on("click",(async()=>{this.$els.loadingBefore.toggle(!1),await this.loadStoriesByIds(null,!0),this.$els.loadingBefore.toggle(this.storiesBefore.length>0)})),message:this.$("."+o.FG.message.item),pagination:E("."+o.FG.pagination),hiddenCounter:E("."+o.FG.hiddenCounter.item),messageSubs:this.$("."+o.FG.messageSubs.item),relatedStoriesAdv:this.$("."+o.FG.relatedStoriesAdv),footer:E(".footer")},"story"!==this.feedName&&"story-preview"!==this.feedName||(this.$els.container=this.$el),this._options.hiddenStories=this.$els.hiddenCounter.data("amount"),this._showSubsStub=!this.$els.container.find(`.${n.lO.item}`).length,this.$els.hiddenCounter.on("click",(()=>{g.c.getInstance().sendEvent("click",{button_name:"visited_stories",component_name:"feed"})})),this._init(),super.render()),this}_init(){return this._createLoadAnimation(),this._createLoadAnimationBefore(),this._getOptionsFromData(),this._attachTools(),this._attachMouseHoverStory(),this._attachHotkeys(),this._initHotkeysListeners(),["community-queue"].includes(this.feedName)||this._attachDetectFocusIn(),this._attachScroll(),this._attachSocialButton(),this._attachStorySave(),this._attachModeratorTools(),this.initStories(),this.assignScreenIndex(),this._initFeedNotifications(),this._initAnalytics(),this._initAdAnalytics(),this}_initFeedNotifications(){const e=this.$el.find(".stories-feed__rec-message");if(!e.length)return;e.find("button").on("click",(()=>{i.eR.set("rec_feed_message_shown",!0,{expires:365}),e.remove()}))}_initAnalytics(){const e=this.$els.message.data("type");e&&!["read_all_posts","more_votes_advice"].includes(e)&&this.$els.message.hasClass(o.FG.message.show)&&g.c.getInstance().sendEvent("reach_element",{type:e})}_initAdAnalytics(){_.Q.instance.watch(this.$els.relatedStoriesAdv,m.L.FEED)}_updateTitle(e){document.title=e}_updateMenuCaption(e){}_storiesInViewport(e){if(c.I.isSupported&&c.I.isFullScreen||this.marks.has("orientationStoryId"))return this;e=e||i.core.ui.scrollTop;const t=.6*i.core.ui.windowHeight;let s=!1;0!==this.feedName.length&&f.getInstance().setViewportForAnalytics(this.stories.items,this.feedName);const o=this.$els.container.find(`.${n.lO.item}`).toArray();this.marks.set("mouseStoryIdNeedsUpdate",!0);for(let i=0,n=o.length;i<n;i++){var r;const e=o[i],n=Number(null===(r=e.dataset)||void 0===r?void 0:r.storyId),a=this.stories.get(n),l=e.getBoundingClientRect(),c=l.top<=t&&l.bottom>=150;c&&(s||(s=!0,this.isExpandedMode&&(this._firstJump?this._firstJump=!1:this.navigationStoryId=this.mouseStoryId=n,null==a||a.setCurrentPlayer())),null==a||a.updateViewBounds()),a&&!a.isMetrikaVisited&&a.inViewport&&!c&&"story"!==this.feedName&&"story-preview"!==this.feedName&&(a.isMetrikaVisited=!0,g.c.getInstance().yandex.goal("one-scrolled-story")),a&&a.inViewport!==c&&(a.inViewport=c)}return this.viewObserver.update(),this}async scrollTo(e,t=!1){this.marks.set("scrolling",!0),await i.core.ui.scrollTo(e,t),await l.Utils.delay(150),this.marks.delete("scrolling")}_attachTools(){return super._attachTools(),this.$el.on("click",".story__scroll-next-btn",(e=>{let t=E(e.target),s=t.closest(".story"),i=s.data("story-id");if(t.hasClass("story__scroll-next-btn")&&(t.addClass("story__scroll-next-btn_unhoverable"),this.timeout("post-remove-unhoverable",500,(()=>{t.removeClass("story__scroll-next-btn_unhoverable")})),this.focused&&"story"!==this.feedName&&"story-preview"!==this.feedName)){g.c.getInstance().yandex.goal("story_move-to-next");const e=this.stories.get(i);g.c.getInstance().sendEvent("click",S(S({button:"next_story",post_id:i},e&&{author_id:e.authorId}),e&&{screen_index:e.screenIndex})),this.navigationStoryId=i,this._toNextStory(s)}})),this.$els.message.on("click",".button_link",(e=>{this._toCalendar(),e.preventDefault()})),this}_attachSocialButton(){return this._socialButtons=new u.B(this),this}_attachStorySave(){return this.$el.on("click",".story__save",(e=>{this.stories.get(E(e.currentTarget).data("story-id")).handleSaveClick(e.currentTarget)})),this}_attachModeratorTools(){if(!this.$el.find(".story__mods-list").length)return;this.$el.on("click",'.story__mod[data-role="sharing"]',(e=>{e.stopPropagation(),e.preventDefault();const t=E(e.currentTarget).data("story-id");t&&(new d.$).markStoryShared(t)})),this.$el.on("click",'.story__mod[data-role="ban"]',(e=>{e.stopPropagation(),e.preventDefault();let t=E(e.currentTarget),s=t.data("user-id"),i=t.data("story-id");const o=Boolean(t.data("admoder"));s&&i&&(new d.$).on("complete",(function(){t.addClass("story__mod_active")})).showBanUserDialog(e.target,s,i,1,o)})),this.$el.on("click",'.story__mod[data-role="delete"]',(e=>{e.stopPropagation(),e.preventDefault();const t=E(e.currentTarget),s=t.data("story-id"),o=t.data("user-id");if(!s)return;let r=E(".story__header",".story").addClass("story__header_highlight");(new d.$).on("complete",(function(){i.core.history.replaceUrl(window.location.pathname+window.location.search),window.location.reload()})).on("cancel",(function(){r.removeClass("story__header_highlight")})).showDeleteStoryDialog(e.currentTarget,o,s)})),this.$el.on("click",`.${n.lO.moderator.button}[data-role="delete404"]`,(e=>{e.stopPropagation()&&e.preventDefault();const t=E(e.currentTarget),s=t.data("story-id"),o=t.data("user-id");if(!s)return;const r=E(".story__header",".story").addClass("story__header_highlight");(new d.$).on("complete",(()=>{i.core.history.replaceUrl(window.location.pathname+window.location.search),window.location.reload()})).on("cancel",(()=>r.removeClass("story__header_highlight"))).showDeleteStory404Dialog(e.currentTarget,o,s)})),this.$el.on("click",`.${n.lO.moderator.button}[data-role^="restore"]`,(e=>{e.stopPropagation(),e.preventDefault();let t=E(e.currentTarget);t.attr("disabled","disabled");let s=t.attr("data-story-id");s&&(new d.$).on("cancel",(function(){t.removeAttr("disabled")})).on("complete",(function(){t.fadeOut(),window.location.reload()})).restoreStory(s)})),this.$el.on("click",'[data-role="feed-hide"]',(e=>{e.stopPropagation(),e.preventDefault();let t=E(e.currentTarget),s=t.data("story-id"),i=!t.data("feed");s&&(new d.$).on("complete",(function(){t.toggleClass("story__mod-btn_feed-active",i).data("feed",i),t.next(".story__mod-text").remove()})).setStoryVisibilityFlag(t,s,i)})),this.$el.on("click",'.story__mod[data-role="move"]',(e=>{e.stopPropagation(),e.preventDefault();let t=E(e.currentTarget).data("story-id");t&&(new d.$).on("complete",(function(){window.location.reload()})).moveStoryToCommonFeed(t)})),this.$el.on("click",'.story__mod[data-role="history"]',(e=>{e.stopPropagation(),e.preventDefault();let t=E(e.target),s=this.$el.find(".story__restore-history");s.length&&(t.toggleClass("story__mod_active"),s.slideToggle())}));let e=!1;this.$el.on("click",".story__tags-edit_mod",(t=>{t.stopPropagation(),t.preventDefault();let s=E(t.currentTarget),i=s.data("story-id"),o=this.$(".mt__tags");o&&i&&(e||(e=(new d.$).on("complete",(function(){window.location.reload()})).editTags(i,o)),s.toggleClass("story__tags-edit_active"),o.slideToggle())}));const t=this.$el.find(".story__mod-btn_tags");t.length&&this.initModerationSpecialTags({ctx:this,container:t,template:w})}_attachDetectFocusIn(){return this.$el.on("mouseenter",(0,y.throttle)((()=>this.focused=!0),50)),this}_attachMouseHoverStory(){let e;return this.$el.on("mousemove",`.${n.lO.item}`,(0,y.throttle)((t=>{e===t.currentTarget||this.marks.has("scrolling")||(e=t.currentTarget,this.marks.delete("mouseStoryIdNeedsUpdate"),this.mouseStoryId=o.nT.getStoryIdByElement(t.target))}),50)),this}_initHotkeysListeners(){i.core.on("pauseHotkeys",(()=>{i.core.ui.hotkeys.off()})),i.core.on("restoreHotkeys",this._attachHotkeys.bind(this))}_attachHotkeys(){return i.core.ui.hotkeys.on(["w","add"],(()=>{if(!this.mouseStoryId||!this.focused||i.core.ui.player.isPlayerInFullscreen)return;let e=this.stories.get(this.mouseStoryId);e&&this._voteStory(e,a.STORY_VOTE.UP,!0)}),{type:r.FM.KEYDOWN,repeat:!1}),i.core.ui.hotkeys.on(["s","subtract"],(()=>{if(!this.mouseStoryId||!this.focused||i.core.ui.player.isPlayerInFullscreen)return;let e=this.stories.get(this.mouseStoryId);e&&this._voteStory(e,a.STORY_VOTE.DOWN,!0)}),{type:r.FM.KEYDOWN,repeat:!1}),i.core.ui.hotkeys.on(["a","numpad4"],(0,y.throttle)((()=>{this.focused&&"story"!==this.feedName&&"story-preview"!==this.feedName&&!i.core.ui.player.isPlayerInFullscreen&&this._toPrevStory()}),700),{type:r.FM.KEYDOWN,repeat:!1}),i.core.ui.hotkeys.on(["d","numpad6"],(0,y.throttle)((()=>{this.focused&&"story"!==this.feedName&&"story-preview"!==this.feedName&&!i.core.ui.player.isPlayerInFullscreen&&this._toNextStory()}),700),{type:r.FM.KEYDOWN,repeat:!1}),i.core.ui.hotkeys.on("e",(()=>{if(!this.focused||!this.navigationStoryId||"story"===this.feedName||"story-preview"===this.feedName||i.core.ui.player.isPlayerInFullscreen)return;let e=this.stories.get(this.navigationStoryId);if(!e||e.isCommentsDisabled)return;i.core.ui.header.hideNext=!0;let t=window.open(e.titleLink+"#comments","_blank");try{t.focus()}catch(s){}}),{type:r.FM.KEYUP,repeat:!1}),i.core.ui.hotkeys.on("x",(()=>{if(i.core.ui.player.isPlayerInFullscreen)return;let e=this.stories.get(this.navigationStoryId);e&&this.focused&&this.scrollTo(e.offsetTop-10,!0)}),{type:r.FM.KEYDOWN}),"story"===this.feedName?this._attachHotkeyStoryPage():i.core.ui.hotkeys.on("f",(()=>{if(i.core.ui.player.isPlayerInFullscreen)return;let e=this.stories.get(this.navigationStoryId);e&&this.focused&&e.isLongStory&&(e.isCollapsedLongStory=!1)}),{type:r.FM.KEYDOWN}),i.core.ui.player.attachHotkey(),this}_attachHotkeyStoryPage(){return i.core.ui.hotkeys.on("q",(()=>{window.opener&&!i.core.ui.player.isPlayerInFullscreen&&(window.opener.focus(),window.close())})),this}_onToolClick(e,t,s){Array.isArray(t)||(s=t,t=[]);const i=this.stories.get(o.nT.getStoryIdByElement(s.target));i&&!0===e.call(this,i,...t)&&s.preventDefault()}_showSimilarStories(e){e.$similarBlock?e.$similarBlock.toggleClass(n.lO.similarBlockOpened):(e.$similarBlock=e.$el.find("."+n.lO.similarBlock),e.$similarBlock.addClass(n.lO.similarBlockOpened),this._similarStories=new h.Bi({$parent:e.$el.find(".story__similar-content"),type:h.VQ.STORY,storyId:e.id}),this._similarStories.show())}_readMore(e){return e&&e.isLongStory&&(e.isCollapsedLongStory=!1,this._sendReadMoreEvent(e)),!0}_toNextStory(e){let t;!e&&this.navigationStoryId&&(e=this.$els.container.find(`.${n.lO.item}[data-story-id=${this.navigationStoryId}]`)),e&&(t=e.nextAll(".story").toArray().find((e=>"none"!==window.getComputedStyle(e).display)));let s=t?parseInt(t.dataset.storyId,10):this.navigationStoryId?this.stories.nextId(this.navigationStoryId):this.stories.firstId();const i=this.stories.get(s);if(!i&&t)return this._scrollToTarget(t),this;i&&i.isHidden&&(s=this.stories.nextId(s));let o=this.stories.get(this.navigationStoryId);return o&&this.viewObserver.setVisit(o),s?(this.changeStory(s),this):(this.isPaginationMode&&"related"!==this.feedName&&this._toPage(!0),this)}_toPrevStory(){var e;let t=this.navigationStoryId?this.$els.container.find(`.${n.lO.item}[data-story-id=${this.navigationStoryId}]`):void 0,s=t&&t.length>0?t.prevAll(".story").toArray().find((e=>"none"!==window.getComputedStyle(e).display)):void 0;this.isExpandedMode&&this.navigationStoryId&&(null==t||null===(e=t.get(0))||void 0===e?void 0:e.getBoundingClientRect().top)<-200&&(s=t.get(0));let i=s?parseInt(s.dataset.storyId,10):this.stories.firstId();const o=this.stories.get(i);return!o&&s?(this._scrollToTarget(s),this):(o&&o.isHidden&&(i=this.stories.prevId(i)),i!==this.stories.firstId()||s?(this.changeStory(i),this):(this.isPaginationMode&&"related"!==this.feedName&&this._toPage(!1),this))}_scrollToTarget(e){const t=e instanceof HTMLElement?e:e.el;this.navigationStoryId=t.dataset.storyId,p.$.request((()=>{this.scrollTo(t.getBoundingClientRect().top+i.core.ui.scrollTop-14,!0)}));const s=t.querySelector(".player");s?setTimeout((()=>{s.focus()}),300):document.activeElement.blur()}_toPage(e){let t=Math.max(1,Math.min(this.page+(e?1:-1),this._options.lastPage));return t!==this.page&&(i.core.history.searchParams.set("page",t),i.core.history.searchParams.set("scrollto",e?"first":"last"),i.core.history.location.href=i.core.history.location.pathname+"?"+i.core.history.searchParams.toString()),this}changeStory(e){super.changeStory(e);const t=this.stories.get(e);return this._scrollToTarget(t),this}async _toCalendar(){await this.scrollTo(i.core.ui.$els.main.offset().top,!0),i.core.emit("ui-calendar-feed-popup:open")}initStories(){return this._initStoriesCommon(n.lO)}get currentScrollStoryId(){return this._options.currentScrollStoryId}set currentScrollStoryId(e){let t,s=this._options.currentScrollStoryId;s!==(e="boolean"==typeof e?0:Number(e))&&(this._options.currentScrollStoryId=e,s&&(t=this.stories.get(s),t.scrollMode=!1),e&&(t=this.stories.get(e),t.scrollMode=!0))}get mouseStoryId(){if(this.marks.has("mouseStoryIdNeedsUpdate")){this.marks.delete("mouseStoryIdNeedsUpdate");const e=this.$els.container.get(0).querySelector(":scope > .story:hover");if(e){const t=o.nT.getStoryIdByElement(e);if(t)return this.mouseStoryId=t,t}}return this._options.mouseStoryId}set mouseStoryId(e){this._options.mouseStoryId=Number(e)}get socialButtons(){return this._socialButtons}}},57215:(e,t,s)=>{"use strict";s.d(t,{DV:()=>o.DV,$m:()=>S,_D:()=>i._,RP:()=>k,pd:()=>D});var i=s(33416),o=s(82580),r=(s(88674),s(12953));s(48218),s(16253);s(19755);var n=s(63907),a=s(88358);function l(e){var t,s="";Array.prototype.join;return s+='<form class="stories-feed-filter">\n\t',"hot"!==e.feedName||e.isSubsMode||(s+='\n\t\t<label class="stories-feed-filter__field">\n\t\t\t<span class="stories-feed-filter__title">Сортировать по времени</span>\n\t\t\t<input class="checkbox_switch" type="checkbox" name="isSortedByTime" value="true" data-to-boolean="true" '+(null==(t=e.isSortedByTime?'checked="checked"':"")?"":t)+">\n\t\t</label>\n\t\t<hr>\n\t"),s+="\n\n\t"+(null==(t=e.dateFilterTemplate)?"":t)+'\n\n\t<label class="stories-feed-filter__field" data-role="hide-visited">\n\t\t<span class="stories-feed-filter__title">Просмотренные</span>\n\t\t<select data-role="listbox" name="displayMode">\n\t\t\t<option value="0" '+(null==(t=0===e.displayMode?'selected="selected"':"")?"":t)+'>показывать</option>\n\t\t\t<option value="1" '+(null==(t=1===e.displayMode?'selected="selected"':"")?"":t)+'>сворачивать</option>\n\t\t\t<option value="2" '+(null==(t=2===e.displayMode?'selected="selected"':"")?"":t)+">скрывать</option>\n\t\t</select>\n\t</label>\n\n\t",e.isUserAuthorized&&(s+='\n\t\t<label class="stories-feed-filter__field">\n\t\t\t<span class="stories-feed-filter__title">Показывать 18+ контент</span>\n\t\t\t<input type="checkbox" name="isAdultVisible" class="checkbox_switch" value="true" data-to-boolean="true" '+(null==(t=e.isAdultVisible?'checked="checked"':'data-confirm-adult="1"')?"":t)+">\n\t\t</label>\n\t"),s+="\n</form>\n"}s(90477);var c=s(96637),d=s(90312),u=(s(41817),s(85823)),p=s(31474);function h(e){var t,s="";Array.prototype.join;return e.isDateFilterOnly&&(s+='\n\t<form class="stories-feed-filter stories-feed-filter_dates menu_vertical">\n'),s+="\n\t\n\t","most-saved"!==e.feedName&&(e.isDisableCalendar||e.isSubsMode||"best"!==e.feedName)||(s+='\n\t\t<label class="stories-feed-filter__field menu__item">\n\t\t\t<input type="radio" name="time" value="today" '+(null==(t=e.date&&"today"!==e.date?"":'checked="checked"')?"":t)+'>\n\t\t\t<span class="stories-feed-filter__title">За сегодня</span>\n\t\t</label>\n\t\t<label class="stories-feed-filter__field menu__item">\n\t\t\t<input type="radio" name="time" value="week" '+(null==(t="week"===e.date?'checked="checked"':"")?"":t)+'>\n\t\t\t<span class="stories-feed-filter__title">За неделю</span>\n\t\t</label>\n\t\t<label class="stories-feed-filter__field menu__item">\n\t\t\t<input type="radio" name="time" value="month" '+(null==(t="month"===e.date?'checked="checked"':"")?"":t)+'>\n\t\t\t<span class="stories-feed-filter__title">За месяц</span>\n\t\t</label>\n\t\t<label class="stories-feed-filter__field menu__item">\n\t\t\t<input type="radio" name="time" value="all_time" '+(null==(t="all"===e.date?'checked="checked"':"")?"":t)+'>\n\t\t\t<span class="stories-feed-filter__title">За всё время</span>\n\t\t</label>\n\t\t<hr />\n\t'),s+="\n\t\n\t",e.isDisableCalendar||e.isSubsMode||(s+='\n\t\t<p class="stories-feed-filter__field menu__item'+(null==(t="range"===e.date?" stories-feed-filter__field_current":"")?"":t)+'" data-role="calendar">\n\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__calendar icon--ui__calendar_modal"><use xlink:href="#icon--ui__calendar"></use></svg> <span class="stories-feed-filter__title">Выбрать дату</span>\n\t\t</p>\n\t\t<p class="stories-feed-filter__field menu__item" data-role="random">\n\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__random icon--ui__random_modal"><use xlink:href="#icon--ui__random"></use></svg> <span class="stories-feed-filter__title">Случайная дата</span>\n\t\t</p>\n\t\t',e.isDateFilterOnly||(s+="\n\t\t<hr>\n\t\t"),s+="\n\t"),s+="\n\t\n",e.isDateFilterOnly&&(s+="\n</form>\n"),s+="\n\t"}s(91904);var _=s(10553),m=s(10850),g=s(55529);function v(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function f(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?v(Object(s),!0).forEach((function(t){y(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):v(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function y(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const b=s(19755);class w extends o.mC{constructor(e){super(e),y(this,"_initDateForm",(()=>{const e=this.dateFilterPopup.content;if(!e)return;const t=new u.x(e),s=e.find('p[data-role="calendar"]');this.$els.calendarCustom={el:s,title:s.find(".stories-feed-filter__title")},this.listenTo(t,"change",this._handleDateFormChange.bind(this));const i=e.find('p[data-role="calendar"]').get(0);null==i||i.addEventListener("mouseenter",(e=>{this.$els.calendarCustom.el.data("hint")||(this.calendarPopup.target=this.$els.calendarCustom.el,this.calendarPopup.onMouseEnter(e))})),null==i||i.addEventListener("click",(()=>{this.calendarPopup.target=this.$els.calendarCustom.el,this.calendarPopup.show()})),e.on("click",'p[data-role="random"]',(()=>{this.feedType!==o.DV.COMPANIES?(this.calendar.setRangeByType("random",this.feedType!==o.DV.MOST_SAVED),this.calendar.datesRangeMode&&this._onSelectRange(),this._dateFilterPopup.hide()):this._loadRandomDate()}))})),this.$el&&this.show()}render(){if(this.isRendered)return this;super.render(),this.$els=f(f({},this.$els),{},{selectedDateRange:this.$(".feed-panel__selected-date")}),this.$els.selectedDateRange.find(".items-list__close").on("click",(()=>{const{datesRangeMode:e,defaultDate:t}=this.feedDateFilterParameters;this.calendar.setRangeByType("all"===t?"all_time":t,e),e&&this._onSelectRange(),this.$els.selectedDateRange.hide(),this._resetDateFilterRadio(t),this.filter.update({date:t,dateCaption:""})}))}_reset(){this._options.calendar&&(this._options.calendar.destroy(),delete this._options.calendar),this._calendarPopup&&(this._calendarPopup.destroy(),this._calendarPopup=void 0),this._dateFilterPopup&&this.dateFilterPopup.destroy()}_resetDateFilterRadio(e=""){this._dateFilterPopup&&this.dateFilterPopup.$('input[type="radio"]').each(((t,s)=>{s.checked=s.value===e,b(s).trigger("update")}))}_onSelectRange(){const e=this._getRange(),t=o._h.includes(e.type);return(this.feedType===o.DV.MOST_SAVED||this.feedType===o.DV.BEST)&&!t&&this._dateFilterPopup&&this._resetDateFilterRadio(),this.$els.selectedDateRange.length&&(this.$els.selectedDateRange.find("span:first").text(e.caption),this.$els.selectedDateRange.toggle(!this._isDefaultRange(e))),super._onSelectRange(),this.calendarPopup.hide(),this.dateFilterPopup.hide(),!0}_initDateFilterPopup(e=(()=>"")){const t=this.isDisableCalendar||this.isSubsMode||["community","community-search"].includes(this.feedName),s=this._options.inlineFiltersMode,i=f(f({},this.filter.plainData),{},{feedName:this.feedName,isDisableCalendar:t,isSubsMode:this.isSubsMode,isDateFilterOnly:s});i.date&&!o._h.includes(i.date)&&(i.date="range"),s||(i.dateFilterTemplate=h(i));const r=e(i);this._dateFilterPopup=new a._({alignment:this._options.inlineFiltersMode?a.SE.CENTER:a.SE.END,direction:this._options.inlineFiltersMode?a.Lh.LEFT:a.Lh.BOTTOM,indent:!1,content:r,autoCloseOutsideClick:!0,zIndex:7e3}),this.listenToOnce(this._dateFilterPopup,n.eM.DESTROYED,(()=>{this._dateFilterPopup=void 0,delete this.$els.calendarCustom.el,delete this.$els.calendarCustom.title})),this.listenTo(this._dateFilterPopup,n.eM.RENDERED,this._initDateForm),this.listenToOnce(this._dateFilterPopup,n.eM.UNMOUNTED,(()=>{this._dateFilterPopup.content.find(`.${o.FG.filter.fields.hideVisited}`).removeClass(o.FG.filter.fieldHighlight)}))}async _handleDateFormChange(e,t){var s;const i=e.serialize();if(null!=t&&null!==(s=t.$els)&&void 0!==s&&s.input.data("confirmAdult")&&!t.checked){if(!(await m.Z.showAdultPopup(!0)).result)return void(t.checked=!1);t.$els.input.data("confirmAdult",0)}e.saveAsDefault(),2!==i.displayMode&&0!==i.displayMode||window.history.replaceState(null,null,window.location.pathname),i.time&&(this.calendar.setRangeByType(i.time,this.feedType!==o.DV.MOST_SAVED),this._onSelectRange(),delete i.time),this.filter.update(i)}async _loadRandomDate(){var e;let t;(null===(e=this._options.randomDates)||void 0===e?void 0:e.length)>0||(this.$els.selectedDateRange.find("span:first").html(`<div class="feed-panel__selected-date-loader">${(0,_.t)("ui__progress-circle")}</div>`),this.$els.selectedDateRange.toggle(!0),this.calendarPopup.hide(),this.dateFilterPopup.hide(),this.feed.clear(),this._options.randomDates=await this._requestFeedRandomDates()),t=this._options.randomDates.pop(),this.calendar.setDate(t),this._onSelectRange()}get dateFilterPopup(){return this._dateFilterPopup||this._initDateFilterPopup(l),this._dateFilterPopup}get calendarPopup(){return this._calendarPopup||(this._calendarPopup=new a.gR({alignment:a.SE.END,direction:a.Lh.LEFT,theme:a.xb.GRAY,indent:!1,content:this.calendar.show().$el,delay:200,destroyAfterHide:!1,interactive:!0,zIndex:(0,g.e)()}),this.$els.calendarCustom.el&&this.$els.calendarCustom.el.length&&(this._calendarPopup.target=this.$els.calendarCustom.el),this._calendarPopup.footer.addClass("popup__footer_indent popup__footer_center"),this._calendarPopup.addButtonIntoFooter("Показать посты",(()=>this._onSelectRange()),p.j.SUCCESS),this.listenToOnce(this._calendarPopup,n.eM.DESTROYED,(()=>this._calendarPopup=void 0)),this.listenTo(this._calendarPopup,n.eM.MOUNTED,(()=>this.dateFilterPopup.autoCloseOutsideHandler=!1)),this.listenTo(this._calendarPopup,n.eM.UNMOUNTED,(()=>this.dateFilterPopup.autoCloseOutsideHandler=!0))),this._calendarPopup}}s(19755);class k extends w{render(){if(this.isRendered)return this;if(super.render(),this.$els=Object.assign(this.$els,{container:this.$(".feed-panel__container"),menu:this.$(".menu")}),this._isNeedShowHint()&&(this.$els.target.addClass(o.FG.filter.hideVisitedMark),this.$els.target.one("click",(()=>{c.LocalStorage.set(o.fo,!0),this.$els.target.removeClass(o.FG.filter.hideVisitedMark),this.dateFilterPopup.content.find(`.${o.FG.filter.fields.hideVisited}`).addClass(o.FG.filter.fieldHighlight)})),!c.LocalStorage.get(o.of,!1))){const e=new a._({target:this.$els.target,alignment:a.SE.END,direction:a.Lh.TOP,autoCloseOutsideClick:!1,distance:-12,indent:!1,content:'<div class="stories-feed-hint">\n\t<div class="stories-feed-hint__close"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__close icon--ui__close_size-middle"><use xlink:href="#icon--ui__close"></use></svg></div>\n\t<span class="stories-feed-hint__text">\n\t\tМы изменили настройки отображения просмотренных постов\n\t</span>\n</div>'});e.content.find(".stories-feed-hint__close").on("click",(()=>e.hide())),e.show(),c.LocalStorage.set(o.of,!0)}if(this.$els.target&&this.$els.target.length){const e="button-filter_active";this.listenTo(this.dateFilterPopup,n.eM.MOUNTED,(()=>this.$els.target.addClass(e))),this.listenTo(this.dateFilterPopup,n.eM.HIDDEN,(()=>this.$els.target.removeClass(e))),this.$els.target.on("click",(()=>this.dateFilterPopup.toggle())),this.listenTo(r.default,"ui-calendar-feed-popup:open",(()=>{this.dateFilterPopup.show()}))}return this}_onChangeFilter(e,t){void 0!==t.displayMode&&(this.feed.displayModeViewedStories=o.kc[e.data.displayMode],d.c.getInstance().sendEvent("change_viewed_posts_settings",{settings_type:["show","roll","hide"][e.data.displayMode]})),void 0!==t.isAdultVisible&&(this.feed.adultVisible=e.data.isAdultVisible),void 0!==t.isSortedByTime&&this._changeSortByTime(),this._dateFilterPopup&&this.dateFilterPopup.hide()}_initDateFilterPopup(){super._initDateFilterPopup(l);const e=this.$els.target.find(".button-filter__popup-target");e.length?this._dateFilterPopup.target=e:(this._dateFilterPopup.distance=-12,this._dateFilterPopup.target=this.$els.target)}}class S extends i._{constructor(e){super(e)}_init(){return this._attachTools(),this._attachSocialButton(),this._attachStorySave(),this._attachModeratorTools(),this.initStories(),this}initStories(){this.$els.container=this.$el.find(".client-mention__main"),super.initStories(),this._socialButtons.updateShareButtons()}}s(66992),s(33948);var O=s(32691),E=s(19755),C=s.n(E),x=s(30381),T=s.n(x);function I(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function P(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?I(Object(s),!0).forEach((function(t){A(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):I(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function A(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class D extends w{constructor(...e){super(...e),A(this,"_handleHideViewedFormChange",(e=>{e!==o.kc.VISITED_STORIES_HIDE&&e!==o.kc.VISITED_STORIES_SHOW||window.history.replaceState(null,null,window.location.pathname),this.feed.displayModeViewedStories=e,d.c.getInstance().sendEvent("change_viewed_posts_settings",{settings_type:["show","roll","hide"][e.value]}),this.filter.update({displayMode:e.value})}))}render(){if(this.isRendered)return this;super.render();const e=C()(".menu-filters");this.$els=P(P({},this.$els),{},{dateBtn:e.find('[data-name="date-filter"]'),nsfwBtn:e.find('[data-name="show-nsfw"]'),sortByTimeBtn:e.find('[data-name="sort-by-time"]'),sortByRatingBtn:e.find('[data-name="sort-by-rating"]'),hideViewedBtn:e.find('[data-name="hide-viewed"]')}),this._init()}_init(){if(this.$els.nsfwBtn.length){this.$els.nsfwBtn.on("click",(e=>{e.preventDefault()}));const e=new O.m({$el:this.$els.nsfwBtn});this.filter.on("dataChange",((t,s)=>{"isAdultVisible"in s&&e.toggleChecked(!s.isAdultVisible)})),this.$els.nsfwBtn.on("click",this._handleNsfwBtnClick.bind(this)),this.listenTo(r.default,"subscribe-nsfw-tag",(t=>{t&&e.toggleChecked(t,!1,!1)}))}this.$els.sortByTimeBtn.length&&new O.m({$el:this.$els.sortByTimeBtn}).on("change",this._handleSortByTimeBtnClick.bind(this)),this.$els.sortByRatingBtn.length&&new O.m({$el:this.$els.sortByRatingBtn}).on("change",this._handleSortByRatingBtnClick.bind(this)),this.$els.hideViewedBtn.length&&new O.m({$el:this.$els.hideViewedBtn}).on("change",(e=>{const t=e?o.kc.VISITED_STORIES_HIDE:o.kc.VISITED_STORIES_SHOW;this._handleHideViewedFormChange(t)})),this.$els.dateBtn.on("click",(()=>{this.dateFilterPopup.show()}))}async _handleNsfwBtnClick(){if(this.$els.nsfwBtn.data("confirmAdult")&&!this.$els.nsfwBtn.hasClass("checkbox_checked")){if(!(await m.Z.showAdultPopup(!0)).result)return;this.$els.nsfwBtn.data("confirmAdult",0)}const e=!this.filter.plainData.isAdultVisible;this.$els.nsfwBtn.toggleClass("button-filter_active",e),this.feed.adultVisible=e,this.filter.update({isAdultVisible:e})}_handleSortByRatingBtnClick(){var e;const t="boolean"==typeof this.filter.data.isSortByRating?!this.filter.data.isSortByRating:this.$els.sortByRatingBtn.hasClass("checkbox_checked");null===(e=this.$els.sortByRatingBtn)||void 0===e||e.toggleClass("button-filter_active",t),t?this.feed.searchParams.set("s","r"):this.feed.searchParams.delete("s"),this.filter.update({isSortByRating:t}),"profile"!==this.feedName?(this._updateFeed(),d.c.getInstance().sendEvent("filter",{filter_type:"rating",value_old:t?1:0,value_new:t?0:1})):this._changeProfileSort(t)}_handleSortByTimeBtnClick(){const e="boolean"==typeof this.filter.data.isSortedByTime?!this.filter.data.isSortedByTime:this.$els.sortByTimeBtn.hasClass("checkbox_checked");this.$els.sortByTimeBtn.toggleClass("button-filter_active",e),this.filter.update({isSortedByTime:e}),"profile"!==this.feedName?this._changeSortByTime():this._changeProfileSort(e)}_initDateFilterPopup(){super._initDateFilterPopup(h),this._dateFilterPopup.target=this.$els.dateBtn}_onSelectRange(){if(!super._onSelectRange())return!1;const e=this._getRange();let t="Выбрать дату",s="";return this._isDefaultRange(e)||(s=this._getSelectedDateCaption(e),s&&(t="Дата")),this.$els.dateBtn.find(".sidebar-menu-date-filter__label").text(t),this.$els.dateBtn.find(".sidebar-menu-date-filter__date").text(s),!0}_getSelectedDateCaption(e){if("all"===e.type)return"За всё время";const{start:t,end:s}=e;if(!t||!s)return"";const i="DD.MM.YYYY";if(t===s)return T()(t).format(i);const o=t.getFullYear()===s.getFullYear();return T()(t).format(o?"DD.MM":i)+" - "+T()(s).format(i)}_handleDateFormChange(e){super._handleDateFormChange(e),this.dateFilterPopup.hide()}}},79849:(e,t,s)=>{"use strict";s.d(t,{B:()=>S});s(74916),s(66992),s(38559),s(33948),s(88674),s(41637),s(41817);var i=s(90477),o=s(96637),r=s(88358);var n=s(63907);class a extends r._{constructor(){super({addOverlay:!0,direction:r.Lh.BOTTOM,alignment:r.Lh.LEFT,distance:10,autoCorrectPosition:!0,destroyAfterRemove:!0,destroyAfterHide:!0,content:'<div class="social-widget" data-is-loading>\n    <div class="social-widget__spinner"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__progress-circle icon--ui__progress-circle_story-editor"><use xlink:href="#icon--ui__progress-circle"></use></svg></div>\n    <div class="social-widget__content">\n        <div class="social-widget__widget"></div>\n        <div class="social-widget__controls">\n            <button class="button_success button_small">Я уже с вами</button>\n        </div>\n    </div>\n</div>\n'});const e=this.content.find(".social-widget");this.$els.widget=e[0],this.$els.widgetFrame=e.find(".social-widget__widget")[0],e.on("click",".button_success",(()=>{this._onSubscribe(!0)})),this._isSubscribe=void 0,this._onSubscribeBind=this._onSubscribe.bind(this,!0),this._onUnsubscribeBind=this._onSubscribe.bind(this,!1)}async waitSubscribe(e){return this._isSubscribe}destroy(){super.destroy(),delete this._onSubscribeBind,delete this._onUnsubscribeBind,delete this._ready,delete this._isSubscribe}_onSubscribe(e){this._isSubscribe=e,this.hide()}_onUnmounted(){return new Promise((e=>{this.listenToOnce(this,n.eM.UNMOUNTED,(()=>{e()}))}))}addScript(e){return new Promise(((t,s)=>{let i=document.createElement("script");function o(e,o){(o||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=null,i.onreadystatechange=null,i=void 0,o?s():t())}i.async=!0,i.defer=!0,i.onload=o,i.onerror=()=>s(),i.onreadystatechange=o,i.src=e,document.body.appendChild(i)}))}get apiReady(){}}var l=s(12953);const c="pkb_Sgr";class d extends a{static createGroup(e,t){e.Widgets.Group(t,{mode:0,width:"380",height:"320",color1:l.core.ui.css.colors.bg,color2:l.core.ui.css.colors.caption,color3:l.core.ui.css.colors.textGreen},31480508)}async waitSubscribe(e){this.target=e,this.show(),this.$els.widget.dataset.isLoading="true";try{const e=await this.apiReady;return e.Observer.subscribe("widgets.groups.joined",this._onSubscribeBind),e.Observer.subscribe("widgets.groups.leaved",this._onUnsubscribeBind),this.$els.widgetFrame.id="social-vk-widget",delete this.$els.widget.dataset.isLoading,this.updateWidth(),this.updatePosition(),d.createGroup(e,"social-vk-widget"),await this._onUnmounted(),e.Observer.unsubscribe("widgets.groups.joined",this._onSubscribeBind),e.Observer.unsubscribe("widgets.groups.leaved",this._onUnsubscribeBind),this._isSubscribe}catch(t){l.core.logger.warn("social",t),this.isShown&&this.hide()}}get apiReady(){return this._ready?this._ready:window.VK?this._ready=window.VK:new Promise(((e,t)=>{setTimeout((()=>t(new Error("vk api timeout"))),6e4),window.vkAsyncInit=()=>{delete window.vkAsyncInit,window.VK.init({apiId:4725981,onlyWidgets:!0}),e(this._ready=window.VK)},this.addScript("//vk.com/js/api/openapi.js")}))}static get instance(){return new d}}var u=s(16253),p=s(36005);var h=s(62956),_=s(90312),m=s(14025),g=s(32677),v=s(49463);function f(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function y(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?f(Object(s),!0).forEach((function(t){b(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):f(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function b(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const w=s(19755);let k=!1;class S extends u.vp{constructor(e){var t;(super(),b(this,"_handleCommentShareClick",(e=>{this._hasUtmParameters=!1,this.balloonTarget=e.currentTarget,_.c.getInstance().yandex.goal("share-comment"),_.c.getInstance().sendEvent("comment_share_button_tapped",this._getAnalyticsData())})),this._popup=void 0,this._tiPopup=void 0,this._userSocialGroup=void 0,this._hasUtmParameters=!0,this._feed=e,this._storyShareClass="story__share",this._commentShareClass="comment__tool",e&&e.el)&&(this._feed=e,null===(t=e.$el)||void 0===t||t.on("click",`.${this._storyShareClass}`,(e=>{this._hasUtmParameters=!0,this.balloonTarget=e.currentTarget,_.c.getInstance().yandex.goal("share-post"),_.c.getInstance().sendEvent("content_share_button_tapped",this._getAnalyticsData())})));k||(k=!0,w(".comments").on("click.share",`.${this._commentShareClass}[data-role="share"]`,this._handleCommentShareClick))}updateShareButtons(){const e=w(".comments");e.off("click.share"),e.on("click.share",`.${this._commentShareClass}[data-role="share"]`,this._handleCommentShareClick)}_closePopup(){if(!this._popup)return;const e=this._popup;this._tiPopup&&(clearInterval(this._tiPopup),delete this._tiPopup),e.closed||e.close(),delete this._popup}onClickSocialButton(e){var t;e.preventDefault(),this.balloon.hide();let s=this._getStoryIdOfClickedBalloon(e);if(!s){const e=this.balloonTarget.closest(".comments");e&&(s=e.dataset.storyId)}s&&(_.c.getInstance().google.event("share","post"),m.DT.sendEvent("share"),this._logShareClick(s));const i=e.currentTarget.dataset.type,o=null!==(t=this.balloonTarget)&&void 0!==t&&t.classList.contains("comment__tool")?"comment_shared":"content_shared";_.c.getInstance().sendEvent(o,y(y({},this._getAnalyticsData()),{},{type:(0,h.Lq)(i)})),this._closePopup();const r=e.currentTarget.href,n=`left=${e.screenX||Math.round(screen.width/2-325)},top=${e.screenY||screen.height>570?Math.round(screen.height/3-285):0},width=650,height=570,personalbar=no,toolbar=no,scrollbars=yes,resizable=yes`,a=this._popup=window.open(r,"social share",n)||window.open(r);a.focus();let l=0;this._tiPopup=setInterval((()=>{!a.closed&&500*l++<3e5||(this._closePopup(),this._showWidget(e))}),500)}onClickCopyButton(e){e.preventDefault();const t=this.balloonTarget,s=t?t.dataset.url:e.target.dataset.url,i=this._hasUtmParameters?(s.includes("?")||s.includes("%3F")?"&":"?")+"utm_source=linkshare&utm_medium=sharing":"",r=this._getStoryIdOfClickedBalloon(e);o.Utils.copyToClipboard(decodeURIComponent(s)+i);const n=t.classList.contains(this._commentShareClass)?"comment_shared":"content_shared";_.c.getInstance().sendEvent(n,y(y({},this._getAnalyticsData()),{},{type:"copy_link"})),this._logShareClick(r),this.balloonTarget?(this.balloon.content.html('<div class="social-balloon-copy">Скопировано! 👍</div>'),this.balloon.updatePosition(),this.balloon._skipNextClick=!0,setTimeout((()=>this.balloon.isShown&&this.balloon.hide()),2e3)):l.core.ui.toasts.add("story-link-copy",{content:"Скопировано! 👍"})}_getAnalyticsData(){var e,t;const s=this.balloonTarget;if(!s)return{};const i=s.classList.contains(this._storyShareClass),o=s.classList.contains(this._commentShareClass);if(!i&&!o)return{};if(i){var r,n;const e=Number(s.dataset.storyId),t=null===(r=this._feed)||void 0===r||null===(n=r.stories)||void 0===n?void 0:n.get(e);return t?y({time:t.getViewTimeMS()},t.analyticsData):{}}let a,l,c,d,u,p,h,_;const m=s.closest(".comment");d=m.dataset.id,u=null===(e=m.dataset.meta.match(/aid=(\d+)/))||void 0===e?void 0:e[1];const g=s.closest(".comments");if(c=null!==(t=null==g?void 0:g.dataset.storyId)&&void 0!==t?t:void 0,c&&this._feed&&this._feed.stories){const e=this._feed.stories.get(Number(c));var f;if(e)a=e.commentsCount,l=e.authorId,p=e.donationAnalyticsParam,h=null===(f=e.analyticsData)||void 0===f?void 0:f.component_name,_=v.Z.getInstance().getViewTimeMS("comments")}const b={comments:a,author_id:l,post_id:c,comment_id:d,comment_author_id:u,post_donation:p,component_name:h,time:_};return Object.fromEntries(Object.entries(b).filter((([e,t])=>void 0!==t)))}async _showWidget(e){const t=e.currentTarget.dataset.type,s=w(this.balloonTarget),i=this.subscribesToSocial.data[t];if(!s.length||void 0!==i&&("number"!=typeof i||i>Date.now()-72e5))return;let o;if("vk"===t)o=await d.instance.waitSubscribe(s);this.subscribesToSocial.data[t]="boolean"==typeof o?o:Date.now()}_getStoryById(e){var t,s;return null===(t=this._feed)||void 0===t||null===(s=t.stories)||void 0===s?void 0:s.items.find((t=>t.id===Number(e)))}_getStoryIdOfClickedBalloon(e){return this.balloonTarget?this.balloonTarget.dataset.storyId:w(e.currentTarget).parent().data("storyId")}_logShareClick(e){var t,s;null===(t=(s=navigator).sendBeacon)||void 0===t||t.call(s,"/ajax.php?"+new URLSearchParams({route:"share-story",story_id:e,screen_id:g.L[l.core.ui.screen]}))}get subscribesToSocial(){if(this._userSocialGroup)return this._userSocialGroup;const e=o.LocalStorage.get(c),t="object"==typeof e&&(e.N||0)>Date.now()-108e6,s={vk:t?e.V:void 0,facebook:t?e.F:void 0,twitter:t?e.T:void 0,ok:t?e.O:void 0},r=this._userSocialGroup=new i.Lo(s);return this.listenTo(r,i.u$.CHANGE,(()=>{const e=r.plainData;o.LocalStorage.set(c,{V:e.vk,F:e.facebook,T:e.twitter,O:e.ok,N:Date.now()})})),r}get balloon(){let e=this._balloon;return e||(e=this._balloon=new r._({}),e.content.on("click",".social__button",this.onClickSocialButton.bind(this)),e.content.on("click",".social-balloon__copy",this.onClickCopyButton.bind(this)),e)}get menu(){let e=this._menu;return e||(e=this._menu=new r._({direction:r.Lh.RIGHT,stickyPosition:!0,autoCorrectPosition:!1}),e.content.on("click",".social-menu__button",this.onClickSocialButton.bind(this)),e.content.on("click",".social-menu__copy",this.onClickCopyButton.bind(this)),e)}get balloonTarget(){return this._balloonTarget}set balloonTarget(e){if(this._balloonTarget===e&&this.balloon.isShown)return this.balloon.hide(),void delete this._balloonTarget;const t=e.dataset.url+(e.dataset.url.includes("?")||e.dataset.url.includes("%3F")?"%26":"%3F"),s=e.dataset.title;this.balloon.content=function(e){var t="",s=p.escape;return t+'<div class="social-balloon">\n    <div class="social-balloon__header">\n        <a href="https://t.me/share/url?url='+s(e.url+encodeURIComponent("utm_source=tgshare&utm_medium=sharing")+(e.title?"&text="+encodeURIComponent(e.title):""))+'" target="_blank" rel="nofollow noopener" class="social__button" data-type="tg"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__share_social_tg"><use xlink:href="#icon--ui__share_social_tg"></use></svg></a>\n        <a href="https://vk.com/share.php?url='+s(e.url+encodeURIComponent("utm_source=vshare&utm_medium=sharing"))+'" target="_blank" rel="nofollow noopener" class="social__button" data-type="vk"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__share_social_vk"><use xlink:href="#icon--ui__share_social_vk"></use></svg></a>\n        <a href="https://connect.ok.ru/offer?url='+s(e.url+encodeURIComponent("utm_source=okshare&utm_medium=sharing"))+'" target="_blank" rel="nofollow noopener" class="social__button" data-type="ok"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__share_social_ok"><use xlink:href="#icon--ui__share_social_ok"></use></svg></a>\n    </div>\n    <div class="social-balloon__footer">\n        <a href="/" class="social-balloon__copy"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__share_link icon--ui__share_link_story"><use xlink:href="#icon--ui__share_link"></use></svg> Скопировать ссылку</a>\n    </div>\n</div>\n'}({url:t,title:s}),this.balloon.target=this._balloonTarget=e,this.balloon.show()}}},77289:(e,t,s)=>{"use strict";s.d(t,{VQ:()=>i.VQ,Bi:()=>c});s(66992),s(33948);var i=s(26938),o=s(91920),r=s(96637);var n=s(90312),a=(s(91904),s(36005));const l=s(19755);class c extends i.kc{constructor(e){super(e),this._options.fragmentsLinePerPage=3,this._options.fragmentSize={[o.STORY_BLOCK_TYPE.VIDEO]:1,[o.STORY_BLOCK_TYPE.IMAGE]:1,[o.STORY_BLOCK_TYPE.VIDEO_FILE]:1,[o.STORY_BLOCK_TYPE.TEXT]:3}}render(){return this.isRendered||(this.$el=l((e={},t="",Array.prototype.join,t+='<div class="stories-similar">\n\t<div class="stories-similar__progress">\n\t\t<div class="stories-similar__progress-bar"></div>\n\t\t<div class="stories-similar__progress-message"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__progress-circle"><use xlink:href="#icon--ui__progress-circle"></use></svg> Сбор информации о возможных дубликатах</div>\n\t</div>\n\t<div class="stories-similar__empty">Похожих постов не найдено</div>\n\t<div class="stories-similar__error">\n\t\t<span>Ну вот :( При поиске похожих постов обнаружена ошибка!</span>\n\t\t<button class="button" type="button">Повторим поиск?</button>\n\t</div>\n\t<div class="stories-similar__main">\n\t\t<div class="stories-similar__fragments"></div>\n\t\t<div class="stories-similar__controls">\n\t\t\t<button type="button" class="stories-similar__more" data-role="more">Показать ещё</button>\n\t\t\t',e.existStory&&(t+='\n\t\t\t<button type="button" class="button_link stories-similar__close">Закрыть</button>\n\t\t\t'),t+="\n\t\t</div>\n\t</div>\n</div>")),this.$els={main:this.$(".stories-similar__main"),progress:{el:this.$(".stories-similar__progress"),bar:this.$(".stories-similar__progress-bar")},empty:this.$(".stories-similar__empty"),repeatButton:this.$(".stories-similar__error button"),fragments:this.$(".stories-similar__fragments"),controls:this.$(".stories-similar__controls"),more:this.$(".stories-similar__more").on("click",this._renderPage.bind(this,!1))},this.$el.on("click",".story-fragment__text-more",(e=>{l(e.currentTarget).hide().prev().addClass("story-fragment__hidden-text_show")})),this.$els.repeatButton.click((e=>{this.relaunchErrorSources()})),this._updateType(this.type),super.render()),this;var e,t}_updateType(e){switch(this.sources.clear(),this.type){case i.VQ.STORY:this.state=i.DX.WAIT,this.getStoryDuplications();break;case i.VQ.EDITOR:case i.VQ.MANUAL:this.state=i.DX.EMPTY}this._updateMoreButton()}_updateState(e){this.$el.attr("data-state",e.toString().toLowerCase()),e===i.DX.READY&&this._renderPage(!0)}_renderPage(e=!1){e&&this.$els.fragments.empty(),this.getPageFragments(e).map((e=>c._renderFragment(e).appendTo(this.$els.fragments))),this.emit("update"),(0,a.forEach)(this.$(".story-fragment"),(e=>e.classList.add("story-fragment_show"))),this._updateMoreButton()}_updateMoreButton(){return this.$els.more.toggle(!this.sources.items.every((e=>e.isEmpty||e.isFinished))),this}static _renderFragment(e){let t,i=(e.story_display_type&o.STORY_TYPE.TGP.valueOf())===o.STORY_TYPE.TGP.valueOf()||!e.story_display_type&&e.is_gtext||2===e.img_type;if(e.type===o.STORY_BLOCK_TYPE.IMAGE){let t=e.frg_width||e.width,[s,i]=r.Utils.calculateAspectRatioFit(t,e.frg_height||e.height,142,600),o=e.frg_y*(-s/t);e.style=`width: ${s}px; height: ${i}px; background-image: url(`+(e.preview_url||e.image_url)+"); "+(2===e.img_type?"; background-position-y: "+o+"px":"")}else e.type===o.STORY_BLOCK_TYPE.VIDEO?e.style=`width: 142px; height: ${142/(e.ratio||1.75)}px;`+(e.preview_url?` background: url(${e.preview_url})`:""):(e.type,o.STORY_BLOCK_TYPE.VIDEO_FILE);return t=l(function(e){var t,i="";Array.prototype.join;const{STORY_BLOCK_TYPE:o}=s(91920),r=s(30381);return i+='\n<div class="story-fragment story-fragment_type_'+(null==(t=e.type.toString().toLowerCase())?"":t)+'" >\n\t',e.type===o.TEXT?(i+='\n\t<div class="story-fragment__header">\n\t\t<span class="story-fragment__relevance '+(null==(t=e.relevance>=80?"story-fragment__relevance_critical":"")?"":t)+'">'+(null==(t=e.relevance)?"":t)+'%</span>\n\t\t<a target="_blank" href="'+(null==(t=e.story_url)?"":t)+'" class="story-fragment__title">'+(null==(t=e.story_title)?"":t)+'</a>\n\t\t<time class="story-fragment__datetime hint" datetime="'+(null==(t=e.story_datetime)?"":t)+'">'+(null==(t=r(e.story_datetime).fromNow())?"":t)+'</time>\n\t</div>\n\t<div class="story-fragment__text">\n\t\t',e.text_before&&(i+='<span class="story-fragment__hidden-text">'+(null==(t=e.text_before)?"":t)+'</span><span class="story-fragment__text-more hint" aria-label="Раскрыть скрытый текст">...</span>'),i+=null==(t=e.text)?"":t,e.text_after&&(i+='<span class="story-fragment__hidden-text">'+(null==(t=e.text_after)?"":t)+'</span><span class="story-fragment__text-more hint" aria-label="Раскрыть скрытый текст">...</span>'),i+="\n\t</div>\n\t"):e.type!==o.IMAGE&&e.type!==o.VIDEO||(i+='\n\t<span class="story-fragment__relevance '+(null==(t=e.relevance>=80?"story-fragment__relevance_critical":"")?"":t)+'">'+(null==(t=e.relevance)?"":t)+'%</span>\n\t<a href="'+(null==(t=e.story_url)?"":t)+'" target="_blank" class="story-fragment__media hint" aria-label="'+(null==(t=e.story_title)?"":t)+'" style="'+(null==(t=e.style)?"":t)+';background-size: cover;">\n\t\t',e.type!==o.VIDEO&&3!==e.img_type||(i+='\n\t\t<div class="story-fragment__play"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--player__play"><use xlink:href="#icon--player__play"></use></svg></div>\n\t\t'),i+="\n\t</a>\n\t"),i+"\n</div>"}(e)),t.find("a").on("click contextmenu",(s=>{const i=[...t[0].parentNode.querySelectorAll(".story-fragment")].indexOf(s.target.closest(".story-fragment"))+1;n.c.getInstance().sendEvent("transition_to_post",{type:"show_duplicates",screen_index:i,rec_score:e.relevance,post_id:e.story_id})})),i&&t.attr("data-is-part","true"),e.is_adult&&t.attr("data-is-adult","true"),t}}},28831:(e,t,s)=>{"use strict";s.d(t,{s6:()=>W,BO:()=>o.storyStyle,lO:()=>f});s(66992),s(33948),s(88674),s(41817);var i=s(12953),o=s(91920),r=s(95411),n=s(88358),a=s(12950),l=s(3668),c=s(23703),d=s(80459),u=s(19359),p=s(62520);class h{constructor(e){this._story=e,this._popup=void 0,this._input=void 0,this._submitButton=void 0,this._isChoicedTag=!1,this.$els={icon:this._story.$main.find(".story__tags-edit:not(.story__tags-edit_mod)")},this.$els.icon.length&&(this._initEditPopup(),this.$els.icon.on("click",(e=>{window.location.pathname.includes("/edits")||(e.preventDefault(),this.$els.icon.addClass("clicked"),this._popup.show(),setTimeout((()=>{this._input.focus()}),100))})),this._submitButton.on("click",this._onSubmitForm.bind(this)))}_initEditPopup(){this._popup=new n._({target:this.$els.icon,showArrow:!0,addOverlay:!1,autoCorrectPosition:!0,direction:n.Lh.TOP}),this._popup.content.html(function(e){var t,s="";return s+'<div class="tags-edit">\n\t<form class="tags-edit_form">\n\t\t<input autocomplete="off" class="tags-edit_input" name="tags" placeholder="Введите тег" />\n\t\t<button class="tags-edit_button button button_success" type="submit">Отправить</button>\n\t</form>\n</div>\n<a class="tags-edit_link" target="_blank" href="/edits/'+(null==(t=e.id)?"":t)+'/tags">Перейти к полному редактированию</a>\n'}({id:this._story.id})),this.$els.submit=this._popup.content.find(".tags-edit_button"),this._submitButton=this.$els.submit.length>0?new d.y(this.$els.submit):null,this._input=new l.u3({$el:this._popup.content.find(".tags-edit_input"),suggestion:new c.Z6({maxHeight:110,tagsLine:!0,parseFilter:e=>!this._story.tagsList.includes(e.name),filter:u.ll.SEARCH})}),this._hotkeys=new r.SV(this._input.$el.find("input")),this._hotkeys.on("cmd+enter",this._onSubmitForm.bind(this),{type:r.FM.KEYDOWN}),this._input.listenTo(this._input,c.nT.SELECT,(e=>{e&&(this._input.value=e.id,this._isChoicedTag=!0)})),this._input.$els.input.on("keypress",(e=>{44===e.charCode&&e.preventDefault()})),this._input.listenTo(this._input,"input",(()=>this._isChoicedTag=!1))}async _onSubmitForm(e){if(e.preventDefault(),i.core.initParams.isDeleted)i.core.ui.authRequired();else{if(!this._isChoicedTag)return i.core.ui.toasts.showError("cedit.editor.form.from-list"),!1;if(!this._submitButton)return!1;try{this._submitButton.disabled=!0;const{response:e}=await a.cf.post("/ajax/cedit_actions.php",{action:"add-tag",sid:this._story.id,tag:this._input.value});if(!e.result)return this._submitButton.disabled=!1,void i.core.ui.toasts.showError(e.message);p.l.getInstance().sendTagAnalytics({event:"tag_edit_propose",proposal:u.a8.ADD.value,tag:this._input.value,story:this._story}),i.core.ui.toasts.add({content:e.result&&e.message?e.message:"cedit.editor.form.saved"}),this._isChoicedTag=!1,this._popup.hide(),this._submitButton.disabled=!1,this._input.value=""}catch(t){this._submitButton.disabled=!1,i.core.ui.toasts.showError(t)}}}}var _=s(42670);function m(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function g(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?m(Object(s),!0).forEach((function(t){v(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):m(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function v(e,t,s){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const f=g(g({},o.storyStyle),{similarIndicator:"story__has-similar-stories",similarBlock:"story__similar-title",similarBlockOpened:"story__similar-title_opened",footer:"story__footer",sharings:"story__share-new",rating:{up:"story__rating-up",down:"story__rating-down",active:"_active",count:"story__rating-count",hidden:"story__bull",animated:"story__rating-count_animated"},tools:{save:"story__save",saveActive:"story__save_active"}});function y(e){var t,s="";return s+='<svg version="1.1" class="vote-anim-svg '+(null==(t=e?"":" vote-anim-svg_down")?"":t)+'" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 86 48" style="enable-background:new 0 0 86.4 48.2;" xml:space="preserve">\n\t<g class="vote-anim-group vote-anim-group_1">\n\t\t<line x1="43.2" y1="5.2" x2="43.2" y2="48.2" class="vote-anim-line"/>\n\t</g>\n\t<g class="vote-anim-group vote-anim-group_2">\n\t\t<line x1="52.2" y1="4.2" x2="66.2" y2="43.2" class="vote-anim-line"/>\n\t</g>\n\t<g class="vote-anim-group vote-anim-group_2">\n\t\t<line x1="59" y1="0.2" x2="86.2" y2="31.2" class="vote-anim-line"/>\n\t</g>\n\t<g class="vote-anim-group vote-anim-group_3">\n\t\t<line x1="34.2" y1="4.2" x2="20.2" y2="43.2" class="vote-anim-line"/>\n\t</g>\n\t<g class="vote-anim-group vote-anim-group_3">\n\t\t<line x1="27.2" y1="0.2" x2="0.2" y2="31.2" class="vote-anim-line"/>\n\t</g>\n</svg>'}var b=s(90312);function w(e){var t,s="";return s+='<div class="popup__content-notification story__subscribe-author-popup">\n    <button data-role="close" class="button_link popup__icon-close"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__close icon--ui__close_popup"><use xlink:href="#icon--ui__close"></use></svg></button>\n    <p class="story__subscribe-author-popup-text">Похоже, вам нравятся посты <a href="/@'+(null==(t=e.authorName)?"":t)+'?subscribe_suggestion" target="_blank">@'+(null==(t=e.authorName)?"":t)+'</a>. Подпишитесь на автора, чтобы не пропустить новые публикации</p>\n    <span data-role="subscribe" data-type="user" data-name="'+(null==(t=e.authorName)?"":t)+'" data-id="'+(null==(t=e.authorId)?"":t)+'" data-analytics-type="subscribe_suggestion">\n    </span>\n</div>'}var k=s(85679),S=s(96637),O=s(63907);const E="pkb_popup_sa";class C{constructor(e){this.story=e,this.show()}show(){const{lastTimeClosed:e,lastTimeShown:t,shownCount:s}=this.getLocalStorageConfig(),o=Date.now();if(null!==e&&o-e<=3*k.mf)return;const r=s>=2;if(null!==t){const e=o-t;if(r&&e<=k.mf||!r&&e<=10*k.g4)return}const n=this.createPopup();n.listenToOnce(n,O.eM.MOUNTED,(()=>setTimeout((()=>{i.core.ui.elementInViewport(n.el)&&(S.LocalStorage.set(E,{lastTimeClosed:null,lastTimeShown:o,shownCount:r?1:s+1}),b.c.getInstance().sendEvent("tip_show",{type:"subscribe_suggest_author"}))})))),n.show()}getLocalStorageConfig(){var e;return null!==(e=S.LocalStorage.get(E))&&void 0!==e?e:{lastTimeClosed:null,lastTimeShown:null,shownCount:0}}saveLastTimeClosed(e){S.LocalStorage.set(E,{lastTimeClosed:e,lastTimeShown:null,shownCount:0})}}class x extends C{createPopup(){const{$ratingUp:e,authorId:t,authorName:s}=this.story,o=new n._({target:e,content:w({authorId:t,authorName:s}),destroyAfterHide:!0,autoCloseOutsideClick:!1,autoCloseIfTargetNotVisible:!0,direction:n.Lh.RIGHT,width:272,distance:-20});return o.zIndex=5001,o.content.find('[data-role="close"]').on("click",(()=>{this.saveLastTimeClosed(Date.now()),o.hide()})),i.core.ui.attachSubscribeButtons(o.content.get(0)),i.core.listenToOnce(i.core,"subscribeEnded",o.hide.bind(o)),o.content.find("a").on("click auxclick",(e=>{(0===e.button||1===e.button)&&o.hide()})),o}}var T=s(27409),I=s(36005),P=s(65035),A=s(36005);var D=s(36005);s(91904);var M=s(90477),R=s(42107),N=s(3436);function B(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function L(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?B(Object(s),!0).forEach((function(t){j(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):B(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function j(e,t,s){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const $=s(19755);class U extends O.u1{constructor(e){super(e),this._initCategoriesListener()}_initCategoriesListener(){this.categories=P.YD.categories,this.listenTo(this.categories,M.u$.CHANGE,(e=>{if(!this._balloon)return;const t=this.$els.catList.find(`[data-role="add_to_cat_btn"][data-id="${e.id}"]`);t.find('[data-role="cat_counter"]').text(e.data.count),t.find('[data-role="cat_name"]').text(e.data.name)})),this.listenTo(this.categories,M.u$.UPDATE,((e,t)=>{var s,i;this._balloon&&((null===(s=t.removed)||void 0===s?void 0:s.length)>0&&t.removed.forEach((e=>{this.$els.catList.find(`[data-role="add_to_cat_btn"][data-id="${e.id}"]`).remove()})),(null===(i=t.inserted)||void 0===i?void 0:i.length)>0&&t.inserted.forEach((e=>{if(this.$els.catList.append(function(e){var t="",s=D.escape;return t+'<div class="story-save__cat" data-id="'+s(e.id)+'" data-name="'+s(e.name)+'" data-role="add_to_cat_btn">\n\t<i class="story-save__check-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__check-mark icon--ui__check-mark_size-medium"><use xlink:href="#icon--ui__check-mark"></use></svg></i>\n\t<span class="story-save__name" data-role="cat_name">'+s(e.name)+'</span>\n\t<a class="story-save__link" target="_blank" href="/saved-stories/'+s(e.id)+'">\n\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__external icon--ui__external_size-medium"><use xlink:href="#icon--ui__external"></use></svg>\n\t</a>\n\t<span class="story-save__count" data-role="cat_counter">'+s(e.count)+"</span>\n</div>\n\n\n"}(e.data)),this.$els.catBlocks=this.$els.catList.find('[data-role="add_to_cat_btn"]'),this._balloon.isShown){const e=this.$els.catList[0].scrollHeight;this.$els.catList.animate({scrollTop:e},400)}})))}))}destroy(){super.destroy(),this._balloon&&(this._balloon.destroy(),this._balloon=null)}async handleSave(e,t,s=U.defaultPopupOptions){this.$el=e,this.story=t,this.popupOptions=s,this._balloon&&this._balloon.isShown&&this._balloon.hide();let i=this.story.isSaved;if(this.story.isSaved||this._saveStory(P.mJ),this._balloon?(this._balloon.target=e,this._balloon.setOptions(this.popupOptions),this.$els.catBlocks.removeClass("story-save__cat_added"),this._balloon.show()):this._createPopup(),this.story.isSaved){if(this.story.isSaved){if("number"!=typeof this.story.savedCat){const e=this._balloon.content.get(0).querySelector(".story-save"),t="story-save_loading";e.classList.add(t),this.story.savedCat=await N.b.getSavedCategoryId(this.story.id),e.classList.remove(t)}"number"==typeof this.story.savedCat&&this._updateList(this.story.savedCat,!0)}R.cp.getInstance().sendEvent("click",L(L({},this.story.analyticsData),{},{button:"save_post",post_id:this.story.id,folder:i?this._savedCategoryName:void 0}))}return Promise.resolve(this._balloon)}_createPopup(){const e=function(e){var t="",s=A.escape;return Array.prototype.join,t+='<div class="story-save story-save_bookmark">\n\t<div class="story-save__cat-list" data-role="cat_list">\n\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__progress-circle icon--ui__progress-circle_loading"><use xlink:href="#icon--ui__progress-circle"></use></svg>\n\t\t',e.items.forEach((i=>{t+='\n\t\t\t<div\n\t\t\t\tclass="story-save__cat '+s(e.savedCategoryId===i.id?"story-save__cat_added":"")+'"\n\t\t\t\tdata-id="'+s(i.id)+'"\n\t\t\t\tdata-name="'+s(i.name)+'"\n\t\t\t\tdata-role="add_to_cat_btn"\n\t\t\t>\n\t\t\t\t<i class="story-save__check-icon"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__check-mark icon--ui__check-mark_size-medium"><use xlink:href="#icon--ui__check-mark"></use></svg></i>\n\t\t\t\t<span class="story-save__name" data-role="cat_name">'+s(i.name)+'</span>\n\t\t\t\t<a class="story-save__link" target="_blank" href="/saved-stories/'+s(i.id)+'">\n\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="icon icon--ui__external icon--ui__external_size-medium"><use xlink:href="#icon--ui__external"></use></svg>\n\t\t\t\t</a>\n\t\t\t\t<span class="story-save__count" data-role="cat_counter">'+s(i.count)+"</span>\n\t\t\t</div>\n\t\t"})),t+='\n\t</div>\n\t<div class="story-save__footer">\n\t\t<div class="input story-save__add-b" data-role="create_new_block">\n\t\t\t\t<span class="input__box">\n\t\t\t\t\t<input class="input__input" maxlength="25" data-role="create_new" placeholder="Новая категория" name="create_new_cat" value="" autocomplete="off">\n\t\t\t\t</span>\n\t\t\t<button class="pkb-normal-btn pkb-normal-btn_small" data-role="add_btn">Создать</button>\n\t\t</div>\n\t\t<button data-role="close" class="pkb-normal-btn">Готово</button>\n\t</div>\n</div>\n\n'}({items:this.categories.items.map((e=>e.data)),isBookmarksExp:!0,savedCategoryId:this.story.savedCat,isLoading:void 0===this.story.savedCat});this._balloon=new n._(L(L({},this.popupOptions),{},{target:this.$el,content:e})),this.$els={},this.$els.block=this._balloon.content,this.$els.catList=this.$els.block.find('[data-role="cat_list"]'),this.$els.catBlocks=this.$els.catList.find('[data-role="add_to_cat_btn"]'),this.$els.addNewCatBtn=this.$els.block.find('[data-role="add_btn"]'),this.$els.block.on("click",'[data-role="add_to_cat_btn"]',(e=>{$(e.target).hasClass("story-save__link")||this._onCategoryClick(e)})),this._addInput=new l.u3({$el:this.$els.block.find('[data-role="create_new_block"]'),addClearButton:!1}),this.listenTo(this._addInput,"input",(()=>{""!==this._addInput.value?this.$els.addNewCatBtn.addClass("story-save__svg-green"):this.$els.addNewCatBtn.removeClass("story-save__svg-green")})),this.$els.block.find('[data-role="create_new_block"]').on("keypress",(e=>{13!==event.which&&13!==event.keyCode||(e.preventDefault(),this._createNewCategory())})),this.$els.addNewCatBtn.on("click",(e=>{e.preventDefault(),this._createNewCategory()})),this.$els.block.find('[data-role="close"]').on("click",(()=>{this._balloon.hide(),R.cp.getInstance().sendEvent("click",L(L({},this.story.analyticsData),{},{component_name:"form_save",button:"save_post_done",folder:this._savedCategoryName}))})),this.listenTo(this._balloon,O.eM.HIDDEN,(()=>{R.cp.getInstance().sendEvent("form_close",L(L({},this.story.analyticsData),{},{component_name:"form_save",type:"save_post",folder:this._savedCategoryName}))})),this._balloon.show()}_onCategoryClick(e){e.preventDefault();const t=$(e.target).closest('[data-role="add_to_cat_btn"]'),s=Number(t.data("id")),i=this.story.savedCat===s;if(i){const e=this._savedCategoryName;this._deleteStory(s),R.cp.getInstance().sendEvent("click",L(L({},this.story.analyticsData),{},{button:"unsave_post",folder:e}))}else this._saveStory(s);this._updateList(i?null:s)}_createNewCategory(){let e=this._addInput;e.value.length&&(P.YD.isCategoryNameAvailable(e.value)?P.YD.add(e.value,{component_name:"form_save"}).then((()=>{e.value=""}),(e=>{i.default.ui.toasts.showError(e||"story-save.message.bad")})):i.default.ui.toasts.showError("story-save.message.cat-duplicate"))}_saveStory(e){var t;const s=null===(t=this.categories.get(e))||void 0===t?void 0:t.data.name;let o=this.story.savedCat;return this.story.savedCat=e,this._setStorySaved(!0),P.YD.addOrRemoveStory(!0,this.story.id,e,s,this.story.analyticsData).catch((e=>{i.default.ui.toasts.showError(e||"story-save.message.bad"),this._setStorySaved("number"==typeof o),this.story.savedCat=o,this._updateList(o)}))}_deleteStory(e){this._setStorySaved(!1);let t=this.story.savedCat;return this.story.savedCat=null,P.YD.addOrRemoveStory(!1,this.story.id,e).catch((e=>{i.default.ui.toasts.showError(e||"story-save.message.bad"),this._setStorySaved("number"==typeof t),this.story.savedCat=t,this._updateList(t)}))}_setStorySaved(e){this.story.isSaved=e,this.emit("story-change",this.story.id,e)}_updateList(e,t=!1){this.$els.catBlocks.removeClass("story-save__cat_added");if("number"==typeof e){const s=this.$els.catList.find(`[data-role="add_to_cat_btn"][data-id="${e}"]`).get(0);if(s.classList.add("story-save__cat_added"),t){const e=s.parentElement;e.scrollTop=s.offsetTop-e.clientHeight/2}}}get _savedCategoryName(){var e;return"number"==typeof this.story.savedCat?null===(e=this.categories.get(this.story.savedCat))||void 0===e?void 0:e.data.name:void 0}}j(U,"defaultPopupOptions",{direction:n.Lh.BOTTOM,alignment:n.SE.CENTER});var F=s(56927),V=s(99942),H=s(65028);function Z(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function z(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(s),!0).forEach((function(t){q(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Z(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function q(e,t,s){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class W extends o.Story{constructor(...e){super(...e),q(this,"_communityMiniProfile",null)}_init(){super._init(),this.classes=f,this._markUpdateImageSrc=!1,T.c.getInstance().setTagsRow(this.$el.get(0)),this._options.isStoryEditable&&new h(this),this._attachTagsCopy(),this._attachContextMenu(),this._initLabelRecommendedAnalytics(),this._initContentShowObserver(),this._initFundraising(),this._communityMiniProfile=new H.W({el:this.el.querySelector(".story__community-link")||void 0})}destroy(){var e;i.core.logger.log("story","destroy"),null===(e=this._communityMiniProfile)||void 0===e||e.destroy(),super.destroy()}_getOptionsFromData(){super._getOptionsFromData();const e=this.el.dataset;this._options.isStoryPage="true"===e.page,this._options.isStoryEditable="true"===e.editable}async _attachContextMenu(){if(this.contextMenuPopup)return;if(this.$dots=this.$el.find("."+f.dots.button),!this.$dots.length)return;const e=this._options.contextActions;"saved-stories"===i.core.initParams.pageName&&e.unshift("unsave_cat"),this.contextMenuPopup=new _.H({$el:this.$dots,items:e,story:this,storyBlock:this.$el,seriesId:this._options.seriesId,seriesStoriesCount:this._options.seriesStoriesCount,onMovedToCommunity:e=>{this.$el.find(`.${f.user.info} > div:last-child`).after(function(e){var t,s="";return s+'<div class="story__community">\n    <span>\n        <a class="story__community-link" data-id="'+(null==(t=e.id)?"":t)+'" href="/community/'+(null==(t=e.link)?"":t)+'">\n            <div class="community-avatar community-avatar_small avatar_small avatar">\n                <span class="avatar__inner">\n                    <img src="'+(null==(t=e.avatar)?"":t)+'">\n                </span>\n            </div>\n            '+(null==(t=e.name)?"":t)+"\n        </a>\n    </span>\n</div>\n"}(e))}})}highlight(e,t,s){e=f.highlight.item+e;let i=this.$main.hasClass(e);return i===(s=(0,I.isBoolean)(s)?s:!i)||(this.$main.toggleClass(e,s).toggleClass(f.highlight.blink,t&&s),t&&(s?this.timeout(e,2e3,(()=>this.$main.removeClass(e+" "+f.highlight.blink))):this.cancelTimeout(e))),this}setCurrentPlayer(){let e=this.$content.find(".player:first-child");e.length>0?i.core.ui.player.currentPlayer=e.eq(0):i.core.ui.player.currentPlayer=""}handleSaveClick(e,t={}){if(b.c.getInstance().yandex.goal("tap-post-save"),b.c.getInstance().google.event("save","post"),!i.core.isUserAuthorized)return void i.core.ui.authRequired({analyticsParams:z({reason:"save_post"},this.analyticsData)});if(i.core.isLostAccount)return void i.core.ui.toasts.showWarningMessage(i.ZF.LOST_ACCOUNT);let s=i.core.ui.storySaver;return s&&!s.isDestroyed||(s=i.core.ui.storySaver=new U),s.handleSave(e,this,t)}_updateCollapsed(e){e?(this.scrollMode&&(this.scrollMode=!1),b.c.getInstance().yandex.goal("story_collapse"),i.core.ui.player.stop(this.$content)):this.setCurrentPlayer(),this.$el.toggleClass(f.collapse,e),this.$collapseButton.toggleClass(f.collapseButton.active,e),this.$socialsButton.toggle(!e),this.$content.toggleClass(f.content.show,!e).toggle(!e)}_attachTagsCopy(){this.$tags.on("copy",(e=>{const t=document.getSelection();if(!t.rangeCount)return;let s="",i=t.getRangeAt(0).cloneContents().children;if(i[0].classList.contains("story__tags_cedit")&&(i=i[0].querySelectorAll(".tags__tag")),i.length>0){for(let e of i)s+=e.textContent+",";e.originalEvent.clipboardData.setData("text/plain",s),e.preventDefault()}}))}_updateCollapsedLongStory(e){let t=this.$readMore;if(!t)return;t.classList.toggle(f.readMore.collapsed,!e);let s=this.contentInner;if(e||(this.$collapseButton.toggleClass(f.collapseButton.active,!1),this._markUpdateImageSrc||(setTimeout((()=>{s.querySelectorAll(V.EB).forEach((e=>{e.classList.contains("carousel__item")&&e.dataset.index>1||F.z.prepareImage(e)}))}),0),this._markUpdateImageSrc=!0)),this.sliceType!==o.STORY_SLICE_TYPE.BY_HEIGHT){if(this.sliceType===o.STORY_SLICE_TYPE.BY_BLOCK){let t=this.el.querySelector("."+f.hiddenBlocksWrapper);if(e){let e,i=document.createDocumentFragment(),o=(0,I.find)(s.childNodes,(e=>e.nodeType===Node.COMMENT_NODE&&e.nodeValue===f.cut));for(;e=o.nextElementSibling;)i.appendChild(e);t||(t=document.createElement("div"),t.classList.add(f.hiddenBlocksWrapper),s.appendChild(t)),t.appendChild(i)}else{let e=document.createDocumentFragment();for(;t.firstChild;)e.appendChild(t.firstChild);t.parentNode.replaceChild(e,t)}}}else s.classList.toggle(f.contentInner.sliceByHeight,e)}_updateRating(){const e=this.vote,t=f,s=e===o.STORY_VOTE.UP,r=e===o.STORY_VOTE.DOWN,n=this.$ratingDown.hasClass(t.rating.down+t.rating.active),a=this.$ratingUp.hasClass(t.rating.up+t.rating.active);this.$ratingUp.toggleClass(t.rating.up+t.rating.active,s),this.$ratingDown.toggleClass(t.rating.down+t.rating.active,r),(s||a)&&(this.$ratingCount.addClass(t.rating.animated),this.timeout("paste",600,(async()=>{this.$ratingCount.removeClass(t.rating.animated)})));const l=Number(this.rating);if((0,I.isNumber)(l)&&!isNaN(l)&&e&&!r){const t=l+e.valueOf();let s;if(t<=0)this.$ratingCount.html('<span class="story__bull"></span>'),s="Пост еще не набрал плюсов";else{if(n)return;this.$ratingCount.text(t),s=`Пост набрал ${t} ${i.core.i18n("plural.pluses",t)}`}this.$ratingPlus.attr("title",s)}}_updateSaved(e){var t;null===(t=this.el.querySelector(`.${f.tools.save}`))||void 0===t||t.classList.toggle(f.tools.saveActive,e)}_createSubscribeAuthorPopup(){return new x(this)}get scrollMode(){return this._options.scrollMode}set scrollMode(e){return(e=Boolean(e))===this.scrollMode?e:(this.isCollapsed||this.$scrollTools.toggleClass(f.scrollTools.enabled,e).toggleClass(f.scrollTools.disabled,!e),this._options.scrollMode=e)}get $collapseButton(){return this._options.$collapseButton||(this._options.$collapseButton=this.$el.find(`.${f.collapseButton.button}`).eq(0)),this._options.$collapseButton}get $scrollTools(){return this._options.$scrollTools||(this._options.$scrollTools=this.$el.find(`.${f.scrollTools.item}`).eq(0)),this._options.$scrollTools}get $content(){return this._options.$content||(this._options.$content=this.$el.find(`.${f.content.item}`).eq(0)),this._options.$content}get $tags(){return this._options.$tags||(this._options.$tags=this.$el.find(`.${f.tags.wrapper}`).eq(0)),this._options.$tags}get $socialsButton(){return this._options.$socialsButton||(this._options.$socialsButton=this.$el.find(`.${f.sharings}`).eq(0)),this._options.$socialsButton}get $main(){return this._options.$main||(this._options.$main=this.$el.find(`.${f.main}`).eq(0)),this._options.$main}get titleLink(){let e=this.el.querySelector(`.${f.title.link}`);return e?e.getAttribute("href"):""}get $ratingPlus(){return this._options.$ratingPlus||(this._options.$ratingPlus=this.$el.find(".story__rating-plus").eq(0)),this._options.$ratingPlus}get $ratingUp(){return this._options.$ratingUp||(this._options.$ratingUp=this.$el.find(`.${f.rating.up}`).eq(0),this._options.$ratingUp.append(y(!0))),this._options.$ratingUp}get $ratingDown(){return this._options.$ratingDown||(this._options.$ratingDown=this.$el.find(`.${f.rating.down}`).eq(0),this._options.$ratingDown.append(y(!1))),this._options.$ratingDown}get $ratingCount(){return this._options.$ratingCount||(this._options.$ratingCount=this.$el.find(`.${f.rating.count}`).eq(0)),this._options.$ratingCount}get $hiddenRating(){return this._options.$hiddenRating||(this._options.$hiddenRating=this.$el.find(`.${f.rating.hidden}`).eq(0)),this._options.$hiddenRating}get $viewedCount(){return this._options.$viewedCount||(this._options.$viewedCount=this.$el.find(`.${f.viewed.count}`).eq(0)),this._options.$viewedCount}}},63331:(e,t,s)=>{"use strict";s.d(t,{Z:()=>k});s(88674),s(41817);var i=s(12953),o=s(44361),r=s(88358),n=s(96637),a=s(33662),l=s(47442);var c=s(90312),d=s(36005),u=s(82800),p=s(41779),h=s(62895),_=s(63907),m=s(72283),g=s(15112);function v(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function f(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?v(Object(s),!0).forEach((function(t){y(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):v(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function y(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const b=s(19755);let w;class k extends r.gR{constructor(e){super(e),this.showArrow=!1,this._tagVal=e.tag,this._actionCallback=()=>{},(0,d.isFunction)(e.actionCallback)&&(this._actionCallback=e.actionCallback)}render(){return this.isRendered||(this.target.$target.length&&this.updateContent(),super.render()),this}async updateContent(){var e;let t=this._tagVal||String(this.target.$target.data("tag")),i=await o.zG.getListSubsIgnore(!0),r=i.subs.map((e=>e.toLowerCase())).includes(t.toLowerCase()),n=i.ignore.map((e=>e.toLowerCase())).includes(t.toLowerCase()),a=b(function(e){var t,i="";Array.prototype.join;const o=s(12953).core;return i+='\n\n<div class="tag-hint menu menu_vertical menu_padding_none">\n\t',e.subscribed?i+='\n\t\t<div class="menu__item" data-action="unsubscribe">Отписаться</div>\n\t':i+='\n\t\t<div class="menu__item" data-action="subscribe">Подписаться</div>\n\t',i+="\n\n\t",e.canIgnore&&(i+="\n\t\t",e.ignored?i+='\n\t\t\t<div class="menu__item" data-action="unignore">'+(null==(t=o.i18n("ignore.tags.UNIGNORE"))?"":t)+"</div>\n\t\t":i+='\n\t\t\t<div class="menu__item" data-action="quickIgnore" data-event="mouseenter">'+(null==(t=o.i18n("ignore.tags.IGNORE"))?"":t)+"</div>\n\t\t",i+="\n\t"),i+"\n</div>\n"}({subscribed:r,ignored:n,canIgnore:-1===t.indexOf(o.Gm)}));a.find(".menu__item").each(((e,s)=>{const i=s.dataset.event||"click";s.addEventListener(i,(()=>{let e=s.dataset.action;this._handleAction(t,e,s)}))})),this.content=a,this.updateWidth(),this.updatePosition(),null===(e=m.o.postRunAction)||void 0===e||e.call(m.o)}_showQuickIgnore(e,t){var s,i,o;if(!this.quickIgnoreBalloon||this.quickIgnoreBalloon.isDestroyed)return this.quickIgnoreBalloon=new r._({target:t,content:(0,p.Z)(),direction:u.Lh.RIGHT,alignment:u.SE.CENTER,destroyAfterHide:!0}),this.quickIgnoreBalloon.show(),new h.B({$el:this.quickIgnoreBalloon.$els.content,mode:"tags",item:e,storyId:Number(null===(s=this.target)||void 0===s||null===(i=s.target)||void 0===i||null===(o=i.closest(".story"))||void 0===o?void 0:o.dataset.storyId),popup:this.quickIgnoreBalloon,parentPopup:this}),this.addMouseTarget(this.quickIgnoreBalloon.$el),new Promise((e=>{this.quickIgnoreBalloon.on(_.eM.HIDDEN,e)}))}async _handleAction(e,t,s){if("quickIgnore"!==t&&this.hide(),this.emit("select"),!i.core.isUserAuthorized&&"quickIgnore"!==t){let s=null;return"subscribe"===t&&(s={action:"subscribe_tag",data:{value:!0,tag:e,analyticsParams:this.analyticsParams}}),i.core.ui.authRequired({analyticsParams:f({reason:"subscribe"===t?"follow":"ignore",tag:e},this.analyticsParams),triggeredAction:s}),"subscribe"===t&&c.c.getInstance().sendEvent("click",f({type:"subscribe_tag",tag:e},this.analyticsParams)),void this._actionCallback()}try{switch(t){case"subscribe":this._isSearchPage()&&c.c.getInstance().yandex.goal("subscribe-tag_context"),await o.zG.subscribe(e,!0,this.analyticsParams),this._switchButtons(e,!0,"subscribe");break;case"unsubscribe":await o.zG.subscribe(e,!1,this.analyticsParams),this._switchButtons(e,!1);break;case"quickIgnore":return await this._showQuickIgnore(e,s),void this._actionCallback();case"unignore":let t=await a.jj.getTagIgnore(e);t.total&&await a.jj.removeRule(t.rules[0].id),this._switchButtons(e,!1,"ignore")}}catch(r){return void this.actionError(r)}this.actionSuccess(t)}_switchButtons(e,t,s="subscribe"){try{(0,g.S)()[s].tag[e]=t}catch(i){}}_isSearchPage(){const{pathname:e}=i.core.history;return-1!==e.indexOf("/tag/")||-1!==e.indexOf("/search")}async actionSuccess(e){let t=this.toast;switch(t.isShown&&(t.hide(),await n.Utils.delay(200)),e){case"ignore":case"unignore":t.content=i.core.i18n("ignore.messages.success");break;default:t.content=i.core.i18n(`stories-search.tags.${e}`)}t.show(),this._actionCallback()}async actionError(e){let t=this.toast;t.isShown&&(t.hide(),await n.Utils.delay(200)),t.content=e.message||e,t.theme=l.K.DANGER,t.show(),this._actionCallback()}get toast(){return w||(w=new l.O({destroyAfterHide:!1})),w}get analyticsParams(){const e=this.target.$target;if(!e.length)return{};const t={type:e.data("analyticsType")||""},s=e.closest(".story");return s.length&&s.data("ext-feed")&&(t.component_name="extension",t.screen=s.data("ext-feed")),t}}},94217:(e,t,s)=>{"use strict";s.d(t,{E:()=>a});s(85827),s(66992),s(33948);var i=s(13218),o=s.n(i),r=s(68929),n=s.n(r);function a(e){if(!o()(e))throw new Error("target must be an object");return Object.entries(e).reduce(((e,[t,s])=>(e[n()(t)]=s,e)),{})}},92934:(e,t,s)=>{"use strict";function i(e,t,s){let i;const o=function(t,s){i=void 0,s&&e.apply(t,s)},r=function(...r){if(i&&clearTimeout(i),s){const s=!i;i=setTimeout(o,t),s&&e.apply(this,r)}else i=setTimeout(o,t,this,r)};return r.cancel=function(){i&&(clearTimeout(i),i=void 0)},r.runImmediately=function(...e){var t,s;null===(t=r.cancel)||void 0===t||t.call(this),null===(s=r.runImmediately)||void 0===s||s.call(this,e)},r}s.d(t,{D:()=>i})},33877:(e,t,s)=>{"use strict";s.d(t,{g:()=>i});s(88674);function i(e,t){return e<=0?t:new Promise((s=>setTimeout(s,e,t)))}},76137:(e,t,s)=>{"use strict";s.d(t,{f:()=>i});s(74916),s(15306);function i(e){return e.replace(/[$()*+.?[\\\]^{|}]/g,"\\$&").replace(/-/g,"\\x2d")}},58749:(e,t,s)=>{"use strict";s.d(t,{x:()=>i});s(66992),s(33948);function i(e){if(null===e)return!0;if(function(e){const t=null!=e&&"function"!=typeof e&&e.length;return"number"==typeof t&&t>=0}(e)&&(Array.isArray(e)||"string"==typeof e))return 0===e.length;if(e instanceof Map||e instanceof Set)return!e.size;for(const t in e)if(Object.hasOwnProperty.call(e,t))return!1;return!0}},63748:(e,t,s)=>{"use strict";function i(e){const t=typeof e;return null!==e&&("object"===t||"function"===t)}s.d(t,{K:()=>i})},26216:(e,t,s)=>{"use strict";function i(e,t){const s=e.length,i=t.length;if(s<i)return!1;let o=i-1,r=s-1;for(;o>=0;){if(e[r]!==t[o])return!1;o--,r--}return!0}s.d(t,{C:()=>i})},10414:(e,t,s)=>{"use strict";s.d(t,{I:()=>i});s(66992),s(33948);function i(e){let t,s=!1;return(...i)=>s?t:(s=!0,t=e(...i))}},26639:(e,t,s)=>{"use strict";s.d(t,{W:()=>i});s(88674);function i(){return new Promise((e=>{requestAnimationFrame((()=>e()))}))}},51540:(e,t,s)=>{"use strict";function i(e,t,{leading:s=!0,trailing:i=!0}={leading:!0,trailing:!0}){let o,r,n,a=0;const l=function(){a=s?Date.now():0,o=void 0,e.apply(r,n),o||(r=n=void 0)},c=function(...c){const d=Date.now();a||s||(a=d);const u=t-(d-a);r=this,n=c,u<=0||u>t?(o&&(clearTimeout(o),o=void 0),a=d,e.apply(r,c),o||(r=n=void 0)):!o&&i&&(o=setTimeout(l,u))};return c.cancel=function(){o&&(clearTimeout(o),a=0,o=r=n=void 0)},c}s.d(t,{P:()=>i})},65704:(e,t,s)=>{"use strict";s.d(t,{E:()=>o});s(66992),s(33948);const i=new Map;function o(e="$pikabu"){const t=i.has(e)?(i.get(e)||0)+1:0;return i.set(e,t),"$pikabu"===e?`${t}`:`${e+t}`}},83257:(e,t,s)=>{"use strict";s.d(t,{Pf:()=>l,Ih:()=>u,RB:()=>d});s(88674),s(66992),s(33948),s(74916);var i=s(33877),o=s(26639),r=s(70017);const n="tvkuid",a=["pub300x250","pub300x250m","pub728x90","text-ad","textAd","textad","textads","text-ads","text-ad-links","sidebar-block_placeholder"],l=(e=>{let t=null;return()=>{if(t)return t;let s,i;return t=new Promise(((e,t)=>{s=e,i=t})),e().then((e=>(s(e),e))).catch((e=>{throw i(e),e}))}})((async()=>{const e=document.createElement("div");e.classList.add(...a),e.setAttribute("style","width:1px!important;height:1px!important;position:absolute!important;left:-10000px!important;top:-1000px!important;"),document.body.append(e),await(0,o.W)();let t=3,s=!1;do{if(s=c(e),s||!t)break;await(0,i.g)(1e3)}while(t--);return e.remove(),s}));function c(e){if(null===e.offsetParent||0===e.offsetHeight||0===e.offsetLeft||0===e.offsetTop||0===e.offsetWidth||0===e.clientHeight||0===e.clientWidth)return!0;const t=window.getComputedStyle(e,null);return"none"===t.display||"hidden"===t.visibility}function d(e){var t;const s=null===(t=String(window.location.hostname).match(/pikabu\.[a-z]+/i))||void 0===t?void 0:t[0],i=String.fromCharCode(65+~~((new Date).getMinutes()/5));0===(null==s?void 0:s.indexOf("pikabu"))&&(r.e.remove(n),r.e.set(n,i+(e?"1":"0"),{expires:1,domain:"."+s}))}function u(){const e=r.e.get(n);return!!e&&Boolean(parseInt(e.substring(1,2)))}},34608:(e,t,s)=>{"use strict";s.d(t,{Ih:()=>i.Ih,Pf:()=>i.Pf,RB:()=>i.RB});var i=s(83257)},68505:(e,t,s)=>{"use strict";s.d(t,{m:()=>r});s(66992),s(33948),s(41817);var i=s(2439);function o(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function r(e,t,s){const o=a.getInstance(s),r="el"in e?e.el:e;return r instanceof HTMLElement?(o.observe(r,t),function(e,t){return e instanceof i.v&&e.once("_destroy",t),t}(r,(()=>o.unobserve(r,t)))):()=>{}}const n={root:null,rootMargin:void 0,threshold:void 0};class a{static getInstance(e=n){const t=a.instanceMap.get(e);if(t)return t;const s=new a(e);return a.instanceMap.set(e,s),s}constructor(e){o(this,"list",new WeakMap),o(this,"counter",0),o(this,"handlerChanged",(e=>{e.forEach((e=>{const t=this.list.get(e.target);t?e.target.isConnected&&t.forEach((t=>{!1===t.call(e,e)&&this.unobserve(e.target,t)})):this.observer.unobserve(e.target)}))})),this.options=e,this.observer=new IntersectionObserver(this.handlerChanged,e)}destroy(){this.observer.disconnect(),a.instanceMap.delete(this.options)}observe(e,t){const s=this.list.get(e)||new Set;s.add(t),this.list.set(e,s),this.observer.observe(e),this.counter++}unobserve(e,t){const s=this.list.get(e);s&&(s.delete(t),s.size||this.list.delete(e)),this.observer.unobserve(e),--this.counter<=0&&this.destroy()}}o(a,"instanceMap",new WeakMap)},90312:(e,t,s)=>{"use strict";s.d(t,{c:()=>G});s(74916),s(15306),s(41817);var i=s(12953);class o{constructor(e){this.counterId=e}goal(e,t){i.core.logger.log("YMetrika","Reach goal",t);try{if(void 0===t||0===Object.keys(t).length)return void ym(this.counterId,"reachGoal",e);ym(this.counterId,"reachGoal",e,t)}catch(s){i.core.logger.error("YMetrika",s)}}hit(e){const t=void 0===e?location.href:e;i.core.logger.log("YMetrika","Hit",t);try{ym(this.counterId,"hit",t)}catch(s){i.core.logger.error("YMetrika",s)}}}class r{pageView(){i.core.logger.log("GAnalytics","Page view");try{gtag("event","page_view")}catch(e){i.core.logger.error("GAnalytics",e)}}event(e,t,s,i){const o={};void 0!==t&&(o.event_category=t),void 0!==s&&(o.event_label=s),void 0!==i&&(o.value=i),this.action(e,o)}action(e,t){i.core.logger.log("GAnalytics","Action",t);try{gtag("event",e,t)}catch(s){i.core.logger.log("GAnalytics",s)}}}s(66992),s(33948),s(88674);var n=s(55151),a=s(53056);let l,c;!function(e){e[e.create_at=1]="create_at",e[e.user_id=2]="user_id",e[e.app_version=3]="app_version",e[e.platform=4]="platform",e[e.post_id=5]="post_id",e[e.author_id=6]="author_id",e[e.comment_id=7]="comment_id",e[e.tag_id=8]="tag_id",e[e.screen=9]="screen",e[e.type=10]="type",e[e.is_authorised=11]="is_authorised",e[e.device_id=12]="device_id",e[e.gaid=13]="gaid",e[e.idfa=14]="idfa",e[e.source=15]="source",e[e.is_promo=16]="is_promo",e[e.pluses=17]="pluses",e[e.minuses=18]="minuses",e[e.tags=19]="tags",e[e.comments=20]="comments",e[e.is_full=21]="is_full",e[e.is_picture=22]="is_picture",e[e.is_video=23]="is_video",e[e.is_gif=24]="is_gif",e[e.search_input=25]="search_input",e[e.data_start=26]="data_start",e[e.data_end=27]="data_end",e[e.is_random_data=28]="is_random_data",e[e.screen_referer=31]="screen_referer",e[e.comment_author_id=32]="comment_author_id",e[e.community_id=33]="community_id",e[e.content_type=34]="content_type",e[e.draft_id=35]="draft_id",e[e.duplicates_count=36]="duplicates_count",e[e.duplicates_id=37]="duplicates_id",e[e.duplicates_probability=38]="duplicates_probability",e[e.email=39]="email",e[e.filter_type=40]="filter_type",e[e.ignore_type=41]="ignore_type",e[e.ip=42]="ip",e[e.login=43]="login",e[e.phone=44]="phone",e[e.post_link=45]="post_link",e[e.promo_id=46]="promo_id",e[e.rating=47]="rating",e[e.screen_index=48]="screen_index",e[e.session_id=49]="session_id",e[e.settings_type=50]="settings_type",e[e.social_network=51]="social_network",e[e.transition_source=52]="transition_source",e[e.transition_type=53]="transition_type",e[e.user_rate=54]="user_rate",e[e.search_filter=55]="search_filter",e[e.url=56]="url",e[e.url_params=57]="url_params",e[e.session_ts=58]="session_ts",e[e.tags_mask=59]="tags_mask",e[e.view_time=60]="view_time",e[e.view_ratio=61]="view_ratio",e[e.show_full_post=62]="show_full_post",e[e.rec_score=63]="rec_score",e[e.rec_algorithm=64]="rec_algorithm",e[e.position=65]="position",e[e.link=66]="link",e[e.reason=67]="reason",e[e.tag_from=68]="tag_from",e[e.tag_to=69]="tag_to",e[e.proposal=70]="proposal",e[e.value_old=71]="value_old",e[e.value_new=72]="value_new",e[e.level=73]="level",e[e.list=74]="list",e[e.folder=75]="folder",e[e.length=76]="length",e[e.time_old=77]="time_old",e[e.time_new=78]="time_new",e[e.folder_id=79]="folder_id",e[e.status=80]="status",e[e.partner_id=81]="partner_id",e[e.posts=82]="posts",e[e.subscribers=83]="subscribers",e[e.hide_visited=84]="hide_visited",e[e.nsfw=85]="nsfw",e[e.adblock=86]="adblock",e[e.cookie=87]="cookie",e[e.js=88]="js",e[e.image_id=89]="image_id",e[e.size=90]="size",e[e.list_f32=91]="list_f32",e[e.type_i8=92]="type_i8",e[e.post_donation=93]="post_donation",e[e.color_theme=94]="color_theme",e[e.site_color=95]="site_color",e[e.tag=96]="tag",e[e.score=97]="score",e[e.screen_community_name=98]="screen_community_name",e[e.screen_user_name=99]="screen_user_name",e[e.screen_user=100]="screen_user",e[e.screen_community=101]="screen_community",e[e.screen_tag=102]="screen_tag",e[e.scheduled_date=103]="scheduled_date",e[e.screen_search=104]="screen_search",e[e.search_filters_list=105]="search_filters_list",e[e.no_tags=106]="no_tags",e[e.category_id=107]="category_id",e[e.sound_on=108]="sound_on",e[e.sound_volume=109]="sound_volume",e[e.button=110]="button",e[e.menu_item=111]="menu_item",e[e.mode=112]="mode",e[e.component_name=113]="component_name",e[e.amp_exp_params=114]="amp_exp_params",e[e.time=115]="time",e[e.start_up_time=120]="start_up_time",e[e.ad_params=121]="ad_params",e[e.settings=122]="settings",e[e.bell=123]="bell",e[e.subs=124]="subs",e[e.anl=125]="anl",e[e.post_series_id=126]="post_series_id",e[e.button_name=127]="button_name",e[e.fp_key=128]="fp_key",e[e.item_index=129]="item_index",e[e.google_id=130]="google_id",e[e.tab_name=131]="tab_name",e[e.feeds=132]="feeds",e[e.repeated=133]="repeated",e[e.event_num=134]="event_num",e[e.page_ts=135]="page_ts",e[e.item_id=136]="item_id",e[e.currency=137]="currency",e[e.fp_key2=138]="fp_key2",e[e.launch=139]="launch",e[e.action_bar=140]="action_bar",e[e.target=141]="target",e[e.anonim=150]="anonim",e[e.lite_page=151]="lite_page",e[e.start_date=153]="start_date",e[e.end_date=154]="end_date",e[e.shows=155]="shows",e[e.org_type=156]="org_type",e[e.name=157]="name",e[e.sorting_by=158]="sorting_by",e[e.anonymous=159]="anonymous",e[e.is_mark=160]="is_mark",e[e.comment_type=161]="comment_type",e[e.upload_type=162]="upload_type"}(l||(l={})),function(e){e[e.start_session=1]="start_session",e[e.authorization=2]="authorization",e[e.transition_to_tab=3]="transition_to_tab",e[e.show_post=4]="show_post",e[e.rate_content=5]="rate_content",e[e.transition_to_post=6]="transition_to_post",e[e.show_comment=7]="show_comment",e[e.leave_comment=8]="leave_comment",e[e.show_ad=9]="show_ad",e[e.click_ad=10]="click_ad",e[e.click_post_link=11]="click_post_link",e[e.click_registration=12]="click_registration",e[e.create_account=13]="create_account",e[e.approve_phone=14]="approve_phone",e[e.click_create_post=15]="click_create_post",e[e.save_draft_post=16]="save_draft_post",e[e.delete_draft_post=17]="delete_draft_post",e[e.publish_post=18]="publish_post",e[e.click_show_full_post=19]="click_show_full_post",e[e.click_show_comments=20]="click_show_comments",e[e.click_show_comments_thread=21]="click_show_comments_thread",e[e.search=22]="search",e[e.filter=23]="filter",e[e.transition_to_tag=24]="transition_to_tag",e[e.transition_to_author=25]="transition_to_author",e[e.transition_to_community=26]="transition_to_community",e[e.subscribe_to_author=27]="subscribe_to_author",e[e.subscribe_to_community=28]="subscribe_to_community",e[e.subscribe_to_tag=29]="subscribe_to_tag",e[e.save_post=30]="save_post",e[e.create_login=31]="create_login",e[e.create_email=32]="create_email",e[e.create_phone=33]="create_phone",e[e.create_password=34]="create_password",e[e.add_text=35]="add_text",e[e.add_picture=36]="add_picture",e[e.add_video=37]="add_video",e[e.add_tag=38]="add_tag",e[e.mark_mine=39]="mark_mine",e[e.mark_nsfw=40]="mark_nsfw",e[e.mark_public_for_community=41]="mark_public_for_community",e[e.show_duplicates=42]="show_duplicates",e[e.post_preview=43]="post_preview",e[e.change_viewed_posts_settings=44]="change_viewed_posts_settings",e[e.add_to_ignore_list=45]="add_to_ignore_list",e[e.share_to_social_network=46]="share_to_social_network",e[e.show_post_2s=47]="show_post_2s",e[e.recommended_community_interaction=48]="recommended_community_interaction",e[e.comment_view=49]="comment_view",e[e.post_donation=50]="post_donation",e[e.author_sponsorship_start=51]="author_sponsorship_start",e[e.author_sponsorship_stop=52]="author_sponsorship_stop",e[e.author_sponsorship_amount_change=53]="author_sponsorship_amount_change",e[e.page_load=54]="page_load",e[e.open_app_link=55]="open_app_link",e[e.tooltip_popup=56]="tooltip_popup",e[e.subscribe_email=57]="subscribe_email",e[e.click_external_link=58]="click_external_link",e[e.tip_show=59]="tip_show",e[e.tip_close=60]="tip_close",e[e.tip_link_click=61]="tip_link_click",e[e.hotkey_use=62]="hotkey_use",e[e.report_send=63]="report_send",e[e.tags_merge_propose=64]="tags_merge_propose",e[e.tag_edit_propose=65]="tag_edit_propose",e[e.tag_edit_vote=66]="tag_edit_vote",e[e.user_note_add=67]="user_note_add",e[e.user_note_edit=68]="user_note_edit",e[e.user_setting_change=69]="user_setting_change",e[e.comment_branch_show=70]="comment_branch_show",e[e.comment_branch_collapse=71]="comment_branch_collapse",e[e.reach_element=72]="reach_element",e[e.app_enter=73]="app_enter",e[e.app_exit=74]="app_exit",e[e.show_comments=75]="show_comments",e[e.click=76]="click",e[e.log_out=77]="log_out",e[e.reaction_add_post=78]="reaction_add_post",e[e.reaction_remove_post=79]="reaction_remove_post",e[e.save_category_create=80]="save_category_create",e[e.post_batch_load=81]="post_batch_load",e[e.video_play=82]="video_play",e[e.video_pause=83]="video_pause",e[e.video_fullscreen=84]="video_fullscreen",e[e.video_timeline_click=85]="video_timeline_click",e[e.send_company_feedback=86]="send_company_feedback",e[e.show_company_feedback_link=87]="show_company_feedback_link",e[e.company_comment_pin=88]="company_comment_pin",e[e.error_occurred=89]="error_occurred",e[e.author_donation=90]="author_donation",e[e.top_hot_click=91]="top_hot_click",e[e.reg_notification_click=93]="reg_notification_click",e[e.user_params=94]="user_params",e[e.image_view=95]="image_view",e[e.registration_code_request=96]="registration_code_request",e[e.captcha_manual_show=97]="captcha_manual_show",e[e.captcha_manual_pass=98]="captcha_manual_pass",e[e.captcha_pass_auto=99]="captcha_pass_auto",e[e.input_start=100]="input_start",e[e.permission_request=101]="permission_request",e[e.permission_approve=102]="permission_approve",e[e.permission_deny=103]="permission_deny",e[e.form_show=104]="form_show",e[e.form_interact=105]="form_interact",e[e.form_rate=106]="form_rate",e[e.subscribe_to_notification=107]="subscribe_to_notification",e[e.unsubscribe_from_notification=108]="unsubscribe_from_notification",e[e.unsubscribe=109]="unsubscribe",e[e.save_comment=110]="save_comment",e[e.post_profile_hide=111]="post_profile_hide",e[e.post_profile_unhide=112]="post_profile_unhide",e[e.simplified_account_confirmation=113]="simplified_account_confirmation",e[e.show_post_lite=114]="show_post_lite",e[e.draft_post_choose=115]="draft_post_choose",e[e.mark_scheduled=120]="mark_scheduled",e[e.posting_schedule=121]="posting_schedule",e[e.comment_branch_hide=122]="comment_branch_hide",e[e.comment_branch_unhide=123]="comment_branch_unhide",e[e.error_occured=124]="error_occured",e[e.click_authorization=125]="click_authorization",e[e.sound_change=126]="sound_change",e[e.content_viewed=127]="content_viewed",e[e.feed_element_showed=129]="feed_element_showed",e[e.feed_element_viewed=130]="feed_element_viewed",e[e.mark=128]="mark",e[e.editor_time=131]="editor_time",e[e.post_series_create=135]="post_series_create",e[e.post_series_delete=136]="post_series_delete",e[e.mark_post_series=137]="mark_post_series",e[e.post_series_add_post=138]="post_series_add_post",e[e.transition_to_post_series=139]="transition_to_post_series",e[e.post_series_delete_post=140]="post_series_delete_post",e[e.form_close=141]="form_close",e[e.form_init=142]="form_init",e[e.scroll_start=143]="scroll_start",e[e.content_showed=144]="content_showed",e[e.page_close=145]="page_close",e[e.account_created=146]="account_created",e[e.approve_account=147]="approve_account",e[e.seen_before_menu_item_tapped=149]="seen_before_menu_item_tapped",e[e.seen_before_button_tapped=150]="seen_before_button_tapped",e[e.seen_before_approved=151]="seen_before_approved",e[e.interest_checked=152]="interest_checked",e[e.interests_approve_button_tapped=153]="interests_approve_button_tapped",e[e.unsave_comment=154]="unsave_comment",e[e.ad_request=156]="ad_request",e[e.gallery_open=157]="gallery_open",e[e.gallery_transition=158]="gallery_transition",e[e.video_feed_opened=159]="video_feed_opened",e[e.video_feed_closed=160]="video_feed_closed",e[e.video_feed_next_moved=161]="video_feed_next_moved",e[e.video_feed_previous_moved=162]="video_feed_previous_moved",e[e.comments_button_tapped=163]="comments_button_tapped",e[e.comments_more_button_tapped=164]="comments_more_button_tapped",e[e.share_button_tapped=165]="share_button_tapped",e[e.compilations_showed=166]="compilations_showed",e[e.compilation_tapped=167]="compilation_tapped",e[e.tile_showed=168]="tile_showed",e[e.popup_show=169]="popup_show",e[e.popup_close=170]="popup_close",e[e.switch_tab=171]="switch_tab",e[e.animation_played=172]="animation_played",e[e.create_code=173]="create_code",e[e.banner_showed=174]="banner_showed",e[e.banner_closed=175]="banner_closed",e[e.topic_tapped=177]="topic_tapped",e[e.menu_opened=178]="menu_opened",e[e.ignore_popup_button_tapped=184]="ignore_popup_button_tapped",e[e.less_similar_content_requested=185]="less_similar_content_requested",e[e.signin_button_tapped=193]="signin_button_tapped",e[e.get_app_button_tapped=194]="get_app_button_tapped",e[e.settings_tab_opened=197]="settings_tab_opened",e[e.interest_liked=198]="interest_liked",e[e.interest_disliked=199]="interest_disliked",e[e.interest_rating_canceled=200]="interest_rating_canceled",e[e.birthdate_approve_button_tapped=201]="birthdate_approve_button_tapped",e[e.video_feed_tutorial_showed=202]="video_feed_tutorial_showed",e[e.interests_popup_showed=203]="interests_popup_showed",e[e.interests_popup_closed=204]="interests_popup_closed",e[e.content_nps_survey_confirmed=205]="content_nps_survey_confirmed",e[e.content_nps_survey_tapped=206]="content_nps_survey_tapped",e[e.content_nps_survey_showed=207]="content_nps_survey_showed",e[e.nsfw_activation_approve_button_tapped=208]="nsfw_activation_approve_button_tapped",e[e.nsfw_activation_cancel_button_tapped=209]="nsfw_activation_cancel_button_tapped",e[e.nsfw_activation_ok_button_tapped=210]="nsfw_activation_ok_button_tapped",e[e.survey_vote_added=211]="survey_vote_added",e[e.followers_button_tapped=212]="followers_button_tapped",e[e.following_button_tapped=213]="following_button_tapped",e[e.editors_choice_feed_showed=214]="editors_choice_feed_showed",e[e.show_more_editors_choice_tapped=215]="show_more_editors_choice_tapped",e[e.next_post_editors_choice_moved=216]="next_post_editors_choice_moved",e[e.prev_post_editors_choice_moved=217]="prev_post_editors_choice_moved",e[e.vacancies_button_tapped=218]="vacancies_button_tapped",e[e.sorting_comments_button_tapped=219]="sorting_comments_button_tapped",e[e.author_support_popup_showed=220]="author_support_popup_showed",e[e.author_support_popup_closed=221]="author_support_popup_closed",e[e.go_to_pay_button_tapped=222]="go_to_pay_button_tapped",e[e.paid_author_subscription_button_tapped=223]="paid_author_subscription_button_tapped",e[e.paid_author_subscription_cancel_approve_button_tapped=224]="paid_author_subscription_cancel_approve_button_tapped",e[e.go_to_cloudtips_button_tapped=225]="go_to_cloudtips_button_tapped",e[e.author_donation_enable_button_tapped=226]="author_donation_enable_button_tapped",e[e.paid_author_subscription_form_showed=227]="paid_author_subscription_form_showed",e[e.paid_author_subscription_create_button_tapped=228]="paid_author_subscription_create_button_tapped",e[e.paid_author_subscription_delete_approve_button_tapped=229]="paid_author_subscription_delete_approve_button_tapped",e[e.author_donation_button_tapped=230]="author_donation_button_tapped",e[e.pin_post_button_tapped=239]="pin_post_button_tapped",e[e.unpin_post_button_tapped=240]="unpin_post_button_tapped",e[e.add_caption_under_image=241]="add_caption_under_image",e[e.delete_all_drafts_button_tapped=242]="delete_all_drafts_button_tapped",e[e.delete_all_drafts_cancel_button_tapped=243]="delete_all_drafts_cancel_button_tapped",e[e.delete_draft_approve_button_tapped=244]="delete_draft_approve_button_tapped",e[e.delete_draft_cancel_button_tapped=245]="delete_draft_cancel_button_tapped",e[e.delete_all_drafts_approve_button_tapped=246]="delete_all_drafts_approve_button_tapped",e[e.add_image_carousel=247]="add_image_carousel",e[e.more_compilations_button_tapped=248]="more_compilations_button_tapped",e[e.compilation_next_button_tapped=249]="compilation_next_button_tapped",e[e.compilation_back_buttton_tapped=250]="compilation_back_buttton_tapped",e[e.compilation_show_all_button_tapped=251]="compilation_show_all_button_tapped",e[e.reply_comment_button_tapped=252]="reply_comment_button_tapped",e[e.reply_comment_cancel_button_tapped=253]="reply_comment_cancel_button_tapped",e[e.back_to_explore_button_tapped=254]="back_to_explore_button_tapped",e[e.community_donation_button_tapped=255]="community_donation_button_tapped",e[e.community_donation_form_showed=256]="community_donation_form_showed",e[e.content_liked=257]="content_liked",e[e.content_disliked=258]="content_disliked",e[e.content_rating_canceled=259]="content_rating_canceled",e[e.comment_liked=260]="comment_liked",e[e.comment_disliked=261]="comment_disliked",e[e.comment_rating_canceled=262]="comment_rating_canceled",e[e.content_shared=263]="content_shared",e[e.comment_shared=264]="comment_shared",e[e.content_share_button_tapped=265]="content_share_button_tapped",e[e.content_copy_link_button_tapped=266]="content_copy_link_button_tapped",e[e.comment_share_button_tapped=267]="comment_share_button_tapped",e[e.comment_copy_link_button_tapped=268]="comment_copy_link_button_tapped",e[e.specials_banner_tapped=269]="specials_banner_tapped",e[e.comment_pinned=270]="comment_pinned",e[e.comment_unpinned=271]="comment_unpinned",e[e.adblock_breaker_info_showed=272]="adblock_breaker_info_showed",e[e.adblock_breaker_info_ok_button_tapped=273]="adblock_breaker_info_ok_button_tapped",e[e.adblock_breaker_info_detailed_button_tapped=274]="adblock_breaker_info_detailed_button_tapped",e[e.comment_donation_button_tapped=275]="comment_donation_button_tapped",e[e.comment_donation_approve_button_tapped=276]="comment_donation_approve_button_tapped",e[e.comment_donation_remove_button_tapped=277]="comment_donation_remove_button_tapped",e[e.more_comments_in_branch_button_tapped=278]="more_comments_in_branch_button_tapped",e[e.show_parent_comment_button_tapped=279]="show_parent_comment_button_tapped",e[e.hide_parent_comment_button_tapped=280]="hide_parent_comment_button_tapped",e[e.go_to_parent_comment_button_tapped=281]="go_to_parent_comment_button_tapped",e[e.return_from_parent_comment_button_tapped=282]="return_from_parent_comment_button_tapped",e[e.collapse_post_button_tapped=283]="collapse_post_button_tapped",e[e.go_to_comments_button_tapped=284]="go_to_comments_button_tapped",e[e.save_post2=285]="save_post2",e[e.redeemed_ad_showed=286]="redeemed_ad_showed",e[e.inp_event=289]="inp_event",e[e.post_series_edit_button_tapped=290]="post_series_edit_button_tapped",e[e.post_series_popup_edit_button_tapped=291]="post_series_popup_edit_button_tapped",e[e.post_series_popup_save_button_tapped=292]="post_series_popup_save_button_tapped",e[e.post_series_popup_cancel_button_tapped=293]="post_series_popup_cancel_button_tapped",e[e.post_series_popup_sorting_series_button_tapped=294]="post_series_popup_sorting_series_button_tapped",e[e.post_series_sorting_series_save_button_tapped=295]="post_series_sorting_series_save_button_tapped",e[e.post_series_sorting_series_cancel_button_tapped=296]="post_series_sorting_series_cancel_button_tapped",e[e.show_more_similar_posts_button_tapped=297]="show_more_similar_posts_button_tapped",e[e.subscribe_after_plus_popup_showed=298]="subscribe_after_plus_popup_showed",e[e.post_series_choose_post_save_button_tapped=299]="post_series_choose_post_save_button_tapped",e[e.post_series_choose_post_cancel_button_tapped=300]="post_series_choose_post_cancel_button_tapped",e[e.sorting_feed_button_tapped=301]="sorting_feed_button_tapped",e[e.post_series_popup_sorting_posts_button_tapped=302]="post_series_popup_sorting_posts_button_tapped",e[e.post_series_sorting_posts_save_button_tapped=303]="post_series_sorting_posts_save_button_tapped",e[e.post_series_sorting_cancel_button_tapped=304]="post_series_sorting_cancel_button_tapped",e[e.multiple_tags_tip_more_button_tapped=305]="multiple_tags_tip_more_button_tapped",e[e.subs_recs_more_button_tapped=306]="subs_recs_more_button_tapped",e[e.subs_recs_more_popup_showed=307]="subs_recs_more_popup_showed",e[e.subs_recs_more_popup_closed=308]="subs_recs_more_popup_closed",e[e.subs_recs_closed=309]="subs_recs_closed",e[e.subs_recs_element_reached=310]="subs_recs_element_reached",e[e.wakeup_author_button_tapped=316]="wakeup_author_button_tapped",e[e.wakeup_author_popup_showed=317]="wakeup_author_popup_showed",e[e.wakeup_author_popup_closed=318]="wakeup_author_popup_closed",e[e.wakeup_author_popup_button_tapped=319]="wakeup_author_popup_button_tapped",e[e.experts_publish_post_popup_showed=322]="experts_publish_post_popup_showed",e[e.experts_publish_post_popup_closed=323]="experts_publish_post_popup_closed",e[e.pikaboost_popup_showed=327]="pikaboost_popup_showed",e[e.pikaboost_popup_closed=328]="pikaboost_popup_closed",e[e.pikaboost_start_popup_button_tapped=329]="pikaboost_start_popup_button_tapped",e[e.mark_pikaboost=330]="mark_pikaboost",e[e.loader_showed=331]="loader_showed",e[e.pikabu_plus_popup_showed=332]="pikabu_plus_popup_showed",e[e.pikabu_plus_popup_button_tapped=333]="pikabu_plus_popup_button_tapped",e[e.pikabu_plus_popup_closed=334]="pikabu_plus_popup_closed",e[e.pikabu_plus_request_sent=335]="pikabu_plus_request_sent",e[e.fields_fulled=336]="fields_fulled",e[e.answer_unhid=337]="answer_unhid",e[e.answer_hid=338]="answer_hid",e[e.best_answer_popup_showed=352]="best_answer_popup_showed",e[e.best_answer_popup_closed=353]="best_answer_popup_closed",e[e.best_answer_popup_approve_button_tapped=354]="best_answer_popup_approve_button_tapped",e[e.post_answer_popup_showed=355]="post_answer_popup_showed",e[e.post_answer_popup_closed=356]="post_answer_popup_closed",e[e.transition_to_custom_ad_create=358]="transition_to_custom_ad_create",e[e.click_custom_ad_manual=359]="click_custom_ad_manual",e[e.click_custom_ad_preview=360]="click_custom_ad_preview",e[e.add_custom_ad_link=361]="add_custom_ad_link",e[e.add_custom_ad_dates=362]="add_custom_ad_dates",e[e.click_custom_ad_geo=363]="click_custom_ad_geo",e[e.click_custom_ad_gender=364]="click_custom_ad_gender",e[e.click_custom_ad_age=365]="click_custom_ad_age",e[e.add_custom_ad_shows=366]="add_custom_ad_shows",e[e.add_custom_ad_organisation=367]="add_custom_ad_organisation",e[e.add_custom_ad_contact=368]="add_custom_ad_contact",e[e.click_custom_ad_conditions_mark=369]="click_custom_ad_conditions_mark",e[e.click_custom_ad_send=370]="click_custom_ad_send",e[e.show_custom_ad_popup=371]="show_custom_ad_popup",e[e.click_custom_ad_one_more=372]="click_custom_ad_one_more",e[e.click_custom_ad_to_main_page=373]="click_custom_ad_to_main_page",e[e.transition_to_custom_ad_rules=373]="transition_to_custom_ad_rules",e[e.click_custom_ad_application=375]="click_custom_ad_application",e[e.transition_to_post_answers=376]="transition_to_post_answers",e[e.transition_to_task=377]="transition_to_task",e[e.transition_to_comics=378]="transition_to_comics",e[e.subscribe_to_post_answers=379]="subscribe_to_post_answers",e[e.ad_load=380]="ad_load",e[e.notification_showed=381]="notification_showed",e[e.user_banned=382]="user_banned",e[e.user_unbanned=383]="user_unbanned",e[e.user_unban_cancelled=384]="user_unban_cancelled",e[e.comment_showed=385]="comment_showed",e[e.mark_get_mailing=386]="mark_get_mailing",e[e.get_mailing_popup_showed=387]="get_mailing_popup_showed",e[e.get_mailing_popup_closed=388]="get_mailing_popup_closed",e[e.get_mailing_popup_continue_button_tapped=389]="get_mailing_popup_continue_button_tapped",e[e.mark_anonymous_comment=395]="mark_anonymous_comment",e[e.transition_to_tags_tab=396]="transition_to_tags_tab",e[e.show_full_comment_button_tapped=397]="show_full_comment_button_tapped",e[e.transition_to_subs_tab=398]="transition_to_subs_tab",e[e.subscribe_to_comment=399]="subscribe_to_comment",e[e.unsubscribe_from_comment=400]="unsubscribe_from_comment"}(c||(c={}));var d=s(32677);let u;!function(e){e.source="s",e.timestamp="t",e.utc="uc",e.sessionId="sd",e.sessionTimestamp="st",e.authorisedId="ad",e.unauthorisedId="ud",e.unauthorisedIdTimestamp="ut",e.ymId="yd",e.ymD="y_",e.yabsSid="ys",e.url="u",e.referrer="r",e.urlParams="up",e.browser="b",e.os="o",e.experimentParams="xp"}(u||(u={}));s(27885);const p=/^\s*at .*(\S+\:\d+|\(native\))/m,h=/^(eval@)?(\[native code\])?$/,_=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/;function m(e){if(e.stack&&e.stack.match(p))return function(e){return e.stack.split("\n").filter((e=>p.test(e))).map((e=>{e.indexOf("(eval ")>-1&&(e=e.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""));let t=e.replace(/^\s+/,"").replace(/\(eval code/g,"(");const s=t.match(/ (\((.+):(\d+):(\d+)\)$)/);t=s?t.replace(s[0],""):t;const i=t.split(/\s+/).slice(1),o=g(s?s[1]:i.pop());return{functionName:i.join(" ")||void 0,fileName:["eval","<anonymous>"].indexOf(o[0])>-1?void 0:o[0],lineNumber:Number(o[1])||0,columnNumber:Number(o[2])||0}}))}(e);if(e.stack)return function(e){return e.stack.split("\n").filter((e=>!h.test(e))).map((e=>{if(e.indexOf(" > eval")>-1&&(e=e.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1")),-1===e.indexOf("@")&&-1===e.indexOf(":"))return{functionName:e};const t=/((.*".+"[^@]*)?[^@]*)(?:@)/,s=e.match(t),i=s&&s[1]?s[1]:void 0,o=g(e.replace(t,""));return{functionName:i,fileName:o[0],lineNumber:Number(o[1])||0,columnNumber:Number(o[2])||0}}))}(e);throw new Error("Cannot parse given Error object")}function g(e){return-1===e.indexOf(":")?[e]:_.exec(e.replace(/[\(\)]/g,"")).slice(1)}const v="/ajax/log.php",f="pkb_errs",y=3,b=function(){try{const e="_t";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}();function w(e,t=0,s=4){if(e instanceof Error)try{const i=e.name,o=e.message,r=e&&e.stack?m(e).slice(t,t+s):[],n=r[0],a=JSON.stringify({f:n?n.fileName:"",l:n?n.lineNumber:0,c:n?n.columnNumber:0,t:i,m:o,n:navigator.userAgent,s:r.map((e=>({f:e.functionName,l:e.lineNumber})))});if(function(e){if(!b)return!1;const t=Math.round(Date.now()/1e3);let s;try{s=JSON.parse(sessionStorage.getItem(f)||"")}catch(i){s={}}if("number"==typeof s[e]&&t-y<s[e])return!0;s[e]=t;try{sessionStorage.setItem(f,JSON.stringify(s))}catch(i){}return!1}(function(e){let t=5381,s=e.length;for(;s;)t=33*t^e.charCodeAt(--s);return t>>>0}(a)))return;const l=new FormData;if(l.append("action","log-js-error"),l.append("payload",a),navigator.sendBeacon)return void navigator.sendBeacon(v,l);const c=new XMLHttpRequest;c.open("POST",v,!0),c.send(l)}catch(i){}}class k extends Error{constructor(e){super("Empty batch in analytics"),this.name=this.constructor.name,this.message=JSON.stringify(e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class S extends Error{constructor(e){super("Full empty values in analytics"),this.name=this.constructor.name,this.message=JSON.stringify(e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}function O(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function E(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class C{constructor(){this.eventCount=0,this.eventStack=new Map,this.showPostEventStack=new Map,this.showPostEventStackForNewAnalytics=new Map,this.lastTimestamp=Date.now()/1e3}static _getParametersHash(e){return JSON.stringify(e)}static _mapEvent(e,t){const s={},i=c[e];if(void 0===i)return null;s[n.xT]=i;for(const[r,n]of Object.entries(t)){const e=l[r];if(void 0!==e)if("screen"!==r&&"screen_referer"!==r)s[e]=n;else{var o;const t=n;s[e]=null!==(o=d.L[t])&&void 0!==o?o:0}}return s}startCycle(e=!1){void 0!==this.timer&&clearTimeout(this.timer);const t=()=>{e?this.sendFromStorage():this.send(),this.timer=setTimeout(t,this._getSendInterval())};t()}pushShowPostEvent(e,t={create_at:0,post_id:0}){if(0===Object.keys(t).length)return;let s;const i=`${t.create_at}-${t.post_id}-show_post`;if(this.showPostEventStack.has(i)){s=this.showPostEventStack.get(i);const e=C._mapEvent("show_post",t);if(!e)return;s.data=e}else{const i=C._mapEvent("show_post",t);if(!i)return;s={parameters:e,data:i},this.eventCount++}Array.isArray(s.data)||0===Object.keys(s.data).length||this.showPostEventStack.set(i,s)}push(e,t,s={}){if(!t.sessionTimestamp)return;if(this.lastTimestamp=t.sessionTimestamp,"show_post"===e)return void this.pushShowPostEvent(t,s);let i;const o=C._getParametersHash(t);i=this.eventStack.has(o)?this.eventStack.get(o):{parameters:t,events:[]};C._mapEvent(e,s)&&i.events.push(C._mapEvent(e,s)),this.eventStack.set(o,i),this.eventCount++}pushToStorage(e,t,s={}){var i;if(!t.sessionTimestamp)return;const o={parameters:t,event:{name:e,eventParameters:s}};this.lastTimestamp=t.sessionTimestamp;const r=null!==(i=a.m.get(n.wr))&&void 0!==i?i:[];r.push(o),a.m.set(n.wr,r)}async send(e=!1){if(0===this.eventCount)return;const t={};for(const{parameters:n,events:c}of this.eventStack.values()){if(!c.filter((e=>!Array.isArray(e)&&0!==Object.keys(e).length)).length)return;const e=JSON.stringify(n);(t[e]=t[e]||{parameters:n,data:[]}).data.push(...c)}for(const{parameters:n,data:c}of this.showPostEventStack.values()){if(!Object.keys(c).length)continue;const e=JSON.stringify(n);(t[e]=t[e]||{parameters:n,data:[]}).data.push(c)}const s=new Map(this.showPostEventStackForNewAnalytics);this.clear();const i=Math.floor(Date.now()/1e3),o=[];Object.values(t).forEach((({data:e,parameters:t})=>{const s={e};for(const[i,o]of Object.entries(t)){if(void 0===o)continue;s[u[i]]=o}s.sa=i,o.push(s)})),s.forEach((e=>{if(Array.isArray(e.data)||0===Object.keys(e.data).length)return void w(new k(e));const t={e:[e.data]};for(const[s,i]of Object.entries(e.parameters)){if(void 0===i)continue;t[u[s]]=i}t.sa=i,o.push(t)}));const r=JSON.stringify(o);let a=n.fi;try{o.find((e=>e.e.find((e=>285===e[0]))))&&(a=n.J5)}catch(l){}await fetch(a+"?json",{method:"POST",mode:"no-cors",credentials:"include",body:r,keepalive:e})}_cleanAnalyticsParams(e){const t=e.map((t=>{const s=function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?O(Object(s),!0).forEach((function(t){E(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):O(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},t);if(s.e=t.e.filter((e=>JSON.stringify(e)!==JSON.stringify({}))),s.e.length<t.e.length&&w(new S(e)),0!==s.e.length)return s}));return t.filter((e=>void 0!==e))}sendFromStorage(e=!1){var t;const s=null!==(t=a.m.get(n.wr))&&void 0!==t?t:[];a.m.remove(n.wr),s.forEach((e=>{this.push(e.event.name,e.parameters,e.event.eventParameters)})),this.send(e)}clear(){this.eventStack.clear(),this.showPostEventStack.clear(),this.showPostEventStackForNewAnalytics.clear(),this.eventCount=0}_getSendInterval(){const e=Date.now()/1e3-this.lastTimestamp;for(const t of n.JP)if(e>=t.sessionLifetime)return 1e3*t.interval;return 1e3*n.JP[n.JP.length-1].interval}}var x=s(59639);const T="serviceWorker"in navigator&&x.N;s(38559),s(41637);var I=s(70017),P=s(58749);function A(){}function D(e){if(!e||e instanceof URLSearchParams||e instanceof FormData||e instanceof Blob)return null!=e?e:null;const t=new FormData;return Object.entries(e).forEach((([e,s])=>{t.set(e,s)})),t}var M=s(53963);function R(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class N{constructor(e){R(this,"onSessionStart",A),this.dataSource=e,this.permanentSession={id:window.PkbAnalytics.unauthorizedId,timestamp:window.PkbAnalytics.unauthorizedTs},this.session=M.m2.getInstance(),this.session.loadFromCookie(),this.session.addSessionCreationListener((()=>{fetch("/ajax/analytics.php",{method:"POST",body:D({action:"set_frontend_params",sid:this.session.id,sts:this.session.createAt,uid:this.permanentSession.id,uts:this.permanentSession.timestamp})})}))}setOnSessionStartCallback(e){this.onSessionStart=e,this.session.addSessionCreationListener(e)}getTrackSession(){const e=this.session.update();return{session:{id:String(this.session.id),timestamp:this.session.createAt},isNewSession:e}}}var B=s(98859);class L{constructor(){this.utc=-Math.floor((new Date).getTimezoneOffset()/60),this.source=n.PY,this.ymD=void 0,this.ymId=void 0,this.browser=`${i.core.ua.name} ${i.core.ua.version}`,this.os=`${i.core.ua.osname} ${i.core.ua.osversion}`;const e=void 0!==window.anl;this.sessions=new N({os:this.os,browser:this.browser,sessionID:i.core.initParams.sessionID,userID:i.core.initParams.userID,source:this.source,isNewUser:!0===i.core.initParams.isNewUser&&!e});const t=n.vv,s=()=>{ym(t,"getClientID",(e=>{this.ymId=e,this.ymD=I.e.get("_ym_d"),a.m.set(n.a0,{id:this.ymId,time:this.ymD})}))},o=a.m.get(n.a0);o&&"string"!=typeof o&&!(0,P.x)(o)&&(this.ymId=o.id,this.ymD=o.time),"function"==typeof window.ym?s():document.addEventListener(`yacounter${t}inited`,(()=>{s()})),this.experimentParams=JSON.stringify(window.PkbAnalytics.experiments||{})}get(){const e=Object.fromEntries(new URLSearchParams(location.search)),t=this._getTrackSession();return{authorisedId:i.core.initParams.userID>0?i.core.initParams.userID:void 0,browser:this.browser,os:this.os,referrer:document.referrer.length>0?document.referrer:void 0,sessionId:null==t?void 0:t.id,sessionTimestamp:null==t?void 0:t.timestamp,source:this.source,unauthorisedId:this.sessions.permanentSession.id,unauthorisedIdTimestamp:this.sessions.permanentSession.timestamp,url:location.protocol+"//"+location.host+location.pathname,urlParams:(0,P.x)(e)?void 0:JSON.stringify(e),utc:this.utc,ymD:this.ymD,ymId:this.ymId,experimentParams:this.experimentParams}}_getTrackSession(){const e=this.sessions.getTrackSession();if(B.O&&e)return e.session}}var j=s(96883);function $(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function U(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?$(Object(s),!0).forEach((function(t){F(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):$(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function F(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class V{constructor(){if(this.parameters=new L,this.aggregator=new C,T){const e=[];this.pushMethod=(t,s)=>{const o=this.parameters.get();t&&Object.keys(s).length&&Object.keys(o).length?i.core.sw.isReady?i.core.sw.send("ch-send-analytics",{name:t,parameters:o,eventParameters:s}):e.push({name:t,parameters:o,eventParameters:s}):w(new k(o))},i.core.once("sw-ready",(()=>{e.forEach((e=>{null!=e&&e.name&&Object.keys(null==e?void 0:e.eventParameters).length&&Object.keys(null==e?void 0:e.parameters).length?i.core.sw.send("ch-send-analytics",e):w(new k(e))}))}))}else this.pushMethod=(e,t)=>{const s=this.parameters.get();e&&Object.keys(t).length&&Object.keys(s).length?this.aggregator.pushToStorage(e,s,t):w(new k(s))},this.aggregator.startCycle(!0)}send(e,t){var s,o;if(!B.O)return;const r=null===(s=window.PkbAnalytics)||void 0===s?void 0:s.gaClientId,a="show_post"===e||"show_ad"===e||"show_comments"===e||"save_post2"===e,l=U(U({create_at:M.HQ.getDateNow(),page_ts:M.HQ.pageTs},r&&{google_id:r}),t);l.event_num=M.HQ.getEventId(e,l.create_at);const c=null===(o=window.PkbAnalytics)||void 0===o?void 0:o.fp;if(c&&(l.fp_key=c),"show_post"!==e&&i.core.logger.log("Clickhouse",`Send ${e}`,l),n.oj.includes(e)||!a)return void j.d.send(e,l);const d="save_post2"===e;d&&this.sendImmediately(),this.pushMethod(e,l),d&&this.sendImmediately()}sendImmediately(){T?i.core.sw.isReady&&i.core.sw.send("ch-send-immediately"):this.aggregator.sendFromStorage(!0)}}var H=s(35249);class Z{constructor(e){this.setScreen(e),this._prevScreen=this.findReferrerPageScreen()}setScreen(e){e&&e!==this._currentScreen&&(this._currentScreen&&(this._prevScreen=this._currentScreen),this._currentScreen=e,this.saveCurrentPageScreen(e))}getReffererMap(){let e=a.m.get(n.Hu,!0);return e&&"string"!=typeof e&&Array.isArray(e)||(e=[]),new Map(e)}saveCurrentPageScreen(e){const t=this.getReffererMap(),s=window.location.pathname;t.delete(s),t.set(s,e),a.m.set(n.Hu,[...t].slice(-n.OX)),this._referrerMap=t}findReferrerPageScreen(){const e=document.referrer;if(!e||-1===e.search(/pikabu.(lh|dev|ru|)/))return;const{pathname:t}=(0,H.k)(e);return this.referrerMap.get(t)}get prevScreen(){return this._prevScreen}get referrerMap(){return this._referrerMap||(this._referrerMap=this.getReffererMap()),this._referrerMap}}function z(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function q(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?z(Object(s),!0).forEach((function(t){W(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):z(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function W(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class G{constructor(){W(this,"commonParameters",{}),this.yandex=new o(n.vv),this.google=new r,this.clickhouse=new V}static getInstance(){return G.instance?G.instance:G.instance=new G}static excludeEmptyParams(e){const t=/!undefined$/,s=/!empty$/,i={};let o;for(o in e){if(!Object.prototype.hasOwnProperty.call(e,o))continue;const r=e[o];if(t.test(o)){if(void 0!==r){i[o.replace(t,"")]=r}}else if(s.test(o)){if(r){i[o.replace(s,"")]=r}}else i[o]=r}return i}sendEvent(e,t){if(!t||0===t.length)return;const s=()=>{const s=G.excludeEmptyParams(q(q({screen:i.core.ui.screen,screen_referer:this.screenHistory.prevScreen},this.commonParameters),t));this.clickhouse.send(e,s)};i.core.ui.screen?s():setTimeout(s,200)}get screenHistory(){return this._screenHistory||(this._screenHistory=new Z(i.core.ui.screen)),this._screenHistory}}},55151:(e,t,s)=>{"use strict";s.d(t,{FJ:()=>a,Hu:()=>p,J5:()=>d,JP:()=>_,OX:()=>n,PY:()=>o,a0:()=>h,fi:()=>c,oj:()=>m,vv:()=>i,wr:()=>u,xT:()=>r});s(74916);const i=174977,o=3,r=0,n=10,a=18e5,l=/^testing\d+\.pikabu\.ru$/.test(location.hostname)?"/anl":"https://cs44.pikabu.ru",c=`${l}/ev.php`,d=`${l}/ev2.php`,u="pkb_Cae",p="pkb_Sr",h="pkb_Yms",_=[{sessionLifetime:60,interval:30},{sessionLifetime:50,interval:10},{sessionLifetime:40,interval:10},{sessionLifetime:30,interval:10},{sessionLifetime:25,interval:5},{sessionLifetime:20,interval:5},{sessionLifetime:15,interval:5},{sessionLifetime:10,interval:5},{sessionLifetime:8,interval:2},{sessionLifetime:6,interval:2},{sessionLifetime:4,interval:2},{sessionLifetime:2,interval:2},{sessionLifetime:1,interval:1},{sessionLifetime:0,interval:1}],m=["authorization","leave_comment","click_registration","create_account","error_occurred","approve_phone","click_create_post","publish_post","subscribe_to_author","subscribe_to_community","subscribe_to_tag","save_post","create_login","create_email","create_phone","create_password","change_viewed_posts_settings","add_to_ignore_list","subscribe_email","click_external_link","user_note_add","user_note_edit","user_setting_change","reach_element","log_out","content_viewed"]},32677:(e,t,s)=>{"use strict";s.d(t,{L:()=>i});s(74916);let i;!function(e){e[e.unknown=0]="unknown",e[e.hot=1]="hot",e[e.best=2]="best",e[e.new=3]="new",e[e.my_lent=4]="my_lent",e[e.communities=5]="communities",e[e.communities_feed=6]="communities_feed",e[e.saved=7]="saved",e[e.discussed=8]="discussed",e[e.post=9]="post",e[e.post_under_comments=10]="post_under_comments",e[e.theme_feed=11]="theme_feed",e[e.search=12]="search",e[e.notifications=13]="notifications",e[e.user=14]="user",e[e.user_settings=15]="user_settings",e[e.user_answers=16]="user_answers",e[e.user_comments=17]="user_comments",e[e.user_liked=18]="user_liked",e[e.user_saved_stories=19]="user_saved_stories",e[e.user_subs_list=20]="user_subs_list",e[e.user_ignore_list=21]="user_ignore_list",e[e.user_notes=22]="user_notes",e[e.authorization=23]="authorization",e[e.create_account=24]="create_account",e[e.post_add=25]="post_add",e[e.top_comments=26]="top_comments",e[e.about_us=27]="about_us",e[e.appearance=28]="appearance",e[e.community=29]="community",e[e.pikabu_contacts=30]="pikabu_contacts",e[e.pikabu_ad=31]="pikabu_ad",e[e.pikabu_help=32]="pikabu_help",e[e.pikabu_rules=33]="pikabu_rules",e[e.pikabu_terms=34]="pikabu_terms",e[e.awards_lent=35]="awards_lent",e[e.approved_users=36]="approved_users",e[e.banned_profiles=37]="banned_profiles",e[e.tags=38]="tags",e[e.interview=39]="interview",e[e.email_subscription=40]="email_subscription",e[e.recommend=41]="recommend",e[e.visited=42]="visited",e[e.tags_edits=44]="tags_edits",e[e.post_tag_edit=45]="post_tag_edit",e[e.post_edit=46]="post_edit",e[e.restore=47]="restore",e[e.companies=53]="companies",e[e.communities_mine=56]="communities_mine",e[e.gamification=57]="gamification",e[e.post_series=58]="post_series",e[e.top_authors=62]="top_authors",e[e.top_commentators=63]="top_commentators",e[e.video_feed=65]="video_feed",e[e.drafts=67]="drafts",e[e.explore=68]="explore",e[e.chistomen_feed=69]="chistomen_feed",e[e.experts=70]="experts",e[e.pikabu_plus=72]="pikabu_plus",e[e.post_answers=92]="post_answers",e[e["15_years"]=93]="15_years",e[e.upload_app_landing=95]="upload_app_landing"}(i||(i={}))},20446:(e,t,s)=>{"use strict";let i,o,r;s.d(t,{dt:()=>o,kH:()=>r}),function(e){e[e.CLICKHOUSE=0]="CLICKHOUSE",e[e.GOOGLE=1]="GOOGLE",e[e.YANDEX=2]="YANDEX"}(i||(i={})),function(e){e.HOT="hot",e.BEST="best",e.NEW="new",e.RECOMMEND="recommend",e.VISITED="visited",e.MY_LENT="my_lent",e.COMMUNITIES="communities",e.COMMUNITIES_FEED="communities_feed",e.COMMUNITIES_MINE="communities_mine",e.COMMUNITIES_MOD="communities_mod",e.SAVED="saved",e.DISCUSSED="discussed",e.POST="post",e.POST_UNDER_COMMENTS="post_under_comments",e.THEME_FEED="theme_feed",e.SEARCH="search",e.NOTIFICATIONS="notifications",e.USER="user",e.USER_SETTINGS="user_settings",e.USER_ANSWERS="user_answers",e.USER_COMMENTS="user_comments",e.USER_LIKED="user_liked",e.USER_SAVED_STORIES="user_saved_stories",e.USER_SUBS_LIST="user_subs_list",e.USER_IGNORE_LIST="user_ignore_list",e.USER_NOTES="user_notes",e.AUTHORIZATION="authorization",e.CREATE_ACCOUNT="create_account",e.POST_ADD="post_add",e.TOP_COMMENTS="top_comments",e.ABOUT_US="about_us",e.APPEARANCE="appearance",e.COMMUNITY="community",e.PIKABU_CONTACTS="pikabu_contacts",e.PIKABU_AD="pikabu_ad",e.PIKABU_HELP="pikabu_help",e.PIKABU_RULES="pikabu_rules",e.PIKABU_TERMS="pikabu_terms",e.AWARDS_LENT="awards_lent",e.APPROVED_USERS="approved_users",e.BANNED_PROFILES="banned_profiles",e.TAGS="tags",e.TAGS_EDITS="tags_edits",e.POST_TAG_EDIT="post_tag_edit",e.RESTORE="restore",e.COMPLAINTS_LIST="complaints_list",e.COMPANIES="companies",e.GAMIFICATION="gamification",e.TOP_AUTHORS="top_authors",e.SERIES="post_series",e.VIDEO_FEED="video_feed",e.STORY_DRAFTS="drafts",e.CHISTOMEN="chistomen_feed",e.EXPERTS="experts",e.BROWSING="explore",e.BROWSING_IMAGES="explore",e.BROWSING_SERIES="explore",e.BROWSING_TEXT="explore",e.BROWSING_VIDEOS="explore",e.BROWSING_NSFW="explore",e.BROWSING_UNIQUE="explore",e.BROWSING_MY="explore",e.BROWSING_ANSWERS="explore",e.BROWSING_VIRUS="explore",e.BROWSING_VIEWED="explore",e.BROWSING_SHORT="explore",e.BROWSING_ANONYMOUS="explore",e.BROWSING_DLINNOPOST="explore",e.PIKABU_PLUS="pikabu_plus",e.COMSTORIES="post_answers",e.CUSTOM_AD_CREATE="custom_ad_create",e.CUSTOM_AD_RULES="custom_ad_rules"}(o||(o={})),function(e){e[e.MONETIZATION=2]="MONETIZATION",e[e.STORY_EDITOR=7]="STORY_EDITOR"}(r||(r={}))},42107:(e,t,s)=>{"use strict";s.d(t,{cp:()=>i.c,dt:()=>o.dt,kH:()=>o.kH});var i=s(90312),o=s(20446);s(55151)},93266:(e,t,s)=>{"use strict";s.d(t,{D:()=>o});var i=s(96883);class o{static sendEvent(e,t={}){i.d.send(e,t)}}},73736:(e,t,s)=>{"use strict";s.d(t,{dV:()=>g});s(74916),s(15306),s(66992),s(33948),s(84944),s(33792),s(60285),s(41637),s(88674),s(41817);var i=s(53963),o=s(3101),r=s(33234);s(85827);const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";var a=s(46170),l=s(23887);s(38559);const c=()=>{const e=/^\/story\/\w*_(\d+)/.exec(location.pathname);return e?parseInt(e[1]):void 0};function d(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function u(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?d(Object(s),!0).forEach((function(t){p(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function p(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const h="undefined"!=typeof navigator&&"sendBeacon"in navigator,_="pkbAR";class m{static getInstance(){return m.instance?m.instance:m.instance=new m}constructor(){var e,t,s;p(this,"session",i.m2.getInstance()),p(this,"options",{source:0,gatewayUrl:"",referrerAcceptUrl:"https://"+document.domain}),p(this,"initialized",!1),p(this,"eventBuffer",[]),p(this,"domain",null===(e=document.domain)||void 0===e||null===(t=e.match(/[^.]*\.[^.]*$/))||void 0===t?void 0:t[0]),p(this,"tz",-Math.floor((new Date).getTimezoneOffset()/60)),p(this,"screenParams",{}),p(this,"commonParameters",{}),this.session.loadFromCookie(),"BroadcastChannel"in window&&new BroadcastChannel("anl").addEventListener("message",(e=>{"object"==typeof e.data&&("yid"in e.data&&"string"==typeof e.data.yid&&(this.options.yid=e.data.yid),"gid"in e.data&&"string"==typeof e.data.gid&&(this.options.gid=e.data.gid))})),this.setScreen(null!==(s=function(e=location.search){const t=new URLSearchParams(e);for(const[s,i]of l.t8)if(t.has(s))return i}())&&void 0!==s?s:function(e=location.pathname){for(const[t,s]of l.sM)if(t.test(e))return s}())}addSessionCreationListener(e,t){this.session.addSessionCreationListener(e,t)}initialize(e){var t;if(this.initialized||!navigator.cookieEnabled)return;const s=(0,r.$)(document.cookie);this.options.yid=null!==(t=s._ym_uid)&&void 0!==t?t:void 0,this.options.yts=s._ym_d?Number(s._ym_d):void 0,this.options.gid=s._ga?s._ga.replace(/^GA(\d\.){2}/,""):void 0,this.session.loadFromCookie(s.Tas);const i=s.pcid;if("object"==typeof e){var l,d;const t=this.options;t.gatewayUrl=null!==(l=e.gatewayUrl)&&void 0!==l?l:"",t.source=null!==(d=e.source)&&void 0!==d?d:0,t.aid=Number.isFinite(e.aid)?e.aid:0,t.uid=e.uid,t.uts=e.uts,t.exps=e.exps,t.fp=e.fp,e.referrerAcceptUrl&&(t.referrerAcceptUrl=e.referrerAcceptUrl.startsWith("http")?e.referrerAcceptUrl:"https://"+e.referrerAcceptUrl)}if(!this.options.uid)if(i)this.options.uid=(0,o.d)(i);else{const e=Array(9).fill(0).reduce((e=>e+n[Math.floor(62*Math.random())]),"")+"v0",t=new Date;t.setSeconds(3456e4),(0,a.l)(`pcid=${e}; path=/`+(this.domain?`; domain=${this.domain}`:"")+`; expires=${t.toUTCString()}`),this.options.uid=(0,o.d)(e)}this.initialized=!0,this.session.addSessionCreationListener((()=>{this.send("startSession",{transitionSource:void 0===document.referrer?"direct":/https?:\/\/(?:[\w-]+\.)?pikabu\.(?:lh|ru)/.test(document.referrer)?"internal":"external",postId:c()})}),"startSession"),this.eventBuffer&&(this.eventBuffer.forEach((([e,t])=>this.transfer(e,t))),delete this.eventBuffer)}getScreenParams(){return this.screenParams}setScreen(e,t){var s;if(this.screenParams=null!=t?t:{},!e||this.screen===e)return;this.screen&&(this.screenReferer=this.screen),this.screen=e;const i=(null!==(s=localStorage.getItem(_))&&void 0!==s?s:"").split("."),r=new Map;for(let o=0,c=i.length;o<c;o+=2){var n;const e=parseInt(i[o],36),t=parseInt(null!==(n=i[o+1])&&void 0!==n?n:"",36);Number.isInteger(t)&&r.set(e,t)}const a=(0,o.d)(window.location.pathname);if(r.delete(a),r.set(a,e),localStorage.setItem(_,Array.from(r).slice(-10).flat().map((e=>e.toString(36))).join(".")),this.screenReferer)return;const l=document.referrer;if(l&&this.options.referrerAcceptUrl&&l.startsWith(this.options.referrerAcceptUrl)){const{pathname:e}=new URL(l);this.screenReferer=r.get((0,o.d)(e))}}send(e,t,s=!1){if(!navigator.cookieEnabled)return;this.session.update();const i=t.createAt||t.create_at||t[1]||this.session.getDateNow();delete t[1],delete t.createAt,delete t.create_at;const o=t.eventNum||t.event_num||t[134]||this.session.getEventId(e,i);var r;delete t[134],delete t.eventNum,delete t.event_num,r=t,Object.entries(r).forEach((([e,t])=>{e.endsWith("!undefined")&&(delete r[e],r[e.slice(0,-10)]=t),e.endsWith("!empty")&&(delete r[e],t&&(r[e.slice(0,-6)]=t))}));const n=function(e){return Object.fromEntries(Object.entries(e).filter((([,e])=>void 0!==e&&""!==e&&null!==e&&!Number.isNaN(e))))}(u(u({1:i,9:this.screen,31:this.screenReferer,128:this.options.fp,130:this.options.gid,134:o,135:this.session.pageTs},t),this.commonParameters));this.initialized?this.transfer(e,n,s):this.eventBuffer&&this.eventBuffer.push([e,n])}transfer(e,t,s=!1){var i,o;const r=this.options.gatewayUrl||"",n=JSON.stringify({tz:this.tz,uid:this.options.uid,uts:this.options.uts,sid:this.session.id,sts:this.session.createAt,yid:this.options.yid,yts:this.options.yts,aid:this.options.aid,exps:this.options.exps,url:location.protocol+"//"+location.host+location.pathname+location.search,referrer:null!==(i=document.referrer)&&void 0!==i?i:void 0,event:t});s=null!==(o=document.hidden)&&void 0!==o?o:s;const a=`${r}/v2/event/j/${this.options.source}/${e}`;s&&h?navigator.sendBeacon(a,n):fetch(a,{mode:"no-cors",cache:"no-cache",method:"POST",body:n,keepalive:!0}).catch((e=>console.warn(e)))}}const g=m.getInstance()},53963:(e,t,s)=>{"use strict";s.d(t,{m2:()=>u,HQ:()=>p});s(74916),s(66992),s(33948),s(41817);var i=s(46170);var o=s(33234),r=s(3101);s(15306);function n(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const a=1640984400;let l=0;const c={};let d=0;class u{static getInstance(){return window.anlSession?window.anlSession:window.anlSession=new u}constructor(){var e,t;n(this,"pageTs",Date.now()),n(this,"domain",null===(e=document.domain)||void 0===e||null===(t=e.match(/[^.]*\.[^.]*$/))||void 0===t?void 0:t[0]),n(this,"listeners",new Set),n(this,"namedListeners",new Map)}getDateNow(){const e=Date.now();return d>=e?++d:d=e}getEventId(e,t){var s;const i=(0,r.d)(e.replace(/\W/g,"").replace(/^\w/,(e=>e.toLowerCase())).replace(/[A-Z]/g,(e=>`_${e.toLowerCase()}`))+String(t));return c[i]=null!==(s=c[i])&&void 0!==s?s:l++}addSessionCreationListener(e,t){t?this.namedListeners.set(t,e):this.listeners.add(e)}update(){if(!this.id||this.id<=0||!Number.isSafeInteger(this.id))return this.create(),!0;const e=this.createAt+60*this.lastUpdate,t=Date.now()/1e3;if(e<=t-1800||e>=t+1800)return this.create(),!0;const s=Math.floor((t-this.createAt)/60);return this.lastUpdate===s||(this.lastUpdate=s,this.save()),!1}loadFromCookie(e){e="string"==typeof e?e:(0,o.$)(document.cookie).Tas;const[t,s,i]=(e||"").split(".").map((e=>parseInt(e,36))).filter((e=>Number.isSafeInteger(e)&&e>=0));t&&s&&(this.id=t,this.createAt=s+a,this.lastUpdate=i)}create(){this.id=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER+1),this.createAt=Math.floor(Date.now()/1e3),this.lastUpdate=0,this.save(),this.listeners.forEach((e=>e())),this.namedListeners.forEach((e=>e()))}save(){if(!this.id||!this.createAt)return;const e=[this.id,this.createAt-a,this.lastUpdate].map((e=>(null!=e?e:0).toString(36))).join(".");(0,i.l)(`Tas=${e}; path=/${this.domain?"; domain="+this.domain:""}`)}}const p=u.getInstance()},3101:(e,t,s)=>{"use strict";function i(e,t=0){let s=3735928559^t,i=1103547991^t;for(let o,r=0;r<e.length;r++)o=e.charCodeAt(r),s=Math.imul(s^o,2654435761),i=Math.imul(i^o,1597334677);return s=Math.imul(s^s>>>16,2246822507)^Math.imul(i^i>>>13,3266489909),i=Math.imul(i^i>>>16,2246822507)^Math.imul(s^s>>>13,3266489909),4294967296*(2097151&i)+(s>>>0)}s.d(t,{d:()=>i})},33234:(e,t,s)=>{"use strict";s.d(t,{$:()=>o});s(24603),s(74916),s(66992),s(33948),s(13728);const i=new RegExp(`(${["pcid","grex2","Tas","_ym_d","_ym_uid","_ga"].join("|")})\\s*=\\s*([^;]*)`,"g");function o(e){const t={};for(const[,s,o]of e.matchAll(i))t[s]=decodeURIComponent(o).trim();return t}},96883:(e,t,s)=>{"use strict";s.d(t,{d:()=>i.dV});s(85827),s(66992),s(33948),s(68929);var i=s(73736)},23887:(e,t,s)=>{"use strict";let i;s.d(t,{qJ:()=>i,sM:()=>o,t8:()=>r}),function(e){e[e.HOT=1]="HOT",e[e.BEST=2]="BEST",e[e.NEW=3]="NEW",e[e.MY_LENT=4]="MY_LENT",e[e.COMMUNITIES=5]="COMMUNITIES",e[e.COMMUNITIES_FEED=6]="COMMUNITIES_FEED",e[e.COMMUNITIES_MINE=56]="COMMUNITIES_MINE",e[e.SAVED=7]="SAVED",e[e.DISCUSSED=8]="DISCUSSED",e[e.POST=9]="POST",e[e.POST_UNDER_COMMENTS=10]="POST_UNDER_COMMENTS",e[e.THEME_FEED=11]="THEME_FEED",e[e.SEARCH=12]="SEARCH",e[e.NOTIFICATIONS=13]="NOTIFICATIONS",e[e.USER=14]="USER",e[e.USER_SETTINGS=15]="USER_SETTINGS",e[e.USER_ANSWERS=16]="USER_ANSWERS",e[e.USER_COMMENTS=17]="USER_COMMENTS",e[e.USER_LIKED=18]="USER_LIKED",e[e.USER_SAVED_STORIES=19]="USER_SAVED_STORIES",e[e.USER_SUBS_LIST=20]="USER_SUBS_LIST",e[e.USER_IGNORE_LIST=21]="USER_IGNORE_LIST",e[e.USER_NOTES=22]="USER_NOTES",e[e.AUTHORIZATION=23]="AUTHORIZATION",e[e.CREATE_ACCOUNT=24]="CREATE_ACCOUNT",e[e.POST_ADD=25]="POST_ADD",e[e.TOP_COMMENTS=26]="TOP_COMMENTS",e[e.ABOUT_US=27]="ABOUT_US",e[e.APPEARANCE=28]="APPEARANCE",e[e.COMMUNITY=29]="COMMUNITY",e[e.PIKABU_CONTACTS=30]="PIKABU_CONTACTS",e[e.PIKABU_AD=31]="PIKABU_AD",e[e.PIKABU_HELP=32]="PIKABU_HELP",e[e.PIKABU_RULES=33]="PIKABU_RULES",e[e.PIKABU_TERMS=34]="PIKABU_TERMS",e[e.AWARDS_LENT=35]="AWARDS_LENT",e[e.APPROVED_USERS=36]="APPROVED_USERS",e[e.BANNED_PROFILES=37]="BANNED_PROFILES",e[e.TAGS=38]="TAGS",e[e.INTERVIEW=39]="INTERVIEW",e[e.EMAIL_SUBSCRIPTION=40]="EMAIL_SUBSCRIPTION",e[e.RECOMMEND=41]="RECOMMEND",e[e.VISITED=42]="VISITED",e[e.TAGS_EDITS=44]="TAGS_EDITS",e[e.POST_TAG_EDIT=45]="POST_TAG_EDIT",e[e.RESTORE=47]="RESTORE",e[e.COMPANIES=53]="COMPANIES",e[e.GAMIFICATION=57]="GAMIFICATION",e[e.SERIES=58]="SERIES",e[e.TOP_AUTHORS=62]="TOP_AUTHORS",e[e.TOP_COMMENTATORS=63]="TOP_COMMENTATORS",e[e.VIDEO_FEED=65]="VIDEO_FEED",e[e.INTERESTS_SURVEY=66]="INTERESTS_SURVEY",e[e.STORY_DRAFTS=67]="STORY_DRAFTS",e[e.EXPERTS=70]="EXPERTS",e[e.CUSTOM_AD_CREATE=73]="CUSTOM_AD_CREATE",e[e.CUSTOM_AD_RULES=74]="CUSTOM_AD_RULES",e[e.UPLOAD_APP_LANDING=95]="UPLOAD_APP_LANDING"}(i||(i={}));const o=[[/^\/(new|best|hot)\/feed\/\w+/,i.THEME_FEED],[/^\/$/,i.HOT],[/^\/hot/,i.HOT],[/^\/best/,i.BEST],[/^\/new/,i.NEW],[/^\/rec/,i.RECOMMEND],[/^\/visited-stories/,i.VISITED],[/^\/subs(?!-list)/,i.MY_LENT],[/^\/communities\/feed/,i.COMMUNITIES_FEED],[/^\/communities\/mine/,i.COMMUNITIES_MINE],[/^\/communities/,i.COMMUNITIES],[/^\/most-saved/,i.SAVED],[/^\/disputed/,i.DISCUSSED],[/^\/story\/(?:\w*)?_\d+/,i.POST],[/^\/search/,i.SEARCH],[/^\/notifications/,i.NOTIFICATIONS],[/^\/@[\d.a-zа-я]{3,32}/,i.USER],[/^\/settings/,i.USER_SETTINGS],[/^\/answers/,i.USER_ANSWERS],[/^\/(comments|commented\.php)/,i.USER_COMMENTS],[/^\/liked/,i.USER_LIKED],[/^\/saved-stories/,i.USER_SAVED_STORIES],[/^\/subs-list/,i.USER_SUBS_LIST],[/^\/ignore-list/,i.USER_IGNORE_LIST],[/^\/notes/,i.USER_NOTES],[/^\/add/,i.POST_ADD],[/^\/top-comments/,i.TOP_COMMENTS],[/^\/community\/\w+/,i.COMMUNITY],[/^\/information\/contacts/,i.PIKABU_CONTACTS],[/^\/information\/ad/,i.PIKABU_AD],[/^\/information\/rules/,i.PIKABU_RULES],[/^\/information\/terms/,i.PIKABU_TERMS],[/^\/awards/,i.AWARDS_LENT],[/^\/approved-users/,i.APPROVED_USERS],[/^\/banned-profiles/,i.BANNED_PROFILES],[/^\/tag$/,i.SEARCH],[/^\/tag/,i.TAGS],[/^\/page\/interview/,i.INTERVIEW],[/^\/subscribe-email/,i.EMAIL_SUBSCRIPTION],[/^\/restore\.php/,i.RESTORE],[/^\/edits\/\d+\/?(tags|title|text|image|video)?\/?(\d+)?\/?(waiting|approved|rejected|canceled|history)?/,i.POST_TAG_EDIT],[/^\/edits\/?((@\w+)|(waiting|approved|rejected|canceled|mine))?/,i.TAGS_EDITS],[/^\/companies/,i.COMPANIES],[/^\/achievements/,i.GAMIFICATION],[/^\/top\/authors/,i.TOP_AUTHORS],[/^\/top\/commentators/,i.TOP_COMMENTATORS],[/^\/series/,i.SERIES],[/^\/drafts/,i.STORY_DRAFTS],[/^\/experts/,i.EXPERTS],[/^\/information\/user-ads/,i.CUSTOM_AD_CREATE],[/^\/information\/user-ads-rules/,i.CUSTOM_AD_RULES],[/^\/applications/,i.UPLOAD_APP_LANDING]],r=[["videofeed",i.VIDEO_FEED]]},46170:(e,t,s)=>{"use strict";function i(e){document.cookie=e}s.d(t,{l:()=>i})},84864:(e,t,s)=>{"use strict";s.d(t,{GV:()=>n,sT:()=>o,oB:()=>r});s(88674),s(66992),s(33948),s(41817);function i(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class o{constructor(e){i(this,"ERRORS",{CardNumber_Empty:"Пустой номер карты",CardNumber_Invalid:"Некорректный номер карты",Cvv_Empty:"Пустой CVV",Cvv_Invalid:"Некорректный CVV",ExpDateMonth_Empty:"Пустой месяц",ExpDateMonth_Invalid:"Некорректный месяц",ExpDateYear_Empty:"Пустой год",ExpDateYear_Invalid:"Некорректный год"}),this.getPublicId=e}static getPossibleIssuers(e){const t=[];return this.mayBeMir(e)&&t.push(r.MIR),this.mayBeVisa(e)&&t.push(r.VISA),this.mayBeMastercard(e)&&t.push(r.MASTERCARD),this.mayBeMaestro(e)&&t.push(r.MAESTRO),this.mayBeUnion(e)&&t.push(r.UNION),t}static async getBank(e){var t;null!==(t=this.binsHashRequest)&&void 0!==t||(this.binsHashRequest=fetch(this.BINS_URL).then((e=>e.json())));return(await this.binsHashRequest)[e]}static getIssuerLogoUrl(e){return`https://s.pikabu.ru/images/issuers/${e}.svg`}static getBankLogoUrl(e){return`https://s.pikabu.ru/images/banks/${e}.svg`}static isValidLuhn(e){let t=e.length;if(t<14)return!1;let s=1,i=0;const o=[[0,1,2,3,4,5,6,7,8,9],[0,2,4,6,8,1,3,5,7,9]];for(;t--;)i+=o[s^=1][Number(e.charAt(t))];return i%10==0&&i>0}static mayBeMir(e){return this.matchesRange(e,"2200","2204")}static mayBeVisa(e){return this.matchesRange(e,"4")}static mayBeMastercard(e){return this.matchesRange(e,"2221","2720")||this.matchesRange(e,"51","55")}static mayBeMaestro(e){return["676770","676774","5018","5020","5038","5893","6304","6759","6761","6762","6763"].some((t=>t.slice(0,e.length)===e))}static mayBeUnion(e){return this.matchesRange(e,"62")}static matchesRange(e,t,s=t){const i=Math.max(t.length,s.length),o=e.slice(0,i);return o>=t.slice(0,e.length)&&o<=s.slice(0,e.length)}async createCryptogram(e,t){const s=await this.getCheckout(t);try{return await s.createPaymentCryptogram(e)}catch(i){const e=Object.values(i)[0];throw new Error(this.ERRORS[e])}}async getCheckout(e){var t;null!==(t=o.checkoutScriptRequest)&&void 0!==t||(o.checkoutScriptRequest=async function(e){return new Promise(((t,s)=>{const i=document.createElement("script");i.src=e,i.addEventListener("load",(()=>t(i))),i.addEventListener("error",(e=>s(e))),document.head.append(i)}))}(o.CHECKOUT_SCRIPT_URL).then((()=>window.cp)));const[s,i]=await Promise.all([o.checkoutScriptRequest,this.getPublicId(e)]);return new s.Checkout({publicId:i})}}let r,n;i(o,"BINS_URL","https://s.pikabu.ru/files/bins.json"),i(o,"CHECKOUT_SCRIPT_URL","https://checkout.cloudpayments.ru/checkout.js"),function(e){e.MIR="mir",e.VISA="visa",e.MASTERCARD="mastercard",e.MAESTRO="maestro",e.UNION="union"}(r||(r={})),function(e){e.ALFA="alfa",e.GAZPROM="gazprom",e.SBER="sber",e.TINKOFF="tinkoff",e.VTB="vtb"}(n||(n={}))},62430:(e,t,s)=>{"use strict";function i(e){return e.__meta?e.__meta:e.__meta={}}s.d(t,{O:()=>i})},29084:(e,t,s)=>{"use strict";s.d(t,{T:()=>o});s(66992),s(33948),s(41817);function i(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class o{constructor(e){i(this,"_options",{}),e&&this.setOptions(e)}static getDescriptor(e,t){var s;return e?null!==(s=Object.getOwnPropertyDescriptor(e,t))&&void 0!==s?s:o.getDescriptor(Object.getPrototypeOf(e),t):void 0}destroy(){var e;this.__isDestroyed||(this.__isDestroyed=!0,null!==(e=this.__meta)&&void 0!==e&&e.cancelable&&(this.__meta.cancelable.forEach((e=>e.cancel&&e.cancel())),delete this.__meta.cancelable),this.cancelAnimationFrame(),this.cancelInterval(),this.cancelTimeout())}setOptions(e){for(const[t,s]of Object.entries(e)){const e=o.getDescriptor(this,t);e&&Object.prototype.hasOwnProperty.call(e,"set")&&void 0!==e.set?this[t]=s:this._options[t]=s}return this}getOption(e){const t=o.getDescriptor(this,e);return t&&Object.prototype.hasOwnProperty.call(t,"get")&&void 0!==t.get?this[e]:this._options[e]}cancelDecorator(e){"cancel"in e&&"function"==typeof e.cancel&&e.cancel()}runDecoratorImmediately(e,...t){"runImmediately"in e&&"function"==typeof e.runImmediately&&e.runImmediately.apply(this,t)}timeout(e,t,s,i=!0,...o){var r;i&&this.cancelTimeout(e);let n=this.timeoutsList;n||(n=this.timeoutsList=new Map);const a=()=>{var t;null===(t=n)||void 0===t||t.delete(e),s.apply(this,o)};return null===(r=n)||void 0===r||r.set(e,{callback:a,timeout:setTimeout(a,t)}),this}runTimeoutImmediately(...e){if(!e.length)return this;const t=this.timeoutsList;return t?(e.forEach((e=>{const s=t.get(e);s&&(clearTimeout(s.timeout),s.callback())})),this):this}cancelTimeout(...e){const t=this.timeoutsList;return t?e.length?(e.forEach((e=>{const s=t.get(e);s&&(clearTimeout(s.timeout),t.delete(e))})),0===t.size&&delete this.timeoutsList,this):(t.forEach((e=>clearTimeout(e.timeout))),t.clear(),delete this.timeoutsList,this):this}interval(e,t,s,i=!0){var o;i&&this.cancelTimeout(e);let r=this.intervalList;return r||(r=this.intervalList=new Map),null===(o=r)||void 0===o||o.set(e,setInterval(s.bind(this),t)),this}cancelInterval(...e){const t=this.intervalList;return t?e.length?(e.forEach((e=>{const s=t.get(e);s&&(clearInterval(s),t.delete(e))})),0===t.size&&delete this.intervalList,this):(t.forEach((e=>clearInterval(e))),t.clear(),delete this.intervalList,this):this}animationFrame(e,t,s=!0){var i;s&&this.cancelTimeout(e);let o=this.animationList;o||(o=this.animationList=new Map);return null===(i=o)||void 0===i||i.set(e,{callback:()=>{var s;null===(s=o)||void 0===s||s.delete(e),t.call(this)},timeout:requestAnimationFrame(t)}),this}cancelAnimationFrame(...e){const t=this.animationList;return t?e.length?(e.forEach((e=>{const s=t.get(e);s&&(cancelAnimationFrame(s.timeout),t.delete(e))})),0===t.size&&delete this.animationList,this):(t.forEach((e=>cancelAnimationFrame(e.timeout))),t.clear(),delete this.animationList,this):this}get isDestroyed(){return!0===this.__isDestroyed}}},75130:(e,t,s)=>{"use strict";s.d(t,{U:()=>d});s(74916),s(66992),s(33948),s(15306),s(41817);var i=s(70017);let o;function r(e,t){let s,i,o=0,r=1,n="",a=0;for(;o<e.length;){for(s=e.charAt(o),i="",o++;o<e.length&&null!==e.charAt(o).match(/[\d*]/);)i+=e.charAt(o),o++;switch(""===i&&(i="1"),s){case"C":if(i=arguments.length-r,i>arguments.length-r)throw new Error("Warning:  pack() Type "+s+": too few arguments");for(a=0;a<i;a++)n+=String.fromCharCode(arguments[r]),r++;break;case"S":if(i=arguments.length-r,i>arguments.length-r)throw new Error("Warning:  pack() Type "+s+": too few arguments");for(a=0;a<i;a++)n+=String.fromCharCode(255&arguments[r]),n+=String.fromCharCode(arguments[r]>>8&255),r++;break;case"L":if(i=arguments.length-r,i>arguments.length-r)throw new Error("Warning:  pack() Type "+s+": too few arguments");for(a=0;a<i;a++)n+=String.fromCharCode(255&arguments[r]),n+=String.fromCharCode(arguments[r]>>8&255),n+=String.fromCharCode(arguments[r]>>16&255),n+=String.fromCharCode(arguments[r]>>24&255),r++;break;default:throw new Error("Warning: pack() Type "+s+": unknown format code")}}if(r<arguments.length){throw new Error("Warning: pack(): "+(arguments.length-r)+" arguments unused")}return n}function n(e,t){let s,i=0,o=0,r={},n="",a="",l="",c="",d=0;for(;i<e.length;){for(n=e.charAt(i),a="",i++;i<e.length&&null!==e.charAt(i).match(/[\d\*]/);)a+=e.charAt(i),i++;for(""===a&&(a="1"),l="";i<e.length&&"/"!==e.charAt(i);)l+=e.charAt(i),i++;switch("/"===e.charAt(i)&&i++,n){case"C":for(a=t.length-o,c=t.substr(o,a),o+=a,d=0;d<c.length;d++)s=c.charCodeAt(d),"c"===n&&s>=128&&(s-=256),r[l+(a>1?d+1:"")]=s;break;case"S":for(a=(t.length-o)/2,c=t.substr(o,2*a),o+=2*a,d=0;d<c.length;d+=2)s=((255&c.charCodeAt(d+1))<<8)+(255&c.charCodeAt(d)),"s"===n&&s>=32768&&(s-=65536),r[l+(a>1?d/2+1:"")]=s;break;case"L":for(a=(t.length-o)/4,c=t.substr(o,4*a),o+=4*a,d=0;d<c.length;d+=4)s=((255&c.charCodeAt(d+3))<<24)+((255&c.charCodeAt(d+2))<<16)+((255&c.charCodeAt(d+1))<<8)+(255&c.charCodeAt(d)),r[l+(a>1?d/4+1:"")]=s;break;default:throw new Error("Warning:  unpack() Type "+n+": unknown format code")}}return r}function a(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(e){e.BOOL="b",e.INT8="i8",e.INT16="i16",e.INT32="i32",e.UNKNOWN=""}(o||(o={}));class l{constructor(){var e,t;a(this,"properties",{}),a(this,"host",null===(e=/pikabu\.[a-z]+/i.exec(String(window.location.hostname)))||void 0===e?void 0:e[0]),a(this,"COOKIE_NAME_PREFIX","clpr"),a(this,"COOKIE_TTL",365),a(this,"SEPARATOR","."),a(this,"MAX_INT8",255),a(this,"MIN_INT8",0),a(this,"MAX_INT16",65535),a(this,"MIN_INT16",0),a(this,"MAX_INT32",2147483647),a(this,"MIN_INT32",0),a(this,"PACK_SYMBOL_PER_INT_TYPE",{[o.INT8]:"C",[o.INT16]:"S",[o.INT32]:"L"}),a(this,"BASE64_LENGTH_MULTIPLICITY",4),a(this,"CHUNK_SIZE",8);const s=null!==(t=i.e.get(this.getCookieName()))&&void 0!==t?t:"";this.unpack(s)}get(e){var t;return null!==(t=this.properties[e])&&void 0!==t?t:!this.getBoolFieldNames().includes(e)&&0}set(e,t){const s=this.getType(e);if(s===o.UNKNOWN)throw new TypeError(`${e}: no such field`);if(s===o.BOOL){if("boolean"!=typeof t)throw new TypeError(`${e} must be boolean`)}else{if(!Number.isInteger(t))throw new TypeError(`${e} must be integer`);const i=this.getMaxIntValue(s),o=this.getMinIntValue(s);if(t>i||t<o)throw new TypeError(`${e} must be between ${o} and ${i}`)}return this.properties[e]=t,i.e.set(this.getCookieName(),this.pack(),{expires:this.COOKIE_TTL,domain:"."+this.host}),this}isset(e){return void 0!==this.properties[e]&&null!==this.properties[e]}getCookieName(){return this.COOKIE_NAME_PREFIX+this.getVersion()}getCookieValue(){return this.pack()}pack(){const e=[],t=this.getFieldsListPerType();for(const[s,i]of Object.entries(t)){const t=s;let n,a;t===o.BOOL?(n=this.packBoolFieldsToIntList(),a="C"):(n=i.map((e=>this.get(e))),a=this.PACK_SYMBOL_PER_INT_TYPE[t]);const l=r(a+"*",...n);e.push(btoa(l).replace(/=+$/,""))}return e.join(this.SEPARATOR)}unpack(e){const[t,s,i,r]=e.split(this.SEPARATOR),a={[o.BOOL]:null!=t?t:"",[o.INT8]:null!=s?s:"",[o.INT16]:null!=i?i:"",[o.INT32]:null!=r?r:""},l=this.getFieldsListPerType();for(const[d,u]of Object.entries(l)){const e=d;let t=a[e];const s=this.BASE64_LENGTH_MULTIPLICITY*Math.ceil(t.length/this.BASE64_LENGTH_MULTIPLICITY);let i;t=t.padEnd(s,"=");try{i=atob(t)}catch(c){continue}const r=n((e===o.BOOL?"C":this.PACK_SYMBOL_PER_INT_TYPE[e])+"*",i);if(!r)continue;const l=Object.keys(r).map((e=>r[e]));e!==o.BOOL?u.forEach(((e,t)=>{var s;this.properties[e]=null!==(s=l[t])&&void 0!==s?s:0})):this.unpackIntListToBoolFields(l)}}packBoolFieldsToIntList(){const e=this.getBoolFieldNames(),t=[];return this.getChunkedArray(e).forEach((e=>{let s=0;e.forEach(((e,t)=>{this.get(e)&&(s|=1<<t)})),t.push(s)})),t}unpackIntListToBoolFields(e){const t=this.getBoolFieldNames();this.getChunkedArray(t).forEach(((t,s)=>{var i;const o=null!==(i=e[s])&&void 0!==i?i:0;t.forEach(((e,t)=>{this.properties[e]=1==(o>>t&1)}))}))}getType(e){const t=l;if(t.fieldPerTypeCache[e])return t.fieldPerTypeCache[e];const s=this.getFieldsListPerType();for(const[i,o]of Object.entries(s)){const s=i;if(o.includes(e))return t.fieldPerTypeCache[e]=s,s}return t.fieldPerTypeCache[e]=o.UNKNOWN,o.UNKNOWN}getMaxIntValue(e){return{[o.INT8]:this.MAX_INT8,[o.INT16]:this.MAX_INT16,[o.INT32]:this.MAX_INT32}[e]}getMinIntValue(e){return{[o.INT8]:this.MIN_INT8,[o.INT16]:this.MIN_INT16,[o.INT32]:this.MIN_INT32}[e]}getFieldsListPerType(){return{[o.BOOL]:this.getBoolFieldNames(),[o.INT8]:this.getInt8FieldNames(),[o.INT16]:this.getInt16FieldNames(),[o.INT32]:this.getInt32FieldNames()}}getChunkedArray(e,t=this.CHUNK_SIZE){const s=t,i=Array(Math.ceil(e.length/s));return Array.from(i,((t,i)=>e.slice(i*s,i*s+s)))}}a(l,"fieldPerTypeCache",{});var c=s(39868);class d extends l{getVersion(){return 1}getBoolFieldNames(){return["isWebPSupportChecked","hasWebPSupport",c.m.HOT,c.m.BEST,c.m.NEW,"popupComValueShown","comStatsAccordionHidden","isInRecAuthorsNewComExp","isStoryEditorComValueHidden","isHotFeedBadgeShown","isActualTopicsHidden_deprecated","isQuestionsSidebarBannerHidden","isSubscriptionFormHidden","isDonationsNewBadgeHidden","isSmartBannerHidden","isCommunityMonetizationBadgeHidden","isVideoFeedOpened","isBrowsingPageOpened_deprecated","isMultipleTagsHintShown","isMultipleTagsLinkClicked",c.m.EXPERTS,"isExpertsPageOpened","isProfileDeprecatingAuthWarningClosed","isComstoryPopupShown"]}getInt8FieldNames(){return["testInt8"]}getInt16FieldNames(){return["testInt16"]}getInt32FieldNames(){return["disputedInFeedClosedTimestampHours_deprecated","recComBlockTime","popularAuthorsBlockTime_deprecated"]}}},14032:(e,t,s)=>{"use strict";s.d(t,{vU:()=>n,lZ:()=>a,Wi:()=>u});s(88674);var i=s(12953);let o,r;const n=async({layoutId:e,invoiceId:t,amount:s,onSuccess:n,onFail:a})=>{var l;await(r?Promise.resolve():o||(o=new Promise(((e,t)=>{try{const s=document.createElement("script");s.async=!0,s.defer=!0,s.addEventListener("load",(()=>{r=new ctips.CloudTipsSiteWidget,e()})),s.addEventListener("error",(e=>{t(e),o=void 0})),s.src=1===i.core.initParams.cloudTipsMode?"https://widget.cloudtips.ru/bundle.js":"https://widget-sandbox.cloudtips.ru/bundle.js",document.body.appendChild(s)}catch(s){t(s),o=void 0}})),o)),null===(l=r)||void 0===l||l.open({layoutid:e,invoiceid:t,amount:s},{onSuccess:n,onFail:a})},a=e=>{const t=document.querySelector(".ctips-sitewidget-wrapper");if(!t)return;const s=new MutationObserver((i=>{i.forEach((i=>{i.removedNodes.forEach((i=>{i===t&&(e(),s.disconnect())}))}))}));s.observe(document.body,{childList:!0})};var l=s(13218),c=s.n(l);const d={success:"Success"};function u(e){return c()(e)&&"statusCode"in e&&e.statusCode===d.success}},85679:(e,t,s)=>{"use strict";s.d(t,{mf:()=>r,g4:()=>o,$E:()=>a,vL:()=>i,P0:()=>n});const i=1e3,o=60*i,r=1440*o,n=7*r,a=30*r},48270:(e,t,s)=>{"use strict";s.d(t,{L:()=>d});s(41817),s(66992),s(33948);var i=s(2439);s(78564);var o,r,n=s(65704);function a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function l(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?a(Object(s),!0).forEach((function(t){c(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function c(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}let d=(o=function(e="id"){return function(t){return t.prototype.fieldId=e,t}}("id"),u={},o(r=function(e){return e.prototype.defaults=u,e}(r=class extends i.v{constructor(e,t=!0,s){var i,o,r,a;super(),c(this,"_id",(0,n.E)()),s&&(this.fieldId=s),this._data=this._createData(e),t&&(this._proxy=(i=this._data,o=this.onChangeData.bind(this),r=this,a=i,Proxy.revocable(a,{set(e,t,s){if(!(t in e))throw new TypeError("Can't add property create, object is not extensible. Use DataObject.defaults");const i=e[t];return e[t]=s,o.call(r,t,s,i),!0},get:(e,t)=>e[t],deleteProperty(e,t){throw new TypeError(`Cannot delete property '${t}' of #<Object>. Use \`${t} = undefined;\``)},defineProperty(){throw new TypeError("Can't use Object.defineProperty, object is not extensible. Use DataObject.defaults")}})))}hasSnapshot(e){return!!this._snapshots&&this._snapshots.has(e)}save(e){this._snapshots||(this._snapshots=new Map),this._snapshots.has(e)&&this._snapshots.delete(e);const t=Object.freeze(l({},this._data));this._snapshots.set(e,t),this.emit("dataSaveSnapshot",this,e,t)}diff(e){const t=[],s=this._snapshots?this._snapshots.get(e):void 0;if(!s){for(const[e,s]of Object.entries(this._data))t.push({property:e,type:"add",value:s});return t}const i=new Set(Object.entries(s).filter((([,e])=>void 0!==e)).map((([e])=>e)));for(const[o,r]of Object.entries(this._data))void 0!==r&&(Object.prototype.hasOwnProperty.call(s,o)&&void 0!==s[o]?r!==s[o]&&t.push({property:o,type:"set",value:r}):t.push({property:o,type:"add",value:r}),i.delete(o));for(const o of i)t.push({property:o,type:"remove",value:void 0});return i.clear(),t}_createData(e){return Object.assign({[this.fieldId]:void 0},this.defaults||{},e)}destroy(e=!1){this.isDestroyed||(e||this.emit("dataDestroy",this),this._proxy&&(this._proxy.revoke(),delete this._proxy),this._marks&&(this._marks.clear(),delete this._marks),super.destroy(e))}update(e,t=!1,s=!0){const i={};for(const[o,r]of Object.entries(e)){const e=this._data[o];e!==r&&(i[o]=e,this._data[o]=r,t||this.emit("dataChangeProperty",this,o,r,e))}if(!s)for(const o of Object.keys(this._data)){if(Object.prototype.hasOwnProperty.call(e,o))continue;const s=this._data[o];i[o]=s,this._data[o]=void 0,t||this.emit("dataChangeProperty",this,o,void 0,s)}return Object.entries(i).length&&!t&&this.emit("dataChange",this,i),i}onChangeData(e,t,s){t!==s&&(this.emit("dataChange",this,{[e]:s}),this.emit("dataChangeProperty",this,e,t,s))}get data(){var e;return null!==(e=this._proxy)&&void 0!==e&&e.proxy?this._proxy.proxy:this._data}get plainData(){return l({},this._data)}get marks(){return this._marks||(this._marks=new Map),this._marks}get id(){const e=this.data[this.fieldId?this.fieldId.toString():"id"];return void 0===e?this._id:e}})||r)||r);var u},96430:(e,t,s)=>{"use strict";s.d(t,{E:()=>n});s(66992),s(33948);var i=s(92934),o=s(62430),r=s(29084);function n(e){return function(t,s,n){const a=n.value;if(t instanceof r.T){var l;const s=(0,o.O)(t);s.cancelable=null!==(l=s.cancelable)&&void 0!==l?l:new Set;const r=(0,i.D)((function(...e){this.isDestroyed||a.apply(this,e)}),e);return n.value=r,s.cancelable.add(r),n}return n.value=(0,i.D)(a,e),n}}},70807:(e,t,s)=>{"use strict";s.d(t,{p:()=>r});s(66992),s(33948);var i=s(29084),o=s(62430);function r(e,t){return function(s,r,n){if(!(s instanceof i.T))return n;const a=(0,o.O)(s);return a.listDelegatedEvents=a.listDelegatedEvents||new Set,a.listDelegatedEvents.add({events:e,selector:t,handler:n.value}),n}}},83801:(e,t,s)=>{"use strict";s.d(t,{x:()=>i});const i=!!window.CSS&&window.CSS.supports("color","var(--primary)")},59639:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function isSupportedAsync(){try{return eval("async () => {}"),!0}catch(e){return!1}}__webpack_require__.d(__webpack_exports__,{N:()=>IS_DETECTED_ASYNC});const IS_DETECTED_ASYNC=isSupportedAsync()},7016:(e,t,s)=>{"use strict";s.d(t,{v:()=>i});const i="IntersectionObserver"in window},39844:(e,t,s)=>{"use strict";s.d(t,{L:()=>i});s(74916);function i(){const e=navigator.userAgent.match(/windows nt (\d+\.\d+)/i);return Boolean(e&&parseFloat(e[1])<10)}},95593:(e,t,s)=>{"use strict";s.d(t,{S:()=>o,i:()=>i});s(66992),s(33948);function i(e,t){return Object.values(e).includes(t)?t:Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function o(e,t){for(const[s,i]of Object.entries(e))if(i===t)return s}},76148:(e,t,s)=>{"use strict";s.d(t,{v:()=>c});s(66992),s(33948),s(41817);function i(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class o{constructor(e,t,s,o,r=!1,n){if(i(this,"__isDestroyed",!1),!s||!o)throw new Error("need listener & target");this.event=e,this.callback=t,this.listener=s,this.target=o,this.isOnce=r,this.limitOptions=n,s.addEventEmitterListener(this,!0),o.addEventEmitterListener(this,!1)}destroy(){this.__isDestroyed||(this.__isDestroyed=!0,this.listener&&(this.listener.removeEventEmitterListener(this,!0),this.listener=void 0),this.target&&(this.target.removeEventEmitterListener(this,!1),this.target=void 0),this.callback=void 0)}apply(e){if(this.__isDestroyed||!this.callback)return;const t=this.callback.apply(this.listener,e);return this.isOnce&&this.destroy(),t}destroyByFilter(e,t,s,i){s&&this.target!==s||t&&this.callback!==t||i&&this.listener!==i||void 0!==e&&this.event!==e||this.destroy()}}var r=s(76405),n=s(29084),a=s(27743);function l(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class c extends n.T{constructor(...e){super(...e),l(this,"emitter",this)}emit(e,...t){var s;if(!this.listenersSelfByEvent)return;const i=this.listenersSelfByEvent.get(e);if(i&&i.forEach((s=>{s.limitOptions&&!1!==this.emitByLimit(e,s,t)||s.apply(t)})),null===(s=this.listenersSelfByEvent)||void 0===s||!s.has("_eventAll"))return;const o=this.listenersSelfByEvent.get("_eventAll");o&&o.forEach((s=>s.apply([e,...t])))}emitResult(e,...t){if(!this.listenersSelfByEvent)return;const s=this.listenersSelfByEvent.get(e);if(s)for(const i of s.values()){if(i.limitOptions&&!1!==this.emitByLimit(e,i,t))return;const s=i.apply(t);if(void 0!==s)return s}}on(e,t,s){return this.listenTo(this,e,t,s),this}onByMap(e,t){this.listenToByMap(this,e,t)}once(e,t,s){this.listenToOnce(this,e,t,s)}onceByMap(e,t){this.listenToOnceByMap(this,e,t)}off(e,t,s,i){var o,r;if(!this.listenersSelf||!this.listenersSelfByEvent)return;const n="_eventHook"===e||!this.listenersSelfByEvent.has("_eventHook"),a=Boolean(null!==(o=null!==(r=null!=e?e:t)&&void 0!==r?r:s)&&void 0!==o?o:i);this.listenersSelf.forEach((i=>{(n||"_eventHook"!==i.event)&&(a?i.destroyByFilter(e,t,void 0,s):i.destroy())})),!n&&this.listenersSelf&&this.listenersSelf.forEach((i=>{a?i.destroyByFilter(e,t,void 0,s):i.destroy()}))}listenTo(e,t,s,i,r){return"function"!=typeof s||"number"!=typeof t&&"string"!=typeof t||new o(t,s,this,e,!0===r,i),this}listenToByMap(e,t,s,i){if("object"==typeof t&&!Array.isArray(t)){i=!0===i;for(const[s,r]of Object.entries(t))"function"==typeof r&&new o(s,r,this,e,i)}}listenToOnce(e,t,s,i){this.listenTo(e,t,s,i,!0)}listenToOnceByMap(e,t,s){this.listenToByMap(e,t,s,!0)}stopListening(e,t,s,i){var o,r;if(!this.listenersTo)return;const n="_eventHook"===t,a=Boolean(null!==(o=null!==(r=null!=t?t:s)&&void 0!==r?r:e)&&void 0!==o?o:i);this.listenersTo.forEach((i=>{(n||"_eventHook"!==i.event)&&(a?i.destroyByFilter(t,s,e):i.destroy())})),!n&&this.listenersTo&&this.listenersTo.forEach((i=>{a?i.destroyByFilter(t,s,e):i.destroy()}))}destroy(e=!1){if(!this.isDestroyed){if(super.destroy(),!e)try{this.emitter.emit("_destroy")}catch(t){a.kg.error("emitter","cant destroy")}this.off(),this.stopListening(),delete this.emitter}}addEventEmitterListener(e,t){if(t)return this.listenersTo||(this.listenersTo=new Set),void this.listenersTo.add(e);(this.listenersSelf||(this.listenersSelf=new Set)).add(e);const s=e.event,i=this.listenersSelfByEvent||(this.listenersSelfByEvent=new Map),o="_eventHook"!==s&&i.has("_eventHook");let n=i.get(s);n||(i.set(s,n=new Set),o&&this.emitter.emit("_eventHook",r.Z.FIRST_ON,s,e)),n.add(e),o&&this.emitter.emit("_eventHook",r.Z.ON,s,e)}removeEventEmitterListener(e,t){if(t){if(!this.listenersTo)return;return this.listenersTo.delete(e),void(this.listenersTo.size||delete this.listenersTo)}if(this.listenersSelf&&(this.listenersSelf.delete(e),this.listenersSelf.size||delete this.listenersSelf),!this.listenersSelfByEvent)return;const s=this.listenersSelfByEvent,i=e.event,o=s.get(i),n="_eventHook"!==i&&s.has("_eventHook");o&&(o.delete(e),n&&this.emitter.emit("_eventHook",r.Z.OFF,i,e),o.size||(this.listenersSelfByEvent.delete(i),this.listenersSelfByEvent.size||delete this.listenersSelfByEvent,n&&this.emitter.emit("_eventHook",r.Z.LAST_OFF,i,e)))}emitByLimit(e,t,s){return!1}get hook(){return{on:(e,t)=>{this.emitter.listenTo(this,"_eventHook",((s,i,o)=>{i===e&&t(s,o.apply.bind(this))}))}}}}},76405:(e,t,s)=>{"use strict";let i;s.d(t,{Z:()=>i}),function(e){e.FIRST_ON="$firstOn",e.LAST_OFF="$lastOff",e.ON="$on",e.OFF="$off"}(i||(i={}))},2439:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o.Z,v:()=>i.v});var i=s(76148),o=s(76405)},84947:(e,t,s)=>{"use strict";s.d(t,{H:()=>i});class i extends Error{constructor(e,t){super(`there was a problem accessing the api ${e}`),t&&(this.message=`[CODE: ${t}] ${this.message}`),this.name=this.constructor.name,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,i)}}},91904:(e,t,s)=>{"use strict";s.d(t,{t:()=>y.t,V:()=>b});s(85827),s(41817),s(66992),s(33948);function i(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const o=new Map;class r{constructor(e=0){i(this,"lastUseTime",Date.now()),this.defaultTTL=e}static get(e,t){const s=o.get(e);if(s)return s;const i=new r(t);return o.set(e,i),i}static get size(){return o.size}static has(e){return o.has(e)}static remove(e){o.delete(e)}static removeUnused(e=12e4){o.forEach(((t,s)=>{var i;t.removeUnused(e),null!==(i=t.data)&&void 0!==i&&i.size||o.delete(s)}))}static removeExpired(){o.forEach(((e,t)=>{var s;e.removeExpired(),null!==(s=e.data)&&void 0!==s&&s.size||o.delete(t)}))}static clear(){o.clear()}get(e){if(!this.data)return;const t=this.data.get(e);if(t){if(!(t.expireTime&&Date.now()>=t.expireTime))return this.lastUseTime=t.lastUseTime=Date.now(),t.data;this.data.delete(e)}}set(e,t,s=this.defaultTTL){this.data||(this.data=new Map);const i=this.lastUseTime=Date.now();return this.data.set(e,{data:t,lastUseTime:i,expireTime:s?i+s:void 0}),t}has(e){if(this.lastUseTime=Date.now(),!this.data)return!1;const t=this.data.get(e);return!!t&&(!(t.expireTime&&Date.now()>=t.expireTime)||(this.data.delete(e),!1))}remove(e){return!this.data||this.data.delete(e)}removeUnused(e=12e4){if(!this.data||!this.data.size)return;const t=Date.now()-e,s=this.data;this.lastUseTime<=t?s.clear():s.forEach((({lastUseTime:e},i)=>{e<=t&&s.delete(i)}))}removeExpired(){if(!this.data||!this.data.size)return;const e=Date.now(),t=this.data;t.forEach((({expireTime:s},i)=>{s&&s<e&&t.delete(i)}))}}var n=s(65704);var a,l,c,d=s(29084);function u(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}let p=(a=function(e=(0,n.E)("cache"),t){return function(s,i,o){void 0===o&&(o=Object.getOwnPropertyDescriptor(s,i));const n=o.value;return o.value=function(...s){const i=(" "+s.toString().slice(0,100)).slice(1),o=r.get(e);if(o.has(i))return o.get(i);const a=n.apply(this,s);return o.set(i,a,t),a},o}}("data",6e4),c=class e extends d.T{constructor(){super()}static getInstance(){return e.instance?e.instance:e.instance=new e}getList(){var e,t;return null!==(e=null===(t=window.PkbAnalytics)||void 0===t?void 0:t.experiments)&&void 0!==e?e:{}}isUserInExperiment(e,t){const s=this.getUserExperimentGroup(e);return!!s&&(t?s===t:!this.isControlGroup(e))}getUserExperimentGroup(e){return this.getList()[e]}isUserInControlGroup(e){const t=this.getUserExperimentGroup(e);return!!t&&this.isControlGroup(t)}isControlGroup(t){return t===e.NAME_CONTROL_GROUP_00||t===e.NAME_CONTROL_GROUP_01}},u(c,"NAME_CONTROL_GROUP_00","c0"),u(c,"NAME_CONTROL_GROUP_01","c1"),h=(l=c).prototype,_="getList",m=[a],g=Object.getOwnPropertyDescriptor(l.prototype,"getList"),v=l.prototype,f={},Object.keys(g).forEach((function(e){f[e]=g[e]})),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=m.slice().reverse().reduce((function(e,t){return t(h,_,e)||e}),f),v&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(v):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(h,_,f),f=null),l);var h,_,m,g,v,f,y=s(37733);const b=p.getInstance()},37733:(e,t,s)=>{"use strict";let i;s.d(t,{t:()=>i}),function(e){e.PAID_SUBS="paid_subs_20230310",e.DISABLE_ADBLOCK_POPUP="disable_adblock_popup_20220725",e.GALLERY="gallery_20220413",e.COMMENTS_ADS_2="comments_ads_2_20230127",e.COMMENTS_UX_FIX="comments_ux_fix_20220415",e.NO_EMOTIONS="no_emotions_20230228",e.APP_POPUP_2="go_to_app_2_20230220",e.CONTENT_NPS="content_nps_20230323",e.VIDEO_FINISHED="video_finished_20230322",e.VIDEO_STREAMING="boost_load_video_20230629",e.BROWSING_PAGE_V2="browsing_page_v2_20231016",e.ACTIONS_BAR="actions_bar_20231103",e.SPECIALS_FEED_POST_BANNER="specials_feed_post_banner_20231030",e.MIXED_VIDEOS_UNDER_COMMENTS="mixed_videos_under_comments_20240514",e.COMMENT_POSITION_ON_TAG_PAGE="comment_position_on_tag_page_20240816",e.COMMENT_POSITION_ON_HOT_PAGE="comment_position_on_hot_page_20240912",e.COMMENT_POSITION_ON_POST_PAGE="comment_position_on_post_page_20240816",e.SUBSCRIBE_ON_REG="subscribe_on_reg_20240926",e.COMMENTS_SUBSCRIPTION="comments_subscription_20241001",e.ADULT_CONTENT_UNDER_POST="adult_content_under_post_20241028",e.GOOGLE_POPUP="google_popup_20241024"}(i||(i={}))},34653:(e,t,s)=>{"use strict";function i(e,t={day:"2-digit",month:"2-digit",year:"numeric"}){const s=e instanceof Date?e:new Date(e);if(isNaN(s.valueOf()))return"";const i=s.toLocaleDateString("ru",t);return i.charAt(0).toUpperCase()+i.slice(1)}s.d(t,{p:()=>i})},29460:(e,t,s)=>{"use strict";s.d(t,{k:()=>o});var i=s(12953);function o(e){if(e<=60)return`${e} ${i.core.i18n("plural.seconds",e)}`;const t=Math.floor(e/3600),s=Math.ceil((e-3600*t)/60);return`${t>0?`${t} ${i.core.i18n("plural.hours",t)}`:""} ${s>0?`${s} ${i.core.i18n("plural.minutes",s)}`:""}`}},92514:(e,t,s)=>{"use strict";function i(e){return Number(e).toLocaleString("ru")}s.d(t,{xG:()=>o,p6:()=>r.p,uf:()=>i,m9:()=>a,cw:()=>n,mr:()=>u,kT:()=>l.k});s(74916),s(15306);function o(e,t=0){return Number(e).toLocaleString("ru",{style:"currency",currency:"RUB",currencyDisplay:"symbol",minimumFractionDigits:t,maximumFractionDigits:t}).replace("RUB","₽")}var r=s(34653);function n(e,t){return`${e>=t?100:Math.round(100*e/t)}%`}function a(e){return parseFloat((100*Number(e)).toFixed(2)).toLocaleString("ru")+"%"}var l=s(29460);const c=60,d=60*c;function u(e){return[Math.floor(e/d),Math.floor(e%d/c),Math.floor(e%c)].map((e=>String(e).padStart(2,"0"))).join(":")}},55529:(e,t,s)=>{"use strict";s.d(t,{e:()=>i});s(66992),s(33948);function i(e=document.body){const t=new Set(["SVG","SCRIPT","NOSCRIPT","STYLE"]),s=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,(e=>t.has(e.nodeName.toUpperCase())?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT));let i=0,o=s.nextNode();for(;o;){const e=Number(getComputedStyle(o).zIndex);isNaN(e)?o=s.nextNode():(o=s.nextSibling()||s.nextNode(),i=Math.max(e,i))}return i+1}},77754:(e,t,s)=>{"use strict";s.d(t,{N:()=>o});s(88674),s(66992),s(3462),s(33824),s(33948),s(41817);function i(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class o{static async descrambleUrl(e,t){const s=await fetch(e).then((e=>e.arrayBuffer())).then((e=>new Uint8Array(e)));return o.descramble(s,t)}static descramble(e,t){const s=o.findEncodedImageBytesOffset(e);if(0===s)throw new Error("Cannot find separator in the image data");return o.decodeImageBytes(e,s,t)}static decodeImageBytes(e,t,s){const i=String.fromCharCode(...[...e.slice(t,t+o.MIME_LENGTH)].filter((e=>e>0))),r=e[t+o.MIME_LENGTH];if(e=e.slice(t+o.MIME_LENGTH+1),1===r){const t=(e,t)=>(e%t+t)%t;for(let i=0,o=e.length;i<o;i++)e[i]=t(e[i]-s,256)}const n=[];for(let o=0;o<e.length;o+=5e3)n.push(String.fromCharCode.apply(null,Array.from(e.slice(o,o+5e3))));return`data:${i};base64,`+btoa(n.join(""))}static findEncodedImageBytesOffset(e){const t=o.IMAGE_DATA_SEPARATOR.split("").map((e=>e.charCodeAt(0))),s=t[0];e:for(let i=o.SUBSTITUTE_MIN_LENGTH,r=e.length;i<r;i++)if(e[i]===s){for(let s=1;s<t.length;s++)if(e[i+s]!==t[s])continue e;return i+t.length}return 0}}i(o,"IMAGE_DATA_SEPARATOR","\0\0\0\0scramble:"),i(o,"MIME_LENGTH",20),i(o,"SUBSTITUTE_MIN_LENGTH",1e4)},91719:(e,t,s)=>{"use strict";s.d(t,{Q:()=>i});s(74916);function i(e){var t,s,i,o;const r=e.dataset.src||e.src,n=e.dataset.largeImage||r;if(!e.dataset.scramblerOffset)return n;const a=n.match(/\/(\w+)\.gif$/);if(!a)return n;const l=a[1],c=(null===(t=e.closest(".comment"))||void 0===t||null===(s=t.dataset)||void 0===s?void 0:s.id)||"",d=""===c&&(null===(i=e.closest(".story"))||void 0===i||null===(o=i.dataset)||void 0===o?void 0:o.storyId)||"";return""!==c?`/nsfw-view/comment/${c}/${l}`:`/nsfw-view/story/${d}/${l}`}},99942:(e,t,s)=>{"use strict";s.d(t,{EB:()=>i,Qs:()=>o,Y0:()=>r});const i=".image-lazy:not(.image-lazy-processed)",o="image-loaded",r="image-lazy-processed"},56927:(e,t,s)=>{"use strict";s.d(t,{z:()=>r});var i=s(99942),o=s(77754);class r{constructor(){this.intersectionObserver=new IntersectionObserver(this.onIntersectionObserver.bind(this),{rootMargin:"200% 0px"})}static getInstance(){return r.instance?r.instance:r.instance=new r}static prepareImage(e){if(e.classList.contains(i.Y0))return;e.classList.add(i.Y0);const t=e.querySelector("img");if(!t||t.classList.contains(i.Y0))return;t.classList.add(i.Y0);const s=t.dataset.src;s&&"string"==typeof s&&(t.dataset.scramblerOffset?o.N.descrambleUrl(s,Number(t.dataset.scramblerOffset)).then((e=>{t.src=e,t.classList.add(i.Qs)})):(t.classList.add(i.Qs),t.setAttribute("src",s)))}unobserve(e){e.querySelectorAll(".image-lazy").forEach((e=>{this.intersectionObserver.unobserve(e)}))}init(){document.querySelectorAll(i.EB).forEach((e=>{this.intersectionObserver.observe(e)}))}onIntersectionObserver(e){e.forEach((e=>{if(!e.isIntersecting)return;const t=e.target;this.intersectionObserver.unobserve(t),r.prepareImage(t)}))}}},27743:(e,t,s)=>{"use strict";s.d(t,{kg:()=>n});s(66992),s(33948),s(41817);let i;!function(e){e[e.LOG=7]="LOG",e[e.INFO=6]="INFO",e[e.WARN=4]="WARN",e[e.ERROR=3]="ERROR"}(i||(i={}));i.LOG,i.INFO,i.WARN,i.ERROR;function o(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class r{constructor(){o(this,"startTime",Date.now()),this.transports=new Map}static getInstance(){return r.instance?r.instance:r.instance=new r}error(e,t,s){this.sendToTransports(i.ERROR,e,t,s)}warn(e,t,s){this.sendToTransports(i.WARN,e,t,s)}info(e,t,s){this.sendToTransports(i.INFO,e,t,s)}log(e,t,s){this.sendToTransports(i.LOG,e,t,s)}sendToTransports(e,t,s,i){const o=new Date,r=o.valueOf(),n=r-this.startTime,a={timestamp:r,date:o.toISOString(),afterStart:n,level:e,subject:t,message:s,fields:i};this.transports.forEach((t=>e<=t.level&&t.sendMessage(a)))}}const n=r.getInstance()},44760:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});s(88674),s(66992),s(33948);function i(e,t=1){const s=[];return async function i(...o){if(s.length>=t)try{await Promise.race(s)}finally{return i(...o)}const r=e(...o);s.push(r);try{return await r}finally{s.splice(s.indexOf(r),1)}}}},36830:(e,t,s)=>{"use strict";s.d(t,{g:()=>o});var i=s(53056);function o(e){i.m.set("pkb_mar",{messageAfterReload:e})}},70017:(e,t,s)=>{"use strict";s.d(t,{e:()=>l});s(74916),s(15306),s(66992),s(33948),s(41817);function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function o(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const n=/(%[\da-f]{2})+/gi,a=/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[B-D])/g;class l{static set(e,t,s={}){if("number"==typeof(s=o({path:"/"},s)).expires){const e=new Date;e.setMilliseconds(e.getMilliseconds()+864e5*s.expires),s.expires=e}if("string"!=typeof t&&"number"!=typeof t)try{const e=JSON.stringify(t);t=/^[[{]/.test(e)?e:t.toString()}catch(i){}return t=encodeURIComponent(t.toString()).replace(a,decodeURIComponent),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),document.cookie=[e,"=",t,s.expires?"; expires="+s.expires.toUTCString():"",s.path?"; path="+s.path:"",s.domain?"; domain="+s.domain:"",s.secure?"; secure":"",s.sameSite?"; samesite="+s.sameSite:"",s.httpOnly?"; HttpOnly":""].join("")}static getAll(){const e=document.cookie?document.cookie.split("; "):[],t=new Map;for(const s of e){const[e,i]=s.split("=").map((e=>(e.startsWith('"')&&(e=s.slice(1,-1)),e.replace(n,decodeURIComponent))));t.set(e,i)}return t}static get(e,t=!1){const s=l.getAll().get(e);if(s){if(t)try{return JSON.parse(s)}catch(i){}return s}}static remove(e,t={}){return l.set(e,"",o({expires:-1},t))}}},53056:(e,t,s)=>{"use strict";s.d(t,{m:()=>o});const i=s(98859).O?window.localStorage:void 0;class o{static set(e,t){void 0!==i&&i.setItem(e,JSON.stringify(t))}static get(e,t=!0){if(void 0===i)return;const s=i.getItem(e);if("string"==typeof s){if(t)try{return JSON.parse(s)}catch(o){return s||void 0}return s}}static remove(e){void 0!==i&&i.removeItem(e)}static clear(){void 0!==i&&i.clear()}}},34524:(e,t,s)=>{"use strict";s.d(t,{q:()=>o,x:()=>r});s(41817);const i=function(){try{const e="_t";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}()?window.sessionStorage:void 0,o="pkb_sst";class r{static set(e,t,s=!1){void 0!==i&&(s&&(t.timestamp=Date.now()),i.setItem(e,JSON.stringify(t)))}static get(e,t=!0){if(void 0===i)return;const s=i.getItem(e);if("string"==typeof s){if(!t)return s;try{const e=JSON.parse(s);if(e.timestamp&&this.isDataExpired(e.timestamp))return;return e}catch(o){return s||void 0}}}static remove(e){void 0!==i&&i.removeItem(e)}static clear(){void 0!==i&&i.clear()}static isDataExpired(e){return Date.now()-e>this.SESSION_STORAGE_DATA_TTL}}var n,a,l;n=r,l=864e5,(a=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(a="SESSION_STORAGE_DATA_TTL"))in n?Object.defineProperty(n,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):n[a]=l},79025:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});s(88674),s(66992),s(33948);var i=s(33877),o=s(12953);class r{start(e=0,t,s=1e3){let r=!1;const n=async()=>{if(0!==e&&!r){try{if(!o.core.sw.target)throw new Error;await o.core.sw.query("timeout",s)}catch(a){await(0,i.g)(s)}t(--e),n()}};return(async()=>{try{await Promise.race([this.initPromise(),async()=>{throw await(0,i.g)(300),new Error}])}catch(e){o.core.initSW()}n()})(),()=>{r=!0}}initPromise(){return void 0!==this.promise||(this.promise=new Promise((e=>{o.core.once("sw-ready",e)}))),this.promise}}},79431:(e,t,s)=>{"use strict";s.d(t,{hA:()=>r,NM:()=>d});s(88674),s(41817);const i="target-actions";var o=s(90647);let r;!function(e){e.STORY_DRAFTS_PAGE="story-drafts-page",e.SPECIALS_PROMO_BUTTON="specials-promo-button",e.COMMENT_REPLY_UNSUPPORTED_BROWSER="comment-reply-unsupported-browser",e.DEPRECATED_AUTH_DIALOG_CHECK_TS="deprecated-auth-dialog-check-ts"}(r||(r={}));const n={};function a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function l(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?a(Object(s),!0).forEach((function(t){c(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function c(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const d=new class{constructor(){c(this,"observers",{})}async getDB(){var e;return null!==(e=this.db)&&void 0!==e?e:this.db=await(0,o.X3)("pikabu",1,{upgrade(e){e.objectStoreNames.contains(i)||e.createObjectStore(i)}})}getOptions(e){var t;return l(l({},n[e]),{},{limit:(null===(t=n[e])||void 0===t?void 0:t.limit)||1})}async add(e,t){try{const s=await this.getDB(),o=this.getOptions(e).limit,r=s.transaction(i,"readwrite");let n=await r.store.get(e);Array.isArray(n)||(n=[]),n.push(t),n=n.slice(-o),await r.store.put(n,e),await r.done,this.broadcast(e,n)}catch(s){console.error(s)}}async get(e,t){try{var s;const o=await this.getDB(),r=null!==(s=await o.get(i,e))&&void 0!==s?s:[];return t?r.filter(t):r}catch(o){return console.error(o),[]}}async has(e,t){try{const s=await this.get(e,t);return Boolean(s.length)}catch(s){return console.error(s),!1}}async clear(e){try{const t=await this.getDB();await t.delete(i,e)}catch(t){console.error(t)}}subscribe(e,t){var s,i;return null!==(i=(s=this.observers)[e])&&void 0!==i||(s[e]=[]),this.observers[e].includes(t)||this.observers[e].push(t),()=>this.unsubscribe(e,t)}unsubscribe(e,t){this.observers[e].splice(this.observers[e].indexOf(t),1)}broadcast(e,t){var s;null===(s=this.observers[e])||void 0===s||s.forEach((e=>e(t)))}}},25883:(e,t,s)=>{"use strict";s.d(t,{k:()=>i});const i=e=>{const t="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D".split(" ").map((e=>parseInt(e,16)));let s=-1;for(let i=0,o=e.length;i<o;i++)s=s>>>8^t[255&(s^e.charCodeAt(i))];return(-1^s)>>>0}},10553:(e,t,s)=>{"use strict";s.d(t,{t:()=>i});s(85827);function i(e,...t){e="icon--"+e;return`<svg xmlns="http://www.w3.org/2000/svg" class="icon ${t.reduce(((t,s)=>t+` ${e}_${s}`),e)}"><use xlink:href="#${e}"></use></svg>`}},87864:(e,t,s)=>{"use strict";s.d(t,{m:()=>o});var i=s(10370);function o(e){const t=(0,i.r)(e).firstElementChild;if(t instanceof HTMLElement)return t;throw new Error("error parsing HTML")}},10370:(e,t,s)=>{"use strict";function i(e){const t=document.createElement("template");return t.innerHTML=e,t.content}s.d(t,{r:()=>i})},35249:(e,t,s)=>{"use strict";s.d(t,{k:()=>i});s(74916);function i(e){const t=document.createElement("a");return t.href=e,{path:t.pathname+t.search,pathname:t.pathname,hostname:t.hostname,search:t.search,hash:t.hash}}},86455:(e,t,s)=>{"use strict";let i;s.d(t,{j:()=>i}),function(e){e.DEFAULT="",e.SUCCESS="success",e.DANGER="danger",e.WARNING="warning",e.DARK="dark"}(i||(i={}))},92948:(e,t,s)=>{"use strict";function i(e){let t=0,s=e;for(;s;){if(s.dataset.id){t=Number(s.dataset.id);break}s=s.parentElement}return t}s.d(t,{$:()=>i})},61547:(e,t,s)=>{"use strict";s.d(t,{Y:()=>a});var i=s(19578),o=s(19755),r=s.n(o);function n(e){return r()(e).data(i.M)||null}function a(e,t=40){for(;e&&e!==document.documentElement&&t-- >0;){if(!e)return null;if(e&&i.K in e)return n(e);e=e.parentElement}return null}},19578:(e,t,s)=>{"use strict";s.d(t,{K:()=>i,M:()=>o});const i="_uiElement",o="_uiElement"},43241:(e,t,s)=>{"use strict";s.d(t,{u:()=>c});s(41817);var i=s(76148),o=s(19578),r=s(19755),n=s.n(r);function a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function l(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class c extends i.v{constructor(e){super(),l(this,"emitter",this),l(this,"_isShown",!1),l(this,"_isRendered",!1),l(this,"_isMounted",!1),l(this,"destroyBound",(()=>{this.emitter.emit("uiRemoved",this),this.destroy()})),e&&this.setOptions(function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?a(Object(s),!0).forEach((function(t){l(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({destroyAfterRemove:!0},e))}destroy(){if(this.isDestroyed)return;this.unmount(),this.emitter.emit("uiDestroyed",this);const e=this.$el;e&&(this.destroyAfterRemove&&(this.destroyAfterRemove=!1),e.off(),delete this._options.el[o.K],e.removeData(o.M),e.empty().remove());for(const t in this._options)Object.prototype.hasOwnProperty.call(this._options,t)&&delete this._options[t];this.cancelTimeout(),this.cancelInterval(),super.destroy()}render(){return this._isRendered=!0,this.emitter.emit("uiRendered",this),this}show(){return this.render(),this.mount(),this._isShown=!0,this}hide(){return this.unmount(),this._isShown=!1,this}mount(){return this.isMounted||(this.$el&&this.$parent&&this.$el.parent()!==this.$parent&&this.$el.appendTo(this.$parent),this.emitter.emit("uiMounted",this),this._isMounted=!0),this}unmount(){return this.isMounted?(this.$el&&this.$el.detach(),this.emitter.emit("uiUnmounted",this),this._isMounted=!1,this):this}$(e){const t=this.$el;if(t)return t.find(e)}onRemoveEvent(e){}offRemoveEvent(e){}get $el(){return this._options.$el}set $el(e){const t=this.$el,s=null==e,i=e instanceof HTMLElement||e instanceof n()&&e.length>0;if(!s&&!i)throw new Error("$el attribute can [JQuery|undefined] "+typeof e);if(t&&(this._options.el&&delete this._options.el[o.K],t.removeData(o.M),this.offRemoveEvent(t)),null==e)return t&&t.remove(),delete this._options.el,delete this._options.$el,void(this._isMounted=this._isRendered=this._isShown=!1);e=n()(e).eq(0);const r=this._options.el=e[0];!r.parentNode||r.parentNode instanceof DocumentFragment||(this._isMounted=!0,this.$parent=n()(r.parentNode)),this.destroyAfterRemove&&this.onRemoveEvent(e),Object.defineProperty(this._options.el,o.K,{value:!0,configurable:!0,writable:!1,enumerable:!1}),this._options.$el=n()(e).eq(0),this._options.$el.data(o.M,this)}get el(){return this._options.el}set el(e){if(void 0!==e){if(null===e||!(e instanceof HTMLElement))throw new Error("el attribute can [HTMLElement|undefined] "+typeof e);this.$el=n()(e),this._options.el=e}else this.$el=void 0}get $parent(){return this._options.$parent}set $parent(e){if(!e)throw new Error("$parent attribute can [HTMLElement|JQuery]"+typeof e);this._options.$parent=n()(e).eq(0)}get destroyAfterRemove(){return this._options.destroyAfterRemove}set destroyAfterRemove(e){if(this._options.destroyAfterRemove===(e=Boolean(e)))return;this._options.destroyAfterRemove=e;const t=this.$el;t&&(e?this.onRemoveEvent(t):this.offRemoveEvent(t))}get isMounted(){return this._isMounted}get isShown(){return this._isShown}get isRendered(){return this._isRendered}get eid(){return this._eid||(this._eid=Symbol("UIElement")),this._eid}}},82800:(e,t,s)=>{"use strict";let i,o,r;s.d(t,{Lh:()=>o,SE:()=>r,xb:()=>i}),function(e){e.DEFAULT="",e.GRAY="gray",e.WARNING="warning",e.DANGER="danger",e.GREEN="green"}(i||(i={})),function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.TOP=2]="TOP",e[e.BOTTOM=3]="BOTTOM"}(o||(o={})),function(e){e[e.START=0]="START",e[e.CENTER=1]="CENTER",e[e.END=2]="END"}(r||(r={}))},41773:(e,t,s)=>{"use strict";let i;s.d(t,{j:()=>i,E:()=>n}),function(e){e[e.COMMUNITY_STAT_TOOLTIP=1]="COMMUNITY_STAT_TOOLTIP",e[e.COMMUNITY_STAT_TOOLTIP_STEP1=2]="COMMUNITY_STAT_TOOLTIP_STEP1",e[e.COMMUNITY_STAT_TOOLTIP_STEP2=3]="COMMUNITY_STAT_TOOLTIP_STEP2",e[e.COMMUNITY_STAT_TOOLTIP_NEW_STEP2=4]="COMMUNITY_STAT_TOOLTIP_NEW_STEP2",e[e.STORIES_FOR_SUBSCRIBERS_FEATURE=5]="STORIES_FOR_SUBSCRIBERS_FEATURE",e[e.SCHEDULED_STORY_TOOLTIP=6]="SCHEDULED_STORY_TOOLTIP",e[e.INTERESTED_TOPICS_TOOLTIP=7]="INTERESTED_TOPICS_TOOLTIP",e[e.SERIES_AUTHOR_TOOLTIP=8]="SERIES_AUTHOR_TOOLTIP",e[e.SERIES_USER_TOOLTIP=9]="SERIES_USER_TOOLTIP",e[e.NEW_EDITOR_INTRO=10]="NEW_EDITOR_INTRO",e[e.PUBLIC_RATINGS_AUTHORS_BANNER=11]="PUBLIC_RATINGS_AUTHORS_BANNER",e[e.PUBLIC_RATINGS_COMMENTATORS_BANNER=12]="PUBLIC_RATINGS_COMMENTATORS_BANNER",e[e.HIDE_QUESTIONS_EDITOR_PROMO=14]="HIDE_QUESTIONS_EDITOR_PROMO",e[e.HIDE_QUESTIONS_FAST_LINK=15]="HIDE_QUESTIONS_FAST_LINK",e[e.HIDE_MULTIPLE_SAVE_CATS_INFO=16]="HIDE_MULTIPLE_SAVE_CATS_INFO",e[e.VIDEO_FEED_ONBOARDING=17]="VIDEO_FEED_ONBOARDING",e[e.ADBLOCK_WARNING=18]="ADBLOCK_WARNING",e[e.PROPERTY_SHOW_SET_TOP_AUTHOR_TOOLTIP=19]="PROPERTY_SHOW_SET_TOP_AUTHOR_TOOLTIP",e[e.HIDE_EXPERTS_TOPICS_TOOLTIP=20]="HIDE_EXPERTS_TOPICS_TOOLTIP"}(i||(i={}));var o=s(12953),r=s(12950);class n{static setInit(){void 0===n.currentFlags&&(n.currentFlags=Number(o.core.initParams.userFlags))}static get(){return n.setInit(),n.currentFlags}static has(e){n.setInit();const t=1<<e-1;return(n.currentFlags&t)===t}static set(e,t){if(n.setInit(),n.has(e)===t)return;const s=1<<e-1;n.currentFlags=t?n.currentFlags|s:n.currentFlags&~s,r.cf.post("/ajax/user/property-change",{flag_number:e,value:Number(t)})}}},14292:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'h3{margin:16px 0 12px}.single-block__br--eRGfdaFT{position:relative;display:block;margin-top:16px;text-decoration:none !important;border:1px solid var(--color-black-430);background-color:var(--color-bright-800);background-position:right bottom;color:var(--color-black-940);height:106px;padding:15px 0 0 23px;border-radius:8px;background-image:url("https://cs.pikabu.ru/images/browsing/browsing_bg_dv.png");background-size:282px 106px}@media(min-resolution: 192dpi),(min-resolution: 2dppx){.single-block__br--eRGfdaFT{background-image:url("https://cs.pikabu.ru/images/browsing/browsing_bg_dv@2x.png")}}@media(-webkit-min-device-pixel-ratio: 2),(min-device-pixel-ratio: 2){.single-block__br--eRGfdaFT{background-image:url("https://cs.pikabu.ru/images/browsing/browsing_bg_dv@2x.png")}}.single-block__caption--tBjCAyPl{margin-bottom:16px;font-size:20px;line-height:28px;font-weight:400}',""]),n.locals={br:"single-block__br--eRGfdaFT",caption:"single-block__caption--tBjCAyPl"};const a=n},93089:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.cards-view__container--PjuzNeLL{display:flex;justify-content:space-between}.cards-view__block--voEUIUB2{position:relative;height:130px;border-radius:8px;overflow:hidden;transition:background .5s ease-out}.cards-view__block_of_3--xUtRsLxz{width:32%}.cards-view__block_of_4--fYDicO8F{width:24%}.cards-view__block--voEUIUB2::after{content:"";opacity:0;position:absolute;left:0;top:0;width:100%;height:100%;background:#000;z-index:0;transition:opacity 200ms ease-out}.cards-view__block--voEUIUB2:hover::after{opacity:.04}.cards-view__block_green--cpcnFpRz{background-image:radial-gradient(122.88% 141.42% at 0% 100%, #8bca58 0%, #6bad42 100%)}.cards-view__block_purple--tHWPt75u{background-image:radial-gradient(100.25% 133.64% at 39.64% 119.23%, #a658ca 0%, #4442ad 100%)}.cards-view__block_sea--POCZhrFn{background-image:radial-gradient(100.25% 133.64% at 39.64% 119.23%, #8aca58 0%, #42ada7 100%)}.cards-view__block_orange--ru5mewjb{background-image:radial-gradient(100.25% 133.64% at 39.64% 119.23%, #cb5959 0%, #eda841 100%)}.cards-view__block_white--SHzYTQr6{background:var(--color-bright-800)}.cards-view__card--A9qKg19V{position:relative;display:block;width:100%;height:100%;border-radius:8px;z-index:1}.cards-view__closeAdultModalBtn--HNUaSOrT{margin-left:12px}',""]),n.locals={container:"cards-view__container--PjuzNeLL",block:"cards-view__block--voEUIUB2",block_of_3:"cards-view__block_of_3--xUtRsLxz",block_of_4:"cards-view__block_of_4--fYDicO8F",block_green:"cards-view__block_green--cpcnFpRz",block_purple:"cards-view__block_purple--tHWPt75u",block_sea:"cards-view__block_sea--POCZhrFn",block_orange:"cards-view__block_orange--ru5mewjb",block_white:"cards-view__block_white--SHzYTQr6",card:"cards-view__card--A9qKg19V",closeAdultModalBtn:"cards-view__closeAdultModalBtn--HNUaSOrT"};const a=n},99976:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".authors-cards__container--oEYd134h{position:relative}.authors-cards__caption--TekR5oSq{position:absolute;bottom:16px;width:100%;text-align:center;color:var(--color-bright-900);font-size:14px;line-height:24px;font-weight:500}.authors-cards__avatars--GVSIFIxU{position:absolute;top:16px;width:60px;left:50%;transform:translate(-50%, 0);display:flex;flex-wrap:wrap}.authors-cards__avatars--GVSIFIxU>*{border-radius:0}.authors-cards__avatars--GVSIFIxU>*:nth-child(1){border-radius:8px 0 0 0}.authors-cards__avatars--GVSIFIxU>*:nth-child(3){border-radius:0 8px 0 0}.authors-cards__avatars--GVSIFIxU>*:nth-child(7){border-radius:0 0 0 8px}.authors-cards__avatars--GVSIFIxU>*:nth-child(9){border-radius:0 0 8px 0}",""]),n.locals={container:"authors-cards__container--oEYd134h",caption:"authors-cards__caption--TekR5oSq",avatars:"authors-cards__avatars--GVSIFIxU"};const a=n},45813:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.by-content-cards__container--QECeRfak{position:relative}.by-content-cards__container_images--VR9rEHuo::after{content:"";position:absolute;right:0;top:0;border-radius:0 8px 0 0;background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_96dpi.png");background-size:457px 340px;background-position:0 -140px;width:118px;height:113px}@media(min-resolution: 192dpi),(min-resolution: 2dppx){.by-content-cards__container_images--VR9rEHuo::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}@media(-webkit-min-device-pixel-ratio: 2),(min-device-pixel-ratio: 2){.by-content-cards__container_images--VR9rEHuo::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}.by-content-cards__container_text--BTXKMem_::after{content:"";position:absolute;right:0;top:0;border-radius:0 8px 0 0;background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_96dpi.png");background-size:457px 340px;background-position:-352px -122px;width:104px;height:101px}@media(min-resolution: 192dpi),(min-resolution: 2dppx){.by-content-cards__container_text--BTXKMem_::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}@media(-webkit-min-device-pixel-ratio: 2),(min-device-pixel-ratio: 2){.by-content-cards__container_text--BTXKMem_::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}.by-content-cards__container_videos--Di5lYxMB::after{content:"";position:absolute;right:0;top:0;border-radius:0 8px 0 0;background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_96dpi.png");background-size:457px 340px;background-position:-352px 0;width:105px;height:112px}@media(min-resolution: 192dpi),(min-resolution: 2dppx){.by-content-cards__container_videos--Di5lYxMB::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}@media(-webkit-min-device-pixel-ratio: 2),(min-device-pixel-ratio: 2){.by-content-cards__container_videos--Di5lYxMB::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}.by-content-cards__container_nsfw--GPrfmjDn::after{content:"";position:absolute;right:0;top:0;border-radius:0 8px 0 0;background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_96dpi.png");background-size:457px 340px;background-position:-128px -140px;width:122px;height:105px}@media(min-resolution: 192dpi),(min-resolution: 2dppx){.by-content-cards__container_nsfw--GPrfmjDn::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}@media(-webkit-min-device-pixel-ratio: 2),(min-device-pixel-ratio: 2){.by-content-cards__container_nsfw--GPrfmjDn::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}.by-content-cards__caption--xWs8i3CW{position:absolute;left:12px;bottom:12px;border-radius:8px;background-color:var(--color-bright-900);padding:0 8px;color:var(--color-black-900);font-size:14px;line-height:24px;font-weight:500}',""]),n.locals={container:"by-content-cards__container--QECeRfak",container_images:"by-content-cards__container_images--VR9rEHuo",container_text:"by-content-cards__container_text--BTXKMem_",container_videos:"by-content-cards__container_videos--Di5lYxMB",container_nsfw:"by-content-cards__container_nsfw--GPrfmjDn",caption:"by-content-cards__caption--xWs8i3CW"};const a=n},89107:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.by-filters-cards__container--TJDSyYNI{position:relative}.by-filters-cards__container_discussed--GvbkPD1l::after{content:"";position:absolute;left:50%;top:30px;transform:translate(-50%, 0);background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_96dpi.png");background-size:457px 340px;background-position:-260px -140px;width:33px;height:32px}@media(min-resolution: 192dpi),(min-resolution: 2dppx){.by-filters-cards__container_discussed--GvbkPD1l::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}@media(-webkit-min-device-pixel-ratio: 2),(min-device-pixel-ratio: 2){.by-filters-cards__container_discussed--GvbkPD1l::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}.by-filters-cards__container_saved--JfBbBWVc::after{content:"";position:absolute;left:50%;top:30px;transform:translate(-50%, 0);background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_96dpi.png");background-size:457px 340px;background-position:-303px -140px;width:33px;height:32px}@media(min-resolution: 192dpi),(min-resolution: 2dppx){.by-filters-cards__container_saved--JfBbBWVc::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}@media(-webkit-min-device-pixel-ratio: 2),(min-device-pixel-ratio: 2){.by-filters-cards__container_saved--JfBbBWVc::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}.by-filters-cards__container_virus--lQkY10wG::after{content:"";position:absolute;left:50%;top:30px;transform:translate(-50%, 0);background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_96dpi.png");background-size:457px 340px;background-position:-303px -182px;width:33px;height:32px}@media(min-resolution: 192dpi),(min-resolution: 2dppx){.by-filters-cards__container_virus--lQkY10wG::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}@media(-webkit-min-device-pixel-ratio: 2),(min-device-pixel-ratio: 2){.by-filters-cards__container_virus--lQkY10wG::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}.by-filters-cards__container_viewed--N5ChJC9r::after{content:"";position:absolute;left:50%;top:30px;transform:translate(-50%, 0);background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_96dpi.png");background-size:457px 340px;background-position:-260px -182px;width:33px;height:32px}@media(min-resolution: 192dpi),(min-resolution: 2dppx){.by-filters-cards__container_viewed--N5ChJC9r::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}@media(-webkit-min-device-pixel-ratio: 2),(min-device-pixel-ratio: 2){.by-filters-cards__container_viewed--N5ChJC9r::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}.by-filters-cards__caption--GkOXpTzH{position:absolute;bottom:16px;width:100%;text-align:center;color:var(--color-black-800);font-size:14px;line-height:24px;font-weight:500}',""]),n.locals={container:"by-filters-cards__container--TJDSyYNI",container_discussed:"by-filters-cards__container_discussed--GvbkPD1l",container_saved:"by-filters-cards__container_saved--JfBbBWVc",container_virus:"by-filters-cards__container_virus--lQkY10wG",container_viewed:"by-filters-cards__container_viewed--N5ChJC9r",caption:"by-filters-cards__caption--GkOXpTzH"};const a=n},72811:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.by-format-cards__container--zfayuPWi{position:relative}.by-format-cards__container_short--DF6qrUqC::after{content:"";position:absolute;left:50%;top:50%;transform:translate(-50%, -50%);background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_96dpi.png");background-size:457px 340px;background-position:-352px -233px;width:62px;height:10px}@media(min-resolution: 192dpi),(min-resolution: 2dppx){.by-format-cards__container_short--DF6qrUqC::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}@media(-webkit-min-device-pixel-ratio: 2),(min-device-pixel-ratio: 2){.by-format-cards__container_short--DF6qrUqC::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}.by-format-cards__container_series--KOSO4xqK::after{content:"";position:absolute;left:50%;top:50%;transform:translate(-50%, -50%);background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_96dpi.png");background-size:457px 340px;background-position:0 -263px;width:90px;height:77px}@media(min-resolution: 192dpi),(min-resolution: 2dppx){.by-format-cards__container_series--KOSO4xqK::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}@media(-webkit-min-device-pixel-ratio: 2),(min-device-pixel-ratio: 2){.by-format-cards__container_series--KOSO4xqK::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}.by-format-cards__container_anonymous--CfCPxPdL::after{content:"";position:absolute;left:50%;top:50%;transform:translate(-50%, -50%);background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_96dpi.png");background-size:457px 340px;background-position:-179px 0;width:163px;height:130px}@media(min-resolution: 192dpi),(min-resolution: 2dppx){.by-format-cards__container_anonymous--CfCPxPdL::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}@media(-webkit-min-device-pixel-ratio: 2),(min-device-pixel-ratio: 2){.by-format-cards__container_anonymous--CfCPxPdL::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}.by-format-cards__container_dlinnopost--IaxUb6Cp::after{content:"";position:absolute;left:50%;top:50%;transform:translate(-50%, -50%);background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_96dpi.png");background-size:457px 340px;background-position:0 0;width:169px;height:130px}@media(min-resolution: 192dpi),(min-resolution: 2dppx){.by-format-cards__container_dlinnopost--IaxUb6Cp::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}@media(-webkit-min-device-pixel-ratio: 2),(min-device-pixel-ratio: 2){.by-format-cards__container_dlinnopost--IaxUb6Cp::after{background-image:url("https://cs.pikabu.ru/apps/ub/5.3.195/desktop/sprite_browsing_192dpi.png")}}.by-format-cards__caption--YaraJr9V{position:absolute;left:12px;bottom:12px;border-radius:8px;background-color:var(--color-bright-900);padding:0 8px;color:var(--color-black-900);font-size:14px;line-height:24px;font-weight:500}',""]),n.locals={container:"by-format-cards__container--zfayuPWi",container_short:"by-format-cards__container_short--DF6qrUqC",container_series:"by-format-cards__container_series--KOSO4xqK",container_anonymous:"by-format-cards__container_anonymous--CfCPxPdL",container_dlinnopost:"by-format-cards__container_dlinnopost--IaxUb6Cp",caption:"by-format-cards__caption--YaraJr9V"};const a=n},29857:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".nsfw-warning__closeAdultModalBtn--gXW26Sm1{margin-left:12px}",""]),n.locals={closeAdultModalBtn:"nsfw-warning__closeAdultModalBtn--gXW26Sm1"};const a=n},60390:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.app__host--t4FJQ_Yn{background-color:var(--color-bright-800);position:relative;transition:border-color 200ms}.app__host_border--u5Xke0pR{border:1px solid var(--color-black-430);border-radius:2px}.app__host_disabled--crDDZ208{pointer-events:none}.app__host_disabled--crDDZ208 .app__closeBtn--Uk2_zD2U{pointer-events:all}.app__host_drag--AE5PcdFh::after{content:"Перенесите изображение сюда";vertical-align:-50%;position:absolute;text-align:center;top:42%;left:0;right:0;bottom:0;z-index:11}.app__host_drag--AE5PcdFh::before{content:"";background-color:var(--color-bright-alpha-80);position:absolute;top:0;left:0;right:0;bottom:0;z-index:10;border:4px dashed var(--color-black-440);border-radius:2px}.app__host_drop--E975y3Ad::after{content:"Отпустите клавишу мыши"}.app__host_drop--E975y3Ad::before{border-color:var(--color-primary-700)}.app__editor--AJlxU6Ua{padding:15px 24px;width:100%}.app__editorContainer--oMYcnK98{display:flex;flex-wrap:wrap}.app__feedbackOffer--ceJbAHIx{border:none;border-top:1px solid var(--color-black-430)}.app__controls--GAzYlr0M{border-top:1px solid var(--color-black-430)}.app__marking--nc1Z12ou{width:100%;background:var(--color-warning-200);padding:8px 24px}',""]),n.locals={host:"app__host--t4FJQ_Yn",host_border:"app__host_border--u5Xke0pR",host_disabled:"app__host_disabled--crDDZ208",closeBtn:"app__closeBtn--Uk2_zD2U",host_drag:"app__host_drag--AE5PcdFh",host_drop:"app__host_drop--E975y3Ad",editor:"app__editor--AJlxU6Ua",editorContainer:"app__editorContainer--oMYcnK98",feedbackOffer:"app__feedbackOffer--ceJbAHIx",controls:"app__controls--GAzYlr0M",marking:"app__marking--nc1Z12ou"};const a=n},44501:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".alert-view__host--HxKn0pWO{position:relative;width:100%;border:0;border-top:1px solid var(--color-black-430);border-radius:0;margin:0;font-size:12px;line-height:16px;font-weight:400;padding:16px 24px;border-top:1px solid var(--color-black-430)}.alert-view__close--D8Z5OUs8{color:var(--color-black-600);position:absolute;top:8px;right:8px;cursor:pointer}",""]),n.locals={host:"alert-view__host--HxKn0pWO",close:"alert-view__close--D8Z5OUs8"};const a=n},13584:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".invalid-input-msg-view__correctedText--TRo_ebyG{color:var(--color-primary-900);word-break:break-word;white-space:pre-wrap;cursor:pointer}.invalid-input-msg-view__correctedText--TRo_ebyG:hover{text-decoration:underline}",""]),n.locals={correctedText:"invalid-input-msg-view__correctedText--TRo_ebyG"};const a=n},84679:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".attach-files-btn-view__host--T3Z1SRcb{color:var(--color-black-600);display:inline-flex;align-items:center}",""]),n.locals={host:"attach-files-btn-view__host--T3Z1SRcb"};const a=n},33693:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".controls-view__host--UyD_V037{overflow:hidden;border-top:1px solid var(--color-black-430);background-color:var(--color-black-200);display:flex;align-items:center;flex-wrap:wrap;row-gap:8px;padding:16px 24px}.controls-view__host_disabled--kHQvCzQY{opacity:.5}.controls-view__hiddenBtNote--tBdUy9rk{width:100%}.controls-view__switch--Gsph8TZk{padding-left:8px}.controls-view__attachBtn--K_5veaw2{margin-left:15px}.controls-view__draftDate--ezGNknTs{margin:1px 0 0 auto}.controls-view__anonymous--VbvPF6PV{margin-left:12px}",""]),n.locals={host:"controls-view__host--UyD_V037",host_disabled:"controls-view__host_disabled--kHQvCzQY",hiddenBtNote:"controls-view__hiddenBtNote--tBdUy9rk",switch:"controls-view__switch--Gsph8TZk",attachBtn:"controls-view__attachBtn--K_5veaw2",draftDate:"controls-view__draftDate--ezGNknTs",anonymous:"controls-view__anonymous--VbvPF6PV"};const a=n},86280:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".anonymous-confirm-popup__popup--gpH3qRyi{padding:32px;max-width:400px}.anonymous-confirm-popup__caption--Z0iGr_OA{font-size:16px;line-height:24px;font-weight:400;margin-top:16px}.anonymous-confirm-popup__switcher--GH51kyKq{justify-content:space-between;margin:16px 0}.anonymous-confirm-popup__buttons--dnIosX_l{display:flex;flex-direction:column;gap:12px}",""]),n.locals={popup:"anonymous-confirm-popup__popup--gpH3qRyi",caption:"anonymous-confirm-popup__caption--Z0iGr_OA",switcher:"anonymous-confirm-popup__switcher--GH51kyKq",buttons:"anonymous-confirm-popup__buttons--dnIosX_l"};const a=n},82712:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".draft-date-view__host--y8GHTrzx{color:var(--color-black-700);font-style:italic;text-align:right;font-size:12px;line-height:18px;font-weight:400;transition:opacity 200ms ease-out;text-overflow:ellipsis;text-align:right;white-space:nowrap;cursor:default;transition:opacity 200ms ease,visibility 200ms ease,transform 200ms cubic-bezier(0.71, 1.7, 0.77, 1.24)}.draft-date-view__host--y8GHTrzx-enter-from,.draft-date-view__host--y8GHTrzx-leave-to{transform:translate(0, 100%);opacity:0;visibility:hidden}",""]),n.locals={host:"draft-date-view__host--y8GHTrzx"};const a=n},21458:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".hidden-by-note-view__host--Ys0cOzck{color:var(--color-black-700);width:100%;padding-bottom:15px}",""]),n.locals={host:"hidden-by-note-view__host--Ys0cOzck"};const a=n},67201:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".sending-animation-view__host--FE8TAN34{overflow:hidden;width:58px;height:24px;position:relative;color:inherit;margin:0 6px}@keyframes sending-animation-view__shaking--nuT5v6GX{0%{transform:scaleY(1)}25%{transform:scaleY(1.03)}50%{transform:scaleY(1)}75%{transform:scaleY(0.97)}100%{transform:scaleY(1)}}.sending-animation-view__message--_K5LAgxw{width:58px;animation:sending-animation-view__shaking--nuT5v6GX .1s infinite}@keyframes sending-animation-view__strokes--GNbIyLaM{0%{transform:translateX(-100%)}100%{transform:translateX(0)}}.sending-animation-view__strokes--GNbIyLaM{position:absolute;width:16px;left:0;top:0;bottom:0;overflow:hidden}.sending-animation-view__strokesBottom--rXV2ETSM{width:11px}.sending-animation-view__str--bY9yKcRa{position:absolute;animation:sending-animation-view__strokes--GNbIyLaM .3s infinite reverse}.sending-animation-view__str_1--I50zvu9s{top:2px}.sending-animation-view__str_2--zSvKoprT{top:7px;left:30px}.sending-animation-view__str_3--kYsPYVC3{top:13px;left:61px}.sending-animation-view__str_4--tNaD860L{top:18px;left:30px}.sending-animation-view__str_5--juvpq0XJ{bottom:0;left:31px}",""]),n.locals={host:"sending-animation-view__host--FE8TAN34",message:"sending-animation-view__message--_K5LAgxw",shaking:"sending-animation-view__shaking--nuT5v6GX",strokes:"sending-animation-view__strokes--GNbIyLaM",strokesBottom:"sending-animation-view__strokesBottom--rXV2ETSM",str:"sending-animation-view__str--bY9yKcRa",str_1:"sending-animation-view__str_1--I50zvu9s",str_2:"sending-animation-view__str_2--zSvKoprT",str_3:"sending-animation-view__str_3--kYsPYVC3",str_4:"sending-animation-view__str_4--tNaD860L",str_5:"sending-animation-view__str_5--juvpq0XJ"};const a=n},37682:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".submit-btn-view__host--o6UCdB5V{display:flex}.submit-btn-view__mainBtn_radius--z_oguxE0{border-radius:8px 0 0 8px}.submit-btn-view__extraBtn--oY0eaazi{border-radius:0 8px 8px 0}.submit-btn-view__popup--CMpBt5l1{max-width:520px}.submit-btn-view__popupActions--itJ7Psym{display:flex;gap:12px}",""]),n.locals={host:"submit-btn-view__host--o6UCdB5V",mainBtn_radius:"submit-btn-view__mainBtn_radius--z_oguxE0",extraBtn:"submit-btn-view__extraBtn--oY0eaazi",popup:"submit-btn-view__popup--CMpBt5l1",popupActions:"submit-btn-view__popupActions--itJ7Psym"};const a=n},51773:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.thumb-view__host--hKT1lnun{position:relative;display:flex;width:var(--preview-size);height:var(--preview-size);margin:16px 16px 16px 0;border-radius:3px;cursor:move;user-select:none;background-color:var(--color-black-200)}.thumb-view__host_error--qZsznC3L::before{content:"";position:absolute;top:0;bottom:0;left:0;right:0;opacity:.8;border-radius:2px;background-color:var(--color-danger-800)}.thumb-view__preview--iogcHOsP{width:100%;height:100%;border-radius:3px;background-size:cover}.thumb-view__close--LnX9ZjFE{position:absolute;right:-4px;top:-4px;padding:8px;border-radius:100%;line-height:0;z-index:10;cursor:pointer}.thumb-view__close--LnX9ZjFE svg{fill:var(--color-black-800)}.thumb-view__duration--KSn7VrWJ{position:absolute;text-align:center;background-color:var(--color-contrast-bg-60);color:var(--color-bright-900);font-size:11px;line-height:15px;bottom:5px;right:5px;border-radius:3px;opacity:.8;padding:1px 3px}.thumb-view__loader--Q_vAf7vm{position:absolute;top:0;bottom:0;left:0;right:0;background-color:rgba(0,0,0,.5);border-radius:2px;display:flex;align-items:center;justify-content:center}.thumb-view__errorIcon--pb9KgMia{position:absolute;left:50%;top:50%;transform:translate(-50%, -50%)}',""]),n.locals={host:"thumb-view__host--hKT1lnun",host_error:"thumb-view__host_error--qZsznC3L",preview:"thumb-view__preview--iogcHOsP",close:"thumb-view__close--LnX9ZjFE",duration:"thumb-view__duration--KSn7VrWJ",loader:"thumb-view__loader--Q_vAf7vm",errorIcon:"thumb-view__errorIcon--pb9KgMia"};const a=n},32945:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".thumbs-view__host--w_iYW4lC{display:flex;flex-wrap:wrap;padding:0 24px;border-top:1px solid var(--color-black-430);width:100%}.thumbs-view__item_ghost--bWuONGCO{opacity:.5;filter:blur(3px)}.thumbs-view__item_chosen--isM7hgbc{opacity:.5}",""]),n.locals={host:"thumbs-view__host--w_iYW4lC",item_ghost:"thumbs-view__item_ghost--bWuONGCO",item_chosen:"thumbs-view__item_chosen--isM7hgbc"};const a=n},90122:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".app__host--efesbdmt{position:absolute;height:100%}",""]),n.locals={host:"app__host--efesbdmt"};const a=n},30358:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".app__googleLogo--DOMdGDqO{margin:40px auto 32px}@keyframes app__wave-animation--gUhmeZTn{0%{transform:rotate(0deg)}5%{transform:rotate(3deg)}10%{transform:rotate(-1deg)}15%{transform:rotate(3deg)}20%{transform:rotate(-2deg)}25%{transform:rotate(0.5deg)}50%{transform:rotate(0deg)}100%{transform:rotate(0deg)}}.app__googleHand--Ft7VI6n2{transform-origin:40% 80%;animation:app__wave-animation--gUhmeZTn 5s infinite}.app__footer--xc2uILqa{display:flex;flex-wrap:wrap;padding-top:32px;gap:16px}",""]),n.locals={googleLogo:"app__googleLogo--DOMdGDqO",googleHand:"app__googleHand--Ft7VI6n2","wave-animation":"app__wave-animation--gUhmeZTn",footer:"app__footer--xc2uILqa"};const a=n},95437:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.email-subscribe-step__popup--INgNZIx6{padding:32px;max-width:520px}.email-subscribe-step__caption--JHpAoyTi{margin-bottom:16px;font-size:14px;line-height:24px;font-weight:400;font-size:16px}.email-subscribe-step__image--Lp1LUbUl{margin-bottom:28px;background-image:url("https://cs.pikabu.ru/images/misc/email-subscribe/email_subscribe_dv.png");height:120px}.email-subscribe-step__input--cQZaWswl{overflow:hidden;height:40px;transition:height 200ms ease-out}.email-subscribe-step__input--cQZaWswl-enter-from,.email-subscribe-step__input--cQZaWswl-leave-to{height:0}.email-subscribe-step__switcher--aZ9twKT3{margin-bottom:28px;justify-content:space-between}.email-subscribe-step__errorIcon--wAn9q1yJ{color:var(--color-danger-800)}.email-subscribe-step__buttons--CdrkDTSG{margin-top:16px;display:flex;justify-content:flex-end}.email-subscribe-step__toastContainer--Liw8julf{position:absolute;left:0;right:0;top:-48px}.email-subscribe-step__toastContainer--Liw8julf .toast{border-radius:8px;margin-bottom:8px}',""]),n.locals={popup:"email-subscribe-step__popup--INgNZIx6",caption:"email-subscribe-step__caption--JHpAoyTi",image:"email-subscribe-step__image--Lp1LUbUl",input:"email-subscribe-step__input--cQZaWswl",switcher:"email-subscribe-step__switcher--aZ9twKT3",errorIcon:"email-subscribe-step__errorIcon--wAn9q1yJ",buttons:"email-subscribe-step__buttons--CdrkDTSG",toastContainer:"email-subscribe-step__toastContainer--Liw8julf"};const a=n},32252:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.app__modal--Aa177wm5{max-width:360px}.app__text--D8zfMfAZ{color:var(--color-black-940);font-size:13px;line-height:20px;font-weight:400}.app__header--VcffQMo3{display:flex;align-items:center;flex-direction:column;padding-left:32px;width:100%;font-weight:700;font-size:16px;line-height:24px;padding-bottom:6px}.app__icon--E6Pkg_mY{width:52px;height:52px;margin:0 auto}.app__title--p42CVKro{padding:4px 0}.app__list--eQ7zflnB{margin-left:12px;list-style-type:none;padding:8px 0 4px 0}.app__list--eQ7zflnB li{margin-top:0;position:relative}.app__list--eQ7zflnB li::before{content:"";position:absolute;left:-12px;width:4px;height:4px;background:var(--color-black-940);border-radius:2px;top:8px}.app__price--gIsvH3z_{font-weight:700;text-align:center;min-height:20px;display:flex;justify-content:center;align-items:center;margin-top:12px}.app__btns--XjInbU8V{padding-top:4px}',""]),n.locals={modal:"app__modal--Aa177wm5",text:"app__text--D8zfMfAZ",header:"app__header--VcffQMo3",icon:"app__icon--E6Pkg_mY",title:"app__title--p42CVKro",list:"app__list--eQ7zflnB",price:"app__price--gIsvH3z_",btns:"app__btns--XjInbU8V"};const a=n},11537:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".app__header--McQcM8B6{display:flex;align-items:center;flex-wrap:wrap;position:relative;width:100%}.app__seriesLinks--mCtdXihI{background-color:var(--color-bright-800);position:absolute;top:100%;left:-24px;right:-24px;padding:0 24px 4px;z-index:1;width:auto}.app__searchPanel--Y7sWGMTn{width:100%;margin-top:12px}.app__addBtn--kJt4bEIo{margin-right:12px}",""]),n.locals={header:"app__header--McQcM8B6",seriesLinks:"app__seriesLinks--mCtdXihI",searchPanel:"app__searchPanel--Y7sWGMTn",addBtn:"app__addBtn--kJt4bEIo"};const a=n},63695:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".modal-content-view__host--RlElXelO{overflow:hidden}.modal-content-view__step--tlOLeUzK{background-color:var(--color-bright-800);transition:transform .45s cubic-bezier(0, 0, 0.21, 1)}.modal-content-view__step--tlOLeUzK-enter-from,.modal-content-view__step--tlOLeUzK-leave-to{transform:translate3d(100%, 0, 0);pointer-events:none}",""]),n.locals={host:"modal-content-view__host--RlElXelO",step:"modal-content-view__step--tlOLeUzK"};const a=n},49729:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".input-view__host--H9aV88js{color:var(--color-black-600);flex-grow:1;transition:color 200ms ease-out;cursor:pointer}.input-view__host_active--juCtApkC{color:var(--color-primary-700)}.input-view__calendar--sl1HXiYI{background-color:var(--color-bright-800)}.input-view__calendarFooter--wH5tnXzb{display:flex;align-items:center;justify-content:center;background-color:var(--color-black-200);padding:15px;border-top:1px solid var(--color-black-430)}.input-view__btn--x2hK3dOV+.input-view__btn--x2hK3dOV{margin-left:16px}",""]),n.locals={host:"input-view__host--H9aV88js",host_active:"input-view__host_active--juCtApkC",calendar:"input-view__calendar--sl1HXiYI",calendarFooter:"input-view__calendarFooter--wH5tnXzb",btn:"input-view__btn--x2hK3dOV"};const a=n},75997:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".search-stories-view__checkbox--QkW4O0Sf{padding:2px}.search-stories-view__list--pM6lBtAc{display:flex;flex-wrap:wrap;justify-content:space-between}.search-stories-view__story--BwHlnYh4{height:160px;width:248px;padding:11px;border:1px solid var(--color-black-430)}.search-stories-view__story--BwHlnYh4+.search-stories-view__story--BwHlnYh4{margin-bottom:16px}.search-stories-view__storyTitle--gNh5zovR{color:var(--color-black-940);font-size:13px;line-height:20px;font-weight:500}.search-stories-view__emptyMessage--HHZsNLNm{padding:120px 0 192px;text-align:center;color:var(--color-black-800);font-size:14px;line-height:20px;font-weight:400}",""]),n.locals={checkbox:"search-stories-view__checkbox--QkW4O0Sf",list:"search-stories-view__list--pM6lBtAc",story:"search-stories-view__story--BwHlnYh4",storyTitle:"search-stories-view__storyTitle--gNh5zovR",emptyMessage:"search-stories-view__emptyMessage--HHZsNLNm"};const a=n},38816:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".tags-view__host--aEOifh2L{padding:12px 0 4px}.tags-view__host_hasTags--f5qFzcvI{padding:10px 0}.tags-view__tagsInput--dRNOhgNK{padding:0}",""]),n.locals={host:"tags-view__host--aEOifh2L",host_hasTags:"tags-view__host_hasTags--f5qFzcvI",tagsInput:"tags-view__tagsInput--dRNOhgNK"};const a=n},44660:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.image-view__cta--vFnfbirK{font-size:12px;line-height:16px;font-weight:400}.image-view__imageWrapper--yZlcOirT{display:block;position:relative;width:208px;height:172px;border-radius:8px;overflow:hidden;cursor:pointer;margin:8px 0 12px}.image-view__imageWrapper--yZlcOirT:hover .image-view__icon--eCtT4cXo{display:block}.image-view__imageWrapper--yZlcOirT:hover::before{background-color:var(--color-black-alpha-70)}.image-view__imageWrapper--yZlcOirT::before{content:"";position:absolute;border-radius:8px;top:0;left:0;right:0;bottom:0}.image-view__cover--NmSunDOY{height:100%;width:100%}.image-view__icon--eCtT4cXo{fill:var(--color-bright-900);position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);display:none}',""]),n.locals={cta:"image-view__cta--vFnfbirK",imageWrapper:"image-view__imageWrapper--yZlcOirT",icon:"image-view__icon--eCtT4cXo",cover:"image-view__cover--NmSunDOY"};const a=n},82765:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".series-view__transition--CSaYp69F{background-color:var(--color-bright-800);transition:transform 200ms ease-out,opacity 200ms ease-out}.series-view__transition--CSaYp69F-enter-from,.series-view__transition--CSaYp69F-leave-to{transform:translateX(100%);opacity:0;pointer-events:none}.series-view__host--JdLOQZ19{color:var(--color-black-800)}.series-view__host_shifted--yZPNZQXJ{margin-top:-24px}.series-view__stories--ZIeAwat6{padding:16px 0}.series-view__story--d8oXiJqi+.series-view__story--d8oXiJqi{margin-top:12px}.series-view__moreTrigger--ebK7QnRf{margin-top:12px;font-size:14px;line-height:24px;font-weight:500}.series-view__image--m17ehsa8{margin-top:12px}.series-view__trigger--NefgMlY3{display:inline-flex;align-items:center}.series-view__trigger--NefgMlY3:hover{text-decoration:none}.series-view__deleteIcon--Ug0fgBQ9{color:var(--color-black-600);margin-left:auto;flex-shrink:0;cursor:pointer}.series-view__deleteTrigger--CyhCRahw{color:var(--color-danger-900);margin-top:12px;font-size:13px;line-height:20px;font-weight:500}.series-view__deleteInfo--zwPgQpUy{color:var(--color-black-700);margin-top:4px;font-size:11px;line-height:16px;font-weight:400}.series-view__triggerIcon--Ugdb3cDO{margin-right:4px}",""]),n.locals={transition:"series-view__transition--CSaYp69F",host:"series-view__host--JdLOQZ19",host_shifted:"series-view__host_shifted--yZPNZQXJ",stories:"series-view__stories--ZIeAwat6",story:"series-view__story--d8oXiJqi",moreTrigger:"series-view__moreTrigger--ebK7QnRf",image:"series-view__image--m17ehsa8",trigger:"series-view__trigger--NefgMlY3",deleteIcon:"series-view__deleteIcon--Ug0fgBQ9",deleteTrigger:"series-view__deleteTrigger--CyhCRahw",deleteInfo:"series-view__deleteInfo--zwPgQpUy",triggerIcon:"series-view__triggerIcon--Ugdb3cDO"};const a=n},876:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".steps-links-view__host--KSjLWbe_{display:flex;width:100%}.steps-links-view__trigger--xf9NUYWs{display:inline-flex;align-items:center;font-size:14px;line-height:24px;font-weight:500}.steps-links-view__trigger--xf9NUYWs:hover{text-decoration:none}.steps-links-view__triggerIcon--hdOsEvjV{margin-right:8px}.steps-links-view__sortStoriesTrigger--mc0dsE9r{margin-left:auto}",""]),n.locals={host:"steps-links-view__host--KSjLWbe_",trigger:"steps-links-view__trigger--xf9NUYWs",triggerIcon:"steps-links-view__triggerIcon--hdOsEvjV",sortStoriesTrigger:"steps-links-view__sortStoriesTrigger--mc0dsE9r"};const a=n},12251:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,"",""]),n.locals={};const a=n},6163:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".sorting-select-view__host--fZ2_Plsf{display:inline-flex;font-size:14px;line-height:24px;font-weight:400;padding-top:8px}.sorting-select-view__dropdownAnchor--ztXw40GS{display:inline-flex;align-items:center;margin-left:4px;font-size:14px;line-height:24px;font-weight:500}.sorting-select-view__dropdownAnchor--ztXw40GS:hover{text-decoration:none}.sorting-select-view__dropdownIcon--RPXVgQzf{margin:1px 0 0 4px}",""]),n.locals={host:"sorting-select-view__host--fZ2_Plsf",dropdownAnchor:"sorting-select-view__dropdownAnchor--ztXw40GS",dropdownIcon:"sorting-select-view__dropdownIcon--RPXVgQzf"};const a=n},69429:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.sorting-stories-view__stories--lM8981jt{padding-top:4px}.sorting-stories-view__swapControls--hdm1yts0{display:flex;align-items:center;justify-content:center;padding-right:11px}.sorting-stories-view__storyWrapper--xXTr_jgs{display:flex}.sorting-stories-view__storyWrapper--xXTr_jgs+.sorting-stories-view__storyWrapper--xXTr_jgs{margin-top:8px}.sorting-stories-view__stories_swapping--xUKRf2IL .sorting-stories-view__storyWrapper--xXTr_jgs{margin-top:0}.sorting-stories-view__stories_swapping--xUKRf2IL .sorting-stories-view__storyWrapper--xXTr_jgs:not(:first-child):not(:last-child) .sorting-stories-view__story--nqkFEHFM{border-radius:0}.sorting-stories-view__stories_swapping--xUKRf2IL .sorting-stories-view__storyWrapper--xXTr_jgs:first-child:not(.sorting-stories-view__stories_swapping--xUKRf2IL .sorting-stories-view__storyWrapper--xXTr_jgs:last-child) .sorting-stories-view__story--nqkFEHFM{border-radius:8px 8px 0 0}.sorting-stories-view__stories_swapping--xUKRf2IL .sorting-stories-view__storyWrapper--xXTr_jgs:last-child:not(.sorting-stories-view__stories_swapping--xUKRf2IL .sorting-stories-view__storyWrapper--xXTr_jgs:first-child) .sorting-stories-view__story--nqkFEHFM{border-radius:0 0 8px 8px}.sorting-stories-view__story--nqkFEHFM{position:relative;flex-grow:1;overflow:hidden}.sorting-stories-view__stories_swapping--xUKRf2IL .sorting-stories-view__story--nqkFEHFM{border-style:dashed;padding:7px 11px}.sorting-stories-view__stories_swapping--xUKRf2IL .sorting-stories-view__story--nqkFEHFM::before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;box-sizing:border-box;background:linear-gradient(to left, var(--color-linear-bright-900) 0, var(--color-linear-transparent) 164px);z-index:1}.sorting-stories-view__deleteIcon--DfUywuPU{color:var(--color-black-600);margin-left:auto;flex-shrink:0;cursor:pointer}.sorting-stories-view__swapBtn--hO3rzbnn+.sorting-stories-view__swapBtn--hO3rzbnn{margin-left:8px}.sorting-stories-view__deleteControlBtn--DsvMeTQx{color:var(--color-danger-900);margin-left:16px}',""]),n.locals={stories:"sorting-stories-view__stories--lM8981jt",swapControls:"sorting-stories-view__swapControls--hdm1yts0",storyWrapper:"sorting-stories-view__storyWrapper--xXTr_jgs",stories_swapping:"sorting-stories-view__stories_swapping--xUKRf2IL",story:"sorting-stories-view__story--nqkFEHFM",deleteIcon:"sorting-stories-view__deleteIcon--DfUywuPU",swapBtn:"sorting-stories-view__swapBtn--hO3rzbnn",deleteControlBtn:"sorting-stories-view__deleteControlBtn--DsvMeTQx"};const a=n},62714:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".story-view__host--N3s0p3Ri{display:flex;align-items:flex-start;border:1px solid var(--color-black-430);border-radius:8px;padding:11px}.story-view__loader--WJtW9OXO{width:100%;padding:8px 0 16px}.story-view__title--vCgoDn15{color:var(--color-black-940);display:flex;align-items:center;font-size:13px;line-height:20px;font-weight:500}.story-view__title--vCgoDn15 span{max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block}.story-view__titleTextMargin--DInOT6EH{margin-right:4px}.story-view__container--DalEQ_kw{overflow:hidden;width:100%}.story-view__container_padding--kpVGsvQY{padding-left:8px}.story-view__text--j9yg81Rt{padding-top:4px;color:var(--color-black-800);font-size:12px;line-height:16px;font-weight:400;display:-webkit-box;line-clamp:7;-webkit-line-clamp:7;-webkit-box-orient:vertical;overflow:hidden}.story-view__text_short--uD3LWzrt{display:-webkit-box;line-clamp:3;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}.story-view__text--j9yg81Rt+.story-view__extraBlock--eNlsOPSM{padding-top:4px}.story-view__extraBlock--eNlsOPSM{display:flex;align-items:center}.story-view__extraBlock--eNlsOPSM+.story-view__extraBlock--eNlsOPSM{padding-top:4px}.story-view__extrBlockTitle--t8KGlZPz{color:var(--color-black-800);font-size:12px;line-height:16px;font-weight:400;display:-webkit-box;line-clamp:3;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}.story-view__extraBlockIcon--s47ttpcw{color:var(--color-black-600);margin-right:8px;flex-shrink:0}.story-view__imgContainer--SM6eoeI7{display:flex;padding-top:4px}.story-view__img--qznSsJ_X{width:56px;height:56px;object-fit:cover;border-radius:8px}.story-view__img_single--DgZCfxAz{width:192px;height:108px}.story-view__img--qznSsJ_X+.story-view__img--qznSsJ_X{margin-left:8px}",""]),n.locals={host:"story-view__host--N3s0p3Ri",loader:"story-view__loader--WJtW9OXO",title:"story-view__title--vCgoDn15",titleTextMargin:"story-view__titleTextMargin--DInOT6EH",container:"story-view__container--DalEQ_kw",container_padding:"story-view__container_padding--kpVGsvQY",text:"story-view__text--j9yg81Rt",text_short:"story-view__text_short--uD3LWzrt",extraBlock:"story-view__extraBlock--eNlsOPSM",extrBlockTitle:"story-view__extrBlockTitle--t8KGlZPz",extraBlockIcon:"story-view__extraBlockIcon--s47ttpcw",imgContainer:"story-view__imgContainer--SM6eoeI7",img:"story-view__img--qznSsJ_X",img_single:"story-view__img_single--DgZCfxAz"};const a=n},10615:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".app__card--pkfnIsPM{margin-bottom:16px}.app__card--pkfnIsPM-enter-active,.app__card--pkfnIsPM-leave-active{transition:opacity .2s}.app__card--pkfnIsPM-enter-from,.app__card--pkfnIsPM-leave-to{opacity:0}.app__card--pkfnIsPM:not(.app__card_story--akGINonu){padding:15px 23px}.app__card_brief--iU0BmeKj{border:none;border-bottom-left-radius:0;border-bottom-right-radius:0;margin-bottom:0}.app__card_brief--iU0BmeKj:not(:last-child){border-bottom:1px solid var(--color-black-430)}.app__sidebar--gexm6KBT{margin-top:16px}.app__description--b1jOfJeP{margin-top:8px;color:var(--color-black-700);font-size:11px;line-height:16px;font-weight:400}.app_story-editor .app__inner{display:flex;flex-direction:row-reverse;align-items:flex-start}.app_story-editor .main{padding-right:0;flex:1 1 0;width:calc(100% - 320px)}.app_story-editor .sidebar{width:300px;padding-left:0;margin-left:20px}",""]),n.locals={card:"app__card--pkfnIsPM",card_story:"app__card_story--akGINonu",card_brief:"app__card_brief--iU0BmeKj",sidebar:"app__sidebar--gexm6KBT",description:"app__description--b1jOfJeP"};const a=n},22425:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".alerts-view__alert--Jg2E0abr{margin-bottom:16px}",""]),n.locals={alert:"alerts-view__alert--Jg2E0abr"};const a=n},16758:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".community-value-message__host--W4mD_75m{font-size:14px;line-height:24px;font-weight:400;cursor:default;position:relative;display:flex;align-items:center;margin-bottom:12px;padding:7px 15px;border:1px solid var(--color-black-430);border-radius:8px;background-color:var(--color-black-100);color:var(--color-black-800)}.community-value-message__cookie--nG3w1bKE{flex-shrink:0}.community-value-message__header--mbXDxe7h{margin-left:12px}.community-value-message__close--oiTAO7re{all:unset;cursor:pointer;position:absolute;top:7px;right:7px;padding:3px;font-size:0;line-height:1;transition:background-color 200ms ease-out,filter 200ms ease-out,color 200ms ease-out}.community-value-message__close--oiTAO7re svg{width:10px;height:10px;fill:var(--color-black-600)}",""]),n.locals={host:"community-value-message__host--W4mD_75m",cookie:"community-value-message__cookie--nG3w1bKE",header:"community-value-message__header--mbXDxe7h",close:"community-value-message__close--oiTAO7re"};const a=n},22935:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".recommended-communities__host--o1CKDNFH{padding-top:12px}.recommended-communities__community--F1zJfxpd{padding-right:12px}",""]),n.locals={host:"recommended-communities__host--o1CKDNFH",community:"recommended-communities__community--F1zJfxpd"};const a=n},47655:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".selected-community__rules--YCfBfbB3{margin-top:12px}.selected-community__list--SkmpDyfe{overflow:hidden}.selected-community__moreBtn--AZBD5xG8{margin-top:4px;display:inline-flex;align-items:center;font-size:14px;line-height:24px;font-weight:500}.selected-community__moreIcon--Q97w0vJd{margin-left:4px}",""]),n.locals={rules:"selected-community__rules--YCfBfbB3",list:"selected-community__list--SkmpDyfe",moreBtn:"selected-community__moreBtn--AZBD5xG8",moreIcon:"selected-community__moreIcon--Q97w0vJd"};const a=n},91739:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".list-view__alert--sdgv4aqp{margin-top:16px}.list-view__loader--THhT8xif{padding:16px 0}.list-view__loader--THhT8xif+.list-view__loader--THhT8xif{margin-top:8px}.list-view__draft--vePSNiNc{padding:8px 0}.list-view__draft--vePSNiNc:hover{background-color:rgba(0,0,0,0)}.list-view__draft--vePSNiNc+.list-view__draft--vePSNiNc{margin-top:8px}.list-view__draftTitle--IfVAcDiN{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block}.list-view__draftText--c1lkQ_ni{display:-webkit-box;line-clamp:2;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.list-view__deleteAll--YV_eDGph{all:unset;display:inline-flex;align-items:center;margin-top:12px;color:var(--color-danger-900);font-size:13px;line-height:20px;font-weight:500;cursor:pointer}.list-view__deleteAllIcon--wucJPcP7{margin-right:8px}",""]),n.locals={alert:"list-view__alert--sdgv4aqp",loader:"list-view__loader--THhT8xif",draft:"list-view__draft--vePSNiNc",draftTitle:"list-view__draftTitle--IfVAcDiN",draftText:"list-view__draftText--c1lkQ_ni",deleteAll:"list-view__deleteAll--YV_eDGph",deleteAllIcon:"list-view__deleteAllIcon--wucJPcP7"};const a=n},51407:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".story-page-drafts__info--M2QioK7s{display:flex;height:20px;margin-bottom:16px}.story-page-drafts__btn--YlEemKeY{all:unset;display:inline-flex;color:var(--color-primary-900);font-size:13px;line-height:20px;font-weight:500}.story-page-drafts__btn_limit--I4bhUz2f{color:var(--color-danger-900)}.story-page-drafts__btn_limit--I4bhUz2f .story-page-drafts__icon--PwNNJdmX{color:var(--color-danger-800)}@media(hover: hover){.story-page-drafts__btn--YlEemKeY{cursor:pointer;filter:unset}}.story-page-drafts__icon--PwNNJdmX{margin-right:8px;color:var(--color-primary-800)}.story-page-drafts__saved--ZIpfJRWV{display:inline-flex;color:var(--color-black-600);transition:opacity 200ms ease,visibility 200ms ease,transform 200ms cubic-bezier(0.71, 1.7, 0.77, 1.24);font-size:11px;font-weight:400;margin-left:auto}.story-page-drafts__saved--ZIpfJRWV-enter-from,.story-page-drafts__saved--ZIpfJRWV-leave-to{transform:translate(0, 100%);opacity:0;visibility:hidden}",""]),n.locals={info:"story-page-drafts__info--M2QioK7s",btn:"story-page-drafts__btn--YlEemKeY",btn_limit:"story-page-drafts__btn_limit--I4bhUz2f",icon:"story-page-drafts__icon--PwNNJdmX",saved:"story-page-drafts__saved--ZIpfJRWV"};const a=n},69344:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".editor-menu__buttons--w7iIWngf{display:flex;margin-right:20px}.editor-menu__button--dVmfe_cZ:not(:first-child){margin-left:8px}.editor-menu__button_separated--QDDR0374:not(:first-child){margin-left:20px}.editor-menu__moreButton--cXnxz6si{margin-right:20px}.editor-menu__shortText--_Mw_Jxpc{margin-left:auto;flex-shrink:0}.editor-menu__heading1--LYQmpoyF{font-size:17px;line-height:24px;font-weight:600}.editor-menu__heading2--ZKbFX9mt{font-size:16px;line-height:24px;font-weight:600}.editor-menu__divider--Cr2J19Nj{border-bottom:1px solid var(--color-black-430);margin:7px 0 8px 0}.editor-menu__tooltipCard--LboVA828{padding:4px 0}.editor-menu__tooltipBtn--yA9Fkryo{display:flex;align-items:center;padding:8px}",""]),n.locals={buttons:"editor-menu__buttons--w7iIWngf",button:"editor-menu__button--dVmfe_cZ",button_separated:"editor-menu__button_separated--QDDR0374",moreButton:"editor-menu__moreButton--cXnxz6si",shortText:"editor-menu__shortText--_Mw_Jxpc",heading1:"editor-menu__heading1--LYQmpoyF",heading2:"editor-menu__heading2--ZKbFX9mt",divider:"editor-menu__divider--Cr2J19Nj",tooltipCard:"editor-menu__tooltipCard--LboVA828",tooltipBtn:"editor-menu__tooltipBtn--yA9Fkryo"};const a=n},5211:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".editor-theme-switch__host--RbsKUphs{display:flex;align-items:center}.editor-theme-switch__hint--fRwDRcGi{margin-left:4px}",""]),n.locals={host:"editor-theme-switch__host--RbsKUphs",hint:"editor-theme-switch__hint--fRwDRcGi"};const a=n},40952:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.editor-view__host--YUxzZQh6{position:relative}.editor-view__host--YUxzZQh6 .pkb-spoiler{background-color:var(--color-black-alpha-12);box-shadow:0 0 0 3px var(--color-black-alpha-12)}.editor-view__host--YUxzZQh6 .pkb-marker{color:inherit;background-color:var(--color-warning-alpha-40)}.editor-view__host--YUxzZQh6 .pm-dropcursor{background-color:var(--color-primary-700) !important;border-radius:4px}.editor-view__host--YUxzZQh6 .ProseMirror{font-size:14px;line-height:24px;font-weight:400;outline:0;width:100%;color:var(--color-black-940)}.editor-view__host--YUxzZQh6 .ProseMirror-selectednode{outline:0}.editor-view__host--YUxzZQh6 .ProseMirror-focused .ProseMirror-selectednode[data-focus=true]::after{content:"";display:block;position:absolute;pointer-events:none;left:0;right:0;background:rgba(138,200,88,.4);z-index:2004;top:8px;bottom:8px}.editor-view__host--YUxzZQh6 .ProseMirror>[data-placeholder]::before{content:attr(data-placeholder);color:var(--color-black-700);position:absolute;pointer-events:none;top:0;left:0;right:0;padding:8px 24px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block}.editor-view__host--YUxzZQh6 [data-theme=true] .ProseMirror>[data-placeholder]::before{content:none}.editor-view__menu--twQWo4hk{position:sticky;top:0;z-index:4999}.editor-view__feedbackOffer--ewUOy7Cv{border-top:1px solid var(--color-black-430)}',""]),n.locals={host:"editor-view__host--YUxzZQh6",menu:"editor-view__menu--twQWo4hk",feedbackOffer:"editor-view__feedbackOffer--ewUOy7Cv"};const a=n},2481:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".limit-view__host--y_A24UAe{display:flex;justify-content:flex-end;align-items:center;padding:8px 24px}.limit-view__divider--VAA3CBWW{color:var(--color-black-700);margin:0 8px}.limit-view__limit--IcaaScx6{font-size:12px;line-height:16px;font-weight:400;color:var(--color-black-700)}.limit-view__limit_exceeded--FZdKFrow{color:var(--color-danger-900)}",""]),n.locals={host:"limit-view__host--y_A24UAe",divider:"limit-view__divider--VAA3CBWW",limit:"limit-view__limit--IcaaScx6",limit_exceeded:"limit-view__limit_exceeded--FZdKFrow"};const a=n},1347:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".attachment-popup-view__divider--B_wZU5o1{margin:12px 0}.attachment-popup-view__upload--ooD4HsWc{display:flex;flex-flow:column;align-items:center;border:4px dashed var(--color-black-430);padding:28px 20px}.attachment-popup-view__uploadNote--V2jgPOLK{font-size:13px;line-height:20px;font-weight:400;margin-bottom:8px;color:var(--color-black-700);text-align:center}",""]),n.locals={divider:"attachment-popup-view__divider--B_wZU5o1",upload:"attachment-popup-view__upload--ooD4HsWc",uploadNote:"attachment-popup-view__uploadNote--V2jgPOLK"};const a=n},6825:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.floating-menu-view__host--NJlVWmx4{position:relative;padding:12px;z-index:2}.floating-menu-view__button--HzqgG6Ir{all:unset;width:20px;height:20px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:opacity 200ms ease-out;background-color:var(--color-primary-700);border-radius:50%;color:var(--color-bright-900)}.floating-menu-view__menu--GilNXSiG{position:absolute;gap:8px;left:100%;top:calc(50% - 22px);padding:8px;background-color:var(--color-bright-800);border-radius:2px;display:none;filter:drop-shadow(0 1px 8px var(--color-contrast-shadow));will-change:filter}.floating-menu-view__menu_visible--HXE6cace{display:flex}.floating-menu-view__menu--GilNXSiG::before{content:"";display:block;position:absolute;right:100%;width:0;height:0;border:solid rgba(0,0,0,0);border-width:7px 8px 7px 0;border-right-color:var(--color-bright-800);top:calc(50% - 7px)}.floating-menu-view__menuButton--MJpEPZAY{all:unset;cursor:pointer;color:var(--color-black-600);width:28px;height:28px;display:flex;align-items:center;justify-content:center}.floating-menu-view__menuButton--MJpEPZAY:disabled{opacity:.5;cursor:not-allowed}',""]),n.locals={host:"floating-menu-view__host--NJlVWmx4",button:"floating-menu-view__button--HzqgG6Ir",menu:"floating-menu-view__menu--GilNXSiG",menu_visible:"floating-menu-view__menu_visible--HXE6cace",menuButton:"floating-menu-view__menuButton--MJpEPZAY"};const a=n},67757:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.image-editor-view__host--qOhEYvnK{display:flex;flex-direction:column;height:100%;padding-bottom:16px}.image-editor-view__imageContainer--BDoVq10Z{position:relative;flex:1;max-width:1020px;min-width:900px;margin:84px auto 40px}.image-editor-view__imageContainer--BDoVq10Z .cropper-modal{opacity:1;background-color:var(--color-black-alpha-70)}.image-editor-view__imageContainer--BDoVq10Z .cropper-center{display:none}.image-editor-view__imageContainer--BDoVq10Z .cropper-point{background-color:var(--color-bright-900)}.image-editor-view__imageContainer--BDoVq10Z .cropper-point.point-se{width:5px;height:5px}.image-editor-view__imageContainer--BDoVq10Z .cropper-point.point-se::before{display:none}.image-editor-view__imageContainer--BDoVq10Z .cropper-point.point-se::before{display:none}.image-editor-view__image--lzVTJTPD{display:none}.image-editor-view__controls--Kl6hlGP8{background-color:var(--color-bright-alpha-30);display:flex;align-items:center;margin:0 auto;border-radius:8px;padding:16px 24px}.image-editor-view__loader--JEYvY5Of{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}.image-editor-view__controlBtn--TRqkBSCf{all:unset;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden;color:var(--color-black-700);height:40px;width:40px;background-color:var(--color-black-440);border-radius:8px;transition:background-color 200ms ease-out,color 200ms ease-out,filter 200ms ease-out;cursor:pointer}.image-editor-view__controlBtn--TRqkBSCf::after{content:"";display:block;position:absolute;top:0;bottom:0;width:100%;opacity:0;transition:opacity 200ms ease-out;background:linear-gradient(0deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.2)),var(--color-black-440)}.image-editor-view__controlBtn--TRqkBSCf:hover::after{opacity:.2}.image-editor-view__controlBtn--TRqkBSCf:active,.image-editor-view__controlBtn_active--SG86hHuJ{filter:unset;color:var(--color-bright-900);background-color:var(--color-primary-700)}.image-editor-view__controlBtn--TRqkBSCf:disabled{pointer-events:none;color:var(--color-black-700);background-color:var(--color-black-440)}.image-editor-view__controlBtn--TRqkBSCf:focus-visible{box-shadow:var(--shadow-focus)}.image-editor-view__controlBtn--TRqkBSCf+.image-editor-view__controlBtn--TRqkBSCf:not(.image-editor-view__controlBtn_reset--o5auFAZA){margin-left:12px}.image-editor-view__controlBtn_reset--o5auFAZA{width:124px;margin-left:40px}.image-editor-view__apply--bpFR7vDt{margin-left:20px}',""]),n.locals={host:"image-editor-view__host--qOhEYvnK",imageContainer:"image-editor-view__imageContainer--BDoVq10Z",image:"image-editor-view__image--lzVTJTPD",controls:"image-editor-view__controls--Kl6hlGP8",loader:"image-editor-view__loader--JEYvY5Of",controlBtn:"image-editor-view__controlBtn--TRqkBSCf",controlBtn_active:"image-editor-view__controlBtn_active--SG86hHuJ",controlBtn_reset:"image-editor-view__controlBtn_reset--o5auFAZA",apply:"image-editor-view__apply--bpFR7vDt"};const a=n},97807:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".carousel-edit-popup__content--kdb4ZwhQ{margin-bottom:12px}.carousel-edit-popup__info--ztNafEjA{color:var(--color-black-800);font-size:13px;line-height:20px;font-weight:400;margin:16px 0}.carousel-edit-popup__item--C6wv0gjf{cursor:move;user-select:none}.carousel-edit-popup__item_ghost--G5Q7seZR{opacity:.5}.carousel-edit-popup__item_chosen--ZgcQlB8z{opacity:.5}.carousel-edit-popup__item_dragging--SUfToQZe .not-draggable{display:none}.carousel-edit-popup__item--C6wv0gjf .not-draggable{cursor:auto}.carousel-edit-popup__items--nrPOpS4Z{display:flex;flex-wrap:wrap;margin:-16px 0 0 -16px}.carousel-edit-popup__items--nrPOpS4Z>*{margin:16px 0 0 16px}.carousel-edit-popup__items--nrPOpS4Z>*{will-change:transform}.carousel-edit-popup__footer--d_sXjQwN{display:flex;justify-content:flex-end}.carousel-edit-popup__footer--d_sXjQwN>:not(:first-child){margin-left:8px}.carousel-edit-popup__footer--d_sXjQwN button{width:170px}.carousel-edit-popup__popup--kHqTUybg{z-index:6000}",""]),n.locals={content:"carousel-edit-popup__content--kdb4ZwhQ",info:"carousel-edit-popup__info--ztNafEjA",item:"carousel-edit-popup__item--C6wv0gjf",item_ghost:"carousel-edit-popup__item_ghost--G5Q7seZR",item_chosen:"carousel-edit-popup__item_chosen--ZgcQlB8z",item_dragging:"carousel-edit-popup__item_dragging--SUfToQZe",items:"carousel-edit-popup__items--nrPOpS4Z",footer:"carousel-edit-popup__footer--d_sXjQwN",popup:"carousel-edit-popup__popup--kHqTUybg"};const a=n},52282:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".carousel-overlay__host--OXuriEyP{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;pointer-events:none}.carousel-overlay__icon_error--KqkAdnOQ{z-index:1;color:var(--color-danger-800)}",""]),n.locals={host:"carousel-overlay__host--OXuriEyP",icon_error:"carousel-overlay__icon_error--KqkAdnOQ"};const a=n},51160:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.node-images-carousel-view__host--mq5iGp_g{position:relative;padding:8px 0}.ProseMirror-focused .node-images-carousel-view__host_selected--X1edOgsr::after{content:"";display:block;position:absolute;pointer-events:none;left:0;right:0;top:0;bottom:0;background:rgba(138,200,88,.4);z-index:2004;top:8px;bottom:8px}.node-images-carousel-view__figure--gBg_KO6I{user-select:none;outline:none}.node-images-carousel-view__controls--wP2YrHDf{position:absolute;top:48px;right:10px;z-index:2100;display:grid;gap:8px}.node-images-carousel-view__loader--qNTA6pzF{pointer-events:none}',""]),n.locals={host:"node-images-carousel-view__host--mq5iGp_g",host_selected:"node-images-carousel-view__host_selected--X1edOgsr",figure:"node-images-carousel-view__figure--gBg_KO6I",controls:"node-images-carousel-view__controls--wP2YrHDf",loader:"node-images-carousel-view__loader--qNTA6pzF"};const a=n},10330:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".popup-image-item__host--v3Ns_Cvu{border-radius:8px;position:relative;display:flex;overflow:hidden;width:174px;height:116px}.popup-image-item__host--v3Ns_Cvu img{width:100%;height:100%;object-fit:scale-down;pointer-events:none;background-color:var(--color-black-300)}.popup-image-item__host--v3Ns_Cvu div{position:absolute}.popup-image-item__buttons--h5SYsKR7{background-color:var(--color-black-alpha-70);padding:4px 8px;border-radius:8px;top:8px;right:8px;display:grid;grid-auto-flow:column;gap:8px}.popup-image-item__buttons--h5SYsKR7 button{all:unset;color:var(--color-bright-900);cursor:pointer}.popup-image-item__loader--IO9Fh8nA{position:absolute;top:calc(50% - 8px);left:calc(50% - 8px)}.popup-image-item__icon_error--tbEYdrJy{color:var(--color-danger-800)}.popup-image-item__icon_success--L2F9tus6{color:var(--color-bright-900)}",""]),n.locals={host:"popup-image-item__host--v3Ns_Cvu",buttons:"popup-image-item__buttons--h5SYsKR7",loader:"popup-image-item__loader--IO9Fh8nA",icon_error:"popup-image-item__icon_error--tbEYdrJy",icon_success:"popup-image-item__icon_success--L2F9tus6"};const a=n},61400:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".node-blockquote-view__wrapper--sh7luUw4{padding:8px 24px}",""]),n.locals={wrapper:"node-blockquote-view__wrapper--sh7luUw4"};const a=n},35071:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>C});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r),a=s(61667),l=s.n(a),c=new URL(s(31310),s.b),d=new URL(s(82807),s.b),u=new URL(s(5853),s.b),p=new URL(s(40930),s.b),h=new URL(s(98691),s.b),_=new URL(s(28443),s.b),m=new URL(s(63193),s.b),g=new URL(s(46968),s.b),v=n()(o()),f=l()(c),y=l()(d),b=l()(u),w=l()(p),k=l()(h),S=l()(_),O=l()(m),E=l()(g);v.push([e.id,".node-bullet-list-view__wrapper--KxE9yNDZ{padding:8px 24px}.node-bullet-list-view__list--dK0sS12u{margin-left:12px;list-style-type:none}.node-bullet-list-view__list--dK0sS12u>li::before{position:relative;top:-3px;margin-right:8px;float:left}:root:not([data-theme-dark]) .node-bullet-list-view__list--dK0sS12u>li::before{content:url("+f+")}:root[data-theme-dark] .node-bullet-list-view__list--dK0sS12u>li::before{content:url("+y+")}:root:not([data-theme-dark]) .node-bullet-list-view__list--dK0sS12u .node-bullet-list-view__list--dK0sS12u>li::before{content:url("+b+")}:root[data-theme-dark] .node-bullet-list-view__list--dK0sS12u .node-bullet-list-view__list--dK0sS12u>li::before{content:url("+w+")}:root:not([data-theme-dark]) .node-bullet-list-view__list--dK0sS12u .node-bullet-list-view__list--dK0sS12u .node-bullet-list-view__list--dK0sS12u>li::before{content:url("+k+")}:root[data-theme-dark] .node-bullet-list-view__list--dK0sS12u .node-bullet-list-view__list--dK0sS12u .node-bullet-list-view__list--dK0sS12u>li::before{content:url("+S+")}:root:not([data-theme-dark]) .node-bullet-list-view__list--dK0sS12u .node-bullet-list-view__list--dK0sS12u .node-bullet-list-view__list--dK0sS12u .node-bullet-list-view__list--dK0sS12u>li::before{content:url("+O+")}:root[data-theme-dark] .node-bullet-list-view__list--dK0sS12u .node-bullet-list-view__list--dK0sS12u .node-bullet-list-view__list--dK0sS12u .node-bullet-list-view__list--dK0sS12u>li::before{content:url("+E+")}",""]),v.locals={wrapper:"node-bullet-list-view__wrapper--KxE9yNDZ",list:"node-bullet-list-view__list--dK0sS12u"};const C=v},71137:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".node-embed-video-loader-view__host--IAl4nK53{display:flex;justify-content:center;user-select:none;padding:8px 0}",""]),n.locals={host:"node-embed-video-loader-view__host--IAl4nK53"};const a=n},37745:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.node-embed-video-view__host--f3Bpwhkj{position:relative;padding:8px 0}.ProseMirror-focused .node-embed-video-view__host_selected--s3BQE1LB::after{content:"";display:block;position:absolute;pointer-events:none;left:0;right:0;background:rgba(138,200,88,.4);z-index:2004;top:8px;bottom:8px}.node-embed-video-view__controls--k_HGaPCY{position:absolute;top:24px;right:24px;z-index:2100;display:flex;flex-direction:column;margin:-8px 0 0 -8px}.node-embed-video-view__controls--k_HGaPCY>*{margin:8px 0 0 8px}',""]),n.locals={host:"node-embed-video-view__host--f3Bpwhkj",host_selected:"node-embed-video-view__host_selected--s3BQE1LB",controls:"node-embed-video-view__controls--k_HGaPCY"};const a=n},55600:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".node-fundraising-view__host--MQWPk9mC{background-color:var(--color-black-200);border-radius:8px;margin:8px 23px;padding:20px}.node-fundraising-view__header--iUoIbdEe{display:flex;justify-content:space-between;word-break:break-word}.node-fundraising-view__description--ogVBLzni{color:var(--color-black-700);margin-top:8px;font-size:13px;line-height:20px;font-weight:400}.node-fundraising-view__progress--OMCpAUOP{margin-top:20px}.node-fundraising-view__delete--HKyDAxpC{color:var(--color-black-600);flex-shrink:0;cursor:pointer}",""]),n.locals={host:"node-fundraising-view__host--MQWPk9mC",header:"node-fundraising-view__header--iUoIbdEe",description:"node-fundraising-view__description--ogVBLzni",progress:"node-fundraising-view__progress--OMCpAUOP",delete:"node-fundraising-view__delete--HKyDAxpC"};const a=n},98726:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".node-heading-first-view__host--SPvo2eEh{font-size:17px;line-height:24px;font-weight:600;color:var(--color-black-800);padding:8px 24px 0}",""]),n.locals={host:"node-heading-first-view__host--SPvo2eEh"};const a=n},36751:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".node-heading-second-view__host--EQO5bRg4{font-size:16px;line-height:24px;font-weight:600;color:var(--color-black-800);padding:8px 24px 0}",""]),n.locals={host:"node-heading-second-view__host--EQO5bRg4"};const a=n},73862:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".node-highlight-view__pkb-highlight-block--KlVcK6HZ,.node-highlight-view__wrapper--tmo9sQp3{color:var(--color-black-800);background:var(--color-primary-200);border-radius:8px;font-size:18px;line-height:28px;font-weight:500;padding:20px}.node-highlight-view__wrapper--tmo9sQp3{margin:8px 23px}",""]),n.locals={"pkb-highlight-block":"node-highlight-view__pkb-highlight-block--KlVcK6HZ",wrapper:"node-highlight-view__wrapper--tmo9sQp3"};const a=n},48401:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".node-image-caption-view__host--zA_xu75M{position:relative;color:var(--color-black-700);padding:10px 24px;font-size:13px;line-height:20px;font-weight:400}.node-image-caption-view__placeholder--npWGSuW2{position:absolute;pointer-events:none}.node-image-caption-view__counter--d7KTDZWO{position:absolute;color:var(--color-black-600);right:8px;bottom:8px;font-size:11px;line-height:16px;font-weight:400}",""]),n.locals={host:"node-image-caption-view__host--zA_xu75M",placeholder:"node-image-caption-view__placeholder--npWGSuW2",counter:"node-image-caption-view__counter--d7KTDZWO"};const a=n},71414:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".node-image-loader-view__host--ewyocpQe{position:relative;user-select:none}.node-image-loader-view__image--VnywkAzm{display:block;max-width:100%}",""]),n.locals={host:"node-image-loader-view__host--ewyocpQe",image:"node-image-loader-view__image--VnywkAzm"};const a=n},57665:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.node-image-view__wrapper--iQ6rnbsz{padding:8px 0}.node-image-view__host--MB2o4akl{position:relative}.ProseMirror-focused .node-image-view__host_selected--RAILu_BF::after{content:"";display:block;position:absolute;pointer-events:none;left:0;right:0;top:0;bottom:0;background:rgba(138,200,88,.4);z-index:2004}.node-image-view__figure--UBr1SQds{user-select:none;outline:none}.node-image-view__image--Q0aSYpTB{display:block;max-width:100%;height:100%}.node-image-view__controls--FfeQ3G75{position:absolute;top:24px;right:24px;z-index:2100;display:flex;flex-direction:column}.node-image-view__controls--FfeQ3G75:not(.node-image-view__controls_row--GmAaJ96x){margin:-8px 0 0 -8px}.node-image-view__controls--FfeQ3G75:not(.node-image-view__controls_row--GmAaJ96x)>*{margin:8px 0 0 8px}.node-image-view__controls_row--GmAaJ96x{flex-direction:row;top:50%;transform:translateY(-50%)}.node-image-view__controls_row--GmAaJ96x>*{margin-left:8px}',""]),n.locals={wrapper:"node-image-view__wrapper--iQ6rnbsz",host:"node-image-view__host--MB2o4akl",host_selected:"node-image-view__host_selected--RAILu_BF",figure:"node-image-view__figure--UBr1SQds",image:"node-image-view__image--Q0aSYpTB",controls:"node-image-view__controls--FfeQ3G75",controls_row:"node-image-view__controls_row--GmAaJ96x"};const a=n},51598:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.node-ordered-list-view__wrapper--YlMtsqgD{padding:8px 24px}.node-ordered-list-view__list--MSpVKVCA{margin-left:12px;counter-reset:count;list-style-type:none}.node-ordered-list-view__list--MSpVKVCA>li::before{counter-increment:count;content:counters(count, ".") ".";margin-right:8px;float:left}',""]),n.locals={wrapper:"node-ordered-list-view__wrapper--YlMtsqgD",list:"node-ordered-list-view__list--MSpVKVCA"};const a=n},41864:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".node-paragraph-view__content--hRxcjf1f:not(.node-paragraph-view__content_short--Zc94b8L6){padding:8px 24px}.node-paragraph-view__content_short--Zc94b8L6{font-size:var(--theme-font-size, 18px);line-height:var(--theme-line-height, 32px);font-weight:500;color:var(--theme-color, var(--color-bright-900));text-align:center}",""]),n.locals={content:"node-paragraph-view__content--hRxcjf1f",content_short:"node-paragraph-view__content_short--Zc94b8L6"};const a=n},22337:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".node-poll-view__host--FiQuShoj{background-color:var(--color-black-200);padding:20px 23px}.node-poll-view__header--qImU3Smy{color:var(--color-black-800);display:flex;justify-content:space-between;font-size:16px;line-height:20px;font-weight:500}.node-poll-view__alert--VA654Sva{margin-top:20px}.node-poll-view__delete--kzRetfSx{color:var(--color-black-600);cursor:pointer}.node-poll-view__title--wgi3XIEL{margin:20px 0 16px}.node-poll-view__option--QrFvvZJZ{padding:0 15px}.node-poll-view__option--QrFvvZJZ+.node-poll-view__option--QrFvvZJZ{margin-top:8px}.node-poll-view__option--QrFvvZJZ input{padding:9px 0}.node-poll-view__add--VMPmtFrw{margin-top:12px}.node-poll-view__error--Y59DPycD{color:var(--color-danger-900);margin-top:4px}",""]),n.locals={host:"node-poll-view__host--FiQuShoj",header:"node-poll-view__header--qImU3Smy",alert:"node-poll-view__alert--VA654Sva",delete:"node-poll-view__delete--kzRetfSx",title:"node-poll-view__title--wgi3XIEL",option:"node-poll-view__option--QrFvvZJZ",add:"node-poll-view__add--VMPmtFrw",error:"node-poll-view__error--Y59DPycD"};const a=n},64136:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".node-separator-view__wrapper--XMeO5Nf_{cursor:pointer;padding:11px 0 12px;display:flex;align-items:center}.node-separator-view__wrapper--XMeO5Nf_ hr{margin:0 auto;background-color:var(--color-black-500);width:300px}.node-separator-view__wrapper_selected--AtfJBI2O hr{background-color:var(--color-bright-900);outline:2px solid var(--color-primary-400)}",""]),n.locals={wrapper:"node-separator-view__wrapper--XMeO5Nf_",wrapper_selected:"node-separator-view__wrapper_selected--AtfJBI2O"};const a=n},94028:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".node-video-loader-view__host--N1g35UWd{position:relative;user-select:none;padding:8px 0}",""]),n.locals={host:"node-video-loader-view__host--N1g35UWd"};const a=n},61732:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.node-video-view__host--vA71FauR{position:relative;padding:8px 0}.ProseMirror-focused .node-video-view__host_selected--my8WtrbM::after{content:"";display:block;position:absolute;pointer-events:none;left:0;right:0;background:rgba(138,200,88,.4);z-index:2004;top:8px;bottom:8px}.node-video-view__controls--JzDncP0m{position:absolute;top:24px;right:24px;z-index:2100;display:flex;flex-direction:column;margin:-8px 0 0 -8px}.node-video-view__controls--JzDncP0m>*{margin:8px 0 0 8px}.node-video-view__hint--ZMKmtzZF{font-size:13px;line-height:20px;font-weight:400;padding:12px;max-width:328px}.node-video-view__hintWrapper--RHISeLzJ{z-index:2005}',""]),n.locals={host:"node-video-view__host--vA71FauR",host_selected:"node-video-view__host_selected--my8WtrbM",controls:"node-video-view__controls--JzDncP0m",hint:"node-video-view__hint--ZMKmtzZF",hintWrapper:"node-video-view__hintWrapper--RHISeLzJ"};const a=n},12289:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.node-wrapper-view__host--x6bdZ_Cf{display:flex;flex-direction:column;outline:0;position:relative}.node-wrapper-view__host_reordering--B2CGI_H4{overflow:hidden}.node-wrapper-view__host_complex--Vj9bKDdE+.node-wrapper-view__host_complex--Vj9bKDdE{margin-top:8px}.node-wrapper-view__dragHandleWrapper--SnnuCPei{position:absolute;right:100%;top:0;bottom:0;display:flex;align-items:center;padding:0 12px;transition:opacity 200ms ease-out}.node-wrapper-view__host--x6bdZ_Cf:not(:hover) .node-wrapper-view__dragHandleWrapper--SnnuCPei{opacity:0}.node-wrapper-view__button--QFFfYqkA{width:20px;height:20px;display:flex;align-items:center;justify-content:center;background-color:rgba(0,0,0,0);color:var(--color-black-600);cursor:move;position:sticky;bottom:0;top:0}.node-wrapper-view__button--QFFfYqkA:active{cursor:grabbing}.node-wrapper-view__moveMenu--DGciTEZD{position:absolute;right:100%;top:0;width:100px;height:100%;display:flex;align-items:center;justify-content:center}.node-wrapper-view__host_reordering--B2CGI_H4 .node-wrapper-view__moveMenu--DGciTEZD{transform:translateX(100px)}.node-wrapper-view__moveButton--vX14OHrb:not(:last-child){margin-right:8px}.node-wrapper-view__content--YBpn9eXj{position:relative}.node-wrapper-view__host_reordering--B2CGI_H4 .node-wrapper-view__content--YBpn9eXj{transform:translateX(100px);min-height:40px;margin:0}.node-wrapper-view__host_reordering--B2CGI_H4 .node-wrapper-view__content--YBpn9eXj::before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;box-sizing:border-box;border:dashed var(--color-black-440);border-width:0 0 1px 1px;background:linear-gradient(to left, var(--color-linear-bright-900) 100px, var(--color-linear-transparent) 224px);z-index:1}.node-wrapper-view__host_reordering--B2CGI_H4:first-child .node-wrapper-view__content--YBpn9eXj::before{border-top-width:1px}',""]),n.locals={host:"node-wrapper-view__host--x6bdZ_Cf",host_reordering:"node-wrapper-view__host_reordering--B2CGI_H4",host_complex:"node-wrapper-view__host_complex--Vj9bKDdE",dragHandleWrapper:"node-wrapper-view__dragHandleWrapper--SnnuCPei",button:"node-wrapper-view__button--QFFfYqkA",moveMenu:"node-wrapper-view__moveMenu--DGciTEZD",moveButton:"node-wrapper-view__moveButton--vX14OHrb",content:"node-wrapper-view__content--YBpn9eXj"};const a=n},51727:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.story-editor-view__host--puqpSJIx{position:relative}.story-editor-view__host_disabled--yoQQeqXn{opacity:.4;pointer-events:none;user-select:none;position:relative}.story-editor-view__host_disabled--yoQQeqXn::after{pointer-events:auto;content:"";position:absolute;display:block;cursor:not-allowed;top:0;bottom:0;left:0;right:0}.story-editor-view__fab--HdC5Gcnu{position:absolute;left:0;top:0;transition:transform 200ms ease-out;transform:translate(var(--translate-x), var(--translate-y));z-index:6;--translate-x: calc(var(--anchor-left) - 100%);--translate-y: calc(var(--anchor-top) - 2px)}.story-editor-view__content--AiUvaboN{padding:0 0 16px 0;position:relative}.story-editor-view__content_short--Wc6n5kFe{--theme-font-size: var(--6c488b65);--theme-line-height: var(--e022f120);transition:background 200ms ease-out;display:flex;justify-content:center;align-items:center;position:relative;min-height:352px;padding:80px 54px;background:linear-gradient(104.55deg, rgba(255, 255, 255, 0.25) -11%, rgba(255, 255, 255, 0) 100%),var(--theme-background);overflow-anchor:none;margin:8px 0}.story-editor-view__content_short--Wc6n5kFe::before{content:"";display:block;position:absolute;top:0;left:0;width:100%;height:100%;background-color:var(--theme-cake-color, var(--color-bright-alpha-10));mask:url("https://cs.pikabu.ru/images/big_svg/bg-story-short.svg");-webkit-mask:url("https://cs.pikabu.ru/images/big_svg/bg-story-short.svg");mask-size:cover;-webkit-mask-size:cover}.story-editor-view__content_short-1--nhHus_1V{--theme-background: var(--color-primary-1000)}.story-editor-view__content_short-2--Z5O6Ap9W{--theme-background: var(--color-danger-1000)}.story-editor-view__content_short-3--TA8agDcu{--theme-background: var(--color-warning-1000)}.story-editor-view__content_short-4--HrSw3C91{--theme-background: var(--color-turquoise-900)}.story-editor-view__content_short-5--CDvdEyX1{--theme-background: var(--color-blue-900)}.story-editor-view__content_short-6--Mj2VM0Fx{--theme-background: var(--color-purple-900)}.story-editor-view__content_short-7--pEYeVC0d{--theme-background: var(--color-bright-800);--theme-color: var(--color-black-940);--theme-cake-color: var(--color-black-alpha-005)}.story-editor-view__skeleton--zw5Ma_9a{padding:16px 23px}.dragging-node-preview{background-color:var(--color-bright-800);position:fixed;left:0;top:0;overflow:hidden;will-change:transform;line-height:24px}.dragging-node-preview>*{opacity:.7}',""]),n.locals={host:"story-editor-view__host--puqpSJIx",host_disabled:"story-editor-view__host_disabled--yoQQeqXn",fab:"story-editor-view__fab--HdC5Gcnu",content:"story-editor-view__content--AiUvaboN",content_short:"story-editor-view__content_short--Wc6n5kFe","content_short-1":"story-editor-view__content_short-1--nhHus_1V","content_short-2":"story-editor-view__content_short-2--Z5O6Ap9W","content_short-3":"story-editor-view__content_short-3--TA8agDcu","content_short-4":"story-editor-view__content_short-4--HrSw3C91","content_short-5":"story-editor-view__content_short-5--CDvdEyX1","content_short-6":"story-editor-view__content_short-6--Mj2VM0Fx","content_short-7":"story-editor-view__content_short-7--pEYeVC0d",skeleton:"story-editor-view__skeleton--zw5Ma_9a"};const a=n},10800:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".theme-view__color--Eo6zzQiT{margin:0 0 16px 0;padding:0 32px}.theme-view__title--onqOVMUE{color:var(--color-black-800);margin-bottom:4px;font-size:13px;line-height:20px;font-weight:400}.theme-view__buttons--xkxKZz4I{display:flex}.theme-view__label--N2ob5PAO{padding:4px}.theme-view__button--sN0aKlqO{all:unset;display:block;box-sizing:border-box;width:32px;height:32px;border-radius:4px;cursor:pointer}.theme-view__button--sN0aKlqO:checked{outline:2px solid var(--color-primary-900);outline-offset:2px}.theme-view__button_1--_VP9j89k{background-color:var(--color-primary-1000)}.theme-view__button_2--C4PWi3WW{background-color:var(--color-danger-1000)}.theme-view__button_3--dEpGFc7a{background-color:var(--color-warning-1000)}.theme-view__button_4--B6VlNU1u{background-color:var(--color-turquoise-900)}.theme-view__button_5--Aq72a5iQ{background-color:var(--color-blue-900)}.theme-view__button_6--IwGy6zLM{background-color:var(--color-purple-900)}.theme-view__button_7--USkDBx0V{background-color:var(--color-bright-800);border:1px solid var(--color-black-430)}.theme-view__shortText--yB96RlTb{padding:13px 16px;border:solid var(--color-black-430);border-width:1px 0}",""]),n.locals={color:"theme-view__color--Eo6zzQiT",title:"theme-view__title--onqOVMUE",buttons:"theme-view__buttons--xkxKZz4I",label:"theme-view__label--N2ob5PAO",button:"theme-view__button--sN0aKlqO",button_1:"theme-view__button_1--_VP9j89k",button_2:"theme-view__button_2--C4PWi3WW",button_3:"theme-view__button_3--dEpGFc7a",button_4:"theme-view__button_4--B6VlNU1u",button_5:"theme-view__button_5--Aq72a5iQ",button_6:"theme-view__button_6--IwGy6zLM",button_7:"theme-view__button_7--USkDBx0V",shortText:"theme-view__shortText--yB96RlTb"};const a=n},44209:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".title-view__content--astkN9TQ{color:var(--color-black-940);position:relative;word-break:break-all;font-size:20px;line-height:28px;font-weight:400;padding:16px 24px 8px}.title-view__content_fixed--crrzHw_N{display:flex}textarea.title-view__content--astkN9TQ{outline:none;border:0;background-color:rgba(0,0,0,0);resize:none;display:block;width:100%;overflow:hidden}textarea.title-view__content--astkN9TQ::placeholder{font-size:inherit;font-weight:inherit;font-family:inherit;line-height:inherit;color:var(--color-black-700)}.title-view__fixedTitle--COne2E5f{margin-right:auto}.title-view__reset--RzY8oO2u{margin-left:8px}",""]),n.locals={content:"title-view__content--astkN9TQ",content_fixed:"title-view__content_fixed--crrzHw_N",fixedTitle:"title-view__fixedTitle--COne2E5f",reset:"title-view__reset--RzY8oO2u"};const a=n},4256:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".video-loader-view__host--knAnpsg6{position:relative;background-color:var(--color-black-900)}.video-loader-view__video--T3s_FNAI{display:block;width:100%;max-height:70vh;object-fit:contain}.video-loader-view__overlay--gND4aCuq{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;background-color:var(--color-black-alpha-70)}.video-loader-view__loader--MczBvFUJ{display:flex;align-items:center}.video-loader-view__text--JXf9_ANw{margin-left:12px;color:var(--color-bright-900);font-size:14px;line-height:24px;font-weight:400}.video-loader-view__deleteBtn--hx82IhAZ{position:absolute;top:24px;right:24px;z-index:2100}",""]),n.locals={host:"video-loader-view__host--knAnpsg6",video:"video-loader-view__video--T3s_FNAI",overlay:"video-loader-view__overlay--gND4aCuq",loader:"video-loader-view__loader--MczBvFUJ",text:"video-loader-view__text--JXf9_ANw",deleteBtn:"video-loader-view__deleteBtn--hx82IhAZ"};const a=n},20727:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".upd-editor-view__host--s6chIznc{position:relative}.upd-editor-view__title--xLBapzZP{color:var(--color-black-800);font-size:14px;line-height:24px;font-weight:500;padding:0 23px}.upd-editor-view__wrapper--JrUl07h_{position:relative;border-top:1px solid var(--color-black-430);border-bottom:1px solid var(--color-black-430);padding:11px 0}.upd-editor-view__checkbox--f3R3ziF7{margin:12px 23px}",""]),n.locals={host:"upd-editor-view__host--s6chIznc",title:"upd-editor-view__title--xLBapzZP",wrapper:"upd-editor-view__wrapper--JrUl07h_",checkbox:"upd-editor-view__checkbox--f3R3ziF7"};const a=n},76456:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".series-list__addIcon--xaNpz1iW{color:var(--color-primary-900)}",""]),n.locals={addIcon:"series-list__addIcon--xaNpz1iW"};const a=n},25451:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".series-selected__host--rp2nVCUB{display:flex;align-items:center;padding:10px 0 2px}.series-selected__avatar--Q2htaCxA{float:left;margin-right:8px}.series-selected__title--ALTHF7JE{font-size:14px;line-height:20px;font-weight:500}.series-selected__storiesCount--IS9X4cab{color:var(--color-black-700);margin-top:4px;font-size:13px;line-height:20px;font-weight:400}.series-selected__btn--OUmsP7Ry{margin-left:auto}",""]),n.locals={host:"series-selected__host--rp2nVCUB",avatar:"series-selected__avatar--Q2htaCxA",title:"series-selected__title--ALTHF7JE",storiesCount:"series-selected__storiesCount--IS9X4cab",btn:"series-selected__btn--OUmsP7Ry"};const a=n},58087:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".setting-exclusive-dialog-view__note--_Esu9vS3{font-size:14px;line-height:24px;font-weight:500;margin-top:4px}.setting-exclusive-dialog-view__cost--VVCoCQ8W{display:flex;align-items:center;margin-top:16px}.setting-exclusive-dialog-view__input--Wu00N4iA{width:160px}.setting-exclusive-dialog-view__units--h8ekxi9V{margin-left:8px;font-size:13px;line-height:20px;font-weight:400}.setting-exclusive-dialog-view__button--NvpKEQUh{margin-top:16px}.setting-exclusive-dialog-view__footer--CLPMhGmx{margin-top:16px;display:flex}.setting-exclusive-dialog-view__footer--CLPMhGmx>*:not(:first-child){margin-left:12px}",""]),n.locals={note:"setting-exclusive-dialog-view__note--_Esu9vS3",cost:"setting-exclusive-dialog-view__cost--VVCoCQ8W",input:"setting-exclusive-dialog-view__input--Wu00N4iA",units:"setting-exclusive-dialog-view__units--h8ekxi9V",button:"setting-exclusive-dialog-view__button--NvpKEQUh",footer:"setting-exclusive-dialog-view__footer--CLPMhGmx"};const a=n},33233:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".setting-exclusive-view__badge--AJ8Atyao{margin-left:4px}",""]),n.locals={badge:"setting-exclusive-view__badge--AJ8Atyao"};const a=n},68251:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".story-edit-page-settings-hint__host--FkWqZvcY{margin-left:5px}",""]),n.locals={host:"story-edit-page-settings-hint__host--FkWqZvcY"};const a=n},53141:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".story-edit-page-settings-scheduled-story__host--HJWj50kD{display:flex}.story-edit-page-settings-scheduled-story__day--Nr4_9L4X{min-width:164px;margin-right:8px}.story-edit-page-settings-scheduled-story__time--YvNokED_{width:100px}",""]),n.locals={host:"story-edit-page-settings-scheduled-story__host--HJWj50kD",day:"story-edit-page-settings-scheduled-story__day--Nr4_9L4X",time:"story-edit-page-settings-scheduled-story__time--YvNokED_"};const a=n},58123:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".story-edit-page-settings-series__host--RHIfUzO9{margin-top:8px}.story-edit-page-settings-series__addIcon--Q_cpTUQ3{color:var(--color-primary-900)}",""]),n.locals={host:"story-edit-page-settings-series__host--RHIfUzO9",addIcon:"story-edit-page-settings-series__addIcon--Q_cpTUQ3"};const a=n},94456:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".story-edit-page-settings-story-boost__label--XH62SXuz{display:flex;align-items:center}.story-edit-page-settings-story-boost__badge--g3ddQOAS{color:var(--color-primary-700);margin-left:4px;display:flex;padding:1px 3px;align-items:center;gap:4px;border-radius:4px;border:1px solid var(--color-primary-700);background:var(--color-primary-100);font-size:13px}",""]),n.locals={label:"story-edit-page-settings-story-boost__label--XH62SXuz",badge:"story-edit-page-settings-story-boost__badge--g3ddQOAS"};const a=n},34292:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".story-edit-page-settings__setting--axQJ4LBf{display:flex;align-items:center}.story-edit-page-settings__setting--axQJ4LBf:not(:first-child){margin-top:12px}.story-edit-page-settings__scheduledStory--cF9mBFXy{margin:8px 0 0 32px}.story-edit-page-settings__scheduledStoryError--_Cd2znY2{color:var(--color-danger-900);font-size:13px;line-height:20px;font-weight:400}",""]),n.locals={setting:"story-edit-page-settings__setting--axQJ4LBf",scheduledStory:"story-edit-page-settings__scheduledStory--cF9mBFXy",scheduledStoryError:"story-edit-page-settings__scheduledStoryError--_Cd2znY2"};const a=n},27983:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".story-edit-page-preview-popup__skeleton--pLx4baay{margin-top:15px;padding:15px 23px;background-color:var(--color-bright-800);border:1px solid var(--color-black-440);border-radius:2px}",""]),n.locals={skeleton:"story-edit-page-preview-popup__skeleton--pLx4baay"};const a=n},48762:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".story-edit-page-publish__card--udXr0dRz{padding:15px 23px}.story-edit-page-publish__card--udXr0dRz:not(:last-of-type){margin-bottom:16px}.story-edit-page-publish__previewButton--wbKQJV2g{margin-top:8px}",""]),n.locals={card:"story-edit-page-publish__card--udXr0dRz",previewButton:"story-edit-page-publish__previewButton--wbKQJV2g"};const a=n},80829:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".app__header--fDccoPR6{display:flex;align-items:center;padding:24px 0 0 24px}.app__body--zGc36O9_{overflow:hidden auto;background-color:var(--color-bright-800);margin:20px 0;flex:1}.app__modalCardBody--iywcgovn{width:520px;padding:0}.app__modalCardContent--UdN6OHuH{margin-right:0;padding-right:0}.app__content--ehFVP9n1{padding:0 24px}.app__drawer--oXkUVnrw{background-color:var(--color-black-300);display:flex;flex-direction:column;height:100%}.app__drawer--oXkUVnrw>:not(:last-child){flex-shrink:0}.app__drawer--oXkUVnrw>:last-child{flex-grow:1;display:flex;flex-direction:column;overflow:hidden}.app__bodyInner--vFoWZICH{height:1000px}.app__footer--ZAYFNGm7{padding:8px 24px 24px}.app__footer--ZAYFNGm7 button+button{margin-left:12px}",""]),n.locals={header:"app__header--fDccoPR6",body:"app__body--zGc36O9_",modalCardBody:"app__modalCardBody--iywcgovn",modalCardContent:"app__modalCardContent--UdN6OHuH",content:"app__content--ehFVP9n1",drawer:"app__drawer--oXkUVnrw",bodyInner:"app__bodyInner--vFoWZICH",footer:"app__footer--ZAYFNGm7"};const a=n},86253:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".series-avatar-view__avatar--FP5Dh7o_{border-radius:8px;flex-shrink:0}.series-avatar-view__loader--_UrHZvbw{border-radius:8px;margin-right:12px;flex-shrink:0}",""]),n.locals={avatar:"series-avatar-view__avatar--FP5Dh7o_",loader:"series-avatar-view__loader--_UrHZvbw"};const a=n},94923:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".series-item-view__host--JWO93XUM{padding:12px 0 11px;margin:0;display:flex}.series-item-view__host--JWO93XUM+.series-item-view__host--JWO93XUM:not(.series-item-view__host_swapping--UdkDSF8e){border-top:1px solid var(--color-black-430)}.series-item-view__host_swapping--UdkDSF8e{padding:0}.series-item-view__host--JWO93XUM:first-child:not(.series-item-view__host--JWO93XUM:last-child) .series-item-view__figure_swapping--MG_7D8pH{border-radius:8px 8px 0 0;border-top-width:1px}.series-item-view__host--JWO93XUM:last-child:not(.series-item-view__host--JWO93XUM:first-child) .series-item-view__figure_swapping--MG_7D8pH{border-radius:0 0 8px 8px}.series-item-view__host--JWO93XUM:first-child:last-child .series-item-view__figure_swapping--MG_7D8pH{border-radius:8px;border-top-width:1px}.series-item-view__swapControls--k4SFLG5G{display:flex;padding:20px 11px 20px 0}.series-item-view__swapBtn--M4g8iiud:last-child{margin-left:8px}.series-item-view__figure--qSfDzcaC{display:flex;align-items:center;flex-grow:1}.series-item-view__figure_swapping--MG_7D8pH{border:dashed var(--color-black-440);border-width:0 1px 1px 1px;padding:12px 11px 11px}.series-item-view__editBtn--T9ELR4rA{margin-left:auto}",""]),n.locals={host:"series-item-view__host--JWO93XUM",host_swapping:"series-item-view__host_swapping--UdkDSF8e",figure_swapping:"series-item-view__figure_swapping--MG_7D8pH",swapControls:"series-item-view__swapControls--k4SFLG5G",swapBtn:"series-item-view__swapBtn--M4g8iiud",figure:"series-item-view__figure--qSfDzcaC",editBtn:"series-item-view__editBtn--T9ELR4rA"};const a=n},27263:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".series-list-view__host--nNGn9sEN{max-height:560px;list-style:none;margin-left:0;overflow:hidden auto;overscroll-behavior:contain;color:var(--color-black-800);font-size:14px;line-height:24px;font-weight:400;scrollbar-color:var(--color-black-500) rgba(0,0,0,0);scrollbar-width:thin;margin-right:-16px;padding-right:10px}.series-list-view__host--nNGn9sEN::-webkit-scrollbar{width:4px}.series-list-view__host--nNGn9sEN::-webkit-scrollbar-thumb{background-color:var(--color-black-500);border-radius:8px}.series-list-view__host--nNGn9sEN::-webkit-scrollbar-thumb:hover{box-shadow:inset 0 0 0 2px rgba(0,0,0,.08)}.series-list-view__host--nNGn9sEN::-webkit-scrollbar-thumb:active{box-shadow:inset 0 0 0 2px rgba(0,0,0,.16)}.series-list-view__host--nNGn9sEN::-webkit-scrollbar-track{background-color:rgba(0,0,0,0);border-radius:2px}.series-list-view__loader--IXSNWvvH{flex-shrink:0;margin-right:16px;border-radius:8px}.series-list-view__swapControls--llJ10xSr{display:flex;padding:20px 11px 20px 0}.series-list-view__swapBtn--rBjcRzGk:last-child{margin-left:8px}.series-list-view__editBtn--mjtNNYEZ{margin-left:auto}",""]),n.locals={host:"series-list-view__host--nNGn9sEN",loader:"series-list-view__loader--IXSNWvvH",swapControls:"series-list-view__swapControls--llJ10xSr",swapBtn:"series-list-view__swapBtn--rBjcRzGk",editBtn:"series-list-view__editBtn--mjtNNYEZ"};const a=n},22606:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".series-title-view__title--aRZHy3xH{color:var(--color-black-940);font-weight:700;padding-left:12px;font-size:16px;line-height:20px}",""]),n.locals={title:"series-title-view__title--aRZHy3xH"};const a=n},84816:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".sort-controls-view__host--KwfM3Vgk{position:relative;font-size:14px;line-height:24px;font-weight:500;padding-top:12px;height:40px}.sort-controls-view__host--KwfM3Vgk>*{position:absolute}.sort-controls-view__edit--yLv4Gain{display:inline-flex;align-items:center}.sort-controls-view__edit--yLv4Gain:hover{text-decoration:none}.sort-controls-view__slideUp--K6K7PiI6{transition:opacity 200ms ease-out,visibility 200ms ease-out,transform 200ms ease-out}.sort-controls-view__slideUp--K6K7PiI6-enter-from,.sort-controls-view__slideUp--K6K7PiI6-leave-to{transform:translateY(16px);opacity:0;visibility:hidden}.sort-controls-view__sortingIcon--dRy9QdrV{margin-right:8px}",""]),n.locals={host:"sort-controls-view__host--KwfM3Vgk",edit:"sort-controls-view__edit--yLv4Gain",slideUp:"sort-controls-view__slideUp--K6K7PiI6",sortingIcon:"sort-controls-view__sortingIcon--dRy9QdrV"};const a=n},69320:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".sort-select-view__host--syk3SLfU{display:inline-flex}.sort-select-view__dropdownAnchor--BfXJrtTB{display:inline-flex;align-items:center;margin-left:4px;font-size:14px;line-height:24px;font-weight:500}.sort-select-view__dropdownAnchor--BfXJrtTB:hover{text-decoration:none}.sort-select-view__dropdownIcon--vMKpQHoM{margin:1px 0 0 4px}",""]),n.locals={host:"sort-select-view__host--syk3SLfU",dropdownAnchor:"sort-select-view__dropdownAnchor--BfXJrtTB",dropdownIcon:"sort-select-view__dropdownIcon--vMKpQHoM"};const a=n},25093:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".author-view__host--IxZaHBEQ{display:flex;flex-direction:column;align-items:center}.author-view__user--_ZVqBUrD{margin-top:8px;color:var(--color-black-940);display:flex;align-items:center;font-size:18px;line-height:24px;font-weight:500}.author-view__icon--BHr4PDv8{color:var(--color-primary-700);margin-left:4px}",""]),n.locals={host:"author-view__host--IxZaHBEQ",user:"author-view__user--_ZVqBUrD",icon:"author-view__icon--BHr4PDv8"};const a=n},31199:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".card-form-view__host--w6Hk9f7I{display:flex;flex-direction:column;align-items:center;padding:28px 0 16px 0}.card-form-view__cost--hFIUeHct{margin-top:20px;font-size:16px;line-height:24px;font-weight:700}.card-form-view__commission--tmnAi_d8{margin-top:4px;color:var(--color-black-700);font-size:14px;line-height:24px;font-weight:400}.card-form-view__card--qaP2MLDS{margin-top:20px}.card-form-view__button--RRsDCI30{min-width:200px;margin-top:24px}.card-form-view__agreement--yM9XQ4jc{margin-top:8px;text-align:center;color:var(--color-black-700);font-size:13px;line-height:20px;font-weight:400}",""]),n.locals={host:"card-form-view__host--w6Hk9f7I",cost:"card-form-view__cost--hFIUeHct",commission:"card-form-view__commission--tmnAi_d8",card:"card-form-view__card--qaP2MLDS",button:"card-form-view__button--RRsDCI30",agreement:"card-form-view__agreement--yM9XQ4jc"};const a=n},30155:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".verification-form-view__host--O3Ch3PP6{padding:24px 0 16px 0}.verification-form-view__frame--wB_Ltusu{display:block;border:none;width:100%;height:500px;border-radius:8px}",""]),n.locals={host:"verification-form-view__host--O3Ch3PP6",frame:"verification-form-view__frame--wB_Ltusu"};const a=n},28661:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".support-view__host--zm4dxVLm{display:flex;flex-direction:column;align-items:center;padding:28px 0 16px 0}.support-view__options--W6G_SOG3{width:100%;margin-top:12px}.support-view__option--F1T6uEpI:not(:first-child){margin-top:16px}.support-view__note--W7GbkLLh{margin:4px 0 0 36px;color:var(--color-black-800);font-size:13px;line-height:20px;font-weight:400}.support-view__button--flYNOf8M{margin-top:24px}",""]),n.locals={host:"support-view__host--zm4dxVLm",options:"support-view__options--W6G_SOG3",option:"support-view__option--F1T6uEpI",note:"support-view__note--W7GbkLLh",button:"support-view__button--flYNOf8M"};const a=n},20779:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".app__body--cCR7jGq8{position:relative;z-index:2}.app__title--DJoP4M1z{text-align:center;padding:12px 0}.app__list--_5ynODKs{padding:12px 0}.app__btns--ZHLotSQa{display:flex;align-items:center;gap:12px;padding-top:16px}.app__confetti--cJDArxZ5{position:absolute;top:50%;left:50%}.app__confetti_right--bHgyWJgg{transform:translate(0, -72%)}.app__confetti_left--g5X4sD7k{transform:translate(-100%, -72%)}.app__help--aE_hS1ql{margin-left:auto;font-size:14px;line-height:24px;font-weight:500}.app__help--aE_hS1ql:hover{text-decoration:none}",""]),n.locals={body:"app__body--cCR7jGq8",title:"app__title--DJoP4M1z",list:"app__list--_5ynODKs",btns:"app__btns--ZHLotSQa",confetti:"app__confetti--cJDArxZ5",confetti_right:"app__confetti_right--bHgyWJgg",confetti_left:"app__confetti_left--g5X4sD7k",help:"app__help--aE_hS1ql"};const a=n},92465:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".icon-view__host--ICD3HqoJ{display:flex;align-items:center;justify-content:center}.icon-view__medal--XtP0yAAJ{height:200px;width:200px;transform-origin:center top;animation:icon-view__swing--h6pmxfGk 2s ease-in-out}.icon-view__stroke--teve0pJh{stroke-dasharray:163;stroke-dashoffset:163;animation:icon-view__dash--RzoK2bzH .7s linear forwards}@keyframes icon-view__dash--RzoK2bzH{to{stroke-dashoffset:0}}.icon-view__star--REfP6FZT{animation:icon-view__fadein--P0M7rR86 .7s ease-in-out}@keyframes icon-view__fadein--P0M7rR86{0%{opacity:0}100%{opacity:1}}@keyframes icon-view__swing--h6pmxfGk{0%{transform:rotate(35deg)}12.5%{transform:rotate(-30deg)}25%{transform:rotate(23deg)}37.5%{transform:rotate(-17deg)}50%{transform:rotate(10deg)}62.5%{transform:rotate(-3deg)}75%{transform:rotate(1deg)}100%{transform:rotate(0)}}",""]),n.locals={host:"icon-view__host--ICD3HqoJ",medal:"icon-view__medal--XtP0yAAJ",swing:"icon-view__swing--h6pmxfGk",stroke:"icon-view__stroke--teve0pJh",dash:"icon-view__dash--RzoK2bzH",star:"icon-view__star--REfP6FZT",fadein:"icon-view__fadein--P0M7rR86"};const a=n},60973:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-action-sheet__modal--BcrS0WIj{padding:11px 0 15px;border:1px solid var(--color-black-430)}.pkb-action-sheet__closeBtn--VMa9HdZQ{margin:16px 15px 0}",""]),n.locals={modal:"pkb-action-sheet__modal--BcrS0WIj",closeBtn:"pkb-action-sheet__closeBtn--VMa9HdZQ"};const a=n},72693:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-alert__host--r46r69mD{display:flex;align-items:flex-start;color:var(--color-black-800);border:1px solid var(--color-primary-700);background-color:var(--color-primary-100);padding:11px 15px;border-radius:8px;position:relative;font-size:13px;line-height:20px;font-weight:400}.pkb-alert__host--r46r69mD .pkb-alert__icon--hrCiTfh8{color:var(--color-primary-800);flex-shrink:0;margin-right:8px}.pkb-alert__host_red--ya152mqF{background-color:var(--color-danger-200);border-color:var(--color-danger-800)}.pkb-alert__host_red--ya152mqF .pkb-alert__icon--hrCiTfh8{color:var(--color-danger-800)}.pkb-alert__host_yellow--jMJVVLHw{background-color:var(--color-warning-200);border-color:var(--color-warning-900)}.pkb-alert__host_yellow--jMJVVLHw .pkb-alert__icon--hrCiTfh8{color:var(--color-warning-900)}.pkb-alert__host_gray--PslMTKw8{background-color:var(--color-black-200);border-color:var(--color-black-400)}.pkb-alert__host_gray--PslMTKw8 .pkb-alert__icon--hrCiTfh8{color:var(--color-black-600)}.pkb-alert__close-button--KJvKEjIj{color:var(--color-black-600);padding:4px;cursor:pointer;float:right}.pkb-alert__title--Ll_eOxjY{color:var(--color-black-900);margin-bottom:4px;font-size:13px;line-height:20px;font-weight:500}.pkb-alert__content--PXo8fyz_{flex-grow:1}.pkb-alert__buttons--AzrapjmO{margin-top:8px}.pkb-alert__buttons__button--EszLLuem{all:unset;color:var(--color-primary-900);text-decoration:none;cursor:pointer;font-size:13px;line-height:20px;font-weight:500}",""]),n.locals={host:"pkb-alert__host--r46r69mD",icon:"pkb-alert__icon--hrCiTfh8",host_red:"pkb-alert__host_red--ya152mqF",host_yellow:"pkb-alert__host_yellow--jMJVVLHw",host_gray:"pkb-alert__host_gray--PslMTKw8","close-button":"pkb-alert__close-button--KJvKEjIj",title:"pkb-alert__title--Ll_eOxjY",content:"pkb-alert__content--PXo8fyz_",buttons:"pkb-alert__buttons--AzrapjmO",buttons__button:"pkb-alert__buttons__button--EszLLuem"};const a=n},7553:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-animated-back-icon-btn__host--jCMkLASQ{display:inline-flex;align-items:center;justify-content:center;position:relative;height:28px;width:0;transition:width 200ms ease-out}.pkb-animated-back-icon-btn__host_active--NPl_r125{width:28px;margin-right:8px}.pkb-animated-back-icon-btn__icon--ArHsxdpJ{color:var(--color-black-800);position:absolute;left:50%;transform:translate3d(-50%, 0, 0);transition:opacity 200ms ease-out,visibility 200ms ease-out,transform 200ms ease-out;cursor:pointer}.pkb-animated-back-icon-btn__icon--ArHsxdpJ-enter-from,.pkb-animated-back-icon-btn__icon--ArHsxdpJ-leave-to{transform:translate3d(-100%, 0, 0);opacity:0;visibility:hidden}",""]),n.locals={host:"pkb-animated-back-icon-btn__host--jCMkLASQ",host_active:"pkb-animated-back-icon-btn__host_active--NPl_r125",icon:"pkb-animated-back-icon-btn__icon--ArHsxdpJ"};const a=n},93751:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-animated-slide__host--fU_4Tw3s{transition:height 200ms ease-out;overflow:hidden}",""]),n.locals={host:"pkb-animated-slide__host--fU_4Tw3s"};const a=n},24719:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-bank-card-header__host--kaHhEXea{height:32px;display:flex;align-items:flex-start;justify-content:flex-end}.pkb-bank-card-header__bankLogo--jLTran2s{height:100%;margin-right:auto;transition:200ms ease-out}.pkb-bank-card-header__bankLogo_hidden--U3UZPJ8B{opacity:0;transform:translateX(-16px)}.pkb-bank-card-header__issuerLogo--Jxk48WPi{height:20px;transition:200ms ease-out;flex-basis:auto;overflow:hidden}.pkb-bank-card-header__issuerLogo--Jxk48WPi:not(:first-child){margin-left:8px}.pkb-bank-card-header__issuerLogo_hidden--Hitygh_X{opacity:0;transform:translateX(16px)}.pkb-bank-card-header__issuerLogo_leave_active--dJculPht{position:absolute}",""]),n.locals={host:"pkb-bank-card-header__host--kaHhEXea",bankLogo:"pkb-bank-card-header__bankLogo--jLTran2s",bankLogo_hidden:"pkb-bank-card-header__bankLogo_hidden--U3UZPJ8B",issuerLogo:"pkb-bank-card-header__issuerLogo--Jxk48WPi",issuerLogo_hidden:"pkb-bank-card-header__issuerLogo_hidden--Hitygh_X",issuerLogo_leave_active:"pkb-bank-card-header__issuerLogo_leave_active--dJculPht"};const a=n},90849:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.pkb-bank-card__host--FllJEV87{border-radius:8px;display:flex;width:460px;max-width:100%}.pkb-bank-card__front--_pYCecBO{overflow:hidden;position:relative;background:#e8e8e9;border-radius:inherit;box-shadow:var(--shadow-low);z-index:1;color:var(--color-black-800);transition:200ms ease-out;flex:1 1 0;padding:16px}:root[data-theme-dark] .pkb-bank-card__front--_pYCecBO{background:#383a3f}.pkb-bank-card__front_alfa--_ujIg4_N{background:radial-gradient(50% 125%, rgba(255, 255, 255, 0.22), rgba(0, 0, 0, 0)),#ef3124 !important;color:var(--color-bright-900)}.pkb-bank-card__front_gazprom--bvtRl8Sr{background:radial-gradient(50% 125%, rgba(255, 255, 255, 0.22), rgba(0, 0, 0, 0)),#476bf0 !important;color:var(--color-bright-900)}.pkb-bank-card__front_sber--NOaRzPVh{background:linear-gradient(300deg, rgba(0, 0, 0, 0) 22%, rgba(255, 255, 255, 0.5) 98%),linear-gradient(70deg, #fcea00 9%, #43bc00 54%, #0089d1 86%) !important;color:var(--color-bright-900)}.pkb-bank-card__front_tinkoff--HJyvRmO6{background:radial-gradient(50% 125%, rgba(255, 255, 255, 0.22), rgba(0, 0, 0, 0)),#000 !important;color:var(--color-bright-900)}.pkb-bank-card__front_vtb--Kncsqp9b{background:radial-gradient(50% 125%, rgba(255, 255, 255, 0.22), rgba(0, 0, 0, 0)),linear-gradient(111deg, #163bf5 3%, #3983f7) !important;color:var(--color-bright-900)}.pkb-bank-card__body--EISQmGPL{margin-top:16px}.pkb-bank-card__label--yUi2Jaq5{font-size:12px;line-height:16px;font-weight:400}.pkb-bank-card__label--yUi2Jaq5:not(:first-child){margin-top:16px}.pkb-bank-card__fieldNumber--SL52Qtqv{margin-top:4px}.pkb-bank-card__date--X_quzbck{margin-top:4px;display:flex;align-items:center}.pkb-bank-card__fieldDate--LTUU4NfO{width:60px}.pkb-bank-card__separator--FKVh6R8y{margin:0 4px;font-size:14px;line-height:24px;font-weight:400}.pkb-bank-card__back--guTsPBVL{display:flex;flex:0 0 29.567%;min-width:105px;flex-direction:column;justify-content:flex-end;position:relative;border-top-right-radius:inherit;border-bottom-right-radius:inherit;z-index:0;color:var(--color-black-800);background:linear-gradient(#e3e3e3 20px, #646465 20px, #646465 60px, #e3e3e3 60px);padding:16px 12px}:root[data-theme-dark] .pkb-bank-card__back--guTsPBVL{background:linear-gradient(#303135 20px, #1d1d1d 20px, #1d1d1d 60px, #303135 60px)}.pkb-bank-card__back--guTsPBVL::before{content:"";display:block;position:absolute;right:100%;width:8px;height:100%;top:0;background:inherit}.pkb-bank-card__fieldCvv--sNangHjg{margin-top:4px;width:60px}.pkb-bank-card__note--brqxPln0{margin-top:4px;font-size:11px;line-height:16px;font-weight:400}',""]),n.locals={host:"pkb-bank-card__host--FllJEV87",front:"pkb-bank-card__front--_pYCecBO",front_alfa:"pkb-bank-card__front_alfa--_ujIg4_N",front_gazprom:"pkb-bank-card__front_gazprom--bvtRl8Sr",front_sber:"pkb-bank-card__front_sber--NOaRzPVh",front_tinkoff:"pkb-bank-card__front_tinkoff--HJyvRmO6",front_vtb:"pkb-bank-card__front_vtb--Kncsqp9b",body:"pkb-bank-card__body--EISQmGPL",label:"pkb-bank-card__label--yUi2Jaq5",fieldNumber:"pkb-bank-card__fieldNumber--SL52Qtqv",date:"pkb-bank-card__date--X_quzbck",fieldDate:"pkb-bank-card__fieldDate--LTUU4NfO",separator:"pkb-bank-card__separator--FKVh6R8y",back:"pkb-bank-card__back--guTsPBVL",fieldCvv:"pkb-bank-card__fieldCvv--sNangHjg",note:"pkb-bank-card__note--brqxPln0"};const a=n},32764:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-base-input__host--pskWR_bB{font-size:13px;line-height:20px;font-weight:400;display:flex;align-items:center;background-color:var(--color-bright-800);border:1px solid var(--color-black-430);border-radius:8px;padding:9px 15px;cursor:text;position:relative;transition:border-color 200ms ease-out}.pkb-base-input__host_error--qYpTpqrE{border-color:var(--color-danger-800)}.pkb-base-input__host--pskWR_bB:focus-within{border-color:var(--color-primary-900)}.pkb-base-input__host--pskWR_bB:focus-visible{outline:none}.pkb-base-input__host_disabled--iodVTgEC{opacity:.5;cursor:not-allowed}.pkb-base-input__host_disabled--iodVTgEC>*{pointer-events:none}.pkb-base-input__host_small--v77TXGx8{padding:5px 11px}.pkb-base-input__host_large--xb464cfY{padding:13px 23px}.pkb-base-input__host_gray--uQYNSJ04{background-color:var(--color-black-300)}.pkb-base-input__host_borderless--PBdGr2HA{border:0}.pkb-base-input__inputWrapper--XrcoHKtF{flex:1 1 0;position:relative;overflow:hidden;min-height:20px}.pkb-base-input__label--FHCJSPGQ{display:block;position:absolute;pointer-events:none;color:var(--color-black-700);white-space:nowrap;overflow:hidden;width:100%;text-overflow:ellipsis;top:50%;left:0;transform:translateY(-50%)}.pkb-base-input__bar--oUrnvsEo{margin-left:8px;width:16px;height:16px}.pkb-base-input__loader--DrxQowdX{position:absolute;pointer-events:none}.pkb-base-input__clearButton--pc3o_NYu{color:var(--color-black-600);cursor:pointer}.pkb-base-input__restSymbols--kXsTr6e5{position:absolute;color:var(--color-black-600);bottom:7px;right:7px;font-size:11px;line-height:16px;font-weight:400}.pkb-base-input__prefix--BalmDlPE{margin-right:8px}.pkb-base-input__suffix--N405svOO{margin-left:8px}.pkb-base-input__error--a0CuqgDW{padding:12px;max-width:502px;font-size:13px;line-height:20px;font-weight:400}",""]),n.locals={host:"pkb-base-input__host--pskWR_bB",host_error:"pkb-base-input__host_error--qYpTpqrE",host_disabled:"pkb-base-input__host_disabled--iodVTgEC",host_small:"pkb-base-input__host_small--v77TXGx8",host_large:"pkb-base-input__host_large--xb464cfY",host_gray:"pkb-base-input__host_gray--uQYNSJ04",host_borderless:"pkb-base-input__host_borderless--PBdGr2HA",inputWrapper:"pkb-base-input__inputWrapper--XrcoHKtF",label:"pkb-base-input__label--FHCJSPGQ",bar:"pkb-base-input__bar--oUrnvsEo",loader:"pkb-base-input__loader--DrxQowdX",clearButton:"pkb-base-input__clearButton--pc3o_NYu",restSymbols:"pkb-base-input__restSymbols--kXsTr6e5",prefix:"pkb-base-input__prefix--BalmDlPE",suffix:"pkb-base-input__suffix--N405svOO",error:"pkb-base-input__error--a0CuqgDW"};const a=n},10977:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-btn__host--n2MGeea1{--pkb-btn_color: var(--color-primary-700);border-radius:8px;background-color:var(--pkb-btn_color);color:var(--color-bright-900);cursor:pointer;display:inline-flex;overflow:hidden;position:relative;align-items:center;justify-content:center;text-overflow:ellipsis;text-transform:none;user-select:none;white-space:nowrap;padding:8px 24px;min-width:40px;min-height:40px;transition:filter 200ms ease-out;font-size:14px;line-height:24px;font-weight:500}@media(hover: hover){.pkb-btn__host--n2MGeea1:hover{text-decoration:none;filter:opacity(0.8) brightness(1)}}.pkb-btn__host_active--okWGHzuS:not(:hover),.pkb-btn__host--n2MGeea1:active{filter:opacity(1) brightness(0.8)}.pkb-btn__host--n2MGeea1:focus-visible{box-shadow:var(--shadow-focus)}.pkb-btn__host_disabled--oSOk2g8S{pointer-events:none;opacity:.5}.pkb-btn__host_wide--pv56KZ78{width:100%}.pkb-btn__host_loading--yBz5vs0Q{pointer-events:none}.pkb-btn__host_loading--yBz5vs0Q .pkb-btn__icon--RIMAA8KC,.pkb-btn__host_loading--yBz5vs0Q .pkb-btn__text--FO_UA9yM{visibility:hidden}.pkb-btn__host_icon--_6TmyFom{padding:12px}.pkb-btn__host_small--tfNFdJh9{padding:4px 20px;min-width:32px;min-height:32px}.pkb-btn__host_small--tfNFdJh9.pkb-btn__host_icon--_6TmyFom{padding:8px}.pkb-btn__host_tiny--RohF1ppA{padding:4px 8px;min-width:28px;min-height:28px}.pkb-btn__host_micro--SoKHh6QS{padding:2px 8px;min-width:20px;min-height:20px;font-size:12px;line-height:16px;font-weight:400}.pkb-btn__host_large--I2FV4_RE{min-height:48px}.pkb-btn__host_negative--zheV02Cr{--pkb-btn_color: var(--color-danger-800)}.pkb-btn__host_gray--IZZxwJ9K{--pkb-btn_color: var(--color-black-440);color:var(--color-black-700)}.pkb-btn__host_dark--qPpzSqIX{--pkb-btn_color: var(--color-black-alpha-70)}.pkb-btn__host_outline--zAiPINw3{background:rgba(0,0,0,0);border:1px solid var(--pkb-btn_color);color:var(--pkb-btn_color);padding:7px 23px;transition:filter 200ms ease-out,border-color 200ms ease-out}.pkb-btn__host_outline--zAiPINw3.pkb-btn__host_icon--_6TmyFom{padding:11px}.pkb-btn__host_outline--zAiPINw3.pkb-btn__host_small--tfNFdJh9{padding:3px 19px}.pkb-btn__host_outline--zAiPINw3.pkb-btn__host_small--tfNFdJh9.pkb-btn__host_icon--_6TmyFom{padding:7px}@supports(color: color-mix(in sRGB, white, black)){.pkb-btn__host--n2MGeea1{--pkb-btn_color-hover: color-mix(in sRGB, var(--pkb-btn_color), #ffffff 20%);--pkb-btn_color-active: color-mix(in sRGB, var(--pkb-btn_color), #000000 20%);transition:background-color 200ms ease-out,color 200ms ease-out,border-color 200ms ease-out}@media(hover: hover){.pkb-btn__host--n2MGeea1:hover{filter:none;background:var(--pkb-btn_color-hover)}}.pkb-btn__host_active--okWGHzuS:not(:hover),.pkb-btn__host--n2MGeea1:active{filter:none;background:var(--pkb-btn_color-active)}.pkb-btn__host_outline--zAiPINw3{background:rgba(0,0,0,0);border:1px solid var(--pkb-btn_color);color:var(--pkb-btn_color);padding:7px 23px}@media(hover: hover){.pkb-btn__host_outline--zAiPINw3:hover{background:rgba(0,0,0,0);border-color:var(--pkb-btn_color-hover);color:var(--pkb-btn_color-hover)}}.pkb-btn__host_outline--zAiPINw3.pkb-btn__host_active--okWGHzuS:not(:hover),.pkb-btn__host_outline--zAiPINw3:active{background:rgba(0,0,0,0);border-color:var(--pkb-btn_color-active);color:var(--pkb-btn_color-active)}}.pkb-btn__loader--UV9aYcn4{position:absolute}.pkb-btn__icon--RIMAA8KC+.pkb-btn__text--FO_UA9yM,.pkb-btn__text--FO_UA9yM+.pkb-btn__icon--RIMAA8KC{margin-left:8px}",""]),n.locals={host:"pkb-btn__host--n2MGeea1",host_active:"pkb-btn__host_active--okWGHzuS",host_disabled:"pkb-btn__host_disabled--oSOk2g8S",host_wide:"pkb-btn__host_wide--pv56KZ78",host_loading:"pkb-btn__host_loading--yBz5vs0Q",icon:"pkb-btn__icon--RIMAA8KC",text:"pkb-btn__text--FO_UA9yM",host_icon:"pkb-btn__host_icon--_6TmyFom",host_small:"pkb-btn__host_small--tfNFdJh9",host_tiny:"pkb-btn__host_tiny--RohF1ppA",host_micro:"pkb-btn__host_micro--SoKHh6QS",host_large:"pkb-btn__host_large--I2FV4_RE",host_negative:"pkb-btn__host_negative--zheV02Cr",host_gray:"pkb-btn__host_gray--IZZxwJ9K",host_dark:"pkb-btn__host_dark--qPpzSqIX",host_outline:"pkb-btn__host_outline--zAiPINw3",loader:"pkb-btn__loader--UV9aYcn4"};const a=n},76618:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.pkb-card__host--QMLjxvPm{background-color:var(--color-bright-800);border:1px solid var(--color-black-430);border-radius:8px}.pkb-card__host_disabled--ds6Br0rb{opacity:.4;pointer-events:none;user-select:none;position:relative}.pkb-card__host_disabled--ds6Br0rb::after{pointer-events:auto;content:"";position:absolute;display:block;cursor:not-allowed;top:0;bottom:0;left:0;right:0}',""]),n.locals={host:"pkb-card__host--QMLjxvPm",host_disabled:"pkb-card__host_disabled--ds6Br0rb"};const a=n},79392:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-checkbox__host--m7C_OVc_{display:inline-flex;align-items:center;user-select:none;cursor:pointer}.pkb-checkbox__host_disabled--E5jOPcUO{opacity:.5;cursor:not-allowed}.pkb-checkbox__check--kQEIYePs{display:flex;align-items:center;justify-content:center;flex-shrink:0;height:20px;width:20px;color:var(--color-bright-900);background-color:var(--color-bright-800);border:1px solid var(--color-black-600);border-radius:4px;transition:background-color 200ms ease-out}.pkb-checkbox__checkbox--L7S2XC_c:checked+.pkb-checkbox__check--kQEIYePs,.pkb-checkbox__checkbox--L7S2XC_c:indeterminate+.pkb-checkbox__check--kQEIYePs{background-color:var(--color-primary-700);border:0}.pkb-checkbox__label--hovu4hNU{font-size:14px;line-height:24px;font-weight:400;margin-left:12px}",""]),n.locals={host:"pkb-checkbox__host--m7C_OVc_",host_disabled:"pkb-checkbox__host_disabled--E5jOPcUO",check:"pkb-checkbox__check--kQEIYePs",checkbox:"pkb-checkbox__checkbox--L7S2XC_c",label:"pkb-checkbox__label--hovu4hNU"};const a=n},13726:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-community-avatar__img--K5eNQVJR{display:block;border-radius:8px}",""]),n.locals={img:"pkb-community-avatar__img--K5eNQVJR"};const a=n},65833:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-community-details__host--Jbg5Gta0{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;font-size:13px;line-height:20px;font-weight:400;color:var(--color-black-700)}.pkb-community-details__host--Jbg5Gta0 span+span{margin-left:4px}",""]),n.locals={host:"pkb-community-details__host--Jbg5Gta0"};const a=n},48055:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-community-selection__host--UOnqVqZ9{display:flex;align-items:center;padding:4px 0}.pkb-community-selection__host_add--N9Zo9Lix{transition:background-color 200ms ease-out;cursor:pointer}.pkb-community-selection__host_add--N9Zo9Lix .pkb-community-selection__button--LUGaTsuC,.pkb-community-selection__host_add--N9Zo9Lix .pkb-community-selection__link--qkYGFxix{opacity:0}.pkb-community-selection__host_add--N9Zo9Lix:hover{background-color:var(--color-primary-100)}.pkb-community-selection__host_add--N9Zo9Lix:hover .pkb-community-selection__button--LUGaTsuC,.pkb-community-selection__host_add--N9Zo9Lix:hover .pkb-community-selection__link--qkYGFxix{opacity:1}.pkb-community-selection__host--UOnqVqZ9:focus-visible{outline:0;box-shadow:var(--shadow-focus)}.pkb-community-selection__avatar--rULKEyZx{flex-shrink:0}.pkb-community-selection__info--nQlsMqzu{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;margin-left:8px;flex-grow:1}.pkb-community-selection__title--iBW7wAdG{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;color:var(--color-black-940);display:flex;align-items:center}.pkb-community-selection__title--iBW7wAdG span{text-overflow:ellipsis;overflow:hidden}.pkb-community-selection__link--qkYGFxix{display:inline;color:var(--color-black-700);margin-left:4px;transition:opacity 200ms ease-out}.pkb-community-selection__button--LUGaTsuC{flex-shrink:0;margin-left:4px;transition:opacity 200ms ease-out}",""]),n.locals={host:"pkb-community-selection__host--UOnqVqZ9",host_add:"pkb-community-selection__host_add--N9Zo9Lix",button:"pkb-community-selection__button--LUGaTsuC",link:"pkb-community-selection__link--qkYGFxix",avatar:"pkb-community-selection__avatar--rULKEyZx",info:"pkb-community-selection__info--nQlsMqzu",title:"pkb-community-selection__title--iBW7wAdG"};const a=n},17701:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-control-btn__host--JF26HTaH{all:unset;background-color:var(--color-bright-800);border:1px solid var(--color-black-430);box-sizing:border-box;border-radius:4px;color:var(--color-black-700);width:24px;height:24px;display:flex;align-items:center;justify-content:center;transition:all 200ms ease-out;position:relative}@media(hover: hover){.pkb-control-btn__host--JF26HTaH:hover{filter:unset;cursor:pointer;color:var(--color-black-600)}}.pkb-control-btn__host--JF26HTaH:focus-visible{border:none;box-shadow:var(--shadow-focus)}.pkb-control-btn__host--JF26HTaH:active{filter:unset;background-color:var(--color-black-300)}.pkb-control-btn__host_active--l5xgBqqK{background-color:var(--color-black-100)}.pkb-control-btn__host--JF26HTaH:disabled{opacity:.5;cursor:not-allowed}.pkb-control-btn__host--JF26HTaH:disabled *{pointer-events:none}.pkb-control-btn__host_lg--mNE5fRqK{width:32px;height:32px;border-radius:8px}.pkb-control-btn__host_media--ynr2aAae{background-color:var(--color-bright-alpha-70);border:0}.pkb-control-btn__host_media--ynr2aAae:active{background-color:var(--color-bright-alpha-70)}@media(hover: hover){.pkb-control-btn__host_media--ynr2aAae:hover{color:var(--color-black-700)}}",""]),n.locals={host:"pkb-control-btn__host--JF26HTaH",host_active:"pkb-control-btn__host_active--l5xgBqqK",host_lg:"pkb-control-btn__host_lg--mNE5fRqK",host_media:"pkb-control-btn__host_media--ynr2aAae"};const a=n},42876:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-delete-confirm-popup__content--mapQWEBS{color:var(--color-black-800);font-size:14px;line-height:24px;font-weight:400}.pkb-delete-confirm-popup__button--K08SVpYl:not(:first-child){margin-left:12px}",""]),n.locals={content:"pkb-delete-confirm-popup__content--mapQWEBS",button:"pkb-delete-confirm-popup__button--K08SVpYl"};const a=n},73151:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.pkb-divider__host--PtYv2dzP{display:flex;align-items:center}.pkb-divider__host--PtYv2dzP::before,.pkb-divider__host--PtYv2dzP::after{content:"";display:block;height:1px;background:var(--color-black-430);flex-grow:1}.pkb-divider__label--W1tftpeH{font-size:13px;line-height:20px;font-weight:500;color:var(--color-black-700);margin:0 16px}',""]),n.locals={host:"pkb-divider__host--PtYv2dzP",label:"pkb-divider__label--W1tftpeH"};const a=n},6853:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-drawer-search__list--iTJp5ewj{padding:8px 0}.pkb-drawer-search__tip--IVqZBwxK{display:flex;padding:20px 16px 20px 56px}.pkb-drawer-search__upIconWrapper--tdwaGwR6{display:inline-flex;color:var(--color-black-700);width:20px;height:20px;margin-right:12px}.pkb-drawer-search__upIcon--CBJ4keEH{margin:auto}",""]),n.locals={list:"pkb-drawer-search__list--iTJp5ewj",tip:"pkb-drawer-search__tip--IVqZBwxK",upIconWrapper:"pkb-drawer-search__upIconWrapper--tdwaGwR6",upIcon:"pkb-drawer-search__upIcon--CBJ4keEH"};const a=n},45197:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-drawer__host--PyLiONAB{background-color:var(--color-bright-800);bottom:0;left:0;overflow:hidden;overscroll-behavior:contain;position:fixed;right:0;top:0;will-change:transform;transition:transform 200ms ease-out,opacity 200ms ease-out;display:flex;flex-direction:column;height:100%}.pkb-drawer__host--PyLiONAB-enter-from,.pkb-drawer__host--PyLiONAB-leave-to{transform:translateX(100vw);opacity:0;pointer-events:none}.pkb-drawer__header--toqAJCrr{position:sticky;top:0;z-index:5000;flex-shrink:0}.pkb-drawer__content--nujONAHH{flex-grow:1;display:flex;flex-direction:column;overflow:hidden auto}.pkb-drawer__footer--IZf0mthb{background:var(--color-bright-800);box-shadow:var(--shadow-mobi);padding:12px 16px}",""]),n.locals={host:"pkb-drawer__host--PyLiONAB",header:"pkb-drawer__header--toqAJCrr",content:"pkb-drawer__content--nujONAHH",footer:"pkb-drawer__footer--IZf0mthb"};const a=n},80198:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-dropdown-transition__host--mzJttvXv-enter-active,.pkb-dropdown-transition__host--mzJttvXv-leave-active{transition:opacity 250ms ease,visibility 250ms ease,transform 250ms cubic-bezier(0.71, 1.7, 0.77, 1.24)}.pkb-dropdown-transition__host--mzJttvXv-enter-from,.pkb-dropdown-transition__host--mzJttvXv-leave-to{transform:translate3d(0, 20px, 0);opacity:0;visibility:hidden}",""]),n.locals={host:"pkb-dropdown-transition__host--mzJttvXv"};const a=n},16586:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-dropdown__host--o4R3A1Eg{position:absolute;overflow-y:auto;background-color:var(--color-bright-800);border-radius:8px;filter:drop-shadow(0 1px 8px var(--color-contrast-shadow))}",""]),n.locals={host:"pkb-dropdown__host--o4R3A1Eg"};const a=n},48732:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-edited-time__host--MFHRHQEP{color:var(--color-black-700);white-space:nowrap;font-size:13px;line-height:20px;font-weight:400}.pkb-edited-time__hint--ue9cPMmD{padding:6px 8px}",""]),n.locals={host:"pkb-edited-time__host--MFHRHQEP",hint:"pkb-edited-time__hint--ue9cPMmD"};const a=n},36873:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-editor-controls__host--OdoGKLLt{background-color:var(--color-bright-800);border-bottom:1px solid var(--color-black-430);padding:11px 15px;display:flex;align-items:center;border-top-left-radius:8px;border-top-right-radius:8px}",""]),n.locals={host:"pkb-editor-controls__host--OdoGKLLt"};const a=n},36975:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-editor-tags__host--o8JtRULi{padding-bottom:16px}.pkb-editor-tags__recommended--uGEKBEX9{font-size:13px;line-height:20px;font-weight:400;color:var(--color-black-800);padding:6px 23px 2px 23px;display:flex;flex-wrap:wrap;margin:-8px 0 0 -12px}.pkb-editor-tags__recommended--uGEKBEX9>*{margin:8px 0 0 12px}.pkb-editor-tags__tag--xtVUSoeP{color:var(--color-primary-900);cursor:pointer;border-bottom:1px dashed currentColor;user-select:none}",""]),n.locals={host:"pkb-editor-tags__host--o8JtRULi",recommended:"pkb-editor-tags__recommended--uGEKBEX9",tag:"pkb-editor-tags__tag--xtVUSoeP"};const a=n},26890:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-extra-btn__host--dJAMfJQ6{background:var(--color-primary-800);border-radius:0 2px 2px 0}.pkb-extra-btn__host_gray--acRxOZWZ{background:var(--color-black-500)}",""]),n.locals={host:"pkb-extra-btn__host--dJAMfJQ6",host_gray:"pkb-extra-btn__host_gray--acRxOZWZ"};const a=n},20468:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-fullscreen-popup__host--sjl3Buii{background-color:#000;position:fixed;top:0;left:0;width:100%;height:100%;z-index:6000}.pkb-fullscreen-popup__content--xghjf0PP{position:relative;width:100%;height:100%;overflow:auto;pointer-events:auto;overscroll-behavior:contain;z-index:6001}.pkb-fullscreen-popup__closeButton--lRB8HPen{position:absolute;top:18px;right:18px}",""]),n.locals={host:"pkb-fullscreen-popup__host--sjl3Buii",content:"pkb-fullscreen-popup__content--xghjf0PP",closeButton:"pkb-fullscreen-popup__closeButton--lRB8HPen"};const a=n},58371:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-fundraising-progressbar__values--TWjzOXul{display:flex;justify-content:space-between;color:var(--color-primary-900);margin-top:12px;font-size:20px;line-height:20px;font-weight:500}.pkb-fundraising-progressbar__footer--Pj1tFSdu{display:flex;justify-content:space-between;color:var(--color-black-700);margin-top:4px;font-size:11px;line-height:16px;font-weight:400}.pkb-fundraising-progressbar__footer--Pj1tFSdu strong{font-size:11px;line-height:16px;font-weight:700}.pkb-fundraising-progressbar__footer_completed--NOcEw1lJ{display:block;margin-top:8px;color:var(--color-black-800);font-size:14px;line-height:24px;font-weight:400}.pkb-fundraising-progressbar__footer_completed--NOcEw1lJ strong{font-size:14px;line-height:24px;font-weight:500}",""]),n.locals={values:"pkb-fundraising-progressbar__values--TWjzOXul",footer:"pkb-fundraising-progressbar__footer--Pj1tFSdu",footer_completed:"pkb-fundraising-progressbar__footer_completed--NOcEw1lJ"};const a=n},10968:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-header-popup__host--cg1BlJQH{align-items:center;background:var(--color-bright-800);box-shadow:var(--shadow-mobi);display:flex;height:56px;padding:0 max(16px,env(safe-area-inset-right)) 0 max(16px,env(safe-area-inset-left))}.pkb-header-popup__host_dark--SLPEpuzE{background:var(--color-black-900)}.pkb-header-popup__host_dark--SLPEpuzE .pkb-header-popup__title--lT4ZJu76{color:var(--color-bright-900)}.pkb-header-popup__button--_GQj619q{margin-right:8px}.pkb-header-popup__content--azOpEO2J{flex:1 1 auto;overflow:hidden}.pkb-header-popup__title--lT4ZJu76{font-size:18px;line-height:20px;font-weight:500;color:var(--color-black-800);overflow:hidden;white-space:nowrap;text-overflow:ellipsis}",""]),n.locals={host:"pkb-header-popup__host--cg1BlJQH",host_dark:"pkb-header-popup__host_dark--SLPEpuzE",title:"pkb-header-popup__title--lT4ZJu76",button:"pkb-header-popup__button--_GQj619q",content:"pkb-header-popup__content--azOpEO2J"};const a=n},45760:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-hint__icon--w2K7jyEl{color:var(--color-black-700);fill:var(--color-black-700);width:24px;height:24px}@media(hover: hover){.pkb-hint__icon--w2K7jyEl{cursor:pointer}}.pkb-hint__icon_disabled--gbQ30n6r{cursor:default}.pkb-hint__tooltip--At0St4iF{font-size:13px;line-height:20px;font-weight:400;padding:12px;max-width:328px}",""]),n.locals={icon:"pkb-hint__icon--w2K7jyEl",icon_disabled:"pkb-hint__icon_disabled--gbQ30n6r",tooltip:"pkb-hint__tooltip--At0St4iF"};const a=n},77832:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-icon-btn__host--Oo2tOkhv{all:unset;cursor:pointer;display:inline-flex;justify-content:center;align-items:center;flex-shrink:0;background-color:rgba(0,0,0,0);border-radius:8px;user-select:none;color:var(--color-black-600);width:32px;height:32px;transition:background-color 200ms ease-out,color 200ms ease-out}.pkb-icon-btn__host_large--cwl_J2kW{width:40px;height:40px}.pkb-icon-btn__host_small--vMEfhzCl{width:24px;height:24px}@media(hover: hover){.pkb-icon-btn__host--Oo2tOkhv:hover{background:var(--color-primary-500);color:var(--color-bright-900);filter:none}}.pkb-icon-btn__host--Oo2tOkhv:focus-visible{background:var(--color-primary-500);color:var(--color-bright-900);box-shadow:var(--shadow-focus)}.pkb-icon-btn__host--Oo2tOkhv:active{background:var(--color-primary-900);color:var(--color-bright-900);filter:none}.pkb-icon-btn__host--Oo2tOkhv:disabled{cursor:default;pointer-events:none;opacity:.5}.pkb-icon-btn__host_gray--LxCsmTCd{background:var(--color-black-300)}.pkb-icon-btn__host_light--a0TTlVRG{background:var(--color-bright-800);color:var(--color-black-700)}.pkb-icon-btn__host_circle--rsat9JG_{border-radius:50%}",""]),n.locals={host:"pkb-icon-btn__host--Oo2tOkhv",host_large:"pkb-icon-btn__host_large--cwl_J2kW",host_small:"pkb-icon-btn__host_small--vMEfhzCl",host_gray:"pkb-icon-btn__host_gray--LxCsmTCd",host_light:"pkb-icon-btn__host_light--a0TTlVRG",host_circle:"pkb-icon-btn__host_circle--rsat9JG_"};const a=n},86569:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-icon__host--RM9zRTSM{display:block;pointer-events:revert}",""]),n.locals={host:"pkb-icon__host--RM9zRTSM"};const a=n},23070:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-images-carousel__image--TAk0yDw0{display:block;max-width:100%;height:100%;object-fit:contain}",""]),n.locals={image:"pkb-images-carousel__image--TAk0yDw0"};const a=n},21409:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-input-comunity__searchItem--sZz3GieY{padding:5px 24px}",""]),n.locals={searchItem:"pkb-input-comunity__searchItem--sZz3GieY"};const a=n},19288:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-input-tag-add-btn__host--zcOsL45m{background-color:var(--color-black-440);color:var(--color-black-800);display:flex;align-items:center;padding:8px 12px;border-radius:40px;font-size:13px;cursor:pointer}.pkb-input-tag-add-btn__host_disabled--QpaAoy1d{cursor:default}.pkb-input-tag-add-btn__icon--J0rerpM3{margin-right:8px;color:var(--color-black-700)}",""]),n.locals={host:"pkb-input-tag-add-btn__host--zcOsL45m",host_disabled:"pkb-input-tag-add-btn__host_disabled--QpaAoy1d",icon:"pkb-input-tag-add-btn__icon--J0rerpM3"};const a=n},20226:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-input-tag-list__tag--tFth5Vph{font-size:13px;background-color:var(--color-bright-800);color:var(--color-black-800);display:flex;align-items:center;padding:5px 7px 5px 11px;border:1px solid var(--color-black-430);border-radius:40px;overflow:hidden}.pkb-input-tag-list__tag_readonly--Eb4ZJs25{padding:5px 7px}.pkb-input-tag-list__tag__label--lRo0gVyj{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block}.pkb-input-tag-list__removeButton--GX4Hirgp{margin-left:8px;color:var(--color-black-600);cursor:pointer;flex-shrink:0}",""]),n.locals={tag:"pkb-input-tag-list__tag--tFth5Vph",tag_readonly:"pkb-input-tag-list__tag_readonly--Eb4ZJs25",tag__label:"pkb-input-tag-list__tag__label--lRo0gVyj",removeButton:"pkb-input-tag-list__removeButton--GX4Hirgp"};const a=n},60809:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-input-tag__host--FncACLhg{padding:5px 23px}.pkb-input-tag__host_large--uJllvR0Q{padding:7px 23px}.pkb-input-tag__host_small--U8sFKJqm{padding:5px 15px}.pkb-input-tag__wrapper--ghs3cfqt{display:flex;flex-wrap:wrap;cursor:text;margin:-8px 0 0 -8px}.pkb-input-tag__wrapper--ghs3cfqt>*{margin:8px 0 0 8px}.pkb-input-tag__input--U63z_jON{font-size:inherit;line-height:inherit;font-weight:inherit;color:var(--color-black-940);outline:none;border:0;background-color:rgba(0,0,0,0);overflow:hidden;padding:6px 0}.pkb-input-tag__shrinkedAddBtn--YZig8ion{padding:6px 12px}",""]),n.locals={host:"pkb-input-tag__host--FncACLhg",host_large:"pkb-input-tag__host_large--uJllvR0Q",host_small:"pkb-input-tag__host_small--U8sFKJqm",wrapper:"pkb-input-tag__wrapper--ghs3cfqt",input:"pkb-input-tag__input--U63z_jON",shrinkedAddBtn:"pkb-input-tag__shrinkedAddBtn--YZig8ion"};const a=n},10779:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-input-time__wrapper--Uev_Qx_t{display:flex;cursor:text}.pkb-input-time__input--g8JnIH95{font-size:inherit;line-height:inherit;font-weight:inherit;display:block;width:100%;color:var(--color-black-940);outline:none;border:0;background-color:rgba(0,0,0,0);resize:none;overflow:hidden}.pkb-input-time__input_hour--DKgcHh2I{width:15px}.pkb-input-time__input_minute--CTblf9S6{flex:1 1 0;width:100%}",""]),n.locals={wrapper:"pkb-input-time__wrapper--Uev_Qx_t",input:"pkb-input-time__input--g8JnIH95",input_hour:"pkb-input-time__input_hour--DKgcHh2I",input_minute:"pkb-input-time__input_minute--CTblf9S6"};const a=n},63914:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-input__input--pYBLhRPA{font-size:inherit;line-height:inherit;font-weight:inherit;display:block;width:100%;color:var(--color-black-940);outline:none;border:0;background-color:rgba(0,0,0,0);resize:none;overflow:hidden}.pkb-input__input--pYBLhRPA::placeholder{color:var(--color-black-700);font-size:inherit;line-height:inherit;font-weight:inherit}.pkb-input__input--pYBLhRPA::-webkit-datetime-edit-year-field{color:var(--color-black-940)}.pkb-input__icon--BkDCK18W{margin-right:8px;color:var(--color-black-600)}",""]),n.locals={input:"pkb-input__input--pYBLhRPA",icon:"pkb-input__icon--BkDCK18W"};const a=n},63840:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.pkb-item__host--gny8eg8N{font-size:14px;line-height:24px;font-weight:500;align-items:center;background-color:rgba(0,0,0,0);color:var(--color-black-800);display:flex;user-select:none;padding:8px 16px;position:relative;transition:background-color 200ms ease-out;cursor:pointer}@media(hover: hover){.pkb-item__host--gny8eg8N:hover{background-color:var(--color-primary-100)}}.pkb-item__host--gny8eg8N:focus-visible{background-color:var(--color-primary-100);box-shadow:var(--shadow-focus)}.pkb-item__host--gny8eg8N:active{background-color:var(--color-primary-200)}.pkb-item__host_disabled--D86TK20e{opacity:.5;pointer-events:none}.pkb-item__content--kxP7aYxb{align-items:center;display:flex;flex-shrink:0;height:24px;justify-content:center;margin-right:8px;width:24px;color:var(--color-black-600)}.pkb-item__label--IjzefXTB{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.pkb-item__host_active--Aik_11YM{color:var(--color-primary-900)}.pkb-item__host_active--Aik_11YM::before{content:"";display:block;position:absolute;left:0;top:0;bottom:0;width:2px;background-color:var(--color-primary-900)}',""]),n.locals={host:"pkb-item__host--gny8eg8N",host_disabled:"pkb-item__host_disabled--D86TK20e",content:"pkb-item__content--kxP7aYxb",label:"pkb-item__label--IjzefXTB",host_active:"pkb-item__host_active--Aik_11YM"};const a=n},25217:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-loader__host--osKfvl0_{display:block;animation-duration:1s;animation-iteration-count:infinite;animation-timing-function:linear;animation-name:pkb-loader__spin--mVYAn44v;color:var(--color-primary-800)}.pkb-loader__host_spinner--ZvsMlAVx{animation-duration:.4s}.pkb-loader__host_gray--uZyp1DXs{color:var(--color-black-700)}.pkb-loader__host_yellow--njWJ52lz{color:var(--color-warning-800)}.pkb-loader__host_red--kVB44Xdp{color:var(--color-danger-800)}.pkb-loader__host_white--VvmbgNjo{color:var(--color-bright-900)}@keyframes pkb-loader__spin--mVYAn44v{from{transform:rotateZ(0)}to{transform:rotateZ(360deg)}}",""]),n.locals={host:"pkb-loader__host--osKfvl0_",spin:"pkb-loader__spin--mVYAn44v",host_spinner:"pkb-loader__host_spinner--ZvsMlAVx",host_gray:"pkb-loader__host_gray--uZyp1DXs",host_yellow:"pkb-loader__host_yellow--njWJ52lz",host_red:"pkb-loader__host_red--kVB44Xdp",host_white:"pkb-loader__host_white--VvmbgNjo"};const a=n},80547:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-menu__trigger--RYSRl404{width:fit-content}.pkb-menu__tooltip--uzrlSwns{padding:8px 0}",""]),n.locals={trigger:"pkb-menu__trigger--RYSRl404",tooltip:"pkb-menu__tooltip--uzrlSwns"};const a=n},2945:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-modal-card-base__host--SMzVcJxp{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;transition:opacity 200ms ease-out;padding:16px;align-items:center}.pkb-modal-card-base__host_hidden--pGyquI6i{opacity:0}.pkb-modal-card-base__body--T7983VIT{transition:transform 200ms ease-out}.pkb-modal-card-base__host_hidden--pGyquI6i .pkb-modal-card-base__body--T7983VIT{transform:translateY(16px)}",""]),n.locals={host:"pkb-modal-card-base__host--SMzVcJxp",host_hidden:"pkb-modal-card-base__host_hidden--pGyquI6i",body:"pkb-modal-card-base__body--T7983VIT"};const a=n},96704:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-modal-card-body__host--ILln0CoJ{display:flex;flex-direction:column;position:relative;max-width:100%;max-height:calc(100vh - 40px);background-color:var(--color-bright-800);margin:0 auto;border-radius:8px;width:560px;padding:24px 24px 16px}.pkb-modal-card-body__host_gray--xadvfxJa{background-color:var(--color-black-300)}.pkb-modal-card-body__header--wLQp2oI2{display:flex;align-items:flex-start}.pkb-modal-card-body__header_withButton--dYENU8EE{padding-right:32px}.pkb-modal-card-body__close--eVrfKMp6{position:absolute;top:24px;right:24px}.pkb-modal-card-body__footer--AXEC_Zjw{margin-top:16px}",""]),n.locals={host:"pkb-modal-card-body__host--ILln0CoJ",host_gray:"pkb-modal-card-body__host_gray--xadvfxJa",header:"pkb-modal-card-body__header--wLQp2oI2",header_withButton:"pkb-modal-card-body__header_withButton--dYENU8EE",close:"pkb-modal-card-body__close--eVrfKMp6",footer:"pkb-modal-card-body__footer--AXEC_Zjw"};const a=n},93570:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-modal-card-content__host--WMu7Fiji{overflow:hidden auto;overscroll-behavior:contain;color:var(--color-black-800);margin-right:-12px;padding-right:calc(12px - var(--modal-card-scrollbar-width));font-size:14px;line-height:24px;font-weight:400;scrollbar-color:var(--color-black-500) rgba(0,0,0,0);scrollbar-width:thin}.pkb-modal-card-content__host--WMu7Fiji::-webkit-scrollbar{width:4px}.pkb-modal-card-content__host--WMu7Fiji::-webkit-scrollbar-thumb{background-color:var(--color-black-500);border-radius:8px}.pkb-modal-card-content__host--WMu7Fiji::-webkit-scrollbar-thumb:hover{box-shadow:inset 0 0 0 2px rgba(0,0,0,.08)}.pkb-modal-card-content__host--WMu7Fiji::-webkit-scrollbar-thumb:active{box-shadow:inset 0 0 0 2px rgba(0,0,0,.16)}.pkb-modal-card-content__host--WMu7Fiji::-webkit-scrollbar-track{background-color:rgba(0,0,0,0);border-radius:2px}",""]),n.locals={host:"pkb-modal-card-content__host--WMu7Fiji"};const a=n},82112:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-modal-card-cross-btn__close--qR0IJkOg{position:absolute;top:24px;right:24px}.pkb-modal-card-cross-btn__close_large--s9Ksbr7w{top:32px;right:32px}",""]),n.locals={close:"pkb-modal-card-cross-btn__close--qR0IJkOg",close_large:"pkb-modal-card-cross-btn__close_large--s9Ksbr7w"};const a=n},88438:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-modal-card-header__header--xl7dbxa1{display:flex;align-items:center;padding-bottom:8px}.pkb-modal-card-header__header_large--vKjNXd6R{padding-bottom:16px}",""]),n.locals={header:"pkb-modal-card-header__header--xl7dbxa1",header_large:"pkb-modal-card-header__header_large--vKjNXd6R"};const a=n},12291:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-modal-card-title__host--PfEyUMaP{color:var(--color-black-940);margin-right:auto}.pkb-modal-card-title__host_medium--lxuDqmqS{font-size:16px;line-height:24px;font-weight:700}.pkb-modal-card-title__host_large--AEA7OvhO{font-size:24px;font-weight:500;line-height:32px}",""]),n.locals={host:"pkb-modal-card-title__host--PfEyUMaP",host_medium:"pkb-modal-card-title__host_medium--lxuDqmqS",host_large:"pkb-modal-card-title__host_large--AEA7OvhO"};const a=n},46798:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.pkb-modal-page-body__host--DGXnXasa{display:flex;flex-direction:column;position:relative;max-width:100%;max-height:100%;background-color:var(--color-bright-800);border-radius:16px 16px 0 0;padding:36px 16px 32px 16px}.pkb-modal-page-body__host--DGXnXasa::after{content:"";position:absolute;top:12px;left:50%;transform:translateX(-50%);width:80px;height:6px;background:var(--color-black-400);border-radius:3px}.pkb-modal-page-body__header--CkecSPPW{text-align:center;color:var(--color-black-940);font-size:24px;font-weight:500;padding-bottom:16px;line-height:32px}.pkb-modal-page-body__content--vhNvzwzi{overflow:auto;overscroll-behavior:contain;color:var(--color-black-800);font-size:14px;line-height:24px;font-weight:400;scrollbar-color:var(--color-black-500) rgba(0,0,0,0);scrollbar-width:thin}.pkb-modal-page-body__content--vhNvzwzi::-webkit-scrollbar{width:4px}.pkb-modal-page-body__content--vhNvzwzi::-webkit-scrollbar-thumb{background-color:var(--color-black-500);border-radius:8px}.pkb-modal-page-body__content--vhNvzwzi::-webkit-scrollbar-thumb:hover{box-shadow:inset 0 0 0 2px rgba(0,0,0,.08)}.pkb-modal-page-body__content--vhNvzwzi::-webkit-scrollbar-thumb:active{box-shadow:inset 0 0 0 2px rgba(0,0,0,.16)}.pkb-modal-page-body__content--vhNvzwzi::-webkit-scrollbar-track{background-color:rgba(0,0,0,0);border-radius:2px}.pkb-modal-page-body__footer--gCUpxFax{margin-top:16px}',""]),n.locals={host:"pkb-modal-page-body__host--DGXnXasa",header:"pkb-modal-page-body__header--CkecSPPW",content:"pkb-modal-page-body__content--vhNvzwzi",footer:"pkb-modal-page-body__footer--gCUpxFax"};const a=n},7815:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-modal-page__host--mp9p1r95{position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;transition:opacity 250ms ease-in-out;padding-top:16px;align-items:flex-end}.pkb-modal-page__host_hidden--LRm8qrKJ{opacity:0}.pkb-modal-page__body--n7lrswUX{transition:transform 250ms ease-in-out;touch-action:none;width:100%}.pkb-modal-page__host_hidden--LRm8qrKJ .pkb-modal-page__body--n7lrswUX{transform:translateY(100%)}",""]),n.locals={host:"pkb-modal-page__host--mp9p1r95",host_hidden:"pkb-modal-page__host_hidden--LRm8qrKJ",body:"pkb-modal-page__body--n7lrswUX"};const a=n},78317:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-more-btn__host--tuB9YBDU{display:flex}.pkb-more-btn__mainBtn--AVyj6uMC{border-radius:8px 0 0 8px}.pkb-more-btn__extraBtn--gADdM_Q2{border-radius:0 8px 8px 0}",""]),n.locals={host:"pkb-more-btn__host--tuB9YBDU",mainBtn:"pkb-more-btn__mainBtn--AVyj6uMC",extraBtn:"pkb-more-btn__extraBtn--gADdM_Q2"};const a=n},56836:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-overlay__host--e2PV6mG4{position:absolute;left:0;top:0;width:100%;height:100%;background:var(--color-black-alpha-70)}",""]),n.locals={host:"pkb-overlay__host--e2PV6mG4"};const a=n},99500:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-pop-up-btn__host--cdJGoXIo{all:unset;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;width:36px;height:36px;background-color:var(--color-black-alpha-70);color:var(--color-bright-900);transition:background-color 200ms ease-out,color 200ms ease-out}@media(hover: hover){.pkb-pop-up-btn__host--cdJGoXIo:hover{cursor:pointer}}.pkb-pop-up-btn__host--cdJGoXIo:focus-visible{outline:2px solid var(--color-primary-900)}.pkb-pop-up-btn__host--cdJGoXIo:active,.pkb-pop-up-btn__host--cdJGoXIo.pkb-pop-up-btn__active--T1bbaG2o{filter:unset;background-color:linear-gradient(0deg, rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)),var(--color-black-alpha-70)}.pkb-pop-up-btn__host--cdJGoXIo:disabled{cursor:default;pointer-events:none;opacity:.5}",""]),n.locals={host:"pkb-pop-up-btn__host--cdJGoXIo",active:"pkb-pop-up-btn__active--T1bbaG2o"};const a=n},76043:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-progress-overlay__host--jWZdCfW5{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center}.pkb-progress-overlay__host_fullscreen--PN6hL0iN{position:fixed;touch-action:none;z-index:6000}",""]),n.locals={host:"pkb-progress-overlay__host--jWZdCfW5",host_fullscreen:"pkb-progress-overlay__host_fullscreen--PN6hL0iN"};const a=n},32979:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-progressbar__host--dxUQm7rD{width:100%;position:relative;overflow:hidden;border-radius:8px;background-color:var(--color-primary-400)}.pkb-progressbar__host_small--fqb1OVrs{height:20px;border:1px solid var(--color-primary-700)}.pkb-progressbar__host_small--fqb1OVrs::after{font-size:14px;line-height:20px;font-weight:500}.pkb-progressbar__host_small--fqb1OVrs>div{background-color:var(--color-primary-700)}.pkb-progressbar__host_large--WefsEbBh{height:40px}.pkb-progressbar__host_large--WefsEbBh::after{background:var(--color-black-alpha-40);padding:2px 8px;border-radius:8px;font-size:16px;line-height:20px;font-weight:500}.pkb-progressbar__host_large--WefsEbBh>div{background:repeating-linear-gradient(-75deg, var(--color-primary-700), var(--color-primary-700) 8px, var(--color-primary-800) 8px, var(--color-primary-800) 16px) fixed,var(--color-primary-700);border-radius:0 8px 8px 0}.pkb-progressbar__host_completed--NrF32iP3.pkb-progressbar__host_large--WefsEbBh>div{background:repeating-linear-gradient(-75deg, var(--color-black-300), var(--color-black-300) 8px, var(--color-black-400) 8px, var(--color-black-400) 16px) fixed,var(--color-black-300)}.pkb-progressbar__host--dxUQm7rD::after{content:attr(data-label);display:inline-block;color:var(--color-bright-900);position:absolute;left:50%;top:50%;transform:translate(-50%, -50%)}.pkb-progressbar__host--dxUQm7rD>div{height:100%;transition:width 600ms ease-out,background-color 200ms ease-out}",""]),n.locals={host:"pkb-progressbar__host--dxUQm7rD",host_small:"pkb-progressbar__host_small--fqb1OVrs",host_large:"pkb-progressbar__host_large--WefsEbBh",host_completed:"pkb-progressbar__host_completed--NrF32iP3"};const a=n},92093:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.pkb-radio__host--vj8GIhec{display:inline-flex;align-items:flex-start;user-select:none;cursor:pointer}.pkb-radio__host_disabled--v0dZNC0h{opacity:.5;cursor:not-allowed}.pkb-radio__icon--eylDazQV{display:flex;align-items:center;justify-content:center;flex-shrink:0;height:24px;width:24px}.pkb-radio__icon--eylDazQV::before{content:"";box-sizing:border-box;flex-shrink:0;height:20px;width:20px;background-color:var(--color-bright-800);border:1px solid var(--color-black-600);border-radius:50%;transition:border 200ms ease-out}.pkb-radio__input--Vx792S5O{display:none}.pkb-radio__input--Vx792S5O:checked+.pkb-radio__icon--eylDazQV::before{border:5px solid var(--color-primary-700)}.pkb-radio__label--tGEyv7K2{margin-left:12px;color:var(--color-black-940);font-size:14px;line-height:24px;font-weight:400}',""]),n.locals={host:"pkb-radio__host--vj8GIhec",host_disabled:"pkb-radio__host_disabled--v0dZNC0h",icon:"pkb-radio__icon--eylDazQV",input:"pkb-radio__input--Vx792S5O",label:"pkb-radio__label--tGEyv7K2"};const a=n},33873:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-search-item__host--ATWjPTKq{font-size:13px;line-height:20px;font-weight:400;align-items:center;background-color:rgba(0,0,0,0);display:flex;user-select:none;padding:10px 16px;transition:background-color 200ms ease-out}.pkb-search-item__host--ATWjPTKq:hover{cursor:pointer;background-color:var(--color-black-300)}.pkb-search-item__host--ATWjPTKq:focus-visible{outline:0;box-shadow:var(--shadow-focus)}.pkb-search-item__prefix--yaTPXKC6{display:inline-flex;margin-right:8px}.pkb-search-item__suffix--Zfnj9ydE{display:inline-flex;margin-left:8px}.pkb-search-item__label--XJ5M0B00{color:var(--color-black-800);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-right:auto}.pkb-search-item__selection--KmcRqA8z{background-color:var(--color-warning-200)}",""]),n.locals={host:"pkb-search-item__host--ATWjPTKq",prefix:"pkb-search-item__prefix--yaTPXKC6",suffix:"pkb-search-item__suffix--Zfnj9ydE",label:"pkb-search-item__label--XJ5M0B00",selection:"pkb-search-item__selection--KmcRqA8z"};const a=n},72136:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-select-option__host--VLybADAR{font-size:14px;line-height:24px;font-weight:400;align-items:center;background-color:rgba(0,0,0,0);display:flex;user-select:none;padding:8px 15px;transition:background-color 200ms ease-out;cursor:pointer}@media(hover: hover){.pkb-select-option__host--VLybADAR:hover{background-color:var(--color-black-200)}}.pkb-select-option__host--VLybADAR:active{background-color:var(--color-black-300)}.pkb-select-option__host_disabled--3O61N_TN{opacity:.5;pointer-events:none}.pkb-select-option__label--wSIN1Soj{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-right:auto}.pkb-select-option__icon--t9Q24G0F{margin-left:8px;color:var(--color-primary-700)}",""]),n.locals={host:"pkb-select-option__host--VLybADAR",host_disabled:"pkb-select-option__host_disabled--3O61N_TN",label:"pkb-select-option__label--wSIN1Soj",icon:"pkb-select-option__icon--t9Q24G0F"};const a=n},42205:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-select__host--yUa2zJZW{cursor:default;user-select:none}.pkb-select__text--HDN5qZHy{user-select:none}.pkb-select__listBox--quUayFse{position:absolute;z-index:7000;overflow:auto;padding:4px 0;max-height:208px;background-color:var(--color-bright-800);border-radius:8px;filter:drop-shadow(var(--shadow-default));scrollbar-color:var(--color-black-500) rgba(0,0,0,0);scrollbar-width:thin}.pkb-select__listBox--quUayFse::-webkit-scrollbar{width:4px}.pkb-select__listBox--quUayFse::-webkit-scrollbar-thumb{background-color:var(--color-black-500);border-radius:8px}.pkb-select__listBox--quUayFse::-webkit-scrollbar-thumb:hover{box-shadow:inset 0 0 0 2px rgba(0,0,0,.08)}.pkb-select__listBox--quUayFse::-webkit-scrollbar-thumb:active{box-shadow:inset 0 0 0 2px rgba(0,0,0,.16)}.pkb-select__listBox--quUayFse::-webkit-scrollbar-track{background-color:rgba(0,0,0,0);border-radius:2px}.pkb-select__icon--dmqrfsC3{color:var(--color-black-600);transition:transform 200ms ease-out}.pkb-select__icon_active--JOvGvhPW{transform:rotateZ(0.5turn)}",""]),n.locals={host:"pkb-select__host--yUa2zJZW",text:"pkb-select__text--HDN5qZHy",listBox:"pkb-select__listBox--quUayFse",icon:"pkb-select__icon--dmqrfsC3",icon_active:"pkb-select__icon_active--JOvGvhPW"};const a=n},42005:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-series-avatar__default--UnnobAFu{display:inline-block}",""]),n.locals={default:"pkb-series-avatar__default--UnnobAFu"};const a=n},11624:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-skeleton-ribs__rib--PHVb9JYu{border-radius:30px}.pkb-skeleton-ribs__rib--PHVb9JYu+.pkb-skeleton-ribs__rib--PHVb9JYu{margin-top:12px}",""]),n.locals={rib:"pkb-skeleton-ribs__rib--PHVb9JYu"};const a=n},44691:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-skeleton__host--sG8Boqp1{height:8px}",""]),n.locals={host:"pkb-skeleton__host--sG8Boqp1"};const a=n},73231:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-story-draft-preview__host--hlkmq4PP{position:relative;transition:background-color 200ms ease-out;padding:8px 23px}.pkb-story-draft-preview__host_loading--fK8iyzbc{pointer-events:none}.pkb-story-draft-preview__host_loading--fK8iyzbc>:not(.pkb-story-draft-preview__loader--QFQeLAsN){opacity:.2}.pkb-story-draft-preview__host--hlkmq4PP:hover{cursor:pointer;background-color:var(--color-primary-100)}.pkb-story-draft-preview__host--hlkmq4PP:focus-visible{outline:0;box-shadow:var(--shadow-focus)}.pkb-story-draft-preview__loader--QFQeLAsN{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}.pkb-story-draft-preview__header--L1tOqHPy{display:flex;align-items:center}.pkb-story-draft-preview__title--eed8onxp{color:var(--color-black-940);margin-right:8px;word-break:break-word;font-size:16px;line-height:20px;font-weight:500}.pkb-story-draft-preview__time--mht__pQv{color:var(--color-black-700);white-space:nowrap;flex-grow:1;font-size:13px;line-height:20px;font-weight:400}.pkb-story-draft-preview__text--AzNYcrve{color:var(--color-black-800);margin-top:4px;word-break:break-word;font-size:14px;line-height:24px;font-weight:400}.pkb-story-draft-preview__media--WLDrPyUS{color:var(--color-black-800);display:flex;align-items:center;margin-top:4px;font-size:13px;line-height:20px;font-weight:400}.pkb-story-draft-preview__mediaItem--mSH4HrrX{background-color:var(--color-black-300);border-radius:4px;padding:8px;margin-right:4px;color:var(--color-black-700)}.pkb-story-draft-preview__mediaItem--mSH4HrrX:last-child{margin-right:8px}.pkb-story-draft-preview__deleteIcon--c0vG8VgB{flex-shrink:0;margin-left:8px}",""]),n.locals={host:"pkb-story-draft-preview__host--hlkmq4PP",host_loading:"pkb-story-draft-preview__host_loading--fK8iyzbc",loader:"pkb-story-draft-preview__loader--QFQeLAsN",header:"pkb-story-draft-preview__header--L1tOqHPy",title:"pkb-story-draft-preview__title--eed8onxp",time:"pkb-story-draft-preview__time--mht__pQv",text:"pkb-story-draft-preview__text--AzNYcrve",media:"pkb-story-draft-preview__media--WLDrPyUS",mediaItem:"pkb-story-draft-preview__mediaItem--mSH4HrrX",deleteIcon:"pkb-story-draft-preview__deleteIcon--c0vG8VgB"};const a=n},59179:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-subscribe-btn-menu__loadIgnore--kbgOH4_A{padding:24px 80px}",""]),n.locals={loadIgnore:"pkb-subscribe-btn-menu__loadIgnore--kbgOH4_A"};const a=n},62984:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-subscribe-btn__wrapper--xj6sl79P{width:fit-content}.pkb-subscribe-btn__wrapper_wide--JFoHCvHE{width:100%}.pkb-subscribe-btn__wrapper--xj6sl79P svg{fill:currentColor}",""]),n.locals={wrapper:"pkb-subscribe-btn__wrapper--xj6sl79P",wrapper_wide:"pkb-subscribe-btn__wrapper_wide--JFoHCvHE"};const a=n},49942:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.pkb-switch__host--XiLf7vtC{display:flex;align-items:center;user-select:none;color:var(--color-black-940);gap:12px}.pkb-switch__host_disabled--wanuB2Gz{opacity:.5;pointer-events:none}.pkb-switch__host_revert--YqtT3WuK{flex-direction:row-reverse}.pkb-switch__host_large--xvZRsNXy .pkb-switch__switch--RljMVBUE{width:40px;height:24px}.pkb-switch__host_large--xvZRsNXy .pkb-switch__switch--RljMVBUE::before{width:40px;height:24px}.pkb-switch__host_large--xvZRsNXy .pkb-switch__switch--RljMVBUE::after{width:20px;height:20px}.pkb-switch__host_large--xvZRsNXy .pkb-switch__checkbox--_B9xIPdN:checked+.pkb-switch__switch--RljMVBUE::after{left:18px}.pkb-switch__host_largelabel--TA_yPTk4 .pkb-switch__label--BecgLsd4{font-size:16px}@media(hover: hover){.pkb-switch__host--XiLf7vtC{cursor:pointer}.pkb-switch__host_disabled--wanuB2Gz{cursor:default}}.pkb-switch__checkbox--_B9xIPdN{display:none}.pkb-switch__switch--RljMVBUE{flex-shrink:0;height:20px;width:32px;position:relative}.pkb-switch__switch--RljMVBUE::before{position:absolute;display:block;content:"";width:32px;left:0;height:20px;top:0;border-radius:20px;background-color:var(--color-black-500)}.pkb-switch__switch--RljMVBUE::after{position:absolute;display:block;content:"";border-radius:50%;top:2px;left:2px;width:16px;height:16px;background-color:var(--color-bright-900);transition:background-color 200ms ease-out,left 200ms ease-out}.pkb-switch__checkbox--_B9xIPdN:checked+.pkb-switch__switch--RljMVBUE::before{background-color:var(--color-primary-700)}.pkb-switch__checkbox--_B9xIPdN:checked+.pkb-switch__switch--RljMVBUE::after{background-color:var(--color-bright-900);left:14px}.pkb-switch__label--BecgLsd4{font-size:14px;line-height:24px;font-weight:400}',""]),n.locals={host:"pkb-switch__host--XiLf7vtC",host_disabled:"pkb-switch__host_disabled--wanuB2Gz",host_revert:"pkb-switch__host_revert--YqtT3WuK",host_large:"pkb-switch__host_large--xvZRsNXy",switch:"pkb-switch__switch--RljMVBUE",checkbox:"pkb-switch__checkbox--_B9xIPdN",host_largelabel:"pkb-switch__host_largelabel--TA_yPTk4",label:"pkb-switch__label--BecgLsd4"};const a=n},39250:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-tab-panels__host--abILf__h{position:relative;transition:height 200ms ease-out}.pkb-tab-panels__transition_active--Mejn6wSj{transition:200ms ease-out;position:absolute;width:100%}.pkb-tab-panels__transition_hidden--u9OPKJh9{opacity:0;transform:translateY(16px)}.pkb-tab-panels__transition_active--Mejn6wSj,.pkb-tab-panels__transition_hidden--u9OPKJh9{pointer-events:none}",""]),n.locals={host:"pkb-tab-panels__host--abILf__h",transition_active:"pkb-tab-panels__transition_active--Mejn6wSj",transition_hidden:"pkb-tab-panels__transition_hidden--u9OPKJh9"};const a=n},9731:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-tooltip-base__host--D2npIY4K{--card-bg: var(--color-bright-800);position:absolute;left:0;top:0}.pkb-tooltip-base__host_green--Vu9G_l25{--card-bg: var(--color-primary-100);color:var(--color-bright-900)}.pkb-tooltip-base__host_green--Vu9G_l25 .pkb-tooltip-base__card--qwVmDoX_{outline:1px solid var(--color-primary-700);outline-offset:-1px}.pkb-tooltip-base__host_green--Vu9G_l25 .pkb-tooltip-base__arrow--SbTvNK7n{color:var(--color-primary-700)}.pkb-tooltip-base__host_red--mjc6Yu4M{--card-bg: var(--color-danger-800);color:var(--color-bright-900)}.pkb-tooltip-base__host_dark--lJhrbeC4{--card-bg: var(--color-black-900);color:var(--color-bright-900)}.pkb-tooltip-base__card--qwVmDoX_{position:absolute;background-color:var(--card-bg);border-radius:8px;top:0;left:0;width:max-content;overflow:hidden;box-shadow:var(--shadow-medium)}.pkb-tooltip-base__host_top--CiTHQ29o .pkb-tooltip-base__card--qwVmDoX_,.pkb-tooltip-base__host_bottom--yZE6fa_I .pkb-tooltip-base__card--qwVmDoX_{min-width:var(--min-card-size)}.pkb-tooltip-base__host_left--eQZPv8nF .pkb-tooltip-base__card--qwVmDoX_,.pkb-tooltip-base__host_right--rF5sicKX .pkb-tooltip-base__card--qwVmDoX_{min-height:var(--min-card-size)}.pkb-tooltip-base__arrow--SbTvNK7n{position:absolute;width:18px;height:7px;z-index:1000;display:flex;pointer-events:none;fill:var(--card-bg);color:var(--card-bg)}.pkb-tooltip-base__arrow_top--XHSysJtZ{transform:translate(-50%, -100%)}.pkb-tooltip-base__arrow_bottom--E6NB_waP{transform:rotate(180deg) translateX(50%)}.pkb-tooltip-base__arrow_right--gpsImgsw{transform:rotate(90deg) translate(-50%, -100%);transform-origin:top left}.pkb-tooltip-base__arrow_left--Gi5CDFKU{transform:rotate(270deg) translate(-50%, -100%);transform-origin:top left}",""]),n.locals={host:"pkb-tooltip-base__host--D2npIY4K",host_green:"pkb-tooltip-base__host_green--Vu9G_l25",card:"pkb-tooltip-base__card--qwVmDoX_",arrow:"pkb-tooltip-base__arrow--SbTvNK7n",host_red:"pkb-tooltip-base__host_red--mjc6Yu4M",host_dark:"pkb-tooltip-base__host_dark--lJhrbeC4",host_top:"pkb-tooltip-base__host_top--CiTHQ29o",host_bottom:"pkb-tooltip-base__host_bottom--yZE6fa_I",host_left:"pkb-tooltip-base__host_left--eQZPv8nF",host_right:"pkb-tooltip-base__host_right--rF5sicKX",arrow_top:"pkb-tooltip-base__arrow_top--XHSysJtZ",arrow_bottom:"pkb-tooltip-base__arrow_bottom--E6NB_waP",arrow_right:"pkb-tooltip-base__arrow_right--gpsImgsw",arrow_left:"pkb-tooltip-base__arrow_left--Gi5CDFKU"};const a=n},42292:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-tooltip-rich__container--SFZaTVaF{padding:12px;max-width:345px}.pkb-tooltip-rich__title--T6tX7Dng{color:var(--color-black-940);margin-bottom:4px;font-size:14px;line-height:20px;font-weight:500}.pkb-tooltip-rich__title_dark--DaIDWkmr,.pkb-tooltip-rich__title_red--SG0VDfbF{color:var(--color-bright-900)}.pkb-tooltip-rich__content--ef6fm_zp{color:var(--color-black-800);font-size:13px;line-height:20px;font-weight:400}.pkb-tooltip-rich__content_dark--ixKCOBGJ,.pkb-tooltip-rich__content_red--p70Rm_t8{color:var(--color-bright-900)}.pkb-tooltip-rich__buttons--KWk9cRR_{margin-top:8px;display:flex}.pkb-tooltip-rich__button_main--hjI2pf9n:only-child{width:100%}.pkb-tooltip-rich__button_main--hjI2pf9n:not(:only-child){margin-right:8px}",""]),n.locals={container:"pkb-tooltip-rich__container--SFZaTVaF",title:"pkb-tooltip-rich__title--T6tX7Dng",title_dark:"pkb-tooltip-rich__title_dark--DaIDWkmr",title_red:"pkb-tooltip-rich__title_red--SG0VDfbF",content:"pkb-tooltip-rich__content--ef6fm_zp",content_dark:"pkb-tooltip-rich__content_dark--ixKCOBGJ",content_red:"pkb-tooltip-rich__content_red--p70Rm_t8",buttons:"pkb-tooltip-rich__buttons--KWk9cRR_",button_main:"pkb-tooltip-rich__button_main--hjI2pf9n"};const a=n},68652:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-tooltip__animate--G3aAAOrH-enter-active,.pkb-tooltip__animate--G3aAAOrH-leave-active{transition:opacity 250ms ease,transform 250ms cubic-bezier(0.71, 1.7, 0.77, 1.24)}.pkb-tooltip__animate--G3aAAOrH-enter-from,.pkb-tooltip__animate--G3aAAOrH-leave-to{--offset-y: 20px;opacity:0}",""]),n.locals={animate:"pkb-tooltip__animate--G3aAAOrH"};const a=n},586:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-user-avatar__host--Fb_0KxBO{display:block;object-fit:cover;border-radius:50%;overflow:hidden}.pkb-user-avatar__group--Ga1ZUNY3{color:var(--color-black-440)}",""]),n.locals={host:"pkb-user-avatar__host--Fb_0KxBO",group:"pkb-user-avatar__group--Ga1ZUNY3"};const a=n},42821:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,'.pkb-video-editor-timeline__host--RS8JJNsi{cursor:pointer;position:relative;height:16px}.pkb-video-editor-timeline__bar--Kw9xJBN7{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;touch-action:none}.pkb-video-editor-timeline__bar--Kw9xJBN7::before{content:"";display:block;width:100%;height:4px;background:var(--color-bright-alpha-70)}.pkb-video-editor-timeline__progress--uQOTnDiI{position:absolute;top:calc(50% - 2px);left:0;width:var(--progress);height:4px;background:var(--color-primary-700);pointer-events:none}.pkb-video-editor-timeline__thumb--I3V4X6ZW{position:absolute;top:calc(50% - 6px);left:calc(var(--progress) - 6px);width:12px;height:12px;border-radius:50%;border:4px solid var(--color-primary-700);background:var(--color-bright-800);opacity:0;transition:opacity 200ms ease-out;pointer-events:none}.pkb-video-editor-timeline__host--RS8JJNsi:hover .pkb-video-editor-timeline__thumb--I3V4X6ZW{opacity:1}.pkb-video-editor-timeline__crop--jmsnhxEX{cursor:pointer;position:absolute;width:12px;height:20px;top:calc(50% - 10px);background:var(--color-black-440);border-radius:2px;display:flex;align-items:center;justify-content:center;color:var(--color-black-700);touch-action:none}.pkb-video-editor-timeline__crop_start--GCcjasJo{transform:translateX(-12px);left:var(--progress)}.pkb-video-editor-timeline__crop_end--ze5nALrO{left:var(--progress)}.pkb-video-editor-timeline__hint--kLGWMAzz{z-index:6001;pointer-events:none}.pkb-video-editor-timeline__hintContent--pfTV3io9{font-size:13px;line-height:20px;font-weight:400;padding:6px 8px}',""]),n.locals={host:"pkb-video-editor-timeline__host--RS8JJNsi",bar:"pkb-video-editor-timeline__bar--Kw9xJBN7",progress:"pkb-video-editor-timeline__progress--uQOTnDiI",thumb:"pkb-video-editor-timeline__thumb--I3V4X6ZW",crop:"pkb-video-editor-timeline__crop--jmsnhxEX",crop_start:"pkb-video-editor-timeline__crop_start--GCcjasJo",crop_end:"pkb-video-editor-timeline__crop_end--ze5nALrO",hint:"pkb-video-editor-timeline__hint--kLGWMAzz",hintContent:"pkb-video-editor-timeline__hintContent--pfTV3io9"};const a=n},68137:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".pkb-video-editor__host--mPlsgc1C{display:flex;background-color:var(--color-black-900);bottom:0;left:0;overflow:hidden auto;overscroll-behavior:contain;position:fixed;user-select:none;right:0;top:0;z-index:6001;align-items:center;justify-content:center}.pkb-video-editor__overlay--TXgEtfCZ{position:absolute;bottom:0;left:0;right:0;top:0;z-index:-1}.pkb-video-editor__container--POCScSAc{width:800px;max-width:100%}.pkb-video-editor__player--GXCDzjS8{position:relative}.pkb-video-editor__video--AyL5pwPF{display:block;background-color:var(--color-bright-alpha-10);width:100%;object-fit:contain;cursor:pointer;max-height:min(100vh - 108px,600px)}:root[data-theme-dark] .pkb-video-editor__video--AyL5pwPF{background-color:var(--color-bright-alpha-65)}.pkb-video-editor__play--QyxEn7Qz{position:absolute;color:var(--color-bright-900);display:flex;justify-content:center;align-items:center;width:56px;height:56px;border-radius:50%;background-color:var(--color-black-alpha-10);top:calc(50% - 28px);left:calc(50% - 28px);pointer-events:none;transition:background-color 200ms ease-out}.pkb-video-editor__player--GXCDzjS8:hover .pkb-video-editor__play--QyxEn7Qz{background-color:var(--color-black-alpha-70)}.pkb-video-editor__controls--sY7cr5Gu{position:absolute;bottom:0;left:0;right:0;display:flex;align-items:center;padding:0 32px 0 16px;background:linear-gradient(transparent, rgba(33, 33, 33, 0.32));height:52px;padding:0 64px 0 16px}.pkb-video-editor__controls__play--q72ZtMJV{all:unset;cursor:pointer;display:flex;justify-content:center;align-items:center;flex-shrink:0;user-select:none;color:var(--color-bright-800);width:32px;height:32px;margin-right:32px}.pkb-video-editor__controls__timeline--g_2xIdF8{flex:1 1 0}.pkb-video-editor__controls__cut--O8SolTy0{margin-left:32px}.pkb-video-editor__panel--_lFhvPyD{background:var(--color-black-alpha-12);display:flex;align-items:center;border-radius:2px;padding:8px 24px;margin-top:20px}:root[data-theme-dark] .pkb-video-editor__panel--_lFhvPyD{background-color:var(--color-bright-alpha-65)}.pkb-video-editor__mute--QgGmx7UG{margin-right:16px;color:var(--color-bright-900)}.pkb-video-editor__buttons--VTyNIDwD{display:flex;margin-left:auto}.pkb-video-editor__buttons--VTyNIDwD>*:not(:last-child){margin-right:20px}",""]),n.locals={host:"pkb-video-editor__host--mPlsgc1C",overlay:"pkb-video-editor__overlay--TXgEtfCZ",container:"pkb-video-editor__container--POCScSAc",player:"pkb-video-editor__player--GXCDzjS8",video:"pkb-video-editor__video--AyL5pwPF",play:"pkb-video-editor__play--QyxEn7Qz",controls:"pkb-video-editor__controls--sY7cr5Gu",controls__play:"pkb-video-editor__controls__play--q72ZtMJV",controls__timeline:"pkb-video-editor__controls__timeline--g_2xIdF8",controls__cut:"pkb-video-editor__controls__cut--O8SolTy0",panel:"pkb-video-editor__panel--_lFhvPyD",mute:"pkb-video-editor__mute--QgGmx7UG",buttons:"pkb-video-editor__buttons--VTyNIDwD"};const a=n},81516:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".community-info-tooltip__host--dUHCIuqw{width:328px;z-index:7000;background-color:var(--color-bright-800);border-radius:8px;filter:drop-shadow(0 1px 8px var(--color-contrast-shadow))}.community-info-tooltip__loader--m6Pwjp1J{display:flex;align-items:center;justify-content:center;padding:16px 0}.community-info-tooltip__body--MFc1Wky5{display:flex;padding:16px 16px 12px}.community-info-tooltip__img--z5u0OsOe{border-radius:4px;min-width:88px;width:88px;height:88px;object-fit:cover}.community-info-tooltip__subscribe--EWoZdqbw{padding:8px 16px 16px}.community-info-tooltip__footer--yyOHU9q2{border-top:1px solid var(--color-black-300);padding:11px 16px 12px;text-align:center;font-size:12px;line-height:16px;font-weight:400}.community-info-tooltip__footer--yyOHU9q2 strong{color:var(--color-black-800)}.community-info-tooltip__footer--yyOHU9q2 span{color:var(--color-black-700)}.community-info-tooltip__footer--yyOHU9q2 span+span{margin-left:8px}.community-info-tooltip__arrow--ALJNevex{position:absolute;width:13px;height:13px;background-color:var(--color-bright-800);z-index:-1;pointer-events:none;transform:rotate(45deg)}",""]),n.locals={host:"community-info-tooltip__host--dUHCIuqw",loader:"community-info-tooltip__loader--m6Pwjp1J",body:"community-info-tooltip__body--MFc1Wky5",img:"community-info-tooltip__img--z5u0OsOe",subscribe:"community-info-tooltip__subscribe--EWoZdqbw",footer:"community-info-tooltip__footer--yyOHU9q2",arrow:"community-info-tooltip__arrow--ALJNevex"};const a=n},77527:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".info-view__host--qx8fhMKD{display:flex;flex-direction:column;justify-content:center;overflow:hidden;padding-left:8px}.info-view__name--D2ofvp9g{display:flex;align-items:center;color:var(--color-black-940);font-size:20px;line-height:28px;font-weight:400}.info-view__name--D2ofvp9g a{color:inherit;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block}.info-view__lockIcon--aHGovR91{display:inline-flex;color:var(--color-black-600);margin-left:8px;flex-shrink:0}.info-view__description--EuFOx4h6{color:var(--color-black-800);padding-top:8px;display:-webkit-box;line-clamp:3;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;font-size:12px;line-height:16px;font-weight:400}.info-view__description--EuFOx4h6 blockquote{all:unset}.info-view__description--EuFOx4h6 blockquote::after{display:none}.info-view__description--EuFOx4h6 blockquote+p{margin-top:0}",""]),n.locals={host:"info-view__host--qx8fhMKD",name:"info-view__name--D2ofvp9g",lockIcon:"info-view__lockIcon--aHGovR91",description:"info-view__description--EuFOx4h6"};const a=n},53830:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".feedback-offer__host--W6ud3CUv{color:var(--color-black-800);background-color:var(--color-warning-200);transition:max-height 200ms ease-out;max-height:100vh;font-size:12px;padding:15px 24px 16px}.feedback-offer__host--W6ud3CUv-enter-from,.feedback-offer__host--W6ud3CUv-leave-to{max-height:0}.feedback-offer__inform--nwFCx3A_{display:flex}.feedback-offer__inform--nwFCx3A_ span{flex:1}.feedback-offer__list--B46ddJ3k{margin-left:0}.feedback-offer__links--mBvghrjS{list-style:none;display:flex;align-items:center;flex-wrap:wrap;margin-top:12px}.feedback-offer__link--QNNJQveZ{display:inline-flex;align-items:center}.feedback-offer__link--QNNJQveZ+.feedback-offer__link--QNNJQveZ{margin-left:12px}.feedback-offer__link__icon--VsUD6IQI{margin-right:8px}.feedback-offer__icon--uNH8zqtv{color:var(--color-black-600)}@media(hover: hover){.feedback-offer__icon--uNH8zqtv{cursor:pointer}}",""]),n.locals={host:"feedback-offer__host--W6ud3CUv",inform:"feedback-offer__inform--nwFCx3A_",list:"feedback-offer__list--B46ddJ3k",links:"feedback-offer__links--mBvghrjS",link:"feedback-offer__link--QNNJQveZ",link__icon:"feedback-offer__link__icon--VsUD6IQI",icon:"feedback-offer__icon--uNH8zqtv"};const a=n},99848:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".link-tooltip__content--Cz45FlZK{padding:8px 12px;display:flex;align-items:center;margin:-8px 0 0 -8px}.link-tooltip__content--Cz45FlZK>*{margin:8px 0 0 8px}",""]),n.locals={content:"link-tooltip__content--Cz45FlZK"};const a=n},41280:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".rich-editor__host--_vLaL0Sv{width:100%;cursor:text}.rich-editor__host_disabled--rfJtVWv1{opacity:.5;pointer-events:none}.rich-editor__host--_vLaL0Sv .ProseMirror{font-size:14px;line-height:20px;font-weight:400;outline:0;width:100%;color:var(--color-black-940)}.rich-editor__host--_vLaL0Sv .ProseMirror-selectednode{outline:0}.rich-editor__host--_vLaL0Sv .ProseMirror>[data-placeholder]::before{content:attr(data-placeholder);font-size:14px;line-height:20px;font-weight:400;color:var(--color-black-700);pointer-events:none}.rich-editor__host--_vLaL0Sv .ProseMirror>[data-placeholder]>p{position:absolute;top:0;left:0;bottom:0;right:0}",""]),n.locals={host:"rich-editor__host--_vLaL0Sv",host_disabled:"rich-editor__host_disabled--rfJtVWv1"};const a=n},19933:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".user-mentions__host--ein3_rhx{background-color:var(--color-bright-800);border-radius:8px;filter:drop-shadow(0 1px 8px var(--color-contrast-shadow));will-change:filter;position:absolute;overflow-y:auto;max-height:400px;transition:opacity 250ms ease,visibility 250ms ease,transform 250ms cubic-bezier(0.71, 1.7, 0.77, 1.24)}.user-mentions__host--ein3_rhx-enter-from,.user-mentions__host--ein3_rhx-leave-to{transform:translate(0, 20px);opacity:0;visibility:hidden}.user-mentions__role--KwFyB_wY{margin-left:5px;color:var(--color-black-700);font-size:12px;line-height:16px;font-weight:400}.user-mentions__icon--Sp6F9Mpp{margin-left:2px;color:var(--color-primary-700)}",""]),n.locals={host:"user-mentions__host--ein3_rhx",role:"user-mentions__role--KwFyB_wY",icon:"user-mentions__icon--Sp6F9Mpp"};const a=n},44113:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".formatting-tools-view__tooltipCard--aXYnoc9Q{border-radius:3px}.formatting-tools-view__btn--dsF0Fufz{all:unset;width:32px;height:32px;border-radius:0;padding:8px;border:0;background-color:rgba(0,0,0,0);color:var(--color-black-700);margin:0;box-sizing:border-box;transition:background-color 200ms;cursor:pointer}.formatting-tools-view__btn_active--lZbmyVYq{background-color:var(--color-black-100)}.formatting-tools-view__btn--dsF0Fufz:active{background-color:var(--color-black-300)}.formatting-tools-view__btn--dsF0Fufz:focus-visible{outline:2px solid var(--color-primary-900)}.formatting-tools-view__btn--dsF0Fufz:hover{filter:unset;background-color:var(--color-black-300)}",""]),n.locals={tooltipCard:"formatting-tools-view__tooltipCard--aXYnoc9Q",btn:"formatting-tools-view__btn--dsF0Fufz",btn_active:"formatting-tools-view__btn_active--lZbmyVYq"};const a=n},28066:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var i=s(8081),o=s.n(i),r=s(23645),n=s.n(r)()(o());n.push([e.id,".node-blockquote-view__host--JfXcXD4C{margin:8px 0}",""]),n.locals={host:"node-blockquote-view__host--JfXcXD4C"};const a=n},11830:(e,t,s)=>{var i={"./ru":21793};function o(e){var t=r(e);return s(t)}function r(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}o.keys=function(){return Object.keys(i)},o.resolve=r,e.exports=o,o.id=11830},20723:(e,t,s)=>{"use strict";s.d(t,{Z:()=>Z});var i=s(66252),o=s(3577),r=s(49963),n=s(82222),a=s(7233),l=s(2262),c=s(55946);const d=["href"],u=(0,i.aZ)({__name:"by-content-cards",props:{card:{}},setup(e){const t=e;return(e,s)=>((0,i.wg)(),(0,i.iD)("a",{ref:"container",class:(0,o.C_)([e.$style.container,e.$style["container_"+t.card.code]]),href:t.card.url,target:"_blank"},[(0,i._)("span",{class:(0,o.C_)(e.$style.caption)},(0,o.zw)(t.card.title),3)],10,d))}});var p=s(1546),h=s.n(p),_=s(83744);const m={};m.$style=h();const g=(0,_.Z)(u,[["__cssModules",m]]),v=["href"],f=(0,i.aZ)({__name:"by-filters-cards",props:{card:{}},setup(e){const t=e;return(e,s)=>((0,i.wg)(),(0,i.iD)("a",{ref:"container",class:(0,o.C_)([e.$style.container,e.$style["container_"+t.card.code]]),href:t.card.url,target:"_blank"},[(0,i._)("span",{class:(0,o.C_)(e.$style.caption)},(0,o.zw)(t.card.title),3)],10,v))}});var y=s(89922),b=s.n(y);const w={};w.$style=b();const k=(0,_.Z)(f,[["__cssModules",w]]),S=["href"],O=(0,i.aZ)({__name:"by-format-cards",props:{card:{}},setup(e){const t=e;return(e,s)=>((0,i.wg)(),(0,i.iD)("a",{ref:"container",class:(0,o.C_)([e.$style.container,e.$style["container_"+t.card.code]]),href:t.card.url,target:"_blank"},null,10,S))}});var E=s(9792),C=s.n(E);const x={};x.$style=C();const T=(0,_.Z)(O,[["__cssModules",x]]);var I=s(20252);const P=["href"],A=(0,i.aZ)({__name:"authors-cards",props:{card:{}},setup(e){const t=e,s=(0,a.o)(),r=(0,i.Fl)((()=>{var e,i,o;switch(t.card.code){case"top_authors":return(null===(e=s.browsingParams)||void 0===e?void 0:e[n.U_.UNIQUE])||[];case"my":return(null===(i=s.browsingParams)||void 0===i?void 0:i[n.U_.MY])||[];case"answers":return(null===(o=s.browsingParams)||void 0===o?void 0:o[n.U_.REPLIES])||[]}return[]}));return(e,s)=>((0,i.wg)(),(0,i.iD)("a",{ref:"container",href:t.card.url,target:"_blank"},[(0,i._)("div",{class:(0,o.C_)(e.$style.avatars)},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(r.value,((e,t)=>((0,i.wg)(),(0,i.j4)(I.Z,{key:t,size:20,url:e},null,8,["url"])))),128))],2),(0,i._)("span",{class:(0,o.C_)(e.$style.caption)},(0,o.zw)(t.card.title),3)],8,P))}});var D=s(63446),M=s.n(D);const R={};R.$style=M();const N=(0,_.Z)(A,[["__cssModules",R]]);var B=s(70017),L=s(86445),j=s(89275),$=s(56281);const U=(0,i.aZ)({__name:"cards-view",props:{block:{}},setup(e){var t;const s=e,{sendEvent:d}=(0,c.z)(),u=(0,a.o)(),p=(0,j.o)(),h=(0,l.iH)(null===(t=u.browsingCards)||void 0===t?void 0:t[s.block]),_=(0,l.iH)(),m=(0,l.iH)(!1),v={[n.eQ.CARDS_BY_CONTENT]:g,[n.eQ.CARDS_AUTHORS]:N,[n.eQ.CARDS_BY_FILTERS]:k,[n.eQ.CARDS_BY_FORMAT]:T};function f(e,t,s){d("compilation_tapped",{type:e,screen_index:t+1}),"nsfw"!==e||p.initParams.isAdultVisible||B.e.get(L.QU)||(s.preventDefault(),m.value=!0)}function y(e){if(s.block===n.eQ.CARDS_BY_CONTENT||s.block===n.eQ.CARDS_BY_FORMAT)return"block_green";if(s.block===n.eQ.CARDS_AUTHORS)switch(e){case"top_authors":return"block_purple";case"my":return"block_sea";case"answers":return"block_orange"}return s.block===n.eQ.CARDS_BY_FILTERS?"block_white":""}return(e,t)=>{var n;return(0,i.wg)(),(0,i.iD)(i.HY,null,[void 0!==v[s.block]?((0,i.wg)(),(0,i.iD)("div",{key:0,ref_key:"container",ref:_,class:(0,o.C_)(e.$style.container)},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(h.value,((t,n)=>((0,i.wg)(),(0,i.iD)("div",{key:t.title,class:(0,o.C_)([e.$style.block,e.$style["block_of_"+h.value.length],e.$style[y(t.code)]])},[((0,i.wg)(),(0,i.j4)((0,i.LL)(v[s.block]),{card:t,class:(0,o.C_)(e.$style.card),onClick:(0,r.iM)((e=>f(t.code,n,e)),["left"]),onMouseup:(0,r.iM)((e=>f(t.code,n,e)),["middle"])},null,40,["card","class","onClick","onMouseup"]))],2)))),128))],2)):(0,i.kq)("v-if",!0),m.value?((0,i.wg)(),(0,i.j4)($.Z,{key:1,modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=e=>m.value=e),"proceed-url":null===(n=h.value.find((e=>"nsfw"===e.code)))||void 0===n?void 0:n.url},null,8,["modelValue","proceed-url"])):(0,i.kq)("v-if",!0)],64)}}});var F=s(85158),V=s.n(F);const H={};H.$style=V();const Z=(0,_.Z)(U,[["__cssModules",H]])},56281:(e,t,s)=>{"use strict";s.d(t,{Z:()=>v});var i=s(66252),o=s(49963),r=s(3577),n=s(91181),a=s(37043),l=s(70017),c=s(2262),d=s(86445);const u=(0,i._)("p",null," Контент, помеченный метками 18+, может быть небезопасен для просмотра. Нажмите «Продолжить», если не передумали. ",-1),p=(0,i.aZ)({__name:"nsfw-warning",props:{modelValue:{type:Boolean},proceedUrl:{},cancelUrl:{}},emits:["update:modelValue"],setup(e,{emit:t}){const s=(0,c.iH)(!0),p=t,h=e;function _(){p("update:modelValue",!1),l.e.set(d.QU,"1",{expires:1})}function m(){p("update:modelValue",!1),h.cancelUrl&&(window.location.href=h.cancelUrl)}return(e,t)=>((0,i.wg)(),(0,i.j4)(n.Z,{modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=e=>s.value=e),title:"Вам уже есть 18?","cross-button":"",onClose:m},{footer:(0,i.w5)((()=>[(0,i._)("div",null,[(0,i.Wm)(a.Z,{href:h.proceedUrl,wide:e.IS_MOBILE,label:"Продолжить",onClick:(0,o.iM)(_,["left"]),onMouseup:(0,o.iM)(_,["middle"])},null,8,["href","wide","onClick","onMouseup"]),e.IS_DESKTOP?((0,i.wg)(),(0,i.j4)(a.Z,{key:0,href:h.cancelUrl,theme:"gray",label:"Отмена",class:(0,r.C_)(e.$style.closeAdultModalBtn),onClick:m},null,8,["href","class"])):(0,i.kq)("v-if",!0)])])),default:(0,i.w5)((()=>[u])),_:1},8,["modelValue"]))}});var h=s(86022),_=s.n(h),m=s(83744);const g={};g.$style=_();const v=(0,m.Z)(p,[["__cssModules",g]])},76841:(e,t,s)=>{"use strict";s.d(t,{Z:()=>w});s(88674),s(41817);var i=s(66252),o=s(2262),r=s(3577),n=s(40094),a=s(96101),l=s(49963),c=s(59870),d=s(544),u=s(66309),p=s(60387);function h(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function _(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const m=["inert"],g=(0,i.aZ)({__name:"node-wrapper-view",props:function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?h(Object(s),!0).forEach((function(t){_(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):h(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({contentClass:{type:[String,Array,Object],default:void 0},canFocused:{type:Boolean}},d.Un),setup(e){const{isBlocksReorderingMode:t,theme:s}=(0,i.f3)(c.yC,{isBlocksReorderingMode:(0,o.iH)(!1),theme:(0,o.iH)(0)}),h=e,_=(0,l.fb)(),g=(0,o.iH)(),v=(0,i.Fl)((()=>h.node.type.name)),f=(0,i.Fl)((()=>c.ju.has(v.value))),y=(0,i.Fl)((()=>!c.w_.has(v.value)&&!f.value&&!h.node.content.size)),b=(0,i.Fl)((()=>h.node.type.spec.draggable&&!t.value&&!y.value&&!s.value)),w=!h.editor.view.docView.node.resolve(h.getPos()).depth,k=(0,i.Fl)((()=>{var e;return h.editor.can().pkbMoveNode(null===(e=h.node.attrs)||void 0===e?void 0:e.id,-1)})),S=(0,i.Fl)((()=>{var e;return h.editor.can().pkbMoveNode(null===(e=h.node.attrs)||void 0===e?void 0:e.id,1)})),O=(0,i.Fl)((()=>k.value||S.value));function E(e,t){return Boolean((null==e?void 0:e.classList.contains(_.host))&&(null==t?void 0:t.classList.contains(_.host)))}async function C(){var e;const t=(0,u.NXq)(g);E(t.previousElementSibling,t)&&await(0,p.V)(t.previousElementSibling,t),h.editor.commands.pkbMoveNode(null===(e=h.node.attrs)||void 0===e?void 0:e.id,-1)}async function x(){var e;const t=(0,u.NXq)(g);E(t,t.nextElementSibling)&&await(0,p.V)(t,t.nextElementSibling),h.editor.commands.pkbMoveNode(null===(e=h.node.attrs)||void 0===e?void 0:e.id,1)}return(e,s)=>w?((0,i.wg)(),(0,i.j4)((0,o.SU)(d.T5),{key:0,ref_key:"hostEl",ref:g,"data-focus":h.canFocused,class:(0,r.C_)({[(0,o.SU)(_).host]:!0,[(0,o.SU)(_).host_reordering]:(0,o.SU)(t)&&O.value,[(0,o.SU)(_).host_complex]:f.value})},{default:(0,i.w5)((()=>[(0,o.SU)(t)&&O.value?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,r.C_)((0,o.SU)(_).moveMenu),contenteditable:"false"},[(0,i.Wm)(a.Z,{class:(0,r.C_)((0,o.SU)(_).moveButton),icon:"up_18",size:"lg",disabled:!k.value,onClick:C},null,8,["class","disabled"]),(0,i.Wm)(a.Z,{class:(0,r.C_)((0,o.SU)(_).moveButton),icon:"down_18",size:"lg",disabled:!S.value,onClick:x},null,8,["class","disabled"])],2)):(0,i.kq)("v-if",!0),(0,i._)("div",null,[e.IS_DESKTOP&&b.value?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,r.C_)((0,o.SU)(_).dragHandleWrapper),contenteditable:"false"},[(0,i._)("div",{class:(0,r.C_)((0,o.SU)(_).button),draggable:"true","data-drag-handle":""},[(0,i.Wm)(n.Z,{name:"sorting-burger_16"})],2)],2)):(0,i.kq)("v-if",!0)]),(0,i._)("div",{class:(0,r.C_)([(0,o.SU)(_).content,(0,r.C_)(h.contentClass)]),inert:(0,o.SU)(t)||void 0},[(0,i.WI)(e.$slots,"default")],10,m)])),_:3},8,["data-focus","class"])):((0,i.wg)(),(0,i.j4)((0,o.SU)(d.T5),{key:1},{default:(0,i.w5)((()=>[(0,i.WI)(e.$slots,"default")])),_:3}))}});var v=s(32423),f=s.n(v),y=s(83744);const b={};b.$style=f();const w=(0,y.Z)(g,[["__cssModules",b]])},72658:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var i=s(66252),o=s(3577),r=s(91181),n=s(37043);const a=(0,i.aZ)({__name:"pkb-action-sheet",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const s=e,a=t,l=(0,i.Fl)({get:()=>s.modelValue,set:e=>a("update:modelValue",e)});return(e,t)=>((0,i.wg)(),(0,i.j4)(r.Z,{modelValue:l.value,"onUpdate:modelValue":t[1]||(t[1]=e=>l.value=e),class:(0,o.C_)(e.$style.modal)},{default:(0,i.w5)((()=>[(0,i.WI)(e.$slots,"default"),(0,i._)("div",{class:(0,o.C_)(e.$style.closeBtn)},[(0,i.Wm)(n.Z,{label:"Закрыть",theme:"gray",wide:"",onClick:t[0]||(t[0]=e=>l.value=!1)})],2)])),_:3},8,["modelValue","class"]))}});var l=s(84272),c=s.n(l),d=s(83744);const u={};u.$style=c();const p=(0,d.Z)(a,[["__cssModules",u]])},85651:(e,t,s)=>{"use strict";s.d(t,{Z:()=>u});var i=s(66252),o=s(3577),r=s(40094);const n=(0,i.aZ)({__name:"pkb-alert",props:{theme:{default:"green"},title:{default:void 0},button:{default:void 0},icon:{default:void 0},withCloseButton:{type:Boolean}},emits:["close","buttonClick"],setup(e,{emit:t}){const s=e,n=t;return(e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:(0,o.C_)({[e.$style.host]:!0,[e.$style[`host_${s.theme}`]]:"green"!==s.theme,[e.$style["host_with-icon"]]:s.icon})},[s.icon?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,o.C_)(e.$style.icon)},[(0,i.Wm)(r.Z,{size:20,name:s.icon},null,8,["name"])],2)):(0,i.kq)("v-if",!0),(0,i._)("div",{class:(0,o.C_)(e.$style.content)},[s.withCloseButton?((0,i.wg)(),(0,i.j4)(r.Z,{key:0,name:"close_16",class:(0,o.C_)(e.$style["close-button"]),onClick:t[0]||(t[0]=e=>n("close"))},null,8,["class"])):(0,i.kq)("v-if",!0),s.title||e.$slots.title?((0,i.wg)(),(0,i.iD)("div",{key:1,class:(0,o.C_)(e.$style.title)},[e.$slots.title?(0,i.WI)(e.$slots,"title",{key:0}):((0,i.wg)(),(0,i.iD)(i.HY,{key:1},[(0,i.Uk)((0,o.zw)(s.title),1)],64))],2)):(0,i.kq)("v-if",!0),(0,i.WI)(e.$slots,"default"),e.button?((0,i.wg)(),(0,i.iD)("div",{key:2,class:(0,o.C_)(e.$style.buttons)},[(0,i._)("button",{class:(0,o.C_)(e.$style.buttons__button),onClick:t[1]||(t[1]=t=>e.$emit("buttonClick"))},(0,o.zw)(e.button),3)],2)):(0,i.kq)("v-if",!0)],2)],2))}});var a=s(36146),l=s.n(a),c=s(83744);const d={};d.$style=l();const u=(0,c.Z)(n,[["__cssModules",d]])},546:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var i=s(66252),o=s(3577),r=s(49963),n=s(40094);const a=(0,i.aZ)({__name:"pkb-animated-back-icon-btn",props:{active:{type:Boolean}},emits:["click"],setup(e,{emit:t}){const s=e,a=t;return(e,t)=>((0,i.wg)(),(0,i.iD)("span",{class:(0,o.C_)([e.$style.host,{[e.$style.host_active]:s.active}])},[(0,i.Wm)(r.uT,{name:e.$style.icon},{default:(0,i.w5)((()=>[s.active?((0,i.wg)(),(0,i.j4)(n.Z,{key:0,class:(0,o.C_)(e.$style.icon),name:"back_20",size:20,onClick:t[0]||(t[0]=e=>a("click"))},null,8,["class"])):(0,i.kq)("v-if",!0)])),_:1},8,["name"])],2))}});var l=s(11096),c=s.n(l),d=s(83744);const u={};u.$style=c();const p=(0,d.Z)(a,[["__cssModules",u]])},32995:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var i=s(66252),o=s(49963);const r=(0,i.aZ)({__name:"pkb-animated-slide",props:{active:{type:Boolean}},setup(e){const t=e,s=e=>{if(!(e instanceof HTMLElement))return;e.style.height="auto";const t=e.offsetHeight;e.style.height="0",setTimeout((()=>e.style.height=t+"px"))},r=e=>{e instanceof HTMLElement&&(e.style.height="0")},n=e=>{e instanceof HTMLElement&&(e.style.height="auto")},a=e=>{if(!(e instanceof HTMLElement))return;const t=e.offsetHeight;e.style.height=t+"px",setTimeout((()=>e.style.height="0"))};return(e,l)=>((0,i.wg)(),(0,i.j4)(o.uT,{name:e.$style.host,onBeforeEnter:r,onEnter:s,onAfterEnter:n,onLeave:a},{default:(0,i.w5)((()=>[t.active?((0,i.wg)(),(0,i.iD)("div",(0,i.dG)({key:0,class:e.$style.host},e.$attrs),[(0,i.WI)(e.$slots,"default")],16)):(0,i.kq)("v-if",!0)])),_:3},8,["name"]))}});var n=s(18024),a=s.n(n),l=s(83744);const c={};c.$style=a();const d=(0,l.Z)(r,[["__cssModules",c]])},50451:(e,t,s)=>{"use strict";s.d(t,{Z:()=>v});var i=s(66252),o=s(3577),r=s(2262),n=s(49963),a=s(40094),l=s(89661),c=s(48090),d=s(12665),u=s(66309);const p=(0,i.aZ)({__name:"pkb-base-input",props:{size:{default:"medium"},theme:{default:"normal"},label:{default:void 0},error:{type:[String,Boolean],default:!1},errorDirection:{default:"top"},showErrorImmediately:{type:Boolean},disabled:{type:Boolean},loading:{type:Boolean},clearable:{type:Boolean},empty:{type:Boolean},borderless:{type:Boolean},restSymbols:{default:void 0},maxRestSymbols:{default:void 0}},emits:["clear","show:error","hide:error"],setup(e,{emit:t}){const s=e,p=t,h=(0,n.fb)(),_=(0,i.Fl)((()=>s.error&&"string"==typeof s.error)),m=(0,r.iH)(),{focused:g}=(0,u.L_M)(m),v=(0,r.iH)(g.value),f=(0,i.YP)(g,(e=>{e&&(v.value=!0,f())})),y=(0,i.Fl)((()=>_.value&&!g.value)),b=(0,i.Fl)((()=>!(!s.maxRestSymbols||void 0===s.restSymbols)&&s.restSymbols<=s.maxRestSymbols)),w=(0,i.Fl)((()=>m.value.offsetHeight));(0,i.YP)(y,(e=>p(e?"show:error":"hide:error")));const{x:k,y:S,width:O}=(0,d.XL)((0,i.Fl)((()=>y.value?m.value:void 0)),{absolute:!0}),E=(0,i.Fl)((()=>k.value+O.value/2)),C=(0,i.Fl)((()=>({[h.host]:!0,[h[`host_${s.size}`]]:"medium"!==s.size,[h[`host_${s.theme}`]]:"normal"!==s.theme,[h.host_disabled]:s.disabled,[h.host_borderless]:s.borderless,[h.host_error]:s.error&&!g.value&&(s.showErrorImmediately||v.value)})));return(e,t)=>((0,i.wg)(),(0,i.iD)("div",{ref_key:"hostEl",ref:m,class:(0,o.C_)(C.value)},[e.$slots.prefix?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,o.C_)((0,r.SU)(h).prefix)},[(0,i.WI)(e.$slots,"prefix")],2)):(0,i.kq)("v-if",!0),(0,i._)("label",{class:(0,o.C_)((0,r.SU)(h).inputWrapper)},[s.label?(0,i.wy)(((0,i.wg)(),(0,i.iD)("span",{key:0,class:(0,o.C_)((0,r.SU)(h).label)},(0,o.zw)(s.label),3)),[[n.F8,s.empty]]):(0,i.kq)("v-if",!0),(0,i.WI)(e.$slots,"default")],2),s.loading||s.clearable?((0,i.wg)(),(0,i.iD)("div",{key:1,class:(0,o.C_)((0,r.SU)(h).bar)},[s.loading?((0,i.wg)(),(0,i.j4)(l.Z,{key:0,class:(0,o.C_)((0,r.SU)(h).loader)},null,8,["class"])):(0,i.kq)("v-if",!0),s.clearable&&!s.empty?((0,i.wg)(),(0,i.j4)(a.Z,{key:1,class:(0,o.C_)((0,r.SU)(h).clearButton),name:"close_16",onClick:t[0]||(t[0]=e=>p("clear"))},null,8,["class"])):(0,i.kq)("v-if",!0)],2)):(0,i.kq)("v-if",!0),e.$slots.suffix?((0,i.wg)(),(0,i.iD)("div",{key:2,class:(0,o.C_)((0,r.SU)(h).suffix)},[(0,i.WI)(e.$slots,"suffix")],2)):(0,i.kq)("v-if",!0),b.value?((0,i.wg)(),(0,i.iD)("div",{key:3,class:(0,o.C_)((0,r.SU)(h).restSymbols)},(0,o.zw)(s.restSymbols),3)):(0,i.kq)("v-if",!0),((0,i.wg)(),(0,i.j4)(i.lR,{to:"body"},[y.value?((0,i.wg)(),(0,i.j4)(c.Z,{key:0,direction:s.errorDirection,theme:"red",x:E.value,y:(0,r.SU)(S),"target-height":w.value},{default:(0,i.w5)((()=>[(0,i._)("div",{class:(0,o.C_)((0,r.SU)(h).error)},(0,o.zw)(s.error),3)])),_:1},8,["direction","x","y","target-height"])):(0,i.kq)("v-if",!0)]))],2))}});var h=s(97138),_=s.n(h),m=s(83744);const g={};g.$style=_();const v=(0,m.Z)(p,[["__cssModules",g]])},37043:(e,t,s)=>{"use strict";s.d(t,{Z:()=>h});var i=s(66252),o=s(3577),r=s(89661),n=s(40094),a=s(2262);const l=(0,i.aZ)({__name:"pkb-btn",props:{label:{default:void 0},size:{default:"medium"},theme:{default:"normal"},icon:{default:void 0},iconRight:{default:void 0},outline:{type:Boolean},wide:{type:Boolean},loading:{type:Boolean},active:{type:Boolean},disabled:{type:Boolean},href:{default:void 0}},setup(e,{expose:t}){const s=e,l={normal:"white",negative:"white",gray:"gray",dark:"white"},c={normal:"green",negative:"red",gray:"gray",dark:"gray"},d=(0,a.iH)(),u=(0,i.Fl)((()=>s.outline?c[s.theme]:l[s.theme])),p=(0,i.Fl)((()=>({micro:12,tiny:16,small:16,medium:24,large:24}[s.size]))),h=(0,i.Fl)((()=>Boolean(s.href))),_=(0,i.Fl)((()=>h.value?"a":"button"));return t({focus:()=>{var e;null===(e=d.value)||void 0===e||e.focus()}}),(e,t)=>((0,i.wg)(),(0,i.j4)((0,i.LL)(_.value),{ref_key:"hostEl",ref:d,class:(0,o.C_)({[e.$style.host]:!0,[e.$style[`host_${s.theme}`]]:"normal"!==s.theme,[e.$style[`host_${s.size}`]]:"medium"!==s.size,[e.$style.host_icon]:s.icon&&!s.label,[e.$style.host_outline]:s.outline,[e.$style.host_wide]:s.wide,[e.$style.host_loading]:s.loading,[e.$style.host_active]:s.active,[e.$style.host_disabled]:s.disabled}),disabled:s.disabled,href:s.href},{default:(0,i.w5)((()=>[s.loading?((0,i.wg)(),(0,i.j4)(r.Z,{key:0,size:p.value,color:u.value,class:(0,o.C_)(e.$style.loader)},null,8,["size","color","class"])):(0,i.kq)("v-if",!0),s.icon?((0,i.wg)(),(0,i.j4)(n.Z,{key:1,name:s.icon,class:(0,o.C_)(e.$style.icon)},null,8,["name","class"])):(0,i.kq)("v-if",!0),s.label||e.$slots.default?((0,i.wg)(),(0,i.iD)("span",{key:2,class:(0,o.C_)(e.$style.text)},[(0,i.WI)(e.$slots,"default",{},(()=>[(0,i.Uk)((0,o.zw)(s.label),1)]))],2)):(0,i.kq)("v-if",!0),s.iconRight?((0,i.wg)(),(0,i.j4)(n.Z,{key:3,name:s.iconRight,class:(0,o.C_)(e.$style.icon)},null,8,["name","class"])):(0,i.kq)("v-if",!0)])),_:3},8,["class","disabled","href"]))}});var c=s(97329),d=s.n(c),u=s(83744);const p={};p.$style=d();const h=(0,u.Z)(l,[["__cssModules",p]])},76122:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var i=s(66252),o=s(3577);const r=(0,i.aZ)({__name:"pkb-card",props:{disabled:{type:Boolean}},setup(e){const t=e;return(e,s)=>((0,i.wg)(),(0,i.iD)("div",{class:(0,o.C_)([e.$style.host,{[e.$style.host_disabled]:t.disabled}])},[(0,i.WI)(e.$slots,"default")],2))}});var n=s(29885),a=s.n(n),l=s(83744);const c={};c.$style=a();const d=(0,l.Z)(r,[["__cssModules",c]])},47344:(e,t,s)=>{"use strict";s.d(t,{Z:()=>_});var i=s(66252),o=s(3577),r=s(49963),n=s(40094);const a=["onClick"],l=["disabled",".indeterminate"],c=(0,i.aZ)({__name:"pkb-checkbox",props:{modelValue:{type:Boolean},label:{},disabled:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const s=e,c=t,d=(0,i.Fl)({get:()=>s.modelValue,set:e=>c("update:modelValue",e)}),u=(0,i.Fl)((()=>void 0===d.value));function p(){s.disabled||(d.value=!d.value)}return(e,t)=>((0,i.wg)(),(0,i.iD)("label",{class:(0,o.C_)({[e.$style.host]:!0,[e.$style.host_disabled]:s.disabled}),onClick:(0,r.iM)(p,["prevent"])},[(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),class:(0,o.C_)(e.$style.checkbox),type:"checkbox",hidden:"",disabled:s.disabled,".indeterminate":u.value},null,10,l),[[r.e8,d.value]]),(0,i._)("span",{class:(0,o.C_)(e.$style.check)},[d.value?((0,i.wg)(),(0,i.j4)(n.Z,{key:0,name:"approve",size:20})):u.value?((0,i.wg)(),(0,i.j4)(n.Z,{key:1,name:"hide_16",size:20})):(0,i.kq)("v-if",!0)],2),e.$slots.default||s.label?((0,i.wg)(),(0,i.iD)("span",{key:0,class:(0,o.C_)(e.$style.label)},[(0,i.WI)(e.$slots,"default",{},(()=>[(0,i.Uk)((0,o.zw)(s.label),1)]))],2)):(0,i.kq)("v-if",!0)],10,a))}});var d=s(9209),u=s.n(d),p=s(83744);const h={};h.$style=u();const _=(0,p.Z)(c,[["__cssModules",h]])},34273:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var i=s(66252),o=s(3577);const r=["width","height","src","alt"],n="https://cs.pikabu.ru/images/def_avatar/community_v3.png",a=(0,i.aZ)({__name:"pkb-community-avatar",props:{communityName:{default:void 0},url:{default:n},size:{}},setup(e){const t=e,s=(0,i.Fl)((()=>t.communityName?`Аватар сообщества "${t.communityName}"`:"Аватар сообщества"));return(e,a)=>((0,i.wg)(),(0,i.iD)("img",{class:(0,o.C_)(e.$style.img),width:t.size,height:t.size,src:t.url||n,alt:s.value},null,10,r))}});var l=s(51072),c=s.n(l),d=s(83744);const u={};u.$style=c();const p=(0,d.Z)(a,[["__cssModules",u]])},96101:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var i=s(66252),o=s(3577),r=s(40094);const n=["disabled","tabindex"],a=(0,i.aZ)({__name:"pkb-control-btn",props:{icon:{},iconSize:{default:16},active:{type:Boolean},disabled:{type:Boolean},theme:{default:"normal"},size:{default:"md"}},setup(e){const t=e;return(e,s)=>((0,i.wg)(),(0,i.iD)("button",{type:"button",class:(0,o.C_)({[e.$style.host]:!0,[e.$style.host_active]:t.active,[e.$style[`host_${t.theme}`]]:"normal"!==t.theme,[e.$style[`host_${t.size}`]]:"md"!==t.size}),disabled:t.disabled,tabindex:t.disabled?-1:0},[(0,i.Wm)(r.Z,{name:t.icon,size:t.iconSize},null,8,["name","size"]),(0,i.WI)(e.$slots,"default")],10,n))}});var l=s(19342),c=s.n(l),d=s(83744);const u={};u.$style=c();const p=(0,d.Z)(a,[["__cssModules",u]])},34828:(e,t,s)=>{"use strict";s.d(t,{Z:()=>f});s(88674),s(41817);var i=s(66252),o=s(3577),r=s(66309),n=s(41218),a=s(91181),l=s(37043),c=s(12665);function d(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function u(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?d(Object(s),!0).forEach((function(t){p(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function p(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const h=(0,i.aZ)(u(u({},{inheritAttrs:!1}),{},{__name:"pkb-delete-confirm-popup",props:{active:{type:Boolean},title:{},content:{}},emits:["update:active","cancel","confirm"],setup(e,{emit:t}){const{enter:s,escape:d}=(0,r.IKb)(),u=e,p=t,h=(0,i.Fl)({get:()=>u.active,set:e=>p("update:active",e)});let _,m;async function g(){h.value=!1,await(0,i.Y3)(),p("confirm")}async function v(){h.value=!1,await(0,i.Y3)(),p("cancel")}return(0,c.gX)(h,{onActivated(){_=(0,n.$M)(s,g),m=(0,n.$M)(d,v)},onDeactivated(){var e,t;null===(e=_)||void 0===e||e(),null===(t=m)||void 0===t||t()}}),(e,t)=>((0,i.wg)(),(0,i.j4)(a.Z,(0,i.dG)({modelValue:h.value,"onUpdate:modelValue":t[2]||(t[2]=e=>h.value=e)},e.$attrs,{title:u.title,"cross-button":"",onClose:t[3]||(t[3]=e=>v())}),{footer:(0,i.w5)((()=>[(0,i.Wm)(l.Z,{label:"Удалить",theme:"negative",class:(0,o.C_)(e.$style.button),wide:e.IS_MOBILE,onClick:t[0]||(t[0]=e=>g())},null,8,["class","wide"]),e.IS_DESKTOP?((0,i.wg)(),(0,i.j4)(l.Z,{key:0,label:"Отмена",theme:"gray",class:(0,o.C_)(e.$style.button),onClick:t[1]||(t[1]=e=>v())},null,8,["class"])):(0,i.kq)("v-if",!0)])),default:(0,i.w5)((()=>[(0,i._)("div",{class:(0,o.C_)(e.$style.content)},[(0,i.WI)(e.$slots,"default",{},(()=>[(0,i.Uk)((0,o.zw)(u.content),1)]))],2)])),_:3},16,["modelValue","title"]))}}));var _=s(2708),m=s.n(_),g=s(83744);const v={};v.$style=m();const f=(0,g.Z)(h,[["__cssModules",v]])},6564:(e,t,s)=>{"use strict";s.d(t,{Z:()=>_});s(88674);var i=s(66252),o=s(3577),r=s(2262),n=s(62357),a=s(50542),l=s(40094);const c=(0,i.aZ)({__name:"pkb-drawer-search",props:{modelValue:{},tip:{default:""},active:{type:Boolean,default:!1},loading:{type:Boolean},empty:{type:Boolean},showListWithEmptyInput:{type:Boolean}},emits:["focus","update:active","update:modelValue"],setup(e,{emit:t}){const s=e,c=t,d=(0,r.iH)(null),u=(0,i.Fl)({get:()=>s.modelValue,set:e=>{c("update:modelValue",e)}});return(0,i.YP)((()=>s.active),(async e=>{var t;e&&(await(0,i.Y3)(),null===(t=d.value)||void 0===t||t.focus())})),(e,t)=>((0,i.wg)(),(0,i.j4)(n.Z,{active:s.active,"onUpdate:active":t[2]||(t[2]=e=>c("update:active",e))},{header:(0,i.w5)((()=>[(0,i.Wm)(a.Z,{ref_key:"inputRef",ref:d,modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),label:"Введите запрос",borderless:"",clearable:"",loading:s.loading,theme:"gray",icon:"search_16",onFocus:t[1]||(t[1]=e=>c("focus"))},null,8,["modelValue","loading"])])),default:(0,i.w5)((()=>[!u.value&&!e.showListWithEmptyInput||s.empty?((0,i.wg)(),(0,i.iD)("div",{key:1,class:(0,o.C_)(e.$style.tip)},[(0,i._)("span",{class:(0,o.C_)(e.$style.upIconWrapper)},[(0,i.Wm)(l.Z,{name:"up_12",class:(0,o.C_)(e.$style.upIcon),size:12},null,8,["class"])],2),(0,i._)("p",null,(0,o.zw)(s.empty?"Ничего не найдено. Попробуйте изменить параметры поиска ️😉":s.tip),1)],2)):((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,o.C_)(e.$style.list)},[(0,i.WI)(e.$slots,"default")],2))])),_:3},8,["active"]))}});var d=s(78156),u=s.n(d),p=s(83744);const h={};h.$style=u();const _=(0,p.Z)(c,[["__cssModules",h]])},62357:(e,t,s)=>{"use strict";s.d(t,{Z:()=>b});s(88674),s(41817);var i=s(66252),o=s(49963),r=s(2262),n=s(3577),a=s(51795),l=s(66309),c=s(65704),d=s(12665),u=s(55529);function p(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function h(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?p(Object(s),!0).forEach((function(t){_(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):p(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function _(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const m=(0,i.aZ)(h(h({},{inheritAttrs:!1}),{},{__name:"pkb-drawer",props:{title:{default:void 0},active:{type:Boolean},closeLocked:{type:Boolean},crossBtn:{type:Boolean,default:!0}},emits:["update:active","transitionIn","transitionOut","close"],setup(e,{emit:t}){const s=(0,c.E)("pkb-drawer"),p=e,h=t,_=(0,i.Fl)({get:()=>p.active,set(e){h("update:active",e)}});return(0,d.XW)(_),(0,d.gX)(_,{onActivated(){window.history.replaceState({id:s,opened:!1},document.title),window.history.pushState({id:s,opened:!0},document.title)}}),(0,l.ORN)(window,"popstate",(async e=>{const{state:t}=e;s===(null==t?void 0:t.id)&&(_.value&&p.closeLocked?(e.preventDefault(),window.history.go(1)):_.value=t.opened)})),(e,t)=>((0,i.wg)(),(0,i.j4)(i.lR,{to:"body"},[(0,i.Wm)(o.uT,{name:e.$style.host,appear:"",onBeforeEnter:t[1]||(t[1]=e=>h("transitionIn")),onAfterLeave:t[2]||(t[2]=e=>h("transitionOut"))},{default:(0,i.w5)((()=>[_.value?((0,i.wg)(),(0,i.iD)("aside",(0,i.dG)({key:0,class:e.$style.host},e.$attrs,{style:{zIndex:(0,r.SU)(u.e)()}}),[e.$slots.header||p.title?((0,i.wg)(),(0,i.j4)(a.Z,{key:0,class:(0,n.C_)(e.$style.header),title:p.title,"cross-btn":p.crossBtn&&!p.closeLocked,"onClick:close":t[0]||(t[0]=e=>{return t="cross-button",void(p.closeLocked||(h("close",t),window.history.back()));var t})},{default:(0,i.w5)((()=>[(0,i.WI)(e.$slots,"header")])),_:3},8,["class","title","cross-btn"])):(0,i.kq)("v-if",!0),(0,i._)("div",{class:(0,n.C_)(e.$style.content)},[(0,i.WI)(e.$slots,"default")],2),e.$slots.footer?((0,i.wg)(),(0,i.iD)("footer",{key:1,class:(0,n.C_)(e.$style.footer)},[(0,i.WI)(e.$slots,"footer")],2)):(0,i.kq)("v-if",!0)],16)):(0,i.kq)("v-if",!0)])),_:3},8,["name"])]))}}));var g=s(97892),v=s.n(g),f=s(83744);const y={};y.$style=v();const b=(0,f.Z)(m,[["__cssModules",y]])},75645:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var i=s(66252),o=s(49963);var r=s(65585),n=s.n(r),a=s(83744);const l={},c={};c.$style=n();const d=(0,a.Z)(l,[["render",function(e,t){return(0,i.wg)(),(0,i.j4)(o.uT,{name:e.$style.host},{default:(0,i.w5)((()=>[(0,i.WI)(e.$slots,"default")])),_:3},8,["name"])}],["__cssModules",c]])},55317:(e,t,s)=>{"use strict";s.d(t,{Z:()=>m});var i=s(66252),o=s(3577),r=s(2262),n=s(12665),a=s(66309),l=s(55529),c=s(75645);const d=(0,i.aZ)({__name:"pkb-dropdown",props:{for:{},active:{type:Boolean},maxHeight:{default:400},width:{default:void 0},relativePosition:{default:"left"}},emits:["update:active","click:outside"],setup(e,{emit:t}){const s=e,d=t,u=(0,i.Fl)({get:()=>Boolean(s.active),set(e){d("update:active",e)}}),p=(0,r.iH)(),h=(0,i.Fl)((()=>u.value?s.for:void 0)),{x:_,y:m,width:g,height:v}=(0,n.XL)(h,{absolute:!0}),{height:f,width:y}=(0,n.XL)(p,{absolute:!0}),{height:b}=(0,a.iPe)(),w=(0,i.Fl)((()=>{const e=b.value+window.scrollY<m.value+v.value+f.value,t=window.scrollY>m.value-f.value;return e&&!t})),k=(0,i.Fl)((()=>{var e;return{"max-height":s.maxHeight+"px",top:w.value?m.value-f.value+"px":m.value+v.value+"px",width:null!==(e=s.width)&&void 0!==e?e:g.value+"px",left:"left"===s.relativePosition?_.value+"px":_.value-Math.abs(g.value-y.value)+"px",zIndex:(0,l.e)()}}));return(0,a.S1d)(s.for,(e=>{e.forEach((e=>{e.isIntersecting||(u.value=!1)}))})),(0,a.i9H)(p,(e=>{const t=(0,a.NXq)(h);t&&!e.composedPath().includes(t)&&d("click:outside")})),(e,t)=>((0,i.wg)(),(0,i.j4)(i.lR,{to:"body"},[(0,i.Wm)(c.Z,null,{default:(0,i.w5)((()=>[u.value?((0,i.wg)(),(0,i.iD)("div",{key:0,ref_key:"dropdownEl",ref:p,class:(0,o.C_)(e.$style.host),style:(0,o.j5)(k.value)},[(0,i.WI)(e.$slots,"default")],6)):(0,i.kq)("v-if",!0)])),_:3})]))}});var u=s(20318),p=s.n(u),h=s(83744);const _={};_.$style=p();const m=(0,h.Z)(d,[["__cssModules",_]])},66261:(e,t,s)=>{"use strict";s.d(t,{Z:()=>_});var i=s(66252),o=s(3577),r=s(2262),n=s(35653),a=s(30381),l=s.n(a);const c=(0,i.aZ)({__name:"pkb-edited-time",props:{editedTs:{}},setup(e){const t=e,s=(0,r.iH)(),a=(0,i.Fl)((()=>l()(1e3*t.editedTs).local().format("D MMMM YYYY [в] H:mm"))),c=(0,r.iH)(!1);return(e,t)=>{const r=(0,i.Q2)("tooltip");return(0,i.wy)(((0,i.wg)(),(0,i.iD)("time",{ref_key:"hostEl",ref:s,class:(0,o.C_)(e.$style.host),onClick:t[0]||(t[0]=e=>c.value=!c.value)},[(0,i.WI)(e.$slots,"default"),(0,i.Wm)(n.Z,{active:e.IS_MOBILE&&c.value,for:s.value,class:(0,o.C_)(e.$style.hint),direction:"top"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(a.value),1)])),_:1},8,["active","for","class"])],2)),[[r,a.value]])}}});var d=s(8586),u=s.n(d),p=s(83744);const h={};h.$style=u();const _=(0,p.Z)(c,[["__cssModules",h]])},7284:(e,t,s)=>{"use strict";s.d(t,{Z:()=>u});var i=s(66252),o=s(3577),r=s(37043);const n=(0,i.aZ)({__name:"pkb-extra-btn",props:{icon:{},theme:{default:void 0},size:{default:void 0},active:{type:Boolean},disabled:{type:Boolean}},setup(e){const t=e;return(e,s)=>((0,i.wg)(),(0,i.j4)(r.Z,{class:(0,o.C_)([e.$style.host,{[e.$style[`host_${t.theme}`]]:"normal"!==t.theme}]),icon:t.icon,theme:t.theme,size:t.size,active:t.active,disabled:t.disabled},null,8,["class","icon","theme","size","active","disabled"]))}});var a=s(12941),l=s.n(a),c=s(83744);const d={};d.$style=l();const u=(0,c.Z)(n,[["__cssModules",d]])},6314:(e,t,s)=>{"use strict";s.d(t,{Z:()=>v});s(66992),s(33948);var i=s(66252),o=s(3577),r=s(60581),n=s(92514);const a=(0,i._)("span",{class:"pkb-ruble-sign"},"₽",-1),l=(0,i._)("span",{class:"pkb-ruble-sign"},"₽",-1),c=(0,i._)("span",{class:"pkb-ruble-sign"},"₽",-1),d=(0,i._)("span",{class:"pkb-ruble-sign"},"₽",-1),u=(0,i._)("span",null,"осталось собрать",-1),p=(0,i.aZ)({__name:"pkb-fundraising-progressbar",props:{value:{},max:{},completed:{type:Boolean}},setup(e){const t=e,s=(0,i.Fl)((()=>(0,n.uf)(t.value))),p=(0,i.Fl)((()=>(0,n.uf)(t.max))),h=(0,i.Fl)((()=>(0,n.uf)(Math.max(t.max-t.value,0))));return(e,n)=>((0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(r.Z,{mode:"percents",value:t.value,max:t.max},null,8,["value","max"]),t.completed?((0,i.wg)(),(0,i.iD)("footer",{key:0,class:(0,o.C_)([e.$style.footer,e.$style.footer_completed])},[(0,i.Uk)(" Собрано "),(0,i._)("strong",null,[(0,i.Uk)((0,o.zw)(s.value)+" ",1),a]),(0,i.Uk)(" из "),(0,i._)("strong",null,[(0,i.Uk)((0,o.zw)(p.value)+" ",1),l])],2)):((0,i.wg)(),(0,i.iD)(i.HY,{key:1},[(0,i._)("div",{class:(0,o.C_)(e.$style.values)},[(0,i._)("span",null,[(0,i.Uk)((0,o.zw)(s.value)+" ",1),c]),(0,i._)("span",null,[(0,i.Uk)((0,o.zw)(h.value)+" ",1),d])],2),(0,i._)("footer",{class:(0,o.C_)(e.$style.footer)},[(0,i._)("span",null,[(0,i.Uk)("из "),(0,i._)("strong",null,(0,o.zw)(p.value),1),(0,i.Uk)(" собрано")]),u],2)],64))]))}});var h=s(76432),_=s.n(h),m=s(83744);const g={};g.$style=_();const v=(0,m.Z)(p,[["__cssModules",g]])},51795:(e,t,s)=>{"use strict";s.d(t,{Z:()=>u});var i=s(66252),o=s(3577),r=s(62728);const n=(0,i.aZ)({__name:"pkb-header-popup",props:{title:{default:void 0},theme:{default:"normal"},crossBtn:{type:Boolean,default:!0}},emits:["click:close"],setup(e,{emit:t}){const s=e,n=t;return(e,t)=>((0,i.wg)(),(0,i.iD)("header",{class:(0,o.C_)({[e.$style.host]:!0,[e.$style[`host_${s.theme}`]]:"normal"!==s.theme})},[s.crossBtn?((0,i.wg)(),(0,i.j4)(r.Z,{key:0,class:(0,o.C_)(e.$style.button),size:"large","icon-name":"close_20","icon-size":20,onClick:t[0]||(t[0]=e=>n("click:close"))},null,8,["class"])):(0,i.kq)("v-if",!0),(0,i._)("div",{class:(0,o.C_)(e.$style.content)},[s.title?((0,i.wg)(),(0,i.iD)("h3",{key:0,class:(0,o.C_)(e.$style.title)},(0,o.zw)(s.title),3)):(0,i.WI)(e.$slots,"default",{key:1})],2)],2))}});var a=s(73523),l=s.n(a),c=s(83744);const d={};d.$style=l();const u=(0,c.Z)(n,[["__cssModules",d]])},43339:(e,t,s)=>{"use strict";s.d(t,{Z:()=>_});var i=s(66252),o=s(3577),r=s(49963),n=s(2262),a=s(35653),l=s(40094);const c=(0,i.aZ)({__name:"pkb-hint",props:{alignment:{default:"center"},direction:{default:"bottom"},disabled:{type:Boolean},active:{type:Boolean,default:!1},tooltipContainer:{default:"body"}},emits:["update:active"],setup(e,{emit:t}){const s=e,c=t,d=(0,n.iH)(),u=(0,i.Fl)({get:()=>s.active,set:e=>c("update:active",e)});function p(){s.disabled||c("update:active",u.value=!u.value)}return(e,t)=>((0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(l.Z,{ref_key:"iconEl",ref:d,class:(0,o.C_)([e.$style.icon,{[e.$style.icon_disabled]:s.disabled}]),name:"hint_24",onClick:(0,r.iM)(p,["prevent"])},null,8,["class","onClick"]),(0,i.Wm)(a.Z,{active:u.value,"onUpdate:active":t[0]||(t[0]=e=>u.value=e),for:d.value,alignment:s.alignment,direction:s.direction,class:(0,o.C_)(e.$style.tooltip),container:s.tooltipContainer},{default:(0,i.w5)((()=>[(0,i.WI)(e.$slots,"default")])),_:3},8,["active","for","alignment","direction","class","container"])]))}});var d=s(90889),u=s.n(d),p=s(83744);const h={};h.$style=u();const _=(0,p.Z)(c,[["__cssModules",h]])},62728:(e,t,s)=>{"use strict";s.d(t,{Z:()=>u});var i=s(66252),o=s(3577),r=s(40094);const n=(0,i.aZ)({__name:"pkb-icon-btn",props:{iconName:{},iconSize:{default:16},size:{default:"medium"},theme:{default:"normal"},circle:{type:Boolean}},setup(e){const t=e;return(e,s)=>((0,i.wg)(),(0,i.iD)("button",{class:(0,o.C_)({[e.$style.host]:!0,[e.$style.host_circle]:t.circle,[e.$style[`host_${t.theme}`]]:"normal"!==t.theme,[e.$style[`host_${t.size}`]]:"medium"!==t.size})},[(0,i.Wm)(r.Z,{class:(0,o.C_)(e.$style.icon),name:t.iconName,size:t.iconSize},null,8,["class","name","size"])],2))}});var a=s(68e3),l=s.n(a),c=s(83744);const d={};d.$style=l();const u=(0,c.Z)(n,[["__cssModules",d]])},40094:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var i=s(66252),o=s(3577);const r=["width","height"],n=["xlink:href"],a=(0,i.aZ)({__name:"pkb-icon",props:{name:{},size:{default:16}},setup(e){const t=e;return(e,s)=>((0,i.wg)(),(0,i.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",class:(0,o.C_)(e.$style.host),width:t.size,height:t.size},[(0,i._)("use",{"xlink:href":`#icon--ui__${t.name}`},null,8,n)],10,r))}});var l=s(77850),c=s.n(l),d=s(83744);const u={};u.$style=c();const p=(0,d.Z)(a,[["__cssModules",u]])},61258:(e,t,s)=>{"use strict";s.d(t,{Z:()=>D});s(88674),s(74916),s(66992),s(33948),s(55674);var i=s(66252),o=s(3577),r=s(49963),n=s(6564),a=s(53329),l=s(50451),c=s(55317),d=(s(2707),s(40094));const u=(0,i.aZ)({__name:"pkb-input-tag-list",props:{tags:{},disabled:{type:Boolean},readonlyTags:{default:void 0}},emits:["update:tags"],setup(e,{emit:t}){const s=e,r=t,n=(0,i.Fl)({get(){var e;const t=null!==(e=s.readonlyTags)&&void 0!==e?e:[];return 0===t.length?s.tags:[...s.tags].sort(((e,s)=>(t.includes(s)?1:0)-(t.includes(e)?1:0)))},set(e){r("update:tags",e)}});return(e,t)=>((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.value,(t=>{var r,a;return(0,i.wg)(),(0,i.iD)("div",{key:t,class:(0,o.C_)([e.$style.tag,{[e.$style.tag_readonly]:null===(r=e.readonlyTags)||void 0===r?void 0:r.includes(t)}])},[(0,i._)("span",{class:(0,o.C_)(e.$style.tag__label)},(0,o.zw)("Моё"===t?"[моё]":t),3),null!==(a=e.readonlyTags)&&void 0!==a&&a.includes(t)?(0,i.kq)("v-if",!0):((0,i.wg)(),(0,i.j4)(d.Z,{key:0,class:(0,o.C_)(e.$style.removeButton),name:"close_ios",onClick:e=>{return i=t,void(s.disabled||(n.value=n.value.filter((e=>e!==i))));var i}},null,8,["class","onClick"]))],2)})),128))}});var p=s(96531),h=s.n(p),_=s(83744);const m={};m.$style=h();const g=(0,_.Z)(u,[["__cssModules",m]]),v=(0,i.aZ)({__name:"pkb-input-tag-add-btn",props:{icon:{default:"add_16"},label:{default:"Добавить тег"}},setup(e){const t=e;return(e,s)=>((0,i.wg)(),(0,i.iD)("div",{class:(0,o.C_)(e.$style.host)},[(0,i.Wm)(d.Z,{class:(0,o.C_)(e.$style.icon),name:t.icon},null,8,["class","name"]),(0,i.Uk)(" "+(0,o.zw)(t.label),1)],2))}});var f=s(53810),y=s.n(f);const b={};b.$style=y();const w=(0,_.Z)(v,[["__cssModules",b]]);var k=s(2262),S=s(23279),O=s.n(S),E=s(44361);const C=["disabled"];var x;!function(e){e[e.NONE=0]="NONE",e[e.PROGRESS=1]="PROGRESS",e[e.FOUND=2]="FOUND",e[e.NOT_FOUND=3]="NOT_FOUND"}(x||(x={}));const T=(0,i.aZ)({__name:"pkb-input-tag",props:{size:{default:"medium"},theme:{default:"normal"},modelValue:{},label:{default:void 0},error:{type:[Boolean,String],default:!1},showErrorImmediately:{type:Boolean},disabled:{type:Boolean},maxTags:{default:void 0},borderless:{type:Boolean},readonlyTags:{default:()=>[]},btnIcon:{default:"add_16"},btnCaption:{default:"Добавить тег"},mode:{default:void 0}},emits:["update:modelValue","showDropdown","addTag"],setup(e,{expose:t,emit:s}){const d=e,u=s,p=(0,i.Fl)({get:()=>d.modelValue,set(e){u("update:modelValue",e)}}),h=(0,k.iH)(),_=(0,k.iH)(""),m=(0,k.iH)(x.NONE),v=(0,k.iH)(!1),f=(0,k.iH)([]),y=(0,k.iH)([]),b=O()((async()=>{const e=await E.Hx.search(_.value,E.ll.STORY),t=new Set(p.value.map((e=>e.toLowerCase())));f.value=e.filter((e=>!t.has(e.name.toLowerCase()))),m.value=f.value.length?x.FOUND:x.NOT_FOUND,u("showDropdown",f.value.length>0)}),500);function S(){f.value=[],u("showDropdown",!1)}function T(e){v.value=!1,p.value=[...p.value,e],S(),_.value="",m.value=x.NONE,B(),u("addTag",e)}(0,i.YP)(_,(()=>{_.value?(m.value=x.PROGRESS,b()):S()}));const I=(0,i.Fl)((()=>void 0!==d.maxTags&&p.value.length>=d.maxTags)),P=(0,k.iH)(),A=(0,i.Fl)((()=>"btn"===d.mode)),D=(0,i.Fl)((()=>"dropdown"===d.mode)),M=(0,i.Fl)((()=>f.value.length>0)),R=(0,k.iH)("btn"!==d.mode),N=(0,i.Fl)((()=>!D.value&&(A.value&&!R.value||!1)));function B(){var e;null===(e=P.value)||void 0===e||e.focus()}async function L(){const e=P.value;e&&(e.style.width="0",e.style.width=`${e.scrollWidth||1}px`)}return(0,i.YP)(_,L,{flush:"post"}),(0,i.bv)(L),t({focus:B}),(e,t)=>((0,i.wg)(),(0,i.j4)(l.Z,{ref_key:"hostEl",ref:h,class:(0,o.C_)({[e.$style[`host_${d.size}`]]:"medium"!==d.size}),size:d.size,theme:d.theme,label:A.value?"":d.label,error:d.error,"show-error-immediately":d.showErrorImmediately,disabled:d.disabled,loading:m.value===x.PROGRESS,borderless:d.borderless,empty:!e.IS_MOBILE&&!p.value.length&&!_.value,onClick:t[13]||(t[13]=e=>B())},{default:(0,i.w5)((()=>[(0,i._)("div",{class:(0,o.C_)(e.$style.wrapper)},[(0,i.Wm)(g,{tags:p.value,"onUpdate:tags":t[0]||(t[0]=e=>p.value=e),disabled:d.disabled,"readonly-tags":d.readonlyTags},null,8,["tags","disabled","readonly-tags"]),I.value?(0,i.kq)("v-if",!0):((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[N.value?((0,i.wg)(),(0,i.j4)(w,{key:0,class:(0,o.C_)({[e.$style.shrinkedAddBtn]:A.value&&e.IS_DESKTOP}),icon:d.btnIcon,label:d.btnCaption,onClick:t[1]||(t[1]=e=>{d.disabled||(v.value=!0,A.value&&(R.value=!0))})},null,8,["class","icon","label"])):(0,i.wy)(((0,i.wg)(),(0,i.iD)("input",{key:1,ref_key:"inputEl",ref:P,"onUpdate:modelValue":t[2]||(t[2]=e=>_.value=e),class:(0,o.C_)(e.$style.input),disabled:d.disabled,onKeydown:[t[3]||(t[3]=(0,r.D2)((e=>function(){if(d.disabled)return;const e=_.value.trim();e&&(p.value.every((t=>t.toLowerCase()!==e.toLowerCase()))&&(p.value=[...p.value,e]),_.value="",P.value.focus())}()),["enter"])),t[4]||(t[4]=(0,r.D2)((e=>{var t;d.disabled||_.value||null!==(t=d.readonlyTags)&&void 0!==t&&t.includes(p.value[p.value.length-1])||(p.value=p.value.slice(0,-1))}),["backspace"])),t[5]||(t[5]=(0,r.D2)((0,r.iM)((e=>{return null===(t=P.value)||void 0===t||t.blur(),void S();var t}),["prevent"]),["esc"])),t[6]||(t[6]=(0,r.D2)((0,r.iM)((e=>{var t;m.value===x.FOUND&&(null===(t=y.value[0])||void 0===t||t.focus())}),["prevent"]),["down"]))],onInput:t[7]||(t[7]=e=>function(){if(d.disabled)return;const e=_.value.split(",");if(e.length>1){var t,s;_.value=null!==(t=null===(s=e.pop())||void 0===s?void 0:s.trimStart())&&void 0!==t?t:"";const i=e.map((e=>e.trim())).filter((e=>e&&p.value.every((t=>t.toLowerCase()!==e.toLowerCase()))));p.value=[...p.value,...i]}}()),onBlur:t[8]||(t[8]=e=>{A.value&&!M.value&&(R.value=!1)})},null,42,C)),[[r.nr,_.value]])],64))],2),e.IS_MOBILE&&!D.value?((0,i.wg)(),(0,i.j4)(n.Z,{key:0,modelValue:_.value,"onUpdate:modelValue":t[9]||(t[9]=e=>_.value=e),active:v.value,"onUpdate:active":t[10]||(t[10]=e=>v.value=e),empty:m.value===x.NOT_FOUND,loading:m.value===x.PROGRESS,tip:"Пожалуйста, начните вводить тег, а затем выберите из списка"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(f.value,(e=>((0,i.wg)(),(0,i.j4)(a.Z,{key:e.name,label:"Моё"===e.name?"[моё]":e.name,selection:_.value,onClick:t=>T(e.name)},{suffix:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(e.count),1)])),_:2},1032,["label","selection","onClick"])))),128))])),_:1},8,["modelValue","active","empty","loading"])):(0,i.kq)("v-if",!0),e.IS_DESKTOP||D.value?((0,i.wg)(),(0,i.j4)(c.Z,{key:1,for:h.value,active:M.value,"onClick:outside":t[12]||(t[12]=e=>S())},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(f.value,((e,s)=>((0,i.wg)(),(0,i.j4)(a.Z,{ref_for:!0,ref_key:"tagsRefs",ref:y,key:s,tabindex:"0",label:"Моё"===e.name?"[моё]":e.name,selection:_.value,onClick:t=>T(e.name),onKeydown:[(0,r.D2)((0,r.iM)((e=>function(e){var t;0!==e?null===(t=y.value[e-1])||void 0===t||t.focus():B()}(s)),["prevent"]),["up"]),(0,r.D2)((0,r.iM)((e=>function(e){var t;null===(t=y.value[e+1])||void 0===t||t.focus()}(s)),["prevent"]),["down"]),t[11]||(t[11]=(0,r.D2)((0,r.iM)((e=>async function(){B(),await(0,i.Y3)(),S()}()),["prevent"]),["esc"])),(0,r.D2)((0,r.iM)((t=>T(e.name)),["prevent"]),["enter"])]},{suffix:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(e.count),1)])),_:2},1032,["label","selection","onClick","onKeydown"])))),128))])),_:1},8,["for","active"])):(0,i.kq)("v-if",!0)])),_:1},8,["class","size","theme","label","error","show-error-immediately","disabled","loading","borderless","empty"]))}});var I=s(41535),P=s.n(I);const A={};A.$style=P();const D=(0,_.Z)(T,[["__cssModules",A]])},50542:(e,t,s)=>{"use strict";s.d(t,{Z:()=>m});var i=s(66252),o=s(3577),r=s(50451),n=s(40094),a=s(2262);const l=["maxlength","minlength"],c=["type","maxlength","minlength","min","max","step"],d=(0,i.aZ)({__name:"pkb-input",props:{type:{default:"text"},size:{default:"medium"},theme:{default:"normal"},modelValue:{},label:{default:void 0},error:{type:[String,Boolean],default:!1},errorDirection:{default:"top"},showErrorImmediately:{type:Boolean},icon:{default:void 0},disabled:{type:Boolean},loading:{type:Boolean},clearable:{type:Boolean},borderless:{type:Boolean},inputmode:{default:void 0},autocomplete:{default:void 0},placeholder:{default:void 0},tabindex:{default:void 0},autofocus:{type:Boolean},clean:{type:Function,default:void 0},format:{type:Function,default:void 0},maxLength:{default:void 0},minLength:{default:void 0},maxRestSymbols:{default:void 0},min:{default:void 0},max:{default:void 0},step:{default:void 0}},emits:["update:modelValue","focus","blur","show:error","hide:error"],setup(e,{expose:t,emit:s}){const d=e,u=s,p=(0,a.iH)(),h=(0,i.Fl)((()=>"textarea"===d.type)),_=(0,i.Fl)((()=>!d.modelValue)),m=(0,i.Fl)((()=>({disabled:d.disabled,inputmode:d.inputmode,autocomplete:d.autocomplete,placeholder:d.label?void 0:d.placeholder,tabindex:d.tabindex}))),g=(0,i.Fl)((()=>d.maxLength&&d.maxLength-d.modelValue.length||0));function v(){p.value&&f(p.value.value)}function f(e,t=!0){if(!p.value)return;const s=d.clean?d.clean(e):e,i=d.format?d.format(s):s;if(p.value.value!==i){const s=p.value.selectionStart-(e.length-i.length);p.value.value=i,"number"!==d.type&&"date"!==d.type&&t&&p.value.setSelectionRange(s,s)}d.modelValue!==s&&u("update:modelValue",s)}function y(){var e;null===(e=p.value)||void 0===e||e.focus()}function b(e,t){var s;null===(s=p.value)||void 0===s||s.setSelectionRange(e,t)}function w(){const e=p.value;e&&(e.style.height="auto",e.style.height=`${e.scrollHeight}px`)}return(0,i.YP)((()=>d.modelValue),(e=>f(e))),(0,i.bv)((()=>{f(d.modelValue,!1),d.autofocus&&(b(-1,-1),y())})),h.value&&((0,i.YP)((()=>d.modelValue),w,{flush:"post"}),(0,i.bv)(w)),t({focus:y,blur:function(){var e;null===(e=p.value)||void 0===e||e.blur()},setSelectionRange:b}),(e,t)=>((0,i.wg)(),(0,i.j4)(r.Z,{size:d.size,theme:d.theme,label:d.label,error:d.error,"error-direction":d.errorDirection,"show-error-immediately":d.showErrorImmediately,disabled:d.disabled,loading:d.loading,clearable:d.clearable,borderless:d.borderless,empty:_.value,"rest-symbols":g.value,"max-rest-symbols":d.maxRestSymbols,onClear:t[4]||(t[4]=e=>u("update:modelValue","")),"onShow:error":t[5]||(t[5]=e=>u("show:error")),"onHide:error":t[6]||(t[6]=e=>u("hide:error")),onClick:t[7]||(t[7]=e=>y())},(0,i.Nv)({default:(0,i.w5)((()=>[h.value?((0,i.wg)(),(0,i.iD)("textarea",(0,i.dG)({key:0,ref_key:"inputEl",ref:p},m.value,{class:e.$style.input,maxlength:e.maxLength,minlength:e.minLength,rows:"1",onInput:v,onFocus:t[0]||(t[0]=e=>u("focus")),onBlur:t[1]||(t[1]=e=>u("blur"))}),null,16,l)):((0,i.wg)(),(0,i.iD)("input",(0,i.dG)({key:1,ref_key:"inputEl",ref:p},m.value,{lang:"ru",class:e.$style.input,type:d.type,maxlength:e.maxLength,minlength:e.minLength,min:d.min,max:d.max,step:d.step,onInput:v,onFocus:t[2]||(t[2]=e=>u("focus")),onBlur:t[3]||(t[3]=e=>u("blur"))}),null,16,c))])),_:2},[e.$slots.prefix||d.icon?{name:"prefix",fn:(0,i.w5)((()=>[d.icon?((0,i.wg)(),(0,i.j4)(n.Z,{key:0,name:d.icon,class:(0,o.C_)(e.$style.icon)},null,8,["name","class"])):(0,i.WI)(e.$slots,"prefix",{key:1})])),key:"0"}:void 0,e.$slots.suffix?{name:"suffix",fn:(0,i.w5)((()=>[(0,i.WI)(e.$slots,"suffix")])),key:"1"}:void 0]),1032,["size","theme","label","error","error-direction","show-error-immediately","disabled","loading","clearable","borderless","empty","rest-symbols","max-rest-symbols"]))}});var u=s(83712),p=s.n(u),h=s(83744);const _={};_.$style=p();const m=(0,h.Z)(d,[["__cssModules",_]])},90008:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var i=s(66252),o=s(3577),r=s(40094),n=s(22177);const a=(0,i.aZ)({__name:"pkb-item",props:{icon:{},radio:{type:Boolean},label:{},active:{type:Boolean},disabled:{type:Boolean}},emits:["update:active"],setup(e,{emit:t}){const s=e,a=t;return(e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:(0,o.C_)({[e.$style.host]:!0,[e.$style.host_active]:s.active&&!s.radio,[e.$style.host_disabled]:s.disabled}),onClick:t[0]||(t[0]=e=>a("update:active",!s.active))},[s.radio?((0,i.wg)(),(0,i.iD)("span",{key:0,class:(0,o.C_)(e.$style.content)},[(0,i.Wm)(n.Z,{"model-value":s.active,value:!0},null,8,["model-value"])],2)):s.icon?((0,i.wg)(),(0,i.iD)("span",{key:1,class:(0,o.C_)(e.$style.content)},[(0,i.Wm)(r.Z,{name:s.icon,size:20},null,8,["name"])],2)):(0,i.kq)("v-if",!0),(0,i._)("span",{class:(0,o.C_)(e.$style.label)},(0,o.zw)(s.label),3)],2))}});var l=s(29409),c=s.n(l),d=s(83744);const u={};u.$style=c();const p=(0,d.Z)(a,[["__cssModules",u]])},89661:(e,t,s)=>{"use strict";s.d(t,{Z:()=>g});var i=s(66252),o=s(3577);const r=["width","height","viewBox"],n=["cx","cy","r","stroke-width"],a=["d","stroke","stroke-width","stroke-dasharray"],l={key:0},c=["id"],d=[(0,i._)("stop",{"stop-color":"currentColor"},null,-1),(0,i._)("stop",{offset:"1","stop-color":"currentColor","stop-opacity":"0"},null,-1)],u=(0,i.aZ)({__name:"pkb-loader",props:{size:{default:16},color:{default:"green"},progress:{default:void 0},spinner:{type:Boolean}},setup(e){const t=e,s=(0,i.Fl)((()=>t.spinner||null===t.progress||void 0===t.progress)),u=(0,i.Fl)((()=>t.size/8)),p=(0,i.Fl)((()=>t.size/2)),h=(0,i.Fl)((()=>p.value-u.value/2)),_=(0,i.Fl)((()=>2*Math.PI*h.value)),m=(0,i.Fl)((()=>_.value*(s.value?.75:t.progress))),g=(0,i.Fl)((()=>`M${p.value},${u.value/2}a${h.value},${h.value} 0 1 1 0,${2*h.value}a${h.value},${h.value} 0 1 1 0,-${2*h.value}`));return(e,v)=>((0,i.wg)(),(0,i.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",class:(0,o.C_)({[e.$style.host]:!0,[e.$style.host_spinner]:s.value,[e.$style[`host_${t.color}`]]:"green"!==t.color}),width:t.size,height:t.size,viewBox:`0 0 ${t.size} ${t.size}`},[(0,i._)("circle",{cx:p.value,cy:p.value,r:h.value,stroke:"currentColor","stroke-width":u.value,fill:"none","stroke-opacity":"0.1"},null,8,n),(0,i._)("path",{d:g.value,stroke:s.value?`url(#${e.$style.host})`:"currentColor","stroke-width":u.value,"stroke-linecap":"round",fill:"none","stroke-dashoffset":"0","stroke-dasharray":`${m.value} ${_.value}`},null,8,a),s.value?((0,i.wg)(),(0,i.iD)("defs",l,[(0,i._)("linearGradient",{id:e.$style.host,x1:"10",y1:"18",x2:"16",y2:"7",gradientUnits:"userSpaceOnUse"},d,8,c)])):(0,i.kq)("v-if",!0)],10,r))}});var p=s(24614),h=s.n(p),_=s(83744);const m={};m.$style=h();const g=(0,_.Z)(u,[["__cssModules",m]])},32499:(e,t,s)=>{"use strict";s.d(t,{Z:()=>h});var i=s(66252),o=s(3577),r=s(72658),n=s(35653),a=s(2262);const l=(0,i.aZ)({__name:"pkb-menu",setup(e){const t=(0,a.iH)(!1),s=(0,a.iH)();function l(e=null){t.value=Boolean(null!=e?e:!t.value)}return(e,a)=>((0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",{ref_key:"triggerEl",ref:s,class:(0,o.C_)(e.$style.trigger)},[(0,i.WI)(e.$slots,"trigger",{toggle:l})],2),e.IS_MOBILE?((0,i.wg)(),(0,i.j4)(r.Z,{key:0,modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=e=>t.value=e)},{default:(0,i.w5)((()=>[(0,i.WI)(e.$slots,"default",{toggle:l})])),_:3},8,["modelValue"])):((0,i.wg)(),(0,i.j4)(n.Z,{key:1,active:t.value,"onUpdate:active":a[1]||(a[1]=e=>t.value=e),class:(0,o.C_)(e.$style.tooltip),for:s.value},{default:(0,i.w5)((()=>[(0,i.WI)(e.$slots,"default",{toggle:l})])),_:3},8,["active","class","for"]))],64))}});var c=s(88437),d=s.n(c),u=s(83744);const p={};p.$style=d();const h=(0,u.Z)(l,[["__cssModules",p]])},5707:(e,t,s)=>{"use strict";s.d(t,{Z:()=>v});var i=s(66252),o=s(49963),r=s(3577),n=s(2262),a=s(32881),l=s(12665),c=s(66309),d=s(55529),u=s(59870);const p=(0,i.aZ)({__name:"pkb-modal-card-base",props:{modelValue:{type:Boolean},title:{default:""},theme:{default:"normal"},crossButton:{type:Boolean,default:void 0},closeLocked:{type:Boolean,default:void 0},centered:{type:Boolean},headerSize:{default:"medium"}},emits:["update:modelValue","close","transitionIn","transitionOut"],setup(e,{emit:t}){const s=e;(0,i.JJ)(u.gN,{theme:(0,i.Fl)((()=>{var e;return null!==(e=s.theme)&&void 0!==e?e:"normal"})),title:(0,i.Fl)((()=>s.title)),crossButton:(0,i.Fl)((()=>{var e;return null!==(e=s.crossButton)&&void 0!==e&&e})),closeLocked:(0,i.Fl)((()=>s.closeLocked)),close:m,headerSize:(0,i.Fl)((()=>s.headerSize))});const p=t,h=(0,l.sx)(),_=(0,n.iH)(!1);function m(e){s.closeLocked||(p("update:modelValue",!1),p("close",e))}return(0,l.XW)(_),(0,l.gX)((()=>s.modelValue),{onActivated(){(0,c.ORN)(document,"keyup",(e=>{"Escape"===e.key&&1===h.modalsOpenCount&&m("escape")}))}}),(e,t)=>((0,i.wg)(),(0,i.j4)(i.lR,{to:"body"},[(0,i.Wm)(o.uT,{appear:"","enter-from-class":e.$style.host_hidden,"leave-to-class":e.$style.host_hidden,onBeforeEnter:t[1]||(t[1]=e=>{p("transitionIn"),_.value=!0}),onAfterLeave:t[2]||(t[2]=e=>{p("transitionOut"),_.value=!1}),onEnter:t[3]||(t[3]=e=>{document.activeElement instanceof HTMLElement&&document.activeElement.blur()})},{default:(0,i.w5)((()=>[s.modelValue?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,r.C_)([e.$style.host,{[e.$style.centered]:s.centered}]),style:(0,r.j5)({zIndex:(0,n.SU)(d.e)()})},[(0,i.Wm)(a.Z,{onClick:t[0]||(t[0]=e=>m("overlay"))}),(0,i._)("div",(0,i.dG)({class:e.$style.body},e.$attrs),[(0,i.WI)(e.$slots,"default")],16)],6)):(0,i.kq)("v-if",!0)])),_:3},8,["enter-from-class","leave-to-class"])]))}});var h=s(20994),_=s.n(h),m=s(83744);const g={};g.$style=_();const v=(0,m.Z)(p,[["__cssModules",g]])},37829:(e,t,s)=>{"use strict";s.d(t,{Z:()=>C});var i=s(66252),o=s(3577),r=s(2262),n=s(59870),a=s(93356),l=s(43544);const c=(0,i.aZ)({__name:"pkb-modal-card-header",setup(e){const{title:t,headerSize:s}=(0,a.D3)(n.gN);return(e,n)=>e.$slots.default||(0,r.SU)(t)?((0,i.wg)(),(0,i.iD)("header",{key:0,class:(0,o.C_)([e.$style.header,e.$style[`header_${(0,r.SU)(s)}`]])},[(0,r.SU)(t)?((0,i.wg)(),(0,i.j4)(l.Z,{key:0},{default:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)((0,r.SU)(t)),1)])),_:1})):(0,i.WI)(e.$slots,"default",{key:1})],2)):(0,i.kq)("v-if",!0)}});var d=s(44290),u=s.n(d),p=s(83744);const h={};h.$style=u();const _=(0,p.Z)(c,[["__cssModules",h]]);var m=s(62728);const g=(0,i.aZ)({__name:"pkb-modal-card-cross-btn",setup(e){const{theme:t,headerSize:s}=(0,a.D3)(n.gN);return(e,n)=>((0,i.wg)(),(0,i.j4)(m.Z,{class:(0,o.C_)([e.$style.close,e.$style[`close_${(0,r.SU)(s)}`]]),circle:"medium"===(0,r.SU)(s),theme:"normal"===(0,r.SU)(t)&&"medium"===(0,r.SU)(s)?"gray":"light","icon-name":"large"===(0,r.SU)(s)?"close_24":"error_12","icon-size":"large"===(0,r.SU)(s)?24:12},null,8,["class","circle","theme","icon-name","icon-size"]))}});var v=s(8163),f=s.n(v);const y={};y.$style=f();const b=(0,p.Z)(g,[["__cssModules",y]]);var w=s(21495);const k=(0,i.aZ)({__name:"pkb-modal-card-body",setup(e){const{theme:t,crossButton:s,closeLocked:l,close:c,title:d}=(0,a.D3)(n.gN),u=(0,i.Fl)((()=>!l.value&&s.value));return(e,s)=>((0,i.wg)(),(0,i.iD)("div",{class:(0,o.C_)([e.$style.host,{[e.$style[`host_${(0,r.SU)(t)}`]]:"normal"!==(0,r.SU)(t)}])},[e.$slots.header||(0,r.SU)(d)?((0,i.wg)(),(0,i.j4)(_,{key:0,class:(0,o.C_)([{[e.$style.header_withButton]:u.value}])},{default:(0,i.w5)((()=>[(0,i.WI)(e.$slots,"header")])),_:3},8,["class"])):(0,i.kq)("v-if",!0),u.value?((0,i.wg)(),(0,i.j4)(b,{key:1,onClick:s[0]||(s[0]=e=>(0,r.SU)(c)("cross-button"))})):(0,i.kq)("v-if",!0),e.$slots.content?(0,i.WI)(e.$slots,"content",{key:2}):((0,i.wg)(),(0,i.j4)(w.Z,{key:3},{default:(0,i.w5)((()=>[(0,i.WI)(e.$slots,"default")])),_:3})),e.$slots.footer?((0,i.wg)(),(0,i.iD)("footer",{key:4,class:(0,o.C_)(e.$style.footer)},[(0,i.WI)(e.$slots,"footer")],2)):(0,i.kq)("v-if",!0)],2))}});var S=s(1535),O=s.n(S);const E={};E.$style=O();const C=(0,p.Z)(k,[["__cssModules",E]])},21495:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var i=s(66252),o=s(3577),r=s(2262),n=s(66309);const a=(0,i.aZ)({__name:"pkb-modal-card-content",setup(e){const t=(0,r.iH)(),s=(0,r.iH)(0);return(0,n.yU7)(t,(()=>{s.value=t.value?t.value.offsetWidth-t.value.clientWidth:0})),(e,r)=>((0,i.wg)(),(0,i.iD)("div",{ref_key:"hostRef",ref:t,class:(0,o.C_)(e.$style.host),style:(0,o.j5)({"--modal-card-scrollbar-width":`${s.value}px`})},[(0,i.WI)(e.$slots,"default")],6))}});var l=s(96843),c=s.n(l),d=s(83744);const u={};u.$style=c();const p=(0,d.Z)(a,[["__cssModules",u]])},43544:(e,t,s)=>{"use strict";s.d(t,{Z:()=>h});var i=s(66252),o=s(3577),r=s(2262),n=s(59870),a=s(93356);const l=(0,i.aZ)({__name:"pkb-modal-card-title",setup(e){const{headerSize:t}=(0,a.D3)(n.gN);return(e,s)=>((0,i.wg)(),(0,i.iD)("h3",{class:(0,o.C_)([e.$style.host,e.$style[`host_${(0,r.SU)(t)}`]])},[(0,i.WI)(e.$slots,"default")],2))}});var c=s(21970),d=s.n(c),u=s(83744);const p={};p.$style=d();const h=(0,u.Z)(l,[["__cssModules",p]])},91181:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});s(41817);var i=s(66252),o=s(3577),r=s(37829),n=s(5707);function a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function l(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?a(Object(s),!0).forEach((function(t){c(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function c(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const d=(0,i.aZ)(l(l({},{inheritAttrs:!1}),{},{__name:"pkb-modal-card",props:{modelValue:{type:Boolean},title:{},theme:{},crossButton:{type:Boolean},closeLocked:{type:Boolean},centered:{type:Boolean},headerSize:{}},emits:["update:modelValue","close","transitionIn","transitionOut"],setup(e,{emit:t}){const s=e,a=t;return(e,t)=>((0,i.wg)(),(0,i.j4)(n.Z,{"model-value":s.modelValue,title:s.title,theme:s.theme,"cross-button":s.crossButton,"close-locked":s.closeLocked,centered:s.centered,"header-size":s.headerSize,onClose:t[0]||(t[0]=e=>a("close",e)),onTransitionIn:t[1]||(t[1]=e=>a("transitionIn")),onTransitionOut:t[2]||(t[2]=e=>a("transitionOut")),"onUpdate:modelValue":t[3]||(t[3]=e=>a("update:modelValue",e))},{default:(0,i.w5)((()=>[(0,i.Wm)(r.Z,(0,o.vs)((0,i.F4)(e.$attrs)),(0,i.Nv)({default:(0,i.w5)((()=>[(0,i.WI)(e.$slots,"default")])),_:2},[e.$slots.header?{name:"header",fn:(0,i.w5)((()=>[(0,i.WI)(e.$slots,"header")])),key:"0"}:void 0,e.$slots.footer?{name:"footer",fn:(0,i.w5)((()=>[(0,i.WI)(e.$slots,"footer")])),key:"1"}:void 0]),1040)])),_:3},8,["model-value","title","theme","cross-button","close-locked","centered","header-size"]))}}))},14949:(e,t,s)=>{"use strict";s.d(t,{Z:()=>O});s(88674),s(41817);var i=s(66252),o=s(49963),r=s(3577),n=s(2262),a=s(32881);const l=(0,i.aZ)({__name:"pkb-modal-page-body",props:{title:{}},setup(e){const t=e;return(e,s)=>((0,i.wg)(),(0,i.iD)("div",{class:(0,r.C_)(e.$style.host)},[t.title?((0,i.wg)(),(0,i.iD)("h3",{key:0,class:(0,r.C_)(e.$style.header)},(0,r.zw)(t.title),3)):(0,i.kq)("v-if",!0),(0,i._)("div",{class:(0,r.C_)(e.$style.content)},[(0,i.WI)(e.$slots,"default")],2),e.$slots.footer?((0,i.wg)(),(0,i.iD)("footer",{key:1,class:(0,r.C_)(e.$style.footer)},[(0,i.WI)(e.$slots,"footer")],2)):(0,i.kq)("v-if",!0)],2))}});var c=s(52773),d=s.n(c),u=s(83744);const p={};p.$style=d();const h=(0,u.Z)(l,[["__cssModules",p]]);var _=s(12665),m=s(66309),g=s(55529);function v(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function f(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?v(Object(s),!0).forEach((function(t){y(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):v(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function y(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const b=(0,i.aZ)(f(f({},{inheritAttrs:!1}),{},{__name:"pkb-modal-page",props:{modelValue:{type:Boolean},title:{}},emits:["update:modelValue","close"],setup(e,{emit:t}){const s=e,l=t,c=(0,n.iH)(),d=(0,n.iH)(),{distanceY:u,isSwiping:p}=(0,m.wYW)(c,{onSwipe(){d.value=v.value?`translateY(${v.value}px)`:null},async onSwipeEnd(e){d.value=null,v.value>.3*e.target.clientHeight&&(await(0,i.Y3)(),y())}}),v=(0,i.Fl)((()=>Math.max(-u.value,0))),f=(0,n.iH)(!1);function y(){l("update:modelValue",!1),l("close")}return(0,_.XW)(f),(e,t)=>((0,i.wg)(),(0,i.j4)(i.lR,{to:"body"},[(0,i.Wm)(o.uT,{"enter-from-class":e.$style.host_hidden,"leave-to-class":e.$style.host_hidden,onBeforeEnter:t[0]||(t[0]=e=>f.value=!0),onAfterLeave:t[1]||(t[1]=e=>f.value=!1)},{default:(0,i.w5)((()=>[s.modelValue?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,r.C_)(e.$style.host),style:(0,r.j5)({zIndex:(0,n.SU)(g.e)()})},[(0,i.Wm)(a.Z,{onClick:y}),(0,i.Wm)(h,(0,i.dG)({ref_key:"bodyEl",ref:c,class:e.$style.body,style:{transform:d.value,transition:(0,n.SU)(p)?"none":null}},e.$attrs,{title:s.title,"onClick:close":y}),(0,i.Nv)({default:(0,i.w5)((()=>[(0,i.WI)(e.$slots,"default")])),_:2},[e.$slots.footer?{name:"footer",fn:(0,i.w5)((()=>[(0,i.WI)(e.$slots,"footer")])),key:"0"}:void 0]),1040,["class","style","title"])],6)):(0,i.kq)("v-if",!0)])),_:3},8,["enter-from-class","leave-to-class"])]))}}));var w=s(70087),k=s.n(w);const S={};S.$style=k();const O=(0,u.Z)(b,[["__cssModules",S]])},37103:(e,t,s)=>{"use strict";s.d(t,{Z:()=>g});s(41817);var i=s(66252),o=s(3577),r=s(49963),n=s(37043),a=s(7284);function l(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function c(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?l(Object(s),!0).forEach((function(t){d(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function d(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const u=(0,i.aZ)(c(c({},{inheritAttrs:!1}),{},{__name:"pkb-more-btn",props:{icon:{},mainIcon:{default:void 0},theme:{default:"normal"},label:{default:void 0},size:{default:"medium"},wide:{type:Boolean,default:!1},loading:{type:Boolean},active:{type:Boolean},disabled:{type:Boolean},extraDisabled:{type:Boolean},extraHint:{default:void 0}},emits:["click:extra"],setup(e,{emit:t}){const s=e,l=t;return(e,t)=>{const c=(0,i.Q2)("tooltip");return(0,i.wg)(),(0,i.iD)("div",{class:(0,o.C_)(e.$style.host)},[(0,i.Wm)(n.Z,(0,i.dG)(e.$attrs,{class:e.$style.mainBtn,label:s.label,theme:s.theme,size:s.size,wide:s.wide,loading:s.loading,disabled:s.disabled,icon:s.mainIcon}),{default:(0,i.w5)((()=>[s.label||e.$slots.btn?(0,i.WI)(e.$slots,"btn",{key:0},(()=>[(0,i.Uk)((0,o.zw)(s.label),1)])):(0,i.kq)("v-if",!0)])),_:3},16,["class","label","theme","size","wide","loading","disabled","icon"]),(0,i.wy)((0,i.Wm)(a.Z,{class:(0,o.C_)(e.$style.extraBtn),icon:s.icon,theme:s.theme,size:s.size,disabled:s.extraDisabled,onClick:t[0]||(t[0]=(0,r.iM)((e=>l("click:extra")),["stop"]))},null,8,["class","icon","theme","size","disabled"]),[[c,s.extraHint]]),(0,i.WI)(e.$slots,"default")],2)}}}));var p=s(38490),h=s.n(p),_=s(83744);const m={};m.$style=h();const g=(0,_.Z)(u,[["__cssModules",m]])},32881:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var i=s(66252),o=s(3577);var r=s(38189),n=s.n(r),a=s(83744);const l={},c={};c.$style=n();const d=(0,a.Z)(l,[["render",function(e,t){return(0,i.wg)(),(0,i.iD)("div",{class:(0,o.C_)(e.$style.host)},null,2)}],["__cssModules",c]])},60581:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var i=s(66252),o=s(3577),r=s(92514);const n=["data-label"],a=(0,i.aZ)({__name:"pkb-progressbar",props:{value:{},max:{},mode:{default:"normal"},size:{default:"small"}},setup(e){const t=e,s=(0,i.Fl)((()=>"normal"===t.mode?t.value+" из "+t.max:(0,r.cw)(t.value,t.max))),a=(0,i.Fl)((()=>(0,r.cw)(t.value,t.max)));return(e,r)=>((0,i.wg)(),(0,i.iD)("div",{class:(0,o.C_)([e.$style.host,{[e.$style.host_small]:"small"===t.size,[e.$style.host_large]:"large"===t.size,[e.$style.host_completed]:t.value>=t.max}]),"data-label":s.value},[(0,i._)("div",{style:(0,o.j5)({width:a.value})},null,4)],10,n))}});var l=s(98851),c=s.n(l),d=s(83744);const u={};u.$style=c();const p=(0,d.Z)(a,[["__cssModules",u]])},22177:(e,t,s)=>{"use strict";s.d(t,{Z:()=>u});var i=s(66252),o=s(3577);const r=["checked","value","disabled"],n=(0,i.aZ)({__name:"pkb-radio",props:{modelValue:{},value:{},label:{},disabled:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const s=e,n=t,a=(0,i.Fl)((()=>s.modelValue===s.value));return(e,t)=>((0,i.wg)(),(0,i.iD)("label",{class:(0,o.C_)({[e.$style.host]:!0,[e.$style.host_disabled]:s.disabled})},[(0,i._)("input",{checked:a.value,value:s.value,class:(0,o.C_)(e.$style.input),type:"radio",disabled:s.disabled,onChange:t[0]||(t[0]=e=>n("update:modelValue",s.value))},null,42,r),(0,i._)("span",{class:(0,o.C_)(e.$style.icon)},null,2),e.$slots.default||s.label?((0,i.wg)(),(0,i.iD)("span",{key:0,class:(0,o.C_)(e.$style.label)},[(0,i.WI)(e.$slots,"default",{},(()=>[(0,i.Uk)((0,o.zw)(s.label),1)]))],2)):(0,i.kq)("v-if",!0)],2))}});var a=s(9887),l=s.n(a),c=s(83744);const d={};d.$style=l();const u=(0,c.Z)(n,[["__cssModules",d]])},53329:(e,t,s)=>{"use strict";s.d(t,{Z:()=>h});s(74916),s(15306),s(24603);var i=s(66252),o=s(3577),r=s(2262),n=s(49963);const a=["innerHTML"],l=(0,i.aZ)({__name:"pkb-search-item",props:{label:{},selection:{default:""},index:{default:void 0},itemsRefs:{default:void 0}},emits:["esc","enter","navigation:first","navigation:last"],setup(e,{expose:t,emit:s}){const l=e,c=s,d=(0,r.iH)(),u=(0,n.fb)(),p=(0,i.Fl)((()=>{return l.selection?(e=l.label,t=l.selection,e.replace(new RegExp(function(e){return e.replace(/[$()*+.?[\\\]^{|}]/g,"\\$&")}(t),"ig"),`<span class="${u.selection}">$&</span>`)):l.label;var e,t}));return t({focus:function(){var e;null===(e=d.value)||void 0===e||e.focus()}}),(e,t)=>((0,i.wg)(),(0,i.iD)("div",{ref_key:"hostEl",ref:d,tabindex:"0",class:(0,o.C_)((0,r.SU)(u).host),onKeydown:[t[0]||(t[0]=(0,n.D2)((0,n.iM)((e=>{var t;l.itemsRefs&&void 0!==l.index&&(0!==l.index?null===(t=l.itemsRefs[l.index-1])||void 0===t||t.focus():c("navigation:first"))}),["prevent"]),["up"])),t[1]||(t[1]=(0,n.D2)((0,n.iM)((e=>{var t;l.itemsRefs&&void 0!==l.index&&(l.index!==l.itemsRefs.length-1?null===(t=l.itemsRefs[l.index+1])||void 0===t||t.focus():c("navigation:last"))}),["prevent"]),["down"])),t[2]||(t[2]=(0,n.D2)((0,n.iM)((e=>c("esc")),["prevent"]),["esc"])),t[3]||(t[3]=(0,n.D2)((0,n.iM)((e=>c("enter")),["prevent"]),["enter"]))]},[e.$slots.prefix?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,o.C_)((0,r.SU)(u).prefix)},[(0,i.WI)(e.$slots,"prefix")],2)):(0,i.kq)("v-if",!0),l.selection?((0,i.wg)(),(0,i.iD)("span",{key:1,class:(0,o.C_)((0,r.SU)(u).label),innerHTML:p.value},null,10,a)):((0,i.wg)(),(0,i.iD)("span",{key:2,class:(0,o.C_)((0,r.SU)(u).label)},(0,o.zw)(l.label),3)),e.$slots.suffix?((0,i.wg)(),(0,i.iD)("div",{key:3,class:(0,o.C_)((0,r.SU)(u).suffix)},[(0,i.WI)(e.$slots,"suffix")],2)):(0,i.kq)("v-if",!0)],34))}});var c=s(98177),d=s.n(c),u=s(83744);const p={};p.$style=d();const h=(0,u.Z)(l,[["__cssModules",p]])},3485:(e,t,s)=>{"use strict";s.d(t,{Z:()=>h});var i=s(66252),o=s(3577),r=s(59870),n=s(93356),a=s(40094);const l=(0,i.aZ)({__name:"pkb-select-option",props:{value:{},label:{},disabled:{type:Boolean}},setup(e){const{selectOption:t,value:s}=(0,n.D3)(r.Eu),l=(0,i.Fl)((()=>s.value===c.value)),c=e;function d(){var e;t({value:c.value,label:null!==(e=c.label)&&void 0!==e?e:String(c.value)})}return l.value&&d(),(e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:(0,o.C_)({[e.$style.host]:!0,[e.$style.host_disabled]:e.disabled}),onClick:t[0]||(t[0]=e=>{c.disabled||d()})},[(0,i._)("span",{class:(0,o.C_)(e.$style.label)},(0,o.zw)(c.label),3),l.value?((0,i.wg)(),(0,i.j4)(a.Z,{key:0,name:"approve",class:(0,o.C_)(e.$style.icon)},null,8,["class"])):(0,i.kq)("v-if",!0)],2))}});var c=s(76961),d=s.n(c),u=s(83744);const p={};p.$style=d();const h=(0,u.Z)(l,[["__cssModules",p]])},47961:(e,t,s)=>{"use strict";s.d(t,{Z:()=>w});s(41817);var i=s(66252),o=s(3577),r=s(49963),n=s(50451),a=s(40094),l=s(2262),c=s(28959),d=s(66037),u=s(66309),p=s(59870);function h(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function _(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?h(Object(s),!0).forEach((function(t){m(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):h(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function m(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const g=(0,i.aZ)({__name:"pkb-select",props:{size:{default:"medium"},modelValue:{},label:{default:"Не выбрано"},error:{type:[String,Boolean],default:!1},errorDirection:{default:"top"},showErrorImmediately:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const s=e,h=t,m=(0,i.Fl)({get:()=>s.modelValue,set(e){h("update:modelValue",e)}}),g=(0,l.iH)(),v=(0,l.iH)(),f=(0,l.iH)(!1),y=(0,l.iH)(""),{floatingStyles:b}=(0,c.YF)(g,v,{whileElementsMounted:d.Me,middleware:[(0,d.RR)()]}),{width:w}=(0,u.h4X)(g,void 0,{box:"border-box"}),k=(0,i.Fl)((()=>_(_({},b.value),{},{width:w.value+"px"})));(0,u.i9H)(v,(()=>f.value=!1),{ignore:[g]}),(0,i.JJ)(p.Eu,{selectOption:e=>{y.value=e.label,m.value=e.value,f.value=!1},value:m});const S=e=>{"Enter"!==e.key&&" "!==e.key&&"Escape"!==e.key||(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),"Escape"===e.key?f.value=!1:f.value=!f.value)};return(e,t)=>((0,i.wg)(),(0,i.j4)(n.Z,{ref_key:"hostEl",ref:g,class:(0,o.C_)(e.$style.host),size:s.size,label:s.label,empty:!m.value,tabindex:"0",error:s.error,"error-direction":s.errorDirection,"show-error-immediately":s.showErrorImmediately,onClick:t[0]||(t[0]=e=>f.value=!f.value),onKeydown:S},{suffix:(0,i.w5)((()=>[(0,i.Wm)(a.Z,{name:"arrow_down_16",class:(0,o.C_)({[e.$style.icon]:!0,[e.$style.icon_active]:f.value}),size:20},null,8,["class"])])),default:(0,i.w5)((()=>[(0,i._)("span",{class:(0,o.C_)(e.$style.text)},(0,o.zw)(y.value),3),((0,i.wg)(),(0,i.j4)(i.lR,{to:"body"},[(0,i.wy)((0,i._)("div",{ref_key:"listBoxEl",ref:v,class:(0,o.C_)(e.$style.listBox),style:(0,o.j5)(k.value)},[(0,i.WI)(e.$slots,"default")],6),[[r.F8,f.value]])]))])),_:3},8,["class","size","label","empty","error","error-direction","show-error-immediately"]))}});var v=s(47387),f=s.n(v),y=s(83744);const b={};b.$style=f();const w=(0,y.Z)(g,[["__cssModules",b]])},82768:(e,t,s)=>{"use strict";s.d(t,{Z:()=>u});var i=s(66252),o=s(3577);const r=["src","alt","width","height"],n=(0,i.aZ)({__name:"pkb-series-avatar",props:{title:{},url:{default:""},size:{default:20},preview:{type:Boolean}},setup(e){const t=e;return(e,s)=>e.url?((0,i.wg)(),(0,i.iD)("img",{key:0,src:e.url,alt:t.title,width:t.size,height:t.size,loading:"lazy"},null,8,r)):((0,i.wg)(),(0,i.iD)("span",{key:1,class:(0,o.C_)(["sprite",`sprite--ui__series-thumb_${t.size}`,e.$style.default])},null,2))}});var a=s(63975),l=s.n(a),c=s(83744);const d={};d.$style=l();const u=(0,c.Z)(n,[["__cssModules",d]])},72189:(e,t,s)=>{"use strict";s.d(t,{Z:()=>u});var i=s(66252),o=s(3577),r=s(55331);const n=(0,i.aZ)({__name:"pkb-skeleton-ribs",props:{ribs:{}},setup(e){const t=e;return(e,s)=>((0,i.wg)(),(0,i.iD)("div",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.ribs,((t,s)=>((0,i.wg)(),(0,i.j4)(r.Z,{key:s,class:(0,o.C_)(e.$style.rib),width:t+"%",height:"8px"},null,8,["class","width"])))),128))]))}});var a=s(76280),l=s.n(a),c=s(83744);const d={};d.$style=l();const u=(0,c.Z)(n,[["__cssModules",d]])},55331:(e,t,s)=>{"use strict";s.d(t,{Z:()=>h});var i=s(66252),o=s(3577);const r={class:"skeleton skeleton_animated"};var n=s(83744);const a={},l=(0,n.Z)(a,[["render",function(e,t){return(0,i.wg)(),(0,i.iD)("div",r)}]]),c=(0,i.aZ)({__name:"pkb-skeleton",props:{width:{default:"100%"},height:{default:"100%"}},setup(e){const t=e;return(e,s)=>((0,i.wg)(),(0,i.j4)(l,{class:(0,o.C_)(e.$style.host),style:(0,o.j5)({width:t.width,height:t.height})},null,8,["class","style"]))}});var d=s(92685),u=s.n(d);const p={};p.$style=u();const h=(0,n.Z)(c,[["__cssModules",p]])},9771:(e,t,s)=>{"use strict";s.d(t,{Z:()=>v});var i=s(66252),o=s(3577),r=s(49963),n=s(2262),a=s(62728),l=s(40094),c=s(34828),d=s(66261),u=s(89661);const p=(0,i.aZ)({__name:"pkb-story-draft-preview",props:{id:{},loading:{type:Boolean},title:{},text:{},createdAt:{},createdInterval:{},titleClass:{},textClass:{},imgCount:{},videoCount:{},pollsCount:{},fundraisingWidgetsCount:{}},emits:["delete-click","delete","delete-abort"],setup(e,{emit:t}){const s=e,p=t,h=(0,n.iH)(!1),_=(0,i.Fl)((()=>{const e=s.fundraisingWidgetsCount>0?1:0;return s.imgCount+s.videoCount+s.pollsCount+e}));return(e,t)=>{const n=(0,i.Q2)("tooltip");return(0,i.wg)(),(0,i.iD)("div",{class:(0,o.C_)([e.$style.host,{[e.$style.host_loading]:s.loading}])},[s.loading?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,o.C_)(e.$style.loader)},[(0,i.Wm)(u.Z,{size:32,color:"gray"})],2)):(0,i.kq)("v-if",!0),(0,i._)("header",{class:(0,o.C_)(e.$style.header)},[(0,i._)("div",{class:(0,o.C_)([e.$style.title,s.titleClass])},[(0,i.Uk)((0,o.zw)(s.title)+" ",1),e.IS_MOBILE?((0,i.wg)(),(0,i.j4)(d.Z,{key:0,class:(0,o.C_)(e.$style.time),"edited-ts":s.createdAt},{default:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(s.createdInterval),1)])),_:1},8,["class","edited-ts"])):(0,i.kq)("v-if",!0)],2),(0,i._)("span",{class:(0,o.C_)(e.$style.time)},[e.IS_DESKTOP?((0,i.wg)(),(0,i.j4)(d.Z,{key:0,"edited-ts":s.createdAt},{default:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(s.createdInterval),1)])),_:1},8,["edited-ts"])):(0,i.kq)("v-if",!0)],2),(0,i.wy)((0,i.Wm)(a.Z,{"icon-name":"delete_16",class:(0,o.C_)(e.$style.deleteIcon),onClick:t[0]||(t[0]=(0,r.iM)((e=>(h.value=!0,void p("delete-click",s.id))),["stop"]))},null,8,["class"]),[[n,"Удалить черновик"]])],2),s.text?((0,i.wg)(),(0,i.iD)("p",{key:1,class:(0,o.C_)([e.$style.text,e.textClass])},(0,o.zw)(s.text),3)):(0,i.kq)("v-if",!0),s.imgCount>0||s.videoCount>0?((0,i.wg)(),(0,i.iD)("div",{key:2,class:(0,o.C_)(e.$style.media)},[s.imgCount>0?((0,i.wg)(),(0,i.iD)("span",{key:0,class:(0,o.C_)(e.$style.mediaItem)},[(0,i.Wm)(l.Z,{name:"photo_20"})],2)):(0,i.kq)("v-if",!0),s.videoCount>0?((0,i.wg)(),(0,i.iD)("span",{key:1,class:(0,o.C_)(e.$style.mediaItem)},[(0,i.Wm)(l.Z,{name:"play_20"})],2)):(0,i.kq)("v-if",!0),s.pollsCount>0?((0,i.wg)(),(0,i.iD)("span",{key:2,class:(0,o.C_)(e.$style.mediaItem)},[(0,i.Wm)(l.Z,{name:"poll_circle_20"})],2)):(0,i.kq)("v-if",!0),s.fundraisingWidgetsCount>0?((0,i.wg)(),(0,i.iD)("span",{key:3,class:(0,o.C_)(e.$style.mediaItem)},[(0,i.Wm)(l.Z,{name:"coin_circle_20"})],2)):(0,i.kq)("v-if",!0),(0,i.Uk)(" "+(0,o.zw)(_.value),1)],2)):(0,i.kq)("v-if",!0),(0,i.Wm)(c.Z,{active:h.value,"onUpdate:active":t[1]||(t[1]=e=>h.value=e),title:"Удалить черновик",content:"Вы действительно хотите удалить черновик поста?",onConfirm:t[2]||(t[2]=e=>p("delete",s.id)),onClose:t[3]||(t[3]=e=>p("delete-abort",s.id)),onCancel:t[4]||(t[4]=e=>p("delete-abort",s.id))},null,8,["active"])],2)}}});var h=s(28495),_=s.n(h),m=s(83744);const g={};g.$style=_();const v=(0,m.Z)(p,[["__cssModules",g]])},88511:(e,t,s)=>{"use strict";s.d(t,{Z:()=>$});s(88674),s(41817);var i=s(66252),o=s(3577),r=s(2262),n=s(37103),a=s(37043),l=s(15112),c=s(55946),d=s(48849),u=s(35653),p=s(91181),h=s(89661),_=s(12953),m=s(33662),g=s(33324),v=s(88358),f=s(41779),y=s(62895),b=s(81780),w=s(53201),k=(s(55529),s(71503));const S=["href"],O=["href"],E=["href"],C=(0,i.aZ)({__name:"pkb-subscribe-btn-menu",props:{type:{},id:{},isSubscribed:{type:Boolean,default:!1},name:{},avatar:{},isFullBan:{type:Boolean,default:!1},isIgnored:{type:Boolean,default:!1},isIgnoredComments:{type:Boolean,default:!1},isPessimized:{type:Boolean},analytics:{},actions:{},banReason:{},link:{default:""},showText:{type:Boolean,default:!0},showIcon:{type:Boolean,default:!1},wide:{type:Boolean,default:!1},size:{default:"small"},cssClass:{default:""},modelValue:{type:Boolean},menu:{type:Boolean}},emits:["update:modelValue","update:menu"],setup(e,{emit:t}){const s=e,n=t,a=(0,r.iH)(!1),u=(0,r.iH)(),p=(0,l.S)(),{sendEvent:C}=(0,c.z)(),x="BroadcastChannel"in window&&new BroadcastChannel(d.Y);async function T(e){if(p.processing[s.type][s.id])return;let t=s.type;if("user"===s.type&&(t="author"),C("ignore_popup_button_tapped",{"tag_id!empty":"tag"===t?s.id:null,"author_id!empty":"author"===t?s.id:null,"community_id!empty":"community"===t?s.id:null,"post_id!empty":"comstory"===t?s.id:null,type:t}),!_.core.isUserAuthorized)return _.core.ui.authRequired({analyticsParams:{reason:"ignore",author_id:s.id}}),"ignore"===e?C("click",{type:"author_posts_hide",author_id:s.id}):"ignore_comments"===e&&C("click",{type:"author_comments_hide",author_id:s.id}),void D();let i=(e="ignore.messages.success")=>_.core.ui.toasts.add({content:_.core.i18n(e)});try{switch(e){case"ignore":if("comstory"!==s.type)if(p.ignore[s.type][s.id]){a.value=!0;const e=await async function(){try{return await p.getIgnoreRules(s.type,s.id)}catch(e){return _.core.ui.toasts.showError(e),[]}}();if(!e.length)return;let t=e[0];await m.jj.removeRule(t),p.ignore[s.type][s.id]=!1,i();const o={event:d.H.IGNORE,type:s.type,id:s.id,value:p.ignore[s.type][s.id]};x&&x.postMessage(o),_.core.emit(m.AJ.STORIES)}else A();break;case"ignore_comments":if("user"===s.type){a.value=!0,p.ignoreComments[s.type][s.id]?(await m.jj.removeCommentsIgnore(s.id),p.ignoreComments[s.type][s.id]=!1):(await m.jj.addCommentsIgnore(s.id,M.value.type||"","user"),p.ignoreComments[s.type][s.id]=!0);const e={event:d.H.IGNORE_COMMENTS,type:s.type,id:s.id,value:p.ignoreComments[s.type][s.id]};x&&x.postMessage(e),_.core.emit(m.AJ.COMMENTS),i()}break;case"pessimize":if("comstory"===s.type){a.value=!0,p.pessimize[s.type][s.id]?(await(0,w.x)(Number(s.id),!1),p.pessimize[s.type][s.id]=!1,i()):(await(0,w.x)(Number(s.id),!0),p.pessimize[s.type][s.id]=!0,p.subscribe[s.type][s.id]&&await p.toggleSubscribe(s.type,s.id,M.value,!1),i("ignore.messages.comstory"));const e={event:d.H.PESSIMIZE,type:s.type,id:s.id,value:p.pessimize[s.type][s.id]};x&&x.postMessage(e)}break;case"complain":const e=await new g.n({destroyAfterHide:!0,targetId:s.id,authorId:s.id,targetType:"user",name:"UIComplainModalPopup"});_.core.emit("ignore-actions-complain"),e.show()}D()}catch(o){_.core.logger.error(o),_.core.ui.toasts.showError(o)}finally{a.value=!1}}function I(){"comstory"===s.type||p.ignore[s.type][s.id]||A()}let P;function A(){if(!u.value||"comstory"===s.type||p.ignore[s.type][s.id]||P&&!P.isDestroyed)return;let e;if("community"===s.type)e="communities";else if("user"===s.type)e="authors";else{if("tag"!==s.type)return;e="tags"}P=new v._({target:u.value,content:(0,f.Z)(),direction:v.Lh.RIGHT,alignment:v.SE.CENTER,destroyAfterHide:!0}),P.show(),new y.B({$el:P.$els.content,mode:e,item:s.id,popup:P}),_.core.listenTo(_.core,"hideQuickIgnore",(()=>{D()})),n("update:menu",!1),_.core.listenTo(P,b.e.HIDDEN,(()=>{n("update:menu",!0)})),_.core.listenToOnce(_.core.ui,"ignore",(e=>{if(e&&e.target===s.id&&e.type===s.type&&"comstory"!==s.type){p.ignore[s.type][s.id]=!0,D();const e={event:d.H.IGNORE,type:s.type,id:s.id,value:p.ignore[s.type][s.id]};x&&x.postMessage(e),p.subscribe[s.type][s.id]&&p.toggleSubscribe(s.type,s.id,M.value,!1),_.core.emit(m.AJ.STORIES)}}))}function D(){n("update:modelValue",!1)}const M=(0,i.Fl)((()=>s.analytics||{})),R=(0,i.Fl)((()=>{var e,t;return!(null===(e=s.actions)||void 0===e||!e.includes("complain"))||"user"===s.type&&(null===(t=_.core.initParams.reportReasons)||void 0===t?void 0:t.some((e=>3===e.type)))}));return(e,t)=>{var n,l,c,d,_,m;return a.value?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,o.C_)(e.$style.loadIgnore)},[(0,i.Wm)(h.Z,{size:24})],2)):((0,i.wg)(),(0,i.iD)("div",{key:1,class:(0,o.C_)(e.IS_DESKTOP?"menu menu_vertical menu_padding_none":"popup-menu popup-menu_nopadding")},[R.value?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,o.C_)(e.IS_DESKTOP?"menu__item":"popup-menu__item"),onClick:t[0]||(t[0]=e=>T("complain"))}," Пожаловаться ",2)):(0,i.kq)("v-if",!0),null!==(n=s.actions)&&void 0!==n&&n.includes("ignore")&&"comstory"!==s.type?((0,i.wg)(),(0,i.iD)("div",{key:1,ref_key:"ignoreMenuItem",ref:u,class:(0,o.C_)(e.IS_DESKTOP?"menu__item":"popup-menu__item"),onClick:t[1]||(t[1]=e=>T("ignore")),onMouseover:I},(0,o.zw)((0,r.SU)(p).ignore[s.type][s.id]?"Показывать посты":"Скрыть посты"),35)):(0,i.kq)("v-if",!0),null!==(l=s.actions)&&void 0!==l&&l.includes("pessimize")&&"comstory"===s.type?((0,i.wg)(),(0,i.iD)("div",{key:2,class:(0,o.C_)(e.IS_DESKTOP?"menu__item":"popup-menu__item"),onClick:t[2]||(t[2]=e=>T("pessimize"))},(0,o.zw)((0,r.SU)(p).pessimize[s.type][s.id]?"Показывать цепочку постов-ответов":"Игнорировать цепочку постов-ответов"),3)):(0,i.kq)("v-if",!0),null!==(c=s.actions)&&void 0!==c&&c.includes("ignore-comments")&&"user"===s.type&&e.$props.id!==String((0,r.SU)(k.tK))?((0,i.wg)(),(0,i.iD)("div",{key:3,class:(0,o.C_)(e.IS_DESKTOP?"menu__item":"popup-menu__item"),onClick:t[3]||(t[3]=e=>T("ignore_comments"))},(0,o.zw)((0,r.SU)(p).ignoreComments[s.type][s.id]?"Показывать комментарии":"Скрыть комментарии"),3)):(0,i.kq)("v-if",!0),null!==(d=s.actions)&&void 0!==d&&d.includes("settings")&&"community"===s.type?((0,i.wg)(),(0,i.iD)("a",{key:4,class:(0,o.C_)(e.IS_DESKTOP?"menu__item":"popup-menu__item"),href:"/community/"+s.link+"/settings"}," Настройки сообщества ",10,S)):(0,i.kq)("v-if",!0),null!==(_=s.actions)&&void 0!==_&&_.includes("settings-ban")&&"community"===s.type?((0,i.wg)(),(0,i.iD)("a",{key:5,class:(0,o.C_)(e.IS_DESKTOP?"menu__item":"popup-menu__item"),href:"/community/"+s.link+"/settings/ban-list"}," Настройки сообщества ",10,O)):(0,i.kq)("v-if",!0),null!==(m=s.actions)&&void 0!==m&&m.includes("ignore-list")&&"community"===s.type?((0,i.wg)(),(0,i.iD)("a",{key:6,class:(0,o.C_)(e.IS_DESKTOP?"menu__item":"popup-menu__item"),href:"/community/"+s.link+"/ban-list"}," Игнор-лист сообщества ",10,E)):(0,i.kq)("v-if",!0)],2))}}});var x=s(77936),T=s.n(x),I=s(83744);const P={};P.$style=T();const A=(0,I.Z)(C,[["__cssModules",P]]);function D(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function M(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?D(Object(s),!0).forEach((function(t){R(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):D(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function R(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const N=(0,i.aZ)({__name:"pkb-subscribe-btn",props:{type:{},id:{},isSubscribed:{type:Boolean,default:!1},name:{},avatar:{},isFullBan:{type:Boolean,default:!1},isIgnored:{type:Boolean,default:!1},isIgnoredComments:{type:Boolean,default:!1},isPessimized:{type:Boolean},analytics:{},actions:{},banReason:{},link:{},showText:{type:Boolean,default:!0},showIcon:{type:Boolean,default:!1},wide:{type:Boolean,default:!1},size:{default:"small"},cssClass:{default:""}},setup(e,{expose:t}){const s=e,h=(0,r.iH)(!1),m=(0,r.iH)(),g=(0,r.iH)(!0),v=(0,l.S)(),{sendEvent:f}=(0,c.z)(),y="BroadcastChannel"in window&&new BroadcastChannel(d.Y);async function b(e){if(h.value=!1,_.core.isUserAuthorized)try{v.toggleSubscribe(s.type,s.id,k.value,e)}catch(t){_.core.ui.toasts.showError(t)}else!function(){const e=M({reason:"follow"},k.value),t={data:{value:!0,analyticsParams:e}};"tag"===s.type?(f("click",M({type:"subscribe_tag",tag:s.id},e)),e.tag=s.id,t.action="subscribe_tag",t.data.tag=s.id):"user"===s.type?(f("click",M({type:"subscribe_author",author_id:s.id},e)),e.author_id=s.id,t.action="subscribe_author",t.data.id=s.id):"community"===s.type?(f("click",M({type:"subscribe_community",community_id:s.id},e)),e.community_id=s.id,t.action="subscribe_community",t.data.id=s.id):"comstory"===s.type&&(e.post_id=s.id,t.action="subscribe_comstory",t.data.id=s.id);_.core.ui.authRequired({analyticsParams:e,triggeredAction:t})}()}(0,i.bv)((()=>{v.addButton(s)})),y&&y.addEventListener("message",(e=>{const t=e.data;t.id===s.id&&t.type===s.type&&(t.event===d.H.SUBSCRIBE&&(v.subscribe[s.type][s.id]=t.value),t.event===d.H.IGNORE&&"comstory"!==s.type&&(v.ignore[s.type][s.id]=t.value),t.event===d.H.IGNORE_COMMENTS&&"user"===s.type&&(v.ignoreComments[s.type][s.id]=t.value),t.event===d.H.PESSIMIZE&&"comstory"===s.type&&(v.pessimize[s.type][s.id]=t.value))}));const w=(0,i.Fl)((()=>v.subscribe[s.type][s.id]||!1)),k=(0,i.Fl)((()=>s.analytics||{}));return(0,i.YP)(h,(()=>{_.core.ui.emit("subscribe-menu-open",h.value)})),_.core.ui.listenTo(_.core.ui,"close-extra-menu",(()=>{h.value=!1})),t({isMenusActive:(0,i.Fl)((()=>h.value))}),(e,t)=>{var l;return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",{ref_key:"mainBtn",ref:m,class:(0,o.C_)([e.$style.wrapper,{[e.$style.wrapper_wide]:s.wide},s.cssClass])},[null!==(l=s.actions)&&void 0!==l&&l.length?((0,i.wg)(),(0,i.j4)(n.Z,{key:0,size:s.size,wide:s.wide,label:s.showText?w.value?"Отписаться":"Подписаться":"",theme:w.value?"gray":"normal",loading:(0,r.SU)(v).processing[s.type][s.id],disabled:(0,r.SU)(v).processing[s.type][s.id],"extra-disabled":(0,r.SU)(v).processing[s.type][s.id],icon:"more_16","main-icon":s.showIcon?w.value?"rss-delete":"rss-add":void 0,onClick:t[0]||(t[0]=e=>b()),"onClick:extra":t[1]||(t[1]=e=>{h.value=!h.value})},null,8,["size","wide","label","theme","loading","disabled","extra-disabled","main-icon"])):((0,i.wg)(),(0,i.j4)(a.Z,{key:1,size:s.size,wide:s.wide,label:s.showText?w.value?"Отписаться":"Подписаться":"",theme:w.value?"gray":"normal",loading:(0,r.SU)(v).processing[s.type][s.id],disabled:(0,r.SU)(v).processing[s.type][s.id],icon:s.showIcon?w.value?"rss-delete":"rss-add":void 0,onClick:t[2]||(t[2]=e=>b())},null,8,["size","wide","label","theme","loading","disabled","icon"]))],2),((0,i.wg)(),(0,i.j4)((0,i.LL)(e.IS_DESKTOP?u.Z:p.Z),{active:h.value,"onUpdate:active":t[6]||(t[6]=e=>h.value=e),modelValue:h.value,"onUpdate:modelValue":t[7]||(t[7]=e=>h.value=e),for:m.value,direction:"bottom",alignment:"end","target-alignment":"end","show-arrow":!1,"close-on-click-outside":g.value},{default:(0,i.w5)((()=>[(0,i.Wm)(A,(0,i.dG)(s,{modelValue:h.value,"onUpdate:modelValue":t[3]||(t[3]=e=>h.value=e),menu:g.value,"onUpdate:menu":t[4]||(t[4]=e=>g.value=e)}),null,16,["modelValue","menu"]),e.IS_MOBILE?((0,i.wg)(),(0,i.j4)(a.Z,{key:0,wide:"",size:"medium",theme:"gray",onClick:t[5]||(t[5]=e=>h.value=!1)},{default:(0,i.w5)((()=>[(0,i.Uk)(" Закрыть ")])),_:1})):(0,i.kq)("v-if",!0)])),_:1},40,["active","modelValue","for","close-on-click-outside"]))],64)}}});var B=s(1167),L=s.n(B);const j={};j.$style=L();const $=(0,I.Z)(N,[["__cssModules",j]])},69023:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var i=s(66252),o=s(3577),r=s(49963);const n=["tabindex"],a=(0,i.aZ)({__name:"pkb-switch",props:{modelValue:{type:Boolean},label:{default:""},disabled:{type:Boolean},size:{default:"medium"},labelSize:{default:"medium"},revertLabel:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:t}){const s=e,a=t,l=(0,i.Fl)({get:()=>Boolean(s.modelValue),set(e){a("update:modelValue",e)}});return(e,t)=>((0,i.wg)(),(0,i.iD)("label",{class:(0,o.C_)([e.$style.host,{[e.$style.host_disabled]:s.disabled,[e.$style.host_large]:"large"===s.size,[e.$style.host_largelabel]:"large"===s.labelSize,[e.$style.host_revert]:s.revertLabel}]),tabindex:s.disabled?-1:0},[(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>l.value=e),type:"checkbox",class:(0,o.C_)(e.$style.checkbox)},null,2),[[r.e8,l.value]]),(0,i._)("span",{class:(0,o.C_)(e.$style.switch)},null,2),e.$slots.default?(0,i.WI)(e.$slots,"default",{key:0}):s.label?((0,i.wg)(),(0,i.iD)("span",{key:1,class:(0,o.C_)(e.$style.label)},(0,o.zw)(s.label),3)):(0,i.kq)("v-if",!0)],10,n))}});var l=s(92929),c=s.n(l),d=s(83744);const u={};u.$style=c();const p=(0,d.Z)(a,[["__cssModules",u]])},24482:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var i=s(66252),o=s(49963),r=s(2262),n=s(59870),a=s(93356);const l=(0,i.aZ)({__name:"pkb-tab-panel",props:{name:{}},setup(e){const t=e,{tab:s}=(0,a.D3)(n.BP);return(e,n)=>(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",null,[(0,i.WI)(e.$slots,"default")],512)),[[o.F8,t.name===(0,r.SU)(s)]])}})},70197:(e,t,s)=>{"use strict";s.d(t,{Z:()=>h});var i=s(66252),o=s(3577),r=s(49963),n=s(2262),a=s(59870);const l=(0,i.aZ)({__name:"pkb-tab-panels",props:{tab:{}},setup(e){const t=e,s=(0,i.Fl)((()=>t.tab)),l=(0,n.iH)();function c(e){l.value=`${e.clientHeight}px`}function d(){l.value=void 0}return(0,i.JJ)(a.BP,{tab:(0,n.OT)(s)}),(e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:(0,o.C_)(e.$style.host),style:(0,o.j5)({height:l.value})},[(0,i.Wm)(r.W3,{"enter-from-class":e.$style.transition_hidden,"leave-to-class":e.$style.transition_hidden,"enter-active-class":e.$style.transition_active,"leave-active-class":e.$style.transition_active,onBeforeLeave:c,onEnter:c,onAfterEnter:d},{default:(0,i.w5)((()=>[(0,i.WI)(e.$slots,"default")])),_:3},8,["enter-from-class","leave-to-class","enter-active-class","leave-active-class"])],6))}});var c=s(13384),d=s.n(c),u=s(83744);const p={};p.$style=d();const h=(0,u.Z)(l,[["__cssModules",p]])},48090:(e,t,s)=>{"use strict";s.d(t,{Z:()=>g});var i=s(66252),o=s(3577),r=s(2262),n=s(12665),a=s(66309),l=s(55529),c=s(40094);const d=16,u=(0,i.aZ)({__name:"pkb-tooltip-base",props:{x:{},y:{},targetHeight:{default:0},alignment:{default:"center"},direction:{default:"top"},theme:{default:"normal"},cardClass:{default:void 0},showArrow:{type:Boolean,default:!0}},setup(e){const t=e,s=t.showArrow?6:0,u=t.showArrow?8:0,p=2*u+16,h=d+u+s,_=(0,r.iH)(),m=(0,r.iH)(),{width:g,height:v}=(0,n.XL)(m),{width:f}=(0,a.iPe)(),y=(0,i.Fl)((()=>t.x<h?"right":t.x>f.value-h?"left":t.direction)),b=(0,i.Fl)((()=>"bottom"===y.value?`translate(${~~t.x}px, calc(${~~t.y+t.targetHeight}px + var(--offset-y, 0px)))`:`translate(${~~t.x}px, calc(${~~t.y}px + var(--offset-y, 0px)))`)),w=(0,i.Fl)((()=>{if(!g.value&&!v.value)return;let e=0,i=0;switch(y.value){case"top":case"bottom":switch(t.alignment){case"start":e=u+s;break;case"end":e=g.value-u-s;break;default:e=g.value/2}e=Math.min(e,t.x-d),e=Math.max(e,g.value-(f.value-t.x-d)),e*=-1;break;case"left":e=-(g.value+s);break;case"right":e=s}switch(y.value){case"top":i=-(v.value+s);break;case"bottom":i=s;break;case"left":case"right":switch(t.alignment){case"start":i=u+s;break;case"end":i=v.value-u-s;break;default:i=v.value/2}i=Math.min(i,t.y),i*=-1}return`translate(${~~e}px, ${~~i}px)`})),k=(0,i.Fl)((()=>{switch(y.value){case"left":return~~(t.x-s-d)+"px";case"right":return~~(f.value-t.x-s-d)+"px";default:return~~(f.value-32)+"px"}}));return(e,s)=>((0,i.wg)(),(0,i.iD)("div",{ref_key:"hostEl",ref:_,class:(0,o.C_)({[e.$style.host]:!0,[e.$style[`host_${y.value}`]]:!0,[e.$style[`host_${t.theme}`]]:"normal"!==t.theme}),style:(0,o.j5)({transform:b.value,zIndex:(0,r.SU)(l.e)()})},[(0,i._)("div",{ref_key:"cardEl",ref:m,class:(0,o.C_)([e.$style.card,t.cardClass]),style:(0,o.j5)({visibility:w.value?"visible":"hidden",transform:w.value,maxWidth:k.value,"--min-card-size":`${p}px`})},[(0,i.WI)(e.$slots,"default")],6),t.showArrow?((0,i.wg)(),(0,i.j4)(c.Z,{key:0,class:(0,o.C_)([e.$style.arrow,e.$style["arrow_"+y.value]]),name:"tooltip-arrow",width:"18",height:"7"},null,8,["class"])):(0,i.kq)("v-if",!0)],6))}});var p=s(70989),h=s.n(p),_=s(83744);const m={};m.$style=h();const g=(0,_.Z)(u,[["__cssModules",m]])},35653:(e,t,s)=>{"use strict";s.d(t,{Z:()=>f});s(41817);var i=s(66252),o=s(49963),r=s(3577),n=s(48090),a=s(12665),l=s(66309),c=s(2262);function d(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function u(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?d(Object(s),!0).forEach((function(t){p(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function p(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const h=(0,i.aZ)(u(u({},{inheritAttrs:!1}),{},{__name:"pkb-tooltip",props:{active:{type:Boolean},for:{},alignment:{default:"center"},direction:{default:"bottom"},theme:{default:"normal"},wrapperClass:{default:void 0},container:{default:"body"},closeOnClickOutside:{type:Boolean,default:!0},withAnimation:{type:Boolean,default:!0},showArrow:{type:Boolean,default:!0},targetAlignment:{default:"center"}},emits:["update:active"],setup(e,{expose:t,emit:s}){const d=e,u=s,p=(0,c.iH)(),h=(0,c.iH)();(0,l.S1d)(h,(e=>{e.forEach((e=>{e.isIntersecting||u("update:active",!1)}))}));const _=(0,i.Fl)((()=>d.active?d.for:void 0)),m=(0,a.XL)(_,{absolute:!0});(0,i.YP)(_,(()=>{_.value&&m.update()})),(0,l.i9H)(p,(()=>{d.closeOnClickOutside&&u("update:active",!1)}),{ignore:[_]});const g=(0,i.Fl)((()=>{var e;if(!d.active)return;const t=null===(e=(0,l.NXq)(p))||void 0===e?void 0:e.offsetParent;return t&&t!==document.body?t:void 0})),v=(0,a.XL)(g,{absolute:!0}),f=(0,i.Fl)((()=>{switch(d.direction){case"left":return m.x.value-v.x.value;case"right":return m.x.value+m.width.value-v.x.value;default:let e=0;return"end"===d.targetAlignment?e=m.width.value:"center"===d.targetAlignment&&(e=m.width.value/2),m.x.value+e-v.x.value}})),y=(0,i.Fl)((()=>{switch(d.direction){case"top":return m.y.value-v.y.value;case"bottom":return m.y.value+m.height.value-v.y.value;default:let e=0;return"end"===d.targetAlignment?e=m.height.value:"center"===d.targetAlignment&&(e=m.height.value/2),m.y.value+e-v.y.value}}));return t({updatePosition:m.update}),(e,t)=>((0,i.wg)(),(0,i.j4)(i.lR,{to:d.container},[(0,i.Wm)(o.uT,{appear:"",name:e.withAnimation?e.$style.animate:void 0},{default:(0,i.w5)((()=>[d.active?((0,i.wg)(),(0,i.j4)(n.Z,{key:0,ref_key:"tooltipEl",ref:p,alignment:d.alignment,direction:d.direction,theme:d.theme,class:(0,r.C_)(d.wrapperClass),x:f.value,y:y.value,"show-arrow":d.showArrow},{default:(0,i.w5)((()=>[(0,i._)("div",(0,i.dG)(e.$attrs,{ref_key:"contentEl",ref:h}),[(0,i.WI)(e.$slots,"default")],16)])),_:3},8,["alignment","direction","theme","class","x","y","show-arrow"])):(0,i.kq)("v-if",!0)])),_:3},8,["name"])],8,["to"]))}}));var _=s(37148),m=s.n(_),g=s(83744);const v={};v.$style=m();const f=(0,g.Z)(h,[["__cssModules",v]])},20252:(e,t,s)=>{"use strict";s.d(t,{Z:()=>m});var i=s(66252),o=s(2262),r=s(3577),n=s(40094),a=s(71503);const l=["src","width","height"],c="https://cs.pikabu.ru/images/def_avatar/def_avatar_80.png",d=(0,i.aZ)({__name:"pkb-user-avatar",props:{url:{default:c},size:{}},setup(e){const t=e;return(e,s)=>t.url===(0,o.SU)(a.j$)?((0,i.wg)(),(0,i.j4)(n.Z,{key:0,name:"group-avatar",size:t.size,class:(0,r.C_)(e.$style.group)},null,8,["size","class"])):((0,i.wg)(),(0,i.iD)("img",{key:1,class:(0,r.C_)(e.$style.host),src:t.url||c,width:t.size,height:t.size,alt:""},null,10,l))}});var u=s(24158),p=s.n(u),h=s(83744);const _={};_.$style=p();const m=(0,h.Z)(d,[["__cssModules",_]])},63363:(e,t,s)=>{"use strict";s.d(t,{Z:()=>M});s(41817);var i=s(66252),o=s(2262),r=s(3577),n=s(28959),a=s(66037),l=s(85983),c=s(89661),d=s(75645),u=s(66309),p=s(41218),h=s(44813),_=s(93356),m=s(88511),g=s(40094);const v=["href"],f=["innerHTML"],y=(0,i.aZ)({__name:"info-view",props:{name:{},link:{},description:{},locked:{type:Boolean}},setup(e){const t=e;return(e,s)=>((0,i.wg)(),(0,i.iD)("figcaption",{class:(0,r.C_)(e.$style.host)},[(0,i._)("h2",{class:(0,r.C_)(e.$style.name)},[(0,i._)("a",{href:t.link},(0,r.zw)(t.name),9,v),t.locked?((0,i.wg)(),(0,i.j4)(g.Z,{key:0,name:"ic_lock",class:(0,r.C_)(e.$style.lockIcon),size:16},null,8,["class"])):(0,i.kq)("v-if",!0)],2),t.description?((0,i.wg)(),(0,i.iD)("p",{key:0,class:(0,r.C_)(e.$style.description),innerHTML:t.description},null,10,f)):(0,i.kq)("v-if",!0)],2))}});var b=s(53617),w=s.n(b),k=s(83744);const S={};S.$style=w();const O=(0,k.Z)(y,[["__cssModules",S]]);var E=s(55946);const C=(0,s(69876).Q_)("CommunityMiniProfileStore",{state:()=>({community:void 0,communityId:0}),actions:{getCommunityLink(){return this.community?"/community/"+this.community.linkName:""},getCommunityLinkName(){return this.community?this.community.linkName:""}}});var x=s(96637);const T=["src"],I=(0,i.aZ)({__name:"community-info-tooltip",props:{for:{},active:{type:Boolean},communityId:{}},emits:["destroy"],setup(e,{emit:t}){const s=e,g=t,{sendEvent:v}=(0,E.z)(),f=C(),y=(0,o.iH)(),b=(0,o.iH)(),w=(0,o.iH)(),{isOutside:k}=(0,u.jYR)(y),S=(0,p.VW)((0,i.Fl)((()=>{var e;return Boolean(!k.value||s.active||(null===(e=w.value)||void 0===e?void 0:e.isMenusActive))})),500),I=(0,i.Fl)((()=>s.for));(0,i.bv)((()=>{f.communityId=s.communityId})),(0,i.YP)(S,(e=>{e&&v("form_show",{type:"community_profile_mini_post",community_id:s.communityId})}));const P=(0,i.Fl)((()=>h.aw.info({id:s.communityId}))),{data:A}=(0,h.Z)({queryKey:P,enabled:S});(0,i.YP)(A,(e=>{e&&(f.community=e)}));const{floatingStyles:D,middlewareData:M,placement:R}=(0,n.YF)(I,y,{whileElementsMounted:a.Me,middleware:[(0,a.RR)(),(0,l.cv)(8),(0,n.x7)({element:b})],placement:"top",strategy:"fixed",transform:!1}),N=(0,i.Fl)((()=>{var e,t,s,i;const o={top:"bottom",right:"left",bottom:"top",left:"right"}[R.value.split("-")[0]];return{position:"absolute",left:void 0!==(null===(e=M.value.arrow)||void 0===e?void 0:e.x)?`${null===(t=M.value.arrow)||void 0===t?void 0:t.x}px`:"",top:void 0!==(null===(s=M.value.arrow)||void 0===s?void 0:s.y)?`${(null===(i=M.value.arrow)||void 0===i?void 0:i.y)||0}px`:"",[o||"bottom"]:"-4px"}}));return(0,i.wF)((()=>{_.Eh.invalidateQueries({queryKey:P})})),(e,t)=>((0,i.wg)(),(0,i.j4)(i.lR,{to:"body"},[(0,i.Wm)(d.Z,{onAfterLeave:t[0]||(t[0]=e=>g("destroy"))},{default:(0,i.w5)((()=>[(0,o.SU)(S)?((0,i.wg)(),(0,i.iD)("div",{key:0,ref_key:"hintEl",ref:y,class:(0,r.C_)(e.$style.host),style:(0,r.j5)((0,o.SU)(D))},[(0,o.SU)(A)?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[(0,i._)("figure",{class:(0,r.C_)(e.$style.body)},[(0,i._)("img",{class:(0,r.C_)(e.$style.img),src:(0,o.SU)(A).avatar},null,10,T),(0,i.Wm)(O,{name:(0,o.SU)(A).name,link:(0,o.SU)(f).getCommunityLink(),description:(0,o.SU)(A).description,locked:(0,o.SU)(A).isHidden},null,8,["name","link","description","locked"])],2),(0,i._)("div",{class:(0,r.C_)(e.$style.subscribe)},[(0,i.Wm)(m.Z,{id:String(s.communityId),ref_key:"subscribeBtnRef",ref:w,type:"community",wide:"",link:(0,o.SU)(f).getCommunityLinkName(),"is-subscribed":(0,o.SU)(A).isSubscribed,analytics:{type:"from_post_mini"},actions:["ignore","ignore-list"]},null,8,["id","link","is-subscribed"])],2),(0,i._)("footer",{class:(0,r.C_)(e.$style.footer)},[(0,i._)("span",null,[(0,i._)("strong",null,(0,r.zw)((0,o.SU)(A).subsCount),1),(0,i.Uk)(" "+(0,r.zw)((0,o.SU)(x.Utils).pluralNounRU((0,o.SU)(A).subsCount,["подписчик","подписчика","подписчиков"])),1)]),(0,i._)("span",null,[(0,i._)("strong",null,(0,r.zw)((0,o.SU)(A).storiesCount),1),(0,i.Uk)(" "+(0,r.zw)((0,o.SU)(x.Utils).pluralNounRU((0,o.SU)(A).storiesCount,["пост","поста","постов"])),1)])],2)],64)):((0,i.wg)(),(0,i.iD)("div",{key:1,class:(0,r.C_)(e.$style.loader)},[(0,i.Wm)(c.Z,{size:32})],2)),(0,i._)("span",{ref_key:"arrowEl",ref:b,class:(0,r.C_)(e.$style.arrow),style:(0,r.j5)(N.value)},null,6)],6)):(0,i.kq)("v-if",!0)])),_:1})]))}});var P=s(68711),A=s.n(P);const D={};D.$style=A();const M=(0,k.Z)(I,[["__cssModules",D]])},78699:(e,t,s)=>{"use strict";s.d(t,{Z:()=>b});s(41817);var i=s(66252),o=s(49963),r=s(3577),n=s(2262),a=s(44813),l=s(40094),c=s(55946),d=s(96637);function u(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function p(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?u(Object(s),!0).forEach((function(t){h(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):u(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function h(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const _=["href"],m=(0,i.aZ)({__name:"feedback-offer",props:{text:{}},emits:["close"],setup(e,{emit:t}){const s=e,u=t,{sendEvent:h}=(0,c.z)(),m=(0,n.iH)(!1),g=(0,i.Fl)((()=>a.uj.findMentionsInText({text:s.text}))),{data:v}=(0,a.JY)({queryKey:g,enabled:(0,i.Fl)((()=>!m.value&&s.text.length>0))}),f=(0,i.Fl)((()=>{var e;return d.Utils.formatList(null===(e=v.value)||void 0===e?void 0:e.map((e=>e.name)))})),y=(0,i.Fl)((()=>{var e;return null===(e=v.value)||void 0===e?void 0:e.map((e=>[{type:"feedback-form",url:e.url,name:"Форма обратной связи "+e.name,icon:"new-tab_16"},p(p({type:"website"},e.website),{},{icon:"new-tab_16"}),p(p({type:"tg"},e.tg),{},{icon:"telegram-logo_16"}),p(p({type:"vk"},e.vk),{},{icon:"vkontakte-logo_16"})].filter((e=>Boolean(e.url)))))})),b=(0,i.Fl)((()=>{var e,t;return null!==(e=null===(t=v.value)||void 0===t?void 0:t.length)&&void 0!==e?e:0})),w=(0,i.Fl)((()=>!m.value&&b.value));function k(e){0!==e.button&&1!==e.button||h("click",{type:"company_feedback_link"})}return(0,i.YP)(w,(e=>{e&&h("show_company_feedback_link",{})})),(e,t)=>((0,i.wg)(),(0,i.j4)(o.uT,{name:e.$style.host},{default:(0,i.w5)((()=>[w.value?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,r.C_)(e.$style.host)},[(0,i._)("div",{class:(0,r.C_)(e.$style.inform)},[(0,i._)("span",null,[(0,i.Uk)(" Информируем, что на Пикабу есть "),b.value>2?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[(0,i.Uk)(" официальные представители поддержки компаний ")],64)):((0,i.wg)(),(0,i.iD)(i.HY,{key:1},[(0,i.Uk)(" официальный представитель поддержки компании ")],64)),(0,i.Uk)(" "+(0,r.zw)(f.value)+", вы можете обратиться напрямую: ",1)]),(0,i.Wm)(l.Z,{name:"close_16",class:(0,r.C_)(e.$style.icon),size:16,onClick:t[0]||(t[0]=e=>(u("close"),void(m.value=!0)))},null,8,["class"])],2),(0,i._)("ul",{class:(0,r.C_)(e.$style.list)},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(y.value,((s,o)=>((0,i.wg)(),(0,i.iD)("li",{key:o,class:(0,r.C_)(e.$style.links)},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s,(s=>((0,i.wg)(),(0,i.iD)("a",{key:s.type,target:"_blank",href:s.url,class:(0,r.C_)(e.$style.link),onClick:t[1]||(t[1]=e=>k(e)),onAuxclick:t[2]||(t[2]=e=>k(e))},[(0,i.Wm)(l.Z,{name:s.icon,class:(0,r.C_)(e.$style.link__icon)},null,8,["name","class"]),(0,i._)("span",null,(0,r.zw)(s.name),1)],42,_)))),128))],2)))),128))],2)],2)):(0,i.kq)("v-if",!0)])),_:1},8,["name"]))}});var g=s(28696),v=s.n(g),f=s(83744);const y={};y.$style=v();const b=(0,f.Z)(m,[["__cssModules",y]])},29333:(e,t,s)=>{"use strict";s.d(t,{Z:()=>v});s(74916);var i=s(66252),o=s(2262),r=s(3577),n=s(49963),a=s(66309),l=s(48090),c=s(50542),d=s(37043),u=s(12665);const p=(0,i.aZ)({__name:"link-tooltip",props:{active:{type:Boolean},editor:{}},emits:["update:active"],setup(e,{emit:t}){const s=e,p=t,h=(0,u.ob)((0,i.Fl)((()=>s.editor))),_=(0,o.iH)(""),m=(0,o.iH)(),g=(0,o.iH)(),v=(0,o.iH)(0),f=/^https?:\/\//i,y=/^mailto:/i,b=/^(https?:\/\/|mailto:)?([a-zа-яё0-9._@-]+\.(?:[a-z0-9-]+|рф)(?::\d+)?)([\/?#].*)?$/i,w=(0,i.Fl)((()=>b.test(_.value)));let k;function S(e){""!==e&&w.value?s.editor.chain().focus().extendMarkRange("link").setLink({href:f.test(e)||y.test(e)?e:e.includes("@")?`mailto:${e}`:`https://${e}`}).run():s.editor.chain().focus().extendMarkRange("link").unsetLink().run(),E()}function O(){if(!s.editor.getAttributes("link").href){const e=h.value.from;s.editor.chain().focus(v.value).extendMarkRange("link").unsetLink().run(),s.editor.chain().focus(e).run()}E()}function E(){p("update:active",!1),_.value=""}function C(e){try{return decodeURIComponent(e)}catch(t){return e}}return(0,i.YP)((()=>s.active),(e=>{var t;e?(!function(){v.value=h.value.from,s.editor.commands.extendMarkRange("link");const e=s.editor.getAttributes("link").href;e||s.editor.commands.setLink();_.value=null!=e?e:""}(),setTimeout((()=>k=(0,a.i9H)(g,O)))):(null===(t=k)||void 0===t||t(),k=void 0)})),(0,u.R8)(m,{onMounted:()=>m.value.focus()}),(e,t)=>((0,i.wg)(),(0,i.j4)(i.lR,{to:"body"},[s.active?((0,i.wg)(),(0,i.j4)(l.Z,{key:0,ref_key:"tooltipEl",ref:g,direction:"top",x:(0,o.SU)(h).x+(0,o.SU)(h).width/2,y:(0,o.SU)(h).y-4},{default:(0,i.w5)((()=>[(0,i._)("div",{class:(0,r.C_)(e.$style.content)},[(0,i.Wm)(c.Z,{ref_key:"inputEl",ref:m,modelValue:_.value,"onUpdate:modelValue":t[0]||(t[0]=e=>_.value=e),label:"Добавьте ссылку",clean:C,onKeydown:t[1]||(t[1]=(0,n.D2)((0,n.iM)((e=>S(_.value)),["prevent"]),["enter"]))},null,8,["modelValue"]),(0,i.Wm)(d.Z,{icon:"checkmark_16",disabled:!w.value,onClick:t[2]||(t[2]=e=>S(_.value))},null,8,["disabled"]),(0,i.Wm)(d.Z,{icon:"close_16",theme:"gray",onClick:t[3]||(t[3]=e=>S(""))})],2)])),_:1},8,["x","y"])):(0,i.kq)("v-if",!0)]))}});var h=s(41693),_=s.n(h),m=s(83744);const g={};g.$style=_();const v=(0,m.Z)(p,[["__cssModules",g]])},22521:(e,t,s)=>{"use strict";s.d(t,{Z:()=>$});s(41817);var i=s(66252),o=s(2262),r=s(41218),n=s(544),a=s(70273),l=s(12665),c=(s(85827),s(66992),s(33948),s(3577)),d=s(49963),u=s(66309),p=s(48090),h=s(40094),_=s(15067),m=s(55063),g=s(9855),v=s(61445),f=s(54407),y=s(12953);const b=["data-test","disabled","onClick"],w=(0,i.aZ)({__name:"formatting-tools-view",props:{modelValue:{type:Boolean},editor:{},selectionX:{},selectionY:{},selectionWidth:{},selectionHeight:{},extensions:{}},emits:["update:value"],setup(e,{emit:t}){const s=e,r=t,n=(0,i.Fl)({get:()=>s.modelValue,set(e){r("update:value",e)}}),a={[_.Z.name]:{icon:"bold_16",isDisabled:()=>{var e,t,i;return!(null!==(e=s.editor)&&void 0!==e&&null!==(t=(i=e.can()).toggleBold)&&void 0!==t&&t.call(i))},isActive:()=>{var e;return null===(e=s.editor)||void 0===e?void 0:e.isActive("bold")},handleClick:()=>{var e;null===(e=s.editor)||void 0===e||e.chain().toggleBold().focus().run()}},[m.Z.name]:{icon:"italic_16",isDisabled:()=>{var e,t,i;return!(null!==(e=s.editor)&&void 0!==e&&null!==(t=(i=e.can()).toggleItalic)&&void 0!==t&&t.call(i))},isActive:()=>{var e;return null===(e=s.editor)||void 0===e?void 0:e.isActive("italic")},handleClick:()=>{var e;null===(e=s.editor)||void 0===e||e.chain().toggleItalic().focus().run()}},[g.Z.name]:{icon:"strikethrough_16",isDisabled:()=>{var e,t,i;return!(null!==(e=s.editor)&&void 0!==e&&null!==(t=(i=e.can()).toggleStrike)&&void 0!==t&&t.call(i))},isActive:()=>{var e;return null===(e=s.editor)||void 0===e?void 0:e.isActive("strike")},handleClick:()=>{var e;null===(e=s.editor)||void 0===e||e.chain().toggleStrike().focus().run()}},[v.Z.name]:{icon:"link_16",isDisabled:()=>{var e,t,i;return!(null!==(e=s.editor)&&void 0!==e&&null!==(t=(i=e.can()).setLink)&&void 0!==t&&t.call(i))},isActive:()=>{var e;return null===(e=s.editor)||void 0===e?void 0:e.isActive("link")},handleClick:()=>{var e;w.value=!1,null===(e=s.editor)||void 0===e||e.commands.inputLink()}},[f.Z.name]:{icon:"quote_16",isDisabled:()=>{var e,t,i;return!(null!==(e=s.editor)&&void 0!==e&&null!==(t=(i=e.can()).toggleBlockquote)&&void 0!==t&&t.call(i))},isActive:()=>{var e;return null===(e=s.editor)||void 0===e?void 0:e.isActive("blockquote")},handleClick:()=>{var e;null===(e=s.editor)||void 0===e||e.chain().toggleBlockquote().focus().run()}}},l=(0,o.iH)(),w=(0,o.iH)(!1),k=(0,i.Fl)((()=>s.selectionX+s.selectionWidth/2)),S=(0,i.Fl)((()=>y.core.ua.android?s.selectionY+s.selectionHeight+4:s.selectionY-4));(0,u.i9H)(l,(()=>{w.value=!1}));const O=(0,i.Fl)((()=>Object.entries(a).reduce(((e,[t,i])=>(s.extensions.some((e=>e.name===t))&&e.push(i),e)),[])));return(e,t)=>((0,i.wg)(),(0,i.j4)(i.lR,{to:"body"},[n.value||w.value?((0,i.wg)(),(0,i.j4)(p.Z,{key:0,ref_key:"tooltipEl",ref:l,x:k.value,y:S.value,direction:(0,o.SU)(y.core).ua.android?"bottom":"top","card-class":e.$style.tooltipCard},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(O.value,(s=>((0,i.wg)(),(0,i.iD)("button",{key:s.icon,"data-test":`comment-reply-formatting-${s.icon}`,type:"button",class:(0,c.C_)([e.$style.btn,{[e.$style.btn_active]:s.isActive()}]),disabled:s.isDisabled(),tabindex:"0",onPointerdown:t[0]||(t[0]=(0,d.iM)((e=>{w.value=!0}),["stop"])),onClick:e=>s.handleClick()},[(0,i.Wm)(h.Z,{name:s.icon},null,8,["name"])],42,b)))),128))])),_:1},8,["x","y","direction","card-class"])):(0,i.kq)("v-if",!0)]))}});var k=s(75126),S=s.n(k),O=s(83744);const E={};E.$style=S();const C=(0,O.Z)(w,[["__cssModules",E]]);var x=s(29333),T=s(49170),I=s(15917),P=s(79902),A=s(29939);function D(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function M(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?D(Object(s),!0).forEach((function(t){R(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):D(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function R(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const N=(0,i.aZ)(M(M({},{inheritAttrs:!1}),{},{__name:"rich-editor",props:{modelValue:{},editable:{type:Boolean,default:!0},storyId:{default:0},extensions:{default:()=>[]},userMentionsType:{default:P.D.COMMENT}},emits:["update:modelValue","paste:files","paste:links"],setup(e,{expose:t,emit:s}){const c=e,d=s,u=(0,i.Fl)((()=>"string"==typeof c.modelValue)),p=(0,n.jE)({content:c.modelValue,extensions:c.extensions,onUpdate({editor:e}){const t=u.value?e.getHTML():e.getJSON();d("update:modelValue",t)},onFocus(){(0,o.oR)(p)},onBlur(){(0,o.oR)(p)},onTransaction({transaction:e}){e.getMeta("inputLink")&&(_.value=!0)},editorProps:{handlePaste(e,t){var s,i;const o=Array.from(null!==(s=null===(i=t.clipboardData)||void 0===i?void 0:i.files)&&void 0!==s?s:[]);if(o.length)return d("paste:files",o),!0;var r;e.state.selection.empty&&A.j.instance.extractImageVideoUrls(null===(r=t.clipboardData)||void 0===r?void 0:r.getData("text")).then((e=>!!e.length&&(d("paste:links",e),!0))).catch((e=>console.error(e)));return!1}}}),h=(0,i.Fl)((()=>p.value.getText()));(0,i.YP)((()=>c.modelValue),(e=>{const t=u.value?e:(0,a.ar)((0,o.IU)(e),c.extensions);p.value.getHTML()!==t&&p.value.commands.setContent(e,!1,{preserveWhitespace:!0})}));const _=(0,o.iH)(!1),m=(0,i.Fl)((()=>{var e;return Boolean(null===(e=p.value)||void 0===e?void 0:e.isFocused)})),g=(0,l.ob)(p),v=(0,r.VW)(g,50),f=(0,i.Fl)((()=>{var e;return Boolean(null===(e=p.value)||void 0===e?void 0:e.isFocused)&&!_.value&&v.value.from!==v.value.to}));function y(){p.value.chain().focus().run()}const{mentions:b,insertUserMention:w,mention:k}=(0,I.$)({editor:p,storyId:c.storyId,type:c.userMentionsType});return t({focus:y,isFocused:m,setSelectionAtEnd:function(){const e=p.value.state.doc.content.size;p.value.chain().focus().setTextSelection({from:e,to:e}).run()},insertContent:function(e){p.value.chain().insertContent(e).focus().run(),y()},textContent:(0,o.OT)(h)}),(e,t)=>{var s;return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)((0,o.SU)(n.kg),(0,i.dG)(e.$attrs,{class:[e.$style.host,{[e.$style.host_disabled]:!c.editable}],editor:(0,o.SU)(p),"data-test":"comment-reply-input",onClick:t[0]||(t[0]=e=>y())}),null,16,["class","editor"]),(0,o.SU)(p)&&null!==(s=(0,o.SU)(p))&&void 0!==s&&s.isEditable?((0,i.wg)(),(0,i.j4)(C,{key:0,"model-value":f.value,editor:(0,o.SU)(p),"selection-x":(0,o.SU)(v).x,"selection-y":(0,o.SU)(v).y,"selection-width":(0,o.SU)(v).width,"selection-height":(0,o.SU)(v).height,extensions:c.extensions},null,8,["model-value","editor","selection-x","selection-y","selection-width","selection-height","extensions"])):(0,i.kq)("v-if",!0),(0,o.SU)(p)?((0,i.wg)(),(0,i.j4)(T.Z,{key:1,disabled:!m.value,mentions:(0,o.SU)(b),"selection-x":(0,o.SU)(g).x,"selection-y":(0,o.SU)(g).y,"selection-height":(0,o.SU)(g).height,"selection-text":(0,o.SU)(k),onInsert:t[1]||(t[1]=e=>(0,o.SU)(w)(e.name))},null,8,["disabled","mentions","selection-x","selection-y","selection-height","selection-text"])):(0,i.kq)("v-if",!0),(0,o.SU)(p)?((0,i.wg)(),(0,i.j4)(x.Z,{key:2,active:_.value,"onUpdate:active":t[2]||(t[2]=e=>_.value=e),editor:(0,o.SU)(p)},null,8,["active","editor"])):(0,i.kq)("v-if",!0)],64)}}}));var B=s(1882),L=s.n(B);const j={};j.$style=L();const $=(0,O.Z)(N,[["__cssModules",j]])},49170:(e,t,s)=>{"use strict";s.d(t,{Z:()=>w});s(88674);var i=s(66252),o=s(49963),r=s(3577),n=s(2262),a=s(53329),l=s(20252),c=s(40094),d=s(12665),u=s(41218),p=s(66309),h=s(55529),_=s(66037),m=s(51540);const g=(0,i.aZ)({__name:"user-mentions",props:{mentions:{},disabled:{type:Boolean},selectionText:{},selectionX:{},selectionY:{},selectionHeight:{}},emits:["insert"],setup(e,{emit:t}){const s=e,g=t,v=(0,n.iH)(),f=(0,n.iH)(!1),{height:y,width:b}=(0,d.XL)(v,{absolute:!0}),w=(0,n.iH)(null),k=(0,u.Dp)((0,i.Fl)((()=>s.disabled)),300),S=(0,i.Fl)((()=>s.mentions.length>0));(0,i.YP)([()=>s.selectionX,()=>s.selectionY,y,b],(()=>{O()}));const O=(0,m.P)((()=>{w.value={getBoundingClientRect(){const e=s.selectionX,t=s.selectionY+s.selectionHeight+y.value;return{width:0,height:0,x:e,y:t,top:t,left:e,right:e,bottom:t}}}}),100),E=(0,p.CRk)((async()=>{if(!f.value||!w.value)return{};const{x:e,y:t}=await(0,_.oo)(w.value,v.value,{middleware:[(0,_.RR)(),(0,_.uY)({padding:16})],placement:"top-start",strategy:"fixed"});return{top:t+"px",left:e+"px",zIndex:(0,h.e)()}}));return(0,i.YP)(S,(e=>{f.value=e})),(0,i.YP)(k,(e=>{f.value=!e&&S.value})),(e,t)=>((0,i.wg)(),(0,i.j4)(i.lR,{to:"body"},[(0,i.Wm)(o.uT,{name:e.$style.host},{default:(0,i.w5)((()=>[f.value?((0,i.wg)(),(0,i.iD)("div",{key:0,ref_key:"dropdownEl",ref:v,class:(0,r.C_)(e.$style.host),style:(0,r.j5)((0,n.SU)(E))},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.mentions,(t=>((0,i.wg)(),(0,i.j4)(a.Z,{key:t.name,"data-test":`comment-reply-mention-${t.name}`,label:t.name,selection:s.selectionText,onClick:e=>g("insert",t)},(0,i.Nv)({prefix:(0,i.w5)((()=>[(0,i.Wm)(l.Z,{url:t.avatar,size:20},null,8,["url"])])),_:2},[t.role||t.isApproved?{name:"suffix",fn:(0,i.w5)((()=>[t.role?((0,i.wg)(),(0,i.iD)("span",{key:0,class:(0,r.C_)(e.$style.role)},(0,r.zw)(t.role),3)):(0,i.kq)("v-if",!0),t.isApproved?((0,i.wg)(),(0,i.j4)(c.Z,{key:1,name:"approved_16",size:16,class:(0,r.C_)(e.$style.icon)},null,8,["class"])):(0,i.kq)("v-if",!0)])),key:"0"}:void 0]),1032,["data-test","label","selection","onClick"])))),128))],6)):(0,i.kq)("v-if",!0)])),_:1},8,["name"])]))}});var v=s(61935),f=s.n(v),y=s(83744);const b={};b.$style=f();const w=(0,y.Z)(g,[["__cssModules",b]])},26170:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var i=s(66252),o=s(2262),r=s(544);const n=(0,i.aZ)({__name:"node-wrapper-view",setup:e=>(e,t)=>((0,i.wg)(),(0,i.j4)((0,o.SU)(r.T5),null,{default:(0,i.w5)((()=>[(0,i.WI)(e.$slots,"default")])),_:3}))})},67198:(e,t,s)=>{var i=s(14292);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("103528d1",i,!1,{})},85158:(e,t,s)=>{var i=s(93089);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("0c8ec09c",i,!1,{})},63446:(e,t,s)=>{var i=s(99976);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("03a65abe",i,!1,{})},1546:(e,t,s)=>{var i=s(45813);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("7f4fcde3",i,!1,{})},89922:(e,t,s)=>{var i=s(89107);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("a9614200",i,!1,{})},9792:(e,t,s)=>{var i=s(72811);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("c61a39a2",i,!1,{})},86022:(e,t,s)=>{var i=s(29857);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("3ee56dd8",i,!1,{})},8151:(e,t,s)=>{var i=s(60390);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("0c95bca0",i,!1,{})},16070:(e,t,s)=>{var i=s(44501);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("1c13bfc8",i,!1,{})},4155:(e,t,s)=>{var i=s(13584);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("7c99f872",i,!1,{})},18517:(e,t,s)=>{var i=s(84679);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("3b8accfc",i,!1,{})},72869:(e,t,s)=>{var i=s(33693);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("dcf2dbba",i,!1,{})},6815:(e,t,s)=>{var i=s(86280);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("550d8dde",i,!1,{})},23024:(e,t,s)=>{var i=s(82712);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("a3c21874",i,!1,{})},30602:(e,t,s)=>{var i=s(21458);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("e508a9c2",i,!1,{})},25392:(e,t,s)=>{var i=s(67201);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("649005d2",i,!1,{})},77741:(e,t,s)=>{var i=s(37682);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("476f4731",i,!1,{})},48557:(e,t,s)=>{var i=s(51773);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("ba2ae996",i,!1,{})},81455:(e,t,s)=>{var i=s(32945);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("204a69b6",i,!1,{})},22785:(e,t,s)=>{var i=s(90122);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("7ecc57b0",i,!1,{})},88002:(e,t,s)=>{var i=s(30358);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("782bfa70",i,!1,{})},46043:(e,t,s)=>{var i=s(95437);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("41c6d335",i,!1,{})},17156:(e,t,s)=>{var i=s(32252);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("26c03dfa",i,!1,{})},19050:(e,t,s)=>{var i=s(11537);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("54ebd29a",i,!1,{})},76854:(e,t,s)=>{var i=s(63695);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("251f0acf",i,!1,{})},98277:(e,t,s)=>{var i=s(49729);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("1aa5fe66",i,!1,{})},58911:(e,t,s)=>{var i=s(75997);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("6a99dc33",i,!1,{})},4223:(e,t,s)=>{var i=s(38816);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("23432c5d",i,!1,{})},69167:(e,t,s)=>{var i=s(44660);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("16e7e77e",i,!1,{})},52901:(e,t,s)=>{var i=s(82765);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("784b5a30",i,!1,{})},23108:(e,t,s)=>{var i=s(876);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("a3b3b024",i,!1,{})},58262:(e,t,s)=>{var i=s(12251);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("644e142f",i,!1,{})},81221:(e,t,s)=>{var i=s(6163);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("2e608d5e",i,!1,{})},83195:(e,t,s)=>{var i=s(69429);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("1e51a526",i,!1,{})},90109:(e,t,s)=>{var i=s(62714);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("9da17188",i,!1,{})},10879:(e,t,s)=>{var i=s(10615);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("53ba74e6",i,!1,{})},93830:(e,t,s)=>{var i=s(22425);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("55c58fd7",i,!1,{})},58007:(e,t,s)=>{var i=s(16758);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("2a80aa72",i,!1,{})},90478:(e,t,s)=>{var i=s(22935);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("6be7e72a",i,!1,{})},33441:(e,t,s)=>{var i=s(47655);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("22a1be8e",i,!1,{})},56765:(e,t,s)=>{var i=s(91739);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("35e32e66",i,!1,{})},4535:(e,t,s)=>{var i=s(51407);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("07dbf292",i,!1,{})},78378:(e,t,s)=>{var i=s(69344);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("4bf67232",i,!1,{})},25743:(e,t,s)=>{var i=s(5211);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("321b0636",i,!1,{})},88490:(e,t,s)=>{var i=s(40952);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("4d2e95d1",i,!1,{})},93160:(e,t,s)=>{var i=s(2481);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("9b3f039e",i,!1,{})},16350:(e,t,s)=>{var i=s(1347);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("1322de63",i,!1,{})},26666:(e,t,s)=>{var i=s(6825);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("6a9c31de",i,!1,{})},93230:(e,t,s)=>{var i=s(67757);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("1e2c45c9",i,!1,{})},52771:(e,t,s)=>{var i=s(97807);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("037cdf52",i,!1,{})},9553:(e,t,s)=>{var i=s(52282);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("5eeb369b",i,!1,{})},48279:(e,t,s)=>{var i=s(51160);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("344d0906",i,!1,{})},88506:(e,t,s)=>{var i=s(10330);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("32db5a18",i,!1,{})},15929:(e,t,s)=>{var i=s(61400);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("fd6ae04c",i,!1,{})},48902:(e,t,s)=>{var i=s(35071);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("3e71f1ac",i,!1,{})},2420:(e,t,s)=>{var i=s(71137);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("5eaa8b46",i,!1,{})},21418:(e,t,s)=>{var i=s(37745);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("0d8ec658",i,!1,{})},914:(e,t,s)=>{var i=s(55600);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("dd4af802",i,!1,{})},8524:(e,t,s)=>{var i=s(98726);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("3e84220f",i,!1,{})},86996:(e,t,s)=>{var i=s(36751);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("266b9fcf",i,!1,{})},87683:(e,t,s)=>{var i=s(73862);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("5bbfeee2",i,!1,{})},98871:(e,t,s)=>{var i=s(48401);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("23ef0e9c",i,!1,{})},47567:(e,t,s)=>{var i=s(71414);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("79cc23d6",i,!1,{})},58944:(e,t,s)=>{var i=s(57665);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("3ed6ae52",i,!1,{})},34149:(e,t,s)=>{var i=s(51598);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("3ce84402",i,!1,{})},25948:(e,t,s)=>{var i=s(41864);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("000078d4",i,!1,{})},86506:(e,t,s)=>{var i=s(22337);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("6ad9c2fa",i,!1,{})},44409:(e,t,s)=>{var i=s(64136);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("eac56e64",i,!1,{})},59902:(e,t,s)=>{var i=s(94028);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("377bdfb7",i,!1,{})},68378:(e,t,s)=>{var i=s(61732);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("7db265bd",i,!1,{})},32423:(e,t,s)=>{var i=s(12289);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("b521d1e2",i,!1,{})},52934:(e,t,s)=>{var i=s(51727);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("200c29c4",i,!1,{})},31134:(e,t,s)=>{var i=s(10800);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("0032d335",i,!1,{})},3962:(e,t,s)=>{var i=s(44209);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("de483c4e",i,!1,{})},18874:(e,t,s)=>{var i=s(4256);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("c9b20b5e",i,!1,{})},81418:(e,t,s)=>{var i=s(20727);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("f8d55d6a",i,!1,{})},90977:(e,t,s)=>{var i=s(76456);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("5bdec4b8",i,!1,{})},20022:(e,t,s)=>{var i=s(25451);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("0c053b0d",i,!1,{})},62171:(e,t,s)=>{var i=s(58087);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("0ebbb69c",i,!1,{})},12542:(e,t,s)=>{var i=s(33233);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("69b12661",i,!1,{})},28307:(e,t,s)=>{var i=s(68251);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("36e0cded",i,!1,{})},87461:(e,t,s)=>{var i=s(53141);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("6e2c8422",i,!1,{})},65755:(e,t,s)=>{var i=s(58123);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("edad1724",i,!1,{})},8681:(e,t,s)=>{var i=s(94456);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("54058f20",i,!1,{})},1351:(e,t,s)=>{var i=s(34292);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("450a1a2a",i,!1,{})},55066:(e,t,s)=>{var i=s(27983);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("411b31dc",i,!1,{})},79983:(e,t,s)=>{var i=s(48762);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("04ccd3a3",i,!1,{})},54689:(e,t,s)=>{var i=s(80829);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("6ce68dd7",i,!1,{})},91126:(e,t,s)=>{var i=s(86253);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("17069012",i,!1,{})},29023:(e,t,s)=>{var i=s(94923);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("bed637b0",i,!1,{})},41473:(e,t,s)=>{var i=s(27263);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("6b725521",i,!1,{})},90254:(e,t,s)=>{var i=s(22606);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("4b7ecc20",i,!1,{})},16514:(e,t,s)=>{var i=s(84816);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("3039b55a",i,!1,{})},37358:(e,t,s)=>{var i=s(69320);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("2357c832",i,!1,{})},69683:(e,t,s)=>{var i=s(25093);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("4f9c89a7",i,!1,{})},44187:(e,t,s)=>{var i=s(31199);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("73e87118",i,!1,{})},17375:(e,t,s)=>{var i=s(30155);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("13d28df7",i,!1,{})},40889:(e,t,s)=>{var i=s(28661);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("e23ab226",i,!1,{})},89556:(e,t,s)=>{var i=s(20779);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("4bdaac09",i,!1,{})},71335:(e,t,s)=>{var i=s(92465);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("7544da18",i,!1,{})},84272:(e,t,s)=>{var i=s(60973);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("6e1621d4",i,!1,{})},36146:(e,t,s)=>{var i=s(72693);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("a12b11da",i,!1,{})},11096:(e,t,s)=>{var i=s(7553);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("4a659115",i,!1,{})},18024:(e,t,s)=>{var i=s(93751);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("533964ad",i,!1,{})},26626:(e,t,s)=>{var i=s(24719);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("21440822",i,!1,{})},74360:(e,t,s)=>{var i=s(90849);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("be99b9fe",i,!1,{})},97138:(e,t,s)=>{var i=s(32764);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("e1e8782c",i,!1,{})},97329:(e,t,s)=>{var i=s(10977);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("1bddb6ae",i,!1,{})},29885:(e,t,s)=>{var i=s(76618);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("1ee3db78",i,!1,{})},9209:(e,t,s)=>{var i=s(79392);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("4d829b76",i,!1,{})},51072:(e,t,s)=>{var i=s(13726);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("2324864e",i,!1,{})},47024:(e,t,s)=>{var i=s(65833);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("013bb3a4",i,!1,{})},89140:(e,t,s)=>{var i=s(48055);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("79917cb9",i,!1,{})},19342:(e,t,s)=>{var i=s(17701);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("712406f2",i,!1,{})},2708:(e,t,s)=>{var i=s(42876);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("099d5ebc",i,!1,{})},48665:(e,t,s)=>{var i=s(73151);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("4202be19",i,!1,{})},78156:(e,t,s)=>{var i=s(6853);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("780c6501",i,!1,{})},97892:(e,t,s)=>{var i=s(45197);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("0b1031fc",i,!1,{})},65585:(e,t,s)=>{var i=s(80198);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("3266a4c8",i,!1,{})},20318:(e,t,s)=>{var i=s(16586);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("10fdcdcc",i,!1,{})},8586:(e,t,s)=>{var i=s(48732);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("2919a5b1",i,!1,{})},97226:(e,t,s)=>{var i=s(36873);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("0a0ce7d0",i,!1,{})},51820:(e,t,s)=>{var i=s(36975);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("66c3691e",i,!1,{})},12941:(e,t,s)=>{var i=s(26890);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("7ee99b00",i,!1,{})},75182:(e,t,s)=>{var i=s(20468);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("4d179e1c",i,!1,{})},76432:(e,t,s)=>{var i=s(58371);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("3d5015a7",i,!1,{})},73523:(e,t,s)=>{var i=s(10968);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("3f8d32e6",i,!1,{})},90889:(e,t,s)=>{var i=s(45760);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("414d29aa",i,!1,{})},68e3:(e,t,s)=>{var i=s(77832);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("8f991822",i,!1,{})},77850:(e,t,s)=>{var i=s(86569);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("096ab472",i,!1,{})},89559:(e,t,s)=>{var i=s(23070);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("535c1c2e",i,!1,{})},20650:(e,t,s)=>{var i=s(21409);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("17eb17b0",i,!1,{})},53810:(e,t,s)=>{var i=s(19288);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("0da52d3b",i,!1,{})},96531:(e,t,s)=>{var i=s(20226);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("911cae10",i,!1,{})},41535:(e,t,s)=>{var i=s(60809);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("2e300477",i,!1,{})},80089:(e,t,s)=>{var i=s(10779);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("01752aee",i,!1,{})},83712:(e,t,s)=>{var i=s(63914);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("e74c16ce",i,!1,{})},29409:(e,t,s)=>{var i=s(63840);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("3fcdfd79",i,!1,{})},24614:(e,t,s)=>{var i=s(25217);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("2235fd42",i,!1,{})},88437:(e,t,s)=>{var i=s(80547);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("2255bad9",i,!1,{})},20994:(e,t,s)=>{var i=s(2945);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("277bc301",i,!1,{})},1535:(e,t,s)=>{var i=s(96704);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("c1b87d80",i,!1,{})},96843:(e,t,s)=>{var i=s(93570);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("f68693d6",i,!1,{})},8163:(e,t,s)=>{var i=s(82112);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("3c605a86",i,!1,{})},44290:(e,t,s)=>{var i=s(88438);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("419d96e1",i,!1,{})},21970:(e,t,s)=>{var i=s(12291);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("00670521",i,!1,{})},52773:(e,t,s)=>{var i=s(46798);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("8f486c32",i,!1,{})},70087:(e,t,s)=>{var i=s(7815);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("6fe97a82",i,!1,{})},38490:(e,t,s)=>{var i=s(78317);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("484a1fca",i,!1,{})},38189:(e,t,s)=>{var i=s(56836);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("4c61a326",i,!1,{})},4264:(e,t,s)=>{var i=s(99500);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("41dc5d29",i,!1,{})},29246:(e,t,s)=>{var i=s(76043);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("459e890c",i,!1,{})},98851:(e,t,s)=>{var i=s(32979);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("473d333a",i,!1,{})},9887:(e,t,s)=>{var i=s(92093);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("10e33740",i,!1,{})},98177:(e,t,s)=>{var i=s(33873);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("3bef7206",i,!1,{})},76961:(e,t,s)=>{var i=s(72136);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("05d11cf1",i,!1,{})},47387:(e,t,s)=>{var i=s(42205);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("2ce2d8be",i,!1,{})},63975:(e,t,s)=>{var i=s(42005);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("8ffa119e",i,!1,{})},76280:(e,t,s)=>{var i=s(11624);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("f4f1d30e",i,!1,{})},92685:(e,t,s)=>{var i=s(44691);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("acb0aa4c",i,!1,{})},28495:(e,t,s)=>{var i=s(73231);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("4e2b7b80",i,!1,{})},77936:(e,t,s)=>{var i=s(59179);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("590e1573",i,!1,{})},1167:(e,t,s)=>{var i=s(62984);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("641eaac2",i,!1,{})},92929:(e,t,s)=>{var i=s(49942);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("8ad5d750",i,!1,{})},13384:(e,t,s)=>{var i=s(39250);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("5e52f92c",i,!1,{})},70989:(e,t,s)=>{var i=s(9731);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("315df1c4",i,!1,{})},36865:(e,t,s)=>{var i=s(42292);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("a1efc8d2",i,!1,{})},37148:(e,t,s)=>{var i=s(68652);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("4f8cc8ec",i,!1,{})},24158:(e,t,s)=>{var i=s(586);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("2eaa7510",i,!1,{})},29644:(e,t,s)=>{var i=s(42821);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("26c8e091",i,!1,{})},84041:(e,t,s)=>{var i=s(68137);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("75251b95",i,!1,{})},68711:(e,t,s)=>{var i=s(81516);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("203b0334",i,!1,{})},53617:(e,t,s)=>{var i=s(77527);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("47728b0a",i,!1,{})},28696:(e,t,s)=>{var i=s(53830);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("20abcc78",i,!1,{})},41693:(e,t,s)=>{var i=s(99848);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("9ecda120",i,!1,{})},1882:(e,t,s)=>{var i=s(41280);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("4ca3096b",i,!1,{})},61935:(e,t,s)=>{var i=s(19933);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("d41f2f54",i,!1,{})},75126:(e,t,s)=>{var i=s(44113);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("22267bca",i,!1,{})},79915:(e,t,s)=>{var i=s(28066);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,s(54402).Z)("26c356a0",i,!1,{})},5853:e=>{"use strict";e.exports="data:image/svg+xml,%3csvg width=%274%27 height=%274%27 viewBox=%270 0 4 4%27 fill=%27none%27 xmlns=%27http://www.w3.org/2000/svg%27%3e%3ccircle cx=%272%27 cy=%272%27 r=%271.5%27 stroke=%27%234d4d4d%27/%3e%3c/svg%3e"},40930:e=>{"use strict";e.exports="data:image/svg+xml,%3csvg width=%274%27 height=%274%27 viewBox=%270 0 4 4%27 fill=%27none%27 xmlns=%27http://www.w3.org/2000/svg%27%3e%3ccircle cx=%272%27 cy=%272%27 r=%271.5%27 stroke=%27%23a6a6a6%27/%3e%3c/svg%3e"},31310:e=>{"use strict";e.exports="data:image/svg+xml,%3csvg width=%274%27 height=%274%27 viewBox=%270 0 4 4%27 fill=%27none%27 xmlns=%27http://www.w3.org/2000/svg%27%3e%3ccircle cx=%272%27 cy=%272%27 r=%272%27 fill=%27%234d4d4d%27/%3e%3c/svg%3e"},82807:e=>{"use strict";e.exports="data:image/svg+xml,%3csvg width=%274%27 height=%274%27 viewBox=%270 0 4 4%27 fill=%27none%27 xmlns=%27http://www.w3.org/2000/svg%27%3e%3ccircle cx=%272%27 cy=%272%27 r=%272%27 fill=%27%23a6a6a6%27/%3e%3c/svg%3e"},98691:e=>{"use strict";e.exports="data:image/svg+xml,%3csvg width=%274%27 height=%274%27 viewBox=%270 0 4 4%27 fill=%27none%27 xmlns=%27http://www.w3.org/2000/svg%27%3e%3crect width=%274%27 height=%274%27 rx=%271%27 fill=%27%234d4d4d%27/%3e%3c/svg%3e"},28443:e=>{"use strict";e.exports="data:image/svg+xml,%3csvg width=%274%27 height=%274%27 viewBox=%270 0 4 4%27 fill=%27none%27 xmlns=%27http://www.w3.org/2000/svg%27%3e%3crect width=%274%27 height=%274%27 rx=%271%27 fill=%27%23a6a6a6%27/%3e%3c/svg%3e"},63193:e=>{"use strict";e.exports="data:image/svg+xml,%3csvg width=%274%27 height=%274%27 viewBox=%270 0 4 4%27 fill=%27none%27 xmlns=%27http://www.w3.org/2000/svg%27%3e%3crect x=%270.5%27 y=%270.5%27 width=%273%27 height=%273%27 rx=%270.5%27 stroke=%27%234d4d4d%27/%3e%3c/svg%3e"},46968:e=>{"use strict";e.exports="data:image/svg+xml,%3csvg width=%274%27 height=%274%27 viewBox=%270 0 4 4%27 fill=%27none%27 xmlns=%27http://www.w3.org/2000/svg%27%3e%3crect x=%270.5%27 y=%270.5%27 width=%273%27 height=%273%27 rx=%270.5%27 stroke=%27%23a6a6a6%27/%3e%3c/svg%3e"},252:e=>{"use strict";e.exports=JSON.parse('{"approved-users":{"sort-mode":{"DEFAULT":"По дате верификации","NAME":"По имени пользователя","STORIES":"По количеству публикаций"}},"auth":{"analytics-errors":{"contact":{"format":"email_or_phone_wrong","required":"email_or_phone_empty"},"email":{"email":"email_wrong"},"login":{"required":"login_empty","too-short":"login_short"},"password":{"password-week":"password_weak","required":"password_empty","too-short":"password_short"},"phone":{"phone":"phone_wrong","required":"phone_empty"},"phone_socials":{"required":"phone_empty"},"restore_passwd1":{"password-mismatch":"password_differ","password-week":"password_weak","required":"password_empty","too-short":"password_short"},"restore_passwd2":{"password-mismatch":"password_differ","required":"password_empty"},"username":{"required":"nickname_empty","too-long":"nickname_long","too-short":"nickname_short","username-busy":"nickname_occupied","username-first-dot":"nickname_wrong_symbol","username-last-dot":"nickname_wrong_symbol","username-whitelist":"nickname_wrong_symbol"},"username_socials":{"required":"nickname_empty","too-long":"nickname_long","too-short":"nickname_short","username-busy":"nickname_occupied","username-first-dot":"nickname_wrong_symbol","username-last-dot":"nickname_wrong_symbol","username-whitelist":"nickname_wrong_symbol"}},"captcha":"Каптча введена некорректно","email":"Email введён некорректно","forget":{"changed":"Готово! Ваш новый пароль успешно установлен!","failure":"Не удалось найти подходящий аккаунт","success-email":"Мы отправили письмо с инструкциями на указанный email, если аккаунт с таким адресом зарегистрирован на Пикабу"},"next":"продолжить","norecaptcha":"Не удалось связаться с сервисом ReCaptcha. Проверьте свое интернет-соединение и попробуйте позже.<br>Если вы используете VPN, попробуйте его отключить.","password":"Пароль слишком простой","tlg":"Получить код в Telegram","tlg-hint":"Для получения кода, на данном устройстве должно быть установлено приложение &laquo;Телеграм&raquo;","up":{"confirm":{"button":"Подтвердить","header":"Введите код из SMS сообщения","placeholder":"Код из SMS"},"errors":{"captcha":"Вы робот? &#x1F607;","confirm-limit":"Повторить можно через %0 ^auth.up.seconds(\'%0\')","email":"Неверный email","email-busy":"Email занят","format":"Неверный формат","password-mismatch":"Пароли не совпадают","password-short":"Пароль коротковат","password-week":"Пароль слишком простой","phone":"Неверный формат телефона. Введите номер телефона в формате +79001234567","username-busy":"Логин занят","username-first-dot":"Не может начинаться на точку","username-last-dot":"Не может заканчиваться на точку","username-long":"Логин длинноват","username-many-dot":"Разрешены символы A-z, 0-9 и одна точка","username-short":"Логин коротковат","username-whitelist":"Разрешены символы A-z, 0-9 и одна точка"},"seconds":["секунду","секунды","секунд"]},"username":"Логин введён некорректно","username-info":"Никнейм, email или номер телефона, начинающийся с символа «+»","welcome":"Добро пожаловать, "},"background-attach":{"controls":{"change":"изменить фон","remove":"убрать фон"},"popup":{"attach-btn":"Выбрать изображение","cancel":"Отмена","header":"Изменить фон","note":"Оптимальный размер: 1400 х 280"}},"banned-profiles":{"empty":"Ура! Бан-лист пуст","search-empty":"По запросу никого не найдено","title":{"empty":"%1","query":"%0 - %1"}},"button":{"subscribe":{"ignore-list":"Игнор-лист сообщества","settings":"Настройки сообщества","settings-ban":"Настройки сообщества","subscribe":"Подписаться","unsubscribe":"Отписаться"}},"calendar":{"captions":{"all-time":"всё время"},"errors":{"invalid-date":"Введенной даты не существует","invalid-day":"Дата дня должна быть от 1 до 31","invalid-format":"Странный формат даты","invalid-month":"Месяц должен быть от 1 до 12","invalid-year":"Неправильный год","overflow":"Дата выходит за диапазон календаря"},"months":["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],"months2":["Января","Февраля","Марта","Апреля","Мая","Июня","Июля","Августа","Сентября","Октября","Ноября","Декабря"],"weekdays":["пн","вт","ср","чт","пт","сб","вс"]},"cedit":{"changes":["изменение","изменения","изменений"],"editor":{"form":{"from-list":"Пожалуйста, выберите тег из выпадающего списка","saved":"Вариант редактирования успешно сохранен!"}},"feed":{"total":"%0 ^cedit.changes(\'%0\')"},"feed-filter-mode":{"HIDE_VOTED":["скрывать оцененное","Скрывать оцененное"],"SHOW_ALL":["показывать все","Показывать все"]},"label":{"approved":"утвержден %0","rejected":"отклонен %0","waiting":"ожидает"}},"comments":{"button":{"toggle-children":"раскрыть ветку (%0)","toggle-hidden-children":["ещё комментарий","ещё комментарии"],"toggle-hidden-group-children":["ещё комментарий","ещё комментарии"],"toggle-more":"Показать ещё"},"comstory":{"collapse":"Свернуть","expand":"Показать полностью"},"controls":{"cancel":"отмена","create":"ответить","edit":"редактировать","remove":"удалить","unpin":"открепить комментарий"},"dnd":{"drag":"Перенесите изображение сюда","drop":"Отпустите клавишу мыши"},"errors":{"400":"Непредвиденная ошибка","max-depth":"Достигнута максимальная глубина комментариев"},"hidden":{"ignore-hint":"В скрытом у %0","reply-note":["%1 скрыл для себя ваши комментарии","%1 скрыли для себя ваши комментарии"]},"ignore":{"COMMUNITY_IGNORES_YOU":"Вы не можете отвечать в данном посте, так как Вы находитесь в игнор-листе сообщества %0","YOU_IGNORES_AUTHOR_OF_COMMENT":"Вы не можете отвечать, автор комментария находится в Вашем игнор-листе","YOU_IGNORES_AUTHOR_OF_STORY":"Вы не можете отвечать, автор поста находится в Вашем игнор-листе"},"label":["комментарий","комментария","комментариев"],"notice":{"branch-hidden":"Комментарий скрыт из поста адмодером сообщества. Ветка с ответами скрыта автоматически."},"order-mode":{"RATING":"по рейтингу","RELEVANCE":"по актуальности","TIME":"по времени"},"rating-hint":"Комментарий набрал %0 ^plural.pluses(\'%0\')","rating-zero":"Комментарий еще не набрал плюсов","remained":"<strong>%0</strong> ^comments.label(\'%0\')","reply":{"banned":"Вы заблокированы и не можете оставлять комментарии","before-exit":"Присуствует неотправленный комментарий","image-limit":"Максимально можно добавить %0 ^comments.reply.images(%0)","images":["изображение","изображения","изображений"],"rating":"У Вас слишком низкий рейтинг для добавления комментариев"},"success":{"deleted":"Комментарий удален. Причина: ","hidden":"Ветка комментариев скрыта","restored":"Комментарий восстановлен","shown":"Ветка комментариев восстановлена"}},"communities":{"feed":{"eof":{"empty":"Здесь пока что нет ни одного сообщества","message":"Отлично, все прокручено!","mine-empty":"<p>У Вас пока что нет подписок на сообщества :\\\\</p><p>Подписаться можно на странице понравившегося Вам сообщества</p>","search-empty":"Мы не нашли ни одного подходяшего сообщества","search-message":"Сообщества с текущими критериями поиска закончились"},"sort-mode":{"ACTUAL":"По актуальности","SUBS":"По подписчикам","TIME":"По времени"}},"voting":{"popup":{"false":["не устраивает","Не устраивает"],"true":["устраивает","Устраивает"]}}},"complain":{"button":{"cancel":"Отмена"},"checkbox":{"comment":"Скрыть комментарии пользователя","post":"Скрыть посты пользователя на 7 дней","user":"Скрыть комментарии и посты пользователя на 7 дней"},"message":{"maxCharsInInput":"Максимальное количество символов - 180","needNote":"Для отправки жалобы необходимо добавить комментарий","noReasons":"Жаловаться пока не на что"},"targetType":{"comment":"Пожаловаться на комментарий","post":"Пожаловаться на контент","user":"Пожаловаться на профиль"}},"context-menu":{"confirm-popup":{"hide":"Сейчас вы можете убрать из профиля <a target=\'_blank\' href=\'/go/help_post_hide\'>%0 ^plural.stories(\'%0\')</a>.<br>Если передумаете, через 7 дней можно будет вернуть его.<br>Вы уверены?","hide-cancel":"Отмена","hide-ok":"Точно убрать","unhide":"Пост снова вернется в ваш профиль. Вы уверены?","unhide-ok":"Да, вернуть"}},"editor":{"buttons":{"anchor":"Ссылка","bold":"Жирный","italic":"Курсивный","quote":"Цитата","strikethrough":"Перечёркнутый"},"placeholder":{"anchor":"Введите ссылку","editor":"Введите текст"}},"errors":{"common":"Ошибка","response":"Упс! Возникла внутренняя ошибка","upload":"Ошибка загрузки"},"evaluation":{"btns":{"close":"Закрыть","notNow":"Не сейчас","poll":"Оценить","send":"Отправить"},"functionalComfort":{"form":{"placeholder":"Оставьте комментарий"},"reasons":{"comment_publish":{"options":{"navigation":"Навигация по комментариям","text":"Редактирование текста"},"title":"Насколько удобно было опубликовать комментарий?"},"common":{"control":"Управление","filter":"Сортировка и фильтрация","other":"Другое","search":"Поиск"},"ignore_list_visit":{"options":{"tags":"Связка тегов"},"title":"Насколько  удобно пользоваться игнор-листом?"},"my_comments_visit":{"options":{"navigation":"Навигация по ветке комментариев в посте","status":"Статус комментария"},"title":"Насколько удобно пользоваться разделом со своими комментариями?"},"my_saved_visit":{"title":"Насколько удобно пользоваться сохранениями?"},"post_publish":{"options":{"bayan":"Баянометр","files":"Добавление файлов","tags":"Заполнение тегов","text":"Редактирование текста"},"title":"Насколько было удобно опубликовать пост?"},"rates_visit":{"options":{"status":"Статус оценки"},"title":"Насколько  удобно пользоваться разделом своих оценок?"},"responses_visit":{"options":{"navigation":"Навигация по ветке комментариев","source":"Исходник ответов","status":"Статус ответов"},"title":"Насколько  удобно пользоваться разделом \\"ответы\\"?"},"subs_feed_visit":{"options":{"control":"Управление подписками","status":"Статус непрочитанных постов"},"title":"Насколько удобно пользоваться разделом подписок?"}}},"gratitude":{"extraComment":"Оставить дополнительный комментарий","title":"Благодарим за ответ!"},"recommendStories":{"clarification":{"options":{"calm_down":"Успокаивает","entertains":"Развлекает","expectations":"Не оправдывает ожидания","informative":"Информативно","not_interesting":"Не интересует","not_relevant":"Неактуально","not_true":"Неправда","nothing_special":"Ничего особенного","old":"Баян","original":"Оригинально","other":"Другое","pointless":"Бессмысленно","unusually":"Непривычно","useful":"Полезно"},"titles":{"negative":"Почему вы не хотите видеть подобные посты?","partial":"Почему вы хотите видеть подобные посты  лишь частично?","positive":"Почему вы хотите видеть подобные посты?"}},"rate":{"definitely":"Да, очень","never":"Нет, никогда","no":"Скорее нет","not_know":"Не знаю","yes":"Скорее да"}},"visit":{"comment":{"placeholder":"Дополнительный комментарий"},"poll":{"bad":"Плохо","excellent":"Отлично","good":"Хорошо","ideally":"Идеально","veryGood":"Очень хорошо"},"title":"Оцените своё сегодняшнее посещение Пикабу"}},"header":{"notifications":{"is-empty":"Пока рассказывать не о чем ¯\\\\_(ツ)_/¯","show-all":"Показать все уведомления"}},"ignore":{"authors":{"COMPLAIN":"Пожаловаться","IGNORE":"Скрыть посты","IGNORE_COMMENTS":"Скрыть комментарии","UNIGNORE":"Показывать посты","UNIGNORE_COMMENTS":"Показывать комментарии"},"communities":{"IGNORE":"Скрыть посты","UNIGNORE":"Показывать посты"},"duration":{"FOREVER":["навсегда","Навсегда"],"KEEP_EXISTING":["не менять","Не менять"],"MONTH":["на месяц","На месяц"],"THREE_MONTHS":["на три месяца","На три месяца"],"WEEK":["на неделю","На неделю"]},"errors":{"keyword-long":"В ключевом слове должно быть не больше %0 символов","keyword-short":"В ключевом слове должно быть не меньше %0 символов","keyword-wrong-asterisk":"Символ * разрешён только в конце ключевого слова"},"hints":{"date":"Правило активно <br> до %0"},"messages":{"comstory":"Готово! Цепочка постов-ответов скрыта на 30 дней","success":"Готово! Настройки скрытия успешно сохранены!"},"tags":{"IGNORE":"Скрыть посты","UNIGNORE":"Показывать посты"}},"ignore-rule-popup":{"modal":{"header":"Настройки скрытия","save":"Готово"},"result":{"empty-warning":"Нужно указать хотя бы одно условие!"}},"image-viewer":{"close":"закрыть"},"modal":{"activate":"Активировать","add":"Добавить","apply":"Применить","ban":"Забанить","cancel":"Отмена","change":"Изменить","continue":"Продолжить","no":"Нет","ok":"Понятно","remove":"Удалить","restore":"Восстановить","revoke":"Убрать","save":"Сохранить","set":"Установить","yes":"Да"},"moderator-tools":{"balloon-box":{"ban-comment":{"action":"внести пользователя в игнор-лист сообщества","button-name":"Забанить","button-name2":"Внести","title":"Причина бана за комментарий"},"ban-post":{"action":"внести пользователя в игнор-лист сообщества","button-name":"Забанить","button-name2":"Внести","title":"Причина бана за пост"},"delete-comment":{"action":"удалить комментарий","button-name":"Удалить","button-name2":"Удалить","title":"Причина удаления комментария"},"delete-post":{"action":"удалить пост","button-name":"Удалить","button-name2":"Удалить","question":"удалить пост","title":"Причина удаления поста"},"hide-comment-branch":{"action":"скрыть ветку комментариев из поста","button-name":"Скрыть","button-name2":"Скрыть","title":"Подтвердите скрытие ветки"},"show-comment-branch":{"action":"показать ветку комментариев в посте","button-name":"Показать","button-name2":"Показать","title":"Подтвердите показ ветки"}},"errors":{"request":"Нет связи с космосом!","user-comment-forgiven":"Пользователь был забанен ренее за данный комментарий, но бан был снят администрацией ","user-comment-punished":"Пользователь уже понес наказание за данный комментарий","user-post-forgiven":"Пользователь был забанен ренее за данный пост, но бан был снят администрацией ","user-post-punished":"Пользователь уже понес наказание за данный пост"},"modal-box":{"ban-comment":{"button-name":"Забанить","question":"Вы действительно хотите забанить автора комментария?","title":"Бан за комментария"},"ban-post":{"button-name":"Забанить","question":"Вы действительно хотите забанить автора поста?","title":"Бан за пост"},"delete-comment":{"button-name":"Удалить","question":"Вы действительно хотите удалить комментарий?","title":"Удаление комментария"},"delete-post":{"button-name":"Удалить","question":"Вы действительно хотите удалить пост?","title":"Удаление поста"},"mark-shared":{"button-cancel":"Отмена","button-confirm":"Отметить","title":"Отметка о публикации в соцсети"},"move-to-common":{"button-cancel":"Отмена","button-confirm":"Переместить","question":"Вы уверены, что хотите переместить данный пост из сообщества в общую ленту Пикабу?","title":"Подтвердите перемещение"}}},"notifications":{"message":"<p>Здесь будут уведомления о полученных наградах, обновлениях на сайте и многом другом.</p><p>Но пока рассказывать не о чем ¯\\\\_(ツ)_/¯</p>"},"page-banned-profiles":{"form":{"invalid-text-length":"Пожалуйста, введите минимум 2 символа для поиска"},"more":"Показать ещё","source":{"COMMENT":"К комментарию","PERMANENT":"перманентный бан","SLOWMODE":"ограничение количества комментариев в сутки","STORY":"К посту"}},"page-communities":{"rating":"с рейтингом %0 и выше"},"page-community":{"approved":"Пост успешно одобрен!","disapproved":"Пост успешно отклонен"},"page-company-blog":{"sort-mode":{"CLICKS":["по переходам","По переходам"],"CLICKS_CTR":["по CTR переходов","По CTR переходов"],"DATE":["по времени создания","По времени создания"],"READS":["по прочтениям","По прочтениям"],"READS_CTR":["по CTR прочтений","По CTR прочтений"],"UNIQUE_VIEWS":["по охвату","По охвату"],"VIEWS":["по показам","По показам"]}},"page-ignore-list":{"button":{"add":"Добавить запись"},"categories":{"all":"Все записи","authors":"Пользователи","communities":"Сообщества","keywords":"Ключевые слова","tags":"Теги"},"empty":{"stories":"Мы не нашли ни одной подходящей записи","users":"Мы не нашли ни одного подходящего пользователя"},"placeholders":{"comments":"Поиск пользователя","posts":"Поиск тега, сообщества, пользователя или ключевого слова"},"tools":{"delete":"Удалить правило","edit":"Редактировать правило"}},"page-quarantine":{"els":{"bell":"bell_profile-menu","btn":"story__quarantine-action","countdown":"quarantine__countdown","feed":"stories-feed","feed-container":"stories-feed__container","story":"story","tools":"story__quarantine-actions"}},"page-reputation-feedback":{"secondary-inputs-empty":"Пожалуйста, введите ваш e-mail или номер телефона. Это нужно, чтобы мы могли вам ответить."},"page-search":{"captions":{"interval":"задать даты","rating":"от %0"},"communities":["сообщество","сообщества","сообществ"],"sort":["сначала свежее","сначала лучшее"],"stories":["пост","поста","постов"],"tags":["тег","тега","тегов"],"users":["пользователь","пользователя","пользователей"]},"page-settings":{"background-blocked":{"content":"Мы заметили, что вы загружали фон, запрещенный правилами Пикабу. Чтобы читатели не увидели запрещенных изображений, мы заблокировали загрузку фона для Вашего профиля. Список&nbsp;запрещенного контента можно посмотреть по <a href=\'/information/rules#15\'>ссылке</a>.","header":"Ошибка"},"confirmations":{"adult":{"content":"Активируя эту настройку, вы подтверждаете, что вам не менее 18 лет","header":"Показывать 18+ контент"},"ignore":{"common":{"end":"в игнор-лист","header":"Подтверждение добавления в игнор-лист","start":"Вы действительно хотите добавить"},"communities":{"middle":"сообщество"},"tags":{"middle":"тег"},"users":{"middle":"пользователя"},"yes":"Добавить"},"no":"Отмена","remove-ignore":{"common":{"end":"из игнор-листа","header":"Подтверждение удаления из игнор-листа","start":"Вы действительно хотите удалить"},"communities":{"middle":"сообщество"},"tags":{"middle":"тег"},"users":{"middle":"пользователя"},"yes":"Удалить"},"subscribe":{"common":{"header":"Подтверждение подписки","start":"Вы действительно хотите подписаться на"},"communities":{"middle":"сообщество"},"tags":{"middle":"тег"},"users":{"middle":"пользователя"},"yes":"Подписаться"},"unsubscribe":{"common":{"header":"Подтверждение отписки","start":"Вы действительно хотите отписаться от"},"communities":{"middle":"сообщества"},"tags":{"middle":"тега"},"users":{"middle":"пользователя"},"yes":"Отписаться"},"yes":"Подписаться"},"declensions":{"communities":["сообщество","сообщества","сообществ"],"tags":["тег","тега","тегов"],"users":["пользователь","пользователя","пользователей"]},"ignore":{"not-found":{"communities":"Игнорируемые сообщества не найдены","tags":"Игнорируемые теги не найдены","users":"Игнорируемые пользователи не найдены"}},"main":{"before-close":"Настройки не были сохранены. Вы действительно хотите покинуть данную страницу?","groups":{"comments":"Комментарии","others":"Другие","stories-feed":"Лента","story":"Пост"},"move":{"move-to-community":"Переносим пост в сообщество","move-to-community-success":"Пост успешно перенесен в сообщество","move-to-feed":"Переносим пост в ленту","move-to-feed-success":"Пост успешно перенесен в ленту","wait":"Секунду! Загружаем группы","wait-series":"Секунду! Загружаем серии"},"options":{"comments-ordering":{"1":"по рейтингу","2":"по времени","3":"по актуальности"},"is-adult-switch-visible":"Вынести настройку отображения NSFW-контента в меню","is-adult-visible":"Показывать 18+ контент","is-anim-preview-comment":"Ставить GIF на паузу в комментариях","is-disable-ads-allowed":"Отключить рекламу","is-full-story-view":"Показывать полностью длинные посты","is-horror-visible":"Показывать посты с тегом <span class=\\"tag\\">жесть</span>","is-show-related-stories":"Показывать дополнительные посты под комментариями","is-tags-at-top":"Показывать теги вверху поста","is-used-ajax-load":"Постраничный просмотр","is-used-scroll-mode":"Сворачивать содержание постов","is-used-scroll-top-button":"Показывать полосу прокрутки наверх","is-username-at-top":"Дублировать автора и сообщество вверху поста","max-comments-branch-depth":"Сворачивать вложенные комментарии после","minimum-comment-rating-view":"Показывать комментарии с","minimum-story-rating-view":"Показывать посты с","tags-fold-mode-caption":"Теги","type-comments-sorting":"Сортировать комментарии"},"save":{"bad":"Ошибка при обновлении","good":"Настройки сохранены","wait":"Скоро всё сохраним"},"save-message":{"bad":"Ошибка при обновлении","good":"Настройки сохранены","wait":"Скоро всё сохраним"},"unsave-before-close":"Настройки не были сохранены. Вы действительно хотите покинуть данную страницу?"},"notifications":{"account":{"options":{"moderator_user_action":"Модерация и поддержка"},"title":"Аккаунт"},"comments":{"options":{"comment_incoming":"Ответы на комментарии","comment_mention":"Упоминания вас","story_reply":"Ответы на посты"},"title":"Комментарии"},"community":{"options":{"community_manage":"Управление сообществами","interesting_communities":"Интересные сообщества"},"title":"Сообщества"},"donations":{"options":{"donation_technical":"Служебная информация","new_donation":"Новые донаты"},"title":"Донаты"},"flags":{"bell":"В колокольчик","off":"Отключены","on":"Включены","push":"Push в приложении"},"others":{"options":{"achievements":"Достижения","interesting_events":"Интересные события на Пикабу","pikabu_news":"Новости Пикабу"},"title":"Другое"},"stories":{"options":{"community_story_move":"Перемещение поста в сообщество","community_story_reject":"Отклонение поста <br>с премодерации в сообществе","interesting_stories":"Интересные посты","moderator_story_action":"Модерация и поддержка","story_in_hot":"Выход поста в горячее","story_social_publish":"Публикация поста в соцсетях Пикабу"},"title":"Посты"},"tags":{"options":{"tag_edit":"Редактирование тегов"},"title":"Теги"}},"remove-note":{"header":"Подтверждение удаления заметки","message":"Вы действительно хотите удалить заметку о пользователе %0?","success":"Удалить"},"save-categories":{"close":"Закрыть","delete":"Пользователи не найдены","name-duplication":"Введенное название уже используется другой категорией","no":"Отмена","yes":"Удалить"},"security":{"email":{"change":"Изменить email","good-change":"Электронная почта успешно изменена","good-set":"Электронная почта успешно добавлена","need-password":"Пожалуйста, <a href=\\"#set-password\\">установите пароль</a> перед редактированием электронной почты","set":"Добавить email"},"nickname":{"change":"Изменить никнейм","good-change":"Никнейм успешно изменен","need-password":"Пожалуйста, <a href=\\"#set-password\\">установите пароль</a> перед изменением никнейма","often-change":"Вы слишком часто меняете никнейм. Попробуйте позже"},"password":{"change":"Изменить пароль","good-change":"Пароль успешно изменён","good-set":"Пароль успешно установлен","identical":"Значение поля \\"Новый пароль\\" должно отличаться от значения поля \\"Текущий пароль\\"","last-set":"Установлен %0","not-identical":"Пароли не совпадают","set":"Установить пароль"},"phone":{"cancel-phone-change":"Отменить","cancel-phone-change-button":"Отменить изменение","change":"Изменить телефон","change-after":"%1 %0 будет установлен, как основной","good-change":"Запущена процедура изменения номера телефона. Привязка телефона применится через 24 часа","good-change-cancel":"Процедура изменения номера успешно остановлена","good-set":"Номер телефона успешно добавлен","need-password":"Пожалуйста, <a href=\\"#set-password\\">установите пароль</a> перед изменением номера телефона","set":"Добавить телефон"},"promo":{"header":{"good":"Безопасность можно повысить","strong":"Отличная работа!","week":"Для обеспечения безопасности, выполните следующие шаги"},"messages":{"need-email":"Пожалуйста, добавьте электронную почту","need-password":"Пожалуйста, установите пароль","need-phone":"Пожалуйста, добавьте номер телефона","update-password":"Пароль давно не обновлялся, обновите его"}},"social":{"deactive":{"button":"Отвязать","header":"Отвязать аккаунт?"},"need-password":"Пожалуйста, <a href=\\"#set-password\\">установите пароль</a> перед тем, как отключить социальную сеть","set":"Подключить","unset":"Отключить"},"try":"Повторить можно через %0"},"subscriptions":{"not-found":{"communities":"Сообщества не найдены","tags":"Теги не найдены","users":"Пользователи не найдены"}},"toggle-story":{"hide":"Пост успешно скрыт из вашего профиля","unhide":"Пост успешно возвращен в ваш профиль"}},"page-stories-saved":{"category":{"shared":"Категория опубликована","unshared":"Категория скрыта"},"copy-link":"Ссылка скопирована"},"page-survey":{"errors":{"invalid-request":"Ошибка запроса на сервер. Сообщите, пожалуйста, администрации сайта","no-answer":"Пожалуйста, выберите вариант ответа","no-answer-all":"Пожалуйста, выберите вариант ответа на каждый вопрос"}},"page-tags-merge":{"confirmation":{"approve-rule":{"end":"с тегом","header":"Подтверждение объединения тегов","start":"Вы действительно хотите подтвердить объединение тега"},"ban-tag":{"header":"Подтверждение блокирования тега","start":"Вы действительно хотите заблокировать тег"},"disapprove-rule":{"end":"с тегом","header":"Подтверждение отмены правила","start":"Вы действительно хотите отменить правило объединения тега"},"no":"Нет","rollback-rule":{"end":"и восстановить данные обратно","header":"Подтверждение отмены правила","middle":"с тегом","start":"Вы действительно хотите отменить правило объединения тега"},"unban-tag":{"header":"Подтверждение разблокирования тега","start":"Вы действительно хотите разблокировать тег","yes":"Да"},"yes":"Да"},"conflicts":{"empty":"Ура! Конфликтов больше нет, можно создавать объдеинения","has-issues":"Предложенный вариант объединения невозможен, так как существуют следующие конфликты:"},"proposal-form":{"messages":{"merged":"Ваше предложение по объединению тегов успешно сохранено"},"non-existent-tag":"Введите существующий тег"},"rule-actions":{"approve":"Подтвердить","disapprove":"Отклонить","rollback":"Отменить правило"},"tag-actions":{"unban":"Разблокировать"}},"page-tags-search":{"form":{"invalid-text-length":"Пожалуйста, введите минимум 2 символа для поиска"}},"player":{"error-loading":"Непредвиденная ошибка","providers":{"gif":"GIF","pikabu":"Пикабу"},"retry":"Попробовать еще раз?","sound-mode":{"has-audio":"Видео запустится со звуком","muted":"Видео запустится без звука","no-audio":"Видео загружено без звука"}},"plural":{"comments":["комментарий","комментария","комментариев"],"days":["день","дня","дней"],"estimate":["оценил","оценили","оценили"],"hidden":["скрыт","скрыто ","скрыто"],"minuses":["минус","минуса","минусов"],"minutes":["минута","минуты","минут"],"people":["человек","человека","человек"],"pluses":["плюс","плюса","плюсов"],"records":["запись","записи","записей"],"seconds":["секунду","секунды","секунд"],"stories":["пост","поста","постов"],"subs":["подписчик","подписчика","подписчиков"],"tags":["тега","тега","тегов"],"users":["пользователь","пользователя","пользователей"],"viewed":["просмотренный","просмотренных","просмотренных"],"views":["просмотр","просмотра","просмотров"]},"profile":{"hint":"Нажмите, чтобы получать уведомления о новых постах автора. Так вы точно их не пропустите!","success-msg":"Отлично! Вы подписались на уведомления и теперь точно не пропустите новые посты автора"},"promo-test":{"buttons":{"next":"Следующий вопрос","result":"Узнать результат"}},"quarantine":{},"reputation":{"typeCaptions":{"comment":"Комментарий","comment_reply":"Ответ на комментарий","feedback":"Обращение","story":"Пост"}},"reputation-labels-list":{"errors":{"name-duplication":"Уже есть метка с таким названием"},"removeModal":{"content":"Действительно удалить метку <strong>%0</strong>?"}},"request":{"400":"Упс! Возникла внутренняя ошибка","413":"Ошибка загрузки изображения. Максимальный размер файла: 10МБ","500":"Сервер немного устал, попробуйте попытку позже!","network-error":"Нет соединения с сетью"},"stories-feed":{"adult-visible":{"false":"скрывать","true":"показывать"},"adult-visible-title":{"false":"Скрывать","true":"Показывать"},"calendar":{"all_time":"всё время","label":"за %0","month":"месяц","random":"случайная дата","select":"Выбрать дату","today":"сегодня","week":["неделя","неделю"]},"copied":"Скопировано! 👍","display-mode":{"VISITED_STORIES_COLLAPSE":"сворачивать","VISITED_STORIES_HIDE":"скрывать","VISITED_STORIES_SHOW":"показывать","collapse":"сворачивать","hidden":"^plural.hidden(\'%0\') %0","hidden-detail":"%0 ^plural.viewed(\'%0\') ^plural.stories(\'%0\') ^plural.hidden(\'%0\')","hidden-detail_short":"%0 ^plural.viewed(\'%0\') ^plural.stories(\'%0\')","hidden-short":"^plural.hidden(\'%0\')","hide":"скрывать","show":"показывать"},"display-mode-title":{"VISITED_STORIES_COLLAPSE":"Сворачивать","VISITED_STORIES_HIDE":"Скрывать","VISITED_STORIES_SHOW":"Показывать"},"eof":{"default":"Отлично, все прочитано!","empty":"Добавьте пост — и он отобразится в вашем профиле. Если пост не понравится пикабушникам, его <a target=\\"_blank\\" href=\\"/go/help_post_hide\\">можно убрать из профиля</a>.","search":"Посты с текущими критериями поиска закончились","search-empty":"Мы не нашли ни одного подходящего поста"},"saved":{"cat-duplicate":"Введенное название уже используется другой категорией","error":"Произошла ошибка","nice":"Сохранено в «%0»"},"subs":{"rating":{"ALL":["любым","С любым рейтингом"],"POSITIVE":["положительным","С положительным рейтингом"]},"type":{"COMMUNITIES":"Сообщества","TAGS":"Теги","USERS":"Пользователи"},"type-title":{"0":"Все подписки","1":"Подписки на пользователей","2":"Подписки на теги","3":"Подписки на пользователей и теги","4":"Подписки на сообщества","5":"Подписки на пользователей и сообщества","6":"Подписки на теги и сообщества"}},"titles":{"best":{"all":"Лучшие посты за сегодня | Пикабу","subs":"Подписки - Лучшее"},"hot":{"all":"Горячее","subs":"Подписки - Горячее"},"new":{"all":"Свежие посты | Пикабу","subs":"Подписки - Свежее"}}},"stories-search":{"sort-mode":{"FRESH":["сначала свежее","Сначала свежее"],"HOT":["сначала лучшее","Сначала лучшее"],"RELEVANCE":["по релевантности","По релевантности"]},"tags":{"subscribe":"Подписка добавлена","unsubscribe":"Подписка удалена"}},"stories-similar":{"close":"Закрыть","empty-message":"Похожих постов не найдено","error-message":"Ну вот :( При поиске похожих постов обнаружена ошибка","more":"Показать ещё","repeat":"Повторим поиск?","wait-message":"Сбор информации о возможных дубликатах"},"story-editor":{"errors":{"upload":"Возникла ошибка при загрузке изображения"},"images":["картинку","картинки","картинок"],"limits":{"max-images":"Максимально можно добавить %0 ^story-editor.images(\'%0\')"}},"story-save":{"message":{"bad":"Произошла ошибка","cat-duplicate":"Введенное название уже используется другой категорией"}},"tag":{},"tags":{"fold-mode":{"ALL":"Показывать все","NONE":"Скрывать","PARTIAL":"Сворачивать частично"}},"users":{"block-confirm":"Вы действительно хотите забанить пользователя, а также <b>безвозвратно удалить</b> все комментарии и посты данного пользователя?<p>Данная операция необратима!</p>","note-saved":"Заметка сохранена","permabanned":"Пользователь заблокирован навсегда. Причина: %0","permabanned-without-reason":"Пользователь заблокирован навсегда"},"validation-rules":{"at-least-x-characters":"Не менее %0 ^validation-rules.chars(\'%0\')","at-least-x-digits":"Как минимум %0 ^validation-rules.digits(\'%0\')","at-least-x-letters":"Как минимум %0 ^validation-rules.letters(\'%0\')","chars":["символ","символа","символов"],"digits":["цифра","цифры","цифр"],"email":"Неверный email","format":"Неверный формат","length-mismatch":"Длина строки не должна быть меньше %0 и больше %1 ^validation-rules.chars(\'%1\')","letters":["буква","буквы","букв"],"max":"Максимальное значение %0","max-tags":"Превышен максимальный лимит тегов","min":"Минимальное значение %0","min-tags":"Укажите минимум %0 ^plural.tags(\'%0\') из предлагаемых при вводе тега","not-contain-link":"Заголовок поста не должен содержать ссылку. Пожалуйста, уберите ссылку из заголовка","range-overflow":"Максимальное значение %0","range-title":"Укажите заголовок: от %0 до %1 ^validation-rules.chars(\'%1\')","range-underflow":"Минимальное значение %0","required":"Обязательное поле","too-long":"Максимальная длина %0 ^validation-rules.chars(\'%0\')","too-short":"Минимальная длина %0 ^validation-rules.chars(\'%0\')"},"warning-message":{"AUTHORIZATION_REQUIRED":"^icon(\'ui__user-message\') пожалуйста, <a href=\\"#signin\\" class=\\"to-signin\\">войдите</a> в аккаунт или <a href=\\"#signup\\" class=\\"to-signup\\">зарегистрируйтесь</a>","AUTHORIZATION_REQUIRED_NO_LINKS":"^icon(\'ui__user-message\') пожалуйста, войдите в аккаунт или зарегистрируйтесь","BANNED":"Вы временно заблокированы. Блокировка закончится %0","FULLY_BANNED":"Вы заблокированы :(","LOST_ACCOUNT":"Пожалуйста, обновите пароль для восстановления доступа","NEED_MORE_RATING":"У Вас недостаточно рейтинга для данного действия. Необходимо ещё %0","RESTORE":"Ваш аккаунт восстановлен. С возвращением! :)"}}')}},e=>{e.O(0,[583,522,216],(()=>{return t=34414,e(e.s=t);var t}));e.O()}]);