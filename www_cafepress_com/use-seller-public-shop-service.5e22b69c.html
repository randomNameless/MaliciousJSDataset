<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>use-seller-public-shop-service.5e22b69c.html</title>
</head>
<body>

<script>
import{e as Be,f as De,Z as B,$ as a,b as x,a5 as s,C as Ie}from"./entry.be43a630.js";function $e(){const{openSearchPerPage:D}=Be(),{publicShopStore:G,globalStore:H,sellerCollectionStore:i,memberStore:J}=Ie();De(H),B(J);const{memberProfile:m,shopDetail:g,searchLoading:c,searchCollectionLoading:I,searchParams:n,pageSize:K,sort:Q,designs:S,selectedDesignId:w,products:v,inputTag:Re,collections:R,collectionProducts:z,selectedCollection:u,subCollectionBreadcrumb:p,productCategories:y,feedbackLoading:A,tabs:ze,selectedTab:P,isRequestForProfile:h,publicMemberProfileId:b}=B(G),{shopCollections:Ae,collectionBreadcrumb:C,normalSort:N}=B(i),U=async e=>{const r=await a().shop.getShopMember(e);r&&(m.value={...r.profile,name:F(r.profile),address:$(r.profile)},g.value=r.store)};async function V(){var t,o;const e=x(),r=await a().member.getMemberProfile((t=e.params)==null?void 0:t.name);return(o=r==null?void 0:r.profile)!=null&&o.memberNo?(m.value={...r.profile,name:F(r.profile),address:$(r.profile)},b.value=r.profile.memberNo,!0):!1}const X=async()=>{var o;const e=x(),r=parseInt((o=e.params)==null?void 0:o.designId),t=await a().account.getMemberProfileByDesignId(r);t&&(m.value=t,b.value=t.memberNo)},F=e=>{var r;return e?e.firstName?`${e.firstName} ${e.lastName}`:e.showAlias?e.alias:(r=e.email)==null?void 0:r.split("@")[0]:"-"},$=e=>e!=null&&e.city||e!=null&&e.state?e!=null&&e.city&&(e!=null&&e.state)?`${e.city}, ${e.state}`:`${e.city}${e.state}`:"-",_=async()=>{var r;if(((r=y.value)==null?void 0:r.length)>0)return;y.value=await a().product.getShopProductCategories();let e=y.value.filter(t=>t.id>=0);e.find(t=>t.id===0).selected=!0,n.value.categories=e},ee=async()=>{try{(await a().shop.getStoreCollections(g.value.storeNo,0,10,!0)).values.length===0&&(P.value="Products")}catch(e){console.error(e)}},E=async()=>{var e,r;try{if(I.value=!0,!h.value){const t=await a().shop.getStoreCollections(g.value.storeNo,((e=u.value)==null?void 0:e.storeSectionNo)??0,10,!0,!0);R.value=((r=t.values)==null?void 0:r.filter(o=>o.caption.toLowerCase().includes(n.value.caption.toLowerCase())))??[]}}catch(t){console.error(t),s("warning","Warning","Error getting collections.",null,!0)}finally{I.value=!1}},W=async()=>{var e;if(!(!((e=u.value)!=null&&e.storeSectionNo)||c.value||n.value.noMoreProduct))try{c.value=!0;const r=await a().product.getPublicProducts({storeNo:g.value.storeNo,storeSectionNo:u.value.storeSectionNo,productTypeNos:n.value.categories.filter(o=>o.selected).map(o=>o.productTypeNos).flat(),productCaption:n.value.caption,pageSize:K.value,pageIndex:n.value.page++});n.value.noMoreProduct=r.products.length===0;const t=r.products.filter(o=>{var l;return((l=o.availableForSale)==null?void 0:l.isAvailableForSale)!==!1});z.value.push(...t)}catch(r){console.error(r),s("warning","Warning","Error getting products.",null,!0)}finally{c.value=!1}},k=async()=>{var e;if(!n.value.noMoreProduct)try{c.value=!0;const r={queryText:n.value.caption,productTypeNos:n.value.categories.some(o=>o.selected&&o.name==="All Products")?[]:n.value.categories.filter(o=>o.selected).map(o=>o.productTypeNos).flat(),storeNos:g.value.storeNo,page:n.value.page,resultsPerPage:h.value?32:D,tags:n.value.tags,priceRange:n.value.priceRange,storeSectionNo:((e=u==null?void 0:u.value)==null?void 0:e.storeSectionNo)??0,imageSize:500,isRequestForProfile:h.value,memberProfileId:b.value,sort:Q.value};let t=null;h.value?t=await a().search.getProfileDesigns(r):t=await a().search.getDesigns(r),t.length>0?(n.value.page++,S.value.push(...t)):n.value.noMoreProduct=!0}catch(r){console.error(r),s("warning","Warning","Error searching designs.",null,!0)}finally{c.value=!1}},re=async()=>{try{c.value=!0;const e=await a().search.getDesigns({productTypeNos:[],page:n.value.page,resultsPerPage:D,imageSize:500});e.length>0?(n.value.page++,S.value.push(...e)):n.value.noMoreProduct=!0}catch(e){console.error(e),s("warning","Warning","Error searching designs.",null,!0)}finally{c.value=!1}},M=()=>{f()||(L(),P.value==="Collections"?(q(),E(),W()):w.value?Z():(ce(),k()))},te=async()=>{try{A.value=!0,await a().search.RefreshSerp(g.value.storeNo)===!0&&s("success","Success","Sent successfully, see results in 5 minutes.",null,!0)}catch(e){e.statusCode===429?s("warning","Warning","You can only press this button once an hour",null,!0):s("warning","Warning","Error sending feedback.",null,!0)}finally{A.value=!1}},oe=(e,r)=>{f()||(e.id===0?e.selected?e.selected=!1:n.value.categories.forEach(t=>{t.selected=t.id===e.id}):(n.value.categories.find(t=>t.id===0).selected=!1,e.selected=!e.selected),r||M())},f=()=>c.value===!0?(s("warning","Warning","We are searching now.",null,!0),!0):!1,ne=e=>{f()||(se(e),M())},ae=async e=>{f()||(e?(u.value=e,p.value.push(e)):(p.value.pop(),u.value=p.value.length>0?p.value[p.value.length-1]:null),n.value.caption="",L(),q(),E(),W())},se=e=>{P.value=e,n.value.caption="",n.value.page=1,n.value.noMoreProduct=!1,n.value.categories.forEach(r=>{r.selected=r.id===0})},L=()=>{n.value.page=1,n.value.noMoreProduct=!1},q=()=>{R.value=[],z.value=[]},le=()=>{v.value=[],n.value.noMoreProduct=!1,n.value.caption=""},ce=()=>{S.value=[]},ue=async e=>{const r=await a().shop.getShopPrice(e);return r||s("warning","Warning","Error getting shop price.",null,!0),r},ie=async e=>{try{const r=await a().shop.updateShopPrice(e);return r||s("warning","Warning","Error saving shop prices.",null,!0),r}catch{s("warning","Warning","Error saving shop prices.",null,!0)}},ge=async e=>{const r=await a().shop.getStoreCollections(e);if(!r){s("warning","Warning","Error getting collection list.",null,!0);return}return N.value=r.normalSort,r.values},O=async e=>{const r=await a().shop.getCollectionTree(e);if(r)return r;s("warning","Warning","Error getting collection list from store.",null,!0)},de=async(e,r)=>{const t=await a().shop.getStoreCollections(e,r);if(!t){s("warning","Warning","Error loading sub-collections.",null,!0);return}return N.value=t.normalSort,t.values},ve=async(e,r,t,o,l)=>{let d={pageSize:o,pageIndex:t,productTypeNos:r,storeNo:e};l===!0&&(d.active=!0);const j=await a().product.getSellProducts(d);return j||s("warning","Warning","Error loading Products from shop.",null,!0),j},pe=async(e,r,t)=>{const o={...t,locations:null,includeSellableInfo:!1,storeSectionNo:r,storeNo:e},l=await a().shop.getCollectionProducts(o);return l||s("warning","Warning","Error loading Products.",null,!0),l},he=async e=>{const r=await a().shop.saveShopCollection(e);return r||s("warning","Warning","Error saving collection.",null,!0),r},fe=async e=>{const r=await a().shop.reOrderCollection(e);return r||s("warning","Warning","Error re-ordering collection.",null,!0),r},me=async e=>{const r=await a().shop.updateCollection(e);if(!r)s("warning","Warning","Error updating collection.",null,!0);else if(C.value.length>0){const t=[];C.value.forEach(o=>{o.storeSectionNo===e.storeSectionNo?t.push(e):t.push(o)}),i.updateBreadcrumb(t)}return r},Se=async(e,r)=>{try{return await a().shop.deleteCollection(e,r),!0}catch{return s("warning","Warning","Error deleting collection.",null,!0),!1}},we=async(e,r)=>{try{return await a().shop.deleteCollections(e,r),!0}catch{return s("warning","Warning","Error deleting collection(s).",null,!0),!1}},ye=async(e,r,t,o)=>{try{if(parseInt(r)===parseInt(t))return{success:!0};const l={storeNo:e,fromStoreSectionNo:r,storeSectionNo:t,productNos:o};return await a().shop.moveProductsToCollection(l)}catch{return s("warning","Warning","Error add products to collection.",null,!0),!1}},Pe=async(e,r,t)=>{try{const o={storeNo:e,fromStoreSectionNo:r,storeSectionNo:0,productNos:t},l=await a().shop.moveProductsToCollection(o);return(l==null?void 0:l.success)===!0?s("success","Success","Delete product(s) to collection successfully.",null,!0):s("warning","Warning","Fail to delete products.",null,!0),l}catch{return s("warning","Warning","Error removing product from collection.",null,!0),!1}},be=async e=>{const r=await a().shop.getCollectionDetails(e);return r||s("warning","Warning","Error loading collection.",null,!0),r},Ce=async e=>{const r=await a().product.getAllProductCategories(e,0);return r||s("warning","Warning","Error loading Product Categories.",null,!0),r},Ne=async(e,r)=>{if(C.value.length===0){const t=await O(e);if((t==null?void 0:t.length)>0){const o=[],l={};for(let d of t)l[d.storeSectionNo]={...d};await Y(r,l,o),i.updateBreadcrumb(o)}}},Y=(e,r,t)=>{if(r[e]){const o=r[e];t.unshift(o),o.parentSectionNo&&Y(o.parentSectionNo,r,t)}},Ee=()=>{i.updateBreadcrumb([])},We=e=>{i.redirctBreadcrumb(e)},Me=e=>{i.addBreadcrumb(e)},Te=()=>{i.backBreadcrumb()},Z=async e=>{if(v.value.length>0&&!e){T();return}try{if(le(),c.value=!0,h.value){const r=await a().search.getProfileProducts({designId:w.value,imageSize:500});r.length>0?(v.value=r,T()):n.value.noMoreProduct=!0}else{const r=await a().search.getDesignProducts({storeNo:g.value.storeNo,designId:w.value,imageSize:500});r.length>0?(v.value=r,T()):n.value.noMoreProduct=!0}}catch(r){console.error(r),s("warning","Warning","Error searching products.",null,!0)}finally{c.value=!1}},T=()=>{const e=n.value.categories.filter(r=>r.selected).map(r=>r.productTypeNos).flat();v.value.forEach(r=>{r.hide=!e.includes(r.productTypeNo)})};return{getMemberProfile:U,getMemberProfileBymemberNo:V,getMemberProfileByDesignId:X,getCategories:_,handleSearch:M,handleCategoryChange:oe,changeTab:ne,handleSelectCollection:ae,getShopPrice:ue,updateShopPrice:ie,getShopCollections:ge,getShopCollectionTree:O,getSubCollections:de,getShopSellProducts:ve,getCollectionProducts:pe,saveCollection:he,reOrderCollections:fe,normalSort:N,updateCollection:me,deleteCollection:Se,deleteCollections:we,moveProductsToCollection:ye,removeProductsFromCollection:Pe,getCollectionInfo:be,getCollectionProductCategories:Ce,initCollectionRoute:Ne,resetCollectionBreadcrumb:Ee,redirectCollectionBreadcrumb:We,addCollectionBreadcrumb:Me,backCollectionBreadcrumb:Te,hasCollections:ee,searchShopCollections:E,searchCollectionProducts:W,handleFeedBack:te,handleSearchDesignProducts:Z,searchDesigns:k,searchMemberDesigns:re}}export{$e as u};

</script>

</body>
</html>
