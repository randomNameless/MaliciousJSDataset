<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>purchase_options.min.9bec6a8e4e79.html</title>
</head>
<body>

<script>
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[8489],{91793:(S,v,p)=>{p.d(v,{A:()=>P});var w=(E,h,n)=>new Promise((m,a)=>{var _=c=>{try{b(n.next(c))}catch(f){a(f)}},i=c=>{try{b(n.throw(c))}catch(f){a(f)}},b=c=>c.done?m(c.value):Promise.resolve(c.value).then(_,i);b((n=n.apply(E,h)).next())});class P{constructor(h,n,m,a=null,_=null){this.modalCloseButtonSelector='[data-ui-el="close-modal-button"]',this.onShow=null,this.onHide=null,this.willShowModal=i=>w(this,null,function*(){this.onShow!=null&&(yield Promise.resolve(this.onShow(i))),this.scrollingParent.dataset.uiShowModal="true",this.modalElement.showModal()}),this.willHideModal=()=>w(this,null,function*(){this.onHide!=null&&(yield Promise.resolve(this.onHide())),this.scrollingParent.dataset.uiShowModal="false",this.modalElement.close()}),this.triggerSelector=h,this.modalSelector=n,this.scrollingParentSelector=m,a!=null&&(this.onShow=a),_!=null&&(this.onHide=_)}init(){var h,n;const m=document.querySelectorAll(this.triggerSelector);if(this.modalElement=document.querySelector(this.modalSelector),this.scrollingParent=document.querySelector(this.scrollingParentSelector),this.scrollingParent==null)throw new Error("Could not find scrolling parent with selector.");if(this.modalElement==null)throw new Error("Could not find modal element with selector.");if(m.length===0)throw new Error("Could not find trigger element with selector.");(h=this.modalElement.querySelector(this.modalCloseButtonSelector))==null||h.addEventListener("click",()=>{this.willHideModal()}),this.modalElement.addEventListener("click",()=>{this.willHideModal()}),(n=this.modalElement.querySelector('[data-ui-el="modal-inner-container-element"]'))==null||n.addEventListener("click",a=>{a.stopPropagation()}),m.forEach(a=>{a.addEventListener("click",()=>{this.willShowModal(a)})})}}},2681:(S,v,p)=>{var w=p(91793),P=Object.defineProperty,E=Object.defineProperties,h=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,m=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,_=(r,e,t)=>e in r?P(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,i=(r,e)=>{for(var t in e||(e={}))m.call(e,t)&&_(r,t,e[t]);if(n)for(var t of n(e))a.call(e,t)&&_(r,t,e[t]);return r},b=(r,e)=>E(r,h(e)),c=(r=>(r.DOWNLOAD="download",r.RENTAL="rental",r))(c||{});const f=r=>{r&&r.forEach(e=>C(e))},C=r=>{r&&r.style.setProperty("display","none")},k='[data-ui-el="nfb-purchase-options-button-container"]',M='[data-ui-el="rent-button"]',O='[data-ui-el="buy-button"]',B='[data-ui-el="label"]',U='[data-ui-el="spinner"]',D='[data-ui-el="download-product-links-home"]',I='[data-ui-el="download-product-edu-home"]',H='[data-ui-el="nfb-purchase-options-errors-container"]',T='[data-ui-el="other-options-label"]';class q{constructor(){this.rentalError=!1,this.downloadError=!1}init(){document.querySelector('[data-ui-el="licence-infos-modal"]')&&new w.A('[data-ui-el="licences-button"]','[data-ui-el="licence-infos-modal"]',"html").init();try{this.errorsContainers=document.querySelectorAll(H),this.rentButtons=document.querySelectorAll(M),this.rentButtons.length>0&&(this.rentVerifyAccess=new L(this.rentButtons[0],"rental"),this.rentVerifyAccess.verifyRental().catch(e=>{this.rentalError=!0,this.addUnavailableMessage(e,"rental")})),this.buyButtons=document.querySelectorAll(O),this.buyButtons.length>0&&(this.downloadVerifyAccess=new L(this.buyButtons[0],"download"),this.downloadVerifyAccess.verifyDownload().catch(e=>{this.downloadError=!0,this.addUnavailableMessage(e,"download")}))}catch{}}addUnavailableMessage(e,t){let o=t.toString();(t==="download"&&this.rentalError||t==="rental"&&this.downloadError)&&(o="rentalAndDownload",f(document.querySelectorAll(T)));let s=window.PURCHASE_OPTIONS_UNAVAILABLE_MESSAGES.generic;e.territory_available&&e.country===null?s=window.PURCHASE_OPTIONS_UNAVAILABLE_MESSAGES[o].geolocation:!e.segda_available||!e.territory_available?s=window.PURCHASE_OPTIONS_UNAVAILABLE_MESSAGES[o].segda:e.access_available||(s=window.PURCHASE_OPTIONS_UNAVAILABLE_MESSAGES[o].forbiddenTerritory),this.errorsContainers.forEach(d=>{d.setAttribute("has-message","true"),d.innerHTML=`<div class="nfb-inline-message"><i class="nfb-icon icon-warning-o"></i><span>${s}</span></div>`});let l;switch(t){case"rental":l=this.rentButtons;break;case"download":l=this.buyButtons;break}l?.forEach(d=>{const y=d.closest(k);y?y.remove():d.remove()})}}class L{constructor(e,t){this.geolocationPath="/remote/access_rights/geolocation/";try{if(this.element=e,this.type=t,this.language=this.element.dataset.language,!this.language)throw new Error("Verify Segda Access - Missing language value in data attributes.");if(this.registryId=this.element.dataset.id_registre,!this.registryId)throw new Error("Verify Segda Access - Missing registry id value in data attributes.");this.url=this.geolocationPath+this.registryId}catch{}}verifyDownload(){var e,t,o;const s={product_type:(t=(e=this.type)==null?void 0:e.toString())!=null?t:"",language:(o=this.language)!=null?o:""},l=b(i({},s),{market:"home"}),d=fetch(`${this.url}?${new URLSearchParams(i({},l)).toString()}`,{method:"GET"}),y=b(i({},s),{market:"education"}),A=fetch(`${this.url}?${new URLSearchParams(i({},y)).toString()}`,{method:"GET"});return Promise.all([d,A]).then(([u,g])=>u.status!==200&&g.status!==200?Promise.reject({access_available:!1}):Promise.all([u.json(),g.json()])).then(([u,g])=>{if(!this.isAvailable(u)&&!this.isAvailable(g))return Promise.reject(u);this.isAvailable(u)?this.isAvailable(g)||f(this.element.querySelectorAll(I)):f(this.element.querySelectorAll(D)),this.updateDisplay("download")})}verifyRental(){var e,t,o;const s={product_type:(t=(e=this.type)==null?void 0:e.toString())!=null?t:"",language:(o=this.language)!=null?o:"",market:"home"};return fetch(`${this.url}?${new URLSearchParams(i({},s)).toString()}`,{method:"GET"}).then(l=>l.status!==200?Promise.reject({access_available:!1}):l.json()).then(l=>{if(!l||!this.isAvailable(l))return Promise.reject(l);this.updateDisplay("rental")})}isAvailable(e){return e?e.segda_available&&e.territory_available&&e.access_available:!1}updateDisplay(e){var t;const o=(t=this.element.dataset.label)!=null?t:"",s=e==="rental"?M:O,l=`${s} ${B}`,d=`${s} ${U}`;document.querySelectorAll(l).forEach(A=>{var u;A.innerHTML=o,(u=A.closest(".nfb-button"))==null||u.removeAttribute("disabled")}),f(document.querySelectorAll(d))}}const V=new q;document.addEventListener("DOMContentLoaded",()=>{V.init()})},35424:()=>{}},S=>{var v=w=>S(S.s=w);S.O(0,[3524],()=>(v(2681),v(35424)));var p=S.O()}]);

</script>

</body>
</html>
