/*! @permutive/javascript-sdk v20.23.0 (web) (built 2024-11-22T20:07:57.948Z) */(()=>{"use strict";var __webpack_modules__={2865:(e,t,n)=>{function r(e){return e instanceof Error?e:new Error("string"==typeof e?e:JSON.stringify(e))}n.d(t,{w:()=>r})},3939:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(2275),i=n(9727);function s(e){return(0,r.zG)((0,i.Y3)((()=>JSON.parse(e))),(0,i.fS)(r.gn))}},1819:(e,t,n)=>{n.r(t),n.d(t,{CleanRoomAddon:()=>v,load:()=>m});var r=n(3636),i=n(2865),s=n(366),o=n(1385),a=n(2275),c=n(9727),u=n(9246),l=n(5460),d=n(7387),f=n(731),g=n(6707);class p{prefix="[clean_room]";api;sessionManager;permutive;logger;clientContext;viewId;async putOrResetUnprocessed(e){return(0,a.zG)(e,c.g_((()=>u.Y3((()=>this.unprocessedPrebidAuctions.reset()),i.w)),(e=>u.Y3((()=>this.unprocessedPrebidAuctions.put(e)),i.w))),u.vx((e=>(this.reportError(`Unprocessed auctions failed to put. Got ${e}`),u.F2((0,a.Q1)())))),(e=>e()))}unprocessedPrebidAuctions;debouncedPutOrResetUnprocessed=this.setupUnprocessedPrebidAuctions();stagedAuctions={};trackableAuctions={};get allAuctions(){return{...this.stagedAuctions,...this.trackableAuctions}}trackAuctionsInterval=null;constructor(e){this.permutive=e.permutive,this.api=e.api,this.logger=e.logger,this.unprocessedPrebidAuctions=e.unprocessedEvents.PrebidAuctions,this.sessionManager=e.sessionManager,this.clientContext=e.clientContext,this.viewId=e.viewId,(0,a.zG)(e.pbjs,l.UI(c.EQ((()=>{this.logInfo("Waiting for PrebidJS to start PrebidAuctions tracking...")}),(e=>this.startPrebidAuctions(e)))))}async startPrebidAuctions(e){await this.trackUnprocessedPrebidAuctions(),this.logDebug("Starting PrebidAuctions tracking",{prebid:e});const t=(0,g.zi)(e),n=e=>0===e.bidsReceived.length&&0===e.noBids.length?null:(0,a.zG)(this.mapToStagedAuctions(e),o.tS((()=>o.Y3((()=>e.bidsReceived.forEach((e=>{var n;("rendered"===(n=e).status||"targetingSet"===n.status)&&this.setBidToWon(t,e)}))),(e=>{const t=`Failed to process auction. Got ${(0,i.w)(e)}`;return this.reportError(t),(0,i.w)(t)})))));e.onEvent("auctionEnd",(e=>{n(e),this.storeAuctionsAsUnprocessed(this.allAuctions)}));const r=n=>{const r=(0,d.qh)(n);this.logDebug("Processing setTargeting event",{adUnitCodes:r});const i=o.DT((e=>{let[t,n]=e;return!!t&&!!n.hb_adid}),(()=>new Error("Missing targeting data"))),c=(0,a.ls)(i,o.tS((t=>{let[n,{hb_adid:r}]=t;return(0,a.zG)(e.getAllPrebidWinningBids(),(0,s.Ew)((e=>e.adId===r&&e.adUnitCode===n)),o.Yo((()=>new Error("Prebid winning bid does not exist"))))})),o.UI((e=>{this.setBidToWon(t,e)})));return r.forEach(c)};e.onEvent("setTargeting",(e=>{r(e),this.storeAuctionsAsUnprocessed(this.allAuctions)})),e.onEvent("bidWon",(e=>{this.setBidToWon(t,e),this.storeAuctionsAsUnprocessed(this.allAuctions)}));const c=(e,n)=>{this.logDebug("Processing render event",{isRendered:e,props:n}),n.bid&&(e&&this.setBidToRendered(t,n.bid),this.promoteAuctionToTrackable(n.bid),this.storeAuctionsAsUnprocessed(this.allAuctions),this.trackEligibleAuctions())};e.onEvent("adRenderSucceeded",(e=>{c(!0,e)})),e.onEvent("adRenderFailed",(e=>{c(!1,e)})),e.getEvents().forEach((e=>"auctionEnd"===e.eventType?n(e.args):"setTargeting"===e.eventType?r(e.args):"bidWon"===e.eventType?this.setBidToWon(t,e.args):"adRenderSucceeded"===e.eventType?c(!0,e.args):"adRenderFailed"===e.eventType?c(!1,e.args):void 0)),this.storeAuctionsAsUnprocessed(this.allAuctions,{debounced:!1}),(0,d.aT)((async()=>{this.trackAuctionsInterval=null;const e=this.allAuctions;this.stagedAuctions={},this.trackableAuctions={},await this.trackPrebidAuctions(e,{useBeacon:!0}),await this.storeAuctionsAsUnprocessed(null,{debounced:!1})}))}trackUnprocessedPrebidAuctions(){return(0,a.zG)(u.Y3((async()=>(0,a.zG)(await this.unprocessedPrebidAuctions.getIfPresent(),c.g_((()=>this.logDebug("No unprocessed PrebidAuctions found")),(e=>{let{props:t,...n}=e;return this.logDebug("Found unprocessed PrebidAuctions",{props:t,unprocessedData:n}),Promise.all([this.permutive.track("PrebidAuctions",t,{unprocessedData:n}),this.unprocessedPrebidAuctions.reset()])})))),(e=>{const t=`Failed to track unprocessed PrebidAuctions. Got ${(0,i.w)(e)}`;return this.reportError(t),(0,i.w)(t)})),(e=>e()))}setupUnprocessedPrebidAuctions(){const e=new f.b(1e3,2500),t=this.putOrResetUnprocessed.bind(this);return e.schedule(t)}async storeAuctionsAsUnprocessed(e){let{debounced:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.logDebug("Store auctions as unprocessed",{auctionsToStore:e,debounced:t});const n=u.Y3((async()=>{const t=(0,d.qh)(e??{}).map((e=>{let[t,n]=e;return{...n,auction_id:t}})),n=await this.clientContext.getClient();return(0,a.zG)(t,c.DT((e=>e.length>0)),c.UI((e=>({client:n,props:this.makePrebidAuctionProperties({auctions:e}),viewId:this.viewId.get(),sessionId:this.sessionManager.getSessionId()}))))}),i.w);return(0,a.zG)(n,u.EQ((e=>{this.reportError(`Failed to process auctions: ${e}`)}),(e=>{const n=this.debouncedPutOrResetUnprocessed(e);return t?n:Promise.all([this.putOrResetUnprocessed(e),n])})),(e=>e()))}mapBidProperties(e,t){var n;return{ad_id:t.adId,ad_unit_code:t.adUnitCode,advertiser_domains:(0,g.Cg)(t),advertiser_id:(e=>{var t,n;const r=e.rubicon&&"object"==typeof e.rubicon&&"advertiserId"in e.rubicon&&e.rubicon.advertiserId||(null==e||null===(t=e.meta)||void 0===t?void 0:t.buyerId)||(null==e||null===(n=e.meta)||void 0===n?void 0:n.advertiserId);return r?`${r}`:void 0})(t),advertiser_name:(e=>{var t,n,r;const i=(null===(t=e.meta)||void 0===t?void 0:t.clickUrl)||(null===(n=e.adomain)||void 0===n?void 0:n[0])||(null===(r=e.meta)||void 0===r?void 0:r.advertiserName);return i?`${i}`:void 0})(t),bid_available:"string"==typeof t.statusMessage&&t.statusMessage.indexOf("empty")<0,bidder:t.bidder,bidder_timeout:(0,d.rH)(e.bidderTimeout),brand_id:(e=>{var t;const n=null===(t=e.meta)||void 0===t?void 0:t.brandId;return n?`${n}`:void 0})(t),brand_name:(e=>{var t;return null===(t=e.meta)||void 0===t?void 0:t.brandName})(t),cpm:(0,g.Qd)(t),creative_id:`${t.creativeId}`,deal_id:(0,g.$7)(t),dsp_id:(0,g.cs)(t),hb_pb:null===(n=t.adserverTargeting)||void 0===n?void 0:n.hb_pb,height:(0,d.rH)(t.height),request_timestamp:t.requestTimestamp,response_timestamp:t.responseTimestamp,time_to_respond:t.timeToRespond,width:(0,d.rH)(t.width)}}collectAdUnitCodes(e){const t=new Set;return e.reduce(((e,n)=>{let{adUnitCode:r}=n;return!r||t.has(r)||(t.add(r),e.push({ad_unit_code:r})),e}),[])}mapToStagedAuctions(e){return o.Y3((()=>{const{auctionId:t,bidsReceived:n,noBids:r}=e,i=this.collectAdUnitCodes(n),s=this.collectAdUnitCodes(r);return this.stagedAuctions[t]={bids:i,no_bids:s},this.logDebug("Added auction",this.stagedAuctions[t]),this.stagedAuctions[t]}),(e=>{const t=`Failed to map auction. Got ${(0,i.w)(e)}`;return this.reportError(t),(0,i.w)(t)}))}findAuction(e){return(0,a.zG)(this.getStagedAuction(e.auctionId),o.vx((()=>this.getTrackableAuction(e.auctionId))),o.vx((()=>this.mapToStagedAuctions({auctionId:e.auctionId,bidsReceived:[e],bidderRequests:[],noBids:[]}))))}setBidByOperation(e,t,n){const r=e=>e.hasOwnProperty("ad_id"),c=(n,c)=>{const u=e=>e.ad_id===n.adId,l=e=>e.ad_unit_code===n.adUnitCode,[d,f]=(0,a.zG)(c,(0,s.uK)((e=>r(e)&&u(e)&&l(e))),(e=>[e.left,e.right]));this.logDebug(`Bids for ${t}`,{nonMatching:d,matching:f});const g=(0,a.ls)(o.DT((e=>1===e.length),(()=>new Error("No matching bids"))),o.UI((e=>{let[n]=e;return this.logDebug(`Found bid for ${t}`,{found:n}),{found:n,others:d}}))),p=o.DT((e=>e.length<=1),(()=>new Error("Ad ID is not unique"))),h=(0,a.ls)(g,o.vx((()=>o.Y3((()=>{const i=this.mapBidProperties(e,n),s=d.filter((e=>!(!l(e)||!r(e))||!l(e)));return this.logDebug(`Creating bid for ${t}`,{created:i,others:s}),{found:i,others:s}}),(e=>(0,i.w)(`Failed to create bid. Got ${(0,i.w)(e)}`))))));return(0,a.zG)(f,p,o.tS(h))};return(0,a.ls)((e=>(0,a.zG)(this.findAuction(e),o.tS((r=>(0,a.zG)(c(e,r.bids),o.tS((e=>{let{found:t,others:r}=e;return o.Y3((()=>({updated:n(t),others:r})),i.w)})),o.UI((e=>{let{updated:n,others:i}=e;const s=[n,...i];r.bids=s,this.logDebug(`Bid operation ${t} successful`,n,s)}))))))),o.Vn((e=>{const n=`Failed bid operation ${t}. Got ${(0,i.w)(e)}`;return this.reportError(n),(0,i.w)(n)})))}setBidToWon(e,t){return this.setBidByOperation(e,"setWon",(e=>({...e,winning_bid:!0})))(t)}setBidToRendered(e,t){return this.setBidByOperation(e,"setRendered",(e=>({...e,winning_bid:!0,is_rendered:!0,rendered_timestamp:(new Date).getTime()})))(t)}promoteAuctionToTrackable(e){let{auctionId:t}=e;const n=this.stagedAuctions[t];if(n){if(this.trackableAuctions[t])return this.logError("Auction is already promoted to trackable",{auction:this.trackableAuctions[t]});this.trackableAuctions[t]=n,delete this.stagedAuctions[t],this.logDebug("Auction promoted to trackable",{auctionId:t,trackableAuctions:this.trackableAuctions})}}trackEligibleAuctions(){if(this.trackAuctionsInterval)return;this.trackAuctionsInterval=(0,d.PQ)((async()=>{if(!this.trackAuctionsInterval)return;this.trackAuctionsInterval=null;const e=this.trackableAuctions;this.trackableAuctions={},await this.trackPrebidAuctions(e),await this.storeAuctionsAsUnprocessed(this.stagedAuctions,{debounced:!1})}),{timeout:5e3})}async trackPrebidAuctions(e,t){const n=(0,d.qh)(e).map((e=>{let[t,n]=e;return{...n,auction_id:t}}));n.length&&(await this.permutive.track("PrebidAuctions",this.makePrebidAuctionProperties({auctions:n}),t),this.logDebug("Tracked auctions",{auctions:n}))}makePrebidAuctionProperties(e){return{aggregations:e,isp_info:"$ip_isp_info",geo_info:"$ip_geo_info"}}getStagedAuction(e){return(0,a.zG)(this.stagedAuctions[e],o.DT(Boolean,(()=>new Error("Staged auction not found"))),o.Vn((t=>(this.logError(t,{auctionId:e}),t))))}getTrackableAuction(e){return(0,a.zG)(this.trackableAuctions[e],o.DT(Boolean,(()=>new Error("Trackable auction not found"))),o.Vn((t=>(this.logError(t,{auctionId:e}),t))))}reportError(e){return this.api.reportError(`${this.prefix} ${e}`)}logInfo(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.log(this.prefix,...t)}logDebug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.debug(this.prefix,...t)}logError(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.error(this.prefix,...t)}}const h="clean_room",m=e=>{(0,r.Hn)(h)("auto_init",!1)&&e.q.push({functionName:"addon",arguments:[h,{}]})};class v extends p{}},3775:(e,t,n)=>{n.r(t),n.d(t,{SspAddon:()=>F,filterCohortsUsedInTargeting:()=>M,load:()=>L,realService:()=>T,sspService:()=>R,stubService:()=>A});var r=n(5460),i=n(3636),s=n(2275),o=n(1583),a=n(936),c=n(2925),u=n(7560),l=(n(1890),n(1385)),d=n(8940),f=(n(3812),n(1586));const g=e=>[e,d.of(e)],p=f.li,h=f.Yg,m=e=>g(l.F2(e));var v=n(9727);const _="RefEventual",b=e=>t=>r.vP((0,s.zG)(t,r.UI(p),r.UI(e)),(0,s.zG)(t,r.UI(h),r.UI(d.UI(e)))),w=e=>t=>r.vP((0,s.zG)(r.vP((0,s.zG)(e,r.UI(p)),(0,s.zG)(t,r.UI(p))),r.UI((e=>{let[t,n]=e;return n(t)}))),(0,s.zG)(r.vP((0,s.zG)(e,r.UI(h)),(0,s.zG)(t,r.UI(h))),r.UI((e=>{let[t,n]=e;return d.ap(t)(n)})))),y=r.UI(p),k={URI:_,map:(e,t)=>b(t)(e)},I={URI:_,map:k.map,ap:(e,t)=>w(t)(e)},S="RefEventualEither",E=e=>r.a9(m(e)),P=u.UI(k,l.dO),G=c.ap(I,l.G5),U=e=>(e=>t=>{const n=t();return(0,s.zG)(r.fF((()=>n)),r.UI(v.fS((()=>e))),r.UI((e=>(0,s.bc)(e,(()=>n)))))})(l.F2(e)),z={URI:S,map:(e,t)=>P(t)(e)},D={URI:S,map:z.map,ap:(e,t)=>G(t)(e)};n(817);var q=n(7387);const C=(e,t)=>n=>({all:(0,s.zG)(n,P(e)),byAdServer:(0,q.mQ)((0,s.ls)(t,v.UI((e=>(0,s.zG)(n,P(e))))))});var O=n(9246),x=n(7029);const R=T;function A(e,t,n,i,s){return a.of({cohorts:v.YP,externalData:{[$]:r.a9(v.YP)}})}function T(e,t,n,u,l){const d=(0,i.Hn)(j),f=d("ssps",o.cS),g=d("all_cohort_mapping",{}),p=f.includes("google_pps"),h=d("affinity_enabled",!1);return(0,s.zG)(l.consent,a.KD([[e=>!e,a.of(E(v.YP))],a.K4((i=>{let{stopped:a}=i;u.debug("[ssp] Addon started, affinity enabled: ",h);const d=(0,s.zG)(l.cohorts,P((0,s.ls)(o.hX((e=>e in g)),o.tS((e=>g[e]))))),f=(0,s.zG)(r.vP(l.url,a),r.UI((e=>{let[t,n]=e;return(0,s.zG)(t,v.hX((()=>h&&!n)))})),r.UI(v.UI((n=>O.Y3((()=>e.req({method:"GET",url:t.getEndpointUrl("/standard-audiences/v1/affinity",v.YP,[["url",n]]),withCredentials:!1,dataType:"json"})),String)))),r.UI(v.UI(O.Vn((0,q.bw)((e=>n(`Failed to fetch affinity cohorts: ${e}`)))))),r.UI(v.UI(O.UI((e=>e.affinity_values)))),r.UI(v.fS((()=>O.of(o.bM())))),r.VS(U(o.bM())));return(0,s.zG)((0,c.gz)(D)(d,f),P(o.xH),P((e=>[...new Set(e)])),P(v.G))}))]),a.UI(r.xH),a.UI((e=>({cohorts:(0,s.zG)(e,P(v.fS((()=>o.bM()))),C((e=>e),(e=>"dfp"===e.id&&p?v.G(M):v.YP)),v.G),externalData:{[$]:(0,s.zG)(y(e),r.UI(v.Uo),r.UI(v.xH),r.UI(v.UI(M)),r.D8(v.Eh(o.Eh(x.Eq))),r.UI(v.UI((e=>({ssps:f,cohorts:e})))))}}))))}const M=e=>[...new Set(e.map((e=>e.replace(/-ac$/,"").replace(/-aw$/,"").replace(/-c$/,""))))],j="ssp",L=e=>{(0,i.Hn)(j)("auto_init",!1)&&e.q.push({functionName:"addon",arguments:[j,{}]})};class F{constructor(e){}}const $="_pssps"},3812:(e,t,n)=>{n.d(t,{GL:()=>a,HJ:()=>c,N1:()=>d,NC:()=>r,RP:()=>i,SF:()=>f,UM:()=>u,ho:()=>p,iE:()=>g,t_:()=>l});const r=performance.now(),i=(new Date).getTime();let s=[],o=!1;const a=e=>function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return c((()=>e(...n)))},c=(e,t)=>{if(!o){const n=self.setTimeout(e,t);return()=>self.clearTimeout(n)}let n;const r=()=>{void 0!==n&&o&&s.length<1e4&&s.push([n,performance.now()]),n=void 0},i=[self.setTimeout((()=>{n=performance.now(),self.requestAnimationFrame(r),e()}),t),self.setTimeout(r,t)];return()=>{void 0===n&&i.forEach((e=>self.clearTimeout(e)))}},u=(e,t)=>{if(!o){const n=self.setInterval(e,t);return()=>self.clearInterval(n)}let n=!1,r=()=>{};const i=self.setInterval((()=>{r=c((()=>{n||e()}))}),t);return()=>{n=!0,r(),self.clearInterval(i)}},l=e=>new Promise(((t,n)=>e.then(a(t),a(n)))),d=e=>()=>l(e()),f=e=>{const t=d(e);return()=>new Promise((e=>c((()=>e(t())))))},g=()=>{const e=s;return s=[],e},p=e=>{o=e}},5460:(e,t,n)=>{n.d(t,{ap:()=>w,a9:()=>v,Ue:()=>p,gS:()=>h,D8:()=>z,VS:()=>y,xH:()=>k,En:()=>m,p4:()=>U,fF:()=>P,UI:()=>b,Rp:()=>I,vP:()=>S,bw:()=>D,yY:()=>G,YP:()=>_});var r=n(2865),i=n(1385),s=n(2275),o=n(9727),a=n(1583),c=n(7387);function u(e){let t=e,n=[],r=!1;return{addListener(e){if(r)return()=>{};let i=t;const s=()=>{Object.is(t,i)||(i=t,e(t))};n=[...n,s];return()=>{n=n.filter((e=>e!==s))}},notify(e){if(r)throw new Error("Ref bug: Attempted to notify a terminated notifier");Object.is(e,t)||(t=e,n.forEach((e=>e())))},terminate(){r=!0,n=[]}}}function l(e,t){let n=0;return function(){try{if(n++>0)throw new Error(e);return t(...arguments)}finally{n--}}}function d(e,t){let n=[...new Set(e)].filter((e=>"final"!==e.state));if(0===n.length)return{state:"final",onStateChange:()=>()=>{}};const r=()=>0===n.length?"final":n.some((e=>"might_change"===e.state))?"might_change":"nominal",[i,s]=f(r(),(e=>"might_change"!==e&&t())),o=()=>s(r());return n.forEach((t=>{t.onStateChange((t=>{switch(t){case"final":n=e.filter((e=>"final"!==e.state)),o();break;case"might_change":s("might_change");break;case"nominal":o();break;default:throw new Error(`Ref bug: Invalid state ${t}`)}}))})),i}function f(e,t){if("final"===e)return[{state:"final",onStateChange:()=>()=>{}},()=>{}];const{terminate:n,notify:r,addListener:i}=u(e),s={state:e,onStateChange:i},o=l("Disallowed recursion in Branch.",(e=>{if("final"===s.state){if("final"===e)return;throw new Error(`Attempted to change state of final branch to ${e}.`)}try{null==t||t(e),s.state=e,r(e)}finally{"final"===e&&n()}}));return[s,o]}var g=n(2444);function p(e){const[t,n,r]=function(){const[e,t]=f("nominal"),n=l("Disallowed recursion in Branch.",(n=>{if("final"===e.state)throw new Error("Attempted to mutate a finalized Ref.");const r=e.state;try{t("might_change"),n()}finally{t(r)}}));return[e,n,()=>t("final")]}(),[i,s]=q(t,e);return[i,e=>n((()=>s(e))),r]}function h(e){let t=e.empty;const n=()=>()=>{const n=t;return t=e.empty,n},[r,i,s]=p(n());return[r,r=>{t=e.concat(t,r),i(n())},s]}function m(e,t){return n=>{let r=new Array(e).fill(t.empty);return new Array(e).fill(null).map(((e,i)=>(0,s.zG)(n,b(g.UI((e=>{const n=t.concat(r[i],e);return r=r.map(((n,r)=>r===i?t.empty:t.concat(n,e))),n}))))))}}function v(e){return{get current(){return e},onChange:()=>()=>{},branch:{state:"final",onStateChange:()=>()=>{}}}}function _(e){return t=>{const n=t.onChange(e);return e(t.current),n}}function b(e,t){if(t){const[n,r]=q(t.branch,e(t.current));return t.onChange((t=>r(e(t)))),n}return t=>b(e,t)}const w=e=>y((t=>b(t)(e)));function y(e,t){return t?k(b(e,t)):t=>k(b(e,t))}function k(e){if("final"===e.branch.state)return e.current;const[t,n]=function(e,t){let n=t;const r=[e.state,n.state].includes("might_change")?"might_change":"nominal",[i,s]=f(r),o=e=>t=>{switch(t){case"final":s(e().state);break;case"might_change":s("might_change");break;case"nominal":"might_change"===e().state?s("might_change"):s("nominal");break;default:throw new Error(`Ref bug: Unexpected upstream state ${t}`)}};e.onStateChange(o((()=>n)));const a=o((()=>e));let c=n.onStateChange(a);return[i,e=>{n=e,c(),c=e.onStateChange(a),a(n.state)}]}(e.branch,e.current.branch),[r,i]=q(t,e.current.current);let s=e.current.onChange(i);return e.onChange((e=>{s(),s=e.onChange(i),n(e.branch),i(e.current)})),r}function I(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{if(2===t.length){let n=t[0];return b((e=>(n=t[1](n,e),n)),e)}let n=o.bM();return b((e=>{const r=t[0](n,e);return n=o.G(r),r}),e)}}function S(){if(0===arguments.length||C(arguments.length<=0?void 0:arguments[0]))return E(...arguments);const e=arguments.length<=0?void 0:arguments[0],t=Object.keys(e);return(0,s.zG)(Object.values(e),(e=>E(...e)),b((0,s.ls)(a.Su(((e,n)=>[t[e],n])),Object.fromEntries)))}function E(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)return v([]);if(1===t.length)return b((e=>[e]))(t[0]);let r=!1;t.forEach((e=>e.onChange((()=>{if("might_change"!==e.branch.state)throw new Error("Ref bug: Received a change notification without a `might_change` state.");r=!0}))));const i=t.map((0,c.vg)("branch")),s=()=>{r&&(r=!1,u(t.map((e=>e.current))))},o=d(i,s),[a,u]=q(o,t.map((e=>e.current)));return a}function P(e){const[t,n,r]=p(o.YP);return e().then((0,s.ls)(o.G,n,r)),t}const G=e=>()=>o.pC(e.current)?Promise.resolve(e.current.value):new Promise((t=>{const n=(0,s.zG)(e,_(o.UI((e=>{n(),t(e)}))))}));function U(e){const[t,n,a]=p(o.YP);return e.then(i.F2).catch((0,s.ls)(r.w,i.t$)).then((0,s.ls)(o.G,n,a)),t}function z(e){const t=e.hasOwnProperty("equals")?e.equals:e;return function(e){return t=>{if("final"===t.branch.state)return t;let n=o.YP;return b((t=>{if(o.Wi(n))return n=o.G(t),t;const r=e(n.value,t);return n=o.G(r),r}),t)}}(((e,n)=>t(e,n)?e:n))}function D(e){return t=>(_(e)(t),t)}function q(e,t){if("final"===e.state)return[v(t),()=>{}];const n=u(t);e.onStateChange((e=>{"final"===e&&n.terminate()}));let r=t;return[{get current(){return r},onChange:n.addListener,branch:e},l("Disallowed recursion in Ref.",(e=>{r=e,n.notify(r)}))]}function C(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)&&"function"==typeof e.onChange}},936:(e,t,n)=>{n.d(t,{K4:()=>c,KD:()=>h,UI:()=>d,ak:()=>p,bw:()=>f,dQ:()=>u,of:()=>l,vP:()=>g});var r=n(5460),i=n(2275),s=n(7387),o=n(7054),a=n(9727);const c=e=>(0,i.ls)((t=>{let{previousState:n,...r}=t;return e(r)}),(e=>({value:e,state:r.a9(void 0)}))),u=i.yR,l=(0,i.ls)(i.a9,c),d=e=>t=>(0,i.ls)(t,(0,s.rO)({value:e})),f=e=>t=>(0,i.ls)(t,(0,s.rO)({value:(0,s.bw)(e)}));function g(e){return t=>{let{previousState:n,...s}=t;const a=_(n)?n:{},c=(0,i.zG)(e,o.Su(((e,t)=>t({previousState:a[e],...s}))));return{value:(0,i.zG)(c,o.UI((e=>e.value))),state:(0,i.zG)(c,o.UI((e=>e.state)),(e=>r.vP(e)))}}}function p(e,t){return n=>(0,i.ls)((0,s.rO)({previousState:v}),(s=>{const o=n(s),a=t(o.value)({...s,previousState:s.previousState[e]});return{value:(0,i.zG)([o.value,a.value],(t=>{let[n,r]=t;if(!_(n))throw new Error("Service.bind() was passed an upstream Service with a non-record value.");return{...n,[e]:r}})),state:(0,i.zG)(r.vP(o.state,a.state),r.UI((t=>{let[n,r]=t;if(void 0===n)return{[e]:r};if(!_(n))throw new Error("Service.bind() was passed an upstream Service with a non-record state.");return{...n,[e]:r}})))}}))}const h=e=>{const t=e.slice(0,-1),n=e.slice(-1)[0],o=[...t.map((e=>{let[t,n]=e;return[t,(0,i.a9)(n)]})),(0,i.a9)(n)];return a=(0,s.lo)(o),(0,i.ls)(r.UI(a),m);var a};function m(e){const t=(0,i.zG)(e,r.Rp(0,(e=>e+1)));return n=>{let{previousState:s,stopped:o,...c}=n;return(0,i.zG)(r.vP(e,t),r.Rp(((e,n)=>{let[u,l]=n;return(0,i.zG)(e,a.UI((e=>e.state.current)),a.fS((()=>s)),(e=>u({previousState:e,stopped:(0,i.zG)(r.vP(o,t),r.UI((e=>{let[t,n]=e;return t||n!==l}))),...c})))})),(e=>({value:r.UI((e=>e.value),e),state:r.VS((e=>e.state),e)})))}}function v(e){return _(e)?e:{}}function _(e){return"object"==typeof e&&null!==e}},7222:(e,t,n)=>{n(3247)},5842:(e,t,n)=>{n.d(t,{lg:()=>p,Bt:()=>m});var r=n(366),i=n(2275),s=n(9727),o=n(7029),a=n(7387);class c{userId;network;api;logger;constructor(e,t,n,r){this.userId=e,this.network=t,this.api=n,this.logger=r}tag="appnexus";ttlInSeconds=86400;usedForThirdPartyData=!0;url="https://ib.adnxs.com/getuidj";invalidAliases=["","0","-1"];getId(){return this.logger.debug("identities[appnexus]: start HTTP request"),(0,a.G6)(navigator.userAgent)?Promise.resolve({type:"skipped"}):this.api.appnexus(this.url).then((e=>(this.logger.debug("identities[appnexus]: end HTTP request"),{type:"attempted",result:(0,i.zG)((0,s.DT)((e=>this.isValidAlias(e.uid)))(e),(0,s.UI)((e=>e.uid)))})),(e=>({type:"attempted",result:s.YP})))}reset(){return Promise.resolve()}isValidAlias(e){return!!e&&-1===this.invalidAliases.indexOf(e)}}var u=n(5460),l=n(7054),d=n(3940),f=n(1385);const g=d.ff((e=>void 0===e));class p{metrics;trace;permutiveData;identityProviderEnv;logger;ref;setReady;thirdParty;rawRef;identityMapRef;setIdentityMap;providers={};static emailSHA256Regex=/^[a-f0-9]{64}$/;constructor(e,t,n,r,c){this.metrics=e,this.trace=t,this.permutiveData=n,this.identityProviderEnv=r,this.logger=c;const d=this.getCachedIdentitiesAndMigrateIfRequired(),[f,p]=u.Ue(d);this.identityMapRef=f,this.setIdentityMap=p,f.onChange((0,i.ls)(l.z7((e=>!h.has(e))),(0,a.bw)((e=>{this.logger.debug("[identities] Persisting",e),this.permutiveData.setData("identities",e)})))),this.rawRef=(0,i.zG)(f,u.UI((0,i.ls)(l.UI((e=>e.value)),l.hX(g))),u.D8(l.Eh(o.Eq)));const[m,v]=u.Ue(!1);this.ref=(0,i.zG)(u.vP(m,this.rawRef),u.UI((e=>{let[t,n]=e;return(0,i.zG)(n,(0,s.DT)((()=>t)))}))),this.setReady=()=>{e.trackTimeSinceInit("sdk_lifecycle_timestamps",{timestamp_name:"identity_ready",time_origin:"sdk_init"}),v(!0)},this.thirdParty=this.prepareThirdPartyIdentities()}get identities(){return this.identityMapRef.current}prepareThirdPartyIdentities(){this.logger.debug("[Identities]","loading 3rd party identities");const e=this.metrics.startTimer("sdk_get_third_party_identities_task_duration_seconds",{}),t=this.trace.startSpan("load_tpd_ids"),n=[{load:e=>(e.config,e.network,e.api,e.userId,e.logger,s.YP)},{load:e=>{return t=e.userId,n=e.network,r=e.api,i=e.logger,(0,s.G)(new c(t,n,r,i));var t,n,r,i}},{load:e=>(e.cookies,e.messages,s.YP)},{load:e=>(e.cookies,s.YP)},{load:e=>(e.metrics,e.permutiveData,e.permutive,e.messages,s.YP)}],o=(0,r.oA)(n.map((e=>e.load(this.identityProviderEnv)))).map((e=>this.shouldAskForNewIdentity(e)?this.retrieveIdentity(e):Promise.resolve((0,i.bc)(e,this.getCachedTPDIdentity(e.tag)))));return Promise.all(o).then((e=>e.map((e=>{let[t,n]=e;return this.providers[t.tag]=t,this.mapTPDIdentityIfPresent(t.tag,n,t.ttlInSeconds)})))).then((e=>this.setIdentities(e))).then((0,a.bw)((()=>{this.metrics.stopTimer("sdk_get_third_party_identities_task_duration_seconds",e),t.finish()})))}getPrioritizedIdentities(e){const t={default:0,appnexus:1},n=Object.entries(e).map((e=>{let[t,{id:n,expiry:r,priority:i}]=e;return{tag:t,...n?{id:n}:{},...r?{expiry:r}:{},...void 0!==i?{priority:i}:{}}})),i=n.filter((e=>((e,t)=>!!e.id&&!(0,r.t9)(o.Eq)(e.tag,t))(e,Object.values(this.providers).map((e=>e.tag))))),a=n.filter((e=>((e,t)=>!!e.id&&!!(0,r.t9)(o.Eq)(e.tag,t))(e,Object.values(this.providers).map((e=>e.tag))))),c=(0,r.DZ)((e=>(0,s.ij)(e.priority)))(i),u=c.length>0?Math.max(...c):0,l=i.map((e=>void 0!==e.priority?{...e,priority:e.priority}:{...e,priority:u+1})),d=a.map((e=>void 0===t[e.tag]?{tag:e.tag,id:e.id,priority:u+v}:{tag:e.tag,id:e.id,priority:u+_}));return l.concat(d)}getIdentitiesMap(){return this.getFilteredIdentities(((e,t)=>!!t.value))}parseCustomerDefinedIdentities(e){const t=`Identify must be passed a non-empty string or list of { tag, id, priority? } tuples, value passed was '${JSON.stringify(e)}'`,n=e=>"string"==typeof e.id&&"string"==typeof e.tag,s=e=>"email_sha256"!==e.tag||p.emailSHA256Regex.test(e.id);return"string"==typeof e?(a=e).length>0?{left:[],right:[{id:a,tag:"default"}]}:{left:[t],right:[]}:Array.isArray(e)?(o=e,(0,i.zG)(o,r.tV((0,i.ls)(f.DT(n,(()=>t)),f.Y$(s,(()=>"Identify called with unsupported format of email_sha256 ID. The support format is hex-encoded 64 character long lowercase string.")))))):{left:[t],right:[]};var o,a}extractIdentifyFromQueue(e){let{global:t}=e;const n=()=>t.q.findIndex((e=>"identify"===e.functionName)),r=(e,i)=>{if(e<0)return i;const s=t.q.splice(e,1)[0],o=this.parseCustomerDefinedIdentities(s.arguments[0]);return r(n(),{left:i.left.concat(o.left),right:i.right.concat(o.right)})},{left:i,right:s}=r(n(),{left:[],right:[]});return i.forEach((e=>this.logger.warn("Invalid identity provided during init",e))),s}setIdentities(e){const t=e.reduce(((e,t)=>{let{tag:n,id:r,expiry:i,priority:s}=t;return void 0===this.identities[n]&&this.logger.debug(`identities[${n}]: added`),e[n]={...r?{value:r}:{},...i?{expiry:i}:{},...void 0!==s?{priority:s}:{}},e}),{}),n=this.rawRef.current;this.setIdentityMap({...this.identities,...t});const r=this.rawRef.current;return{identifyRequestRequired:()=>!l.xb(r)&&!l.Eh(o.Eq).equals(n,r)}}async reset(){this.setIdentityMap({}),await Promise.all(Object.values(this.providers).map((e=>e.reset())))}getFilteredIdentities(e){return(0,a.m8)(...Object.entries(this.identities).filter((t=>{let[n,r]=t;return e(n,r)})).map((e=>{let[t,{value:n,expiry:r,priority:s}]=e;return(0,i.bc)(t,{id:n,...r?{expiry:r}:{},...void 0!==s?{priority:s}:{}})})))}shouldAskForNewIdentity(e){var t;const n=(0,s.ij)(null===(t=this.identities)||void 0===t?void 0:t[e.tag]);return(0,s.g_)((()=>!0),this.isIdentityExpired)(n)}getCachedTPDIdentity(e){return this.identities[e]?(0,s.ij)(this.identities[e].value):s.YP}mapTPDIdentityIfPresent(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:86400;const r=()=>Date.now()+Math.floor(1e3*n);return(0,s.g_)((()=>({tag:e,expiry:r()})),(t=>({tag:e,id:t,expiry:r()})))(t)}retrieveIdentity(e){return e.getId().then((t=>"skipped"===t.type?(0,i.bc)(e,s.YP):(0,i.zG)(t.result,(t=>this.metrics.track({name:(0,s.pC)(t)?"sdk_third_party_identity_present_count":"sdk_third_party_identity_missing_count",value:1,labels:{identity_tag:e.tag}})),(n=>(0,i.bc)(e,t.result)))))}isIdentityExpired(e){return"number"==typeof e.expiry&&Date.now()>=e.expiry}getCachedIdentitiesAndMigrateIfRequired(){return(e=>(0,a.m8)(...Object.entries(e).filter((e=>{let[t,n]=e;return!this.isIdentityExpired(n)&&!h.has(t)}))))(this.permutiveData.getData("identities")||{})}}const h=new Set(["public","email","email_md5","email_sha256","ip_address"]),m=(e,t,n,i,s)=>{const a=(e,t)=>{const n=["(null)"];return n.indexOf(e)>-1||!!w[e]||(0,r.jV)(o.Eq)(t,n).length>0},c=e=>"721d6d85-35f0-4e35-bb38-13eb0d465158"===e,u={"be668577-07f5-444d-98e0-222b990951b1":a,"e43c8a90-d17b-4790-bfda-81b069b3b8c2":(e,t,n)=>["thestudentroom.co.uk"].some((e=>n.indexOf(e)>-1))&&(0,r.jV)(o.Eq)(t,["tsr-"]).length>0,"5d79bce7-5d2b-427e-a6c4-b89b6c7bf048":a,"366ab8da-5efa-4355-ab00-84db3b68ded2":e=>"96539955-4d7e-40df-882b-7e2fbacedb1c"===e||"345600e7-fb5f-48b1-9aa6-cde5396419b0"===e,"f3a06674-ebb9-4b9d-ba8f-0052018c0687":c,"38dadd0d-257a-4641-b332-b8b0fd20a6cb":c,"10453011-272d-49cd-9043-1964fdb36fd8":e=>"936ba6ac-9a8b-454d-ba98-facebd7553fe"===e},l={"fe68d1f7-c9f4-45b3-8905-7cda73d3fd74":e=>!!b[e]},d=u[e]||l[t];return!!d&&d(s,n,i)},v=2,_=3,b={},w={}},8167:(e,t,n)=>{n.d(t,{z:()=>r});class r{ingestIfEligible(e){return Promise.resolve()}}},1993:(e,t,n)=>{n.d(t,{u6:()=>s});var r=n(936);n(5460),n(7387);const i={prebid:{onReady:()=>({})}},s=e=>r.of(i)},9702:(e,t,n)=>{n.d(t,{CL:()=>a,EW:()=>c,PH:()=>o,eV:()=>i,jH:()=>u,t2:()=>s});var r=n(3636);const i=(0,r.MU)("track_form_submission",!0),s=((0,r.MU)("track_pageview_complete",!0),(0,r.MU)("track_pageview_engagement",!0)),o=((0,r.$S)("sync_segments_cookie",!1),(0,r.$S)("track_slot_clicked",!0)),a=(0,r.$S)("track_slot_rendered",!0),c=(0,r.$S)("track_slot_viewable",!1),u=(0,r.$S)("track_targeting_keys",!1)},7041:(e,t,n)=>{n.d(t,{v:()=>o});class r{logger;permutive;id;segmentCode;triggerType;config;workspaceLevelConfig;prefix="[Activation]";constructor(e,t,n,r,i,s,o){this.logger=e,this.permutive=t,this.id=n,this.segmentCode=r,this.triggerType=i,this.config=s,this.workspaceLevelConfig=o}getSegmentCode(){return this.segmentCode}getTriggerType(){return this.triggerType}getConfig(){return this.config}getWorkspaceLevelConfig(){return this.workspaceLevelConfig}trackImpression(e){return this.trackActivation("impression",e)}trackConversion(e){return this.trackActivation("conversion",e)}trackActivation(e,t){const n={reaction_id:this.id,type:e};this.permutive.track("Reaction",n,t),this.logger.log(this.prefix,n.type,n)}}var i=n(3636);const s={dfp:{dfp:[141938,121681,118474,118211,121680,118215,125753,137806,118460,162294,118478,141412,121767,116208,118793,162398,117414,108187,117111,118786,121764,121752,118476,116207,150867,121761,172408,122487,117501,118483,118795,118099,156584,146580,118608,143008,118485,118788,162402,121682,161960,121762,173349,118222,121760,117307,118477,118487,137808,117374,118794,118208,117372,118798,164161,118473,118221,118470,118471,139860,118100,118468,121676,137809,118462,118216,118218,118463,164162,118223,117418,164159,146579,123457,117484,121769,118475,124811,121771,143007,121765,121633,164160,121770,117303,118789,125010,116209,118212,118210,116687,176552,176856,184136,184730,184732,184738,184745,185474,185907,185937,185989,186173,187028,187907,187912,194711,194509,194712,194512,194714,194715,194716,194717,194718,194719,194731,194732,194733,194734,194737,194739,194740,194741,194743,207225,211378],dfp_legacy:{}},eyeota_pixel:[],dbm:{omitted:0},appnexus:{},appnexus_adserver:[],nativo:[],rubicon_ssp:[],smart:[],freewheel:[]};class o{logger;permutive;clientContext;constructor(e,t,n){this.logger=e,this.permutive=t,this.clientContext=n}getSpecializedActivations(e){return s[e]}getActivations(e){return(0,i.Hn)(e)("activationConfigs",[]).filter((e=>this.areContextCriteriaSatisfied(e))).map((e=>new r(this.logger,this.permutive,e.id,e.sc,e.tt,e.c,e.wc)))}areContextCriteriaSatisfied(e){const t=e.cc,n=e=>{const t=this.clientContext.getContext()[e.key];switch(e.comparison){case"EQUALS":return t===e.value;case"NOT_EQUALS":return t!==e.value;case"CONTAINS":return"string"==typeof t&&t.indexOf(e.value)>=0;case"NOT_CONTAINS":return"string"==typeof t&&t.indexOf(e.value)<0}};return!t||("AND"===(r=t).operator?r.criteria.every(n):r.criteria.some(n));var r}}},3636:(e,t,n)=>{n.d(t,{$S:()=>o,Hn:()=>i,MU:()=>s});const r={standard_cohorts:{auto_init:!0,activationConfigs:[]},ssp:{auto_init:!0,ssps:["google_pps","appnexus"],cohort_mapping:{1e7:"bgyz",10000001:"bhgp",10000002:"bhhc",10000003:"bhhg",10000004:"bhhk",10000005:"bhhp",10000006:"bhhv",10000007:"bhhy",10000008:"bhie",10000010:"bhis",10000011:"bhiz",10000012:"bhji",10000013:"bhjq",10000014:"bhka",10000015:"bhkl",10000016:"bhkr",10000017:"bhky",10000018:"bhlg",10000019:"bhli",10000020:"bhlo",10000021:"bhlp",10000022:"bhnd",10000023:"bhnl",10000024:"bhnp",10000025:"bhnw",10000026:"bhoj",10000035:"bgzb",10000036:"bhgq",10000037:"bhgs",10000038:"bhgw",10000039:"bhgy",10000040:"bhgz",10000041:"bhhe",10000042:"bhhh",10000043:"bhhw",10000044:"bhhx",10000045:"bhhz",10000046:"bhia",10000047:"bhif",10000048:"bhig",10000049:"bhii",10000050:"bhij",10000051:"bhik",10000052:"bhim",10000053:"bhip",10000054:"bhit",10000055:"bhiu",10000056:"bhiv",10000057:"bhiy",10000058:"bhjm",10000059:"bhjr",10000060:"bhjs",10000061:"bhjw",10000062:"bhjx",10000063:"bhkm",10000064:"bhir",10000065:"bhko",10000066:"bhkp",10000067:"bhkq",10000068:"bhkz",10000069:"bhla",10000070:"bhlb",10000071:"bhle",10000072:"bhlf",10000073:"bhlq",10000074:"bhlt",10000075:"bhlu",10000076:"bhlw",10000077:"bhlx",10000078:"bhly",10000079:"bhmb",10000080:"bhmi",10000081:"bhmj",10000082:"bhml",10000083:"bhmp",10000084:"bhmr",10000085:"bhmw",10000086:"bhmz",10000087:"bhne",10000088:"bhnf",10000089:"bhni",10000090:"bhnn",10000324:"bhhj",10000325:"bhhi",10000327:"bhku",10000328:"bhkt",10000329:"bhkw",10000330:"bhkv",10000687:"bgzc",10000688:"bgza",10000689:"bhha",10000690:"bhgt",10000691:"bhgx",10000692:"bhgv",10000693:"bhgr",10000694:"bhgu",10000695:"bhhb",10000696:"bhhd",10000697:"bhhf",10000698:"bhhl",10000699:"bhho",10000700:"bhhm",10000701:"bhhn",10000702:"bhhq",10000703:"bhht",10000704:"bhhu",10000705:"bhhs",10000706:"bhhr",10000707:"bhib",10000708:"bhid",10000709:"bhic",10000710:"bhio",10000711:"bhin",10000712:"bhil",10000713:"bhiq",10000714:"bhih",10000715:"bhiw",10000716:"bhix",10000717:"bhja",10000718:"bhjc",10000719:"bhjd",10000720:"bhje",10000721:"bhjf",10000722:"bhjb",10000723:"bhjg",10000724:"bhjh",10000725:"bhjo",10000726:"bhjk",10000727:"bhjn",10000728:"bhjj",10000729:"bhjl",10000730:"bhjy",10000731:"bhju",10000732:"bhjv",10000733:"bhjz",10000734:"bhjt",10000735:"bhkj",10000736:"bhkk",10000737:"bhki",10000738:"bhkd",10000739:"bhkc",10000740:"bhkf",10000741:"bhkh",10000742:"bhkb",10000743:"bhkg",10000744:"bhke",10000745:"bhjp",10000746:"bhkn",10000747:"bhkx",10000748:"bhks",10000749:"bhld",10000750:"bhlc",10000751:"bhlh",10000752:"bhlk",10000753:"bhlj",10000754:"bhll",10000755:"bhlm",10000756:"bhlv",10000757:"bhna",10000758:"bhmv",10000759:"bhmt",10000760:"bhmy",10000761:"bhmc",10000762:"bhmo",10000763:"bhls",10000764:"bhmq",10000765:"bhme",10000766:"bhmh",10000767:"bhlz",10000768:"bhlr",10000769:"bhnb",10000770:"bhmk",10000771:"bhmu",10000772:"bhmx",10000773:"bhmg",10000774:"bhmd",10000775:"bhmf",10000776:"bhnc",10000777:"bhmn",10000778:"bhmm",10000779:"bhma",10000780:"bhms",10000781:"bhng",10000782:"bhnj",10000783:"bhnh",10000784:"bhnk",10000785:"bhno",10000786:"bhnm",10000787:"bhnu",10000788:"bhnv",10000789:"bhns",10000790:"bhnt",10000791:"bhnq",10000792:"bhnr",10000793:"bhob",10000794:"bhny",10000795:"bhod",10000796:"bhoh",10000797:"bhog",10000798:"bhnz",10000799:"bhoa",10000800:"bhoe",10000801:"bhnx",10000802:"bhoc",10000803:"bhof"},all_cohort_mapping:{1e7:["bgyz"],10000001:["bhgp"],10000002:["bhhc"],10000003:["bhhg"],10000004:["bhhk"],10000005:["bhhp"],10000006:["bhhv"],10000007:["bhhy"],10000008:["bhie"],10000010:["bhis"],10000011:["bhiz"],10000012:["bhji"],10000013:["bhjq"],10000014:["bhka"],10000015:["bhkl"],10000016:["bhkr"],10000017:["bhky"],10000018:["bhlg"],10000019:["bhli"],10000020:["bhlo"],10000021:["bhlp"],10000022:["bhnd"],10000023:["bhnl"],10000024:["bhnp"],10000025:["bhnw"],10000026:["bhoj"],10000035:["bgzb"],10000036:["bhgq"],10000037:["bhgs"],10000038:["bhgw"],10000039:["bhgy"],10000040:["bhgz"],10000041:["bhhe"],10000042:["bhhh"],10000043:["bhhw"],10000044:["bhhx"],10000045:["bhhz"],10000046:["bhia"],10000047:["bhif"],10000048:["bhig"],10000049:["bhii"],10000050:["bhij"],10000051:["bhik"],10000052:["bhim"],10000053:["bhip"],10000054:["bhit"],10000055:["bhiu"],10000056:["bhiv"],10000057:["bhiy"],10000058:["bhjm"],10000059:["bhjr"],10000060:["bhjs"],10000061:["bhjw"],10000062:["bhjx"],10000063:["bhkm"],10000064:["bhir"],10000065:["bhko"],10000066:["bhkp"],10000067:["bhkq"],10000068:["bhkz"],10000069:["bhla"],10000070:["bhlb"],10000071:["bhle"],10000072:["bhlf"],10000073:["bhlq"],10000074:["bhlt"],10000075:["bhlu"],10000076:["bhlw"],10000077:["bhlx"],10000078:["bhly"],10000079:["bhmb"],10000080:["bhmi"],10000081:["bhmj"],10000082:["bhml"],10000083:["bhmp"],10000084:["bhmr"],10000085:["bhmw"],10000086:["bhmz"],10000087:["bhne"],10000088:["bhnf"],10000089:["bhni"],10000090:["bhnn"],10000324:["bhhj"],10000325:["bhhi"],10000327:["bhku"],10000328:["bhkt"],10000329:["bhkw"],10000330:["bhkv"],10000687:["bgzc"],10000688:["bgza"],10000689:["bhha"],10000690:["bhgt"],10000691:["bhgx"],10000692:["bhgv"],10000693:["bhgr"],10000694:["bhgu"],10000695:["bhhb"],10000696:["bhhd"],10000697:["bhhf"],10000698:["bhhl"],10000699:["bhho"],10000700:["bhhm"],10000701:["bhhn"],10000702:["bhhq"],10000703:["bhht"],10000704:["bhhu"],10000705:["bhhs"],10000706:["bhhr"],10000707:["bhib"],10000708:["bhid"],10000709:["bhic"],10000710:["bhio"],10000711:["bhin"],10000712:["bhil"],10000713:["bhiq"],10000714:["bhih"],10000715:["bhiw"],10000716:["bhix"],10000717:["bhja"],10000718:["bhjc"],10000719:["bhjd"],10000720:["bhje"],10000721:["bhjf"],10000722:["bhjb"],10000723:["bhjg"],10000724:["bhjh"],10000725:["bhjo"],10000726:["bhjk"],10000727:["bhjn"],10000728:["bhjj"],10000729:["bhjl"],10000730:["bhjy"],10000731:["bhju"],10000732:["bhjv"],10000733:["bhjz"],10000734:["bhjt"],10000735:["bhkj"],10000736:["bhkk"],10000737:["bhki"],10000738:["bhkd"],10000739:["bhkc"],10000740:["bhkf"],10000741:["bhkh"],10000742:["bhkb"],10000743:["bhkg"],10000744:["bhke"],10000745:["bhjp"],10000746:["bhkn"],10000747:["bhkx"],10000748:["bhks"],10000749:["bhld"],10000750:["bhlc"],10000751:["bhlh"],10000752:["bhlk"],10000753:["bhlj"],10000754:["bhll"],10000755:["bhlm"],10000756:["bhlv"],10000757:["bhna"],10000758:["bhmv"],10000759:["bhmt"],10000760:["bhmy"],10000761:["bhmc"],10000762:["bhmo"],10000763:["bhls"],10000764:["bhmq"],10000765:["bhme"],10000766:["bhmh"],10000767:["bhlz"],10000768:["bhlr"],10000769:["bhnb"],10000770:["bhmk"],10000771:["bhmu"],10000772:["bhmx"],10000773:["bhmg"],10000774:["bhmd"],10000775:["bhmf"],10000776:["bhnc"],10000777:["bhmn"],10000778:["bhmm"],10000779:["bhma"],10000780:["bhms"],10000781:["bhng"],10000782:["bhnj"],10000783:["bhnh"],10000784:["bhnk"],10000785:["bhno"],10000786:["bhnm"],10000787:["bhnu"],10000788:["bhnv"],10000789:["bhns"],10000790:["bhnt"],10000791:["bhnq"],10000792:["bhnr"],10000793:["bhob"],10000794:["bhny"],10000795:["bhod"],10000796:["bhoh"],10000797:["bhog"],10000798:["bhnz"],10000799:["bhoa"],10000800:["bhoe"],10000801:["bhnx"],10000802:["bhoc"],10000803:["bhof"]},affinity_enabled:!1,activationConfigs:[]},web:{auto_init:!1,track_pageview_engagement:!0,track_form_submission:!1,track_link_click:!0,track_pageview_complete:!0,add_alchemy_taxonomy:!1,add_alchemy_entities:!1,engagement_edge_only:!0,segment_transition_edge_only:!0,activationConfigs:[]},xandr__curation_platform:{auto_init:!0,activation_method:"prebid",ssp_code:"appnexus",type:"curation_platform",activationConfigs:[]},clean_room:{auto_init:!0,pass_cohorts_to_prebid:!0,cohort_ssp_config:[],activationConfigs:[]},google_pps__curation_platform:{auto_init:!0,activation_method:"prebid",ssp_code:"google_pps",type:"curation_platform",activationConfigs:[]},dfp:{auto_init:!0,track_slot_rendered:!1,track_slot_viewable:!0,track_slot_clicked:!0,activationConfigs:[]},privacy_sandbox_topics:{auto_init:!0,prebid:!1,topics_iframe_url:"https://cdn.permutive.app/topics.html",activationConfigs:[]}},i=e=>{const t=r[e];return(e,n)=>(null==t?void 0:t[e])??n},s=i("web"),o=i("dfp");i("facebook_pixel_v2")},6688:(e,t,n)=>{n.d(t,{z:()=>s,k:()=>o});var r=n(4513);class i{context;constructor(e){this.context=e}getContext(){return this.context}updateContext(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((e=>{let[t,n]=e;this.context[t]=n}))}}class s extends i{constructor(e){super(e)}getClient(){return Promise.resolve(o())}}const o=()=>{const e="PermutiveWebSDK/v20.23.0";return{type:"web",user_agent:navigator.userAgent?`${navigator.userAgent} ${e}`:e,url:(0,r.bk)(window.location.href),domain:window.location.hostname||"",title:document.title,referrer:(0,r.bk)(document.referrer)}}},4253:(e,t,n)=>{n.d(t,{J:()=>c});var r=n(2275),i=n(9727),s=n(9134);const o=e=>t=>class extends t{key=e;put(e){return this.db.then((t=>t.put(e,this.key))).then(r.Q1)}getIfPresent(){return this.db.then((e=>e.get(this.key))).then(i.ij)}reset(){return this.db.then((e=>e.delete(this.key)))}},a=e=>(0,r.zG)(class{db;constructor(e){this.db=Promise.resolve((0,s.E)(e.namespace,e.logger,e.consent))}},o(e));class c extends(a("permutive-unprocessed-pba")){constructor(e){super(e)}}},5472:(e,t,n)=>{n.d(t,{LP:()=>s,dG:()=>r,eP:()=>i});const r=4096,i=`Cookie exceeds maximum supported size of ${r} bytes for most browsers.`,s="Cookie is missing required parameters."},6329:(e,t,n)=>{n.d(t,{Eq:()=>d,X:()=>f,b:()=>l});var r=n(5460),i=n(936),s=n(5191),o=n(7029),a=n(6627),c=n(2275),u=n(9727);const l=()=>({continent:void 0,environment:"",events_count:0,os:"",sample_rate:0,sdk_version:"",segments_count:0,session_count:0,session_init_count:0,session_view_count:0,user_agent:""}),d=s.n_({continent:{equals:(e,t)=>e===t},environment:o.Eq,events_count:a.Eq,os:o.Eq,sample_rate:a.Eq,sdk_version:o.Eq,segments_count:a.Eq,session_count:a.Eq,session_init_count:a.Eq,session_view_count:a.Eq,user_agent:o.Eq}),f=e=>{const t=p(e.userId),n=(0,c.zG)(r.vP(e.userId,e.sessionId),r.UI((e=>{let[t,n]=e;return`${t},${n}`})),p),s=String(Math.random()),o=(0,c.zG)(e.sdkVariant,u.UI((e=>`-${e}`)),u.fS((()=>""))),a={environment:"web",events_count:0,os:g(window.navigator.userAgent||""),sample_rate:e.sampleRate,sdk_version:"v20.23.0"+o,segments_count:0,user_agent:window.navigator.userAgent||""};return(0,c.zG)(i.vP({session_count:t(e.sessionId),session_init_count:n(r.a9(s)),session_view_count:n(e.viewId)}),i.UI((0,c.ls)((t=>r.vP({...t,continent:(0,c.zG)(e.continent,r.UI(u.FS))})),r.UI((e=>({...a,...e}))))))},g=e=>{const t=e.toLowerCase();return t.includes("windows")?"windows":t.includes("iphone")||t.includes("ipad")?"ios":t.includes("android")?"android":t.includes("macintosh")?"macos":t.includes("linux")?"linux":"unknown"},p=e=>t=>i.dQ((n=>{let{previousState:i}=n;const u=(0,c.zG)(r.vP(e,t),r.Rp(function(e){if(null!==e&&"object"==typeof e&&"scope"in e&&"lastValue"in e&&"count"in e)return e;return{scope:"",lastValue:"",count:1}}(i),((e,t)=>{let[n,r]=t;return{scope:n,lastValue:r,count:n!==e.scope?1:r!==e.lastValue?e.count+1:e.count}})),r.D8(s.n_({scope:o.Eq,lastValue:o.Eq,count:a.Eq})));return{state:u,value:(0,c.zG)(u,r.UI((e=>e.count)))}}))},6769:(e,t,n)=>{n.d(t,{p:()=>f});var r=n(2865),i=n(2275),s=n(7387),o=n(6329),a=n(5460),c=n(1583),u=n(9246),l=n(8940),d=n(3812);const f=e=>{let t=e.context.current;(0,i.zG)(e.context,a.D8(o.Eq),a.Rp((0,i.bc)(o.b(),o.b()),((e,t)=>{let[,n]=e;return(0,i.bc)(n,t)})),(e=>e.onChange((e=>{let[n,r]=e;o.Eq.equals({...n,continent:void 0},{...r,continent:void 0})||g({beacon:!1}),t=r}))));const n="[Metrics Reporter]";let f=!0;const g=async s=>{let{beacon:o}=s;const a=t,d=(0,i.zG)(u.of(e.metrics.consume()),u.Y$((()=>f),(()=>{})),u.tS(c.EQ((()=>u.of(void 0)),(t=>u.Y3((()=>(async(t,n)=>{if(!t)return e.api.metrics(n);if(!e.api.metricsBeacon(n))throw new Error("Failed to send beacon.")})(o,{context:a,items:t})),(i=>{f=!1,function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];e.logger.error(n,...r)}(`Failed to publish metrics ${(0,r.w)(i).message}`,t)}))))),l.UI(i.Q1));return d()},p=()=>{(0,d.HJ)((()=>g({beacon:!1}).finally((()=>p()))),5e3)};p(),(0,s.Bf)((()=>g({beacon:!0})),{capture:!1})}},6176:(e,t,n)=>{n.d(t,{u:()=>r});class r{trace;metrics;messages;_isRealtime=!1;_isReady=!1;constructor(e,t,n){this.trace=e,this.metrics=t,this.messages=n}isRealtime(){return this._isRealtime}isReady(){return this._isReady}setAsRealtime(e){const t=performance.now();this._isRealtime=!0,this.trace.measureSinceInit("sdk_realtime").finish(),this.messages.emit("permutive:realtime"),this.metrics.trackTimeSinceInit("sdk_realtime_targeting_set_task_duration_seconds",{},t),this.metrics.trackTimeSinceInit("sdk_lifecycle_timestamps",{timestamp_name:"sdk_realtime",time_origin:"sdk_init"},t),this.metrics.track({name:"sdk_user_segments_count",value:e,labels:{}})}setAsReady(){const e=performance.now();this._isReady=!0,this.trace.measureSinceInit("sdk_ready").finish(),this.messages.emit("permutive:ready"),this.metrics.trackTimeSinceInit("sdk_initialisation_task_duration_seconds",{},e),this.metrics.trackTimeSinceInit("sdk_lifecycle_timestamps",{timestamp_name:"sdk_ready",time_origin:"sdk_init"},e),window.performance&&window.performance.memory&&(this.metrics.track({name:"sdk_heap_memory_bytes_used",value:window.performance.memory.usedJSHeapSize,labels:{}}),this.metrics.track({name:"sdk_heap_memory_limit_fraction_used",value:window.performance.memory.usedJSHeapSize/window.performance.memory.jsHeapSizeLimit,labels:{}}))}}},3195:(e,t,n)=>{n.d(t,{a:()=>s});var r=n(2275),i=n(5326);class s{config;localStorage;logger;permutiveData;cookies;externalData;constructor(e,t,n,r,i,s){this.config=e,this.localStorage=t,this.logger=n,this.permutiveData=r,this.cookies=i,this.externalData=s}async reset(){return this.logger.log("Resetting State"),(0,r.zG)(this.cookies.deleteCookie(this.config.cookieName),(e=>this.externalData.removeExternalData(this.config.cookieName)),(e=>(0,i.XP)({_paols:!0,_papns:!0,_pcrdbs:!0,_pcrprs:!0,_pdfps:!0,_pfws:!0,_pnativo:!0,_prps:!0,_prubicons:!0,_psegs:!0,_psmart:!0,"permutive-id":!0,"permutive-loaded":!0,"permutive-prebid-rtd":!0,"permutive-prebid-id":!0,"permutive-events-cache":!0,_pssps:!0,_ppsts:!0}).forEach((e=>this.externalData.removeExternalData(e)))),(e=>this.permutiveData.reset()),(e=>Promise.all([this.localStorage.delete(this.config.permutiveDataMiscKey),this.localStorage.delete(this.config.permutiveDataQueriesKey)])),r.Q1)}}},1772:(e,t,n)=>{n.d(t,{u:()=>r});class r{permutiveData;permutiveReset;userId;viewId;logger;constructor(e,t,n,r,i){this.permutiveData=e,this.permutiveReset=t,this.userId=n,this.viewId=r,this.logger=i}getPermutiveData(e){return this.permutiveData.getData(e)}setPermutiveData(e,t){return this.permutiveData.setData(e,t)}getStateSizeInBytes(){return this.logger.warn("getStateSizeInBytes needs to be updated to reflect new event persistence"),this.permutiveData.getDataSize()}reset(){return this.permutiveReset.reset()}}},1347:(e,t,n)=>{n.d(t,{W:()=>r});class r{ref;constructor(e){this.ref=e}get(){return this.ref.current}}},9134:(e,t,n)=>{n.d(t,{E:()=>i});var r=n(7056);const i=(e,t,n)=>{const i=window.localStorage;return(0,r.rK)(i,"[Local Storage]",e,t,n)}},8480:(e,t,n)=>{n.d(t,{u:()=>i});n(6851);var r=n(7056);const i=(e,t,n)=>{const i=window.sessionStorage;return(0,r.rK)(i,"[Session Storage]",e,t,n)}},7056:(e,t,n)=>{n.d(t,{oP:()=>c,rK:()=>d});var r=n(2865),i=n(3939),s=n(1385),o=n(2275),a=n(4429);class c{storage;namespace;constructor(e,t){this.storage=e,this.namespace=t}async put(e,t){const n=this.namespace.getNamespacedStorageKey(t.toString());return this.storage.setItem(n,JSON.stringify(e)),t}async get(e){const t=this.namespace.getNamespacedStorageKey(e.toString()),n=this.storage.getItem(t);return null===n?null:(0,i.A)(n)}async delete(e){const t=this.namespace.getNamespacedStorageKey(e.toString());this.storage.removeItem(t)}async deleteStore(){}}const u=e=>{const{logger:t,consent:n,prefix:r}=e,i=(e,n)=>(t.debug(`${r} Failed to write ${String(n)} as consent is revoked`),Promise.resolve(n));return e=>class extends e{put=(0,a.v)(super.put.bind(this),i,(()=>!n.current))}},l=e=>{const{logger:t,prefix:n,storage:i}=e;return e=>class extends e{isSupported=null;isStorageSupported(){return null!==this.isSupported||(this.isSupported=s.Y3((()=>{const e="_permutive_ls_test";return i.setItem(e,e),i.getItem(e),i.removeItem(e),!0}),r.w),(0,o.zG)(this.isSupported,s.EQ((e=>{t.warn(`${n} Is NOT supported`,e)}),(()=>{t.debug(`${n} Is supported`)})))),this.isSupported}async put(e,t){return(0,o.zG)(this.isStorageSupported(),s.EQ((e=>{throw e}),(()=>super.put(e,t))))}async get(e){return(0,o.zG)(this.isStorageSupported(),s.EQ((()=>null),(()=>super.get(e))))}async delete(e){return(0,o.zG)(this.isStorageSupported(),s.EQ(o.Q1,(()=>super.delete(e))))}async deleteStore(){return(0,o.zG)(this.isStorageSupported(),s.EQ(o.Q1,(()=>super.deleteStore())))}}},d=(e,t,n,r,i)=>new((0,o.zG)(c,l({logger:r,prefix:t,storage:e}),u({logger:r,consent:i,prefix:t})))(e,n)},3247:(e,t,n)=>{n.d(t,{SD:()=>d});var r=n(9727),i=n(1583),s=n(7054),o=n(2275),a=n(5460),c=n(7387);const u={tradedesk:21,ddp:755,appnexus:32,pubmatic:76,neustar_fabrick:468},l="[TCF]",d=(e,t)=>{const[n,d,g]=(0,o.zG)(a.Ue(r.YP),(e=>{let[n,...i]=e;return[(0,o.zG)(n,a.bw(r.UI((e=>{t.debug(l,`Status "${e.type}"`,e)})))),...i]})),p=e.__tcfapi;if(p){const e=new Set(["tcloaded","useractioncomplete"]);p("addEventListener",2,((n,i)=>{i?"loaded"===n.cmpStatus&&e.has(n.eventStatus)&&(t.debug(l,"TCF API loaded",n),d(r.G({type:"loaded",data:n}))):(t.warn(l,"TCF API failed to register event listener"),d(r.G({type:"aborted"})),g())}))}else t.debug(l,"TCF API missing from the page"),d(r.G({type:"missing"})),g();const[h,m]=(0,o.zG)(a.gS(i.uZ()),(e=>{let[t,n]=e;return[t,(0,o.ls)(i.of,n)]}));return(0,o.zG)(a.vP(n,h),a.bw((e=>{let[n,i]=e;return(0,o.zG)(n,r.UI((e=>{const n=i();switch(t.debug(l,`Processing ${n.length} listeners`,n),e.type){case"missing":n.forEach((n=>{let[r,i]=n;t.debug(l,`Invoking ${r} as TCF API missing`),i(e)}));break;case"aborted":n.forEach((e=>{let[n]=e;t.debug(l,`Invoking ${n} skipped as TCF API aborted`)}));break;case"loaded":n.forEach((n=>{let[i,a]=n;(0,o.zG)(f(e.data),r.EQ((()=>{t.debug(l,`Invoking ${i} as GDPR does not apply`),a(e)}),(n=>(0,o.zG)(u,s.P5(i),r.tS((e=>(0,o.zG)(n,s.P5(e.toString())))),r.UI((n=>{n?(t.debug(l,`${i} has consent`,{vendor:i}),a(e)):t.debug(l,`${i} does not have consent`,{vendor:i})}))))))}))}})))}))),{registerVendorOnValidConsent:(e,t)=>m([e,t]),getStatusOrAbortOnTimeout:e=>new Promise((t=>{const i=setTimeout((()=>t({type:"aborted"})),e);(0,o.zG)(n,a.UI(r.UI((e=>{clearTimeout(i),t(e)}))))})).then((0,c.bw)((e=>t.debug(l,"TCF status resolved as",{status:e})))),tcfApiStatusRef:n}},f=e=>e.gdprApplies?r.G(e.vendor.consents):r.YP},6563:(e,t,n)=>{n.d(t,{C:()=>a});var r=n(366),i=n(2275);n(9082),n(1993);const s=(o=[[{name:"dfp",import:Promise.resolve().then(n.bind(n,2198))}],[],[],[],[],[],[{name:"clean_room",import:Promise.resolve().then(n.bind(n,1819))}],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[{name:"web",import:Promise.resolve().then(n.bind(n,7866))}],[],[],[{name:"ssp",import:Promise.resolve().then(n.bind(n,3775))}],[],[]],(0,i.zG)((0,r.xH)(o),(0,r.u4)({},((e,t)=>({...e,[t.name]:t.import})))));var o;const a=e=>{const t=Object.entries(s).map((async t=>{let[n,r]=t;return e.logger.log(`Loading addon ${n}`),(await r).load(e)}));return Promise.all(t)}},2725:(e,t,n)=>{n.r(t),n.d(t,{createAddon:()=>I,getCachedDFPSegments:()=>y});var r=n(2865),i=n(1385),s=n(2275),o=n(9727),a=n(1583),c=n(5460),u=n(3636),l=n(7387);const d="_pdfps";n(5472);var f=n(366),g=n(7029);let p=!1;let h=null;const m=(e,t)=>{const{logger:n}=t;(0,s.zG)(e,o.UI((e=>{!0!==p&&e.pubadsReady&&(h??=r=>{let{slot:i}=r;const{getContentUrl:o}=i;if(!o||"function"!=typeof o)return;(0,s.zG)(o(),(0,g.pn)("&trunc=1"))&&(n.debug("DFP content URL has been truncated!"),(e=>{let{metrics:t,logger:n}=e;p||(t.track({name:"sdk_targeting_size_limit_exceeded_count",value:1,labels:{target:"dfp"}}),p=!0,n.debug("DFP has exceeded targeting limit"))})(t),h&&e.pubads().removeEventListener("slotRenderEnded",h),h=null)},e.pubads().addEventListener("slotRenderEnded",h))})))},v=(e,t,n,r)=>{const{logger:i}=t;m(e,t);(0,s.zG)(e,o.UI((e=>(e=>{e.cmd.push((()=>{const{getTargeting:t,setTargeting:s}=e.pubads(),o=t("permutive")||[],a=Object.values(n.eligibleSegments).map(String).concat(n.allSeenCloudCohorts).concat("rts"),c=(0,f.uK)((e=>a.includes(e))),{left:u}=c(o),l=r.concat(u).concat("rts");i.debug("DFP setting GPT targeting to",l),s("permutive",l)}))})(e))))};var _=n(2198);const b={liveSegments:[],cloudCohorts:[],allSeenCloudCohorts:[],eligibleSegments:{}},w={segments:b,getGAMKeyValues:()=>({permutive:""})},y=e=>e.getExternalJsonData(d)||[],k=(e,t,n)=>{const{logger:i,externalData:s,api:o}=t;let a=n.map(String).concat(b.cloudCohorts);i.debug("DFP is updating with targeting values",a),v(e,t,b,a);try{s.setExternalJsonData(d,a)}catch(e){const t=(0,r.w)(e),n="DFP failed to set data. Got:";i.error(n,t),o.reportError(`${n} ${t.message}`)}return((e,t)=>{let{api:n,logger:r}=e;(0,u.$S)("sync_segments_cookie",!1)?(r.debug("DFP syncing segment cookie _pdfps"),n.segmentSync({key:d,value:t})):r.debug("DFP sync segments cookie not enabled, skipping sync")})(t,JSON.stringify(a)),i.debug("DFP live segments updated to",n),n},I=async e=>{const{api:t,logger:n,activationManager:r,messages:u,externalData:f,nextGenOutput:g,userId:p,cookies:h}=e,m=await(0,l.a4)((()=>window.googletag),(()=>!!window.googletag),{waitTimeInMs:10,maxAttempts:200,exponentialBackOff:!1});o.Wi(m)&&n.error("[DFP]: unable to find google tag script on the page"),(0,s.zG)(m,o.UI((e=>(e=>e.cmd.push((()=>e.pubads().setTargeting("prmtvsdk","web"))))(e))));w.getGAMKeyValues=()=>({...(0,s.zG)((0,_.generateProjectSpecificKVs)(e),i.Vn((e=>{var n;return n=e,t.reportError(`[DFP] ${n}`,p.get()),e})),i.fS((()=>({})))),permutive:w.segments.liveSegments.join(",")}),b.eligibleSegments=(e=>{const t=e.getSpecializedActivations("dfp"),n={};for(const e of t.dfp)n[e]=e;for(const e of Object.keys(t.dfp_legacy)){const r=Number(e);n[r]=t.dfp_legacy[r]}return n})(r);const v=(0,s.zG)(g.queryLanguageCohorts.all,c.UI((e=>(n.debug("DFP received QL segments",{qlSegments:e}),((e,t)=>e.filter((e=>e in t)).map((e=>t[e])))(e,b.eligibleSegments)))),c.D8(l.cO)),y=g.activations.dfp??c.a9(a.bM()),I=(0,s.zG)(y,c.Rp(a.bM(),((e,t)=>[...new Set([...e,...t])])));return(0,s.zG)(c.vP(v,y,I),c.YP((0,l.Z_)(t,p,(t=>{let[r,i,s]=t;n.debug("DFP received updated cohorts",{filteredQlSegments:r,cloudCohorts:i}),b.cloudCohorts=i,b.allSeenCloudCohorts=s,b.liveSegments=k(m,e,r)})))),n.debug("DFP initialised with segments",b),(0,s.zG)(m,o.UI((e=>{e.secureSignalProviders=e.secureSignalProviders||[],e.secureSignalProviders.push({id:"permutive-secure-signal",collectorFunction:c.yY(g.addons.secureSignal)})}))),u.on("permutive:reset",(0,l.Z_)(t,p,(()=>{n.debug("DFP received 'permutive:reset' event"),f.removeExternalData(d),h.deleteCookie(d)}))),u.emit("permutive:dfp:ready"),w}},2198:(e,t,n)=>{n.r(t),n.d(t,{generateProjectSpecificKVs:()=>G,load:()=>f});var r=n(2865),i=n(1385),s=n(9727),o=n(2275),a=n(9702),c=n(3636),u=n(7387),l=n(2725);const d={},f=e=>{(0,c.Hn)("dfp")("auto_init",!1)&&e.q.push({functionName:"addon",arguments:["dfp",{}]}),window.googletag=window.googletag||{},window.googletag.cmd.push((()=>g(e)))},g=e=>{e.permutive.ready((0,u.Z_)(e.api,e.userId,(()=>I(e.metrics))),"realtime");S(e.externalData);(0,o.zG)(G(e),i.tS((e=>i.Y3((()=>(0,u.qh)(e).forEach((e=>{let[t,n]=e;googletag.pubads().setTargeting(t,n)}))),r.w))),i.Vn((t=>e.api.reportError(`[DFP:load], ${t}`,e.userId.get())))),b(e.permutive),googletag.cmd.push((()=>{w(e.permutive),y(e.permutive)})),window.addEventListener("message",h(e.permutive),!1)},p=e=>{let{advertiserId:t,campaignId:n,lineItemId:r,creativeId:i}=e;return{advertiser_id:(0,u.rH)(t),campaign_id:(0,u.rH)(n),line_item_id:(0,u.rH)(r),creative_id:(0,u.rH)(i)}},h=e=>t=>{try{const n=JSON.parse(t.data);if(!n.permutive_type||"google_ad_click"!==n.permutive_type)return;const{ad_unit_path:r,creative_id:i,advertiser_id:s,order_id:o,line_item_id:a}=(null==n?void 0:n.data)??{},c=p({lineItemId:a,advertiserId:s,campaignId:o,creativeId:i});let u;Object.keys(d).some((e=>{const{slot:t,creative_id:n}=d[e];if((null==t?void 0:t.ad_unit_path)===r&&n===c.creative_id)return u=d[e],!0})),u=u??{...c,is_empty:!1},m(e,u)}catch{}},m=(e,t)=>{a.PH&&t&&e.track("SlotClicked",t)},v={},_=(e,t,n)=>{d[t]=n,k(e,n),v[t]&&v[t](),v[t]=P(e,t)},b=e=>{const t=googletag.pubadsReady&&googletag.pubads().getSlots();t&&t.forEach((t=>{const n=t.getResponseInformation();if(!n)return;const r={...p(n),is_empty:!1,service_name:"publisher_ads",slot:E(t)},i=t.getSlotElementId();_(e,i,r)}))},w=e=>{googletag.pubads().addEventListener("slotRenderEnded",(t=>{const n={...p(t),is_empty:t.isEmpty,service_name:t.serviceName,slot:E(t.slot)};if(t.size){const[e,r]=t.size;"number"==typeof e&&"number"==typeof r&&(n.width=e,n.height=r)}const r=t.slot.getSlotElementId();_(e,r,n)}))},y=e=>{a.EW&&googletag.pubads().addEventListener("impressionViewable",(t=>{let{slot:n,serviceName:r}=t;const i=n.getResponseInformation();if(!i)return;const s={...p(i),service_name:r,slot:E(n)};e.track("SlotViewable",s)}))},k=(e,t)=>{if(!a.CL)return;var n;n={...t,rendered_timestamp:Date.now()},e.track("SlotRendered",n)},I=e=>{let t=0;const n=googletag.pubadsReady&&googletag.pubads().getSlots();n&&n.forEach((e=>e.getResponseInformation()&&t++));const r=0===t?"sdk_targeting_realtime_success_count":"sdk_targeting_realtime_fail_count";e.track({name:r,value:1,labels:{target:"dfp"}})},S=e=>{const t=(0,l.getCachedDFPSegments)(e);googletag.cmd.push((()=>{const{getTargeting:e,setTargeting:n}=googletag.pubads(),r=e("permutive")||[];n("permutive",[...new Set([...t.map(String),...r])])}))},E=e=>{const t={ad_unit_path:e.getAdUnitPath(),slot_element_id:e.getSlotElementId()};return a.jH?{...t,...(()=>{const t={},n=[];let r=[];const i=(e,i)=>{const s="slot"===e?e=>t[e]=1:()=>{},o=i.getTargetingKeys();r=o;for(let o=0;o<r.length;o++){const a=r[o];if(void 0!==t[a]&&"service"===e)continue;const c=[],u=i.getTargeting(a);for(let e=0;e<u.length;e++)c.push(u[e].toString());c.length>0&&(s(a),n.push({key:a,value:c}))}};return i("slot",e),i("service",googletag.pubads()),{targeting_keys:n}})()}:t},P=(e,t)=>{let n=[];const r=()=>(0,o.zG)((0,o.bc)((0,o.zG)(s.Y3((()=>document.getElementById(t))),s.tS(s.ij),s.tS(s.KQ((e=>e.querySelector("iframe"))))),s.ij(document.activeElement)),s.RD,s.UI((n=>{let[r,i]=n;"hidden"===document.visibilityState&&r===i&&m(e,d[t])})));return document.addEventListener("visibilitychange",r),n.push((()=>document.removeEventListener("visibilitychange",r))),()=>{n.forEach((e=>e())),n=[]}},G=e=>{let{userId:t,viewId:n}=e;return i.Y3((()=>({})),r.w)}},7866:(e,t,n)=>{n.r(t),n.d(t,{WebAddon:()=>k,load:()=>y});var r=n(2865),i=n(1385),s=n(2275),o=n(6627),a=n(9727),c=n(5586),u=n(9702),l=n(3636),d=n(7387);const f=(0,l.MU)("add_alchemy_entities",!1),g=(0,l.MU)("add_alchemy_taxonomy",!1);function p(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{...e&&g?{taxonomy_labels:"$alchemy_taxonomy_labels"}:{},...e&&f?{entity_names:"$alchemy_entity_names"}:{},classifications_watson:{taxonomy_labels:"$taxonomy_labels"},privacy_sandbox_topics_v2:"$privacy_sandbox_topics_v2"}}function h(e,t,n,r){const i={isp_info:"$ip_isp_info",geo_info:"$ip_geo_info",...m(),...e,...t};n.track("Pageview",i).then((e=>{e&&r.emit("permutive:event:pageview",e)}))}function m(){return{}}var v=n(3812);const _=["mousemove","click","scroll"],b=["email","tel","submit","reset","button","file","password","radio","checkbox"],w=["email","e-mail","password","tel","telephone","phone","name_first","name_last","sa_zip"],y=e=>{(0,l.Hn)("web")("auto_init",!1)&&e.q.push({functionName:"addon",arguments:["web",{auto_init:!0}]})};class k{permutive;options;api;clientContext;logger;dirtyState=!1;cancelEngagementTimer=()=>{};totalCompletion=0;totalEngagedTime=0;pageEngagementDetected;cleanupPageEngagementDetection=s.Q1;constructor(e){this.permutive=e.permutive,this.options=e,this.api=e.api,this.clientContext=e.clientContext,this.logger=e.logger,this.options.customProperties.setCustomProps(e.page||{});this.pageEngagementDetected=(()=>{this.dirtyState=!0}).bind(this),h(p(this.clientContext.getContext().isArticle),this.options.customProperties.getCustomProps(),this.permutive,this.options.messages),this.enablePageEngagementDetection(),"loading"!==document.readyState?this.attachListeners():window.addEventListener("DOMContentLoaded",this.attachListeners.bind(this),!1),u.t2&&(this.cancelEngagementTimer=this.registerEngagementInterval(this.getEventInterval()))}sendFormSubmissionEvent(e){{const t=e.currentTarget,n={form:{method:t.method||"GET",properties:this.serializeForm(t),..."string"==typeof t.id?{id:t.id}:{},...t.name&&"string"==typeof t.name?{name:t.name}:{},...t.action&&"string"==typeof t.action?{action:t.action}:{}}};this.permutive.track("FormSubmission",n)}}async trackEngagementInterval(e){const t=this.updateState(e);!function(e,t,n,r,i,s){const o={isp_info:"$ip_isp_info",geo_info:"$ip_geo_info",engaged_time:e,total_engaged_time:t,...i,completion:n,total_completion:r};s.track("PageviewEngagement",o)}(t.engaged_time,t.total_engaged_time,t.completion,t.total_completion,this.options.customProperties.getCustomProps(),this.permutive)}async reset(e){this.disablePageEngagementDetection(),this.dirtyState=!1;const t=this.updateWebOptions(e);this.options.pageviewState.setState(((e,n)=>{var r,i;return{viewId:(null===(r=t.context)||void 0===r?void 0:r.view_id)??(0,d.k$)(),watsonEnabled:(null===(i=t.watson)||void 0===i?void 0:i.enabled)??n.watsonEnabled}})),this.totalCompletion=0,this.totalEngagedTime=0,this.options.customProperties.setCustomProps(this.options.page||{}),this.enablePageEngagementDetection(),h(p(this.clientContext.getContext().isArticle),this.options.customProperties.getCustomProps(),this.permutive,this.options.messages),u.t2&&(this.cancelEngagementTimer(),this.cancelEngagementTimer=this.registerEngagementInterval(this.getEventInterval()))}serializeForm(e){return[...e.getElementsByTagName("input")].filter((e=>!(!e.type||!e.id||e.disabled||e.checked||"fieldset"===e.nodeName.toLowerCase()||-1!==b.indexOf(e.type.toLowerCase())||-1!==w.indexOf(e.name.toLowerCase())))).map((e=>({name:e.name||e.id,value:e.value}))).filter((e=>e.value.length<120))}registerEngagementInterval(e){return(0,v.UM)((()=>{this.dirtyState&&this.trackEngagementInterval(e)}),1e3*e)}attachListeners(){const e=e=>"a"===e.tagName.toLowerCase(),t=e=>e instanceof Element,n=t=>e(t)?(0,a.G)(t):t.parentElement?e(t.parentElement)?(0,a.G)(t.parentElement):n(t.parentElement):a.YP;u.eV&&[].slice.call(document.getElementsByTagName("form"),0).forEach((e=>e.addEventListener("submit",(0,s.ls)(a.DT(this.canTrackPermutiveEvent("FormSubmission")),a.UI((0,d.Z_)(this.options.api,this.options.userId,this.sendFormSubmissionEvent.bind(this)))))));(0,l.MU)("track_link_click",!0)&&document.body.addEventListener("click",(0,s.ls)(a.DT(this.canTrackPermutiveEvent("LinkClick")),a.UI((e=>({event:e,anchor:(0,s.zG)(e.target,a.ij,a.tS(a.DT(t)),a.tS(n))}))),a.DZ((e=>{let{event:t,anchor:n}=e;return a.pC(n)?a.G({event:t,anchor:n.value}):a.YP})),a.UI((e=>{let{event:t,anchor:n}=e;return I(this.permutive,n,(r=t,!("_blank"===n.target||r.metaKey||r.ctrlKey||r.shiftKey||2===r.which||3===r.which)));var r}))),{capture:!0})}updateState(e){const t=Math.max(this.totalCompletion,this.getCurrentCompletion()),n=t-this.totalCompletion;return this.totalEngagedTime+=e,this.totalCompletion=t,this.dirtyState=!1,{engaged_time:e,total_engaged_time:this.totalEngagedTime,completion:n,total_completion:this.totalCompletion}}getCurrentCompletion(){if("function"==typeof this.options.getPageCompletion)return(0,s.zG)((0,i.Y3)((0,s.ls)(this.options.getPageCompletion,Number,(e=>isNaN(e)?0:e),(0,c.uZ)(o.Df)(0,1)),r.w),(0,i.EQ)((e=>(this.logger.warn("Web: invoking getPageCompletion threw an error. Got",e),0)),(e=>(this.logger.debug("Web: invoking getPageCompletion returned",e),e))));return(()=>{const e=document.documentElement.scrollHeight,t=window.pageYOffset+window.innerHeight;return t<=0?0:t>=e?1:t/e})()}registerPageEngagementCleanup(e){"function"==typeof e?this.cleanupPageEngagementDetection=()=>(0,i.Y3)((()=>{e(),this.cleanupPageEngagementDetection=s.Q1}),(e=>this.logger.warn("Page detection cleanup threw an error",(0,r.w)(e)))):this.logger.warn("No page detection cleanup was registered")}enablePageEngagementDetection(){this.options.addPageEngagementDetection&&(0,s.zG)(this.options.addPageEngagementDetection(this.pageEngagementDetected),(e=>this.registerPageEngagementCleanup(e))),this.setDirtyEventListenersTo(!0,this.getDirtyEvents())}disablePageEngagementDetection(){this.cleanupPageEngagementDetection(),this.setDirtyEventListenersTo(!1,this.getDirtyEvents())}setDirtyEventListenersTo(e,t){const n=e?window.addEventListener:window.removeEventListener;return t.forEach((e=>n(e,this.pageEngagementDetected))),null}getDirtyEvents(){return this.options.dirtyEvents||_}getEventInterval(){return this.options.eventInterval||5}canTrackPermutiveEvent(e){return t=>{var n,o;return(0,s.zG)(null===(n=this.options)||void 0===n||null===(o=n.filterPermutiveEvent)||void 0===o?void 0:o[e],a.DT((e=>"function"==typeof e)),a.tS((0,s.ls)((e=>i.Y3((()=>e(t)),(e=>new Error(`Threw an unexpected error: ${(0,r.w)(e)}`)))),i.tS(i.DT((e=>"boolean"==typeof e),(()=>new Error("Did not return a boolean")))),(0,d.bw)(i.Vn((t=>this.logger.error(`Filter predicate for "${e}" event failed`,t)))),a.Uo)),a.fS((()=>!0)))}}updateWebOptions(e){(0,d.Kn)(e)||(e={}),e.watson&&"object"==typeof e.watson&&"enabled"in e.watson&&"boolean"==typeof e.watson.enabled||delete e.watson,"object"==typeof e.filterPermutiveEvent&&null!==e.filterPermutiveEvent||delete e.filterPermutiveEvent,"context"in e&&!(0,d.Kn)(e.context)&&delete e.context;const t={addPageEngagementDetection:void 0,context:void 0,dirtyEvents:void 0,eventInterval:void 0,filterPermutiveEvent:void 0,getPageCompletion:void 0,page:void 0,watson:void 0};return this.options={...this.options,...t,...e}}}const I=(e,t,n)=>{if(window.location.href&&t.href){const r=0===t.href.indexOf("data:")?"NOT_URL":t.href;e.track("LinkClick",{dest_url:r},{useBeacon:n})}}},2102:(e,t,n)=>{n.d(t,{a:()=>r});class r{messages;handlers={};messageQueue={};constructor(e){var t,n;this.messages=e;null===(t=(n=window).addEventListener)||void 0===t||t.call(n,"message",(e=>{var t;"permutive"===(null==e||null===(t=e.data)||void 0===t?void 0:t.origin)&&this.handle(e)}),!1),this.messages.once("permutive:api:ready",(function(){var e,t;null===(e=(t=window).postMessage)||void 0===e||e.call(t,{origin:"permutive",type:"sdk-init"},"*")}))}listen(e,t){if(e in this.handlers||(this.handlers[e]=[]),this.handlers[e].push(t),e in this.messageQueue){const t=this.messageQueue[e];if(void 0===t)return;for(let e=0;e<t.length;e++){const n=t[e];this.handle(n)}}}handle(e){if(e.data.type in this.handlers)this.handlers[e.data.type].forEach((t=>{t(e)}));else{(this.messageQueue[e.data.type]??=[]).push(e)}}}},7367:(e,t,n)=>{n.d(t,{o:()=>r,s:()=>i});class r extends Error{static errorName="NetworkRequestFailedError";name=r.errorName;constructor(){super(r.defaultMessage)}static get defaultMessage(){return"Network request failed"}}class i extends Error{static errorName="NetworkRequestTimeoutError";name=i.errorName;constructor(){super(i.defaultMessage)}static get defaultMessage(){return"Network request timed out"}}},8645:(e,t,n)=>{n.d(t,{F:()=>d});var r=n(2865),i=n(2275),s=n(9727),o=n(1583),a=n(4513),c=n(7367),u=n(2444);class l{urls;config;network;metricsCollector;logger;webClient;prefix="[API]";constructor(e,t,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:()=>s.YP;this.urls=e,this.config=t,this.network=n,this.metricsCollector=r,this.logger=i,this.webClient=o}async reportError(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Date;const l=(0,r.w)(e);if(this.logError("Reporting error:\n",l),!this.config.sendClientErrors)return void this.logDebug("Send errors not enabled. Skipping");const d=(0,i.zG)(this.webClient,u.UI(s.fS((()=>{var e,t,n,r;return{domain:(null===(e=self.location)||void 0===e?void 0:e.hostname)??"",referrer:"document"in self?null===(t=self.document)||void 0===t?void 0:t.referrer:"",url:(null===(n=self.location)||void 0===n?void 0:n.href)??"",user_agent:(null===(r=navigator)||void 0===r?void 0:r.userAgent)??""}}))),u.UI((e=>{var r,i;const s={error_message:(null==l||null===(r=l.message)||void 0===r?void 0:r.toString())??"",stack_trace:null==l||null===(i=l.stack)||void 0===i?void 0:i.split("\n")},o=t?{user_id:t}:{};return{platform:"web",sdk_version:"v20.23.0",ql_runtime_version:"v13.1.0",timestamp:n,domain:e.domain,url:(0,a.bk)(e.url),referrer:(0,a.bk)(e.referrer),user_agent:e.user_agent,error_message:s.error_message??String(l),stack_trace:s.stack_trace,...o}}))),f=e=>this.network.req({url:this.urls.getSdkErrorsUrl("/errors",s.G(this.config.sdkErrorsApiVersion)),method:"POST",payload:[e],contentType:"text/plain",dataType:"text",withCredentials:!1}),g=e=>{this.metricsCollector.trackCounter({name:"sdk_http_generic_network_request_fail_count_total",value:1,labels:{network_error_type:e}})};await(0,i.zG)([c.o,c.s],o.Ew((e=>l.name===e.errorName||l.message.indexOf(e.errorName)>=0||l.message.indexOf(e.defaultMessage)>=0)),s.g_((()=>{const e=d();return f(e).catch((0,i.ls)(r.w,(e=>this.logError(e))))}),(async e=>g(e.errorName))))}logDebug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.debug(this.prefix,...t)}logError(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.error(this.prefix,...t)}}class d extends l{identifyPromise;identify(e,t,n){const r=()=>this.reqWithMetrics(e,"sdk_http_identify_seconds",{url:this.urls.getEndpointUrl("/identify",s.G(this.config.apiVersion)),method:"POST",payload:{user_id:t.get(),aliases:n},contentType:"text/plain",dataType:"json",withCredentials:!0});return this.identifyPromise?this.identifyPromise=this.identifyPromise.then(r):this.identifyPromise=r()}metrics(e){return this.network.req({url:this.urls.getEndpointUrl("/internal/metrics",s.G(this.config.apiVersion)),method:"POST",payload:e,contentType:"text/plain",dataType:"text",withCredentials:!1})}metricsBeacon(e){return this.network.reqWithBeacon({url:this.urls.getEndpointUrl("/internal/metrics",s.G(this.config.apiVersion)),payload:e})}reset(e){return this.reqWithMetrics(e,"sdk_http_reset_seconds",{url:this.urls.getEndpointUrl("/reset",s.G(this.config.apiVersion)),method:"POST",payload:null,contentType:"text/plain",dataType:"json",withCredentials:!0})}segmentSync(e){return this.network.req({url:`https://${this.config.segmentSyncApiHost}/sync/${e.key}`,method:"POST",payload:`value=${encodeURIComponent(e.value)}`,contentType:"application/x-www-form-urlencoded",dataType:"json",withCredentials:!0})}appnexus(e){return this.network.req({url:e,method:"GET",contentType:"text/plain",dataType:"json",withCredentials:!0,timeout:2e3})}pxid(e){return this.network.req({url:this.urls.makeAuthenticatedUrl(e),method:"GET",contentType:"text/plain",dataType:"json",withCredentials:!0,timeout:2e3})}queries(){const e={addons:{dfp:{activations:{dfp:[],dfp_legacy:{}},auto_init:!0,track_slot_rendered:!1,track_slot_viewable:!1,track_slot_clicked:!1,track_targeting_keys:!1,sync_segments_cookie:!1},web:{auto_init:!1,track_pageview_engagement:!0,track_pageview_complete:!0,track_form_submission:!1,track_link_click:!1,engagement_edge_only:!0,segment_transition_edge_only:!1}},queries:{queries:{},eventSegments:{},eventsLookup:[],literalsLookup:[],subexpressionsLookup:[],stateSyncReplays:[],propertiesLookup:[],ahoCorasickLookup:[]},queries_metadata:{}},t=`${this.config.cdnBaseUrl.startsWith("dev.local:")?"http":"https"}://${this.config.cdnBaseUrl}/queries/f279b5ea-1200-4ff6-9d35-17893279723e-amp.json`;return this.network.req({url:t,withCredentials:!1,dataType:"json",method:"GET"}).catch((()=>e))}pxidReset(e){return this.network.req({url:this.urls.makeAuthenticatedUrl(e),method:"POST",payload:null,contentType:"text/plain",dataType:"json",withCredentials:!0})}uploadCohortMemberships(e,t){return this.reqWithMetrics(e,"sdk_http_upload_cohort_memberships_seconds",{url:this.urls.getCCSCohortMembershipEndpointUrl("/amp/cohorts",s.G("alpha"),[["i",t.user_id]]),method:"POST",payload:t,contentType:"text/plain",dataType:"json",withCredentials:!1})}reqWithMetrics(e,t,n){const r=e.startTimer(t,{});return this.network.req(n).then((n=>(0,i.zG)(e.stopTimer(t,r),(e=>n))))}}},1671:(e,t,n)=>{n.d(t,{E:()=>b});var r=n(1385),i=n(2275),s=n(7367),o=n(3812),a=n(9727),c=n(7963),u=function(e){return"Left"===e._tag},l=function(e){return"Right"===e._tag};function d(e){return{_tag:"Left",left:e}}function f(e){return{_tag:"Right",right:e}}function g(e,t){return{_tag:"Both",left:e,right:t}}var p=function(e,t,n){return function(r){switch(r._tag){case"Left":return e(r.left);case"Right":return t(r.right);case"Both":return n(r.left,r.right)}}},h=p;h(f,d,(function(e,t){return g(t,e)}));var m=f,v="These",_=(i.yR,i.yR,c.Xl,n(7387));class b{metrics;constructor(e){this.metrics=e}req(e){return this.reqImpl(e).then((e=>(0,i.MZ)(e)))}reqWithBeacon(e){var t,n;let{url:r,payload:i}=e;const s=JSON.stringify(i),o=(null===(t=navigator)||void 0===t||null===(n=t.sendBeacon)||void 0===n?void 0:n.call(t,r,JSON.stringify(i)))??!1;return this.trackRequestMetrics({is_beacon:!0,is_error:!o,request:{method:"POST",url:r,content_length:s.length}}),o}reqImpl(e){const t="arraybuffer",{url:n,dataType:u,contentType:l,method:d,withCredentials:p,timeout:h}=e;return new Promise(((m,v)=>{const b=new XMLHttpRequest,w="POST"===e.method?"string"==typeof(y=e.payload)?y:JSON.stringify(y):null;var y;const k=e=>this.trackRequestMetrics({is_beacon:!1,request:{method:d,url:n,content_length:(null==w?void 0:w.length)??0},response:e});b.onload=(0,o.GL)((()=>{var e,n;return(0,i.zG)(b.status,r.DT((e=>e<400),(()=>{const e="text"===b.responseType||""===b.responseType?b.responseText:"Couldn't access response text";return`Failed ajax request. Status code was ${b.status}. ${e}`})),r.tS((()=>"json"===u?b.responseText?r.Y3((()=>JSON.parse(b.responseText)),(e=>`Failed to parse response as JSON. Response was ${JSON.stringify(b.responseText)}. Got ${e}`)):r.F2(null):"text"===u?r.F2(b.responseText):r.F2(b.response))),(0,_.bw)((0,i.ls)(a.IS,(n={content_length:"text"===b.responseType||""===b.responseType?(null===(e=b.responseText)||void 0===e?void 0:e.length)??0:b.responseType===t?b.response.byteLength:0,response_time_ms:self.performance.now()-I,status_code:b.status},function(e){return c.Wi(e)?f(n):g(e.value,n)}),k)),r.EQ(v,m))})),b.onerror=(0,o.GL)((()=>{k(r.t$("network error")),v(new s.o)})),b.ontimeout=(0,o.GL)((()=>{k(r.t$("timeout")),v(new s.s)})),b.open(d,n,!0),l&&b.setRequestHeader("content-type",l),b.timeout=h||b.timeout,b.withCredentials=p||b.withCredentials,b.responseType="binary"===u?t:b.responseType;const I=self.performance.now();b.send(w)}))}trackRequestMetrics(e){var t;if(null===(t=this.metrics)||void 0===t||!t.isEnabled())return;const n=new URL(e.request.url).pathname;if(n.includes("metrics"))return;const r=t=>this.metrics.track({name:"sdk_http_request_count_total",value:1,labels:{request_method:e.request.method,request_path:n,request_content_length:e.request.content_length,...t}});var s;!0===e.is_beacon?r({is_beacon:!0,is_error:e.is_error}):(0,i.zG)((s=e.response,u(s)?c.YP:(l(s),c.G(s.right))),a.aD((()=>({})),(e=>({response_content_length:e.content_length,response_status:e.status_code,response_time_ms:e.response_time_ms}))),(t=>({is_beacon:!1,is_error:!l(e.response),...t})),r)}}},7592:(e,t,n)=>{n.r(t),n.d(t,{startMaster:()=>ue});var r=n(5460),i=n(2275),s=n(936),o=n(9727),a=n(1583),c=n(7387),u=n(2444),l=n(7054),d=n(2925),f=n(8491),g=n(817);var p=n(8940),h=n(8543),m=n(7560),v=n(4219);function _(e,t){return function(n){return e.map(n,t.compact)}}function b(e,t,n){var r=_(e,t),s=(0,m.UI)(e,n);return function(e){return v.s4(r((0,i.zG)(e,s(o.IS))),r((0,i.zG)(e,s(o.EK))))}}function w(e,t){return function(n){return function(r){return e.map(r,(function(e){return t.filter(e,n)}))}}}function y(e,t){return function(n){return function(r){return e.map(r,(function(e){return t.filterMap(e,n)}))}}}function k(e,t){var n=w(e,t);return function(e){var t=n((0,f.ff)(e)),r=n(e);return function(e){return(0,v.s4)(t(e),r(e))}}}function I(e,t){var n=y(e,t);return function(e){return function(t){return(0,v.s4)((0,i.zG)(t,n((function(t){return(0,o.IS)(e(t))}))),(0,i.zG)(t,n((function(t){return(0,o.EK)(e(t))}))))}}}var S=n(7963);function E(e){return(0,i.ls)(o.G,e.of)}function P(e){return(0,i.a9)(e.of(o.YP))}function G(e){return function(t){return e.map(t,o.G)}}function U(e){return(0,i.ls)(o.ij,e.of)}function z(e){var t=U(e);return function(e){return(0,i.ls)(e,t)}}function D(e){var t=L(e),n=z(e);return function(e){return t(n(e))}}function q(e){return function(t){return(0,i.ls)(t,e.of)}}function C(e){var t=L(e),n=q(e);return function(e){return t(n(e))}}function O(e){return function(t){return function(n){return e.of(o.DT(t)(n))}}}function x(e){return(0,i.ls)(o.Uo,e.of)}function R(e){return function(t,n){return function(r){return e.map(r,o.EQ(t,n))}}}function A(e){return function(t,n){return function(r){return e.chain(r,o.EQ(t,n))}}}function T(e){return function(t){return function(n){return e.chain(n,o.EQ(t,e.of))}}}function M(e){return(0,m.UI)(e,o.dO)}function j(e){return(0,d.ap)(e,o.G5)}function L(e){var t=P(e);return function(n){return function(r){return e.chain(r,o.EQ((function(){return t()}),n))}}}function F(e){var t=E(e);return function(n){return function(r){return e.chain(r,o.EQ(n,t))}}}var $=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},B=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},N=E(p.PM),Q=(p.PM,p.of,p.PM,p.dO,p.UI(o.Uo)),Y=(p.dO,p.qo,p.UA,p.PM,function(e){return function(){return $(void 0,void 0,void 0,(function(){return B(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,e().then(S.G)];case 1:return[2,t.sent()];case 2:return t.sent(),[2,S.YP];case 3:return[2]}}))}))}}),K=(p.PM,p.UA,p.PM,p.UA,M(p.dO)),W=j(p.Hi),H=N,V=L(p.UA),J=(p.UA,p.PM,p.dO,o.Ri,p.dO,o.Ri,o.dO,p.dO,o.xu,p.dO,o.xu,p.dO,o.xu,p.dO,o.xu,function(e,t){return(0,i.zG)(e,K(t))}),Z=function(e,t){return(0,i.zG)(e,W(t))},X=function(e,t){return(0,i.zG)(e,V(t))},ee="TaskOption",te={URI:ee,map:J},ne={URI:ee,map:J,ap:Z,chain:X},re=(S.F4,(0,m.YO)(te)),ie=(0,h.a)(ne),se=(S.Xl,n(3812)),oe=n(1586);const ae=(e,t)=>{const[n,s]=r.gS(a.uZ());return(0,i.zG)(t,r.UI(u.UI((t=>{a.Od(t)&&e.all().then((e=>(0,i.zG)(t,a.UI((0,oe.H5)((()=>e))),s)))}))),r.UI((e=>e()))),n},ce=(e,t)=>{let n=!1;return r.UI(u.UI((0,c.bw)((r=>{n||(n=(0,i.zG)(r,a.G((e=>{let[,t]=e;return"Pageview"===t.name}))),n&&e.trackTimeSinceInit("sdk_lifecycle_timestamps",{timestamp_name:t,time_origin:"sdk_init"}))}))))};function ue(e){let{eventsCacheFactory:t,metrics:h,trace:m,migratedStateMaps:v,worker:_,...b}=e;return e=>s.dQ((0,i.ls)((0,c.rO)({previousState:le}),(s=>{let{stopped:c,previousState:w}=s;(0,i.zG)(c,r.YP((e=>e&&_.stop()))),_.send({...b,migratedStateMaps:w.stateMigrated?{external:o.YP,internal:o.YP}:v(),previousState:w.workerState}),m.measureSinceInit("post_worker_config_duration").finish(),h.trackTimeSinceInit("sdk_lifecycle_timestamps",{timestamp_name:"master_sent_worker_config",time_origin:"sdk_init"},performance.now());const y=m.startSpan("worker_config_response_duration"),k=_.next();k.then((()=>{y.finish(),h.trackTimeSinceInit("sdk_lifecycle_timestamps",{timestamp_name:"master_received_worker_config_response",time_origin:"sdk_init"},performance.now())}));const I=((e,t)=>{const s=(0,i.zG)((()=>t),p.UI((e=>o.lo(!e))),V((()=>Q(e()))),re("eventsCache"),ie("eventsCacheService",(()=>(0,i.zG)((0,se.N1)(Y((()=>Promise.resolve().then(n.bind(n,2831))))),K((e=>e.eventCacheService)))))),c=s();return e=>{let{priorCachedEventsRequests:t,...n}=e;return e=>{let{previousState:s,stopped:l}=e;const d=r.a9(u.of(a.bM())),[f,g]=r.Ue({eventsToPublish:r.a9(u.of(a.bM())),priorCachedEventsResponses:d,state:r.a9(s)});return c.then(o.EQ((()=>g({eventsToPublish:n.eventsToPublish,priorCachedEventsResponses:d,state:r.a9(void 0)})),(e=>{let{eventsCache:r,eventsCacheService:i}=e;const{state:o,value:{newEvents:a}}=i({eventsCache:r,newEvents:n.eventsToPublish})({previousState:s,stopped:l});g({eventsToPublish:a,priorCachedEventsResponses:ae(r,t),state:o})}))),{state:(0,i.zG)(f,r.VS((e=>e.state))),value:(0,i.bc)((0,i.zG)(f,r.VS((e=>e.priorCachedEventsResponses))),{...n,eventsToPublish:(0,i.zG)(f,r.VS((e=>e.eventsToPublish)))})}}}})(t,k.then((e=>e.eventsCachedInWorker)));return(0,i.zG)((()=>_.read()),function(e,t){const n=e=>(0,i.zG)(e,l.Hd((e=>e in t)),(e=>{let{left:t,right:n}=e;return{buffers:n,nonBuffers:t}}));return s=>{const{buffers:o,nonBuffers:a}=n(e),[c,u]=r.Ue({...a,...(0,i.zG)(o,l.Su((e=>()=>{const n=o[e];return o[e]=t[e].empty,n})))});return(async()=>{for(;;){const e=(0,i.zG)(await s(),g.UI(n),g.ur({concat:(e,n)=>({nonBuffers:{...e.nonBuffers,...n.nonBuffers},buffers:(()=>{const r={...e.buffers};for(const e in n.buffers)r[e]=e in r?t[e].concat(r[e],n.buffers[e]):n.buffers[e];return r})()})})),r=(0,i.zG)(e.buffers,l.Su(((e,n)=>(o[e]=t[e].concat(o[e],n),()=>{const n=o[e];return o[e]=t[e].empty,n}))));u({...c.current,...e.nonBuffers,...r})}})(),(0,i.zG)(e,l.Su((e=>(0,i.zG)(c,r.UI((t=>t[e]))))))}}({activations:w.activations,cohorts:w.cohorts,context:{},eventsToPublish:a.cS,eventsToPublishOnPageUnload:a.cS,externalData:{},geoIP:o.YP,metrics:a.cS,priorCachedEventsRequests:a.cS,realtime:!1,state:w.workerState,transitionsSinceInit:{segmentsEntered:a.cS,segmentsExited:a.cS},workerStateFlushed:!1,stateMigratedThisInitialisation:!1,secureSignal:o.YP},{eventsToPublish:a.uZ(),metrics:a.uZ(),priorCachedEventsRequests:a.uZ()}),(e=>{let{metrics:t,...n}=e;return t.onChange((e=>e().forEach((e=>h.track(e))))),n}),(t=>{let{workerStateFlushed:n,stateMigratedThisInitialisation:s,activations:g,cohorts:p,state:m,secureSignal:v,...b}=t;const{value:[y,k],state:S}=I(b)({stopped:c,previousState:w.masterEventsCache});return function(e,t,n){const s=(0,i.zG)(r.vP(t),r.UI((0,i.ls)(l.UI((e=>"function"==typeof e?e:u.of(e))),(0,d.Yt)(u.G5))));let a=s.current();e(a),(0,i.zG)(s,r.YP((t=>{const r=t(),s=(0,i.zG)(r,l.z7(((e,t)=>{var r;return t!==a[e]&&(null===(r=n[e])||void 0===r||!r.isEmpty(t))})),o.DT((0,f.ff)(l.xb)));o.pC(s)&&(a={...a,...s.value},e(s.value))})))}(_.send,{consent:e.consent,contextualCohorts:e.contextualCohorts,enrichmentReplacementMap:e.enrichmentReplacementMap,eventSourceId:e.eventSourceId,identities:e.identities,userId:e.userId,userIdIsNewlyGenerated:e.userIdIsNewlyGenerated,newEvents:(0,i.zG)(e.newEvents,ce(h,"pageview_sent_to_worker")),sessionId:e.sessionId,viewId:e.viewId,webClient:e.webClient,pageviewState:e.pageviewState,priorCachedEventsResponses:y},{newEvents:{isEmpty:a.xb},priorCachedEventsResponses:{isEmpty:a.xb}}),h.trackTimeSinceInit("sdk_lifecycle_timestamps",{timestamp_name:"master_sent_worker_input",time_origin:"sdk_init"},performance.now()),{state:r.vP({activations:g,cohorts:p,masterEventsCache:S,workerState:m,stateMigrated:(0,i.zG)(r.vP(n,s),r.Rp(w.stateMigrated,((e,t)=>{let[n,r]=t;return e||n&&r})))}),value:{...k,stateMigratedThisInitialisation:s,activations:{dfp:r.UI((e=>e.dfp),g),xandr_ssp:r.UI((e=>e.xandr_ssp),g)},cohorts:{all:r.UI((e=>e.all),p),ql:r.UI((e=>e.ql),p),qlCustom:r.UI((e=>e.qlCustom),p),qlStandard:r.UI((e=>e.qlStandard),p)},secureSignal:v}}}))})))}const le=e=>he(e)?{activations:de(e.activations),cohorts:ge(e.cohorts),masterEventsCache:e.masterEventsCache,workerState:e.workerState,stateMigrated:!!e.stateMigrated}:{activations:de(null),cohorts:ge(null),masterEventsCache:null,workerState:null,stateMigrated:!1},de=e=>he(e)?{dfp:pe(e.dfp),xandr_ssp:pe(e.xandr_ssp)}:fe(),fe=()=>({dfp:a.cS,xandr_ssp:a.cS}),ge=e=>he(e)?{all:pe(e.all),ql:pe(e.ql),qlCustom:pe(e.qlCustom),qlStandard:pe(e.qlStandard)}:me(),pe=e=>Array.isArray(e)?e:a.cS,he=e=>null!==e&&"object"==typeof e&&!Array.isArray(e),me=()=>({all:a.cS,ql:a.cS,qlCustom:a.cS,qlStandard:a.cS})},4669:(e,t,n)=>{n.r(t),n.d(t,{runNextGenFeatures:()=>at});var r=n(2275),i=n(5460),s=n(936),o=n(3812),a=n(9727),c=n(7387);function u(e){let{messages:t}=e;const[n,r]=i.Ue(new Set);return t.on("permutive:addon:preinit",(e=>r(new Set([...n.current,e])))),n}function l(){const e=()=>Math.floor(Date.now()/1e3),[t,n]=i.Ue(e());return(0,o.UM)((()=>n(e())),1e3),t}function d(){const[e,t]=i.Ue(!1);return(0,c.aT)((()=>t(!0)),navigator.userAgent),e}var f=n(1583),g=n(2865),p=n(1385),h=n(817),m=n(3940),v=n(7054),_=n(4219),b=n(3636),w=n(6707);const y="[Prebid Monitoring]",k=(e,t)=>{e.metrics.trackCounter({name:"sdk_prebid_monitoring_key_flag_count_total",labels:t,value:1})},I=(e,t)=>{e.metrics.trackCounter({name:"sdk_prebid_monitoring_key_bidder_flag_count_total",labels:t,value:1})},S=function(e,t){const n=E(e);return s.K4((()=>(0,r.zG)(t,i.UI((0,r.ls)(a.DT((e=>e.consent)),a.UI((e=>e.prebidJS)))),i.D8(a.Eh((0,c.Or)())),i.bw((0,r.ls)(a.tS((e=>e.completedChecks?e.mainPair:a.YP)),a.UI((t=>k(e,{flag:"prebid_main_key",prebid_key:t.windowPropertyKey}))))),i.UI(a.UI((e=>(0,r.zG)(e.mainPair,a.UI((t=>[t,...e.otherPairs])),a.fS((()=>e.otherPairs)))))),i.Rp(new Set,((t,i)=>(0,r.zG)(i,a.UI(f.hX((e=>!t.has(e.windowPropertyKey)))),a.hX(f.Od),(0,c.bw)(a.EQ((()=>e.logger.debug(y,"Nothing to report")),(t=>e.logger.debug(y,"Reporting",t)))),a.fS((()=>[])),f.UI((t=>(0,r.zG)((t=>(0,r.zG)(p.Y3((function(){var n;const{pbjs:i,windowPropertyKey:s}=t;e.logger.log(y,`Reporting on "${s}"`,t);const o=P(i);e.logger.debug(y,`Version ${i.version} parsed as`,o);const a=(0,w.zi)(i);e.logger.debug(y,"Read config",a);const c=(0,r.zG)((null===(n=a.realTimeData)||void 0===n?void 0:n.dataProviders)??[],f.Ew((e=>"permutive"===e.name)));return e.logger.debug(y,"Read data provider config",c),{pbjs:i,config:a,dataProviderConfig:c,installedModules:i.installedModules||[],version:o,windowPropertyKey:s}}),g.w),p.ak("bidders",(e=>n.acBidders(e))),p.ak("permutiveRTDProvider",(e=>n.permutiveRTDProvider(e))),p.ak("consent",(e=>n.consent(e))),p.ak("targeting",(e=>n.targeting(e)))))(t),p.Pd((n=>e.reportError(`${y} Failed to report pair "${t.windowPropertyKey}", ${n.message}`)),(()=>t.windowPropertyKey))))),f.hp,(e=>new Set([...t,...e]))))),(e=>({reportedKeys:e})))))};const E=e=>({acBidders:t=>p.Y3((()=>{(0,b.Hn)("prebid")("data_provider_config",{ac_bidders:[]});const n=[],i=(0,r.zG)(t.dataProviderConfig,a.UI((e=>{var t;return(null==e||null===(t=e.params)||void 0===t?void 0:t.acBidders)??[]})),a.fS((()=>[]))),s=[...new Set([...n,...i])];return e.logger.debug(y,"Determined acBidders as",{acBidders:s,dynamicBidders:n,staticBidders:i}),s.forEach((n=>{I(e,{flag:"prebid_ac_bidder",prebid_key:t.windowPropertyKey,prebid_bidder:n})})),{acBidders:s,dynamicBidders:n,readBidders:i}}),g.w),consent:t=>p.Y3((()=>{var n,r,i,s,o,a;const c=t.windowPropertyKey;t.config.consentManagement&&"object"==typeof t.config.consentManagement&&k(e,{prebid_key:c,flag:"prebid_has_consent_management"});const u=t.installedModules.includes("gdprEnforcement");u&&k(e,{prebid_key:c,flag:"prebid_gdpr_enforcement_module"});const l=(null===(n=t.config)||void 0===n||null===(r=n.consentManagement)||void 0===r||null===(i=r.gdpr)||void 0===i||null===(s=i.rules)||void 0===s||null===(o=s.find((e=>"storage"===(null==e?void 0:e.purpose))))||void 0===o||null===(a=o.vendorExceptions)||void 0===a?void 0:a.includes("permutive"))||!1;return l&&k(e,{prebid_key:c,flag:"prebid_storage_exception"}),{hasGDPREnforcementModule:u,addedAsStorageException:l}}),g.w),permutiveRTDProvider:t=>p.Y3((()=>{const n=t.installedModules.includes("permutiveRtdProvider");return n&&k(e,{prebid_key:t.windowPropertyKey,flag:"prebid_permutive_rtd"}),n}),g.w),targeting:t=>{const n=(0,r.ls)(f.UI((e=>[e,null])),v.sq),i=(t,n)=>(0,r.zG)(t,(0,c.bw)((t=>e.logger.debug(y,`Processing ${t.length} bidder request(s)`,t))),f.hX((e=>n.hasOwnProperty(e.bidderCode)&&null===n[e.bidderCode])),h.vM((e=>e.bidderCode)),v.DZ(f.f2((0,c.lo)([[e=>(e=>{var t,n,r;const i=null==e||null===(t=e.user)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.find((e=>"permutive.com"===e.name));return!(null==i||null===(r=i.segment)||void 0===r||!r.length)})(e.ortb2),()=>a.G("ortb2")],[e=>{return t=e.params,["permutive","p_standard"].some((e=>{var n,r,i,s;return(null==t||null===(n=t.visitor)||void 0===n||null===(r=n[e])||void 0===r?void 0:r.length)||(null==t||null===(i=t.keywords)||void 0===i||null===(s=i[e])||void 0===s?void 0:s.length)}));var t},()=>a.G("params")],()=>a.YP]))),(0,c.bw)((t=>e.logger.debug(y,"Bidders targeting method's updated",t)))),s=s=>{e.logger.debug(y,"Bidders found with no targeting method",s);let o=n(s);const a=n=>(0,r.zG)(i([n],o),(0,c.bw)((e=>{o={...o,...e}})),(0,c.bw)(v.Su(((n,r)=>I(e,{flag:`prebid_${r}_targeting_success`,prebid_key:t.windowPropertyKey,prebid_bidder:n})))),(0,c.bw)((()=>{Object.values(o).includes(null)||(e.logger.debug(y,`Cleaning up "bidRequested" listener for ${t.windowPropertyKey}`),t.pbjs.offEvent("bidRequested",a))})));t.pbjs.onEvent("bidRequested",a)};return p.Y3((()=>{const o=(0,r.zG)(t.pbjs.getEvents(),f.DZ((0,r.ls)(a.DT((e=>"bidRequested"===e.eventType)),a.UI((0,c.vg)("args")))));return(0,r.zG)(t.bidders.acBidders,a.DT(f.Od),a.EQ((()=>e.logger.debug(y,"No bidders for targeting")),(0,r.ls)(n,(e=>({...e,...i(o,e)})),v.uK(m.ff((e=>null===e))),_.Pd((0,r.ls)(v.XP,a.DT(f.Od),a.UI(s)),v.Su(((n,r)=>I(e,{prebid_bidder:n,prebid_key:t.windowPropertyKey,flag:`prebid_${r}_targeting_success`})))))))}),g.w)}}),P=e=>{const[t,n,r]=e.version.split("-")[0].replace("v","").split(".").map((e=>parseInt(e)));return{major:t,minor:n,patch:r}},G=function(e,t){const n=(0,r.zG)(t.pbjs,i.VS((0,r.ls)(a.tS(a.KQ((e=>{var t;return null===(t=e.getUserIdsAsync)||void 0===t?void 0:t.call(e).then((()=>{var t;return(null===(t=e.getUserIdsAsEids)||void 0===t?void 0:t.call(e))??[]}))}))),a.UI(i.p4),a.fS((()=>i.a9(a.YP))))),i.UI(a.tS(a.Uo)),i.bw(a.mU((t=>(t.length>0?t.forEach((t=>{e.metrics.trackCounter({name:"sdk_prebid_alternative_identifiers_count_total",labels:{alternative_user_id_name:t.source},value:1})})):e.metrics.trackCounter({name:"sdk_prebid_alternative_identifiers_count_total",labels:{identifier:"NONE"},value:1}),a.YP))))),o=(0,r.zG)(t.pbjs,i.UI(a.tS(a.KQ((e=>{var t;return null===(t=e.getUserIdsAsEids)||void 0===t?void 0:t.call(e)})))));return s.K4((()=>(0,r.zG)(i.vP(n,o),i.UI((e=>{let[t,n]=e;return(0,r.zG)(t,a.wp((()=>n)))})),i.UI((0,r.ls)(a.UI(f.DZ((e=>{var t,n;return"string"==typeof(null===(t=e.uids)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.id)?a.G((0,r.bc)(e.source,{id:e.uids[0].id})):a.YP}))),a.tS(h.c2),a.UI(v.sq))),i.bw((t=>{a.pC(t)&&e.logger.debug("[Prebid Identifiers]","Found identifiers",t.value)})))))};const U=function(e){let{externalData:t}=e;return s.K4((()=>{t.removeExternalData(z)}))};const z="_pfws",D=new Set(["AdRequest","Reaction","PageviewEngagement","SegmentEntry","SegmentExit"]);class q{events;listeners;static highVolumeEvents=(()=>{const e=new Set([...D]);return e.delete("Reaction"),e})();constructor(){this.events=[],this.listeners=[]}newEvent(e,t){q.highVolumeEvents.has(e.name)||this.events.push([e,t]),[...this.listeners].forEach((n=>{this.handle(e,t,n)}))}addListener(e){this.listeners.push(e);const t={replay:()=>(this.replay(e),t),remove:()=>(this.remove(e),t)};return t}handle(e,t,n){const r="string"==typeof n.name&&e.name===n.name,i=n.name.test&&n.name.test(e.name),s=r||i;if(s)try{n.callback(e,t)}catch(e){window.console&&window.console.error&&window.console.error("callback error: ",e)}s&&n.once&&this.remove(n)}replay(e){let t=-1!==this.listeners.indexOf(e);for(let n=0;n<this.events.length&&t;n++)this.handle(this.events[n][0],this.events[n][1],e),t=-1!==this.listeners.indexOf(e)}remove(e){const t=this.listeners.indexOf(e);-1!==t&&this.listeners.splice(t,1)}}var C=n(2444),O=n(2925);var x=n(1586),R=n(9246),A=n(8940);const T="[Event Upload]",M=(e,t,n,a)=>s.dQ((s=>{let{stopped:u,previousState:l}=s;Array.isArray(l)&&(0,r.zG)(l,B(e))();const d=new Set([...D]),[g,{appendUntrackedEvents:h,appendUploadResults:m}]=(0,r.zG)((()=>{const[e,t]=i.gS(f.uZ()),[n,s]=i.gS(f.uZ());return(0,r.bc)({uploadResults:e,untrackedEvents:n},{appendUploadResults:t,appendUntrackedEvents:s})})(),(0,x.pL)((0,r.ls)((function(e){const[t,n]=(0,r.zG)(e.uploadResults,N(f.bj));return{...e,uploadResults:t,erroredEventsAsJSON:n}}),(function(e){const[t,n]=(0,r.zG)(e.erroredEventsAsJSON,N(f.UI((0,x.H5)((0,c.rO)({event:(0,c.rO)({time:e=>new Date(e)})})))));return{...e,erroredEventsAsJSON:t,erroredEvents:n}}),(function(e){let{uploadResults:t,untrackedEvents:n,...s}=e;const o=(0,r.zG)(t,i.UI(C.UI((0,r.ls)(f.hp,f.UI((0,x.H5)((0,c.rO)({time:e=>new Date(e)}))))))),a=(0,r.zG)(i.vP(o,n),i.UI(C.RD),i.UI(C.UI((e=>{let[t,n]=e;return n.concat(t)}))));return{...s,successEvents:a}}),(function(e){const[t,n]=(0,r.zG)(e.successEvents,N(f.UI((0,x.H5)((0,c.rO)({time:e=>e.toISOString()})))));return{...e,successEvents:t,successEventsAsJSON:n}})))),[v,_]=i.Ue(0),[b,w]=i.Ue(0),y=(0,r.zG)(t,i.UI(C.UI((e=>(0,r.zG)(e,f.uK((e=>{let[,t]=e;return!d.has(t.event.name)})),(e=>{let{left:t,right:n}=e;return(0,r.zG)(t,f.UI((0,x.H5)((e=>e.event))),h),n}))))),i.UI(C.UI((e=>(e.length>0&&((0,o.HJ)((()=>_(v.current+e.length)),500),(0,o.HJ)((()=>w(b.current+e.length)),5e3)),e))))),k=e=>t=>(0,r.zG)(e,f.hX((e=>{let[n]=e;return!t.closeEventsProcessed.includes(n)})),f.zo(t.queue)),I=(0,r.zG)(i.vP(v,b,y,n,u,a),i.Rp({closeEventsProcessed:f.cS,noQueueItemsProcessed:0,queue:f.cS},((t,n)=>{let[i,s,o,a,u,l]=n;return u?t:(0,r.zG)(t,(0,c.rO)({queue:f.zo(o())}),(t=>l?(0,r.zG)(t,(t=>n=>(0,r.zG)(n,k(t),$(e),(0,c.rO)({right:(0,c.bw)((0,r.ls)(f.UI((0,r.ls)((0,x.H5)((0,c.rO)({time:e=>e.toISOString()})),p.F2)),m))}),(e=>{let{left:t,right:i}=e;return(0,r.zG)(n,(0,c.rO)({closeEventsProcessed:(0,r.zG)(i,f.UI(x.li),f.zo),queue:(0,r.zG)(t.map(x.li),(e=>new Set(e)),(e=>f.hX((t=>{let[n]=t;return e.has(n)})))),noQueueItemsProcessed:e=>e+n.queue.length}))})))(a)):s>t.noQueueItemsProcessed||i===t.noQueueItemsProcessed+t.queue.length?(t=>((0,r.zG)(t.queue,B(e),A.UI(m))(),{closeEventsProcessed:t.closeEventsProcessed,noQueueItemsProcessed:t.noQueueItemsProcessed+t.queue.length,queue:f.cS}))(t):t))}))),S=(0,r.zG)(n,i.UI(k),i.ap(I),i.D8(f.Eh({equals:(e,t)=>e[0]===t[0]})));return{state:S,value:g}})),j=(e,t)=>e.permutiveUrls.getEndpointUrl("/batch/events",a.G(e.config.apiVersion),[["enrich",JSON.stringify(t.requiresEnrichment)],["sdkp",JSON.stringify(t.sdkProcessed)]]),L=e=>(0,r.zG)(e.events,f.UI((0,r.ls)(x.Yg,(e=>e.event)))),F=(0,r.ls)(h.vM((e=>{let[t,n]=e;return`${n.requiresEnrichment}${n.sdkProcessed}`})),(e=>Object.values(e)),f.UI((e=>({requiresEnrichment:e[0][1].requiresEnrichment,events:e,sdkProcessed:e[0][1].sdkProcessed})))),$=e=>(0,r.ls)(F,f.YO("request"),f.Hr("success",(t=>{let{request:n}=t;return e.logger.debug(T,"Uploading via beacon",n),e.permutiveApi.reqWithBeacon({url:j(e,n),payload:L(n)})})),f.tS((e=>(0,r.zG)(e.request.events,f.UI((t=>{let[n,{event:i}]=t;return e.success?p.F2((0,r.bc)(n,i)):p.t$((0,r.bc)(n,i))}))))),f.UI((0,c.bw)(p.EQ((t=>{let[,n]=t;return e.metrics.trackCounter({name:"sdk_event_beacon_fail_count_total",labels:{event_name:n.name},value:1})}),(t=>{let[,n]=t;return e.metrics.trackCounter({name:"sdk_event_beacon_success_count_total",labels:{event_name:n.name},value:1})})))),f.oh),B=e=>t=>(0,r.zG)(F(t),A.uU((t=>(0,r.zG)(t,(e=>t=>(e.logger.debug(T,"Uploading",t),R.Y3((()=>e.permutiveApi.req({payload:L(t),url:j(e,t),method:"POST",contentType:"text/plain",dataType:"json",withCredentials:!1})),(t=>(e.reportError(`Error sending events batch. Got ${p.KC(t)}`),t)))))(e),R.UI(f.UI((e=>e.body))),R.EQ((e=>(0,r.zG)(t.events,f.UI((()=>p.t$(e))))),f.UI(p.F2)),A.UI(f.$R(t.events))))),A.UI(f.tS(f.UI((t=>{let[n,[i,{event:s}]]=t;return(0,r.zG)(n,p.EQ((e=>p.t$((0,r.bc)(i,{event:{...s,time:s.time.toISOString()},error:e}))),(e=>"request_id"in e?p.t$((0,r.bc)(i,{event:{...s,time:s.time.toISOString()},error:e})):p.F2((0,r.bc)(i,{...s,id:e.id,time:e.time})))),(0,c.bw)(p.EQ((t=>{let[,{event:n}]=t;return e.metrics.trackCounter({name:"sdk_event_upload_fail_count_total",labels:{event_name:n.name},value:1})}),(t=>{let[,n]=t;return e.metrics.trackCounter({name:"sdk_event_upload_success_count_total",labels:{event_name:n.name},value:1})}))))}))))),N=e=>t=>(0,r.zG)(t,i.En(2,f.uZ()),(0,x.H5)(i.UI(C.UI(e)))),Q=(e,t,n,o)=>(0,r.zG)(s.K4((()=>{const[e,t]=i.Ue(i.a9(C.of([])));return{eventsToPublishBufferRef:i.xH(e),publishEvents:n=>{(0,r.zG)(i.vP(e.current,n),i.UI(C.RD),i.UI(C.UI(f.xH)),t)}}})),s.ak("eventUpload",(t=>{let{eventsToPublishBufferRef:r}=t;return M(e,r,n,o)})),s.ak("eventHandler",(e=>{let{eventUpload:t}=e;return n=t.successEventsAsJSON,o=t.erroredEventsAsJSON,s.K4((()=>{const e=new q;return(0,r.zG)(n,i.UI((e=>e())),i.bw((t=>t.forEach((t=>{let[,n]=t;return e.newEvent(n,null)}))))),(0,r.zG)(o,i.UI((e=>e())),i.bw((t=>t.forEach((t=>{let[,{event:n,error:r}]=t;return e.newEvent(n,r)}))))),{eventHandlerAfterUpload:e}}));var n,o})),s.ak("eventResolver",(e=>{let{eventUpload:n}=e;return((e,t,n,o)=>s.K4((()=>{(0,r.zG)(i.vP({unresolvedEvents:t,erroredEvents:o,successEvents:n}),i.UI((0,O.Yt)(C.G5)),i.Rp({},((e,t)=>{const n=t();return(0,r.zG)(n.unresolvedEvents,a.DT(f.Od),a.UI((0,r.ls)(v.sq,(t=>({...e,...t})))),a.fS((()=>e)),(e=>(0,r.zG)(n.successEvents,f.u4(e,((e,t)=>{let[n,i]=t;return(0,r.zG)(v.P5(n,e),a.UI((t=>(t.succeed(i),v.EG(n)(e)))),a.fS((()=>e)))})))),(e=>(0,r.zG)(n.erroredEvents,f.u4(e,((e,t)=>{let[n,{event:i,error:s}]=t;return(0,r.zG)(v.P5(n,e),a.UI((t=>(t.fail(`Failed to track ${i.name}. ${"error"in s?s.error.message:s.message}`),v.EG(n)(e)))),a.fS((()=>e)))})))))})))})))(0,t,n.successEvents,n.erroredEvents)})),s.UI((e=>{let{publishEvents:t,eventHandler:n}=e;return{eventHandlerAfterUpload:n.eventHandlerAfterUpload,publishEvents:t}}))),Y="_pnativo",K=function(e){let{externalData:t}=e;return s.K4((()=>{t.removeExternalData(Y)}))};var W,H,V,J,Z,X=-1,ee=function(e){addEventListener("pageshow",(function(t){t.persisted&&(X=t.timeStamp,e(t))}),!0)},te=function(){var e=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},ne=function(){var e=te();return e&&e.activationStart||0},re=function(e,t){var n=te(),r="navigate";return X>=0?r="back-forward-cache":n&&(document.prerendering||ne()>0?r="prerender":document.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:r}},ie=function(e,t,n){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var r=new PerformanceObserver((function(e){Promise.resolve().then((function(){t(e.getEntries())}))}));return r.observe(Object.assign({type:e,buffered:!0},n||{})),r}}catch(e){}},se=function(e,t,n,r){var i,s;return function(o){t.value>=0&&(o||r)&&((s=t.value-(i||0))||void 0===i)&&(i=t.value,t.delta=s,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,n),e(t))}},oe=function(e){requestAnimationFrame((function(){return requestAnimationFrame((function(){return e()}))}))},ae=function(e){document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e()}))},ce=function(e){var t=!1;return function(){t||(e(),t=!0)}},ue=-1,le=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},de=function(e){"hidden"===document.visibilityState&&ue>-1&&(ue="visibilitychange"===e.type?e.timeStamp:0,ge())},fe=function(){addEventListener("visibilitychange",de,!0),addEventListener("prerenderingchange",de,!0)},ge=function(){removeEventListener("visibilitychange",de,!0),removeEventListener("prerenderingchange",de,!0)},pe=function(){return ue<0&&(ue=le(),fe(),ee((function(){setTimeout((function(){ue=le(),fe()}),0)}))),{get firstHiddenTime(){return ue}}},he=function(e){document.prerendering?addEventListener("prerenderingchange",(function(){return e()}),!0):e()},me=[1800,3e3],ve=[.1,.25],_e=function(e,t){t=t||{},function(e,t){t=t||{},he((function(){var n,r=pe(),i=re("FCP"),s=ie("paint",(function(e){e.forEach((function(e){"first-contentful-paint"===e.name&&(s.disconnect(),e.startTime<r.firstHiddenTime&&(i.value=Math.max(e.startTime-ne(),0),i.entries.push(e),n(!0)))}))}));s&&(n=se(e,i,me,t.reportAllChanges),ee((function(r){i=re("FCP"),n=se(e,i,me,t.reportAllChanges),oe((function(){i.value=performance.now()-r.timeStamp,n(!0)}))})))}))}(ce((function(){var n,r=re("CLS",0),i=0,s=[],o=function(e){e.forEach((function(e){if(!e.hadRecentInput){var t=s[0],n=s[s.length-1];i&&e.startTime-n.startTime<1e3&&e.startTime-t.startTime<5e3?(i+=e.value,s.push(e)):(i=e.value,s=[e])}})),i>r.value&&(r.value=i,r.entries=s,n())},a=ie("layout-shift",o);a&&(n=se(e,r,ve,t.reportAllChanges),ae((function(){o(a.takeRecords()),n(!0)})),ee((function(){i=0,r=re("CLS",0),n=se(e,r,ve,t.reportAllChanges),oe((function(){return n()}))})),setTimeout(n,0))})))},be=0,we=1/0,ye=0,ke=function(e){e.forEach((function(e){e.interactionId&&(we=Math.min(we,e.interactionId),ye=Math.max(ye,e.interactionId),be=ye?(ye-we)/7+1:0)}))},Ie=function(){return W?be:performance.interactionCount||0},Se=function(){"interactionCount"in performance||W||(W=ie("event",ke,{type:"event",buffered:!0,durationThreshold:0}))},Ee=[],Pe=new Map,Ge=0,Ue=[],ze=function(e){if(Ue.forEach((function(t){return t(e)})),e.interactionId||"first-input"===e.entryType){var t=Ee[Ee.length-1],n=Pe.get(e.interactionId);if(n||Ee.length<10||e.duration>t.latency){if(n)e.duration>n.latency?(n.entries=[e],n.latency=e.duration):e.duration===n.latency&&e.startTime===n.entries[0].startTime&&n.entries.push(e);else{var r={id:e.interactionId,latency:e.duration,entries:[e]};Pe.set(r.id,r),Ee.push(r)}Ee.sort((function(e,t){return t.latency-e.latency})),Ee.length>10&&Ee.splice(10).forEach((function(e){return Pe.delete(e.id)}))}}},De=function(e){var t=self.requestIdleCallback||self.setTimeout,n=-1;return e=ce(e),"hidden"===document.visibilityState?e():(n=t(e),ae(e)),n},qe=[200,500],Ce=function(e,t){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(t=t||{},he((function(){var n;Se();var r,i=re("INP"),s=function(e){De((function(){e.forEach(ze);var t=function(){var e=Math.min(Ee.length-1,Math.floor((Ie()-Ge)/50));return Ee[e]}();t&&t.latency!==i.value&&(i.value=t.latency,i.entries=t.entries,r())}))},o=ie("event",s,{durationThreshold:null!==(n=t.durationThreshold)&&void 0!==n?n:40});r=se(e,i,qe,t.reportAllChanges),o&&(o.observe({type:"first-input",buffered:!0}),ae((function(){s(o.takeRecords()),r(!0)})),ee((function(){Ge=Ie(),Ee.length=0,Pe.clear(),i=re("INP"),r=se(e,i,qe,t.reportAllChanges)})))})))},Oe=[2500,4e3],xe={},Re={passive:!0,capture:!0},Ae=new Date,Te=function(e,t){H||(H=t,V=e,J=new Date,Le(removeEventListener),Me())},Me=function(){if(V>=0&&V<J-Ae){var e={entryType:"first-input",name:H.type,target:H.target,cancelable:H.cancelable,startTime:H.timeStamp,processingStart:H.timeStamp+V};Z.forEach((function(t){t(e)})),Z=[]}},je=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){Te(e,t),i()},r=function(){i()},i=function(){removeEventListener("pointerup",n,Re),removeEventListener("pointercancel",r,Re)};addEventListener("pointerup",n,Re),addEventListener("pointercancel",r,Re)}(t,e):Te(t,e)}},Le=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,je,Re)}))},Fe=[100,300];const $e=function(e){let t=0;const n=n=>{if(0===t)return;const r=Be(n);r&&e.metrics.track({name:`sdk_web_vitals_${r.suffix}`,labels:{},value:r.value})},o=(0,c.HP)((()=>{_e(n),function(e,t){t=t||{},he((function(){var n,r=pe(),i=re("LCP"),s=function(e){t.reportAllChanges||(e=e.slice(-1)),e.forEach((function(e){e.startTime<r.firstHiddenTime&&(i.value=Math.max(e.startTime-ne(),0),i.entries=[e],n())}))},o=ie("largest-contentful-paint",s);if(o){n=se(e,i,Oe,t.reportAllChanges);var a=ce((function(){xe[i.id]||(s(o.takeRecords()),o.disconnect(),xe[i.id]=!0,n(!0))}));["keydown","click"].forEach((function(e){addEventListener(e,(function(){return De(a)}),!0)})),ae(a),ee((function(r){i=re("LCP"),n=se(e,i,Oe,t.reportAllChanges),oe((function(){i.value=performance.now()-r.timeStamp,xe[i.id]=!0,n(!0)}))}))}}))}(n),function(e,t){t=t||{},he((function(){var n,r=pe(),i=re("FID"),s=function(e){e.startTime<r.firstHiddenTime&&(i.value=e.processingStart-e.startTime,i.entries.push(e),n(!0))},o=function(e){e.forEach(s)},a=ie("first-input",o);n=se(e,i,Fe,t.reportAllChanges),a&&(ae(ce((function(){o(a.takeRecords()),a.disconnect()}))),ee((function(){var r;i=re("FID"),n=se(e,i,Fe,t.reportAllChanges),Z=[],V=-1,H=null,Le(addEventListener),r=s,Z.push(r),Me()})))}))}(n),Ce(n)}));return s.K4((n=>{let{stopped:s}=n;t++,(0,r.zG)(s,i.YP((e=>{e&&t--}))),e.metrics.isEnabled()&&o()}))};const Be=e=>(e=>"CLS"===e.name)(e)?{value:e.value,suffix:`${e.name.toLowerCase()}_score`}:(e=>["INP","FID","LCP"].includes(e.name))(e)?{value:e.value/1e3,suffix:`${e.name.toLowerCase()}_seconds`}:void 0;var Ne=n(1001);const Qe=(e,t)=>{const{activationManager:n,externalData:o,metrics:a,permutiveData:c}=e;return(0,r.zG)(s.of({}),s.ak("psegs",(()=>((e,t)=>s.K4((n=>{let{stopped:s}=n;const o="_psegs";(0,r.zG)(i.vP(t,s),i.YP((t=>{let[n,i]=t;i||(0,r.zG)(n,f.EQ((()=>e.removeExternalData(o)),(t=>e.setExternalJsonData(o,t))))})))})))(e.externalData,t.qlSegments))),s.ak("webVitals",(()=>$e(e))),s.ak("nativo",(()=>K({activationManager:n,externalData:o,metrics:a,queryLanguageCohorts:t.qlSegments,...t}))),s.ak("twitterPixel",(()=>(0,Ne.eJ)({activationManager:n,metrics:a,permutiveData:c,queryLanguageCohorts:t.qlSegments,...t}))),s.ak("prebidJS",(()=>(0,w.dN)(e))))};var Ye=n(6329);const Ke=()=>{const[e,t]=i.gS(f.uZ());return{trackEvent:e=>{let n,r,{event:i,useBeacon:s}=e;const o=new Promise(((e,t)=>{n=e,r=t}));return t([{localId:(0,c.k$)(),event:i,fail:r,succeed:n,useBeacon:s}]),o},trackedEvents:e}};n(1228);const We=function(e,t){return s.K4((()=>({addon:()=>({}),cohorts:i.a9(a.YP)})))};const He=(e,t)=>s.vP({contextual:We(e,t)});var Ve=n(5326);const Je="_ppsts",Ze=function(e,t,n){return s.dQ((s=>{let{previousState:o}=s;e.externalData.removeExternalData(Je);const u=r.Q1;return(0,r.zG)(i.vP({consent:n,sessionId:t}),i.Rp((l=o,(0,r.zG)(l,a.DT((e=>Boolean(e&&"object"==typeof e))),a.UI((0,c.rO)({topics:e=>i.a9(a.of(e))})))),((t,n)=>(0,r.zG)(n,a.DT((e=>{let{consent:t}=e;return t})),a.UI((n=>{let{sessionId:s}=n;return(0,r.zG)(t,a.hX((e=>e.sessionId===s)),a.fS((()=>({sessionId:s,topics:i.fF(Xe(e))}))))}))))),i.VS(a.EQ((()=>i.a9(a.YP)),(e=>(0,r.zG)(e.topics,i.UI(a.UI((t=>({topics:t,sessionId:e.sessionId})))))))),i.bw(u),(e=>({state:(0,r.zG)(e,i.UI(a.FS)),value:{replacementMap:(0,r.zG)(e,i.UI(a.UI((e=>({$privacy_sandbox_topics_v2:e.topics[2]??[]})))))}})));var l}))};const Xe=e=>(0,r.zG)(R.Do,R.Hr("span",(()=>e.trace.startSpan("topics_data_retrieval"))),R.ak("message",(()=>R.Y3(et,(e=>e)))),R.At((e=>{let{span:t}=e;return t.finish})),R.EQ((t=>(e.api.reportError(`Error while registering the topics enricher: got ${t}`),{})),(e=>{let{message:t}=e;return tt(t.value??[])}))),et=()=>{if(!("browsingTopics"in document))return Promise.resolve({value:void 0});const e="https://cdn.permutive.app/topics.html",t=new URL(e).origin,n=document.createElement("iframe");n.src=e,n.style.display="none",n.browsingtopics=!0;const r=(0,o.t_)(new Promise(((e,r)=>{window.addEventListener("message",(i=>{i.source===n.contentWindow&&i.origin===t&&(i.data.error?r(i.data.error):e(i.data))}))})));return document.body.appendChild(n),r},tt=e=>(0,r.zG)(e,h.vM((e=>e.taxonomyVersion)),Ve.UI((e=>e.map((e=>e.topic)))));var nt=n(1993),rt=n(3247);i.a9(a.YP),i.a9([]),i.a9([]),i.a9([]),i.a9(Ye.b()),i.a9(a.YP),i.a9({segmentsEntered:[],segmentsExited:[]}),i.a9(!1),i.a9((e=>{let{event:t}=e;return Promise.resolve(t)})),new q,i.a9(a.YP),i.a9(!1);function it(e,t,n){const{addonsLoaded:u,consent:l,currentTimestampSecs:d,enabledAddons:g,identities:p,sdkVariant:h,sessionId:m,userId:v,userIdIsNewlyGenerated:_,viewId:b,pageviewState:w}=t,[y,k]=(0,r.zG)(i.Ue(i.a9(f.cS)),(e=>{let[t,n]=e;return[i.xH(t),n]})),I=a.ij(e.permutiveData.getData("event-source-id")),E=(0,r.zG)(v,i.Rp(-1,(e=>e+1)),i.UI((t=>(0,r.zG)(I,a.hX((()=>0===t)),a.fS((()=>{const t=(0,c.k$)();return e.permutiveData.setData("event-source-id",t),t}))))));return(0,r.zG)(s.vP({computeTimeMetrics:(P=e.metrics,s.K4((e=>{let{stopped:t}=e;const n=(0,o.HJ)((()=>{(0,r.zG)((0,o.iE)(),(0,c.bw)((()=>(0,o.ho)(!1))),f.UI((e=>{let[t,n]=e;return(n-t)/1e3})),(e=>{P.track({name:"sdk_ui_thread_compute_first10s_total_seconds",value:e.reduce(((e,t)=>e+t),0),labels:{}}),P.track({name:"sdk_ui_thread_compute_first10s_total_task_overrun_seconds",value:(0,r.zG)(e,f.hX((e=>e>.05)),f.UI((e=>e-.05)),f.u4(0,((e,t)=>e+t))),labels:{}}),P.track({name:"sdk_ui_thread_compute_first10s_longest_task_seconds",value:Math.max(0,...e),labels:{}})}))}),1e4);(0,r.zG)(t,i.YP((e=>e&&n())))}))),audiences:He(e,t),privacySandboxTopics:Ze(e,m,l)}),s.UI((e=>{const{reset:t,trackEvent:n,trackedEvents:s}=((e,t)=>{const[n,s]=i.Ue(0),o=(0,r.zG)(i.vP(n,t),i.UI((()=>[]))),a=(0,r.zG)(i.vP(o,e),i.D8(((e,t)=>{let[,n]=e,[,r]=t;return n===r})),i.UI((e=>{let[t]=e;const n=Ke();return t.forEach(n.trackEvent),n})));return{reset:()=>s(n.current+1),trackEvent:(0,r.zG)(i.vP(a,o),i.UI((e=>{let[t,n]=e;return e=>(n.push(e),t.trackEvent(e))}))),trackedEvents:(0,r.zG)(a,i.VS((e=>e.trackedEvents)))}})(v,b),[o,a,c]=(0,r.zG)(s,i.En(3,f.uZ()));return{...e,reset:t,trackEvent:n,unresolvedEvents:(0,r.zG)(o,i.UI(C.UI(f.UI((e=>(0,r.bc)(e.localId,{fail:e.fail,succeed:e.succeed})))))),eventsToProcessLocally:(0,r.zG)(a,i.UI(C.UI(f.hX((e=>!e.useBeacon))))),eventsToUploadViaBeacon:(0,r.zG)(c,i.UI(C.UI(f.hX((e=>e.useBeacon)))))}})),s.ak("eventPublication",(n=>{let{unresolvedEvents:r}=n;return Q(e,r,y,t.sdkClosing)})),s.ak("core",(o=>{let{audiences:c,eventPublication:u,eventsToProcessLocally:g,privacySandboxTopics:h}=o;return(0,r.zG)(n({contextualCohorts:c.contextual.cohorts,consent:l,currentTimestampSecs:d,enrichmentReplacementMap:h.replacementMap,eventSourceId:E,identities:p,newEvents:(0,r.zG)(g,i.UI(C.UI(f.UI((e=>(0,r.bc)(e.localId,e.event)))))),sessionId:m,userId:v,userIdIsNewlyGenerated:_,viewId:b,webClient:t.webClient,pageviewState:w}),s.bw((e=>{let{eventsToPublish:t}=e;return(0,r.zG)(t,i.UI(C.UI(st)),u.publishEvents)})),s.bw((e=>{let{eventsToPublishOnPageUnload:t}=e;return(0,r.zG)(t,i.UI(st),k)})),s.bw((t=>{let{externalData:n}=t;return(0,r.zG)(n,i.UI((t=>(0,r.zG)(Object.entries(t),f.UI((t=>{let[n,i]=t;return(0,r.zG)(i,a.EQ((()=>e.externalData.removeExternalData(n)),(t=>e.externalData.setExternalJsonData(n,t))))}))))))})),s.bw((t=>{let{context:n}=t;return(0,r.zG)(n,i.UI((t=>{const n=Object.entries(t);e.clientContext.updateContext(...n)})))})))})),s.bw((e=>{let{core:n,eventPublication:s,eventsToUploadViaBeacon:o}=e;return(0,r.zG)(i.vP({cohorts:n.cohorts.all,eventsIO:o,segments:n.cohorts.ql,sessionId:m,userId:v,viewId:b,webClient:t.webClient}),i.UI((e=>{let{webClient:t,...n}=e;return(0,r.zG)(t,a.UI((e=>({...n,webClient:e}))))})),i.UI(a.EQ((()=>C.of(f.bM())),(e=>{let{cohorts:t,eventsIO:n,segments:i,sessionId:s,userId:o,viewId:a,webClient:c}=e;return(0,r.zG)(n,C.UI(f.UI((e=>{let{event:n,localId:u}=e;return(0,r.bc)(u,{requiresEnrichment:!0,sdkProcessed:!1,event:{user_id:o,name:n.name,segments:i,cohorts:t,properties:{...n.properties,client:{...c,...n.properties.client??{}}},session_id:s,time:new Date,view_id:a}})}))))}))),s.publishEvents)})),s.ak("metricContext",(e=>{let{core:n}=e;return(0,r.zG)(n.geoIP,i.UI(a.tS((e=>{var t;return a.ij(null===(t=e.geo_info)||void 0===t?void 0:t.continent)}))),(e=>Ye.X({continent:e,sampleRate:t.metricSampleRate,sdkVariant:h,sessionId:m,userId:v,viewId:b})))})),s.ak("sdkql",(t=>{let{core:n}=t;return Qe(e,{addonsLoaded:u,consent:l,initdAddons:g,qlSegments:n.cohorts.ql})})),s.ak("strategicPartnerships",(t=>{let{sdkql:n}=t;return((e,t)=>s.vP({prebid_identifiers:G(e,t)}))(e,{pbjs:(0,r.zG)(n.prebidJS,i.UI((e=>(0,r.zG)(e.mainPair,a.UI((e=>e.pbjs))))))})})),s.ak("mediaAndEntertainment",(t=>{let{core:n}=t;return((e,t)=>(0,r.zG)(s.vP({freewheel:U({activationManager:e.activationManager,externalData:e.externalData,...t})}),s.UI((0,r.a9)({}))))(e,{addonsLoaded:u,consent:l,initdAddons:g,queryLanguageCohorts:n.cohorts.ql})})),s.ak("advertisers",(t=>{let{sdkql:n}=t;return((e,t)=>(0,r.zG)(s.of(t),s.ak("prebidMonitoring",(t=>{let{consent:n,prebidJS:r}=t;return S(e,i.vP({consent:n,prebidJS:r}))})),s.UI(r.Q1)))(e,{consent:l,prebidJS:n.prebidJS})})),s.ak("identityManager",(t=>{let{core:n}=t;return(0,nt.u6)({...e,consent:l,tcfApiStatus:(0,rt.SD)(window,e.logger).tcfApiStatusRef,currentTimestampSecs:d,geoIP:n.geoIP},p)})),s.UI((e=>{let{core:t,audiences:n,metricContext:r,sdkql:s,trackEvent:o,eventPublication:a,strategicPartnerships:c,identityManager:u,reset:l}=e;return{activations:t.activations,addons:{contextual:n.contextual.addon,identityManager:u,secureSignal:t.secureSignal},metricContext:r,pbjsPair:i.UI((e=>e.mainPair),s.prebidJS),queryLanguageCohorts:{all:t.cohorts.ql,custom:t.cohorts.qlCustom,standard:t.cohorts.qlStandard},segmentTransitionsSinceInit:t.transitionsSinceInit,trackEvent:o,realtime:t.realtime,eventHandlerAfterUpload:a.eventHandlerAfterUpload,prebidIdentifiers:c.prebid_identifiers,reset:l,stateMigratedThisInitialisation:t.stateMigratedThisInitialisation}})));var P}const st=f.UI((0,x.H5)((e=>({event:e,requiresEnrichment:!1,sdkProcessed:!0}))));function ot(e){return(0,r.ls)((0,c.rO)({previousState:e=>{if("string"!=typeof e)return{};try{return JSON.parse(e)}catch{return{}}}}),e,(0,c.rO)({state:i.UI(JSON.stringify)}))}function at(e){const t=function(e){const{activationManager:t,api:n,clientContext:r,config:i,externalData:s,logger:o,metrics:a,permutiveData:c,network:u,urls:l,namespace:d,trace:f}=e;return{activationManager:t,api:n,clientContext:r,config:i,externalData:s,logger:o,metrics:a,permutiveData:c,permutiveApi:u,permutiveUrls:l,reportError:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n.reportError(e,null==t?void 0:t.userId,null==t?void 0:t.timestamp)},namespace:d,trace:f}}(e),n=function(e){const t={addonsLoaded:e.addonsLoaded,consent:(n=e.consentTracking,(0,r.zG)(n,a.EQ((()=>i.a9(!0)),(e=>e.consentRef)))),currentTimestampSecs:l(),enabledAddons:u(e),identities:e.identities,sdkClosing:d(),metricSampleRate:e.config.metricsSamplingPercentage/100,sdkVariant:a.ij(e.sdkVariant),sessionId:i.a9(e.sessionManager.getSessionId()),userId:e.userId.ref,userIdIsNewlyGenerated:e.userId.isNewlyGenerated,viewId:e.viewId.ref,pageviewState:e.pageviewState,webClient:e.webClient};var n;return t}(e);return function(e,t,n,a){const u=5e3;return(0,r.zG)(e,function(e,t){return n=>s=>{const{value:a,state:c}=n(s),[u,l]=i.Ue(c.current),d=(0,o.UM)((()=>l(c.current)),e),f=(0,r.zG)(i.vP(c,u),i.UI((e=>{let[t,n]=e;return t===n})));return(0,r.zG)(t,i.bw((e=>e&&d()))),{value:(0,r.bc)(f,a),state:(0,r.zG)(i.vP(t,c,u),i.UI((e=>{let[t,n,r]=e;return t?n:r})))}}}(u,a),ot,function(e){return t=>(0,r.ls)((0,c.rO)({previousState:t=>e.current?t:void 0}),t,(0,c.rO)({state:(0,r.ls)((t=>i.vP(e,t)),i.UI((e=>{let[t,n]=e;return t?n:void 0})))}))}(n),function(e){return t=>(0,r.ls)((0,c.rO)({previousState:()=>localStorage.getItem(e)}),t,(0,c.rO)({state:(0,c.bw)(i.YP((t=>{switch(typeof t){case"string":localStorage.setItem(e,t);break;case"undefined":localStorage.removeItem(e);break;case"object":if(null===t){localStorage.removeItem(e);break}throw new Error("Permutive app raised an invalid state.");default:throw new Error("Permutive app raised an invalid state.")}})))}))}(t),s.UI((e=>{let[t,n]=e;return n})))({stopped:i.a9(!1)}).value}(it(t,n,e.core),e.namespace.getNamespacedStorageKey("permutive-app"),n.consent,n.sdkClosing)}},6851:(e,t,n)=>{n.d(t,{iq:()=>d,B9:()=>p,ti:()=>m});var r=n(2865),i=n(3939),s=n(1385),o=n(9727),a=n(2275),c=n(7387);var u=n(4513);const l="__permutive.",d="__permutiveConfigQueryParams";const f={default:{windowKey:"permutive",environment:"default",apiHost:"api.permutive.com",apiKey:"",apiProtocol:"https",cdnBaseUrl:"cdn.permutive.com",cdnProtocol:"https",pxidHost:"prmutv.co",apiVersion:"v2.0",sdkErrorsApiVersion:"v2",advertiserApiVersion:"v2",classificationModelsApiVersion:"v1",loggingEnabled:!1,tracingEnabled:!1,requestTimeout:5e3,cookieDomain:"."+(0,u._Y)(window.location.hostname),cookieName:"permutive-id",cookieExpiry:function(){const e=new Date;return e.setMonth(e.getMonth()+6),e.toUTCString()}(),eventsTTLInDays:null,permutiveDataMiscKey:"permutive-data-misc",permutiveDataQueriesKey:"permutive-data-queries",stateNamespace:"",sendClientErrors:!0,metricsSamplingPercentage:20,eventsCacheLimitBytes:25e5,segmentSyncApiHost:"f279b5ea-1200-4ff6-9d35-17893279723e.partner.permutive.app",consentRequired:!1,sdkType:"stable",viewId:null,localStorageDebouncedKeys:[],localStorageWriteDelay:1e3,localStorageWriteMaxDelay:1500,watson:{enabled:!0},secureSignalsApiHost:"secure-signals.permutive.app"},production:{},development:{apiProtocol:"http",loggingEnabled:!0,tracingEnabled:!0,sendClientErrors:!1}},g=e=>{const t={consentRequired:!0,loggingEnabled:!0,sendClientErrors:!0,tracingEnabled:!0},n={eventsTTLInDays:!0,eventsCacheLimitBytes:!0,metricsSamplingPercentage:!0,requestTimeout:!0,localStorageWriteDelay:!0,localStorageWriteMaxDelay:!0};return Object.keys(e).reduce(((r,i)=>{if(t.hasOwnProperty(i)){const t="true"===e[i];return{...r,[i]:t}}if(n.hasOwnProperty(i)){const t=Number(e[i]);return isNaN(t)?r:{...r,[i]:t}}return{...r,[i]:e[i]}}),{})},p=function(){let{getQueryParams:e=u.zM}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e=>Object.entries(e).reduce(((e,t)=>{let[n,r]=t;if(!(0===n.indexOf(l)))return e;const i=n.replace(l,"");return[...e,[i,r]]}),[]);return(0,a.zG)(s.Y3((()=>(0,a.zG)(e(),t,(e=>(0,c.m8)(...e)),g,(e=>h({queryConfig:e})))),(e=>`Failed to parse query params. Got ${(0,r.w)(e).message}`)))},h=e=>{let{queryConfig:t}=e;const n=(0,a.zG)(o.Y3((()=>window.sessionStorage.getItem(d))),o.tS(o.ij),o.tS((0,a.ls)(i.A,o.ij)),o.fS((()=>({}))));return(0,c.PM)(n,t)},m=(e,t)=>{const n=(e.environment&&f[e.environment])??{};return(0,c.PM)(f.default,n,e,t)}},1228:(e,t,n)=>{n.d(t,{NY:()=>h,vk:()=>f,qA:()=>d});var r=n(2865),i=n(1385),s=n(2275),o=n(9246),a=n(7056),c=n(1954),u=n(5460);var l=n(4564);const d=()=>({opt_in:!0,token:c.L}),f=()=>({opt_in:!1,token:""}),g=e=>{return(0,s.ls)((t=e,e=>(0,s.zG)((0,l.J)(t.consentRequired,e),(e=>{let{consentData:n,isValid:r}=e;return t.consentDatabase.put(n,c.L),r}))),(e=>{let{logger:t,messages:n}=e;return e=>{const r=e?"given":"revoked";return t.log("Consent has been",r),n.emit(`permutive:consent:${r}`),e}})(e));var t},p=e=>(t,n)=>{e.on("permutive:consent:revoked",t),e.on("permutive:consent:given",n)},h=async e=>{const{logger:t,namespace:n,consentRequired:d,messages:f}=e,h=new a.oP(window.localStorage,n),m=(0,l.J)(d,await h.get(c.L)),v=await(0,s.zG)(o.Y3((()=>h.put(m.consentData,c.L)),(e=>new Error(`LocalStorage access is required. ${(0,r.w)(e).message}`))),(e=>e()));if(i.nM(v))return v;const{consentRef:_,giveConsent:b,revokeConsent:w,isRevoked:y,isGiven:k}=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const[t,n]=u.Ue(e),r=()=>!0===t.current;return{consentRef:t,revokeConsent:()=>(n(!1),t.current),giveConsent:()=>(n(!0),t.current),isRevoked:()=>!r(),isGiven:r}}(m.isValid),I={consentRef:_,isGiven:k,isRevoked:y,listenForConsent:p(f)};I.listenForConsent(w,b);const S=g({consentDatabase:h,consentRequired:d,logger:t,messages:f});return i.F2({consentTracking:I,consentValidation:S,consentDatabase:h})}},1954:(e,t,n)=>{n.d(t,{L:()=>r});const r="permutive-consent"},4429:(e,t,n)=>{n.d(t,{v:()=>r});const r=(e,t,n)=>function(){const r=n()?t:e;return r(...arguments)}},4564:(e,t,n)=>{n.d(t,{J:()=>o});var r=n(2275),i=n(9727),s=n(1228);const o=(e,t)=>(0,r.zG)((0,i.ij)(t),(t=>!1===e&&(0,i.Wi)(t)?{isValid:!0,consentData:(0,s.qA)()}:(e=>(0,i.pC)(e)&&(e=>null!==e&&"object"==typeof e)(e.value)&&(e=>{var t;return!0===e.opt_in&&"string"==typeof e.token&&(null===(t=e.token)||void 0===t?void 0:t.length)>0})(e.value))(t)?{isValid:!0,consentData:t.value}:{isValid:!1,consentData:(0,s.vk)()}))},268:(e,t,n)=>{n.d(t,{S:()=>m});var r=n(2275),i=n(9727),s=n(366),o=n(5460),a=n(5842),c=n(3247),u=n(3812);var l=n(7387);class d{wait_prev;block_next;task;started;complete;constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.wait_prev=t.wait_prev||!1,this.block_next=t.block_next||!1,this.started=!1,this.complete=!1,this.task=e}waits(){return this.wait_prev}blocks(){return this.block_next}execute(e){this.started=!0,this.task((()=>{this.complete=!0,e()}))}}var f=n(1202);n(9082);class g{logger;api;activationManager;sessionManager;metrics;viewId;userId;network;clientContext;unprocessedEvents;taskQueue;identities;permutiveReset;messages;addons;trace;permutiveRealtime;state;customProperties;config;permutiveData;externalData;cookies;identitiesIngestor;global;nextGen;pageviewState;initialisedAddons=[];tcf;constructor(e,t,n,r,i,s,o,a,u,l,d,f,g,p,h,m,v,_,b,w,y,k,I,S,E,P,G){this.logger=e,this.api=t,this.activationManager=n,this.sessionManager=r,this.metrics=i,this.viewId=s,this.userId=o,this.network=a,this.clientContext=u,this.unprocessedEvents=l,this.taskQueue=d,this.identities=f,this.permutiveReset=g,this.messages=p,this.addons=h,this.trace=m,this.permutiveRealtime=v,this.state=_,this.customProperties=b,this.config=w,this.permutiveData=y,this.externalData=k,this.cookies=I,this.identitiesIngestor=S,this.global=E,this.nextGen=P,this.pageviewState=G,this.tcf=(0,c.SD)(window,this.logger)}identify(e){const t="[Identify]";this.logger.debug("<call> identify",e);const n=(0,l.b2)(),{left:o,right:c}=this.identities.parseCustomerDefinedIdentities(e);if(o.length>0)throw new Error(o.join(" "));const u={...this.identities.getIdentitiesMap(),...c.reduce(((e,t)=>{let{tag:n,id:r,priority:i,expiry:s}=t;return{...e,[n]:{id:r,...void 0!==i?{priority:i}:{},...void 0!==s?{expiry:s}:{}}}}),{})},g=(0,r.zG)(Object.values(u),s.DZ((e=>i.ij(e.id)))),p=this.identities.getPrioritizedIdentities(u);if("string"==typeof e&&(0,a.Bt)("f279b5ea-1200-4ff6-9d35-17893279723e","f279b5ea-1200-4ff6-9d35-17893279723e",g,window.location.hostname,this.userId.get()))return n.resolve(),n.promise;const h=async e=>{await(0,f.Yj)({clientContext:this.clientContext,global:this.global,identities:this.identities,logger:this.logger,reset:this.permutiveReset,userId:this.userId},e.user_id)};return this.taskQueue.add(new d((async e=>{this.logger.debug("<task> identify",c);const r=async()=>{this.logger.log(t,"request identity");const e=await this.api.identify(this.metrics,this.userId,p);this.userId.isEqual(e.user_id)?this.metrics.track({name:"sdk_identity_remained_total",value:1,labels:{identify_reason:"identify_call"}}):(this.metrics.track({name:"sdk_identity_changed_total",value:1,labels:{identify_reason:"identify_call"}}),await h(e))};this.identities.setIdentities(c).identifyRequestRequired()?await r():this.logger.log(t,"skip request"),this.logger.debug("<done> identify",c),e(),n.resolve(),await this.identitiesIngestor.ingestIfEligible(c).catch((e=>this.api.reportError(`Couldn't ingest identities, got ${e}`,this.userId.get())))}),{wait_prev:!0,block_next:!0})),n.promise}on(e,t){return this.nextGen.eventHandlerAfterUpload.addListener({name:e,callback:t,once:!1})}once(e,t){return this.nextGen.eventHandlerAfterUpload.addListener({name:e,callback:t,once:!0})}pageviewTracked=!1;track(){const[e,t,n]=[arguments.length<=0?void 0:arguments[0],(arguments.length<=1?void 0:arguments[1])||{},(arguments.length<=2?void 0:arguments[2])||{}],r=this.trace.startSpan(`track("${e}")`);this.logger.log("<call> track",e);const i=(0,l.b2)();this.pageviewTracked||"Pageview"!==e||(this.pageviewTracked=!0,this.metrics.trackTimeSinceInit("sdk_lifecycle_timestamps",{timestamp_name:"pageview_tracked",time_origin:"sdk_init"})),this.metrics.trackCounter({name:"sdk_event_track_count_total",labels:{event_name:e},value:1}),i.promise.then((()=>{this.metrics.trackCounter({name:"sdk_event_track_success_count_total",labels:{event_name:e},value:1}),r.finish()}),(()=>{this.metrics.trackCounter({name:"sdk_event_track_fail_count_total",labels:{event_name:e},value:1}),r.finish()}));const s=n.unprocessedData??{},o=s.sessionId??this.sessionManager.getSessionId(),a=s.viewId??this.viewId.get(),c={success:n.success||(e=>{}),error:n.error||((e,t)=>{})};return this.taskQueue.add(new d((r=>{this.logger.log("<task> track",e);return(s.client?Promise.resolve(s.client):this.clientContext.getClient()).then((s=>{const u={name:e,properties:{...t,client:t.client?(0,l.PM)(s,t.client):s},session_id:o,view_id:a,time:new Date};return this.nextGen.trackEvent.current({event:u,useBeacon:n.useBeacon??!1}).then((e=>{this.logger.log("<done> track",u.name),c.success(e),i.resolve(u),r()})).catch((e=>{c.error(e),this.api.reportError(e,this.userId.get()),i.reject(e)}))}))}))),i.promise}trigger(e,t,n){const r=(0,l.b2)();this.logger.log("<call> trigger",e);const i=t=>(i,s)=>{if(i.properties.segment_number===e){const o={result:t};this.logger.debug("<fire> trigger",{event:i,error:s,segmentCode:e,payload:o}),n(o),r.resolve(o)}};return this.nextGen.eventHandlerAfterUpload.addListener({name:"SegmentEntry",callback:i(!0),once:!1}),this.nextGen.eventHandlerAfterUpload.addListener({name:"SegmentExit",callback:i(!1),once:!1}),this.logger.log("<done> trigger",e),r.promise}query(){return Promise.resolve({result:!1})}segment(e,t){const n=(0,l.b2)();this.logger.log("<call> segment",e);return this.taskQueue.add(new d((r=>{this.logger.log("<task> segment",e);const i=this.nextGen.queryLanguageCohorts.all.current.includes(e)||!1;t(i),n.resolve(),this.logger.log("<done> segment",e),r()}))),n.promise}segments(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";const n=(0,l.b2)();this.logger.log("<call> segments");return this.taskQueue.add(new d((r=>{this.logger.log("<task> segments ("+t+")");const i=i=>{e(i),n.resolve(i),this.logger.log("<done> segments ("+t+")"),r()};"dfp"===t?this.messages.once("permutive:dfp:ready",(()=>{this.addons.dfp&&i([...this.addons.dfp.segments.liveSegments])})):i([...this.nextGen.queryLanguageCohorts.all.current])}))),n.promise}reset(){return Promise.all([this.api.reset(this.metrics),this.identities.reset(),this.permutiveReset.reset(),this.nextGen.reset(),this.userId.reset()]).then((()=>{this.messages.emit("permutive:reset")})).catch((e=>{this.api.reportError(`Error resetting internals. Got ${e}`)}))}addon(e,t){this.logger.debug("[Addon]",`Called for ${e}`,t);const s={...t,permutive:this,api:this.api,activationManager:this.activationManager,network:this.network,clientContext:this.clientContext,logger:this.logger,unprocessedEvents:this.unprocessedEvents,metrics:this.metrics,state:this.state,messages:this.messages,userId:this.userId,viewId:this.viewId,customProperties:this.customProperties,config:this.config,permutiveData:this.permutiveData,sessionManager:this.sessionManager,addons:this.addons,externalData:this.externalData,cookies:this.cookies,nextGenOutput:this.nextGen,identities:this.identities,pageviewState:this.pageviewState,tcf:this.tcf},a=(0,r.zG)(this.nextGen.pbjsPair,o.UI(i.UI((0,l.vg)("pbjs")))),c=e=>{this.initialisedAddons.push(e),this.messages.emit("permutive:addon:preinit",e)};if(-1===this.initialisedAddons.indexOf(e))switch(c(e),e){case"web":Promise.resolve().then(n.bind(n,7866)).then((e=>this.addons.web=new e.WebAddon(s))).then((()=>this.messages.emit("permutive:web:ready")));break;case"publishers":case"overlays":case"scriptrunner":case"nativo":case"freewheel":case"facebook_pixel_v2":case"tiktok_pixel":case"eyeota_pixel":case"rubicon":case"rubicon_ssp":case"tracking_pixel":case"twitter_pixel":case"pinterest_pixel":case"local_storage":case"appnexus_adserver":case"prebid":case"classification_models":case"gam_log":case"smart":case"tradedesk":case"ddp":case"dbm":case"appnexus":case"pubmatic":0;break;case"dfp":Promise.resolve().then(n.bind(n,2725)).then((async e=>this.addons.dfp=await e.createAddon(s)));break;case"clean_room":Promise.resolve().then(n.bind(n,1819)).then((e=>this.addons.clean_room=new e.CleanRoomAddon({...s,pbjs:a,prebidIdentifiers:this.nextGen.prebidIdentifiers})));break;case"ssp":Promise.resolve().then(n.bind(n,3775)).then((e=>this.addons.ssp=new e.SspAddon(s)))}else"web"===e&&!0!==t.auto_init&&((e,t,n,r)=>new Promise(((s,o)=>{const a=(0,i.Y3)(e);if((0,i.pC)(a))return s(a.value);n.once(t,(()=>(0,i.g_)((()=>o(new Error(`Error after waiting for event ${t}`))),s)((0,i.Y3)(e))));const c=(null==r?void 0:r.timeout)??1e4;(0,u.HJ)((()=>o(new Error(`Event ${t} was not received within the timeout period ${c}ms`))),c)})))((()=>{if(!this.addons.web)throw new Error('"web" addon not ready');return this.addons.web.reset(t)}),"permutive:web:ready",this.messages).catch((e=>{this.api.reportError(`Got error while trying to reset web. Got ${e.message}`,this.state.userId.get())}))}ready(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"initialised";const n=(0,l.b2)(),r=()=>{e(),n.resolve()};switch(t){case"initialised":this.permutiveRealtime.isReady()?r():this.messages.on("permutive:ready",r);break;case"realtime":this.permutiveRealtime.isRealtime()?r():this.messages.once("permutive:realtime",r)}return n.promise}}var p=n(4429);const h=e=>{const{logger:t,consentTracking:n}=e,i=function(){return t.debug("Methods[track]: Cannot track as consent is revoked"),Promise.resolve(null)};return e=>class extends e{constructor(){super(...arguments),n.isRevoked()&&this.consentRevoked(),n.listenForConsent((()=>this.consentRevoked()),r.Q1)}async consentRevoked(){return await this.sessionManager.reset(),this.reset()}track=(0,p.v)(super.track.bind(this),i,n.isRevoked)}},m=(e,t,n,i,s,o,a,c,u,l,d,f,p,m,v,_,b,w,y,k,I,S,E,P,G,U,z,D)=>new((0,r.zG)(g,h({consentTracking:U,logger:e})))(e,t,n,i,s,o,a,c,u,l,d,f,p,m,v,_,b,w,y,k,I,S,E,P,G,z,D)},1202:(e,t,n)=>{n.d(t,{Yj:()=>c,TZ:()=>a});var r=n(2865),i=n(7387);var s=n(5842);const o=async e=>{await e.identities.thirdParty,await function(e,t){return(0,s.Bt)("f279b5ea-1200-4ff6-9d35-17893279723e","f279b5ea-1200-4ff6-9d35-17893279723e",e.identities.getPrioritizedIdentities(e.identities.getIdentitiesMap()).map((e=>e.id)),window.location.hostname,e.userId.get())?t.reset():Promise.resolve()}(e,e.permutiveMethods);const t=await function(e){const t=e.trace.startSpan("identify");0;return(async e=>{const t="[Identify Init]",{logger:n,api:r,userId:s,identities:o,metrics:a,identitiesIngestor:c,messages:u,sessionManager:l}=e,d=await o.thirdParty,f=o.extractIdentifyFromQueue(e),g={...o.getIdentitiesMap(),...f.reduce(((e,t)=>{let{tag:n,id:r,priority:i,expiry:s}=t;return{...e,[n]:{id:r,...s?{expiry:s}:{},...void 0!==i?{priority:i}:{}}}}),{})},p=o.setIdentities(Object.entries(g).map((e=>{let[t,{id:n,priority:r,expiry:i}]=e;return{tag:t,id:n,...i?{expiry:i}:{},...void 0!==r?{priority:r}:{}}})));o.setReady();const h=o.getPrioritizedIdentities(g);n.log("Begin identification");const m=e.sessionCount>1&&l.sessionHasChanged()||d.identifyRequestRequired()||p.identifyRequestRequired()?await(n.debug(t,"request identity"),r.identify(a,s,h).then((e=>{const r=e.user_id;return s.isEqual(r)?{identityChanged:!1}:(n.debug(t,"fetch received new user id",r),{identityChanged:!0,userId:r})})).catch((e=>(r.reportError(`${t} Fetch failed. Got ${e}`,s.get()),{identityChanged:!1}))).then((0,i.bw)((t=>e.metrics.track({name:`sdk_identity_${t.identityChanged?"changed":"remained"}_total`,value:1,labels:{identify_reason:"sdk_init"}}))))):(n.debug(t,"skip request"),{identityChanged:!1});return c.ingestIfEligible(h).catch((e=>r.reportError(`Couldn't ingest identities, got ${e}`,m.identityChanged?m.userId:s.get()))),u.emit("permutive:user:ready"),n.debug(t,"result",m),m})(e).catch((t=>(e.api.reportError(`Failed to identify. Got ${(0,r.w)(t)}`),{identityChanged:!1}))).then((e=>(t.finish(),e)))}(e);return t.identityChanged?await c(e,t.userId):e.logger.log("Identity has not changed"),t},a=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>{};o(e).then(t),u(e.global,e.clientContext)};async function c(e,t){e.logger.log("Identity has changed"),await e.reset.reset(),e.userId.set(t),u(e.global,e.clientContext),e.identities.setIdentities([])}function u(e,t){return e.context=t.getContext()}},9774:(e,t,n)=>{function r(e,t,n,r){r.debug("set SDK as ready"),e.emit("permutive:api:ready"),e.emit("permutive:queries:initialised"),t.track({name:"sdk_local_storage_byte_total",value:n.getStateSizeInBytes(),labels:{}}),r.warn("sdk_query_states_byte_total metric needs re-implementing")}n.d(t,{R:()=>r})},8629:(e,t,n)=>{n.d(t,{LA:()=>a});var r=n(366),i=n(5586),s=n(7387);const o=(e,t,n)=>{let{api:r,state:i}=n;r.reportError(`Function "permutive.${t.functionName}" caused an error: ${e.message}`,i.userId.get())};function a(e,t,n,r,i,s){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:d;const u=c(e),l=s.startSpan("queued_methods"),f={api:i,state:t},g=e=>{if(e.functionName in n){n[e.functionName].apply(r,e.arguments)}else o(new Error("Does not exist."),e,f)},p=e=>!a.includes(e);u.forEach((e=>{try{p(e.functionName)&&g(e)}catch(t){const n=t instanceof Error?t:new Error("Unknown error.");o(n,e,f)}})),l.finish()}function c(e){const t=(0,r.uK)((e=>-1!==l.indexOf(e.functionName)))(e),n=t.right,o=t.left.filter((e=>"consent"!==e.functionName)),a=(0,i.Zt)(((e,t)=>u(e)&&u(t)?(0,s.lW)(f).compare(e.arguments[0],t.arguments[0]):(0,s.lW)(l).compare(e.functionName,t.functionName)));return(0,r.DY)(a)(n).concat(o)}const u=e=>"addon"===e.functionName,l=["identify","trigger","addon","track"],d=["identify"],f=["dfp","appnexus_adserver","web"]},9215:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{initialiseWebSDK:()=>initialiseWebSDK});var _permutive_permutive_utils_ts_error__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(2865),fp_ts_Option__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(9727),fp_ts_Either__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(1385),fp_ts_function__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(2275),fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(9246),_framework_ref__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5460),_identity_legacy_NeustarFabrickIdentitiesIngestor__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(7222),_identity_legacy_PermutiveIdentities__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(5842),_identity_legacy_PermutiveIdentitiesIngestorNoOp__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(8167),_sdkql_blockers__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(8672),_core_activations_PermutiveActivationManagerWeb__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(7041),_core_activations_PermutiveAddons__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(3636),_core_context_PermutiveClientContextWeb__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(6688),_sdkql_event_collection_events_cache_store_crypto_HashcodeDigest__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(8),_sdkql_event_collection_events_cache_store_crypto_SHA256Digest__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(1948),_sdkql_event_collection_PermutiveEventCustomProps__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(1555),_core_events_unprocessed_UnprocessedPrebidAuctions__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(4253),_core_metrics_MetricReporter__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(6769),_core_state_PermutiveRealtime__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(6176),_core_state_PermutiveReset__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(3195),_core_state_PermutiveStateWeb__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(1772),_core_state_PermutiveViewId__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(1347),_core_store_LocalStorage__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(9134),_core_tcf_TCF__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(3247),_dynamic_addons_LoadAddons__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(6563),_dynamic_messages_PermutiveMessages__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(2102),_http_PermutiveApi__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(8645),_utils_PermutiveUtils__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(7387),_utils_task_queue_PermutiveTaskQueue__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(5365),_utils_urls_UrlHelpers__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(4513),_Config__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(6851),_initialisation_identity__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(1202),_initialisation_initialisationLifecycle__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__(9774),_initialisation_queuedMethods__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(8629),_PermutiveMethodsWeb__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(268),_framework_compute_time_measurement__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(3812),fp_ts_Task__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(8940),main_core_store_SessionStorage__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(8480),main_http_PermutiveNetwork__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(1671);const prefix="[Initialisation Web]",initialiseWebSDK=_ref=>{let{cookieStore,consentModule,core,externalData,localStorage,logger,messages,metrics,namespace,pageviewState,partialTagWithKey,permutiveData,sessionManager,tag,trace,configFromQueryParams,urls,userId}=_ref;return(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_21__.Y3)((async()=>{const windowKey=partialTagWithKey.key,permutiveGlobal=window[windowKey],config=tag.config,viewId=(0,fp_ts_function__WEBPACK_IMPORTED_MODULE_22__.zG)(pageviewState.ref,_framework_ref__WEBPACK_IMPORTED_MODULE_0__.UI((e=>e.viewId)),(e=>new _core_state_PermutiveViewId__WEBPACK_IMPORTED_MODULE_23__.W(e))),network=new main_http_PermutiveNetwork__WEBPACK_IMPORTED_MODULE_20__.E(metrics),sessionStorage=(0,main_core_store_SessionStorage__WEBPACK_IMPORTED_MODULE_19__.u)(namespace,logger,consentModule.consentTracking.consentRef),{consentTracking,consentValidation}=consentModule;(0,fp_ts_function__WEBPACK_IMPORTED_MODULE_22__.zG)(consentTracking.consentRef,_framework_ref__WEBPACK_IMPORTED_MODULE_0__.YP((e=>{e?sessionStorage.put(configFromQueryParams,_Config__WEBPACK_IMPORTED_MODULE_14__.iq).then(fp_ts_function__WEBPACK_IMPORTED_MODULE_22__.Q1,(e=>{logger.warn(prefix,`Failed to cache "${_Config__WEBPACK_IMPORTED_MODULE_14__.iq}".`,(0,_permutive_permutive_utils_ts_error__WEBPACK_IMPORTED_MODULE_24__.w)(e))})):sessionStorage.delete(_Config__WEBPACK_IMPORTED_MODULE_14__.iq)}))),window[windowKey].consent=consentValidation;const context=(0,_utils_PermutiveUtils__WEBPACK_IMPORTED_MODULE_12__.PM)(tag.context||{},{path:window.location.pathname,url:(0,_utils_urls_UrlHelpers__WEBPACK_IMPORTED_MODULE_25__.bk)(window.location.href),referrer:(0,_utils_urls_UrlHelpers__WEBPACK_IMPORTED_MODULE_25__.bk)(document.referrer),view_id:viewId.get()}),createInternalsSpan=trace.startSpan("internals"),clientContext=new _core_context_PermutiveClientContextWeb__WEBPACK_IMPORTED_MODULE_26__.z(context);(0,fp_ts_function__WEBPACK_IMPORTED_MODULE_22__.zG)(viewId.ref,_framework_ref__WEBPACK_IMPORTED_MODULE_0__.YP((e=>clientContext.updateContext(["view_id",e])))),(0,fp_ts_function__WEBPACK_IMPORTED_MODULE_22__.zG)(userId.ref,_framework_ref__WEBPACK_IMPORTED_MODULE_0__.YP((e=>clientContext.updateContext(["user_id",e]))));const api=new _http_PermutiveApi__WEBPACK_IMPORTED_MODULE_11__.F(urls,config,network,metrics,logger),identityProviderEnv={permutive:permutiveGlobal,network,api,userId,metrics,permutiveData,messages,config,cookies:cookieStore,logger},identities=new _identity_legacy_PermutiveIdentities__WEBPACK_IMPORTED_MODULE_2__.lg(metrics,trace,permutiveData,identityProviderEnv,logger),identitiesIngestor=new _identity_legacy_PermutiveIdentitiesIngestorNoOp__WEBPACK_IMPORTED_MODULE_27__.z,permutiveRealtime=new _core_state_PermutiveRealtime__WEBPACK_IMPORTED_MODULE_28__.u(trace,metrics,messages),unprocessedArgs={consent:consentTracking.consentRef,logger,namespace},unprocessedEvents={PrebidAuctions:new _core_events_unprocessed_UnprocessedPrebidAuctions__WEBPACK_IMPORTED_MODULE_29__.J(unprocessedArgs)},customProperties=new _sdkql_event_collection_PermutiveEventCustomProps__WEBPACK_IMPORTED_MODULE_7__.X,permutiveReset=new _core_state_PermutiveReset__WEBPACK_IMPORTED_MODULE_30__.a(config,localStorage,logger,permutiveData,cookieStore,externalData),taskQueue=new _utils_task_queue_PermutiveTaskQueue__WEBPACK_IMPORTED_MODULE_13__.i(messages),activationManager=new _core_activations_PermutiveActivationManagerWeb__WEBPACK_IMPORTED_MODULE_3__.v(logger,permutiveGlobal,clientContext),[addonsLoadedRef,setAddonsLoaded]=_framework_ref__WEBPACK_IMPORTED_MODULE_0__.Ue(!1),webClient=(()=>{const[e,t]=_framework_ref__WEBPACK_IMPORTED_MODULE_0__.Ue(Date.now());return(0,_framework_compute_time_measurement__WEBPACK_IMPORTED_MODULE_18__.UM)((()=>t(Date.now())),1e3),(0,fp_ts_function__WEBPACK_IMPORTED_MODULE_22__.zG)(_framework_ref__WEBPACK_IMPORTED_MODULE_0__.vP(viewId.ref,e),_framework_ref__WEBPACK_IMPORTED_MODULE_0__.UI((()=>(0,_core_context_PermutiveClientContextWeb__WEBPACK_IMPORTED_MODULE_26__.k)())),_framework_ref__WEBPACK_IMPORTED_MODULE_0__.D8(((e,t)=>e===t||JSON.stringify(e)===JSON.stringify(t))))})(),eventCacheStoreFactory=()=>(0,fp_ts_function__WEBPACK_IMPORTED_MODULE_22__.zG)((0,_framework_compute_time_measurement__WEBPACK_IMPORTED_MODULE_18__.N1)((0,fp_ts_function__WEBPACK_IMPORTED_MODULE_22__.zG)((0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_21__.Y3)((()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,8949))),String),trace.traceTask("import-DBStore-main-thread"))),(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_21__.UI)((e=>{let{DBStore:t}=e;return new t((0,_core_store_LocalStorage__WEBPACK_IMPORTED_MODULE_31__.E)(namespace,logger,consentTracking.consentRef))}))),eventsCacheFactory=()=>(0,fp_ts_function__WEBPACK_IMPORTED_MODULE_22__.zG)((0,_framework_compute_time_measurement__WEBPACK_IMPORTED_MODULE_18__.SF)((0,fp_ts_function__WEBPACK_IMPORTED_MODULE_22__.zG)((0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_21__.Y3)((()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,3194))),String),trace.traceTask("import-events-cache"))),(0,fp_ts_TaskEither__WEBPACK_IMPORTED_MODULE_21__.tS)((e=>{let{EventsCache:t}=e;return(0,fp_ts_function__WEBPACK_IMPORTED_MODULE_22__.zG)(t.initialise(config,logger,(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};api.reportError(e,null==t?void 0:t.userId,null==t?void 0:t.timestamp)}),trace,metrics,userId.ref,eventCacheStoreFactory),trace.traceTask("initialise-events-cache-main-thread"))}))),nextGen=await(0,fp_ts_function__WEBPACK_IMPORTED_MODULE_22__.zG)((0,_framework_compute_time_measurement__WEBPACK_IMPORTED_MODULE_18__.SF)((()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,4669)))),trace.traceTask("import-next-gen"),fp_ts_Task__WEBPACK_IMPORTED_MODULE_32__.Qt("configureCore",core),fp_ts_Task__WEBPACK_IMPORTED_MODULE_32__.UI((e=>{let{runNextGenFeatures:t,configureCore:n}=e;return t({activationManager,addonsLoaded:addonsLoadedRef,api,clientContext,config,consentTracking:fp_ts_Option__WEBPACK_IMPORTED_MODULE_33__.G(consentTracking),core:n({eventsCacheFactory,migratedStateMaps:()=>({internal:(0,fp_ts_function__WEBPACK_IMPORTED_MODULE_22__.zG)(permutiveData.getData("internal_query_states"),fp_ts_Option__WEBPACK_IMPORTED_MODULE_33__.DT(_utils_PermutiveUtils__WEBPACK_IMPORTED_MODULE_12__.Kn)),external:(0,fp_ts_function__WEBPACK_IMPORTED_MODULE_22__.zG)(permutiveData.getData("external_query_states"),fp_ts_Option__WEBPACK_IMPORTED_MODULE_33__.DT(_utils_PermutiveUtils__WEBPACK_IMPORTED_MODULE_12__.Kn))})}),externalData,identities:identities.ref,logger,messages,metrics,namespace,network,permutiveData,sessionManager,urls,userId,viewId,pageviewState:pageviewState.ref,trace,webClient:(0,fp_ts_function__WEBPACK_IMPORTED_MODULE_22__.zG)(webClient,_framework_ref__WEBPACK_IMPORTED_MODULE_0__.UI(fp_ts_Option__WEBPACK_IMPORTED_MODULE_33__.of))})})))();(0,_core_metrics_MetricReporter__WEBPACK_IMPORTED_MODULE_8__.p)({api,context:nextGen.metricContext,logger,messages,metrics});const state=new _core_state_PermutiveStateWeb__WEBPACK_IMPORTED_MODULE_34__.u(permutiveData,permutiveReset,userId,viewId,logger),addons={},permutiveMethods=(0,_PermutiveMethodsWeb__WEBPACK_IMPORTED_MODULE_17__.S)(logger,api,activationManager,sessionManager,metrics,viewId,userId,network,clientContext,unprocessedEvents,taskQueue,identities,permutiveReset,messages,addons,trace,permutiveRealtime,state,customProperties,config,permutiveData,externalData,cookieStore,identitiesIngestor,permutiveGlobal,consentTracking,nextGen,pageviewState);createInternalsSpan.finish(),[].forEach((s=>{fp_ts_Either__WEBPACK_IMPORTED_MODULE_35__.Y3((()=>eval(s)),(e=>{api.reportError({...e,message:`Error running custom script ${s}`},userId.get())}))}));const blockers=(0,_sdkql_blockers__WEBPACK_IMPORTED_MODULE_36__.X)({logger,messages});blockers.addBlocker("permutive:queries:initialised");const initialIdentifyResult=(0,_utils_PermutiveUtils__WEBPACK_IMPORTED_MODULE_12__.b2)();let globalIdentifyBound=!1;messages.on("permutive:user:ready",(()=>{permutiveGlobal.identify=permutiveMethods.identify.bind(permutiveMethods),globalIdentifyBound=!0;const e=identities.extractIdentifyFromQueue({global:permutiveGlobal});e.length>0?initialIdentifyResult.resolve(permutiveGlobal.identify(e)):initialIdentifyResult.resolve()})),messages.on("permutive:blockers:empty",(()=>{if(!globalIdentifyBound){const e=permutiveGlobal.identify;permutiveGlobal.identify=t=>(e(t),initialIdentifyResult.promise)}permutiveGlobal.on=permutiveMethods.on.bind(permutiveMethods),permutiveGlobal.once=permutiveMethods.once.bind(permutiveMethods),permutiveGlobal.track=permutiveMethods.track.bind(permutiveMethods),permutiveGlobal.trigger=permutiveMethods.trigger.bind(permutiveMethods),permutiveGlobal.query=permutiveMethods.query.bind(permutiveMethods),permutiveGlobal.segment=permutiveMethods.segment.bind(permutiveMethods),permutiveGlobal.segments=permutiveMethods.segments.bind(permutiveMethods),permutiveGlobal.reset=permutiveMethods.reset.bind(permutiveMethods),permutiveGlobal.ready=permutiveMethods.ready.bind(permutiveMethods),permutiveGlobal.addon=permutiveMethods.addon.bind(permutiveMethods),permutiveGlobal.context=clientContext.getContext(),permutiveGlobal.addons=addons,permutiveGlobal.config=config,permutiveRealtime.setAsReady(),(0,_initialisation_queuedMethods__WEBPACK_IMPORTED_MODULE_16__.LA)(permutiveGlobal.q,state,permutiveGlobal,permutiveMethods,api,trace),setAddonsLoaded(!0)}));const loadAddonsSpan=trace.startSpan("load_addons");(0,_dynamic_addons_LoadAddons__WEBPACK_IMPORTED_MODULE_10__.C)({extMessages:new _dynamic_messages_PermutiveMessages__WEBPACK_IMPORTED_MODULE_37__.a(messages),nextGen,messages,viewId,state,sessionManager,api,clientContext,externalData,logger,metrics,namespace,network,permutive:permutiveGlobal,q:permutiveGlobal.q,userId}),loadAddonsSpan.finish(),await(0,_initialisation_identity__WEBPACK_IMPORTED_MODULE_15__.TZ)({api,clientContext,externalData,global:permutiveGlobal,identities,identitiesIngestor,logger,messages,metrics,network,permutiveMethods,reset:permutiveReset,trace,userId,sessionManager,sessionCount:nextGen.metricContext.current.session_count}),(0,_initialisation_initialisationLifecycle__WEBPACK_IMPORTED_MODULE_38__.R)(messages,metrics,state,logger),(0,fp_ts_function__WEBPACK_IMPORTED_MODULE_22__.zG)(_framework_ref__WEBPACK_IMPORTED_MODULE_0__.vP(nextGen.realtime,nextGen.queryLanguageCohorts.all),_framework_ref__WEBPACK_IMPORTED_MODULE_0__.D8(((e,t)=>e[0]===t[0])),_framework_ref__WEBPACK_IMPORTED_MODULE_0__.bw((e=>{let[t,n]=e;t&&permutiveRealtime.setAsRealtime(n.length)})))}),(e=>`Exception during initialisation. Got ${e}`))}},4749:(e,t,n)=>{n.r(t),n.d(t,{runSdk:()=>te});var r=n(1385),i=n(2275);var s=n(9246),o=n(8940),a=n(9727);var c=n(5472);class u{namespace;config;logger;constructor(e,t,n){this.namespace=e,this.config=t,this.logger=n}makeCookie(e,t,n){return[encodeURIComponent(this.namespace.getNamespacedStorageKey(e)),"=",t?encodeURIComponent(t):"","; expires=",n,"; domain=",this.config.cookieDomain,"; path=/; samesite=none; secure"].join("")}setCookie(e,t){if(!(t&&e&&this.config.cookieExpiry&&this.config.cookieDomain)){const{cookieExpiry:n,cookieDomain:r}=this.config??{};throw this.logger.warn(`Unable to set cookie. ${c.LP}`,{value:t,cookieName:e,cookieExpiry:n,cookieDomain:r}),new Error(c.LP)}const n=this.makeCookie(e,t,this.config.cookieExpiry);if(n.length>c.dG)throw this.logger.warn(`Unable to set cookie ${this.namespace.getNamespacedStorageKey(e)}. ${c.eP}`),new Error(c.eP);return this.logger.debug(`Setting cookie ${n}`),document.cookie=n,!0}getCookie(e){const t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e:this.namespace.getNamespacedStorageKey(e),n=new RegExp("\\b"+encodeURIComponent(t)+"=([^;]+)").exec(document.cookie);return null!==n?decodeURIComponent(n[1]):null}deleteCookie(e){if(!e||!this.config.cookieDomain)return!1;const t=this.makeCookie(e,void 0,"Thu, 01 Jan 1970 00:00:00 UTC");return this.logger.debug(`Deleting cookie ${t}`),document.cookie=t,!0}}var l=n(4429);const d=e=>{const{logger:t,consentTracking:n}=e,r=e=>(t.debug(`Cookie: Failed to set cookie ${e} as consent is revoked`),!1);return e=>class extends e{setCookie=(0,l.v)(super.setCookie.bind(this),r,n.isRevoked)}};var f=n(2865),g=n(3939);class p{namespace;constructor(e){this.namespace=e}getExternalData(e){const t=this.namespace.getNamespacedStorageKey(e);return window.localStorage.getItem(t)}getExternalJsonData(e){const t=this.getExternalData(e);return null===t?null:(0,g.A)(t)}setExternalData(e,t){const n=this.namespace.getNamespacedStorageKey(e);try{window.localStorage.setItem(n,t)}catch(e){}}setExternalJsonData(e,t){return(0,i.zG)((n=t,(0,r.Y3)((function(){var e=JSON.stringify(n);if("string"!=typeof e)throw new Error("Converting unsupported structure to JSON");return e}),i.yR)),(0,r.UI)((t=>this.setExternalData(e,t))),(0,r.g_)((e=>{throw(0,f.w)(e)}),i.Q1));var n}removeExternalData(e){const t=this.namespace.getNamespacedStorageKey(e);window.localStorage.removeItem(t)}}const h=e=>{const{logger:t,consentTracking:n}=e,r=e=>{t.debug(`External Data: Failed to set key ${e} as consent is revoked`)},i=r,s=r;return e=>class extends e{setExternalData=(0,l.v)(super.setExternalData.bind(this),i,n.isRevoked);setExternalJsonData=(0,l.v)(super.setExternalJsonData.bind(this),s,n.isRevoked)}};var m=n(3812);class v{sdkInitTimestamp;prefix="[Permutive]"+(self.document?"[Main]":"[Worker]");debugStyle=["color: blue"].join(";");constructor(e){this.sdkInitTimestamp=e}get timeDeltaFromInit(){return`[${(new Date).getTime()-this.sdkInitTimestamp}ms]`}log(){return console.log.bind(self.console,this.timeDeltaFromInit,this.prefix)(...arguments)}debug(){return console.debug.bind(self.console,"%s%c%s",this.timeDeltaFromInit,this.debugStyle,this.prefix)(...arguments)}warn(){return console.warn.bind(self.console,this.timeDeltaFromInit,this.prefix)(...arguments)}error(){return console.error.bind(self.console,this.timeDeltaFromInit,this.prefix)(...arguments)}}class _{log(){}debug(){}warn(){}error(){}}const b="[MESSAGES]";class w{logger;messageListenerMap={};replayQueue={};onceTracker={};defaultMessageOptions={withReplay:!1,once:!1};constructor(e){this.logger=e}on(e,t,n){const r=this.mergeMessageOptions(n);r.withReplay&&this.processReplayQueue(e,t);const i=y(e,this.messageListenerMap).push(t)-1;return r.once&&this.addToOnceTracker(e,i),i}once(e,t){return this.on(e,t,{once:!0})}off(e,t){if(null==t)return this.messageListenerMap[e]=[],void(this.replayQueue[e]=[]);t<0?this.logError('Index for "off" fell out of range',{index:t}):y(e,this.messageListenerMap)[t]=i.Q1}emit(e,t,n){const r=this.mergeMessageOptions(n);y(e,this.messageListenerMap).length>0?(this.logDebug(`Emitting Event: ${e}`),this.emitMessageWithPayload(e,t)):r.withReplay&&this.addToReplayQueue(e,t)}addToReplayQueue(e,t){y(e,this.replayQueue).push(t)}processReplayQueue(e,t){var n;null===(n=this.replayQueue[e])||void 0===n||n.forEach((e=>t(e)))}emitMessageWithPayload(e,t){var n;null===(n=this.messageListenerMap[e])||void 0===n||n.forEach(((n,r)=>{n(t),this.removeListenerIfSetToFireOnlyOnce(e,r)}))}addToOnceTracker(e,t){y(e,this.onceTracker).push(t)}removeListenerIfSetToFireOnlyOnce(e,t){var n;null!==(n=this.onceTracker[e])&&void 0!==n&&n.includes(t)&&this.off(e,t)}mergeMessageOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...this.defaultMessageOptions,...e}}logError(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.error(b,...t)}logDebug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.debug(b,...t)}}const y=(e,t)=>t[e]??=[];var k=n(2925);class I{sdkInitTimestamp;timeOriginSdkInit;logger;prefix="[Metrics]";timeOriginForContext=P();pendingMetrics=[];pendingCounters={};pendingTimers={};noMetricsTracked=0;constructor(e,t,n){this.sdkInitTimestamp=e,this.timeOriginSdkInit=t,this.logger=n}isEnabled(){return!0}getNoMetricsTracked(){return this.noMetricsTracked}consume(){const e=this.pendingMetrics.concat(Object.values(this.pendingCounters).flat());return this.pendingMetrics=[],this.pendingCounters={},e}track(e){this.noMetricsTracked++,this.logDebug(`Tracking ${e.name}`,{metric:e}),this.pendingMetrics.push(e)}trackCounter(e){if(this.noMetricsTracked++,this.logDebug(`Tracking ${e.name}`,{metric:e}),e.name in this.pendingCounters){const t=Object.keys(e.labels),n=this.pendingCounters[e.name].findIndex((n=>Object.keys(n.labels).length===t.length&&t.every((t=>n.labels[t]===e.labels[t]))));-1===n?this.pendingCounters[e.name].push(e):this.pendingCounters[e.name][n]=E(this.pendingCounters[e.name][n],e.value)}else this.pendingCounters[e.name]=[e]}synchroniseTimeBetweenContexts(e){return(0,i.zG)(k.gz(a.G5)(this.timeOriginForContext,this.timeOriginSdkInit),a.UI((t=>{let[n,r]=t;return e+n-r})))}trackTimeSinceInit(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:performance.now();(0,i.zG)(this.synchroniseTimeBetweenContexts(n),a.UI((e=>(e-this.sdkInitTimestamp)/1e3)),a.UI((n=>this.track({name:e,value:n,labels:t}))))}startTimer(e,t){const n=performance.now(),r=this.generateRandomKey(e);return this.pendingTimers[r]={startTime:n,labels:t},r}stopTimer(e,t){const n=this.pendingTimers[t];if(n){const r=(performance.now()-n.startTime)/1e3;this.logDebug("timer stopped",e,r),this.track({name:e,value:r,labels:n.labels}),delete this.pendingTimers[t]}}generateRandomKey(e){return`${e}-${[...Array(24)].map((()=>Math.random().toString(36)[2])).join("")}`}logDebug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.debug(this.prefix,...t)}}class S{isEnabled(){return!1}getNoMetricsTracked(){return 0}consume(){return[]}track(e){}trackCounter(e){}trackTimeSinceInit(e,t){}startTimer(e,t){return""}stopTimer(e,t){}}const E=(e,t)=>({...e,value:e.value+t}),P=()=>(0,i.zG)(a.Y3((()=>performance.timeOrigin)),a.hX((e=>"number"==typeof e&&!Number.isNaN(e))));var G=n(7387),U=n(731),z=n(1001);class D{config;namespace;logger;prefix="[Data Store]";permutiveData={};permutiveDataSize=0;localStorageScheduler;localStorageQueue=new Set;debouncedStorageKeys;debouncedFlush;constructor(e,t,n){this.config=e,this.namespace=t,this.logger=n,this.localStorageScheduler=new U.b(e.localStorageWriteDelay,e.localStorageWriteMaxDelay),this.debouncedFlush=this.localStorageScheduler.schedule(this.flushLocalStorageQueue.bind(this)),this.debouncedStorageKeys=new Set(e.localStorageDebouncedKeys),this.localStorageScheduler.scheduleForPageUnload(this.flushLocalStorageQueue.bind(this)),this.permutiveData=this.buildData()}reset(){this.permutiveData={}}getDataSize(){return this.permutiveDataSize}getData(e){return this.permutiveData[e]}setData(e,t){this.permutiveData[e]=t,this.requestWrite(e)}deleteKey(e){delete this.permutiveData[e],this.requestWrite(e)}requestWrite(e){this.debouncedStorageKeys.has(e)?(this.localStorageQueue.add(e),this.debouncedFlush()):this.writeData(e)}flushLocalStorageQueue(){for(let e of this.localStorageQueue)this.writeData(e);this.localStorageQueue.clear()}buildData(){return{...this.getDataChunk("misc"),...this.getDataChunk("queries")}}getDataChunk(e){const t=this.namespace.getNamespacedStorageKey(this.chunkKeyToStorageKey(e)),n=window.localStorage.getItem(t),r=null===n?null:(0,g.A)(n);return n&&r?(this.permutiveDataSize+=2*n.length,r):{}}chunkKeyToStorageKey(e){switch(e){case"queries":return this.config.permutiveDataQueriesKey;case"misc":return this.config.permutiveDataMiscKey;default:throw new Error(`Unhandled chunk key "${e}"`)}}writeData(e){this.logger.debug(`Data Store: Writing ${e} to localStorage`);const[t,n]=this.dataKeyToChunkInfo(e);return r.Y3((()=>window.localStorage.setItem(this.namespace.getNamespacedStorageKey(t),JSON.stringify(n))),(t=>{const n=(0,f.w)(t);return this.logError(`Failed to set ${e}. Got ${n}`),n}))}dataKeyToChunkInfo(e){const t=e=>(0,G.eu)(this.permutiveData,e);switch(e){case"internal_query_states":case"external_query_states":case"event-source-id":return[this.chunkKeyToStorageKey("queries"),t(q)];case z.Kd:case"identities":case"amp_ready":case"metricsEnabled":case"addon:tradedesk":case"addon:tracking_pixel":case"addon:eyeota_pixel":case"addon:pinterest_pixel":case"addon:facebook_pixel_v2":case"addon:tiktok_pixel":case"addon:appnexus":case"addon:ddp":case"addon:gigya":case"addon:neustar_fabrick":case"pubmatic":case"lotame":return[this.chunkKeyToStorageKey("misc"),t(C)];default:throw new Error(`Unhandled data key "${e}"`)}}logError(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.error(this.prefix,...t)}}const q=["internal_query_states","external_query_states","event-source-id"],C=[z.Kd,"identities","amp_ready","metricsEnabled","addon:tradedesk","addon:tracking_pixel","addon:eyeota_pixel","addon:pinterest_pixel","addon:facebook_pixel_v2","addon:tiktok_pixel","addon:appnexus","addon:ddp","addon:gigya","addon:neustar_fabrick","pubmatic","lotame"],O=e=>{const{logger:t,consentTracking:n}=e,i=e=>(t.debug(`Data Store: Failed to write ${e} as consent is revoked`),r.F2(void 0));return e=>class extends e{writeData=(0,l.v)(super.writeData.bind(this),i,n.isRevoked)}};class x{config;constructor(e){this.config=e}getNamespacedStorageKey(e){return`${this.config.stateNamespace}${e}`}}var R=n(5460);class A{config;cookies;externalData;ref;isNewlyGenerated;setState;constructor(e,t,n,r){this.config=e,this.cookies=t,this.externalData=n;const[s,o]=R.Ue(this.getOrGenerateUserId());this.ref=(0,i.zG)(s,R.UI((e=>e.userId))),this.isNewlyGenerated=(0,i.zG)(s,R.UI((e=>e.isNewlyGenerated))),this.setState=o,(0,i.zG)(R.vP(this.ref,r),R.YP((e=>{let[t,n]=e;n?(this.cookies.setCookie(this.config.cookieName,t),this.externalData.setExternalData(this.config.cookieName,t)):(this.cookies.deleteCookie(this.config.cookieName),this.externalData.removeExternalData(this.config.cookieName))})))}isEqual(e){return this.ref.current===e}get(){return this.ref.current}set(e){this.setState({userId:e,isNewlyGenerated:!1})}reset(){this.setState({userId:(0,G.k$)(),isNewlyGenerated:!0})}getOrGenerateUserId(){return(0,i.zG)(this.getUserIdFromCookie(),a.wp((()=>this.getUserIdFromLocalStorage())),a.UI((e=>({userId:e,isNewlyGenerated:!1}))),a.fS((()=>({userId:(0,G.k$)(),isNewlyGenerated:!0}))))}getUserIdFromCookie(){return this.getUserIdFromStorageIfValid("cookie")}getUserIdFromLocalStorage(){return this.getUserIdFromStorageIfValid("localStorage")}getUserIdFromStorageIfValid(e){const t=a.DT(G.Gz);return(0,i.zG)("cookie"===e?this.cookies.getCookie(this.config.cookieName):this.externalData.getExternalData(this.config.cookieName),a.ij,a.tS(t))}}class T{config;PATH_JOINER_Q="?";PATH_JOINER_A="&";constructor(e){this.config=e}getBaseUrl(){return`${this.config.apiProtocol}://${this.config.apiHost}`}getEndpointUrl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return this.getUrl("base",e,t,n)}getSdkErrorsUrl(e,t){return this.getUrl("sdk-errors",e,t,[])}getAdvertiserEndpointUrl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return this.getUrl("adv",e,t,n)}getClassificationModelsEndpointUrl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return this.getUrl("clm",e,t,n)}getAudienceMatchingEndpointUrl(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const i=`${e}/${n}/audiences`;return this.getUrl("audience-matching",i,t,r)}getCCSCohortMembershipEndpointUrl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return this.getUrl("ccs",e,t,n)}makeAuthenticatedUrl(e){return this.makeUrlWithQueryParams(e,[["k",this.config.apiKey]])}getUrlPrefix(e){switch(e){case"base":return"";case"adv":return"/adv";case"sdk-errors":return"/sdk-errors";case"clm":return"/clm";case"audience-matching":return"/audience-matching";case"ccs":return"/ccs"}}getUrl(e,t,n,r){const i=this.getUrlPrefix(e),s=(0,a.g_)((()=>""),(e=>`/${e}`))(n),o=`${this.getBaseUrl()}${i}${s}${t}`;return this.makeUrlWithQueryParams(o,r.concat([["k",this.config.apiKey]]))}makeUrlWithQueryParams(e,t){const n=t.map((e=>{let[t,n]=e;return`${t}=${n}`})).join(this.PATH_JOINER_A),r=e.includes(this.PATH_JOINER_Q)?this.PATH_JOINER_A:this.PATH_JOINER_Q;return`${e}${r}${n}`}}const M=`permutive.${self.document?"main":"worker"}.`;class j{config;shouldUsePerformanceMark=!1;constructor(e){var t;this.config=e,this.shouldUsePerformanceMark=((null===(t=self.performance)||void 0===t?void 0:t.mark)&&this.config.tracingEnabled)??!1}startSpan(e){const t=this.generateSpan(e);return t.start(),{spanId:t.spanId,finish:t.finish}}measureSinceInit(e){const t=this.generateSpan(`${e}_since_init`);return t.start({startTime:m.NC}),{spanId:t.spanId,finish:t.finish}}traceTask(e){return t=>async()=>{const n=this.startSpan(e),r=await t();return n.finish(),r}}measureBetween(e,t,n){const r=this.generateSpan(e);r.start({startTime:t}),r.finish({startTime:n})}generateSpan(e){if(!this.shouldUsePerformanceMark)return{spanId:null,start:()=>{},finish:()=>{}};const{spanName:t,startMarkerName:n,endMarkerName:r}=j.generateUniqueMarkerNames(e);return{spanId:n,start:e=>{var t;return null===(t=self.performance)||void 0===t?void 0:t.mark(n,e)},finish:e=>{var i,s,o;null===(i=self.performance)||void 0===i||i.mark(r,{startTime:(null==e?void 0:e.startTime)??performance.now()}),null===(s=self.performance)||void 0===s||null===(o=s.measure)||void 0===o||o.call(s,t,n,r)}}}static generateUniqueMarkerNames(e){const t=`${M}${e}`,n=`${t}${j.generateId()}`;return{spanName:t,startMarkerName:`${n}_start`,endMarkerName:`${n}_end`}}static generateId(){return"_"+Math.random().toString(36).substr(2,9)}}var L=n(6851),F=n(1228),$=n(366),B=n(9215),N=n(1954),Q=n(4564);const Y=e=>{const{partialTagWithKey:t}=e,n=t.key;var s;window[n].consent=(s=e,(0,i.ls)(s.consentModule.consentValidation,a.DT(Boolean),a.UI((0,B.initialiseWebSDK)(s)),i.Q1));const c=(0,a.EQ)((()=>{return t={consentDatabase:e.consentModule.consentDatabase,consentRequired:e.tag.config.consentRequired},(0,i.zG)((0,i.a9)(t.consentDatabase.get(N.L)),(0,o.UI)((e=>(0,Q.J)(t.consentRequired,e).isValid)));var t}),o.of);return(0,i.zG)((0,i.zG)((e=>{let{consentModule:t,tag:n}=e;const r=(0,$.Ew)((function(e){return"consent"===e.functionName}))(n.q);return(0,a.UI)((e=>t.consentValidation(e.arguments[0])))(r)})(e),c),(0,o.UI)((e=>e?(0,r.F2)(!0):(0,r.t$)("No consent to run on the page"))))},K=e=>(0,i.zG)((e=>"function"==typeof e.Map?(0,r.F2)(new e.Map([["a",1]])):(0,r.t$)("Maps not supported"))(e),r.tS((e=>1===e.size?(0,r.F2)(null):(0,r.t$)("Iterable Maps not supported")))),W=e=>(0,i.zG)((e=>"function"==typeof e.Set?(0,r.F2)(new e.Set([1,2])):(0,r.t$)("Sets not supported"))(e),r.tS((e=>2===e.size?(0,r.F2)(null):(0,r.t$)("Iterable Sets not supported")))),H=e=>(0,i.zG)((0,k.gz)(r.G5)(K(e),W(e),(e=>e.Worker&&e.Blob?(0,r.F2)(null):(0,r.t$)("WebWorkers not supported"))(e)),(e=>(0,r.UI)(i.Q1)(e)));const V=()=>{const e=(0,n(3092).Z)(),t=(e=>{const t=[],n=[],r=()=>{for(;t.length>0&&n.length>0;)n.shift()()},i=e=>new Promise((t=>{n.push((()=>t(e()))),(0,m.HJ)(r)}));return e.addEventListener("message",(0,m.GL)((e=>{null!==e.data&&(t.push(e.data),(0,m.HJ)(r))}))),{next:()=>i((()=>t.shift())),read:()=>i((()=>t.splice(0)))}})(e);return e.postMessage(null),r=>function(e){let{worker:t,trace:r,metrics:s,...c}=e;return t.send({...c,globals:self._____workerGlobals,initialTimestampSecs:(0,i.zG)(a.lo(!1),a.UI((()=>Math.floor(Date.now()/1e3)))),metricsEnabled:s.isEnabled(),timeOriginMainContext:P()}),(0,i.zG)((0,m.SF)((()=>Promise.resolve().then(n.bind(n,7592)))),r.traceTask("import-master-low-priority"),o.UI((e=>n=>e.startMaster({...n,metrics:s,trace:r,worker:t}))))}({...r,worker:{...t,send:t=>e.postMessage(t),stop:()=>e.terminate()}})};var J=n(9134);class Z{db;options;constructor(e,t){this.db=e,this.options=t}getSessionId(){return this.options.session_id}sessionHasChanged(){return this.options.hasChanged}static decodeSessionData(e){return e&&"object"==typeof e&&e.hasOwnProperty("session_id")&&e.hasOwnProperty("last_updated")?{...e,last_updated:new Date(e.last_updated)}:null}reset(){return this.db.delete(this.options.session_data_key)}async persistSessionData(e){const t=e.last_updated.toISOString();await this.db.put({...e,last_updated:t},this.options.session_data_key)}static generateNewSession(e){return{session_id:(0,G.k$)(),last_updated:e}}static hasExpired(e,t,n){if(isNaN(t.getTime()))return!0;return e>new Date(t.getTime()+1e3*n)}static async initialise(e,t,n){const r={timeout_seconds:1800,session_data_key:"permutive-session",hasChanged:!1,logger:n};e.deleteCookie(r.session_data_key);const s=new Date,o=await t.get(r.session_data_key).catch(i.gn),a=Z.decodeSessionData(o),c=null===a||Z.hasExpired(s,a.last_updated,r.timeout_seconds)?{...Z.generateNewSession(s),hasChanged:!0}:{...a,last_updated:s,hasChanged:!1},u=new Z(t,(0,G.PM)(r,c));return await u.persistSessionData(c),u}}var X=n(6688);const ee=e=>(0,i.zG)(s.Do,(0,i.ls)(s.Qt("support",s.Uo(H(self))),s.Qt("partialTagWithKey",s.Uo((e=>{var t,n;const s="f279b5ea-1200-4ff6-9d35-17893279723e",o=void 0!==(null===(t=e[s])||void 0===t?void 0:t.q)&&void 0!==(null===(n=e[s])||void 0===n?void 0:n.config)?s:"permutive";return(0,i.zG)(e[o],(0,r.ij)("Can't find permutive tag on the page"),(0,r.UI)((e=>({tag:e,key:o}))))})(window))),s.UI((e=>{const t=e.partialTagWithKey.key;return window[t].sdkVersion="v20.23.0",e})),s.Qt("configFromQueryParams",s.Uo((0,L.B9)())),s.Hr("tag",(e=>((e,t)=>{let{tag:n,key:r}=e;return{...n,config:(0,L.ti)({...n.config,windowKey:r},t)}})(e.partialTagWithKey,e.configFromQueryParams))),s.UI((e=>{{const n=e.partialTagWithKey.key,r=window[n];t=r,window.googletag=window.googletag||{cmd:[]},window.googletag.cmd.push((()=>{const e=googletag.pubads(),n=()=>{t.track("AdRequest",{ad_server_id:"dfp",cohorts:e.getTargeting("permutive")})},r=e.getSlots().filter((e=>e.getResponseInformation())).length;for(let e=0;e<r;e++)n();e.addEventListener("slotRequested",n)}))}var t;return e})),s.Hr("trace",(e=>{let{tag:t}=e;return new j(t.config)})),s.Hr("namespace",(e=>{let{tag:t}=e;return new x(t.config)})),s.Hr("logger",(e=>{let{tag:t}=e;return function(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.RP;return e.loggingEnabled&&void 0!==(null===(t=self.console)||void 0===t?void 0:t.log)?new v(n):new _}(t.config)}))),s.Hr("urls",(e=>{let{tag:t}=e;return new T(t.config)})),s.Hr("messages",(e=>{let{logger:t}=e;return new w(t)})),s.Hr("worker",(()=>V())),s.ak("consentModule",(e=>(0,i.zG)((()=>(0,F.NY)({...e,consentRequired:e.tag.config.consentRequired})),s.Vn((e=>e.message))))),s.Hr("cookieStore",(e=>{let{consentModule:t,logger:n,namespace:r,tag:s}=e;return((e,t,n,r)=>new((0,i.zG)(u,d({consentTracking:r,logger:n})))(e,t,n))(r,s.config,n,t.consentTracking)})),s.Hr("externalData",(e=>{let{consentModule:t,logger:n,namespace:r}=e;return((e,t,n)=>new((0,i.zG)(p,h({consentTracking:n,logger:t})))(e))(r,n,t.consentTracking)})),s.Hr("userId",(e=>{let{cookieStore:t,consentModule:n,externalData:r,tag:i}=e;return new A(i.config,t,r,n.consentTracking.consentRef)})),s.Hr("permutiveData",(e=>{let{tag:t,namespace:n,logger:r,consentModule:s}=e;return((e,t,n,r)=>new((0,i.zG)(D,O({consentTracking:r,logger:n})))(e,t,n))(t.config,n,r,s.consentTracking)})),s.Hr("metrics",(t=>{let{tag:n,logger:r,permutiveData:i}=t;return function(e,t,n,r,i){const s=r.getData("metricsEnabled")??(()=>{const e=Math.random()<=n.metricsSamplingPercentage/100;return r.setData("metricsEnabled",e),e})()?new I(e,t,i):new S;return s.track({name:"sdk_initialisation_start_time_seconds",value:e/1e3,labels:{}}),s}(e.contextsInitTimestampPerformance,P(),n.config,i,r)})),s.Hr("pageviewState",(e=>{let{tag:t}=e;return(e=>{const t={viewId:(0,i.zG)(e.viewId,a.DT((e=>"string"==typeof e&&(0,G.Gz)(e))),a.fS(G.k$)),watsonEnabled:e.watson.enabled};return(0,i.zG)(R.Ue(t),(e=>{let[n,r]=e;return{ref:n,setState:(0,i.ls)((e=>e(n.current,t)),r)}}))})(t.config)})),(0,i.ls)(s.Hr("localStorage",(e=>{let{logger:t,namespace:n,consentModule:r}=e;return(0,J.E)(n,t,r.consentTracking.consentRef)})),s.ak("sessionManager",(e=>{let{cookieStore:t,localStorage:n,logger:r}=e;return s.Y3((()=>Z.initialise(t,n,r)),(e=>`Failed to initialise session manager: ${e.message}`))})),s.Hr("core",(t=>{let{consentModule:n,metrics:r,pageviewState:s,permutiveData:o,sessionManager:c,trace:u,tag:l,userId:d,worker:f}=t;const{eventSourceId:g,isFirstPageview:p}=(0,i.zG)(a.ij(o.getData("event-source-id")),a.hX(G.Gz),a.UI((e=>({eventSourceId:e,isFirstPageview:!1}))),a.fS((()=>({eventSourceId:(0,G.k$)(),isFirstPageview:!0})))),h=n.consentTracking.consentRef;if(p)if(h.current)o.setData("event-source-id",g);else{let e=!1;h.onChange((()=>{e||(e=!0,o.setData("event-source-id",g))}))}return f({consent:h.current,eventSourceId:g,isFirstPageview:p,isSecureContext:(m=l.config,"development"===m.environment?self.isSecureContext:"https:"===self.location.protocol),metrics:r,permutiveConfig:l.config,organizationId:"f279b5ea-1200-4ff6-9d35-17893279723e",pageviewState:s.ref.current,sdkInitTimestampPerformance:e.contextsInitTimestampPerformance,sdkInitTimestampDate:e.contextsInitTimestamp,sessionId:c.getSessionId(),trace:u,trackPageviewComplete:!0,userId:d.get(),userIdIsNewlyGenerated:d.isNewlyGenerated.current,webClient:(0,X.k)()});var m})),s.ak("consent",(e=>Y(e))),s.tS((e=>(0,i.zG)((0,m.SF)((()=>Promise.resolve().then(n.bind(n,9215)))),e.trace.traceTask("permutive.main.import_permutiveWebLowPriority"),o.tS((t=>t.initialiseWebSDK(e)))))))),te=e=>(e=>{e().then((0,r.g_)((e=>console.warn(`Permutive was not initialized. ${e}`)),i.Q1))})(ee(e))},7387:(e,t,n)=>{n.d(t,{Bf:()=>_,G6:()=>I,Gz:()=>w,HP:()=>D,Kn:()=>l,Or:()=>P,PM:()=>f,PQ:()=>S,Z_:()=>U,a4:()=>p,aT:()=>v,b2:()=>g,bw:()=>O,cO:()=>E,eu:()=>h,k$:()=>b,lW:()=>G,lo:()=>x,m8:()=>y,mQ:()=>q,qh:()=>d,rH:()=>A,rO:()=>C,vg:()=>z});var r=n(366),i=n(2275),s=n(9727),o=n(5586),a=n(8491),c=n(7029),u=n(3812);const l=e=>"object"==typeof e&&!Array.isArray(e)&&null!==e,d=e=>Object.entries(e);function f(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(((e,t)=>({...e,...t})),{})}a.ff(c.xb);function g(){let e,t;return{promise:new Promise(((n,r)=>{e=n,t=r})),reject:t,resolve:e}}function p(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r={waitTimeInMs:50,exponentialBackOff:!1,maxAttempts:20},{waitTimeInMs:o,exponentialBackOff:a,maxAttempts:c}=f(r,n);let l=0;const d=n=>new Promise((r=>Promise.resolve(t()).then((t=>t?Promise.resolve(e()).then((e=>r((0,s.G)(e)))):(0,i.zG)(l++,(e=>e<c?(0,u.HJ)((()=>r(d(n*(a?2:1)))),n):r(s.YP)))))));return d(o)}function h(e,t){const n=Object.create(null);for(const r of t)n[r]=e[r];return n}let m=[];function v(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:navigator.userAgent;if(m.unshift(e),m.length>1)return;const n=["beforeunload","pagehide"],r=n.concat(["visibilitychange"]),i=e=>{if(!s&&e){s=!0;const e=m;m=[],e.forEach((e=>{try{e()}catch{}}))}};let s=!1;r.forEach((e=>{window.addEventListener(e,(()=>{const n=("visibilitychange"!==e||document.hidden)&&k(t);i(n)}))})),n.forEach((e=>{window.addEventListener(e,(()=>i(!0)))}))}function _(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t={capture:!0,...t};const n=["visibilitychange","pagehide"];n.forEach((n=>window.addEventListener(n,(()=>s.Y3((()=>{"pagehide"!==n&&"hidden"!==document.visibilityState||e()}))),{capture:t.capture})))}function b(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^(self.crypto||self.msCrypto).getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)))}function w(e){return 36===e.length&&/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i.test(e)}function y(){const e={},t=arguments.length;for(let n=0;n<t;n++){const[t,r]=n<0||arguments.length<=n?void 0:arguments[n];e[t]=r}return e}function k(e){return/Mobi|Android/i.test(e)}function I(e){return/^((?!chrome|android).)*safari/i.test(e)}function S(e,t){return new Promise((n=>{(0,u.HJ)((()=>{Promise.resolve(e()).then(n)}),(null==t?void 0:t.timeout)??0)}))}function E(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}const P=()=>({equals:(e,t)=>Object.is(e,t)});function G(e){return(0,o.Zt)(((t,n)=>{const r=e.indexOf(t),i=e.indexOf(n);switch(!0){case-1===r&&-1===i:return 0;case-1!==r&&-1===i:return-1;case-1===r&&-1!==i:return 1;default:return r<=i?-1:1}}))}function U(e,t,n){return function(){try{return n(...arguments)}catch(n){e.reportError(n,t.get())}}}function z(e){return t=>null!=t&&e in t?t[e]:void 0}function D(e){let t=s.YP;const n=(0,s.fS)((()=>{const n=e();return t=(0,s.G)(n),n}));return()=>n(t)}const q=e=>{const t=new Map;return n=>(t.has(n)||t.set(n,e(n)),t.get(n))},C=e=>t=>{const n={...t};for(const i in e){var r;n[i]=null===(r=e[i])||void 0===r?void 0:r.call(e,t[i])}return n};function O(e){return t=>(e(t),t)}const x=e=>t=>{const n=e.slice(0,-1),o=e.slice(-1)[0];return(0,i.zG)(n,r.f2((e=>{let[n,r]=e;return(0,i.zG)(t,s.DT(n),s.UI(r))})),s.fS((()=>o(t))))},R=e=>t=>{if("number"==typeof t)return t;if("string"==typeof t){const n=e(t);return Number.isNaN(n)?void 0:n}},A=R(parseInt);R(parseFloat)},731:(e,t,n)=>{n.d(t,{b:()=>s});var r=n(7387),i=n(3812);class s{timeoutDurationInMilliseconds;maxTimeOutDurationInMilliseconds;constructor(e,t){this.timeoutDurationInMilliseconds=e,this.maxTimeOutDurationInMilliseconds=t}schedule(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeoutDurationInMilliseconds,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.maxTimeOutDurationInMilliseconds;return this.debounce(e,t,n)}scheduleAccumulated(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeoutDurationInMilliseconds,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.maxTimeOutDurationInMilliseconds;return this.debounce(e,n,r,t)}scheduleForPageUnload(e){return(0,r.aT)(e)}debounce(e,t,n,s){let o,a,c,u=[];return l=>{s&&(c=s.concat(c??s.empty,l));const d=(0,r.b2)();u.push(d);var f;return null===(f=o)||void 0===f||f(),o=(0,i.HJ)((()=>{var t;null===(t=a)||void 0===t||t(),a=void 0;const n=e(c||l);u.forEach((e=>e.resolve(n))),c=null==s?void 0:s.empty,u=[]}),t),a||(a=(0,i.HJ)((()=>{var t;null===(t=o)||void 0===t||t(),a=void 0;const n=e(c||l);u.forEach((e=>e.resolve(n))),c=null==s?void 0:s.empty,u=[]}),n)),d.promise}}}},5365:(e,t,n)=>{n.d(t,{i:()=>i});var r=n(3812);class i{messages;queue=[];nextNotify=null;constructor(e){this.messages=e,e.on("permutive:taskQueue:update",(()=>{this.execute()}))}add(e){this.queue.push(e),this.notify()}notify(){const e=()=>{this.messages.emit("permutive:taskQueue:update")},t=(new Date).getTime();null===this.nextNotify||this.nextNotify<t-50?(this.nextNotify=t,e()):this.nextNotify<=t&&(this.nextNotify=t+50,(0,r.HJ)(e,50))}execute(){if(0===this.queue.length)return;let e=!1,t=!1,n=0;for(let r=0;r<this.queue.length;r++){const i=this.queue[r];if(i.complete)n+=1;else if(i.started)t=!0,e=e||i.blocks();else{if(i.waits()&&t)break;e||(t=!0,e=e||i.blocks(),i.execute((()=>{this.notify()})))}}this.queue.splice(0,n)}size(){return this.queue.length}}},4513:(e,t,n)=>{n.d(t,{_Y:()=>o,bk:()=>s,zM:()=>i});var r=n(2275);const i=()=>{var e,t;const n=null===(e=window.location.href.split("?")[1])||void 0===e||null===(t=e.split("#")[0])||void 0===t?void 0:t.split("&");return void 0===n?{}:n.reduce(((e,t)=>{const[n,r]=t.split("=");return{...e,[n]:r}}),{})},s=e=>{if(!e)return"";return(0,r.zG)(e,(e=>{const t=e.length-1;return"/"===e[t]?e.slice(0,t):e}))};function o(e){const t=e.match(/\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b/),n=e.match(/[a-z0-9][a-z0-9-]+\.[a-z.]{2,24}$/i),r=e.match(/localhost/);if(n&&n.length>0){const t=e.split(".").reverse();return t.length>=3&&t[1].match(/^(com|edu|gov|net|mil|org|nom|co|ac|name|info|biz)$/i)?t[2]+"."+t[1]+"."+t[0]:t[1]+"."+t[0]}return t&&(null==t?void 0:t.length)>0?t[0]:r&&(null==r?void 0:r.length)>0?"localhost":""}},9082:(e,t,n)=>{n(3636),n(7387),n(3812)},6707:(e,t,n)=>{n.d(t,{$7:()=>m,Cg:()=>g,Qd:()=>h,cs:()=>p,dN:()=>d,zi:()=>f});var r=n(1385),i=n(2275),s=n(9727),o=n(1583),a=n(936),c=n(5460),u=n(7387);const l="[PrebidJS]";function d(e){const t=(()=>{const e=["pbjs",...window._pbjsGlobals||[]];return[...new Set(e)]})();e.logger.debug(l,"Found keys",t);return a.K4((()=>(0,i.zG)(t,o.UI((0,i.ls)((e=>(e=>{const t={maxAttempts:100,waitTimeInMs:50};let n;return{windowPropertyKey:e,pbjs:(0,u.a4)((()=>n),(()=>{const t=(0,i.zG)(window,(0,u.vg)(e));return!(null==t||!t.que||"function"!=typeof(null==t?void 0:t.getEvents)||(n=t,0))}),t)}})(e)),(t=>(0,i.zG)(c.p4(t.pbjs),c.UI((n=>{const o=r.pF((n=>(n.message=`Failed to resolve key "${t.windowPropertyKey}". ${n.message}`,e.reportError(`${l} ${n.toString()}`),s.YP)));return(0,i.zG)(n,(0,u.bw)(s.UI((n=>e.logger.debug(l,`Completed check for key "${t.windowPropertyKey}"`,{result:n})))),s.UI(o),s.UI(s.UI((e=>({windowPropertyKey:t.windowPropertyKey,pbjs:e})))))})))))),(e=>c.vP(...e)),c.UI((e=>({completedChecks:e.every(s.pC),pbjsKeyPairs:e.map(s.xH)}))),c.UI((e=>{let{pbjsKeyPairs:t,completedChecks:n}=e;const r=t.filter(s.pC),[a,...c]=r;return{completedChecks:n,mainPair:a??s.YP,otherPairs:(0,i.zG)(c,o.DZ(i.yR))}})))))}const f=e=>"function"==typeof e.readConfig?e.readConfig():e.getConfig();function g(e){var t;const n=null===(t=e.meta)||void 0===t?void 0:t.advertiserDomains;if("string"==typeof n)return[n];if(Array.isArray(n)){const e=n.filter((e=>"string"==typeof e));return e.length>0?e:void 0}}const p=e=>{var t;const n=e.appnexus&&"object"==typeof e.appnexus&&"buyerMemberId"in e.appnexus&&e.appnexus.buyerMemberId,r=e.rubicon&&"object"==typeof e.rubicon&&"networkId"in e.rubicon&&e.rubicon.networkId,i=n||r||(null==e||null===(t=e.meta)||void 0===t?void 0:t.networkId);return i?`${i}`:void 0},h=e=>{const t=e=>isNaN(e)?void 0:e;try{return"number"==typeof e.cpm?t(e.cpm):(0,i.zG)(e.cpm??"",parseFloat,t)}catch{return}},m=e=>e.dealId?`${e.dealId}`:void 0},8672:(e,t,n)=>{n.d(t,{X:()=>r});const r=e=>{let t=!0;const n=[];return{addBlocker:r=>{n.push(r),e.logger.log("<blockers> added blocker "+r),e.messages.on(r,(()=>{if(t){const i=n.indexOf(r);i>=0&&(n.splice(i,1),e.logger.log("<blockers> removed blocker "+r)),0===n.length&&(t=!1,e.messages.emit("permutive:blockers:empty"),e.logger.log("<blockers> complete"))}}))}}}},1555:(e,t,n)=>{n.d(t,{X:()=>i});var r=n(5460);class i{ref;setCustomProps;constructor(){const[e,t]=r.Ue({});this.ref=e,this.setCustomProps=t}getCustomProps(){return this.ref.current}}},3194:(e,t,n)=>{n.r(t),n.d(t,{EventsCache:()=>k,RESET_HISTORICAL:()=>b});var r=n(2865),i=n(2925),s=n(1583),o=n(1385),a=n(2275),c=n(9727),u=n(8940),l=n(9246);const d=e=>({id:e.id,name:e.name,time:new Date(e.time),properties:e.properties||{},session_id:e.session_id,view_id:e.view_id}),f=e=>({id:e.id,name:e.name,time:(g(e.time)?e.time:new Date).toISOString(),properties:e.properties||{},session_id:e.session_id,view_id:e.view_id}),g=e=>isFinite(e)&&e instanceof Date;var p=n(7387),h=n(731);class m extends Error{constructor(e){super(e),this.name="StoreClosingError"}}const v="permutive-events-cache",_="permutive-events-for-page",b="historical",w="[EVENTSCACHE]",y=e=>"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name;class k{config;logger;reportError;trace;metrics;userId;makeEventsStore;eventStore;eventsCache=this.makeEventsRepository(v);eventsForPage=this.makeEventsRepository(_);eventsTTLInMilliseconds;readiness;debouncedReportError=(()=>new h.b(5e3,5e3).schedule((e=>this.reportError(e.errorMessage,{userId:e.userId}))))();static initialise(e,t,n,r,i,s,o){return(0,a.zG)(o(),l.UI((a=>new k(e,t,n,r,i,s,o,a))))}constructor(e,t,n,r,i,s,o,l){this.config=e,this.logger=t,this.reportError=n,this.trace=r,this.metrics=i,this.userId=s,this.makeEventsStore=o,this.eventStore=l,this.eventsTTLInMilliseconds=(0,a.zG)((0,c.ij)(this.config.eventsTTLInDays),(0,c.tS)((e=>"number"==typeof e&&e>0?(0,c.G)(24*e*3600):c.YP))),this.eventsCache.events=(0,p.HP)((()=>(0,p.PQ)((0,a.zG)(u.tD((()=>this.trace.startSpan("load_event_cache"))),u.tS((e=>(0,a.zG)(this.loadFromDisk(),u.At((t=>()=>{e.finish(),this.logDebug(`Event cache loaded, #e ${t.length}`)}))))))))),this.readiness=this.eventsCache.events().then((()=>this.migratePreviousPagesEvents())),s.onChange((()=>this.reset()))}async migratePreviousPagesEvents(){const e=this.trace.startSpan("migrate_previous_for_page_events"),t=(0,u.pE)((e=>(0,l.Y3)((()=>e.flush()),r.w)));return(0,a.zG)([this.eventsForPage,this.eventsCache],t,(0,u.UI)((t=>{const n=s.bj(t);return n.length>0&&this.reportError(`Migrate previous events failed. Got:\n${n.join("\n ")}`,{userId:this.userId.current}),e.finish()})),(e=>e()))}all(){return Promise.all([this.eventsCache.events(),this.eventsForPage.events()]).then(s.xH)}async add(e,t){let{persistOnDisk:n}=t;return this.logDebug("Adding to cache",e),this.eventsForPage.events=(0,a.zG)(this.eventsForPage.events,u.UI((t=>[...t,e])),p.HP),n&&this.readiness.then((()=>this.eventsForPage.flush())),e}filterEventsByWorkspace(e){return e}pruneEventsToSizeLimit(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.config.eventsCacheLimitBytes;if(n<=0||t<=n)return this.logDebug(`Event size of ${t} less than limit of ${n}`),{events:e,sizeInBytes:t};this.logDebug("Events before pruning",{count:e.length,sizeInBytes:t,byteLimit:n});let r=1,i=[...e];for(;t>n;)i.splice(0,r),r*=2,t=2*JSON.stringify(i).length;return this.logDebug("Events after pruning",{count:i.length,sizeInBytes:t}),{events:i,sizeInBytes:t}}loadFromDisk(){const e=()=>[],t=(0,a.zG)(this.eventsTTLInMilliseconds,c.EQ((()=>a.yR),(e=>s.hX((t=>e>Date.now()-t.time.getTime())))));return(0,a.zG)(u.tD((()=>(this.logLog("Loading event cache..."),this.metrics.startTimer("sdk_load_events_cache_task_duration_seconds",{})))),u.YO("loadEventsCacheTask"),u.ak("eventsFromDisk",(()=>(0,a.zG)(s.nI([this.eventStore.get(v),this.eventStore.get(_)]),s.UI(l.LV((0,p.lo)([[e=>e instanceof m,(0,a.ls)(e,u.of)],t=>(0,a.zG)(u.tD((()=>this.reportError(`Error fetching data from store. Got ${t}`,{userId:this.userId.current}))),u.tS((()=>()=>this.reset("historical"))),u.UI(e))]),(0,a.ls)(c.fS(e),u.of))),s.vP(u.qA)))),u.At((e=>{let{eventsFromDisk:t,loadEventsCacheTask:n}=e;return()=>{this.logDebug("Read events from store:",t),this.metrics.stopTimer("sdk_load_events_cache_task_duration_seconds",n)}})),u.UI((0,a.ls)((0,p.vg)("eventsFromDisk"),s.xH,this.filterEventsByWorkspace,(e=>this.pruneEventsToSizeLimit(e,2*JSON.stringify(e).length)),(e=>(this.eventsCache.sizeInBytes=e.sizeInBytes,this.eventsCache.sizeInBytesLastSuccessfulWrite=e.sizeInBytes,e.events.length>0&&(this.metrics.track({name:"sdk_events_cache_byte_total",value:e.sizeInBytes,labels:{}}),this.metrics.track({name:"sdk_events_cache_size_total",value:e.events.length,labels:{}})),e.events)),s.UI(d),t)))}async reset(e){return(0,a.zG)(u.tD((()=>this.logDebug("Resetting Events Cache"))),u.tS((()=>this.eventStore.deleteStore())),l.tS((()=>this.makeEventsStore())),l.Zl((t=>(this.eventStore=t,e===b?i.gz(l.Ij)(this.eventsCache.reset,this.eventsForPage.flush):i.gz(l.Ij)(this.eventsCache.reset,this.eventsForPage.reset)))),l.wE((()=>()=>this.all())),l.fS((()=>u.of(I()))),(e=>e()))}getStateSizeInBytes(){return this.eventsForPage.sizeInBytes+this.eventsCache.sizeInBytes}makeEventsRepository(e){const t=(()=>{let e=Promise.resolve(o.F2((0,a.Q1)()));return t=>e=e.then(t)})(),n=e=>(0,a.zG)(u.tD((()=>this.logDebug(`Writing ${e.length} events to ${v.key}`))),u.tS((()=>this.eventStore.put(e.map(f),v.key))),l.UI(a.Q1)),i=(0,a.zG)(u.tD((()=>this.logDebug(`Deleting events for ${v.key}`))),u.tS((()=>this.eventStore.delete(v.key))),l.Vn(r.w)),s=(0,a.ls)(u.of,u.At((e=>()=>this.logError(`Events cache failed to put ${v.key}. Got ${e}`))),u.tS((0,p.lo)([[e=>y(e)&&v.retryAttempts<9,()=>(0,a.zG)(u.tD((()=>{v.retryAttempts+=1,this.logDebug(`Attempt #${v.retryAttempts} to write ${v.key} to EventsStore`)})),u.tS((()=>m)),u.tS((()=>d)))],[e=>y(e),e=>(0,a.zG)(u.tD((()=>this.logDebug(`Attempted ${v.retryAttempts} rewrite attempts and reached limit of 9 max writes.`,"Reporting QuotaExceededError to API"))),u.tS((()=>()=>this.debouncedReportError({errorMessage:`Events cache failed to put ${v.key}. Got ${e}`,userId:this.userId.current}))),u.tS((()=>l.t$(e))))],l.t$]))),c=e=>l.tD((()=>{this.logDebug(`Successfully wrote events for ${v.key} after ${v.retryAttempts} attempts`),v.retryAttempts=0,v.sizeInBytes=2*JSON.stringify(e).length,v.sizeInBytesLastSuccessfulWrite=v.sizeInBytes})),d=(0,a.zG)((()=>v.events()),u.tS((e=>(0,a.zG)(n(e),u.mU(o.EQ(s,(()=>c(e)))))))),g=(e,t)=>(0,a.zG)(e.events,u.UI((n=>{const r=2*JSON.stringify(n).length,i=this.pruneEventsToSizeLimit(n,r,t);return e.events=u.of(i.events),e.sizeInBytes=i.sizeInBytes,t-e.sizeInBytes}))),h=(e,t)=>{let[n,...r]=e;return n&&0!==t?(0,a.zG)(g(n,t),u.tS((e=>(this.logDebug(`${e} left after pruning ${n.key}`),h(r,e))))):u.of((0,a.Q1)())},m=(0,a.zG)(l.tD((()=>this.eventsForPage.sizeInBytes-this.eventsForPage.sizeInBytesLastSuccessfulWrite)),l.fX(o.DT((e=>e>0),(e=>new Error(`${this.eventsForPage.key} failed to write the same or smaller events cache of size ${e}`)))),l.tS((e=>{const t=1.2*e,n=[this.eventsCache,this.eventsForPage];return this.logDebug(`Pruning ${t} bytes from`,n),(0,a.zG)(h(n,t),l.fF)}))),v={key:e,events:u.of([]),sizeInBytes:0,sizeInBytesLastSuccessfulWrite:0,retryAttempts:0,flush:()=>(0,a.zG)(u.tD((()=>this.trace.startSpan(`write_${v.key}`))),u.tS((e=>(0,a.zG)(d,u.At((()=>()=>e.finish()))))),t),reset:()=>(0,a.zG)(u.tD((()=>{v.events=u.of([]),v.sizeInBytes=0,v.sizeInBytesLastSuccessfulWrite=0})),u.tS((()=>i)),t)};return v}logDebug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.debug(w,...t)}logWarn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.warn(w,...t)}logError(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.error(w,...t)}logLog(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.log(w,...t)}}const I=()=>[]},8949:(e,t,n)=>{n.r(t),n.d(t,{DBStore:()=>o});var r=n(2865),i=n(9727),s=n(9246);class o{db;constructor(e){this.db=Promise.resolve(e)}put(e,t){return(0,s.Y3)((()=>this.db.then((n=>n.put(e,t)))),r.w)}get(e){return(0,s.Y3)((()=>this.db.then((t=>t.get(e))).then(i.ij)),r.w)}delete(e){return(0,s.Y3)((()=>this.db.then((t=>t.delete(e)))),(e=>String(e)))}deleteStore(){return(0,s.Y3)((()=>this.db.then((e=>e.deleteStore()))),(e=>String(e)))}}},8:(e,t,n)=>{n(7387)},1948:(e,t,n)=>{n(3812)},2831:(e,t,n)=>{n.r(t),n.d(t,{eventCacheService:()=>u,eventNameBlacklist:()=>l});var r=n(5460),i=n(936),s=n(2444),o=n(2275),a=n(1583),c=n(7387);const u=e=>i.K4((()=>({newEvents:(0,o.zG)(e.newEvents,r.UI(s.UI((0,c.bw)(a.UI((t=>{let[,n]=t;l.has(n.name)||e.eventsCache.add(n,{persistOnDisk:!0})})))))),priorEvents:()=>e.eventsCache.all()}))),l=new Set(["AdRequest","PageviewEngagement","PrebidAuctions","Reaction","SegmentEntry","SegmentExit","SlotRendered","ThirdPartySegments","VideoEngagement"])},1001:(e,t,n)=>{n.d(t,{Kd:()=>i,eJ:()=>s});n(3636);var r=n(936);n(5460),n(7387);const i="addon:twitter_pixel",s=function(e){return r.K4((()=>{}))}},2925:(e,t,n)=>{n.d(t,{Qt:()=>o,Yt:()=>d,ap:()=>s,gz:()=>l});var r=n(2275),i=n(7963);function s(e,t){return function(n){return function(r){return e.ap(e.map(r,(function(e){return function(n){return t.ap(e,n)}})),n)}}}function o(e){return function(t,n){return function(r){return e.ap(e.map(r,(function(e){return function(n){var r;return Object.assign({},e,((r={})[t]=n,r))}})),n)}}}function a(e,t,n){return function(r){for(var i=Array(n.length+1),s=0;s<n.length;s++)i[s]=n[s];return i[n.length]=r,0===t?e.apply(null,i):a(e,t-1,i)}}var c={1:function(e){return[e]},2:function(e){return function(t){return[e,t]}},3:function(e){return function(t){return function(n){return[e,t,n]}}},4:function(e){return function(t){return function(n){return function(r){return[e,t,n,r]}}}},5:function(e){return function(t){return function(n){return function(r){return function(i){return[e,t,n,r,i]}}}}}};function u(e){return i.e$.call(c,e)||(c[e]=a(r.bc,e-1,[])),c[e]}function l(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=t.length,i=u(r),s=e.map(t[0],i),o=1;o<r;o++)s=e.ap(s,t[o]);return s}}function d(e){return function(t){for(var n=Object.keys(t),r=n.length,i=function(e){var t=e.length;switch(t){case 1:return function(t){var n;return(n={})[e[0]]=t,n};case 2:return function(t){return function(n){var r;return(r={})[e[0]]=t,r[e[1]]=n,r}};case 3:return function(t){return function(n){return function(r){var i;return(i={})[e[0]]=t,i[e[1]]=n,i[e[2]]=r,i}}};case 4:return function(t){return function(n){return function(r){return function(i){var s;return(s={})[e[0]]=t,s[e[1]]=n,s[e[2]]=r,s[e[3]]=i,s}}}};case 5:return function(t){return function(n){return function(r){return function(i){return function(s){var o;return(o={})[e[0]]=t,o[e[1]]=n,o[e[2]]=r,o[e[3]]=i,o[e[4]]=s,o}}}}};default:return a((function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];for(var i={},s=0;s<t;s++)i[e[s]]=n[s];return i}),t-1,[])}}(n),s=e.map(t[n[0]],i),o=1;o<r;o++)s=e.ap(s,t[n[o]]);return s}}},366:(e,t,n)=>{n.d(t,{oA:()=>w,t9:()=>g,DZ:()=>b,Ew:()=>u,f2:()=>l,xH:()=>v,jV:()=>p,uK:()=>y,tV:()=>I,u4:()=>E,DY:()=>f});var r=n(2275),i=(n(7560),n(7963)),s=n(817);i.r1;var o=function(e){return[e]};s.xP,s.Lx,s.u4,s.OE,s.nq,s.iw,s.YM,s.ZN,s.Eh,i.F4,s.YM,s.Z$,s.VV,s.Fp,s.j0;s.ur;var a=n(1583),c=n(4219);n(6511);a.P5,a.YM,a.Z$;a.cx;function u(e){return a.Ew(e)}var l=a.f2;a.JO,a.qr;var d=function(e){return e.slice()},f=function(e){return function(t){return t.length<=1?d(t):t.slice().sort(e.compare)}};var g=a.t9;function p(e){var t=g(e);return function(n,r){if(void 0===r){var i=p(e);return function(e){return i(e,n)}}return n.filter((function(e){return t(e,r)}))}}a.kp,a.Eq;var h=o,m=function(e){return function(t){return(0,r.zG)(t,function(e){return function(t){for(var n=[],r=0;r<t.length;r++)n.push.apply(n,e(r,t[r]));return n}}((function(t,n){return e(n)})))}},v=m(r.yR),_=function(e){return function(t){for(var n=[],r=0;r<t.length;r++){var s=e(r,t[r]);i.pC(s)&&n.push(s.value)}return n}},b=function(e){return _((function(t,n){return e(n)}))},w=b(r.yR),y=function(e){return k((function(t,n){return e(n)}))},k=function(e){return function(t){for(var n=[],r=[],i=0;i<t.length;i++){var s=t[i];e(i,s)?r.push(s):n.push(s)}return(0,c.s4)(n,r)}},I=function(e){return S((function(t,n){return e(n)}))},S=function(e){return function(t){for(var n=[],r=[],i=0;i<t.length;i++){var s=e(i,t[i]);"Left"===s._tag?n.push(s.left):r.push(s.right)}return(0,c.s4)(n,r)}},E=(a.Lx,a.xP,a.u4);a.OE,a.nq,a.iw,a.ZN,a.Eh,a.pR,a.pJ,a.oR,a.yW,a.j0,i.F4},8543:(e,t,n)=>{function r(e){return function(t){return function(n){return e.chain(n,(function(n){return e.map(t(n),(function(){return n}))}))}}}function i(e){return function(t,n){return function(r){return e.chain(r,(function(r){return e.map(n(r),(function(e){var n;return Object.assign({},r,((n={})[t]=e,n))}))}))}}}n.d(t,{a:()=>i,m:()=>r})},1385:(e,t,n)=>{n.d(t,{G5:()=>v,dO:()=>p,Pd:()=>y,ak:()=>L,tS:()=>b,Y$:()=>O,g_:()=>D,ij:()=>A,Yo:()=>E,DT:()=>S,fS:()=>C,pF:()=>q,nM:()=>P,t$:()=>a,UI:()=>g,Vn:()=>k,EQ:()=>z,vx:()=>R,F2:()=>c,LF:()=>x,KC:()=>j,i$:()=>M,Y3:()=>T});var r=n(8543),i=n(5162),s=n(2275),o=(n(7560),n(7963)),a=o.t$,c=o.F2,u=function(e,t){return(0,s.zG)(e,g(t))},l=function(e,t){return(0,s.zG)(e,m(t))},d=function(e,t){return(0,s.zG)(e,b(t))},f="Either",g=function(e){return function(t){return P(t)?t:c(e(t.right))}},p={URI:f,map:u},h=c,m=function(e){return function(t){return P(t)?t:P(e)?e:c(t.right(e.right))}},v={URI:f,map:u,ap:l},_=function(e){return function(t){return P(t)?t:e(t.right)}},b=_,w={URI:f,map:u,ap:l,chain:d},y=function(e,t){return function(n){return P(n)?a(e(n.left)):c(t(n.right))}},k=function(e){return function(t){return P(t)?a(e(t.left)):t}},I={URI:f,fromEither:s.yR},S=(0,i.DT)(I),E=(0,i.Yo)(I),P=o.nM,G=(o.tO,function(e,t){return function(n){return P(n)?e(n.left):t(n.right)}}),U=G,z=G,D=z,q=function(e){return function(t){return P(t)?e(t.left):t.right}},C=q,O=(0,i.Y$)(I,w),x=function(e){return P(e)?c(e.left):a(e.right)},R=function(e){return function(t){return P(t)?e(t.left):t}},A=function(e){return function(t){return null==t?a(e):c(t)}},T=function(e,t){try{return c(e())}catch(e){return a(t(e))}},M=U(s.yR,s.yR);function j(e){return e instanceof Error?e:new Error(String(e))}o.F4;var L=(0,r.a)(w);o.Xl},1890:(e,t,n)=>{n.d(t,{EQ:()=>w,F2:()=>a,KQ:()=>f,LF:()=>P,LU:()=>E,LV:()=>y,NG:()=>g,Pd:()=>_,UI:()=>p,Vn:()=>b,ap:()=>h,dQ:()=>S,fS:()=>k,i$:()=>G,ij:()=>d,m8:()=>u,pk:()=>l,t$:()=>c,tS:()=>m,vx:()=>I,wp:()=>v});var r=n(2925),i=n(1385),s=n(2275),o=n(7560);function a(e){return(0,s.ls)(i.F2,e.of)}function c(e){return(0,s.ls)(i.t$,e.of)}function u(e){return function(t){return e.map(t,i.F2)}}function l(e){return function(t){return e.map(t,i.t$)}}function d(e){return function(t){return(0,s.ls)(i.ij(t),e.of)}}function f(e){var t=d(e);return function(e){var n=t(e);return function(e){return(0,s.ls)(e,n)}}}function g(e){var t=m(e),n=f(e);return function(e){var r=n(e);return function(e){return t(r(e))}}}function p(e){return(0,o.UI)(e,i.dO)}function h(e){return(0,r.ap)(e,i.G5)}function m(e){return function(t){return function(n){return e.chain(n,(function(n){return i.nM(n)?e.of(n):t(n.right)}))}}}function v(e){return function(t){return function(n){return e.chain(n,(function(n){return i.nM(n)?t():e.of(n)}))}}}function _(e){return function(t,n){return function(r){return e.map(r,i.Pd(t,n))}}}function b(e){return function(t){return function(n){return e.map(n,i.Vn(t))}}}function w(e){return function(t,n){return function(r){return e.map(r,i.EQ(t,n))}}}function y(e){return function(t,n){return function(r){return e.chain(r,i.EQ(t,n))}}}function k(e){return function(t){return function(n){return e.chain(n,i.EQ(t,e.of))}}}function I(e){return function(t){return function(n){return e.chain(n,(function(n){return i.nM(n)?t(n.left):e.of(n)}))}}}function S(e){var t=I(e);return function(n){return t((function(t){return e.map(n(t),(function(e){return i.nM(e)?e:i.t$(t)}))}))}}function E(e){return function(t){return function(n){return e.chain(n,i.EQ((function(n){return e.map(t(n),i.t$)}),(function(t){return e.of(i.F2(t))})))}}}function P(e){return function(t){return e.map(t,i.LF)}}function G(e){return function(t){return e.map(t,i.i$)}}},5191:(e,t,n)=>{n.d(t,{f7:()=>r,n_:()=>i,w4:()=>s});n(2275);var r=function(e){return{equals:function(t,n){return t===n||e(t,n)}}},i=function(e){return r((function(t,n){for(var r in e)if(!e[r].equals(t[r],n[r]))return!1;return!0}))},s={equals:function(e,t){return e===t}};s.equals},5162:(e,t,n)=>{n.d(t,{DT:()=>o,Y$:()=>u,Yo:()=>s,fX:()=>c});var r=n(2275),i=n(7963);function s(e){return function(t){return function(n){return e.fromEither(i.Wi(n)?i.t$(t()):i.F2(n.value))}}}function o(e){return function(t,n){return function(r){return e.fromEither(t(r)?i.F2(r):i.t$(n(r)))}}}function a(e){return function(t){return(0,r.ls)(t,e.fromEither)}}function c(e,t){var n=a(e);return function(e){return function(r){return t.chain(r,n(e))}}}function u(e,t){return function(n,r){return function(s){return t.chain(s,(function(t){return e.fromEither(n(t)?i.F2(t):i.t$(r(t)))}))}}}},1395:(e,t,n)=>{n.d(t,{At:()=>s});var r=n(8543),i=n(2275);function s(e,t){var n=(0,r.m)(t);return function(t){return n((0,i.ls)(t,e.fromIO))}}},7560:(e,t,n)=>{function r(e,t){return function(n){return function(r){return e.map(r,(function(e){return t.map(e,n)}))}}}function i(e){return function(t){return function(n){return e.map(n,(function(e){var n;return(n={})[t]=e,n}))}}}function s(e){return function(t,n){return function(r){return e.map(r,(function(e){var r;return Object.assign({},e,((r={})[t]=n(e),r))}))}}}n.d(t,{Hr:()=>s,UI:()=>r,YO:()=>i})},2444:(e,t,n)=>{n.d(t,{G5:()=>l,RD:()=>p,UI:()=>a,of:()=>c});var r=n(2275),i=(n(7560),n(7963)),s=function(e,t){return function(){return t(e())}},o=function(e,t){return function(){return e()(t())}},a=function(e){return function(t){return s(t,e)}},c=r.a9,u="IO",l={URI:u,map:s,ap:o},d=(r.yR,r.yR,i.F4,c(i.Xl)),f=function(e){var t=function(e){return function(t){return function(){for(var n=[e(0,i.YM(t))()],r=1;r<t.length;r++)n.push(e(r,t[r])());return n}}}(e);return function(e){return i.Od(e)?t(e):d}},g=function(e){return f((function(t,n){return e(n)}))},p=g(r.yR)},9727:(e,t,n)=>{n.d(t,{G5:()=>G,Ri:()=>A,xu:()=>F,dO:()=>S,wp:()=>D,tS:()=>U,mU:()=>V,hX:()=>T,DZ:()=>M,xH:()=>H,g_:()=>K,Uo:()=>$,ij:()=>J,KQ:()=>X,DT:()=>d,Eh:()=>k,IS:()=>f,fS:()=>W,EK:()=>g,lo:()=>C,Wi:()=>N,pC:()=>B,UI:()=>I,EQ:()=>Y,aD:()=>Q,YP:()=>u,of:()=>E,RD:()=>re,G:()=>l,FS:()=>ee,Y3:()=>Z,bM:()=>q});var r=n(8543),i=n(2275),s=(n(7560),n(7963)),o=n(8491),a=n(4219);n(6511);function c(e,t){return function(n){return n?t.of(void 0):e.zero()}}var u=s.YP,l=s.G;function d(e){return function(t){return e(t)?l(t):u}}var f=function(e){return"Right"===e._tag?u:l(e.left)},g=function(e){return"Left"===e._tag?u:l(e.right)},p=function(e,t){return(0,i.zG)(e,I(t))},h=function(e,t){return(0,i.zG)(e,P(t))},m=function(e,t){return(0,i.zG)(e,U(t))},v=function(e,t){return(0,i.zG)(e,T(t))},_=function(e,t){return(0,i.zG)(e,M(t))},b=function(e,t){return(0,i.zG)(e,j(t))},w=function(e,t){return(0,i.zG)(e,L(t))},y="Option",k=function(e){return{equals:function(t,n){return t===n||(N(t)?N(n):!N(n)&&e.equals(t.value,n.value))}}},I=function(e){return function(t){return N(t)?u:l(e(t.value))}},S={URI:y,map:p},E=l,P=function(e){return function(t){return N(t)||N(e)?u:l(t.value(e.value))}},G={URI:y,map:p,ap:h},U=function(e){return function(t){return N(t)?u:e(t.value)}},z={URI:y,map:p,ap:h,chain:m},D=function(e){return function(t){return N(t)?e():t}},q=function(){return u},C=c({URI:y,zero:q},{URI:y,of:E}),O=U(i.yR),x=(0,a.s4)(u,u),R=function(e){return N(e)?x:(0,a.s4)(f(e.value),g(e.value))},A={URI:y,compact:O,separate:R},T=function(e){return function(t){return N(t)?u:e(t.value)?t:u}},M=function(e){return function(t){return N(t)?u:e(t.value)}},j=function(e){return function(t){return(0,a.s4)(v(t,(0,o.ff)(e)),v(t,e))}},L=function(e){return(0,i.ls)(I(e),R)},F={URI:y,map:p,compact:O,separate:R,filter:v,filterMap:_,partition:b,partitionMap:w},$=g,B=s.pC,N=function(e){return"None"===e._tag},Q=function(e,t){return function(n){return N(n)?e():t(n.value)}},Y=Q,K=Y,W=function(e){return function(t){return N(t)?e():t.value}},H=O,V=(0,r.m)(z),J=function(e){return null==e?u:l(e)},Z=function(e){try{return l(e())}catch(e){return u}},X=function(e){return(0,i.ls)(e,J)},ee=Y(i.r5,i.yR);s.F4;var te=E(s.Xl),ne=function(e){var t=function(e){return function(t){var n=e(0,s.YM(t));if(N(n))return u;for(var r=[n.value],i=1;i<t.length;i++){var o=e(i,t[i]);if(N(o))return u;r.push(o.value)}return l(r)}}(e);return function(e){return s.Od(e)?t(e):te}},re=function(e){return ne((function(t,n){return e(n)}))}(i.yR)},5586:(e,t,n)=>{n.d(t,{Fp:()=>c,VV:()=>a,Zt:()=>o,uZ:()=>u});var r=n(5191),i=n(2275),s=function(e){return function(t,n){return t===n||0===e(t,n)}},o=function(e){return{equals:s(e),compare:function(t,n){return t===n?0:e(t,n)}}},a=(i.W8,function(e){return function(t,n){return t===n||e.compare(t,n)<1?t:n}}),c=function(e){return function(t,n){return t===n||e.compare(t,n)>-1?t:n}},u=function(e){var t=a(e),n=c(e);return function(e,r){return function(i){return n(t(i,r),e)}}};r.w4.equals},8491:(e,t,n)=>{n.d(t,{ff:()=>r});n(2275);var r=function(e){return function(t){return!e(t)}}},1583:(e,t,n)=>{n.d(t,{$R:()=>G,DZ:()=>B,EQ:()=>h,Eh:()=>re,Eq:()=>O,Ew:()=>y,G:()=>de,Hr:()=>pe,JO:()=>I,Lx:()=>H,OE:()=>V,Od:()=>g,P5:()=>v,Su:()=>j,UI:()=>M,YM:()=>_,YO:()=>ge,Z$:()=>b,ZN:()=>te,bM:()=>R,bj:()=>P,cS:()=>ue,cx:()=>w,f2:()=>k,hX:()=>F,hp:()=>E,iw:()=>Z,j0:()=>fe,kp:()=>C,nI:()=>ce,nq:()=>J,oA:()=>N,oR:()=>ae,of:()=>x,oh:()=>L,pJ:()=>oe,pR:()=>ie,qr:()=>S,t9:()=>U,tS:()=>A,u4:()=>W,uK:()=>Q,uZ:()=>ne,vP:()=>X,xH:()=>T,xP:()=>K,xb:()=>f,yW:()=>le,zo:()=>z});var r=n(5191),i=n(2275),s=n(7560),o=n(7963),a=n(6627),c=n(5586),u=n(817),l=n(4219),d=(n(6511),function(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}),f=function(e){return 0===e.length},g=u.Od,p=(u.Ce,u.ws,u.R3);u.Im;var h=function(e,t){return function(n){return g(n)?t(n):e()}},m=u.dC;function v(e,t){return void 0===t?function(t){return v(e,t)}:m(e,t)?o.YP:o.G(t[e])}var _=function(e){return g(e)?o.G(u.YM(e)):o.YP},b=function(e){return g(e)?o.G(u.Z$(e)):o.YP};var w=function(e){return function(t){for(var n=0;n<t.length;n++)if(e(t[n]))return o.G(n);return o.YP}};function y(e){return function(t){for(var n=0;n<t.length;n++)if(e(t[n]))return o.G(t[n]);return o.YP}}var k=function(e){return function(t){for(var n=0;n<t.length;n++){var r=e(t[n]);if(o.pC(r))return r}return o.YP}};var I=function(e){return function(t){for(var n=t.length-1;n>=0;n--){var r=e(t[n]);if(o.pC(r))return r}return o.YP}},S=function(e){return function(t){for(var n=t.length-1;n>=0;n--)if(e(t[n]))return o.G(n);return o.YP}},E=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];"Right"===r._tag&&t.push(r.right)}return t},P=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];"Left"===r._tag&&t.push(r.left)}return t};function G(e,t){return void 0===t?function(t){return G(t,e)}:function(e,t,n){for(var r=[],i=Math.min(e.length,t.length),s=0;s<i;s++)r[s]=n(e[s],t[s]);return r}(e,t,(function(e,t){return[e,t]}))}function U(e){return function(t,n){if(void 0===n){var r=U(e);return function(e){return r(t,e)}}for(var i,s=0;s<n.length;s++)if(i=n[s],e.equals(i,t))return!0;return!1}}var z=function(e){return function(t){return f(t)?e:f(e)?t:t.concat(e)}};var D=function(e,t){return(0,i.zG)(e,M(t))},q=function(e,t,n){return(0,i.zG)(e,W(t,n))},C=function(e,t){return(0,i.zG)(e,oe(t))},O=function(e,t){return(0,i.zG)(e,ae(t))},x=u.of,R=function(){return ue},A=function(e){return function(t){return(0,i.zG)(t,function(e){return function(t){if(f(t))return ue;for(var n=[],r=0;r<t.length;r++)n.push.apply(n,e(r,t[r]));return n}}((function(t,n){return e(n)})))}},T=A(i.yR),M=function(e){return function(t){return t.map((function(t){return e(t)}))}},j=function(e){return function(t){return t.map((function(t,n){return e(n,t)}))}},L=function(e){for(var t=[],n=[],r=0,i=e;r<i.length;r++){var s=i[r];"Left"===s._tag?t.push(s.left):n.push(s.right)}return(0,l.s4)(t,n)},F=function(e){return function(t){return t.filter(e)}},$=function(e){return function(t){for(var n=[],r=0;r<t.length;r++){var i=e(r,t[r]);o.pC(i)&&n.push(i.value)}return n}},B=function(e){return $((function(t,n){return e(n)}))},N=B(i.yR),Q=function(e){return Y((function(t,n){return e(n)}))},Y=function(e){return function(t){for(var n=[],r=[],i=0;i<t.length;i++){var s=t[i];e(i,s)?r.push(s):n.push(s)}return(0,l.s4)(n,r)}},K=function(e){return function(t){return function(n){return n.reduce((function(n,r,i){return e.concat(n,t(i,r))}),e.empty)}}},W=function(e,t){return V(e,(function(e,n,r){return t(n,r)}))},H=function(e){var t=K(e);return function(e){return t((function(t,n){return e(n)}))}},V=function(e,t){return function(n){for(var r=n.length,i=e,s=0;s<r;s++)i=t(s,i,n[s]);return i}},J=function(e,t){return Z(e,(function(e,n,r){return t(n,r)}))},Z=function(e,t){return function(n){return n.reduceRight((function(e,n,r){return t(r,n,e)}),e)}},X=function(e){return function(t){return q(t,e.of(R()),(function(t,n){return e.ap(e.map(t,(function(e){return function(t){return(0,i.zG)(e,p(t))}})),n)}))}},ee="ReadonlyArray",te=function(e){return{show:function(t){return"[".concat(t.map(e.show).join(", "),"]")}}},ne=function(){return{concat:function(e,t){return f(e)?t:f(t)?e:e.concat(t)},empty:ue}},re=function(e){return(0,r.f7)((function(t,n){return t.length===n.length&&t.every((function(t,r){return e.equals(t,n[r])}))}))},ie=function(e){return(0,c.Zt)((function(t,n){for(var r=t.length,i=n.length,s=Math.min(r,i),o=0;o<s;o++){var c=e.compare(t[o],n[o]);if(0!==c)return c}return a.Df.compare(r,i)}))},se={URI:ee,map:D},oe=function(e){return function(t){for(var n=d([],e(t),!0),r=[];n.length>0;){var i=n.shift();o.nM(i)?n.unshift.apply(n,e(i.left)):r.push(i.right)}return r}},ae=function(e){return function(t){var n=e(t),r=[],i=[];function s(t){o.nM(t)?e(t.left).forEach((function(e){return r.push(e)})):i.push(t.right)}for(var a=0,c=n;a<c.length;a++){s(c[a])}for(;r.length>0;)s(r.shift());return i}},ce=(u.oo,function(e){return f(e)?ue:e.slice()}),ue=u.cS;function le(e){return function(t){return t.every(e)}}var de=function(e){return function(t){return t.some(e)}},fe=function(e){var t=u.j0(e);return function(n){return h((function(){return e.empty}),t(n))}},ge=(o.F4,(0,s.YO)(se)),pe=(0,s.Hr)(se);u.w6,u.QI,u.Ss},817:(e,t,n)=>{n.d(t,{R3:()=>v,Im:()=>m,ur:()=>$,QI:()=>N,cS:()=>d,Lx:()=>z,xP:()=>C,c2:()=>b,Eh:()=>A,ZN:()=>R,vM:()=>I,YM:()=>T,j0:()=>B,Od:()=>f,dC:()=>g,Z$:()=>j,UI:()=>P,Fp:()=>F,VV:()=>L,of:()=>E,Ce:()=>h,ws:()=>p,w6:()=>y,u4:()=>U,nq:()=>D,iw:()=>O,OE:()=>q,Ss:()=>Q,oo:()=>_});var r,i=n(5191),s=n(2275),o=(n(7560),n(7963)),a=n(5586),c=function(e){return{concat:a.VV(e)}},u=function(e){return{concat:a.Fp(e)}};r=void 0;var l=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},d=o.Xl,f=o.Od,g=function(e,t){return e<0||e>=t.length},p=function(e){return function(t){return l([e],t,!0)}},h=p,m=function(e){return function(t){return l(l([],t,!0),[e],!1)}},v=m,_=function(e,t,n){if(f(n)){var r=o.r1(n);return r.splice(e,0,t),r}return[t]},b=function(e){return f(e)?o.G(e):o.YP},w=function(e){return function(t){for(var n=Math.max(0,Math.floor(t)),r=[e(0)],i=1;i<n;i++)r.push(e(i));return r}},y=function(e,t){return e<=t?w((function(t){return e+t}))(t-e+1):[e]};function k(e,t){return t?e.concat(t):function(t){return t.concat(e)}}var I=function(e){return function(t){for(var n={},r=0,i=t;r<i.length;r++){var s=i[r],a=e(s);o.e$.call(n,a)?n[a].push(s):n[a]=[s]}return n}};var S=function(e){return function(t){for(var n=[e,t[0]],r=1;r<t.length;r++)n.push(e,t[r]);return n}},E=o.ri,P=function(e){return G((function(t,n){return e(n)}))},G=function(e){return function(t){for(var n=[e(0,T(t))],r=1;r<t.length;r++)n.push(e(r,t[r]));return n}},U=function(e,t){return q(e,(function(e,n,r){return t(n,r)}))},z=function(e){return function(t){return function(n){return n.slice(1).reduce((function(n,r){return e.concat(n,t(r))}),t(n[0]))}}},D=function(e,t){return O(e,(function(e,n,r){return t(n,r)}))},q=function(e,t){return function(n){return n.reduce((function(e,n,r){return t(r,e,n)}),e)}},C=function(e){return function(t){return function(n){return n.slice(1).reduce((function(n,r,i){return e.concat(n,t(i+1,r))}),t(0,n[0]))}}},O=function(e,t){return function(n){return n.reduceRight((function(e,n,r){return t(r,n,e)}),e)}},x=o.YM,R=function(e){return{show:function(t){return"[".concat(t.map(e.show).join(", "),"]")}}},A=function(e){return(0,i.f7)((function(t,n){return t.length===n.length&&t.every((function(t,r){return e.equals(t,n[r])}))}))},T=(o.F4,x),M=o.Gb,j=function(e){return e[e.length-1]},L=function(e){var t=c(e);return function(e){return e.reduce(t.concat)}},F=function(e){var t=u(e);return function(e){return e.reduce(t.concat)}},$=function(e){return function(t){return t.reduce(e.concat)}},B=function(e){var t=$(e);return function(e){return(0,s.ls)(function(e){return function(t){var n=M(t);return f(n)?(0,s.zG)(n,S(e),h(T(t))):t}}(e),t)}};function N(e,t){return void 0===t?h(e):(0,s.zG)(t,h(e))}var Q=function(e,t){return(0,s.zG)(e,k([t]))}},7054:(e,t,n)=>{n.d(t,{Bu:()=>h,CC:()=>A,DZ:()=>X,EG:()=>p,EW:()=>B,Eh:()=>ce,G:()=>q,HA:()=>O,Hd:()=>P,I8:()=>M,P5:()=>m,RF:()=>T,RJ:()=>L,SW:()=>Q,Su:()=>_,UI:()=>b,Ub:()=>K,V_:()=>$,XP:()=>d,_Y:()=>F,_r:()=>E,dp:()=>c,dx:()=>f,e$:()=>g,hX:()=>Z,jt:()=>G,kp:()=>R,mK:()=>V,mS:()=>j,nn:()=>x,nr:()=>le,nu:()=>N,oA:()=>se,oh:()=>oe,qS:()=>H,ri:()=>I,sq:()=>z,t9:()=>C,tV:()=>te,uK:()=>ee,uZ:()=>ue,vA:()=>W,vP:()=>S,xb:()=>u,yW:()=>D,z7:()=>U,zV:()=>Y});var r=n(5191),i=n(2275),s=n(7963),o=n(4219),a=n(7029),c=(n(6511),function(e){return Object.keys(e).length}),u=function(e){for(var t in e)if(s.e$.call(e,t))return!1;return!0},l=function(e){return function(t){return Object.keys(t).sort(e.compare)}},d=l(a.Df);var f=function(e,t){return function(n){if(s.e$.call(n,e)&&n[e]===t)return n;var r=Object.assign({},n);return r[e]=t,r}},g=function(e,t){return s.e$.call(t,e)};function p(e){return function(t){if(!s.e$.call(t,e))return t;var n=Object.assign({},t);return delete n[e],n}}function h(e){return function(t,n){if(void 0===n){var r=h(e);return function(e){return r(e,t)}}for(var i in t)if(!s.e$.call(n,i)||!e.equals(t[i],n[i]))return!1;return!0}}function m(e,t){return void 0===t?function(t){return m(e,t)}:s.e$.call(t,e)?s.G(t[e]):s.YP}var v={};function _(e){return function(t){var n={};for(var r in t)s.e$.call(t,r)&&(n[r]=e(r,t[r]));return n}}function b(e){return _((function(t,n){return e(n)}))}function w(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(2===e.length)return w(a.Df).apply(void 0,e);var n=l(e[0]);return function(e,t){return function(r){for(var i=e,s=n(r),o=s.length,a=0;a<o;a++){var c=s[a];i=t(c,i,r[c])}return i}}}function y(e){if("compare"in e){var t=l(e);return function(e){return function(n){return function(r){for(var i=e.empty,s=t(r),o=s.length,a=0;a<o;a++){var c=s[a];i=e.concat(i,n(c,r[c]))}return i}}}}return y(a.Df)(e)}function k(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(2===e.length)return k(a.Df).apply(void 0,e);var n=l(e[0]);return function(e,t){return function(r){for(var i=e,s=n(r),o=s.length-1;o>=0;o--){var a=s[o];i=t(a,r[a],i)}return i}}}var I=function(e,t){var n;return(n={})[e]=t,n};function S(e){return V(a.Df)(e)}function E(e){return function(t){var n={},r={};for(var i in t)if(s.e$.call(t,i)){var a=e(i,t[i]);switch(a._tag){case"Left":n[i]=a.left;break;case"Right":r[i]=a.right}}return(0,o.s4)(n,r)}}function P(e){return function(t){var n={},r={};for(var i in t)if(s.e$.call(t,i)){var a=t[i];e(i,a)?r[i]=a:n[i]=a}return(0,o.s4)(n,r)}}function G(e){return function(t){var n={};for(var r in t)if(s.e$.call(t,r)){var i=e(r,t[r]);s.pC(i)&&(n[r]=i.value)}return n}}function U(e){return function(t){var n={},r=!1;for(var i in t)if(s.e$.call(t,i)){var o=t[i];e(i,o)?n[i]=o:r=!0}return r?n:t}}var z=function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n];t[i[0]]=i[1]}return t};function D(e){return function(t){for(var n in t)if(!e(t[n]))return!1;return!0}}function q(e){return function(t){for(var n in t)if(e(t[n]))return!0;return!1}}function C(e){return function(t,n){if(void 0===n){var r=C(e);return function(e){return r(t,e)}}for(var i in n)if(e.equals(n[i],t))return!0;return!1}}var O=function(e,t){return(0,i.zG)(e,b(t))},x=function(e,t){return(0,i.zG)(e,_(t))},R=function(e){var t=ne(e);return function(e,n,r){return(0,i.zG)(e,t(n,r))}},A=function(e){return function(t){var n=re(e)(t);return function(e,t){return(0,i.zG)(e,n(t))}}},T=function(e){var t=ie(e);return function(e,n,r){return(0,i.zG)(e,t(n,r))}},M=function(e,t){return(0,i.zG)(e,Z(t))},j=function(e,t){return(0,i.zG)(e,X(t))},L=function(e,t){return(0,i.zG)(e,ee(t))},F=function(e,t){return(0,i.zG)(e,te(t))},$=function(e){var t=w(e);return function(e,n,r){return(0,i.zG)(e,t(n,r))}},B=function(e){var t=y(e);return function(e){var n=t(e);return function(e,t){return(0,i.zG)(e,n(t))}}},N=function(e){var t=k(e);return function(e,n,r){return(0,i.zG)(e,t(n,r))}},Q=function(e,t){return(0,i.zG)(e,E(t))},Y=function(e,t){return(0,i.zG)(e,P(t))},K=function(e,t){return(0,i.zG)(e,G(t))},W=function(e,t){return(0,i.zG)(e,U(t))},H=function(e){var t=J(e);return function(e){var n=t(e);return function(e,t){return n(e,(0,i.ls)(i.SK,t))}}},V=function(e){var t=H(e);return function(e){var n=t(e);return function(e){return n(e,i.yR)}}},J=function(e){return function(t){var n=l(e);return function(e,r){var i=n(e);if(0===i.length)return t.of(v);for(var s=t.of({}),o=function(n){s=t.ap(t.map(s,(function(e){return function(t){var r;return Object.assign({},e,((r={})[n]=t,r))}})),r(n,e[n]))},a=0,c=i;a<c.length;a++){o(c[a])}return s}}},Z=function(e){return U((function(t,n){return e(n)}))},X=function(e){return G((function(t,n){return e(n)}))},ee=function(e){return P((function(t,n){return e(n)}))},te=function(e){return E((function(t,n){return e(n)}))};function ne(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){var n=w(e[0]);return function(e,t){return n(e,(function(e,n,r){return t(n,r)}))}}return ne(a.Df).apply(void 0,e)}function re(e){if("compare"in e){var t=y(e);return function(e){var n=t(e);return function(e){return n((function(t,n){return e(n)}))}}}return re(a.Df)(e)}function ie(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){var n=k(e[0]);return function(e,t){return n(e,(function(e,n,r){return t(n,r)}))}}return ie(a.Df).apply(void 0,e)}var se=function(e){var t={};for(var n in e)if(s.e$.call(e,n)){var r=e[n];s.pC(r)&&(t[n]=r.value)}return t},oe=function(e){var t={},n={};for(var r in e)if(s.e$.call(e,r)){var i=e[r];s.nM(i)?t[r]=i.left:n[r]=i.right}return(0,o.s4)(t,n)},ae="ReadonlyRecord";function ce(e){var t=h(e);return(0,r.f7)((function(e,n){return t(e)(n)&&t(n)(e)}))}function ue(e){return{concat:function(t,n){if(u(t))return n;if(u(n))return t;var r=Object.assign({},t);for(var i in n)s.e$.call(n,i)&&(r[i]=s.e$.call(t,i)?e.concat(t[i],n[i]):n[i]);return r},empty:v}}a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df;function le(e,t){return s.e$.call(void 0===t?this:t,e)}a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df},1586:(e,t,n)=>{n.d(t,{H5:()=>a,Pd:()=>s,Yg:()=>i,li:()=>r,pL:()=>o});n(2275);function r(e){return e[0]}function i(e){return e[1]}var s=function(e,t){return function(n){return[t(r(n)),e(i(n))]}},o=function(e){return function(t){return[e(r(t)),i(t)]}},a=function(e){return function(t){return[r(t),e(i(t))]}}},5326:(e,t,n)=>{n.d(t,{UI:()=>a,XP:()=>o});var r=n(7054),i=n(7029),s=(n(6511),r.dp,r.xb,function(e){return function(t){return Object.keys(t).sort(e.compare)}}),o=s(i.Df);r.dx,r.e$;r.Bu,r.P5,r.Su;var a=r.UI;r.ri;function c(e){return r.vP(e)}r._r;r.jt;r.yW,r.G,r.t9;var u=r.HA,l=(r.nn,r.kp),d=r.CC,f=r.RF,g=(r.I8,r.mS,r.RJ,r._Y,r.V_),p=r.EW,h=r.nu,m=(r.SW,r.zV,r.Ub,r.vA,r.qS),v=(r.mK,function(e){return function(t){var n=s(e);return function(e,r){var i=n(e);if(0===i.length)return t.of({});for(var s=t.of({}),o=function(n){s=t.ap(t.map(s,(function(e){return function(t){return e[n]=t,e}})),r(n,e[n]))},a=0,c=i;a<c.length;a++){o(c[a])}return s}}});r.hX,r.DZ,r.uK,r.tV;r.oA,r.oh;var _="Record";r.Eh,r.uZ,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,r.nr,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df,i.Df},3940:(e,t,n)=>{n.d(t,{ff:()=>r});var r=function(e){return function(t){return!e(t)}}},4219:(e,t,n)=>{n.d(t,{Pd:()=>i,s4:()=>r});n(2275);var r=function(e,t){return{left:e,right:t}},i=function(e,t){return function(n){return r(e(s(n)),t(o(n)))}},s=function(e){return e.left},o=function(e){return e.right}},8940:(e,t,n)=>{n.d(t,{At:()=>P,Hi:()=>w,PM:()=>b,Qt:()=>z,UA:()=>I,UI:()=>g,YO:()=>G,ak:()=>U,ap:()=>p,dO:()=>_,mU:()=>S,of:()=>h,pE:()=>x,qA:()=>y,qo:()=>k,tD:()=>u,tS:()=>m,uU:()=>O});var r=n(2925),i=n(8543),s=n(1395),o=n(2275),a=n(7560),c=n(7963),u=function(e){return function(){return Promise.resolve().then(e)}};var l=function(e,t){return(0,o.zG)(e,g(t))},d=function(e,t){return(0,o.zG)(e,p(t))},f=function(e,t){return(0,o.zG)(e,m(t))},g=function(e){return function(t){return function(){return Promise.resolve().then(t).then(e)}}},p=function(e){return function(t){return function(){return Promise.all([Promise.resolve().then(t),Promise.resolve().then(e)]).then((function(e){return(0,e[0])(e[1])}))}}},h=function(e){return function(){return Promise.resolve(e)}},m=function(e){return function(t){return function(){return Promise.resolve().then(t).then((function(t){return e(t)()}))}}},v="Task";var _={URI:v,map:l},b={URI:v,of:h},w={URI:v,map:l,ap:d},y={URI:v,map:l,ap:d,of:h},k={URI:v,map:l,ap:d,chain:f},I={URI:v,map:l,of:h,ap:d,chain:f},S=(o.yR,(0,i.m)(k)),E={URI:v,fromIO:u},P=(0,s.At)(E,k),G=(c.F4,(0,a.YO)(_)),U=(0,i.a)(k),z=(0,r.Qt)(w),D=h(c.Xl),q=function(e){var t=function(e){return function(t){return function(){return Promise.all(t.map((function(t,n){return Promise.resolve().then((function(){return e(n,t)()}))})))}}}(e);return function(e){return c.Od(e)?t(e):D}},C=function(e){var t=function(e){return function(t){return function(){return c.Gb(t).reduce((function(t,n,r){return t.then((function(t){return Promise.resolve().then(e(r+1,n)).then((function(e){return t.push(e),t}))}))}),Promise.resolve().then(e(0,c.YM(t))).then(c.ri))}}}(e);return function(e){return c.Od(e)?t(e):D}},O=function(e){return q((function(t,n){return e(n)}))},x=function(e){return C((function(t,n){return e(n)}))}},9246:(e,t,n)=>{n.d(t,{Do:()=>ee,Qt:()=>re,ak:()=>ne,tS:()=>M,fX:()=>W,At:()=>J,wE:()=>X,Zl:()=>j,Y$:()=>H,Uo:()=>k,tD:()=>w,fF:()=>y,fS:()=>E,t$:()=>h,Hr:()=>te,UI:()=>x,Vn:()=>A,EQ:()=>I,LV:()=>S,of:()=>F,vx:()=>G,F2:()=>m,Ij:()=>ie,Y3:()=>P});var r=n(2925),i=n(8543),s=n(1890),o=n(5162),a=n(1395),c=n(2275);function u(e,t){return function(n){var r=(0,c.ls)(n,e.fromTask);return function(e){return t.chain(e,r)}}}var l=n(7560),d=n(7963),f=n(8940),g=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},p=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},h=s.t$(f.PM),m=s.F2(f.PM),v=s.m8(f.dO),_=s.pk(f.dO),b=(0,c.ls)(f.tD,v),w=(f.tD,b),y=v,k=f.of,I=(f.tD,s.EQ(f.dO)),S=s.LV(f.UA),E=s.fS(f.UA),P=function(e,t){return function(){return g(void 0,void 0,void 0,(function(){var n;return p(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e().then(d.F2)];case 1:return[2,r.sent()];case 2:return n=r.sent(),[2,d.t$(t(n))];case 3:return[2]}}))}))}},G=(f.dO,f.PM,f.PM,f.UA,s.vx(f.UA)),U=(f.UA,f.UA,f.dO,function(e,t){return(0,c.zG)(e,x(t))}),z=function(e,t){return(0,c.zG)(e,T(t))},D=function(e,t){return(0,c.zG)(e,M(t))},q=function(e,t,n){return(0,c.zG)(e,R(t,n))},C=function(e,t){return(0,c.zG)(e,A(t))},O=function(e,t){return(0,c.zG)(e,L(t))},x=s.UI(f.dO),R=s.Pd(f.dO),A=s.Vn(f.dO),T=s.ap(f.Hi),M=s.tS(f.UA),j=M,L=s.wp(f.UA),F=m,$=h,B="TaskEither";var N={URI:B,map:U},Q={URI:B,map:U,ap:z},Y={URI:B,map:U,ap:z,chain:D},K={URI:B,fromEither:k},W=(0,o.fX)(K,Y),H=(0,o.Y$)(K,Y),V={URI:B,fromIO:w},J=(0,a.At)(V,Y),Z={URI:B,fromIO:w,fromTask:y},X=u(Z,Y);var ee=F(d.F4),te=(0,l.Hr)(N),ne=(0,i.a)(Y),re=(0,r.Qt)(Q),ie=(d.Xl,{URI:B,bimap:q,mapLeft:C,map:U,of:F,ap:z,chain:D,alt:O,fromIO:w,fromTask:y,throwError:$})},6511:(e,t,n)=>{function r(e,t){return function(n){var r=e.traverse(n);return function(e,i){return n.map(r(e,i),t.separate)}}}function i(e,t){return function(n){var r=e.traverse(n);return function(e,i){return n.map(r(e,i),t.compact)}}}n.d(t,{BL:()=>i,Fj:()=>r})},2275:(e,t,n)=>{n.d(t,{MZ:()=>i,Q1:()=>u,SK:()=>g,W8:()=>o,a9:()=>s,bc:()=>d,gn:()=>a,ls:()=>l,r5:()=>c,yR:()=>r,zG:()=>f});function r(e){return e}var i=r;function s(e){return function(){return e}}var o=s(!0),a=s(null),c=s(void 0),u=c;function l(e,t,n,r,i,s,o,a,c){switch(arguments.length){case 1:return e;case 2:return function(){return t(e.apply(this,arguments))};case 3:return function(){return n(t(e.apply(this,arguments)))};case 4:return function(){return r(n(t(e.apply(this,arguments))))};case 5:return function(){return i(r(n(t(e.apply(this,arguments)))))};case 6:return function(){return s(i(r(n(t(e.apply(this,arguments))))))};case 7:return function(){return o(s(i(r(n(t(e.apply(this,arguments)))))))};case 8:return function(){return a(o(s(i(r(n(t(e.apply(this,arguments))))))))};case 9:return function(){return c(a(o(s(i(r(n(t(e.apply(this,arguments)))))))))}}}function d(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e}function f(e,t,n,r,i,s,o,a,c){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return n(t(e));case 4:return r(n(t(e)));case 5:return i(r(n(t(e))));case 6:return s(i(r(n(t(e)))));case 7:return o(s(i(r(n(t(e))))));case 8:return a(o(s(i(r(n(t(e)))))));case 9:return c(a(o(s(i(r(n(t(e))))))));default:for(var u=arguments[0],l=1;l<arguments.length;l++)u=arguments[l](u);return u}}var g=function(e,t){return t}},7963:(e,t,n)=>{n.d(t,{F2:()=>d,F4:()=>v,G:()=>a,Gb:()=>h,Od:()=>g,Wi:()=>i,Xl:()=>m,YM:()=>p,YP:()=>o,e$:()=>_,nM:()=>c,pC:()=>s,r1:()=>b,ri:()=>f,t$:()=>l,tO:()=>u});var r=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},i=function(e){return"None"===e._tag},s=function(e){return"Some"===e._tag},o={_tag:"None"},a=function(e){return{_tag:"Some",value:e}},c=function(e){return"Left"===e._tag},u=function(e){return"Right"===e._tag},l=function(e){return{_tag:"Left",left:e}},d=function(e){return{_tag:"Right",right:e}},f=function(e){return[e]},g=function(e){return e.length>0},p=function(e){return e[0]},h=function(e){return e.slice(1)},m=[],v={},_=Object.prototype.hasOwnProperty,b=function(e){return r([e[0]],e.slice(1),!0)}},6627:(e,t,n)=>{n.d(t,{Df:()=>i,Eq:()=>r});var r={equals:function(e,t){return e===t}},i={equals:r.equals,compare:function(e,t){return e<t?-1:e>t?1:0}};r.equals,i.compare},7029:(e,t,n)=>{n.d(t,{Df:()=>i,Eq:()=>r,pn:()=>o,xb:()=>s});var r={equals:function(e,t){return e===t}},i={equals:r.equals,compare:function(e,t){return e<t?-1:e>t?1:0}},s=function(e){return 0===e.length},o=function(e,t){return function(n){return n.endsWith(e,t)}}},3092:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(1005),i=n.n(r);function s(){return i()('/*! @permutive/javascript-sdk v20.23.0 (web) (built 2024-11-22T20:07:57.948Z) */(()=>{"use strict";var __webpack_modules__={865:(e,t,n)=>{function r(e){return e instanceof Error?e:new Error("string"==typeof e?e:JSON.stringify(e))}n.d(t,{w:()=>r})},238:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{N:()=>runtimeFactory});const runtimeFactory=deps=>{const{provideEnvironment,...lookups}=generateLookupMethods(deps.runtimeInput),env=generateRuntimeEnvironment({lookups,hash:deps.hash});return provideEnvironment(env),{env,locallyLiftedQueries:deps.runtimeInput.queries(env)||{},cloudLiftedQueries:"function"==typeof deps.runtimeInput.interpretOnlyQueries?deps.runtimeInput.interpretOnlyQueries(env):{},queriesByEvent:deps.runtimeInput.eventSegments(env)||{},createCloudLiftQueries:cloudLiftQueries=>{const createQueries=eval?.(`"use strict";${cloudLiftQueries}`);return createQueries(env)}}};function generateRuntimeEnvironment(e){const t=e=>()=>{throw new Error(`${e} lookup has not been provided`)};let n=t("events"),r=t("literals"),i=t("properties"),s=t("ahoCorasick"),o=t("subexpressions"),a=t("rootCompression");function c(e){return u(e)&&!l(e)}function u(e){return Boolean(e&&"object"==typeof e&&!Array.isArray(e))}function l(e){for(const t in e)return!1;return!0}function f(e){return(t,n)=>{const r=null!=t&&null!=n?e(t,n):t||n;return null==r||u(r)&&l(r)?null:r}}function d(e,t,n=g){const r=i(t).reduce((function(e,t){return e&&null!=e[t]?e[t]:null}),e);return null===r?null:n(r)}function p(e,t,n=g){return e.properties?d(e.properties,t,n):null}e.lookups.onReady((e=>{const{ahoCorasick:t,events:c,literals:u,properties:l,subexpressions:f,rootCompression:d}=e;n=e=>"number"==typeof e?c[e]:e,r=e=>"number"==typeof e?u[e]:e,i=e=>"number"==typeof e?l[e]:e,s=e=>t[e],o=e=>f[e],a=e=>d[e]}));let g=e=>e,h=e=>!0;function m(e,t){return function(n){for(let r=0;r<e.length;r++){if((e[r](n)||!1)===t)return t}return!t}}function v(e){return m(e,!0)}function b(e){return m(e,!1)}let w=e=>t=>!e(t),_=(e,t)=>n=>n>=e&&n<=t,y=e=>new Date(e).getTime(),S=e=>d(e,["time"],y),I=(e,t)=>d(t,e,y),k=(e,t,n,r,i,s)=>o=>{const a=d(o,e,(e=>e.filter(r).map((e=>d(e,t))).reduce(i,s)));return n(null===a?s:a)};function G(e,t,n,r){for(const i of e)if(n(i)&&t(i)===r)return r;return!r}let z=e=>t=>("string"==typeof e||"number"==typeof e)&&"string"==typeof t&&t.toLowerCase().indexOf(r(e).toLowerCase())>-1,q=e=>t=>null!=t&&Array.isArray(t)&&t.indexOf(e)>=0;const U=(e,t)=>({l:r=>d(r,["name"])===n(e)&&t(r)?["p",1]:null,a:(e,t)=>["p",e[1]+t[1]],i:e=>e?Array.isArray(e)?e.slice(-1)[0]:e:0,c:e=>Array.isArray(e)&&e[1]?e:null});function E(e,t,n,r,i){const s=d(e.getSegments(),[t,n])||!1;return i&&(r||s)&&e.setSegmentActivation(t,n,i),s}function P(e,t,n){return d(e.getSegments(),[t,n])||!1}function x(e,t,n=18e5){return r=>{function i(e,t,n){if(c(t)){if(c(n)){const r={...t,...n};for(const i in n)if(t[i]){const o=s(e,t[i],n[i]);null!=o&&(r[i]=o)}return r}return t}return n}function s(e,t,n){if(c(t)){if(c(n)){const i={...t,...n};for(const s in n)if(t[s]){const o=Array.isArray(t[s])?[e,...t[s]]:[e,t[s]],a=Array.isArray(n[s])?[e,...n[s]]:[e,n[s]],c=r.d.a(o,a);if(null!=c){const[e,...t]=c;i[s]=t}}return i}return t}return n}const o=e=>Array.isArray(e)&&"object"==typeof e[3];return{a:{m:(e,t)=>[t[0],r.a.m(null!=e[0]&&e[0][0]===t[0][0]?e[1]:r.a.z,t[1])],z:[[],r.a.z]},p:(n,i)=>[[e(n)],d(i,t)===e(n)?r.p(n,i):r.a.z],r:(t,n)=>r.r(t,0!==n[0].length&&n[0][0]===e(t)?n[1]:r.a.z),d:r.d.sq||{a:(e,t)=>{if(!o(e))return o(t)?t:null;if(!o(t))return o(e)?e:null;const[n,,,r]=e;return[n,"u",null,i(n,r,t[3])]},l:(i,s)=>{let o=d(i,t),a=e(s);if(o!==a)return null;let c=r.d.l(i,s);if(!(Array.isArray(c)&&c.length>1))return null;let[u,...l]=c,f=+(S(i)||s.getCurrentTime()),p=Math.floor(f/n),g={};return g[p]={},g[p][a]=1===l.length?l[0]:l,[u,"u",null,g]},i:(t,n)=>{if(!o(t))return[[],r.a.z];let i=e(n),s=t[3];return[[i],Object.keys(s).map((e=>s[e][i])).filter((e=>e)).map((e=>r.d.i([t[0]].concat(e)))).reduce(r.a.m,r.a.z)]},c:g}}}}let O=x((e=>e.getCurrentSession()),["session_id"],18e5),D=x((e=>e.getCurrentView()),["view_id"],3e5);function A(e,t,r,i=1){return{a:{m:(e,t)=>e.concat(t).slice(-r),z:[]},p:(r,i)=>d(i,["name"])===n(t)?[e.p(r,i)]:[],r:(t,n)=>e.r(t,n.reduce(((t,n)=>e.a.m(t,n)),e.a.z)),d:e.d.ftn||{a:(e,t)=>{const n=Object.entries({...e[3],...t[3]}).sort((([e],[t])=>Number(e)-Number(t))).slice(-r);return[e[0],e[1],null,Object.fromEntries(n)]},l:(t,n)=>{const s=e.d.l(t,n),o=d(t,["time"],y)*i;return s&&[s[0],"x"+r,null,{[o]:2==s.length?s[1]:s.slice(1)}]},i:(t,n)=>t?Object.keys(t[3]||{}).sort().reverse().map((e=>Array.isArray(e)?[t[0],...t[3][e]]:[t[0],t[3][e]])).map((t=>e.d.i(t,n))):[],c:g}}}let C=(e,t)=>null==e?null==t?null:{b:t}:null==t?{a:e}:{a:e,b:t};function T(e,t){return n=>{if(!n||null==n.a&&null==n.b)return null;const r=null==n.a?void 0:e.d.c(n.a)??void 0,i=null==n.b?void 0:t.d.c(n.b)??void 0;return r===n.a&&i===n.b?n:C(r,i)}}function M(e,t){return{a:(n,r)=>{const i=null!=n.a&&null!=r.a?e.d.a(n.a,r.a):n.a||r.a,s=null!=n.b&&null!=r.b?t.d.a(n.b,r.b):n.b||r.b;return C(i,s)},l:(n,r)=>C(e.d.l(n,r),t.d.l(n,r)),i:(n,r)=>n?[e.d.i(n.a||null,r),t.d.i(n.b||null,r)]:[e.a.z,t.a.z],c:T(e,t)}}function j(e,t,n,r){let i=e,s=t.map(n),o=(e,n)=>r(t[e])(n);for(let e=t.length-1;e>0&&i;e--)i.b&&(s[e]=o(e,i.b)),i.a&&1===e&&(s[0]=o(0,i.a)),i=i.a;return s}const R=e=>(t,n=e.length-1)=>{if(!t||null==t.a&&null==t.b)return null;const r=e[n];if(!r)return null;if(1===n)return T(e[0],r)(t);const i=null==t.a?void 0:R(e)(t.a,n-1)??void 0,s=null==t.b?void 0:r.d.c(t.b)??void 0;return i===t.a&&s===t.b?t:C(i,s)};let F=e=>t=>{function n(e){let t=e[0];for(let n=1;n<e.length;n++)t=[t,e[n]];return t}function r(e){let n=e,r=Array(t.length);for(let e=t.length-1;e>0;e--)r[e]=n[1],n=n[0];return r[0]=n,r}function i(e,n,r=t.length-1){if(0==r)throw new Error("subquery index out of bounds.");const s=(1==r?f(t[0].d.a)(e?.a,n?.a):i(e?.a,n?.a,r-1))||void 0,o=f(t[r].d.a)(e?.b,n?.b)||void 0;return C(s,o)}return{p:(e,r)=>n(t.map((t=>t.p(e,r)))),r:(n,i)=>{const s=r(i);return e(t.map(((e,t)=>()=>e.r(n,s[t]))))({})},a:{z:n(t.map((e=>e.a.z))),m:(e,i)=>{const s=r(e),o=r(i);return n(t.map(((e,t)=>function(e,t,n){return null===t?n:null===n?t:e.a.m(t,n)}(e,s[t],o[t]))))}},d:{a:(e,n)=>1==t.length?f(t[0].d.a)(e,n):i(e,n),l:(e,n)=>function(e){let t=e[0];for(let n=1;n<e.length;n++)t=C(t,e[n]);return t}(t.map((t=>t.d.l(e,n)))),i:(e,r)=>((e,r)=>n(j(e,t,(e=>e.a.z),(e=>t=>e.d.i(t,r)))))(e,r),c:R(t)}}},Q=F(v),L=F(b);let N=e=>t=>({d:{i:(n,r)=>e(j(n,t,(e=>e.d.i(null,r)),(e=>t=>e.d.i(t,r))).map((e=>t=>e)))({}),c:R(t)}}),Y=N(b),$=N(v);function B(e,t){let n=s(e);if(!t||!n)return!1;if(!n.length)return!0;let r=0,i=!1,o=(e=>{let t=[];for(let n=0;n<e.length;++n){let r=e.charCodeAt(n);if(r>=55296&&r<=56319){let r=e.charCodeAt(n+1);if(r>=56320&&r<=57343){t.push(e.slice(n,n+2)),++n;continue}}t.push(e.charAt(n))}return t})(t.toLowerCase());for(let e=0;e<o.length;e++){let t=o[e];for(;r>0&&!n[r][t];)r=n[r].su?n[r].su:0;if(n[r][t]&&(r=n[r][t],i=!!n[r].te,i))break}return i}let H=(t,n)=>{let r,i,s=e.hash(t);if(0===n.length)return!1;if(n[0]===s)return!0;let o=0,a=n.length,c=!1;for(;(c=(r=n[i=o+(a-o>>1)])!==s)&&(r<s?o=i:a=i,!(o>=a-1)););return!c},V=(e,t)=>n=>H(d(n,e),t),K=(e,t)=>n=>H(p(n,e),t);return{q:function(e){return{lift:(t,n)=>e.d.l(t,n),append:f(e.d.a),interpret:(t,n)=>((t,n)=>({result:e.r(t,n)}))(n,e.d.i(t,n)),compact:e.d.c,migrate:g,m:e.a.m,z:e.a.z,p:e.p,r:e.r,i:e.d.i}},i_q:function(e){return{interpret:(t,n)=>({result:e.d.i(t,n)}),compact:e.d.c}},a:b,acq:function(e,t){return{p:(n,r)=>[e.p(n,r),t.p(n,r)],r:(n,r)=>e.r(n,r[0])&&t.r(n,r[1]),a:{z:[e.a.z,t.a.z],m:(n,r)=>[e.a.m(n[0],r[0]),t.a.m(n[1],r[1])]},d:M(e,t)}},acqs:L,acs:B,acs_:(e,t)=>n=>B(t,d(n,e)),af_i:(e,t,n=h)=>r=>d(r,e,(e=>G(e,t,n,!1)))&&!0,af_l:(e,t,n=h)=>r=>{const i=d(r,e,(e=>e.filter(n).length));return t(null===i?0:i)},af_m:(e,t,n,r=h)=>i=>{const s=d(i,e,(e=>e.filter(r)));return null===s||0===s.length?n(0):n(s.map((e=>d(e,t))).reduce(((e,t)=>e+t),0)/s.length)},af_n:(e,t,n,r=h)=>k(e,t,n,r,((e,t)=>Math.min(e,t)),Number.POSITIVE_INFINITY),af_p:(e,t,n,r=h)=>k(e,t,n,r,((e,t)=>e*t),1),af_s:(e,t,n,r=h)=>k(e,t,n,r,((e,t)=>e+t),0),af_u:(e,t,n=h)=>r=>d(r,e,(e=>G(e,t,n,!0)))||!1,af_x:(e,t,n,r=h)=>k(e,t,n,r,((e,t)=>Math.max(e,t)),Number.NEGATIVE_INFINITY),as:(e,t,n)=>r=>{const i=p(r,t),s=n.length;let o=!0;for(let t=0;t<s;t++){const r=n[t];if(o=e(r)(i),!o)break}return o},c:q,c_:(e,t)=>n=>q(t)(d(n,e)),cl_:(e,t)=>n=>q(r(t))(d(n,e)),cx:e=>t=>q(r(e))(t),cw:function(e,t,r=g){return{a:{m:(e,t)=>e+t,z:0},p:(r,i)=>d(i,["name"])===n(e)&&t(i)?1:0,r:(e,t)=>r(t),d:U(e,t)}},cb:function(e,t,r,i){return{a:{m:(e,t)=>Math.min(e+t,i),z:0},p:(r,i)=>d(i,["name"])===n(e)&&t(i)?1:0,r:(e,t)=>r(t),d:{l:r=>d(r,["name"])===n(e)&&t(r)?[`b${i}p`,1]:null,a:(e,t)=>[`b${i}p`,Math.min(e[1]+t[1],i)],i:e=>e?Array.isArray(e)?e.slice(-1)[0]:e:0,c:e=>Array.isArray(e)&&e[1]?e:null}}},e:e=>t=>t===e,e_:(e,t)=>n=>d(n,e)===t,fm:function(e,t){return{p:t.p,r:(n,r)=>e(t.r(n,r)),a:t.a,d:t.d}},frontDecode:function(e){const t=e.split("\\t");if(0===t.length)return[];var n=t[0],r=new Array(Math.ceil(t.length/2));r[0]=t[0];for(var i=1;i<t.length/2;i+=1){const e=t[2*i-1],s=t[2*i];if(""===e)n=s;else{const t=parseInt(e);n=n.slice(0,t)+s}r[i]=n}return r},ftn:function(e,t,r){return{a:{m:(e,t)=>e.concat(t.slice(0,r-e.length)),z:[]},p:(r,i)=>d(i,["name"])===n(t)?[e.p(r,i)]:[],r:(t,n)=>e.r(t,n.reduce(((t,n)=>e.a.m(t,n)),e.a.z)),d:A(e,t,r,-1).d}},g:e=>t=>t>e,g_:(e,t)=>n=>d(n,e)>t,ge:e=>t=>t>=e,ge_:(e,t)=>n=>d(n,e)>=t,bse:(t,n)=>r=>{let i=d(r,t);return e.hash(i)===n},bsne:(t,n)=>r=>{let i=d(r,t);return e.hash(i)!==n},bsc:V,bsnc:(e,t)=>w(V(e,t)),bsc_:K,bsnc_:(e,t)=>w(K(e,t)),i_:g,ifp:function(e){return{a:{m:(e,t)=>t,z:null},p:e=>null,r:(t,n)=>(t=>P(t,"1p",e))(t),d:{a:(e,t)=>null,l:(e,t)=>null,i:e=>null,c:e=>null}}},isp:function(e,t,n,r){return{a:{m:(e,t)=>t,z:!1},p:(n,r)=>P(n,e,t),r:(i,s)=>E(i,e,t,n,r),d:{a:(e,t)=>null,l:(e,t)=>null,i:e=>Array.isArray(e)&&(!!+e[2]||!1),c:g}}},itp:function(e,t,n,r){return{a:{m:(e,t)=>t,z:!1},p:(n,r)=>P(n,e,t),r:(i,s)=>E(i,e,t,n,r),d:{a:(e,t)=>null,l:(e,t)=>null,i:e=>Array.isArray(e)&&(!!+e[2]||!1),c:g}}},i_cw:function(e){return{d:{i:t=>{let n=t?Array.isArray(t)?t.slice(-1)[0]:t:0;return e(n)},c:e=>Array.isArray(e)&&e[1]?e:null}}},i_acqs:Y,i_ocqs:$,i_tw:function(e,t,n){const r=n||100,i=Math.ceil(t/r);return{d:{i:(n,r)=>{const s=Array.isArray(n)?n:[],o=r.getCurrentTime(),a=(c=o.getTime()-t,Math.floor(c/i));var c;const u=Object.keys(s[3]||{}).reduce(((e,t)=>parseInt(t)>=a?s[3][t]+e:e),0);return e.d.i(["p",u],r)},c:g}}},i_ltn:function(e,t,n=1){return{d:{i:(t,n)=>{const r=Array.isArray(t)?t:[],i=Object.keys(r[3]||{}).reduce(((e,t)=>r[3][t]+e),0);return e.d.i(["p",i],n)},c:g}}},k:d,l:e=>t=>t<e,l_:(e,t)=>n=>{const r=d(n,e);return null!==r&&r<t},le:e=>t=>t<=e,le_:(e,t)=>n=>{const r=d(n,e);return null!==r&&r<=t},lm:function(e,t){let n=t=>function(e,t,n){if(void 0===t[n])return NaN;const r=e||{};if(0==(r["1p"]||[]).length)return NaN;const i=t[n]||{};let s=(i["1p"]||{}).const||0;return Object.keys(r).forEach((e=>{r[e].forEach((t=>{const n=(i[e]||{})[t]||0;s+=n}))})),o=s,1/(1+Math.pow(Math.E,-o));var o}(t.getSegmentsArray(),t.getLookalikeModels(),e);return{a:{m:(e,t)=>t,z:null},p:e=>null,r:(e,r)=>t(n(e)),d:{a:(e,t)=>null,l:(e,t)=>null,i:e=>null,c:e=>null}}},ltn:A,mnw:function(e,t,r,i=g){const s=Number.POSITIVE_INFINITY;return{a:{m:(e,t)=>e<t?e:t,z:s},p:(i,o)=>d(o,["name"])===n(e)&&t(o)?d(o,r):s,r:(e,t)=>i(t),d:{a:(e,t)=>e[1]<t[1]?e:t,l:i=>d(i,["name"])===n(e)&&t(i)?["n",d(i,r)]:null,i:e=>e?Array.isArray(e)?e.slice(-1)[0]:e:s,c:e=>Array.isArray(e)&&e[1]!==s?e:null}}},mxw:function(e,t,r,i=g){const s=Number.NEGATIVE_INFINITY;return{a:{m:(e,t)=>e>t?e:t,z:s},p:(i,o)=>d(o,["name"])===n(e)&&t(o)?d(o,r):s,r:(e,t)=>i(t),d:{l:i=>d(i,["name"])===n(e)&&t(i)?["v",d(i,r)]:null,a:(e,t)=>e[1]>t[1]?e:t,i:e=>e?Array.isArray(e)?e.slice(-1)[0]:e:s,c:e=>Array.isArray(e)&&e[1]!==s?e:null}}},n0:w(g),n:e=>t=>t!==e,nt:w,n_:(e,t)=>n=>d(n,e)!==t,o:v,ocq:function(e,t){return{p:(n,r)=>[e.p(n,r),t.p(n,r)],r:(n,r)=>e.r(n,r[0])||t.r(n,r[1]),a:{z:[e.a.z,t.a.z],m:(n,r)=>[e.a.m(n[0],r[0]),t.a.m(n[1],r[1])]},d:M(e,t)}},ocqs:Q,oe:function(e){const t=Object.keys(e);let n=t.length,r=new Array(n);for(;n--;)r[n]=[t[n],e[t[n]]];return r},os:(e,t,n)=>r=>{const i=p(r,t),s=n.length;let o=!1;for(let t=0;t<s;t++){const r=n[t];if(o=e(r)(i),o)break}return o},pacs:(e,t)=>n=>B(t,p(n,e)),pb:(e,t,n)=>r=>_(t,n)(p(r,e)),pc:(e,t)=>n=>{const r=p(n,e);return null!=r&&Array.isArray(r)&&r.indexOf(t)>=0},pc_:(e,t)=>n=>{const i=p(n,e),s=r(t);return null!=i&&Array.isArray(i)&&i.indexOf(s)>=0},pe:(e,t)=>n=>p(n,e)===t,pg:(e,t)=>n=>p(n,e)>t,pge:(e,t)=>n=>p(n,e)>=t,pl:(e,t)=>n=>{let r=p(n,e);return null!==r&&r<t},ple:(e,t)=>n=>{let r=p(n,e);return null!==r&&r<=t},pn:(e,t)=>n=>p(n,e)!==t,ps:(e,t)=>n=>z(t)(p(n,e)),r:function(e,...t){return a(e)(...t)},ref:function(e){return t=>o(e)(t)},rle:function(e){let t=0;for(let n=0;n<e.length;n++){let r=e[n];"number"==typeof r?(t+=r,n+=1):t+=1}let n=Array(t),r=0;for(let t=0;t<e.length;t++){let i=e[t];"number"==typeof i?(n.fill(e[t+1],r,r+i),t+=1,r+=i):(n[r]=i,r++)}return n},s:z,s_:(e,t)=>n=>z(t)(d(n,e)),scq:function(e,t,n=g){return{p:(n,r)=>[e.p(n,r),t.p(n,r)],r:(r,i)=>n(e.r(r,i[0])+t.r(r,i[1])),a:{z:[e.a.z,t.a.z],m:(n,r)=>[e.a.m(n[0],r[0]),t.a.m(n[1],r[1])]},d:M(e,t)}},sq:O,dscq:function(e,t,r,i){const s=`x${i}`,o=e=>e?2===e.length?["p",s,"",e[1]]:e:null,a=r=>{const i=(e=>d(e,["session_id"]))(r);return i&&d(r,["name"])===n(e)&&t(r)?["p",s,"",{[i]:1}]:null},c=(e,t)=>{const n=o(e),r=o(t);return n?r?["p",s,"",{...n[3],...r[3]}]:n:r};return{a:{m:c,z:null},p:(e,t)=>a(t),r:(e,t)=>{const n=t&&t[3]&&"object"==typeof t[3]?Object.keys(t[3]).length:0;return r(n)},d:{a:f(c),l:(e,t)=>a(e),i:(e,t)=>o(e),c:g}}},sw:function(e,t,r,i=g){return{a:{m:(e,t)=>e+t,z:0},p:(i,s)=>d(s,["name"])===n(e)&&t(s)?d(s,r):0,r:(e,t)=>i(t),d:{a:(e,t)=>{const n=new Array(Math.max(e.length,t.length));n[0]="p2";for(let r=1;r<n.length;r++)n[r]=(e[r]??0)+(t[r]??0);return n},l:i=>{return(r=>d(r,["name"])===n(e)&&t(r))(i)?(s=d(i,r))<0?["p2",null,-s]:["p2",s]:null;var s},i:e=>{return e?Array.isArray(e)?((t="p2"===e[0]?e.slice(1):e)[0]||0)-(t[1]||0):e:0;var t},c:e=>Array.isArray(e)&&(e[1]||e[2])?e:null}}},t:h,tb:(e,t)=>n=>_(e,t)(S(n)),te:e=>t=>S(t)===e,te_:(e,t)=>n=>I(e,n)===t,tg:e=>t=>S(t)>e,tg_:(e,t)=>n=>I(e,n)>t,tge:e=>t=>S(t)>=e,tge_:(e,t)=>n=>I(e,n)>=t,ti:y,tl:e=>t=>S(t)<e,tl_:(e,t)=>n=>I(e,n)<t,tle:e=>t=>S(t)<e,tle_:(e,t)=>n=>I(e,n)<t,tn:e=>t=>S(t)!==e,tn_:(e,t)=>n=>I(e,n)!==t,tw:function(e,t,n){const r=n||100,i=Math.ceil(t/r),s=e=>Math.floor(e/i),o=(e,n,r)=>[s(e.getTime()-t),{[s(n)]:r}],a=(t,n)=>{const r=Math.max(t[0],n[0]),i=Object.keys(t[1]).filter((e=>e>=r)).concat(Object.keys(n[1]).filter((e=>e>=r))).filter(((e,t,n)=>n.indexOf(e)===t)).reduce(((r,i)=>{const s=e.a.m(t[1][i]||e.a.z,n[1][i]||e.a.z);return s!==e.a.z&&(r[i]=s),r}),{});return[r,i]},c=[Number.NEGATIVE_INFINITY,{}],u=e=>{const t=t=>t.map((([t,n,r])=>o(e.t,r,t))).reduce(a,c);return a(t(e.in),t(e.out))};return{a:{m:(e,t)=>{const n=e.w?u(e):e;return a(n,t)},z:c},p:(t,n)=>o(t.getCurrentTime(),d(n,["time"],y),e.p(t,n)),r:(t,n)=>{const r=(n.w?u(n):n)[1];return e.r(t,Object.keys(r).reduce(((t,n)=>e.a.m(t,r[n])),e.a.z))},d:e.d.tw||{a:([e,,...t],[,,...n])=>[e,"w",...a(t,n)],l:(t,n)=>{const r=e.d.l(t,n),i=e.d.i(r,n);return r&&[r[0],"w",...o(n.getCurrentTime(),d(t,["time"],y),i)]},i:(e,n)=>{const r=Array.isArray(e)?e:[],i=n.getCurrentTime(),o=s(i.getTime()-t);return[r[2]||null,Object.keys(r[3]||{}).map((e=>({[e]:r[3][e]}))).reduce(((e,t)=>(Object.keys(t).filter((e=>parseInt(e)>=o)).forEach((n=>e[n]=t[n])),e)),{})]},c:g}}},vq:D,w:e=>t=>t===r(e),x:e=>t=>t!==r(e),y:(e,t)=>n=>p(n,e)===r(t),y_:(e,t)=>n=>d(n,e)===r(t),z:(e,t)=>n=>p(n,e)!==r(t),z_:(e,t)=>n=>d(n,e)!==r(t)}}function generateLookupMethods(e){let t,n=!1,r=[];return{onReady:e=>{n?e(t):r.push(e)},provideEnvironment:i=>{t={events:e.eventsLookup(i),literals:e.literalsLookup(i),properties:e.propertiesLookup(i),ahoCorasick:e.ahoCorasickLookup(i),subexpressions:e.subexpressionsLookup(i),rootCompression:e.rootCompressionLookup(i)},r.forEach((e=>e(t))),r=[],n=!0}}}},812:(e,t,n)=>{n.d(t,{GL:()=>a,HJ:()=>c,N1:()=>f,NC:()=>r,RP:()=>i,UM:()=>u,t_:()=>l});const r=performance.now(),i=(new Date).getTime();let s=[],o=!1;const a=e=>function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return c((()=>e(...n)))},c=(e,t)=>{if(!o){const n=self.setTimeout(e,t);return()=>self.clearTimeout(n)}let n;const r=()=>{void 0!==n&&o&&s.length<1e4&&s.push([n,performance.now()]),n=void 0},i=[self.setTimeout((()=>{n=performance.now(),self.requestAnimationFrame(r),e()}),t),self.setTimeout(r,t)];return()=>{void 0===n&&i.forEach((e=>self.clearTimeout(e)))}},u=(e,t)=>{if(!o){const n=self.setInterval(e,t);return()=>self.clearInterval(n)}let n=!1,r=()=>{};const i=self.setInterval((()=>{r=c((()=>{n||e()}))}),t);return()=>{n=!0,r(),self.clearInterval(i)}},l=e=>new Promise(((t,n)=>e.then(a(t),a(n)))),f=e=>()=>l(e())},460:(e,t,n)=>{n.d(t,{g1:()=>z,YO:()=>I,oQ:()=>T,a9:()=>w,Ue:()=>m,gS:()=>v,D8:()=>C,VS:()=>q,xH:()=>U,En:()=>b,p4:()=>A,fF:()=>D,Hr:()=>k,UI:()=>y,u4:()=>E,Rp:()=>P,vP:()=>x,bw:()=>M,YP:()=>_});var r=n(865),i=n(385),s=n(275),o=n(492),a=n(583),c=n(387);function u(e){let t=e,n=[],r=!1;return{addListener(e){if(r)return()=>{};let i=t;const s=()=>{Object.is(t,i)||(i=t,e(t))};n=[...n,s];return()=>{n=n.filter((e=>e!==s))}},notify(e){if(r)throw new Error("Ref bug: Attempted to notify a terminated notifier");Object.is(e,t)||(t=e,n.forEach((e=>e())))},terminate(){r=!0,n=[]}}}function l(e,t){let n=0;return function(){try{if(n++>0)throw new Error(e);return t(...arguments)}finally{n--}}}function f(e,t){let n=[...new Set(e)].filter((e=>"final"!==e.state));if(0===n.length)return{state:"final",onStateChange:()=>()=>{}};const r=()=>0===n.length?"final":n.some((e=>"might_change"===e.state))?"might_change":"nominal",[i,s]=d(r(),(e=>"might_change"!==e&&t())),o=()=>s(r());return n.forEach((t=>{t.onStateChange((t=>{switch(t){case"final":n=e.filter((e=>"final"!==e.state)),o();break;case"might_change":s("might_change");break;case"nominal":o();break;default:throw new Error(`Ref bug: Invalid state ${t}`)}}))})),i}function d(e,t){if("final"===e)return[{state:"final",onStateChange:()=>()=>{}},()=>{}];const{terminate:n,notify:r,addListener:i}=u(e),s={state:e,onStateChange:i},o=l("Disallowed recursion in Branch.",(e=>{if("final"===s.state){if("final"===e)return;throw new Error(`Attempted to change state of final branch to ${e}.`)}try{null==t||t(e),s.state=e,r(e)}finally{"final"===e&&n()}}));return[s,o]}var p=n(560),g=n(444);const h="Ref";function m(e){const[t,n,r]=function(){const[e,t]=d("nominal"),n=l("Disallowed recursion in Branch.",(n=>{if("final"===e.state)throw new Error("Attempted to mutate a finalized Ref.");const r=e.state;try{t("might_change"),n()}finally{t(r)}}));return[e,n,()=>t("final")]}(),[i,s]=j(t,e);return[i,e=>n((()=>s(e))),r]}function v(e){let t=e.empty;const n=()=>()=>{const n=t;return t=e.empty,n},[r,i,s]=m(n());return[r,r=>{t=e.concat(t,r),i(n())},s]}function b(e,t){return n=>{let r=new Array(e).fill(t.empty);return new Array(e).fill(null).map(((e,i)=>(0,s.zG)(n,y(g.UI((e=>{const n=t.concat(r[i],e);return r=r.map(((n,r)=>r===i?t.empty:t.concat(n,e))),n}))))))}}function w(e){return{get current(){return e},onChange:()=>()=>{},branch:{state:"final",onStateChange:()=>()=>{}}}}function _(e){return t=>{const n=t.onChange(e);return e(t.current),n}}function y(e,t){if(t){const[n,r]=j(t.branch,e(t.current));return t.onChange((t=>r(e(t)))),n}return t=>y(e,t)}const S={URI:h,map:(e,t)=>y(t)(e)},I=p.YO(S),k=p.Hr(S),G=e=>q((t=>y(t)(e))),z={URI:h,of:w,map:S.map,ap:(e,t)=>G(t)(e)};function q(e,t){return t?U(y(e,t)):t=>U(y(e,t))}function U(e){if("final"===e.branch.state)return e.current;const[t,n]=function(e,t){let n=t;const r=[e.state,n.state].includes("might_change")?"might_change":"nominal",[i,s]=d(r),o=e=>t=>{switch(t){case"final":s(e().state);break;case"might_change":s("might_change");break;case"nominal":"might_change"===e().state?s("might_change"):s("nominal");break;default:throw new Error(`Ref bug: Unexpected upstream state ${t}`)}};e.onStateChange(o((()=>n)));const a=o((()=>e));let c=n.onStateChange(a);return[i,e=>{n=e,c(),c=e.onStateChange(a),a(n.state)}]}(e.branch,e.current.branch),[r,i]=j(t,e.current.current);let s=e.current.onChange(i);return e.onChange((e=>{s(),s=e.onChange(i),n(e.branch),i(e.current)})),r}function E(e){return t=>{if("final"===t.branch.state)return t;let n=o.YP;return y((t=>{if(o.Wi(n))return n=o.G(t),t;const r=e(n.value,t);return n=o.G(r),r}),t)}}function P(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{if(2===t.length){let n=t[0];return y((e=>(n=t[1](n,e),n)),e)}let n=o.bM();return y((e=>{const r=t[0](n,e);return n=o.G(r),r}),e)}}function x(){if(0===arguments.length||R(arguments.length<=0?void 0:arguments[0]))return O(...arguments);const e=arguments.length<=0?void 0:arguments[0],t=Object.keys(e);return(0,s.zG)(Object.values(e),(e=>O(...e)),y((0,s.ls)(a.Su(((e,n)=>[t[e],n])),Object.fromEntries)))}function O(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)return w([]);if(1===t.length)return y((e=>[e]))(t[0]);let r=!1;t.forEach((e=>e.onChange((()=>{if("might_change"!==e.branch.state)throw new Error("Ref bug: Received a change notification without a `might_change` state.");r=!0}))));const i=t.map((0,c.vg)("branch")),s=()=>{r&&(r=!1,u(t.map((e=>e.current))))},o=f(i,s),[a,u]=j(o,t.map((e=>e.current)));return a}function D(e){const[t,n,r]=m(o.YP);return e().then((0,s.ls)(o.G,n,r)),t}function A(e){const[t,n,a]=m(o.YP);return e.then(i.F2).catch((0,s.ls)(r.w,i.t$)).then((0,s.ls)(o.G,n,a)),t}function C(e){const t=e.hasOwnProperty("equals")?e.equals:e;return E(((e,n)=>t(e,n)?e:n))}function T(e){return R(e)?e:w(e)}function M(e){return t=>(_(e)(t),t)}function j(e,t){if("final"===e.state)return[w(t),()=>{}];const n=u(t);e.onStateChange((e=>{"final"===e&&n.terminate()}));let r=t;return[{get current(){return r},onChange:n.addListener,branch:e},l("Disallowed recursion in Ref.",(e=>{r=e,n.notify(r)}))]}function R(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)&&"function"==typeof e.onChange}},936:(e,t,n)=>{n.d(t,{Hr:()=>m,K4:()=>c,KD:()=>w,UI:()=>f,VS:()=>p,YO:()=>v,ak:()=>h,bw:()=>d,dQ:()=>u,kR:()=>_,of:()=>l,vP:()=>g,yi:()=>b});var r=n(460),i=n(275),s=n(387),o=n(54),a=n(492);const c=e=>(0,i.ls)((t=>{let{previousState:n,...r}=t;return e(r)}),(e=>({value:e,state:r.a9(void 0)}))),u=i.yR,l=(0,i.ls)(i.a9,c),f=e=>t=>(0,i.ls)(t,(0,s.rO)({value:e})),d=e=>t=>(0,i.ls)(t,(0,s.rO)({value:(0,s.bw)(e)}));function p(e){return t=>n=>{let{previousState:i,...s}=n;const o=t({previousState:Array.isArray(i)?i[0]:void 0,...s}),a=e(o.value)({previousState:Array.isArray(i)?i[1]:void 0,...s});return{value:a.value,state:r.vP(o.state,a.state)}}}function g(e){return t=>{let{previousState:n,...s}=t;const a=I(n)?n:{},c=(0,i.zG)(e,o.Su(((e,t)=>t({previousState:a[e],...s}))));return{value:(0,i.zG)(c,o.UI((e=>e.value))),state:(0,i.zG)(c,o.UI((e=>e.state)),(e=>r.vP(e)))}}}function h(e,t){return n=>(0,i.ls)((0,s.rO)({previousState:S}),(s=>{const o=n(s),a=t(o.value)({...s,previousState:s.previousState[e]});return{value:(0,i.zG)([o.value,a.value],(t=>{let[n,r]=t;if(!I(n))throw new Error("Service.bind() was passed an upstream Service with a non-record value.");return{...n,[e]:r}})),state:(0,i.zG)(r.vP(o.state,a.state),r.UI((t=>{let[n,r]=t;if(void 0===n)return{[e]:r};if(!I(n))throw new Error("Service.bind() was passed an upstream Service with a non-record state.");return{...n,[e]:r}})))}}))}const m=(e,t)=>f((n=>({...n,[e]:t(n)})));function v(e){return t=>(0,i.ls)((0,s.rO)({previousState:(0,i.ls)(S,(t=>t[e]))}),t,(0,s.rO)({value:t=>({[e]:t}),state:r.UI((t=>({[e]:t})))}))}const b=(e,t)=>{const n=t||(t=>t===e);return t=>u((o=>{let{previousState:a,...c}=o;const u=Array.isArray(a)&&2===a.length&&n(a[0])?a[1]:void 0;return(0,i.zG)({previousState:u,...c},t,(0,s.rO)({state:r.UI((t=>[e,t]))}))}))},w=e=>{const t=e.slice(0,-1),n=e.slice(-1)[0],r=[...t.map((e=>{let[t,n]=e;return[t,(0,i.a9)(n)]})),(0,i.a9)(n)];return _((0,s.lo)(r))};function _(e){return(0,i.ls)(r.UI(e),y)}function y(e){const t=(0,i.zG)(e,r.Rp(0,(e=>e+1)));return n=>{let{previousState:s,stopped:o,...c}=n;return(0,i.zG)(r.vP(e,t),r.Rp(((e,n)=>{let[u,l]=n;return(0,i.zG)(e,a.UI((e=>e.state.current)),a.fS((()=>s)),(e=>u({previousState:e,stopped:(0,i.zG)(r.vP(o,t),r.UI((e=>{let[t,n]=e;return t||n!==l}))),...c})))})),(e=>({value:r.UI((e=>e.value),e),state:r.VS((e=>e.state),e)})))}}function S(e){return I(e)?e:{}}function I(e){return"object"==typeof e&&null!==e}},371:(e,t,n)=>{n.d(t,{d:()=>f,m:()=>l});var r=n(275),i=n(385),s=n(492),o=n(460),a=n(387),c=n(936),u=n(191);const l=e=>c.dQ((t=>{let{stopped:n,previousState:c}=t;const u=function(e){return m(e)?e:{validityKey:"",lastSuccess:s.YP}}(c),l=(0,r.zG)(u,(e=>({...e,inFlight:s.YP,lastSuccess:(0,r.zG)(e.lastSuccess,s.UI(i.F2))}))),f=(0,r.zG)(e,o.UI((e=>"currentTimestampSecs"in e&&"freshness"in e&&"validity"in e?e:{currentTimestampSecs:0,validity:{key:e.validityKey,maxAge:Number.MAX_SAFE_INTEGER},freshness:{key:e.freshnessKey,maxAge:Number.MAX_SAFE_INTEGER},refresh:e.refresh})),(e=>o.vP(e,n)),o.Rp(o.a9(l),((e,t)=>{let[n,c]=t;if(c)return e;const u=n.validity.key(),l=s.hX((e=>n.currentTimestampSecs-e.timestamp<=n.validity.maxAge)),f=(0,a.HP)(n.freshness.key),d=s.hX((e=>n.currentTimestampSecs-e.timestamp<=n.freshness.maxAge&&e.freshnessKey===f())),p=(0,r.zG)(e,o.UI((0,r.ls)(s.DT((e=>e.validityKey===u)),s.EQ((()=>({validityKey:u,inFlight:s.YP,lastSuccess:s.YP})),(0,a.rO)({inFlight:l,lastSuccess:s.tS(i.EQ((e=>s.G(i.t$(e))),(0,r.ls)(s.G,l,s.UI((e=>i.F2(e))))))})))),o.D8(g()));if((0,r.zG)(p.current,(e=>(0,r.zG)(e.inFlight,s.wp((()=>(0,r.zG)(e.lastSuccess,s.tS(s.Uo)))),d,s.pC))))return p;const h=()=>({timestamp:n.currentTimestampSecs,freshnessKey:f(),output:s.YP});return(0,r.zG)(n.refresh,s.EQ((()=>p),(0,r.ls)((0,r.nn)({previous:(0,r.zG)(p.current.lastSuccess,s.tS(s.Uo),s.tS((e=>e.output)))}),o.fF,o.UI(s.EQ((()=>(0,r.zG)(p,o.UI((0,a.rO)({inFlight:()=>s.G(h())})))),i.EQ((e=>(0,r.zG)(p,o.UI((0,a.rO)({inFlight:()=>s.YP,lastSuccess:(0,r.ls)(s.tS((0,r.ls)(s.Uo,s.hX((e=>s.pC(e.output))))),i.Yo((()=>e)),s.G)})))),(e=>o.a9({validityKey:u,inFlight:s.YP,lastSuccess:s.G(i.F2({...h(),output:s.G(e)}))}))))),o.xH)))})),o.xH,o.D8(g())),d=(0,r.zG)(f,o.UI((e=>({validityKey:e.validityKey,lastSuccess:(0,r.zG)(e.lastSuccess,s.tS(s.Uo))}))),o.D8(h())),p=(0,r.zG)(d,o.Rp(-1,(e=>e+1)));return{value:(0,r.zG)(f,o.UI((0,r.ls)((0,a.vg)("lastSuccess"),s.UI(i.UI((e=>e.output))),s.fS((()=>i.F2(s.YP)))))),state:(0,r.zG)(o.vP(d,p),o.UI((e=>{let[t,n]=e;return n>0?t:h().equals(t,u)?c:t})))}})),f=e=>t=>(0,r.ls)((0,a.rO)({previousState:(0,r.ls)(s.DT(m),s.YO("s1"),s.Hr("s2",(t=>{let{s1:n}=t;return(0,r.zG)(n,(0,a.rO)({lastSuccess:s.UI((0,a.rO)({output:s.tS(e)}))}))})),s.UI((e=>{let{s1:t,s2:n}=e;return h().equals(t,n)?t:n})),s.FS)}),t),d=()=>u.n_({freshnessKey:(0,a.Or)(),timestamp:(0,a.Or)(),output:s.Eh((0,a.Or)())});function p(e){return"object"==typeof e&&null!==e&&(!(!("freshnessKey"in e)||!v(e.freshnessKey))&&("timestamp"in e&&"number"==typeof e.timestamp&&!(!("output"in e)||!(0,a.El)(e.output))))}const g=()=>u.n_({validityKey:(0,a.Or)(),inFlight:s.Eh(d()),lastSuccess:s.Eh(i.Eh((0,a.Or)(),d()))}),h=()=>u.n_({validityKey:(0,a.Or)(),lastSuccess:s.Eh(d())});function m(e){return"object"==typeof e&&null!==e&&(!(!("validityKey"in e)||!v(e.validityKey))&&!!("lastSuccess"in e&&(0,a.El)(e.lastSuccess)&&(0,r.zG)(e.lastSuccess,s.EQ((()=>!0),p))))}function v(e){return null===e||"string"==typeof e||"number"==typeof e}},41:(e,t,n)=>{n.r(t),n.d(t,{PermutiveActivationManagerWeb:()=>o,optimisedActivationsConfig:()=>s});class r{logger;permutive;id;segmentCode;triggerType;config;workspaceLevelConfig;prefix="[Activation]";constructor(e,t,n,r,i,s,o){this.logger=e,this.permutive=t,this.id=n,this.segmentCode=r,this.triggerType=i,this.config=s,this.workspaceLevelConfig=o}getSegmentCode(){return this.segmentCode}getTriggerType(){return this.triggerType}getConfig(){return this.config}getWorkspaceLevelConfig(){return this.workspaceLevelConfig}trackImpression(e){return this.trackActivation("impression",e)}trackConversion(e){return this.trackActivation("conversion",e)}trackActivation(e,t){const n={reaction_id:this.id,type:e};this.permutive.track("Reaction",n,t),this.logger.log(this.prefix,n.type,n)}}var i=n(636);const s={dfp:{dfp:[141938,121681,118474,118211,121680,118215,125753,137806,118460,162294,118478,141412,121767,116208,118793,162398,117414,108187,117111,118786,121764,121752,118476,116207,150867,121761,172408,122487,117501,118483,118795,118099,156584,146580,118608,143008,118485,118788,162402,121682,161960,121762,173349,118222,121760,117307,118477,118487,137808,117374,118794,118208,117372,118798,164161,118473,118221,118470,118471,139860,118100,118468,121676,137809,118462,118216,118218,118463,164162,118223,117418,164159,146579,123457,117484,121769,118475,124811,121771,143007,121765,121633,164160,121770,117303,118789,125010,116209,118212,118210,116687,176552,176856,184136,184730,184732,184738,184745,185474,185907,185937,185989,186173,187028,187907,187912,194711,194509,194712,194512,194714,194715,194716,194717,194718,194719,194731,194732,194733,194734,194737,194739,194740,194741,194743,207225,211378],dfp_legacy:{}},eyeota_pixel:[],dbm:{omitted:0},appnexus:{},appnexus_adserver:[],nativo:[],rubicon_ssp:[],smart:[],freewheel:[]};class o{logger;permutive;clientContext;constructor(e,t,n){this.logger=e,this.permutive=t,this.clientContext=n}getSpecializedActivations(e){return s[e]}getActivations(e){return(0,i.Hn)(e)("activationConfigs",[]).filter((e=>this.areContextCriteriaSatisfied(e))).map((e=>new r(this.logger,this.permutive,e.id,e.sc,e.tt,e.c,e.wc)))}areContextCriteriaSatisfied(e){const t=e.cc,n=e=>{const t=this.clientContext.getContext()[e.key];switch(e.comparison){case"EQUALS":return t===e.value;case"NOT_EQUALS":return t!==e.value;case"CONTAINS":return"string"==typeof t&&t.indexOf(e.value)>=0;case"NOT_CONTAINS":return"string"==typeof t&&t.indexOf(e.value)<0}};return!t||("AND"===(r=t).operator?r.criteria.every(n):r.criteria.some(n));var r}}},636:(e,t,n)=>{n.d(t,{Hn:()=>i});const r={standard_cohorts:{auto_init:!0,activationConfigs:[]},ssp:{auto_init:!0,ssps:["google_pps","appnexus"],cohort_mapping:{1e7:"bgyz",10000001:"bhgp",10000002:"bhhc",10000003:"bhhg",10000004:"bhhk",10000005:"bhhp",10000006:"bhhv",10000007:"bhhy",10000008:"bhie",10000010:"bhis",10000011:"bhiz",10000012:"bhji",10000013:"bhjq",10000014:"bhka",10000015:"bhkl",10000016:"bhkr",10000017:"bhky",10000018:"bhlg",10000019:"bhli",10000020:"bhlo",10000021:"bhlp",10000022:"bhnd",10000023:"bhnl",10000024:"bhnp",10000025:"bhnw",10000026:"bhoj",10000035:"bgzb",10000036:"bhgq",10000037:"bhgs",10000038:"bhgw",10000039:"bhgy",10000040:"bhgz",10000041:"bhhe",10000042:"bhhh",10000043:"bhhw",10000044:"bhhx",10000045:"bhhz",10000046:"bhia",10000047:"bhif",10000048:"bhig",10000049:"bhii",10000050:"bhij",10000051:"bhik",10000052:"bhim",10000053:"bhip",10000054:"bhit",10000055:"bhiu",10000056:"bhiv",10000057:"bhiy",10000058:"bhjm",10000059:"bhjr",10000060:"bhjs",10000061:"bhjw",10000062:"bhjx",10000063:"bhkm",10000064:"bhir",10000065:"bhko",10000066:"bhkp",10000067:"bhkq",10000068:"bhkz",10000069:"bhla",10000070:"bhlb",10000071:"bhle",10000072:"bhlf",10000073:"bhlq",10000074:"bhlt",10000075:"bhlu",10000076:"bhlw",10000077:"bhlx",10000078:"bhly",10000079:"bhmb",10000080:"bhmi",10000081:"bhmj",10000082:"bhml",10000083:"bhmp",10000084:"bhmr",10000085:"bhmw",10000086:"bhmz",10000087:"bhne",10000088:"bhnf",10000089:"bhni",10000090:"bhnn",10000324:"bhhj",10000325:"bhhi",10000327:"bhku",10000328:"bhkt",10000329:"bhkw",10000330:"bhkv",10000687:"bgzc",10000688:"bgza",10000689:"bhha",10000690:"bhgt",10000691:"bhgx",10000692:"bhgv",10000693:"bhgr",10000694:"bhgu",10000695:"bhhb",10000696:"bhhd",10000697:"bhhf",10000698:"bhhl",10000699:"bhho",10000700:"bhhm",10000701:"bhhn",10000702:"bhhq",10000703:"bhht",10000704:"bhhu",10000705:"bhhs",10000706:"bhhr",10000707:"bhib",10000708:"bhid",10000709:"bhic",10000710:"bhio",10000711:"bhin",10000712:"bhil",10000713:"bhiq",10000714:"bhih",10000715:"bhiw",10000716:"bhix",10000717:"bhja",10000718:"bhjc",10000719:"bhjd",10000720:"bhje",10000721:"bhjf",10000722:"bhjb",10000723:"bhjg",10000724:"bhjh",10000725:"bhjo",10000726:"bhjk",10000727:"bhjn",10000728:"bhjj",10000729:"bhjl",10000730:"bhjy",10000731:"bhju",10000732:"bhjv",10000733:"bhjz",10000734:"bhjt",10000735:"bhkj",10000736:"bhkk",10000737:"bhki",10000738:"bhkd",10000739:"bhkc",10000740:"bhkf",10000741:"bhkh",10000742:"bhkb",10000743:"bhkg",10000744:"bhke",10000745:"bhjp",10000746:"bhkn",10000747:"bhkx",10000748:"bhks",10000749:"bhld",10000750:"bhlc",10000751:"bhlh",10000752:"bhlk",10000753:"bhlj",10000754:"bhll",10000755:"bhlm",10000756:"bhlv",10000757:"bhna",10000758:"bhmv",10000759:"bhmt",10000760:"bhmy",10000761:"bhmc",10000762:"bhmo",10000763:"bhls",10000764:"bhmq",10000765:"bhme",10000766:"bhmh",10000767:"bhlz",10000768:"bhlr",10000769:"bhnb",10000770:"bhmk",10000771:"bhmu",10000772:"bhmx",10000773:"bhmg",10000774:"bhmd",10000775:"bhmf",10000776:"bhnc",10000777:"bhmn",10000778:"bhmm",10000779:"bhma",10000780:"bhms",10000781:"bhng",10000782:"bhnj",10000783:"bhnh",10000784:"bhnk",10000785:"bhno",10000786:"bhnm",10000787:"bhnu",10000788:"bhnv",10000789:"bhns",10000790:"bhnt",10000791:"bhnq",10000792:"bhnr",10000793:"bhob",10000794:"bhny",10000795:"bhod",10000796:"bhoh",10000797:"bhog",10000798:"bhnz",10000799:"bhoa",10000800:"bhoe",10000801:"bhnx",10000802:"bhoc",10000803:"bhof"},all_cohort_mapping:{1e7:["bgyz"],10000001:["bhgp"],10000002:["bhhc"],10000003:["bhhg"],10000004:["bhhk"],10000005:["bhhp"],10000006:["bhhv"],10000007:["bhhy"],10000008:["bhie"],10000010:["bhis"],10000011:["bhiz"],10000012:["bhji"],10000013:["bhjq"],10000014:["bhka"],10000015:["bhkl"],10000016:["bhkr"],10000017:["bhky"],10000018:["bhlg"],10000019:["bhli"],10000020:["bhlo"],10000021:["bhlp"],10000022:["bhnd"],10000023:["bhnl"],10000024:["bhnp"],10000025:["bhnw"],10000026:["bhoj"],10000035:["bgzb"],10000036:["bhgq"],10000037:["bhgs"],10000038:["bhgw"],10000039:["bhgy"],10000040:["bhgz"],10000041:["bhhe"],10000042:["bhhh"],10000043:["bhhw"],10000044:["bhhx"],10000045:["bhhz"],10000046:["bhia"],10000047:["bhif"],10000048:["bhig"],10000049:["bhii"],10000050:["bhij"],10000051:["bhik"],10000052:["bhim"],10000053:["bhip"],10000054:["bhit"],10000055:["bhiu"],10000056:["bhiv"],10000057:["bhiy"],10000058:["bhjm"],10000059:["bhjr"],10000060:["bhjs"],10000061:["bhjw"],10000062:["bhjx"],10000063:["bhkm"],10000064:["bhir"],10000065:["bhko"],10000066:["bhkp"],10000067:["bhkq"],10000068:["bhkz"],10000069:["bhla"],10000070:["bhlb"],10000071:["bhle"],10000072:["bhlf"],10000073:["bhlq"],10000074:["bhlt"],10000075:["bhlu"],10000076:["bhlw"],10000077:["bhlx"],10000078:["bhly"],10000079:["bhmb"],10000080:["bhmi"],10000081:["bhmj"],10000082:["bhml"],10000083:["bhmp"],10000084:["bhmr"],10000085:["bhmw"],10000086:["bhmz"],10000087:["bhne"],10000088:["bhnf"],10000089:["bhni"],10000090:["bhnn"],10000324:["bhhj"],10000325:["bhhi"],10000327:["bhku"],10000328:["bhkt"],10000329:["bhkw"],10000330:["bhkv"],10000687:["bgzc"],10000688:["bgza"],10000689:["bhha"],10000690:["bhgt"],10000691:["bhgx"],10000692:["bhgv"],10000693:["bhgr"],10000694:["bhgu"],10000695:["bhhb"],10000696:["bhhd"],10000697:["bhhf"],10000698:["bhhl"],10000699:["bhho"],10000700:["bhhm"],10000701:["bhhn"],10000702:["bhhq"],10000703:["bhht"],10000704:["bhhu"],10000705:["bhhs"],10000706:["bhhr"],10000707:["bhib"],10000708:["bhid"],10000709:["bhic"],10000710:["bhio"],10000711:["bhin"],10000712:["bhil"],10000713:["bhiq"],10000714:["bhih"],10000715:["bhiw"],10000716:["bhix"],10000717:["bhja"],10000718:["bhjc"],10000719:["bhjd"],10000720:["bhje"],10000721:["bhjf"],10000722:["bhjb"],10000723:["bhjg"],10000724:["bhjh"],10000725:["bhjo"],10000726:["bhjk"],10000727:["bhjn"],10000728:["bhjj"],10000729:["bhjl"],10000730:["bhjy"],10000731:["bhju"],10000732:["bhjv"],10000733:["bhjz"],10000734:["bhjt"],10000735:["bhkj"],10000736:["bhkk"],10000737:["bhki"],10000738:["bhkd"],10000739:["bhkc"],10000740:["bhkf"],10000741:["bhkh"],10000742:["bhkb"],10000743:["bhkg"],10000744:["bhke"],10000745:["bhjp"],10000746:["bhkn"],10000747:["bhkx"],10000748:["bhks"],10000749:["bhld"],10000750:["bhlc"],10000751:["bhlh"],10000752:["bhlk"],10000753:["bhlj"],10000754:["bhll"],10000755:["bhlm"],10000756:["bhlv"],10000757:["bhna"],10000758:["bhmv"],10000759:["bhmt"],10000760:["bhmy"],10000761:["bhmc"],10000762:["bhmo"],10000763:["bhls"],10000764:["bhmq"],10000765:["bhme"],10000766:["bhmh"],10000767:["bhlz"],10000768:["bhlr"],10000769:["bhnb"],10000770:["bhmk"],10000771:["bhmu"],10000772:["bhmx"],10000773:["bhmg"],10000774:["bhmd"],10000775:["bhmf"],10000776:["bhnc"],10000777:["bhmn"],10000778:["bhmm"],10000779:["bhma"],10000780:["bhms"],10000781:["bhng"],10000782:["bhnj"],10000783:["bhnh"],10000784:["bhnk"],10000785:["bhno"],10000786:["bhnm"],10000787:["bhnu"],10000788:["bhnv"],10000789:["bhns"],10000790:["bhnt"],10000791:["bhnq"],10000792:["bhnr"],10000793:["bhob"],10000794:["bhny"],10000795:["bhod"],10000796:["bhoh"],10000797:["bhog"],10000798:["bhnz"],10000799:["bhoa"],10000800:["bhoe"],10000801:["bhnx"],10000802:["bhoc"],10000803:["bhof"]},affinity_enabled:!1,activationConfigs:[]},web:{auto_init:!1,track_pageview_engagement:!0,track_form_submission:!1,track_link_click:!0,track_pageview_complete:!0,add_alchemy_taxonomy:!1,add_alchemy_entities:!1,engagement_edge_only:!0,segment_transition_edge_only:!0,activationConfigs:[]},xandr__curation_platform:{auto_init:!0,activation_method:"prebid",ssp_code:"appnexus",type:"curation_platform",activationConfigs:[]},clean_room:{auto_init:!0,pass_cohorts_to_prebid:!0,cohort_ssp_config:[],activationConfigs:[]},google_pps__curation_platform:{auto_init:!0,activation_method:"prebid",ssp_code:"google_pps",type:"curation_platform",activationConfigs:[]},dfp:{auto_init:!0,track_slot_rendered:!1,track_slot_viewable:!0,track_slot_clicked:!0,activationConfigs:[]},privacy_sandbox_topics:{auto_init:!0,prebid:!1,topics_iframe_url:"https://cdn.permutive.app/topics.html",activationConfigs:[]}},i=e=>{const t=r[e];return(e,n)=>(null==t?void 0:t[e])??n};i("web"),i("dfp"),i("facebook_pixel_v2")},277:(e,t,n)=>{n.d(t,{X:()=>i,k:()=>r});const r=e=>({id:e.id,name:e.name,time:new Date(e.time),properties:e.properties||{},session_id:e.session_id,view_id:e.view_id}),i=e=>({id:e.id,name:e.name,time:(s(e.time)?e.time:new Date).toISOString(),properties:e.properties||{},session_id:e.session_id,view_id:e.view_id}),s=e=>isFinite(e)&&e instanceof Date},878:(e,t,n)=>{n.d(t,{F:()=>u,I:()=>c});var r=n(460),i=n(444),s=n(583),o=n(275),a=n(387);const c=(e,t)=>{let n=!1;return r.UI(i.UI((0,a.bw)((r=>{n||(n=(0,o.zG)(r,s.G((e=>{let[,t]=e;return"Pageview"===t.name}))),n&&e.trackTimeSinceInit("sdk_lifecycle_timestamps",{timestamp_name:t,time_origin:"sdk_init"}))}))))},u=(e,t)=>{const n=c(e,t);return(0,o.ls)(r.En(2,s.uZ()),(e=>{let[t,i]=e;return(0,o.zG)(i,n,r.UI((e=>e()))),t}))}},324:(e,t,n)=>{n.r(t),n.d(t,{service:()=>Cs});var r=n(275),i=n(936),s=n(460),o=n(492),a=n(495);const c=e=>{const t=e.current;return(0,r.zG)(e,s.UI((e=>e===t?{segmentsEntered:[],segmentsExited:[]}:{segmentsEntered:(0,r.zG)(e,l(t)),segmentsExited:(0,r.zG)(t,l(e))})))},u=e=>new Set(e),l=e=>t=>(0,r.zG)(t,f((t=>!e.has(t)))),f=e=>t=>{const n=[];return t.forEach((t=>e(t)&&n.push(t))),n};var d=n(444),p=n(812),g=n(387);const h=()=>({kind:"null",value:null}),m=e=>({kind:"string",value:e}),v=e=>({kind:"number",value:e}),b=e=>({kind:"array",value:e}),w=e=>({kind:"object",value:e}),_=e=>e,y=()=>({kind:"bottom"}),S=e=>({kind:"inner",a:e}),I=e=>({kind:"top",error:e}),k=e=>({kind:"unbounded",group:e}),G=(e,t)=>({kind:"windowed",key:t,group:e}),z=(e,t,n)=>({kind:"countLimit",n,limit:t,group:e}),q=(e,t,n)=>({kind:"uniqueLimit",n,limit:t,group:e}),U=e=>({kind:"numberGroup",group:e}),E=e=>({kind:"stringGroup",group:e}),P=e=>({kind:"tuple",tuple:e}),x=e=>({state:e}),O=(e,t)=>({commands:e,payload:t});var D=n(881),A=n(29);const C=(e,t)=>{switch(e.kind){case"bottom":return{kind:"bottom"};case"inner":return S(t(e.a));case"top":return I(e.error)}},T=e=>(0,D.Zt)(((t,n)=>{if("bottom"===t.kind&&"bottom"===n.kind)return 0;if("bottom"===t.kind)return-1;if("bottom"===n.kind)return 1;if("top"===t.kind&&"top"===n.kind)return A.Df.compare(t.error,n.error);if("top"===t.kind)return 1;if("top"===n.kind)return-1;if("inner"===t.kind&&"inner"===n.kind)return e.compare(t.a,n.a);throw new Error("Non exhaustive match in extendedAlgebraOrd")}));var M=n(586),j=n(358),R=n(385),F=function(e){return-1===e?1:1===e?-1:0};function Q(e,t){return(0,j.oA)(e.map(t))}function L(e,t,n,r){const i=(e,t)=>{if(0===e.length)return(0,j.oA)(t.map((e=>(0,o.G)({1:e[1],2:n(o.YP,(0,o.G)(e[2]))}))));if(0===t.length)return(0,j.oA)(e.map((e=>(0,o.G)({1:e[1],2:n((0,o.G)(e[2]),o.YP)}))));if(e.length>0&&t.length>0&&(0,D.lt)(r)(e[0][1],t[0][1])){const[r,...s]=e,a=r[1],c=r[2];return(0,j.Ce)({1:a,2:n((0,o.G)(c),o.YP)})(i(s,t))}if(e.length>0&&t.length>0&&(0,D.gt)(r)(e[0][1],t[0][1])){const[r,...s]=t,a=r[1],c=r[2];return(0,j.Ce)({1:a,2:n(o.YP,(0,o.G)(c))})(i(e,s))}if(e.length>0&&t.length>0){const[r,...s]=e,[a,...c]=t,u=r[1],l=r[2],f=a[2];return(0,j.Ce)({1:u,2:n((0,o.G)(l),(0,o.G)(f))})(i(s,c))}throw new Error("Non exhaustive match in mapOption2")},s=(0,D.Uz)((e=>e[1]))(r),a=(e=>{const t=Q(e,(e=>(0,o.pC)(e[2])?(0,o.G)({1:e[1],2:e[2].value}):o.YP));return 0===t.length?o.YP:(0,o.G)(t)})(i((0,j.DY)(s)([...e].map((e=>({1:e[0],2:e[1]})))),(0,j.DY)(s)([...t].map((e=>({1:e[0],2:e[1]}))))));return(0,o.UI)((e=>new Map(e.map((e=>[e[1],e[2]])))))(a)}function N(e,t,n,r){const i=(0,D.Uz)((e=>e[0]))(r),s=(0,j.DY)(i)([...t]).reduceRight(((e,t)=>{if((0,R.nM)(e)){const r=n(t[1],e.left);return(0,o.pC)(r)?(0,R.t$)(r.value):(0,R.F2)(t[0])}return e}),(0,R.t$)(e));return(0,o.Uo)(s)}function Y(e,t){return new Map([...e].map(t))}function $(e,t){return new Map([...e].filter(t))}var B=n(191),H=n(627);function V(e){return JSON.stringify(K(e))}function K(e){switch(e.kind){case"null":return Z.encode(e);case"string":return J.encode(e);case"number":return ee.encode(e);case"array":return te.encode(e);case"object":return ne.encode(e)}}function W(e){return null===e?Z.decode(e):"number"==typeof e?ee.decode(e):"string"==typeof e?J.decode(e):Array.isArray(e)?te.decode(e):ne.decode(e)}const X=(e,t)=>(0,R.t$)(`Failed to decode. Input was ${JSON.stringify(e)}. Codec type was ${t}`),Z={encode:e=>null,decode:e=>null===e?(0,R.F2)({kind:"null",value:null}):X(e,"SimpleNull")},J={encode:e=>e.value,decode:e=>"string"==typeof e?(0,R.F2)(m(e)):X(e,"SimpleString")},ee={encode:e=>e.value,decode:e=>"number"==typeof e?(0,R.F2)(v(e)):X(e,"SimpleNumber")},te={encode:e=>e.value.map(K),decode:e=>{if(Array.isArray(e)){const t=(0,j.fw)(R.g1)(W)(e);return(0,R.UI)(b)(t)}return X(e,"SimpleArray")}},ne={encode:e=>{const t=[...e.value.entries()];return Object.assign({},...Array.from(t,(([e,t])=>({[e]:K(t)}))))},decode:e=>{if(e&&e.constructor===Object){const t=(0,j.fw)(R.g1)((([e,t])=>(0,r.zG)(W(t),(0,R.UI)((t=>(0,r.bc)(e,t))))))(Object.entries(e));return(0,R.UI)((e=>w(new Map([...e]))))(t)}return X(e,"SimpleObject")}};function re(e){return(0,r.zG)(e,se,(0,o.UI)(V),(0,o.fS)((()=>"<encode error>")))}function ie(e){return(0,o.UI)(fe)(function(e){switch(e.state.kind){case"top":return(0,o.G)(m(e.state.error));case"bottom":return o.YP;case"inner":return se(e.state.a)}}(e))}function se(e){return function(e){switch(e.kind){case"numberGroup":case"stringGroup":return oe(e.group);case"tuple":return e.tuple.length>0}}(e.payload)?(0,o.G)(b(function(e,t){const n=(0,o.UI)((e=>(0,j.Ce)(e)(t)))(e);return(0,o.fS)((()=>t))(n)}((0,o.UI)((e=>m(function(e){const t=e=>(0,o.EQ)((()=>""),(e=>"b"+JSON.stringify(e)))(e.bound),n=e=>{switch(e.operation){case"add":return"p";case"mul":return"m";case"max":return"v";case"min":return"n"}},r=e=>{const r=t(e[1])+n(e[1]);return 1===e[2]?r:r+JSON.stringify(e[2])};return e.map(r).join("")}(e))))(e.commands),function(e){const t=e=>{switch(e.kind){case"bottom":return{kind:"null",value:null};case"top":return m(e.error);case"inner":return v(e.a)}},n=e=>Q([ae,ce,e=>(0,r.zG)(e,le,w,o.G)],(t=>t(e))),i=e=>Q([ae,ue,e=>(0,r.zG)(e,le,(e=>Y(e,(([e,t])=>[JSON.stringify(e),t]))),w,o.G)],(t=>t(e)));switch(e.kind){case"tuple":return e.tuple.map(t);case"stringGroup":return n(e.group);case"numberGroup":return i(e.group)}}(e.payload)))):o.YP}function oe(e){switch(e.kind){case"unbounded":return e.group.size>0;case"windowed":return e.group.size>0||(0,o.pC)(e.key);case"countLimit":case"uniqueLimit":return e.group.size>0||(0,o.pC)(e.limit)}}function ae(e){switch(e.kind){case"unbounded":return o.YP;case"windowed":return(0,o.G)(m("w"));case"countLimit":return(0,o.G)(m(1===e.n?"x":`x${e.n}`));case"uniqueLimit":return(0,o.G)(m(1===e.n?"u":`u${e.n}`))}}function ce(e){switch(e.kind){case"unbounded":return o.YP;case"windowed":return(0,o.G)(m((0,o.pC)(e.key)?e.key.value:""));case"countLimit":case"uniqueLimit":return(0,o.G)(m((0,o.pC)(e.limit)?e.limit.value:""))}}function ue(e){switch(e.kind){case"unbounded":return o.YP;case"windowed":return(0,o.pC)(e.key)?(0,o.G)(v(e.key.value)):(0,o.G)({kind:"null",value:null});case"countLimit":case"uniqueLimit":return(0,o.pC)(e.limit)?(0,o.G)(v(e.limit.value)):(0,o.G)({kind:"null",value:null})}}function le(e){switch(e.kind){case"unbounded":case"windowed":case"countLimit":case"uniqueLimit":return e.group}}function fe(e){switch(e.kind){case"array":return 0===e.value.length?{kind:"null",value:null}:1===e.value.length?fe(e.value[0]):b(e.value.map(fe));case"object":return(0,r.zG)($(e.value,(([e,t])=>"null"!==t.kind)),(e=>Y(e,(e=>[e[0],fe(e[1])]))),w);default:return e}}function de(e){const t=e=>{if(0===e.length)return{kind:"bottom"};const t=(e=>{if(4!==e.length)return o.YP;const[t,n,r,i]=e;if("string"===t.kind&&"string"===n.kind&&"object"===i.kind){const e=(0,o.DT)((e=>pe(e[1].value)&&ge(e[2].value)))({1:t,2:n});return(0,o.UI)((e=>({prim:e[1].value,grp:e[2].value,cutoff:r,m:i.value})))(e)}return o.YP})(e);if((0,o.pC)(t)){const{prim:e,grp:n,cutoff:r,m:i}=t.value,s=he(r,i,me(n));return"string"==typeof s?I(s):S(O(ve(e),s))}const n=(e=>{if(3!==e.length)return o.YP;const[t,n,r]=e;if("string"===t.kind&&"object"===r.kind){const e=(0,o.DT)((e=>ge(e.value)))(t);return(0,o.UI)((e=>({grp:e.value,cutoff:n,m:r.value})))(e)}return o.YP})(e);if((0,o.pC)(n)){const{grp:e,cutoff:t,m:r}=n.value,i=he(t,r,me(e));return"string"==typeof i?I(i):S(O(o.YP,i))}const r=(e=>{if(2!==e.length)return o.YP;const[t,n]=e;if("string"===t.kind&&"object"===n.kind){const e=(0,o.DT)((e=>pe(e.value)))(t);return(0,o.UI)((e=>({prim:e.value,m:n.value})))(e)}return o.YP})(e);if((0,o.pC)(r)){const{prim:e,m:t}=r.value;return S(O(ve(e),E(k(t))))}const i=(e=>{if(1!==e.length)return o.YP;const[t]=e;return"object"===t.kind?(0,o.G)({m:t.value}):o.YP})(e);if((0,o.pC)(i)){const{m:e}=i.value;return S(O(o.YP,E(k(e))))}const s=(e=>{if(e.length<1)return o.YP;const[t,...n]=e;if("string"===t.kind){const e=(0,o.DT)((e=>pe(e.value)))(t);return(0,o.UI)((e=>({prim:e.value,rest:n})))(e)}return o.YP})(e);if((0,o.pC)(s)){const{prim:e,rest:t}=s.value;return S(O(ve(e),we(t)))}return S(O(o.YP,we(e)))},n=e=>"array"===e.kind?(0,j.tS)(n)(e.value):[e];return"null"===e.kind?x({kind:"bottom"}):x(t(n(e)))}function pe(e){const t=e.split("");if(!0==(0===t.length))return!1;{const[e,...n]=t;return-1!=="bpmvn".indexOf(e)&&n.every((e=>-1!=="bpmvn0123456789.".indexOf(e)))}}function ge(e){const t=e.split("");switch(!0){case 0===t.length:return!1;case"w"===t[0]&&void 0===t[1]:return!0;default:{const[e,...n]=t;return-1!=="ux".indexOf(e)&&-1===n.map((e=>!isNaN(parseInt(e)))).indexOf(!1)}}}function he(e,t,n){switch(e.kind){case"string":return E(n({1:(0,o.G)(e.value),2:t}));case"number":case"null":return U(n({1:"null"===e.kind?o.YP:(0,o.G)(e.value),2:$(Y(t,(([e,t])=>[Number(e),t])),(e=>!isNaN(e[0])))}));default:return"{bad cutoff}"}}function me(e){const t=e=>t=>q(t[2],t[1],e),n=e=>t=>z(t[2],t[1],e),r=e.split("");switch(!0){case"w"===r[0]&&void 0===r[1]:return e=>G(e[2],e[1]);case"u"===r[0]&&void 0===r[1]:return t(1);case"u"===r[0]&&void 0!==r[1]:return t(parseInt(r.slice(1).join("")));case"x"===r[0]&&void 0===r[1]:return n(1);case"x"===r[0]&&void 0!==r[1]:return n(parseInt(r.slice(1).join("")));default:throw new Error("This should never happen if you use isGroupCommand")}}function ve(e){const t=e=>(0,o.Wi)(e.bound)||"add"===e.operation||"mul"===e.operation?(0,o.G)(e):o.YP,n=(e,n,i)=>{const s=((e,n)=>(0,r.zG)(e,(e=>{switch(e){case"p":return(0,o.G)("add");case"m":return(0,o.G)("mul");case"v":return(0,o.G)("max");case"n":return(0,o.G)("min");default:return o.YP}}),o.UI((e=>({operation:e,bound:n}))),o.tS(t)))(e,i);return(0,o.UI)((e=>{const{init:t,rest:r}=(0,j.zT)((e=>{return"number"==typeof(t=parseInt(e))&&isFinite(t)&&Math.floor(t)===t;var t}))(n);return{1:{1:e,2:0===t.length?1:parseInt(t.join(""))},2:r.join("")}}))(s)};return(0,o.UI)(_)((0,M.nI)(be(e,(e=>{const t=e.split("");if(0===t.length)return o.YP;const[i,...s]=t;if("b"===i){const{init:e,rest:t}=(0,r.zG)(s,(0,j.zT)((e=>-1!=="1234567890.".indexOf(e))));if(0===e.length||0===t.length)return o.YP;const i=parseFloat(e.join("")),[a,...c]=t;return n(a,c,(0,o.G)(i))}return n(i,s,o.YP)}))))}function be(e,t){const n=t(e);return(0,o.fS)((()=>[]))((0,o.UI)((e=>[e[1]].concat(be(e[2],t))))(n))}function we(e){return P(e.map(_e))}function _e(e){switch(e.kind){case"number":return S(e.value);case"string":return I(e.value);case"null":return{kind:"bottom"};case"object":return I("{object}");case"array":return I("{array}")}}var ye=n(925);const Se={strategy:(e,t,n)=>r=>{if((0,o.Wi)(n))return t;if("delta"===e&&(0,o.Wi)(t))return o.YP;if((0,o.Wi)(t))return n;if((0,o.pC)(t)&&(0,o.pC)(n))return r(t.value,n.value);throw new Error("Non exhaustive match in combineCommand.strategy")},operation:(e,t,n,i,s,a)=>{const c=(0,j.pR)(T(a)),u=(0,r.zG)(t.bound,o.EQ((()=>r.yR),(e=>t=>(0,D.VV)(a)(s.fromNumber(e),t))));if("append"===e&&"add"===t.operation)return(0,j.yL)(n,i,Ee("append",(0,r.ls)(s.plus,u)));if("append"===e&&"mul"===t.operation)return(0,j.yL)(n,i,Ee("append",(0,r.ls)(s.times,u)));if("append"===e&&"max"===t.operation)return(0,D.Fp)(c)(n,i);if("join"===e&&"add"===t.operation)return(0,j.yL)(n,i,Ee("join",(0,D.Fp)(a)));if("join"===e&&"mul"===t.operation)return(0,j.yL)(n,i,Ee("join",(0,D.Fp)(a)));if("join"===e&&"max"===t.operation)return(0,D.Fp)(c)(n,i);if("min"===t.operation)return Se.operation(e,{operation:"max",bound:t.bound},n,i,s,function(e){return(0,D.Zt)(((t,n)=>F(e.compare(t,n))))}(a));if("delta"===e&&"max"===t.operation)return(0,D.gt)(c)(n,i)?n:i.map(y);if("delta"===e)return(0,j.yL)(n,i,((e,t)=>(0,D.gt)(T(a))(e,t)?C(e,u):{kind:"bottom"}));throw new Error("Non exhaustive match in combineCommand.operation")},extend:(e,t,n,r)=>{if("delta"===e&&"top"===n.kind&&"top"===r.kind)return(0,D.gt)(A.Df)(n.error,r.error)?I(n.error):{kind:"bottom"};if("delta"===e&&"bottom"===r.kind)return n;if("delta"===e&&"bottom"===n.kind)return{kind:"bottom"};if("top"===n.kind&&"top"===r.kind)return I((0,D.Fp)(A.Df)(n.error,r.error));if("top"===n.kind)return n;if("top"===r.kind)return r;if("inner"===n.kind&&"inner"===r.kind)return t(n.a,r.a);if("bottom"===n.kind)return r;if("bottom"===r.kind)return n;throw new Error("Non exhaustive match in extend")}},Ie={fromNumber:r.yR,plus:(e,t)=>e+t,times:(e,t)=>e*t};function ke(e,t,n,r){if("unbounded"===e.kind&&"unbounded"===t.kind){const i=e.group,s=t.group;return(0,o.fS)(y)((0,o.UI)((e=>S(k(e))))(L(i,s,n,r)))}if("windowed"===e.kind&&"windowed"===t.kind){const i=e.key,s=e.group,a=t.key,c=t.group,u=(0,D.Fp)((0,o.pR)(r))(i,a);return(0,o.fS)(y)((0,o.UI)((e=>S(G(e,u))))(L(s,c,n,r)))}if("countLimit"===e.kind&&"countLimit"===t.kind){const i=e.n,s=t.n;if(i===s){const s=e.limit,a=e.group,c=t.limit,u=t.group,l=(0,D.Fp)((0,o.pR)(r))(s,c);return(0,o.fS)(y)((0,o.UI)((e=>S(z(e,l,i))))(L(a,u,n,r)))}return I("Non matching counts")}if("uniqueLimit"===e.kind&&"uniqueLimit"===t.kind){const i=e.n,s=t.n;if(i===s){const s=e.limit,a=e.group,c=t.limit,u=t.group,l=(0,D.Fp)((0,o.pR)(r))(s,c);return(0,o.fS)(y)((0,o.UI)((e=>S(q(e,l,i))))(L(a,u,n,r)))}return I("Non matching counts")}return I("Non matching group types")}function Ge(e,t,n){return(0,o.fS)(h)(ze(e,o.YP)(t,n))}function ze(e,t){const n=t=>(n,r)=>Se.strategy(e,n,r)(ze(e,t)),i=(t,r,i)=>{if("stringGroup"===r.kind&&"stringGroup"===i.kind){const e=ke(r.group,i.group,n(t),A.Df);return C(e,(e=>E(Ue(e,A.Df))))}if("numberGroup"===r.kind&&"numberGroup"===i.kind){const e=ke(r.group,i.group,n(t),H.Df);return C(e,(e=>U(Ue(e,H.Df))))}if("tuple"===r.kind&&"tuple"===i.kind){const n=(0,o.pC)(t)?t.value:[];return S(P(function(e,t,n,r,i,s){const a=(e,t)=>({1:(0,j.ke)(e)(t).concat((0,j.KB)(Math.max(0,e-t.length),y)),2:(0,j.md)(e)(t)}),c=(t,n,r)=>{if(0===t.length)return Se.operation(e,{operation:"max",bound:o.YP},n,r,i,s);if(t.length>0){const[o,...u]=t,l=a(o[2],n),f=l[1],d=l[2],p=a(o[2],r),g=p[1],h=p[2];return Se.operation(e,o[1],f,g,i,s).concat(c(u,d,h))}throw new Error("Non exhaustive match in recurse")};return(0,j.GY)((0,j.Qp)((e=>"bottom"===e.kind))((0,j.GY)(c(t,n,r))))}(e,n,r.tuple,i.tuple,Ie,H.Df)))}throw new Error(`Non matching payload. Got ${r.kind} and ${i.kind}`)},s=(e,n)=>{if((0,o.Eh)((0,M.Eh)((0,B.n_)({1:(0,B.n_)({operation:A.Eq,bound:(0,o.Eh)(H.Eq)}),2:H.Eq}))).equals(e.commands,n.commands)){const r=(0,o.Wi)(e.commands)?t:e.commands,s=i(r,e.payload,n.payload);return C(s,(t=>O(e.commands,t)))}if(s=e.commands,a=n.commands,(0,o.Eh)((0,M.Eh)((0,B.n_)({1:(0,B.n_)({operation:A.Eq}),2:H.Eq}))).equals(s,a)){const s=(0,r.zG)(((e,t)=>(0,r.zG)((0,ye.gz)(o.G5)(e,t),(0,o.UI)((([e,t])=>M.yL(e,t,((e,t)=>({1:{operation:e[1].operation,bound:(0,r.zG)((0,ye.gz)(o.G5)(e[1].bound,t[1].bound),o.UI((([e,t])=>Math.min(e,t))),o.wp((()=>e[1].bound)),o.wp((()=>t[1].bound)))},2:e[2]})))))))(e.commands,n.commands),o.wp((()=>t))),a=i(s,e.payload,n.payload);return C(a,(e=>O(s,e)))}throw new Error(`Non matching primitive strings. Got ${re(e)} and ${re(n)}`);var s,a};return(t,n)=>ie(x(Se.extend(e,s,de(t).state,de(n).state)))}function qe(e,t,n){const r=(0,o.UI)((t=>$(e,(([e,r])=>(0,D.gf)(n)(e,t)))))(t);return(0,o.fS)((()=>e))(r)}function Ue(e,t){switch(e.kind){case"unbounded":return e;case"windowed":return(0,o.Wi)(e.key)?e:G(qe(e.group,e.key,t),e.key);case"countLimit":{const n=e.limit,r=e.n,i=e.group,s=N(r,i,((e,t)=>t<=1?o.YP:(0,o.G)(t-1)),t),a=(0,D.Fp)((0,o.pR)(t))(n,s);return z(qe(i,a,t),a,r)}case"uniqueLimit":{const n=e.limit,r=e.n,i=e.group,s=(e,t)=>{if("object"===e.kind){const n=[...e.value.keys(),...t.keys()],i=new Set(n);return i.size>=r?o.YP:(0,o.G)(i)}return o.YP},a=N(new Set,i,s,t),c=(0,D.Fp)((0,o.pR)(t))(n,a);return q(qe(i,c,t),c,r)}}}function Ee(e,t){return(n,r)=>Se.extend(e,((e,n)=>S(t(e,n))),n,r)}function Pe(e,t){return Ge("append",e,t)}function xe(e,t){return Ge("join",e,t)}var Oe=n(54),De=n(491),Ae=n(716),Ce=n(543),Te=n(560),Me=n(219);function je(e,t){return function(n){return e.map(n,t.compact)}}function Re(e,t,n){var i=je(e,t),s=(0,Te.UI)(e,n);return function(e){return Me.s4(i((0,r.zG)(e,s(o.IS))),i((0,r.zG)(e,s(o.EK))))}}function Fe(e,t){return function(n){return function(r){return e.map(r,(function(e){return t.filter(e,n)}))}}}function Qe(e,t){return function(n){return function(r){return e.map(r,(function(e){return t.filterMap(e,n)}))}}}function Le(e,t){var n=Fe(e,t);return function(e){var t=n((0,De.ff)(e)),r=n(e);return function(e){return(0,Me.s4)(t(e),r(e))}}}function Ne(e,t){var n=Qe(e,t);return function(e){return function(t){return(0,Me.s4)((0,r.zG)(t,n((function(t){return(0,o.IS)(e(t))}))),(0,r.zG)(t,n((function(t){return(0,o.EK)(e(t))}))))}}}var Ye=n(395),$e=n(272),Be=n(963);function He(e){return(0,r.ls)(o.G,e.of)}function Ve(e){return(0,r.a9)(e.of(o.YP))}function Ke(e){return function(t){return e.map(t,o.G)}}function We(e){return(0,r.ls)(o.ij,e.of)}function Xe(e){var t=We(e);return function(e){return(0,r.ls)(e,t)}}function Ze(e){var t=ct(e),n=Xe(e);return function(e){return t(n(e))}}function Je(e){return function(t){return(0,r.ls)(t,e.of)}}function et(e){var t=ct(e),n=Je(e);return function(e){return t(n(e))}}function tt(e){return function(t){return function(n){return e.of(o.DT(t)(n))}}}function nt(e){return(0,r.ls)(o.Uo,e.of)}function rt(e){return function(t,n){return function(r){return e.map(r,o.EQ(t,n))}}}function it(e){return function(t,n){return function(r){return e.chain(r,o.EQ(t,n))}}}function st(e){return function(t){return function(n){return e.chain(n,o.EQ(t,e.of))}}}function ot(e){return(0,Te.UI)(e,o.dO)}function at(e){return(0,ye.ap)(e,o.G5)}function ct(e){var t=Ve(e);return function(n){return function(r){return e.chain(r,o.EQ((function(){return t()}),n))}}}function ut(e){var t=He(e);return function(n){return function(r){return e.chain(r,o.EQ(n,t))}}}var lt=n(940),ft=He(lt.PM),dt=(lt.PM,lt.of),pt=(lt.PM,function(e){return gt(lt.tD(e))}),gt=Ke(lt.dO),ht=lt.UI(o.Uo),mt=(lt.dO,it(lt.qo)),vt=(lt.UA,lt.PM,lt.PM,lt.UA,lt.PM,et(lt.UA)),bt=ot(lt.dO),wt=at(lt.Hi),_t=ft,yt=ct(lt.UA),St=(lt.UA,lt.PM,lt.dO,o.Ri,lt.dO,o.Ri,o.dO,Fe(lt.dO,o.xu)),It=(lt.dO,o.xu,lt.dO,o.xu,lt.dO,o.xu,function(e,t){return(0,r.zG)(e,bt(t))}),kt=function(e,t){return(0,r.zG)(e,wt(t))},Gt=function(e,t){return(0,r.zG)(e,yt(t))},zt="TaskOption",qt={URI:zt,map:It},Ut={URI:zt,map:It,ap:kt,chain:Gt},Et={URI:zt,fromIO:pt},Pt=(0,Ye.At)(Et,Ut),xt={URI:zt,fromIO:pt,fromTask:gt},Ot=(0,$e.wt)(xt),Dt=(0,$e.oU)(xt,Ut),At=(Be.F4,(0,Te.Hr)(qt)),Ct=(0,Ce.a)(Ut),Tt=(Be.Xl,He(d.PM)),Mt=(d.PM,d.of,d.PM,d.dO,o.Uo,d.dO,d.qo,d.UA,d.UI(o.FS),d.UI(o.WG),d.PM,d.PM,d.UA,d.PM,d.UA,d.dO,d.G5,Tt),jt=(d.UA,ut(d.UA)),Rt=(d.PM,d.dO,o.Ri,d.dO,o.Ri,o.dO,d.dO,o.xu,d.dO,o.xu,d.dO,o.xu,d.dO,o.xu,Be.F4,Be.Xl,n(583));const Ft=new Set(["AdRequest","Reaction","PageviewEngagement","SegmentEntry","SegmentExit"]),Qt=e=>i.dQ((t=>{let{previousState:n}=t;const[i,a]=s.Ue(!1);const[c,u]=s.gS({empty:o.YP,concat:(e,t)=>(0,r.zG)(Rt.oA([e,t]),o.DT(Rt.Od),o.UI((e=>e.reduce(((e,t)=>({...e,...t}))))))}),l=(0,r.zG)((0,g.Kn)(n)?n:{},(0,g.rO)({stateOffset:(0,r.ls)(o.DT(g.BJ),o.fS((()=>0))),fetchUnseenKey:(0,r.ls)(o.DT(g.HD),o.fS((()=>"")))})),f=(0,r.zG)(s.gS(o.uZ({concat:function(e,t){return Object.assign({},e,t)}})),(t=>{let[n,i]=t;return(0,r.zG)(s.vP(e.lastProcessedEvents,e.internalStateDiff,e.queryLanguageProcessing),s.bw((e=>{let[t,n,r]=e;if(r)return;return t().filter((e=>!Ft.has(e.name))).length>0?i(n()):void 0}))),(0,r.zG)(s.vP({internalStateDiff:n,internalStateMap:e.internalStateMap}),s.D8(((e,t)=>e.internalStateDiff===t.internalStateDiff)))})),d=(0,r.zG)(s.vP(e.sessionId,f,i),s.Rp(s.a9({...l,inFlightRequest:!1,previousDecodedState:(0,r.zG)(e.internalStateMap.current,Nt,W,R.fS((()=>w(new Map)))),sendFullStateWithUnseen:!1}),((t,n)=>{let[i,{internalStateDiff:a,internalStateMap:c},l]=n;return(0,r.zG)(t,s.VS((t=>{if(t.inFlightRequest)return s.a9(t);const n=!l&&t.sendFullStateWithUnseen,f=n||!e.groupIdIsNewlyGenerated&&i!==t.fetchUnseenKey;return(0,r.zG)(n?Mt(c):a,jt((()=>()=>(0,r.zG)({},o.DT((()=>f))))),lt.tD,yt((0,r.ls)($t(t.previousDecodedState),Ae.Vn((0,g.bw)((t=>e.logger.error(t)))),ht)),mt((()=>lt.of({...t,inFlightRequest:!1})),(0,r.ls)(lt.of,lt.ak("processed",(n=>(0,r.zG)(e,Lt({delta:n.delta,stateOffset:t.stateOffset,fetchUnseen:f}),lt.UI((0,g.bw)((0,r.ls)(o.UI((0,g.vg)("stateDelta")),o.hX(De.ff(Oe.xb)),u)))))),lt.UI((e=>({fetchUnseenKey:i,inFlightRequest:!1,sendFullStateWithUnseen:t.sendFullStateWithUnseen&&!n,previousDecodedState:e.decodedState,stateOffset:(0,r.zG)(e.processed,o.UI((e=>e.response.state_offset)),o.fS((()=>t.stateOffset)))}))))),s.fF,s.UI(o.fS((()=>({...t,inFlightRequest:!0})))))})))})),s.xH,s.UI((e=>({stateOffset:e.stateOffset,fetchUnseenKey:e.fetchUnseenKey}))),s.D8((0,B.MW)({stateOffset:H.Eq,fetchUnseenKey:A.Eq})));return{state:d,value:{externalStateDelta:c}}})),Lt=e=>t=>(0,r.zG)(e,o.DT((e=>e.fetchUnseen||De.ff(Oe.xb)(e.delta))),dt,yt((e=>{return(0,r.zG)(t,(n={event_source_id:t.eventSourceId,fetch_unseen:e.fetchUnseen,group_id:t.groupId,last_seen_offset:e.stateOffset,state:e.delta},e=>Ae.Y3((()=>e.permutiveApi.req({url:e.permutiveUrls.getEndpointUrl("/state",o.G("v1.0"),[["fetch_unseen",JSON.stringify(n.fetch_unseen)]]),method:"POST",payload:{group_id:n.group_id,event_source_id:n.event_source_id,state:JSON.stringify(n.state),last_seen_offset:n.last_seen_offset},contentType:"text/plain",dataType:"json",withCredentials:!1})),(e=>`Error sending state delta. Got ${R.KC(e)}`))),Ae.Vn((0,g.bw)((e=>t.reportError(e)))),ht,St((e=>!!e)),vt((0,r.ls)(R.of,R.YO("response"),R.ak("stateDelta",(e=>{return t=e.response.state,(0,R.Y3)((function(){return JSON.parse(t)}),r.yR);var t})),R.Vn((0,g.bw)((e=>t.reportError(`Failed to parse State API response, got ${e}`)))),o.Uo)));var n}))),Nt=e=>(0,g.b0)(e,((e,t)=>t.state?o.G({[t.checksum]:t.state}):o.YP)),Yt=e=>t=>{const n=(0,r.zG)(t,Nt,W,R.fS((()=>w(new Map))),(t=>Ge("delta",t,e)));return{decodedState:xe(n,e),delta:(0,r.zG)(n,K,o.ij,o.fS((()=>({}))))}},$t=e=>t=>()=>new Promise((n=>(0,p.HJ)((()=>(0,r.zG)(t,R.it(Yt(e),(e=>`Failed to compute delta for state sync. Got ${e}`)),n)))));n(511),Oe.dp;var Bt=Oe.xb,Ht=function(e){return function(t){return Object.keys(t).sort(e.compare)}};A.Df;Oe.dx,Oe.e$;Oe.Bu,Oe.P5,Oe.Su;var Vt=Oe.UI;Oe.ri;function Kt(e){return Oe.vP(e)}Oe._r;Oe.jt;Oe.yW,Oe.G,Oe.t9;var Wt=Oe.HA,Xt=(Oe.nn,Oe.kp),Zt=Oe.CC,Jt=Oe.RF,en=(Oe.I8,Oe.mS,Oe.RJ,Oe._Y,Oe.V_),tn=Oe.EW,nn=Oe.nu,rn=(Oe.SW,Oe.zV,Oe.Ub,Oe.vA,Oe.qS),sn=(Oe.mK,function(e){return function(t){var n=Ht(e);return function(e,r){var i=n(e);if(0===i.length)return t.of({});for(var s=t.of({}),o=function(n){s=t.ap(t.map(s,(function(e){return function(t){return e[n]=t,e}})),r(n,e[n]))},a=0,c=i;a<c.length;a++){o(c[a])}return s}}}),on=Oe.hX;Oe.DZ,Oe.uK,Oe.tV;Oe.oA,Oe.oh;var an="Record";var cn=Oe.Eh,un=(Oe.uZ,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,Oe.nr,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,A.Df,n(865)),ln=n(350),fn=function(e){return function(t){return[void 0,e(t)]}},dn=function(e){return function(t){return[e(t),t]}},pn=function(e,t){return(0,r.zG)(e,mn(t))},gn=function(e,t){return(0,r.zG)(e,vn(t))},hn=function(e,t){return(0,r.zG)(e,wn(t))},mn=function(e){return function(t){return function(n){var r=t(n),i=r[0],s=r[1];return[e(i),s]}}},vn=function(e){return function(t){return function(n){var r=t(n),i=r[0],s=r[1],o=e(s),a=o[0],c=o[1];return[i(a),c]}}},bn=function(e){return function(t){return[e,t]}},wn=function(e){return function(t){return function(n){var r=t(n),i=r[0],s=r[1];return e(i)(s)}}},_n="State",yn={URI:_n,map:pn},Sn={URI:_n,map:pn,ap:gn},In=(0,ye.N)(Sn),kn=(0,ye.a1)(Sn),Gn={URI:_n,map:pn,ap:gn,of:bn},zn={URI:_n,map:pn,ap:gn,chain:hn},qn=(0,Ce.m)(zn),Un=(r.yR,(0,Te.YO)(yn)),En=(0,Ce.a)(zn),Pn=function(e){var t=function(e){return function(t){return function(n){for(var r=e(0,Be.YM(t))(n),i=[r[0]],s=r[1],o=1;o<t.length;o++){var a=e(o,t[o])(s),c=a[0],u=a[1];i.push(c),s=u}return[i,s]}}}(e);return function(e){return Be.Od(e)?t(e):bn(Be.Xl)}},xn=function(e){return Pn((function(t,n){return e(n)}))},On=xn(r.yR);const Dn=e=>({aggregations:{PageviewEngagement:{engaged_time:0},SegmentEntry:new Set,SegmentExit:new Set,CohortEntry:new Set,CohortExit:new Set},customProperties:{},sessionId:e.sessionId,viewId:e.viewId}),An=e=>t=>{const n=new Set(t);return n.add(e),n},Cn=e=>t=>{const n=new Set(t);return n.delete(e),n},Tn=e=>[...e];var Mn,jn,Rn=n(277);!function(e){e.init=function(e){return e&&"object"==typeof e&&"externalStateMap"in e&&"internalStateMap"in e?e:{externalStateMap:o.YP,internalStateMap:{},migrationVersion:hr}}}(Mn||(Mn={})),function(e){e.sequenceNonEmptyArray=e=>{if(1===e.length)return e[0];const t=(0,r.bc)([],{},[]);for(const n of e){t[0].push(...n[0]);for(const e in n[1])t[1][e]=n[1][e];t[2].push(...n[2])}return t},e.sequenceArray=t=>(0,r.zG)(t,o.DT(Rt.Od),o.UI(e.sequenceNonEmptyArray)),e.empty=[Rt.cS,Oe.cS,Rt.cS],e.ofOutputEvent=e=>[Rt.cS,Oe.cS,[e]]}(jn||(jn={}));const Fn=e=>gr((t=>(0,r.zG)(Qn((e=>({...e,getCurrentSession:()=>t.environment.sessionId,getCurrentView:()=>t.environment.viewId}))),wn((()=>{return On([Ln(e),Bn(t.environment.thirdPartyData),(i=t.environment.lookalikeModels,(0,r.zG)((function(e){return[e,e]}),wn((e=>cr.equals(e.lal,i)?bn(Rt.cS):(0,r.zG)(fn((0,g.rO)({lal:(0,r.a9)(i)})),In(Qn(function(e){const t=(0,r.zG)(e,o.fS((()=>({}))));return e=>({...e,getLookalikeModels:()=>t})}(i))),wn((()=>(0,r.zG)(Rt.Yo(i),xn((()=>Wn("updateLAL"))),mn(Rt.xH))))))))),(0,r.zG)(t.externalStateDelta,o.UI(Kn),o.fS((()=>bn(Rt.bM())))),(n=t.cloudLiftedState,(0,r.zG)(n,Rt.tS((e=>Object.entries(e))),xn((e=>{let[t,n]=e;return dn((e=>(0,r.bc)(t,e.queries.runtime.cloudLiftedQueries[t],n)))})),wn((e=>Jn(R.F2(e)))))),Xn(t.newEvents)]);var n,i})),mn((0,r.ls)(Rt.xH,o.DT(Rt.Od),o.tS(jn.sequenceArray))),(e=>t=>{let[n,i]=e(t);if(o.pC(n)){let e=n.value,t=0;for(;e[2].length>t;)t=e[2].length,[e,i]=(0,r.zG)(i,(0,r.zG)(Xn(e[2]),mn((t=>jn.sequenceNonEmptyArray([e,...t])))));n=o.G(e)}return(0,r.bc)(n,i)}),pr(e,"query_language_process_duration")))),Qn=e=>fn((0,g.rO)({effects:e}));function Ln(e){return(0,r.zG)((function(e){return[e,e]}),wn((t=>{let{bootstrapped:n,effects:i,eventsForReplay:s}=t;return n?bn(Rt.cS):(0,r.zG)(fn((e=>({...e,bootstrapped:!0,eventsForReplay:[]}))),qn(Nn),wn((()=>(0,r.zG)(s,Rt.R3(dr(i)),xn(Zn("bootstrap")),mn(Rt.xH)))),pr(e,"query_language_bootstrap_duration"))})))}const Nn=()=>fn((e=>(0,r.zG)(e.invalidatedQueries,Rt.EQ((()=>e),Yn(e))))),Yn=e=>t=>{const n=(0,r.zG)(t,Rt.UI((t=>(0,r.bc)(t,{checksum:e.queries.metadata[t]}))),(e=>Object.fromEntries(e)));return(0,r.zG)(e,(0,g.rO)({persistentState:(0,g.rO)({internalStateMap:e=>({...n,...e})})}))},$n=(0,r.zG)(dn((e=>e.tpdQueries)),wn(o.EQ((()=>(0,r.zG)(dn((e=>new Set([...e.queries.runtime.queriesByEvent["!UpdateSecondPartyData"]||[],...e.queries.runtime.queriesByEvent["!UpdateThirdPartyData"]||[]]))),qn((e=>fn((0,g.rO)({tpdQueries:()=>o.G(e)})))))),bn)));function Bn(e){const t=(0,r.zG)(e,o.UI(a.li));return(0,r.zG)((function(e){return[e,e]}),wn((n=>{if(o.Eh(H.Eq).equals(t,n.tpdHashInEffectsObject))return bn(Rt.cS);const i=o.FS(t);return(0,r.zG)(fn((0,g.rO)({persistentState:(0,g.rO)({tpdHash:(0,r.a9)(i)}),tpdHashInEffectsObject:(0,r.a9)(t),tpdReady:(0,r.a9)(o.pC(e))})),mn((()=>(0,r.zG)(e,o.UI(a.Yg)))),qn((e=>Qn(function(e){const t=ur((()=>(0,r.zG)(e,o.fS((()=>({"3p":{}}))))));return e=>{const n=ur((()=>({...t(),...e.get1PSegments()})));return{...e,getSegments:n,getSegmentsArray:ur((()=>fr(n()))),get3PSegments:t}}}(e)))),wn(o.fw(Gn)((()=>(0,r.zG)(n.tpdEventsToProcess,Rt.EQ((()=>i!==n.persistentState.tpdHash?Wn("updateTPD"):bn(Rt.cS)),(0,r.ls)(xn(Zn("updateTPD")),In(fn((e=>({...e,tpdEventsToProcess:[]})))),mn(Rt.xH))))))),mn(o.fS((()=>Rt.bM()))))})))}const Hn=e=>Oe.jt(((t,n)=>(0,r.zG)(Oe.P5(t,e.metadata),o.tS((e=>Oe.P5(e,n))),o.tS((n=>(0,r.zG)(Oe.P5(t,e.runtime.locallyLiftedQueries),o.wp((()=>Oe.P5(t,e.runtime.cloudLiftedQueries))),o.NG((e=>e.compact(n)))))),o.tS((0,r.ls)(W,o.Uo))))),Vn=(e,t)=>{if(Oe.xb(e))return t;if(Oe.xb(t))return e;const n={...e};for(const e in t)n[e]=(0,r.zG)(o.ij(n[e]),o.EQ((()=>t[e]),(n=>(0,r.zG)(o.Y3((()=>xe(n,t[e]))),o.fS((()=>t[e]))))));return n};function Kn(e){return(0,r.zG)(dn((t=>(0,r.zG)(e,Hn(t.queries),(e=>(0,r.zG)(t.persistentState.externalStateMap,o.UI(Oe.DZ((0,r.ls)(W,o.Uo))),o.EQ((()=>e),(t=>Vn(t,e))))),Oe.UI(K)))),wn((e=>fn((0,g.rO)({persistentState:(0,g.rO)({externalStateMap:(0,r.a9)(o.G(e))})})))),wn((()=>Wn("updateExternalState"))))}function Wn(e){return(0,r.zG)(dn((e=>dr(e.effects))),wn(Zn(e)))}function Xn(e){return(0,r.zG)(e,Rt.EQ((()=>bn(Rt.bM())),(0,r.ls)(nr,wn(xn((e=>{let[t,n]=e;return(0,r.zG)(n,Zn(t))}))),mn(Rt.xH))))}function Zn(e){return(0,r.ls)(bn,qn((e=>"Pageview"!==e.name?bn(void 0):fn((0,g.rO)({pageviewProperties:(0,r.a9)(e.properties)})))),"bootstrap"===e?r.yR:qn((e=>{return fn((0,g.rO)({unprocessedPageviewComplete:(t=e,e=>{switch(t.name){case"Pageview":return t.view_id!==e.viewId?e:{...e,customProperties:t.properties};case"SegmentEntry":{const n=t.properties.segment_number;return(0,r.zG)(e,(0,g.rO)({aggregations:e=>e.SegmentExit.has(n)?(0,r.zG)(e,(0,g.rO)({CohortExit:Cn(String(n)),SegmentExit:Cn(n)})):(0,r.zG)(e,(0,g.rO)({CohortEntry:An(String(n)),SegmentEntry:An(n)}))}))}case"SegmentExit":{const n=t.properties.segment_number;return(0,r.zG)(e,(0,g.rO)({aggregations:e=>e.SegmentEntry.has(n)?(0,r.zG)(e,(0,g.rO)({CohortEntry:Cn(String(n)),SegmentEntry:Cn(n)})):(0,r.zG)(e,(0,g.rO)({CohortExit:An(String(n)),SegmentExit:An(n)}))}))}case"PageviewEngagement":{if(t.view_id!==e.viewId)return e;const n=t.properties;return(0,r.zG)(e,(0,g.rO)({aggregations:(0,g.rO)({PageviewEngagement:()=>({engaged_time:n.total_engaged_time,completion:n.total_completion})})}))}default:return e}})}));var t})),qn((e=>{return sr(e)?Qn((t=e.properties.segment_number,n="SegmentEntry"===e.name,e=>{return(0,r.zG)(e,(i={"1p":{...e.get1PSegments()["1p"],[t]:n}},e=>{const t=ur((()=>({...i,...e.get3PSegments()})));return{...e,getSegments:t,getSegmentsArray:ur((()=>fr(t()))),get1PSegments:()=>i}}));var i})):bn(void 0);var t,n})),Un("event"),En("queriesToProcess",(t=>{let{event:n}=t;return function(e,t){return(0,r.zG)((function(e){return[e,e]}),Un("state"),En("tpdQueriesToReject",(e=>{let{state:{tpdReady:t}}=e;return t?bn(o.bM()):(0,r.zG)($n,mn(o.DT((e=>e.size>0))))})),wn((n=>{let{state:i,tpdQueriesToReject:s}=n;const a=(0,r.zG)(s,o.UI((e=>Rt.hX((t=>!e.has(t))))),o.fS((()=>e=>e)));switch(e){case"bootstrap":return bn((0,r.zG)(i.queriesForReplay,a));case"event":const e=i.tpdReady?bn(void 0):fn((0,g.rO)({tpdEventsToProcess:Rt.R3(t)}));return(0,r.zG)(bn(i.locallyLiftedQueriesByEvent[t.name]||[]),mn(a),In(e));case"lookalikeTransition":return bn(i.locallyLiftedQueriesByEvent[t.name]||[]);case"transition":const n=i.locallyLiftedQueriesByEvent[t.name]||[];if(o.pC(i.lal)){const e=i.locallyLiftedQueriesByEvent["!UpdateLookalikeModels"]||[];return bn(n.concat(e))}return bn(n);case"updateExternalState":return bn((0,r.zG)(i.persistentState.externalStateMap,o.fS((()=>({}))),Oe.XP));case"updateLAL":return bn(i.locallyLiftedQueriesByEvent["!UpdateLookalikeModels"]||[]);case"updateTPD":return bn([...i.locallyLiftedQueriesByEvent["!UpdateSecondPartyData"]||[],...i.locallyLiftedQueriesByEvent["!UpdateThirdPartyData"]||[]]);default:return bn([])}})))}(e,n)})),wn((t=>{let{event:n,queriesToProcess:i}=t;return(0,r.zG)(i,Rt.EQ((()=>bn(Rt.bM())),(t=>(0,r.zG)(dn((t=>"bootstrap"!==e?t.effects:{...t.effects,getCurrentTime:()=>n.time,getCurrentView:()=>n.view_id,getCurrentSession:()=>n.session_id})),wn((e=>(0,r.zG)(dn((e=>(0,r.zG)(t,Rt.DZ((t=>(0,r.zG)(Oe.P5(t,e.queries.runtime.locallyLiftedQueries),o.wp((()=>Oe.P5(t,e.cloudLiftQueriesForReplay))),o.UI((e=>(0,r.bc)(t,e))))))))),wn((t=>Jn(R.t$((0,r.bc)(t,n)),e))))))))))})))}const Jn=(e,t)=>(0,r.zG)(e,R.EQ((e=>{let[n,i]=e;return(0,r.zG)(n,xn((e=>{let[n,r]=e;return er(n,R.t$([r,i]),t)})))}),xn((e=>{let[t,n,r]=e;return er(t,R.F2([n,r]))}))),mn(jn.sequenceArray),qn(o.fw(Gn)((e=>{let[,t]=e;return fn((0,g.rO)({persistentState:(0,g.rO)({internalStateMap:e=>({...e,...t})})}))}))),mn(Rt.Yo)),er=(e,t,n)=>(0,r.zG)(dn(R.it((i=>{var s,c,u;const l=n??i.effects,f=(0,r.zG)(t,R.EQ(a.li,a.li)),[d,p]=(0,r.zG)(t,R.aD((e=>{let[t,n]=e;return(0,r.bc)(t.lift(n,l),ar({null:null,encode:r.yR,decode:R.of,append:t.append}))}),(e=>{let[,t]=e;return(0,r.bc)(t,ar(or()))}))),g=(0,r.zG)(i.persistentState.externalStateMap,o.tS(Oe.P5(e))),h=i.persistentState.internalStateMap[e]||{checksum:i.queries.metadata[e]},m=p(e,l,f,h,g,d),v=Boolean(null===(s=m.result)||void 0===s?void 0:s.result)!==Boolean(null===(c=i.persistentState.internalStateMap[e])||void 0===c||null===(u=c.result)||void 0===u?void 0:u.result),b=(0,r.zG)(Rt.lo(v),Rt.UI((()=>{var t;return{name:null!==(t=m.result)&&void 0!==t&&t.result?"SegmentEntry":"SegmentExit",time:l.getCurrentTime(),view_id:l.getCurrentView(),session_id:l.getCurrentSession(),properties:{...i.pageviewProperties,segment_number:Number(e)}}})));return(0,r.bc)(m,b)}),(t=>`Failed to interpret query ${e}. Got ${t}`))),wn(R.EQ((e=>bn([[e],Oe.cS,Rt.cS])),(t=>{let[n,i]=t;return(0,r.zG)(n.dropExternalState?tr(e):bn(void 0),mn((()=>[Rt.cS,{[e]:n},i])))})))),tr=e=>fn((0,g.rO)({persistentState:(0,g.rO)({externalStateMap:o.UI(Oe.EG(e))})}));function nr(e){const t=e=>t=>(0,r.bc)(e,t);return dn((n=>(0,r.zG)(e,Rt.pO(ln.aL(((e,t)=>{const n=sr(e);return(0,r.zG)(t,Rt.zT((e=>sr(e)===n)),(e=>{let{init:t,rest:n}=e;return(0,r.bc)(t,n)}),(0,a.pL)(((e,t)=>n=>(0,r.bc)(e,(0,r.zG)(n,Rt.Ce(t))))(n,e)))}))),Rt.tS((e=>{let[i,s]=e;if(!i)return(0,r.zG)(s,Rt.UI(t("event")));const o=(0,r.zG)(s,Rt.yW((e=>n.lookalikeTransitionSegmentNumbers.has(e.properties.segment_number))),(e=>e?"lookalikeTransition":"transition"));return(0,r.zG)(s,ln.ut(((e,n)=>(0,r.zG)(e,Rt.UI(t("event")),Rt.R3((0,r.zG)(n,t(o)))))))})))))}const rr=(0,r.ls)(Oe.hX((e=>{var t;return Boolean(null===(t=e.result)||void 0===t?void 0:t.result)})),Oe.XP,Rt.UI(parseInt)),ir=(0,r.ls)(Vt((e=>e.activations??{})),on((0,r.zG)(Boolean,(0,De.xD)((0,De.ff)(Bt)))));function sr(e){var t;return("SegmentEntry"===e.name||"SegmentExit"===e.name)&&void 0!==(null===(t=e.properties)||void 0===t?void 0:t.segment_number)}const or=()=>({null:{kind:"null",value:null},encode:K,decode:W,append:Pe}),ar=e=>(t,n,i,s,a,c)=>{const u={...s.activations},l={...n,setSegmentActivation:(e,n,r)=>{if(r!=t)throw new Error(`QL called setSegmentActivation for query ${r} while interpreting query ${t}`);e in u?u[e].includes(n)||(u[e]=[...u[e],n]):u[e]=[n]}},f=o.ij(s.state),d=o.ij(c),p=(0,r.zG)((0,ye.gz)(o.G5)(f,d),o.UI((t=>{let[n,i]=t;const s=(0,r.zG)(e.decode(n),R.fS((()=>e.null))),o=(0,r.zG)(e.decode(i),R.fS((()=>e.null)));try{return R.F2(e.append(s,o))}catch(e){throw(0,un.w)(`Failed to append lifted event ${JSON.stringify(i)} to internal state ${JSON.stringify(n)}. Got ${e}`)}})),o.Gk((()=>(0,r.zG)(f,o.wp((()=>d)),o.UI(R.t$))))),h=(0,r.zG)(p,o.UI(R.EQ(r.yR,e.encode)),o.tS(o.ij)),{overallState:m,dropExternalState:v}=(0,r.zG)((0,ye.gz)(o.G5)(p,a),o.UI((t=>{let[n,i]=t;return(0,r.zG)(o.Uo(e.decode(i)),o.tS((t=>(0,r.zG)(n,R.vx(e.decode),R.fS((()=>e.null)),o.it((n=>e.append(n,t)))))),o.EQ((()=>({overallState:h,dropExternalState:!0})),(t=>({overallState:o.ij(e.encode(t)),dropExternalState:!1}))))})),o.fS((()=>(0,r.zG)(h,o.Gk((()=>a)),(e=>({overallState:e,dropExternalState:!1}))))),(0,g.rO)({overallState:o.WG})),b=i.interpret(m,l);return{checksum:s.checksum,...(0,r.zG)(h,o.aD((()=>({})),(e=>({state:e})))),...!1===b.result?{}:{result:b},...Bt(u)?{}:{activations:u},...!1===v?{}:{dropExternalState:v}}},cr=o.Eh({equals:(e,t)=>e===t});function ur(e){let t,n=!1;return()=>(n||(t=e(),n=!0),t)}function lr(e){const t=ur((()=>(0,r.zG)(e,Oe.hX((e=>{var t;return Boolean(null===(t=e.result)||void 0===t?void 0:t.result)})),Oe.UI((()=>!0)),(e=>({"1p":e}))))),n={"3p":{}},i=ur((()=>({...t(),...n})));return{getSegments:i,getSegmentsArray:ur((()=>fr(i()))),get1PSegments:t,get3PSegments:()=>n}}function fr(e){return Object.keys(e).reduce(((t,n)=>{const r=Object.keys(e[n]),i=[];return r.forEach((t=>{!0===e[n][t]&&i.push(t)})),t[n]=i,t}),{})}const dr=e=>({name:"",properties:{},session_id:e.getCurrentSession(),view_id:e.getCurrentView(),time:e.getCurrentTime()}),pr=(e,t)=>n=>r=>{const i=e.startSpan(t),s=n(r);return i.finish(),s},gr=e=>t=>(0,r.zG)(fn((0,g.rO)({unprocessedPageviewComplete:(0,r.ls)(o.DT((e=>e.viewId===t.environment.viewId)),o.fS((()=>Dn(t.environment))))})),kn(dn((e=>(0,r.zG)(o.ij(e.persistentState.unprocessedPVC),o.hX((e=>e.view_id!==t.environment.viewId)),o.UI(Rn.k))))),Un("flushedPvc"),En("processingResult",(n=>{let{flushedPvc:i}=n;return e({...t,newEvents:(0,r.zG)(i,o.EQ((()=>t.newEvents),(e=>[...t.newEvents,e])))})})),qn((()=>fn((e=>{return{...e,persistentState:{...e.persistentState,unprocessedPVC:(0,Rn.X)((t=new Date,n=e.unprocessedPageviewComplete,{name:"PageviewComplete",time:t,session_id:n.sessionId,view_id:n.viewId,properties:{...n.customProperties,aggregations:(0,r.zG)(n.aggregations,(0,g.rO)({SegmentEntry:Tn,SegmentExit:Tn,CohortEntry:Tn,CohortExit:Tn}))}}))}};var t,n})))),mn((e=>{let{flushedPvc:t,processingResult:n}=e;const i=(0,r.zG)(t,o.UI(jn.ofOutputEvent));return(0,r.zG)((0,ye.gz)(o.G5)(i,n),o.UI(jn.sequenceNonEmptyArray),o.wp((()=>i)),o.wp((()=>n)))}))),hr=2,mr=e=>t=>{const n=t.migrationVersion??(t.stateIsCompact?1:0);return(0,r.zG)([vr,br],Rt.md(n),Rt.EQ((()=>t),(0,r.ls)(Rt.OV(e),Rt.u4(t,((e,t)=>t(e))),(0,g.rO)({migrationVersion:()=>hr}))))},vr=e=>(0,g.rO)({externalStateMap:o.UI(Oe.jt(((t,n)=>(0,r.zG)(Oe.P5(t,e.locallyLiftedQueries),o.wp((()=>Oe.P5(t,e.cloudLiftedQueries))),o.NG((e=>e.compact(n))))))),internalStateMap:Oe.Su(((t,n)=>{if(null==(null==n?void 0:n.state))return n;const r=e.locallyLiftedQueries[t]||e.cloudLiftedQueries[t];return{...n,state:r.compact(n.state)}}))}),br=e=>{const t=new Set(e.queriesByEvent.PageviewEngagement??[]),n=new Set(e.queriesByEvent.PageviewComplete??[]);return(0,g.rO)({internalStateMap:Oe.z7((0,De.ff)((e=>t.has(e)&&n.has(e))))})},wr=(e,t)=>Oe.xb(t)?e:(0,r.zG)(e,Oe.z7((e=>!(e in t))));var _r=n(569),yr=n(878);const Sr=()=>e=>((0,r.zG)(e,s.UI((e=>e()))),s.a9({newResults:d.of(Rt.cS),pendingEvents:Rt.cS})),Ir=()=>()=>Ae.of((()=>({}))),kr=e=>[e,lt.of(e)],Gr=a.li,zr=a.Yg,qr=e=>t=>(0,r.zG)(zr(t),(t=>()=>new Promise((n=>{const r=t();r.then(o.G).then(n);const i=(0,p.HJ)((()=>n(o.YP)),e);r.then(i)})))),Ur="RefEventual",Er=s.UI(kr),Pr=e=>s.a9(kr(e)),xr=e=>t=>s.vP((0,r.zG)(t,s.UI(Gr),s.UI(e)),(0,r.zG)(t,s.UI(zr),s.UI(lt.UI(e)))),Or=e=>t=>s.vP((0,r.zG)(s.vP((0,r.zG)(e,s.UI(Gr)),(0,r.zG)(t,s.UI(Gr))),s.UI((e=>{let[t,n]=e;return n(t)}))),(0,r.zG)(s.vP((0,r.zG)(e,s.UI(zr)),(0,r.zG)(t,s.UI(zr))),s.UI((e=>{let[t,n]=e;return lt.ap(t)(n)})))),Dr=e=>t=>(0,r.zG)(t.current,qr(e),lt.UI(o.fS((()=>(e=>Gr(e.current))(t))))),Ar=s.UI(Gr),Cr=s.UI(zr),Tr={URI:Ur,map:(e,t)=>xr(t)(e)},Mr={URI:Ur,map:Tr.map,ap:(e,t)=>Or(t)(e)},jr=e=>i.dQ((t=>{let{previousState:n}=t;const[i,c]=(0,r.zG)(e.newEvents,s.En(2,Rt.uZ()),(0,_r.H5)(Sr(e.permutiveApi,e.permutiveUrls,(u=e.customQueries.runtime,(0,r.zG)(Object.entries(u.queriesByEvent),Rt.hX((e=>{let[,t]=e;return(0,r.zG)(t,Rt.G((e=>e in u.cloudLiftedQueries)))})),Rt.UI(a.li))))));var u;const l=s.vP({lookalikeModels:e.lookalikeModels,sessionId:e.sessionId,thirdPartyData:(0,r.zG)(e.thirdPartyData,s.UI(o.UI((0,_r.H5)(Oe.UI((e=>{const t={};return e.forEach((e=>t[e]=!0)),t})))))),viewId:e.viewId}),f=(0,r.zG)(s.vP({cloudLiftedState:(0,r.zG)(c,s.UI((e=>e.newResults))),environment:l,externalStateDelta:e.externalStateDelta,newEvents:(0,r.zG)(i,(0,yr.I)(e.metrics,"query_language_began_processing_pageview"))}),s.UI((0,g.rO)({environment:e=>d.of(e)})),s.UI((0,ye.Yt)(d.G5))),p=Mn.init(n);const h=(0,r.zG)(n?lt.of({processedState:p,stateMigratedThisInitialisation:!1}):(e.metrics.track({name:"sdk_query_state_migrated_workerisation_count_total",labels:{},value:1}),(0,r.zG)(e.migratedStateMaps,lt.UI((e=>{let{internal:t,external:n}=e;return{stateMigratedThisInitialisation:!0,processedState:{externalStateMap:n,internalStateMap:(0,r.zG)(t,o.fS((()=>({}))))}}})))),lt.Hr("environment",(()=>l.current)),lt.ak("process",(t=>{let{environment:n,processedState:i}=t;return(0,r.zG)((s={downloadCloudLiftQueries:Ir(e.permutiveApi,e.permutiveUrls),environment:n,initialState:i,pastEvents:e.priorEvents,queries:e.customQueries},(0,r.zG)(lt.Do,lt.Hr("persistentState",(()=>(0,r.zG)(s.initialState,(0,g.rO)({internalStateMap:Oe.z7(((e,t)=>t.checksum===s.queries.metadata[e]))}),mr(s.queries.runtime)))),lt.Hr("invalidatedLocalQueries",(e=>{let{persistentState:{internalStateMap:t}}=e;return wr(s.queries.runtime.locallyLiftedQueries,t)})),lt.Hr("invalidatedCloudLiftQueries",(e=>{let{persistentState:{internalStateMap:t}}=e;return wr(s.queries.runtime.cloudLiftedQueries,t)})),lt.Hr("hasInvalidatedQueries",(e=>{let{invalidatedCloudLiftQueries:t,invalidatedLocalQueries:n}=e;return!(Oe.xb(t)&&Oe.xb(n))})),lt.ak("eventsForReplay",(e=>{let{hasInvalidatedQueries:t}=e;return t?s.pastEvents:lt.of(Rt.bM())})),lt.ak("cloudLiftQueriesForReplay",(0,r.ls)(o.DT((e=>e.eventsForReplay.length>0)),o.UI((e=>Object.keys(e.invalidatedCloudLiftQueries))),o.hX(Rt.Od),o.UI((0,r.ls)(s.downloadCloudLiftQueries,Ae.OV(s.queries.runtime),lt.UI(R.fS((()=>({})))))),o.fS((()=>lt.of({}))))),lt.Hr("queriesForReplay",(e=>{let{cloudLiftQueriesForReplay:t,invalidatedLocalQueries:n}=e;return[...Object.keys(n),...Object.keys(t)]})),lt.UI((e=>{let{cloudLiftQueriesForReplay:t,eventsForReplay:n,invalidatedCloudLiftQueries:i,invalidatedLocalQueries:a,queriesForReplay:c,persistentState:u}=e;return{bootstrapped:!1,cloudLiftQueriesForReplay:t,effects:{getCurrentTime:()=>new Date,getCurrentSession:()=>s.environment.sessionId,getCurrentView:()=>s.environment.viewId,getLookalikeModels:()=>({}),setSegmentActivation:(e,t,n)=>{throw new Error(`setSegmentActivation() called for segment ${n} without being overridden first.`)},...lr(u.internalStateMap)},eventsForReplay:n,invalidatedQueries:[...Object.keys(i),...Object.keys(a)],lal:o.YP,locallyLiftedQueriesByEvent:(0,r.zG)(s.queries.runtime.queriesByEvent,Oe.DZ(o.KQ(Rt.hX((e=>e in s.queries.runtime.locallyLiftedQueries))))),lookalikeTransitionSegmentNumbers:(0,r.zG)(s.queries.runtime.queriesByEvent["!UpdateLookalikeModels"]||Rt.cS,Rt.UI(parseInt),(e=>new Set(e))),pageviewProperties:{},numEventsForReplay:n.length,queries:s.queries,queriesForReplay:c,persistentState:u,tpdEventsToProcess:Rt.cS,tpdHashInEffectsObject:o.YP,tpdQueries:o.YP,tpdReady:!1,unprocessedPageviewComplete:Dn({sessionId:s.environment.sessionId,viewId:s.environment.viewId})}})))),e.trace.traceTask("query_language_initialisation_duration"),lt.UI((0,g.bw)((t=>{var n;e.metrics.trackTimeSinceInit("sdk_lifecycle_timestamps",{timestamp_name:"query_language_ready",time_origin:"sdk_init"},performance.now()),e.metrics.trackCounter({name:"sdk_queries_to_replay_count",value:(n=t,0===n.numEventsForReplay?0:n.queriesForReplay.length),labels:{}})}))),lt.UI((t=>{let n=t;const i=(0,r.zG)(e.validationService,o.OV(t.persistentState.externalStateMap));return t=>{const[s,a]=(0,r.zG)(t,Fn(e.trace))(n);return(0,r.zG)(i,o.OV((0,r.bc)(t,a))),n=a,[s,a.persistentState]}})));var s})),s.fF),m=(0,r.zG)(h,s.UI(o.UI((e=>e.process)))),v=(0,r.zG)(h,s.UI(o.EQ((()=>!1),(e=>e.stateMigratedThisInitialisation))));let b=Rt.bM();const w=(0,r.zG)(s.vP({processInput:m,inputIO:(0,r.zG)(f,s.UI(o.G))}),s.UI((0,ye.Yt)(o.G5)),s.UI(o.UI((e=>{let{processInput:t,inputIO:n}=e;const i=n(),[s,c]=(0,r.zG)(i,(0,g.rO)({newEvents:Rt.UI(a.Yg),cloudLiftedState:Rt.UI((e=>e.state))}),(e=>t({...e}))),u=(0,r.zG)(s,o.EQ((()=>({errors:[],events:i.newEvents,internalStateDiff:o.YP})),(e=>{let[t,n,r]=e;return{errors:t,events:i.newEvents.concat(r.map((e=>[(0,g.k$)(),e]))),internalStateDiff:o.G(n)}})));return b=(0,r.zG)(b,Rt.R3(u)),{consumeDeltas:()=>{const e=b;return b=Rt.cS,e},modelState:c}})))),_=(0,r.zG)(w,s.UI(o.UI((e=>e.modelState)))),y=(0,r.zG)(w,s.UI(o.UI((e=>e.consumeDeltas))),s.UI(o.fS((()=>d.of(Rt.bM()))))),S=(0,r.zG)(s.vP(_,c),s.Rp(((e,t)=>{let[n,i]=t;const s=(0,r.zG)(e,o.UI((e=>{let[,t]=e;return(0,r.zG)(n,o.EQ((()=>t),(e=>(0,r.zG)(t,Rt.hX((t=>!t(e,i.pendingEvents)))))))})),o.fS((()=>Rt.bM())));if(o.pC(n)&&Rt.xb(i.pendingEvents))return[kr(n.value),s];const a=(0,g.b2)(),c=(0,r.zG)(n,o.fS((()=>p)));var u;return[(0,r.zG)((()=>a.promise),(u=c,e=>[u,e])),(0,r.zG)(s,Rt.R3(((e,t)=>{const n=Rt.xb(t)||(0,r.zG)(i.pendingEvents,Rt.yW((e=>!t.includes(e))));return n&&a.resolve(e),n})))]})),s.UI(a.li)),I=(0,r.zG)(y,s.En(3,Rt.uZ()),(t=>{let[n,i,a]=t;return{errors:(0,r.zG)(n,s.UI(d.UI(Rt.tS((e=>e.errors))))),events:(0,r.zG)(i,s.UI(d.UI(Rt.tS((e=>e.events)))),(0,yr.F)(e.metrics,"query_language_processed_pageview")),internalStateDiff:(0,r.zG)(a,s.UI(d.UI((0,r.ls)(Rt.DZ((e=>e.internalStateDiff)),o.DT(Rt.Od),o.UI((e=>e.reduce(((e,t)=>({...e,...t})))))))))}})),k=(0,r.zG)(S,xr((e=>e.internalStateMap))),G=Ar(k);return{state:Ar(S),value:{...I,stateMigratedThisInitialisation:v,internalStateMap:G,processing:(0,r.zG)(s.vP(w,c),s.UI((e=>{let[t,n]=e;return o.Wi(t)||Rt.Od(n.pendingEvents)}))),segments:(0,r.zG)(k,xr(Rr)),tpdUsage:(0,r.zG)(s.vP(e.thirdPartyData,G),s.UI((e=>{let[t,n]=e;return(0,r.zG)(t,o.UI((()=>ir(n))))}))),unprocessedPageviewComplete:(0,r.zG)(_,s.UI(o.NG((e=>e.unprocessedPVC))),s.UI(o.UI(Rn.k)))}}})),Rr=e=>(0,r.zG)(rr(e),(e=>(0,r.zG)(e,Rt.uK((e=>e<1e7)),(t=>{let{left:n,right:r}=t;return{all:e,custom:r,standard:n}}))));var Fr=n(890);const Qr=e=>kr(R.F2(e)),Lr="RefEventualEither",Nr=e=>s.a9(Qr(e)),Yr=Te.UI(Tr,R.dO),$r=ye.ap(Mr,R.G5),Br=e=>(e=>t=>{const n=t();return(0,r.zG)(s.fF((()=>n)),s.UI(o.fS((()=>e))),s.UI((e=>(0,r.bc)(e,(()=>n)))))})(R.F2(e)),Hr=e=>xr(R.F2)(e),Vr=e=>xr(R.fS(e)),Kr={URI:Lr,map:(e,t)=>Yr(t)(e)},Wr={URI:Lr,map:Kr.map,ap:(e,t)=>$r(t)(e)},Xr=e=>Ar(e.all),Zr=(e,t)=>n=>({all:(0,r.zG)(n,Yr(e)),byAdServer:(0,g.mQ)((0,r.ls)(t,o.UI((e=>(0,r.zG)(n,Yr(e))))))}),Jr=(e,t)=>(0,r.ls)(xr(R.F2),Zr(e,t)),ei=e=>(0,r.zG)(e,xr(R.F2),Zr(r.yR,(e=>o.G(e.filterCohorts)))),ti=e=>({all:(0,r.zG)(e.all,Vr((()=>Rt.bM()))),byAdServer:(0,g.mQ)((0,r.ls)(e.byAdServer,o.UI(Vr((()=>Rt.bM())))))}),ni=e=>(0,r.zG)(e,ti,Xr),ri=new Set(["AdRequest","PageviewEngagement","PrebidAuctions","Reaction","SegmentEntry","SegmentExit","SlotRendered","ThirdPartySegments","VideoEngagement"]),ii=function(){return(0,r.bc)(...arguments)};var si=n(199);new Map;var oi=function(e,t){for(var n,r=new Map,i=e.entries();!(n=i.next()).done;){var s=n.value,o=s[0],a=s[1];r.set(o,t(o,a))}return r};var ai=function(e,t){return oi(e,(function(e,n){return t(n)}))};const ci=e=>{let{queries:t,...n}=e;const[i,c]=s.Ue("pending");let u=o.G([]);const l=e=>{const t=Math.ceil(Math.random()*e.length);return(0,r.zG)(e,j.ke(t))};(0,r.zG)((()=>new Promise((e=>setTimeout(e,n.processingDelayMs)))),lt.UI((()=>performance.now())),lt.UI((e=>(0,r.zG)(u,o.UI(l),o.hX(j.Od),o.UI(M.ur(si.n_({events:Rt.jG(),externalStateDeltas:Rt.jG(),lookalikeModels:si.Z$(),modelState:si.Z$(),thirdPartyData:si.Z$()}))),(0,g.bw)((()=>{u=o.YP})),o.Hr("startTime",(()=>e))))),lt.UI((0,g.bw)(o.EQ((()=>c("skipped")),(()=>c("in_progress"))))),Ct("historicalEvents",(()=>gt(n.historicalEvents))),Ct("expectedSegmentMemberships",Ot((e=>di({events:{historical:e.historicalEvents,new:e.events},externalState:{historical:n.externalState,deltas:e.externalStateDeltas},lookalikeModels:e.lookalikeModels,queries:t,thirdPartyData:e.thirdPartyData})))),At("report",(e=>{let{expectedSegmentMemberships:n,modelState:i}=e;return function(e){const t=new Set(e.expectedSegmentMemberships);return(0,r.zG)(function(e){const t=(0,r.zG)(Object.keys(e.runtime.queriesByEvent),Rt.Su(((e,t)=>[t,2**e]))),n={},i=Object.fromEntries(t);for(const t in e.runtime.queriesByEvent){const r=e.runtime.queriesByEvent[t];for(const e of r)n[e]?n[e]+=i[t]:n[e]=i[t]}const s={};for(const e in n){const t=n[e];s[t]?s[t].push(e):s[t]=[e]}return(0,r.zG)(Object.entries(s),Rt.UI((0,r.ls)((0,a.pL)((e=>Number(e))),(0,a.pL)((e=>(0,r.zG)(t,Rt.DZ((0,r.ls)(o.DT((t=>{let[,n]=t;return(e&n)>0})),o.UI(a.li)))))))),(e=>new Map(e)))}(e.queries),function(e){return function(t){return ai(t,e)}}((n=>({actualSegments:(0,r.zG)(n,Rt.hX((t=>{var n,r;return Boolean(null===(n=e.modelState.persistentState.internalStateMap[t])||void 0===n||null===(r=n.result)||void 0===r?void 0:r.result)}))),expectedSegments:(0,r.zG)(n,Rt.hX((e=>t.has(e))))}))))}({expectedSegmentMemberships:n,modelState:i,queries:t})})),Pt((e=>{let{startTime:t}=e;return()=>n.metrics.track({name:"sdk_segmentation_validation_duration_seconds",value:(performance.now()-t)/1e3,labels:{}})})),bt((e=>e.report)),bt(li(n.metrics)),bt((()=>c("finished"))))();return[i,e=>{let[t,n]=e;(0,r.zG)((0,ye.gz)(o.g1)(u,t.environment.lookalikeModels,(0,r.zG)(t.environment.thirdPartyData,o.UI(a.Yg))),o.UI((e=>{let[r,i,s]=e;r.push({externalStateDeltas:Rt.Yo(t.externalStateDelta),lookalikeModels:i,events:t.newEvents,modelState:n,thirdPartyData:s})})))}]};const ui=new Set(["SegmentEntry","SegmentExit","PageviewEngagement","PageviewComplete","Pageview","LinkClick","SlotViewable","SlotRendered","UpdateLookalikeModels","UpdateSecondPartyData","UpdateThirdPartyData"]),li=e=>t=>{for(const[n,{expectedSegments:i,actualSegments:s}]of t){if(0===i.length&&0===s.length)continue;const{correct:t,incorrect:o,missing:a}=fi(i,s),c=(0,r.zG)(n,Rt.UI((e=>e.startsWith("!")?e.slice(1):e)),Rt.UI((e=>ui.has(e)?e:"misc")),(e=>[...new Set(e)]),Rt.UI((e=>(0,r.bc)(`trigger_${e}`,!0))),Rt.R3((0,r.bc)("is_cloud_lifted",!1)),(e=>Object.fromEntries(e))),u=(t,n)=>n.length>0&&e.trackCounter({name:t,value:n.length,labels:c});u("sdk_segmentation_validation_correct_count_total",t),u("sdk_segmentation_validation_incorrect_count_total",o),u("sdk_segmentation_validation_missing_count_total",a)}},fi=(e,t)=>{if(0===t.length)return{correct:[],incorrect:[],missing:e};if(0===e.length)return{correct:[],incorrect:t,missing:[]};const n=new Set(t),i=new Set(e),{right:s,left:o}=(0,r.zG)(t,Rt.uK((e=>i.has(e))));return{correct:s,incorrect:o,missing:(0,r.zG)(e,Rt.hX((e=>!n.has(e))))}};const di=e=>hi(50,(function*(){const t=(0,r.zG)(e.queries.runtime.queriesByEvent,Oe.DZ((0,r.ls)(o.ij,o.UI(Rt.DZ((0,r.ls)(o.DT((t=>t in e.queries.runtime.locallyLiftedQueries)),o.UI((t=>(0,r.bc)(t,e.queries.runtime.locallyLiftedQueries[t]))))))))),n=(0,r.zG)(e.externalState.historical,o.fS((()=>({}))),Oe.DZ(o.Dj(W)),(t=>(0,r.zG)(e.externalState.deltas,Rt.UI(Hn(e.queries)),Rt.u4(t,Vn))),Oe.UI(K)),i={},s=new gi(e.lookalikeModels,e.thirdPartyData),a=e=>(s.processEvent(e),(0,r.zG)(t[e.name]??[],Rt.DZ((t=>{let[n,a]=t;return(0,r.zG)(o.ij(a.lift(e,s.effects)),o.fX((e=>i[n]?(0,r.zG)(e,pi(a,i[n])):R.F2(e))),o.UI((e=>(i[n]=e,n))))})))),c=t=>(0,r.zG)((t=>(0,r.zG)(i[t]??null,(i=>t in n?(0,r.zG)(n[t],pi(e.queries.runtime.locallyLiftedQueries[t],i),R.fS((()=>i))):i),(n=>e.queries.runtime.locallyLiftedQueries[t].interpret(n,s.effects)),(e=>e.result)))(t),o.DT((e=>e!==s.getSegmentResult(t))),o.UI((e=>({name:e?"SegmentEntry":"SegmentExit",properties:{segment_number:Number(t)},time:s.effects.getCurrentTime(),session_id:s.effects.getCurrentSession(),view_id:s.effects.getCurrentView()})))),u=e=>{if(0==e.length)return;const t=(0,r.zG)(e,Rt.tS((0,r.ls)(c,o.UI(a),o.fS((()=>Rt.bM())))));u(t)};for(const t of e.events.historical)yield,a(t);(0,r.zG)(Object.keys(e.queries.runtime.locallyLiftedQueries),u);for(const t of e.events.new)switch(yield,t.name){case"SegmentEntry":case"SegmentExit":case"PageviewComplete":break;default:a(t)}return(0,r.zG)(Object.keys(e.queries.runtime.locallyLiftedQueries),u),s.effects.getSegmentsArray()["1p"]})),pi=(e,t)=>n=>R.Y3((()=>e.append(t,n)),(e=>`Failed to append lifted state: ${e}`));class gi{segments;segmentsArray=void 0;lastEvent=o.YP;effects;constructor(e,t){const n=(0,r.zG)(t,Oe.UI(Oe.hX((e=>!0===e))));this.segments={...n,"1p":{}};const i=(0,r.zG)(this.segments,Oe.UI(Object.keys));this.effects={get1PSegments:()=>({"1p":this.segments["1p"]}),get3PSegments:()=>n,getLookalikeModels:()=>e,getSegments:()=>this.segments,getSegmentsArray:()=>(this.segmentsArray||(this.segmentsArray={...i,"1p":Object.keys(this.segments["1p"])}),this.segmentsArray),setSegmentActivation:()=>{},getCurrentTime:()=>(0,r.zG)(this.lastEvent,o.EQ((()=>new Date),(e=>e.time))),getCurrentSession:()=>(0,r.zG)(this.lastEvent,o.EQ((()=>""),(e=>e.session_id))),getCurrentView:()=>(0,r.zG)(this.lastEvent,o.EQ((()=>""),(e=>e.view_id)))}}get1pSegments(){return this.effects.getSegmentsArray()["1p"]}getSegmentResult(e){return this.segments["1p"][e]??!1}processEvent(e){if("SegmentEntry"===e.name){const t=e.properties.segment_number;t&&this.processSegmentEntry([t])}else if("SegmentExit"===e.name){const t=e.properties.segment_number;t&&this.processSegmentExit([t])}else if("PageviewComplete"===e.name){const t=e.properties.aggregations;(null==t?void 0:t.SegmentEntry)&&this.processSegmentEntry(t.SegmentEntry),(null==t?void 0:t.SegmentExit)&&this.processSegmentExit(t.SegmentExit)}this.lastEvent=o.G(e)}processSegmentEntry(e){for(const t of e)t in this.segments["1p"]||(this.segments["1p"][t]=!0,this.segmentsArray=void 0)}processSegmentExit(e){for(const t of e)t in this.segments["1p"]&&(delete this.segments["1p"][t],this.segmentsArray=void 0)}}const hi=(e,t)=>async()=>{let n=performance.now();const r=t();for(;;){performance.now()-n>e&&(await new Promise((e=>setTimeout(e))),n=performance.now());const t=r.next();if(t.done)return t.value}},mi=e=>i.dQ((e=>{let{previousState:t}=e;return{value:o.YP,state:s.a9(t)}})),vi=e=>i.dQ((t=>{let{previousState:n}=t;const i=(0,r.zG)(n,o.DT(g.El),o.xH,o.hX(A.HD)),a=(0,r.zG)(i,o.EQ((()=>!1),(t=>t===e.sessionId)));if(!e.metrics.isEnabled()||Math.random()>.1||a)return{value:o.YP,state:s.a9(n)};const[c,u]=s.Ue(s.a9("pending"));return{value:o.G((t=>{const[n,r]=ci({externalState:t,historicalEvents:e.priorEvents,metrics:e.metrics,processingDelayMs:6e4,queries:e.customQueries});return u(n),r})),state:(0,r.zG)(s.xH(c),s.UI((0,r.ls)(o.DT((e=>"in_progress"===e||"finished"===e)),o.UI((()=>e.sessionId)),o.wp((()=>i)))))}})),bi=e=>(0,r.zG)(i.K4((t=>{let{stopped:n}=t;const[i,a]=s.Ue(s.a9(d.of(o.YP)));let c;const u=new Promise((e=>{c=e}));return{priorEvents:()=>u.then((e=>e())),externalStateDelta:s.xH(i),newEvents:(0,r.zG)(s.vP(e.newEvents,n),s.UI((e=>{let[t,n]=e;return n?()=>[]:t}))),setCachedPriorEvents:c,setExternalStateDelta:a}})),i.ak("segmentationValidation",(t=>{let{priorEvents:n}=t;return(0,r.zG)(e.eventsCache,R.EQ((()=>mi),(()=>vi)),(t=>t({...e,sessionId:e.sessionId.current,priorEvents:n})))})),i.ak("segmentationService",(t=>{let{newEvents:n,priorEvents:o,externalStateDelta:a,segmentationValidation:c}=t;return(0,r.zG)(jr({...e,externalStateDelta:a,newEvents:n,priorEvents:o,validationService:c}),i.bw((t=>(0,r.zG)(t.errors,s.UI((t=>(0,r.zG)(t(),Rt.UI((t=>e.reportError(`Query Language: ${t}`,{userId:e.groupId}))))))))))})),i.UI((t=>(0,r.zG)(t.segmentationService.events,s.En(4,Rt.uZ()),(n=>{let[i,c,u,l]=n;return{...t,newEvents:i,realtime:(0,r.zG)(c,s.Rp(!1,((e,t)=>{const n=t();return e||n.some((e=>{let[,t]=e;return"Pageview"===t.name}))})),(e=>s.vP(e,t.segmentationService.processing)),s.UI((e=>{let[t,n]=e;return t&&!n})),s.u4(((e,t)=>e||t))),currentPageviewSegments:(f={processedEvents:(0,r.zG)(u,s.UI(d.UI(Rt.UI(a.Yg)))),segments:t.segmentationService.segments,viewId:e.viewId},(0,r.zG)(s.vP(f.processedEvents,f.viewId,f.segments),s.Rp({pageviewProcessed:!1,resolvePageviewSegments:e=>{},segments:kr({all:[],custom:[],standard:[]}),viewId:""},((e,t)=>{let[n,i,s]=t;const a=n();return(0,r.zG)(e,o.DT((e=>e.viewId===i)),o.EQ((()=>{if((0,r.zG)(a,Rt.G((e=>"Pageview"===e.name&&e.view_id===i))))return{pageviewProcessed:!0,resolvePageviewSegments:()=>{},segments:s,viewId:i};{const e=(0,g.b2)();return{pageviewProcessed:!1,resolvePageviewSegments:t=>e.resolve(zr(t)()),segments:ii(Gr(s),(()=>e.promise)),viewId:i}}}),(e=>e.pageviewProcessed?{...e,segments:s}:(0,r.zG)(a,Rt.G((e=>"Pageview"===e.name&&e.view_id===i)))?(e.resolvePageviewSegments(s),{pageviewProcessed:!0,resolvePageviewSegments:()=>{},segments:s,viewId:i}):{...e,segments:s})))})),s.UI((e=>e.segments)))),lastProcessedEvents:(0,r.zG)(l,s.UI(d.UI(Rt.UI(a.Yg))))};var f})))),i.Hr("cohorts",(t=>{let{segmentationService:n}=t;return(0,r.zG)(s.fF(e.nonQlCohorts),s.UI(o.UI((e=>(0,r.zG)(n.segments,xr((e=>e.all)),xr(Rt.UI(String)),ei,(t=>({query_language:t,...e})))))))})),i.ak("stateSync",(t=>{let{segmentationService:n,lastProcessedEvents:r}=t;return Qt({eventSourceId:e.eventSourceId,groupId:e.groupId,groupIdIsNewlyGenerated:e.groupIdIsNewlyGenerated,internalStateDiff:n.internalStateDiff,internalStateMap:n.internalStateMap,lastProcessedEvents:r,logger:e.logger,permutiveApi:e.permutiveApi,permutiveUrls:e.permutiveUrls,queryLanguageProcessing:n.processing,reportError:e.reportError,sessionId:e.sessionId,viewId:e.viewId})})),i.bw((e=>{let{stateSync:t,setExternalStateDelta:n}=e;return n(t.externalStateDelta)})),i.ak("segmentTransitions",(t=>{let{segmentationService:n}=t;return(e=>(0,r.zG)(i.vP({currentSegmentsSet:i.K4((()=>(0,r.zG)(e.segments,s.UI(u))))}),i.ak("transitionsSinceInit",(e=>{let{currentSegmentsSet:t}=e;return i.of(c(t))})),i.UI((e=>{let{currentSegmentsSet:t,...n}=e;return n}))))({segments:(0,r.zG)(Ar(n.segments),s.UI((e=>e.all))),viewId:e.viewId})})),i.Hr("cohortsRef",(e=>{let{cohorts:t}=e;return(0,r.zG)(t,s.VS(o.EQ((()=>s.a9(Rt.bM())),(0,r.ls)((e=>Object.values(e)),Rt.UI((0,r.ls)(ti,(e=>e.all),Ar,s.D8(Rt.Eh(A.Eq)))),Rt.vP(s.g1),s.UI(Rt.xH)))))})),i.Hr("createTrackRequest",(t=>{let{cohortsRef:n,segmentationService:i}=t;return(0,r.zG)(s.vP({cohorts:(0,r.zG)(n,s.UI(o.G)),qlSegments:(0,r.zG)(Ar(i.segments),s.UI(o.G)),webClient:e.webClient}),s.UI((0,ye.Yt)(o.G5)),s.UI(o.UI((t=>{let{cohorts:n,qlSegments:r,webClient:i}=t;return t=>({...t,segments:r.all,user_id:e.groupId,cohorts:n,properties:{...t.properties,client:{...i,...t.properties.client??{}}}})}))))})),i.Hr("eventsToPublishOnPageUnload",(t=>e.trackPageviewComplete?(0,r.zG)(t.segmentationService.unprocessedPageviewComplete,s.UI(Rt.pc(o.UI((e=>(0,r.bc)(`PageviewComplete-${e.view_id}`,e))))),(e=>s.vP(t.createTrackRequest,e)),s.UI((e=>{let[t,n]=e;return(0,r.zG)(t,o.EQ((()=>Rt.cS),(e=>(0,r.zG)(n,Rt.UI((0,a.H5)(e))))))}))):s.a9(Rt.cS))),i.ak("eventCache",(t=>{let{newEvents:n,setCachedPriorEvents:o}=t;return(0,r.zG)(e.eventsCache,R.EQ((e=>(o(e),i.of({newEvents:n}))),(e=>(0,r.zG)((e=>i.K4((()=>({newEvents:(0,r.zG)(e.newEvents,s.UI(d.UI((0,g.bw)(Rt.UI((t=>{let[,n]=t;ri.has(n.name)||e.eventsCache.add(n,{persistOnDisk:!0})})))))),priorEvents:()=>e.eventsCache.all()}))))({eventsCache:e,newEvents:n}),i.UI((e=>{let{newEvents:t,priorEvents:n}=e;return o(n),{newEvents:t}}))))))})),i.UI((e=>({...e,newEvents:e.eventCache.newEvents}))),i.Hr("eventsToPublish",(t=>{let{cohorts:n,newEvents:i,segmentationService:c}=t;return(0,r.zG)(s.vP(i,e.webClient,c.segments,(0,r.zG)(n,s.UI(o.UI((0,r.ls)((e=>Object.values(e)),Rt.UI(ti),Rt.UI((e=>e.all)))))),(0,r.zG)(e.viewId,s.Rp(new Set,((e,t)=>new Set([...e,t]))))),s.UI((t=>{let[n,i,s,c,u]=t;return(0,r.zG)(o.Do,o.Qt("webClient",i),o.Qt("cohorts",c),o.ak("events",(()=>(0,r.zG)(n(),Rt.hX((e=>{let[,t]=e;return"PageviewComplete"!==t.name||u.has(t.view_id)})),o.DT(Rt.Od)))),dt,Ct("segments",(()=>(0,r.zG)(zr(s),gt))),Dt((e=>(0,r.zG)(e.cohorts,lt.uU(Dr(1e3)),lt.UI(Rt.xH),lt.UI((t=>({...e,cohorts:t})))))),bt((t=>{let{cohorts:n,events:i,segments:s,webClient:o}=t;return(0,r.zG)(i,Rt.UI((0,a.H5)((t=>({...t,segments:s.all,user_id:e.groupId,cohorts:n,properties:{...t.properties,client:{...o,...t.properties.client??{}}}})))))})),lt.UI(o.fS((()=>Rt.bM()))))})),(e=>{const[t,n]=s.gS(Rt.uZ());return(0,r.zG)(e,s.UI((e=>e().then(n)))),t}))})));var wi=n(965);function _i(e){return t=>(0,r.zG)(s.oQ(e),s.UI((0,g.rO)({backoffAfterErrorMs:e=>e??0,backoffAfterSuccessMs:e=>e??0})),(e=>i.dQ((n=>{let{previousState:i}=n;const[a,c]=s.Ue(function(e){if("object"!=typeof e||null===e)return{lastSuccess:0,lastError:0};return e}(i)),u=(0,r.zG)(s.vP(a,e),s.UI((e=>{let[t,n]=e;return Math.max(t.lastError+n.backoffAfterErrorMs,t.lastSuccess+n.backoffAfterSuccessMs)})));return{state:a,value:(0,r.ls)(o.DT((()=>Date.now()>=u.current)),o.UI(t),o.UI((0,g.bw)((e=>e.then((()=>c({...a.current,lastSuccess:Date.now()})),(()=>c({...a.current,lastError:Date.now()})))))))}}))))}const yi=function(e,t){return i.of(o.YP)};var Si=n(371);const Ii=["pug"],ki=function(e,t){return(0,r.zG)(Gi(e),_i({backoffAfterErrorMs:6e5}),i.VS((e=>Si.m((0,r.zG)(t,s.UI((0,g.rO)({tpdUsage:o.UI((0,r.ls)(Oe.UI(Oe.z7((e=>!Ii.includes(e)))),Oe.hX((0,De.ff)(Oe.xb))))})),s.UI((t=>{let{tpdUsage:n,userId:i}=t;return{validityKey:()=>i,freshnessKey:(0,r.ls)((()=>n),o.EQ((()=>0),(0,r.ls)(JSON.stringify,g.vp))),refresh:(0,r.zG)(n,o.hX((e=>Object.keys(e).length>0)),o.UI((t=>()=>Ae.Y3((()=>(0,r.zG)(e({user_id:i,time:new Date,tpd_segments:t}),o.fS((()=>Promise.reject("Blocked by backoff."))))),(e=>`Failed to report TPD usage. Got ${e}`)))))}})))))),i.UI(r.Q1))};const Gi=e=>t=>{const{config:n,metrics:r,permutiveApi:i,permutiveUrls:s}=e,a=r.startTimer("sdk_http_tpd_usage_seconds",{});return i.req({url:s.getEndpointUrl("/tpd/usage",o.G(n.apiVersion)),method:"POST",payload:t,contentType:"text/plain",dataType:"json",withCredentials:!1}).then((e=>(r.stopTimer("sdk_http_tpd_usage_seconds",a),e)))};var zi=function(e){return function(t){return function(n){return e(t(n))}}},qi=r.a9;Be.F4,Be.Xl;function Ui(e){return function(t){return function(){return e.of(t)}}}function Ei(e){return function(t){return function(n){return function(r){return e.map(n(r),t)}}}}function Pi(e){return function(t){return function(n){return function(r){return e.ap(n(r),t(r))}}}}function xi(e){return function(t){return function(n){return function(r){return e.chain(n(r),(function(e){return t(e)(r)}))}}}}function Oi(e){return function(t){return(0,r.ls)(t,e.of)}}lt.PM;var Di=qi,Ai=(lt.tD,zi(lt.tD),function(e,t){return(0,r.zG)(e,Ci(t))}),Ci=Ei(lt.dO),Ti=(lt.Hi,Ui(lt.PM)),Mi=(lt.UA,"ReaderTask"),ji={URI:Mi,map:Ai},Ri={URI:Mi,of:Ti};Be.F4,Be.Xl;var Fi=qi,Qi=Fr.F2(Ri),Li=(Ae.QM,Ae.lk,Ae.dk,Ae.Op,Ae.fj,Fr.UI(ji)),Ni=Qi;Be.F4,Be.Xl;function Yi(e,t){const n=["amp","gigya","pxid","sailthru"],a=(0,r.zG)(t.identities,s.UI(o.UI(Oe.z7((e=>!n.includes(e)))))),c=e=>(0,g.vp)(JSON.stringify(e)),u=e=>[c(e),e];return(0,r.zG)(i.vP({fetchFromNewEndpoint:(0,r.zG)($i(e),_i({backoffAfterErrorMs:6e5})),fetchFromLegacyEndpoint:(0,r.zG)(Bi(e),_i({backoffAfterErrorMs:6e5}))}),i.VS((n=>{let{fetchFromNewEndpoint:c,fetchFromLegacyEndpoint:l}=n;return(0,r.zG)(Si.m((0,r.zG)(s.vP(t.userId,t.sessionId,a),s.UI((t=>{let[n,i,s]=t;return{validityKey:()=>n,freshnessKey:()=>`${Hi(s)},${i}`,refresh:(0,r.zG)(s,o.UI((t=>()=>Oe.xb(t)?Ae.of({}):Ae.Y3((()=>(0,r.zG)((t=>(0,r.zG)(c(t),o.UI((e=>e.catch((()=>(0,r.zG)(l(t.identities),o.fS((()=>e))))))),o.wp((()=>l(t.identities))),o.UI((0,g.bw)((t=>{const n=e.metrics.startTimer("sdk_get_third_party_data_task_duration_seconds",{});t.catch(r.Q1).then((()=>{e.metrics.stopTimer("sdk_get_third_party_data_task_duration_seconds",n)}))})))))({userId:n,identities:t}),o.fS((()=>Promise.reject("Blocked by persistent backoff"))))),(e=>`Error fetching TPD. Got ${e}`)))),o.UI(Li(u)))}})))),Si.d((e=>o.G((e=>Array.isArray(e)?e:u(e))(e)))),i.UI(s.UI(R.fS((t=>(e.logger.warn("[TPD]",`Failed to retrieve usable value, using zero value. ${t}`),o.G(u({}))))))),i.bw((0,r.ls)(s.UI(o.pC),s.UI((t=>{t&&e.metrics.trackTimeSinceInit("sdk_lifecycle_timestamps",{timestamp_name:"audience_matching_ready",time_origin:"sdk_init"})})))))})))}const $i=e=>async t=>{const n=e.metrics.startTimer("sdk_http_audience_matching_seconds",{}),i=await e.permutiveApi.req({url:e.permutiveUrls.getAudienceMatchingEndpointUrl("/id",o.G("v1"),t.userId),payload:{identities:(0,r.zG)(t.identities,Oe.Yz,Rt.UI((e=>{let[t,n]=e;return{tag:t,id:n}})))},method:"POST",withCredentials:!1,dataType:"json"});return e.metrics.stopTimer("sdk_http_audience_matching_seconds",n),i.items},Bi=e=>async t=>{const n=e.metrics.startTimer("sdk_http_tpd_seconds",{}),r=await e.permutiveApi.req({url:e.permutiveUrls.getEndpointUrl("/tpd",o.G(e.config.apiVersion)),method:"POST",payload:{user_id:t},contentType:"text/plain",dataType:"json",withCredentials:!1});return e.metrics.stopTimer("sdk_http_tpd_seconds",n),r},Hi=(0,r.ls)(JSON.stringify,g.vp);const Vi=(e,t)=>(0,r.zG)(i.vP({data:Yi(e,{identities:t.identities,sessionId:t.sessionId,userId:t.userId}),usageReporting:ki(e,s.vP({tpdUsage:t.tpdUsage,userId:t.userId}))}),i.ak("analytics",(e=>{let{data:n}=e;return function(e){return i.dQ((t=>{let{previousState:n}=t;const[i,a]=s.gS(Rt.uZ());var c;return{state:(0,r.zG)(s.vP(e.userId,e.providerSegments,e.sessionId,e.viewId),s.D8(((e,t)=>{let[n,r]=e,[i,s]=t;return n===i&&r===s})),s.Rp(null!==(c=n)&&"object"==typeof c?c:{userId:"",providerHashes:{}},((e,t)=>{let[n,i,s,c]=t;const u=(0,r.zG)(i,o.fS((()=>({})))),l=(0,r.zG)(u,Oe.UI((0,g.SL)(g.vp))),f=(0,r.zG)(e,o.DT((e=>e.userId===n)),o.UI((e=>e.providerHashes)),o.fS((()=>({}))));return(0,r.zG)(u,Oe.z7((e=>l[e]!==(f[e]||0))),(e=>Object.entries(e)),Rt.UI((e=>{let[t,n]=e;return(0,r.bc)((0,g.k$)(),{name:"ThirdPartySegments",properties:{data_provider:t,segments:[...n]},session_id:s,time:new Date,view_id:c})})),a),{userId:n,providerHashes:l}}))),value:i}}))}({providerSegments:(0,r.zG)(n,s.UI(o.UI(_r.Yg))),sessionId:t.sessionId,userId:t.userId,viewId:t.viewId})})),i.UI((e=>{let{data:t,analytics:n}=e;return{data:t,analyticsEvents:n}}))),Ki=function(e){const t={include_geo:!0,include_isp:!0,include_ip_hash:!0,include_ip:!1},n=e.trace.startSpan("geoip_data_retrieval");return(0,r.zG)(Si.m((0,r.zG)(e.sessionId,s.UI((n=>({validityKey:()=>(0,g.vp)(JSON.stringify(t)),freshnessKey:()=>n,refresh:o.G((()=>Ae.Y3((()=>Wi(e.permutiveApi,e.metrics,e.config,t,e.permutiveUrls)),(e=>`Error fetching geoip. Got ${e}`))))}))))),i.UI(s.UI(R.fS((t=>(e.logger.warn("[geoip]",`Failed to retrieve usable value, using zero value. ${t}`),o.G({})))))),i.bw((0,r.ls)(s.UI(o.pC),s.UI((t=>{t&&(e.metrics.trackTimeSinceInit("sdk_lifecycle_timestamps",{timestamp_name:"geoip_data_ready",time_origin:"sdk_init"},performance.now()),n.finish())})))))};const Wi=(e,t,n,r,i)=>{const s=[];r.include_geo&&s.push(["include","geo"]),r.include_isp&&s.push(["include","isp"]),r.include_ip&&s.push(["include","ip"]),r.include_ip_hash&&s.push(["include","ip_hash"]);const a=t.startTimer("sdk_http_geoip_seconds",{});return e.req({url:i.getEndpointUrl("/geoip",o.G(n.apiVersion),s),method:"GET",contentType:"text/plain",dataType:"json",withCredentials:!1}).then((e=>(t.stopTimer("sdk_http_geoip_seconds",a),e)))},Xi=e=>t=>{const n=r=>{const i={...r};for(let s in r){const o=r[s];t.hasOwnProperty(o)?null!=e&&e.dropUnenriched&&void 0===t[o]?delete i[s]:i[s]=t[o]:null!==o&&"object"==typeof o&&o.constructor===Object&&(i[s]=n(o))}return i};return n};var Zi=n(414),Ji=n(636);const es=function(e,t,n,a,c){const u=(0,Ji.Hn)(ns),l=u("ssps",Rt.cS),f=u("all_cohort_mapping",{}),d=l.includes("google_pps"),p=u("affinity_enabled",!1);return(0,r.zG)(c.consent,i.KD([[e=>!e,i.of(Nr(o.YP))],i.K4((i=>{let{stopped:u}=i;a.debug("[ssp] Addon started, affinity enabled: ",p);const l=(0,r.zG)(c.cohorts,Yr((0,r.ls)(Rt.hX((e=>e in f)),Rt.tS((e=>f[e]))))),d=(0,r.zG)(s.vP(c.url,u),s.UI((e=>{let[t,n]=e;return(0,r.zG)(t,o.hX((()=>p&&!n)))})),s.UI(o.UI((n=>Ae.Y3((()=>e.req({method:"GET",url:t.getEndpointUrl("/standard-audiences/v1/affinity",o.YP,[["url",n]]),withCredentials:!1,dataType:"json"})),String)))),s.UI(o.UI(Ae.Vn((0,g.bw)((e=>n(`Failed to fetch affinity cohorts: ${e}`)))))),s.UI(o.UI(Ae.UI((e=>e.affinity_values)))),s.UI(o.fS((()=>Ae.of(Rt.bM())))),s.VS(Br(Rt.bM())));return(0,r.zG)((0,ye.gz)(Wr)(l,d),Yr(Rt.xH),Yr((e=>[...new Set(e)])),Yr(o.G))}))]),i.UI(s.xH),i.UI((e=>({cohorts:(0,r.zG)(e,Yr(o.fS((()=>Rt.bM()))),Zr((e=>e),(e=>"dfp"===e.id&&d?o.G(ts):o.YP)),o.G),externalData:{[rs]:(0,r.zG)(Ar(e),s.UI(o.Uo),s.UI(o.xH),s.UI(o.UI(ts)),s.D8(o.Eh(Rt.Eh(A.Eq))),s.UI(o.UI((e=>({ssps:l,cohorts:e})))))}}))))};const ts=e=>[...new Set(e.map((e=>e.replace(/-ac$/,"").replace(/-aw$/,"").replace(/-c$/,""))))],ns="ssp";const rs="_pssps",is=e=>{const t=(0,r.zG)((null==e?void 0:e.dfp)??[],Rt.UI(String),(e=>new Set(e)));return{id:"dfp",filterCohorts:Rt.hX((e=>t.has(e)))}};const ss=e=>{if(!e.metrics.isEnabled())return()=>{};const t=(0,r.zG)(e.adServers,Rt.UI((e=>(0,r.bc)(e.id,e))),Oe.sq,Oe.UI((t=>{const n=(0,r.zG)(e.cohorts,Oe.DZ((e=>e.byAdServer(t))),(e=>s.vP(e)),s.UI(Oe.UI((i=5e3,a="Timeout",e=>(0,r.zG)(e,qr(i),lt.UI(o.pF((()=>R.t$(a)))))))),s.UI((0,ye.Yt)(lt.Hi)),s.UI(lt.UI((0,r.ls)(Oe.oh,Me.Vn(Oe.Su(((t,n)=>{e.logger.warn("[Targeting Metrics]",`[${t}]`,n)}))),Me.F2))),(e=>()=>e.current));var i,a;return(0,r.ls)(Rt.of,Rt.UI((e=>e.cohorts)),as,Rt.UI((e=>{let[t,n]=e;return{allCohorts:new Set(t),cohortCountByType:os(t),requestCount:n}})),(i=>(0,r.zG)(n(),lt.UI(Oe.Su(((t,n)=>(i,s)=>{(0,r.zG)(n,Rt.Hr("actualCohortCount",(e=>{let{cohortCountByType:t}=e;return(0,r.zG)(t,Oe.P5(i))})),Rt.UI((n=>{const a={cohort_type:i,target:t},c=s.reduce(((e,t)=>n.allCohorts.has(t)?e+1:e),0),u=s.length-c;e.metrics.track({name:"sdk_ad_request_missed_cohorts",labels:a,value:n.requestCount*u}),e.metrics.track({name:"sdk_ad_request_successful_cohorts",labels:a,value:n.requestCount*c}),(0,r.zG)(n.actualCohortCount,o.UI((t=>{const r=t-c;e.metrics.track({name:"sdk_ad_request_superfluous_cohorts",labels:a,value:n.requestCount*r})})))})))})(t.id,i))))),(e=>e()))})));return e=>{if("AdRequest"===e.name)(n=e.properties).ad_server_id in t&&t[n.ad_server_id](n);var n}},os=e=>({ql:(0,r.zG)(e,Rt.u4(0,((e,t)=>isNaN(parseInt(t))?e:e+1)))}),as=e=>(0,r.zG)(e,Rt.pO((e=>{const{init:t,rest:n}=(0,r.zG)(e,Rt.zT((t=>t===e[0])));return[t,n]})),Rt.UI((e=>[e[0],e.length]))),cs=e=>o.YP;const us=B.n_({cohorts:Rt.Eh((0,g.Or)()),ctx:(0,g.Or)()}),ls=Rt.cS;Promise.resolve(R.F2(ls)),B.n_({userId:(0,g.Or)(),lastSuccess:{equals:(e,t)=>e&&t&&us.equals(e,t)||e===t}});function fs(e,t){return Object.keys(t).reduce(((n,r)=>void 0!==e[r]?{...n,[r]:t[r]+e[r]}:{...n,[r]:t[r]}),e)}function ds(e,t){return(0,r.zG)(ms(e),((e,t)=>n=>(0,r.zG)((e=>n(e)().then((e=>R.nM(e)?Promise.reject(e.left):e.right))),_i(e),i.UI((e=>n=>()=>(0,r.zG)(n,e,o.EQ((()=>Promise.resolve(R.t$(t))),(e=>e.then(R.F2,R.t$))))))))({backoffAfterErrorMs:6e5},"Advertiser segmentation request blocked by rate limiting."),i.VS((n=>i.dQ((i=>{let{previousState:a}=i;return e.logger.debug("[advertiser] previous state:",a),(0,r.zG)(t,s.Rp(s.a9(gs(e)(a)),hs(e)(n)),s.xH,s.bw((t=>e.logger.debug("[advertiser] updated state:",t))),(e=>({state:(0,r.zG)(e,s.UI((e=>{let{userId:t,lastSuccess:n}=e;return{userId:t,lastSuccess:o.FS(n)}})),s.D8(Gs)),value:(0,r.zG)(e,s.UI((e=>{let{eventual:t}=e;return t})))})))})))))}const ps=e=>t=>(0,r.zG)(t,xr(function(e){return t=>(0,r.zG)(t.cohorts,j.hX((n=>(0,r.zG)(n.groups,j.yW((i=>(0,r.zG)(o.ij(t.groups[i]),R.Yo((()=>`cohort [${n.code}] is missing group [${i}]`)),R.Vn((t=>e.error(`[advertiser] ${t}`))),R.UI((e=>e>0)),R.fS((()=>!0)))))))),j.UI((e=>{let{code:t}=e;return t})))}(e)),Jr((e=>e),(e=>"dfp"===e.id?o.G((e=>e)):o.YP)),o.G),gs=e=>t=>(0,r.zG)(t,o.DT(zs),o.fS((()=>qs())),(e=>R.Y3((()=>({userId:e.userId,inFlight:!1,lastSuccess:o.ij(e.lastSuccess),view:Is(),ctx:(0,r.zG)(o.ij(e.lastSuccess),o.UI((e=>{let[t]=e;return t}))),eventual:Us()})),(e=>`failed to parse existing persistent state: ${e}`))),R.fS((t=>(e.logger.error("[advertiser]",t),Ss(""))))),hs=e=>t=>(n,i)=>(0,r.zG)(n,s.VS((0,r.ls)(o.DT((e=>{let{userId:t}=e;return t===i.userId})),o.fS((()=>Ss(i.userId))),(n=>{if(ks(n)===i.viewId)return e.logger.debug("[advertiser] view id is the same as previous, returning existing state",n),s.a9(n);if(n.inFlight)return e.logger.debug("[advertiser] in flight request",n),s.a9(n);{let a;e.logger.debug("[advertiser] fetching cohorts for view",n);const c=new Promise((e=>{a=e})),u=()=>c;return(0,r.zG)((0,ye.gz)(lt.Hi)(i.customCohorts,i.standardCohorts),lt.tS((e=>{let[r,s]=e;return t([i.userId,o.FS(n.ctx),r,s])})),Ae.YO("response"),Ae.ak("cohorts",(t=>{let{response:n}=t;return(0,r.zG)(n.c,ws,(0,g.bw)(R.EQ((t=>{e.logger.error(`[advertiser] failed to decode data from response. ${t}`)}),(t=>{e.logger.debug("[advertiser] decoded data from response",t)}))),lt.of)})),Ae.Hr("view",(e=>{let{response:t,cohorts:n}=e;return(0,r.bc)(t.ctx,n)})),s.fF,s.UI((0,r.ls)(o.EQ((function(){return{...n,inFlight:!0,eventual:(0,r.bc)((0,r.zG)(n.lastSuccess,o.UI((e=>{let[t,n]=e;return n})),o.fS((()=>ys()))),u)}}),R.EQ((function(t){e.logger.error(`[advertiser] ${t}`);const s=(0,r.zG)(n.lastSuccess,o.UI((e=>{let[t,n]=e;return n})),o.fS((()=>ys())));return a(s),{userId:i.userId,lastSuccess:n.lastSuccess,ctx:n.ctx,view:(0,r.bc)(i.viewId,o.YP),inFlight:!1,eventual:[s,u]}}),(function(e){let{response:t,view:n}=e;const[,s]=n;return a(s),(0,r.zG)({userId:i.userId,lastSuccess:o.G(n),view:(0,r.bc)(i.viewId,o.G(s)),ctx:o.G(t.ctx),inFlight:!1,eventual:(0,r.bc)(s,u)})}))))))}})))),ms=e=>Ae.it((t=>e.permutiveApi.req({url:e.permutiveUrls.getAdvertiserEndpointUrl("/segment",o.G("v4")),method:"POST",payload:vs(t),contentType:"text/plain",dataType:"json",withCredentials:!1})),(e=>`Failed to fetch advertiser cohorts: ${e}`)),vs=e=>JSON.stringify(e),bs=e=>{const t=(0,r.zG)(e,j.YM,R.Yo((()=>"Expected a value, found empty array")),R.tS((e=>"string"==typeof e?R.F2(e):R.t$("Expected a cohort code, found "+typeof e)))),n=(0,r.zG)(e,j.Gb,o.fS((()=>[])),R.DT(Array.isArray,(()=>"Expected an array of groups [integer], found "+typeof e[1])));return(0,r.zG)(t,R.tS((e=>(0,r.zG)(n,R.UI((t=>({code:e,groups:t})))))))};function ws(e){const[t,n]=e;return(0,r.zG)(t,j.fw(R.g1)(bs),R.UI((e=>({cohorts:e,groups:n}))))}const _s=B.n_({cohorts:j.Eh(B.n_({code:A.Eq,groups:j.Eh(H.Eq)})),groups:j.Eh(H.Eq)}),ys=()=>({cohorts:[],groups:[]}),Ss=e=>({inFlight:!1,userId:e,lastSuccess:o.YP,view:Is(),ctx:o.YP,eventual:Us()}),Is=()=>["",o.YP],ks=e=>e.view[0],Gs=B.n_({userId:(0,g.Or)(),lastSuccess:{equals:(e,t)=>e===t||!!e&&!!t&&B.bc(A.Eq,_s).equals(e,t)}}),zs=e=>"object"==typeof e&&null!==e&&"userId"in e&&"lastSuccess"in e&&(void 0===e.lastSuccess||Array.isArray(e.lastSuccess)&&2===e.lastSuccess.length&&"string"==typeof e.lastSuccess[0]&&null!==e.lastSuccess[1]&&"object"==typeof e.lastSuccess[1]),qs=()=>({userId:""}),Us=()=>(0,r.bc)(ys(),(()=>Promise.resolve(ys()))),Es=(e,t)=>{const n=(0,r.zG)(t,o.UI((e=>e.all)),o.fS((()=>Nr(Rt.cS))),Ar,s.UI(o.Uo));return{_pcrdbs:s.a9(o.YP),_pcrprs:n}},Ps=function(e,t){return(0,r.zG)(t,i.KD([[e=>!e.consent,i.K4((()=>Pr(ys())))],ds(e,t)]),i.UI((0,r.ls)(s.xH,(n=>(0,ye.gz)(Mr)(n,Er((0,r.zG)(t,s.UI((e=>{let{events:t}=e;return t})),(t=>{return(n=e.logger,e=>t=>(0,r.zG)(t,s.UI((t=>(0,r.zG)(R.Y3((()=>{const i=t().filter((t=>{let[,n]=t;return"SlotViewable"===n.name&&(0,r.zG)(o.ij(n.properties.line_item_id),o.UI((e=>e.toString())),o.UI((t=>e.has(t))),o.fS((()=>!1)))})).map((e=>{let[t,n]=e;return n.properties.line_item_id.toString()}));return i.forEach((e=>t=>e.debug("[advertiser] impression event for deal_id:",t))(n)),(e=>e.reduce(((e,t)=>({...e,[t]:1})),{}))(i)}),(e=>`Caught error when processing deal id impressions on events. Got ${e}`)),R.fS((e=>(n.error("[advertiser]",e),{})))))),s.Rp({},fs),s.D8(((e,t)=>Bt(t))),s.D8(cn(H.Eq)),s.bw((e=>n.debug("[advertiser] impressions:",e)))))(new Set([]))(t);var n}))))),xr((e=>{let[t,n]=e;return function(e,t,n){const i=(0,r.zG)(t.groups,j.Su(((i,s)=>{const a=(0,r.zG)((0,r.zG)(t.cohorts,j.hX((e=>{let{groups:t}=e;return t.includes(i)})),j.Lx(H.Pc)((t=>(0,r.zG)(o.ij(e[t.code]),o.fS((()=>[])),j.Lx(H.Pc)((e=>(0,r.zG)(o.ij(n[e]),o.fS((()=>0))))))))));return Math.max(0,s-a)})));return{cohorts:t.cohorts,groups:i}}({},t,n)})),ps(e.logger))),i.bw((t=>{(0,r.zG)(t,o.UI(ni),o.fS((()=>s.a9([]))),(t=>(0,r.zG)(t,s.UI((t=>e.logger.debug("[advertiser] cohorts available for targeting:",t))))))})))};const xs=(0,r.zG)(Ps,(e=>(t,n)=>(0,r.zG)(e(t,n),i.UI((e=>({cohorts:e,externalData:Es(t.logger,e)}))))));const Os=i.K4((()=>{}));const Ds=e=>t=>(0,r.zG)(e,Oe.UI((e=>t.reduce(((t,n)=>t+Number(e.has(n))),0))));const As=function(e,t){return i.K4((()=>({signalRef:s.a9(o.YP)})))};const Cs=e=>t=>{const{consent:n,currentTimestampSecs:c,identities:u,sessionId:l,userId:f,viewId:h,pageviewState:m}=t;return(0,r.zG)(i.K4((()=>{let n;const r=new Promise((e=>{n=e})),[i,a]=s.Ue(s.a9(o.YP));return{...t,adServers:[is(e.optimisedActivationsConfig.dfp)],nonQlCohortsT:()=>r,setNonQlCohorts:n,setTpdUsage:a,tpdUsage:s.xH(i)}})),i.ak("geoip",(()=>(e=>(0,r.zG)(e,Ki,i.YO("data"),i.Hr("replacementMap",(e=>{let{data:t}=e;return(0,r.zG)(t,s.UI(o.UI((e=>{var t;return{$ip_geo_info:e.geo_info,$ip_geo_info_continent:null===(t=e.geo_info)||void 0===t?void 0:t.continent,$ip_isp_info:e.isp_info,$ip_address:e.ip,$ip_address_hash:e.ip_hash}}))))})),i.Hr("permutiveContext",(e=>{let{data:t}=e;return(0,r.zG)(t,s.UI(o.EQ((()=>({})),(e=>{var t,n,r,i,s,o,a,c,u;return{isp:null===(t=e.isp_info)||void 0===t?void 0:t.isp,organization:null===(n=e.isp_info)||void 0===n?void 0:n.organization,autonomous_system_number:null===(r=e.isp_info)||void 0===r?void 0:r.autonomous_system_number,autonomous_system_organization:null===(i=e.isp_info)||void 0===i?void 0:i.autonomous_system_organization,continent:null===(s=e.geo_info)||void 0===s?void 0:s.continent,country:null===(o=e.geo_info)||void 0===o?void 0:o.country,city:null===(a=e.geo_info)||void 0===a?void 0:a.city,province:null===(c=e.geo_info)||void 0===c?void 0:c.province,postal_code:null===(u=e.geo_info)||void 0===u?void 0:u.postal_code}}))))}))))({...e,sessionId:l}))),i.Hr("watson",(t=>{let{webClient:n}=t;return(0,r.zG)(e.watson,o.fS((()=>(0,r.zG)(n,s.UI(o.UI((e=>e.url))),s.D8(o.Eh(A.Eq)),(t=>(0,Zi.watson)({...e,pageUrl:t,watsonEnabled:(0,r.zG)(m,s.UI((e=>e.watsonEnabled)))}))))))})),i.ak("audienceMatching",(t=>{let{tpdUsage:n}=t;return Vi(e,{identities:u,sessionId:l,tpdUsage:n,userId:f,viewId:h})})),i.UI((e=>{let{audienceMatching:{analyticsEvents:t,...n},newEvents:i,...o}=e;return{...o,audienceMatching:n,newEvents:(0,r.zG)(s.vP(i,t),s.UI(d.RD),s.UI(d.UI(Rt.xH)))}})),i.UI((e=>{const[t,n,i]=s.Ue(o.bM()),[a,c]=(0,r.zG)(e.newEvents,s.En(2,Rt.uZ())),u=(0,r.zG)(s.vP(a,t),s.UI((e=>{let[t,n]=e;return(0,r.zG)(n,o.UI((e=>(0,r.zG)(t,d.UI(Rt.UI((0,g.bw)((t=>{let[,n]=t;return e(n)}))))))),o.fS((()=>d.of(Rt.bM()))))})));return{...e,newEvents:u,newEventsForAdvertiserSegmentation:c,collectTargetingSuccessMetrics:e=>{n(o.G(e)),i()}}})),i.ak("enrichedEvents",(t=>{let{enrichmentReplacementMap:n,geoip:c,newEvents:u,watson:l}=t;return(0,r.zG)(s.vP({misc:n,geoip:c.replacementMap,watson:l.replacementMap}),s.UI((0,ye.Yt)(o.G5)),s.UI(o.UI((e=>{let{misc:t,geoip:n,watson:r}=e;return{...t,...n,...r}}))),(t=>i.K4((()=>((e,t,n,i)=>((0,r.zG)(t,s.UI(o.pC),s.YP((t=>{t&&e.trackTimeSinceInit("sdk_lifecycle_timestamps",{timestamp_name:"event_enrichment_ready",time_origin:"sdk_init"})}))),(0,r.zG)(n,s.VS((()=>(0,r.zG)(s.vP((0,r.zG)(t,s.UI(o.UI(Xi({dropUnenriched:!0})))),i),s.UI((0,r.ls)((e=>{let[t,n]=e;return()=>(0,r.zG)(t,o.EQ((()=>[]),(e=>(0,r.zG)(n(),Rt.UI((0,a.H5)((0,g.rO)({properties:e})))))))})))))))))(e.metrics,t,f,u)))))})),i.UI((0,g.rO)({enrichedEvents:(0,yr.F)(e.metrics,"pageview_enriched")})),i.ak("lookalikeModels",(()=>(0,r.zG)(e.lookalikeModels,o.EQ((()=>(0,wi.lookalikeModelsService)({...e,consent:n,currentTimestampSecs:c})),i.of)))),i.ak("queryLanguage",(n=>{let{audienceMatching:o,nonQlCohortsT:a,enrichedEvents:c,lookalikeModels:u,setTpdUsage:l,userIdIsNewlyGenerated:d}=n;return(0,r.zG)((p={...e,...t,newEvents:c,thirdPartyData:o.data,groupId:f,groupIdIsNewlyGenerated:d,nonQlCohorts:a,lookalikeModels:u,migratedStateMaps:e.migratedStateMaps},(0,r.zG)(s.vP(p.eventSourceId,p.groupId,p.groupIdIsNewlyGenerated),s.D8((0,r.zG)(A.Eq,B.Uz((e=>{let[t]=e;return t})))),i.kR((e=>{let[t,n,s]=e;return(0,r.zG)(bi({...p,eventSourceId:t,groupId:n,groupIdIsNewlyGenerated:s,migratedStateMaps:p.migratedStateMaps}),i.yi(t))})),i.UI((e=>({stateMigratedThisInitialisation:(0,r.zG)(e,s.VS((e=>e.segmentationService.stateMigratedThisInitialisation))),cohorts:(0,r.zG)(e,s.VS((e=>e.cohortsRef))),currentPageviewSegments:{all:(0,r.zG)(e,s.VS((e=>e.currentPageviewSegments)),xr((e=>e.all))),custom:(0,r.zG)(e,s.VS((e=>e.currentPageviewSegments)),xr((e=>e.custom))),standard:(0,r.zG)(e,s.VS((e=>e.currentPageviewSegments)),xr((e=>e.standard)))},eventsToPublish:(0,r.zG)(e,s.VS((e=>e.eventsToPublish))),eventsToPublishOnPageUnload:(0,r.zG)(e,s.VS((e=>e.eventsToPublishOnPageUnload))),realtime:(0,r.zG)(e,s.VS((e=>e.realtime)),s.Rp(!1,((e,t)=>e||t)),s.bw((e=>{e&&p.metrics.trackTimeSinceInit("sdk_lifecycle_timestamps",{timestamp_name:"worker_realtime",time_origin:"sdk_init"},performance.now())}))),segments:{all:(0,r.zG)(e,s.VS((e=>Ar(e.segmentationService.segments))),s.UI((e=>e.all))),custom:(0,r.zG)(e,s.VS((e=>Ar(e.segmentationService.segments))),s.UI((e=>e.custom))),standard:(0,r.zG)(e,s.VS((e=>Ar(e.segmentationService.segments))),s.UI((e=>e.standard)))},thirdPartyDataUsage:(0,r.zG)(e,s.VS((e=>e.segmentationService.tpdUsage))),transitionsSinceInit:(0,r.zG)(e,s.VS((e=>e.segmentTransitions.transitionsSinceInit)))}))))),i.bw((e=>{let{thirdPartyDataUsage:t}=e;return l(t)})));var p})),i.ak("classificationModels",(t=>{let{queryLanguage:r}=t;return yi(e,s.vP({consent:n,currentTimestampSecs:c,queryLanguageCohorts:Cr(r.currentPageviewSegments.all),realtime:r.realtime,userId:f}))})),i.ak("demandPartners",(n=>{let{queryLanguage:a}=n;return((e,t)=>(0,r.zG)(es(e.permutiveApi,e.permutiveUrls,e.reportError,e.logger,t),i.UI((e=>{let{cohorts:t,externalData:n}=e;return{ssp:t,externalData:n}}))))(e,{cohorts:Hr(a.currentPageviewSegments.all),consent:t.consent,url:(0,r.zG)(t.webClient,s.UI(o.UI((e=>e.url))))})})),i.ak("advertiserSegmentation",(t=>{let{queryLanguage:r,newEventsForAdvertiserSegmentation:i}=t;return xs(e,s.vP({consent:n,customCohorts:Cr(r.currentPageviewSegments.custom),realtime:r.realtime,sessionId:l,standardCohorts:Cr(r.currentPageviewSegments.standard),userId:f,viewId:h,events:i}))})),i.ak("ipIdentifier",(e=>{let{userId:t,geoip:n}=e;return(0,r.zG)(n.data,s.UI(o.tS(o.KQ((e=>e.ip))))),Os})),i.ak("secureSignal",(t=>{let{advertiserSegmentation:n,demandPartners:o}=t;return(0,r.zG)(As(e,(0,r.zG)(f,s.UI((e=>({userId:e,advertiserCohorts:n.cohorts,stdAudienceCohorts:o.ssp}))))),i.UI((e=>{let{signalRef:t}=e;return t})))})),i.ak("nonQlCohorts",(e=>{let{advertiserSegmentation:t,classificationModels:n,contextualCohorts:s,setNonQlCohorts:o,demandPartners:a,viewId:c}=e;return(0,r.zG)(i.of(Oe.oA({advertiser:t.cohorts,classificationModel:n,contextual:cs({contextualCohorts:s,viewId:c}),ssp:a.ssp})),i.bw(o))})),i.Hr("qlCohorts",(e=>{let{queryLanguage:t}=e;return(0,r.zG)(t.segments.all,s.UI(Rt.UI(String)))})),i.bw((t=>{return t.collectTargetingSuccessMetrics(ss({adServers:t.adServers,cohorts:{...t.nonQlCohorts,query_language:(n=t.qlCohorts,(0,r.zG)(n,Er,ei))},logger:e.logger,metrics:e.metrics}));var n})),i.Hr("eventsToPublish",(t=>{let{qlCohorts:n,queryLanguage:i,nonQlCohorts:o}=t;const a=(e=>{if(!e.metrics.isEnabled())return e=>{};const t=(0,r.zG)(e.cohortsByType,Oe.UI(s.Rp(new Set,((e,t)=>new Set([...e,...t])))),(e=>s.vP(e)));return n=>{"Pageview"===n.name&&(0,p.HJ)((()=>(0,r.zG)(n.cohorts,Ds(t.current),Oe.Su(((t,n)=>e.metrics.track({name:"sdk_pageview_cohort_count",labels:{cohort_type:t},value:n}))))))}})({cohortsByType:(0,r.zG)(o,Oe.UI(ni),Oe.dx("query_language",n)),metrics:e.metrics});return(0,r.zG)(i.eventsToPublish,s.UI(d.UI(Rt.UI((0,g.bw)((e=>{let[,t]=e;return a(t)}))))))})),i.UI((e=>{let{adServers:t,advertiserSegmentation:n,demandPartners:i,eventsToPublish:o,geoip:a,queryLanguage:c,nonQlCohorts:u,watson:l,secureSignal:f}=e;return{activations:(0,r.zG)(t,Rt.UI((e=>(0,r.zG)(Object.values(u),Rt.UI(ti),Rt.DZ((t=>t.byAdServer(e))),Rt.UI(Ar),Rt.UI(s.D8(Rt.Eh(A.Eq))),(e=>s.vP(...e)),s.UI(Rt.xH),(t=>(0,r.bc)(e.id,t))))),Oe.sq),cohorts:{all:c.cohorts,ql:c.segments.all,qlCustom:c.segments.custom,qlStandard:c.segments.standard},context:(0,r.zG)(s.vP(l.permutiveContext,a.permutiveContext),s.UI((e=>{let[t,n]=e;return{...t,...n}}))),eventsToPublish:o,eventsToPublishOnPageUnload:c.eventsToPublishOnPageUnload,externalData:s.vP({...n.externalData,...i.externalData}),geoIP:a.data,realtime:c.realtime,stateMigratedThisInitialisation:c.stateMigratedThisInitialisation,transitionsSinceInit:c.transitionsSinceInit,secureSignal:f}})))}},387:(e,t,n)=>{n.d(t,{BJ:()=>f,El:()=>P,G6:()=>_,HD:()=>l,HP:()=>k,Kn:()=>u,Or:()=>S,PQ:()=>y,SL:()=>p,aT:()=>m,b0:()=>b,b2:()=>g,bw:()=>q,k$:()=>v,lo:()=>U,mQ:()=>G,rO:()=>z,vg:()=>I,vp:()=>d});var r=n(358),i=n(275),s=n(492),o=n(491),a=n(29),c=n(812);const u=e=>"object"==typeof e&&!Array.isArray(e)&&null!==e,l=e=>"string"==typeof e,f=e=>"number"==typeof e&&!Number.isNaN(e);function d(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}function p(e){return t=>{let n=0;for(let r of t){n=n+e(r)|0}return n}}o.ff(a.xb);function g(){let e,t;return{promise:new Promise(((n,r)=>{e=n,t=r})),reject:t,resolve:e}}let h=[];function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:navigator.userAgent;if(h.unshift(e),h.length>1)return;const n=["beforeunload","pagehide"],r=n.concat(["visibilitychange"]),i=e=>{if(!s&&e){s=!0;const e=h;h=[],e.forEach((e=>{try{e()}catch{}}))}};let s=!1;r.forEach((e=>{window.addEventListener(e,(()=>{const n=("visibilitychange"!==e||document.hidden)&&w(t);i(n)}))})),n.forEach((e=>{window.addEventListener(e,(()=>i(!0)))}))}function v(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^(self.crypto||self.msCrypto).getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)))}function b(e,t){const n=Object.keys(e),r=n.length,i={};for(let o=0;o<r;o++){const r=n[o],a=t(r,e[r]);(0,s.pC)(a)&&(i[r]=a.value)}return i}function w(e){return/Mobi|Android/i.test(e)}function _(e){return/^((?!chrome|android).)*safari/i.test(e)}function y(e,t){return new Promise((n=>{(0,c.HJ)((()=>{Promise.resolve(e()).then(n)}),(null==t?void 0:t.timeout)??0)}))}const S=()=>({equals:(e,t)=>Object.is(e,t)});function I(e){return t=>null!=t&&e in t?t[e]:void 0}function k(e){let t=s.YP;const n=(0,s.fS)((()=>{const n=e();return t=(0,s.G)(n),n}));return()=>n(t)}const G=e=>{const t=new Map;return n=>(t.has(n)||t.set(n,e(n)),t.get(n))},z=e=>t=>{const n={...t};for(const i in e){var r;n[i]=null===(r=e[i])||void 0===r?void 0:r.call(e,t[i])}return n};function q(e){return t=>(e(t),t)}const U=e=>t=>{const n=e.slice(0,-1),o=e.slice(-1)[0];return(0,i.zG)(n,r.f2((e=>{let[n,r]=e;return(0,i.zG)(t,s.DT(n),s.UI(r))})),s.fS((()=>o(t))))},E=e=>t=>{if("number"==typeof t)return t;if("string"==typeof t){const n=e(t);return Number.isNaN(n)?void 0:n}};E(parseInt),E(parseFloat);function P(e){return"object"==typeof e&&null!==e&&"_tag"in e&&["None","Some"].includes(e._tag)}},965:(e,t,n)=>{n.r(t),n.d(t,{lookalikeModelsService:()=>_,realService:()=>S,stubService:()=>y});var r=n(275),i=n(492);const s=(e,t,n,r)=>t+(n-t)*r/(Math.pow(2,e)-1),o=(e,t)=>{const n=(e,t)=>{const n=e.toString(16);return("0".repeat(t)+n).slice(Math.min(-t,-n.length))};return`${n(e.getUint32(t),8)}-${n(e.getUint16(t+4),4)}-${n(e.getUint16(t+6),4)}-${n(e.getUint16(t+8),4)}-${n(e.getUint32(t+10),8)}${n(e.getUint16(t+14),4)}`},a=e=>{const t=[1,2],n=e.getInt8(0);if(1===n)return c(e);if(2===n)return u(e);{const r=(0,i.Y3)((()=>o(e,1))),s=(0,i.g_)((()=>"Couldn\'t decode model id"),(e=>`Model id was ${e}`))(r);throw new Error(`Decoding only supported for version(s): ${t}; Supplied version was ${n}; ${s}`)}},c=e=>l(e,1),u=e=>l(e,2),l=(e,t)=>{const n=o(e,1),r=((e,t)=>{switch(String.fromCharCode(e.getInt8(t))){case"1":return"1p";case"3":return"3p"}})(e,17),i=e.getInt8(18),s=e.getFloat32(19),a=e.getFloat32(23),[c,u]=((e,t,n,r,i,s)=>{const o={};let a=0;do{let n;1===s?(a=e.getUint16(t),n=e.getUint16(t+2),t+=4):(a=e.getUint32(t),n=e.getUint16(t+4),t+=6),o[0===a?"const":a]=n.toString(36)}while(0!==a);return[o,t]})(e,27,0,0,0,t);return[{version:t,id:n,data_preference:r,weights:c,precision:i,min:s,max:a},u]};var f=n(716),d=n(940),p=n(812),g=n(936),h=n(460),m=n(385),v=n(371),b=n(387);const w=()=>i.G({}),_=S;function y(e){return g.K4((()=>h.a9(w())))}function S(e){e.logger.warn("add cleanup of legacy LAL cache");const t=e.trace.startSpan("lookalike_models_data_retrieval_duration");return(0,r.zG)(v.m((0,r.zG)(h.vP(e.consent,e.currentTimestampSecs),h.UI((t=>{let[n,o]=t;return{currentTimestampSecs:o,validity:{maxAge:604800,key:()=>null},freshness:{maxAge:86400,key:()=>null},refresh:(0,r.zG)(n,i.DT(Boolean),i.UI((()=>()=>f.fF(function(e){const t="Failed fetching binary models, reverting to JSON.\\nError: ",n="Failed fetching json models.\\nError: ";return(0,r.zG)(f.Y3((()=>k(e)),(e=>e.message)),p.N1,f.oU((e=>()=>function(e){const t=[];let n=0;for(;n<e.byteLength;){const[r,i]=a(new DataView(e,n));t.push(r),n+=i}return t}(e))),p.N1,f.UI(I((e=>{let{precision:t,max:n,min:r}=e;return{"1p":{},precision:t,min:r,max:n}}))),f.Vn((n=>(e.logger.log(t+n),e.metrics.track({name:"sdk_binary_models_missing_count",value:1,labels:{}}),n))),f.wp((()=>(0,r.zG)(f.Y3((()=>G(e)),(e=>e.message)),f.UI((e=>e.models)),f.UI(I((()=>({"1p":{}}))))))),f.UI((e=>(e=>{const t=Object.keys(e);return t.length>0&&e[t[0]].hasOwnProperty("precision")})(e)?(e=>{const t={},n=Object.keys(e),r=e=>{const t={"1p":{}},{precision:n,min:r,max:i}=e,o=e["1p"],a=Object.keys(o);for(let e=0;e<a.length;e++){const c=a[e],u=parseInt(o[c],36);t["1p"][c]=s(n,r,i,u)}return t};for(let i=0;i<n.length;i++){const s=n[i],o=e[s];t[s]=r(o)}return t})(e):e)),f.fS((t=>(e.reportError(n+t),d.of({})))))}(e)))))}})))),g.UI(h.UI((0,r.ls)(m.fS((t=>(e.logger.warn("[LAL]",`Failed to refresh, using zero value. ${t}`),w()))),(0,b.bw)(i.UI((()=>{t.finish(),e.metrics.trackTimeSinceInit("sdk_lifecycle_timestamps",{timestamp_name:"lookalike_models_ready",time_origin:"sdk_init"})})))))))}function I(e){return t=>{const n={};for(let r=0;r<t.length;r++){const i=t[r],{id:s,weights:o}=i;if(void 0===s||void 0===o)continue;const a=e(i);Object.keys(o).forEach((e=>{a["1p"][e]=o[e]})),n[s]=a}return n}}const k=e=>{const{permutiveApi:t,config:n,metrics:r}=e,i=r.startTimer("sdk_http_models_seconds",{});return t.req({url:z(n.cdnProtocol,n.cdnBaseUrl,"binary"),method:"GET",contentType:"text/plain",dataType:"binary",withCredentials:!1}).then((e=>(r.stopTimer("sdk_http_models_seconds",i),e)))},G=e=>{const{permutiveApi:t,config:n,metrics:r}=e,i=r.startTimer("sdk_http_models_seconds",{});return t.req({url:z(n.cdnProtocol,n.cdnBaseUrl,"json"),method:"GET",contentType:"text/plain",dataType:"json",withCredentials:!1}).then((e=>(r.stopTimer("sdk_http_models_seconds",i),e)))};function z(e,t,n){const r=`${e}://${t}`;switch(n){case"binary":return`${r}/models/v2/f279b5ea-1200-4ff6-9d35-17893279723e-models.bin`;case"json":return`${r}/models/f279b5ea-1200-4ff6-9d35-17893279723e-models.json`}}},343:(e,t,n)=>{n.d(t,{K:()=>U,O:()=>z});let r,i;const s=new WeakMap,o=new WeakMap,a=new WeakMap,c=new WeakMap,u=new WeakMap;let l={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return o.get(e);if("objectStoreNames"===t)return e.objectStoreNames||a.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return p(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function f(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(g(this),t),p(s.get(this))}:function(...t){return p(e.apply(g(this),t))}:function(t,...n){const r=e.call(g(this),t,...n);return a.set(r,t.sort?t.sort():[t]),p(r)}}function d(e){return"function"==typeof e?f(e):(e instanceof IDBTransaction&&function(e){if(o.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));o.set(e,t)}(e),t=e,(r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,l):e);var t}function p(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(p(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&s.set(t,e)})).catch((()=>{})),u.set(t,e),t}(e);if(c.has(e))return c.get(e);const t=d(e);return t!==e&&(c.set(e,t),u.set(t,e)),t}const g=e=>u.get(e);const h=["get","getKey","getAll","getAllKeys","count"],m=["put","add","delete","clear"],v=new Map;function b(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(v.get(t))return v.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=m.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!h.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&s.done]))[0]};return v.set(t,s),s}l=(e=>({...e,get:(t,n,r)=>b(t,n)||e.get(t,n,r),has:(t,n)=>!!b(t,n)||e.has(t,n)}))(l);var w=n(865),_=n(385),y=n(275),S=n(940),I=n(716),k=n(387),G=n(812);const z="[IDB]",q=(e,t,n,r,i,s)=>(0,y.zG)((0,S.of)(e.getNamespacedStorageKey(i)),(0,S.tS)((e=>(0,I.Y3)((async()=>n.put(r,s,e)),w.w))),(0,S.UI)((0,_.g_)((e=>{throw t.error(z,`Failed to store crypto key to ${r} due to unexpected error,\\n`,e),e}),(()=>s))),(e=>e()));class U{namespace;logger;cryptoAlg;idb;mainObjectStore;keyObjectStore;keyObjectKey;cryptoKey;MAX_CONSECUTIVE_PUTS=30;puts=1;hasForcedCompaction=!1;constructor(e,t,n,r,i,s,o,a){this.namespace=e,this.logger=t,this.cryptoAlg=n,this.idb=r,this.mainObjectStore=i,this.keyObjectStore=s,this.keyObjectKey=o,this.cryptoKey=a,this.logDebug("Created",this.idb)}static initialise(e,t,n,r,i,s,o,a,c,u){const l=(0,k.G6)(navigator.userAgent)&&!1,f=[u,r.isAvailable(),!l].every((e=>!0===e)),d=async(t,i,s)=>(0,y.zG)(await t.get(s,e.getNamespacedStorageKey(i)),(async e=>e??r.generateKey(!1)),(async r=>q(e,n,t,o,a,await r))).catch((e=>{const t=(0,w.w)(e);throw n.error(z,"Get crypto key failed. Got\\n",t),t})),p=(e,t,n)=>t.includes(n)?(0,y.Q1)():e.createObjectStore(n),g=()=>E(i,c,{upgrade:e=>{const t=[...e.objectStoreNames];p(e,t,s),p(e,t,o)}}).then((e=>{const t=[...e.objectStoreNames];return t.includes(s)&&t.includes(o)?e:Promise.reject(new Error("Object store(s) missing."))})),h=f?(0,_.Y3)((()=>function(e){if(!(0,k.G6)(navigator.userAgent)||!indexedDB.databases)return Promise.resolve();let t=()=>{},n=0;return new Promise((e=>{const r=()=>(n++,indexedDB.databases().finally((0,G.GL)(e)));t=(0,G.UM)(r,100),r()})).finally((()=>{t(),e.track({name:"sdk_idb_conn_attempt_safari_count",value:n,labels:{}})}))}(t).then((()=>g())).catch((e=>(n.error(`Re-creating IDB database ${i} due to error`,e),P(i).then((()=>g())))))),String):(0,_.t$)("Connection not attempted. Default to localStorage");return(0,_.g_)((e=>(0,I.t$)(e)),(t=>(0,y.zG)((0,I.Y3)((()=>t.then((async e=>({db:e,cryptoKey:await d(e,a,o)})))),String),(0,I.UI)((t=>{let{db:i,cryptoKey:c}=t;return new U(e,n,r,i,s,o,a,c)})))))(h)}async put(e,t){return(0,y.zG)((async()=>(0,y.bc)(JSON.stringify(e),this.cryptoKey)),(0,S.tS)((e=>{let[t,n]=e;return(0,S.of)(this.cryptoAlg.encrypt(n,t))})),(0,S.tS)((e=>async()=>(await this.recreateIfNecessary(this.puts++),e))),(0,S.tS)((e=>(0,I.Y3)((()=>this.idb.put(this.mainObjectStore,e,this.namespace.getNamespacedStorageKey(String(t)))),w.w))),(0,S.UI)((0,_.g_)((n=>{throw this.logError(`Failed to put "${t.toString()}" value`,e,". Got \\n",n),"QuotaExceededError"===n.name&&this.forceCompaction(),n}),(()=>t))),(e=>e()))}get(e){return(0,y.zG)(this.namespace.getNamespacedStorageKey(String(e)),(t=>this.idb.get(this.mainObjectStore,t).then((async e=>e?JSON.parse(await this.cryptoAlg.decrypt(this.cryptoKey,e)):null)).catch((t=>{const n=(0,w.w)(t);throw this.logError(`Get ${e.toString()} failed. Got`,n),n}))))}delete(e){return(0,y.zG)(this.namespace.getNamespacedStorageKey(String(e)),(e=>this.idb.delete(this.mainObjectStore,e)))}deleteStore(){return this.logDebug("Deleting",this.idb),this.idb.close(),P(this.idb.name)}forceCompaction(){if(this.hasForcedCompaction)return null;this.hasForcedCompaction=!0,this.logDebug("Attempting to force compaction");const e=`__${this.mainObjectStore}`;return E(e).then((t=>(t.close(),P(e))))}recreateIfNecessary(e){return(0,k.G6)(navigator.userAgent)&&e%this.MAX_CONSECUTIVE_PUTS==0?this.recreate():Promise.resolve()}async recreate(){const e=this.idb.name,t=this.idb.version,n=await this.idb.getAllKeys(this.mainObjectStore),r=[];for(const e of n)r.push([e,await this.idb.get(this.mainObjectStore,e)]);await this.deleteStore(),this.idb=await E(e,t,{upgrade:e=>{e.createObjectStore(this.mainObjectStore),e.createObjectStore(this.keyObjectStore)}}),await Promise.all(r.map((e=>{let[t,n]=e;return this.idb.put(this.mainObjectStore,n,t)}))),await q(this.namespace,this.logger,this.idb,this.keyObjectStore,this.keyObjectKey,this.cryptoKey),this.logDebug("Reset to",this.idb)}logDebug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.debug(z,...t)}logError(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.error(z,...t)}}const E=(0,y.ls)((function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=p(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(p(o.result),e.oldVersion,e.newVersion,p(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(()=>i()))})).catch((()=>{})),a}),G.t_,(e=>e.then((e=>({close:e.close.bind(e),createObjectStore:(0,y.ls)(e.createObjectStore.bind(e),y.Q1),delete:(0,y.ls)(e.delete.bind(e),G.t_),get:(0,y.ls)(e.get.bind(e),G.t_),getAllKeys:(0,y.ls)(e.getAllKeys.bind(e),G.t_),get name(){return e.name},get objectStoreNames(){return e.objectStoreNames},put:(0,y.ls)(e.put.bind(e),G.t_),get version(){return e.version}}))))),P=(0,y.ls)((function(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(()=>t())),p(n).then((()=>{}))}),G.t_)},699:(e,t,n)=>{n.r(t),n.d(t,{make:()=>o});var r=n(275),i=n(343);const s=e=>{const{logger:t,consent:n,prefix:r}=e,i=(e,n)=>(t.debug(`${r} Failed to write ${String(n)} as consent is revoked`),Promise.resolve(n));return e=>class extends e{put=((e,t,n)=>function(){return(n()?t:e)(...arguments)})(super.put.bind(this),i,(()=>!n.current))}},o=(e,t,n,o,a,c,u,l,f,d,p)=>(0,r.zG)(i.K,s({logger:f,consent:d,prefix:i.O})).initialise(e,t,f,n,o,a,c,u,l,p)},414:(e,t,n)=>{n.r(t),n.d(t,{watson:()=>l});var r=n(460),i=n(275),s=n(492),o=n(385),a=n(583),c=n(29),u=n(569);const l=e=>(0,i.zG)(d(e),r.YO("data"),r.Hr("replacementMap",(e=>{let{data:t}=e;return(0,i.zG)(t,s.YO("data"),s.Hr("taxonomyLabels",(e=>{let{data:t}=e;return function(e){const t=e=>{const t=e.split("/").filter((e=>e));return t.map(((e,n)=>"/"+t.slice(0,n+1).join("/")))},n=a.xH(e.filter(Boolean).map((e=>t(e.label))));return a.jj(c.Eq)(n)}(t.taxonomy??[])})),s.UI((e=>{var t,n,r;let{data:s,taxonomyLabels:o}=e;return{$alchemy_concepts:s.concepts??[],$alchemy_document_emotion:(null===(t=s.emotion)||void 0===t||null===(n=t.document)||void 0===n?void 0:n.emotion)??null,$alchemy_document_sentiment:(null===(r=s.sentiment)||void 0===r?void 0:r.document)??null,$alchemy_entities:s.entities??[],$alchemy_entity_names:(0,i.zG)(s.entities??[],a.UI((e=>e.text))),$alchemy_keywords:s.keywords??[],$alchemy_taxonomy:s.taxonomy??[],$alchemy_taxonomy_labels:o,$taxonomy_labels:o}})))})),r.Hr("permutiveContext",(e=>{let{data:t}=e;return(0,i.zG)(t,s.EQ((()=>({})),(e=>({watson:e}))))})),(e=>({permutiveContext:(0,i.zG)(e,r.UI((e=>e.permutiveContext))),replacementMap:(0,i.zG)(e,r.UI((e=>e.replacementMap)))}))),f=()=>r.a9(s.G({})),d=e=>(0,i.zG)(r.vP(e.watsonEnabled,e.pageUrl),r.UI((0,i.ls)(s.DT(u.li),s.tS(u.Yg))),r.UI(s.UI((0,i.ls)(p(e.permutiveApi,e.metrics,e.config,e.permutiveUrls,e.trace),r.p4,r.UI(s.UI(o.fS((()=>({})))))))),r.VS(s.fS(f))),p=(e,t,n,r,i)=>o=>{const a=t.startTimer("sdk_http_watson_seconds",{}),c=i.startSpan("watson_data_retrieval");return e.req({url:r.getEndpointUrl("/watson",s.G(n.apiVersion)),method:"POST",contentType:"text/plain",dataType:"json",withCredentials:!1,payload:{url:o,classify:!0}}).then((e=>(t.stopTimer("sdk_http_watson_seconds",a),t.trackTimeSinceInit("sdk_lifecycle_timestamps",{timestamp_name:"watson_data_ready",time_origin:"sdk_init"},performance.now()),c.finish(),e)))}},925:(e,t,n)=>{n.d(t,{N:()=>o,Qt:()=>c,Yt:()=>p,a1:()=>a,ap:()=>s,gz:()=>d});var r=n(275),i=n(963);function s(e,t){return function(n){return function(r){return e.ap(e.map(r,(function(e){return function(n){return t.ap(e,n)}})),n)}}}function o(e){return function(t){return function(n){return e.ap(e.map(n,(function(e){return function(){return e}})),t)}}}function a(e){return function(t){return function(n){return e.ap(e.map(n,(function(){return function(e){return e}})),t)}}}function c(e){return function(t,n){return function(r){return e.ap(e.map(r,(function(e){return function(n){var r;return Object.assign({},e,((r={})[t]=n,r))}})),n)}}}function u(e,t,n){return function(r){for(var i=Array(n.length+1),s=0;s<n.length;s++)i[s]=n[s];return i[n.length]=r,0===t?e.apply(null,i):u(e,t-1,i)}}var l={1:function(e){return[e]},2:function(e){return function(t){return[e,t]}},3:function(e){return function(t){return function(n){return[e,t,n]}}},4:function(e){return function(t){return function(n){return function(r){return[e,t,n,r]}}}},5:function(e){return function(t){return function(n){return function(r){return function(i){return[e,t,n,r,i]}}}}}};function f(e){return i.e$.call(l,e)||(l[e]=u(r.bc,e-1,[])),l[e]}function d(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=t.length,i=f(r),s=e.map(t[0],i),o=1;o<r;o++)s=e.ap(s,t[o]);return s}}function p(e){return function(t){for(var n=Object.keys(t),r=n.length,i=function(e){var t=e.length;switch(t){case 1:return function(t){var n;return(n={})[e[0]]=t,n};case 2:return function(t){return function(n){var r;return(r={})[e[0]]=t,r[e[1]]=n,r}};case 3:return function(t){return function(n){return function(r){var i;return(i={})[e[0]]=t,i[e[1]]=n,i[e[2]]=r,i}}};case 4:return function(t){return function(n){return function(r){return function(i){var s;return(s={})[e[0]]=t,s[e[1]]=n,s[e[2]]=r,s[e[3]]=i,s}}}};case 5:return function(t){return function(n){return function(r){return function(i){return function(s){var o;return(o={})[e[0]]=t,o[e[1]]=n,o[e[2]]=r,o[e[3]]=i,o[e[4]]=s,o}}}}};default:return u((function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];for(var i={},s=0;s<t;s++)i[e[s]]=n[s];return i}),t-1,[])}}(n),s=e.map(t[n[0]],i),o=1;o<r;o++)s=e.ap(s,t[n[o]]);return s}}},358:(e,t,n)=>{n.d(t,{Ce:()=>u,DY:()=>I,Eh:()=>j,GY:()=>S,Gb:()=>g,KB:()=>f,Lx:()=>A,Od:()=>c,Qp:()=>w,Su:()=>E,UI:()=>q,YM:()=>p,f2:()=>_,fw:()=>T,hX:()=>D,ke:()=>h,md:()=>b,oA:()=>O,pR:()=>R,tS:()=>U,yL:()=>k,yW:()=>F,zT:()=>v});var r=n(275),i=(n(560),n(963)),s=n(586),o=n(583),a=(n(219),n(511),function(e){return 0===e.length}),c=s.Od,u=s.Ce,l=(s.ws,s.R3),f=(s.Im,function(e,t){return e<=0?[]:s.KB(t)(e)});var d=s.dC,p=(o.P5,o.YM),g=(o.Z$,function(e){return c(e)?i.G(s.Gb(e)):i.YP}),h=function(e){return function(t){return d(e,t)?y(t):t.slice(0,e)}};var m=function(e,t){for(var n=e.length,r=0;r<n&&t(e[r]);r++);return r};function v(e){return function(t){var n=G(m(t,e))(t);return{init:n[0],rest:n[1]}}}var b=function(e){return function(t){return e<=0||a(t)?y(t):e>=t.length?[]:t.slice(e,t.length)}};function w(e){return function(t){return t.slice(m(t,e))}}o.cx;var _=o.f2;o.JO,o.qr;var y=function(e){return e.slice()},S=function(e){return a(e)?[]:e.slice().reverse()},I=function(e){return function(t){return t.length<=1?y(t):t.slice().sort(e.compare)}},k=function(e,t,n){for(var r=[],i=Math.min(e.length,t.length),s=0;s<i;s++)r[s]=n(e[s],t[s]);return r};o.t9;var G=function(e){return function(t){return e>=1&&c(t)?s.lx(e)(t):a(t)?[y(t),[]]:[[],y(t)]}};o.kp,o.Eq;var z=s.of,q=function(e){return function(t){return t.map((function(t){return e(t)}))}},U=function(e){return function(t){return(0,r.zG)(t,function(e){return function(t){for(var n=[],r=0;r<t.length;r++)n.push.apply(n,e(r,t[r]));return n}}((function(t,n){return e(n)})))}},E=function(e){return function(t){return t.map((function(t,n){return e(n,t)}))}},P=function(e){return function(t){for(var n=[],r=0;r<t.length;r++){var s=e(r,t[r]);i.pC(s)&&n.push(s.value)}return n}},x=function(e){return P((function(t,n){return e(n)}))},O=x(r.yR),D=function(e){return function(t){return t.filter(e)}},A=o.Lx,C=(o.xP,o.u4,o.OE),T=(o.nq,o.iw,function(e){var t=M(e);return function(e){return t((function(t,n){return e(n)}))}}),M=function(e){return function(t){return C(e.of([]),(function(n,i,s){return e.ap(e.map(i,(function(e){return function(t){return(0,r.zG)(e,l(t))}})),t(n,s))}))}},j=(o.ZN,o.Eh),R=o.pR,F=(o.pJ,o.oR,s.oo,o.yW);o.j0,i.F4,s.w6,s.QI,s.Ss},543:(e,t,n)=>{function r(e){return function(t){return function(n){return e.chain(n,(function(n){return e.map(t(n),(function(){return n}))}))}}}function i(e){return function(t,n){return function(r){return e.chain(r,(function(r){return e.map(n(r),(function(e){var n;return Object.assign({},r,((n={})[t]=e,n))}))}))}}}n.d(t,{a:()=>i,m:()=>r})},385:(e,t,n)=>{n.d(t,{g1:()=>_,G5:()=>w,dO:()=>m,Pd:()=>k,ak:()=>N,YO:()=>L,tS:()=>S,g_:()=>D,ij:()=>M,Yo:()=>U,DT:()=>q,Eh:()=>g,fS:()=>A,nM:()=>E,t$:()=>c,UI:()=>h,Vn:()=>G,EQ:()=>O,aD:()=>x,of:()=>v,vx:()=>T,F2:()=>u,LF:()=>C,KC:()=>Q,i$:()=>F,Y3:()=>j,it:()=>R});var r=n(543),i=n(162),s=n(275),o=n(560),a=n(963),c=a.t$,u=a.F2,l=function(e,t){return(0,s.zG)(e,h(t))},f=function(e,t){return(0,s.zG)(e,b(t))},d=function(e,t){return(0,s.zG)(e,S(t))},p="Either",g=function(e,t){return{equals:function(n,r){return n===r||(E(n)?E(r)&&e.equals(n.left,r.left):P(r)&&t.equals(n.right,r.right))}}},h=function(e){return function(t){return E(t)?t:u(e(t.right))}},m={URI:p,map:l},v=u,b=function(e){return function(t){return E(t)?t:E(e)?e:u(t.right(e.right))}},w={URI:p,map:l,ap:f},_={URI:p,map:l,ap:f,of:v},y=function(e){return function(t){return E(t)?t:e(t.right)}},S=y,I={URI:p,map:l,ap:f,chain:d},k=function(e,t){return function(n){return E(n)?c(e(n.left)):u(t(n.right))}},G=function(e){return function(t){return E(t)?c(e(t.left)):t}},z={URI:p,fromEither:s.yR},q=(0,i.DT)(z),U=(0,i.Yo)(z),E=a.nM,P=a.tO,x=function(e,t){return function(n){return E(n)?e(n.left):t(n.right)}},O=x,D=O,A=function(e){return function(t){return E(t)?e(t.left):t.right}},C=function(e){return E(e)?u(e.left):c(e.right)},T=function(e){return function(t){return E(t)?e(t.left):t}},M=function(e){return function(t){return null==t?c(e):u(t)}},j=function(e,t){try{return u(e())}catch(e){return c(t(e))}},R=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return j((function(){return e.apply(void 0,n)}),t)}},F=x(s.yR,s.yR);function Q(e){return e instanceof Error?e:new Error(String(e))}a.F4;var L=(0,o.YO)(m),N=(0,r.a)(I);a.Xl},890:(e,t,n)=>{n.d(t,{EQ:()=>_,F2:()=>a,KQ:()=>d,LF:()=>z,LU:()=>G,LV:()=>y,NG:()=>p,Pd:()=>b,UI:()=>g,Vn:()=>w,ap:()=>h,dQ:()=>k,fS:()=>S,i$:()=>q,ij:()=>f,m8:()=>u,pk:()=>l,t$:()=>c,tS:()=>m,vx:()=>I,wp:()=>v});var r=n(925),i=n(385),s=n(275),o=n(560);function a(e){return(0,s.ls)(i.F2,e.of)}function c(e){return(0,s.ls)(i.t$,e.of)}function u(e){return function(t){return e.map(t,i.F2)}}function l(e){return function(t){return e.map(t,i.t$)}}function f(e){return function(t){return(0,s.ls)(i.ij(t),e.of)}}function d(e){var t=f(e);return function(e){var n=t(e);return function(e){return(0,s.ls)(e,n)}}}function p(e){var t=m(e),n=d(e);return function(e){var r=n(e);return function(e){return t(r(e))}}}function g(e){return(0,o.UI)(e,i.dO)}function h(e){return(0,r.ap)(e,i.G5)}function m(e){return function(t){return function(n){return e.chain(n,(function(n){return i.nM(n)?e.of(n):t(n.right)}))}}}function v(e){return function(t){return function(n){return e.chain(n,(function(n){return i.nM(n)?t():e.of(n)}))}}}function b(e){return function(t,n){return function(r){return e.map(r,i.Pd(t,n))}}}function w(e){return function(t){return function(n){return e.map(n,i.Vn(t))}}}function _(e){return function(t,n){return function(r){return e.map(r,i.EQ(t,n))}}}function y(e){return function(t,n){return function(r){return e.chain(r,i.EQ(t,n))}}}function S(e){return function(t){return function(n){return e.chain(n,i.EQ(t,e.of))}}}function I(e){return function(t){return function(n){return e.chain(n,(function(n){return i.nM(n)?t(n.left):e.of(n)}))}}}function k(e){var t=I(e);return function(n){return t((function(t){return e.map(n(t),(function(e){return i.nM(e)?e:i.t$(t)}))}))}}function G(e){return function(t){return function(n){return e.chain(n,i.EQ((function(n){return e.map(t(n),i.t$)}),(function(t){return e.of(i.F2(t))})))}}}function z(e){return function(t){return e.map(t,i.LF)}}function q(e){return function(t){return e.map(t,i.i$)}}},191:(e,t,n)=>{n.d(t,{MW:()=>c,Uz:()=>o,bc:()=>s,f7:()=>r,n_:()=>i,w4:()=>a});n(275);var r=function(e){return{equals:function(t,n){return t===n||e(t,n)}}},i=function(e){return r((function(t,n){for(var r in e)if(!e[r].equals(t[r],n[r]))return!1;return!0}))},s=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r((function(t,n){return e.every((function(e,r){return e.equals(t[r],n[r])}))}))},o=function(e){return function(t){return r((function(n,r){return t.equals(e(n),e(r))}))}},a={equals:function(e,t){return e===t}},c=i;a.equals},162:(e,t,n)=>{n.d(t,{DT:()=>o,Dj:()=>a,Yo:()=>s,fX:()=>c});var r=n(275),i=n(963);function s(e){return function(t){return function(n){return e.fromEither(i.Wi(n)?i.t$(t()):i.F2(n.value))}}}function o(e){return function(t,n){return function(r){return e.fromEither(t(r)?i.F2(r):i.t$(n(r)))}}}function a(e){return function(t){return(0,r.ls)(t,e.fromEither)}}function c(e,t){var n=a(e);return function(e){return function(r){return t.chain(r,n(e))}}}},395:(e,t,n)=>{n.d(t,{At:()=>o,oU:()=>s});var r=n(543),i=n(275);function s(e,t){return function(n){var r=(0,i.ls)(n,e.fromIO);return function(e){return t.chain(e,r)}}}function o(e,t){var n=(0,r.m)(t);return function(t){return n((0,i.ls)(t,e.fromIO))}}},272:(e,t,n)=>{n.d(t,{oU:()=>s,wt:()=>i});var r=n(275);function i(e){return function(t){return(0,r.ls)(t,e.fromTask)}}function s(e,t){return function(n){var i=(0,r.ls)(n,e.fromTask);return function(e){return t.chain(e,i)}}}},560:(e,t,n)=>{function r(e,t){return function(n){return function(r){return e.map(r,(function(e){return t.map(e,n)}))}}}function i(e){return function(t){return function(n){return e.map(n,(function(e){return e(t)}))}}}function s(e){return function(t){return function(n){return e.map(n,(function(e){var n;return(n={})[t]=e,n}))}}}function o(e){return function(t,n){return function(r){return e.map(r,(function(e){var r;return Object.assign({},e,((r={})[t]=n(e),r))}))}}}n.d(t,{Hr:()=>o,OV:()=>i,UI:()=>r,YO:()=>s})},444:(e,t,n)=>{n.d(t,{G5:()=>p,PM:()=>d,RD:()=>w,UA:()=>h,UI:()=>c,dO:()=>f,of:()=>u,qo:()=>g});var r=n(275),i=(n(560),n(963)),s=function(e,t){return function(){return t(e())}},o=function(e,t){return function(){return e()(t())}},a=function(e,t){return function(){return t(e())()}},c=function(e){return function(t){return s(t,e)}},u=r.a9,l="IO",f={URI:l,map:s},d={URI:l,of:u},p={URI:l,map:s,ap:o},g={URI:l,map:s,ap:o,chain:a},h={URI:l,map:s,ap:o,of:u,chain:a},m=(r.yR,r.yR,i.F4,u(i.Xl)),v=function(e){var t=function(e){return function(t){return function(){for(var n=[e(0,i.YM(t))()],r=1;r<t.length;r++)n.push(e(r,t[r])());return n}}}(e);return function(e){return i.Od(e)?t(e):m}},b=function(e){return v((function(t,n){return e(n)}))},w=b(r.yR)},586:(e,t,n)=>{n.d(t,{Ce:()=>l,Eh:()=>S,Gb:()=>k,Im:()=>f,KB:()=>m,Od:()=>a,QI:()=>z,R3:()=>d,Ss:()=>q,dC:()=>c,lx:()=>y,nI:()=>h,of:()=>w,oo:()=>p,ur:()=>G,w6:()=>v,ws:()=>u,yL:()=>_});var r=n(275),i=(n(560),n(963)),s=n(350),o=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},a=function(e){return e.length>0},c=function(e,t){return e<0||e>=t.length},u=function(e){return function(t){return o([e],t,!0)}},l=u,f=function(e){return function(t){return o(o([],t,!0),[e],!1)}},d=f,p=function(e,t,n){if(a(n)){var r=g(n);return r.splice(e,0,t),r}return[t]},g=i.r1,h=function(e){return a(e)?i.G(e):i.YP},m=function(e){return function(t){for(var n=Math.max(0,Math.floor(t)),r=[e(0)],i=1;i<n;i++)r.push(e(i));return r}},v=function(e,t){return e<=t?m((function(t){return e+t}))(t-e+1):[e]};var b=g,w=function(e){return[e]},_=function(e,t,n){for(var r=[n(e[0],t[0])],i=Math.min(e.length,t.length),s=1;s<i;s++)r[s]=n(e[s],t[s]);return r};s.xP,s.Lx;var y=function(e){return function(t){var n=Math.max(1,e);return n>=t.length?[b(t),[]]:[(0,r.zG)(t.slice(1,n),l(I(t))),t.slice(n)]}},S=(s.u4,s.OE,s.nq,s.iw,s.YM,s.ZN,s.Eh),I=(i.F4,s.YM),k=function(e){return e.slice(1)},G=(s.Z$,s.VV,s.Fp,function(e){return function(t){return t.reduce(e.concat)}});s.j0;function z(e,t){return void 0===t?l(e):(0,r.zG)(t,l(e))}var q=function(e,t){return(0,r.zG)(e,d(t))};s.ur},492:(e,t,n)=>{n.d(t,{DT:()=>g,Dj:()=>ue,Do:()=>be,EK:()=>m,EQ:()=>re,Eh:()=>G,FS:()=>ve,G:()=>p,G5:()=>D,Gk:()=>M,Hr:()=>_e,IS:()=>h,KQ:()=>ge,NG:()=>he,OV:()=>ae,Qt:()=>Se,Ri:()=>$,UI:()=>U,Uo:()=>Z,WG:()=>me,Wi:()=>te,Y3:()=>de,YO:()=>we,YP:()=>d,aD:()=>ne,ak:()=>ye,bM:()=>R,dO:()=>E,fS:()=>oe,fX:()=>le,fw:()=>X,g1:()=>A,g_:()=>ie,hX:()=>B,ij:()=>fe,it:()=>pe,lo:()=>Q,pC:()=>ee,pF:()=>se,pR:()=>z,tS:()=>C,uZ:()=>q,wp:()=>j,xH:()=>ce,xu:()=>W});var r=n(925),i=n(543),s=n(162),o=n(275),a=n(560),c=n(963),u=n(491),l=n(219),f=(n(511),n(957)),d=c.YP,p=c.G;function g(e){return function(t){return e(t)?p(t):d}}var h=function(e){return"Right"===e._tag?d:p(e.left)},m=function(e){return"Left"===e._tag?d:p(e.right)},v=function(e,t){return(0,o.zG)(e,U(t))},b=function(e,t){return(0,o.zG)(e,O(t))},w=function(e,t){return(0,o.zG)(e,C(t))},_=function(e,t){return(0,o.zG)(e,B(t))},y=function(e,t){return(0,o.zG)(e,H(t))},S=function(e,t){return(0,o.zG)(e,V(t))},I=function(e,t){return(0,o.zG)(e,K(t))},k="Option",G=function(e){return{equals:function(t,n){return t===n||(te(t)?te(n):!te(n)&&e.equals(t.value,n.value))}}},z=function(e){return{equals:G(e).equals,compare:function(t,n){return t===n?0:ee(t)?ee(n)?e.compare(t.value,n.value):1:-1}}},q=function(e){return{concat:function(t,n){return te(t)?n:te(n)?t:p(e.concat(t.value,n.value))},empty:d}},U=function(e){return function(t){return te(t)?d:p(e(t.value))}},E={URI:k,map:v},P=p,x={URI:k,of:P},O=function(e){return function(t){return te(t)||te(e)?d:p(t.value(e.value))}},D={URI:k,map:v,ap:b},A={URI:k,map:v,ap:b,of:P},C=function(e){return function(t){return te(t)?d:e(t.value)}},T={URI:k,map:v,ap:b,chain:w},M=function(e){return function(t){return te(t)?e():t}},j=M,R=function(){return d},F={URI:k,zero:R},Q=(0,f.l)(F,x),L=C(o.yR),N=(0,l.s4)(d,d),Y=function(e){return te(e)?N:(0,l.s4)(h(e.value),m(e.value))},$={URI:k,compact:L,separate:Y},B=function(e){return function(t){return te(t)?d:e(t.value)?t:d}},H=function(e){return function(t){return te(t)?d:e(t.value)}},V=function(e){return function(t){return(0,l.s4)(_(t,(0,u.ff)(e)),_(t,e))}},K=function(e){return(0,o.ls)(U(e),Y)},W={URI:k,map:v,compact:L,separate:Y,filter:_,filterMap:y,partition:S,partitionMap:I},X=function(e){return function(t){return function(n){return te(n)?e.of(d):e.map(t(n.value),p)}}},Z=m,J={URI:k,fromEither:Z},ee=c.pC,te=function(e){return"None"===e._tag},ne=function(e,t){return function(n){return te(n)?e():t(n.value)}},re=ne,ie=re,se=function(e){return function(t){return te(t)?e():t.value}},oe=se,ae=(0,a.OV)(E),ce=L,ue=(0,s.Dj)(J),le=(0,s.fX)(J,T),fe=function(e){return null==e?d:p(e)},de=function(e){try{return p(e())}catch(e){return d}},pe=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return de((function(){return e.apply(void 0,t)}))}},ge=function(e){return(0,o.ls)(e,fe)},he=function(e){return function(t){return te(t)?d:fe(e(t.value))}},me=re(o.gn,o.yR),ve=re(o.r5,o.yR);var be=P(c.F4),we=(0,a.YO)(E),_e=(0,a.Hr)(E),ye=(0,i.a)(T),Se=(0,r.Qt)(D);c.Xl},881:(e,t,n)=>{n.d(t,{Fp:()=>d,Uz:()=>a,VV:()=>f,Zt:()=>o,gf:()=>l,gt:()=>u,lt:()=>c});var r=n(191),i=n(275),s=function(e){return function(t,n){return t===n||0===e(t,n)}},o=function(e){return{equals:s(e),compare:function(t,n){return t===n?0:e(t,n)}}},a=function(e){return function(t){return o((function(n,r){return t.compare(e(n),e(r))}))}},c=(i.W8,function(e){return function(t,n){return-1===e.compare(t,n)}}),u=function(e){return function(t,n){return 1===e.compare(t,n)}},l=function(e){return function(t,n){return-1!==e.compare(t,n)}},f=function(e){return function(t,n){return t===n||e.compare(t,n)<1?t:n}},d=function(e){return function(t,n){return t===n||e.compare(t,n)>-1?t:n}};r.w4.equals},491:(e,t,n)=>{n.d(t,{ff:()=>r,xD:()=>i});n(275);var r=function(e){return function(t){return!e(t)}},i=function(e){return function(t){return function(n){return t(n)&&e(n)}}}},583:(e,t,n)=>{n.d(t,{Ce:()=>h,DZ:()=>W,EQ:()=>b,Eh:()=>fe,Eq:()=>Q,Ew:()=>q,G:()=>Ie,Hr:()=>Ge,JO:()=>E,Lx:()=>ne,N7:()=>O,OE:()=>re,OV:()=>ge,Od:()=>g,P5:()=>_,R3:()=>m,Su:()=>H,UI:()=>B,YM:()=>y,Yo:()=>v,Z$:()=>S,ZN:()=>ce,bM:()=>N,bj:()=>x,cS:()=>ye,cx:()=>z,f2:()=>U,hX:()=>V,iw:()=>se,j0:()=>ke,jG:()=>ue,jj:()=>A,kp:()=>F,lo:()=>ve,md:()=>G,nI:()=>_e,nq:()=>ie,oA:()=>X,oR:()=>we,of:()=>L,pJ:()=>be,pO:()=>C,pR:()=>de,pc:()=>M,qr:()=>P,t9:()=>D,tS:()=>Y,u4:()=>te,uK:()=>Z,uZ:()=>le,vP:()=>oe,xH:()=>$,xP:()=>ee,xb:()=>p,yW:()=>Se,zT:()=>k});var r=n(191),i=n(275),s=n(560),o=n(963),a=n(627),c=n(881),u=n(350),l=n(219),f=(n(511),n(957)),d=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},p=function(e){return 0===e.length},g=u.Od,h=u.Ce,m=(u.ws,u.R3);u.Im;var v=function(e){return o.Wi(e)?ye:[e.value]},b=function(e,t){return function(n){return g(n)?t(n):e()}},w=u.dC;function _(e,t){return void 0===t?function(t){return _(e,t)}:w(e,t)?o.YP:o.G(t[e])}var y=function(e){return g(e)?o.G(u.YM(e)):o.YP},S=function(e){return g(e)?o.G(u.Z$(e)):o.YP};var I=function(e,t){for(var n=e.length,r=0;r<n&&t(e[r]);r++);return r};function k(e){return function(t){var n=T(I(t,e))(t);return{init:n[0],rest:n[1]}}}var G=function(e){return function(t){return e<=0||p(t)?t:e>=t.length?ye:t.slice(e,t.length)}};var z=function(e){return function(t){for(var n=0;n<t.length;n++)if(e(t[n]))return o.G(n);return o.YP}};function q(e){return function(t){for(var n=0;n<t.length;n++)if(e(t[n]))return o.G(t[n]);return o.YP}}var U=function(e){return function(t){for(var n=0;n<t.length;n++){var r=e(t[n]);if(o.pC(r))return r}return o.YP}};var E=function(e){return function(t){for(var n=t.length-1;n>=0;n--){var r=e(t[n]);if(o.pC(r))return r}return o.YP}},P=function(e){return function(t){for(var n=t.length-1;n>=0;n--)if(e(t[n]))return o.G(n);return o.YP}},x=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];"Left"===r._tag&&t.push(r.left)}return t};var O=function(e){for(var t=[],n=[],r=0;r<e.length;r++)t[r]=e[r][0],n[r]=e[r][1];return[t,n]};function D(e){return function(t,n){if(void 0===n){var r=D(e);return function(e){return r(t,e)}}for(var i,s=0;s<n.length;s++)if(i=n[s],e.equals(i,t))return!0;return!1}}var A=function(e){var t=u.jj(e);return function(e){return g(e)?t(e):e}},C=function(e){var t=u.pO(e);return function(e){return g(e)?t(e):ye}},T=function(e){return function(t){return e>=1&&g(t)?u.lx(e)(t):p(t)?[t,ye]:[ye,t]}},M=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return v(e.apply(void 0,t))}};var j=function(e,t){return(0,i.zG)(e,B(t))},R=function(e,t,n){return(0,i.zG)(e,te(t,n))},F=function(e,t){return(0,i.zG)(e,be(t))},Q=function(e,t){return(0,i.zG)(e,we(t))},L=u.of,N=function(){return ye},Y=function(e){return function(t){return(0,i.zG)(t,function(e){return function(t){if(p(t))return ye;for(var n=[],r=0;r<t.length;r++)n.push.apply(n,e(r,t[r]));return n}}((function(t,n){return e(n)})))}},$=Y(i.yR),B=function(e){return function(t){return t.map((function(t){return e(t)}))}},H=function(e){return function(t){return t.map((function(t,n){return e(n,t)}))}},V=function(e){return function(t){return t.filter(e)}},K=function(e){return function(t){for(var n=[],r=0;r<t.length;r++){var i=e(r,t[r]);o.pC(i)&&n.push(i.value)}return n}},W=function(e){return K((function(t,n){return e(n)}))},X=W(i.yR),Z=function(e){return J((function(t,n){return e(n)}))},J=function(e){return function(t){for(var n=[],r=[],i=0;i<t.length;i++){var s=t[i];e(i,s)?r.push(s):n.push(s)}return(0,l.s4)(n,r)}},ee=function(e){return function(t){return function(n){return n.reduce((function(n,r,i){return e.concat(n,t(i,r))}),e.empty)}}},te=function(e,t){return re(e,(function(e,n,r){return t(n,r)}))},ne=function(e){var t=ee(e);return function(e){return t((function(t,n){return e(n)}))}},re=function(e,t){return function(n){for(var r=n.length,i=e,s=0;s<r;s++)i=t(s,i,n[s]);return i}},ie=function(e,t){return se(e,(function(e,n,r){return t(n,r)}))},se=function(e,t){return function(n){return n.reduceRight((function(e,n,r){return t(r,n,e)}),e)}},oe=function(e){return function(t){return R(t,e.of(N()),(function(t,n){return e.ap(e.map(t,(function(e){return function(t){return(0,i.zG)(e,m(t))}})),n)}))}},ae="ReadonlyArray",ce=function(e){return{show:function(t){return"[".concat(t.map(e.show).join(", "),"]")}}},ue=function(){return{concat:function(e,t){return p(e)?t:p(t)?e:e.concat(t)}}},le=function(){return{concat:ue().concat,empty:ye}},fe=function(e){return(0,r.f7)((function(t,n){return t.length===n.length&&t.every((function(t,r){return e.equals(t,n[r])}))}))},de=function(e){return(0,c.Zt)((function(t,n){for(var r=t.length,i=n.length,s=Math.min(r,i),o=0;o<s;o++){var c=e.compare(t[o],n[o]);if(0!==c)return c}return a.Df.compare(r,i)}))},pe={URI:ae,map:j},ge=(0,s.OV)(pe),he={URI:ae,of:L},me={URI:ae,zero:N},ve=(0,f.l)(me,he),be=function(e){return function(t){for(var n=d([],e(t),!0),r=[];n.length>0;){var i=n.shift();o.nM(i)?n.unshift.apply(n,e(i.left)):r.push(i.right)}return r}},we=function(e){return function(t){var n=e(t),r=[],i=[];function s(t){o.nM(t)?e(t.left).forEach((function(e){return r.push(e)})):i.push(t.right)}for(var a=0,c=n;a<c.length;a++){s(c[a])}for(;r.length>0;)s(r.shift());return i}},_e=(u.oo,function(e){return p(e)?ye:e.slice()}),ye=u.cS;function Se(e){return function(t){return t.every(e)}}var Ie=function(e){return function(t){return t.some(e)}},ke=function(e){var t=u.j0(e);return function(n){return b((function(){return e.empty}),t(n))}},Ge=(o.F4,(0,s.Hr)(pe));u.w6,u.QI,u.Ss},350:(e,t,n)=>{n.d(t,{Ce:()=>d,Eh:()=>C,Fp:()=>Q,Im:()=>p,Lx:()=>U,OE:()=>P,Od:()=>u,QI:()=>B,R3:()=>g,Ss:()=>H,UI:()=>G,VV:()=>F,YM:()=>T,Z$:()=>j,ZN:()=>A,aL:()=>N,c2:()=>v,cS:()=>c,dC:()=>l,iw:()=>O,j0:()=>$,jj:()=>m,lx:()=>I,nq:()=>E,of:()=>k,oo:()=>h,pO:()=>S,u4:()=>q,ur:()=>L,ut:()=>Y,w6:()=>w,ws:()=>f,xP:()=>x});var r=n(191),i=n(275),s=(n(560),n(963)),o=n(199),a=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},c=s.Xl,u=s.Od,l=function(e,t){return e<0||e>=t.length},f=function(e){return function(t){return a([e],t,!0)}},d=f,p=function(e){return function(t){return a(a([],t,!0),[e],!1)}},g=p,h=function(e,t,n){if(u(n)){var r=s.r1(n);return r.splice(e,0,t),r}return[t]},m=function(e){return function(t){if(1===t.length)return t;for(var n=[T(t)],r=function(t){n.every((function(n){return!e.equals(n,t)}))&&n.push(t)},i=0,s=M(t);i<s.length;i++){r(s[i])}return n}},v=function(e){return u(e)?s.G(e):s.YP},b=function(e){return function(t){for(var n=Math.max(0,Math.floor(t)),r=[e(0)],i=1;i<n;i++)r.push(e(i));return r}},w=function(e,t){return e<=t?b((function(t){return e+t}))(t-e+1):[e]};function _(e,t){return t?e.concat(t):function(t){return t.concat(e)}}var y=function(e){return function(t){for(var n=[e,t[0]],r=1;r<t.length;r++)n.push(e,t[r]);return n}},S=function(e){return function(t){for(var n=e(t),r=[n[0]],i=n[1];u(i);){var s=e(i),o=s[0],a=s[1];r.push(o),i=a}return r}},I=function(e){return function(t){var n=Math.max(1,e);return n>=t.length?[t,c]:[(0,i.zG)(t.slice(1,n),d(T(t))),t.slice(n)]}},k=s.ri,G=function(e){return z((function(t,n){return e(n)}))},z=function(e){return function(t){for(var n=[e(0,T(t))],r=1;r<t.length;r++)n.push(e(r,t[r]));return n}},q=function(e,t){return P(e,(function(e,n,r){return t(n,r)}))},U=function(e){return function(t){return function(n){return n.slice(1).reduce((function(n,r){return e.concat(n,t(r))}),t(n[0]))}}},E=function(e,t){return O(e,(function(e,n,r){return t(n,r)}))},P=function(e,t){return function(n){return n.reduce((function(e,n,r){return t(r,e,n)}),e)}},x=function(e){return function(t){return function(n){return n.slice(1).reduce((function(n,r,i){return e.concat(n,t(i+1,r))}),t(0,n[0]))}}},O=function(e,t){return function(n){return n.reduceRight((function(e,n,r){return t(r,n,e)}),e)}},D=s.YM,A=function(e){return{show:function(t){return"[".concat(t.map(e.show).join(", "),"]")}}},C=function(e){return(0,r.f7)((function(t,n){return t.length===n.length&&t.every((function(t,r){return e.equals(t,n[r])}))}))},T=(s.F4,D),M=s.Gb,j=function(e){return e[e.length-1]},R=function(e){return e.slice(0,-1)},F=function(e){var t=o.VV(e);return function(e){return e.reduce(t.concat)}},Q=function(e){var t=o.Fp(e);return function(e){return e.reduce(t.concat)}},L=function(e){return function(t){return t.reduce(e.concat)}},N=function(e){return function(t){return e(T(t),M(t))}},Y=function(e){return function(t){return e(R(t),j(t))}},$=function(e){var t=L(e);return function(e){return(0,i.ls)(function(e){return function(t){var n=M(t);return u(n)?(0,i.zG)(n,y(e),d(T(t))):t}}(e),t)}};function B(e,t){return void 0===t?d(e):(0,i.zG)(t,d(e))}var H=function(e,t){return(0,i.zG)(e,_([t]))}},54:(e,t,n)=>{n.d(t,{Bu:()=>v,CC:()=>R,DZ:()=>ne,EG:()=>m,EW:()=>B,Eh:()=>fe,G:()=>A,HA:()=>T,Hd:()=>U,I8:()=>Q,P5:()=>b,RF:()=>F,RJ:()=>N,SW:()=>V,Su:()=>_,UI:()=>y,Ub:()=>W,V_:()=>$,XP:()=>f,Yz:()=>x,_Y:()=>Y,_r:()=>q,cS:()=>w,dp:()=>c,dx:()=>g,e$:()=>h,hX:()=>te,jt:()=>E,kp:()=>j,mK:()=>J,mS:()=>L,nn:()=>M,nr:()=>pe,nu:()=>H,oA:()=>ce,oh:()=>ue,qS:()=>Z,ri:()=>G,sq:()=>O,t9:()=>C,tV:()=>ie,uK:()=>re,uZ:()=>de,vA:()=>X,vP:()=>z,xb:()=>u,yW:()=>D,z7:()=>P,zV:()=>K});var r=n(191),i=n(275),s=n(963),o=n(219),a=n(29),c=(n(511),function(e){return Object.keys(e).length}),u=function(e){for(var t in e)if(s.e$.call(e,t))return!1;return!0},l=function(e){return function(t){return Object.keys(t).sort(e.compare)}},f=l(a.Df);function d(e){if("function"==typeof e)return d(a.Df)(e);var t=l(e);return function(e){return function(n){for(var r=[],i=0,s=t(n);i<s.length;i++){var o=s[i];r.push(e(o,n[o]))}return r}}}var p=d(a.Df)((function(e,t){return[e,t]}));var g=function(e,t){return function(n){if(s.e$.call(n,e)&&n[e]===t)return n;var r=Object.assign({},n);return r[e]=t,r}},h=function(e,t){return s.e$.call(t,e)};function m(e){return function(t){if(!s.e$.call(t,e))return t;var n=Object.assign({},t);return delete n[e],n}}function v(e){return function(t,n){if(void 0===n){var r=v(e);return function(e){return r(e,t)}}for(var i in t)if(!s.e$.call(n,i)||!e.equals(t[i],n[i]))return!1;return!0}}function b(e,t){return void 0===t?function(t){return b(e,t)}:s.e$.call(t,e)?s.G(t[e]):s.YP}var w={};function _(e){return function(t){var n={};for(var r in t)s.e$.call(t,r)&&(n[r]=e(r,t[r]));return n}}function y(e){return _((function(t,n){return e(n)}))}function S(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(2===e.length)return S(a.Df).apply(void 0,e);var n=l(e[0]);return function(e,t){return function(r){for(var i=e,s=n(r),o=s.length,a=0;a<o;a++){var c=s[a];i=t(c,i,r[c])}return i}}}function I(e){if("compare"in e){var t=l(e);return function(e){return function(n){return function(r){for(var i=e.empty,s=t(r),o=s.length,a=0;a<o;a++){var c=s[a];i=e.concat(i,n(c,r[c]))}return i}}}}return I(a.Df)(e)}function k(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(2===e.length)return k(a.Df).apply(void 0,e);var n=l(e[0]);return function(e,t){return function(r){for(var i=e,s=n(r),o=s.length-1;o>=0;o--){var a=s[o];i=t(a,r[a],i)}return i}}}var G=function(e,t){var n;return(n={})[e]=t,n};function z(e){return J(a.Df)(e)}function q(e){return function(t){var n={},r={};for(var i in t)if(s.e$.call(t,i)){var a=e(i,t[i]);switch(a._tag){case"Left":n[i]=a.left;break;case"Right":r[i]=a.right}}return(0,o.s4)(n,r)}}function U(e){return function(t){var n={},r={};for(var i in t)if(s.e$.call(t,i)){var a=t[i];e(i,a)?r[i]=a:n[i]=a}return(0,o.s4)(n,r)}}function E(e){return function(t){var n={};for(var r in t)if(s.e$.call(t,r)){var i=e(r,t[r]);s.pC(i)&&(n[r]=i.value)}return n}}function P(e){return function(t){var n={},r=!1;for(var i in t)if(s.e$.call(t,i)){var o=t[i];e(i,o)?n[i]=o:r=!0}return r?n:t}}var x=p,O=function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n];t[i[0]]=i[1]}return t};function D(e){return function(t){for(var n in t)if(!e(t[n]))return!1;return!0}}function A(e){return function(t){for(var n in t)if(e(t[n]))return!0;return!1}}function C(e){return function(t,n){if(void 0===n){var r=C(e);return function(e){return r(t,e)}}for(var i in n)if(e.equals(n[i],t))return!0;return!1}}var T=function(e,t){return(0,i.zG)(e,y(t))},M=function(e,t){return(0,i.zG)(e,_(t))},j=function(e){var t=se(e);return function(e,n,r){return(0,i.zG)(e,t(n,r))}},R=function(e){return function(t){var n=oe(e)(t);return function(e,t){return(0,i.zG)(e,n(t))}}},F=function(e){var t=ae(e);return function(e,n,r){return(0,i.zG)(e,t(n,r))}},Q=function(e,t){return(0,i.zG)(e,te(t))},L=function(e,t){return(0,i.zG)(e,ne(t))},N=function(e,t){return(0,i.zG)(e,re(t))},Y=function(e,t){return(0,i.zG)(e,ie(t))},$=function(e){var t=S(e);return function(e,n,r){return(0,i.zG)(e,t(n,r))}},B=function(e){var t=I(e);return function(e){var n=t(e);return function(e,t){return(0,i.zG)(e,n(t))}}},H=function(e){var t=k(e);return function(e,n,r){return(0,i.zG)(e,t(n,r))}},V=function(e,t){return(0,i.zG)(e,q(t))},K=function(e,t){return(0,i.zG)(e,U(t))},W=function(e,t){return(0,i.zG)(e,E(t))},X=function(e,t){return(0,i.zG)(e,P(t))},Z=function(e){var t=ee(e);return function(e){var n=t(e);return function(e,t){return n(e,(0,i.ls)(i.SK,t))}}},J=function(e){var t=Z(e);return function(e){var n=t(e);return function(e){return n(e,i.yR)}}},ee=function(e){return function(t){var n=l(e);return function(e,r){var i=n(e);if(0===i.length)return t.of(w);for(var s=t.of({}),o=function(n){s=t.ap(t.map(s,(function(e){return function(t){var r;return Object.assign({},e,((r={})[n]=t,r))}})),r(n,e[n]))},a=0,c=i;a<c.length;a++){o(c[a])}return s}}},te=function(e){return P((function(t,n){return e(n)}))},ne=function(e){return E((function(t,n){return e(n)}))},re=function(e){return U((function(t,n){return e(n)}))},ie=function(e){return q((function(t,n){return e(n)}))};function se(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){var n=S(e[0]);return function(e,t){return n(e,(function(e,n,r){return t(n,r)}))}}return se(a.Df).apply(void 0,e)}function oe(e){if("compare"in e){var t=I(e);return function(e){var n=t(e);return function(e){return n((function(t,n){return e(n)}))}}}return oe(a.Df)(e)}function ae(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){var n=k(e[0]);return function(e,t){return n(e,(function(e,n,r){return t(n,r)}))}}return ae(a.Df).apply(void 0,e)}var ce=function(e){var t={};for(var n in e)if(s.e$.call(e,n)){var r=e[n];s.pC(r)&&(t[n]=r.value)}return t},ue=function(e){var t={},n={};for(var r in e)if(s.e$.call(e,r)){var i=e[r];s.nM(i)?t[r]=i.left:n[r]=i.right}return(0,o.s4)(t,n)},le="ReadonlyRecord";function fe(e){var t=v(e);return(0,r.f7)((function(e,n){return t(e)(n)&&t(n)(e)}))}function de(e){return{concat:function(t,n){if(u(t))return n;if(u(n))return t;var r=Object.assign({},t);for(var i in n)s.e$.call(n,i)&&(r[i]=s.e$.call(t,i)?e.concat(t[i],n[i]):n[i]);return r},empty:w}}a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df;function pe(e,t){return s.e$.call(void 0===t?this:t,e)}a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df,a.Df},495:(e,t,n)=>{n.d(t,{H5:()=>a,Kl:()=>c,Lx:()=>l,Pd:()=>s,Yg:()=>i,li:()=>r,nq:()=>f,pL:()=>o,u4:()=>u});n(275);function r(e){return e[0]}function i(e){return e[1]}var s=function(e,t){return function(n){return[t(r(n)),e(i(n))]}},o=function(e){return function(t){return[e(r(t)),i(t)]}},a=function(e){return function(t){return[r(t),e(i(t))]}},c=r,u=function(e,t){return function(n){return t(e,r(n))}},l=function(){return function(e){return function(t){return e(r(t))}}},f=function(e,t){return function(n){return t(r(n),e)}}},199:(e,t,n)=>{n.d(t,{Z$:()=>u,Fp:()=>a,VV:()=>o,n_:()=>c});var r,i=n(963),s=n(881),o=function(e){return{concat:s.VV(e)}},a=function(e){return{concat:s.Fp(e)}},c=function(e){return{concat:function(t,n){var r={};for(var s in e)i.e$.call(e,s)&&(r[s]=e[s].concat(t[s],n[s]));return r}}},u=function(){return{concat:function(e,t){return t}}};r=void 0},219:(e,t,n)=>{n.d(t,{F2:()=>o,Vn:()=>i,s4:()=>r});n(275);var r=function(e,t){return{left:e,right:t}},i=function(e){return function(t){return r(e(s(t)),o(t))}},s=function(e){return e.left},o=function(e){return e.right}},940:(e,t,n)=>{n.d(t,{At:()=>G,Do:()=>z,Hi:()=>w,Hr:()=>U,PM:()=>b,UA:()=>S,UI:()=>d,YO:()=>q,ak:()=>E,ap:()=>p,dO:()=>v,mU:()=>I,of:()=>g,pE:()=>A,qA:()=>_,qo:()=>y,tD:()=>c,tS:()=>h,uU:()=>D});var r=n(543),i=n(395),s=n(275),o=n(560),a=n(963),c=function(e){return function(){return Promise.resolve().then(e)}};var u=function(e,t){return(0,s.zG)(e,d(t))},l=function(e,t){return(0,s.zG)(e,p(t))},f=function(e,t){return(0,s.zG)(e,h(t))},d=function(e){return function(t){return function(){return Promise.resolve().then(t).then(e)}}},p=function(e){return function(t){return function(){return Promise.all([Promise.resolve().then(t),Promise.resolve().then(e)]).then((function(e){return(0,e[0])(e[1])}))}}},g=function(e){return function(){return Promise.resolve(e)}},h=function(e){return function(t){return function(){return Promise.resolve().then(t).then((function(t){return e(t)()}))}}},m="Task";var v={URI:m,map:u},b={URI:m,of:g},w={URI:m,map:u,ap:l},_={URI:m,map:u,ap:l,of:g},y={URI:m,map:u,ap:l,chain:f},S={URI:m,map:u,of:g,ap:l,chain:f},I=(s.yR,(0,r.m)(y)),k={URI:m,fromIO:c},G=(0,i.At)(k,y),z=g(a.F4),q=(0,o.YO)(v),U=(0,o.Hr)(v),E=(0,r.a)(y),P=g(a.Xl),x=function(e){var t=function(e){return function(t){return function(){return Promise.all(t.map((function(t,n){return Promise.resolve().then((function(){return e(n,t)()}))})))}}}(e);return function(e){return a.Od(e)?t(e):P}},O=function(e){var t=function(e){return function(t){return function(){return a.Gb(t).reduce((function(t,n,r){return t.then((function(t){return Promise.resolve().then(e(r+1,n)).then((function(e){return t.push(e),t}))}))}),Promise.resolve().then(e(0,a.YM(t))).then(a.ri))}}}(e);return function(e){return a.Od(e)?t(e):P}},D=function(e){return x((function(t,n){return e(n)}))},A=function(e){return O((function(t,n){return e(n)}))}},716:(e,t,n)=>{n.d(t,{At:()=>te,DT:()=>Z,EQ:()=>G,F2:()=>m,Hi:()=>V,Hr:()=>se,Ij:()=>ce,LV:()=>z,OV:()=>H,Op:()=>_,QM:()=>v,Qt:()=>ae,UI:()=>T,Vn:()=>j,Y3:()=>U,YO:()=>ie,Zl:()=>Q,ak:()=>oe,dk:()=>w,fF:()=>S,fS:()=>q,fX:()=>X,fj:()=>k,it:()=>E,lk:()=>b,oU:()=>ee,of:()=>N,t$:()=>h,tD:()=>y,tS:()=>F,wE:()=>re,wp:()=>L});var r=n(925),i=n(543),s=n(890),o=n(162),a=n(395),c=n(272),u=n(275),l=n(560),f=n(963),d=n(940),p=function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},g=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},h=s.t$(d.PM),m=s.F2(d.PM),v=s.m8(d.dO),b=s.pk(d.dO),w=(0,u.ls)(d.tD,v),_=(0,u.ls)(d.tD,b),y=w,S=v,I=d.of,k=d.tD,G=s.EQ(d.dO),z=s.LV(d.UA),q=s.fS(d.UA),U=function(e,t){return function(){return p(void 0,void 0,void 0,(function(){var n;return g(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e().then(f.F2)];case 1:return[2,r.sent()];case 2:return n=r.sent(),[2,f.t$(t(n))];case 3:return[2]}}))}))}},E=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return U((function(){return e.apply(void 0,n)}),t)}},P=(d.dO,d.PM,d.PM,d.UA,d.UA,d.UA,d.UA,d.dO,function(e,t){return(0,u.zG)(e,T(t))}),x=function(e,t){return(0,u.zG)(e,R(t))},O=function(e,t){return(0,u.zG)(e,F(t))},D=function(e,t,n){return(0,u.zG)(e,M(t,n))},A=function(e,t){return(0,u.zG)(e,j(t))},C=function(e,t){return(0,u.zG)(e,L(t))},T=s.UI(d.dO),M=s.Pd(d.dO),j=s.Vn(d.dO),R=s.ap(d.Hi),F=s.tS(d.UA),Q=F,L=s.wp(d.UA),N=m,Y=h,$="TaskEither";var B={URI:$,map:P},H=(0,l.OV)(B),V={URI:$,map:P,ap:x},K={URI:$,map:P,ap:x,chain:O},W={URI:$,fromEither:I},X=(0,o.fX)(W,K),Z=(0,o.DT)(W),J={URI:$,fromIO:y},ee=(0,a.oU)(J,K),te=(0,a.At)(J,K),ne={URI:$,fromIO:y,fromTask:S},re=(0,c.oU)(ne,K);f.F4;var ie=(0,l.YO)(B),se=(0,l.Hr)(B),oe=(0,i.a)(K),ae=(0,r.Qt)(V),ce=(f.Xl,{URI:$,bimap:D,mapLeft:A,map:P,of:N,ap:x,chain:O,alt:C,fromIO:y,fromTask:S,throwError:Y})},569:(e,t,n)=>{n.d(t,{H5:()=>o,Yg:()=>s,li:()=>i});var r=n(495),i=(n(275),r.li),s=r.Yg;var o=function(e){return function(t){return[i(t),e(s(t))]}};r.Kl,r.Lx,r.u4,r.nq},511:(e,t,n)=>{function r(e,t){return function(n){var r=e.traverse(n);return function(e,i){return n.map(r(e,i),t.separate)}}}function i(e,t){return function(n){var r=e.traverse(n);return function(e,i){return n.map(r(e,i),t.compact)}}}n.d(t,{BL:()=>i,Fj:()=>r})},957:(e,t,n)=>{function r(e,t){return function(n){return n?t.of(void 0):e.zero()}}n.d(t,{l:()=>r})},275:(e,t,n)=>{n.d(t,{MZ:()=>s,Q1:()=>l,SK:()=>g,W8:()=>a,a9:()=>o,bc:()=>d,gn:()=>c,ls:()=>f,nn:()=>r,r5:()=>u,yR:()=>i,zG:()=>p});var r=function(e){return function(t){return t(e)}};function i(e){return e}var s=i;function o(e){return function(){return e}}var a=o(!0),c=o(null),u=o(void 0),l=u;function f(e,t,n,r,i,s,o,a,c){switch(arguments.length){case 1:return e;case 2:return function(){return t(e.apply(this,arguments))};case 3:return function(){return n(t(e.apply(this,arguments)))};case 4:return function(){return r(n(t(e.apply(this,arguments))))};case 5:return function(){return i(r(n(t(e.apply(this,arguments)))))};case 6:return function(){return s(i(r(n(t(e.apply(this,arguments))))))};case 7:return function(){return o(s(i(r(n(t(e.apply(this,arguments)))))))};case 8:return function(){return a(o(s(i(r(n(t(e.apply(this,arguments))))))))};case 9:return function(){return c(a(o(s(i(r(n(t(e.apply(this,arguments)))))))))}}}function d(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e}function p(e,t,n,r,i,s,o,a,c){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return n(t(e));case 4:return r(n(t(e)));case 5:return i(r(n(t(e))));case 6:return s(i(r(n(t(e)))));case 7:return o(s(i(r(n(t(e))))));case 8:return a(o(s(i(r(n(t(e)))))));case 9:return c(a(o(s(i(r(n(t(e))))))));default:for(var u=arguments[0],l=1;l<arguments.length;l++)u=arguments[l](u);return u}}var g=function(e,t){return t}},963:(e,t,n)=>{n.d(t,{F2:()=>f,F4:()=>v,G:()=>a,Gb:()=>h,Od:()=>p,Wi:()=>i,Xl:()=>m,YM:()=>g,YP:()=>o,e$:()=>b,nM:()=>c,pC:()=>s,r1:()=>w,ri:()=>d,t$:()=>l,tO:()=>u});var r=function(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},i=function(e){return"None"===e._tag},s=function(e){return"Some"===e._tag},o={_tag:"None"},a=function(e){return{_tag:"Some",value:e}},c=function(e){return"Left"===e._tag},u=function(e){return"Right"===e._tag},l=function(e){return{_tag:"Left",left:e}},f=function(e){return{_tag:"Right",right:e}},d=function(e){return[e]},p=function(e){return e.length>0},g=function(e){return e[0]},h=function(e){return e.slice(1)},m=[],v={},b=Object.prototype.hasOwnProperty,w=function(e){return r([e[0]],e.slice(1),!0)}},627:(e,t,n)=>{n.d(t,{Df:()=>i,Eq:()=>r,Pc:()=>o});var r={equals:function(e,t){return e===t}},i={equals:r.equals,compare:function(e,t){return e<t?-1:e>t?1:0}},s=(r.equals,i.compare,{concat:function(e,t){return e+t}}),o={concat:s.concat,empty:0}},29:(e,t,n)=>{n.d(t,{Df:()=>i,Eq:()=>r,HD:()=>s,xb:()=>o});var r={equals:function(e,t){return e===t}},i={equals:r.equals,compare:function(e,t){return e<t?-1:e>t?1:0}},s=function(e){return"string"==typeof e},o=function(e){return 0===e.length}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};(()=>{var e=__webpack_require__(812),t=__webpack_require__(460),n=__webpack_require__(275),r=__webpack_require__(936),i=__webpack_require__(492),s=__webpack_require__(583),o=__webpack_require__(387),a=__webpack_require__(716);function c(e,r){return(0,n.zG)(a.Y3((()=>e.get(r)),(e=>`Failed to read previous state from IndexedDB: ${e}.`)),a.UI((e=>e??void 0)),a.UI((i=>s=>(0,n.ls)((0,o.rO)({previousState:()=>i}),s,(s=>{let{value:a,state:c}=s;const[u,l]=t.Ue(!1),f=(0,n.zG)(c,t.Rp(-1,(e=>e+1)));return{value:(0,n.bc)(u,a),state:(0,n.zG)(t.vP(c,f),(0,o.bw)(t.YP((t=>{let[n,s]=t;if(0!==s||n!==i)switch(l(!1),typeof n){case"undefined":e.delete(r).then((()=>l(!0)));break;case"object":null===n?e.delete(r).then((()=>l(!0))):e.put(n,r).then((()=>l(!0)));break;default:e.put(n,r).then((()=>l(!0)))}}))))}})))))}function u(e){return r=>(0,n.ls)((0,o.rO)({previousState:t=>e.current?t:void 0}),r,(0,o.rO)({state:(0,n.ls)((n=>t.vP(e,n)),t.UI((e=>{let[t,n]=e;return t?n:void 0})))}))}var l=__webpack_require__(385);class f extends Error{static errorName="NetworkRequestFailedError";name=f.errorName;constructor(){super(f.defaultMessage)}static get defaultMessage(){return"Network request failed"}}class d extends Error{static errorName="NetworkRequestTimeoutError";name=d.errorName;constructor(){super(d.defaultMessage)}static get defaultMessage(){return"Network request timed out"}}var p=__webpack_require__(963),g=function(e){return"Left"===e._tag},h=function(e){return"Right"===e._tag};function m(e){return{_tag:"Left",left:e}}function v(e){return{_tag:"Right",right:e}}function b(e,t){return{_tag:"Both",left:e,right:t}}var w=function(e,t,n){return function(r){switch(r._tag){case"Left":return e(r.left);case"Right":return t(r.right);case"Both":return n(r.left,r.right)}}},_=w;_(v,m,(function(e,t){return b(t,e)}));var y=v,S="These";n.yR,n.yR,p.Xl;class I{metrics;constructor(e){this.metrics=e}req(e){return this.reqImpl(e).then((e=>(0,n.MZ)(e)))}reqWithBeacon(e){var t,n;let{url:r,payload:i}=e;const s=JSON.stringify(i),o=(null===(t=navigator)||void 0===t||null===(n=t.sendBeacon)||void 0===n?void 0:n.call(t,r,JSON.stringify(i)))??!1;return this.trackRequestMetrics({is_beacon:!0,is_error:!o,request:{method:"POST",url:r,content_length:s.length}}),o}reqImpl(t){const r="arraybuffer",{url:s,dataType:a,contentType:c,method:u,withCredentials:g,timeout:h}=t;return new Promise(((m,w)=>{const _=new XMLHttpRequest,y="POST"===t.method?"string"==typeof(S=t.payload)?S:JSON.stringify(S):null;var S;const I=e=>this.trackRequestMetrics({is_beacon:!1,request:{method:u,url:s,content_length:(null==y?void 0:y.length)??0},response:e});_.onload=(0,e.GL)((()=>{var e,t;return(0,n.zG)(_.status,l.DT((e=>e<400),(()=>{const e="text"===_.responseType||""===_.responseType?_.responseText:"Couldn\'t access response text";return`Failed ajax request. Status code was ${_.status}. ${e}`})),l.tS((()=>"json"===a?_.responseText?l.Y3((()=>JSON.parse(_.responseText)),(e=>`Failed to parse response as JSON. Response was ${JSON.stringify(_.responseText)}. Got ${e}`)):l.F2(null):"text"===a?l.F2(_.responseText):l.F2(_.response))),(0,o.bw)((0,n.ls)(i.IS,(t={content_length:"text"===_.responseType||""===_.responseType?(null===(e=_.responseText)||void 0===e?void 0:e.length)??0:_.responseType===r?_.response.byteLength:0,response_time_ms:self.performance.now()-k,status_code:_.status},function(e){return p.Wi(e)?v(t):b(e.value,t)}),I)),l.EQ(w,m))})),_.onerror=(0,e.GL)((()=>{I(l.t$("network error")),w(new f)})),_.ontimeout=(0,e.GL)((()=>{I(l.t$("timeout")),w(new d)})),_.open(u,s,!0),c&&_.setRequestHeader("content-type",c),_.timeout=h||_.timeout,_.withCredentials=g||_.withCredentials,_.responseType="binary"===a?r:_.responseType;const k=self.performance.now();_.send(y)}))}trackRequestMetrics(e){var t;if(null===(t=this.metrics)||void 0===t||!t.isEnabled())return;const r=new URL(e.request.url).pathname;if(r.includes("metrics"))return;const s=t=>this.metrics.track({name:"sdk_http_request_count_total",value:1,labels:{request_method:e.request.method,request_path:r,request_content_length:e.request.content_length,...t}});var o;!0===e.is_beacon?s({is_beacon:!0,is_error:e.is_error}):(0,n.zG)((o=e.response,g(o)?p.YP:(h(o),p.G(o.right))),i.aD((()=>({})),(e=>({response_content_length:e.content_length,response_status:e.status_code,response_time_ms:e.response_time_ms}))),(t=>({is_beacon:!1,is_error:!h(e.response),...t})),s)}}class k{config;PATH_JOINER_Q="?";PATH_JOINER_A="&";constructor(e){this.config=e}getBaseUrl(){return`${this.config.apiProtocol}://${this.config.apiHost}`}getEndpointUrl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return this.getUrl("base",e,t,n)}getSdkErrorsUrl(e,t){return this.getUrl("sdk-errors",e,t,[])}getAdvertiserEndpointUrl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return this.getUrl("adv",e,t,n)}getClassificationModelsEndpointUrl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return this.getUrl("clm",e,t,n)}getAudienceMatchingEndpointUrl(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const i=`${e}/${n}/audiences`;return this.getUrl("audience-matching",i,t,r)}getCCSCohortMembershipEndpointUrl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return this.getUrl("ccs",e,t,n)}makeAuthenticatedUrl(e){return this.makeUrlWithQueryParams(e,[["k",this.config.apiKey]])}getUrlPrefix(e){switch(e){case"base":return"";case"adv":return"/adv";case"sdk-errors":return"/sdk-errors";case"clm":return"/clm";case"audience-matching":return"/audience-matching";case"ccs":return"/ccs"}}getUrl(e,t,n,r){const s=this.getUrlPrefix(e),o=(0,i.g_)((()=>""),(e=>`/${e}`))(n),a=`${this.getBaseUrl()}${s}${o}${t}`;return this.makeUrlWithQueryParams(a,r.concat([["k",this.config.apiKey]]))}makeUrlWithQueryParams(e,t){const n=t.map((e=>{let[t,n]=e;return`${t}=${n}`})).join(this.PATH_JOINER_A),r=e.includes(this.PATH_JOINER_Q)?this.PATH_JOINER_A:this.PATH_JOINER_Q;return`${e}${r}${n}`}}var G=__webpack_require__(343),z=__webpack_require__(925);class q{sdkInitTimestamp;timeOriginSdkInit;logger;prefix="[Metrics]";timeOriginForContext=P();pendingMetrics=[];pendingCounters={};pendingTimers={};noMetricsTracked=0;constructor(e,t,n){this.sdkInitTimestamp=e,this.timeOriginSdkInit=t,this.logger=n}isEnabled(){return!0}getNoMetricsTracked(){return this.noMetricsTracked}consume(){const e=this.pendingMetrics.concat(Object.values(this.pendingCounters).flat());return this.pendingMetrics=[],this.pendingCounters={},e}track(e){this.noMetricsTracked++,this.logDebug(`Tracking ${e.name}`,{metric:e}),this.pendingMetrics.push(e)}trackCounter(e){if(this.noMetricsTracked++,this.logDebug(`Tracking ${e.name}`,{metric:e}),e.name in this.pendingCounters){const t=Object.keys(e.labels),n=this.pendingCounters[e.name].findIndex((n=>Object.keys(n.labels).length===t.length&&t.every((t=>n.labels[t]===e.labels[t]))));-1===n?this.pendingCounters[e.name].push(e):this.pendingCounters[e.name][n]=E(this.pendingCounters[e.name][n],e.value)}else this.pendingCounters[e.name]=[e]}synchroniseTimeBetweenContexts(e){return(0,n.zG)(z.gz(i.G5)(this.timeOriginForContext,this.timeOriginSdkInit),i.UI((t=>{let[n,r]=t;return e+n-r})))}trackTimeSinceInit(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:performance.now();(0,n.zG)(this.synchroniseTimeBetweenContexts(r),i.UI((e=>(e-this.sdkInitTimestamp)/1e3)),i.UI((n=>this.track({name:e,value:n,labels:t}))))}startTimer(e,t){const n=performance.now(),r=this.generateRandomKey(e);return this.pendingTimers[r]={startTime:n,labels:t},r}stopTimer(e,t){const n=this.pendingTimers[t];if(n){const r=(performance.now()-n.startTime)/1e3;this.logDebug("timer stopped",e,r),this.track({name:e,value:r,labels:n.labels}),delete this.pendingTimers[t]}}generateRandomKey(e){return`${e}-${[...Array(24)].map((()=>Math.random().toString(36)[2])).join("")}`}logDebug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.debug(this.prefix,...t)}}class U{isEnabled(){return!1}getNoMetricsTracked(){return 0}consume(){return[]}track(e){}trackCounter(e){}trackTimeSinceInit(e,t){}startTimer(e,t){return""}stopTimer(e,t){}}const E=(e,t)=>({...e,value:e.value+t}),P=()=>(0,n.zG)(i.Y3((()=>performance.timeOrigin)),i.hX((e=>"number"==typeof e&&!Number.isNaN(e))));class x{sdkInitTimestamp;prefix="[Permutive]"+(self.document?"[Main]":"[Worker]");debugStyle=["color: blue"].join(";");constructor(e){this.sdkInitTimestamp=e}get timeDeltaFromInit(){return`[${(new Date).getTime()-this.sdkInitTimestamp}ms]`}log(){return console.log.bind(self.console,this.timeDeltaFromInit,this.prefix)(...arguments)}debug(){return console.debug.bind(self.console,"%s%c%s",this.timeDeltaFromInit,this.debugStyle,this.prefix)(...arguments)}warn(){return console.warn.bind(self.console,this.timeDeltaFromInit,this.prefix)(...arguments)}error(){return console.error.bind(self.console,this.timeDeltaFromInit,this.prefix)(...arguments)}}class O{log(){}debug(){}warn(){}error(){}}class D{crypto=self.crypto||self.msCrypto;ALG_NAME="AES-GCM";isAvailable(){var e;return!(null===(e=this.crypto)||void 0===e||!e.subtle)}generateKey(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,e.t_)(this.crypto.subtle.generateKey({name:this.ALG_NAME,length:256},t,["encrypt","decrypt"]))}encrypt(e,t){const[n,r]=this._encrypt(e,this.str2bytes(t));return n.then((e=>{const t=new Uint8Array(16+e.byteLength);return t.set(r,0),t.set(new Uint8Array(Uint32Array.of(e.byteLength).buffer),12),t.set(new Uint8Array(e),16),t.buffer}))}decrypt(e,t){const n=new Uint8Array(t,0,12),r=new Uint32Array(t,12,1)[0],i=t.slice(16,16+r);return this._decrypt(e,n,i).then(this.bytes2str)}_encrypt(t,n){const r=this.crypto.getRandomValues(new Uint8Array(12));return[(0,e.t_)(this.crypto.subtle.encrypt({name:this.ALG_NAME,iv:r},t,n)),r]}_decrypt(t,n,r){return(0,e.t_)(this.crypto.subtle.decrypt({name:this.ALG_NAME,iv:n},t,r))}str2bytes(e){return(new TextEncoder).encode(e).buffer}bytes2str(e){return(new TextDecoder).decode(e)}}class A{config;constructor(e){this.config=e}getNamespacedStorageKey(e){return`${this.config.stateNamespace}${e}`}}var C=__webpack_require__(940),T=__webpack_require__(444),M=__webpack_require__(54),j=__webpack_require__(491),R=__webpack_require__(350);var F=__webpack_require__(865),Q=__webpack_require__(277);class L{timeoutDurationInMilliseconds;maxTimeOutDurationInMilliseconds;constructor(e,t){this.timeoutDurationInMilliseconds=e,this.maxTimeOutDurationInMilliseconds=t}schedule(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeoutDurationInMilliseconds,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.maxTimeOutDurationInMilliseconds;return this.debounce(e,t,n)}scheduleAccumulated(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeoutDurationInMilliseconds,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.maxTimeOutDurationInMilliseconds;return this.debounce(e,n,r,t)}scheduleForPageUnload(e){return(0,o.aT)(e)}debounce(t,n,r,i){let s,a,c,u=[];return l=>{i&&(c=i.concat(c??i.empty,l));const f=(0,o.b2)();u.push(f);var d;return null===(d=s)||void 0===d||d(),s=(0,e.HJ)((()=>{var e;null===(e=a)||void 0===e||e(),a=void 0;const n=t(c||l);u.forEach((e=>e.resolve(n))),c=null==i?void 0:i.empty,u=[]}),n),a||(a=(0,e.HJ)((()=>{var e;null===(e=s)||void 0===e||e(),a=void 0;const n=t(c||l);u.forEach((e=>e.resolve(n))),c=null==i?void 0:i.empty,u=[]}),r)),f.promise}}}class N extends Error{constructor(e){super(e),this.name="StoreClosingError"}}const Y="permutive-events-cache",$="permutive-events-for-page",B="[EVENTSCACHE]",H=e=>"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name;class V{config;logger;reportError;trace;metrics;userId;makeEventsStore;eventStore;eventsCache=this.makeEventsRepository(Y);eventsForPage=this.makeEventsRepository($);eventsTTLInMilliseconds;readiness;debouncedReportError=(()=>new L(5e3,5e3).schedule((e=>this.reportError(e.errorMessage,{userId:e.userId}))))();static initialise(e,t,r,i,s,o,c){return(0,n.zG)(c(),a.UI((n=>new V(e,t,r,i,s,o,c,n))))}constructor(e,t,r,s,a,c,u,l){this.config=e,this.logger=t,this.reportError=r,this.trace=s,this.metrics=a,this.userId=c,this.makeEventsStore=u,this.eventStore=l,this.eventsTTLInMilliseconds=(0,n.zG)((0,i.ij)(this.config.eventsTTLInDays),(0,i.tS)((e=>"number"==typeof e&&e>0?(0,i.G)(24*e*3600):i.YP))),this.eventsCache.events=(0,o.HP)((()=>(0,o.PQ)((0,n.zG)(C.tD((()=>this.trace.startSpan("load_event_cache"))),C.tS((e=>(0,n.zG)(this.loadFromDisk(),C.At((t=>()=>{e.finish(),this.logDebug(`Event cache loaded, #e ${t.length}`)}))))))))),this.readiness=this.eventsCache.events().then((()=>this.migratePreviousPagesEvents())),c.onChange((()=>this.reset()))}async migratePreviousPagesEvents(){const e=this.trace.startSpan("migrate_previous_for_page_events"),t=(0,C.pE)((e=>(0,a.Y3)((()=>e.flush()),F.w)));return(0,n.zG)([this.eventsForPage,this.eventsCache],t,(0,C.UI)((t=>{const n=s.bj(t);return n.length>0&&this.reportError(`Migrate previous events failed. Got:\\n${n.join("\\n ")}`,{userId:this.userId.current}),e.finish()})),(e=>e()))}all(){return Promise.all([this.eventsCache.events(),this.eventsForPage.events()]).then(s.xH)}async add(e,t){let{persistOnDisk:r}=t;return this.logDebug("Adding to cache",e),this.eventsForPage.events=(0,n.zG)(this.eventsForPage.events,C.UI((t=>[...t,e])),o.HP),r&&this.readiness.then((()=>this.eventsForPage.flush())),e}filterEventsByWorkspace(e){return e}pruneEventsToSizeLimit(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.config.eventsCacheLimitBytes;if(n<=0||t<=n)return this.logDebug(`Event size of ${t} less than limit of ${n}`),{events:e,sizeInBytes:t};this.logDebug("Events before pruning",{count:e.length,sizeInBytes:t,byteLimit:n});let r=1,i=[...e];for(;t>n;)i.splice(0,r),r*=2,t=2*JSON.stringify(i).length;return this.logDebug("Events after pruning",{count:i.length,sizeInBytes:t}),{events:i,sizeInBytes:t}}loadFromDisk(){const e=()=>[],t=(0,n.zG)(this.eventsTTLInMilliseconds,i.EQ((()=>n.yR),(e=>s.hX((t=>e>Date.now()-t.time.getTime())))));return(0,n.zG)(C.tD((()=>(this.logLog("Loading event cache..."),this.metrics.startTimer("sdk_load_events_cache_task_duration_seconds",{})))),C.YO("loadEventsCacheTask"),C.ak("eventsFromDisk",(()=>(0,n.zG)(s.nI([this.eventStore.get(Y),this.eventStore.get($)]),s.UI(a.LV((0,o.lo)([[e=>e instanceof N,(0,n.ls)(e,C.of)],t=>(0,n.zG)(C.tD((()=>this.reportError(`Error fetching data from store. Got ${t}`,{userId:this.userId.current}))),C.tS((()=>()=>this.reset("historical"))),C.UI(e))]),(0,n.ls)(i.fS(e),C.of))),s.vP(C.qA)))),C.At((e=>{let{eventsFromDisk:t,loadEventsCacheTask:n}=e;return()=>{this.logDebug("Read events from store:",t),this.metrics.stopTimer("sdk_load_events_cache_task_duration_seconds",n)}})),C.UI((0,n.ls)((0,o.vg)("eventsFromDisk"),s.xH,this.filterEventsByWorkspace,(e=>this.pruneEventsToSizeLimit(e,2*JSON.stringify(e).length)),(e=>(this.eventsCache.sizeInBytes=e.sizeInBytes,this.eventsCache.sizeInBytesLastSuccessfulWrite=e.sizeInBytes,e.events.length>0&&(this.metrics.track({name:"sdk_events_cache_byte_total",value:e.sizeInBytes,labels:{}}),this.metrics.track({name:"sdk_events_cache_size_total",value:e.events.length,labels:{}})),e.events)),s.UI(Q.k),t)))}async reset(e){return(0,n.zG)(C.tD((()=>this.logDebug("Resetting Events Cache"))),C.tS((()=>this.eventStore.deleteStore())),a.tS((()=>this.makeEventsStore())),a.Zl((t=>(this.eventStore=t,"historical"===e?z.gz(a.Ij)(this.eventsCache.reset,this.eventsForPage.flush):z.gz(a.Ij)(this.eventsCache.reset,this.eventsForPage.reset)))),a.wE((()=>()=>this.all())),a.fS((()=>C.of(K()))),(e=>e()))}getStateSizeInBytes(){return this.eventsForPage.sizeInBytes+this.eventsCache.sizeInBytes}makeEventsRepository(e){const t=(()=>{let e=Promise.resolve(l.F2((0,n.Q1)()));return t=>e=e.then(t)})(),r=e=>(0,n.zG)(C.tD((()=>this.logDebug(`Writing ${e.length} events to ${g.key}`))),C.tS((()=>this.eventStore.put(e.map(Q.X),g.key))),a.UI(n.Q1)),i=(0,n.zG)(C.tD((()=>this.logDebug(`Deleting events for ${g.key}`))),C.tS((()=>this.eventStore.delete(g.key))),a.Vn(F.w)),s=(0,n.ls)(C.of,C.At((e=>()=>this.logError(`Events cache failed to put ${g.key}. Got ${e}`))),C.tS((0,o.lo)([[e=>H(e)&&g.retryAttempts<9,()=>(0,n.zG)(C.tD((()=>{g.retryAttempts+=1,this.logDebug(`Attempt #${g.retryAttempts} to write ${g.key} to EventsStore`)})),C.tS((()=>p)),C.tS((()=>u)))],[e=>H(e),e=>(0,n.zG)(C.tD((()=>this.logDebug(`Attempted ${g.retryAttempts} rewrite attempts and reached limit of 9 max writes.`,"Reporting QuotaExceededError to API"))),C.tS((()=>()=>this.debouncedReportError({errorMessage:`Events cache failed to put ${g.key}. Got ${e}`,userId:this.userId.current}))),C.tS((()=>a.t$(e))))],a.t$]))),c=e=>a.tD((()=>{this.logDebug(`Successfully wrote events for ${g.key} after ${g.retryAttempts} attempts`),g.retryAttempts=0,g.sizeInBytes=2*JSON.stringify(e).length,g.sizeInBytesLastSuccessfulWrite=g.sizeInBytes})),u=(0,n.zG)((()=>g.events()),C.tS((e=>(0,n.zG)(r(e),C.mU(l.EQ(s,(()=>c(e)))))))),f=(e,t)=>(0,n.zG)(e.events,C.UI((n=>{const r=2*JSON.stringify(n).length,i=this.pruneEventsToSizeLimit(n,r,t);return e.events=C.of(i.events),e.sizeInBytes=i.sizeInBytes,t-e.sizeInBytes}))),d=(e,t)=>{let[r,...i]=e;return r&&0!==t?(0,n.zG)(f(r,t),C.tS((e=>(this.logDebug(`${e} left after pruning ${r.key}`),d(i,e))))):C.of((0,n.Q1)())},p=(0,n.zG)(a.tD((()=>this.eventsForPage.sizeInBytes-this.eventsForPage.sizeInBytesLastSuccessfulWrite)),a.fX(l.DT((e=>e>0),(e=>new Error(`${this.eventsForPage.key} failed to write the same or smaller events cache of size ${e}`)))),a.tS((e=>{const t=1.2*e,r=[this.eventsCache,this.eventsForPage];return this.logDebug(`Pruning ${t} bytes from`,r),(0,n.zG)(d(r,t),a.fF)}))),g={key:e,events:C.of([]),sizeInBytes:0,sizeInBytesLastSuccessfulWrite:0,retryAttempts:0,flush:()=>(0,n.zG)(C.tD((()=>this.trace.startSpan(`write_${g.key}`))),C.tS((e=>(0,n.zG)(u,C.At((()=>()=>e.finish()))))),t),reset:()=>(0,n.zG)(C.tD((()=>{g.events=C.of([]),g.sizeInBytes=0,g.sizeInBytesLastSuccessfulWrite=0})),C.tS((()=>i)),t)};return g}logDebug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.debug(B,...t)}logWarn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.warn(B,...t)}logError(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.error(B,...t)}logLog(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.log(B,...t)}}const K=()=>[],W=`permutive.${self.document?"main":"worker"}.`;class X{config;shouldUsePerformanceMark=!1;constructor(e){var t;this.config=e,this.shouldUsePerformanceMark=((null===(t=self.performance)||void 0===t?void 0:t.mark)&&this.config.tracingEnabled)??!1}startSpan(e){const t=this.generateSpan(e);return t.start(),{spanId:t.spanId,finish:t.finish}}measureSinceInit(t){const n=this.generateSpan(`${t}_since_init`);return n.start({startTime:e.NC}),{spanId:n.spanId,finish:n.finish}}traceTask(e){return t=>async()=>{const n=this.startSpan(e),r=await t();return n.finish(),r}}measureBetween(e,t,n){const r=this.generateSpan(e);r.start({startTime:t}),r.finish({startTime:n})}generateSpan(e){if(!this.shouldUsePerformanceMark)return{spanId:null,start:()=>{},finish:()=>{}};const{spanName:t,startMarkerName:n,endMarkerName:r}=X.generateUniqueMarkerNames(e);return{spanId:n,start:e=>{var t;return null===(t=self.performance)||void 0===t?void 0:t.mark(n,e)},finish:e=>{var i,s,o;null===(i=self.performance)||void 0===i||i.mark(r,{startTime:(null==e?void 0:e.startTime)??performance.now()}),null===(s=self.performance)||void 0===s||null===(o=s.measure)||void 0===o||o.call(s,t,n,r)}}}static generateUniqueMarkerNames(e){const t=`${W}${e}`,n=`${t}${X.generateId()}`;return{spanName:t,startMarkerName:`${n}_start`,endMarkerName:`${n}_end`}}static generateId(){return"_"+Math.random().toString(36).substr(2,9)}}class Z{db;static version=3;static connect(t,r,i,s,o,c,u,l,f,d){return(0,n.zG)(a.Y3((()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,699))),String),e.N1,a.tS((e=>e.make(t,r,i,s,o,c,u,Z.version,l,f,d))),a.UI((e=>new Z(Promise.resolve(e)))))}constructor(e){this.db=e}shouldThrowStoreClosingError(e){return"NotFoundError"===e.name||"InvalidStateError"===e.name}makeStoreClosingDuringOpertationError(e){return new N(`Attempted ${e} when the current store is closing.`)}put(e,t){return(0,a.Y3)((()=>this.db.then((n=>n.put(e,t)))),(e=>{const t=(0,F.w)(e);return this.shouldThrowStoreClosingError(t)?this.makeStoreClosingDuringOpertationError("put"):t}))}get(e){return(0,a.Y3)((()=>this.db.then((t=>t.get(e))).then(i.ij)),(e=>{const t=(0,F.w)(e);return this.shouldThrowStoreClosingError(t)?this.makeStoreClosingDuringOpertationError("get"):t}))}delete(e){return(0,a.Y3)((()=>this.db.then((t=>t.delete(e)))),(e=>String(e)))}deleteStore(){return(0,a.Y3)((()=>this.db.then((e=>e.deleteStore()))),(e=>String(e)))}}const J=e=>{if(!e)return"";return(0,n.zG)(e,(e=>{const t=e.length-1;return"/"===e[t]?e.slice(0,t):e}))};class ee{urls;config;network;metricsCollector;logger;webClient;prefix="[API]";constructor(e,t,n,r,s){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:()=>i.YP;this.urls=e,this.config=t,this.network=n,this.metricsCollector=r,this.logger=s,this.webClient=o}async reportError(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Date;const o=(0,F.w)(e);if(this.logError("Reporting error:\\n",o),!this.config.sendClientErrors)return void this.logDebug("Send errors not enabled. Skipping");const a=(0,n.zG)(this.webClient,T.UI(i.fS((()=>{var e,t,n,r;return{domain:(null===(e=self.location)||void 0===e?void 0:e.hostname)??"",referrer:"document"in self?null===(t=self.document)||void 0===t?void 0:t.referrer:"",url:(null===(n=self.location)||void 0===n?void 0:n.href)??"",user_agent:(null===(r=navigator)||void 0===r?void 0:r.userAgent)??""}}))),T.UI((e=>{var n,i;const s={error_message:(null==o||null===(n=o.message)||void 0===n?void 0:n.toString())??"",stack_trace:null==o||null===(i=o.stack)||void 0===i?void 0:i.split("\\n")},a=t?{user_id:t}:{};return{platform:"web",sdk_version:"v20.23.0",ql_runtime_version:"v13.1.0",timestamp:r,domain:e.domain,url:J(e.url),referrer:J(e.referrer),user_agent:e.user_agent,error_message:s.error_message??String(o),stack_trace:s.stack_trace,...a}}))),c=e=>this.network.req({url:this.urls.getSdkErrorsUrl("/errors",i.G(this.config.sdkErrorsApiVersion)),method:"POST",payload:[e],contentType:"text/plain",dataType:"text",withCredentials:!1}),u=e=>{this.metricsCollector.trackCounter({name:"sdk_http_generic_network_request_fail_count_total",value:1,labels:{network_error_type:e}})};await(0,n.zG)([f,d],s.Ew((e=>o.name===e.errorName||o.message.indexOf(e.errorName)>=0||o.message.indexOf(e.defaultMessage)>=0)),i.g_((()=>{const e=a();return c(e).catch((0,n.ls)(F.w,(e=>this.logError(e))))}),(async e=>u(e.errorName))))}logDebug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.debug(this.prefix,...t)}logError(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.error(this.prefix,...t)}}var te=__webpack_require__(238);const ne=e=>{const t=re(e.javaScriptInput),{env:n,...r}=(0,te.N)({hash:e.hash,runtimeInput:t});return r},re=e=>{if(e&&"object"==typeof e)return e;throw new Error("Invalid runtime input specified.")},ie=("undefined"!=typeof globalThis?globalThis:void 0)?.crypto||("undefined"!=typeof global?global:void 0)?.crypto||("undefined"!=typeof window?window:void 0)?.crypto||("undefined"!=typeof self?self:void 0)?.crypto||("undefined"!=typeof frames?frames:void 0)?.[0]?.crypto;let se;se=ie?e=>{const t=[];for(let n=0;n<e;n+=4)t.push(ie.getRandomValues(new Uint32Array(1))[0]);return new ae(t,e)}:e=>{const t=[],n=e=>{let t=e,n=987654321;const r=4294967295;return()=>{n=36969*(65535&n)+(n>>16)&r,t=18e3*(65535&t)+(t>>16)&r;let e=(n<<16)+t&r;return e/=4294967296,e+=.5,e*(Math.random()>.5?1:-1)}};for(let r,i=0;i<e;i+=4){const e=n(4294967296*(r||Math.random()));r=987654071*e(),t.push(4294967296*e()|0)}return new ae(t,e)};class oe{static create(...e){return new this(...e)}mixIn(e){return Object.assign(this,e)}clone(){const e=new this.constructor;return Object.assign(e,this),e}}class ae extends oe{constructor(e=[],t=4*e.length){super();let n=e;if(n instanceof ArrayBuffer&&(n=new Uint8Array(n)),(n instanceof Int8Array||n instanceof Uint8ClampedArray||n instanceof Int16Array||n instanceof Uint16Array||n instanceof Int32Array||n instanceof Uint32Array||n instanceof Float32Array||n instanceof Float64Array)&&(n=new Uint8Array(n.buffer,n.byteOffset,n.byteLength)),n instanceof Uint8Array){const e=n.byteLength,t=[];for(let r=0;r<e;r+=1)t[r>>>2]|=n[r]<<24-r%4*8;this.words=t,this.sigBytes=e}else this.words=e,this.sigBytes=t}static random=se;toString(e=ce){return e.stringify(this)}concat(e){const t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(let e=0;e<i;e+=1){const i=n[e>>>2]>>>24-e%4*8&255;t[r+e>>>2]|=i<<24-(r+e)%4*8}else for(let e=0;e<i;e+=4)t[r+e>>>2]=n[e>>>2];return this.sigBytes+=i,this}clamp(){const{words:e,sigBytes:t}=this;e[t>>>2]&=4294967295<<32-t%4*8,e.length=Math.ceil(t/4)}clone(){const e=super.clone.call(this);return e.words=this.words.slice(0),e}}const ce={stringify(e){const{words:t,sigBytes:n}=e,r=[];for(let e=0;e<n;e+=1){const n=t[e>>>2]>>>24-e%4*8&255;r.push((n>>>4).toString(16)),r.push((15&n).toString(16))}return r.join("")},parse(e){const t=e.length,n=[];for(let r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new ae(n,t/2)}},ue={stringify(e){const{words:t,sigBytes:n}=e,r=[];for(let e=0;e<n;e+=1){const n=t[e>>>2]>>>24-e%4*8&255;r.push(String.fromCharCode(n))}return r.join("")},parse(e){const t=e.length,n=[];for(let r=0;r<t;r+=1)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new ae(n,t)}},le={stringify(e){try{return decodeURIComponent(escape(ue.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:e=>ue.parse(unescape(encodeURIComponent(e)))};class fe extends oe{constructor(){super(),this._minBufferSize=0}reset(){this._data=new ae,this._nDataBytes=0}_append(e){let t=e;"string"==typeof t&&(t=le.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes}_process(e){let t;const{_data:n,blockSize:r}=this,i=n.words,s=n.sigBytes;let o=s/(4*r);o=e?Math.ceil(o):Math.max((0|o)-this._minBufferSize,0);const a=o*r,c=Math.min(4*a,s);if(a){for(let e=0;e<a;e+=r)this._doProcessBlock(i,e);t=i.splice(0,a),n.sigBytes-=c}return new ae(t,c)}clone(){const e=super.clone.call(this);return e._data=this._data.clone(),e}}class de extends fe{constructor(e){super(),this.blockSize=16,this.cfg=Object.assign(new oe,e),this.reset()}static _createHelper(e){return(t,n)=>new e(n).finalize(t)}static _createHmacHelper(e){return(t,n)=>new pe(e,n).finalize(t)}reset(){super.reset.call(this),this._doReset()}update(e){return this._append(e),this._process(),this}finalize(e){e&&this._append(e);return this._doFinalize()}}class pe extends oe{constructor(e,t){super();const n=new e;this._hasher=n;let r=t;"string"==typeof r&&(r=le.parse(r));const i=n.blockSize,s=4*i;r.sigBytes>s&&(r=n.finalize(t)),r.clamp();const o=r.clone();this._oKey=o;const a=r.clone();this._iKey=a;const c=o.words,u=a.words;for(let e=0;e<i;e+=1)c[e]^=1549556828,u[e]^=909522486;o.sigBytes=s,a.sigBytes=s,this.reset()}reset(){const e=this._hasher;e.reset(),e.update(this._iKey)}update(e){return this._hasher.update(e),this}finalize(e){const t=this._hasher,n=t.finalize(e);t.reset();return t.finalize(this._oKey.clone().concat(n))}}const ge=[];class he extends de{_doReset(){this._hash=new ae([1732584193,4023233417,2562383102,271733878,3285377520])}_doProcessBlock(e,t){const n=this._hash.words;let r=n[0],i=n[1],s=n[2],o=n[3],a=n[4];for(let n=0;n<80;n+=1){if(n<16)ge[n]=0|e[t+n];else{const e=ge[n-3]^ge[n-8]^ge[n-14]^ge[n-16];ge[n]=e<<1|e>>>31}let c=(r<<5|r>>>27)+a+ge[n];c+=n<20?1518500249+(i&s|~i&o):n<40?1859775393+(i^s^o):n<60?(i&s|i&o|s&o)-1894007588:(i^s^o)-899497514,a=o,o=s,s=i<<30|i>>>2,i=r,r=c}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+s|0,n[3]=n[3]+o|0,n[4]=n[4]+a|0}_doFinalize(){const e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash}clone(){const e=super.clone.call(this);return e._hash=this._hash.clone(),e}}const me=de._createHelper(he),ve=(de._createHmacHelper(he),{stringify(e){const{words:t,sigBytes:n}=e,r=this._map;e.clamp();const i=[];for(let e=0;e<n;e+=3){const s=(t[e>>>2]>>>24-e%4*8&255)<<16|(t[e+1>>>2]>>>24-(e+1)%4*8&255)<<8|t[e+2>>>2]>>>24-(e+2)%4*8&255;for(let t=0;t<4&&e+.75*t<n;t+=1)i.push(r.charAt(s>>>6*(3-t)&63))}const s=r.charAt(64);if(s)for(;i.length%4;)i.push(s);return i.join("")},parse(e){let t=e.length;const n=this._map;let r=this._reverseMap;if(!r){this._reverseMap=[],r=this._reverseMap;for(let e=0;e<n.length;e+=1)r[n.charCodeAt(e)]=e}const i=n.charAt(64);if(i){const n=e.indexOf(i);-1!==n&&(t=n)}return((e,t,n)=>{const r=[];let i=0;for(let s=0;s<t;s+=1)if(s%4){const t=n[e.charCodeAt(s-1)]<<s%4*2|n[e.charCodeAt(s)]>>>6-s%4*2;r[i>>>2]|=t<<24-i%4*8,i+=1}return ae.create(r,i)})(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="});const be=function(e){let t=i.YP;const n=i.fS((()=>{const n=e();return t=i.G(n),n}));return()=>n(t)}((()=>({metadata:{108187:"0c8b70cdb7",116207:"b45d7878a6",116208:"c5d0889ab9",116209:"905188b41a",116687:"f2236a186a",117111:"86ed7f3dc0",117303:"555a4fd875",117307:"fbfff758da",117372:"03b9382bd7",117374:"4ce16e5172",117414:"1b0fa66d2b",117418:"ececc92bd5",117484:"58bf73db23",117501:"45c79c1078",118099:"2df4294b60",118100:"1e1c9536e0",118208:"b86648a84f",118210:"8736b24bef",118211:"7236641d25",118212:"5d7b141743",118215:"c3cdac53d0",118216:"2aef6f6cd8",118218:"aefa6f06ec",118221:"17027686aa",118222:"640bc7cbf6",118223:"ae2c127422",118460:"922eaeac9b",118462:"a229aedb0f",118463:"8fa89348a0",118468:"10134bf959",118470:"d26624a678",118471:"12e25ce33c",118473:"bf31bb119c",118474:"912d430db7",118475:"5f3b34d203",118476:"73e7dbd4bb",118477:"2404581f37",118478:"ee84e86d97",118483:"212128d060",118485:"f54ebee1e3",118487:"b26caa2440",118608:"ce2a7bf289",118786:"54ae43e66e",118788:"884ca7fae7",118789:"6a1c3d539b",118793:"e35e7c8e32",118794:"63f4c35dc6",118795:"6a9a1ff452",118798:"33e7249871",121633:"fedb64cc02",121635:"f0c9108e3a",121636:"fd0c90d371",121676:"3ce2145361",121680:"f7a3013a03",121681:"84c5f737fb",121682:"1810616f90",121752:"d35b12a7df",121753:"6a2abfb385",121754:"dc61dd2807",121755:"95488915cc",121757:"e750c0e5b7",121758:"0ca1cf0b3f",121759:"a4a2b4e813",121760:"171f10e5bf",121761:"8d93fb6b49",121762:"a2974f7e6b",121764:"90a4fa572d",121765:"10ab0503ef",121767:"df5b9fe643",121769:"be61c5a820",121770:"a9831f0da8",121771:"50590cd47d",122487:"7570b74483",122555:"f725587816",123457:"395d10e8bf",124811:"cfacd20b12",125010:"e30028b00a",125753:"3596e97f87",128599:"33b6f8caf2",129774:"abadf8f0d6",129775:"5d7b5dfd78",131393:"e9741a576f",131394:"8632ccd825",134001:"8701760090",137806:"736538b2ec",137808:"7b522e468d",137809:"3706af38c6",139421:"e183b4d8c3",139424:"a119264e06",139426:"8f9aba4a86",139427:"145b016258",139428:"01c3646dfd",139430:"c013db1c35",139432:"6173c39df2",139433:"9801708f0f",139434:"2be2554671",139435:"3c08b74838",139436:"31ca9f8889",139438:"ac27ae1629",139439:"918fe7be95",139441:"339566f2d1",139465:"a254513b55",139467:"69c88de2df",139468:"be60ee5663",139470:"e4d33ff1ad",139471:"d5a64f7b24",139473:"95642839b8",139474:"492b8bade6",139475:"24f5c02a41",139477:"7ee6968096",139478:"aa8d7ee1cc",139479:"e356d89538",139480:"aeb808b510",139481:"855a79347c",139482:"d2938ce2db",139483:"3c343cfa04",139484:"5264ef2d97",139485:"46774a890d",139486:"62522ad6be",139487:"94890ea214",139488:"7ad465ec95",139489:"d7b10c8657",139490:"c3b827ff04",139491:"004940f3f7",139492:"33d529e4a3",139494:"1cdf1cc86a",139495:"c6b1914562",139496:"9be94c2465",139497:"ba33fcbdb0",139499:"e1da16c5a4",139500:"68e55d40cf",139501:"4469c59feb",139502:"848669be4b",139503:"9c8ffcb683",139504:"80afe684ad",139505:"efe08417eb",139506:"e1d1a5db94",139507:"f1ccc75701",139510:"833a2134d5",139511:"8632ccd825",139512:"40ea9c8adf",139513:"bacc9368d3",139514:"09b1b3d200",139515:"bacad03b79",139516:"7c774dfd0a",139517:"6ef3c62e48",139518:"63e9a1c60b",139519:"b88f6d0409",139520:"c1b733a9f1",139521:"539d568876",139522:"c768dd9189",139523:"c2e1702cc8",139524:"cfdd38ead3",139525:"0939cc83cd",139526:"30f95c47e7",139530:"dd6d3b5764",139860:"f82983f4d2",141312:"1d5f769763",141412:"b802ba1d1b",141938:"cd9d7e9665",143007:"a608df7add",143008:"a406817d47",146579:"769b57f673",146580:"a38a9ee42b",147148:"ebf839235e",150867:"e6ca0199e0",156584:"3b39e2058e",161960:"abf27b83c3",162294:"ce72f9d012",162398:"4d96caf60a",162399:"deecfcbfc0",162402:"8bac16c18c",164159:"6748ef450c",164160:"1808965a88",164161:"f425f83a83",164162:"f1a7c19f58",172408:"b1c743bccf",173349:"35c35e5f8c",176552:"2b7d837131",176856:"8f8add5307",177227:"56bcf2fc9f",182733:"d2f664deef",182734:"abaf3430b5",184136:"8ee18971f9",184730:"3b9d35c2ef",184732:"bb5d302610",184738:"1752d9fed4",184745:"fe81cde36d",185474:"722c466936",185907:"4c53ab6254",185937:"d36139ab55",185989:"a9577605d3",186173:"a39c9f9c68",187028:"6013cd1571",187907:"6fcd36a7f0",187912:"38a462529a",194509:"cb7d41f4ea",194512:"aa91a3f5f5",194711:"fa67e884c7",194712:"6e98fdc222",194714:"42f87286c4",194715:"a1cb1ffa67",194716:"343117f492",194717:"9b781b5cef",194718:"9bc9ce30a3",194719:"ffcc627b8f",194731:"1ed763eb44",194732:"67d7c442e2",194733:"d1fc2ee595",194734:"3f4565b105",194737:"e051f9c286",194739:"e051f9c286",194740:"90f6a30a9c",194741:"446332eb73",194743:"553138a0ef",200689:"f51345d188",200690:"dda875fc05",207225:"ab31d574f1",210682:"b5f8dd00a0",211378:"a8b191a595",1e7:"14dcdbd1b8",10000001:"85e2135ebf",10000002:"6f0530b847",10000003:"9aebeaabdc",10000004:"ec30be261c",10000005:"42e269ebcb",10000006:"fe46ec1a7c",10000007:"c7c5b41643",10000008:"e017e3296e",10000010:"c8a4da1342",10000011:"d0033013c8",10000012:"c920a1872b",10000013:"5cb1560e95",10000014:"945d12984c",10000015:"3f0af1c616",10000016:"e9cff35b9e",10000017:"809a140d15",10000018:"a3f294e223",10000019:"26c5369243",10000020:"2895ae0549",10000021:"7e463b1f7b",10000022:"3ac8066b24",10000023:"05688314fe",10000024:"2b9b203f0f",10000025:"d8c2189403",10000026:"abaa9c1f9a",10000035:"a41083a929",10000036:"8e74dd4bab",10000037:"cafae725da",10000038:"a121dfa9da",10000039:"ff48cf981d",10000040:"254b287491",10000041:"95cf182700",10000042:"7c449193e6",10000043:"7cf4199d2c",10000044:"7d70b943e5",10000045:"d6ebb8fae4",10000046:"6ec2e4a903",10000047:"6b9d9c6b43",10000048:"c697613553",10000049:"154b668a0c",10000050:"06c11d3a67",10000051:"79b306f4fb",10000052:"4ddf4d4f00",10000053:"d4f3f248fb",10000054:"5f1da0f4d3",10000055:"a258c98d13",10000056:"46ae6a0b78",10000057:"484950e70c",10000058:"b0f2c06862",10000059:"81c7d9a013",10000060:"b2774f9b84",10000061:"8d357982ec",10000062:"f17475be77",10000063:"2e17bf9dba",10000064:"5ab5b328ac",10000065:"746301201f",10000066:"74a3fa3235",10000067:"445aec4c58",10000068:"166c8e0df7",10000069:"3c1d1ce2d1",10000070:"41b1a04aca",10000071:"8f48e4fe18",10000072:"ce3f903a4a",10000073:"facdeec66b",10000074:"5bdce48fc9",10000075:"4263c32baa",10000076:"da12137035",10000077:"befae0dd8d",10000078:"3789f175c4",10000079:"8f0ede6d58",10000080:"2c8374dc79",10000081:"939ab96a5d",10000082:"65edb8587b",10000083:"5d51ce9468",10000084:"31758176d8",10000085:"3f06c3645c",10000086:"570293b21e",10000087:"c8ca3f3a91",10000088:"3f8c611719",10000089:"ec5bacbf42",10000090:"b1a46cb9ba",10000324:"7b7e80f204",10000325:"dbc6c5bd69",10000327:"ac86d06eda",10000328:"29283373d0",10000329:"e1abc69b32",10000330:"c319f17ac6",10000687:"559415b345",10000688:"59bcb90348",10000689:"3d5058c75a",10000690:"02beff69b3",10000691:"ef2d717c50",10000692:"ed824f7075",10000693:"855e7d694d",10000694:"3d35d48a1e",10000695:"76f5459105",10000696:"836eb3c3a8",10000697:"f6898d79aa",10000698:"034cb96ed7",10000699:"2ab0be4b8e",10000700:"f9ff676abf",10000701:"b1198dc297",10000702:"9aa495d2d0",10000703:"94466aef62",10000704:"bbe993efa8",10000705:"08e87b19e5",10000706:"30af89e371",10000707:"c615bda81b",10000708:"3439a7f2c6",10000709:"fe2a0450ee",10000710:"d3b1c6970b",10000711:"e8e7936872",10000712:"62ade9a5d9",10000713:"cd2d7202ce",10000714:"f5f5c0c726",10000715:"c8940defa7",10000716:"d4c3511f1c",10000717:"c0b33b2707",10000718:"b7898a96a4",10000719:"0afe21c711",10000720:"15bc4cd75c",10000721:"236acfc33e",10000722:"4252e4f621",10000723:"5532721500",10000724:"cf7ee7c557",10000725:"8e10bb4c62",10000726:"8f9461820c",10000727:"ab5e6c0d6e",10000728:"b0f2c06862",10000729:"a6aa48da2f",10000730:"81fed62109",10000731:"60450684ad",10000732:"91ada79e5f",10000733:"d7bc2d75d2",10000734:"96023b30a9",10000735:"d1f5fdd3ee",10000736:"d1f5fdd3ee",10000737:"4626475287",10000738:"9140be25d5",10000739:"6d7e163aeb",10000740:"9c25789148",10000741:"b9c34da79c",10000742:"4051b7098a",10000743:"b1b7157e01",10000744:"a09ed2c549",10000745:"a058ff2a49",10000746:"a0c8d3019b",10000747:"ac3fdffff0",10000748:"3dd97e8055",10000749:"b754ebaa69",10000750:"51d3b9564c",10000751:"96023b30a9",10000752:"96a9c2bea3",10000753:"0a09c2d0cf",10000754:"38685c8612",10000755:"f8e27f95ef",10000756:"c3e7efdce7",10000757:"b5a29565a3",10000758:"45d836f255",10000759:"1a2a833310",10000760:"c1b09c8fc2",10000761:"5c53c1c7b6",10000762:"76f62be96f",10000763:"34f8564abc",10000764:"d1cf01d5ca",10000765:"dd3bd8d139",10000766:"153a809ae6",10000767:"937f54123d",10000768:"428ccdd665",10000769:"6cd7b24a28",10000770:"f29ba8726d",10000771:"919f452aa2",10000772:"fe2b83f925",10000773:"e1451f31f3",10000774:"7cc13def5b",10000775:"838dd6be01",10000776:"5f08966e98",10000777:"77eae04846",10000778:"84a83ac33b",10000779:"4c0a1b312e",10000780:"36cb533b06",10000781:"eda27d241c",10000782:"bf47ef634c",10000783:"0e5b38bf4e",10000784:"575b94fc50",10000785:"b2bf9497c0",10000786:"3b9d152ebb",10000787:"2573f87eeb",10000788:"6a97ae4ea8",10000789:"50a9a213be",10000790:"b184d9ab96",10000791:"e7684adb8a",10000792:"ebf99bd12f",10000793:"3f7d61c4a9",10000794:"0f02072bd7",10000795:"11e00f9535",10000796:"dcfaea9c78",10000797:"63427e14ff",10000798:"0045fe2ae5",10000799:"e2d6b5bc78",10000800:"96257b0908",10000801:"4b1efa07d3",10000802:"f7c7d3a0ac",10000803:"bb1889cd06"},runtime:ne({hash:function(e){return me(e).toString(ve).slice(0,8)},javaScriptInput:{ahoCorasickLookup:e=>[],eventSegments:e=>({"!UpdateLookalikeModels":["121635","121636","121753","121754","121755","121757","121758","121759","122555","128599","137806","137808","137809","139860","141412","172408","176856","177227"],"!UpdateSecondPartyData":["117111","117414","117484","118211","118212","118215","118218","118221","118223","118460","118462","118468","118470","118478","118483","118789","118794","118795","121676","121680","121752","121761","121762","121764","121765","121769","121770","121771","122487","123457","141938","164159","164160","164161","164162","185937","194741","194743"],"!UpdateThirdPartyData":["116207","116208","116209","117372","121764","129774","129775","131393","131394","134001","139421","139424","139426","139427","139428","139430","139432","139433","139434","139435","139436","139438","139439","139441","139465","139467","139468","139470","139471","139473","139474","139475","139477","139478","139479","139480","139481","139482","139483","139484","139485","139486","139487","139488","139489","139490","139491","139492","139494","139495","139496","139497","139499","139500","139501","139502","139503","139504","139505","139506","139507","139510","139511","139512","139513","139514","139515","139516","139517","139518","139519","139520","139521","139522","139523","139524","139525","139526","139530"],LinkClick:["118223","121682","121764","123457","194714","194715","200689"],Pageview:["10000000","10000001","10000002","10000003","10000004","10000005","10000006","10000007","10000008","10000010","10000011","10000012","10000013","10000014","10000015","10000016","10000017","10000018","10000019","10000020","10000021","10000022","10000023","10000024","10000025","10000026","10000035","10000036","10000037","10000038","10000039","10000040","10000041","10000042","10000043","10000044","10000045","10000046","10000047","10000048","10000049","10000050","10000051","10000052","10000053","10000054","10000055","10000056","10000057","10000058","10000059","10000060","10000061","10000062","10000063","10000064","10000065","10000066","10000067","10000068","10000069","10000070","10000071","10000072","10000073","10000074","10000075","10000076","10000077","10000078","10000079","10000080","10000081","10000082","10000083","10000084","10000085","10000086","10000087","10000088","10000089","10000090","10000324","10000325","10000327","10000328","10000329","10000330","10000687","10000688","10000689","10000690","10000691","10000692","10000693","10000694","10000695","10000696","10000697","10000698","10000699","10000700","10000701","10000702","10000703","10000704","10000705","10000706","10000707","10000708","10000709","10000710","10000711","10000712","10000713","10000714","10000715","10000716","10000717","10000718","10000719","10000720","10000721","10000722","10000723","10000724","10000725","10000726","10000727","10000728","10000729","10000730","10000731","10000732","10000733","10000734","10000735","10000736","10000737","10000738","10000739","10000740","10000741","10000742","10000743","10000744","10000745","10000746","10000747","10000748","10000749","10000750","10000751","10000752","10000753","10000754","10000755","10000756","10000757","10000758","10000759","10000760","10000761","10000762","10000763","10000764","10000765","10000766","10000767","10000768","10000769","10000770","10000771","10000772","10000773","10000774","10000775","10000776","10000777","10000778","10000779","10000780","10000781","10000782","10000783","10000784","10000785","10000786","10000787","10000788","10000789","10000790","10000791","10000792","10000793","10000794","10000795","10000796","10000797","10000798","10000799","10000800","10000801","10000802","10000803","108187","116687","117111","117303","117307","117374","117414","117418","117484","117501","118099","118100","118208","118210","118211","118212","118215","118216","118218","118221","118222","118223","118460","118462","118463","118468","118470","118471","118473","118474","118475","118476","118477","118478","118483","118485","118487","118608","118786","118788","118789","118793","118794","118795","118798","121633","121676","121680","121681","121752","121760","121761","121762","121764","121765","121767","121769","121771","122487","123457","124811","125010","125753","141312","141938","143008","146580","147148","150867","156584","161960","162294","162398","162399","162402","164159","164160","164161","164162","173349","184136","185474","185907","185937","185989","186173","187028","187907","187912","194509","194512","194711","194712","194714","194715","194716","194717","194718","194719","194731","194732","194733","194734","194737","194739","194740","194741","194743","200689","200690","207225","210682"],PageviewComplete:["116687","117111","117303","117307","117414","117418","117484","117501","118099","118100","118208","118210","118211","118212","118215","118216","118218","118221","118223","118460","118462","118463","118468","118470","118471","118473","118474","118475","118476","118477","118478","118483","118485","118487","118608","118786","118788","118789","118793","118794","118795","118798","121633","121676","121680","121681","121765","121767","121769","124811","125753","150867","156584","161960","162294","162398","162399","162402","173349","186173","194509","194512","194711","194712","194714","194715","194716","194717","194718","194719","194731","194732","194733","194734","194737","194739","194740","194741","194743","210682"],PageviewEngagement:["116687","117111","117303","117307","117414","117418","117484","117501","118099","118100","118208","118210","118211","118212","118215","118216","118218","118221","118223","118460","118462","118463","118468","118470","118471","118473","118474","118475","118476","118477","118478","118483","118485","118487","118608","118786","118788","118789","118793","118794","118795","118798","121633","121676","121680","121681","121765","121767","121769","124811","125753","150867","156584","161960","162294","162398","162399","162402","173349","186173","194509","194512","194711","194712","194714","194715","194716","194717","194718","194719","194731","194732","194733","194734","194737","194739","194740","194741","194743","210682"],SegmentEntry:[],SegmentExit:[],SlotClicked:["143007","146579","176552","182733","184730","184732","184738","184745","207225","211378"],SlotViewable:["176552","182734","184730","184732","184738","184745","207225"]}),eventsLookup:e=>["Pageview","PageviewEngagement","PageviewComplete","SlotClicked","LinkClick","SlotViewable"],interpretOnlyQueries:e=>({}),literalsLookup:e=>e.frontDecode("/art and entertainment/books and literature\\t43\\t/poetry\\t23\\tcomics and animation\\t23\\tdance\\t23\\tmovies\\t29\\t and tv\\t36\\t/animated\\t37\\tchildren\'s\\t38\\tomedies\\t37\\tdocumentaries\\t37\\treality\\t38\\tomantic comedies\\t37\\ttelevision\\t24\\tusic\\t28\\t/music genres/classical music\\t42\\topera\\t42\\tpop music\\t42\\tsoundtracks\\t23\\tshows and events\\t39\\t/classical concert\\t23\\ttheatre\\t4\\ts/theater\\t2\\tutomotive and vehicles\\t24\\t/cars/luxury\\t25\\tmotorcycles\\t1\\tbusiness and industrial\\t24\\t/fashion industry\\t1\\teagles\\t2\\tducation\\t10\\t/adult education\\t11\\tlanguage learning\\t1\\tfamily\\t7\\t and parenting\\t2\\tinance/accounting and auditing/tax preparation and planning\\t9\\tfinancial news\\t2\\tood and drink/dining out\\t16\\tfood/fruits and vegetables\\t21\\tsalads\\t16\\thealthy eating\\t16\\tvegan\\t19\\tetarian\\t1\\thealth and fitness\\t19\\t/exercise\\t20\\tnutrition\\t20\\tsports medicine\\t20\\tweight loss\\t7\\t/wellness\\t2\\tobbies and interests/arts and crafts/photography\\t23\\tbirdwatching\\t3\\tme and garden/gardening and landscaping\\t17\\thome improvement and repair\\t1\\tlaw, govt and politics\\t1\\tpets\\t5\\t/birds\\t6\\tcats\\t6\\tdogs\\t6\\tlarge animals\\t2\\thilly-first\\t7\\tfirst\\t7\\ts-best/#kids\\t2\\tolitics\\t9\\t/pennsylvania\\t1\\treal estate\\t12\\t/apartments\\t13\\tbuying and selling homes\\t1\\tsociety/crime\\t9\\tdating\\t2\\tports/diving\\t8\\thorse racing\\t13\\ts\\t8\\tolympics\\t16\\t/paralympic games\\t8\\tskiing\\t8\\tvolleyball/beach volleyball\\t2\\ttyle and fashion/beauty/cosmetics\\t19\\tclothing\\t1\\ttechnology and computing/consumer electronics/tv and video equipment\\t\\t15 free winter events at philadelphia\'s free library for parents and children\\t\\t5 things to do with kids in philly this week\\t1\\t5+\\t\\tA More Perfect Union\\t1\\tctive\\t\\tHome and Garden\\t\\tWrestleMania\\t\\taarp\\t\\tbetting\\t\\tcampaign\\t8\\ting\\t2\\tsino\\t1\\tollege-sports\\t\\tdining\\t\\teagles\\t1\\tedition\\t\\tfood\\t3\\ttball\\t\\tgambling\\t\\thealth\\t3\\tring aids\\t1\\tomeowner\\t2\\tw to find child care in philadelphia\\t12\\tfree pre-k in philadelphia\\t1\\tttps://www.inquirer.com/education\\t25\\tjobs\\t25\\topinion\\t25\\tphilly-tips/best-childrens-museums-philadelphia.html\\t37\\tjobs-in-philadelphia.html\\t37\\tparenting-child-care-philadelphia.html\\t26\\tolitics/\\t25\\treal-estate/home/\\t25\\tthings-to-do/free-philadelphia-library-events-babies-children-teens-2023.html\\t38\\tphiladelphia-kids-events-calendar\\t1\\turts\\t\\tinvestment\\t\\tjalen\\t\\tmarijuana\\t3\\tket\\t1\\tedicare\\t1\\tidterms\\t1\\tusical\\t\\tnfl\\t\\tphiladelphia corporation for aging\\t4\\tlies\\t5\\ty-first\\t6\\tfirst\\t1\\tolitical\\t7\\tian\\t7\\ts\\t\\tregister to vote\\t2\\ttirement\\t10\\t community\\t\\tsenior\\t1\\tirianni\\t\\tticket\\t6\\ts\\t\\tvoting"),propertiesLookup:e=>[["classifications_watson","taxonomy_labels"],["client","url"],["article","section_targets"],["client","title"],["keyword"],["article","sub_section"],["user","sf_subscriber_status"],["campaign_id"],["article","sub_sub_section"],["article","story_tags"],["dest_url"],["article","authors"],["article","clavis_topics"],["geo_info","province"],["article","section_primary"],["creative_id"]],queries:e=>({1e7:e.r(55,"/science","/education/graduate school"),10000001:e.r(59,22),10000002:e.r(55,2,0),10000003:e.r(55,"/finance",25),10000004:e.r(55,29,"/careers"),10000005:e.r(59,28),10000006:e.r(48,32,66,"/society/social institution/marriage"),10000007:e.r(53,1,3,14,15,19,20,"/art and entertainment/visual art and design/art museums and galleries","/art and entertainment/visual art and design/arts education","/art and entertainment/visual art and design/performance art","/art and entertainment/visual art and design/restoration","/art and entertainment/visual art and design/sculpture","/education/art history",47),10000008:e.r(48,"/business and industrial/food industry","/food and drink","/food and drink/food and grocery retailers"),10000010:e.r(55,41,38),10000011:e.r(59,"/hobbies and interests"),10000012:e.r(59,"/home and garden"),10000013:e.r(55,5,4),10000014:e.r(59,13),10000015:e.r(51,"/business and industrial/business news",34,51,"/news",65,"/sports/sports news","/technology and computing/tech news"),10000016:e.r(48,"/finance/bank",34,"/finance/personal finance"),10000017:e.r(59,52),10000018:e.r(49,"/art and entertainment/celebrity fan and gossip",10,12,16),10000019:e.r(59,62),10000020:e.r(59,"/shopping"),10000021:e.r(55,"/sports",41),10000022:e.r(55,"/style and fashion",26),10000023:e.r(48,"/business and industrial/automation","/science/computer science","/technology and computing"),10000024:e.r(49,"/art and entertainment/movies and tv/movies/reviews",12,"/art and entertainment/tv",76),10000025:e.r(59,"/travel"),10000026:e.r(55,"/technology and computing/consumer electronics/game systems and consoles","/hobbies and interests/games/video and computer games"),10000035:e.r(55,"/science/physics","/science/engineering"),10000036:e.r(59,"/automotive and vehicles/buying and selling cars"),10000037:e.r(59,"/automotive and vehicles/motor shows"),10000038:e.r(55,"/automotive and vehicles/electric vehicles","/automotive and vehicles/cars/hybrid"),10000039:e.r(59,24),10000040:e.r(59,"/automotive and vehicles/cars/performance vehicles"),10000041:e.r(55,"/art and entertainment/comics and animation/comics",2),10000042:e.r(59,"/business and industrial/business operations"),10000043:e.r(59,66),10000044:e.r(59,32),10000045:e.r(59,3),10000046:e.r(59,"/art and entertainment/visual art and design"),10000047:e.r(59,"/food and drink/beverages/alcoholic beverages"),10000048:e.r(59,"/food and drink/barbecues and grilling"),10000049:e.r(55,"/food and drink/food and grocery retailers/bakeries","/food and drink/desserts and baking"),10000050:e.r(55,"/food and drink/food/fast food",35),10000051:e.r(59,"/food and drink/food allergies"),10000052:e.r(49,36,37,"/food and drink/health and lowfat cooking",38),10000053:e.r(59,40),10000054:e.r(55,44,42),10000055:e.r(59,"/health and fitness/men\'s health"),10000056:e.r(59,43),10000057:e.r(59,"/health and fitness/women\'s health"),10000058:e.r(61),10000059:e.r(59,"/art and entertainment/movies and tv/action"),10000060:e.r(59,6),10000061:e.r(59,7),10000062:e.r(59,"/art and entertainment/movies and tv/horror"),10000063:e.r(59,65),10000064:e.r(55,"/law, govt and politics/legal issues","/law, govt and politics/law enforcement"),10000065:e.r(59,"/news/national news"),10000066:e.r(55,"/law, govt and politics/politics","/law, govt and politics/government"),10000067:e.r(59,"/science/weather"),10000068:e.r(59,53),10000069:e.r(59,54),10000070:e.r(59,55),10000071:e.r(59,56),10000072:e.r(59,"/pets/reptiles"),10000073:e.r(59,"/sports/football"),10000074:e.r(59,"/sports/baseball"),10000075:e.r(59,"/sports/basketball"),10000076:e.r(59,"/sports/bodybuilding"),10000077:e.r(59,"/sports/bowling"),10000078:e.r(59,"/sports/boxing"),10000079:e.r(59,"/sports/bicycling"),10000080:e.r(59,"/sports/fishing"),10000081:e.r(59,"/sports/golf"),10000082:e.r(59,"/sports/hunting and shooting"),10000083:e.r(59,"/sports/rugby"),10000084:e.r(59,72),10000085:e.r(59,"/sports/tennis"),10000086:e.r(59,"/sports/walking"),10000087:e.r(49,"/business and industrial/tanning","/style and fashion/beauty",74,"/style and fashion/beauty/cosmetology and beauty professionals"),10000088:e.r(55,"/style and fashion/body art","/style and fashion/beauty/tattoos"),10000089:e.r(59,"/style and fashion/men \'s fashion"),10000090:e.r(59,"/technology and computing/consumer electronics"),10000324:e.r(59,25),10000325:e.r(50,"/business and industrial/company/annual report","/business and industrial/company/bankruptcy","/business and industrial/company/earnings","/business and industrial/company/joint venture","/business and industrial/company/merger and acquisition"),10000327:e.r(59,"/finance/personal finance/debt management"),10000328:e.r(59,"/finance/personal finance/insurance"),10000329:e.r(48,"/finance/accounting and auditing/billing and invoicing","/finance/accounting and auditing/bookkeeping",33),10000330:e.r(59,"/finance/investing"),10000687:e.r(59,"/science/social science"),10000688:e.r(59,30),10000689:e.r(55,"/automotive and vehicles/scooters and mopeds",24),10000690:e.r(52,"/automotive and vehicles/vehicle brands/fiat","/automotive and vehicles/vehicle brands/ford","/automotive and vehicles/vehicle brands/honda","/automotive and vehicles/vehicle brands/hyundai","/automotive and vehicles/vehicle brands/nissan","/automotive and vehicles/vehicle brands/peugeot","/automotive and vehicles/vehicle brands/subaru","/automotive and vehicles/vehicle brands/suzuki"),10000691:e.r(53,23,"/automotive and vehicles/vehicle brands/audi","/automotive and vehicles/vehicle brands/bentley","/automotive and vehicles/vehicle brands/ferrari","/automotive and vehicles/vehicle brands/lamborghini","/automotive and vehicles/vehicle brands/land rover","/automotive and vehicles/vehicle brands/maserati","/automotive and vehicles/vehicle brands/mercedes-benz","/automotive and vehicles/vehicle brands/porsche","/automotive and vehicles/vehicle brands/rolls-royce","/automotive and vehicles/vehicle brands/toyota","/automotive and vehicles/vehicle brands/volkswagen","/automotive and vehicles/vehicle brands/volvo"),10000692:e.r(59,"/automotive and vehicles/cars/coupe"),10000693:e.r(55,"/automotive and vehicles/auto repair","/automotive and vehicles/auto parts"),10000694:e.r(59,"/automotive and vehicles/cars"),10000695:e.r(59,"/automotive and vehicles/cars/sedan"),10000696:e.r(59,"/art and entertainment/books and literature/children\'s books"),10000697:e.r(59,1),10000698:e.r(55,"/careers/resume writing and advice","/careers/career advice"),10000699:e.r(59,"/careers/telecommuting"),10000700:e.r(59,"/careers/career planning"),10000701:e.r(55,"/careers/job search","/careers/job fairs"),10000702:e.r(59,29),10000703:e.r(59,"/education/distance learning"),10000704:e.r(59,"/education/special education"),10000705:e.r(55,30,0),10000706:e.r(48,"/education/homework and study tips","/education/teaching and classroom resources/lesson plans","/education/teaching and classroom resources/school supplies"),10000707:e.r(59,47),10000708:e.r(59,20),10000709:e.r(59,15),10000710:e.r(49,38,39,40,"/pets/animal welfare"),10000711:e.r(59,"/food and drink/beverages/non alcoholic beverages"),10000712:e.r(48,"/food and drink/kosher food",39,40),10000713:e.r(59,"/food and drink/cuisines"),10000714:e.r(52,"/food and drink/food/condiments and dressings","/food and drink/food/frozen food",36,"/food and drink/food/grains and pasta","/food and drink/food/herbs and spices",37,"/food and drink/food/snack foods","/food and drink/gastronomy/slow food"),10000715:e.r(59,"/health and fitness/aging"),10000716:e.r(59,45),10000717:e.r(59,"/hobbies and interests/arts and crafts"),10000718:e.r(55,"/hobbies and interests/collecting/stamps and coins","/hobbies and interests/collecting"),10000719:e.r(59,"/hobbies and interests/games/board games and puzzles"),10000720:e.r(59,"/hobbies and interests/magic and illusion"),10000721:e.r(59,"/art and entertainment/music/musical instruments"),10000722:e.r(55,53,48),10000723:e.r(55,"/technology and computing/consumer electronics/radios","/art and entertainment/radio"),10000724:e.r(55,"/art and entertainment/books and literature/science fiction","/art and entertainment/books and literature/fan fiction"),10000725:e.r(59,"/home and garden/appliances"),10000726:e.r(59,50),10000727:e.r(36,[e.tw(e.cw(0,e.pc_(0,"/art and entertainment/visual art and design/design/interior design"),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,"/art and entertainment/visual art and design/drawing"),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,"/art and entertainment/visual art and design/painting"),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,"/hobbies and interests/arts and crafts/woodworking"),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,50),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,"/home and garden/remodeling and construction"),e.ge(1)),2592e6)]),10000728:e.r(61),10000729:e.r(50,"/home and garden/bed and bath/bathroom","/home and garden/bed and bath/bedroom","/home and garden/home furnishings","/home and garden/home furnishings/lamps and lighting","/home and garden/interior decorating"),10000730:e.r(59,"/art and entertainment/movies and tv/independent"),10000731:e.r(59,9),10000732:e.r(59,"/art and entertainment/movies and tv/dramas"),10000733:e.r(59,11),10000734:e.r(56),10000735:e.r(60),10000736:e.r(60),10000737:e.r(59,"/art and entertainment/music/music genres/jazz"),10000738:e.r(59,14),10000739:e.r(59,"/art and entertainment/music/music genres/blues"),10000740:e.r(59,"/art and entertainment/music/music genres/country music"),10000741:e.r(59,"/art and entertainment/music/music genres/hip hop"),10000742:e.r(59,16),10000743:e.r(55,16,"/art and entertainment/music/music genres/electronic music"),10000744:e.r(48,14,15,19),10000745:e.r(59,"/news/local news"),10000746:e.r(59,"/news/international news"),10000747:e.r(59,"/finance/personal finance/financial planning/retirement and pension"),10000748:e.r(55,"/finance/personal finance/financial planning",33),10000749:e.r(55,69,68),10000750:e.r(59,"/pets/aquariums"),10000751:e.r(56),10000752:e.r(59,"/real estate/architects"),10000753:e.r(59,63),10000754:e.r(49,"/business and industrial/agriculture and forestry","/business and industrial/agriculture and forestry/organic farming",48,56),10000755:e.r(59,64),10000756:e.r(59,73),10000757:e.r(59,"/sports/water polo"),10000758:e.r(59,"/sports/table tennis and ping-pong"),10000759:e.r(59,"/sports/softball"),10000760:e.r(55,73,"/sports/volleyball"),10000761:e.r(59,71),10000762:e.r(59,"/sports/rowing"),10000763:e.r(59,"/sports/badminton"),10000764:e.r(59,"/sports/sailing"),10000765:e.r(48,68,69,"/sports/polo"),10000766:e.r(59,"/sports/skating/figure skating"),10000767:e.r(59,"/sports/cheerleading"),10000768:e.r(59,"/sports/auto racing"),10000769:e.r(59,"/sports/weightlifting"),10000770:e.r(59,"/sports/gymnastics"),10000771:e.r(59,"/sports/swimming"),10000772:e.r(59,"/sports/running and jogging"),10000773:e.r(55,"/sports/hockey/field hockey","/sports/hockey"),10000774:e.r(59,67),10000775:e.r(36,[e.tw(e.cw(0,e.pc_(0,"/sports/bicycling/mountain biking"),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,"/sports/canoeing and kayaking"),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,"/sports/climbing"),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,67),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,"/sports/go kart"),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,"/sports/parachuting"),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,"/sports/scuba diving"),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,"/sports/skating"),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,72),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,"/sports/skiing/waterskiing"),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,"/sports/snowboarding"),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,"/sports/surfing and bodyboarding"),e.ge(1)),2592e6)]),10000776:e.r(59,"/sports/wrestling"),10000777:e.r(55,71,70),10000778:e.r(59,"/sports/martial arts"),10000779:e.r(59,"/sports/cricket"),10000780:e.r(59,"/sports/soccer"),10000781:e.r(51,18,23,26,35,"/home and garden/luxury homes","/style and fashion/fashion designers","/style and fashion/luxury goods"),10000782:e.r(59,"/style and fashion/beauty/hair care"),10000783:e.r(48,"/style and fashion/accessories",74,"/style and fashion/jewelry"),10000784:e.r(59,75),10000785:e.r(59,"/business and industrial/automation/robotics"),10000786:e.r(59,"/science/computer science/artificial intelligence"),10000787:e.r(54,9),10000788:e.r(54,10),10000789:e.r(54,8),10000790:e.r(54,5),10000791:e.r(54,6),10000792:e.r(54,7),10000793:e.r(59,"/travel/tourist destinations/seaside resort"),10000794:e.r(59,"/travel/tourist destinations/africa"),10000795:e.r(59,"/travel/tourist facilities/camping"),10000796:e.r(59,"/travel/tourist destinations/south america"),10000797:e.r(59,"/travel/transports/road travel/road accident"),10000798:e.r(59,"/travel/tourist destinations/japan"),10000799:e.r(59,"/travel/tourist destinations/australia and new zealand"),10000800:e.r(50,"/travel/tourist destinations/eastern europe","/travel/tourist destinations/europe","/travel/tourist destinations/france","/travel/tourist destinations/greece","/travel/tourist destinations/italy"),10000801:e.r(59,"/travel/specialty travel/adventure travel"),10000802:e.r(59,"/travel/business travel"),10000803:e.r(59,"/travel/traveling with kids"),108187:e.r(32,0),116207:e.r(57,"eyeota","35478",!1,"116207"),116208:e.r(57,"eyeota","35479",!1,"116208"),116209:e.r(41,"eyeota","35480","116209","eyeota","35481",!1,"116209","eyeota","304",!1,"116209"),116687:e.q(e.acqs([e.ocqs([e.tw(e.cw(0,e.ps(1,101),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,28),e.ge(1)),2592e6)]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.dscq("Pageview",e.t,e.g(5),6)])])),117111:e.q(e.acqs([e.ocqs([e.cw(0,e.af_u(["properties","article","section_targets"],e.bsc([],["09wvZuXQ","3DUv3Gr0","D0wv9jq2","RHgZJOmG","UfG8AFVs","azFav2eD","eHhzAPGV","eohnKktr"])),e.ge(1)),e.isp("event_registrations","37",!1,"117111"),e.isp("newsletter_subscribers","3",!1,"117111"),e.isp("event_registrations","56",!1,"117111")]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.dscq("Pageview",e.t,e.g(5),6)])])),117303:e.q(e.acqs([e.tw(e.cw(0,e.ref(24),e.ge(1)),2592e6),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(299)),e.dscq("Pageview",e.t,e.g(5),6)])])),117307:e.r(1,e.tw(e.cw(0,e.o([e.ref(22),e.af_u(["properties","article","keywords"],e.o([e.s_(4,"child care"),e.s_(4,"childcare"),e.s_(4,"dad"),e.s_(4,"family"),e.s_(4,"guardian"),e.s_(4,"kids"),e.s_(4,"mom"),e.s_(4,"parents"),e.s_(4,"schools")]))]),e.ge(1)),2592e6),e.tw(e.cw(0,e.af_u(["properties","article","section_targets"],e.bsc([],["2o9JdPxT","QknLWFiz","twN70fEp"])),e.ge(1)),2592e6),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(120)),e.dscq("Pageview",e.t,e.g(5),6)])),117372:e.r(57,"eyeota","6672",!1,"117372"),117374:e.r(47,e.os(e.s,1,[101,102]),e.ge(1),0,e.af_u(["properties","article","keywords"],e.o([e.s_(4,"army"),e.s_(4,"college"),e.s_(4,"education"),e.s_(4,"indeed"),e.s_(4,"job"),e.s_(4,"monster"),e.s_(4,"university"),e.s_(4,"work"),e.s_(4,"ziprecruiter")])),e.ge(1)),117414:e.r(16,"117414",e.o([e.pc_(2,21),e.os(e.cx,0,[4,75]),e.os(e.s,3,[90,"streaming"])]),27),117418:e.r(23,300,2592e6,e.o([e.os(e.s,3,[85,"borgata","caesers",88,95,"golden nugget","resorts","showboat","tropicana"]),e.af_u(["properties","article","keywords"],e.o([e.y_(4,85),e.e_(4,"casinos"),e.e_(4,"Atlantic City"),e.y_(4,95),e.y_(4,88)]))]),e.ge(1)),117484:e.r(16,"117484",e.os(e.s,3,["museum",118,"photography","sculpture"]),30),117501:e.q(e.acqs([e.ocqs([e.tw(e.cw(0,e.pc_(0,64),e.ge(1)),2592e6),e.tw(e.cw(0,e.ps(3,"house of the week"),e.ge(1)),2592e6)]),e.ocqs([e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6),e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300))])])),118099:e.r(29,e.af_u(["properties","article","keywords"],e.o([e.s_(4,"chef"),e.s_(4,"cookbook"),e.s_(4,"cooking"),e.s_(4,"culinary"),e.s_(4,"drink"),e.s_(4,93),e.s_(4,"ingredients"),e.s_(4,"recipes")])),1,"https://www.inquirer.com/food/recipes"),118100:e.r(8,e.pe(1,"https://www.inquirer.com/entertainment/movies"),4),118208:e.r(12,e.cw(0,e.o([e.pc_(9,96),e.ps(5,96),e.ps(8,96),e.os(e.s,3,[96])]),e.ge(1)),e.ref(31),2,46),118210:e.r(11,e.cw(0,e.pc_(2,"/business/weed"),e.ge(1)),e.af_u(["properties","article","keywords"],e.o([e.s_(4,"dispensaries"),e.s_(4,"dispensary"),e.s_(4,114),e.s_(4,"vaping"),e.s_(4,"weed")])),e.os(e.s,1,["https://www.inquirer.com/business/weed",114]),e.ge(1)),118211:e.r(19,"21","118211","event_registrations","40","118211",[e.pc_(2,"/sixers"),e.ps(1,"https://www.inquirer.com/sixers"),e.af_u(["properties","article","keywords"],e.o([e.e_(4,"Embiid"),e.e_(4,"NBA"),e.e_(4,"Sixers")]))]),118212:e.r(21,"22","118212",e.pc_(2,"/flyers"),e.ps(1,"https://www.inquirer.com/flyers"),[e.e_(4,"rink"),e.e_(4,"puck"),e.e_(4,"nhl"),e.e_(4,"hockey"),e.e_(4,"Flyers")]),118215:e.r(9,e.af_u(["properties","article","section_targets"],e.bsc([],["+Qi0xaH6","A5ADFpir","I8Jw5dla","Nlgpsi8s","QTC6V9Gk","T3XoM1IE","TNgs+w/t","U9W5+1gZ","obrUE8sD","tu0tFxQD"])),"event_registrations","2",!1,"118215","event_registrations","47",!1,"118215"),118216:e.q(e.acqs([e.tw(e.cw(0,e.o([e.ps(1,"https://www.inquirer.com/sports/betting"),e.af_u(["properties","article","keywords"],e.o([e.y_(4,95),e.e_(4,"gamble"),e.e_(4,"bettor"),e.y_(4,85),e.e_(4,"draftkings"),e.e_(4,"moneyline"),e.e_(4,"Barstool"),e.e_(4,"odds"),e.e_(4,"prediction"),e.e_(4,"betmgm"),e.e_(4,"fanduel"),e.e_(4,"sportsbook")]))]),e.ge(1)),2592e6),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),118218:e.q(e.acqs([e.ocqs([e.tw(e.cw(0,e.ref(32),e.ge(1)),2592e6),e.isp("newsletter_subscribers","4",!1,"118218"),e.cw(0,e.os(e.s,3,["airlines","airport","trip"]),e.ge(1))]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),118221:e.r(1,e.ocqs([e.tw(e.cw(0,e.os(e.s,1,["https://www.inquirer.com/business","https://www.inquirer.com/live","https://www.inquirer.com/newsletters",103,"https://www.inquirer.com/politics","personal_finance"]),e.ge(1)),2592e6),e.isp("newsletter_subscribers","6",!1,"118221"),e.isp("event_registrations","10",!1,"118221"),e.isp("event_registrations","31",!1,"118221"),e.isp("event_registrations","20",!1,"118221"),e.isp("event_registrations","61",!1,"118221"),e.isp("newsletter_subscribers","17",!1,"118221")]),e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)),118222:e.r(47,e.o([e.pe(5,"espanol"),e.ps(1,"https://www.inquirer.com/espanol")]),e.ge(1),0,e.af_u(["properties","article","keywords"],e.o([e.e_(4,"bilingual"),e.e_(4,"spanish speaking"),e.e_(4,"latina"),e.e_(4,"latino"),e.e_(4,"spanish"),e.e_(4,"como"),e.e_(4,"filadelphia"),e.e_(4,"el inquirer")])),e.ge(1)),118223:e.r(18,e.isp("newsletter_subscribers","29",!1,"118223"),e.cw(0,e.o([e.ps(8,128),e.os(e.s,3,["retired",128])]),e.ge(1)),2592e6,2592e6,4,e.ps(10,92),5,1,1),118460:e.r(20,"5","118460","20","118460","10","118460","31","118460",[e.os(e.cx,12,["Poverty, Welfare and Charity","Non Profits","K-12 Education","Local Governments","Communities and Subcultures","Policy and Regulation","Sex and Gender","Rights, Discrimination and Inequality"]),e.os(e.cx,2,[28,"/health/consumer"]),e.pc_(9,80),e.pc_(0,28),e.ps(1,"https://www.inquirer.com/opinion/more-perfect-union-freedom-inequality-philadelphia-20210704.html")]),118462:e.q(e.acqs([e.ocqs([e.tw(e.cw(0,e.o([e.os(e.cx,9,["Wildest Dreams",80]),e.pc_(0,"/society/racism"),e.os(e.s,1,["https://www.inquirer.com/columnists/inq2/black-philadelphia-photojournalists-media-humanity-joy-20211216.html","https://www.inquirer.com/news/inq2/more-perfect-union-philadelphia-systemic-racism-20220209.html"])]),e.ge(1)),2592e6),e.isp("event_registrations","10",!1,"118462"),e.isp("event_registrations","5",!1,"118462"),e.isp("newsletter_subscribers","19",!1,"118462"),e.isp("newsletter_subscribers","9",!1,"118462")]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),118463:e.r(24,300,6,5,e.ref(34)),118468:e.r(20,"42","118468","51","118468","52","118468","4","118468",[e.pe(11,"Trudy Rubin"),e.y(1,103),e.os(e.cx,12,["Wars, Conflicts and Terrorism","International Relations"]),e.os(e.cx,2,["/politics/nation","/news/nation-world"])]),118470:e.r(9,e.ps(1,"https://www.inquirer.com/news/philadelphia"),"newsletter_subscribers","11",!1,"118470","newsletter_subscribers","2",!1,"118470"),118471:e.r(13,300,6,5,e.bsc_(1,["+RkW1foM","7tuc/Veh","rMcOo8fW"]),e.bsc_(8,["0DDl7Zck"]),e.ge(1)),118473:e.r(8,e.ps(1,"https://www.inquirer.com/entertainment/tv/"),12),118474:e.q(e.acqs([e.tw(e.cw(0,e.o([e.pc_(12,"Theater, Dance and Spoken Word"),e.pc_(2,21),e.pc_(0,20),e.af_u(["properties","article","keywords"],e.o([e.e_(4,"broadway"),e.e_(4,"act"),e.e_(4,"show"),e.e_(4,"shows"),e.e_(4,"plays"),e.e_(4,"play"),e.y_(4,118),e.y_(4,132),e.y_(4,133),e.e_(4,"theater"),e.e_(4,"theatre"),e.e_(4,"showtime")]))]),e.ge(1)),2592e6),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),118475:e.r(30,e.af_u(["properties","article","keywords"],e.o([e.e_(4,"artists"),e.e_(4,"artist"),e.e_(4,"performer"),e.e_(4,"performance"),e.y_(4,133),e.y_(4,132),e.e_(4,"musicians"),e.e_(4,"musician"),e.y_(4,118),e.e_(4,"music"),e.e_(4,"venue"),e.e_(4,"concert")])),"https://www.inquirer.com/entertainment/music",e.cx,0,[18,13]),118476:e.r(25,["2o9JdPxT","QknLWFiz","ZMakPip5","s+vvozHc","twN70fEp"]),118477:e.r(28,300,6,5,e.os(e.cx,0,[54,55,52]),e.os(e.s,3,["13 best dog parks, hikes, and beaches near philadelphia","dogs","pet","the best philly restaurants for dog-friendly dining","vet"]),e.os(e.s,1,["pets"])),118478:e.r(9,e.pc_(9,"Jersey Shore Guide"),"newsletter_subscribers","13",!1,"118478","event_registrations","37",!1,"118478"),118483:e.r(4,300,6,5,[e.tw(e.cw(0,e.ref(23),e.ge(1)),2592e6),e.isp("newsletter_subscribers","6",!1,"118483"),e.isp("event_registrations","31",!1,"118483"),e.isp("newsletter_subscribers","8",!1,"118483"),e.isp("event_registrations","61",!1,"118483"),e.isp("event_registrations","36",!1,"118483"),e.isp("newsletter_subscribers","1",!1,"118483")]),118485:e.r(29,e.os(e.cx,0,[44,45,43,42]),11,"Ashley Blake Greenblatt"),118487:e.q(e.acqs([e.ocqs([e.cw(0,e.ref(11),e.ge(1)),e.cw(0,e.ref(1),e.ge(1))]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),118608:e.r(24,300,5,4,e.os(e.s,3,["5 trans women in pa. on the problems facing their community | opinion","gay","lgbtq","pride","queer","transgender"])),118786:e.r(30,e.os(e.s,1,["economy","investing",112,115,"stock","wall-street"]),"https://www.inquirer.com/economy",e.s,3,["bonds","economists","finance","inflation",112,115,"mortgage","rates","stocks","wall street"]),118788:e.r(13,150,4,3,e.ref(7),e.o([e.os(e.cx,9,["World Cup","Womens Sports"]),e.pc_(0,70),e.ps(5,89),e.ps(8,89),e.os(e.s,3,["athletes",89])]),e.ge(1)),118789:e.r(19,"10","118789","newsletter_subscribers","7","118789",[e.pe(14,"sports"),e.af_u(["properties","article","keywords"],e.o([e.s_(4,91),e.s_(4,"flyers"),e.s_(4,"philadelphia union"),e.s_(4,121),e.s_(4,"sixers")]))]),118793:e.r(28,150,4,3,e.pc_(2,"/phillies"),e.ps(1,"https://www.inquirer.com/phillies"),e.af_u(["properties","article","keywords"],e.o([e.s_(4,"baseball"),e.s_(4,"bryce harper"),e.s_(4,"citizens bank park"),e.s_(4,"mlb"),e.s_(4,121),e.s_(4,"world series")]))),118794:e.r(21,"24","118794",e.os(e.w,1,["https://www.inquirer.com/eagles/gamedaycentral/2448801/","https://www.inquirer.com/sports/gameday-central"]),e.pc_(2,27),[e.s_(4,91),e.s_(4,94),e.s_(4,111),e.s_(4,113),e.s_(4,119),e.s_(4,131),e.s_(4,"training camp")]),118795:e.q(e.acqs([e.ocqs([e.tw(e.cw(0,e.o([e.pc_(2,27),e.af_u(["properties","article","keywords"],e.o([e.s_(4,91),e.s_(4,94),e.s_(4,111),e.s_(4,113),e.s_(4,"lincoln financial feild"),e.s_(4,119),e.s_(4,131)]))]),e.ge(1)),2592e6),e.isp("newsletter_subscribers","24",!1,"118795")]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(150)),e.tw(e.dscq("Pageview",e.t,e.g(3),4),2592e6)])])),118798:e.r(10,e.ps(1,"https://www.inquirer.com/food/drink"),e.pc_(0,"/food and drink/beverages")),121633:e.r(2,e.bsc_(1,["0oFS5Nhj","7v5R+DC7","GMheIxLW","IkPcWGpD","lzcckDLF","sZUG8oWh"])),121635:e.r(39,"118485","bf4f4ec8-7a7e-4dc2-9fca-4d3ad13681ec",e.ge(.9224027)),121636:e.r(39,"118210","97fd6209-4430-4a2f-a25f-e9efb73a9045",e.ge(.89510745)),121676:e.q(e.acqs([e.ocqs([e.tw(e.cw(0,e.pc_(2,"/news/pennsylvania"),e.ge(1)),2592e6),e.isp("newsletter_subscribers","11",!1,"121676")]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),121680:e.r(4,300,6,5,[e.tw(e.cw(0,e.ref(23),e.ge(1)),2592e6),e.isp("newsletter_subscribers","6",!1,"121680"),e.isp("event_registrations","31",!1,"121680"),e.isp("newsletter_subscribers","8",!1,"121680"),e.isp("event_registrations","61",!1,"121680"),e.isp("event_registrations","36",!1,"121680"),e.isp("newsletter_subscribers","1",!1,"121680"),e.cw(0,e.os(e.s,3,["democracy","democrat","republicans"]),e.ge(1))]),121681:e.r(24,300,6,5,e.pc_(2,"/soccer")),121682:e.r(37,4,e.bsc_(10,["0CIVZPwr","7SI774vS","BMZjTQNU","HEAOiX0g","HmZ9op+C","WBDrtrUk","aTl7OQ/T","hF6JazuG","sawRVrvo","tTp2Ru+x"]),4,e.bsc_(1,["oCot/Yx4"]),e.ge(1),1),121752:e.q(e.ocqs([e.isp("newsletter_subscribers","30",!1,"121752"),e.cw(0,e.y(6,81),e.ge(1))])),121753:e.r(39,"118223","523f6e32-ddc0-42d1-9359-1ba7dcd56ca3",e.ge(.8975267)),121754:e.r(39,"118487","5e2e3196-fef0-472a-a4e9-b6acd2e74a11",e.ge(.7081848)),121755:e.r(39,"121633","3766e332-191b-450b-ab63-56829f49018e",e.ge(.693524)),121757:e.r(39,"118462","708fefc0-1518-4c1f-a0c4-66038a846f62",e.ge(.69234645)),121758:e.r(39,"117501","ff18718d-dbc8-4e61-96f4-93971048ca91",e.ge(.90676486)),121759:e.r(39,"121681","581b955b-eccf-42ac-8071-c16b57818c6d",e.ge(.80789065)),121760:e.r(31,0,e.bsnc_(["isp_info","isp"],["gKqoEGRE"])),121761:e.r(7,["SxcylPIm"],"121761"),121762:e.r(7,["3/dW7+j1"],"121762"),121764:e.q(e.ocqs([e.tw(e.cw(0,e.bsc_(1,["MaxMYgW9","kSUXYZY7"]),e.ge(1)),2592e6),e.isp("event_registrations","1",!1,"121764"),e.tw(e.cw(4,e.pe(10,"https://www.inquirer.com/jobs/"),e.ge(1)),2592e6),e.itp("eyeota","6694",!1,"121764")])),121765:e.r(6,e.pc_(2,"/politics/election"),"newsletter_subscribers","8","121765"),121767:e.r(25,["6e4P7Pt1","7gOS0KNX","A4q1jNn4","AMKNoK04","VyXQeXyo","rOxTrovc","zQScEPGb"]),121769:e.r(6,e.bsc_(11,["iVmqLcnY"]),"event_registrations","37","121769"),121770:e.q(e.ocqs([e.isp("newsletter_subscribers","3",!1,"121770"),e.isp("event_registrations","56",!1,"121770")])),121771:e.r(22,"4","121771"),122487:e.r(22,"10","122487"),122555:e.r(39,"121682","13ae7715-399a-4be2-937b-2a2c097bd220",e.ge(.72331375)),123457:e.r(36,[e.tw(e.cw(0,e.af_u(["properties","article","keywords"],e.o([e.s_(4,90),e.s_(4,"eat"),e.s_(4,93),e.s_(4,"menu"),e.s_(4,"restaurant")])),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,"/food"),e.ge(1)),2592e6),e.cw(0,e.bsc_(1,["wINN1J4u"]),e.ge(1)),e.isp("event_registrations","37",!1,"123457"),e.isp("newsletter_subscribers","3",!1,"123457"),e.isp("event_registrations","56",!1,"123457"),e.tw(e.cw(0,e.o([e.pe(5,"things-to-do"),e.pc_(2,"/things-to-do"),e.pc_(9,"activities"),e.ps(1,"https://www.inquirer.com/things-to-do")]),e.ge(1)),2592e6),e.isp("newsletter_subscribers","4",!1,"123457"),e.tw(e.cw(0,e.o([e.os(e.s,3,[79,97,116,128,130]),e.af_u(["properties","article","keywords"],e.o([e.s_(4,84),e.s_(4,"aging"),e.s_(4,"hearing aid"),e.s_(4,"living"),e.s_(4,116),e.s_(4,128),e.s_(4,130)])),e.ref(15)]),e.ge(1)),2592e6),e.cw(4,e.ps(10,92),e.ge(1)),e.isp("newsletter_subscribers","29",!1,"123457")]),124811:e.r(10,e.bsc_(1,["2ALnx/Oa","LzgMkbC9","MhG/1FIY","b1/plfEO","y5M4go2f"]),e.pe(8,"small-business")),125010:e.q(e.tw(e.cw(0,e.ref(0),e.ge(1)),2592e6)),125753:e.r(2,e.o([e.pe(5,"cars"),e.pe(1,"https://www.inquirer.com/cars/used-cars-flooded-hurricane-ian-carfax-20221024.html"),e.pc_(0,22)])),128599:e.r(39,"118222","805e0e78-2c59-413f-a09d-99a1187757c0",e.ge(.3535307)),129774:e.r(57,"eyeota","35436",!1,"129774"),129775:e.r(57,"eyeota","35435",!1,"129775"),131393:e.r(57,"liveramp_Experian","1004256479",!1,"131393"),131394:e.r(58,"131394"),134001:e.q(e.ocqs([e.itp("liveramp_AnalyticsIQ","1003520069",!1,"134001"),e.itp("liveramp_AnalyticsIQ","1000689886",!1,"134001"),e.itp("liveramp_AnalyticsIQ","1003048739",!1,"134001"),e.itp("liveramp_Alliant","1000846246",!1,"134001"),e.itp("liveramp_Epsilon","1000459166",!1,"134001"),e.itp("liveramp_Stirista","1000306856",!1,"134001"),e.itp("liveramp_Acxiom","10517",!1,"134001")])),137806:e.r(39,"121676","c9931073-2e28-4a74-8380-ab74a6fb5ced",e.ge(.7242566)),137808:e.r(39,"121680","4880196b-0e80-4682-a468-097f31236a8c",e.ge(.61401653)),137809:e.r(39,"121765","a4177ebd-47b8-4c85-818f-27d84931c0e7",e.ge(.68010473)),139421:e.r(57,"liveramp_Acxiom","1823",!1,"139421"),139424:e.r(57,"liveramp_Acxiom","1958",!1,"139424"),139426:e.r(44,"liveramp_Acxiom","10803","139426","liveramp_Acxiom","10804","139426"),139427:e.r(57,"liveramp_Acxiom","1003644289",!1,"139427"),139428:e.r(57,"liveramp_Acxiom","1636",!1,"139428"),139430:e.r(57,"liveramp_Acxiom","800415401",!1,"139430"),139432:e.r(57,"liveramp_Acxiom","1004908109",!1,"139432"),139433:e.r(57,"liveramp_Acxiom","1003644379",!1,"139433"),139434:e.r(57,"liveramp_Acxiom","1923",!1,"139434"),139435:e.r(57,"liveramp_Acxiom","10871",!1,"139435"),139436:e.r(57,"liveramp_Acxiom","1004908709",!1,"139436"),139438:e.r(41,"liveramp_Acxiom","1272","139438","liveramp_Acxiom","1271",!1,"139438","liveramp_Acxiom","1270",!1,"139438"),139439:e.r(57,"liveramp_Acxiom","1003644539",!1,"139439"),139441:e.r(57,"liveramp_Acxiom","300334699",!1,"139441"),139465:e.r(57,"liveramp_Alliant","1000848906",!1,"139465"),139467:e.r(57,"liveramp_Alliant","1000849646",!1,"139467"),139468:e.r(41,"liveramp_Alliant","1004570889","139468","liveramp_Alliant","1004570899",!1,"139468","liveramp_Alliant","1004570909",!1,"139468"),139470:e.r(57,"liveramp_Alliant","1000849326",!1,"139470"),139471:e.r(42,"liveramp_Alliant","1000846236","139471","liveramp_Alliant","1000847576","139471","liveramp_Alliant","1000846226","139471","liveramp_Alliant","1000847586","139471"),139473:e.r(57,"liveramp_Alliant","1000848716",!1,"139473"),139474:e.r(57,"liveramp_Alliant","1000852016",!1,"139474"),139475:e.r(57,"liveramp_Alliant","1000846166",!1,"139475"),139477:e.r(57,"liveramp_Alliant","1000846146",!1,"139477"),139478:e.r(57,"liveramp_Alliant","1000847106",!1,"139478"),139479:e.r(57,"liveramp_Alliant","1001431729",!1,"139479"),139480:e.r(57,"liveramp_AnalyticsIQ","1005534069",!1,"139480"),139481:e.r(57,"liveramp_AnalyticsIQ","1000690996",!1,"139481"),139482:e.r(42,"liveramp_AnalyticsIQ","1000689836","139482","liveramp_AnalyticsIQ","1000689846","139482","liveramp_AnalyticsIQ","1000689856","139482","liveramp_AnalyticsIQ","1000689866","139482"),139483:e.r(57,"liveramp_AnalyticsIQ","1000691106",!1,"139483"),139484:e.r(57,"liveramp_AnalyticsIQ","1000691456",!1,"139484"),139485:e.r(45,"1000691196","139485","1000691186","139485"),139486:e.r(57,"liveramp_AnalyticsIQ","1003641699",!1,"139486"),139487:e.r(45,"1000899249","139487","1003514819","139487"),139488:e.r(57,"liveramp_AnalyticsIQ","1000691256",!1,"139488"),139489:e.r(45,"1000691616","139489","1000691606","139489"),139490:e.r(57,"liveramp_AnalyticsIQ","1000690946",!1,"139490"),139491:e.r(41,"liveramp_AnalyticsIQ","1000692946","139491","liveramp_AnalyticsIQ","1000692336",!1,"139491","liveramp_AnalyticsIQ","1000692006",!1,"139491"),139492:e.r(57,"liveramp_AnalyticsIQ","1000693506",!1,"139492"),139494:e.r(57,"liveramp_AnalyticsIQ","1003048769",!1,"139494"),139495:e.r(57,"liveramp_Comscore","1004338829",!1,"139495"),139496:e.r(57,"liveramp_Comscore","1004338389",!1,"139496"),139497:e.r(57,"liveramp_Epsilon","1003071376",!1,"139497"),139499:e.r(57,"liveramp_Epsilon","1003069936",!1,"139499"),139500:e.r(57,"liveramp_Epsilon","1000459196",!1,"139500"),139501:e.r(57,"liveramp_Epsilon","1000462976",!1,"139501"),139502:e.r(57,"liveramp_Epsilon","1005785961",!1,"139502"),139503:e.r(57,"liveramp_Epsilon","1005786021",!1,"139503"),139504:e.r(57,"liveramp_Epsilon","1001180969",!1,"139504"),139505:e.r(57,"liveramp_Epsilon","10004622161000400000",!1,"139505"),139506:e.r(57,"liveramp_Epsilon","1000462956",!1,"139506"),139507:e.r(57,"liveramp_Epsilon","1000456446",!1,"139507"),139510:e.r(57,"liveramp_Experian","1005797661",!1,"139510"),139511:e.r(58,"139511"),139512:e.r(57,"liveramp_Experian","1005797971",!1,"139512"),139513:e.r(57,"liveramp_Experian","1004256499",!1,"139513"),139514:e.r(57,"liveramp_Experian","1004256549",!1,"139514"),139515:e.r(44,"liveramp_Experian","1004256609","139515","liveramp_Experian","1004256599","139515"),139516:e.r(57,"liveramp_Experian","1003187499",!1,"139516"),139517:e.r(57,"liveramp_Experian","1004256429",!1,"139517"),139518:e.r(57,"liveramp_Experian","1004268759",!1,"139518"),139519:e.r(46,"1000306286","139519","1000306296","139519"),139520:e.r(57,"liveramp_Stirista","1000308376",!1,"139520"),139521:e.r(43,"liveramp_Stirista","1000044934","139521","1000044944","139521","liveramp_Stirista","1000044964","139521"),139522:e.r(57,"liveramp_Stirista","1003716339",!1,"139522"),139523:e.r(57,"liveramp_Stirista","1000306236",!1,"139523"),139524:e.r(57,"liveramp_Stirista","1006716101",!1,"139524"),139525:e.r(46,"1000307546","139525","1000308146","139525"),139526:e.r(57,"liveramp_Stirista","1003716309",!1,"139526"),139530:e.r(43,"liveramp_Experian","1007229091","139530","1006716011","139530","eyeota","34945","139530"),139860:e.r(39,"121770","c3b4953a-fea1-45bf-98e8-af6344eeb906",e.ge(.5548707)),141312:e.r(34,1,["0FB/QpeU","KBOG/M0y","t/anxsa6","uNCLguUn"]),141412:e.r(39,"141312","1d638647-beaf-4e8f-a1f3-168f1423c139",e.ge(.69560254)),141938:e.q(e.ocqs([e.tw(e.cw(0,e.pc_(9,"Eds & Meds"),e.ge(2)),24192e5),e.cw(0,e.bsc_(1,["AW7vU6zd","NHMG3wwZ","PI+ktZOF","QtyJmgM5","SBPRsTV2","TbuSqzha","ZQmvI8x3","bxcuZpzB"]),e.ge(2)),e.isp("newsletter_subscribers","35",!1,"141938")])),143007:e.r(35,[138425829646,138425713648,138425713480,138425298427,138425292745,138425284657,138425130611,138425130335,138425059473,138425059470,138425025992,138425005868,138424649997,138424638771,138424638078,138424638075,138424638072,138424637814,138424598999,138424593104,138424593098,138424588919,138424588280]),143008:e.r(33,["https://sponsored.inquirer.com/2024-spring-education-guide/","https://sponsored.inquirer.com/6-exciting-math-apps-for-kids-of-all-ages/","https://sponsored.inquirer.com/best-online-programs-for-home-schooling/","https://sponsored.inquirer.com/creative-kids-8-family-friendly-coloring-apps/","https://sponsored.inquirer.com/dvfriends-is-a-place-of-belonging-for-students-with-learning-differences-2/","https://sponsored.inquirer.com/explore-the-city-as-a-classroom-at-friends-select","https://sponsored.inquirer.com/fall-education-guide-2023/","https://sponsored.inquirer.com/friends-central-unveils-the-audrie-gardham-ulmer-37-center-for-innovation-and-design-in-fall-2024/","https://sponsored.inquirer.com/friends-central/","https://sponsored.inquirer.com/gladwyne-montessori-ignites-young-minds/","https://sponsored.inquirer.com/gladwyne-montessori-the-best-foundation-for-a-lifetime-of-learning","https://sponsored.inquirer.com/have-a-bright-child-who-learns-differently-benchmark-school-is-here-for-you-and-them/","https://sponsored.inquirer.com/level-up-learning-with-this-guide-to-free-online-educational-games/","https://sponsored.inquirer.com/nurturing-brilliance-gladwyne-montessoris-unique-educational-journey/","https://sponsored.inquirer.com/perelman-jewish-day-school-why-its-worth-it","https://sponsored.inquirer.com/put-the-power-of-three-to-work-for-you","https://sponsored.inquirer.com/tag/spring-education-guide-2023","https://sponsored.inquirer.com/teen-drivers-and-prom-a-date-with-safety","https://sponsored.inquirer.com/the-muhlenberg-journey-to-success-and-impact/","https://sponsored.inquirer.com/the-only-private-catholic-high-school-for-young-women-in-philadelphia-2","https://sponsored.inquirer.com/the-only-private-catholic-high-school-for-young-women-in-philadelphia-3/","https://sponsored.inquirer.com/waldron-mercy-academy-fostering-a-foundation-of-service/"]),146579:e.r(35,[138427024533,138427647196,138427024386,138426973424,138426974003,138427024806,138427650013,138426974006,138427024809]),146580:e.r(33,["https://sponsored.inquirer.com/the-penn-relay-carnival-puts-philadelphia-on-the-world-stage"]),147148:e.r(34,1,["+0e6AHKc","3Sp8RkmJ","5MU+BcyL","7erViaHp","DLgHgBnE","GV/+b4XM","JjxN5ESw","M12/tQPu","VPpyxHEu","X+BkKBu8","X3F4Df2t","aPXmUYMx","atuizJME","iLvQPMpZ","jwn4sbm6","kP6Dd40z","mkvFY/sJ","qOHoks0Q","rwjHrzFJ","tMg9LsVy"]),150867:e.q(e.acqs([e.ocqs([e.tw(e.cw(0,e.af_u(["properties","article","keywords"],e.o([e.s_(4,"adventure"),e.s_(4,"biking"),e.s_(4,"birding"),e.s_(4,"birdwatch"),e.s_(4,"campfire"),e.s_(4,"camping"),e.s_(4,"canoe"),e.s_(4,"fishing"),e.s_(4,"forest"),e.s_(4,"hiking"),e.s_(4,"hunt"),e.s_(4,"kayak"),e.s_(4,"nature"),e.s_(4,"picnic"),e.s_(4,"snowmobile"),e.s_(4,"snowmobiling"),e.s_(4,"stargazing"),e.s_(4,"tent"),e.s_(4,"trail"),e.s_(4,"wilderness"),e.s_(4,"wildlife")])),e.ge(1)),2592e6),e.tw(e.cw(0,e.af_u(["properties","classifications_watson","taxonomy_labels"],e.bsc([],["TOmpERU/","WMCop/wd","a/impr9i","c7Ph6cBT","l3nlXGSP","ljJQU9wv"])),e.ge(1)),2592e6),e.tw(e.cw(0,e.pe(3,"Outdoors Life"),e.ge(1)),2592e6),e.tw(e.cw(0,e.pe(8,"outdoors"),e.ge(1)),2592e6),e.tw(e.cw(0,e.pe(1,"https://www.inquirer.com/news/pennsylvania/inq2/nature-forest-bathing-therapy-hiking-camping-pennsylvania-20230204.html"),e.ge(1)),2592e6)]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),156584:e.r(11,e.tw(e.cw(0,e.pc_(12,82),e.ge(1)),2592e6),e.y(1,108),e.ref(17),e.ge(1)),161960:e.r(12,e.tw(e.cw(0,e.af_u(["properties","article","clavis_auxiliaries"],e.e_(["name"],"Drug addiction")),e.ge(1)),2592e6),e.pe(8,"opioid-addiction"),0,"/health and fitness/addiction"),162294:e.q(e.acqs([e.tw(e.cw(0,e.o([e.pe(1,"https://www.inquirer.com/real-estate/housing"),e.os(e.cx,0,[63,62,64])]),e.ge(1)),2592e6),e.cw(0,e.y(6,81),e.ge(1)),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),162398:e.q(e.acqs([e.ocqs([e.tw(e.cw(0,e.y(1,108),e.ge(1)),2592e6),e.tw(e.cw(0,e.ref(17),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(12,82),e.ge(1)),2592e6)]),e.cw(0,e.y(6,81),e.ge(1)),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),162399:e.r(5,e.tw(e.cw(0,e.pc_(0,64),e.ge(1)),2592e6),e.tw(e.cw(0,e.ps(3,"House of the week"),e.ge(1)),2592e6)),162402:e.r(5,e.cw(0,e.ref(11),e.ge(1)),e.cw(0,e.ref(1),e.ge(1))),164159:e.r(22,"3","164159"),164160:e.r(22,"2","164160"),164161:e.r(22,"13","164161"),164162:e.r(3,e.t,[e.isp("newsletter_subscribers","1",!1,"164162"),e.isp("newsletter_subscribers","6",!1,"164162"),e.isp("newsletter_subscribers","8",!1,"164162")]),172408:e.r(39,"117484","ad04f614-eba9-40cf-832a-53d51bbed572",e.ge(.8832585)),173349:e.r(25,["3DUv3Gr0","D0wv9jq2","FQlWFB0o","N6ezUORt","NkhC2jXf","UfG8AFVs","azFav2eD","eHhzAPGV","eohnKktr"]),176552:e.r(38,13,13),176856:e.r(40,.9215218),177227:e.r(40,.69057584),182733:e.r(32,3),182734:e.r(32,5),184136:e.r(0,e.cw(0,e.ref(0),e.ge(1)),e.tw(e.cw(0,e.af_u(["properties","classifications_watson","taxonomy_labels"],e.bsc([],["2wy+THSe","E1ZpPwqv","LNrvn5IE","MUCdpQ8r","SlZ1K4lY","iIEYCUW/","jhuMUlJW","lpzOB7jN","mlHJAWyG"])),e.ge(2)),2592e6)),184730:e.r(38,25,25),184732:e.r(37,3,e.os(e.e,7,[3452885454,3353778640,3251676851,3453954215,3290806211,3336753090,3224642593,3240421424,3337770628,3378355088,3455149619]),5,e.os(e.e,7,[3290806211,3224642593,3455149619,3337770628,3336753090,3453954215,3452885454,3378355088,3353778640,3251676851]),e.ge(1),1),184738:e.r(38,26,26),184745:e.r(38,12,12),185474:e.q(e.ocqs([e.cw(0,e.os(e.w,["geo_info","postal_code"],["19536","19511","19562","19539","18011","18343","01832","18321","18351","18332","07832","18320","18327","18302","18356","18341","18335","18301","17953","17922","17966","17920","17979","17945","17930","17946","17934","17943","17981","17935","17959","17949","17921","17972","17932","17931","17933","17936","17929","17965","17970","17923","17974","17951","17944","17954","17901","18077","18091","08886","18039","18063","08865","18040","18088","18211","18250","18053","18079","18229","18071","18012","18212","18030","18244","18235","18080","18035","19538","18065","18078","18218","18232","18246","18224","18240","18256","18248","18242","18220","18255","18251","18249","18222","18247","18245","18221","18219","18237","18231","18216","18223","18234","18239","18230","18254","18225","18202","18201","18086","18083","18044","18085","18059","18081","18042","18043","18064","18014","18045","18020","18031","18051","18067","18968","18055","18069","18037","18981","18017","18092","18036","18062","18016","18087","18068","18018","18015","18052","18032","18106","18001","18109","18003","18002","18060","18034","18046","18195","18104","18049","18099","18098","18101","18105","18102","18025","18103","19450","19438","19475","18056","19465","18070","19518","18041","18958","19468","19519","18054","18073","19457","18979","18084","19478","18957","18076","19473","19504","19503","19548","19512","19505","19492","19464","18074","19545","19472","19435","19525","18444","18407","18440","18518","18433","18414","18416","18507","18517","18471","18505","18403","18411","18504","18434","18503","18515","18577","18501","18502","18540","18510","18512","18452","18447","18509","18410","18508","18448","18519"]),e.ge(1)),e.tw(e.cw(0,e.af_u(["properties","article","keywords"],e.o([e.cl_(["tag"],"lehigh valley"),e.cl_(["tag"],"allentown")])),e.ge(2)),2592e6)])),185907:e.r(31,0,e.af_u(["properties","article","keywords"],e.o([e.e_(4,"religion"),e.e_(4,"protest"),e.e_(4,"drugs"),e.e_(4,"drug"),e.e_(4,"gun violence"),e.e_(4,"violence"),e.e_(4,"Funeral"),e.e_(4,"funeral"),e.e_(4,"fire"),e.e_(4,"elections"),e.e_(4,"election"),e.e_(4,"crimes"),e.e_(4,"crime"),e.e_(4,"courts"),e.e_(4,"court"),e.e_(4,"health system"),e.e_(4,"accident"),e.y_(4,126)]))),185937:e.r(3,e.pe(13,"Delaware"),[e.isp("newsletter_subscribers","30",!1,"185937"),e.cw(0,e.y(6,81),e.ge(1))]),185989:e.r(37,0,e.ps(3,83),0,e.pc_(9,83),e.ge(1),1),186173:e.r(23,300,2592e6,e.bsc_(1,["DtxpNxtY","OGPjScgQ","y2/Rs4hZ"]),e.ge(1)),187028:e.r(34,11,["gSQNmbAM"]),187907:e.r(34,1,["1rFu2TF4","BOJNn/gh","BhaNWvC6","E8LtAVUv","G9MZovU/","GjoIJ0Ty","LSjbTnP4","LXbXM6ZE","WvZKTDRN","o8ezbWk0","uBAgMb/U","zERIngyo"]),187912:e.r(31,0,e.ps(1,"https://www.inquirer.com/food/craig-laban/inq2/craig-laban-shore-dining-guide-2023-20230706.html")),194509:e.r(27,4,3,7),194512:e.r(17,150,4,3,7,e.af_u(["properties","article","section_targets"],e.bsc([],["0Qsr9nw9","DkHFdOEy","FQqK92qS","G5BQgvZ6","I+QibDF/","hEGQjlsz","vkMPBvTQ"]))),194711:e.r(26,300,30),194712:e.r(15,300,30,30),194714:e.r(14,5,4,e.ps(10,92)),194715:e.q(e.acqs([e.ocqs([e.tw(e.cw(0,e.ref(5),e.ge(3)),6048e5),e.tw(e.cw(4,e.ps(10,92),e.ge(3)),6048e5),e.vq(e.mxw(1,e.o([e.ref(4),e.af_u(["properties","article","named_entities"],e.o([e.s_(["type"],84),e.s_(["type"],116),e.s_(["type"],120)]))]),["properties","completion"],e.g(.5)))]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),194716:e.r(26,299,24),194717:e.r(15,299,24,24),194718:e.r(14,31,0,e.pc_(2,46)),194719:e.r(18,e.vq(e.mxw(1,e.pc_(2,46),["properties","completion"],e.g(.5))),e.vq(e.mxw(1,e.ref(31),["properties","completion"],e.g(.5))),6048e5,6048e5,0,e.pc_(2,46),31,3,3),194731:e.r(27,6,5,32),194732:e.r(17,300,6,5,32,e.ref(32)),194733:e.r(26,300,27),194734:e.r(15,300,27,27),194737:e.r(27,6,5,34),194739:e.r(27,6,5,34),194740:e.r(17,300,6,5,34,e.a([e.ref(16),e.ref(14),e.af_u(["properties","article","section_targets"],e.bsc([],["7OVyFW8c","sj5IwMZy"]))])),194741:e.r(4,300,6,5,[e.tw(e.cw(0,e.ref(23),e.ge(2)),1296e6),e.isp("event_registrations","10",!1,"194741"),e.isp("event_registrations","61",!1,"194741"),e.isp("event_registrations","42",!1,"194741"),e.isp("event_registrations","4",!1,"194741"),e.isp("event_registrations","36",!1,"194741"),e.isp("event_registrations","38",!1,"194741"),e.isp("event_registrations","50",!1,"194741"),e.isp("event_registrations","51",!1,"194741"),e.isp("event_registrations","52",!1,"194741")]),194743:e.r(4,300,6,5,[e.tw(e.cw(0,e.ref(23),e.ge(3)),6048e5),e.isp("event_registrations","10",!1,"194743"),e.isp("event_registrations","61",!1,"194743"),e.isp("event_registrations","42",!1,"194743"),e.isp("event_registrations","4",!1,"194743"),e.isp("event_registrations","36",!1,"194743"),e.isp("event_registrations","38",!1,"194743"),e.isp("event_registrations","50",!1,"194743"),e.isp("event_registrations","51",!1,"194743"),e.isp("event_registrations","52",!1,"194743"),e.vq(e.mxw(1,e.ref(29),["properties","completion"],e.g(.5))),e.vq(e.mxw(1,e.ps(1,107),["properties","completion"],e.g(.5))),e.vq(e.mxw(1,e.pc_(0,51),["properties","completion"],e.g(.5))),e.vq(e.mxw(1,e.y(5,126),["properties","completion"],e.g(.5))),e.vq(e.mxw(1,e.af_u(["properties","article","section_targets"],e.bsc([],["bpWGbywR","sx8y6U8L"])),["properties","completion"],e.g(.5)))]),200689:e.r(37,4,e.ps(10,122),0,e.o([e.ref(19),e.os(e.cx,0,["/business and industrial/green solutions","/society/social institution","/society/welfare"]),e.ps(["article","seo_keywords"],"community")]),e.ge(1),1),200690:e.q(e.cw(0,e.ref(19),e.e(0))),207225:e.q(e.ocqs([e.cw(3,e.pe(7,3578096114),e.ge(1)),e.cw(5,e.pe(7,3578096114),e.ge(1)),e.cw(0,e.bsc_(1,["uFacpNFO"]),e.ge(1))])),210682:e.r(0,e.cw(0,e.bsc_(1,["OLFty6PG"]),e.ge(1)),e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(30))),211378:e.r(31,3,e.pe(7,3578096114))}),rootCompressionLookup:e=>[(t,n)=>e.q(e.acqs([t,n])),(t,n,r)=>e.q(e.acqs([t,n,r])),t=>e.q(e.acqs([e.cw(0,t,e.ge(1)),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),(t,n)=>e.q(e.acqs([e.ocqs(n),e.cw(0,t,e.ge(1))])),(t,n,r,i)=>e.q(e.acqs([e.ocqs(i),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(t)),e.tw(e.dscq("Pageview",e.t,e.g(r),n),2592e6)])])),(t,n)=>e.q(e.acqs([e.ocqs([t,n]),e.cw(0,e.y(6,81),e.ge(1)),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),(t,n,r,i)=>e.q(e.acqs([e.ocqs([e.cw(0,t,e.ge(1)),e.isp(n,r,!1,i)]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),(t,n)=>e.q(e.acqs([e.ocqs([e.isp("newsletter_subscribers","30",!1,n),e.cw(0,e.y(6,81),e.ge(1))]),e.cw(0,e.bsc_(13,t),e.ge(1))])),(t,n)=>e.q(e.acqs([e.ocqs([e.tw(e.cw(0,t,e.ge(1)),2592e6),e.cw(0,e.pc_(0,n),e.ge(1))]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),(t,n,r,i,s,o,a,c,u)=>e.q(e.acqs([e.ocqs([e.tw(e.cw(0,t,e.ge(1)),2592e6),e.isp(n,r,i,s),e.isp(o,a,c,u)]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),(t,n)=>e.q(e.acqs([e.ocqs([e.tw(e.cw(0,t,e.ge(1)),2592e6),e.tw(e.cw(0,n,e.ge(1)),2592e6)]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),(t,n,r,i)=>e.q(e.acqs([e.ocqs([e.tw(e.cw(0,n,e.ge(1)),2592e6),e.tw(e.cw(0,r,i),2592e6),t]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),(t,n,r,i)=>e.q(e.acqs([e.ocqs([e.tw(e.cw(0,n,e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(r,i),e.ge(1)),2592e6),t]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),(t,n,r,i,s,o)=>e.q(e.acqs([e.ocqs([e.tw(e.cw(0,i,e.ge(1)),2592e6),e.cw(0,s,o)]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(t)),e.tw(e.dscq("Pageview",e.t,e.g(r),n),2592e6)])])),(t,n,r)=>e.q(e.acqs([e.ocqs([e.tw(e.cw(0,e.ref(t),e.ge(2)),1296e6),e.tw(e.cw(n,r,e.ge(2)),1296e6)]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),(t,n,r)=>e.q(e.acqs([e.ocqs([e.tw(e.cw(0,e.ref(n),e.ge(3)),6048e5),e.vq(e.mxw(1,e.ref(r),["properties","completion"],e.g(.5)))]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(t)),e.dscq("Pageview",e.t,e.g(5),6)])])),(t,n,r)=>e.q(e.acqs([e.ocqs([e.tw(e.cw(0,e.ref(r),e.ge(1)),2592e6),e.isp("newsletter_subscribers","4",!1,t),e.cw(0,n,e.ge(1))]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.dscq("Pageview",e.t,e.g(5),6)])])),(t,n,r,i,s)=>e.q(e.acqs([e.ocqs([e.tw(e.cw(0,e.ref(i),e.ge(3)),6048e5),e.vq(e.mxw(1,s,["properties","completion"],e.g(.5)))]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(t)),e.tw(e.dscq("Pageview",e.t,e.g(r),n),2592e6)])])),(t,n,r,i,s,o,a,c,u)=>e.q(e.acqs([e.ocqs([e.tw(e.cw(0,e.ref(a),e.ge(c)),r),e.tw(e.cw(s,o,e.ge(u)),i),t,n]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),(t,n,r,i,s,o)=>e.q(e.acqs([e.ocqs([e.tw(e.cw(0,e.o(o),e.ge(1)),2592e6),e.isp("newsletter_subscribers",t,!1,n),e.isp(r,i,!1,s)]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),(t,n,r,i,s,o,a,c,u)=>e.q(e.acqs([e.ocqs([e.tw(e.cw(0,e.o(u),e.ge(1)),2592e6),e.isp("event_registrations",t,!1,n),e.isp("event_registrations",r,!1,i),e.isp("event_registrations",s,!1,o),e.isp("event_registrations",a,!1,c)]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),(t,n,r,i,s)=>e.q(e.acqs([e.ocqs([e.tw(e.cw(0,e.o([r,i,e.af_u(["properties","article","keywords"],e.o(s))]),e.ge(1)),2592e6),e.isp("newsletter_subscribers",t,!1,n)]),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),(t,n)=>e.q(e.acqs([e.isp("newsletter_subscribers",t,!1,n),e.cw(0,e.t,e.ge(1))])),(t,n,r,i)=>e.q(e.acqs([e.tw(e.cw(0,r,i),n),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(t)),e.dscq("Pageview",e.t,e.g(5),6)])])),(t,n,r,i)=>e.q(e.acqs([e.tw(e.cw(0,i,e.ge(1)),2592e6),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(t)),e.tw(e.dscq("Pageview",e.t,e.g(r),n),2592e6)])])),t=>e.q(e.acqs([e.tw(e.cw(0,e.af_u(["properties","article","section_targets"],e.bsc([],t)),e.ge(1)),2592e6),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),(t,n)=>e.q(e.acqs([e.tw(e.cw(0,e.ref(n),e.ge(2)),1296e6),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(t)),e.dscq("Pageview",e.t,e.g(5),6)])])),(t,n,r)=>e.q(e.acqs([e.tw(e.cw(0,e.ref(r),e.ge(2)),1296e6),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(n),t),2592e6)])])),(t,n,r,i,s,o)=>e.q(e.acqs([e.tw(e.cw(0,e.o([i,s,o]),e.ge(1)),2592e6),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(t)),e.tw(e.dscq("Pageview",e.t,e.g(r),n),2592e6)])])),(t,n,r)=>e.q(e.acqs([e.tw(e.cw(0,e.o([e.pe(n,r),t]),e.ge(1)),2592e6),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),(t,n,r,i,s)=>e.q(e.acqs([e.tw(e.cw(0,e.o([e.pe(1,n),e.os(r,i,s),t]),e.ge(1)),2592e6),e.ocqs([e.scq(e.sw(2,e.t,["properties","aggregations","PageviewEngagement","engaged_time"]),e.vq(e.sw(1,e.t,["properties","engaged_time"])),e.g(300)),e.tw(e.dscq("Pageview",e.t,e.g(5),6),2592e6)])])),(t,n)=>e.q(e.cw(t,n,e.ge(1))),t=>e.q(e.cw(t,e.t,e.ge(1))),t=>e.q(e.cw(0,e.os(e.s,1,t),e.ge(1))),(t,n)=>e.q(e.cw(0,e.bsc_(t,n),e.ge(1))),t=>e.q(e.cw(3,e.os(e.e,15,t),e.ge(1))),t=>e.q(e.ocqs(t)),(t,n,r,i,s,o)=>e.q(e.ocqs([e.cw(r,i,s),e.cw(t,n,e.ge(o))])),(t,n)=>e.q(e.ocqs([e.cw(5,e.ref(t),e.ge(1)),e.cw(3,e.ref(n),e.ge(1))])),(t,n,r)=>e.q(e.ocqs([e.lm(n,r),e.ifp(t)])),t=>e.q(e.ocqs([e.lm("9fe48b39-77bc-452f-8793-32379ea1cac7",e.ge(t)),e.ifp("176552")])),(t,n,r,i,s,o,a,c,u,l,f)=>e.q(e.ocqs([e.itp(t,n,!1,r),e.itp(i,s,o,a),e.itp(c,u,l,f)])),(t,n,r,i,s,o,a,c,u,l,f,d)=>e.q(e.ocqs([e.itp(t,n,!1,r),e.itp(i,s,!1,o),e.itp(a,c,!1,u),e.itp(l,f,!1,d)])),(t,n,r,i,s,o,a,c)=>e.q(e.ocqs([e.itp(t,n,!1,r),e.itp("liveramp_Stirista",i,!1,s),e.itp(o,a,!1,c)])),(t,n,r,i,s,o)=>e.q(e.ocqs([e.itp(i,s,!1,o),e.itp(t,n,!1,r)])),(t,n,r,i)=>e.q(e.ocqs([e.itp("liveramp_AnalyticsIQ",r,!1,i),e.itp("liveramp_AnalyticsIQ",t,!1,n)])),(t,n,r,i)=>e.q(e.ocqs([e.itp("liveramp_Stirista",r,!1,i),e.itp("liveramp_Stirista",t,!1,n)])),(t,n,r,i,s)=>e.q(e.ocqs([e.tw(e.cw(r,i,s),2592e6),e.tw(e.cw(0,t,n),2592e6)])),(t,n,r)=>e.q(e.ocqs([e.tw(e.cw(0,e.pc_(0,t),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,n),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,r),e.ge(1)),2592e6)])),(t,n,r,i)=>e.q(e.ocqs([e.tw(e.cw(0,e.pc_(0,t),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,n),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,r),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,i),e.ge(1)),2592e6)])),(t,n,r,i,s)=>e.q(e.ocqs([e.tw(e.cw(0,e.pc_(0,t),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,n),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,r),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,i),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,s),e.ge(1)),2592e6)])),(t,n,r,i,s,o,a)=>e.q(e.ocqs([e.tw(e.cw(0,e.pc_(0,t),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,n),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,r),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,i),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,s),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,o),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,a),e.ge(1)),2592e6)])),(t,n,r,i,s,o,a,c)=>e.q(e.ocqs([e.tw(e.cw(0,e.pc_(0,t),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,n),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,r),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,i),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,s),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,o),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,a),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,c),e.ge(1)),2592e6)])),(t,n,r,i,s,o,a,c,u,l,f,d,p)=>e.q(e.ocqs([e.tw(e.cw(0,e.pc_(0,t),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,n),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,r),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,i),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,s),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,o),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,a),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,c),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,u),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,l),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,f),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,d),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,p),e.ge(1)),2592e6)])),t=>e.q(e.ocqs([e.tw(e.cw(0,e.pc_(0,t),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,76),e.ge(1)),2592e6)])),(t,n)=>e.q(e.ocqs([e.tw(e.cw(0,e.pc_(0,n),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,t),e.ge(1)),2592e6)])),()=>e.q(e.ocqs([e.tw(e.cw(0,e.pc_(0,8),e.ge(1)),2592e6),e.tw(e.cw(0,e.pc_(0,11),e.ge(1)),2592e6)])),(t,n,r,i)=>e.q(e.itp(t,n,r,i)),t=>e.q(e.itp("liveramp_Experian","1004256489",!1,t)),t=>e.q(e.tw(e.cw(0,e.pc_(0,t),e.ge(1)),2592e6)),()=>e.q(e.tw(e.cw(0,e.pc_(0,17),e.ge(1)),2592e6)),()=>e.q(e.tw(e.cw(0,e.pc_(0,49),e.ge(1)),2592e6))],stateSyncReplays:e=>[],subexpressionsLookup:e=>[e.os(e.s,1,[102,105]),e.bsc_(1,["2+Nf56KK","65iF7vEm","83gHbef7","NKY1kWXN","QaN4NnKV","XA4G0adS","YTIdC3gz","nl6Venml","nqqDLmcY","ziDXzbtU"]),e.o([e.s_(["name"],84),e.s_(["name"],116),e.s_(["name"],120)]),e.bsc([],["0OyvPflv","74oaqXNi","L3X7IVYt","O4xZhZyA","UFXv5WYf","US78lwa/","g54nTkvo"]),e.o([e.ref(20),e.ref(18)]),e.o([e.ref(4),e.ref(15)]),e.bsc([],["807joY7x","8jiLpN76","9JJlk0tz","9cUdndk3","AuMI1WKo","Hv9G7bNo","ICnEWHQu","OV2tajvI","b9OEgqkv","bCwYsueM","m84S3OlT"]),e.af_u(["properties","article","section_targets"],e.ref(8)),e.bsc([],["0Qsr9nw9","DkHFdOEy","G5BQgvZ6","I+QibDF/","SDa+jOBQ","hEGQjlsz","vkMPBvTQ"]),e.o([e.ref(22),e.ref(14)]),e.bsc([],["mCqoWR39","y1IhkK4t"]),e.os(e.s,3,[98]),e.os(e.e,7,[3394001201,3342117991,3306220973,3445971533,3342758555,3297444396]),e.os(e.e,7,[3533487819,3342758555,3254856430]),e.os(e.s,3,[77,78,99,100]),e.af_u(["properties","article","named_entities"],e.ref(2)),e.os(e.s,1,[104,106,109,110]),e.bsc_(1,["5GvlLhd4","6RIJY/H3","7ATFzeqt","B+pv6r6f","FILFxWiI","G7xLDnpw","GTOm8u2z","L75DuuuR","jkO8FrGZ","mPn3ynG8","n2D1jrSN","qWVxCGBt"]),e.af_u(["properties","article","keywords"],e.o([e.s_(4,84),e.s_(4,97),e.s_(4,116),e.s_(4,129)])),e.o([e.os(e.w,5,[122,123]),e.os(e.w,8,[122,123]),e.os(e.cx,2,[57,58])]),e.os(e.s,3,[79,116,128]),e.bsc([],["AkCyBzgU","OT8EVwPx","US78lwa/","a/rZF3e3"]),e.os(e.cx,2,[59,31]),e.o([e.ref(33),e.ref(29)]),e.af_u(["properties","classifications_watson","taxonomy_labels"],e.ref(10)),e.os(e.e,7,[3475941735,3478816520,3426275039,3319901911,3335929176]),e.os(e.e,7,[3229981840,3229981843,3229983244,3418304042,3420305505,3306498944,3451417817,3359775583,3387435563,3427287975,3350753169,3353851909,3318809491]),e.af_u(["properties","article","section_targets"],e.ref(35)),e.o([e.y(5,126),e.os(e.cx,2,[60,61]),e.pc_(0,51)]),e.af_u(["properties","article","keywords"],e.ref(36)),e.af_u(["properties","article","section_targets"],e.ref(3)),e.af_u(["properties","classifications_watson","taxonomy_labels"],e.ref(6)),e.af_u(["properties","article","section_targets"],e.ref(21)),e.o([e.ref(28),e.ps(1,107)]),e.o([e.ref(9),e.ref(16)]),e.bsc([],["O4xZhZyA","OT8EVwPx","US78lwa/"]),e.o([e.y_(4,127),e.y_(4,134),e.y_(4,117),e.y_(4,87),e.y_(4,86),e.y_(4,124),e.y_(4,125),e.y_(4,126)])]}})})));var we=__webpack_require__(878),_e=__webpack_require__(29);async function ye(f){let{contextsInitTimestampPerformance:d,master:p}=f;const g=await p.next(),h=performance.now();Object.entries(g.globals??{}).forEach((e=>{let[t,n]=e;Object.defineProperty(self,t,{value:n})}));const m=new X(g.permutiveConfig);m.measureBetween("waiting_worker_high_priority_config",d,h);const v=function(t){var n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.RP;return t.loggingEnabled&&void 0!==(null===(n=self.console)||void 0===n?void 0:n.log)?new x(r):new O}(g.permutiveConfig,g.sdkInitTimestampDate),b=g.metricsEnabled?new q(g.sdkInitTimestampPerformance,g.timeOriginMainContext,v):new U;b.trackTimeSinceInit("sdk_lifecycle_timestamps",{timestamp_name:"worker_evaluated",time_origin:"sdk_init"},d),b.trackTimeSinceInit("sdk_lifecycle_timestamps",{timestamp_name:"worker_received_high_priority_config",time_origin:"sdk_init"},h);const w=(0,n.zG)(p.next,m.traceTask("waiting_worker_low_priority_config"))();w.then((()=>b.trackTimeSinceInit("sdk_lifecycle_timestamps",{timestamp_name:"worker_received_low_priority_config",time_origin:"sdk_init"})));const _=(0,n.zG)((()=>p.read()),function(e,r){const i=e=>(0,n.zG)(e,M.Hd((e=>e in r)),(e=>{let{left:t,right:n}=e;return{buffers:n,nonBuffers:t}}));return s=>{const{buffers:o,nonBuffers:a}=i(e),[c,u]=t.Ue({...a,...(0,n.zG)(o,M.Su((e=>()=>{const t=o[e];return o[e]=r[e].empty,t})))});return(async()=>{for(;;){const e=(0,n.zG)(await s(),R.UI(i),R.ur({concat:(e,t)=>({nonBuffers:{...e.nonBuffers,...t.nonBuffers},buffers:(()=>{const n={...e.buffers};for(const e in t.buffers)n[e]=e in n?r[e].concat(n[e],t.buffers[e]):t.buffers[e];return n})()})})),t=(0,n.zG)(e.buffers,M.Su(((e,t)=>(o[e]=r[e].concat(o[e],t),()=>{const t=o[e];return o[e]=r[e].empty,t}))));u({...c.current,...e.nonBuffers,...t})}})(),(0,n.zG)(e,M.Su((e=>(0,n.zG)(c,t.UI((t=>t[e]))))))}}({contextualCohorts:i.YP,consent:g.consent,enrichmentReplacementMap:i.YP,eventSourceId:g.eventSourceId,identities:i.YP,newEvents:s.cS,pageviewState:g.pageviewState,priorCachedEventsResponses:s.cS,sessionId:g.sessionId,userId:g.userId,userIdIsNewlyGenerated:g.userIdIsNewlyGenerated,viewId:g.pageviewState.viewId,webClient:i.G(g.webClient)},{newEvents:s.uZ(),priorCachedEventsResponses:s.uZ()}),(0,o.rO)({newEvents:(0,we.F)(b,"pageview_received_by_worker")}),(e=>({...e,currentTimestampSecs:Se((0,n.zG)(g.initialTimestampSecs,i.EQ((()=>0),(e=>e-Date.now()/1e3))))}))),{eventsCachedInWorker:y,coreService:S}=await function(o,f,d,p,g,h){p.debug("SDK core started",o);const m=500,v=new I(h),b=new k(o.permutiveConfig),w=new ee(b,o.permutiveConfig,v,h,p,(()=>d.webClient.current)),_=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w.reportError(e,null==t?void 0:t.userId,null==t?void 0:t.timestamp)},y=(0,n.zG)(a.Y3((()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,414)).then((e=>e.watson))),(()=>"Failed to import watson.")),a.UI((e=>(0,n.zG)(d.webClient,t.UI(i.UI((e=>e.url))),t.D8(i.Eh(_e.Eq)),(r=>e({config:o.permutiveConfig,metrics:h,permutiveApi:v,permutiveUrls:b,pageUrl:r,trace:g,watsonEnabled:(0,n.zG)(d.pageviewState,t.UI((e=>e.watsonEnabled)))})))))),S=(0,n.zG)(V.initialise(o.permutiveConfig,p,_,g,h,d.userId,(()=>(0,n.zG)(Z.connect(new A(o.permutiveConfig),h,new D,o.organizationId,`events_${d.userId.current}`,`keys_${d.userId.current}`,"events",p,d.consent,o.isSecureContext),g.traceTask("connect_idb_events_cache")))),g.traceTask("initialise_events_cache"),a.At((()=>()=>h.trackTimeSinceInit("sdk_lifecycle_timestamps",{timestamp_name:"events_cache_initialised",time_origin:"sdk_init"},performance.now()))),a.EQ((e=>{p.error(`Worker failed to initialise IndexedDB event cache: ${e}`);const r={},[i,o]=t.gS(s.uZ()),a=()=>new Promise((e=>{const t=String(Math.random());r[t]=n=>{delete r[t],e(n)},o([[t,void 0]])}));return(0,n.zG)(d.priorCachedEventsResponses,t.UI((e=>(0,n.zG)(e(),s.UI((e=>{var t;let[n,i]=e;return null===(t=r[n])||void 0===t?void 0:t.call(r,i)})))))),{eventsCachedInWorker:!1,coreOutput:{priorCachedEventsRequests:i},coreConfig:{eventsCache:l.t$(a)}}}),(e=>({eventsCachedInWorker:!0,coreOutput:{priorCachedEventsRequests:t.a9(T.of(s.bM()))},coreConfig:{eventsCache:l.F2(e)}})))),q=(0,n.zG)(!0,a.DT(n.yR,(()=>"IndexedDB disabled.")),a.tS((()=>(0,n.zG)(G.K.initialise(new A(o.permutiveConfig),h,p,new D,`worker_${o.organizationId}`,"core_service_state","keys","core_service_state",4,o.isSecureContext),g.traceTask("initialise-core-idb")))),a.tS((e=>(0,z.Yt)(a.Hi)({persistCoreState:c(e,"core"),persistLalState:c(e,"lal")})))),U=()=>new Promise((e=>(0,n.zG)(d.consent,t.YP((t=>{t&&e()}))))),E=s=>(0,n.zG)(a.fF(q),a.YO("servicePersistence"),a.Qt("eventsCache",a.fF((()=>s))),a.Qt("coreService",(0,n.zG)(a.Y3((()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,324)).then((e=>e.service))),(e=>`Failed to import core service: ${e}`)),g.traceTask("import-core-service"))),a.Qt("lookalikeModelsService",a.Y3((()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,965)).then((e=>e.lookalikeModelsService))),(()=>"Failed to import lookalike models."))),a.Qt("optimisedActivationsConfig",a.Y3((()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,41)).then((e=>e.optimisedActivationsConfig))),(()=>"Failed to import lookalike models."))),a.Qt("watson",y),C.mU((()=>U)),a.UI((s=>{let{coreService:a,eventsCache:c,lookalikeModelsService:w,optimisedActivationsConfig:y,servicePersistence:S,watson:I}=s;const k={config:o.permutiveConfig,customQueries:be(),logger:p,metrics:h,optimisedActivationsConfig:y,permutiveApi:v,permutiveUrls:b,reportError:_,trackPageviewComplete:o.trackPageviewComplete,migratedStateMaps:(0,n.zG)(i.lo(!o.isFirstPageview),i.EQ((()=>C.of({external:i.bM(),internal:i.bM()})),(()=>T.of(f.then((e=>e.migratedStateMaps)))))),trace:g,watson:i.G(I)};return(0,n.zG)(S,l.UI((s=>{let{persistCoreState:o,persistLalState:l}=s;return(0,n.zG)(w({...k,...d}),l,r.VS((s=>{let[l,f]=s;return(0,n.zG)(d,a({...k,...c.coreConfig,lookalikeModels:i.G(f)}),(p=m,g=t.a9(!1),r=>i=>{const{value:s,state:o}=r(i),[a,c]=t.Ue(o.current),u=(0,e.UM)((()=>c(o.current)),p),l=(0,n.zG)(t.vP(o,a),t.UI((e=>{let[t,n]=e;return t===n})));return(0,n.zG)(g,t.bw((e=>e&&u()))),{value:(0,n.bc)(l,s),state:(0,n.zG)(t.vP(g,o,a),t.UI((e=>{let[t,n,r]=e;return t?n:r})))}}),u(d.consent),o,r.UI((e=>{let[r,[i,s]]=e;return{...s,stateFlushed:(0,n.zG)(t.vP(l,r,i),t.UI((e=>{let[t,n,r]=e;return t&&n&&r})))}})));var p,g})),(e=>{const{value:n}=e({stopped:t.a9(!1),previousState:{}});return e=>({value:n,state:t.a9(void 0)})}))})),l.fS((e=>(p.warn("Worker running in non-persistent mode.",e),(0,n.zG)(d,a({...k,...c.coreConfig,lookalikeModels:i.YP}),r.Hr("stateFlushed",(()=>t.a9(!0))),u(d.consent))))),r.UI((e=>({...e,...c.coreOutput}))))})));return async()=>{const e=S(),t=E(e)(),{eventsCachedInWorker:n}=await e;return{eventsCachedInWorker:n,coreService:t}}}(g,w,_,v,m,b)();p.send({eventsCachedInWorker:y});const E=await S;var P,F;if(l.nM(E))return v.error(`Failed to start worker: ${E.left}`),void(null===(P=(F=self).close)||void 0===P||P.call(F));const Q=E.right,L=await w,N=(await Q)({stopped:t.a9(!1),previousState:L.previousState}),[Y,$]=t.Ue(b.getNoMetricsTracked());(0,e.UM)((()=>$(b.getNoMetricsTracked())),100),function(e,r,s){const o=(0,n.zG)(t.vP(r),t.UI((0,n.ls)(M.UI((e=>"function"==typeof e?e:T.of(e))),(0,z.Yt)(T.G5))));let a=o.current();e(a),(0,n.zG)(o,t.YP((t=>{const r=t(),o=(0,n.zG)(r,M.z7(((e,t)=>{var n;return t!==a[e]&&(null===(n=s[e])||void 0===n||!n.isEmpty(t))})),i.DT((0,j.ff)(M.xb)));i.pC(o)&&(a={...a,...o.value},e(o.value))})))}(p.send,{activations:t.vP(N.value.activations),cohorts:t.vP(N.value.cohorts),context:N.value.context,eventsToPublish:N.value.eventsToPublish,eventsToPublishOnPageUnload:N.value.eventsToPublishOnPageUnload,externalData:N.value.externalData,geoIP:N.value.geoIP,metrics:(0,n.zG)(Y,t.UI((()=>()=>b.consume()))),priorCachedEventsRequests:N.value.priorCachedEventsRequests,realtime:N.value.realtime,state:N.state,transitionsSinceInit:N.value.transitionsSinceInit,workerStateFlushed:N.value.stateFlushed,stateMigratedThisInitialisation:N.value.stateMigratedThisInitialisation,secureSignal:N.value.secureSignal},{eventsToPublish:{isEmpty:s.xb},metrics:{isEmpty:s.xb}})}function Se(n){const r=()=>Math.floor(Date.now()/1e3)+n,[i,s]=t.Ue(r());return(0,e.UM)((()=>s(r())),1e3),i}const Ie=t=>{const n=[],r=[],i=()=>{for(;n.length>0&&r.length>0;)r.shift()()},s=t=>new Promise((n=>{r.push((()=>n(t()))),(0,e.HJ)(i)}));return t.addEventListener("message",(0,e.GL)((t=>{null!==t.data&&(n.push(t.data),(0,e.HJ)(i))}))),{next:()=>s((()=>n.shift())),read:()=>s((()=>n.splice(0)))}};!async function(){const t=self;ye({contextsInitTimestampPerformance:e.NC,master:{...Ie(t),send:e=>t.postMessage(e)}})}()})()})();',"Worker",void 0,void 0)}},1005:e=>{e.exports=function(e,t,n,r){var i=self||window;try{try{var s;try{s=new i.Blob([e])}catch(t){(s=new(i.BlobBuilder||i.WebKitBlobBuilder||i.MozBlobBuilder||i.MSBlobBuilder)).append(e),s=s.getBlob()}var o=i.URL||i.webkitURL,a=o.createObjectURL(s),c=new i[t](a,n);return o.revokeObjectURL(a),c}catch(r){return new i[t]("data:application/javascript,".concat(encodeURIComponent(e)),n)}}catch(e){if(!r)throw Error("Inline worker is not supported");return new i[t](r,n)}}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={},_framework_compute_time_measurement__WEBPACK_IMPORTED_MODULE_0__;_framework_compute_time_measurement__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3812),(()=>{var e,t;(0,_framework_compute_time_measurement__WEBPACK_IMPORTED_MODULE_0__.ho)(!0);const n="permutive.main.import_runWebSdk",r=`${n}_start`;null===(e=performance)||void 0===e||null===(t=e.mark)||void 0===t||t.call(e,r),(0,_framework_compute_time_measurement__WEBPACK_IMPORTED_MODULE_0__.SF)((()=>Promise.resolve().then(__webpack_require__.bind(__webpack_require__,4749))))().then((e=>{var t,i;null===(t=performance)||void 0===t||null===(i=t.measure)||void 0===i||i.call(t,n,r),e.runSdk({contextsInitTimestampPerformance:_framework_compute_time_measurement__WEBPACK_IMPORTED_MODULE_0__.NC,contextsInitTimestamp:_framework_compute_time_measurement__WEBPACK_IMPORTED_MODULE_0__.RP})})).catch(console.error)})()})();