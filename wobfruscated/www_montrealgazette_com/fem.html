<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>fem.html</title>
</head>
<body>
<script>!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("FrontEndModules",[],t):"object"==typeof exports?exports.FrontEndModules=t():e.FrontEndModules=t()}(window,(function(){return function(e){function t(t){for(var r,n,o=t[0],a=t[1],s=0,l=[];s<o.length;s++)n=o[s],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&l.push(i[n][0]),i[n]=0;for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r]);for(c&&c(t);l.length;)l.shift()()}var r={},i={0:0};function n(t){if(r[t])return r[t].exports;var i=r[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.e=function(e){var t=[],r=i[e];if(0!==r)if(r)t.push(r[2]);else{var o=new Promise((function(t,n){r=i[e]=[t,n]}));t.push(r[2]=o);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.src=function(e){return n.p+"chunks/"+{2:"c3ab324c1607ea2900c3",3:"42a9bec55ea7a9cc8d09",4:"6bd63a8d665922db35b3",5:"b28de55a92e7fe71c16b",6:"427d1384298c779681c4",7:"560e6765c71e27c70d8d"}[e]+".js"}(e);var c=new Error;a=function(t){s.onerror=s.onload=null,clearTimeout(l);var r=i[e];if(0!==r){if(r){var n=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+n+": "+o+")",c.name="ChunkLoadError",c.type=n,c.request=o,r[1](c)}i[e]=void 0}};var l=setTimeout((function(){a({type:"timeout",target:s})}),12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(t)},n.m=e,n.c=r,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://fem.gprod.postmedia.digital/v115.0/",n.oe=function(e){throw console.error(e),e};var o=window.webpackJsonpFrontEndModules=window.webpackJsonpFrontEndModules||[],a=o.push.bind(o);o.push=t,o=o.slice();for(var s=0;s<o.length;s++)t(o[s]);var c=a;return n(n.s=45)}([function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return n})),r.d(t,"b",(function(){return a})),r.d(t,"e",(function(){return s})),r.d(t,"d",(function(){return c}));var i={PAGE_LOAD:"page-load"},n=()=>{var e=new URL(String(window.location.href)).searchParams;return e.has("debug")&&"logging"===e.get("debug")},o=()=>["%c[".concat((Date.now()-performance.timeOrigin).toFixed(),"ms]"),"background-color:".concat("#001c3d","; color: ").concat("#FFFFFF")],a=function(e){if(n()){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];for(var a of r)"object"==typeof a&&Object.keys(a).length<=10||"Array"===a.constructor&&a.length<=10?console.table(a):console[e](...o(),a)}},s=e=>{n()&&(console.log(...o(),"Starting new timer with label: ".concat(e)),console.time(e))},c=e=>{n()&&console.timeLog(e)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return n})),r.d(t,"b",(function(){return o}));!!window.MSInputMethodContext&&document.documentMode;var i=function(e){return e.CHANGE="change",e.click="click",e.domContentLoaded="DOMContentLoaded",e.load="load",e.message="message",e.scroll="scroll",e.SUBMIT="submit",e.VISIBILITY="visibilitychange",e.CUSTOM_EVENT="custom-event",e.USER_ATTRIBUTE_CHANGE="user-attribute-change",e.BEFORE_UNLOAD="beforeunload",e.PAGE_HIDE="pagehide",e.FOCUS_IN="focusin",e.PIANO_METER_EVENT="pianometer",e}({}),n=function(e){return e.MOBILE="mobile",e.TABLET="tablet",e.DESKTOP="desktop",e}({}),o={mobileCutoff:768,tabledCutoff:1024,attrs:{background:"background",class:"class",height:"height",hidden:"hidden",id:"id",src:"src",style:"style"},ready:new Promise(e=>"loading"===document.readyState?document.addEventListener(i.domContentLoaded,()=>e()):e()),tagNames:{iFrame:"iframe",script:"script"},addStyles(e){var t=document.createElement("style");return t.innerText=e,document.head.appendChild(t),t},nodes:e=>Array.prototype.slice.call(e instanceof Element?[e]:e),setVis(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.nodes(e).forEach(e=>{var r=(e.getAttribute(o.attrs.style)||"").replace(/;?display:[^;]+/,"");e.setAttribute(o.attrs.style,"".concat(r).concat(t?"":";display:none")),t?e.removeAttribute(o.attrs.hidden):e.setAttribute(o.attrs.hidden,"")})},addClass(e,t){e&&e.classList.add(t)},removeClass(e,t){e&&e.classList.remove(t)},checkClass:(e,t)=>e.classList.contains(t),replaceClass(e,t,r){o.addClass(e,r),o.removeClass(e,t)},swapClass(e,t,r){o.checkClass(e,t)?(o.removeClass(e,t),o.addClass(e,r)):o.checkClass(e,r)&&(o.removeClass(e,r),o.addClass(e,t))},updateTabs(e,t){this.nodes(e).forEach(e=>{t?t>=0?this.setTabIndex(e,t):this.hideTabIndex(e):this.removeTabIndex(e)})},setTabIndex(e,t){e.setAttribute("tabindex",t)},hideTabIndex(e){this.setTabIndex(e,"-1")},idElementExists:e=>null!==document.querySelector("#".concat(e)),removeTabIndex(e){e.removeAttribute("tabindex")},style(e,t,r){this.nodes(e).forEach(e=>{var i=this.getStylesObj(e);r?i[t]=r:delete i[t],this.setStylesObj(e,i)})},getStylesObj(e){var t={};return e.hasAttribute(o.attrs.style)&&e.getAttribute(o.attrs.style).split(";").map(e=>e.split(":").map(e=>e.trim())).forEach(e=>{var[r,i]=e;return r&&i&&(t[r]=i)}),t},setStylesObj(e,t){e.setAttribute(o.attrs.style,Object.entries(t).map(e=>{var[t,r]=e;return"".concat(t,":").concat(r)}).join(";"))},removeStyleParam(e,t){var r=this.getStylesObj(e);delete r[t],this.setStylesObj(e,r)},replaceStyleValues(e,t,r){var i=this.getStylesObj(e),n="".concat(t),o=new RegExp(n,"g");for(var a of Object.keys(i))i[a]=i[a].replace(o,r);this.setStylesObj(e,i)},groupKeyValues(e){var t=[];return e.forEach(e=>{t.includes(e)||t.push(e)}),t},loadScript(e,t,r,i){var n=document.createElement(o.tagNames.script);return n.setAttribute("async",""),n.src=e.replace(/^(?:https?:)?(.+)$/,"".concat(location.protocol,"$1")),t&&t.forEach(e=>{n.setAttribute(e.key,e.value)}),r&&(n.onerror=r),i&&(n.onload=i),document.head.appendChild(n),n},isTablet(){var e=r(41);return!e()&&e({tablet:!0})||window.innerWidth<this.tabledCutoff},isMobile(){return r(41)()||window.innerWidth<this.mobileCutoff},deviceType(){return this.isMobile()?n.MOBILE:this.isTablet()?n.TABLET:n.DESKTOP},browserType(){try{return/bot|crawler|spider|crawling/i.test(navigator.userAgent)?"Crawler":-1!==navigator.userAgent.indexOf("Edg")||window.StyleMedia?"Edge":window.chrome&&(window.chrome.webstore||window.chrome.runtime)||window.chrome&&/google/i.test(navigator.vendor)||navigator.userAgent.match("CriOS")?"Chrome":/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||void 0!==window.safari&&window.safari.pushNotification).toString()?"Safari":!/apple/i.test(navigator.vendor)||/crios/i.test(navigator.userAgent)||/fxios/i.test(navigator.userAgent)?void 0!==window.InstallTrigger?"FireFox":window.opr&&window.opr.addons||window.opera||navigator.userAgent.indexOf(" OPR/")>=0?"Opera":document.documentMode?"IE":"unknown":"Safari"}catch(e){return"unknown"}},browserLanguage(){try{return navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage}catch(e){return"unknown"}},getMetaContent:e=>document.querySelector("meta[name='".concat(e,"']")).getAttribute("content"),getRelUrl:e=>document.querySelector("link[rel='".concat(e,"']")).getAttribute("href"),disableTabs(e){try{var t=document.querySelectorAll(e);return o.updateTabs(t,-1),t}catch(e){return}},enableTabs(e){try{var t=document.querySelectorAll(e);return o.updateTabs(t),t}catch(e){return}},removeFromUrl(e,t){var r=new URL(t);return r.searchParams.delete(e),r.toString()}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var i=function(e){return e.ID="x-id",e.OPT_OUT_POL="political-ad-opt-out",e.PPID="ppid",e.LR_TOKEN_KEY="LRTokenKey",e.JWT="lr_jwt",e.REDIRECT_URL="redirect_url",e.MOBILE_REDIRECT_URI="redirect_uri",e.PIANO_PARAMS="piano_params",e.VF_ACCESS="vfAccess",e.VF_REFRESH="vfRefresh",e.VF_COMMENT_TEXT="vfCommentText",e.LR_USER_UID="lr-user-uid",e.LR_USER="LoginRadiusUser",e.GNS_USER_STATE="gnsUserState",e.GNS_REDIRECT_URL="gnsRedirectUrl",e.ACTIVATE_BUTTON="activateButton",e.VIEWED_ARTICLES="viewedArticles",e.SAVED_RECOMMENDATION_CATEGORIES="savedRecommendationCategories",e.USER_WANTS="user_wants",e.CAMPAIGN="campaign",e.CAMPAIGN_NAME="campaignName",e.OFFER_GROUP="offergroup",e.PASSWORDLESS_EMAIL_ADDRESS="passwordlessEmailAddress",e.COMMENT_METER="_pc_comment_meter",e.SOPHI_AB_TEST="_pc_sophi_ab_test",e.SOPHI_AB_TEST_NAME="_pc_sophi_ab_test_name",e.SOPHI_LOADED="sophiLoaded",e.EMAIL_ONLY_REGISTRATION_EVENT_SENT="emailOnlyRegistrationEventSent",e}({})},function(e,t,r){"use strict";r.d(t,"b",(function(){return w})),r.d(t,"a",(function(){return E}));var i=r(5),n=r(0),o=r(1),a=r(2),s=r(9),c=r(7),l=r(4);function d(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}var u=r(16);function m(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function p(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){m(o,i,n,a,s,"next",e)}function s(e){m(o,i,n,a,s,"throw",e)}a(void 0)}))}}class f{constructor(e,t,r,i){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";this.apiKey=e,this.jwtApp=t,this.accessToken=r,this.appName=i,this.objectName=n}getProfile(){var e=this;return p((function*(){var t=yield fetch("https://api.loginradius.com/identity/v2/auth/account?apiKey=".concat(e.apiKey),{headers:{Authorization:"Bearer ".concat(e.accessToken),"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},method:"GET"}),r=yield t.json();if(r.ErrorCode)throw new Error(r.Description);return r}))()}getJwtToken(){var e=this;return p((function*(){var t=yield fetch("https://".concat(e.appName,".hub.loginradius.com/api/jwt/").concat(e.jwtApp,"/token/?apiKey=").concat(e.apiKey,"&access_token=").concat(e.accessToken),{headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},method:"GET"}),r=yield t.json();if(r.ErrorCode)throw new Error(r.Description);return r.signature}))()}validateAccessToken(){var e=this;return p((function*(){var t=yield fetch("https://api.loginradius.com/identity/v2/auth/access_token/Validate?apiKey=".concat(e.apiKey),{headers:{Authorization:"Bearer ".concat(e.accessToken),"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},method:"GET"});return!!(yield t.json()).access_token}))()}invalidateAccessToken(){var e=this;return p((function*(){yield fetch("https://api.loginradius.com/identity/v2/auth/access_token/inValidate?apiKey=".concat(e.apiKey),{headers:{Authorization:"Bearer ".concat(e.accessToken),"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},method:"GET"})}))()}updateProfileByToken(e){var t=this;return p((function*(){var r=yield fetch("https://api.loginradius.com/identity/v2/auth/account?apiKey=".concat(t.apiKey),{body:JSON.stringify(e),headers:{Authorization:"Bearer ".concat(t.accessToken),"Content-Type":"application/json"},method:"PUT"}),i=yield r.json();if(!i.IsPosted)throw Object(n.b)("error","Profile update error",i.Description),new Error(i.Description);return i}))()}partialUpdateCustomObjectByToken(e){var t=this;return p((function*(){var r=yield t.getCustomObjectByToken();if(void 0===r){var i=yield fetch("https://api.loginradius.com/identity/v2/auth/customobject?apiKey=".concat(t.apiKey,"&objectname=").concat(t.objectName),{body:JSON.stringify(e),headers:{Authorization:"Bearer ".concat(t.accessToken),"Content-Type":"application/json"},method:"POST"}),n=yield i.json();if(n.ErrorCode)throw new Error(n.Description);return n}var o=yield fetch("https://api.loginradius.com/identity/v2/auth/customobject/".concat(r.Id,"?apiKey=").concat(t.apiKey,"&objectname=").concat(t.objectName,"&updatetype=partialreplace"),{body:JSON.stringify(e),headers:{Authorization:"Bearer ".concat(t.accessToken),"Content-Type":"application/json"},method:"PUT"}),a=yield o.json();if(a.ErrorCode)throw new Error(a.Description);return a}))()}getCustomObjectByToken(){var e=this;return p((function*(){var t=yield fetch("https://api.loginradius.com/identity/v2/auth/customobject?apiKey=".concat(e.apiKey,"&objectname=").concat(e.objectName),{headers:{Authorization:"Bearer ".concat(e.accessToken),"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},method:"GET"}),r=yield t.json();if(1057!==r.ErrorCode){if(r.ErrorCode)throw new Error(r.Description);var i=r.data,n=i.filter(e=>!1===(e.IsDeleted||!1)&&!0===(void 0===e.IsActive||e.IsActive));if(n.sort((e,t)=>e.DateCreated>t.DateCreated?1:-1),0!==n.length)return i[i.length-1]}}))()}}function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function v(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function b(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){v(o,i,n,a,s,"next",e)}function s(e){v(o,i,n,a,s,"throw",e)}a(void 0)}))}}function y(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var w=function(e){return e.REDIRECT="Redirect",e.SUBSCRIBE="Subscribe",e.SHOW_CHECKOUT="Show Checkout",e.SHOW_NEWSLETTER_OPT_IN="Show Newsletter Opt-In",e.SHOW_SUCCESS_SCREEN="Show Success Screen",e}({});class E{static getLRApiClient(e,t){return new f(e.apiKey,e.integrationName,t,e.appName,e.objectName)}static setMobileRedirectUrl(){if(sessionStorage){var e=E.getParamFromQueryString(E.mobileRedirectParamName);E.isMobileRedirect(e)&&sessionStorage.setItem(a.a.MOBILE_REDIRECT_URI,e)}}static setRedirectUrl(e){sessionStorage&&sessionStorage.setItem(a.a.REDIRECT_URL,e)}static isMobileRedirect(e){return e&&E.allowedMobileRedirects.some(t=>e.startsWith(t))}static getMobileRedirectUrl(){var e;if(sessionStorage){var t=sessionStorage.getItem(a.a.MOBILE_REDIRECT_URI);E.isMobileRedirect(t)&&(e=t)}return e}static getDesktopRedirectUrl(){var e;return sessionStorage&&(e=sessionStorage.getItem(a.a.REDIRECT_URL)),e}static getRedirectUrl(e,t){var r=E.getRedirectURLFromLocation()||E.getMobileRedirectUrl()||E.getDesktopRedirectUrl()||e;if(r){r.match(/^[a-zA-Z0-9-\.]+:\/\//)||(r="".concat(window.location.protocol,"//").concat(r));var i=new URL(r).hostname,o=E.isMobileRedirect(r);if(o||window.location.hostname===i){if(o&&t)try{r=E.addMobileRedirectTokenToUrl(r,t)}catch(e){Object(n.b)("error","Error adding token to the mobile redirect link.",e)}}else r=window.location.origin}return r}static buildRedirectUrl(e){return E.getMobileRedirectUrl()||E.getDesktopRedirectUrl()||e}static getSSORedirectURL(e,t){var r=new URL(u.b.ssoRedirectLink),i=t||location.origin;return r.searchParams.append("token",e),r.searchParams.append("callback",i),r.toString()}static handleLogin(e){window.tp=window.tp||[];var t=e.jwttoken;localStorage.setItem(a.a.JWT,t),t&&window.tp.push(["init",()=>{window.tp.push(["setExternalJWT",t])}])}static setSailthruCookie(e){return b((function*(){try{yield class{constructor(){}static setCookie(e){return(t=function*(){return new Promise((t,r)=>{window.Sailthru?window.Sailthru.integration("userSignUp",{email:e,lists:{},onError:e=>{Object(n.b)("error","Sailthru cookie set failed",e),r()},onSuccess:()=>{Object(n.b)("info","Sailthru cookie set successfully"),t()}}):(Object(n.b)("error","Sailthru is not available. Can't set the cookie."),r())})},function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function a(e){d(o,i,n,a,s,"next",e)}function s(e){d(o,i,n,a,s,"throw",e)}a(void 0)}))})();var t}}.setCookie(e)}catch(e){Object(n.b)("error",e)}}))()}static isRegistration(e){return 1===e.NoOfLogins}static getNewsletterRedirectURL(e){return"".concat(e,"/newsletter-opt-in/")}static getRegistrationSuccessURL(e){return"".concat(e,"/registration-success/")}static getPianoParams(){return window.sessionStorage?sessionStorage.getItem(a.a.PIANO_PARAMS):void 0}static showCheckoutModal(e){window.tp.push(["init",()=>{window.tp.offer.startCheckout(JSON.parse(e))}])}static isActivation(){return!(!window.sessionStorage||!sessionStorage.getItem(a.a.ACTIVATE_BUTTON))&&(sessionStorage.removeItem(a.a.ACTIVATE_BUTTON),!0)}static isSubscription(){return!(!window.sessionStorage||"subscribe"!==sessionStorage.getItem(a.a.USER_WANTS))&&(sessionStorage.removeItem(a.a.USER_WANTS),!0)}static isCheckout(){return!!E.getPianoParams()}static isHomeDelivery(e){return e.includes("/home-delivery/")}static getPostRegistrationStep(e,t){var r=E.isActivation(),i=E.isHomeDelivery(e),n=E.isSubscription(),o=E.isCheckout(),a=E.isMobileRedirect(e),s=w.SHOW_SUCCESS_SCREEN;return e&&(r||i||a&&!n?s=w.REDIRECT:n?s=o?w.SHOW_CHECKOUT:w.SUBSCRIBE:t&&(s=w.SHOW_NEWSLETTER_OPT_IN)),s}static handleLoginSuccess(e){var t=arguments,r=this;return b((function*(){var o=t.length>1&&void 0!==t[1]&&t[1],c=t.length>2&&void 0!==t[2]&&t[2],d=e.access_token,u=e.Data||e.Profile;E.handleLogin(e);var m,p=E.getRedirectUrl("",d),g=E.createProfile(u),v=!1,y=e=>{Object(n.b)("info","waiting for mParticle to send login event"),window.setTimeout(()=>{Object(n.b)("info","finalizing login"),window.location.replace(E.getSSORedirectURL(d,p))},e)},S=function(){var t=b((function*(t){if(clearTimeout(m),!v){v=!0,yield E.setSailthruCookie(g.email);var r=e.Profile.RegistrationProvider;"live"===r&&(r="microsoft");var i=E.getPianoParams();if(!E.isRegistration(e.Profile)&&E.isActivation())return s.a.get(a.a.ID).printSubscriber&&(p="".concat(window.location.origin,"/already-activated/")),void y(t);if(E.isRegistration(e.Profile)){var o;if(!(null===(o=e.Profile)||void 0===o||null===(o=o.CustomFields)||void 0===o?void 0:o.register_platform)){var l,d,u,h=localStorage.getItem(a.a.LR_TOKEN_KEY),b=JSON.parse((null===(l=document.querySelector("#page-data"))||void 0===l?void 0:l.innerHTML)||"{}"),S=(null==b||null===(d=b.identity)||void 0===d||null===(d=d.sso)||void 0===d||null===(d=d.loginradius)||void 0===d?void 0:d.apiKey)||"",O=E.getMobileRedirectUrl()?"Unified":null==b||null===(u=b.analytics)||void 0===u?void 0:u.platform,_=new f(S,void 0,h,void 0);try{yield _.updateProfileByToken({CustomFields:{register_platform:O}})}catch(e){Object(n.b)("error","Registered Platform details couldn't update in profile.",e)}}if(E.sendRegistrationAnalytics(r||"traditionalRegister"),E.getPostRegistrationStep(p,c)===w.SHOW_NEWSLETTER_OPT_IN)return p=E.getNewsletterRedirectURL(location.origin),void y(t)}else E.sendLoginAnalytics(r||"traditionalSignin");i?E.showCheckoutModal(i):y(t)}}));return function(e){return t.apply(this,arguments)}}(),O=()=>{document.dispatchEvent(i.c.event(l.a.IDENTITY_CHANGE,h(h({},g),{},{isLogin:!0}))),document.addEventListener(l.a.IDENTITY_PROFILE_UPDATED,()=>{document.dispatchEvent(new CustomEvent(l.a.IDENTITY_LOGIN,{detail:{email:g.email,uuid:g.uuid}}))})};!o||r.isAppleRegistration()?(document.addEventListener(l.a.MP_LOGIN_FINISHED,b((function*(){yield S(600)}))),O()):(document.addEventListener(l.a.MP_LOGIN_FINISHED,b((function*(){yield S(600)}))),document.addEventListener(l.a.MP_LISTENS,()=>{document.removeEventListener(l.a.MP_LISTENS,O),O()}));m=window.setTimeout(b((function*(){yield S(600)})),5e3)}))()}static clearErrors(){var e=document.querySelector(".".concat(u.b.DOM.class.errorMessageContainer));e&&e.remove(),document.querySelectorAll(".".concat(u.b.DOM.class.inputWrapperError)).forEach(e=>{var t=e.querySelector("input"),r=e.querySelector(".".concat(u.b.DOM.class.inputErrorMessage));o.b.removeClass(e,"".concat(u.b.DOM.class.inputWrapperError)),t&&(t.removeAttribute("aria-describedby"),t.removeAttribute("aria-invalid")),r&&r.remove()})}static showErrors(e){if(Array.isArray(e))if(!(!e.length||!e[0].ErrorCode)){var t=document.createElement("div"),r=document.createElement("ul");o.b.addClass(r,"errorlist");var i=document.querySelector(".".concat(u.b.DOM.class.identityForm));t.setAttribute("role","alert"),t.className=u.b.DOM.class.errorMessageContainer;var n=e[0],a=document.createElement("li");if(n.Description){if(n.ErrorCode===u.a.VERIFY_EMAIL_FIRST){var s=document.createElement("span"),c=document.createElement("a");c.className="identity-verify-email",c.href="/verify-email/",c.innerText="Resend Verify Email?",c.onclick=()=>{E.sendClickEvent(c.innerText,"link","social-sign-in",c.href)},s.innerHTML="".concat(n.Description," "),s.appendChild(c),a.appendChild(s)}else a.innerHTML=n.Description;r.appendChild(a)}i&&(t.appendChild(r),i.after(t),this.scrollToContentBlocker())}else{e.map(e=>{if(e.Id&&e.Message){var t=document.querySelector("#".concat(e.Id)),r=document.createElement("span"),i=document.createElement("ul"),n=document.createElement("li"),a="".concat(e.Id,"__error"),s=t.getAttribute("aria-describedBy");s||(s="".concat(a)),t.setAttribute("aria-describedBy",s),t.setAttribute("aria-invalid","true"),r.id=a,n.innerHTML=e.Message,o.b.addClass(r,u.b.DOM.class.inputErrorMessage),o.b.addClass(i,"errorlist");var c=t.parentElement;o.b.addClass(c,u.b.DOM.class.inputWrapperError),i.appendChild(n),r.appendChild(i),c.appendChild(r)}});var l=document.querySelector(".".concat(u.b.DOM.class.inputWrapperError," input"));l&&l.focus()}}static scrollToContentBlocker(){var e=document.querySelector(".".concat(u.b.DOM.id.contentBlocker));e&&(e.scrollIntoView({block:"nearest"}),new MutationObserver(t=>{e.classList.contains("hidden")||e.scrollIntoView({block:"nearest"})}).observe(e,{attributes:!0,attributeFilter:["class"]}))}static setRedirectLink(e){var t,r=document.querySelector(".button__back-to-site");if(sessionStorage)if(e){var i=E.getRedirectUrl(window.location.origin,e);t=E.getSSORedirectURL(e,i)}else t=E.getRedirectUrl("");r&&t&&(r.href=t)}static removeAccessTokenFromUrl(){history.replaceState(history.state,"",o.b.removeFromUrl("lr-token",location.href))}static sendLoginAnalytics(e){document.dispatchEvent(new CustomEvent(o.a.CUSTOM_EVENT,{detail:{control_fields:{mparticle:{keys:{integration_name:"integration_name",sign_in_method:"sign_in_method"},mp_event_type:"UserContent"}},event_name:c.a.customEventNames.signin,integration_name:"LoginRadius",sign_in_method:e}}))}static sendRegistrationAnalytics(e){document.dispatchEvent(new CustomEvent(o.a.CUSTOM_EVENT,{detail:{control_fields:{mparticle:{keys:{integration_name:"integration_name",registration_method:"registration_method"},mp_event_type:"UserContent"}},event_name:c.a.customEventNames.registration,integration_name:"LoginRadius",registration_method:e}}))}static sendLogoutAnalytics(){document.dispatchEvent(new CustomEvent(o.a.CUSTOM_EVENT,{detail:{control_fields:{mparticle:{keys:{integration_name:"integration_name"},mp_event_type:"UserContent"}},event_name:c.a.customEventNames.signout,integration_name:"LoginRadius"}}))}static sendSubmissionErrorAnalytics(e,t){Array.isArray(e)&&e.length&&(e[0].ErrorCode?document.dispatchEvent(new CustomEvent(o.a.CUSTOM_EVENT,{detail:{control_fields:{mparticle:{keys:{error_code:"error_code",error_message:"error_message",form_name:"form_name"},mp_event_type:"UserContent"}},error_code:"".concat(e[0].ErrorCode),error_message:e[0].Description,event_name:c.a.customEventNames.submissionError,form_name:t}})):e.map(e=>{document.dispatchEvent(new CustomEvent(o.a.CUSTOM_EVENT,{detail:{control_fields:{mparticle:{keys:{error_message:"error_message",form_name:"form_name",input_id:"input_id"},mp_event_type:"UserContent"}},error_message:e.Message,event_name:c.a.customEventNames.submissionError,form_name:t,input_id:e.Id}}))}))}static sendFormSubmissionEvent(e){document.dispatchEvent(new CustomEvent(o.a.CUSTOM_EVENT,{detail:{control_fields:{mparticle:{keys:{form_name:"form_name"},mp_event_type:"Other"}},event_name:c.a.customEventNames.formSubmission,form_name:e}}))}static sendFormInteractionEvent(e,t){var r=document.querySelector("#".concat(e," form"));r&&r.addEventListener(o.a.FOCUS_IN,()=>{document.dispatchEvent(new CustomEvent(o.a.CUSTOM_EVENT,{detail:{control_fields:{mparticle:{keys:{form_name:"form_name"},mp_event_type:"Other"}},event_name:c.a.customEventNames.formInteraction,form_name:t}}))},{once:!0})}static sendClickEvent(e,t,r,i){document.dispatchEvent(new CustomEvent(o.a.CUSTOM_EVENT,{detail:{action:o.a.click,anchor_text:e,click_source_type:t,control_fields:{mparticle:{keys:{anchor_text:"anchor_text",click_source_type:"click_source_type",layout_section:"layout_section",target_url:"target_url"},mp_event_type:"Navigation"}},event_name:c.a.customEventNames.click,layout_section:r,target_url:i}}))}static createProfile(e){return{created:e.CreatedDate,doNotContact:void 0,email:Array.isArray(e.Email)?e.Email[0].Value:"",emailConfirmed:e.EmailVerified,familyName:e.LastName,gender:e.Gender,givenName:e.FirstName,lastSignIn:e.LastLoginDate,name:e.FullName,uuid:e.Uid}}static setSSOFooterLinks(e){document.querySelectorAll(".identity-footer a").forEach(t=>{var r;r=-1!==t.href.indexOf("http")?t.href:"".concat(window.location.origin).concat(t.href),t.href=E.getSSORedirectURL(e,r)})}static isAppleRegistration(){return null!==document.getElementById("loginradius-submit-login")&&null!==document.getElementById("loginradius-submit-register")||document.querySelectorAll("#loginradius-submit-login").length>1}static setSessionStorage(e){[a.a.CAMPAIGN,a.a.CAMPAIGN_NAME,a.a.OFFER_GROUP,a.a.PIANO_PARAMS].map(t=>{e.has(t)&&sessionStorage.setItem(t,e.get(t))}),e.has(a.a.PIANO_PARAMS)&&e.get(E.redirectParamName)&&E.setRedirectUrl(e.get(E.redirectParamName))}static addMobileRedirectTokenToUrl(e,t){var r=new URL(e);return r.searchParams.append(E.mobileRedirectTokenName,t),r.toString()}static getRedirectURLFromLocation(){return E.getParamFromQueryString(this.redirectParamName)}static getParamFromQueryString(e){return new URLSearchParams(window.location.search).get(e)}}y(E,"mobileRedirectTokenName","token"),y(E,"mobileRedirectParamName","redirect_uri"),y(E,"redirectParamName","redirect"),y(E,"allowedMobileRedirects",["calgaryherald://","nationalpost://","financialpost://","edmontonjournal://","vancouversun://","londonfreepress://","ottawacitizen://","windsorstar://","montrealgazette://","leaderpost://","starphoenix://","com.PostMedia.calgaryherald","com.indusblue.calgaryherald","com.nationalpost.nationalpostipad","com.nationalpost","com.financialpost","com.PostMedia.edmontonjournal","com.indusblue.edmontonjournal","com.PostMedia.vancouversun","com.indusblue.vancouversun","com.fivemobile.canoe.newsreader.londonfreepress","com.nurun.londonfreepress","com.postmedia.ottawacitizen.ios-2","com.postmedia.ottawacitizen.android2","com.PostMedia.windsorstar","com.indusblue.windsorstar","com.PostMedia.montrealgazette","com.indusblue.montrealgazette","com.PostMedia.leaderpost","com.indusblue.leaderpost","com.PostMedia.starphoenix","com.indusblue.starphoenix","com.halifax.saltwire","com.whiz.saltwire"])},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var i=function(e){return e.EMAIL_VERIFIED="pnIdEmailVerified",e.FORM_VALIDATED="pnFormValidated",e.IDENTITY_CHANGE="pnIdChange",e.IDENTITY_INIT="pnIdInit",e.SESSION_INIT="pnIdSession",e.IDENTITY_PROFILE_INIT="pnIdProfileInit",e.IDENTITY_SERVICE_INIT="pdIdServiceInit",e.IDENTITY_SESSION_PROFILE_INIT="pnIdIdentitySessionProfileInit",e.NEW_LOGIN="pnNewLogin",e.PROVIDER_ID_ASSIGNED="pnProviderIdAssigned",e.LOGIN_MODAL_READY="pnLoginModalReady",e.MP_READY="pnMpReady",e.COMMENT_LOGIN="pnCommentLogin",e.COMMENT_LOGOUT="pnCommentLogout",e.IDENTITY_SIGNOUT="pnIdSignOut",e.NEW_REGISTRATION="pnNewRegistration",e.IDENTITY_LOGIN="pnExplicitLogin",e.IDENTITY_READY="pnIdReady",e.IDENTITY_PROFILE_UPDATED="pnIdProfileUpdated",e.MP_LISTENS="mParictle_listeners_ready",e.MP_LOGIN_FINISHED="mParticle_login_finished",e.SAVE_RECOMMENDATION_CATEGORIES="saveRecommendationCategories",e.RECOMMENDATION_CATEGORIES_SAVED_SUCCESS="recommendationCategoriesSavedSuccess",e.RECOMMENDATION_CATEGORIES_SAVED_ERROR="recommendationCategoriesSavedError",e.OPEN_RECOMMENDATION_MODAL="openRecommendationModal",e.MICROSOFT_LOGIN_CALLBACK="microsoftLoginCallback",e.SET_PERSON_ID="fcPersonId",e.ENVELOP_MODULE_READY="envelopeModuleReady",e}({})},function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return l})),r.d(t,"c",(function(){return d}));var i=r(15),n=r(13),o=r(22);function a(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function s(e){a(o,i,n,s,c,"next",e)}function c(e){a(o,i,n,s,c,"throw",e)}s(void 0)}))}}var c=function(e){return e[e.secToMs=1e3]="secToMs",e[e.decPrecision=2]="decPrecision",e}({}),l=function(e){return e.MAGNITE_ERROR="magnite_error",e.GPT_ERROR="gpt_error",e}({}),d={anim(e,t){var r=arguments;return s((function*(){var i=r.length>2&&void 0!==r[2]&&r[2],n=Date.now();return new Promise(r=>{var o=()=>i?setTimeout(()=>a(),83):requestAnimationFrame(()=>a()),a=()=>{var i=Math.min(1,(Date.now()-n)/(t||c.secToMs)),a=e(i);i<1&&!1!==a?o():r()};o()})}))()},deCamelCase(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";if(e)return e.replace(/([a-z\d])([A-Z])/g,"$1"+t+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+t+"$2")},deCamelCaseKeys(e){if(e){var t={};return Object.keys(e).forEach(r=>t[this.deCamelCase(r)]=e[r]),t}},location:()=>window.location,currentPageUrl(){return this.location().href},getDomain(){return this.location().hostname},getPath(){return this.location().pathname},urlParams:e=>new URL(String(e)).searchParams,decodeHtmlEntity:e=>(new DOMParser).parseFromString(e,"text/html").body.textContent,event:(e,t)=>new CustomEvent(String(e),{bubbles:!0,detail:t}),hashCode:i.a,interpolateLin:(e,t,r)=>e+(t-e)*r,isEmptyObject:e=>!Object.entries(e).length,objectValuesToStrings(e){if(e){var t={};return Object.keys(e).forEach(r=>t[r]=String(e[r])),t}},params(e){var t={};return location.search.slice(1).split("&").map(e=>e.split("=").map(e=>e.trim())).forEach(e=>{var[r,i]=e;return t[r]=decodeURIComponent(i)}),e?t[e]:t},promiseTimeout(e){var t=arguments;return s((function*(){var r=t.length>1&&void 0!==t[1]?t[1]:c.secToMs;return Promise.race([e,new Promise((e,t)=>setTimeout(()=>t(new Error("Promise timed out after ".concat(r," ms."))),r))])}))()},prune:n.a,query:e=>Object.entries(e).map(e=>{var[t,r]=e;return"".concat(t,"=").concat(encodeURIComponent(String(r)))}).join("&"),retry(e){var t=arguments,r=this;return s((function*(){var i=t.length>1&&void 0!==t[1]?t[1]:3,n=t.length>2&&void 0!==t[2]?t[2]:1e3,o=t.length>3&&void 0!==t[3]?t[3]:1e3;return new Promise(function(){var t=s((function*(t,a){for(var c=function*(a){if(yield new Promise(function(){var t=s((function*(t,s){var c=yield r.promiseTimeout(e(),o).catch(s);!c&&a<i-1?setTimeout(t,n):t(c)}));return function(e,r){return t.apply(this,arguments)}}()).catch(console.log))return t(),1},l=0;l<i&&!(yield*c(l));l+=1);a()}));return function(e,r){return t.apply(this,arguments)}}())}))()},randomIdentifierGenerator:o.a,dispatchEventWithFemFlagSet(e,t){var r="femCe".concat(e.charAt(0).toUpperCase()+e.slice(1),"Triggered");window[r]=!0;var i=new CustomEvent(e,t);document.dispatchEvent(i)}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var i=r(0),n=r(1),o=r(17),a=r(20),s=r(2),c=r(9),l=r(35),d=r(11),u=r(19),m=r(31);function p(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function f(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){p(o,i,n,a,s,"next",e)}function s(e){p(o,i,n,a,s,"throw",e)}a(void 0)}))}}function g(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class h extends o.a{constructor(e,t,r){super(),g(this,"adLight",!1),g(this,"optOutPoliticalAds",!0),g(this,"registered",!1),g(this,"pageAgeGated",!1),g(this,"pageType",""),this.gpt=e,this.formatter=t,this.targeting=r,this.synchronizeStores()}static destroyOOP(e){e.filter(e=>e.sizeRendered&&e.isWallpaper()).forEach(()=>{document.body.classList.remove(h.Wallpaper.bodyClass);var e=document.getElementById(h.Wallpaper.containerId);e&&e.remove()})}static removeSpecialCharacters(e){return void 0!==e?e.map(e=>e.replace(/[!'()*]/g,"")):[]}static getTargetURI(e){return encodeURIComponent([].concat(e).map(e=>e.key+"="+e.value).join("&"))}initialize(e){var t=this;return f((function*(){Object(i.b)("debug","".concat(i.a.PAGE_LOAD," - Ads initializing")),Object(i.d)(i.a.PAGE_LOAD),m.a.init(e.stickyAd,e.page),t.gpt.adURI=t.formatter(e.provider.account,e.siteId,h.removeSpecialCharacters(e.ancestry),e.page),e.pageConfig&&e.pageConfig.ageGate&&e.pageConfig.ageGate.enabled&&(t.pageAgeGated=!0),t.gpt.registerVendors(),t.pageType=e.page;var r=e.pageConfig&&e.pageConfig.drivingTaxonomy||{};t.gpt.target(t.targeting.page({ancestry:e.ancestry,articleId:e.articleId,bodyType:r.bodyType,carMake:r.carMake,carModel:r.carModel,hub:e.hub,lang:r.lang,modelYears:r.modelYears,negative:e.negative,optOutPoliticalAds:t.optOutPoliticalAds,originId:e.originId,property:e.property,sensitive:e.sensitive,specialSection:r.specialSection,spoke:e.spoke,topics:e.topics,type:e.page,vehicleType:r.vehicleType,wpLegacyId:e.wpLegacyId,writers:e.writers})),t.refreshAd=e.refresh,yield t.update(e.adLight&&(!e.pageConfig.abTest.AdLight||e.pageConfig.abTest.AdLight.enabled)),yield t.registerNewAdsEventListener()}))()}getTargeting(e){var t=this;return f((function*(){var r=t.formatter(e.provider.account,e.siteId,h.removeSpecialCharacters(e.ancestry),e.page),i=e.pageConfig&&e.pageConfig.drivingTaxonomy||{},n={ancestry:e.ancestry,articleId:e.articleId,bodyType:i.bodyType,carMake:i.carMake,carModel:i.carModel,hub:e.hub,lang:i.lang,modelYears:i.modelYears,negative:e.negative,optOutPoliticalAds:t.optOutPoliticalAds,originId:e.originId,property:e.property,sensitive:e.sensitive,specialSection:i.specialSection,spoke:e.spoke,topics:e.topics,type:e.page,vehicleType:i.vehicleType,writers:e.writers};return{adUnit:r,adTargetingParams:h.getTargetURI(t.targeting.page(n))}}))()}update(e){var t=this;return f((function*(){Object(i.b)("debug","".concat(i.a.PAGE_LOAD," - Ads refreshed - adlight is ").concat(e)),Object(i.d)(i.a.PAGE_LOAD),t.adLight=e,!t.adLight&&t.registered||(t.pageAgeGated&&(yield l.a.verified),Object(i.b)("info","update->registerAds()"),yield t.registerAds())}))()}registerNewAdsEventListener(){var e=this;return f((function*(){addEventListener(u.a.SLOT_ADDED,function(){var t=f((function*(t){t.detail.el&&(e.registered=!1,t.detail.el.map(t=>new d.a(t,e.targeting.ad.bind(e.targeting),e.refreshAd,e.adLight,e.pageType)),Object(i.b)("info","registerNewAdsEventListener->registerAds()"),yield e.registerAds())}));return function(e){return t.apply(this,arguments)}}())}))()}getAds(){return d.a.getAdElements().map(e=>new d.a(e,this.targeting.ad.bind(this.targeting),this.refreshAd,this.adLight,this.pageType)).filter(e=>!this.adLight||e.isAdLightIneligible())}registerAds(){var e=this;return f((function*(){if(yield n.b.ready,Object(i.b)("debug","".concat(i.a.PAGE_LOAD," - registerAds called")),Object(i.d)(i.a.PAGE_LOAD),e.adLight&&e.registered&&(h.destroyOOP(e.gpt.ads),e.gpt.ads=e.gpt.ads.filter(e=>e.isAdLightIneligible()),e.registered=!1),!e.registered){e.registered=!0;var t=document.querySelector(".".concat(h.DOM.classes.amuniversalRightRailAdContainer));if(t&&window.innerWidth<1500)for(var r of(t.remove(),document.querySelectorAll(".".concat(h.DOM.classes.amuniversalContainer))))r.classList.remove(h.DOM.classes.amuniversalContainer);var o=document.querySelector(".".concat(h.DOM.classes.amuniversalRightRailAdNytPuzzle));o&&window.innerWidth<n.b.tabledCutoff&&o.remove();var a=e.getAds().filter(t=>e.gpt.storeAd(t));yield e.gpt.initRequestAds(a)}}))()}synchronizeStores(){var e=c.a.get(s.a.OPT_OUT_POL);this.optOutPoliticalAds=void 0===e||!!e,a.a.get(s.a.OPT_OUT_POL).then(t=>{this.optOutPoliticalAds=!!t,this.optOutPoliticalAds!==e&&c.a.set(s.a.OPT_OUT_POL,this.optOutPoliticalAds)}).catch(console.log)}}g(h,"DOM",{attrs:{adSizes:"data-ad",dataScroll:"data-scroll-component"},classes:{amuniversalContainer:"amuniversal__container",amuniversalRightRailAdContainer:"amuniversal__ad__right-rail-container",amuniversalRightRailAdNytPuzzle:"amuniversal__ad__right-rail__nyt-puzzle",breaking:"header-breaking__wrapper",closeStickyAd:"close-sticky-ad",dfpAdSpacer:["ad__section-border","ad__section-border--category-empty"],fixedBottomAdContainer:"fixed-bottom-ad-container",header:"sticky--header",headerOffset:"header--offset",headerShrink:"header--shrink",highImpact:"ad__high-impact",rightRailItem:"story-v2-right-rail-item",stickyAd:"sticky-ad",stickyNoSubscribe:"sticky-no-subscribe",stickyWithSubscribe:"sticky-with-subscribe",stickyWithSubscribeNoBreaking:"sticky-with-subscribe-no-breaking",subscribe:"subscribe",topAd:["ad__section-border","ad__section-border--topmost"],widgetRelatedStories:"article-content__widget-group--related-story-slot",widgetShoppingEssentials:"article-content__widget-group--category-slot"},ids:{fixedBottomAddOffset:"fixed-bottom-ad-offset",header:"header",loc1:"ad-1",secondaryNav:"secondary-nav"},vals:{dataScroll:"ts-ready"}}),g(h,"Wallpaper",{bodyClass:"wallpaper",containerId:"wallpaper-wrapper",readyId:"wallpaper-spot-left",selector:"#wallpaper-wrapper a",size:[4,4]}),g(h,"Native",{size:[5,5]}),g(h,"Interscroller",{sizes:[[6,6],[7,7]]})},function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var i=r(43),n=r.n(i),o=r(0),a=r(1),s=r(17);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){d(o,i,n,a,s,"next",e)}function s(e){d(o,i,n,a,s,"throw",e)}a(void 0)}))}}function m(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class p extends s.a{constructor(e,t){super(),this.adapter=e,this.tagManager=t}initialize(e){var t=this;return u((function*(){Object(o.b)("debug","".concat(o.a.PAGE_LOAD," - Analytics service initializing")),Object(o.d)(o.a.PAGE_LOAD),t.conf&&n()(t.conf,e)||(t.conf=e,t.meta=l({},t.conf),e.tags&&t.tagManager.init(e.tags,t.conf),t.adapter.initialize(e.provider,e.profile,yield t.getDocEvents(),t.meta,t.conf,t.conf.isDev),yield t.assignMutationObservers(p.DOM.attrs.async),yield t.assignMutationObservers(p.DOM.attrs.multiAsync,!0),Object(o.b)("debug","".concat(o.a.PAGE_LOAD," - Analytics service initialized")),Object(o.d)(o.a.PAGE_LOAD))}))()}update(e){this.meta=l(l({},this.conf),{},{profile:e}),this.adapter.update(e)}getDocEvents(e){var t=this;return u((function*(){yield a.b.ready;var r=(e||document).querySelectorAll("[".concat(p.DOM.attrs.action,"]"));return a.b.nodes(r).map(e=>t.adapter.getEventByType(e.getAttribute(p.DOM.attrs.type)||"event",e.getAttribute(p.DOM.attrs.data)||"",e.getAttribute(p.DOM.attrs.action)||"click",e))}))()}assignMutationObservers(e,t){var r=this;return u((function*(){return yield a.b.ready,a.b.nodes(document.querySelectorAll("[".concat(e,"]"))).map(e=>{var i=new MutationObserver(function(){var e=u((function*(e,i){[...new Set(e.map(e=>e.target))].forEach(e=>{r.getDocEvents(e).then(e=>{0!==e.length&&(r.adapter.bindEvents(e,r.meta),t||i.disconnect())}).catch(console.error)})}));return function(t,r){return e.apply(this,arguments)}}());return i.observe(e,{childList:!0,subtree:!0}),i})}))()}}m(p,"ACTION_PAGE_LOAD","page-load"),m(p,"DOM",{attrs:{action:"data-evt",async:"data-async",data:"data-evt-val",multiAsync:"data-multi-async",type:"data-evt-typ"}}),m(p,"scrollEventTypes",{pageScroll:"page_scroll",percentPageview:"percent-pageview"}),m(p,"customEventNames",{adClosed:"ad_closed",ageGatePassed:"age_gate_passed",checkoutClosed:"checkout_closed",click:"click",formInteraction:"form_interaction",formSubmission:"form_submission",meterExecute:"meter_execute",modalView:"modal_view",onPageActionClick:"on_page_action_click",registration:"registration",signin:"signin",signout:"signout",submissionError:"submission_error",subscription:"subscription",topicsSaved:"topics_saved",userAlias:"user_alias"}),m(p,"focusEventTypes",{formFirstInteraction:"form_interaction"})},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class i{static jsonDecode(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(var n in t)if(t.hasOwnProperty(n)){var o=t[n];if("object"==typeof o&&!(o instanceof Array))continue;if(o instanceof Array&&o.length>0&&"object"==typeof o[0])continue;e[r?i.toCamel(n):n]=o}return e}static toCamel(e){var t=e.replace(/[\-_\s]+(.)?/g,(e,t)=>t?t.toUpperCase():"");return t.substr(0,1).toLowerCase()+t.substr(1)}}class n{fromJson(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return i.jsonDecode(this,e,t)}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var i,n,o,a=r(14),s=r(8),c=r(15),l=r(13),d=["mac"],u=["mac"];function m(e,t){if(null==e)return{};var r,i,n=function(e,t){if(null==e)return{};var r,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}class p extends s.a{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.defaultExpireMs,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now(),i=arguments.length>3?arguments[3]:void 0;super(),this.data=e,this.exp=t,this.ts=r,this.mac=i,i||this.updateHash()}fromJson(e){super.fromJson(e),e&&e.data&&(this.data=e.data,this.mac||this.updateHash())}isValid(){var e=Object(l.a)(this),{mac:t}=e,r=m(e,d);return this.mac===Object(c.a)(r)&&(0===this.exp||Date.now()-this.ts<this.exp)}toString(){return JSON.stringify(Object(l.a)(this))}updateHash(){var e=Object(l.a)(this),{mac:t}=e,r=m(e,u);this.mac=Object(c.a)(r)}}function f(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}i=p,o=6048e5,(n=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(n="defaultExpireMs"))in i?Object.defineProperty(i,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):i[n]=o;var g=new class{constructor(){f(this,"cookie",{delim:";",keys:{expires:"expires",path:"path",samesite:"SameSite",secure:"Secure"},path:"/",samesite:{lax:"Lax",none:"None",strict:"Strict"},sep:"=",delete(e){document.cookie=[" ".concat(e).concat(this.sep)," ".concat(this.keys.expires).concat(this.sep).concat(new Date(0).toUTCString())," ".concat(this.keys.path).concat(this.sep).concat(this.path)," ".concat(this.keys.secure)," ".concat(this.keys.samesite).concat(this.sep).concat(this.samesite.none)].join(this.delim)},get(e){var t=JSON.parse((document.cookie.split(this.delim).find(t=>t.trim().startsWith("".concat(e).concat(this.sep)))||"").trim().split(this.sep).pop()||"null"),r=a.a.buildOne(p,t);return r.isValid()?r:this.delete(e)},set(e,t,r){document.cookie=[" ".concat(e).concat(this.sep).concat(t)," ".concat(this.keys.expires).concat(this.sep).concat(new Date(Date.now()+r).toUTCString())," ".concat(this.keys.path).concat(this.sep).concat(this.path)," ".concat(this.keys.secure)," ".concat(this.keys.samesite).concat(this.sep).concat(this.samesite.none)].join(this.delim)}}),f(this,"local",{delete(e){localStorage.removeItem(e)},get(e){var t=a.a.buildOne(p,JSON.parse(localStorage.getItem(e)||"null"));return t.isValid()?t:this.delete(e)},set(e,t){localStorage.setItem(e,t.toString())}})}delete(e){try{return this.cookie.delete(e),this.local.delete(e),!0}catch(e){return!1}}get(e){var t=[...[].concat(this.cookie.get(e)),...[].concat(this.local.get(e))].reduce((e,t)=>t&&e&&t.data&&e.data&&e.ts>t.ts||!t?e:t);if(t)return t.data}set(e,t,r){try{var i=new p(t,r);return this.cookie.set(e,i.toString(),i.exp),this.local.set(e,i.toString()),!0}catch(e){return!1}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var i=function(e){return e.SUCCESS="identity-screen-success--active",e.ERROR="identity-screen-error--active",e.FORM="identity-screen-form--active",e.SOCIAL_FORM="identity-screen-social-form--active",e}({})},function(e,t,r){"use strict";r.d(t,"c",(function(){return d})),r.d(t,"b",(function(){return u})),r.d(t,"a",(function(){return m}));var i=r(6),n=r(8),o=r(5),a=r(1),s=r(19);r(47);function c(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l=function(e){return e.HTML="html",e.VIDEO="video",e}({}),d={attr:{state:{key:"data-ad-ref",value:{off:"off"}}}},u={attr:{acceptableAd:{key:"data-ad-acceptable"},adLightIneligible:{key:"data-ad-light-ineligible"},commentsAd:{key:"data-ad-comment"},highImpact:{key:"data-ad-high-impact"},location:{key:"data-ad-loc"},mobileSize:{key:"data-ad-mobile"},nativePosition:{key:"data-ad-native-pos"},outOfPage:{key:"data-ad-oop"},size:{key:"data-ad"},tabletSize:{key:"data-ad-tablet"},target:{key:"data-ad-target"},type:{key:"data-ad-type",value:{html:l.HTML,video:l.VIDEO}},width:{key:"data-ad-width"}}};class m extends n.a{constructor(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";super(),c(this,"adClasses",{centerRefreshAd:"ad-refresh",hidden:"visually-hidden",refreshBkgd:"ad-refresh-bkgd",stickyWidget:"sticky-widget",widgetSticky:"widget-sticky"}),this.el=e,this.targeting=t,this.refresh=r,this.adLight=n,this.pagetype=a;var s=this.interscrollerSize();this.el.hasAttribute("data-is-v2")&&s.length>=1&&(this.el.setAttribute("data-ad-loc","".concat(this.el.getAttribute("data-ad-loc"),",interscroller")),this.el.setAttribute("data-ad-interscroller","".concat(s).replace(",","x"))),this.el.hasAttribute("data-is-v2")||"2"!==this.el.getAttribute("data-ad-loc")||this.el.id.includes("native")||this.el.setAttribute("data-ad-loc","".concat(this.el.getAttribute("data-ad-loc"),",interscroller")),e.hasAttribute("id")||e.setAttribute("id","ad-".concat(o.c.randomIdentifierGenerator())),this.id=e.getAttribute("id"),this.width=e.getBoundingClientRect().width,!this.refresh||this.adLight||this.isNative()||this.isHighImpact()||this.hasRefreshEnable()||(this.calculateRefreshSizes(this.el),e.setAttribute("style","height:".concat(this.getMaxHeight(),"px"))),this.isOutOfPage()||(this.sizes=m.normalizeSizes(JSON.parse(e.getAttribute(u.attr.size.key)||"null")||m.defaultConf.size)),t&&(this.targets=this.targeting(JSON.parse(e.getAttribute(u.attr.target.key)||"null"),e.getAttribute(u.attr.location.key))),this.id.includes("native")&&(this.hasParentWithClass(i.a.DOM.classes.widgetRelatedStories)?e.setAttribute(u.attr.nativePosition.key,"read-next"):this.hasParentWithClass(i.a.DOM.classes.widgetShoppingEssentials)&&e.setAttribute(u.attr.nativePosition.key,"shopping-essentials")),this.type=e.getAttribute(u.attr.type.key)||m.defaultConf.type}static getAdElements(){return a.b.nodes(document.querySelectorAll("[".concat(u.attr.size.key,"]")))}static normalizeSizes(e){if(e&&e.length)return Array.isArray(e[0])?e:[e]}calculateRefreshSizes(e){if(this.refresh){var t=this.getAdDeviceTypeSizes().map(e=>e.length>1&&!isNaN(e[1])?parseInt(e[1],10):0),r=t.length>0?Math.max(...t):0;isFinite(r)&&r>=20&&(this.reflowHeight="".concat(r,"px !important"),this.centerRefreshAds(e))}}destroy(){}display(e,t){this.advertiser=t,this.sizeRendered=e}fallBack(e){this.el.innerHTML=e}isOutOfPage(){return this.el.hasAttribute(u.attr.outOfPage.key)}isAdLightIneligible(){return this.el.hasAttribute(u.attr.adLightIneligible.key)}isHighImpact(){return this.el.hasAttribute(u.attr.highImpact.key)}isCommentsAd(){return this.el.hasAttribute(u.attr.commentsAd.key)}isWallpaper(){return JSON.stringify(this.sizes)===JSON.stringify([i.a.Wallpaper.size])}isLeaderBoard(){return this.el.id.search("leaderboard")>-1}isAcceptable(){return this.el.hasAttribute(u.attr.acceptableAd.key)}interscrollerSize(){var e=a.b.deviceType()===a.c.MOBILE?u.attr.mobileSize.key:u.attr.size.key;for(var t of i.a.Interscroller.sizes)if(JSON.stringify(this.el.getAttribute(e)).indexOf(JSON.stringify(t))>-1)return t;return[]}isNative(){return JSON.stringify(this.el.getAttribute(u.attr.size.key)).indexOf("".concat(i.a.Native.size))>-1}hasRefreshEnable(){return this.el.hasAttribute(d.attr.state.key)}hasMobileSize(){return this.el.hasAttribute(u.attr.mobileSize.key)}hasTabletSize(){return this.el.hasAttribute(u.attr.tabletSize.key)}loaded(){this.el.setAttribute(u.attr.width.key,"".concat(this.el.getBoundingClientRect().width)),this.el.dispatchEvent(o.c.event(s.a.DISPLAY,this))}validSizes(){if(this.isWallpaper())return this.sizes;if(this.isLeaderBoard())return this.sizes;if(this.isCommentsAd())return this.sizes;var e=this.el.getBoundingClientRect().width,t=this.el.getAttribute(u.attr.width.key),r=t?parseInt(t):0,i=e>0?e:r;return this.mobileSizes=this.getMobileSizes(),this.tabletSizes=this.getTabletSizes(),(this.getAdDeviceTypeSizes()||[]).filter(e=>e[0]<=(this.isBigBox()?i+1:i))}validSizesWithFluid(){return this.validSizes().map(e=>8===e[0]&&8===e[1]?"fluid":e)}getMaxHeight(){var e=this.validSizes();return e?e.reduce((e,t)=>Math.max(e,t[1]),0):0}getAdDeviceTypeSizes(){switch(a.b.deviceType()){case a.c.MOBILE:return this.getMobileSizes();default:return this.getDesktopSizes()}}getDesktopSizes(){var e=m.normalizeSizes(JSON.parse(this.el.getAttribute(u.attr.size.key)));return void 0===e?[]:e}getMobileSizes(){var e=m.normalizeSizes(JSON.parse(this.el.getAttribute(u.attr.mobileSize.key)));return void 0===e?[]:e}getTabletSizes(){var e=m.normalizeSizes(JSON.parse(this.el.getAttribute(u.attr.tabletSize.key)));return void 0===e?[]:e}isBigBox(){return this.el.id.search("bigbox")>-1}centerRefreshAds(e){var t=null!==document.querySelector(".".concat(this.adClasses.stickyWidget)),r=null!==document.querySelector(".".concat(this.adClasses.widgetSticky));this.isLeaderBoard()||!t&&!r?e.classList.add(this.adClasses.centerRefreshAd):r?e.classList.add(this.adClasses.widgetSticky):t&&e.classList.add(this.adClasses.stickyWidget)}hasParentWithClass(e){for(var t=this.el.parentElement;t&&t!==document.body;){if(t.classList.contains(e))return!0;t=t.parentElement}return!1}}c(m,"defaultConf",{size:[300,250],type:l.HTML})},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var i=function(e){return e.AUTHOR="author",e.CATEGORY="category",e.ERROR="error",e.INDEX="index",e.ONE_DIGITAL="one-digital",e.PAGE="page",e.SEARCH="search",e.STORY="story",e.TAG="tag",e}({})},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var i=e=>{var t=JSON.parse(JSON.stringify(e||"null"));return Object.keys(t).forEach(e=>(null===t[e]||void 0===t[e]||t[e]instanceof Function)&&delete t[e]),t}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));class i{static buildOne(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=new e;return i.fromJson(t,r),i}static buildMany(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t.map(t=>this.buildOne(e,t,r))}}},function(e,t,r){"use strict";function i(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}));var n=e=>{var t=0;if(void 0===e)return t;for(var r=JSON.stringify(e),i=0;i<r.length;i++){t=(t<<5)-t+r.charCodeAt(i),t&=t}return t},o=function(){var e,t=(e=function*(e){if(window.crypto&&window.crypto.subtle){var t=(new TextEncoder).encode(e);return window.crypto.subtle.digest("SHA-256",t).then(e=>a(e))}return Promise.reject(new Error("crypto not available"))},function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function s(e){i(a,n,o,s,c,"next",e)}function c(e){i(a,n,o,s,c,"throw",e)}s(void 0)}))});return function(e){return t.apply(this,arguments)}}(),a=e=>{var t=Array.from(new Uint8Array(e));return t.map(e=>e.toString(16).padStart(2,"0")).join("")}},function(e,t,r){"use strict";r.d(t,"a",(function(){return V})),r.d(t,"b",(function(){return q}));var i=r(5),n=r(0),o=r(1),a=r(2),s=r(9),c=r(7),l=r(4),d=r(27),u=r(26),m=r(36),p=r(21),f=r(37),g=r(3);function h(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function v(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){h(o,i,n,a,s,"next",e)}function s(e){h(o,i,n,a,s,"throw",e)}a(void 0)}))}}class b{constructor(e,t,r,i){this.microsoftLoginId=e,this.apiKey=t,this.lrObject=r,b.showNewsletterOptIn=i}init(){var e=this,t=localStorage.getItem(a.a.LR_TOKEN_KEY),r="".concat(window.location.origin,"/sign-in/");if(window.ms&&this.microsoftLoginId&&!t){var i=window.ms.auth.initialize({callback:"handleLiveTapResponse",client_id:this.microsoftLoginId,login_uri:r});"success"===i.result?(window.ms.auth.prompt("right",e=>{var t=e.reason;"display"!==e.type||e.displayed?"skipped"===e.type?"user_cancel"===t&&Object(n.b)("info","User cancelled Microsoft Edge prompt"):"dismissed"===e.type&&"credential_returned"===t&&Object(n.b)("info","Microsoft Edge prompt login credentials returned"):"browser_not_supported"===t&&Object(n.b)("info","Microsoft Edge prompt not supported in browser")}),addEventListener(l.a.MICROSOFT_LOGIN_CALLBACK,function(){var t=v((function*(t){if(t&&t.detail){var r=t.detail;yield e.handleMicrosoftSignIn(r.signInAccountInfo,r.signInErrorInfo)}}));return function(e){return t.apply(this,arguments)}}())):Object(n.b)("error","Microsoft login initialization failed",i)}}handleMicrosoftSignIn(e,t){var r=this;return v((function*(){if(t)Object(n.b)("error","Microsoft login failed",t.errorMessage);else if(e)try{var i=e.idToken,o=yield fetch("https://api.loginradius.com/api/v2/access_token/jwt?key=".concat(r.apiKey,"&id_token=").concat(i,"&providername=").concat("microsoft"),{headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},method:"GET"}),a=(yield o.json()).access_token;r.lrObject.api.socialLogin({token:a},r.socialLoginSuccessResponse,r.socialLoginErrorResponse,v((function*(){yield r.socialLoginMissingField(e,a)})))}catch(e){Object(n.b)("error","Microsoft social sign in error:",e)}}))()}socialLoginSuccessResponse(e){return v((function*(){Object(n.b)("info","Microsoft social sign in successful",e),g.a.setRedirectUrl(location.href),yield g.a.handleLoginSuccess(e,!0,b.showNewsletterOptIn)}))()}socialLoginErrorResponse(e){throw new Error(e.Description)}socialLoginMissingField(e,t){var r=this;return v((function*(){Object(n.b)("info","Microsoft social sign in missing required fields");var i={FirstName:e.givenName,LastName:e.surname},o=yield fetch("https://api.loginradius.com/identity/v2/auth/account?apiKey=".concat(r.apiKey),{body:JSON.stringify(i),headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},method:"PUT"});yield o.json(),r.lrObject.api.socialLogin({token:t},r.socialLoginSuccessResponse,r.socialLoginErrorResponse)}))()}}var y,w,E,S=r(10),O=function(e){return e.FORGOT_PASSWORD="forgotPassword",e.LOGIN="login",e.SOCIAL_LOGIN="socialLogin",e.REGISTRATION="registration",e.VERIFY_EMAIL="verifyEmail",e.RESET_PASSWORD="resetPassword",e}({});class _{initForm(){if(document.querySelector("#".concat(this.container))){Object(n.b)("debug","Initializing ".concat(this.widgetType," widget"));var e={container:this.container,onError:this.onError,onSuccess:this.onSuccess};this.lrObject.init(this.widgetType,e),Object(n.b)("debug","".concat(this.widgetType," widget initialized"))}}}function I(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class A extends _{constructor(e,t){super(),I(this,"validateEmailOptions",{onError:this.onError,onSuccess:this.onSuccess}),this.widgetType=O.VERIFY_EMAIL,this.lrObject=t,this.container=e,Object(n.b)("info","Email validation widget created")}initEmailValidation(){document.querySelector("#".concat(this.container))&&(Object(n.b)("info","Initializing Email validation widget"),this.lrObject.init("verifyEmail",this.validateEmailOptions),Object(n.b)("info","Email validation widget initialized"))}onSuccess(e){Object(n.b)("info",e),o.b.addClass(document.body,S.a.SUCCESS)}onError(e){var t=!(!e.length||974!==e[0].ErrorCode);g.a.showErrors(e),o.b.addClass(document.body,S.a.ERROR),Object(n.b)("error",e),g.a.sendSubmissionErrorAnalytics(e,"email-validation");var r="The email verification link is no longer valid.";t&&(r="The email verification link has already been used."),location.replace("/verify-email/?msg=".concat(r))}}class T extends _{constructor(e,t){super(),this.widgetType=O.FORGOT_PASSWORD,this.lrObject=t,this.container=e}onSuccess(e){Object(n.b)("info",e),g.a.clearErrors(),o.b.removeClass(document.body,S.a.FORM),o.b.addClass(document.body,S.a.SUCCESS),g.a.setRedirectLink(),g.a.sendFormSubmissionEvent("forgot-password")}onError(e){Object(n.b)("error",e),g.a.clearErrors(),g.a.showErrors(e),g.a.sendSubmissionErrorAnalytics(e,"forgot-password")}}function P(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}class C extends _{constructor(e,t){super(),this.widgetType=O.LOGIN,this.lrObject=t,this.container=e,Object(n.b)("info","login widget created")}onSuccess(e){return(t=function*(){Object(n.b)("info","Successfully logged in: ",e),g.a.clearErrors(),yield g.a.handleLoginSuccess(e)},function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function a(e){P(o,i,n,a,s,"next",e)}function s(e){P(o,i,n,a,s,"throw",e)}a(void 0)}))})();var t}onError(e){Object(n.b)("error",e);var t=document.getElementById("loginradius-submit-login");t&&(t.classList.remove("loading"),t.removeAttribute("disabled")),g.a.clearErrors(),g.a.showErrors(e),g.a.sendSubmissionErrorAnalytics(e,"login")}}function R(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}class k extends _{constructor(e,t,r){super(),this.widgetType=O.REGISTRATION,this.lrObject=t,this.container=e,k.showNewsletterOptIn=r;var i=document.querySelector(".identity__link[type=button]");i&&i.addEventListener("click",()=>{this.resendRegistrationEmail()})}onSuccess(e){return(t=function*(){Object(n.b)("debug","Registration form success",e);var t=e.access_token,r=e.Data||e.Profile;g.a.clearErrors(),g.a.handleLogin(e);var i=g.a.createProfile(r);g.a.sendRegistrationAnalytics(e.Profile.RegistrationProvider||"traditionalRegister"),document.dispatchEvent(new CustomEvent(l.a.NEW_REGISTRATION,{detail:{email:i.email,uuid:i.uuid}})),yield g.a.setSailthruCookie(i.email);var a=g.a.getRedirectUrl(location.origin,t),s=g.a.getPostRegistrationStep(a,k.showNewsletterOptIn);if(s===g.b.REDIRECT)location.replace(g.a.getSSORedirectURL(e.access_token,a));else if(s===g.b.SHOW_CHECKOUT){var c=g.a.getPianoParams();g.a.showCheckoutModal(c)}else s===g.b.SUBSCRIBE||(s===g.b.SHOW_NEWSLETTER_OPT_IN?(a=g.a.getNewsletterRedirectURL(location.origin),location.replace(g.a.getSSORedirectURL(e.access_token,a))):(o.b.removeClass(document.body,S.a.FORM),o.b.addClass(document.body,S.a.SUCCESS)));var d=document.querySelector("[data-identity-email]");d&&(d.innerHTML=i.email),g.a.setRedirectLink(e.access_token),g.a.setSSOFooterLinks(e.access_token)},function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function a(e){R(o,i,n,a,s,"next",e)}function s(e){R(o,i,n,a,s,"throw",e)}a(void 0)}))})();var t}onError(e){Object(n.b)("error",e);var t=document.getElementById("loginradius-submit-register");t&&(t.classList.remove("loading"),t.removeAttribute("disabled")),g.a.clearErrors(),g.a.showErrors(e),p.a.showPasswordRequirementsList(k.DOM.class.passwordContainer),g.a.sendSubmissionErrorAnalytics(e,"registration")}resendRegistrationEmail(){Object(n.b)("info","Email resend requested");var e=document.querySelector("[data-identity-email]");this.lrObject.api.resendEmailVerification({email:e.innerHTML},this.onResendEmailSuccess,this.onResendEmailError)}onResendEmailSuccess(e){Object(n.b)("info",e);var t=document.querySelector(".identity__link[type=button]");t.setAttribute("disabled","disabled");var r=document.createElement("p");r.innerHTML="We have resent your activation email",o.b.addClass(r,"resend-activation-email__message--success"),t&&t.parentElement.after(r)}onResendEmailError(e){Object(n.b)("error",e)}}y=k,E={class:{passwordContainer:"content-loginradius-password"}},(w=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(w="DOM"))in y?Object.defineProperty(y,w,{value:E,enumerable:!0,configurable:!0,writable:!0}):y[w]=E;class D extends _{constructor(e,t){super(),this.widgetType=O.RESET_PASSWORD,this.lrObject=t,this.container=e}onSuccess(e){Object(n.b)("info",e),g.a.clearErrors(),o.b.removeClass(document.body,S.a.FORM),o.b.addClass(document.body,S.a.SUCCESS),g.a.sendFormSubmissionEvent("reset-password")}onError(e){Object(n.b)("error",e);var t=Array.isArray(e)?e[0]:void 0;g.a.clearErrors(),p.a.showPasswordRequirementsList(D.DOM.class.passwordContainer),t&&(t.ErrorCode===V.LINK_ALREADY_USED||t.ErrorCode===V.LINK_EXPIRED||t.ErrorCode===V.LINK_TOKEN_INVALID?(o.b.removeClass(document.body,S.a.FORM),o.b.addClass(document.body,S.a.ERROR)):g.a.showErrors(e),g.a.sendSubmissionErrorAnalytics(e,"reset-password"))}}function j(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}!function(e,t,r){(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(D,"DOM",{class:{passwordContainer:"content-loginradius-password"}});class M extends _{constructor(e,t,r,i){super(),this.widgetType=O.SOCIAL_LOGIN,this.lrObject=t,this.container=e,this.socialLogintemplate=r,M.showNewsletterOptIn=i,Object(n.b)("info","login widget created")}initForm(){if(document.querySelector("#".concat(this.container))){var e={container:this.container,onError:this.onError,onSuccess:this.onSuccess,templateName:this.socialLogintemplate};this.lrObject.customInterface(".social-login-interface",e),this.lrObject.init(this.widgetType,e),window.social_lrobj=this.lrObject,this.lrObject.$hooks.register("socialLoginFormRender",()=>{var e=g.a.getRedirectUrl(location.href);e&&e.includes("lr-token")&&g.a.setRedirectUrl(location.href),g.a.removeAccessTokenFromUrl(),o.b.addClass(document.body,S.a.SOCIAL_FORM),g.a.scrollToContentBlocker()})}}onSuccess(e){return(t=function*(){Object(n.b)("info","social-login-widget: Successfully logged in: ",e),g.a.clearErrors(),g.a.removeAccessTokenFromUrl(),yield g.a.handleLoginSuccess(e,!0,M.showNewsletterOptIn)},function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function a(e){j(o,i,n,a,s,"next",e)}function s(e){j(o,i,n,a,s,"throw",e)}a(void 0)}))})();var t}onError(e){Object(n.b)("error","social-login-widget: ",e),g.a.clearErrors(),g.a.showErrors(e),history.replaceState(history.state,"",o.b.removeFromUrl("lr-token",location.href)),g.a.sendSubmissionErrorAnalytics(e,"social-login")}}function L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?L(Object(r),!0).forEach((function(t){F(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function x(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function U(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){x(o,i,n,a,s,"next",e)}function s(e){x(o,i,n,a,s,"throw",e)}a(void 0)}))}}function F(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var V=function(e){return e[e.LINK_ALREADY_USED=974]="LINK_ALREADY_USED",e[e.LINK_EXPIRED=975]="LINK_EXPIRED",e[e.LINK_TOKEN_INVALID=1063]="LINK_TOKEN_INVALID",e[e.NEW_PASSWORD_INVALID=1015]="NEW_PASSWORD_INVALID",e[e.INVAlID_USER_PASSWORD=966]="INVAlID_USER_PASSWORD",e[e.USER_DOES_NOT_EXIST=938]="USER_DOES_NOT_EXIST",e[e.EMAIL_ADDRESS_TAKEN=936]="EMAIL_ADDRESS_TAKEN",e[e.VERIFY_EMAIL_FIRST=1026]="VERIFY_EMAIL_FIRST",e}({}),G=function(e){return e.NEW_PASSWORD_INVALID="Your new password is too similar to your old passwords. Please provide a new password.",e.INVAlID_USER_PASSWORD="The email address and/or password you entered does not match any account. Please try again.",e.USER_DOES_NOT_EXIST="The email address and/or password you entered does not match any account. Please try again.",e.EMAIL_ADDRESS_TAKEN="This email is already registered. To log in to this account please try signing in or resetting your password.",e}({});class q{constructor(e){this.conf=e,this.apiKey=e.identity.sso.hasOwnProperty("loginradius")?e.identity.sso.loginradius.apiKey:"",this.appName=e.identity.sso.hasOwnProperty("loginradius")?e.identity.sso.loginradius.appName:"";var t=location.origin;this.clientId=e.page.clientId,this.microsoftLogin=e.identity.hasOwnProperty("microsoftLogin")?e.identity.microsoftLogin:{},this.showNewsletterOptIn=!!e.identity.hasOwnProperty("showNewsletterOptIn")&&e.identity.showNewsletterOptIn,this.pageData=e,this.lrOptions={accessTokenResponse:!0,apiKey:this.apiKey,appName:this.appName,callbackType:"QueryString",debugMode:!1,forgotPasswordUrl:"".concat(t,"/reset-password/"),hashTemplate:!0,integrationName:"news-websites",objectName:"postmedia-obj",passwordlessLogin:!1,tokenType:"jwt",verificationUrl:"".concat(t,"/validate-email/")},q.ssoRedirectLink="https://".concat(this.appName,".hub.loginradius.com/ssologin/setSafariToken?apiKey=").concat(this.apiKey)}static DeleteIdentityLocalStorage(){return!(!localStorage.getItem(a.a.JWT)&&!localStorage.getItem(a.a.LR_TOKEN_KEY))&&(localStorage.removeItem(a.a.LR_TOKEN_KEY),localStorage.removeItem(a.a.JWT),-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&(localStorage.removeItem(a.a.VF_ACCESS),localStorage.removeItem(a.a.VF_REFRESH)),!0)}init(){var e=this;return U((function*(){try{void 0!==window.LoginRadiusV2?(Object(n.b)("info","LoginRadiusV2 found"),yield e.initializeLoginRadiusV2()):(Object(n.b)("info","LoginRadiusV2 not found, retrying first time..."),yield new Promise((t,r)=>{var i=Date.now(),o=setInterval(U((function*(){void 0!==window.LoginRadiusV2?(clearInterval(o),Object(n.b)("info","LoginRadiusV2 found after retry"),yield e.initializeLoginRadiusV2(),t(void 0)):Date.now()-i>3e4?(clearInterval(o),r(new Error("LoginRadiusV2 loading timed out"))):Object(n.b)("info","LoginRadiusV2 not found, retrying...")})),100)}))}catch(e){Object(n.b)("error","Error initializing LoginRadiusV2: ",e)}}))()}initializeLoginRadiusV2(){var e=this;return U((function*(){if(window.LoginRadiusV2){var t=!!document.querySelector(".".concat(q.DOM.class.setPasswordPage));if(document.querySelector("#".concat(q.DOM.id.registrationContainer)))try{yield e.setSOTT()}catch(e){return void Object(n.b)("error","Error setting SOTT: ",e)}if(e.lrObject=new window.LoginRadiusV2(e.lrOptions),Object(n.b)("info","LoginRadius object created"),e.lrObject.$hooks.register("afterFormRender",e.afterFormRenders.bind(e)),e.lrObject.$hooks.call("setButtonsName",{forgotpassword:"Send Email",login:"Sign In",registration:"Create Account",resetPassword:t?"Set Password":"Reset Password"}),e.lrObject.$hooks.call("customizeFormLabel",{emailid:"Email Address"}),e.lrObject.$hooks.call("customizeFormPlaceholder",{emailid:"youremail@emailaddress.com",firstname:"John",lastname:"Smith"}),e.lrObject.$hooks.call("formAttributes",{confirmpassword:"required",emailid:"required&type=email",firstname:"required",lastname:"required",password:"required"}),e.lrObject.$hooks.call("mapErrorMessages",[{code:V.NEW_PASSWORD_INVALID,description:G.NEW_PASSWORD_INVALID,message:G.NEW_PASSWORD_INVALID},{code:V.INVAlID_USER_PASSWORD,description:G.INVAlID_USER_PASSWORD,message:G.INVAlID_USER_PASSWORD},{code:V.USER_DOES_NOT_EXIST,description:G.USER_DOES_NOT_EXIST,message:G.USER_DOES_NOT_EXIST},{code:V.EMAIL_ADDRESS_TAKEN,description:G.EMAIL_ADDRESS_TAKEN,message:G.EMAIL_ADDRESS_TAKEN}]),Object(n.b)("info","LoginRadius hooks added"),e.registrationWidget=new k(q.DOM.id.registrationContainer,e.lrObject,e.showNewsletterOptIn),e.loginWidget=new C(q.DOM.id.loginContainer,e.lrObject),e.forgotPasswordWidget=new T(q.DOM.id.forgotPasswordContainer,e.lrObject),e.resetPasswordWidget=new D(q.DOM.id.resetPasswordContainer,e.lrObject),e.socialLoginWidget=new M(q.DOM.id.socialLoginContainer,e.lrObject,q.DOM.id.socialLoginTemplate,e.showNewsletterOptIn),Object(n.b)("debug","Initializing LoginRadius UI"),g.a.setMobileRedirectUrl(),e.registrationWidget.initForm(),e.loginWidget.initForm(),e.forgotPasswordWidget.initForm(),e.resetPasswordWidget.initForm(),e.socialLoginWidget.initForm(),Object(n.b)("debug","LoginRadius Widgets Initialized"),(yield r.e(2).then(r.bind(null,69))).IdentityButtons.initDOM(e.conf.page.siteName),e.sendEmailOnlyRegistrationEvent(),document.dispatchEvent(i.c.event(l.a.LOGIN_MODAL_READY)),localStorage&&(yield e.initializeSSO(),yield e.lrTokenFromUrl(),yield e.initializeLoginState()),document.addEventListener(l.a.SAVE_RECOMMENDATION_CATEGORIES,function(){var t=U((function*(t){var r=t.detail.categories;yield e.saveRecommendationCategories(e.clientId,r)}));return function(e){return t.apply(this,arguments)}}()),document.dispatchEvent(i.c.event(l.a.SESSION_INIT,e.hasSession())),e.microsoftLogin&&e.microsoftLogin.id)new b(e.microsoftLogin.id,e.apiKey,e.lrObject,e.showNewsletterOptIn).init()}else Object(n.b)("error","LoginRadiusV2 object not found. Please make sure LR script is loaded")}))()}saveRecommendationCategories(e,t){var r=this;return U((function*(){if(e&&r.lrApiClient){var n={Recommendations:{[e]:{categories:t}}};try{return yield r.lrApiClient.partialUpdateCustomObjectByToken(n),r.sendTopicsSavedAnalytics(t),addEventListener(l.a.MP_READY,()=>{r.sendTopicsSavedAnalytics(t)}),document.dispatchEvent(i.c.event(l.a.RECOMMENDATION_CATEGORIES_SAVED_SUCCESS)),!0}catch(e){var o={detail:{Description:e.message}};document.dispatchEvent(i.c.event(l.a.RECOMMENDATION_CATEGORIES_SAVED_ERROR,o))}}return!1}))()}sendTopicsSavedAnalytics(e){document.dispatchEvent(new CustomEvent(o.a.CUSTOM_EVENT,{detail:{control_fields:{mparticle:{keys:{topics:"topics"},mp_event_type:"Other"}},event_name:c.a.customEventNames.topicsSaved,topics:e.join(",")}}))}setSOTT(){var e=this;return U((function*(){var t=yield fetch(location.origin+"/api-root/subscription/identity/get_sott/",{headers:{"content-type":"application/json"},method:"GET"}),r=yield t.json();r.hasOwnProperty("Sott")?e.lrOptions.sott=r.Sott:Object(n.b)("error","Error fetching SOTT ".concat(t))}))()}initializeSSO(){var e=this;return U((function*(){if(e.hasSession())Object(n.b)("info","SSO already initialized, SSO token - ".concat(e.getAccessToken()));else{var t=yield fetch("https://".concat(e.appName,".hub.loginradius.com/ssologin/login"),{credentials:"include",headers:{"content-type":"application/json"},method:"GET"}),r=yield t.json();if(r.isauthenticated){var i=r.token;localStorage.setItem(a.a.LR_TOKEN_KEY,i),localStorage.removeItem(a.a.JWT),Object(n.b)("info","SSO token found - ".concat(i))}}}))()}lrTokenFromUrl(){return U((function*(){var e=i.c.urlParams(document.location);e.has("lr-token")&&localStorage.setItem(a.a.LR_TOKEN_KEY,e.get("lr-token"))}))()}sendEmailOnlyRegistrationEvent(){i.c.urlParams(document.location).has("just-registered")&&addEventListener(l.a.MP_READY,()=>{sessionStorage&&(sessionStorage.getItem(a.a.EMAIL_ONLY_REGISTRATION_EVENT_SENT)||(sessionStorage.setItem(a.a.EMAIL_ONLY_REGISTRATION_EVENT_SENT,"true"),g.a.sendRegistrationAnalytics("emailOnly")))})}getAccessToken(){if(this.hasSession())return localStorage.getItem(a.a.LR_TOKEN_KEY)}signIn(e){var t=e||location.href;sessionStorage&&(g.a.setRedirectUrl(t),sessionStorage.setItem(a.a.GNS_REDIRECT_URL,t),sessionStorage.removeItem(a.a.ACTIVATE_BUTTON)),location.assign("".concat(location.origin,"/sign-in/"))}signOut(){var e=this;return U((function*(){var t=document.querySelector(".".concat(q.DOM.class.myAccountPage));document.dispatchEvent(new CustomEvent(l.a.IDENTITY_SIGNOUT)),localStorage&&(document.dispatchEvent(i.c.event(l.a.IDENTITY_CHANGE,e.emptyProfile())),q.DeleteIdentityLocalStorage()&&g.a.sendLogoutAnalytics());try{e.lrApiClient&&(yield e.lrApiClient.invalidateAccessToken())}catch(e){Object(n.b)("error","Unable to invalidate access token - ",e)}t?location.assign("/"):location.reload()}))()}hasSession(){return localStorage&&!!localStorage.getItem(a.a.ID)&&!!localStorage.getItem(a.a.LR_TOKEN_KEY)}initializeLoginState(){var e=this;return U((function*(){var t={},r=localStorage.getItem(a.a.LR_TOKEN_KEY),o=localStorage.getItem(a.a.JWT);if(e.lrApiClient=g.a.getLRApiClient({apiKey:e.lrOptions.apiKey,appName:e.appName,integrationName:e.lrOptions.integrationName,objectName:e.lrOptions.objectName},r),r)if(yield e.lrApiClient.validateAccessToken())try{if(e.conf.page.isRecommendationEnabled){var s=sessionStorage?sessionStorage.getItem(a.a.SAVED_RECOMMENDATION_CATEGORIES):void 0;if(s){var c=JSON.parse(s);yield e.saveRecommendationCategories(e.clientId,c),sessionStorage.removeItem(a.a.SAVED_RECOMMENDATION_CATEGORIES)}}var d=yield e.lrApiClient.getProfile(),u=d.FirstName,m=d.LastName,p=d.RegistrationProvider;if(document.querySelector(".".concat(q.DOM.id.contentBlocker))&&!u&&!m&&"apple"===p)throw new Error("Missing first and last name fields on conent blocker Apple sign in");if(t={created:d.CreatedDate,doNotContact:void 0,email:d.Email[0].Value,emailConfirmed:d.EmailVerified,familyName:m,gender:d.Gender,givenName:u,lastSignIn:d.LastLoginDate,name:d.FullName,uuid:d.Uid},e.conf.page.isRecommendationEnabled){var f=yield e.lrApiClient.getCustomObjectByToken();if(f&&f.IsActive&&f.CustomObject&&f.CustomObject.Recommendations&&f.CustomObject.Recommendations[e.clientId]){var h=f.CustomObject.Recommendations[e.clientId].categories;t=N(N({},t),{},{recommendationCategories:h})}}if(!o||!e.isJwtValid(o,u,m)){var v=yield e.lrApiClient.getJwtToken();localStorage.setItem(a.a.JWT,v)}Object(n.b)("info","Access token found: ",r)}catch(r){t=e.emptyProfile(),q.DeleteIdentityLocalStorage(),Object(n.b)("error","Unable to load profile or get JWT - ",r)}else t=e.emptyProfile(),q.DeleteIdentityLocalStorage(),Object(n.b)("info","Invalid or expired token");else t=e.emptyProfile(),q.DeleteIdentityLocalStorage(),Object(n.b)("info","Access token not found");document.dispatchEvent(i.c.event(l.a.IDENTITY_PROFILE_INIT,t))}))()}isJwtValid(e,t,r){var i=JSON.parse(atob(e.split(".")[1])),n=Math.floor(Date.now()/1e3);return i.exp>n&&"postmedia-user"===i.aud&&i.first_name===t&&i.last_name===r}initializeEmailValidationWidget(){this.emailValidationWidget=new A(q.DOM.class.emailValidationContainer,this.lrObject),this.emailValidationWidget.initEmailValidation()}afterFormRenders(e,t){var r=this;return U((function*(){var i,a=document.querySelectorAll("#".concat(t," input:not([type=submit]):not([type=reset]):not([type=button]):not([type=checkbox]):not([type=hidden])")),s=document.querySelectorAll("#".concat(t," [type=checkbox]")),c=document.querySelector("#".concat(t," [type=submit]")),l=document.querySelector("#".concat(t," form")),d=function(){var e=U((function*(e){e.preventDefault(),c&&(c.classList.add("loading"),c.disabled=!0);try{var t=new FormData(l),r=yield fetch(l.action,{body:t,method:l.method});if(r.ok){var i=yield r.json();Object(n.b)("info","Form submission success",i)}else Object(n.b)("error","Form submission error:",r.statusText)}catch(e){Object(n.b)("error","Form submission failed:",e)}}));return function(t){return e.apply(this,arguments)}}();if("registration"===e){var h=document.querySelector("#loginradius-registration-cf_BrandName"),v=document.querySelector("#loginradius-registration-password"),b=document.querySelector("#loginradius-registration-cf_register_platform");if(h&&(h.value=u.a.DOM.property),v&&(v.autocomplete="new-password"),l&&l.addEventListener("submit",d),b){var y,w=g.a.getMobileRedirectUrl()?"Unified":null===(y=r.pageData)||void 0===y||null===(y=y.analytics)||void 0===y?void 0:y.platform;b.value=w||""}}if("login"===e&&l&&c){var E,S=document.querySelector("#".concat(t)),O=null==S||null===(E=S.dataset)||void 0===E?void 0:E.prefillEmail;if(O&&S){var _=S.dataset.editLinkUrl;yield m.a.initDOM("#".concat(t),O,_,"login-email-input-edit"),S.addEventListener("login-email-input-edit",()=>{g.a.sendClickEvent("Edit Email","link","login-form-email-input-edit",location.href)})}l&&l.addEventListener("submit",d);var I=document.createElement("div");o.b.addClass(I,"identity__link-container");var A=document.createElement("a");o.b.addClass(A,"identity__link"),A.href="/forgot-password",A.innerHTML="Forgot Password?",I.appendChild(A),c.before(I),A.addEventListener(o.a.click,()=>{g.a.sendClickEvent(A.innerHTML,"link","login-form",A.href)})}switch(a.forEach(e=>{var t=e.parentElement,r=t.querySelector("label");o.b.addClass(e,"form__control"),o.b.addClass(e,"col-xs-12"),o.b.addClass(t,"form-container__field"),r&&o.b.addClass(r,"form__label")}),s.forEach(e=>{o.b.addClass(e,"form__control"),o.b.addClass(e.parentElement,"form__label--checkbox")}),o.b.addClass(c,"button"),o.b.addClass(c,"button--secondary"),o.b.addClass(c,"button--span"),l&&(l.setAttribute("autocomplete","on"),l.setAttribute("novalidate","")),yield f.a.initDOM(".".concat(q.DOM.class.identityForm)),(document.querySelector("#".concat(q.DOM.id.registrationContainer))||document.querySelector("#".concat(q.DOM.id.resetPasswordContainer)))&&(yield p.a.initDOM(q.DOM.class.passwordFieldContainer)),e){case"forgotpassword":i="forgot-password";break;case"login":i="login";break;case"registration":i="registration";break;case"resetpassword":i="reset-password"}i&&g.a.sendFormInteractionEvent(t,i);var T=document.querySelector(".".concat(q.DOM.class.buttonTextLive));T&&(T.textContent=T.textContent.replace("Live","Microsoft")),o.b.addClass(document.body,"identity-screen-form--active"),i&&document.dispatchEvent(new CustomEvent("form-".concat(i,"-loaded")))}))()}emptyProfile(){var e=s.a.get(a.a.ID),t=new d.a;return e&&(t.id=e.id),t}}F(q,"DOM",{class:{buttonTextLive:"button__text--live",emailValidationContainer:"email-validation-container",errorMessageContainer:"identity-form__message--error",identityForm:"identity-form",inputErrorMessage:"form-container__message--error",inputWrapperError:"form-container__field--error",myAccountPage:"page-my-account",passwordFieldContainer:"content-loginradius-password",profileShortcode:"postmedia-profile-shortcode",registerPage:"page-register",setPasswordPage:"page-set-password"},id:{contentBlocker:"article-block",forgotPasswordContainer:"forgotpassword-container",loginContainer:"login-container",registrationContainer:"registration-container",resetPasswordContainer:"resetpassword-container",socialLoginContainer:"social-login-container",socialLoginTemplate:"sociallogintemplate"}})},function(e,t,r){"use strict";function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,"a",(function(){return n}));class n{constructor(){i(this,"listeners",{})}addEventListener(e,t){return this.listeners[e]=this.listeners[e]||[],this.listeners[e].push(t),this}dispatchEvent(e){try{return(this.listeners[e.type]||[]).forEach(t=>"handleEvent"in t?t.handleEvent(e):t(e)),!0}catch(e){return!1}}removeEventListener(e,t){var r=(this.listeners[e]||[]).indexOf(t);r>=0&&this.listeners[e].splice(r,1)}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var i=function(e){return e[e.ACK=0]="ACK",e[e.DELETE=1]="DELETE",e[e.GET=2]="GET",e[e.SET=3]="SET",e}({})},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var i=function(e){return e.DISPLAY="adDisplay",e.SLOT_ADDED="adSlotAdded",e.STICKY_AD_CLOSED="stickyAdClosedEvent",e}({})},function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var i=r(0),n=r(18),o=r(14),a=r(5),s=r(1);function c(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class l{constructor(){c(this,"stack",[]),c(this,"forEach",this.stack.forEach)}find(e){return this.stack.find(e)}peek(){return this.stack[0]||void 0}push(e){return[].concat(e).forEach(e=>this.stack.push(e)),this.stack.length}remove(e){this.stack.splice(this.stack.indexOf(e),1)}shift(){return this.stack.shift()}take(e){return e>1?this.stack.splice(0,e):this.stack.shift()}}var d=r(25);function u(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function m(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){u(o,i,n,a,s,"next",e)}function s(e){u(o,i,n,a,s,"throw",e)}a(void 0)}))}}function p(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class f{constructor(e){p(this,"queue",new l),this.xdSrc=e,this.initIFrame(),this.xdOrigin=new URL(this.xdSrc).origin}request(e){var t=arguments,r=this;return m((function*(){var n=t.length>1&&void 0!==t[1]?t[1]:f.timeoutMs,o={id:e.id};yield r.ready;var s=a.c.promiseTimeout(new Promise((t,n)=>{o.resolve=t;try{Object(i.b)("debug","XDTransmitter iFrame.postMessage ".concat(e.action),"request on IFrame ".concat(r.xdSrc," with key ").concat(e.key),"req.data = ".concat(JSON.stringify(e.data))),r.iFrame.postMessage(e.send(),r.xdOrigin)}catch(t){Object(i.b)("error","XDTransmitter Exception ".concat(t," during ").concat(e.action),"request on IFrame ".concat(r.xdSrc," with key ").concat(e.key)),n(t)}}),n);r.queue.push(o);try{return yield s}catch(e){throw r.queue.remove(o),e}}))()}initIFrame(){var e=this;this.ready=new Promise(function(){var t=m((function*(t){yield s.b.ready;var r=document.getElementById(f.iFrameId);r||((r=document.createElement(s.b.tagNames.iFrame)).id=f.iFrameId,r.src="".concat(new URL(e.xdSrc).protocol,"//").concat(e.xdSrc.replace(/^(?:.*\/\/)?([^\/]+.*)$/,"$1"))+"#".concat(encodeURIComponent(document.location.href.replace(/^(.*\/\/[^\/]+).*$/,"$1"))),s.b.setVis(r,!1),document.body.appendChild(r));var i=!1;try{i="complete"===r.contentWindow.document.readyState&&"about:blank"!==r.contentWindow.location.href}catch(e){}i?(e.iFrame=r.contentWindow,t()):r.addEventListener(s.a.load,()=>{e.iFrame=r.contentWindow,t()}),window.addEventListener(s.a.message,e.onMessage.bind(e))}));return function(e){return t.apply(this,arguments)}}())}onMessage(e){if(e.origin===this.xdOrigin){var t=o.a.buildOne(d.a,e.data);if(t.validate())if(this.queue.peek()&&t.replyTo===this.queue.peek().id)for(this.queue.shift().resolve(t.data);this.queue.peek()&&void 0!==this.queue.peek().data;){var r=this.queue.shift();r.resolve(r.data||void 0)}else{var i=this.queue.find(e=>t.replyTo===e.id);i&&(i.data=t.data||"")}}}}p(f,"iFrameId","fem-xd"),p(f,"timeoutMs",a.b.secToMs);var g=r(30);class h extends g.a{constructor(e,t,r,i){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Date.now(),o=arguments.length>5?arguments[5]:void 0;super(e,r,n,o),this.action=e,this.key=t,this.data=r,this.exp=i,this.ts=n,this.updateHash(o)}}function v(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function b(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){v(o,i,n,a,s,"next",e)}function s(e){v(o,i,n,a,s,"throw",e)}a(void 0)}))}}var y=new class{constructor(e){Object(i.b)("debug","XDStorage constructor with xdSrc = ".concat(e)),this.xd=new f(e)}delete(e,t){var r=this;return b((function*(){return Object(i.b)("debug","XDStorage delete key = ".concat(e," with timeoutMs = ").concat(t,", xdSrc = ").concat(r.xd.xdOrigin)),r.xd.request(new h(n.a.DELETE,e),t)}))()}get(e,t){var r=this;return b((function*(){return Object(i.b)("debug","XDStorage get key = ".concat(e," with timeoutMs = ").concat(t,", xdSrc = ").concat(r.xd.xdOrigin)),r.xd.request(new h(n.a.GET,e),t)}))()}set(e,t,r,o){var a=this;return b((function*(){Object(i.b)("debug","XDStorage set key = ".concat(e),"with data = ".concat(JSON.stringify(t)),"timeoutMs = ".concat(o),"xdSrc = ".concat(a.xd.xdOrigin));try{return yield a.xd.request(new h(n.a.SET,e,t,r),o),!0}catch(e){return!1}}))()}}("".concat(r.p).concat("xd.html"))},function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var i=r(0),n=r(1);r(52);function o(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}var a,s,c,l=/\d/,d=/([A-Z].*[a-z]|[a-z].*[A-Z])/,u=/[$@#%^&*!~`()\-_+={}\\\[\]|:;"'<>,.?/]/;class m{static initDOM(e){var t,a=this;return(t=function*(){var t=a.getPasswordContainer(e);if(t){var o=t.querySelector("[type=password]");try{var s=(yield r.e(6).then(r.t.bind(null,60,7))).default,c=document.createElement("div");n.b.addClass(c,a.DOM.class.passwordRequirementsWrapper),c.id="id_".concat(Math.random().toString(16).slice(2)),c.innerHTML=s,t.after(c),o.setAttribute("aria-describedby",c.id),o.addEventListener("keyup",t=>{a.validateAndUpdateChecklistUI(e,t)}),o.addEventListener("paste",t=>{setTimeout(()=>{a.validateAndUpdateChecklistUI(e,t)},100)}),o.addEventListener("focus",()=>{a.showPasswordRequirementsList(e)}),Object(i.b)("info","Password requirements list initialized")}catch(e){Object(i.b)("error","Password requirements list not initialized",e)}}},function(){var e=this,r=arguments;return new Promise((function(i,n){var a=t.apply(e,r);function s(e){o(a,i,n,s,c,"next",e)}function c(e){o(a,i,n,s,c,"throw",e)}s(void 0)}))})()}static validateMinCharacters(e){return e.length>=10}static validateNumber(e){return l.test(e)}static validateUppercaseAndLowercase(e){return d.test(e)}static validateSpecialCharacter(e){return u.test(e)}static validateRequirements(e){var t=[];return t.push(this.validateMinCharacters(e)),t.push(this.validateNumber(e)),t.push(this.validateUppercaseAndLowercase(e)),t.push(this.validateSpecialCharacter(e)),t}static updateChecklistUI(e,t){e.forEach((e,r)=>{t[r]?n.b.addClass(e,this.DOM.class.validRequirement):n.b.removeClass(e,this.DOM.class.validRequirement)})}static showPasswordRequirementsList(e){var t=this.getPasswordRequirementsContainer(e);t&&!t.classList.contains(this.DOM.class.showPasswordRequirementsWrapper)&&n.b.addClass(t,this.DOM.class.showPasswordRequirementsWrapper)}static validateAndUpdateChecklistUI(e,t){var r=t.target,i=this.getPasswordRequirementsContainer(e).querySelectorAll("li"),n=this.validateRequirements(r.value);this.updateChecklistUI(i,n)}static getPasswordContainer(e){return document.querySelector(".".concat(e))}static getPasswordRequirementsContainer(e){var t=this.getPasswordContainer(e);return t&&t.nextElementSibling}}a=m,c={class:{passwordRequirementsWrapper:"password-requirements-wrapper",showPasswordRequirementsWrapper:"password-requirements-wrapper--show",validRequirement:"password-requirement--valid"},id:{passwordRequirementsWrapper:"password-requirements-wrapper"}},(s=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(s="DOM"))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var i=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,t=2,r=36,i=11,n="";n.length<e;)n+=Math.random().toString(r).slice(t).slice(-Math.min(i,e));return n}},function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var i,n,o,a=r(8),s=r(15),c=r(13),l=["hash"],d=["hash"];function u(e,t){if(null==e)return{};var r,i,n=function(e,t){if(null==e)return{};var r,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}class m extends a.a{constructor(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now(),i=arguments.length>3?arguments[3]:void 0;super(),this.action=e,this.data=t,this.ts=r,this.updateHash(i)}fromJson(e){return super.fromJson(e),e&&e.data&&(this.data=e.data),this}send(){return Object(c.a)(this)}validate(){var e=Object(c.a)(this),{hash:t}=e,r=u(e,l);return t===Object(s.a)(r)&&Date.now()-this.ts<m.lifespanMs}updateHash(e){var t=Object(c.a)(this),{hash:r}=t,i=u(t,d);this.hash=e||Object(s.a)(i)}}i=m,o=3e4,(n=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(n="lifespanMs"))in i?Object.defineProperty(i,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):i[n]=o},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n}));var i=function(e){return e.VERIFIED="ageVerified",e}({}),n=function(e){return e.VERIFIED="PageAgeGateVerified",e.VERIFYING="PageAgeGateVerifying",e.FAILED="PageAgeGateFailed",e}({})},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var i=r(23);class n extends i.a{constructor(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Date.now(),n=arguments.length>4?arguments[4]:void 0;super(e,r,i,n),this.action=e,this.replyTo=t,this.data=r,this.ts=i,this.updateHash(n)}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return Ce}));var i,n,o,a=r(6),s=r(5),c=r(0),l=r(1),d=r(20),u=r(2),m=r(9),p=r(11),f=r(4),g=r(27),h=r(36),v=r(3);function b(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}class y{init(){var e,t=this;return(e=function*(){if(Object(c.b)("debug","Initializing send passwordless email form"),t.passwordlessSignInForm=document.querySelector("#".concat(y.DOM.formId)),t.passwordlessSignInForm){var e,r=null===(e=t.passwordlessSignInForm.dataset)||void 0===e?void 0:e.prefillEmail,i=t.passwordlessSignInForm.dataset.editLinkUrl,n="passwordless-login-email-input-edit";yield h.a.initDOM("#".concat(y.DOM.formId),r,i,n),t.passwordlessSignInForm.addEventListener(n,()=>{v.a.sendClickEvent("Edit Email","link","passwordless-login-form-email-input-edit",location.href)})}Object(c.b)("debug","Send passwordless email form initialized")},function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){b(o,i,n,a,s,"next",e)}function s(e){b(o,i,n,a,s,"throw",e)}a(void 0)}))})()}}i=y,o={formId:"blockerSendPasswordlessEmailForm"},(n=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(n="DOM"))in i?Object.defineProperty(i,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):i[n]=o;var w=r(10),E=r(28),S=["csrfmiddlewaretoken"],O=["csrfmiddlewaretoken"],_=["csrfmiddlewaretoken"];function I(e,t){if(null==e)return{};var r,i,n=function(e,t){if(null==e)return{};var r,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function A(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function T(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){A(o,i,n,a,s,"next",e)}function s(e){A(o,i,n,a,s,"throw",e)}a(void 0)}))}}class P extends E.a{static sendPasswordlessEmail(e){return T((function*(){var t=document.querySelector("[name=csrfmiddlewaretoken]"),r=t?t.value:"";return P.postData("/api-root/subscription/identity/request_passwordless_link/",e,r)}))()}static sendVerificationEmail(e){return T((function*(){var{csrfmiddlewaretoken:t}=e,r=I(e,S);return P.postData("/api-root/subscription/identity/send_verification_email/",r,t)}))()}static sendResetPasswordEmail(e){return T((function*(){var{csrfmiddlewaretoken:t}=e,r=I(e,O);return P.postData("/api-root/subscription/identity/request_reset_password_email/",r,t)}))()}static resetPassword(e){return T((function*(){var{csrfmiddlewaretoken:t}=e,r=I(e,_);return P.postData("/api-root/subscription/identity/reset_password/",r,t)}))()}}function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){k(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function k(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class D{static getFields(){var e=[],t=document.querySelector("[data-id-form]");t&&t.querySelectorAll("input:not([type=hidden]), select").forEach(t=>{var r=t.name.replace(/[_][a-z1-9]/g,e=>e.slice(-1).toUpperCase());e=R(R({},e),{},{[r]:t.value})});return e}static structureErrors(e){return e.json?Object.entries(e.json).map(e=>{var[t,r]=e;return{key:t,message:r[0]}}):[{key:"non_field_errors",message:"Error: ".concat(e.statusText,". Please try again later.")}]}static clearErrors(){var e=document.querySelector(".".concat(D.DOM.identityFormErrorMessage));e&&e.remove(),document.querySelectorAll(".".concat(D.DOM.inputWrapperError)).forEach(e=>{var t=e.querySelector("input"),r=e.querySelector(".".concat(D.DOM.inputErrorMessage));l.b.removeClass(e,"".concat(D.DOM.inputWrapperError)),t&&(t.removeAttribute("aria-describedby"),t.removeAttribute("aria-invalid")),r&&r.remove()})}static showErrors(e,t){t.forEach(t=>{"non_field_errors"===t.key?D._showNonFieldError(e,t.message):D._showFieldError(t.key,t.message)})}static _showNonFieldError(e,t){var r=document.querySelector(e),i=document.createElement("div"),n=document.createElement("ul"),o=document.createElement("li");i.className=D.DOM.identityFormErrorMessage,i.setAttribute("role","alert"),n.className=D.DOM.errorList,o.innerHTML=t,n.appendChild(o),i.appendChild(n),r&&r.after(i)}static _showFieldError(e,t){var r=document.querySelector("#id_".concat(e)),i=document.createElement("span"),n=document.createElement("ul"),o=document.createElement("li"),a="id_".concat(e,"__error");if(r){var s=r.getAttribute("aria-describedBy");s||(s="".concat(a)),r.setAttribute("aria-describedBy",s),r.setAttribute("aria-invalid","true"),i.id=a,o.innerHTML=t,l.b.addClass(i,D.DOM.inputErrorMessage),l.b.addClass(n,"errorlist");var c=r.parentElement;l.b.addClass(c,D.DOM.inputWrapperError),n.appendChild(o),i.appendChild(n),c.appendChild(i)}}}function j(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function M(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){j(o,i,n,a,s,"next",e)}function s(e){j(o,i,n,a,s,"throw",e)}a(void 0)}))}}function L(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}k(D,"DOM",{errorList:"errorlist",identityFormErrorMessage:"identity-form__message--error",inputErrorMessage:"form-container__message--error",inputWrapperError:"form-container__field--error"});class N{constructor(){L(this,"submissionEventName","forgot-password")}init(){var e=this;Object(c.b)("debug","Initializing Forgot Password form");var t=this.getFormElement();t&&(document.addEventListener(f.a.FORM_VALIDATED,function(){var r=M((function*(r){r.detail.form===N.DOM.form&&(yield e.submitForm(t))}));return function(e){return r.apply(this,arguments)}}()),l.b.addClass(document.body,"identity-screen-form--active")),Object(c.b)("debug","Forgot Password form initialized")}submitForm(e){var t=this;return M((function*(){var r=new FormData(e),i={csrfmiddlewaretoken:void 0};r.forEach((e,t)=>i[t]=e);var n=v.a.buildRedirectUrl(location.origin),o=new URLSearchParams;if(o.append("redirect",n),sessionStorage){n.includes("/home-delivery/")&&(o.append(u.a.CAMPAIGN,sessionStorage.getItem(u.a.CAMPAIGN)),o.append(u.a.CAMPAIGN_NAME,sessionStorage.getItem(u.a.CAMPAIGN_NAME)),o.append(u.a.OFFER_GROUP,sessionStorage.getItem(u.a.OFFER_GROUP)));var a=v.a.getPianoParams();a&&o.append(u.a.PIANO_PARAMS,a)}i.query=o.toString();try{return yield P.sendResetPasswordEmail(i),t.onSuccess()}catch(e){var s=D.structureErrors(e);return t.onError(s)}}))()}onSuccess(){v.a.sendFormSubmissionEvent(this.submissionEventName),l.b.removeClass(document.body,w.a.FORM),l.b.addClass(document.body,w.a.SUCCESS)}onError(e){Object(c.b)("error",e),v.a.sendSubmissionErrorAnalytics(e,this.submissionEventName),v.a.clearErrors(),v.a.showErrors(e)}getFormElement(){return document.querySelector("[data-id-form=".concat(N.DOM.form,"]"))}}function x(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function U(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){x(o,i,n,a,s,"next",e)}function s(e){x(o,i,n,a,s,"throw",e)}a(void 0)}))}}function F(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}L(N,"DOM",{form:"forgotPasswordForm"});class V{constructor(){F(this,"isSubmitted",!1)}init(){var e=this;Object(c.b)("debug","Initializing send passwordless email form"),this.passwordlessSignInForm=document.querySelector("[data-id-form=".concat(V.DOM.form,"]")),this.passwordlessSignInForm&&document.addEventListener(f.a.FORM_VALIDATED,function(){var t=U((function*(t){if(t.detail.form===V.DOM.form&&!e.isSubmitted){e.isSubmitted=!0;try{yield e.submitForm()}catch(t){e.isSubmitted=!1}}}));return function(e){return t.apply(this,arguments)}}()),Object(c.b)("debug","Send passwordless email form initialized")}submitForm(){return U((function*(){var e=D.getFields().emailAddress,t=v.a.buildRedirectUrl(location.origin),r=new URL("/verify-passwordless/",location.origin);if(sessionStorage){t.includes("/home-delivery/")&&(r.searchParams.append(u.a.CAMPAIGN,sessionStorage.getItem(u.a.CAMPAIGN)),r.searchParams.append(u.a.CAMPAIGN_NAME,sessionStorage.getItem(u.a.CAMPAIGN_NAME)),r.searchParams.append(u.a.OFFER_GROUP,sessionStorage.getItem(u.a.OFFER_GROUP)));var i=v.a.getPianoParams();i&&r.searchParams.append(u.a.PIANO_PARAMS,i);var n=sessionStorage.getItem(u.a.ACTIVATE_BUTTON);n&&r.searchParams.append(u.a.ACTIVATE_BUTTON,n)}r.searchParams.append("redirect",t);var o=r.toString();try{yield P.sendPasswordlessEmail({email:e,verification_url:o}),sessionStorage&&sessionStorage.setItem(u.a.PASSWORDLESS_EMAIL_ADDRESS,e),v.a.sendFormSubmissionEvent("send-passwordless-email"),location.replace("/passwordless-email-sent/")}catch(e){throw Object(c.b)("error","Unable to send email containing passwordless login link",e),e}}))()}}F(V,"DOM",{form:"sendPasswordlessEmailForm"});var G,q=r(21),B=r(37);function W(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function z(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){W(o,i,n,a,s,"next",e)}function s(e){W(o,i,n,a,s,"throw",e)}a(void 0)}))}}function H(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Y{constructor(){H(this,"submissionEventName","reset-password")}init(e){var t=this;return z((function*(){Object(c.b)("debug","Initializing Reset Password form"),t.lrApiConfig=e;var r=t.getFormElement();r&&(yield B.a.initDOM("#".concat(Y.DOM.id.resetPasswordContainer)),document.addEventListener(f.a.FORM_VALIDATED,function(){var e=z((function*(e){e.detail.form===Y.DOM.form&&t.validateForm("[data-id-form=".concat(Y.DOM.form,"]"))&&(yield t.submitForm(r))}));return function(t){return e.apply(this,arguments)}}()),yield q.a.initDOM(Y.DOM.class.passwordFieldContainer),l.b.addClass(document.body,"identity-screen-form--active")),Object(c.b)("debug","Reset Password form initialized")}))()}submitForm(e){var t=this;return z((function*(){var r=new FormData(e),i={};r.forEach((e,t)=>i[t]=e);try{var n=(yield P.resetPassword(i)).Data;return t.onSuccess(n)}catch(e){var o=D.structureErrors(e);return t.onError(o)}}))()}onSuccess(e){var t=this;return z((function*(){v.a.sendFormSubmissionEvent(t.submissionEventName),l.b.removeClass(document.body,w.a.FORM),l.b.addClass(document.body,w.a.SUCCESS);var r=e.access_token;if(r){if(localStorage.setItem(u.a.LR_TOKEN_KEY,r),!e.jwttoken&&t.lrApiConfig){var i=v.a.getLRApiClient(t.lrApiConfig,r);e.jwttoken=yield i.getJwtToken()}setTimeout(z((function*(){yield t.authenticate(e)})),1500)}}))()}onError(e){Object(c.b)("error",e),v.a.sendSubmissionErrorAnalytics(e,this.submissionEventName),D.clearErrors();var t=Array.isArray(e)?e[0]:void 0;t&&"fatal_errors"===t.key?(l.b.removeClass(document.body,w.a.FORM),l.b.addClass(document.body,w.a.ERROR)):(v.a.showErrors(e),D.showErrors("[data-id-form=".concat(Y.DOM.form,"]"),e))}authenticate(e){return z((function*(){if(e.access_token&&sessionStorage&&localStorage){var t=new URLSearchParams(window.location.search);v.a.setSessionStorage(t),yield v.a.handleLoginSuccess(e)}else Object(c.b)("error","Password-reset authentication not possible")}))()}getFormElement(){return document.querySelector("[data-id-form=".concat(Y.DOM.form,"]"))}passwordConfirmation(e,t){return e===t}validateForm(e){var t=document.querySelector(e),r=t.querySelector("#".concat(Y.DOM.id.passwordInputField)),i=t.querySelector("#".concat(Y.DOM.id.confirmPasswordInputField)),n=[],o="Passwords must have a minimum of 10 characters, contain upper and lowercase letters, 1 number and 1 special character.";return q.a.validateRequirements(r.value).every(Boolean)||n.push({key:r.name,message:o}),q.a.validateRequirements(i.value).every(Boolean)||n.push({key:i.name,message:o}),n.length||this.passwordConfirmation(r.value,i.value)||n.push({key:i.name,message:"The Confirm Password field does not match the Password field."}),D.clearErrors(),n.length>0&&D.showErrors(e,n),!n.length}}function K(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function J(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){K(o,i,n,a,s,"next",e)}function s(e){K(o,i,n,a,s,"throw",e)}a(void 0)}))}}function X(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}H(Y,"DOM",{class:{passwordFieldContainer:"form-container__field--password"},form:"resetPasswordForm",id:{confirmPasswordInputField:"id_confirm_password",passwordInputField:"id_password",resetPasswordContainer:"id_reset_password_form"}});class ${constructor(){X(this,"submissionEventName","send-verification-email"),X(this,"successURL","/verify-email-success")}init(){var e=this;Object(c.b)("debug","Initializing Send Verification Email form");var t=this.getFormElement();t&&document.addEventListener(f.a.FORM_VALIDATED,function(){var r=J((function*(r){r.detail.form===$.DOM.form&&(yield e.submitForm(t))}));return function(e){return r.apply(this,arguments)}}()),Object(c.b)("debug","Send Verification Email Form initialized")}submitForm(e){var t=this;return J((function*(){var r=new FormData(e),i={};r.forEach((e,t)=>i[t]=e);try{return yield P.sendVerificationEmail(i),t.onSuccess()}catch(e){var n=D.structureErrors(e);return t.onError(n)}}))()}onSuccess(){v.a.sendFormSubmissionEvent(this.submissionEventName),location.assign(this.successURL)}onError(e){v.a.sendSubmissionErrorAnalytics(e,this.submissionEventName),D.clearErrors(),D.showErrors($.formSelector,e),Object(c.b)("error",e)}getFormElement(){return document.querySelector($.formSelector)}}function Q(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function Z(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){Q(o,i,n,a,s,"next",e)}function s(e){Q(o,i,n,a,s,"throw",e)}a(void 0)}))}}G=$,X($,"DOM",{form:"sendVerificationEmailForm"}),X($,"formSelector","[data-id-form=".concat(G.DOM.form,"]"));class ee{constructor(e){this.pianoAdapter=e}init(){var e=this;return Z((function*(){Object(c.b)("debug","Initializing verify address form"),document.querySelector("[data-id-form=".concat(ee.DOM.form,"]"))&&document.addEventListener(f.a.FORM_VALIDATED,function(){var t=Z((function*(t){t.detail.form===ee.DOM.form&&(yield e.submitForm())}));return function(e){return t.apply(this,arguments)}}()),document.querySelector(".".concat(ee.DOM.class.verifyDeliveryAddressSuccess))&&(document.dispatchEvent(s.c.event(f.a.IDENTITY_CHANGE,{conversions:void 0,subscriptions:void 0})),Object(c.b)("debug","Subscriber resource and term ids refreshed")),Object(c.b)("debug","Verify address form initialized")}))()}submitForm(){var e=this;return Z((function*(){var t=D.getFields();v.a.clearErrors();try{yield e.pianoAdapter.addPrintSubscriptionTerm(t),v.a.sendFormSubmissionEvent("verify-delivery-address"),location.assign("/verify-delivery-address-success")}catch(e){v.a.showErrors([{Description:"We are unable to verify your delivery address. Please try again later.",ErrorCode:400}])}}))()}}function te(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function re(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){te(o,i,n,a,s,"next",e)}function s(e){te(o,i,n,a,s,"throw",e)}a(void 0)}))}}function ie(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e,t,r){(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(ee,"DOM",{class:{verifyDeliveryAddressSuccess:"page-verify-delivery-address-success"},form:"verifyDeliveryAddressForm"});class ne{constructor(e,t,r,i,n,o){ie(this,"urlSwg","https://news.google.com/swg/js/v1/swg.js"),ie(this,"urlSwgGaa","https://news.google.com/swg/js/v1/swg-gaa.js"),ie(this,"urlGsiClient","https://accounts.google.com/gsi/client");this.authorizationUrl=e,this.allowedReferrers=t,this.subService=r,this.identityProvider=i,this.pianoAid=n,this.gnsOptions=o||{offerId:"OFPI60QPGCE1",templateId:"OT4PMPI615YZ"}}init(){var e=this;return re((function*(){e.isGnsEnabled(location.href)&&(yield l.b.ready,yield e.loadGoogleLibraries())}))()}loadGoogleLibraries(){var e=this;return re((function*(){l.b.loadScript(e.urlSwg,[{key:"subscriptions-control",value:"manual"}]),l.b.loadScript(e.urlSwgGaa),l.b.loadScript(e.urlGsiClient,void 0,void 0,re((function*(){try{yield e.gnsReady(),yield e.initGaaMetering(e.authorizationUrl,e.allowedReferrers),Object(c.b)("info","GNS scripts loaded")}catch(e){Object(c.b)("info","GNS scripts not loaded")}})))}))()}gnsReady(){return re((function*(){return new Promise((e,t)=>{window.GaaMetering&&window.GaaMetering.init?e(window.GaaMetering):setTimeout(()=>{window.GaaMetering&&window.GaaMetering.init?e(window.GaaMetering):t(new Error("GNS libs"))},1e3)})}))()}updateUserState(e,t){var r={granted:!t||e.adLight};if(r.granted&&(r.grantReason="METERING"),e&&e.email){if(r.id=e.uuid,r.registrationTimestamp=new Date(e.created).getTime(),e&&e.subscriptions&&e.adLight)for(var i of e.subscriptions)i.aid===this.pianoAid&&(r.subscriptionTimestamp=i.start,r.grantReason="SUBSCRIBER",Object(c.b)("info","updateUserState user is subscribed, userState ".concat(JSON.stringify(r))))}else Object(c.b)("info","updateUserState user is anonymous, userState ".concat(JSON.stringify(r)));return localStorage?localStorage.setItem(u.a.GNS_USER_STATE,JSON.stringify(r)):Object(c.b)("warn","updateUserState localStorage is unavailable"),r}readUserState(){var e={granted:!0,grantReason:"METERING"};return localStorage?e=JSON.parse(localStorage.getItem(u.a.GNS_USER_STATE))||e:(Object(c.b)("warn","updateUserState localStorage is unavailable"),e={granted:!0}),e}initGaaMetering(e,t){var r=this;return re((function*(){var i=new Promise(function(){var e=re((function*(e){try{yield window.GaaMetering.getLoginPromise().then(()=>r.identityProvider.signIn()),Object(c.b)("info","initGaaMetering getLoginPromise user logged in"),e(r.readUserState())}catch(e){Object(c.b)("error","initGaaMetering getLoginPromise error")}}));return function(t){return e.apply(this,arguments)}}()),n=new Promise(()=>{Object(c.b)("info","gnsshowcase registerUserPromise")}),o=new Promise(e=>{e(r.readUserState())}),a={allowedReferrers:t||["*"],authorizationUrl:e||"",handleLoginPromise:i,handleSwGEntitlement:r.handleSwGEntitlement.bind(r),publisherEntitlementPromise:o,registerUserPromise:n,showPaywall:r.showPaywall.bind(r),unlockArticle:r.unlockArticle.bind(r),userState:r.readUserState()};window.GaaMetering.init(a),Object(c.b)("info","initGaaMetering is initialized")}))()}handleSwGEntitlement(){this.subService.closeCheckoutModal(),Object(c.b)("info","initGaaMetering handleSwGEntitlement")}showPaywall(){this.subService&&this.gnsOptions&&this.gnsOptions.offerId&&this.gnsOptions.templateId?(this.subService.closeCheckoutModal(),this.subService.showPaywall(this.gnsOptions.offerId,this.gnsOptions.templateId)):Object(c.b)("error","GNS showpaywall undefined offerId and templateId"),Object(c.b)("info","GNS initGaaMetering showPaywall")}unlockArticle(){this.subService?(this.subService.closeCheckoutModal(),Object(c.b)("info","GNS unlockArticle article unlocked")):Object(c.b)("info","GNS unlockArticle - piano not ready")}isGnsEnabled(e){var t=new URL(e),r=new URLSearchParams(t.search);return r.has("utm_source")&&"newsshowcase"===r.get("utm_source")&&r.has("utm_medium")&&"gnews"===r.get("utm_medium")&&r.has("gaa_at")&&r.has("gaa_ts")&&r.has("gaa_n")&&r.has("gaa_sig")}reloadIfNeeded(){var e=sessionStorage?sessionStorage.getItem(u.a.GNS_REDIRECT_URL):void 0;e&&this.isGnsEnabled(e)&&!this.isGnsEnabled(location.href)&&location.href.replace(/\/$/,"")!=="".concat(location.origin,"/sign-in")&&(sessionStorage.removeItem(u.a.GNS_REDIRECT_URL),location.assign(e))}}class oe{init(){var e=document.querySelector(".".concat(oe.DOM.class.pageNewsletterOptIn)),t=document.querySelector(".".concat(oe.DOM.class.pageOnboardNewsletterOptIn));if(e||t){var r=m.a.get(u.a.ID),i=document.querySelector("[".concat(oe.DOM.attrs.newsletterSignup,"]")),n=document.querySelectorAll("[".concat(oe.DOM.attrs.newsletterMaybeLater,"]")),o=r&&r.email?r.email:void 0,a=r&&r.adLight,s=v.a.getRegistrationSuccessURL(location.origin);this.mainBanner=document.querySelector(".".concat(oe.DOM.class.newsletterOptInMain)),this.successBanner=document.querySelector(".".concat(oe.DOM.class.newsletterOptInSuccess)),this.errorBanner=document.querySelector(".".concat(oe.DOM.class.newsletterOptInError)),i&&i.addEventListener("click",()=>{var e=i.getAttribute(oe.DOM.attrs.newsletterSignup);if(!a&&t)return Object(c.b)("error","User is not subscribed."),void this.showErrorMessage();window.Sailthru&&(o?window.Sailthru.integration("userSignUp",{email:o,lists:{[e]:1},onError:()=>{Object(c.b)("error","Unable to sign up for newsletter."),this.showErrorMessage()},onSuccess:()=>{Object(c.b)("info","Newsletter sign up successful."),this.showSuccessMessage()}}):(Object(c.b)("error","User is not logged in"),this.showErrorMessage()))}),n.length>0&&n.forEach(e=>{e.addEventListener("click",()=>{location.replace(s)})})}}showSuccessMessage(){this.mainBanner&&this.successBanner&&(this.mainBanner.setAttribute("hidden","hidden"),this.successBanner.removeAttribute("hidden"))}showErrorMessage(){this.mainBanner&&this.errorBanner&&(this.mainBanner.setAttribute("hidden","hidden"),this.errorBanner.removeAttribute("hidden"))}}function ae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(r),!0).forEach((function(t){le(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ae(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ce(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function le(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e,t,r){(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(oe,"DOM",{attrs:{newsletterMaybeLater:"data-newsletter-maybe-later",newsletterSignup:"data-newsletter-sign-up"},class:{newsletterOptInError:"newsletter-opt-in__error",newsletterOptInMain:"newsletter-opt-in__main",newsletterOptInSuccess:"newsletter-opt-in__success",pageNewsletterOptIn:"page-newsletter-opt-in",pageOnboardNewsletterOptIn:"page-onboard-newsletter-opt-in"}});class de{init(){var e=this;if(document.querySelector(".".concat(de.DOM.class.onboardFollowAuthor))){var t=document.querySelectorAll("[".concat(de.DOM.attr.followAuthorCheckbox,"]")),r=document.querySelector("[".concat(de.DOM.attr.followAuthorForm,"]")),i=m.a.get(u.a.ID),n=i&&i.email?i.email:void 0;if(t&&t.forEach(e=>{e.addEventListener("change",e=>{var t=e.target,r=t.parentElement;t.checked?l.b.addClass(r,de.DOM.class.followAuthorChecked):l.b.removeClass(r,de.DOM.class.followAuthorChecked)})}),r){var o=r.getAttribute(de.DOM.attr.followAuthorForm);r.addEventListener("submit",function(){var t,r=(t=function*(t){var r=document.querySelectorAll("[".concat(de.DOM.attr.followAuthorCheckbox,"]")),i={};if(t.preventDefault(),r.forEach(e=>{if(e.checked){var t=e.getAttribute(de.DOM.attr.followAuthorCheckbox);i=se(se({},i),{},{[t]:"Y"})}}),0===Object.keys(i).length)return Object(c.b)("info","OnboardFollowAuthor.init - No authors selected"),void e.redirectToNextStep();Object(c.b)("info","OnboardFollowAuthor.init - authors selected: ",i),window.Sailthru&&(n?window.Sailthru.integration("userSignUp",{email:n,lists:{[o]:1},onError:()=>{Object(c.b)("error","OnboardFollowAuthor.init - Unable to sign up for newsletter"),e.redirectToNextStep()},onSuccess:()=>{Object(c.b)("info","OnboardFollowAuthor.init - Newsletter sign up successful"),e.redirectToNextStep()},vars:i}):(Object(c.b)("error","OnboardFollowAuthor.init - User is not logged in"),e.redirectToNextStep()))},function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function a(e){ce(o,i,n,a,s,"next",e)}function s(e){ce(o,i,n,a,s,"throw",e)}a(void 0)}))});return function(e){return r.apply(this,arguments)}}())}}}redirectToNextStep(){setTimeout(()=>{v.a.sendFormSubmissionEvent("onboard-follow-author")},0),Object(c.b)("info","redirecting to newsletter opt in onboarding page"),location.replace("/onboard-newsletter-opt-in/")}}le(de,"DOM",{attr:{followAuthorCheckbox:"data-follow-author-checkbox",followAuthorForm:"data-follow-author-form"},class:{followAuthorChecked:"follow-author__checkbox--checked",onboardFollowAuthor:"page-onboard-follow-author"}});class ue{init(){if(document.querySelector(".".concat(ue.DOM.class.pageOnboardPuzzles))){var e=document.querySelector("[".concat(ue.DOM.attrs.continueButton,"]")),t=v.a.getRedirectUrl(location.origin);e&&e.addEventListener("click",()=>{Object(c.b)("info","Onboard puzzles continue - redirecting"),location.replace(t)})}}}!function(e,t,r){(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(ue,"DOM",{attrs:{continueButton:"data-onboard-puzzles-continue"},class:{pageOnboardPuzzles:"page-onboard-puzzles"}});class me{init(){if(document.querySelector(".".concat(me.DOM.class.passwordlessEmailSentPage))){if(sessionStorage){var e=sessionStorage.getItem(u.a.PASSWORDLESS_EMAIL_ADDRESS),t=document.querySelector(".".concat(me.DOM.class.passwordlessEmail));t&&(t.innerHTML=e)}l.b.addClass(document.body,w.a.FORM),Object(c.b)("debug","Passwordless email sent page loaded")}}}!function(e,t,r){(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(me,"DOM",{class:{passwordlessEmail:"passwordless-email",passwordlessEmailSentPage:"page-passwordless-email-sent"}});class pe{constructor(e){this.subService=e}init(){if(document.querySelector(".".concat(pe.DOM.class.pageRegistrationSuccess))){var e=document.querySelector("[".concat(pe.DOM.attrs.registrationSuccessContinueButton,"]"));this.showOffer();var t=v.a.getRedirectUrl(location.origin);e&&e.addEventListener("click",()=>{Object(c.b)("info","Registration success - redirecting"),location.replace(t)})}}showOffer(){var e=document.querySelector(pe.DOM.selectors.offer),t=e?e.dataset.registrationSuccess__offer_id:void 0,r=e?e.dataset.registrationSuccess__template_id:void 0;t&&r&&this.subService.showOffer(t,r,"inline",pe.DOM.selectors.offer)}}function fe(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}!function(e,t,r){(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(pe,"DOM",{attrs:{registrationSuccessContinueButton:"data-registration-success-continue"},class:{pageRegistrationSuccess:"page-registration-success"},selectors:{offer:"#registration-success__offer"}});class ge extends E.a{static verifyPasswordlessLogin(e){return(t=function*(){var t=document.querySelector("[name=csrfmiddlewaretoken]"),r=t?t.value:"";return ge.postData("/api-root/subscription/identity/verify_passwordless_login/",e,r)},function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function a(e){fe(o,i,n,a,s,"next",e)}function s(e){fe(o,i,n,a,s,"throw",e)}a(void 0)}))})();var t}}function he(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function ve(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class be{constructor(){ve(this,"tokenQueryStringKey","vtoken")}init(e){var t,r=this;return(t=function*(){var t=document.querySelector(".".concat(be.DOM.class.pageVerifyPasswordless)),i=new URLSearchParams(window.location.search),n=[];if(t){if(i.has(r.tokenQueryStringKey)){var o=i.get(r.tokenQueryStringKey),a=i.get(u.a.ACTIVATE_BUTTON);a&&sessionStorage.setItem(u.a.ACTIVATE_BUTTON,a);try{var s=yield ge.verifyPasswordlessLogin({vtoken:o}),l=s.access_token;if(l&&sessionStorage&&localStorage){if(v.a.setSessionStorage(i),localStorage.setItem(u.a.LR_TOKEN_KEY,l),!s.jwttoken&&e){var d=v.a.getLRApiClient(e,l);s.jwttoken=yield d.getJwtToken()}yield v.a.handleLoginSuccess(s)}else Object(c.b)("error","Passwordless email link is invalid"),n=[{Message:"Passwordless email link is invalid",Id:"-"}]}catch(e){Object(c.b)("error","Unable to verify passwordless email link",e),n=[{Message:"Unable to verify passwordless email link",Id:"-"}]}}else Object(c.b)("error","Missing vtoken parameter in passwordless email link"),n=[{Message:"Missing vtoken parameter in passwordless email link",Id:"-"}];n.length&&r.sendErrorsAndRedirect(n)}},function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function a(e){he(o,i,n,a,s,"next",e)}function s(e){he(o,i,n,a,s,"throw",e)}a(void 0)}))})()}sendErrorsAndRedirect(e){v.a.sendSubmissionErrorAnalytics(e,"verify-passwordless"),window.location.replace("/verify-passwordless-error/")}}function ye(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function we(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){ye(o,i,n,a,s,"next",e)}function s(e){ye(o,i,n,a,s,"throw",e)}a(void 0)}))}}function Ee(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}ve(be,"DOM",{class:{pageVerifyPasswordless:"page-verify-passwordless"}});class Se{constructor(){Ee(this,"DOM",{class:{appLoader:"app-loader",profileShortcode:"postmedia-profile-shortcode"},dataAppContainer:"data-app-container",dataAppPath:"data-app-path"}),this.initialize().then(()=>{Object(c.b)("debug","Initialize Profile Service App")}).catch(()=>{Object(c.b)("error","Profile Service App not initialized")})}initialize(){var e=this;return we((function*(){var t;if(yield l.b.ready,e.appShortcode=document.querySelector(".".concat(e.DOM.class.profileShortcode)),e.appShortcode&&(e.appType=e.appShortcode.getAttribute("".concat(e.DOM.dataAppContainer)),(t=e.appShortcode.getAttribute("".concat(e.DOM.dataAppPath)))&&(e.URLPath="".concat(t,"/static/js/main.js")),e.URLPath&&e.appType))try{yield e.addLoader(),Object(c.b)("debug","Profile service loader added"),e.loadAppScript(),e.removeLoader()}catch(e){Object(c.b)("error","Profile service loader not added: ".concat(e))}}))()}loadAppScript(){l.b.loadScript(this.URLPath),Object(c.b)("debug","Load Profile Service App script ".concat(this.URLPath))}addLoader(){var e=this;return we((function*(){var t=document.createElement("div");if(t.className="".concat(e.DOM.class.appLoader),e.appShortcode){e.appShortcode.appendChild(t);var i=r.e(3).then(r.t.bind(null,70,7));l.b.addStyles((yield i).default)}}))()}removeLoader(){var e=document.querySelector(".".concat(this.DOM.class.appLoader));e&&e.remove()}}var Oe=r(29);function _e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function Ie(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(r),!0).forEach((function(t){Pe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ae(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function Te(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){Ae(o,i,n,a,s,"next",e)}function s(e){Ae(o,i,n,a,s,"throw",e)}a(void 0)}))}}function Pe(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ce{constructor(){var e=this;this.subscriptionServiceEnabled=!1,this.profile=m.a.get(u.a.ID)||new g.a,d.a.get(u.a.ID).then(e=>{e&&e.email===this.profile.email&&(this.profile.ageOfMajority=e.ageOfMajority,this.profile.id=e.id)}).catch(console.log),document.addEventListener(f.a.IDENTITY_PROFILE_INIT,function(){var t=Te((function*(t){Object(c.b)("debug","Identity profile init event, updating profile"),yield e.update(t.detail)}));return function(e){return t.apply(this,arguments)}}())}static StoreProfile(e){return Te((function*(){var t=s.c.prune(e);m.a.set(u.a.ID,t),delete t.subscriptions,yield d.a.set(u.a.ID,t)}))()}static removeSubscriptionAlert(e){document.body.classList.contains(e)&&(document.querySelector(".".concat(Ce.DOM.class.subscriptionAlert)).remove(),document.body.classList.remove(e),window.dispatchEvent(new CustomEvent("articleLimitAlertEvent",{detail:{limit:!1}})))}initialize(e,t,r,i){var n=this;return Te((function*(){var o,a;n.conf=e,n.profile.adLightDisabled=n.conf.page.abTest&&n.conf.page.abTest.AdLight&&!n.conf.page.abTest.AdLight.enabled,n.identityProvider=t,n.subscriberService=r,n.commentService=i,n.loginService=v.a;var d="",u=[],m={offerId:"",templateId:""};if(e.identity&&(o=e.identity.sso,a=e.identity.subscriber,m=e.identity.gnsOptions,Ce.DOM.links=e.identity.links,Ce.DOM.logo=e.identity.logo,Ce.DOM.property=e.identity.property,e.identity.sso&&e.identity.sso.loginradius)){var p=new URLSearchParams(location.search);p.has("lr-token")&&p.delete("lr-token");var g="https://".concat(location.host).concat(location.pathname,"?").concat(p.toString());d="https://".concat(e.identity.sso.loginradius.appName,".hub.loginradius.com/RequestHandler.aspx?apikey=").concat(e.identity.sso.loginradius.apiKey,"&provider=google&same_window=&is_access_token=true&callbacktype=QueryString&disablesignup=undefined&scope=&callback=").concat(encodeURIComponent(g)),u=["localhost","".concat(e.identity.sso.loginradius.appName,".hub.loginradius.com"),window.location.host]}if(n.hasSubscriptions=!!a,n.hasRegistrantTerm=!!n.hasSubscriptions&&!!a.registrantTermId,n.subscriptionClientId=n.hasSubscriptions?a.registrantTermId:"",n.subscriptionAppId=n.hasSubscriptions?a.account:"",n.hasRegistrantResId=!!n.hasSubscriptions&&!!a.registrantResId,n.subscriptionRegistrantResId=n.hasRegistrantResId?a.registrantResId:"",n.subscriberService&&(n.subscriptionServiceEnabled=!0),n.extendedAccessService=new ne(d,u,n.subscriberService,n.identityProvider,n.subscriptionAppId,m),n.extendedAccessService.reloadIfNeeded(),document.addEventListener(l.a.PIANO_METER_EVENT,function(){var e=Te((function*(e){n.isMeterExpired=e.detail.meterData.expired,n.extendedAccessService&&(n.userState=n.extendedAccessService.updateUserState(n.profile,n.isMeterExpired),Object(c.b)("info","Piano meter event ".concat(JSON.stringify(e.detail),", userState ").concat(JSON.stringify(n.userState))),yield n.extendedAccessService.init())}));return function(t){return e.apply(this,arguments)}}()),o?(document.addEventListener(f.a.COMMENT_LOGIN,e=>{var t=e.detail.commentRedirect,r=location.search.length>0?"&comments":"?comments",i=t?location.href+r:location.href;n.identityProvider.signIn(i),Object(c.b)("debug","IdentityService Event COMMENT_LOGIN; redirect: ".concat(t))}),document.addEventListener(f.a.COMMENT_LOGOUT,()=>{n.identityProvider.signOut(),Object(c.b)("debug","IdentityService Event COMMENT_LOGOUT")}),document.addEventListener(f.a.LOGIN_MODAL_READY,n.loginModalReady.bind(n)),document.addEventListener(f.a.IDENTITY_CHANGE,function(){var e=Te((function*(e){Object(c.b)("debug","Identity change event, updating profile"),yield n.update(e.detail),Object(c.b)("debug","Identity change event, updating UI"),yield n.updateUI(),n.extendedAccessService&&(n.userState=n.extendedAccessService.updateUserState(n.profile,n.isMeterExpired),Object(c.b)("info","Identity change event, userState ".concat(JSON.stringify(n.userState))))}));return function(t){return e.apply(this,arguments)}}()),yield n.session(),n.profileService=new Se,n.passwordlessEmailForm=new V,n.passwordlessEmailForm.init(),n.blockerPasswordlessEmailForm=new y,yield n.blockerPasswordlessEmailForm.init(),n.passwordEmailSent=new me,n.passwordEmailSent.init(),n.newsletterOnboarding=new oe,n.newsletterOnboarding.init(),n.registrationSuccess=new pe(n.subscriberService),n.registrationSuccess.init(),n.followAuthorsOnboarding=new de,n.followAuthorsOnboarding.init(),n.onboardPuzzles=new ue,n.onboardPuzzles.init()):yield n.update(n.profile),e.identity){var h;if(e.identity.sso)h={apiKey:e.identity.sso.hasOwnProperty("loginradius")?e.identity.sso.loginradius.apiKey:"",appName:e.identity.sso.hasOwnProperty("loginradius")?e.identity.sso.loginradius.appName:"",integrationName:"news-websites",objectName:"postmedia-obj"};n.verifyPasswordless=new be,yield n.verifyPasswordless.init(h),n.resetPasswordForm=new Y,yield n.resetPasswordForm.init(h),n.identityProvider.initializeEmailValidationWidget(),n.verificationEmailForm=new $,n.verificationEmailForm.init(),n.forgotPasswordForm=new N,n.forgotPasswordForm.init()}return n.hasSubscriptions&&(n.printActivatedTermId=a?a.activateTermId:"",Object(c.b)("debug","IdentityService.initialize - property has subscriptions, updating subscriptions"),yield n.updateSubscriptions(),Object(c.b)("debug","IdentityService.initialize - updating conversions"),yield n.updateConversions(),n.sophi=new Oe.b(n.subscriberService,e.page,e.identity.sophiPaywallOffer,e.identity.useSophiDecision,n.extendedAccessService.isGnsEnabled(location.href)),yield n.sophi.init(),Object(c.b)("debug","IdentityService.initialize - adding Sophi"),n.verifyAddressForm=new ee(r),yield n.verifyAddressForm.init(),Object(c.b)("debug","VerifyAddressForm.initialize - adding form validation event listener")),document.dispatchEvent(s.c.event(f.a.IDENTITY_INIT,n.profile)),yield n.loginModalReady(),Object(c.b)("debug","IdentityService.initialize - updating UI"),yield n.updateUI(),Object(c.b)("info","Identity init event, userState ".concat(JSON.stringify(n.extendedAccessService.readUserState()))),n}))()}getProfile(){return this.profile}update(e){var t=this;return Te((function*(){if(Object(c.b)("debug","IdentityService.update with incoming profile: ",e),e.updated&&t.profile&&e.updated<t.profile.updated)Object(c.b)("debug","IdentityService.update - outdated data, exiting");else{var r=t.profile&&t.profile.email!==e.email;Object(c.b)("debug","IdentityService.update - newLogin is "+r),r&&(t.profile=Ie(Ie({},t.profile),{},{conversions:void 0,subscriptions:void 0}),Object(c.b)("debug","IdentityService.update - conversions and subscriptions cleared")),t.profile=Ie(Ie({},t.profile),e);var i=s.c.hashCode(s.c.prune(t.profile));if(t.hashCode&&i===t.hashCode)Object(c.b)("debug","IdentityService.update - profile unchanged, exiting");else{!t.hashCode&&t.profile.updated||(t.profile.updated=Date.now()),t.hashCode=i,t.hasSubscriptions&&(Object(c.b)("debug","IdentityService.update - property has subscriptions, updating subscriptions"),yield t.updateSubscriptions(),Object(c.b)("debug","IdentityService.update - subscriptions updated"),r&&(Object(c.b)("debug","IdentityService.update - new login, updating conversions"),yield t.updateConversions(),Object(c.b)("debug","IdentityService.update - conversions updated")),t.updatePrintSubscriber()),t.profile.updated=Date.now(),t.hashCode=s.c.hashCode(s.c.prune(t.profile)),t.profile.email&&r&&document.dispatchEvent(new CustomEvent(f.a.NEW_LOGIN,{detail:{data:t.profile}}));var n=v.a.getPianoParams();(t.openCheckoutAfterLogin||n)&&t.offerId&&t.termId&&(t.subscriberService.showCheckoutModal(t.offerId,t.termId,t.subscribeButton),t.openCheckoutAfterLogin=!1),yield Ce.StoreProfile(t.profile),s.c.dispatchEventWithFemFlagSet(f.a.IDENTITY_READY,{detail:t.profile})}}}))()}loginModalReady(){var e=this;return Te((function*(){yield l.b.ready,e.addListeners();var t=document.querySelectorAll("[".concat(Ce.DOM.attrs.signIn,"]"));if(t.length&&t.length>0){t[0].removeAttribute("style"),t[0].classList.add("signin-button--modal-ready"),t[0].setAttribute("aria-disabled","false"),t[0].disabled=!1;var r=document.getElementsByClassName("signInLoader");r.length&&r.length>0&&t[0].removeChild(r[0])}}))()}subscribed(){return(this.profile.subscriptions||[]).filter(e=>e.aid===this.subscriptionAppId&&e.id!==this.subscriptionRegistrantResId).length>0}updatePrintSubscriber(){var e=(this.profile.conversions||[]).filter(e=>e===this.printActivatedTermId);this.profile.printSubscriber=e.length>0,Object(c.b)("info","Print Subscriber: ",this.profile.printSubscriber)}updateUI(){var e=this;return Te((function*(){yield l.b.ready,Object(c.b)("info","updating UI");var t=e.profile.adLight&&!e.profile.adLightDisabled,r=e.subscribed();if(Object(c.b)("info","subscribed: ",r),t&&(e.commentService.removeCommentWidgetsAdUI(),e.removeAdSlotElements()),e.setName(e.profile.email?e.profile.name:void 0).catch(console.log),e.signedIn()){(t||r)&&Ce.removeSubscriptionAlert("article-counter--visible"),Ce.removeSubscriptionAlert("register-counter--visible"),document.body.classList.contains("register-modal--visible")&&(document.body.classList.remove("register-modal--visible"),e.subscriberService.closeCheckoutModal()),l.b.updateTabs(document.querySelectorAll("[".concat(Ce.DOM.attrs.signIn,"]")),-1),l.b.updateTabs(document.querySelectorAll("[".concat(Ce.DOM.attrs.signOut,"]")));var i=document.querySelector("[".concat(Ce.DOM.attrs.myAccountBtn,"]"));i&&(i.hidden=!1),l.b.updateTabs(document.querySelectorAll("[".concat(Ce.DOM.attrs.myAccountBtn,"]")))}else l.b.updateTabs(document.querySelectorAll("[".concat(Ce.DOM.attrs.signIn,"]"))),l.b.updateTabs(document.querySelectorAll("[".concat(Ce.DOM.attrs.signOut,"]")),-1),l.b.updateTabs(document.querySelectorAll("[".concat(Ce.DOM.attrs.myAccountBtn,"]")),-1);document.querySelectorAll("[".concat(Ce.DOM.attrs.marker,"]")).length?l.b.nodes(document.querySelectorAll("[".concat(Ce.DOM.attrs.marker,"], body"))).forEach(t=>{e.signedIn()?e.signedIn()&&l.b.replaceClass(t,Ce.DOM.class.signedOut,Ce.DOM.class.signedIn):l.b.replaceClass(t,Ce.DOM.class.signedIn,Ce.DOM.class.signedOut)}):(l.b.setVis(document.querySelectorAll("[".concat(Ce.DOM.attrs.signIn,"]")),!e.signedIn()),l.b.setVis(document.querySelectorAll("[".concat(Ce.DOM.attrs.signOut,"]")),!!e.signedIn()),l.b.setVis(document.querySelectorAll("[".concat(Ce.DOM.attrs.myAccountBtn,"]")),!!e.signedIn()))}))()}session(){var e=this;return Te((function*(){var t=e.profile;Object(c.b)("info","identity session called with profile:",t),yield e.commentService.initialize(e.conf.ads,e.identityProvider.getAccessToken()),document.dispatchEvent(s.c.event(f.a.IDENTITY_SESSION_PROFILE_INIT,t)),yield e.update(t)}))()}addListeners(){var e=this;document.addEventListener("click",function(){var t=Te((function*(t){var r=t.target;r.classList.contains(Ce.DOM.class.buttonText)&&(r=r.parentElement);var i,n=localStorage.getItem(u.a.LR_TOKEN_KEY);i=r.getAttribute(Ce.DOM.attrs.loginRedirect)?(-1!==r.getAttribute(Ce.DOM.attrs.loginRedirect).indexOf("http")?"":location.origin)+r.getAttribute(Ce.DOM.attrs.loginRedirect):location.origin,r.hasAttribute(Ce.DOM.attrs.loginRedirect)&&!n?e.identityProvider.signIn(i):r.hasAttribute(Ce.DOM.attrs.loginRedirect)&&n&&location.assign(i),r.hasAttribute(Ce.DOM.attrs.signIn)?(e.openCheckoutAfterLogin=!1,e.identityProvider.signIn()):r.hasAttribute(Ce.DOM.attrs.signOut)?(e.commentService&&(Object(c.b)("info","identity sign out called - signing out vf widget"),yield e.commentService.doWidgetSignout(),Object(c.b)("info","widget signed out successfully")),Object(c.b)("info","identity sign out called - signing out FEM"),e.identityProvider.signOut()):r.hasAttribute(Ce.DOM.attrs.offerId)&&e.subscriberService?e.handleOfferButton(r):r.hasAttribute(Ce.DOM.attrs.activateButton)&&e.subscriberService&&(t.preventDefault(),e.handleActivateButton())}));return function(e){return t.apply(this,arguments)}}())}handleOfferButton(e){this.offerId=e.getAttribute(Ce.DOM.attrs.offerId),this.termId=e.getAttribute(Ce.DOM.attrs.termId),this.offerId&&this.termId&&this.subscriberService.showCheckoutModal(this.offerId,this.termId,e)}handleActivateButton(){var e=this.profile;e&&e.printSubscriber?location.assign("/already-activated/"):this.signedIn()?location.assign("/verify-delivery-address/"):(sessionStorage&&(sessionStorage.setItem(u.a.ACTIVATE_BUTTON,"true"),v.a.setRedirectUrl("".concat(location.origin,"/verify-delivery-address/"))),location.assign("/register/"))}setName(e){return Te((function*(){yield l.b.ready,l.b.nodes(document.querySelectorAll("[".concat(Ce.DOM.attrs.name,"]"))).forEach(t=>{l.b.setVis(t,!!e),t.innerHTML=e})}))()}updateConversions(){var e=this;return Te((function*(){if(e.profile.email){if(void 0===e.profile.conversions&&e.hasRegistrantTerm){var t=yield e.subscriberService.getConversions();e.profile.conversions=t,Object(c.b)("debug","IdentityService.updateConversions - conversions:",t),e.profile.conversions&&-1===e.profile.conversions.indexOf(e.subscriptionClientId)&&(Object(c.b)("debug","IdentityService.updateConversions - registering for One digital access"),yield e.subscriberService.registerForOneDigital(e.conf.identity.subscriber.account),Object(c.b)("debug","IdentityService.updateConversions - registered for One digital access"),e.profile.conversions=[...e.profile.conversions,e.subscriptionClientId])}}else Object(c.b)("debug","IdentityService.updateConversions - no email, not updating conversions"),e.profile.conversions=void 0}))()}updateSubscriptions(){var e=this;return Te((function*(){if(e.profile.email){if(void 0===e.profile.subscriptions&&e.hasSubscriptions){var t=yield e.subscriberService.getAccess();e.profile.subscriptions=t,Object(c.b)("debug","IdentityService - updateSubscriptions - Subscriptions: ",t)}}else Object(c.b)("debug","IdentityService - updateSubscriptions: no email, not updating subscriptions"),e.profile.subscriptions=void 0}))()}signedIn(){return!!this.profile.email||void 0}removeAdSlotElements(){for(var e of Ce.DOM.class.adContainers){Array.from(document.querySelectorAll(".".concat(e))).filter(e=>!e.querySelector("[".concat(p.b.attr.adLightIneligible.key,"]"))).forEach(e=>{var t=e.parentElement.parentElement,r=document.createElement("div");r.classList.add(...a.a.DOM.classes.dfpAdSpacer),t.replaceWith(r)})}var t=".".concat(Ce.DOM.class.storySection.join("."));for(var r of document.querySelectorAll(t)){var i=r.querySelector("p");i&&""===i.innerHTML.trim()&&i.remove()}this.removeEmptySectionUnderWidget();var n=document.querySelector(".".concat(Ce.DOM.class.closeStickyAd));n&&n.remove()}removeEmptySectionUnderWidget(){var e=document.querySelector(".js-widget-content");if(e){e.style.marginBottom="40px";for(var t=e.nextElementSibling,r=0;t&&"section"!==t.tagName.toLowerCase()&&r<10;)t=t.nextElementSibling,r+=1;if(t&&"section"===t.tagName.toLowerCase()){var i=t.innerText.trim();""!==i&&"Article content"!==i||t.remove()}}}}Pe(Ce,"DOM",{attrs:{activateButton:"data-id-activate-button",btns:"data-sso-btns",close:"data-id-close",loginRedirect:"data-id-login-redirect",marker:"data-sso-marker",myAccountBtn:"data-sso-my-account-control",name:"data-id-name",offerId:"data-id-offer",signIn:"data-id-login",signOut:"data-id-logout",termId:"data-id-term"},class:{adContainers:["ad__container","vf3-conversations-list__promo"],buttonText:"button__text",closeStickyAd:"close-sticky-ad",signedIn:"sso-signedIn",signedOut:"sso-signedOut",storySection:["article-content__content-group","article-content__content-group--story"],subscriptionAlert:"tp-container-inner"},links:{},logo:{},property:""})},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var i=r(8),n=r(14),o=r(22),a=r(34);function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class c extends i.a{constructor(e){super(),s(this,"id",Object(o.a)(32)),s(this,"updated",Date.now()),this.email=e}fromJson(e){super.fromJson(e),e.created&&(this.created=new Date(Date.parse(e.created))),e.lastSignIn&&(this.lastSignIn=new Date(Date.parse(e.lastSignIn))),e.subscriptions&&(this.subscriptions=n.a.buildMany(a.b,e.subscriptions))}}},function(e,t,r){"use strict";function i(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}r.d(t,"a",(function(){return n}));class n{static postData(e,t,r){return(n=function*(){var i=yield fetch(e,{body:JSON.stringify(t),headers:{"Content-Type":"application/json","X-CSRFToken":r},method:"POST",mode:"same-origin"});if(i.ok)return i.json();throw{json:yield i.json(),status:i.status,statusText:i.statusText}},function(){var e=this,t=arguments;return new Promise((function(r,o){var a=n.apply(e,t);function s(e){i(a,r,o,s,c,"next",e)}function c(e){i(a,r,o,s,c,"throw",e)}s(void 0)}))})();var n}}},function(e,t,r){"use strict";r.d(t,"c",(function(){return f})),r.d(t,"a",(function(){return g})),r.d(t,"b",(function(){return h}));var i=r(0),n=r(1),o=r(2),a=r(9),s=r(7),c=r(4),l=r(12),d=r(3);function u(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}var m=function(e){return e.ANONYMOUS="anonymous",e.REGISTERED="registered",e.SUBSCRIBED="subscribed",e}({}),p=function(e){return e.ALWAYS="always",e.NEVER="never",e}({}),f=function(e){return e.REGWALL="regwall",e.PAYWALL="paywall",e}({}),g=function(e){return e.CONTROL="control",e.VARIANT="variant",e}({});class h{constructor(e,t,r){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.subscriberService=e,this.pageConf=t,this.paywallOfferConf=r,this.useSophiDecision=i,this.isGNSEnabled=n}init(){var e,t=this;return(e=function*(){var e=window.sophi,r=window.demeter,a=t.pageConf.type,u=t.pageConf.ancestry,h=t.pageConf.isPaywallWhitelisted,v=t.pageConf.isPremium,b=t.pageConf.isRegistration,y=!0;if(e&&r){var w=(document.cookie.split(";").find(e=>e.trim().startsWith("".concat(o.a.SOPHI_AB_TEST_NAME,"=")))||"").trim().split("=").pop()||void 0,E=(document.cookie.split(";").find(e=>e.trim().startsWith("".concat(o.a.SOPHI_AB_TEST,"=")))||"").trim().split("=").pop()||void 0;if(E&&(Object(i.b)("info","Sophi.init - assigned A/B test name: ".concat(w)),Object(i.b)("info","Sophi.init - assigned A/B test group: ".concat(E)),E!==g.VARIANT&&(y=!1)),r("pageview",{args:{article:a===l.a.STORY,section:Array.isArray(u)?u[0]:"index"}}),Object(i.b)("info","Sophi.init - Sophi page view event dispatched"),y){var S=t.getLoginStatus();if(!(a!==l.a.STORY||h||v||t.isGNSEnabled||b||S!==m.REGISTERED&&S!==m.ANONYMOUS))try{if(t.useSophiDecision){var O=yield r("getDecision",{args:{visitor:S}});if(Object(i.b)("info","Sophi.init - Sophi decision: ".concat(JSON.stringify(O))),addEventListener(c.a.MP_READY,()=>{document.dispatchEvent(new CustomEvent(n.a.CUSTOM_EVENT,{detail:{context:O.context,control_fields:{mparticle:{keys:{context:"context",inputs:"inputs",meter_name:"meter_name",trace:"trace",variant_name:"variant_name"},mp_custom_flags:["Google.NonInteraction","Google.Page"],mp_event_type:"UserPreference"}},event_name:s.a.customEventNames.meterExecute,inputs:O.inputs,meter_name:"sophi_meter",trace:O.trace,variant_name:"".concat(w,":").concat(E)}}))}),O.outcome&&O.outcome.wallVisibility===p.ALWAYS){var _=O.outcome.wallType;_===f.PAYWALL?(r("wall",{args:"paywall"}),Object(i.b)("info","Sophi.init - Sophi paywall event dispatched"),Object(i.b)("info","Sophi.init - Show paywall"),t.showPaywall(),t.paywallOfferConf&&t.subscriberService.showOffer(t.paywallOfferConf.offerId,t.paywallOfferConf.templateId,"inline","#identity-screen-offer")):(r("wall",{args:"regwall"}),Object(i.b)("info","Sophi.init - Sophi regwall event dispatched"),Object(i.b)("info","Sophi.init - Show regwall"),t.showRegwall()),addEventListener(c.a.MP_READY,()=>{document.dispatchEvent(new CustomEvent(n.a.CUSTOM_EVENT,{detail:{context:O.context,control_fields:{mparticle:{keys:{context:"context",inputs:"inputs",meter_name:"meter_name",modal_name:"modal_name",trace:"trace",variant_name:"variant_name"},mp_event_type:"UserPreference"}},event_name:s.a.customEventNames.modalView,inputs:O.inputs,meter_name:"sophi_meter",modal_name:_===f.REGWALL?"regwall_limit_reached":"paywall_limit_reached",trace:O.trace,variant_name:"".concat(w,":").concat(E)}}))}),d.a.buildRedirectUrl(location.origin)}}else Object(i.b)("info","Sophi.init - Sophi initialized without using decision"),addEventListener(c.a.MP_READY,()=>{document.dispatchEvent(new CustomEvent(n.a.CUSTOM_EVENT,{detail:{control_fields:{mparticle:{keys:{meter_name:"meter_name",variant_name:"variant_name"},mp_custom_flags:["Google.NonInteraction","Google.Page"],mp_event_type:"UserPreference"}},event_name:s.a.customEventNames.meterExecute,meter_name:"sophi_meter",variant_name:"".concat(w,":").concat(E)}}))})}catch(e){Object(i.b)("error","Sophi.init - Error when getting sophi decision: ".concat(JSON.stringify(e)))}}}},function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){u(o,i,n,a,s,"next",e)}function s(e){u(o,i,n,a,s,"throw",e)}a(void 0)}))})()}showRegwall(){var e=document.querySelectorAll(".identity-screen__more-offer"),t=document.querySelector("#article-block");t&&t.setAttribute("data-aqa","anonymous-block"),e.forEach(e=>e.remove()),this.removeWidgetsAndAds(),n.b.addClass(document.querySelector(".article-content__widget-group--trending-slot, .article-content__share-group, .list-widget-trending.list"),"hidden"),n.b.removeClass(document.querySelector(".article-content__sign-in-group"),"hidden")}showPaywall(){var e=document.querySelector(".identity-screen-form"),t=document.querySelector("#article-block");t&&t.setAttribute("data-aqa","register-block"),e&&e.remove(),this.removeWidgetsAndAds(),n.b.addClass(document.querySelector(".article-content__widget-group--sidebar-slot,.article-content__share-group, .intro-body__anonymous, .intro-body__premium"),"hidden"),n.b.addClass(document.querySelector(".identity-screen"),"identity-screen--piano-offer"),n.b.removeClass(document.querySelector(".article-content__sign-in-group"),"hidden"),n.b.removeClass(document.querySelector(".identity-screen-offer"),"hidden"),n.b.removeClass(document.querySelector(".identity-screen__more-offer"),"hidden")}removeWidgetsAndAds(){var e=document.querySelectorAll(".js-widget-content"),t=document.querySelector(".gallery-block"),r=document.querySelectorAll(".article-content__content-group"),i=document.querySelectorAll(".article-content__ad-group:not(.ad_counter_1):not(.ad_counter_2):not(.ad_counter_3)");e.forEach(e=>e.remove()),t&&t.replaceChildren(),r.forEach(e=>e.remove()),i.forEach(e=>e.remove())}getLoginStatus(){var e=a.a.get(o.a.ID);return e.email?e.adLight?m.SUBSCRIBED:m.REGISTERED:m.ANONYMOUS}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var i=r(22),n=r(23);class o extends n.a{constructor(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now(),n=arguments.length>3?arguments[3]:void 0;super(e,t,r,n),this.action=e,this.data=t,this.ts=r,this.id=Object(i.a)(),this.updateHash(n)}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var i=r(6),n=r(1),o=r(7),a=r(19);function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class c{static init(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e){var o=n.b.isMobile()?e.mobile:e.desktop;if(this.updateRightRailPosition(),o&&o.enabled&&(o.bottom=!!o.bottom,o.close=!!o.close,o.closeTimer=o.closeTimer||0,o.pageTargeting=o.pageTargeting||[],!(o.pageTargeting.length>0)||o.pageTargeting.includes(t))){var a=document.querySelector(".".concat(i.a.DOM.classes.topAd.join(".")));if(this.adMountElement=o.bottom?document.querySelector(".".concat(i.a.DOM.classes.fixedBottomAdContainer)):document.querySelector(".".concat(i.a.DOM.classes.header)),this.adMountElement&&a){if(this.activeTop=!o.bottom,this.enabled=!0,n.b.isMobile()||this.setDesktopSizes(),o.bottom){this.adMountElement.append(a);var s=document.querySelector("#".concat(i.a.DOM.ids.fixedBottomAddOffset));s.removeAttribute("hidden"),s.style.height="".concat((n.b.isMobile()?this.maxMobileHeight:this.maxDesktopHeight)+this.adDivMargin,"px")}else{if(a.classList.add(i.a.DOM.classes.stickyAd),n.b.isMobile()){if(this.adMountElement.append(a),a.classList.add(i.a.DOM.classes.headerOffset),a.setAttribute(i.a.DOM.attrs.dataScroll,i.a.DOM.vals.dataScroll),document.getElementsByClassName(i.a.DOM.classes.subscribe).length>0)document.getElementsByClassName(i.a.DOM.classes.breaking).length>0?a.classList.add(i.a.DOM.classes.stickyWithSubscribe):a.classList.add(i.a.DOM.classes.stickyWithSubscribeNoBreaking),new MutationObserver((e,t)=>{e.forEach(()=>{var e=document.querySelector(".".concat(i.a.DOM.classes.subscribe));this.adMountElement.contains(e)||(a.classList.remove(i.a.DOM.classes.stickyWithSubscribe),a.classList.remove(i.a.DOM.classes.stickyWithSubscribeNoBreaking),t.disconnect())})}).observe(this.adMountElement,{childList:!0,subtree:!0});else a.classList.add(i.a.DOM.classes.stickyNoSubscribe)}else{window.addEventListener("scroll",()=>{this.stickyHeaderDesktop()});var c=document.createElement("div"),l=document.createElement("div");l.id=this.placeholderId,a.parentElement.insertBefore(c,a),c.append(l),c.append(a),a.style.position="relative",a.style.width="100%",a.style.zIndex="249"}var d=a.getBoundingClientRect().height;this.updateRightRailPosition(d)}o.close&&(this.closeTimer=o.closeTimer||0,this.enableCloseButton(a))}else r<5&&setTimeout(()=>{this.init(e,t,r+1)},50)}}}static enableCloseButton(e){var t=e.querySelector(".".concat(i.a.DOM.classes.closeStickyAd));if(t){this.closeTimer>0?setTimeout(()=>{t.style.display="inline"},this.closeTimer*this.secToMsec):t.style.display="inline",t.style.backgroundColor="rgb(247, 247, 247)";var r=Date.now();t.addEventListener("click",()=>{e.remove(),this.updateRightRailPosition(),this.adClosed=!0,setTimeout(()=>{var e=document.querySelector("#".concat(i.a.DOM.ids.fixedBottomAddOffset));e&&e.setAttribute("hidden","");var t=document.getElementById(this.placeholderId);t&&t.setAttribute("hidden",""),document.dispatchEvent(new CustomEvent(a.a.STICKY_AD_CLOSED,{detail:{position:this.activeTop?"top":"bottom"}})),this.sendLoginAnalytics(Date.now()-r)},0)})}}static sendLoginAnalytics(e){document.dispatchEvent(new CustomEvent(n.a.CUSTOM_EVENT,{detail:{control_fields:{mparticle:{keys:{show_close_button_delay:"show_close_button_delay",sticky_ad_position:"sticky_ad_position",time_before_close_click:"time_before_close_click"},mp_event_type:"Other"}},event_name:o.a.customEventNames.adClosed,show_close_button_delay:this.closeTimer*this.secToMsec,sticky_ad_position:this.activeTop?"top":"bottom",time_before_close_click:e}}))}static isActive(){return this.enabled&&!this.adClosed}static isActiveTop(){return this.isActive()&&this.activeTop}static setDesktopSizes(){var e=document.getElementById(i.a.DOM.ids.loc1),t=JSON.parse(e.getAttribute(i.a.DOM.attrs.adSizes));e.setAttribute(i.a.DOM.attrs.adSizes,JSON.stringify(t.filter(e=>e[1]<=this.maxDesktopHeight)))}static stickyHeaderDesktop(){var e=document.getElementById(i.a.DOM.ids.secondaryNav),t=document.getElementById(i.a.DOM.ids.header),r=document.querySelector(".".concat(i.a.DOM.classes.topAd.join(".")));if(r){var n=document.getElementById(this.placeholderId);"none"===window.getComputedStyle(e).display&&0===document.documentElement.scrollTop||e.getBoundingClientRect().bottom>=t.getBoundingClientRect().bottom?(r.style.position="relative",r.style.top="auto",n.style.height=""):(r.style.position="fixed",r.style.top="".concat(t.getBoundingClientRect().bottom,"px"),n.style.height="".concat(r.getBoundingClientRect().height,"px"))}}static updateRightRailPosition(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=document.querySelectorAll(".".concat(i.a.DOM.classes.rightRailItem)),r=document.getElementById(i.a.DOM.ids.header).getBoundingClientRect().height;t.forEach(t=>{t.style.top="".concat(r+e+this.rightRailOffset,"px")})}}s(c,"secToMsec",1e3),s(c,"activeTop",!1),s(c,"enabled",!1),s(c,"adClosed",!1),s(c,"placeholderId","ad-placeholder"),s(c,"maxMobileHeight",50),s(c,"maxDesktopHeight",90),s(c,"adDivMargin",16),s(c,"closeTimer",0),s(c,"rightRailOffset",8)},function(e,t,r){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r=e[1]||"",i=e[3];if(!i)return r;if(t&&"function"==typeof btoa){var n=(a=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),o=i.sources.map((function(e){return"/*# sourceURL="+i.sourceRoot+e+" */"}));return[r].concat(o).concat([n]).join("\n")}var a;return[r].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+r+"}":r})).join("")},t.i=function(e,r){"string"==typeof e&&(e=[[null,e,""]]);for(var i={},n=0;n<this.length;n++){var o=this[n][0];null!=o&&(i[o]=!0)}for(n=0;n<e.length;n++){var a=e[n];null!=a[0]&&i[a[0]]||(r&&!a[2]?a[2]=r:r&&(a[2]="("+a[2]+") and ("+r+")"),t.push(a))}},t}},function(e,t,r){var i,n,o={},a=(i=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===n&&(n=i.apply(this,arguments)),n}),s=function(e,t){return t?t.querySelector(e):document.querySelector(e)},c=function(e){var t={};return function(e,r){if("function"==typeof e)return e();if(void 0===t[e]){var i=s.call(this,e,r);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}t[e]=i}return t[e]}}(),l=null,d=0,u=[],m=r(49);function p(e,t){for(var r=0;r<e.length;r++){var i=e[r],n=o[i.id];if(n){n.refs++;for(var a=0;a<n.parts.length;a++)n.parts[a](i.parts[a]);for(;a<i.parts.length;a++)n.parts.push(y(i.parts[a],t))}else{var s=[];for(a=0;a<i.parts.length;a++)s.push(y(i.parts[a],t));o[i.id]={id:i.id,refs:1,parts:s}}}}function f(e,t){for(var r=[],i={},n=0;n<e.length;n++){var o=e[n],a=t.base?o[0]+t.base:o[0],s={css:o[1],media:o[2],sourceMap:o[3]};i[a]?i[a].parts.push(s):r.push(i[a]={id:a,parts:[s]})}return r}function g(e,t){var r=c(e.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=u[u.length-1];if("top"===e.insertAt)i?i.nextSibling?r.insertBefore(t,i.nextSibling):r.appendChild(t):r.insertBefore(t,r.firstChild),u.push(t);else if("bottom"===e.insertAt)r.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var n=c(e.insertAt.before,r);r.insertBefore(t,n)}}function h(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=u.indexOf(e);t>=0&&u.splice(t,1)}function v(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var i=function(){0;return r.nc}();i&&(e.attrs.nonce=i)}return b(t,e.attrs),g(e,t),t}function b(e,t){Object.keys(t).forEach((function(r){e.setAttribute(r,t[r])}))}function y(e,t){var r,i,n,o;if(t.transform&&e.css){if(!(o="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=o}if(t.singleton){var a=d++;r=l||(l=v(t)),i=S.bind(null,r,a,!1),n=S.bind(null,r,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",b(t,e.attrs),g(e,t),t}(t),i=_.bind(null,r,t),n=function(){h(r),r.href&&URL.revokeObjectURL(r.href)}):(r=v(t),i=O.bind(null,r),n=function(){h(r)});return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else n()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=a()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var r=f(e,t);return p(r,t),function(e){for(var i=[],n=0;n<r.length;n++){var a=r[n];(s=o[a.id]).refs--,i.push(s)}e&&p(f(e,t),t);for(n=0;n<i.length;n++){var s;if(0===(s=i[n]).refs){for(var c=0;c<s.parts.length;c++)s.parts[c]();delete o[s.id]}}}};var w,E=(w=[],function(e,t){return w[e]=t,w.filter(Boolean).join("\n")});function S(e,t,r,i){var n=r?"":i.css;if(e.styleSheet)e.styleSheet.cssText=E(t,n);else{var o=document.createTextNode(n),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function O(e,t){var r=t.css,i=t.media;if(i&&e.setAttribute("media",i),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}function _(e,t,r){var i=r.css,n=r.sourceMap,o=void 0===t.convertToAbsoluteUrls&&n;(t.convertToAbsoluteUrls||o)&&(i=m(i)),n&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var a=new Blob([i],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}));var i=r(8),n=function(e){return e.LOG_IN="login",e.SIGN_IN="signIn",e.SIGN_OUT="signOut",e}({});class o extends i.a{constructor(){var{id:e,aid:t,start:r,end:i,termId:n,termType:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.id=e,this.aid=t,this.start=r,this.end=i,this.termId=n,this.termType=o}isActiveRegistration(){var e=Date.now();return this.end?this.start<=e&&e<=this.end:this.start<=e}isDefaultRegistrationAccess(){return void 0===this.termType||null===this.termType?void 0:"registration"===this.termType}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var i=r(5),n=r(1),o=r(17),a=r(7),s=r(24);function c(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class l extends o.a{constructor(){super(...arguments),c(this,"ageVerificationRequired",!1),c(this,"ageGateDelay",5e3),c(this,"nextDisplayTs",void 0)}getAgeGateElement(){return document.querySelector(".".concat(l.DOM.className.pageAgeGate))}getAgeGateFormElement(){return document.querySelector(".".concat(l.DOM.className.pageGateForm))}showAgeGate(){document.dispatchEvent(i.c.event(s.b.VERIFYING)),this.getAgeGateFormElement().addEventListener("submit",this.ageGateVerify.bind(this),!1),document.querySelector("body").classList.add(l.DOM.className.pageGateBodyEnable);var e=this.getAgeGateElement(),t=e.querySelectorAll(l.focusableElements)[0],r=e.querySelectorAll(l.focusableElements),n=r[r.length-1];e.addEventListener("keydown",e=>{"Tab"===e.key&&(e.shiftKey?document.activeElement===t&&(n.focus(),e.preventDefault()):document.activeElement===n&&(t.focus(),e.preventDefault()))}),t.focus()}hideAgeGate(){document.querySelector("body").classList.remove(l.DOM.className.pageGateBodyEnable)}markFailedAgeGate(){this.getAgeGateElement().classList.add(l.DOM.className.ageVerificationFailed)}markInvalidDate(){this.getAgeGateElement().classList.add(l.DOM.className.invalidDateInput)}resetAgeGate(){this.getAgeGateElement().classList.remove(l.DOM.className.ageVerificationFailed),this.getAgeGateElement().classList.remove(l.DOM.className.invalidDateInput)}initialize(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this;if(e){r.ageVerificationRequired=e.enabled,r.ageGateDelay=e.delayMs;var i=window.location.href.indexOf("".concat(l.DOM.urlParams.ageGatePassthru,"=true"))>-1,n=window.localStorage.getItem(l.DOM.localStorage.verifiedKey);n||(n=r.convertLegacyCookie()?"true":void 0),r.nextDisplayTs=window.localStorage.getItem(l.DOM.localStorage.nextDisplay);var o=!r.nextDisplayTs||Date.now()>parseInt(r.nextDisplayTs,10);r.ageVerificationRequired&&(i||t||n&&!o?r.onAgeVerified():setTimeout(()=>{r.showAgeGate()},r.ageGateDelay))}}convertLegacyCookie(){var e=new RegExp(/(age_gate=)(\d+)/).exec(document.cookie),t=e&&e.length>2?parseInt(e[2],10):void 0;return!!(t&&t>=l.requiredAge)&&(this.onAgeVerified(),this.setNextAgeGateDiplayTime(!0),!0)}ageGateVerify(e){e.preventDefault(),this.resetAgeGate();var t=new Date,r=t.getFullYear()-l.requiredAge,i=t.getDate(),n=t.getMonth(),o=new Date(r,n,i),a=parseInt(document.querySelector("#".concat(l.DOM.ids.inputMonth)).value,10),s=parseInt(document.querySelector("#".concat(l.DOM.ids.inputDay)).value,10),c=parseInt(document.querySelector("#".concat(l.DOM.ids.inputYear)).value,10);if(!this.dateIsValid(c,a,s))return this.markInvalidDate();var d=new Date(c,a-1,s),u=null!==document.querySelector("#".concat(l.DOM.ids.inputRemember,":checked"));return d<=o&&c>=l.minYearInput?(this.hideAgeGate(),this.onAgeVerified(),this.setNextAgeGateDiplayTime(u)):this.markFailedAgeGate(),!1}dateIsValid(e,t,r){if(isNaN(e)||isNaN(t)||isNaN(r))return!1;var i=new Date([e,t,r].join("/"));return!isNaN(i.getTime())&&e>=l.minYearInput}setNextAgeGateDiplayTime(e){var t=Date.now();t+=e?l.rememberMeShowIntervalMs:l.defaultShowIntervalMs,this.nextDisplayTs=t.toString(),localStorage.setItem(l.DOM.localStorage.nextDisplay,this.nextDisplayTs)}onAgeVerified(){localStorage.setItem(l.DOM.localStorage.verifiedKey,"true"),document.dispatchEvent(i.c.event(s.b.VERIFIED)),this.nextDisplayTs||this.setNextAgeGateDiplayTime(!1),document.dispatchEvent(new CustomEvent(n.a.CUSTOM_EVENT,{detail:{control_fields:{mparticle:{mp_event_type:"UserContent"}},event_name:a.a.customEventNames.ageGatePassed}}))}}c(l,"DOM",{className:{ageVerificationFailed:"failed",invalidDateInput:"invalid",pageAgeGate:"age-gate",pageGateBodyEnable:"show-age-gate",pageGateForm:"pn-age-gate"},ids:{inputDay:"age-gate-d",inputMonth:"age-gate-m",inputRemember:"age-gate-remember-me",inputYear:"age-gate-y"},localStorage:{nextDisplay:"page-age-get-next-shown-timestamp",verifiedKey:"page-age-gate-verified"},urlParams:{ageGatePassthru:"utm_agegate"}}),c(l,"focusableElements",'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),c(l,"requiredAge",19),c(l,"minYearInput",1900),c(l,"defaultShowIntervalMs",864e5),c(l,"rememberMeShowIntervalMs",31536e6),c(l,"verified",new Promise(e=>{document.addEventListener(s.b.VERIFIED,()=>e())}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var i,n,o,a=r(0),s=r(1);r(50);function c(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}class l{static initDOM(e,t,i,n){var o,l=this;return(o=function*(){var o=document.querySelector("".concat(e)).querySelector("[type=email]");if(o)try{if(t){o.value=t,o.readOnly=!0,o.tabIndex=-1,o.classList.add("readonly-input");var c=(yield r.e(5).then(r.t.bind(null,59,7))).default,d=document.createElement("div");s.b.addClass(d,l.DOM.class.buttonWrapper),d.innerHTML=c;var u=d.querySelector("button");u.setAttribute("hx-get",i),u.addEventListener(s.a.click,()=>{var e=new Event(n,{bubbles:!0});u.dispatchEvent(e)}),window.htmx.process(d),o.after(d)}}catch(e){Object(a.b)("error","Unable to load show password button UI",e)}},function(){var e=this,t=arguments;return new Promise((function(r,i){var n=o.apply(e,t);function a(e){c(n,r,i,a,s,"next",e)}function s(e){c(n,r,i,a,s,"throw",e)}a(void 0)}))})()}}i=l,o={class:{button:"button",buttonText:"button__text",buttonWrapper:"auth-input-edit-button-container"}},(n=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(n="DOM"))in i?Object.defineProperty(i,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):i[n]=o},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var i,n,o,a=r(0),s=r(1);function c(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}class l{static initDOM(e){return(t=function*(){var t=document.querySelector("".concat(e)).querySelectorAll("[type=password]");if(t)try{var i=(yield r.e(7).then(r.t.bind(null,61,7))).default;t.forEach(e=>{var t=document.createElement("div");s.b.addClass(t,l.DOM.class.buttonWrapper),t.innerHTML=i,e.after(t),l.addListeners(e,t)})}catch(e){Object(a.b)("error","Unable to load show password button UI")}},function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function a(e){c(o,i,n,a,s,"next",e)}function s(e){c(o,i,n,a,s,"throw",e)}a(void 0)}))})();var t}static addListeners(e,t){var r=t.querySelector(".".concat(l.DOM.class.button)),i=t.querySelector(".".concat(l.DOM.class.buttonText));r&&i&&r.addEventListener("click",()=>{"password"===e.type?(e.type="input",i.innerHTML="Hide",s.b.addClass(t,l.DOM.class.showPasswordVisible)):(e.type="password",i.innerHTML="Show",s.b.removeClass(t,l.DOM.class.showPasswordVisible)),e.focus()})}}i=l,o={class:{button:"button",buttonText:"button__text",buttonWrapper:"show-password-button-container",showPasswordVisible:"show-password--visible"}},(n=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(n="DOM"))in i?Object.defineProperty(i,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):i[n]=o},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e){e.exports=JSON.parse('{"ca":{"interlaketoday":{"_kvs":{"comm":"y","et":"sm"}},"brantfordexpositor":{"_kvs":{"comm":"y","et":"sm"}},"chathamdailynews":{"_kvs":{"comm":"y","et":"sm"}},"cochranetimespost":{"_kvs":{"comm":"y","et":"sm"}},"communitypress":{"_kvs":{"comm":"y","et":"sm"}},"countymarket":{"_kvs":{"comm":"y","et":"sm"}},"countyweeklynews":{"_kvs":{"comm":"y","et":"sm"}},"devondispatch":{"_kvs":{"comm":"y","et":"sm"}},"elliotlakestandard":{"_kvs":{"comm":"y","et":"sm"}},"greybrucethisweek":{"_kvs":{"comm":"y","et":"sm"}},"intelligencer":{"_kvs":{"comm":"y","et":"sm"}},"northernnews":{"_kvs":{"comm":"y","et":"sm"}},"nugget":{"_kvs":{"comm":"y","et":"sm"}},"on":{"thepost":{"_kvs":{"comm":"y","et":"sm"}}},"pembinatoday":{"_kvs":{"comm":"y","et":"sm"}},"recorder":{"_kvs":{"comm":"y","et":"sm"}},"simcoereformer":{"_kvs":{"comm":"y","et":"sm"}},"thebeaumontnews":{"_kvs":{"comm":"y","et":"sm"}},"thecragandcanyon":{"_kvs":{"comm":"y","et":"sm"}},"thedailyobserver":{"_kvs":{"comm":"y","et":"sm"}},"thelondoner":{"_kvs":{"comm":"y","et":"sm"}},"theobserver":{"_kvs":{"comm":"y","et":"sm"}},"todaysfarmer":{"_kvs":{"comm":"y","et":"sm"}},"trentonian":{"_kvs":{"comm":"y","et":"sm"}}},"com":{"airdrieecho":{"_kvs":{"comm":"y","et":"sm"}},"calgarysun":{"_kvs":{"et":"sm"}},"camrosecanadian":{"_kvs":{"comm":"y","et":"sm"}},"carmanvalleyleader":{"_kvs":{"comm":"y","et":"sm"}},"chathamthisweek":{"_kvs":{"comm":"y","et":"sm"}},"clintonnewsrecord":{"_kvs":{"comm":"y","et":"sm"}},"cochranetimes":{"_kvs":{"comm":"y","et":"sm"}},"coldlakesun":{"_kvs":{"comm":"y","et":"sm"}},"dailyheraldtribune":{"_kvs":{"comm":"y","et":"sm"}},"delhinewsrecord":{"_kvs":{"comm":"y","et":"sm"}},"draytonvalleywesternreview":{"_kvs":{"comm":"y","et":"sm"}},"edmontonexaminer":{"_kvs":{"comm":"y","et":"sm"}},"edmontonsun":{"_kvs":{"et":"sm"}},"edsonleader":{"_kvs":{"comm":"y","et":"sm"}},"fairviewpost":{"_kvs":{"comm":"y","et":"sm"}},"fortmcmurraytoday":{"_kvs":{"comm":"y","et":"sm"}},"fortsaskatchewanrecord":{"_kvs":{"comm":"y","et":"sm"}},"gananoquereporter":{"_kvs":{"comm":"y","et":"sm"}},"goderichsignalstar":{"_kvs":{"comm":"y","et":"sm"}},"hannaherald":{"_kvs":{"comm":"y","et":"sm"}},"highrivertimes":{"_kvs":{"comm":"y","et":"sm"}},"hintonparklander":{"_kvs":{"comm":"y","et":"sm"}},"ingersolltimes":{"_kvs":{"comm":"y","et":"sm"}},"interlakespectator":{"_kvs":{"comm":"y","et":"sm"}},"kapuskasingtimes":{"_kvs":{"comm":"y","et":"sm"}},"kenoradailyminerandnews":{"_kvs":{"comm":"y","et":"sm"}},"kincardinenews":{"_kvs":{"comm":"y","et":"sm"}},"kingstonthisweek":{"_kvs":{"comm":"y","et":"sm"}},"lacombeglobe":{"_kvs":{"comm":"y","et":"sm"}},"lakeshoreadvance":{"_kvs":{"comm":"y","et":"sm"}},"leducrep":{"_kvs":{"comm":"y","et":"sm"}},"lucknowsentinel":{"_kvs":{"comm":"y","et":"sm"}},"mayerthorpefreelancer":{"_kvs":{"comm":"y","et":"sm"}},"melfortjournal":{"_kvs":{"comm":"y","et":"sm"}},"midnorthmonitor":{"_kvs":{"comm":"y","et":"sm"}},"mitchelladvocate":{"_kvs":{"comm":"y","et":"sm"}},"mordentimes":{"_kvs":{"comm":"y","et":"sm"}},"nantonnews":{"_kvs":{"comm":"y","et":"sm"}},"napaneeguide":{"_kvs":{"comm":"y","et":"sm"}},"nipawinjournal":{"_kvs":{"comm":"y","et":"sm"}},"norwichgazette":{"_kvs":{"comm":"y","et":"sm"}},"ottawasun":{"_kvs":{"et":"sm"}},"owensoundsuntimes":{"_kvs":{"comm":"y","et":"sm"}},"parisstaronline":{"_kvs":{"comm":"y","et":"sm"}},"peacecountrysun":{"_kvs":{"comm":"y","et":"sm"}},"petroliatopic":{"_kvs":{"comm":"y","et":"sm"}},"pinchercreekecho":{"_kvs":{"comm":"y","et":"sm"}},"portagedailygraphic":{"_kvs":{"comm":"y","et":"sm"}},"prrecordgazette":{"_kvs":{"comm":"y","et":"sm"}},"redrivervalleyecho":{"_kvs":{"comm":"y","et":"sm"}},"sarniathisweek":{"_kvs":{"comm":"y","et":"sm"}},"saultstar":{"_kvs":{"comm":"y","et":"sm"}},"saultthisweek":{"_kvs":{"comm":"y","et":"sm"}},"seaforthhuronexpositor":{"_kvs":{"comm":"y","et":"sm"}},"selkirkjournal":{"_kvs":{"comm":"y","et":"sm"}},"sherwoodparknews":{"_kvs":{"comm":"y","et":"sm"}},"shorelinebeacon":{"_kvs":{"comm":"y","et":"sm"}},"sprucegroveexaminer":{"_kvs":{"comm":"y","et":"sm"}},"standard-freeholder":{"_kvs":{"comm":"y","et":"sm"}},"stonewallargusteulontimes":{"_kvs":{"comm":"y","et":"sm"}},"stonyplainreporter":{"_kvs":{"comm":"y","et":"sm"}},"stratfordbeaconherald":{"_kvs":{"comm":"y","et":"sm"}},"strathmorestandard":{"_kvs":{"comm":"y","et":"sm"}},"strathroyagedispatch":{"_kvs":{"comm":"y","et":"sm"}},"stthomastimesjournal":{"_kvs":{"comm":"y","et":"sm"}},"thechronicle-online":{"_kvs":{"comm":"y","et":"sm"}},"thesudburystar":{"_kvs":{"comm":"y","et":"sm"}},"thewhig":{"_kvs":{"comm":"y","et":"sm"}},"tillsonburgnews":{"_kvs":{"comm":"y","et":"sm"}},"timminspress":{"_kvs":{"comm":"y","et":"sm"}},"timminstimes":{"_kvs":{"comm":"y","et":"sm"}},"torontosun":{"_kvs":{"et":"sm"}},"vermilionstandard":{"_kvs":{"comm":"y","et":"sm"}},"vulcanadvocate":{"_kvs":{"comm":"y","et":"sm"}},"wallaceburgcourierpress":{"_kvs":{"comm":"y","et":"sm"}},"wetaskiwintimes":{"_kvs":{"comm":"y","et":"sm"}},"whitecourtstar":{"_kvs":{"comm":"y","et":"sm"}},"wiartonecho":{"_kvs":{"comm":"y","et":"sm"}},"winklertimes":{"_kvs":{"comm":"y","et":"sm"}},"winnipegsun":{"_kvs":{"et":"sm"}},"woodstocksentinelreview":{"_kvs":{"comm":"y","et":"sm"}}}}')},function(e,t,r){(function(t){var r=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,n=/^0b[01]+$/i,o=/^0o[0-7]+$/i,a=parseInt,s="object"==typeof t&&t&&t.Object===Object&&t,c="object"==typeof self&&self&&self.Object===Object&&self,l=s||c||Function("return this")(),d=Object.prototype.toString,u=Math.max,m=Math.min,p=function(){return l.Date.now()};function f(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function g(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==d.call(e)}(e))return NaN;if(f(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=f(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(r,"");var s=n.test(e);return s||o.test(e)?a(e.slice(2),s?2:8):i.test(e)?NaN:+e}e.exports=function(e,t,r){var i,n,o,a,s,c,l=0,d=!1,h=!1,v=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function b(t){var r=i,o=n;return i=n=void 0,l=t,a=e.apply(o,r)}function y(e){return l=e,s=setTimeout(E,t),d?b(e):a}function w(e){var r=e-c;return void 0===c||r>=t||r<0||h&&e-l>=o}function E(){var e=p();if(w(e))return S(e);s=setTimeout(E,function(e){var r=t-(e-c);return h?m(r,o-(e-l)):r}(e))}function S(e){return s=void 0,v&&i?b(e):(i=n=void 0,a)}function O(){var e=p(),r=w(e);if(i=arguments,n=this,c=e,r){if(void 0===s)return y(c);if(h)return s=setTimeout(E,t),b(c)}return void 0===s&&(s=setTimeout(E,t)),a}return t=g(t)||0,f(r)&&(d=!!r.leading,o=(h="maxWait"in r)?u(g(r.maxWait)||0,t):o,v="trailing"in r?!!r.trailing:v),O.cancel=function(){void 0!==s&&clearTimeout(s),l=0,i=c=n=s=void 0},O.flush=function(){return void 0===s?a:S(p())},O}}).call(this,r(38))},function(e,t,r){"use strict";e.exports=a,e.exports.isMobile=a,e.exports.default=a;const i=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,n=/CrOS/,o=/android|ipad|playbook|silk/i;function a(e){e||(e={});let t=e.ua;if(t||"undefined"==typeof navigator||(t=navigator.userAgent),t&&t.headers&&"string"==typeof t.headers["user-agent"]&&(t=t.headers["user-agent"]),"string"!=typeof t)return!1;let r=i.test(t)&&!n.test(t)||!!e.tablet&&o.test(t);return!r&&e.tablet&&e.featureDetect&&navigator&&navigator.maxTouchPoints>1&&-1!==t.indexOf("Macintosh")&&-1!==t.indexOf("Safari")&&(r=!0),r}},function(e,t,r){"use strict";(function(e){var r=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var r=-1;return e.some((function(e,i){return e[0]===t&&(r=i,!0)})),r}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var r=e(this.__entries__,t),i=this.__entries__[r];return i&&i[1]},t.prototype.set=function(t,r){var i=e(this.__entries__,t);~i?this.__entries__[i][1]=r:this.__entries__.push([t,r])},t.prototype.delete=function(t){var r=this.__entries__,i=e(r,t);~i&&r.splice(i,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var r=0,i=this.__entries__;r<i.length;r++){var n=i[r];e.call(t,n[1],n[0])}},t}()}(),i="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,n=void 0!==e&&e.Math===Math?e:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),o="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(n):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)};var a=["top","right","bottom","left","width","height","size","weight"],s="undefined"!=typeof MutationObserver,c=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var r=!1,i=!1,n=0;function a(){r&&(r=!1,e()),i&&c()}function s(){o(a)}function c(){var e=Date.now();if(r){if(e-n<2)return;i=!0}else r=!0,i=!1,setTimeout(s,t);n=e}return c}(this.refresh.bind(this),20)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,r=t.indexOf(e);~r&&t.splice(r,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){i&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),s?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){i&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,r=void 0===t?"":t;a.some((function(e){return!!~r.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),l=function(e,t){for(var r=0,i=Object.keys(t);r<i.length;r++){var n=i[r];Object.defineProperty(e,n,{value:t[n],enumerable:!1,writable:!1,configurable:!0})}return e},d=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||n},u=v(0,0,0,0);function m(e){return parseFloat(e)||0}function p(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.reduce((function(t,r){return t+m(e["border-"+r+"-width"])}),0)}function f(e){var t=e.clientWidth,r=e.clientHeight;if(!t&&!r)return u;var i=d(e).getComputedStyle(e),n=function(e){for(var t={},r=0,i=["top","right","bottom","left"];r<i.length;r++){var n=i[r],o=e["padding-"+n];t[n]=m(o)}return t}(i),o=n.left+n.right,a=n.top+n.bottom,s=m(i.width),c=m(i.height);if("border-box"===i.boxSizing&&(Math.round(s+o)!==t&&(s-=p(i,"left","right")+o),Math.round(c+a)!==r&&(c-=p(i,"top","bottom")+a)),!function(e){return e===d(e).document.documentElement}(e)){var l=Math.round(s+o)-t,f=Math.round(c+a)-r;1!==Math.abs(l)&&(s-=l),1!==Math.abs(f)&&(c-=f)}return v(n.left,n.top,s,c)}var g="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof d(e).SVGGraphicsElement}:function(e){return e instanceof d(e).SVGElement&&"function"==typeof e.getBBox};function h(e){return i?g(e)?function(e){var t=e.getBBox();return v(0,0,t.width,t.height)}(e):f(e):u}function v(e,t,r,i){return{x:e,y:t,width:r,height:i}}var b=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=v(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=h(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),y=function(e,t){var r,i,n,o,a,s,c,d=(i=(r=t).x,n=r.y,o=r.width,a=r.height,s="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,c=Object.create(s.prototype),l(c,{x:i,y:n,width:o,height:a,top:n,right:i+o,bottom:a+n,left:i}),c);l(this,{target:e,contentRect:d})},w=function(){function e(e,t,i){if(this.activeObservations_=[],this.observations_=new r,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=i}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof d(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new b(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof d(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new y(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),E="undefined"!=typeof WeakMap?new WeakMap:new r,S=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var r=c.getInstance(),i=new w(t,r,this);E.set(this,i)};["observe","unobserve","disconnect"].forEach((function(e){S.prototype[e]=function(){var t;return(t=E.get(this))[e].apply(t,arguments)}}));var O=void 0!==n.ResizeObserver?n.ResizeObserver:S;t.a=O}).call(this,r(38))},function(e,t,r){(function(e,r){var i="[object Arguments]",n="[object Map]",o="[object Object]",a="[object Set]",s=/^\[object .+?Constructor\]$/,c=/^(?:0|[1-9]\d*)$/,l={};l["[object Float32Array]"]=l["[object Float64Array]"]=l["[object Int8Array]"]=l["[object Int16Array]"]=l["[object Int32Array]"]=l["[object Uint8Array]"]=l["[object Uint8ClampedArray]"]=l["[object Uint16Array]"]=l["[object Uint32Array]"]=!0,l[i]=l["[object Array]"]=l["[object ArrayBuffer]"]=l["[object Boolean]"]=l["[object DataView]"]=l["[object Date]"]=l["[object Error]"]=l["[object Function]"]=l[n]=l["[object Number]"]=l[o]=l["[object RegExp]"]=l[a]=l["[object String]"]=l["[object WeakMap]"]=!1;var d="object"==typeof e&&e&&e.Object===Object&&e,u="object"==typeof self&&self&&self.Object===Object&&self,m=d||u||Function("return this")(),p=t&&!t.nodeType&&t,f=p&&"object"==typeof r&&r&&!r.nodeType&&r,g=f&&f.exports===p,h=g&&d.process,v=function(){try{return h&&h.binding&&h.binding("util")}catch(e){}}(),b=v&&v.isTypedArray;function y(e,t){for(var r=-1,i=null==e?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}function w(e){var t=-1,r=Array(e.size);return e.forEach((function(e,i){r[++t]=[i,e]})),r}function E(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var S,O,_,I=Array.prototype,A=Function.prototype,T=Object.prototype,P=m["__core-js_shared__"],C=A.toString,R=T.hasOwnProperty,k=(S=/[^.]+$/.exec(P&&P.keys&&P.keys.IE_PROTO||""))?"Symbol(src)_1."+S:"",D=T.toString,j=RegExp("^"+C.call(R).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),M=g?m.Buffer:void 0,L=m.Symbol,N=m.Uint8Array,x=T.propertyIsEnumerable,U=I.splice,F=L?L.toStringTag:void 0,V=Object.getOwnPropertySymbols,G=M?M.isBuffer:void 0,q=(O=Object.keys,_=Object,function(e){return O(_(e))}),B=ve(m,"DataView"),W=ve(m,"Map"),z=ve(m,"Promise"),H=ve(m,"Set"),Y=ve(m,"WeakMap"),K=ve(Object,"create"),J=Ee(B),X=Ee(W),$=Ee(z),Q=Ee(H),Z=Ee(Y),ee=L?L.prototype:void 0,te=ee?ee.valueOf:void 0;function re(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function ie(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function ne(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function oe(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new ne;++t<r;)this.add(e[t])}function ae(e){var t=this.__data__=new ie(e);this.size=t.size}function se(e,t){var r=_e(e),i=!r&&Oe(e),n=!r&&!i&&Ie(e),o=!r&&!i&&!n&&Re(e),a=r||i||n||o,s=a?function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}(e.length,String):[],c=s.length;for(var l in e)!t&&!R.call(e,l)||a&&("length"==l||n&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||we(l,c))||s.push(l);return s}function ce(e,t){for(var r=e.length;r--;)if(Se(e[r][0],t))return r;return-1}function le(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":F&&F in Object(e)?function(e){var t=R.call(e,F),r=e[F];try{e[F]=void 0;var i=!0}catch(e){}var n=D.call(e);i&&(t?e[F]=r:delete e[F]);return n}(e):function(e){return D.call(e)}(e)}function de(e){return Ce(e)&&le(e)==i}function ue(e,t,r,s,c){return e===t||(null==e||null==t||!Ce(e)&&!Ce(t)?e!=e&&t!=t:function(e,t,r,s,c,l){var d=_e(e),u=_e(t),m=d?"[object Array]":ye(e),p=u?"[object Array]":ye(t),f=(m=m==i?o:m)==o,g=(p=p==i?o:p)==o,h=m==p;if(h&&Ie(e)){if(!Ie(t))return!1;d=!0,f=!1}if(h&&!f)return l||(l=new ae),d||Re(e)?fe(e,t,r,s,c,l):function(e,t,r,i,o,s,c){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!s(new N(e),new N(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Se(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case n:var l=w;case a:var d=1&i;if(l||(l=E),e.size!=t.size&&!d)return!1;var u=c.get(e);if(u)return u==t;i|=2,c.set(e,t);var m=fe(l(e),l(t),i,o,s,c);return c.delete(e),m;case"[object Symbol]":if(te)return te.call(e)==te.call(t)}return!1}(e,t,m,r,s,c,l);if(!(1&r)){var v=f&&R.call(e,"__wrapped__"),b=g&&R.call(t,"__wrapped__");if(v||b){var y=v?e.value():e,S=b?t.value():t;return l||(l=new ae),c(y,S,r,s,l)}}if(!h)return!1;return l||(l=new ae),function(e,t,r,i,n,o){var a=1&r,s=ge(e),c=s.length,l=ge(t).length;if(c!=l&&!a)return!1;var d=c;for(;d--;){var u=s[d];if(!(a?u in t:R.call(t,u)))return!1}var m=o.get(e);if(m&&o.get(t))return m==t;var p=!0;o.set(e,t),o.set(t,e);var f=a;for(;++d<c;){u=s[d];var g=e[u],h=t[u];if(i)var v=a?i(h,g,u,t,e,o):i(g,h,u,e,t,o);if(!(void 0===v?g===h||n(g,h,r,i,o):v)){p=!1;break}f||(f="constructor"==u)}if(p&&!f){var b=e.constructor,y=t.constructor;b==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof y&&y instanceof y||(p=!1)}return o.delete(e),o.delete(t),p}(e,t,r,s,c,l)}(e,t,r,s,ue,c))}function me(e){return!(!Pe(e)||function(e){return!!k&&k in e}(e))&&(Ae(e)?j:s).test(Ee(e))}function pe(e){if(r=(t=e)&&t.constructor,i="function"==typeof r&&r.prototype||T,t!==i)return q(e);var t,r,i,n=[];for(var o in Object(e))R.call(e,o)&&"constructor"!=o&&n.push(o);return n}function fe(e,t,r,i,n,o){var a=1&r,s=e.length,c=t.length;if(s!=c&&!(a&&c>s))return!1;var l=o.get(e);if(l&&o.get(t))return l==t;var d=-1,u=!0,m=2&r?new oe:void 0;for(o.set(e,t),o.set(t,e);++d<s;){var p=e[d],f=t[d];if(i)var g=a?i(f,p,d,t,e,o):i(p,f,d,e,t,o);if(void 0!==g){if(g)continue;u=!1;break}if(m){if(!y(t,(function(e,t){if(a=t,!m.has(a)&&(p===e||n(p,e,r,i,o)))return m.push(t);var a}))){u=!1;break}}else if(p!==f&&!n(p,f,r,i,o)){u=!1;break}}return o.delete(e),o.delete(t),u}function ge(e){return function(e,t,r){var i=t(e);return _e(e)?i:function(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}(i,r(e))}(e,ke,be)}function he(e,t){var r,i,n=e.__data__;return("string"==(i=typeof(r=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==r:null===r)?n["string"==typeof t?"string":"hash"]:n.map}function ve(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return me(r)?r:void 0}re.prototype.clear=function(){this.__data__=K?K(null):{},this.size=0},re.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},re.prototype.get=function(e){var t=this.__data__;if(K){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return R.call(t,e)?t[e]:void 0},re.prototype.has=function(e){var t=this.__data__;return K?void 0!==t[e]:R.call(t,e)},re.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=K&&void 0===t?"__lodash_hash_undefined__":t,this},ie.prototype.clear=function(){this.__data__=[],this.size=0},ie.prototype.delete=function(e){var t=this.__data__,r=ce(t,e);return!(r<0)&&(r==t.length-1?t.pop():U.call(t,r,1),--this.size,!0)},ie.prototype.get=function(e){var t=this.__data__,r=ce(t,e);return r<0?void 0:t[r][1]},ie.prototype.has=function(e){return ce(this.__data__,e)>-1},ie.prototype.set=function(e,t){var r=this.__data__,i=ce(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this},ne.prototype.clear=function(){this.size=0,this.__data__={hash:new re,map:new(W||ie),string:new re}},ne.prototype.delete=function(e){var t=he(this,e).delete(e);return this.size-=t?1:0,t},ne.prototype.get=function(e){return he(this,e).get(e)},ne.prototype.has=function(e){return he(this,e).has(e)},ne.prototype.set=function(e,t){var r=he(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this},oe.prototype.add=oe.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},oe.prototype.has=function(e){return this.__data__.has(e)},ae.prototype.clear=function(){this.__data__=new ie,this.size=0},ae.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},ae.prototype.get=function(e){return this.__data__.get(e)},ae.prototype.has=function(e){return this.__data__.has(e)},ae.prototype.set=function(e,t){var r=this.__data__;if(r instanceof ie){var i=r.__data__;if(!W||i.length<199)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new ne(i)}return r.set(e,t),this.size=r.size,this};var be=V?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,i=null==e?0:e.length,n=0,o=[];++r<i;){var a=e[r];t(a,r,e)&&(o[n++]=a)}return o}(V(e),(function(t){return x.call(e,t)})))}:function(){return[]},ye=le;function we(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||c.test(e))&&e>-1&&e%1==0&&e<t}function Ee(e){if(null!=e){try{return C.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Se(e,t){return e===t||e!=e&&t!=t}(B&&"[object DataView]"!=ye(new B(new ArrayBuffer(1)))||W&&ye(new W)!=n||z&&"[object Promise]"!=ye(z.resolve())||H&&ye(new H)!=a||Y&&"[object WeakMap]"!=ye(new Y))&&(ye=function(e){var t=le(e),r=t==o?e.constructor:void 0,i=r?Ee(r):"";if(i)switch(i){case J:return"[object DataView]";case X:return n;case $:return"[object Promise]";case Q:return a;case Z:return"[object WeakMap]"}return t});var Oe=de(function(){return arguments}())?de:function(e){return Ce(e)&&R.call(e,"callee")&&!x.call(e,"callee")},_e=Array.isArray;var Ie=G||function(){return!1};function Ae(e){if(!Pe(e))return!1;var t=le(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Te(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Pe(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ce(e){return null!=e&&"object"==typeof e}var Re=b?function(e){return function(t){return e(t)}}(b):function(e){return Ce(e)&&Te(e.length)&&!!l[le(e)]};function ke(e){return null!=(t=e)&&Te(t.length)&&!Ae(t)?se(e):pe(e);var t}r.exports=function(e,t){return ue(e,t)}}).call(this,r(38),r(46)(e))},function(e){e.exports=JSON.parse('{"sandbox":[{"rid":"AB","regionCode":"RWDZN6QI75UE","countryCode":"CWFOD0UV85MO"},{"rid":"BC","regionCode":"ROOCW9CR00JN","countryCode":"CWFOD0UV85MO"},{"rid":"MB","regionCode":"RKWBU6CM00TU","countryCode":"CWFOD0UV85MO"},{"rid":"NB","regionCode":"RIKBA0YR59VJ","countryCode":"CWFOD0UV85MO"},{"rid":"NL","regionCode":"RNCVX0PW47KU","countryCode":"CWFOD0UV85MO"},{"rid":"NT","region_code":"RMAPW5GN99YX","country_code":"CWFOD0UV85MO"},{"rid":"NS","regionCode":"RMRAD4CA77SC","countryCode":"CWFOD0UV85MO"},{"rid":"NU","regionCode":"RKYNS0ER81CE","countryCode":"CWFOD0UV85MO"},{"rid":"ON","regionCode":"RBREU4CY43JU","countryCode":"CWFOD0UV85MO"},{"rid":"PE","regionCode":"RPJAA1KU68IE","countryCode":"CWFOD0UV85MO"},{"rid":"QC","regionCode":"RWXBL0AY76CO","countryCode":"CWFOD0UV85MO"},{"rid":"SK","regionCode":"RVRUA7PS80WC","countryCode":"CWFOD0UV85MO"},{"rid":"YT","regionCode":"RDTIK0XN86OA","countryCode":"CWFOD0UV85MO"}],"production":[{"rid":"AB","regionCode":"RSUTM0SO50SJ","countryCode":"CXDYL2BO48SC"},{"rid":"BC","regionCode":"RXVJL0CH05QK","countryCode":"CXDYL2BO48SC"},{"rid":"MB","regionCode":"RVWXX8LS18UG","countryCode":"CXDYL2BO48SC"},{"rid":"NB","regionCode":"RKIMI3NT14TK","countryCode":"CXDYL2BO48SC"},{"rid":"NL","regionCode":"RQCQU0ZT75OB","countryCode":"CXDYL2BO48SC"},{"rid":"NT","regionCode":"RIEYF1DG86OU","countryCode":"CXDYL2BO48SC"},{"rid":"NS","regionCode":"RDOKH2GN91UO","countryCode":"CXDYL2BO48SC"},{"rid":"NU","regionCode":"RWBSH3SP98GV","countryCode":"CXDYL2BO48SC"},{"rid":"ON","regionCode":"RVTFW6NV48SC","countryCode":"CXDYL2BO48SC"},{"rid":"PE","regionCode":"RCJOR5AJ63TS","countryCode":"CXDYL2BO48SC"},{"rid":"QC","regionCode":"RJNOG5UK61SB","countryCode":"CXDYL2BO48SC"},{"rid":"SK","regionCode":"RGBPT9SN49FH","countryCode":"CXDYL2BO48SC"},{"rid":"YT","regionCode":"RVQSP8RT68OC","countryCode":"CXDYL2BO48SC"}]}')},function(e,t,r){e.exports=r(58)},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,r){var i=r(48);"string"==typeof i&&(i=[[e.i,i,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};r(33)(i,n);i.locals&&(e.exports=i.locals)},function(e,t,r){(e.exports=r(32)(!1)).push([e.i,".ad-refresh{align-items:center !important;display:flex !important;flex-direction:column;justify-content:center}.ad-refresh-bkgd{background-color:#f7f7f7 !important}",""])},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var r=t.protocol+"//"+t.host,i=r+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var n,o=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?e:(n=0===o.indexOf("//")?o:0===o.indexOf("/")?r+o:i+o.replace(/^\.\//,""),"url("+JSON.stringify(n)+")")}))}},function(e,t,r){var i=r(51);"string"==typeof i&&(i=[[e.i,i,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};r(33)(i,n);i.locals&&(e.exports=i.locals)},function(e,t,r){(e.exports=r(32)(!1)).push([e.i,".readonly-input{pointer-events:none;color:#666;border-color:#efefef}",""])},function(e,t,r){var i=r(53);"string"==typeof i&&(i=[[e.i,i,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};r(33)(i,n);i.locals&&(e.exports=i.locals)},function(e,t,r){(e.exports=r(32)(!1)).push([e.i,".password-requirements-wrapper{display:none;margin-bottom:1.5rem}.password-requirements-wrapper p{font-size:.875rem;line-height:1.2;margin-bottom:.75rem}.password-requirements-wrapper--show{display:block}.password-requirements-list{list-style-type:none;margin:0;padding:0}.password-requirements-list li{display:flex;align-items:center;margin-bottom:.5rem}.password-requirement-icon{margin-right:.25rem;height:1.5rem}.password-requirement--valid circle{fill:#2b9202;stroke:#2b9202}.password-requirement--valid path{fill:#fff}.password-requirement-sr-only{position:absolute;padding:0;width:.063rem;height:.063rem;overflow:hidden;margin:-0.063rem;clip:rect(0, 0, 0, 0)}.password-requirement-text{font-size:.875rem;line-height:1}",""])},function(e,t,r){var i=r(55);"string"==typeof i&&(i=[[e.i,i,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};r(33)(i,n);i.locals&&(e.exports=i.locals)},function(e,t,r){(e.exports=r(32)(!1)).push([e.i,".agegate{position:relative}.agegate>*{display:flex;height:auto !important;justify-content:center}.agegate-msg{font-size:8px;font-weight:700;line-height:8px;text-align:center;text-transform:uppercase;margin-top:5px !important}.agegate-veil{background:rgba(51,51,51,.95);color:#fff;display:flex;flex-flow:column;font-family:helvetica;justify-content:center;position:absolute;padding:0 2em;box-sizing:border-box;text-align:center}.agegate-veil form{align-items:center;display:flex;flex-flow:wrap}.agegate-veil form button{color:#fff;cursor:pointer;background-color:#53a500;border:none;border-radius:.25em;font-size:12px;font-weight:inherit;margin:.5em auto;padding:10px 40px;text-transform:uppercase;transition:all .25s ease-out}.agegate-veil form button:disabled{background-color:#b9b9b9;pointer-events:none}.agegate-veil form>*:first-child{font-size:16px;flex:1 1 50%;line-height:20px}.agegate-veil form>*:last-child{display:inline-flex;flex:1 1 10em;flex-flow:column;font-size:14px;font-weight:700}.agegate-veil form input{margin-right:.7em}.agegate-veil form p{margin:1em}",""])},,,function(e,t,r){"use strict";r.r(t),r.d(t,"initPage",(function(){return Lr})),r.d(t,"getAdTargetingConfig",(function(){return Nr})),r.d(t,"GlobalStore",(function(){return Et.a})),r.d(t,"Store",(function(){return _.a}));var i=r(8);class n extends i.a{fromJson(e){return super.fromJson(e),this.provider=e.provider,e.tags&&(this.tags=e.tags),this}}var o=r(14);class a extends i.a{fromJson(e){return super.fromJson(e),e.ancestry&&(this.ancestry=e.ancestry),e.type&&(this.type=e.type),this.provider=e.provider,e.bidding&&(this.bidding=e.bidding),e.verifier&&(this.verifier=e.verifier),e.refresh&&(this.refresh=e.refresh),e.lazy&&(this.lazy=e.lazy),e.commentAdConfiguration&&(this.commentAdConfiguration=e.commentAdConfiguration),e.stickyAd&&(this.stickyAd=e.stickyAd),e.magniteInArticle&&(this.magniteInArticle=e.magniteInArticle),e.topics&&(this.topics=e.topics),e.hub&&(this.hub=e.hub),e.spoke&&(this.spoke=e.spoke),this}}class s extends i.a{fromJson(e){return super.fromJson(e),e.links&&(this.links=e.links),e.sso&&(this.sso=e.sso),e.subscriber&&(this.subscriber=e.subscriber),e.gnsOptions&&(this.gnsOptions=e.gnsOptions),e.logo&&(this.logo=e.logo),e.microsoftLogin&&(this.microsoftLogin=e.microsoftLogin),e.showNewsletterOptIn&&(this.showNewsletterOptIn=e.showNewsletterOptIn),e.sophiPaywallOffer&&(this.sophiPaywallOffer=e.sophiPaywallOffer),e.useSophiDecision&&(this.useSophiDecision=e.useSophiDecision),e.showOnboardPages&&(this.showOnboardPages=e.showOnboardPages),this}}var c=r(12),l=r(5);class d extends i.a{fromJson(e){if(super.fromJson(e),e.authors){var t=e.authors.map(e=>"object"==typeof e?e:{name:e});this.writers={main:t}}return e.writers&&(this.writers=e.writers),e.date&&(this.date={},e.date.mod&&(this.date.mod=new Date(Date.parse(e.date.mod))),e.date.pub&&(this.date.pub=new Date(Date.parse(e.date.pub))),e.date.pub_timestamp&&(this.date.pub_timestamp=e.date.pub_timestamp),e.date.mod_timestamp&&(this.date.mod_timestamp=e.date.mod_timestamp)),e.klangoo&&(this.klangoo=e.klangoo),e.title&&(this.title=e.title),e.video&&(this.video=e.video),e.otherAncestry&&(this.otherAncestry=e.otherAncestry),e.ageGate&&(this.ageGate=e.ageGate),e.drivingTaxonomy&&(this.drivingTaxonomy=e.drivingTaxonomy),e.abTest&&(this.abTest=e.abTest),this}getTitle(){var e="";return this.title&&this.title.main&&(e=l.c.decodeHtmlEntity(this.title.main)),e}getHeadline(){var e="";return this.title&&this.title.alt&&(e=l.c.decodeHtmlEntity(this.title.alt)),e}getCategories(){return this.type!==c.a.INDEX||this.ancestry&&this.ancestry.length?[...this.ancestry||[]]:["index"]}}class u extends i.a{constructor(e){super(),e&&e.ads&&(this.ads=o.a.buildOne(a,e.ads)),e&&e.analytics&&(this.analytics=o.a.buildOne(n,e.analytics)),e&&e.identity&&(this.identity=o.a.buildOne(s,e.identity)),this.page=o.a.buildOne(d,e.page||{})}}var m=r(39),p=r(24),f=r(4),g=r(27),h=r(40),v=r.n(h),b=r(42),y=r(0),w=r(1);function E(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class S extends i.a{constructor(e){if(super(),E(this,"trendingWidgetClass","article-content__widget-group--trending-slot"),E(this,"trendingWidgetListClass","list-widget-trending"),E(this,"ad2Class","ad_counter_2"),e.page.abTest&&e.page.abTest.useNewStoryPageTemplate)if(this.isDesktopLayout)this.position();else{var t=v()(()=>{this.isDesktopLayout&&(this.position(),window.removeEventListener("resize",t))},S.WindowResizeDebounce);window.addEventListener("resize",t)}}get isDesktopLayout(){return w.b.deviceType()===w.c.DESKTOP}position(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=document.querySelector(".".concat(this.trendingWidgetClass)),r=document.querySelector(".".concat(this.ad2Class));if(t&&r&&t.querySelector(".".concat(this.trendingWidgetListClass))){var i=t.querySelector(".".concat(this.trendingWidgetListClass)),n=()=>{i.style.top="".concat(S.OffsetFromAd2+r.getBoundingClientRect().height,"px")};r.style.position="relative";var{left:o,width:a}=i.getBoundingClientRect();this.trendingWidgetWidth=a,i.style.position="absolute",i.style.left="".concat(o,"px"),n(),i.style.width="".concat(a,"px"),t.style.gridRow="2/span 1",r.appendChild(i);var s=v()(()=>{var{left:e}=t.getBoundingClientRect();i.style.left="".concat(e,"px"),this.isDesktopLayout?(i.style.position="absolute",i.style.width="".concat(this.trendingWidgetWidth,"px"),r.appendChild(i)):(i.style.position="unset",i.style.width="unset",t.appendChild(i))},S.WindowResizeDebounce);new b.a(()=>{n()}).observe(r),window.addEventListener("resize",s)}else e<S.LoopsToDetectTrendingWidget?setTimeout(()=>{this.position(e+1)},S.DetectTrendingWidgetInterval):Object(y.b)("error","Could not localise trending or ad element")}}E(S,"LoopsToDetectTrendingWidget",5),E(S,"DetectTrendingWidgetInterval",100),E(S,"OffsetFromAd2",60),E(S,"WindowResizeDebounce",15);var O=r(3),_=r(2),I=r(9),A=r(7),T=r(26),P=r(11),C=r(19);function R(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class k{constructor(e,t,r,i){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};R(this,"adAttrs",[]),R(this,"el",void 0),R(this,"adEvent",C.a.SLOT_ADDED),R(this,"DOM",{attrs:{class:"viafoura",mobileSize:"data-comments-ad-size-mobile",ref:"data-comments-ad-ref",size:"data-comments-ad-size",target:"data-comments-ad-target",viafouraAd:"data-ad-comment"},classes:{adContainer:"ad__inner__container"}}),this.wrapper=e,this.attrs=t,this.vfTag=r,this.insertAfterVfTag=i,this.adCount=n,this.customEventHandlers=o,this.loadWidget()}handleAdSlotEvent(e){if(w.b.idElementExists("".concat(e))){var t=document.getElementById("".concat(e));for(var r of T.a.DOM.class.adContainers)t.setAttribute(w.b.attrs.class,"".concat(r));var i=document.createElement("div");i.setAttribute(P.b.attr.location.key,"".concat(this.adCount)),this.adAttrs.forEach(e=>{i.setAttribute(e.key,e.value)}),t.append(i),Object(y.b)("info","added new ad slot for viafoura: ".concat(e,", ad counter ").concat(this.adCount)),this.dispatchNewAdEvent(e),this.adCount=this.adCount+1}}dispatchNewAdEvent(e){var t=w.b.nodes(document.querySelector("#".concat(e," [").concat(this.DOM.attrs.viafouraAd,"]")));dispatchEvent(new CustomEvent(this.adEvent,{detail:{el:t}}))}getConversationStarterState(){var e=this.el.querySelectorAll(".vf-conversation-starter_text > span");if(e[1]&&e[1].textContent.trim()===this.attrs.find(e=>"description"===e.key).value)return"none";return this.el.querySelectorAll(".polls__question").length?"polls":this.el.querySelectorAll(".vf-editors-pick_container-comment-text").length?"pinnedComment":"none"}loadWidget(){if(this.el=document.querySelector("[".concat(this.wrapper,"]")),this.el){var e=document.createElement("div");w.b.addClass(e,this.DOM.attrs.class);var t=document.createElement(this.vfTag);this.attrs.forEach(e=>{t.setAttribute(e.key,e.value)}),e.appendChild(t),this.insertAfterVfTag&&this.insertAfterVfTag.forEach(t=>{e.appendChild(document.createElement(t))}),this.el.appendChild(e),this.initAdAttributes(),this.initCustomEventHandlers(),Object(y.b)("debug","viafoura widget loaded for wrapper: ".concat(this.wrapper," - appended to element as child"))}else Object(y.b)("debug","viafoura widget not loaded for wrapper: ".concat(this.wrapper," - wrapper not present"))}initAdAttributes(){this.adAttrs=[{key:w.b.attrs.class,value:this.DOM.classes.adContainer},{key:P.b.attr.target.key,value:this.el.getAttribute(this.DOM.attrs.target)},{key:P.b.attr.size.key,value:this.el.getAttribute(this.DOM.attrs.size)},{key:P.b.attr.mobileSize.key,value:this.el.getAttribute(this.DOM.attrs.mobileSize)},{key:P.c.attr.state.key,value:this.el.getAttribute(this.DOM.attrs.ref)},{key:"".concat(this.DOM.attrs.viafouraAd),value:""}]}initCustomEventHandlers(){var e=this,t=function(t){e.el.addEventListener(r,r=>{t(e,r)})};for(var[r,i]of Object.entries(this.customEventHandlers))t(i)}}function D(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function j(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){D(o,i,n,a,s,"next",e)}function s(e){D(o,i,n,a,s,"throw",e)}a(void 0)}))}}function M(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class L{constructor(){M(this,"displayAds",!0),M(this,"loadViafouraWidgets",!1),M(this,"DOM",{attrs:{jsUrl:"//cdn.viafoura.net/vf-v2.js",myTopics:"data-my-topics",signOut:"data-id-logout"},classes:{adLight:"ad__adlight"},loginRadiusClasses:{emailValidation:"email-validation-container"},loginRadiusIds:{forgotPassword:"forgotpassword-container",login:"login-container",registration:"registration-container",resetPassword:"resetpassword-container"},widgets:{contentRecirculation:"vf-content-recirculation",conversationStarter:"vf-conversation-starter",conversations:"vf-conversations",dropdownItem:"vf-dropdown__list-item",trayTrigger:"vf-tray-trigger"},wrappers:{carousel:{customEventHandlers:{click:(e,t)=>{var r=t.target,i=this.scrapeTargetUrlAndAnchorText(r);i.targetUrl&&document.dispatchEvent(new CustomEvent(w.a.CUSTOM_EVENT,{detail:{anchor_text:i.anchorText,click_source_type:"widget-list",control_fields:{mparticle:{keys:{anchor_text:"anchor_text",click_source_type:"click_source_type",layout_section:"layout_section",target_url:"target_url",widget_title:"widget_title"},mp_event_type:"Navigation"}},event_name:A.a.customEventNames.click,layout_section:"most-commented",target_url:i.targetUrl,widget_title:"most-commented"}}))}},selector:"data-sso-carousel",title:"Most Commented"},commenting:{attrs:{commentsLimit:"",commentsLoadMoreLimit:"",firstPromoPosition:"1",promoInterval:"10",replyLimit:""},customEventHandlers:{click:(e,t)=>{var r=t.target;if(r.innerHTML.includes("Load more comments")&&"true"!==r.getAttribute("data-evt-skip-click")){var i=r.parentElement.classList.contains("vf-load-more")||r.parentElement.classList.contains("vf-loader-button__content")?"other":"first",n=new CustomEvent("custom-event",{detail:{action_type:"load_more",context:"comments",control_fields:{mparticle:{keys:{action_type:"action_type",context:"context",occurrence:"occurrence"},mp_event_type:"Other"}},event_name:"on_page_action_click",occurrence:i}});document.dispatchEvent(n)}}},selector:"data-sso-commenting",title:""},conversationStarter:{customEventHandlers:{click:(e,t)=>{var r=t.target;if(r.classList.contains("vf-conversation-starter_link")){var i=new CustomEvent("custom-event",{detail:{control_fields:{mparticle:{keys:{source_section:"source_section",source_state:"source_state",target_name:"target_name"},mp_event_type:"Other"}},event_name:"click_to_section",source_section:"conversation_starter",source_state:e.getConversationStarterState(),target_name:new URL(r.href).hash}});document.dispatchEvent(i)}}},description:"Leave a comment and share your thoughts with our community.",selector:"data-sso-conversation-starter",target:"comments",title:"Have your say"}}}),M(this,"commentsCount",0),M(this,"totalAllowedComments",-1),M(this,"viafouraClickListeners",{"trending-list__title":this.displayConsole,"vf-js-tray-activator":this.displayConsole})}static sendLoginAnalytics(e){document.dispatchEvent(new CustomEvent(w.a.CUSTOM_EVENT,{detail:{control_fields:{mparticle:{keys:{integration_name:"integration_name",sign_in_method:"sign_in_method"},mp_event_type:"UserContent"}},event_name:A.a.customEventNames.signin,integration_name:"Viafoura",sign_in_method:e}}))}static sendRegistrationAnalytics(e){document.dispatchEvent(new CustomEvent(w.a.CUSTOM_EVENT,{detail:{control_fields:{mparticle:{keys:{integration_name:"integration_name",registration_method:"registration_method"},mp_event_type:"UserContent"}},event_name:A.a.customEventNames.registration,integration_name:"Viafoura",registration_method:e}}))}static PopulateCommentSection(){return j((function*(){var e=localStorage.getItem(_.a.VF_COMMENT_TEXT);if(e){Object(y.b)("debug","populating viafoura comment textarea with: "+e);var t=document.querySelector(".vf-content-editor-input");t?(t.value=e,Object(y.b)("debug","populated vf comment textarea successfully")):Object(y.b)("debug","unable to populate vf comment textarea, cannot find element"),localStorage.removeItem(_.a.VF_COMMENT_TEXT)}}))()}static ScrollToComments(){if(new URLSearchParams(window.location.search).has("comments")){var e=document.getElementById("comments");e&&e.scrollIntoView()}}scrapeTargetUrlAndAnchorText(e){for(var t=e,r=0;null!==t&&r<7;){var i;if("a"===t.tagName.toLowerCase())return{targetUrl:(t.getAttribute("href")||"").split("?")[0],anchorText:(null===(i=t.querySelector(".vf-primary-text p"))||void 0===i||null===(i=i.textContent)||void 0===i?void 0:i.trim())||""};t=t.parentElement,r++}return{targetUrl:"",anchorText:""}}scrapeInitialNumberOfComments(){if(this.commentWidget&&this.commentWidget.el){var e=this.commentWidget.el.querySelector("nav");if(e){var t=e.querySelectorAll("span");if(t.length>4){var r=t[4].textContent.trim();return parseInt(r,10)||0}}}return 0}closeConversation(){if(this.commentWidget&&this.commentWidget.el){this.commentWidget.el.classList.add("commenting-closed");var e=this.commentWidget.el.querySelector(".vf-post-form__new-content");if(e){var t=e.querySelector("textarea");t&&"The conversation is now closed"!==t.getAttribute("placeholder")&&(t.setAttribute("placeholder","The conversation is now closed"),t.setAttribute("aria-label","The conversation is now closed"),t.setAttribute("disabled","disabled"),t.setAttribute("style","overflow-x: hidden; overflow-wrap: break-word; height: 25px;"))}}}blockCommenting(){if(this.commentWidget&&this.commentWidget.el){this.commentWidget.el.classList.add("commenting-closed");var e=this.commentWidget.el.querySelector(".vf-post-form__new-content");if(e){var t=e.querySelector("textarea");t&&"The conversation is now closed"!==t.getAttribute("placeholder")&&e.remove()}}}articleBlockerDisplayed(e){if(!e.classList.contains("hidden")){var t=e.querySelector(".intro-body__anonymous");if(t&&t.classList.contains("hidden"))return!0}return!1}handleCommentingBlockedByPaywall(){var e=document.querySelector("#article-block");e&&(this.articleBlockerDisplayed(e)?this.blockCommenting():new MutationObserver(t=>{this.articleBlockerDisplayed(e)&&this.blockCommenting()}).observe(e,{attributes:!0,attributeFilter:["class"]}))}handleCommentingBlockedByEmailVerification(){(JSON.parse(localStorage.getItem(_.a.LR_USER))||{}).EmailVerified||(this.blockCommenting(),this.addEmailVerificationModal())}addEmailVerificationModal(){if(this.commentWidget&&this.commentWidget.el){var e=document.createElement("div");e.classList.add("email-verification-card"),e.innerHTML='\n              <section>\n                  <h3>Verify your email</h3>\n                  <h4>Help keep your account safe</h4>\n                  <p>You will be sent a link to verify your email address after clicking the button.</p>\n              </section>\n              <section>\n                  <button class="button button--primary" type="button">\n                    <span class="button__text">Verify now</span>\n                  </button>\n              </section>\n            ',this.commentWidget.el.insertBefore(e,this.commentWidget.el.children[1]),console.log("DONE")}}enable(){this.addSubscriptions(),this.addListeners()}addSubscriptions(){window.vfQ.push(()=>{this.buildSubscriptions()})}buildSubscriptions(){this.commentWidget&&this.displayAds&&(Object(y.b)("debug","Viafoura $subscribe bind comment Ad Slot"),window.vf.$subscribe("vf-ads","requestCommentAd",this.commentWidget.handleAdSlotEvent.bind(this.commentWidget))),this.carouselWidget&&this.displayAds&&(Object(y.b)("debug","Viafoura $subscribe bind carousel Ad Slot"),window.vf.$subscribe("vf-ads","requestContentRecirculationAd",this.carouselWidget.handleAdSlotEvent.bind(this.carouselWidget))),window.vf.$subscribe("logout","success",()=>{Object(y.b)("debug","Viafoura $subscribe logout success"),document.dispatchEvent(l.c.event(f.a.COMMENT_LOGOUT))}),window.vf.$subscribe("comment","created",()=>{var e=document.querySelector(".top-commenter-offer");e&&(e.setAttribute("data-evt-skip-click","true"),e.click()),this.commentsCount++,this.totalAllowedComments>-1&&this.commentsCount>=this.totalAllowedComments&&this.closeConversation()}),window.vf.$subscribe("comment-reply","posted",()=>{this.commentsCount++,this.totalAllowedComments>-1&&this.commentsCount>=this.totalAllowedComments&&this.closeConversation()}),window.vf.$subscribe("commenting","loaded",()=>{var e=document.querySelector(".v3-comments__post-form"),t=document.createElement("div");t.className="top-commenter-offer",t.style.margin="-10px 0px 0px 0px",e.appendChild(t);var r=document.createElement("div");r.className="top-commenter-reminder",r.style.margin="-10px 0px 0px 0px",r.classList.add("hidden"),e.appendChild(r),this.commentsCount=this.scrapeInitialNumberOfComments(),this.commentWidget&&this.commentWidget.el&&(this.totalAllowedComments=parseInt(this.commentWidget.el.dataset.totalAllowedComments,10)||-1),this.totalAllowedComments>-1&&this.commentsCount>=this.totalAllowedComments&&this.closeConversation(),this.commentWidget&&this.commentWidget.el&&("commentingBlockedByPaywall"in this.commentWidget.el.dataset&&this.handleCommentingBlockedByPaywall(),"commentingRequiresEmailVerification"in this.commentWidget.el.dataset&&this.handleCommentingBlockedByEmailVerification())}),window.vf.$prepublish((function(e,t){if("authentication"===e&&"required"===t){Object(y.b)("debug","Viafoura $prepublish authentication required");var r=document.querySelector(".vf-content-editor-input");r&&localStorage.setItem(_.a.VF_COMMENT_TEXT,r.value);var i=location.search.length>0?"&comments":"?comments",n=location.href+i;return document.dispatchEvent(l.c.event(f.a.COMMENT_LOGIN,{redirectUrl:n})),!1}for(var o=arguments.length,a=new Array(o>2?o-2:0),s=2;s<o;s++)a[s-2]=arguments[s];return{channel:e,event:t,args:a}}))}addListeners(){var e=this;document.addEventListener("click",function(){var t=j((function*(t){var r=t.target;for(var i in e.viafouraClickListeners)r.classList.contains(i)&&e.eventFunction(e.viafouraClickListeners[i],i)}));return function(e){return t.apply(this,arguments)}}());var t=document.querySelector(".comments__section-viafoura-container");t&&t.addEventListener("click",j((function*(){Object(y.b)("debug","Viafoura clicked - populating comments section"),yield L.PopulateCommentSection()})))}removeCommentWidgetsAdUI(){for(var e of(this.displayAds=!1,Object.values(this.DOM.wrappers)))this.updateAdlightUserStatus(e,this.displayAds),Object(y.b)("debug","Viafoura set adLight status for: "+e)}updateAdlightUserStatus(e,t){var r=document.querySelectorAll("[".concat(e.selector,"]"));if(r&&!t)for(var i of r)w.b.addClass(i,this.DOM.classes.adLight),Object(y.b)("debug","viafoura remove ads from: ".concat(i));else if(r&&t)for(var n of r)w.b.removeClass(n,this.DOM.classes.adLight)}displayConsole(e){Object(y.b)("debug","target: ",e)}eventFunction(e,t){e(t)}initialize(e,t){var r=this;return j((function*(){if(window.vfQ)return r;var i;window.vf=window.vf||{events:{}},window.vfQ=window.vfQ||[],e&&(i=e.commentAdConfiguration),i&&(r.DOM.wrappers.commenting.attrs.firstPromoPosition=i.firstPromoPosition?i.firstPromoPosition:"1",r.DOM.wrappers.commenting.attrs.promoInterval=i.promoInterval?i.promoInterval:"10"),Object(y.b)("debug","comment section is now in view"),yield w.b.ready;var n=document.querySelector("[".concat(r.DOM.attrs.signOut,"]")),o=document.querySelector("[".concat(r.DOM.attrs.myTopics,"]"));if(n&&!o&&(yield r.scriptLoad(r.DOM.attrs.jsUrl),Object(y.b)("debug","Viafoura JS is now ready")),yield r.validateViafouraRequired(r.DOM.wrappers),r.loadViafouraWidgets){for(var[a,s]of Object.entries(r.DOM.wrappers))r.updateAdlightUserStatus(s,r.displayAds),yield r.loadViafouraUI(a,s),Object(y.b)("debug","Viafoura UI is now ready for: "+s);yield r.scssLoad();var c=(document.cookie.split(";").find(e=>e.trim().startsWith("".concat(_.a.COMMENT_METER,"=")))||"").trim().split("=").pop()||"false";Object(y.b)("debug","Viafoura CSS is now ready"),window.vfQ.push(j((function*(){var e=yield window.vf.context.get("user");if(Object(y.b)("debug","Viafoura user: ".concat(e)),t&&0!==e.anonymous)Object(y.b)("debug","logging in viafoura user using token from FEM ".concat(t)),window.vf.session.login.loginRadius(t);else{var i=I.a.get(_.a.ID);t&&e&&i&&i.name!==e.name&&window.vf.session.login.loginRadius(t)}if("expired"===c&&(window.vf.$subscribe("commenting","loaded",()=>{var e=document.getElementsByClassName("vf-load-more__button");if(e.length>0){var t=e[0];t.setAttribute("data-evt-skip-click","true"),t.click()}}),r.commentWidget&&r.commentWidget.el)){var n=r.commentWidget.el.getElementsByTagName("vf-conversations");n&&n.length>0&&n[0].setAttribute("limit","1")}r.enable(),yield w.b.ready})))}return r}))()}doWidgetSignout(){return j((function*(){window.vf&&window.vf.session&&(Object(y.b)("info","signing out viafoura user"),yield window.vf.session.logout(),Object(y.b)("info","viafoura user signed out"))}))()}validateViafouraRequired(e){var t=this;return j((function*(){for(var r of Object.values(e))if(document.querySelector("[".concat(r.selector,"]")))return t.loadViafouraWidgets=!0,!0;return!1}))()}scssLoad(){return j((function*(){try{Object(y.b)("debug","viafoura loading css './styles/viafoura.scss'");var e=r.e(4).then(r.t.bind(null,71,7));return w.b.addStyles((yield e).default),!0}catch(e){return Object(y.b)("error","Error loading viafoura css: "+e),!1}}))()}scriptLoad(e){var t=this;return j((function*(){try{return Object(y.b)("debug","viafoura loading script ".concat(t.DOM.attrs.jsUrl)),w.b.loadScript(e),!0}catch(e){return Object(y.b)("error","Error loading viafoura css: "+e),!1}}))()}loadViafouraUI(e,t){var r=this;return j((function*(){try{var i=document.querySelector("[".concat(t.selector,"]"));if(i)switch(e){case"commenting":return Object(y.b)("debug","viafoura creating commenting widget"),t.attrs.replyLimit=i.dataset.replyLimit,t.attrs.commentsLimit=i.dataset.commentsLimit,t.attrs.commentsLoadMoreLimit=i.dataset.commentsLoadMoreLimit,r.commentWidget=new k(r.DOM.wrappers.commenting.selector,[{key:"first-promo-position",value:t.attrs.firstPromoPosition},{key:"promoInterval",value:t.attrs.promoInterval},{key:"limit",value:t.attrs.commentsLimit},{key:"pagination-limit",value:t.attrs.commentsLoadMoreLimit},{key:"reply-limit",value:t.attrs.replyLimit}],r.DOM.widgets.conversations,["".concat(r.DOM.widgets.trayTrigger)],2,r.DOM.wrappers.commenting.customEventHandlers),!0;case"carousel":return Object(y.b)("debug","viafoura creating carousel widget"),r.carouselWidget=new k(r.DOM.wrappers.carousel.selector,[{key:"title",value:t.title}],r.DOM.widgets.contentRecirculation,void 0,1,r.DOM.wrappers.carousel.customEventHandlers),!0;case"conversationStarter":return Object(y.b)("debug","viafoura creating conversation starter widget"),r.conversationStarterWidget=new k(r.DOM.wrappers.conversationStarter.selector,[{key:"title",value:t.title},{key:"description",value:t.description},{key:"target",value:t.target}],r.DOM.widgets.conversationStarter,void 0,1,r.DOM.wrappers.conversationStarter.customEventHandlers),!0}return Object(y.b)("debug","viafoura widget selector not found: ".concat(t.selector)),!1}catch(e){return Object(y.b)("error","viafoura create ".concat(t.selector," error: ").concat(e)),!1}}))()}}var N=r(16),x=r(34),U=r(29);function F(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function V(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){F(o,i,n,a,s,"next",e)}function s(e){F(o,i,n,a,s,"throw",e)}a(void 0)}))}}function G(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var q=function(e){return e.ALREADY_HAS_ACCESS="alreadyHasAccess",e.CHECKOUT_COMPLETED="checkoutCompleted",e.VOUCHER_REDEMPTION_COMPLETED="voucherRedemptionCompleted",e.CLOSE="close",e}(q||{}),B=function(e){return e.PREMIUM_SHOW_OFFER="Premium Show Offer",e.REGISTRATION_ONLY_USER_SEGMENT="Registration Only User segment",e}(B||{}),W=function(e){return e.MAINSITE='a, main, input, select, textarea, details, audio, video, [tabindex="0"], button:not(.tp-close)',e.MODAL=".tp-iframe-wrapper.tp-active",e.MAIN="main",e}(W||{});class z{constructor(){G(this,"openCheckoutAfterLogin",!1),G(this,"pianoEnabled",!0),G(this,"pianoEndpoints",{access:"/access/list",conversions:"/conversion/list",externalCreate:"/conversion/external/create",register:"/conversion/registration/create"}),G(this,"pianoExpUrl","//experience.tinypass.com/xbuilder/experience/load?aid="),G(this,"pianoSandboxUrl","//sandbox.tinypass.com/xbuilder/experience/load?aid=")}closeCheckoutModal(){window.tp.offer.close(),"/my-offers"===window.location.pathname?this.setFocusOnModalTabs():this.setFocusOnMainTabs();var e=sessionStorage?sessionStorage.getItem("redirect_url"):location.origin,t=sessionStorage?sessionStorage.getItem(_.a.LR_TOKEN_KEY):void 0,r=document.querySelector(".".concat(z.DOM.class.pageRegistrationSuccess));sessionStorage.removeItem(_.a.USER_WANTS),sessionStorage.removeItem(_.a.PIANO_PARAMS),r||e&&(t?location.replace("".concat(N.b.ssoRedirectLink,"&token=").concat(t,"&callback=").concat(e)):location.replace(e))}showPaywall(e,t){window.tp.push(["init",()=>{window.tp.offer.show({displayMode:"modal",offerId:e,showCloseButton:!1,templateId:t})}])}showOffer(e,t,r,i){window.tp.push(["init",()=>{window.tp.offer.show({containerSelector:i,displayMode:r,offerId:e,showCloseButton:!1,templateId:t})}])}showCheckoutModal(e,t,r){this.subscribeButton=r,e&&t&&window.tp.push(["init",()=>{window.tp.offer.startCheckout({offerId:e,termId:t}),this.setFocusOnModalTabs()}])}setFocusOnModalTabs(){var e=document.querySelectorAll(W.MODAL);if(e)try{w.b.disableTabs(W.MAINSITE),w.b.updateTabs(e,0),e[0].focus()}catch(e){Object(y.b)("error",["cannot focus to modal",e])}}setFocusOnMainTabs(){w.b.enableTabs(W.MAINSITE);try{if(this.subscribeButton)this.subscribeButton.focus();else{var e=document.querySelector(W.MAIN);e.tabIndex=0,e.focus()}}catch(e){Object(y.b)("error",["cannot focus to modal",e])}}registerForOneDigital(e){var t=this;return V((function*(){var r={aid:e,term_id:t.registrantTermId,user_token:t.userToken};try{yield t.pianoCallApi(t.pianoEndpoints.register,r),window.tp.user.refreshAccessToken(!0)}catch(e){Object(y.b)("error",e)}}))()}pianoCallApi(e,t){return V((function*(){return window.tp=window.tp||[],Object(y.b)("debug","PianoCallApi: LoginRadius user detected"),yield new Promise(e=>{window.tp.push(["init",()=>{Object(y.b)("debug","PianoCallApi: Piano ready"),e()}])}),new Promise((r,i)=>{try{window.tp.api.callApi(e,t,e=>{200!==e.code&&0!==e.code?i(new Error("Piano API failure: ".concat(JSON.stringify(e)))):r(e)})}catch(e){i(e)}})}))()}addPianoHandlers(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];window.tp.push(["addHandler","showOffer",e=>{[".top-commenter-offer",".top-commenter-profile-offer"].includes(e.containerSelector)&&document.dispatchEvent(new CustomEvent("custom-event",{detail:{control_fields:{mparticle:{keys:{modal_name:"modal_name"},mp_event_type:"UserPreference"}},event_name:A.a.customEventNames.modalView,modal_name:"top_commenter_offer"}}))}]),window.tp.push(["addHandler","showTemplate",e=>{".vf-load-more.vf-label-text"===e.containerSelector&&document.dispatchEvent(new CustomEvent("custom-event",{detail:{control_fields:{mparticle:{keys:{modal_name:"modal_name"},mp_event_type:"UserPreference"}},event_name:A.a.customEventNames.modalView,modal_name:"comment_meter_blocker"}})),this.setFocusOnModalTabs()}]),window.tp.push(["addHandler","customEvent",e=>{switch(e.eventName){case"profile-offer-cta":case"in-comments-offer-cta":sessionStorage.removeItem("redirect_url"),this.sendOnPageActionClickEvent("claim_offer","top_commenter_offer",e.eventName);break;case"top-commenter-remind-me-later-cta":this.uid&&this.ignore_offer().then(e=>{if(e){var t=document.querySelector(".top-commenter-offer");t&&(t.innerHTML="",t.classList.add("hidden"),this.sendOnPageActionClickEvent("remind_me_later","top_commenter_offer","in-comments-offer-cta"));var r=document.querySelector(".top-commenter-reminder");r&&(r.classList.remove("hidden"),r.setAttribute("data-evt-skip-click","true"),r.click())}}).catch();break;case"top-commenter-close-remind-me-later-cta":var t=document.querySelector(".top-commenter-reminder");t&&(t.innerHTML="",t.classList.add("hidden"));break;case"register-cta":O.a.sendClickEvent("Create an Account","link","comment-blocker-cta","/register");break;case"login-cta":O.a.sendClickEvent("Sign in","link","comment-blocker-cta","/sign-in")}}]),window.tp.push(["addHandler","checkoutComplete",()=>{var e=(document.cookie.split(";").find(e=>e.trim().startsWith("".concat(_.a.SOPHI_AB_TEST_NAME,"=")))||"").trim().split("=").pop()||void 0,t=(document.cookie.split(";").find(e=>e.trim().startsWith("".concat(_.a.SOPHI_AB_TEST,"=")))||"").trim().split("=").pop()||void 0;document.dispatchEvent(new CustomEvent(w.a.CUSTOM_EVENT,{detail:{control_fields:{mparticle:{keys:{variant_name:"variant_name"},mp_event_type:"UserContent"},permutive:{}},event_name:A.a.customEventNames.subscription,variant_name:"".concat(e,":").concat(t)}})),localStorage.removeItem(_.a.ID)}]),window.tp.push(["addHandler","startCheckout",()=>{this.setFocusOnModalTabs()}]),window.tp.push(["addHandler","checkoutStateChange",e=>{"offer"!==e.stateName&&document.dispatchEvent(new CustomEvent(w.a.CUSTOM_EVENT,{detail:{control_fields:{mparticle:{keys:{modal_name:"modal_name"},mp_event_type:"UserPreference"},permutive:{keys:{modal_name:"modal_name"}}},event_name:A.a.customEventNames.modalView,modal_name:"state2"===e.stateName?"start_checkout":e.stateName}}))}]),window.tp.push(["addHandler","checkoutClose",e=>{switch(sessionStorage.removeItem(_.a.USER_WANTS),sessionStorage.removeItem(_.a.PIANO_PARAMS),e.state!==q.CHECKOUT_COMPLETED&&document.dispatchEvent(new CustomEvent(w.a.CUSTOM_EVENT,{detail:{checkout_state:e.state,control_fields:{mparticle:{keys:{checkout_state:"checkout_state"},mp_event_type:"UserContent"}},event_name:A.a.customEventNames.checkoutClosed}})),e.state){case q.CHECKOUT_COMPLETED:if(n){location.replace("/onboard-follow-author/");break}this.closeCheckoutModal();break;case q.ALREADY_HAS_ACCESS:case q.VOUCHER_REDEMPTION_COMPLETED:window.location.reload(),this.closeCheckoutModal();break;case q.CLOSE:this.closeCheckoutModal()}}]),window.tp.push(["addHandler","checkoutPaymentError",e=>{document.dispatchEvent(new CustomEvent(w.a.CUSTOM_EVENT,{detail:{control_fields:{mparticle:{keys:{error_message:"error_message",form_name:"form_name"},mp_event_type:"UserContent"}},error_message:"".concat(e.message),event_name:A.a.customEventNames.submissionError,form_name:"piano-checkout"}}))}]),window.tp.push(["addHandler","experienceExecute",e=>{var n,o=e.result.events.filter(e=>"meterExpired"===e.eventType);this.uid||(this.uid=e.user.uid);var a=o.length>0,s=(document.cookie.split(";").find(e=>e.trim().startsWith("".concat(_.a.SOPHI_AB_TEST_NAME,"=")))||"").trim().split("=").pop()||void 0,c=(document.cookie.split(";").find(e=>e.trim().startsWith("".concat(_.a.SOPHI_AB_TEST,"=")))||"").trim().split("=").pop()||void 0;if(c&&c!==U.a.VARIANT&&!r&&!i){var l="",d="",u="";if(window.sophi&&window.sophi.quickStart&&window.sophi.quickStart.decision){var m=window.sophi.quickStart.decision;l=m.trace,d=m.context,u=m.inputs}document.dispatchEvent(new CustomEvent(w.a.CUSTOM_EVENT,{detail:{context:d,control_fields:{mparticle:{keys:{context:"context",inputs:"inputs",meter_name:"meter_name",trace:"trace",variant_name:"variant_name"},mp_custom_flags:["Google.NonInteraction","Google.Page"],mp_event_type:"UserPreference"}},event_name:A.a.customEventNames.meterExecute,inputs:u,meter_name:"sophi_meter",trace:l,variant_name:"".concat(s,":").concat(c)}}))}var p=I.a.get(_.a.ID);if(t&&e.result.experiences.length>0){var f=e.result.events.filter(e=>"experienceExecute"===e.eventType);if(f&&f.length>0&&f[0].eventExecutionContext.splitTests.length>0&&(n=f[0].eventExecutionContext.splitTests[0].variantName),"metered"===window.tp.tags&&!p.adLight&&f&&f.length>0&&!a){var g=f[0].eventExecutionContext.currentMeterName||"undefined";Object(y.b)("debug","Current Meter Name ".concat(g)),document.dispatchEvent(new CustomEvent(w.a.CUSTOM_EVENT,{detail:{control_fields:{mparticle:{keys:{meter_name:"meter_name",variant_name:"variant_name"},mp_custom_flags:["Google.NonInteraction","Google.Page"],mp_event_type:"UserPreference"}},event_name:A.a.customEventNames.meterExecute,meter_name:"".concat(g),variant_name:n}}))}}if(o&&a){var h=o[0].eventParams,v=h.meterName,b="REGMETER"===v?"regwall_limit_reached":"paywall_limit_reached",E=c?"".concat(s,":").concat(c):n;if(window.demeter){var S="REGMETER"===v?U.c.REGWALL:U.c.PAYWALL;window.demeter("wall",{args:S}),Object(y.b)("info","Piano - Sophi ".concat(S," event dispatched"))}document.dispatchEvent(new CustomEvent(w.a.CUSTOM_EVENT,{detail:{control_fields:{mparticle:{keys:{meter_name:"meter_name",modal_name:"modal_name",variant_name:"variant_name"},mp_custom_flags:["Google.NonInteraction","Google.Page"],mp_event_type:"UserPreference"},permutive:{keys:{modal_name:"modal_name"}}},event_name:A.a.customEventNames.modalView,meter_name:c?"sophi_meter":v,modal_name:b,variant_name:E}})),this.handleMeterExpired(h)}e.result.events.filter(e=>e.eventModuleParams.moduleName===B.PREMIUM_SHOW_OFFER).length>0&&document.dispatchEvent(new CustomEvent(w.a.CUSTOM_EVENT,{detail:{control_fields:{mparticle:{keys:{modal_name:"modal_name"},mp_custom_flags:["Google.NonInteraction","Google.Page"],mp_event_type:"UserPreference"}},event_name:A.a.customEventNames.modalView,modal_name:"paywall_premium_content"}})),e.result.events.filter(e=>e.eventModuleParams.moduleName===B.REGISTRATION_ONLY_USER_SEGMENT).length>0&&document.dispatchEvent(new CustomEvent(w.a.CUSTOM_EVENT,{detail:{control_fields:{mparticle:{keys:{modal_name:"modal_name"},mp_custom_flags:["Google.NonInteraction","Google.Page"],mp_event_type:"UserPreference"}},event_name:A.a.customEventNames.modalView,modal_name:"registration_only"}})),this.handleExperienceExecute(e)}]),window.tp.push(["addHandler","meterActive",e=>{this.handleMeterActive(e)}]),"loginradius"===e&&window.tp.push(["addHandler","loginRequired",e=>{var t=location.origin,r=e&&e.startScreen?e.startScreen:"";sessionStorage&&(O.a.setRedirectUrl(location.href),e&&e.offerId&&e.termId&&(sessionStorage.setItem(_.a.PIANO_PARAMS,JSON.stringify(e)),sessionStorage.setItem(_.a.USER_WANTS,"subscribe"))),r===x.a.LOG_IN?location.assign("".concat(t,"/sign-in")):location.assign("".concat(t,"/register"))}])}pianoPushTags(e,t,r){var i=this;return V((function*(){var n=[];return e?n.push("premium_locked"):r?n.push("registration_locked"):t?n.push("not_metered"):n.push("metered"),yield i.pianoReady,new Promise((e,t)=>{try{window.tp.push(["setTags",n]),e()}catch(e){t(e)}})}))()}pianoPushLogoUrl(e){window.tp.push(["setCustomVariable","logoUrl",e.default]),Object(y.b)("debug","logoURL: "+e)}handleMeterActive(e){this.meterData={expired:!1,maxViews:e.maxViews,views:e.views},this.logMeterData(),document.dispatchEvent(new CustomEvent(w.a.PIANO_METER_EVENT,{detail:{meterData:this.meterData}}))}handleMeterExpired(e){this.meterData={expired:!0,maxViews:e.maxViews,views:e.views},this.logMeterData(),document.dispatchEvent(new CustomEvent(w.a.PIANO_METER_EVENT,{detail:{meterData:this.meterData}}))}handleExperienceExecute(e){this.pianoUser={email:e.user.email},this.logMeterData()}logMeterData(){if(this.pianoUser&&this.meterData&&Object(y.c)()){var e="n/a"!==this.pianoUser.email.toLowerCase(),t=e?"Paywall":"Registration",r=this.meterData.expired?"hard gate":"article counter",i=e?this.pianoUser.email:"not logged in",n="".concat(this.meterData.views," of ").concat(this.meterData.maxViews," free metered articles read"),o=e?"padding: 3px 10px 3px 10px; font-size:15px; background-color:green; color:white;":"padding: 3px 10px 3px 10px; font-size:15px; background-color:red; color:black;",a="".concat(t," ").concat(r," - ").concat(i," - ").concat(n);console.log("%c%s",o,a)}}ignore_offer(){var e=this;return V((function*(){return!!(yield fetch("/api-root/subscription/piano/ignore-top-commenter-offer/",{body:new URLSearchParams({aid:window.tp.aid,uid:e.uid}),headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST"})).ok}))()}sendOnPageActionClickEvent(e,t,r){document.dispatchEvent(new CustomEvent(w.a.CUSTOM_EVENT,{detail:{action_type:e,context:t,control_fields:{mparticle:{keys:{action_type:"action_type",context:"context",occurrence:"occurrence"},mp_event_type:"Other"}},event_name:A.a.customEventNames.onPageActionClick,occurrence:r}}))}}G(z,"DOM",{class:{pageRegistrationSuccess:"page-registration-success"}});var H,Y,K,J=r(44);function X(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function $(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){X(o,i,n,a,s,"next",e)}function s(e){X(o,i,n,a,s,"throw",e)}a(void 0)}))}}function Q(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}window.tp=window.tp||[];class Z extends z{constructor(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];super(),Q(this,"pianoConfig",{abTestEnabled:!1,callback:"pianoCallback",offset:0,provider:"loginradius"}),this.conf=e,this.logo=t,this.isPremium=r,this.isRegistration=i,this.isPaywallWhitelisted=n,this.pianoConfig.account=e.account,this.pianoConfig.abTestEnabled=o||!1,this.showOnboardPages=a}static SetExternalJWT(){var e=localStorage.getItem(_.a.JWT);window.tp=window.tp||[],window.tp.push(["init",()=>{window.tp.push(["setExternalJWT",e])}]),Object(y.b)("info","Set Piano external JWT: ",e)}getAccess(){var e=this;return $((function*(){if(localStorage){e.userToken=localStorage.getItem(_.a.JWT);var t={aid:e.pianoConfig.account,cross_app:!0,offset:e.pianoConfig.offset,user_provider:e.pianoConfig.provider,user_token:e.userToken},r=[];try{r=(yield e.pianoCallApi(e.pianoEndpoints.access,t)).data||[]}catch(e){Object(y.b)("error",e)}return r.map(e=>{var t={aid:e.resource.aid,id:e.resource.rid,start:e.start_date*l.b.secToMs};return e.expire_date&&(t.end=e.expire_date*l.b.secToMs),t})}}))()}getConversions(){var e=this;return $((function*(){e.userToken=localStorage.getItem(_.a.JWT);var t,r={aid:e.conf.account,offset:e.pianoConfig.offset,user_provider:e.pianoConfig.provider,user_token:e.userToken};try{t=yield e.pianoCallApi(e.pianoEndpoints.conversions,r)}catch(e){Object(y.b)("error",e)}return(t?t.conversions:[]).map(e=>e.term.term_id)}))()}addPrintSubscriptionTerm(e){var t=this;return $((function*(){var r=t.conf.useSandbox?"sandbox":"production",i=J[r].find(t=>t.rid===e.province),n=JSON.stringify({address1:e.streetAddress,address2:e.address2,city:e.city,country:i.countryCode,firstName:e.firstName,lastName:e.lastName,phone:e.phoneNumber,region:i.regionCode,zipCode:e.postalCode}),o={aid:t.conf.account,check_validity:!0,fields:n,term_id:t.conf.activateTermId};return new Promise(function(){var e=$((function*(e,r){try{e(yield t.pianoCallApi(t.pianoEndpoints.externalCreate,o))}catch(e){Object(y.b)("error","Unable to add PSC term: ",e),r(e)}}));return function(t,r){return e.apply(this,arguments)}}())}))()}pianoOnInit(e){this.addPianoHandlers("loginradius",this.pianoConfig.abTestEnabled,this.isPaywallWhitelisted,this.isPremium,this.showOnboardPages),e()}initialize(){var e=this;return $((function*(){e.pianoPreconfigured=!!window.tp,e.registrantTermId=e.conf.registrantTermId||"",e.userToken="",window.tp=window.tp||[],window.tp.push(["setUseTinypassAccounts",!1]),window.tp.push(["setUsePianoIdUserProvider",!1]),window.tp.push(["setUsePianoIdLiteUserProvider",!0]),e.pianoPushLogoUrl(e.logo),yield e.pianoPushTags(e.isPremium,e.isPaywallWhitelisted,e.isRegistration),localStorage&&localStorage.getItem(_.a.JWT)&&Z.SetExternalJWT(),e.pianoReady=new Promise(t=>window.tp.push(["init",()=>e.pianoOnInit(t)])),window.tp.push(["setAid",e.conf.account]),e.conf.useSandbox?e.pianoExpUrl=e.pianoSandboxUrl+e.conf.account:e.pianoExpUrl=e.pianoExpUrl+e.conf.account,w.b.loadScript(e.pianoExpUrl),yield w.b.ready,document.getElementById("my-subscriptions")&&window.tp.push(["init",()=>{window.tp.myaccount.show({containerSelector:"#my-subscriptions",displayMode:"inline"})}])}))()}}function ee(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function te(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){ee(o,i,n,a,s,"next",e)}function s(e){ee(o,i,n,a,s,"throw",e)}a(void 0)}))}}class re{static getIdentityInstance(e){return te((function*(){var t;if(e.identity)return"loginradius"===e.identity.sso.vendor&&(t=new N.b(e),yield t.init()),t}))()}static getSubscriberInstance(e){return te((function*(){if(e.identity&&e.identity.subscriber){var t,r=!1;if(e.page&&e.page.abTest&&e.page.abTest.hasOwnProperty("piano_experience")&&(r=e.page.abTest.piano_experience.enabled||!1),"loginradius"===e.identity.sso.vendor){e.identity.logo.default.length>0&&"/"===e.identity.logo.default[0]&&(e.identity.logo.default="".concat(window.location.origin).concat(e.identity.logo.default)),t=new Z(e.identity.subscriber,e.identity.logo,e.page.isPremium,e.page.isRegistration,e.page.isPaywallWhitelisted,r,e.identity.showOnboardPages);try{yield t.initialize()}catch(e){Object(y.b)("error","Failed to initialize subscriber service",e)}}return t}}))()}}class ie{constructor(e,t){this.el=e,this.adLight=t,this.el=e,!0===this.adLight?this.removeWidgetContainer():this.loadData()}removeWidgetContainer(){this.el.remove()}}class ne extends ie{loadData(){var e=this.el.getAttribute(ne.DOM.attrs.key),t=w.b.idElementExists(fe.DISTROSCALE),r="//c.jsrdn.com/s/cs.js?p=".concat(e);e&&!t&&w.b.loadScript(r,[{key:w.b.attrs.id,value:fe.DISTROSCALE}])}removeWidgetContainer(){w.b.nodes(document.querySelectorAll(".js-widget-".concat(fe.DISTROSCALE))).forEach(e=>e.remove())}}H=ne,K={attrs:{key:"data-distroscale-htmlid"}},(Y=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(Y="DOM"))in H?Object.defineProperty(H,Y,{value:K,enumerable:!0,configurable:!0,writable:!0}):H[Y]=K;class oe extends ie{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(e,t),this.el=e,this.adLight=t}loadData(){var e=this.el.getAttribute(oe.DOM.attrs.modId),t=this.el.getAttribute(oe.DOM.attrs.urlParam),r=this.getScriptSource(t,this.isFullPage());this.el.id="".concat(e),e&&w.b.loadScript(r)}removeWidgetContainer(){this.isFullPage()||w.b.nodes(document.querySelectorAll(".js-widget-".concat(fe.FLYERCITY))).forEach(e=>e.remove())}getScriptSource(e,t){var r="https://api.flyertown.ca/".concat(e,"/flyertown_module.js");return t&&(r="https://api.flyertown.ca/embed_iframe/v3/".concat(e,"/iframe.js")),r}isFullPage(){return"full"===this.el.getAttribute(oe.DOM.attrs.pageType)}}function ae(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e,t,r){(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(oe,"DOM",{attrs:{modId:"data-mod-id",pageType:"data-page-type",urlParam:"data-url-param"}});class se extends ie{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(e,t),ae(this,"ManifestUrl","https://financialpost.markitondemand.com/F2/Apps"),ae(this,"markitAppConfig",[{appId:"com_financialpost_trendingsymbol",manifestUrl:this.ManifestUrl,selector:"appTrendingSymbol"},{appId:"com_financialpost_marketstoday",manifestUrl:this.ManifestUrl,selector:"appMarketsToday"},{appId:"com_financialpost_equitiesoverview",manifestUrl:this.ManifestUrl,selector:"appEquitiesOverview"},{appId:"com_financialpost_commoditiesoverview",manifestUrl:this.ManifestUrl,selector:"appCommoditiesOverview"},{appId:"com_financialpost_currenciesoverview",manifestUrl:this.ManifestUrl,selector:"appCurrencyOverview"}]),this.el=e,this.adLight=t}static GetQueryVariable(e){var t=window.location.pathname.split("/"),r=t.indexOf(e);return t[r+1]}loadData(){w.b.loadScript("https://financialpost.markitondemand.com/Content/Dist/Scripts/common.min.js");var e=document.createElement("script");e.src="//cdnjs.cloudflare.com/ajax/libs/F2/1.4.5/f2.min.js",e.onload=this.render.bind(this),document.head.appendChild(e)}render(){var e=window.F2.AppHandlers.getToken(),t={exchange:se.GetQueryVariable("exchange"),symbol:se.GetQueryVariable("symbol")};window.F2.init(),window.F2.registerApps(this.getAppConfig(t)),window.F2.AppHandlers.on(e,"appRender",(e,t)=>{var r=document.querySelector("#"+e.selector);e.root=document.createElement("div"),e.root.setAttribute("id","root_"+e.instanceId),e.root.setAttribute("class","panel-body app-root app-wrapper MOD"+e.appId),e.root.innerHTML=t,r.appendChild(e.root)})}getAppConfig(e){return e.exchange&&e.symbol?[{appId:"com_financialpost_companysnapshot",context:{exchange:e.exchange,symbol:e.symbol,type:"stock"},manifestUrl:this.ManifestUrl,selector:"appCompanySnapshot"},{appId:"com_financialpost_performancechart",context:e,manifestUrl:this.ManifestUrl,selector:"appPerformanceChart"}]:this.markitAppConfig}}ae(se,"DOM",{attrs:{markets:"data-markets"}});class ce extends ie{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(e,t),this.el=e,this.adLight=t}loadData(){var e=this.el.getAttribute(ce.DOM.attrs.adSize),t=this.el.getAttribute(ce.DOM.attrs.partnerId);if(this.el.id="origami-ad-container",t){var r=[{key:"id",value:"origami-ad-widget"},{key:"data-partner-id",value:t}];e&&r.push({key:"data-ad-size",value:e}),w.b.loadScript("https://origami.secure.ownlocal.com/origami-widget.js",r)}}}!function(e,t,r){(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(ce,"DOM",{attrs:{adSize:"data-ad-size",partnerId:"data-partner-id"}});class le extends ie{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(e,t),this.el=e,this.adLight=t}loadData(){var e=this.el.getAttribute(le.DOM.attrs.adSize),t=this.el.getAttribute(le.DOM.attrs.partnerId),r="https://widget.secure.ownlocal.com/embed.js?uuid="+t+"?h="+e+"&min_featured_level=0&category=all&subcategory=all&days_ago=30";if(this.el.id="ownlocal",t){w.b.loadScript(r,[{key:"id",value:"ownlocal-script"},{key:"data-active",value:"businesses"}])}}removeWidgetContainer(){w.b.nodes(document.querySelectorAll(".js-widget-".concat(fe.OWNLOCAL))).forEach(e=>e.remove())}}!function(e,t,r){(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(le,"DOM",{attrs:{adSize:"data-ad-size",partnerId:"data-uuid"}});class de extends ie{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(e,t),this.el=e,this.adLight=t}loadData(){Object(y.b)("info","loaded subscription button widget")}}function ue(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function me(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){ue(o,i,n,a,s,"next",e)}function s(e){ue(o,i,n,a,s,"throw",e)}a(void 0)}))}}function pe(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var fe=function(e){return e.DISTROSCALE="distroscale",e.FLYERCITY="flyercity",e.OWNLOCAL="ownlocal",e.ORIGAMI="origami",e.MARKETS="markets",e.SUBSCRIBE="subscribe",e}({});class ge{constructor(){pe(this,"widgets",[])}static createWidgetInstance(e,t){switch(e.getAttribute(ge.DOM.attrs.widget)){case fe.DISTROSCALE:return new ne(e,t);case fe.FLYERCITY:return new oe(e,t);case fe.ORIGAMI:return new ce(e,t);case fe.OWNLOCAL:return new le(e,t);case fe.MARKETS:return new se(e);case fe.SUBSCRIBE:return new de(e,t)}}initialize(e){var t=this;return me((function*(){yield w.b.ready,t.observeWidgets(e),Object(y.b)("info","Widget service initialized, listening for all ads requested to start observing widgets")}))()}update(e){var t=this;return me((function*(){if(e)for(var r of t.widgets)r.removeWidgetContainer()}))()}observeWidgets(e){var t=new IntersectionObserver((t,r)=>{t.forEach(t=>{var i=void 0,n=t.target;return t.isIntersecting&&(Object(y.b)("info","Widget intersected, instancing new widget"),(i=ge.createWidgetInstance(n,e))&&this.widgets.push(i),r.unobserve(t.target)),i})},ge.IO_CONFIG);w.b.nodes(document.querySelectorAll("[".concat(ge.DOM.attrs.widget,"]"))).forEach(e=>{t.observe(e)}),Object(y.b)("info","Intersection Observer created, observing all widgets on page for intersection")}}function he(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function ve(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?he(Object(r),!0).forEach((function(t){we(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):he(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function be(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function ye(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){be(o,i,n,a,s,"next",e)}function s(e){be(o,i,n,a,s,"throw",e)}a(void 0)}))}}function we(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}pe(ge,"DOM",{attrs:{widget:"data-widget"}}),pe(ge,"IO_CONFIG",{rootMargin:"50%",threshold:0});class Ee{constructor(e,t,r,i,n,o,a,s){we(this,"widgetService",new ge),we(this,"hasSubscribersConf",!1),this.conf=e,this.adService=t,this.ageGateService=r,this.pageAgeGateService=i,this.consentBannerService=n,this.recommendationsService=o,this.analyticsService=a,this.identityService=s}init(){var e=this;return ye((function*(){if(Object(y.b)("debug","".concat(y.a.PAGE_LOAD," - Page object constructor")),Object(y.d)(y.a.PAGE_LOAD),e.reportWebVitals().catch(e=>console.log("error",e)),e.profile=e.identityService.getProfile()||new g.a,Object(y.b)("debug","previously stored profile: ",e.profile),e.conf.analytics&&e.analyticsService&&(e.analyticsConf={adSite:e.conf.ads.site,brand:e.conf.analytics.brand,debug:e.conf.analytics.debug,division:e.conf.analytics.division,domain:e.conf.analytics.domain,femVersion:e.conf.analytics.femVersion,isDev:e.conf.analytics.isDev,page:e.conf.page,platform:e.conf.analytics.platform,platformVersion:e.conf.analytics.platformVersion,profile:e.profile,provider:e.conf.analytics.provider,tags:e.conf.analytics.tags}),e.conf.analytics&&e.conf.analytics.tags&&(e.analyticsService.tagManager.initializePermutive(e.conf.analytics.tags,e.analyticsConf),e.analyticsService.tagManager.initializeLiveRamp(e.conf.analytics.tags)),e.analyticsConf=ve(ve({},e.analyticsConf),{},{profile:void 0}),new S(e.conf),e.conf.page&&e.conf.page.ageGate&&e.conf.page.ageGate.enabled?e.loadAds().then(()=>Object(y.b)("debug","Ads loaded")).catch(e=>{Object(y.b)("error","Error loading ads: ",e)}):(yield e.loadAds(),Object(y.b)("debug","Ads loaded")),document.addEventListener(f.a.IDENTITY_INIT,e.onIdentityInit.bind(e)),document.addEventListener(f.a.IDENTITY_READY,t=>{Object(y.b)("debug","Identity ready with event:",t),e.onIdentityChange(t)}),sessionStorage){var t=!1;"true"===sessionStorage.getItem(_.a.SOPHI_LOADED)&&(t=!0),!window.sophi||t?(t&&sessionStorage.removeItem(_.a.SOPHI_LOADED),yield e.loadIdentityService()):document.addEventListener(f.a.IDENTITY_SERVICE_INIT,ye((function*(){sessionStorage.removeItem(_.a.SOPHI_LOADED),yield e.loadIdentityService()})))}e.conf.identity?(e.conf.identity.subscriber&&(e.hasSubscribersConf=!0),document.addEventListener(f.a.EMAIL_VERIFIED,e.onEmailVerified.bind(e)),document.addEventListener(f.a.IDENTITY_SESSION_PROFILE_INIT,e.onIdentitySession.bind(e))):e.onIdentitySession(l.c.event(f.a.IDENTITY_SESSION_PROFILE_INIT,e.profile)),e.pageAgeGateService.addEventListener(p.b.VERIFIED,e.onAgeVerified.bind(e)),e.ageGateService.addEventListener(p.a.VERIFIED,e.onAgeVerified.bind(e)),e.consentBannerService.initialize();var r=sessionStorage&&sessionStorage.getItem(_.a.PIANO_PARAMS);return(/subscribe/.test(location.href)||e.conf.page.type===c.a.STORY)&&O.a.setRedirectUrl(location.href),r&&e.completeSignIn(e.profile)&&"register"!==e.conf.page.type&&"sign-in"!==e.conf.page.type&&window.tp.push(["init",()=>{window.tp.offer.startCheckout(JSON.parse(r))}]),e}))()}completeSignIn(e){return this.hasSubscribersConf?e.email&&e.subscriptions:e.email}loadIdentityService(){var e=this;return ye((function*(){Object(y.b)("debug","Identity service initializing"),yield e.identityService.initialize(e.conf,yield re.getIdentityInstance(e.conf),yield re.getSubscriberInstance(e.conf),new L),Object(y.b)("debug","Identity service initialized")}))()}onAgeVerified(){this.identityService.update({ageOfMajority:!0}).catch(console.log)}onEmailVerified(e){this.profile=e.detail,this.updateSubscriberDetails(),this.identityService.update(this.profile).catch(console.log)}onIdentityChange(e){Object(y.b)("debug","".concat(y.a.PAGE_LOAD," - onIdentityChange event handler")),Object(y.d)(y.a.PAGE_LOAD),this.profile=e.detail,this.updateSubscriberDetails(),this.analyticsConf&&this.analyticsConf.profile&&this.analyticsService.update(this.profile),document.dispatchEvent(new Event(f.a.IDENTITY_PROFILE_UPDATED)),this.adService.update(this.profile.adLight&&!this.profile.adLightDisabled).catch(console.log),this.widgetService.update(this.profile.adLight).catch(console.log)}loadAds(){var e=this;return ye((function*(){if(e.conf.ads&&e.adService)try{yield e.adService.initialize({adLight:e.profile.adLight&&!e.profile.adLightDisabled,analyticsConfig:e.conf.analytics,ancestry:e.conf.ads.ancestry,articleId:e.conf.page.articleId,bidding:e.conf.ads.bidding,hub:e.conf.ads.hub,negative:e.conf.page.klangoo?e.conf.page.klangoo.negativeKeywords:void 0,network:e.conf.ads.network,originId:e.conf.page.originId,page:e.conf.ads.type,pageConfig:e.conf.page,property:e.conf.ads.property,provider:e.conf.ads.provider,refresh:e.conf.ads.refresh,sensitive:e.conf.page.klangoo?e.conf.page.klangoo.sensitiveContent:void 0,siteId:e.conf.ads.site,spoke:e.conf.ads.spoke,stickyAd:e.conf.ads.stickyAd,topics:e.conf.ads.topics,verifier:e.conf.ads.verifier,wpLegacyId:e.conf.page.wpLegacyId,writers:e.conf.page.writers})}catch(e){Object(y.b)("error","adService.initialize failed",e)}}))()}onIdentityInit(e){this.profile=e.detail,this.updateSubscriberDetails(),this.identityService.update(this.profile).catch(console.log),this.ageGateService.initialize(this.profile.ageOfMajority),this.pageAgeGateService.initialize(this.conf.page.ageGate,this.profile.ageOfMajority),this.analyticsConf&&this.completeSignIn(this.profile)?(this.analyticsConf=ve(ve({},this.analyticsConf),{},{profile:this.profile}),this.analyticsService.initialize(this.analyticsConf).catch(console.log)):this.onIdentitySession(l.c.event(f.a.IDENTITY_SESSION_PROFILE_INIT,this.profile)),this.widgetService.initialize(this.profile.adLight).catch(console.log),this.recommendationsService.initialize(this.conf.page.articleId,this.conf.page.isRecommendationEnabled,this.conf.page.isWelcomeToMyTopicsModalEnabled,this.profile.recommendationCategories)}onIdentitySession(e){this.profile=e.detail,!this.analyticsConf||this.analyticsConf.profile||this.profile.email||(this.analyticsConf=ve(ve({},this.analyticsConf),{},{profile:this.profile}),this.analyticsService.initialize(this.analyticsConf).catch(console.log))}updateSubscriberDetails(){this.profile.adLight=(this.profile.subscriptions||[]).reduce((e,t)=>e||(this.conf.identity.subscriber.resIds||[]).indexOf(t.id)>=0,!1)}reportWebVitals(){return ye((function*(){if(new URLSearchParams(window.location.search).has("core-web-vitals-measuring")){yield import("https://unpkg.com/web-vitals@3.1.1/dist/web-vitals.attribution.js?module").then(e=>{e.onCLS(console.log,{reportAllChanges:!0}),e.onFCP(console.log,{reportAllChanges:!0}),e.onLCP(console.log,{reportAllChanges:!0}),e.onTTFB(console.log,{reportAllChanges:!0}),e.onFID(console.log,{reportAllChanges:!0}),e.onINP(console.log,{reportAllChanges:!0})})}}))()}}var Se=r(6),Oe=function(e){return e.AMAZON="amazon",e.DISTRICT_M="districtm",e.INDEX_EXCHANGE="ix",e.MAGNITE="magnite",e}({}),_e={adsHidden:!1,googletagMissing:!1,pianoDetection:!1,detectHiddenAds(){var e=document.getElementById("ad-1");if(!e)return!1;var t=window.getComputedStyle(e);return 0===e.offsetHeight||"none"===t.display||"hidden"===t.visibility},detectGoogletagMissing:()=>void 0===window.googletag||void 0===window.googletag._loadStarted_,detectWithPiano:()=>"true"===(document.cookie.split(";").find(e=>e.trim().startsWith("__adblocker="))||"").trim().split("=").pop(),detectAdBlock:()=>(_e.adsHidden=_e.detectHiddenAds(),_e.googletagMissing=_e.detectGoogletagMissing(),_e.pianoDetection=_e.detectWithPiano(),_e.adsHidden||_e.googletagMissing||_e.pianoDetection),fixAdSpacing(){var e=document.getElementsByClassName("ad__section-border--category");for(var t of Array.from(e)){var r=document.createElement("div");r.style.height="20px",r.className="buffer",t.nextSibling?t.parentNode.insertBefore(r,t.nextSibling):t.parentNode.appendChild(r)}}},Ie=r(31);function Ae(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Te{static applySettings(e){e&&(e.enabled&&(window.innerWidth<w.b.mobileCutoff&&!1!==e.enabledMobile||window.innerWidth>=w.b.mobileCutoff&&!1!==e.enabledDesktop)&&(this.active=!0),e.extraHeight>0&&(this.extraHeight=e.extraHeight),e.disabledPlacements&&(this.disabledPlacements=e.disabledPlacements.map(e=>"ad-".concat(e))),e.headerUpdateInterval&&(this.headerUpdateInterval=e.headerUpdateInterval))}static enableScrollingFollow(e){var t=e.id;if(!(this.disabledPlacements.includes(t)||t in this.updateFunctions||Ie.a.activeTop&&t===Se.a.DOM.ids.loc1)){var r=e.getMaxHeight(),i=document.getElementById(t),n=i.parentElement;i.removeAttribute("style");var o=r;t!==Se.a.DOM.ids.loc1&&(o+=this.extraHeight),n.style.height="".concat(o,"px"),Te.updateFunctions[t]=Te.getUpdateFunction(t),window.addEventListener("scroll",Te.updateFunctions[t])}}static updateAllAds(){for(var e of Object.values(this.updateFunctions))e()}static setAdHeight(e,t,r){var i=t.getBoundingClientRect();if(e.style.height="",i.bottom-r<e.offsetHeight)e.style.position="absolute",e.style.top="",e.style.bottom="0px",e.style.left="",e.style.width="";else if(i.top<r){var n=e.querySelector("iframe").getBoundingClientRect().left;e.style.left||(e.style.left="".concat(n,"px"),e.style.width="unset"),e.style.position="fixed",e.style.top="".concat(r,"px"),e.style.bottom=""}else e.style.position="absolute",e.style.top="0px",e.style.bottom="",e.style.left="",e.style.width=""}static detectHeaderChanged(){var e=document.getElementsByTagName("html")[0].classList.contains(Se.a.DOM.classes.headerShrink);return Te.headerShrinkState!==e&&(Te.headerShrinkState=e,!0)}static getHeaderHeight(){var e;if(Ie.a.isActiveTop())e=document.querySelector(".".concat(Se.a.DOM.classes.stickyAd)).getBoundingClientRect().bottom;else{var t=document.querySelector(".".concat(Se.a.DOM.classes.subscribe)),r=document.getElementById(Se.a.DOM.ids.header);e=t?Math.max(t.getBoundingClientRect().bottom,r.getBoundingClientRect().bottom):r.getBoundingClientRect().bottom}return e}static getUpdateFunction(e){return()=>{var t=document.getElementById(e);if(t){var r=t.parentElement;if(r){var i=this.getHeaderHeight(),n=r.getBoundingClientRect();window.innerWidth<w.b.mobileCutoff&&n.bottom-i>-this.heightOffset&&n.top-this.heightOffset<i&&this.detectHeaderChanged()&&this.setAdHeightDelayed(e),this.setAdHeight(t,r,i)}}}}static setAdHeightDelayed(e){var t=document.getElementById(e),r=t.parentElement;for(var i of this.curTimeouts)clearTimeout(i);this.curTimeouts=[];for(var n=this.headerMoveDuration/this.headerUpdateInterval,o=1;o<=n;o++){var a=setTimeout(()=>{Te.setAdHeight(t,r,this.getHeaderHeight())},o*this.headerUpdateInterval);this.curTimeouts.push(a)}}}Ae(Te,"active",!1),Ae(Te,"headerMoveDuration",800),Ae(Te,"updateFunctions",{}),Ae(Te,"curTimeouts",[]),Ae(Te,"headerShrinkState",!1),Ae(Te,"extraHeight",0),Ae(Te,"disabledPlacements",[]),Ae(Te,"headerUpdateInterval",10),Ae(Te,"heightOffset",100);var Pe={airdrieecho:"ade",bizmagazine:"",brantfordexpositor:"brx",businesslondon:"",calgaryherald:"ch",calgarysun:"csun",canada:"ccn",canoe:"canoe",carmanvalleyleader:"tvl",chathamdailynews:"cdn",chathamthisweek:"ctw",classifieds:"gc",clintonnewsrecord:"cnr",cochranetimes:"cct",cochranetimespost:"cbe",coldlakesun:"clk",communitypress:"cpa",countymarket:"ecm",countyweeklynews:"cwn",dailyheraldtribune:"dht",delhinewsrecord:"dnr",devondispatch:"dvd",draytonvalleywesternreview:"dvw",driving:"dr",edmontonexaminer:"edx",edmontonjournal:"elj",edmontonsun:"esun",edsonleader:"edl",elliotlakestandard:"els",faceoff:"",fairviewpost:"fvp",financialpost:"fp",foodandwineexpo:"",fortmcmurraytoday:"fmt",fortsaskatchewanrecord:"fsr",gananoquereporter:"gqr",goderichsignalstar:"gss",greybrucethisweek:"gbw",hamiltonhaltonweddings:"",hamiltonmagazine:"",hannaherald:"hnh",healthing:"healthing",highrivertimes:"hrt",hintonparklander:"htp",homesanddesign:"",ingersolltimes:"igt",intelligencer:"bvi",interlakespectator:"tis",interlaketoday:"ils",intervin:"",kenoradailyminerandnews:"kdm",kincardinenews:"kcn",kingstonlife:"",kingstonthisweek:"ktw",lacombeglobe:"lmg",lakeshoreadvance:"lsa",leaderpost:"rlp",leducrep:"ldr",lfpress:"lfp",lucknowsentinel:"lus",mayerthorpefreelancer:"myf",melfortjournal:"mfj",midnorthmonitor:"emm",mitchelladvocate:"mta",moderntimes:"mts",montrealgazette:"mg",nantonnews:"nan",napaneeguide:"nap",nationalpost:"np",niagarafoodandwineexpo:"",nipawinjournal:"npj",northernnews:"kln",nugget:"nbn",ontariofarmer:"onf",ottawacitizen:"oc",ottawasun:"osun",owensoundsuntimes:"ows",parisstaronline:"prs",peacecountrysun:"pcs",pembinatoday:"pty",pinchercreekecho:"pce",portagedailygraphic:"ppg",prrecordgazette:"rcg",recorder:"bkr",redrivervalleyecho:"rre",saltwire:"swn",sarniathisweek:"slw",saultstar:"ssw",saultthisweek:"ssm",seaforthhuronexpositor:"shx",selkirkjournal:"tsl",sherwoodparknews:"swp",shorelinebeacon:"slb",simcoelife:"",simcoereformer:"srf",sprucegroveexaminer:"sgx",stonewallargusteulontimes:"sat",stonyplainreporter:"syp",stratfordbeaconherald:"sbh",strathroyagedispatch:"sad",stthomastimesjournal:"stj",swervecalgary:"",thebeaumontnews:"bmn",thecragandcanyon:"bvc",thedailyobserver:"pem",thegrowthop:"thegrowthop",thehomeshow:"",thelondoner:"tlo",theobserver:"sob",theprovince:"vp",thestarphoenix:"ssp",thesudburystar:"sus",thewhig:"kin",tillsonburgnews:"tbn",timminspress:"tdp",timminstimes:"tmt",tj:"tj",todaysfarmer:"los",torontosun:"tsun",trentonian:"ttt",vancouversun:"vs",vermilionstandard:"vms",vinesmag:"",vulcanadvocate:"vla",wallaceburgcourierpress:"wcn",wetaskiwintimes:"wtt",whitecourtstar:"wcs",wiartonecho:"wie",windsorstar:"wsr",winklertimes:"twt",winnipegsun:"wsun",woodstocksentinelreview:"wsr",working:"wk"},Ce=[{path:"legacy/celebration",shortcode:"cel"},{path:"legacy/obituaries",shortcode:"rem"},{path:"standard-freeholder",shortcode:"csf"},{path:"thechronicle-online",shortcode:"wlc"},{path:"thepost.on",shortcode:"hnp"}];class Re{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_kvs";this.lookup=e,this.kvKey=t}byHost(e,t){var r=e.replace("www.","").split(".").reverse().reduce((e,t)=>e&&e[t]||void 0,this.lookup);if(t)try{return r[this.kvKey][t]}catch(e){return}return r}byShortcode(e){var t=Object.keys(Pe),r=e.replace("www.","").replace(/^https?:\/\//,"").split(".").shift();for(var i of Ce)if(e.includes(i.path))return i.shortcode;for(var n of t)if(e.includes(n))return this.getIndexValue(Pe,n);return this.getIndexValue(Pe,r)}getIndexValue(e,t){return e[t]}}class ke{constructor(e,t){this.key=e,this.value=t}}function De(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var je=function(e){return e.ARTICLE="aid",e.ARTICLE_SOURCE="asrc",e.AUTHOR="author",e.CHANNEL="ck",e.COMMUNITY="comm",e.ENTITY="et",e.IMPRESSION="imp",e.LOCATION="loc",e.PAGE="page",e.PARTNER="prtn",e.OPT_OUT_POL="no_pol",e.PROPERTY="pr",e.REFERRER="r",e.REFRESH="rc",e.SENSITIVE="sensitive",e.SENSITIVE_BRAND="scb",e.SENSITIVE_TOPIC="sct",e.NEGATIVE="negative",e.NEGATIVE_BRAND="nkb",e.SHIELD="shield",e.SUBCHANNEL="sck",e.TAG="tag",e.TEST="test",e.TOPICS="topics",e.HUB="hub",e.SPOKE="spk",e.TYPE="type",e.AD_TEST="adtest",e.BODY_TYPE="bt",e.VEHICLE_TYPE="vt",e.SPECIAL_SECTION="sect",e.MODEL_YEAR="year",e.CAR_MAKE="make",e.CAR_MODEL="model",e.LANGUAGE="lang",e}({});class Me{constructor(e){De(this,"default",{loc:"top"}),De(this,"pageTargets",[]),this.lookup=new Re(e)}ad(e,t){var r=[];return e&&e[je.LOCATION]||r.push(new ke(je.LOCATION,t||this.default.loc)),Object.entries(e||{}).forEach(e=>r.push(new ke(e[0],e[1]))),r}page(e){this.pageTargets=[],this.firstConfig||(this.firstConfig=e);var t=e.articleId||this.firstConfig.articleId;return this.targetArticle(t,e.originId||this.firstConfig.originId,e.wpLegacyId||this.firstConfig.wpLegacyId),this.targetWriters(e.writers||this.firstConfig.writers),this.targetOptOut(e.optOutPoliticalAds||this.firstConfig.optOutPoliticalAds),this.targetPageType(e.type||this.firstConfig.type),this.targetProperty(e.property||this.firstConfig.property),this.targetSensitive(e.sensitive||this.firstConfig.sensitive),this.targetTopics(e.topics||this.firstConfig.topics),this.targetHub(e.hub||this.firstConfig.hub),this.targetSpoke(e.spoke||this.firstConfig.spoke),this.targetNegative(e.negative||this.firstConfig.negative),this.targetBodyType(e.bodyType||this.firstConfig.bodyType),this.targetVehicleType(e.vehicleType||this.firstConfig.vehicleType),this.targetSpecialSection(e.specialSection||this.firstConfig.specialSection),this.targetModelYears(e.modelYears||this.firstConfig.modelYears),this.targetCarMake(e.carMake||this.firstConfig.carMake),this.targetCarModel(e.carModel||this.firstConfig.carModel),this.targetLang(e.lang||this.firstConfig.lang),this.targetArticleSource(t),this.targetCommunity(),this.targetEntity(),this.targetPartner(),this.targetReferrer(),this.targetShield(),this.targetWithAncestry(e.ancestry||this.firstConfig.ancestry,e.type||this.firstConfig.type),this.targetAdTest(),this.pageTargets}resetPageTargets(){this.pageTargets=[],delete this.firstConfig}targetArticle(e,t,r){if(e){var i=[e,t];r&&i.push(r),this.pageTargets.push(new ke(je.ARTICLE,i))}}targetArticleSource(e){var t=document.querySelector("link[rel='canonical']")?w.b.getRelUrl("canonical"):"",r=this.lookup.byShortcode(t);""!==t&&r&&e&&this.pageTargets.push(new ke(je.ARTICLE_SOURCE,r))}targetWriters(e){e&&e.main&&e.main.length&&this.pageTargets.push(new ke(je.AUTHOR,e.main.map(e=>"object"==typeof e?e.name:e)))}targetCommunity(){var e=this.lookup.byHost(location.host,je.COMMUNITY);e&&this.pageTargets.push(new ke(je.COMMUNITY,e))}targetEntity(){var e=this.lookup.byHost(location.host,je.ENTITY);e&&this.pageTargets.push(new ke(je.ENTITY,e))}targetPageType(e){this.pageTargets.push(new ke(je.PAGE,e===c.a.STORY?c.a.STORY:c.a.INDEX))}targetBodyType(e){e&&this.pageTargets.push(new ke(je.BODY_TYPE,e.join(",")))}targetVehicleType(e){e&&this.pageTargets.push(new ke(je.VEHICLE_TYPE,e.join(",")))}targetSpecialSection(e){e&&this.pageTargets.push(new ke(je.SPECIAL_SECTION,e.map(e=>e.join(","))))}targetModelYears(e){e&&this.pageTargets.push(new ke(je.MODEL_YEAR,e.join(",")))}targetCarMake(e){e&&this.pageTargets.push(new ke(je.CAR_MAKE,e))}targetCarModel(e){e&&this.pageTargets.push(new ke(je.CAR_MODEL,e))}targetLang(e){e&&this.pageTargets.push(new ke(je.LANGUAGE,e))}targetProperty(e){e&&this.pageTargets.push(new ke(je.PROPERTY,e))}targetPartner(){var e=this.lookup.byHost(location.host,je.PARTNER);e&&this.pageTargets.push(new ke(je.PARTNER,e))}targetReferrer(){if(document.referrer){var e=document.referrer.replace(/^.*\/\/([^\/]+).*$/,"$1");this.pageTargets.push(new ke(je.REFERRER,e))}}targetRefresh(e){var t=void 0===e?0:e;this.pageTargets.push(new ke(je.REFRESH,String(t)))}targetSensitive(e){this.pageTargets.push(new ke(je.SENSITIVE,e?"y":"n")),e&&(e.brands&&e.brands.length&&this.pageTargets.push(new ke(je.SENSITIVE_BRAND,e.brands.map(e=>{var{token:t}=e;return t.toLowerCase()}))),e.categories&&e.categories.length&&this.pageTargets.push(new ke(je.SENSITIVE_TOPIC,e.categories.map(e=>{var{name:t}=e;return t.toLowerCase()}))))}targetNegative(e){if(this.pageTargets.push(new ke(je.NEGATIVE,e&&e.length>0?"y":"n")),e){var t=e.map(e=>e.brand&&e.brand.length?e.brand:"");t&&t.length&&this.pageTargets.push(new ke(je.NEGATIVE_BRAND,t))}}targetTopics(e){e&&this.pageTargets.push(new ke(je.TOPICS,e))}targetHub(e){e&&this.pageTargets.push(new ke(je.HUB,e))}targetSpoke(e){e&&this.pageTargets.push(new ke(je.SPOKE,e))}targetShield(){window.I10C&&window.I10C.Morph&&this.pageTargets.push(new ke(je.SHIELD,"1"))}targetWithAncestry(e,t){if(e&&e.length){var r=e.filter(e=>"!"!==e[0]);this.pageTargets.push(new ke(je.CHANNEL,r[0])),r.length>1&&this.pageTargets.push(new ke(je.SUBCHANNEL,r.slice(1))),t!==c.a.STORY&&this.pageTargets.push(new ke(je.IMPRESSION,[...r].pop()))}else t===c.a.INDEX&&(this.pageTargets.push(new ke(je.CHANNEL,c.a.INDEX)),this.pageTargets.push(new ke(je.IMPRESSION,c.a.INDEX)))}targetOptOut(e){e&&this.pageTargets.push(new ke(je.OPT_OUT_POL,"true"))}targetAdTest(){var e=l.c.params();if("adtest"in e){var{adtest:t}=e;this.pageTargets.push(new ke(je.AD_TEST,t))}}}function Le(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ne{constructor(){Le(this,"waitForBidder",!1)}shouldWaitForBidder(){return this.waitForBidder}}function xe(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function Ue(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Fe=class extends Ne{constructor(){super(),Ue(this,"waitForBidder",!0),Ue(this,"defaultAdServer","googletag"),Ue(this,"defaultTimeoutMs","2e3"),Ue(this,"oopSizes",[[1,1]]),this.URLPath="//c.amazon-adsystem.com/aax2/apstag.js"}initializeBidding(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultAdServer,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.defaultTimeoutMs,i=e.find(e=>e.client===Oe.AMAZON);i&&(this.amazonEnabled=!0,window.apstag=window.apstag||{_Q:[],fetchBids:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return window.apstag._Q.push(["f",t])},init:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return window.apstag._Q.push(["i",t])},setDisplayBids:()=>{}},window.apstag.init({adServer:t,bidTimeout:r,deals:!0,pubID:i.account}),w.b.loadScript(this.URLPath),Object(y.b)("debug","Initialize Amazon bidder: ".concat(this.URLPath)))}requestAdsPromise(e){var t,r=this;return(t=function*(){return new Promise((t,i)=>{if(Object(y.b)("info","AMZ amazonEnabled = ".concat(r.amazonEnabled)),r.amazonEnabled){var n=(e||[]).filter(e=>!!e).map(e=>({sizes:e.isOutOfPage()?r.oopSizes:e.sizes,slotID:e.id}));n.length&&(window.apstag.fetchBids({slots:n},()=>window.googletag.cmd.push(()=>{window.apstag.setDisplayBids(),Object(y.b)("info","Amazon bidder has resolved")})),t())}})},function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function a(e){xe(o,i,n,a,s,"next",e)}function s(e){xe(o,i,n,a,s,"throw",e)}a(void 0)}))})()}};function Ve(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ge=class extends Ne{constructor(){super(),Ve(this,"waitForBidder",!1),Ve(this,"bidderType","districtm"),this.URLPath="//hb.districtm.io/prod/100549/all.postmedia.js"}initializeBidding(e){e.find(e=>e.client===Oe.DISTRICT_M)&&(w.b.loadScript(this.URLPath),Object(y.b)("debug","Initialize DistrictM bidder: ".concat(this.URLPath)))}};function qe(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Be=class extends Ne{constructor(){super(),qe(this,"waitForBidder",!1),this.URLPath="//js-sec.indexww.com/ht/p/"}initializeBidding(e){var t=e.find(e=>e.client===Oe.INDEX_EXCHANGE);t&&(w.b.loadScript("".concat(this.URLPath).concat(t.account,".js")),Object(y.b)("debug","Initialize IndexExchange bidder: ".concat(this.URLPath)))}};function We(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function ze(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class He extends Ne{constructor(){super(),ze(this,"waitForBidder",!0),ze(this,"failSafeTimeout",3500),this.URLPath="//micro.rubiconproject.com/prebid/dynamic/14648.js"}static OnMagniteError(){Object(y.b)("error","Magnite: failed to load script"),window.pbjs.error=!0,document.dispatchEvent(new Event(l.a.MAGNITE_ERROR))}initializeBidding(e){e.find(e=>e.client===Oe.MAGNITE)&&(window.pbjs=window.pbjs||{},window.pbjs.que=window.pbjs.que||[],w.b.loadScript(this.URLPath,void 0,He.OnMagniteError),Object(y.b)("debug","Initialize Magnite bidder: ".concat(this.URLPath)))}requestAdsPromise(e,t){var r,i=this;return(r=function*(){return Object(y.b)("info","optional ads passed to requestAdsPromise",e),new Promise((r,n)=>{window.pbjs.error&&r(),document.addEventListener(l.a.MAGNITE_ERROR,()=>{r()}),window.pbjs.que.push(()=>{var n=e.map(e=>e.id),o=t||e.map(e=>e.slot);window.pbjs.rp.requestBids({adUnitCodes:n,callback:()=>{Object(y.b)("info","Magnite bidder has resolved"),r()},gptSlotObjects:o}),window.setTimeout(r,i.failSafeTimeout),document.removeEventListener(l.a.MAGNITE_ERROR,()=>{r()})})})},function(){var e=this,t=arguments;return new Promise((function(i,n){var o=r.apply(e,t);function a(e){We(o,i,n,a,s,"next",e)}function s(e){We(o,i,n,a,s,"throw",e)}a(void 0)}))})()}}var Ye=He;function Ke(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function Je(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){Ke(o,i,n,a,s,"next",e)}function s(e){Ke(o,i,n,a,s,"throw",e)}a(void 0)}))}}var Xe=class{constructor(){this.bidders=[]}registerBidder(e){e.shouldWaitForBidder()&&(Object(y.b)("debug","Registering parallel bidder",e),-1===this.bidders.indexOf(e)&&this.bidders.push(e))}sendBidderRequests(e,t){var r=this;return Je((function*(){yield Promise.all(r.bidders.map(function(){var r=Je((function*(r){return r.requestAdsPromise(e,t)}));return function(e){return r.apply(this,arguments)}}())),Object(y.b)("info","Parallel bidder promises are finished and ready to request ads: ",e)}))()}};function $e(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function Qe(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){$e(o,i,n,a,s,"next",e)}function s(e){$e(o,i,n,a,s,"throw",e)}a(void 0)}))}}function Ze(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class et{constructor(e,t){Ze(this,"initialRefreshAllDone",!1),Ze(this,"ads",[]),Ze(this,"jsSrc","https://securepubads.g.doubleclick.net/tag/js/gpt.js"),Ze(this,"defaultAdRefreshConf",{max:5,s:30}),Ze(this,"defaultLazyLoadConf",{fetchMarginPercent:50,mobileScaling:2,renderMarginPercent:25}),this.conf=e,this.refreshConf=this.getRefreshAdConfFromOrDefault(this.conf),this.lazyLoadConf=this.getLazyLoadAdConfFromOrDefault(this.conf),w.b.loadScript(this.jsSrc,void 0,et.onGPTError,()=>{_e.detectAdBlock()&&_e.adsHidden&&"story"!==this.conf.ads.type&&_e.fixAdSpacing()}),this.conf.page.abTest&&Te.applySettings(this.conf.page.abTest.scrollingFollow),window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],t&&window.googletag.cmd.push(()=>{window.googletag.pubads().addEventListener("impressionViewable",this.impressionViewable.bind(this)),window.googletag.pubads().addEventListener("slotOnload",this.slotOnLoad.bind(this)),window.googletag.pubads().addEventListener("slotRenderEnded",this.slotRenderEnded.bind(this)),window.googletag.pubads().addEventListener("slotRequested",this.slotRequested.bind(this)),window.googletag.pubads().addEventListener("slotResponseReceived",this.slotResponseReceived.bind(this)),window.googletag.pubads().addEventListener("slotVisibilityChanged",this.slotVisibilityChanged.bind(this)),window.googletag.pubads().setCentering(!0),window.googletag.pubads().enableLazyLoad(this.lazyLoadConf),window.googletag.pubads().enableSingleRequest(),window.googletag.pubads().disableInitialLoad(),window.googletag.enableServices()})}static getInstance(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return et.instance||(et.instance=new et(e,t)),et.instance}static deleteInstance(){et.instance=void 0}static onGPTError(){Object(y.b)("error","GPT loading error"),_e.detectAdBlock()&&_e.adsHidden&&"story"!==et.getInstance().conf.ads.type&&_e.fixAdSpacing(),window.googletag.error=!0,document.dispatchEvent(new Event(l.a.GPT_ERROR))}destroy(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.ads;window.googletag.cmd.push(()=>{window.googletag.destroySlots(e.filter(e=>e.slot).map(e=>e.slot))}),e.forEach(e=>{e.destroy(),this.ads=this.ads.filter(t=>t.id!==e.id)})}registerAd(e){var t=this;return Qe((function*(){var r=e.id;return new Promise(i=>{window.googletag.error&&i(),document.addEventListener(l.a.GPT_ERROR,()=>{i()}),window.googletag.cmd.push(()=>{if(t.ads.find(e=>e.id===r)||i(),e.isOutOfPage())Object(y.b)("debug","".concat(e.id),"window.googletag.defineOutOfPageSlot(this.adURI, ad.id) with ".concat(t.adURI,", ").concat(e.id)),e.slot=window.googletag.defineOutOfPageSlot(t.adURI,e.id);else{Object(y.b)("debug","".concat(e.id," window.googletag.defineSlot("),"this.filterAdUriOnCustomParam(ad), ad.validSizes(), ad.id) ","with ".concat(t.filterAdUriOnCustomParam(e),", ").concat(e.validSizes(),", ").concat(e.id));var n=e.validSizesWithFluid();if(e.slot=window.googletag.defineSlot(t.filterAdUriOnCustomParam(e),n,e.id),e.id.includes("native")&&n.includes("fluid")){e.slot.setTargeting("slot","infeed");var o=e.el.getAttribute(P.b.attr.nativePosition.key);o&&e.slot.setTargeting("pos",o)}}Object(y.b)("debug","ad.slot.addService(window.googletag.pubads())"),e.slot&&(e.slot.addService(window.googletag.pubads()),e.targets&&[...e.targets].forEach(t=>{Object(y.b)("debug","".concat(e.id," ad.slot.setTargeting(target.key, target.value) with"),"".concat(t.key,", ").concat(t.value)),e.slot.setTargeting(t.key,t.value)}),e.el.getAttribute(P.c.attr.state.key)!==P.c.attr.state.value.off&&(Object(y.b)("debug","".concat(e.id," ad.slot.setTargeting(REFRESH_KEY, REFRESH_VALUE) with"),"".concat("refresh",", ").concat("true")),e.slot.setTargeting("refresh","true"),Object(y.b)("debug","".concat(e.id," ad.slot.setTargeting(AdTargetKeys.REFRESH, String(0)) with"),"".concat(je.REFRESH,", ").concat(String(0))),e.slot.setTargeting(je.REFRESH,String(0)))),document.removeEventListener(l.a.GPT_ERROR,()=>{i()}),i()})})}))()}filterAdUriOnCustomParam(e){var t=this.adURI;return e.targets.forEach(e=>{"viafoura"===e.value[0]&&(t=this.adURI.replace(this.adURI.split("/")[2],"arn-viafoura"))}),t}registerVendors(){this.parallel=new Xe,this.conf.ads.bidding.forEach(e=>{switch(e.client){case Oe.AMAZON:this.amazon=new Fe,this.amazon.initializeBidding(this.conf.ads.bidding);break;case Oe.DISTRICT_M:this.districtm=new Ge,this.districtm.initializeBidding(this.conf.ads.bidding);break;case Oe.INDEX_EXCHANGE:this.ix=new Be,this.ix.initializeBidding(this.conf.ads.bidding);break;case Oe.MAGNITE:this.magnite=new Ye,this.magnite.initializeBidding(this.conf.ads.bidding);break;default:Object(y.b)("info","Unknown bidder configured: ".concat(e.client," - Ignoring."))}})}registerBidders(e){var t=this;return Qe((function*(){Object(y.b)("debug","registering bidders: ",t.conf.ads.bidding.map(e=>e.client)),t.conf.ads.bidding.forEach(e=>{t.parallel.registerBidder(t[e.client])}),Object(y.b)("debug","registered bidders, sending requests"),yield t.parallel.sendBidderRequests(e),t.requestAds(e)}))()}initRequestAds(e){var t=this;return Qe((function*(){for(var r of(Object(y.b)("debug","registering ads",e),e))yield t.registerAd(r);Object(y.b)("debug","ads registered, registering bidders"),e.length?(yield t.registerBidders(e),Object(y.b)("debug","bidders registered for the following ads: ",e),t.registerMagniteInArticle()):Object(y.b)("debug","exiting requestAds:GPT, ads array is empty: ",e)}))()}requestAds(e){window.googletag.cmd.push(()=>{var t=e||this.ads;if(t.length)if(Object(y.b)("info","isInitialLoadDisabled()=".concat(window.googletag.pubads().isInitialLoadDisabled())),window.googletag.pubads().isInitialLoadDisabled()){var r=localStorage.getItem(_.a.PPID);r?(Object(y.b)("debug","window.googletag.pubads().setPublisherProvidedId(".concat(r,")")),window.googletag.pubads().setPublisherProvidedId(r)):Object(y.b)("debug","GPT publisherProvidedId from localStorage was undefined,","it won't be set as requested by Google ads"),Object(y.b)("info","window.googletag.display(ads[0]), ads[0]=".concat(t[0].id)),window.googletag.display(t[0].id),this.initialRefreshAllDone?(Object(y.b)("info","slot ".concat(t[0].id," window.googletag.pubads().refresh(ads[0]) with"),"".concat(t[0])),window.googletag.pubads().refresh([t[0].slot])):(Object(y.b)("info","window.googletag.pubads().refresh()"),window.googletag.pubads().refresh(),this.initialRefreshAllDone=!0,Object(y.b)("info","All ads requested, sending out event for listeners"))}else t.forEach(e=>{Object(y.b)("info","ad.id = ".concat(e.id)),Object(y.b)("info","window.googletag.display(ad.id), ad.id = ".concat(e.id)),window.googletag.display(e.id)})})}target(e){window.googletag.cmd.push(()=>[...e].forEach(e=>window.googletag.pubads().setTargeting(e.key,e.value)))}removeAdOnEmpty(e){Object(y.b)("debug","slot ".concat(e.slot.getSlotElementId()," removeAdOnEmpty event.isEmpty: ").concat(e.isEmpty));var t=e.slot.getSlotId().getDomId();Object(y.b)("debug","slot ".concat(e.slot.getSlotElementId()," removeAdOnEmpty this.ads.length: ").concat(this.ads.length));var r=this.ads.find(e=>e.id===t);r&&r.calculateRefreshSizes(document.querySelector("#".concat(t)))}storeAd(e){return!this.ads.find(t=>e.id===t.id)&&(this.ads.push(e),!0)}getCurrentRefreshCountFor(e){return Array.isArray(e.getTargeting(je.REFRESH))&&0===e.getTargeting(je.REFRESH).length?0:parseInt(e.getTargeting(je.REFRESH)[0],10)}isTargetedForRefresh(e){return Object(y.b)("debug","slot ".concat(e.getSlotElementId()," carries the refresh targeting"),"refresh","with the value:",e.getTargeting("refresh")),e.getTargeting("refresh").indexOf("true")>-1}refreshDisabledByAttributeFor(e){var t=document.querySelector("#".concat(e.getSlotElementId()));return Object(y.b)("debug","slot ".concat(e.getSlotElementId()," document.querySelector(#").concat(e.getSlotElementId(),")="),t),null!==t&&null!==t.getAttribute(P.c.attr.state.key)&&(Object(y.b)("debug","slot ".concat(e.getSlotElementId()," has the attribute"),P.c.attr.state.key,"with the value:",t.getAttribute(P.c.attr.state.key)),P.c.attr.state.value.off===t.getAttribute(P.c.attr.state.key))}refreshSlot(e,t){var r=this;return Qe((function*(){Object(y.b)("debug","slot ".concat(e.getSlotElementId()),"window.googletag.pubads().refresh([slot]) with","".concat(e.getSlotElementId()),"Refreshing slot"),Object(y.b)("info","slot ".concat(e.getSlotElementId()),"adding new bids to slot before refresh");var i=r.ads.find(e=>e.id===t);i?(yield r.parallel.sendBidderRequests([i],[e]),r.requestAds([i]),Object(y.b)("info","slot ".concat(t),"bidder requests have returned now refresh ad"),window.googletag.pubads().refresh([e])):Object(y.b)("error","slot ".concat(t),"was not found and will not be refreshed")}))()}incrementRefreshCountAndRefreshSlot(e,t){var r=this,i=document.getElementById(t);if(i){var n=i.closest(".ad__inner"),o=n||i;this.incrementRefreshCount(e),new IntersectionObserver(function(){var i=Qe((function*(i,n){for(var o of i)o.isIntersecting?(yield r.refreshSlot(e,t),n.unobserve(o.target)):Object(y.b)("debug","slot ".concat(e.getSlotElementId()),"Setting Intersection Observer to monitor for ad slot in viewport","Future refresh will be queued")}));return function(e,t){return i.apply(this,arguments)}}(),{threshold:.5}).observe(o)}}impressionViewable(e){var t=e.slot,r=t.getSlotElementId();Object(y.b)("debug","slot ".concat(t.getSlotElementId()," became viewable."));var i=this.refreshConf.s;if(void 0!==i){var n=this.isTargetedForRefresh(t);Object(y.b)("debug","slot ".concat(t.getSlotElementId()," isTargetedForRefresh:"),n);var o=this.refreshDisabledByAttributeFor(t);Object(y.b)("debug","slot ".concat(t.getSlotElementId()," refreshDisabledByAttribute:"),o),n&&!o?setTimeout(this.incrementRefreshCountAndRefreshSlot.bind(this,t,r),i*l.b.secToMs):Object(y.b)("debug","slot ".concat(r),"The slot was not targeted for refresh or was disabled")}else Object(y.b)("debug","slot ".concat(r),"The page-data refresh configuration was undefined")}incrementRefreshCount(e){var t=this.getCurrentRefreshCountFor(e)+1;e.setTargeting(je.REFRESH,String(t)),Object(y.b)("debug","slot ".concat(e.getSlotElementId()),"slot.getTargeting(AdTargetKeys.REFRESH):",e.getTargeting(je.REFRESH)),Object(y.b)("debug","slot ".concat(e.getSlotElementId()),"incremented rc value:",t+1)}slotOnLoad(e){var t=e.slot;Object(y.b)("debug","slot ".concat(t.getSlotElementId()),"Creative iframe has loaded.");var r=t.getSlotId().getDomId(),i=this.ads.find(e=>e.id===r);i&&i.loaded()}slotRenderEnded(e){Object(y.b)("debug","Is empty?:",e.isEmpty);var t="";if(e.slot&&(t=e.slot.getSlotElementId()),Te.active&&t.match(/^ad-\d*$/)||t.match(/^ad-rr\d*$/)||t.match(/^ad-in\d*$/)){if(e.size&&6!==e.size[0]&&7!==e.size[0]){var r=this.ads.find(e=>e.id===t);r&&Te.enableScrollingFollow(r)}Te.updateAllAds()}if(!e.isEmpty){var i=e.slot;Object(y.b)("debug","slot ".concat(i.getSlotElementId()),"finished rendering."),Object(y.b)("debug","slot ".concat(i.getSlotElementId()),"Advertiser ID:",e.advertiserId),Object(y.b)("debug","slot ".concat(i.getSlotElementId()),"Campaign ID: ",e.campaignId),Object(y.b)("debug","slot ".concat(i.getSlotElementId()),"Creative ID: ",e.creativeId),Object(y.b)("debug","slot ".concat(i.getSlotElementId()),"Line Item ID:",e.lineItemId),Object(y.b)("debug","slot ".concat(i.getSlotElementId()),"Size:",e.size),Object(y.b)("debug","slot ".concat(i.getSlotElementId()),"Source Agnostic Creative ID:",e.sourceAgnosticCreativeId),Object(y.b)("debug","slot ".concat(i.getSlotElementId()),"Source Agnostic Line Item ID:",e.sourceAgnosticLineItemId),this.removeAdOnEmpty(e);var n=e.slot.getSlotId().getDomId(),o=this.ads.find(e=>e.id===n);o&&o.display(e.size,e.slot.getResponseInformation().advertiserId)}}slotResponseReceived(e){var t=e.slot;Object(y.b)("debug","slot ".concat(t.getSlotElementId()),"Ad response received.")}slotRequested(e){var t=e.slot;Object(y.b)("debug","slot ".concat(t.getSlotElementId()),"has been requested.")}slotVisibilityChanged(e){var t=e.slot;Object(y.b)("debug","slot ".concat(t.getSlotElementId()," Visibility changed.")),Object(y.b)("debug","slot ".concat(t.getSlotElementId()),"Visible area:",e.inViewPercentage+"%")}getRefreshAdConfFromOrDefault(e){switch(typeof e.ads.refresh){case"boolean":return e.ads.refresh?this.defaultAdRefreshConf:void 0;case"object":return e.ads.refresh;default:return}}getLazyLoadAdConfFromOrDefault(e){switch(typeof e.ads.lazy){case"undefined":case"boolean":return this.defaultLazyLoadConf;case"object":return e.ads.lazy}}registerMagniteInArticle(){if(this.conf.ads.magniteInArticle.desktop&&w.b.deviceType()!==w.c.MOBILE||this.conf.ads.magniteInArticle.mobile&&w.b.deviceType()===w.c.MOBILE){var e=document.createElement("div");e.id="magnite-mia";var t=document.createElement("div");t.style.display="none",t.append(e),document.body.prepend(t);var r=window.googletag.defineSlot(this.adURI,[321,241],"magnite-mia");r.setTargeting("loc","slice"),r.addService(window.googletag.pubads()),window.googletag.pubads().refresh([r])}}}class tt{constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.parts=e}add(e){return new tt([...[].concat(this.parts),...[].concat(e)])}addIf(e,t){return e?this.add(t):this}toString(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",t=[].concat(this.parts).filter(e=>e);return t.length?e+t.join(e):""}}var rt=(e,t,r,i)=>new tt(e).add(t).addIf(i!==c.a.AUTHOR,[...r||[]]).addIf(i===c.a.AUTHOR,[...r||[]].slice(0,-1)).add(i===c.a.STORY?c.a.STORY:c.a.INDEX).toString(),it={advertiser:{ids:[118029421,129344461,4420631957,4445602465,4478460665,4513367905,4525362137,4528708924,4529087420,4538991029,4552172073,4559986059,4561803726,4567476945,4577987662,4582685415,4582887974,4584377759,4584711008,4585343252,4594447339,4609354044,4609356879,4609984445,4611428804,4611552924,4613163241,4613230769,4614148467,4615290658,4619578530,4621550146,4621580764,4621945085,4625629089,4633459918,4636168542,4636388061,4636912230,4636923820,4643528143,4646938443,4648366719,4651275336,4652408871,4657981817,4658771490,4660872853,4667466222,4677338118,4691792532,4695447086,4698166207,4699618287,4701834910,4704537056,4714482921,4715813734,4724060152,4728633963,4736573991,4740035682,4740986131,4741903881,4742541823,4752968130,4767150168,4771552983,4810107512]}},nt=r(17);r(54);function ot(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function at(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){ot(o,i,n,a,s,"next",e)}function s(e){ot(o,i,n,a,s,"throw",e)}a(void 0)}))}}function st(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ct extends nt.a{constructor(){super(...arguments),st(this,"gates",{}),st(this,"verifying",!1)}static requiresVerification(e){return it.advertiser.ids.includes(e)}initialize(e){this.ageVerified=e,document.addEventListener(C.a.DISPLAY,this.onAdLoaded.bind(this)),!this.ageVerified&&l.c.params(ct.DOM.param.verified)&&this.onAgeVerified()}applyMessaging(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object.values(this.gates).map(e=>e.ad)).filter(e=>e&&!(e.isOutOfPage()||e.isWallpaper())).forEach(e=>{var t=document.createElement("div");e.el.classList.remove(ct.DOM.className.gate),e.el.firstElementChild.appendChild(t),t.classList.add(ct.DOM.className.msg),t.innerText=ct.Message.verified,t.setAttribute("style","width:".concat(e.sizeRendered[0],"px"))})}onAdLoaded(e){var t=this;return at((function*(){var r=e.detail,i=l.c.params(ct.DOM.param.test)||ct.requiresVerification(r.advertiser);if(!r.isOutOfPage()&&i)if(r.isWallpaper())t.ageVerified||(yield t.wallpaperReady(),w.b.nodes(document.body.querySelectorAll(Se.a.Wallpaper.selector)).forEach(e=>{t.gates[e.id]={ad:r,veil:t.veil("100%","100%",!1)},e.prepend(t.gates[e.id].veil)}));else{if(t.ageVerified)return t.applyMessaging([r]);var n=t.veil("".concat(r.sizeRendered[0],"px"),"".concat(r.sizeRendered[1],"px"));r.el.classList.add(ct.DOM.className.gate),r.el.firstElementChild.prepend(n),t.gates[r.id]={ad:r,veil:n}}}))()}onAgeVerified(){this.ageVerified=!0,Object.values(this.gates).forEach(e=>{var{veil:t}=e;return t.remove()}),this.applyMessaging(),this.dispatchEvent(l.c.event(p.a.VERIFIED))}onChange(e){this.verifying=e.target.checked,Object.values(this.gates).forEach(e=>{var{ad:t,veil:r}=e;t.isWallpaper()||t.isOutOfPage()||(r.querySelector("input").checked=this.verifying,r.querySelector("button").disabled=!this.verifying)})}veil(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=document.createElement("div");if(i.classList.add(ct.DOM.className.veil),i.setAttribute(w.b.attrs.style,"height:".concat(t,";width:").concat(e)),r){var n=document.createElement("button"),o=document.createElement("input"),a=document.createElement("form"),s=document.createElement("p"),c=document.createElement("label"),l=document.createElement("p");n.innerText=ct.Message.confirm,n.disabled=!this.verifying,o.addEventListener(w.a.CHANGE,this.onChange.bind(this)),o.checked=this.verifying,o.type="checkbox",a.addEventListener(w.a.SUBMIT,this.onAgeVerified.bind(this)),a.appendChild(l),a.appendChild(s),s.appendChild(c),s.appendChild(n),c.innerText=ct.Message.prompt,c.prepend(o),l.innerText=ct.Message.gated,i.appendChild(a)}return i}wallpaperReady(){return at((function*(){return new Promise(e=>{if(document.body.querySelector(Se.a.Wallpaper.selector))return e();new MutationObserver((t,r)=>{t.forEach(t=>{"childList"===t.type&&w.b.nodes(t.addedNodes).forEach(t=>{t.id===Se.a.Wallpaper.readyId&&(r.disconnect(),e())})})}).observe(document.body,{childList:!0,subtree:!0})})}))()}}st(ct,"DOM",{className:{gate:"agegate",msg:"agegate-msg",veil:"agegate-veil"},param:{test:"agegate",verified:"utm_agegate"}}),st(ct,"Message",{confirm:"Verify",gated:"This content is intended for audiences over the age of 19+. Please verify you are legal age of majority in your province.",prompt:"I am 19+ years of age",verified:"You are seeing this ad because you are 19+ of age."});var lt=r(35),dt=function(e){return e.AD_BLOCKER="ad_blocker_enabled",e.BRAND="brand",e.DOMAIN="domain",e.BROWSER="browser",e.DIVISION="division",e.PAGE_URL="page_url",e.PLATFORM="platform",e.PLATFORM_VERSION="platform_version",e.FEM_VERSION="fem_version",e.VIEW_TYPE="view_type",e.ENV="env",e.AD_LIGHT="AdLight User",e.ARTICLE_ID="article_id",e.ARTICLE_AUTHORS="article_authors",e.ARTICLE_AUTHOR_LIST="article_author_list",e.ARTICLE_TAGS="article_tags",e.ARTICLE_TAG_LIST="article_tag_list",e.BROWSER_LG="browser_language",e.DEVICE_TYPE="device_type",e.ERROR="404",e.HEADLINE="Alternate Headline",e.IS_ORIGINAL="originating_property",e.IS_WIRE="wire_content",e.MAIN_CATEGORY="main_category",e.SECONDARY_CATEGORIES="secondary_categories",e.SECONDARY_CATEGORIES_LIST="secondary_categories_list",e.META_TAG="article_tags",e.METERED_CONTENT="metered_content",e.MP_ID="MPID",e.NLP_CATEGORY="nlp_category",e.NLP_SUB_CATEGORY="nlp_sub_category",e.NLP_CATEGORY_LIST="nlp_category_list",e.NLP_CATEGORY_SCORE="nlp_category_score",e.NLP_ENTITY="nlp_entity",e.NLP_ENTITY_LIST="nlp_entity_list",e.NLP_TOPIC="nlp_topic",e.NLP_TOPIC_LIST="nlp_topic_list",e.PROJECT_TYPE="project_type",e.PUB_TIMESTAMP="publish_timestamp",e.REFERRER="referrer",e.REF_DETAILS="referral_details",e.SESSION_UUID="session_uuid",e.SPONSOR_NAME="sponsor_name",e.ADVERTORIAL="advertorial",e.TITLE="article_title",e.TYPE="page_type",e.USER_STATUS="user_status",e.WRD_CNT="word_count",e.CHAR_CNT="character_count",e.WIRE_AUTHORS="wire_authors",e.URL_PARAMS="URL Parameters",e.CAR_MAKE="car_make",e.CAR_MODEL="car_model",e.CAR_YEAR="car_year",e.CAR_BODYSTYLE="car_bodystyle",e.CAR_CLASSIFICATION="car_classification",e.IS_PREMIUM="is_premium",e.LANGUAGE="language",e.PAGEVIEW_PRCNT="percentage_of_page_viewed",e.STORYVIEW_PRCNT="percentage_of_story_viewed",e.PAGEVIEW_PRCNT_DEPRECATED="Percentage of Page Viewed",e.STORYVIEW_PRCNT_DEPRECATED="Percentage of Story Viewed",e.PAGEVIEW_INIT_PRCNT="Initial Percentage of Page Viewed",e.ACTIVE_TIME_ON_PAGE="active_time_on_page",e.CUSTOMER_ID="customer_id",e.FC_RUN_TIME="fc_run_time",e.CLICK_SOURCE_VERTICAL_POSITION_PERCENTAGE="click_vertical_position_percentage",e.CLICK_SOURCE_VERTICAL_POSITION_PIXELS="click_vertical_position_pixels",e.GA_NONINTERACTION="Google.NonInteraction",e.GA_PAGE_PATH="Google.Page",e.GA_PAGE_TITLE="Google.Title",e}({}),ut=function(e){return e.ERROR="Error",e.EVENTNAME="Event",e}({});class mt{error(e,t){return{[ut.ERROR]:e,[ut.EVENTNAME]:t}}}function pt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ft="Empty object is not acceptable";class gt{constructor(){pt(this,"errorFormatter",new mt)}logPageView(e,t,r){try{if(l.c.isEmptyObject(t))return this.logCustomError(ft,"logPageView"),!1;var i=[e,t,r];return window.mParticle.ready((function(){window.mParticle.logPageView.apply(this,i)})),!0}catch(e){return Object(y.b)("error","Unable to log mParticle page view event ",e),!1}}logEvent(e,t,r,i){try{if(l.c.isEmptyObject(r))return this.logCustomError(ft,"logEvent"),!1;var n=[e,t,r,i];return window.mParticle.ready((function(){window.mParticle.logEvent.apply(this,n)})),!0}catch(e){return Object(y.b)("error","Unable to log mParticle custom event ",e),!1}}upload(){try{window.mParticle.ready(()=>window.mParticle.upload())}catch(e){console.error("PageEvents.upload error",e)}}logCustomError(e,t){var r=this.errorFormatter.error(e,t);this.logEvent(gt.mpEventName.Default,gt.mpEventType.Unknown,r)}}function ht(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function vt(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){ht(o,i,n,a,s,"next",e)}function s(e){ht(o,i,n,a,s,"throw",e)}a(void 0)}))}}pt(gt,"mpEventType",{Location:2,Navigation:1,Other:8,Search:3,Social:7,Transaction:4,Unknown:0,UserContent:5,UserPreference:6}),pt(gt,"mpEventName",{Default:"Unknown",ScreenView:"screen_view"}),pt(gt,"mpSupportedNativeAction",[A.a.ACTION_PAGE_LOAD]);class bt extends gt{constructor(){super()}setUserAttribute(e,t){try{if(""===t)return this.logCustomError("Empty attribute value is not acceptable","Set user attribute - "+e),!1;var r=arguments;return window.mParticle.ready(()=>{window.mParticle.Identity.getCurrentUser()&&window.mParticle.Identity.getCurrentUser().setUserAttribute.apply(window.mParticle.Identity.getCurrentUser(),r)}),!0}catch(e){return!1}}userLogin(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{return l.c.isEmptyObject(e)?(this.logCustomError("Empty user identity object is not acceptable","User login"),!1):(window.mParticle.ready(vt((function*(){var r=function(){var e=vt((function*(e){if(!t&&e.getPreviousUser()&&e.getUser()&&e.getPreviousUser().getMPID()!==e.getUser().getMPID()){var r=function(){var t=vt((function*(t){202!==t.httpCode?Object(y.b)("error","Unable to send alias request ",t):document.dispatchEvent(new CustomEvent(w.a.CUSTOM_EVENT,{detail:{anonymous_mpid:e.getPreviousUser().getMPID(),control_fields:{mparticle:{keys:{anonymous_mpid:"anonymous_mpid",original_mpid:"original_mpid"},mp_event_type:"UserContent"}},event_name:A.a.customEventNames.userAlias,original_mpid:e.getUser().getMPID()}})),document.dispatchEvent(new CustomEvent(f.a.MP_LOGIN_FINISHED))}));return function(e){return t.apply(this,arguments)}}(),i=window.mParticle.Identity.createAliasRequest(e.getPreviousUser(),e.getUser());yield window.mParticle.Identity.aliasUsers(i,r)}}));return function(t){return e.apply(this,arguments)}}();yield window.mParticle.Identity.login(e,r)}))),!0)}catch(e){return Object(y.b)("error","Unable to perform login call on mParticle ",e),document.dispatchEvent(new CustomEvent(f.a.MP_LOGIN_FINISHED)),!1}}}var yt=new bt,wt=(e,t)=>{if(e&&e.uuid&&yt.setUserAttribute(dt.CUSTOMER_ID,String(e.uuid)),t){var r=(new Date).toISOString().slice(0,10);yt.setUserAttribute(dt.FC_RUN_TIME,r)}},Et=r(20);function St(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function Ot(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){St(o,i,n,a,s,"next",e)}function s(e){St(o,i,n,a,s,"throw",e)}a(void 0)}))}}function _t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function It(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(r),!0).forEach((function(t){At(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function At(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Tt=new bt;class Pt{initialize(e,t){var r={appVersion:"1.0.0",customFlags:{},identifyRequest:this.buildUserIdentities(t.uuid,t.email),identityCallback:this.mParticleCallback.bind(this),isDebug:!0,isDevelopmentMode:e.isDev,isSandbox:!0,sessionTimeout:30,useCookieStorage:!0,useNativeSdk:!1};window.mParticle=window.mParticle||{config:{rq:[]}},window.mParticle.config=It(It({},window.mParticle.config),r),window.mParticle.ready=e=>window.mParticle.config.rq.push(e),w.b.loadScript("//jssdkcdns.mparticle.com/js/v2/".concat(e.account,"/mparticle.js"))}mParticleCallback(e){var t=this;return Ot((function*(){var r=e.getUser().getUserIdentities().userIdentities,i=I.a.get(_.a.ID);if(i&&i.uuid&&r.customerid!==i.uuid){var n=t.buildUserIdentities(i.uuid,i.email,i.id,window.pid);window.mParticle.Identity.identify(n,()=>{wt(i,window.pid)})}else{var o;try{o=yield Et.a.get(_.a.ID)}catch(e){Object(y.b)("error","Unable to access global profile ",e)}if(o&&o.id&&(o.id!==r.other3||window.pid!==r.other2)){var a=t.buildUserIdentities(o.uuid,o.email,o.id,window.pid);window.mParticle.Identity.identify(a,()=>{wt(o,window.pid)})}else{var s=e=>{if(e.detail.uuid&&r.customerid!==e.detail.uuid&&!e.detail.isLogin){var i=t.buildUserIdentities(e.detail.uuid,e.detail.email,e.detail.id,window.pid);window.mParticle.Identity.identify(i,()=>{wt(e.detail,window.pid)}),removeEventListener(f.a.IDENTITY_CHANGE,s)}};if(window.pid)wt(i||o,window.pid);addEventListener(f.a.IDENTITY_CHANGE,s)}}var c=function(){var e=Ot((function*(e){var r=t.buildUserIdentities(i.uuid,i.email,i.id,e.detail.pid);window.mParticle.Identity.identify(r,()=>{wt(i,e.detail)})}));return function(t){return e.apply(this,arguments)}}();document.addEventListener(f.a.SET_PERSON_ID,c),window.mParticle.Identity.getCurrentUser()&&window.mParticle.Identity.getCurrentUser().getMPID()&&(localStorage.setItem(_.a.PPID,t.buildPPIDfromMPID(window.mParticle.Identity.getCurrentUser().getMPID())),dispatchEvent(new CustomEvent(f.a.PROVIDER_ID_ASSIGNED,{detail:{mpId:window.mParticle.Identity.getCurrentUser().getMPID()}}))),window.mParticle&&window.mParticle.sessionManager.getSession()&&dispatchEvent(new CustomEvent(f.a.MP_READY,{detail:{mpId:window.mParticle.Identity.getCurrentUser().getMPID(),mpSessionUuid:window.mParticle.sessionManager.getSession()}})),setTimeout(()=>t.listenToUserEvents(),1e3)}))()}buildPPIDfromMPID(e){return(e.startsWith("-")?"ppidn"+e.replace("-",""):"ppidp"+e).padStart(32,"0")}listenToUserEvents(){var e=this,t=function(){var t=Ot((function*(t){var r;try{r=yield Et.a.get(_.a.ID)}catch(e){Object(y.b)("error","Unable to access global profile ",e)}var i=e.buildUserIdentities(t.detail.uuid,t.detail.email,r?r.id:void 0);wt(t.detail),Tt.userLogin(i,!0)}));return function(e){return t.apply(this,arguments)}}();document.removeEventListener(f.a.NEW_REGISTRATION,t),document.addEventListener(f.a.NEW_REGISTRATION,t);var r=e=>{var t=this.buildUserIdentities(e.detail.uuid,e.detail.email);wt(e.detail),Tt.userLogin(t,!1)};document.removeEventListener(f.a.IDENTITY_LOGIN,r),document.addEventListener(f.a.IDENTITY_LOGIN,r),document.dispatchEvent(new CustomEvent(f.a.MP_LISTENS))}buildUserIdentities(e,t,r,i){var n={};return e&&(n.customerid=e),t&&(n.email=t),r&&(n.other3=r),i?n.other2=i:window.pid&&(n.other2=window.pid),{userIdentities:n}}}class Ct extends i.a{constructor(e,t,r,i){super(),this.type=e,this.value=t,this.action=r,this.element=i}handle(){}}var Rt=["control_fields"];function kt(e,t){if(null==e)return{};var r,i,n=function(e,t){if(null==e)return{};var r,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}class Dt extends Ct{constructor(e,t,r,i){super(e,t,r,i)}get valueChanged(){var e;return"true"===(null===(e=this.element)||void 0===e?void 0:e.getAttribute("data-evt-val-changed"))}get eventValue(){var e;return this.action===w.a.click&&this.valueChanged?(null===(e=this.element)||void 0===e?void 0:e.getAttribute("data-evt-val"))||"":this.value}setMetaProperties(e){this.metaProperties=e}getProperties(){try{if(this.eventValue&&this.eventValue.length)return JSON.parse(this.eventValue)}catch(e){console.error("Error parsing event value",{value:this.eventValue,error:e})}}getGeneralAttributesList(){return this.eventData=this.eventData||this.getProperties(),this.eventData&&this.eventData.control_fields&&this.eventData.control_fields.extra_keys?this.eventData.control_fields.extra_keys:[]}getProviderAttributesList(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mparticle",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];if(this.eventData=this.eventData||this.getProperties(),this.eventData&&this.eventData.control_fields&&this.eventData.control_fields[e]){var i=this.eventData.control_fields[e].exclude_common_keys||[];r=t.filter(e=>!i.includes(e)),this.eventData.control_fields[e].extra_keys&&(r=[...r,...this.eventData.control_fields[e].extra_keys])}else r=t;return[...new Set(r)]}getProviderControlField(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mparticle";return this.eventData=this.eventData||this.getProperties(),this.eventData.control_fields&&this.eventData.control_fields[e]?this.eventData.control_fields[e]:{}}getProviderCustomData(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mparticle",t={},r=this.eventData||this.getProperties(),{control_fields:i}=r,n=kt(r,Rt);if(i[e]&&i[e].keys){var o=i[e].keys;Object.keys(o).forEach(e=>{t[o[e]]=n[e]})}return t}getControlFields(){return this.eventData&&this.eventData.control_fields?this.eventData.control_fields:{}}}var jt={stringifyFilteredEntities(e,t,r){if(e){var i=t>0?t:e.length;return r?e.filter(e=>e.score>r).slice(0,i).map(e=>l.c.decodeHtmlEntity("".concat(e.type,",").concat(e.subtype,",").concat(e.token))):e.slice(0,i).map(e=>l.c.decodeHtmlEntity("".concat(e.type,",").concat(e.subtype,",").concat(e.token,",").concat(e.score)))}return[]},stringifyFilteredKeytopics(e,t,r){if(e){var i=t>0?t:e.length;return r?e.filter(e=>e.score>r).slice(0,i).map(e=>l.c.decodeHtmlEntity("".concat(e.text))):e.slice(0,i).map(e=>l.c.decodeHtmlEntity("".concat(e.text,",").concat(e.score)))}return[]},stringifyFilteredCategories:e=>e?e.map(e=>l.c.decodeHtmlEntity(e.name)):[],stringifyFilteredSubCategories:e=>e?e.map(e=>{var t=e.name;return e.specificCategories?e.specificCategories.filter(e=>e.name!==t).map(e=>l.c.decodeHtmlEntity(e.name)):[]}).filter(e=>e.length):[],stringifyFilteredCategoriesScore:e=>e?e.map(e=>l.c.decodeHtmlEntity(e.score.toString())):[]};class Mt{constructor(e){this.conf=e}lookup(e,t){var r="";switch(e){case dt.USER_STATUS:r=this.conf.profile.adLight?"subscribed":this.conf.profile.email?"registered":"anonymous";break;case dt.IS_PREMIUM:r=String(this.conf.page.isPremium);break;case dt.AD_LIGHT:r=String(this.conf.profile.adLight);break;case dt.BRAND:r=this.conf.brand;break;case dt.DIVISION:r=this.conf.division;break;case dt.DOMAIN:r=l.c.getDomain();break;case dt.TYPE:r=this.conf.page.type;break;case dt.METERED_CONTENT:r=String(!this.conf.page.isPaywallWhitelisted);break;case dt.ARTICLE_ID:r=this.conf.page.articleId;break;case dt.IS_ORIGINAL:"boolean"==typeof this.conf.page.isOrigin&&(r=String(this.conf.page.isOrigin));break;case dt.WRD_CNT:r=this.conf.page.wc;break;case dt.CHAR_CNT:r=this.conf.page.charCount;break;case dt.SPONSOR_NAME:this.conf.page.sponsor&&(r=this.conf.page.sponsor);break;case dt.ADVERTORIAL:"boolean"==typeof this.conf.page.advertorial&&(r=this.conf.page.advertorial);break;case dt.IS_WIRE:r=this.conf.page.writers&&this.conf.page.writers.wire&&this.conf.page.writers.wire.length>0||this.conf.page.wireId?String(!0):String(!1);break;case dt.ARTICLE_AUTHORS:this.conf.page.writers&&this.conf.page.writers.main&&(r=this.conf.page.writers.main.map(e=>"object"==typeof e?e.name:e).join("|"));break;case dt.ARTICLE_AUTHOR_LIST:this.conf.page.writers&&this.conf.page.writers.main&&(r=this.conf.page.writers.main.map(e=>"object"==typeof e?e.name:e));break;case dt.WIRE_AUTHORS:this.conf.page.writers&&this.conf.page.writers.wire&&(r=this.conf.page.writers.wire.join("|"));break;case dt.ARTICLE_TAGS:this.conf.page.tags&&(r=this.conf.page.tags.join(", "));break;case dt.ARTICLE_TAG_LIST:this.conf.page.tags&&(r=this.conf.page.tags);break;case dt.TITLE:r=this.conf.page.getTitle();break;case dt.HEADLINE:r=this.conf.page.getHeadline();break;case dt.MAIN_CATEGORY:var i=this.conf.page.getCategories();i.length&&(r=i[i.length-1]);break;case dt.PUB_TIMESTAMP:this.conf.page.date&&this.conf.page.date.pub_timestamp&&(r=String(this.conf.page.date.pub_timestamp));break;case dt.NLP_ENTITY:this.conf.page.klangoo&&this.conf.page.klangoo.entities&&(r=jt.stringifyFilteredEntities(this.conf.page.klangoo.entities,5).join("|"));break;case dt.NLP_ENTITY_LIST:this.conf.page.klangoo&&this.conf.page.klangoo.entities&&(r=jt.stringifyFilteredEntities(this.conf.page.klangoo.entities,5,.8));break;case dt.NLP_TOPIC:this.conf.page.klangoo&&this.conf.page.klangoo.keyTopics&&(r=jt.stringifyFilteredKeytopics(this.conf.page.klangoo.keyTopics,5).join("|"));break;case dt.NLP_TOPIC_LIST:this.conf.page.klangoo&&this.conf.page.klangoo.keyTopics&&(r=jt.stringifyFilteredKeytopics(this.conf.page.klangoo.keyTopics,0,.5));break;case dt.NLP_CATEGORY:this.conf.page.klangoo&&this.conf.page.klangoo.categories&&(r=jt.stringifyFilteredCategories(this.conf.page.klangoo.categories).join(","));break;case dt.NLP_CATEGORY_SCORE:this.conf.page.klangoo&&this.conf.page.klangoo.categories&&(r=jt.stringifyFilteredCategoriesScore(this.conf.page.klangoo.categories).join(","));break;case dt.NLP_SUB_CATEGORY:this.conf.page.klangoo&&this.conf.page.klangoo.categories&&(r=jt.stringifyFilteredSubCategories(this.conf.page.klangoo.categories).join(","));break;case dt.NLP_CATEGORY_LIST:this.conf.page.klangoo&&this.conf.page.klangoo.categories&&(r=jt.stringifyFilteredCategories(this.conf.page.klangoo.categories));break;case dt.PAGE_URL:r=l.c.currentPageUrl();break;case dt.REFERRER:var n=document.referrer,o=sessionStorage.getItem("originalReferrer");o||(sessionStorage.setItem("originalReferrer",n),o=n);var a=!!n&&0===n.indexOf(location.protocol+"//"+location.host);r=a?"":o;break;case dt.REF_DETAILS:var s=l.c.urlParams(document.location);s.has("utm_source")&&(r=s.get("utm_source"));break;case dt.URL_PARAMS:if(this.conf.page.captureUrlParams){var c=new URLSearchParams(window.location.search);r={},this.conf.page.captureUrlParams.forEach(e=>{r[e]=c.get(e)})}break;case dt.PROJECT_TYPE:void 0!==this.conf.page.projectType&&(r=String(this.conf.page.projectType));break;case dt.PLATFORM:r=this.conf.platform;break;case dt.PLATFORM_VERSION:r=this.conf.platformVersion;break;case dt.FEM_VERSION:r=this.conf.femVersion;break;case dt.VIEW_TYPE:r="HTML";break;case dt.CLICK_SOURCE_VERTICAL_POSITION_PERCENTAGE:document.body.clientHeight&&t.pageY&&(r=String(Math.round(t.pageY/document.body.clientHeight*100)));break;case dt.CLICK_SOURCE_VERTICAL_POSITION_PIXELS:t.pageY&&(r=String(t.pageY));break;case dt.DEVICE_TYPE:r=w.b.deviceType();break;case dt.AD_BLOCKER:r=(document.cookie.split(";").find(e=>e.trim().startsWith("__adblocker="))||"").trim().split("=").pop()||"false";break;case dt.PAGEVIEW_PRCNT_DEPRECATED:case dt.PAGEVIEW_PRCNT:r=String(this.conf.scrollData[dt.PAGEVIEW_PRCNT]);break;case dt.STORYVIEW_PRCNT_DEPRECATED:case dt.STORYVIEW_PRCNT:r=String(this.conf.scrollData[dt.STORYVIEW_PRCNT]);break;case dt.ACTIVE_TIME_ON_PAGE:r=String(Math.round((Date.now()-this.conf.scrollData[dt.ACTIVE_TIME_ON_PAGE])/1e3));break;case dt.ENV:r=this.conf.isDev?"test":"prod";break;case dt.CAR_MAKE:this.conf.page.drivingTaxonomy&&this.conf.page.drivingTaxonomy.carMake&&(r=String(this.conf.page.drivingTaxonomy.carMake));break;case dt.CAR_MODEL:this.conf.page.drivingTaxonomy&&this.conf.page.drivingTaxonomy.carModel&&(r=String(this.conf.page.drivingTaxonomy.carModel));break;case dt.CAR_YEAR:this.conf.page.drivingTaxonomy&&this.conf.page.drivingTaxonomy.modelYears&&(r=String(this.conf.page.drivingTaxonomy.modelYears));break;case dt.CAR_BODYSTYLE:this.conf.page.drivingTaxonomy&&this.conf.page.drivingTaxonomy.bodyType&&(r=String(this.conf.page.drivingTaxonomy.bodyType));break;case dt.CAR_CLASSIFICATION:this.conf.page.drivingTaxonomy&&this.conf.page.drivingTaxonomy.vehicleType&&(r=String(this.conf.page.drivingTaxonomy.vehicleType));break;case dt.BROWSER:r=w.b.browserType();break;case dt.BROWSER_LG:r=w.b.browserLanguage();break;case dt.GA_NONINTERACTION:r=!0;break;case dt.GA_PAGE_TITLE:r=this.conf.page.getTitle();break;case dt.GA_PAGE_PATH:r=l.c.getPath();break;case dt.SECONDARY_CATEGORIES:this.conf.page.secondary_categories&&(r=this.conf.page.secondary_categories.join(","));break;case dt.SECONDARY_CATEGORIES_LIST:this.conf.page.secondary_categories&&(r=this.conf.page.secondary_categories)}return r}}var Lt=function(e){return e.FIRE_PAGE_VIEW="gtmFirePageView",e}({});function Nt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function xt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ut{constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"dataLayer";this.dataLayerName=e}init(e,t,r){"dataLayer"!==this.dataLayerName?(addEventListener(f.a.MP_READY,e=>{var t={};e.detail.mpId&&(t.mp_id=e.detail.mpId),e.detail.mpSessionUuid&&(t.session_uuid=e.detail.mpSessionUuid),this.sendEvent(t)}),addEventListener(Lt.FIRE_PAGE_VIEW,i=>{this.sendEvent(i.detail),this.loadScript(e,t,r)})):this.loadScript(e,t,r)}sendEvent(e){var t=Object.assign({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),e));window[this.dataLayerName]=window[this.dataLayerName]||[],window[this.dataLayerName].push(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Nt(Object(r),!0).forEach((function(t){xt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t))}loadScript(e,t,r){window[this.dataLayerName]=window[this.dataLayerName]||[],window[this.dataLayerName].push({event:"gtm.js","gtm.start":(new Date).getTime()});var i="";t&&(i+="&gtm_auth="+t),r&&(i+="&gtm_preview="+r),w.b.loadScript("//www.googletagmanager.com/gtm.js?id=".concat(e,"&l=").concat(this.dataLayerName).concat(i))}}function Ft(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function Vt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ft(Object(r),!0).forEach((function(t){Gt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ft(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Gt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class qt extends Dt{constructor(e,t,r,i,n){super(t,r,i,n),this.data=e}handle(){var e=new Ut,t=Vt({},this.data),r=this.getProviderAttributesList("gtm"),i=new Mt(this.metaProperties);r.forEach(e=>{try{var r=i.lookup(e);""!==r&&(t[e]=r)}catch(e){console.error("GlobalDataFormatter error in class GtmProvider",e)}});var n=this.getProviderCustomData();t=Vt(Vt({},t),n);var o=this.getProviderControlField("gtm");if("page-load"===this.action)dispatchEvent(new CustomEvent(Lt.FIRE_PAGE_VIEW,{detail:t}));else if(o.gtm_event_type){var a=Vt(Vt({},t),{},{event_type:o.gtm_event_type||"default"});e.sendEvent(a)}}}function Bt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function Wt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Bt(Object(r),!0).forEach((function(t){zt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function zt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ht,Yt=new gt;class Kt extends Dt{constructor(e,t,r,i,n){super(t,r,i,n),zt(this,"commonAttrs",[dt.AD_BLOCKER,dt.BRAND,dt.BROWSER,dt.BROWSER_LG,dt.DEVICE_TYPE,dt.DIVISION,dt.DOMAIN,dt.FEM_VERSION,dt.TYPE,dt.PAGE_URL,dt.PLATFORM,dt.PLATFORM_VERSION,dt.USER_STATUS,dt.VIEW_TYPE]),this.data=e}handle(e){var t=Wt({},this.data),r=this.getProviderAttributesList("mparticle",this.commonAttrs),i=new Mt(this.metaProperties);r.forEach(r=>{try{var n=i.lookup(r,e);""!==n&&(t[r]=n)}catch(e){console.error("GlobalDataFormatter error in class MparticleProvider",e)}});var n=this.getProviderCustomData("mparticle");t=Wt(Wt({},t),n);var o=this.getProviderControlField("mparticle"),a={};if(o.mp_custom_flags&&o.mp_custom_flags.forEach(e=>{try{var t=i.lookup(e);""!==t&&(a[e]=t)}catch(e){console.error("MP Custom Flag error",e)}}),o&&o.mp_native_event)gt.mpSupportedNativeAction.includes(this.action)?addEventListener(f.a.MP_READY,e=>{var r=e.detail.mpSessionUuid?{[dt.SESSION_UUID]:String(e.detail.mpSessionUuid)}:{},i=e.detail.mpId?{[dt.MP_ID]:String(e.detail.mpId)}:{},n=Wt(Wt(Wt({},t),r),i);Yt.logPageView(this.type||gt.mpEventName.ScreenView,n,a)}):(Yt.logCustomError("mParticleEvents not Supported",this.type),console.error("mParticleEvents not Supported",this.type,"Action",this.action));else{var s=o.mp_event_type||"Other";Yt.logEvent(this.type,gt.mpEventType[s],t,a),this.action!==w.a.BEFORE_UNLOAD&&this.action!==w.a.click||Yt.upload()}}}var Jt=new Uint8Array(16);function Xt(){if(!Ht&&!(Ht="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ht(Jt)}var $t=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var Qt=function(e){return"string"==typeof e&&$t.test(e)},Zt=[],er=0;er<256;++er)Zt.push((er+256).toString(16).substr(1));var tr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(Zt[e[t+0]]+Zt[e[t+1]]+Zt[e[t+2]]+Zt[e[t+3]]+"-"+Zt[e[t+4]]+Zt[e[t+5]]+"-"+Zt[e[t+6]]+Zt[e[t+7]]+"-"+Zt[e[t+8]]+Zt[e[t+9]]+"-"+Zt[e[t+10]]+Zt[e[t+11]]+Zt[e[t+12]]+Zt[e[t+13]]+Zt[e[t+14]]+Zt[e[t+15]]).toLowerCase();if(!Qt(r))throw TypeError("Stringified UUID is invalid");return r};var rr=function(e,t,r){var i=(e=e||{}).random||(e.rng||Xt)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){r=r||0;for(var n=0;n<16;++n)t[r+n]=i[n];return t}return tr(i)},ir=r(15),nr=[dt.MAIN_CATEGORY,dt.BRAND,dt.DIVISION,dt.ENV,dt.TYPE,dt.VIEW_TYPE,dt.CAR_MAKE,dt.CAR_MODEL,dt.CAR_BODYSTYLE,dt.CAR_CLASSIFICATION,dt.REF_DETAILS,dt.USER_STATUS,dt.SPONSOR_NAME,dt.ARTICLE_AUTHOR_LIST,dt.ARTICLE_TAG_LIST,dt.TITLE,dt.NLP_CATEGORY_LIST,dt.NLP_ENTITY_LIST,dt.NLP_TOPIC_LIST,dt.SECONDARY_CATEGORIES_LIST],or={article_author_list:"article_authors",article_tag_list:"article_tags",nlp_category_list:"nlp_category",nlp_entity_list:"nlp_entity",nlp_topic_list:"nlp_topic",secondary_categories_list:"secondary_categories"};function ar(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function sr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ar(Object(r),!0).forEach((function(t){cr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ar(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function cr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class lr{init(e,t,r){if(!window.permutive&&e&&t&&r){var i=window.permutive||{};i.q=[],i.config={},i.config.apiKey=r,i.config.workspaceId=t,i.config.viewId=rr(),i.config.environment="production";var n=function(e){i[e]=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var o=Array.prototype.slice.call(r,0);i.q.push({arguments:o,functionName:e})}};for(var o of["addon","identify","track","trigger","query","segment","segments","ready","on","once","user","consent"])n(o);window.permutive=i,addEventListener(f.a.MP_READY,e=>{e.detail.mpId&&window.permutive.identify([{id:e.detail.mpId,tag:"mpId"}])}),addEventListener(f.a.IDENTITY_INIT,e=>{e.detail.email&&Object(ir.b)(e.detail.email).then(e=>{window.permutive.identify([{id:e,tag:"email_sha256"}])}).catch(e=>{console.error("email_sha256 error",e)})})}}sendPageViewEvent(e){if(window.permutive){var t=this.getEventData(e,nr);window.permutive.addon("web",{page:sr({},t)});var r=window.permutive.config.workspaceId;w.b.loadScript("https://".concat(r,".edge.permutive.app/").concat(r,"-web.js")),window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],window.googletag.cmd.push(()=>{if(0===window.googletag.pubads().getTargeting("permutive").length){var e=window.localStorage.getItem("_pdfps");window.googletag.pubads().setTargeting("permutive",e?JSON.parse(e):[]);var t=window.localStorage.getItem("permutive-id");t&&(window.googletag.pubads().setTargeting("puid",t),window.googletag.pubads().setTargeting("ptime",Date.now().toString())),window.permutive.config.viewId&&window.googletag.pubads().setTargeting("prmtvvid",window.permutive.config.viewId),window.permutive.config.workspaceId&&window.googletag.pubads().setTargeting("prmtvwid",window.permutive.config.workspaceId)}})}}sendEvent(e,t){window.permutive&&window.permutive.track(e,t)}getEventData(e,t,r,i){var n=sr({},r),o=new Mt(e);for(var a in t.forEach(e=>{try{var t=o.lookup(e);""!==t&&t.length>0&&(n[e]=t)}catch(e){console.error("GlobalDataFormatter error in tags.Permutive",e)}}),i&&(n=sr(sr({},n),i)),or)a in n&&(n[or[a]]=n[a],delete n[a]);return n}}function dr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ur extends Dt{constructor(e,t,r,i,n){super(t,r,i,n),dr(this,"commonAttrs",[]),this.data=e}handle(){var e=new lr,t=this.getProviderAttributesList("permutive",this.commonAttrs),r=this.getProviderCustomData("permutive"),i=e.getEventData(this.metaProperties,t,this.data,r);"page-load"!==this.action&&this.type&&e.sendEvent(this.type,i)}}class mr extends Dt{static should_skip_event_trigger(e,t){var r=t?t.target:void 0;return!(e!==w.a.click||!r||"true"!==r.getAttribute("data-evt-skip-click"))}handle(e){if(!mr.should_skip_event_trigger(this.action,e)){var t=this.getGeneralAttributesList(),r=new Mt(this.metaProperties),i={};t.forEach(t=>{try{var n=r.lookup(t,e);""!==n&&void 0!==n&&(i[t]=n)}catch(e){console.error("GlobalDataFormatter error in class Default",e)}});var n=this.getControlFields();if(n.mparticle){var o=new Kt(i,this.type,this.value,this.action,this.element);o.setMetaProperties(this.metaProperties),o.handle(e)}if(n.gtm){var a=new qt(i,this.type,this.value,this.action,this.element);a.setMetaProperties(this.metaProperties),a.handle()}if(n.permutive){var s=new ur(i,this.type,this.value,this.action,this.element);s.setMetaProperties(this.metaProperties),s.handle()}}}}var pr={currentPageViewPercentage(){var e=Math.round((window.innerHeight+window.pageYOffset)/document.body.scrollHeight*100);return Number.isFinite(e)?e>100?100:e:0},currentElementViewPercentage(e){var t=Math.round((window.innerHeight+window.pageYOffset)/(e.getBoundingClientRect().top+window.pageYOffset)*100);return Number.isFinite(t)?t>100?100:t:0}};function fr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function gr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fr(Object(r),!0).forEach((function(t){hr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function hr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class vr extends Dt{constructor(e,t,r,i){super(e,t,r,i),this.type=e,this.value=t,this.action=r,this.element=i,this.setScrollTrackConfig(),this.maxPageViewPercentage=0,this.maxStoryViewPercentage=0,this.startTime=Date.now(),(this.shouldTrackPageViewPercentage||this.shouldTrackStoryViewPercentage)&&document.addEventListener(w.a.scroll,this.scrollListner.bind(this))}handle(e){var t=this.getGeneralAttributesList(),r=this.shouldTrackPageViewPercentage?{[dt.PAGEVIEW_PRCNT]:this.maxPageViewPercentage}:{},i=this.shouldTrackStoryViewPercentage?{[dt.STORYVIEW_PRCNT]:this.maxStoryViewPercentage}:{},n={[dt.ACTIVE_TIME_ON_PAGE]:this.startTime},o=gr(gr(gr({},r),i),n),a=gr(gr({},this.metaProperties),{},{scrollData:o}),s=new Mt(a),c={};if(t.forEach(t=>{try{var r=s.lookup(t,e);""!==r&&(c[t]=r)}catch(e){console.error("GlobalDataFormatter error in class PageScroll",e)}}),this.getControlFields().mparticle){var l=new Kt(c,this.type,this.value,this.action,this.element);l.setMetaProperties(a),l.handle(e)}}setScrollTrackConfig(){var e=[...this.getGeneralAttributesList(),...this.getProviderAttributesList("mparticle",[])];this.shouldTrackPageViewPercentage=e.includes(dt.PAGEVIEW_PRCNT)||e.includes(dt.PAGEVIEW_PRCNT_DEPRECATED),this.shouldTrackStoryViewPercentage=e.includes(dt.STORYVIEW_PRCNT)||e.includes(dt.STORYVIEW_PRCNT_DEPRECATED)}scrollListner(){if(this.shouldTrackPageViewPercentage){var e=pr.currentPageViewPercentage();e>this.maxPageViewPercentage&&(this.maxPageViewPercentage=e)}if(this.shouldTrackStoryViewPercentage&&this.element){var t=pr.currentElementViewPercentage(this.element);t>this.maxStoryViewPercentage&&(this.maxStoryViewPercentage=t)}}}class br extends Dt{constructor(e,t,r,i){super(e,t,r,i),this.type=e,this.value=t,this.action=r,this.element=i,this.observer=void 0}getObserver(){return this.observer}handle(e){var t=this.getGeneralAttributesList(),r=new Mt(this.metaProperties),i={};if(t.forEach(t=>{try{var n=r.lookup(t,e);""!==n&&(i[t]=n)}catch(e){console.error("GlobalDataFormatter error in class Visible",e)}}),this.getControlFields().mparticle){var n=new Kt(i,this.type,this.value,this.action,this.element);n.setMetaProperties(this.metaProperties),n.handle(e)}}observerHandler(e){1===e.intersectionRatio&&this.observer&&(this.handle(e),this.observer.unobserve(e.target),this.removeEventListener())}addEventListener(){this.element&&(this.observer=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(this.observerHandler(e),this.observer&&this.observer.unobserve(e.target))})},{threshold:1}),this.observer.observe(this.element))}removeEventListener(){this.observer&&(this.observer.disconnect(),this.observer=void 0)}}var yr=["event_name","action"];function wr(e,t){if(null==e)return{};var r,i,n=function(e,t){if(null==e)return{};var r,i,n={},o=Object.keys(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)r=o[i],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Er(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Sr extends i.a{constructor(){super(...arguments),Er(this,"mparticle",new Pt),Er(this,"processedElements",[])}initialize(e,t,r,i,n,o){this.meta=i,this.conf=n,e.isDev=o||e.isDev,this.mparticle.initialize(e,t),this.bindEvents(r),this.bindCustomEvent(),this.bindUserAttributeChangeEvent()}update(e){wt(e),"profile"in this.conf&&(this.conf.profile=e)}getEventByType(e,t,r,i){if(r===w.a.BEFORE_UNLOAD)switch(e.toLocaleLowerCase()){case A.a.scrollEventTypes.pageScroll:return new vr(e,t,r,i);default:return new mr(e,t,r,i)}else if("visible"===r)return new br(e,t,r,i);return new mr(e,t,r,i)}bindEvents(e){var t=this,r=e.filter(e=>-1===this.processedElements.indexOf(e.element));this.processedElements=this.processedElements.concat(e.map(e=>e.element));var i=function(e){e instanceof mr||e instanceof vr?e.setMetaProperties(t.conf):e instanceof br?(e.setMetaProperties(t.conf),e.addEventListener()):e instanceof Dt&&e.setMetaProperties(t.meta),A.a.ACTION_PAGE_LOAD===e.action?e.handle():e.action===w.a.click?e.element.addEventListener(w.a.click,t=>e.handle(t)):e.action===w.a.scroll?document.addEventListener(w.a.scroll,e.handle.bind(e)):e.action===w.a.BEFORE_UNLOAD?window.addEventListener(w.a.PAGE_HIDE,e.handle.bind(e)):e.action===w.a.FOCUS_IN&&e.element.addEventListener(w.a.FOCUS_IN,e.handle.bind(e),{once:!0})};for(var n of r)i(n)}bindCustomEvent(){document.addEventListener(w.a.CUSTOM_EVENT,e=>{if(e.detail.event_name){var t=e.detail,{event_name:r,action:i}=t,n=wr(t,yr),o=new mr(r,JSON.stringify(n),i||"");o.setMetaProperties(this.conf),o.handle()}else console.warn("Analytics Adapter: missing event_name in the custom event")},!1)}bindUserAttributeChangeEvent(){document.addEventListener(w.a.USER_ATTRIBUTE_CHANGE,e=>{if(e.detail.action){var{action:t,key:r,value:i}=e.detail,n=new bt;"set"===t&&n.setUserAttribute(r,i)}else console.warn("Analytics Adapter: missing key in the custom user attribute change event")},!1)}}class Or{initialize(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(window.FCObject="fc",!window.fc&&""!==e){var t=window;t.fc=t.fc||function(){(t.fc.q=t.fc.q||[]).push(arguments)};var r=document.createElement("script"),i=document.getElementsByTagName("script")[0];r.setAttribute("id","fc"),r.src="https://tags.fullcontact.com/anon/fullcontact.js",r.setAttribute("async",""),i&&i.parentNode.insertBefore(r,i)}var n={callback:e=>{e&&(window.pid=e,document.dispatchEvent(new CustomEvent(f.a.SET_PERSON_ID,{detail:{pid:e}})))},forceCallback:!0};window.fc("init",e,n)}}class _r{init(e){var t;(t=t||[]).push({c1:"2",c2:e}),w.b.loadScript("//sb.scorecardresearch.com/beacon.js")}}var Ir=r(28);function Ar(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}function Tr(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){Ar(o,i,n,a,s,"next",e)}function s(e){Ar(o,i,n,a,s,"throw",e)}a(void 0)}))}}class Pr extends Ir.a{init(e){var t=this,r=!1;window.addEventListener(f.a.ENVELOP_MODULE_READY,()=>{r=!0;var e=localStorage.getItem("fcHashedData");if(e){var t=JSON.parse(e);t.data.length>0&&(this.setAdditionalData(t.data),r=!1)}}),document.addEventListener(f.a.SET_PERSON_ID,e=>{if(e.detail.pid){var i="",n=localStorage.getItem("fcHashedData");if(n)i=JSON.parse(n).pid;e.detail.pid!==i&&this.getHashedData(e.detail.pid).then(function(){var i=Tr((function*(i){if(i.length>0){var n={data:i,pid:e.detail.pid};localStorage.setItem("fcHashedData",JSON.stringify(n)),r&&t.setAdditionalData(i)}}));return function(e){return i.apply(this,arguments)}}()).catch(e=>{console.log("Unable to update Hashed Data:",e)})}}),this.loadScript(e)}loadScript(e){w.b.loadScript(e,[{key:"defer",value:""}])}getHashedData(e){return Tr((function*(){if(e){var t=document.querySelector("[name=csrfmiddlewaretoken]"),r=t?t.value:"";return Pr.postData("/api-root/subscription/identity/fc_hashed_data/",{pid:e},r)}return[]}))()}setAdditionalData(e){e.forEach(e=>{e.length>0&&window.atsenvelopemodule.setAdditionalData({id:e,type:"emailHashes"})})}}class Cr{init(e){if(e.gtm&&e.gtm.length>0){var t=new Ut;e.gtm.forEach(e=>{t.init(e)})}e.comScore&&(new _r).init(e.comScore);if(e.gtm_params&&e.gtm_params.html&&e.gtm_params.html.container_id){var r=new Ut("gtm_data_layer"),i=e.gtm_params.html;r.init(i.container_id,i.auth,i.env)}e.fullContact&&(new Or).initialize(e.fullContact);this.initializePermutive(e),this.initializeLiveRamp(e)}initializePermutive(e,t){if(void 0===this.permutive&&e.permutive&&e.permutive.organization_id){this.permutive=new lr;var r=e.permutive;this.permutive.init(r.organization_id,r.workspace_id,r.workspace_api_key),this.permutive.sendPageViewEvent(t)}}initializeLiveRamp(e){void 0===this.liveRamp&&e.live_ramp&&(this.liveRamp=new Pr,this.liveRamp.init(e.live_ramp))}}function Rr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class kr extends nt.a{constructor(){super(...arguments),Rr(this,"articleLimitAlert",!1)}get bannerButton(){return document.querySelector(".".concat(kr.DOM.className.button))}get banner(){return document.querySelector(".".concat(kr.DOM.className.banner))}get checkConsentGiven(){return!!(this.consentState&&this.consentState.getGDPRConsentState().ad_targeting&&this.consentState.getGDPRConsentState().personalization&&this.consentState.getCCPAConsentState())&&(console.debug("CONSENT: already given"),!0)}initialize(){addEventListener(f.a.PROVIDER_ID_ASSIGNED,e=>{e.detail.mpId&&(this.consentState=window.mParticle.Identity.getCurrentUser().getConsentState(),this.checkConsentGiven||(this.showBanner(),this.listenForConsent()))}),addEventListener("articleLimitAlertEvent",e=>{e&&e.detail&&(this.articleLimitAlert=!!e.detail.limit,this.labelBannerDisplayVariant())})}listenForConsent(){this.bannerButton&&this.bannerButton.addEventListener("click",this.handleButton.bind(this))}stoplisteningForConsent(){this.bannerButton&&this.bannerButton.removeEventListener("click",this.handleButton.bind(this))}handleButton(){this.generateConsentState(),this.hideBanner(),this.stoplisteningForConsent()}showBanner(){}hideBanner(){this.banner&&this.banner.setAttribute("hidden","")}labelBannerDisplayVariant(){this.articleLimitAlert?this.banner.classList.add(kr.DOM.className.variant):this.banner.classList.remove(kr.DOM.className.variant)}generateConsentState(){var e=Date.now(),t=window.location.href,r="FEM_banner_notification",i=window.mParticle.Consent.createConsentState(),n=window.mParticle.Identity.getCurrentUser(),o=window.mParticle.Consent.createGDPRConsent(!0,e,r,t),a=window.mParticle.Consent.createGDPRConsent(!0,e,r,t),s=window.mParticle.Consent.createCCPAConsent(!0,e,r,t);i.addGDPRConsentState("ad_targeting",o),i.addGDPRConsentState("personalization",a),i.setCCPAConsentState(s),n.setConsentState(i),console.debug("CONSENT: created for user")}}Rr(kr,"DOM",{className:{banner:"consent__banner",button:"consent__button",variant:"consent__banner--with-article-limit"}});var Dr=[1,5];class jr extends nt.a{initialize(e,t,r,i){!0===t&&!0===r?addEventListener(f.a.MP_READY,e=>{e.detail.mpSessionUuid&&this.countUserVisits(e.detail.mpSessionUuid,i)}):document.cookie="visitsCounter=; max-age=0; path=/",!0===t&&e&&this.updateViewedArticles(e)}countUserVisits(e,t){var r=Date.now(),i="",n=0;try{var o=(document.cookie.split(";").find(e=>e.trim().startsWith("visitsCounter="))||"").trim().split("=").pop()||"{}",a=JSON.parse(o);r=Number(a.fistVisitTime)||Date.now(),n=Number(a.visitsCount)||0,i=a.lastSessionUUID||""}catch(e){}if(i!==e){var s={firstVisitTime:r,lastSessionUUID:e,visitsCount:n+1};Dr.includes(s.visitsCount)&&void 0===t&&document.dispatchEvent(new CustomEvent(f.a.OPEN_RECOMMENDATION_MODAL));document.cookie="visitsCounter=".concat(JSON.stringify(s),"; max-age=").concat(31536e3,"; path=/")}}updateViewedArticles(e){var t=JSON.parse(window.localStorage.getItem(_.a.VIEWED_ARTICLES))||[],r=!1,i=new Date,n=[];for(var o of t){new Date(o.expTs)>i&&(n.push(o),o.id===e&&(r=!0))}if(!r){var a=i;a.setMonth(a.getMonth()+1);var s={expTs:a.valueOf(),id:e};n.length>=100&&n.shift(),n.push(s)}window.localStorage.setItem(_.a.VIEWED_ARTICLES,JSON.stringify(n))}}function Mr(e,t,r,i,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(i,n)}var Lr=e=>{Object(y.e)(y.a.PAGE_LOAD),Object(y.b)("debug","".concat(y.a.PAGE_LOAD," - initPage called")),Object(y.d)(y.a.PAGE_LOAD);var t=new Ee(new u(e),new Se.a(et.getInstance(e),rt,new Me(m)),new ct,new lt.a,new kr,new jr,new A.a(new Sr,new Cr),new T.a);return t.init().catch(e=>{Object(y.b)("error","initPage failed: ",e)}),t},Nr=function(){var e,t=(e=function*(e){var t=new u(e),r=new Se.a(et.getInstance(t),rt,new Me(m));return yield r.getTargeting({ancestry:t.ads.ancestry,articleId:t.page.articleId,bidding:t.ads.bidding,hub:t.ads.hub,negative:t.page.klangoo?t.page.klangoo.negativeKeywords:void 0,network:t.ads.network,originId:t.page.originId,page:t.ads.type,pageConfig:t.page,property:t.ads.property,provider:t.ads.provider,refresh:t.ads.refresh,sensitive:t.page.klangoo?t.page.klangoo.sensitiveContent:void 0,siteId:t.ads.site,spoke:t.ads.spoke,topics:t.ads.topics,verifier:t.ads.verifier,writers:t.page.writers}).catch(e=>(Object(y.b)("error","video ad targeting error - getTargeting: ".concat(e)),{}))},function(){var t=this,r=arguments;return new Promise((function(i,n){var o=e.apply(t,r);function a(e){Mr(o,i,n,a,s,"next",e)}function s(e){Mr(o,i,n,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}()}])}));
//# sourceMappingURL=fem.js.map</script>
</body>
</html>
