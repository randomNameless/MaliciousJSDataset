/* VimeoPlayer - v4.39.28 - 2024-12-04 - https://player.vimeo.com/NOTICE.txt */
var e=Object.prototype;function t(t){var n=t&&t.constructor;return t===("function"==typeof n&&n.prototype||e)}function n(e,t){return function(n){return e(t(n))}}var r=n(Object.keys,Object),i=Object.prototype.hasOwnProperty;function o(e){if(!t(e))return r(e);var n=[];for(var o in Object(e))i.call(e,o)&&"constructor"!=o&&n.push(o);return n}var s="object"==typeof global&&global&&global.Object===Object&&global,a="object"==typeof self&&self&&self.Object===Object&&self,u=s||a||Function("return this")(),c=u.Symbol,l=Object.prototype,d=l.hasOwnProperty,h=l.toString,f=c?c.toStringTag:void 0,p=Object.prototype.toString,_=c?c.toStringTag:void 0;function m(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":_&&_ in Object(e)?function(e){var t=d.call(e,f),n=e[f];try{e[f]=void 0;var r=!0}catch(kh){}var i=h.call(e);return r&&(t?e[f]=n:delete e[f]),i}(e):function(e){return p.call(e)}(e)}function v(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function g(e){if(!v(e))return!1;var t=m(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}var y=u["__core-js_shared__"],E=function(){var e=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),T=Function.prototype.toString;function S(e){if(null!=e){try{return T.call(e)}catch(kh){}try{return e+""}catch(kh){}}return""}var b=/^\[object .+?Constructor\]$/,A=Function.prototype,w=Object.prototype,R=A.toString,I=w.hasOwnProperty,k=RegExp("^"+R.call(I).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function P(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!v(e)||function(e){return!!E&&E in e}(e))&&(g(e)?k:b).test(S(e))}(n)?n:void 0}var D=P(u,"DataView"),O=P(u,"Map"),L=P(u,"Promise"),C=P(u,"Set"),N=P(u,"WeakMap"),M=S(D),x=S(O),U=S(L),F=S(C),j=S(N),V=m;(D&&"[object DataView]"!=V(new D(new ArrayBuffer(1)))||O&&"[object Map]"!=V(new O)||L&&"[object Promise]"!=V(L.resolve())||C&&"[object Set]"!=V(new C)||N&&"[object WeakMap]"!=V(new N))&&(V=function(e){var t=m(e),n="[object Object]"==t?e.constructor:void 0,r=n?S(n):"";if(r)switch(r){case M:return"[object DataView]";case x:return"[object Map]";case U:return"[object Promise]";case F:return"[object Set]";case j:return"[object WeakMap]"}return t});var B=V;function H(e){return null!=e&&"object"==typeof e}function X(e){return H(e)&&"[object Arguments]"==m(e)}var q=Object.prototype,W=q.hasOwnProperty,G=q.propertyIsEnumerable,K=X(function(){return arguments}())?X:function(e){return H(e)&&W.call(e,"callee")&&!G.call(e,"callee")},Y=Array.isArray;function $(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function z(e){return null!=e&&$(e.length)&&!g(e)}var Q="object"==typeof exports&&exports&&!exports.nodeType&&exports,J=Q&&"object"==typeof module&&module&&!module.nodeType&&module,Z=J&&J.exports===Q?u.Buffer:void 0,ee=(Z?Z.isBuffer:void 0)||function(){return!1},te={};function ne(e){return function(t){return e(t)}}te["[object Float32Array]"]=te["[object Float64Array]"]=te["[object Int8Array]"]=te["[object Int16Array]"]=te["[object Int32Array]"]=te["[object Uint8Array]"]=te["[object Uint8ClampedArray]"]=te["[object Uint16Array]"]=te["[object Uint32Array]"]=!0,te["[object Arguments]"]=te["[object Array]"]=te["[object ArrayBuffer]"]=te["[object Boolean]"]=te["[object DataView]"]=te["[object Date]"]=te["[object Error]"]=te["[object Function]"]=te["[object Map]"]=te["[object Number]"]=te["[object Object]"]=te["[object RegExp]"]=te["[object Set]"]=te["[object String]"]=te["[object WeakMap]"]=!1;var re="object"==typeof exports&&exports&&!exports.nodeType&&exports,ie=re&&"object"==typeof module&&module&&!module.nodeType&&module,oe=ie&&ie.exports===re&&s.process,se=function(){try{return ie&&ie.require&&ie.require("util").types||oe&&oe.binding&&oe.binding("util")}catch(kh){}}(),ae=se&&se.isTypedArray,ue=ae?ne(ae):function(e){return H(e)&&$(e.length)&&!!te[m(e)]},ce=Object.prototype.hasOwnProperty;function le(e){if(null==e)return!0;if(z(e)&&(Y(e)||"string"==typeof e||"function"==typeof e.splice||ee(e)||ue(e)||K(e)))return!e.length;var n=B(e);if("[object Map]"==n||"[object Set]"==n)return!e.size;if(t(e))return!o(e).length;for(var r in e)if(ce.call(e,r))return!1;return!0}const de={MANIFEST:"manifest",SEGMENT:"segment"},he={method:"GET",async:!0,retry:0,throwHttpErrors:!0,headers:{},hooks:{beforeRequest:[],beforeRetry:[],afterResponse:[]},validateStatus:function(e){return e>=200&&e<300},retryStatus:function(e){return[408,413,429].includes(e)||e>=500&&e<600}};function fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pe(e,t,n){return t&&fe(e.prototype,t),n&&fe(e,n),e}function _e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){_e(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ge(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function ye(e){return(ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ee(e,t){return(Ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Te(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(kh){return!1}}function Se(e,t,n){return(Se=Te()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&Ee(i,n.prototype),i}).apply(null,arguments)}function be(e){var t="function"==typeof Map?new Map:void 0;return(be=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return Se(e,arguments,ye(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Ee(n,e)})(e)}function Ae(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function we(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Re(e){return function(e){if(Array.isArray(e))return ke(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Ie(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ie(e,t){if(e){if("string"==typeof e)return ke(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ke(e,t):void 0}}function ke(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Pe(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=Ie(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function De(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}function Oe(e,t,n){var r=t.get(e);if(!r)throw new TypeError("attempted to set private field on non-instance");if(r.set)r.set.call(e,n);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=n}return n}function Le(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}function Ce(e){return e.filter((e,t,n)=>n.indexOf(e)===t)}function Ne(e,t){return e.reduce((e,n,r,i)=>e.concat(t(n,r,i)),[])}function Me(e){return(t,...n)=>(n.forEach(n=>{for(const r in n){const i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,Object.assign(i,e))}}),t)}const xe=Me({enumerable:!1,configurable:!0,writeable:!1}),Ue=Me({enumerable:!1,configurable:!1,writeable:!1}),Fe=Me({enumerable:!0,configurable:!0,writeable:!1}),je=e=>new Promise((t,n)=>setTimeout(t,e));function Ve(e){e.substring(0,e.lastIndexOf("/")+1)}const Be=e=>new Promise((t,n)=>{const r=document.createElement("script");r.src=e,r.addEventListener("load",t),r.addEventListener("error",e=>n(e.error)),document.head.appendChild(r)}),He=e=>Math.pow(e,2),Xe=e=>Math.sqrt(e),qe=(e,t)=>(...n)=>{[`%c${e}`,t].concat(n)};function We(e,...t){return t.reduce((e,t)=>(Object.keys(t||{}).forEach(n=>{const r=e[n],i=t[n];r&&void 0===i||(Array.isArray(i)?e[n]=(r||[]).concat(i):(e=>e&&"object"==typeof e)(i)?e[n]=We({},r,i):e[n]=i)}),e),e)}const Ge=void 0!==window.ManagedMediaSource?window.ManagedMediaSource:window.MediaSource;function Ke(){let e,t,n=new Promise((function(n,r){e=n,t=r}));return n.resolve=e,n.reject=t,n}function Ye(e,t){if(!t||!t.length)return 0;if(1===t.length&&t.end(0)-t.start(0)<1e-6)return 0;let n=0;for(let r=t.length-1;r>=0&&t.end(r)>e;--r)n+=t.end(r)-Math.max(t.start(r),e);return n}function $e(e,t){let n=e;for(let r=0;r<t.length;r++)if(t.start(r)<=e&&t.end(r)>=e){n=t.end(r);break}return n-e}function ze(){return void 0!==window.performance&&"function"==typeof window.performance.now?window.performance.now():Date.now()}function Qe(){return Math.trunc(ze()/1e3)}function Je(e){return Qe()-e}function Ze(e){return ze()-e}const et=e=>Math.trunc(Date.now()/1e3)-e;function tt(e){if("object"!=typeof e)return"";let t=[];for(let n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.length?t.join("&"):""}function nt(e){return"string"!=typeof e?{}:e.replace("?","").split("&").reduce((e,t)=>{if(t.length>0){const n=t.substring(0,t.indexOf("=")),r=t.substring(t.indexOf("=")+1);e[n]=decodeURIComponent(r)}return e},{})}function rt(e){const t=document.createElement("a");return t.href=e,t}function it(e,t){const n=tt(t);let r=-1===e.indexOf("?")?"?":"&";return`${e}${n?`${r}${n}`:""}`}function ot(e){const t=e.split("://");if(2!==t.length)return null;const n=t[1].split("/");if(n.length>1)return n[0];const r=t[1].split("?");if(r.length>1)return r[0];const i=t[1].split("#");return i.length>1?i[0]:t[1]}function st(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^16*Math.random()>>e/4).toString(16))}function at(e,t){this.headers={},this.perfTimings={},We(this,t),this.ok=2==(this.status/100|0),this.body=e,this.text=()=>Promise.resolve(e),this.json=()=>Promise.resolve(JSON.parse(e)),this.blob=()=>Promise.resolve(new Blob([e])),this.arrayBuffer=()=>Promise.resolve(e),this.clone=()=>new at(e,this),this.isVimeoResponse=!0}let ut=function(e){function t(){var t;return(t=e.call(this,"The operation was aborted.")||this).name="AbortError",t}return ge(t,e),t}(be(Error)),ct=function(e){function t(t){var n;return(n=e.call(this,t.statusText)||this).name="HTTPError",n.response=t,n}return ge(t,e),t}(be(Error)),lt=function(e){function t(){var t;return(t=e.call(this,"A network error occurred.")||this).name="NetworkError",t}return ge(t,e),t}(be(Error)),dt=function(e){function t(t){var n;return(n=e.call(this,"Request timed out.")||this).name="TimeoutError",n.timeoutMs=t,n}return ge(t,e),t}(be(Error));function ht(e,t){let{url:n,method:r,body:i,onDownloadProgress:o}=e,s=100;return new Promise((function(a,u){const c=t?new t:new XMLHttpRequest,l=window.performance;c.open(r.toUpperCase(),n,e.async),e.timeout&&(c.timeout=e.timeout),c.onload=function(){if(0===c.status&&(!c.responseURL||0!==c.responseURL.indexOf("file:")))return;const e={};c.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(t,n,r)=>{e[n]=e[n]?`${e[n]},${r}`:r});let t={};if(window.performance&&void 0!==window.performance.getEntriesByType){const e=window.performance.getEntriesByType("resource");if(e.length&&e.length>=s&&("function"==typeof l.clearResourceTimings&&l.clearResourceTimings(),"function"==typeof l.setResourceTimingBufferSize&&(l.setResourceTimingBufferSize(500),s=500)),e.length){const n=e.filter(e=>e.name===c.responseURL).sort((e,t)=>e.connectStart-t.connectStart);n.length&&(t=n[n.length-1].toJSON())}}a(new at(c.response,{headers:e,statusText:c.statusText,status:c.status,url:c.responseURL,perfTimings:t}))},c.onabort=function(){u(new ut)},c.onerror=function(){u(new lt)},c.ontimeout=function(){u(new dt(e.timeout))},"function"==typeof o&&c.addEventListener("progress",o);for(let t in e.headers)c.setRequestHeader(t,e.headers[t]);e.withCredentials&&(c.withCredentials=!0),e.responseType&&(c.responseType=e.responseType),e.abort=c.abort.bind(c),c.send(i||null)}))}function ft(){}function pt(e,t,n){if(!e.s){if(n instanceof _t){if(!n.s)return void(n.o=pt.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(pt.bind(null,e,t),pt.bind(null,e,2));e.s=t,e.v=n;const r=e.o;r&&r(e)}}const _t=function(){function e(){}return e.prototype.then=function(t,n){const r=new e,i=this.s;if(i){const e=1&i?t:n;if(e){try{pt(r,1,e(this.v))}catch(kh){pt(r,2,kh)}return r}return this}return this.o=function(e){try{const i=e.v;1&e.s?pt(r,1,t?t(i):i):n?pt(r,1,n(i)):pt(r,2,i)}catch(kh){pt(r,2,kh)}},r},e}();function mt(e){return e instanceof _t&&1&e.s}function vt(e){const t=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(kh){return Promise.reject(kh)}}}((function(r){return function(e,t){try{var n=e()}catch(kh){return t(kh)}return n&&n.then?n.then(void 0,t):n}(r,(function(i){let o=!1;n++;const s=function(t){if(!e.retryAbortErrors&&t instanceof ut)return 0;if(t instanceof dt)return 0;if(n>=e.retry)return 0;if(t instanceof ct){if(!e.retryStatus(t.response.status))return 0;const n=t.response.headers["retry-after"];if(n&&e.retryStatus(t.response.status)){let e=Number(n);return isNaN(e)?e=Date.parse(n)-Date.now():e*=1e3,e}if(413===t.response.status)return 0}return.3*2**(n-1)*1e3}(i);return function(a,u){var c=function(){if(0!==s&&n>0)return function(e,t,n){return e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e}(je(s),(function(){const s=e.hooks.beforeRetry||[];return function(e,t){return e&&e.then?e.then(t):t()}(function(e,t,n){var r,i,o=-1;return function n(s){try{for(;++o<e.length;)if((s=t(o))&&s.then){if(!mt(s))return void s.then(n,i||(i=pt.bind(null,r=new _t,2)));s=s.v}r?pt(r,1,s):r=s}catch(kh){pt(r||(r=new _t),2,kh)}}(),r}(s,(function(t){return function(e,t){return e&&e.then?e.then(ft):Promise.resolve()}((0,s[t])(e,i,n))})),(function(){return o=!0,t(r)}))}))}();return c&&c.then?c.then(u):u(c)}(0,(function(t){if(o)return t;if(e.throwHttpErrors)throw i}))}))}));let n=0;return t}function gt(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function yt(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(kh){return Promise.reject(kh)}}}function Et(e,t,n){if(!e.s){if(n instanceof Tt){if(!n.s)return void(n.o=Et.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(Et.bind(null,e,t),Et.bind(null,e,2));e.s=t,e.v=n;const r=e.o;r&&r(e)}}const Tt=function(){function e(){}return e.prototype.then=function(t,n){const r=new e,i=this.s;if(i){const e=1&i?t:n;if(e){try{Et(r,1,e(this.v))}catch(kh){Et(r,2,kh)}return r}return this}return this.o=function(e){try{const i=e.v;1&e.s?Et(r,1,t?t(i):i):n?Et(r,1,n(i)):Et(r,2,i)}catch(kh){Et(r,2,kh)}},r},e}();function St(e){return e instanceof Tt&&1&e.s}function bt(e,t,n){var r,i,o=-1;return function s(a){try{for(;++o<e.length&&(!n||!n());)if((a=t(o))&&a.then){if(!St(a))return void a.then(s,i||(i=Et.bind(null,r=new Tt,2)));a=a.v}r?Et(r,1,a):r=a}catch(kh){Et(r||(r=new Tt),2,kh)}}(),r}function At(e,t){return e&&e.then?e.then(t):t(e)}const wt=["get","post","put","patch","head","delete"],Rt={json:"application/json",text:"text/plain",arrayBuffer:"*/*",blob:"*/*"},It=["get"];function kt(e,t){const n=yt((function(){let e=!1,n=!1;const r=t.hooks.beforeRequest||[];return At(bt(r,(function(i){return gt((0,r[i])(t),(function(r){return r instanceof Pt?(t=r,void(n=!0)):(null==r?void 0:r.isVimeoResponse)?(e=!0,Promise.resolve(r).then(Dt(t))):void 0}))}),(function(){return n||e})),(function(n){return e?n:ht(t).then(Dt(t))}))}));t=new Pt(e,t);const{method:r,json:i,jwt:o,searchParams:s}=t;if(i&&(t.headers["Content-Type"]=Rt.json,t.body=JSON.stringify(i)),o&&(t.headers.Authorization=`jwt ${o}`),s){const[e,n]=t.url.split("?");t.url=it(e,ve(ve({},nt(n)),s))}const a=-1!==It.indexOf(r.toLowerCase())?vt(t)(n):n();for(const u in Rt)a[u]=yt((function(){return t.headers["Content-Type"]=Rt[u],gt(a,(function(e){return e.clone()[u]()}))}));return function e(t,n){const r=t.then.bind(t);return Object.assign(t,{abort:n,then:(...t)=>e(r.apply(void 0,t),n)})}(a,()=>t.abort())}function Pt(e,t){We(this,he,e="string"==typeof e?{url:e}:e,t)}function Dt(e){const{validateStatus:t,throwHttpErrors:n,hooks:r}=e;return yt((function(i){const o=r.afterResponse||[];return At(bt(o,(function(t){return gt((0,o[t])(e,i.clone()),(function(e){e instanceof at&&(i=e)}))})),(function(){if(!t||t(i.status))return i;if(n)throw new ct(i);return i}))}))}wt.forEach((function(e){return kt[e]=(t,n)=>kt(t,ve({method:e},n)),kt[e]}));const{get:Ot,post:Lt,put:Ct,patch:Nt,head:Mt}=kt,xt={ARRAY_BUFFER:"arraybuffer"};var Ut=Object.freeze({__proto__:null,ContentTypes:de,defaults:he,requestMethods:wt,responseTypes:Rt,retryMethods:It,request:kt,Request:Pt,get:Ot,post:Lt,put:Ct,patch:Nt,head:Mt,Response:at,ResponseTypes:xt,AbortError:ut,HTTPError:ct,NetworkError:lt,TimeoutError:dt,xhr:ht});const Ft=navigator.userAgent.toLowerCase(),jt=["googlebot","google-inspectiontool"];function Vt(e){e=e.toLowerCase();const t=new RegExp(e).test(Ft);return"safari"===e?t&&new RegExp("version").test(Ft):t}function Bt(e){const t=document.createElement("div"),n=e.charAt(0).toUpperCase()+e.slice(1),r=(e+" "+["Webkit","Moz","O","ms"].join(n+" ")+n).split(" ");for(let i in r){const e=r[i];if(void 0!==t.style[e])return e}return e}const Ht=!!Vt("android")&&(parseFloat(Ft.replace(/^.* android (\d+)\.(\d+).*$/,"$1.$2"))||!0),Xt=window.devicePixelRatio||1,qt=!(!Vt("windows phone")&&!Vt("iemobile"))&&(parseFloat(Ft.replace(/^.* windows phone (os )?(\d+)\.(\d+).*$/,"$2.$3"))||!0),Wt=!!Vt("msie")&&parseFloat(Ft.replace(/^.*msie (\d+).*$/,"$1")),Gt=!!Vt("trident")&&parseFloat(Ft.replace(/^.*trident\/(\d+)\.(\d+).*$/,"$1.$2"))+4,Kt=Vt("ipad;")||Vt("iphone;")||Vt("ipod touch;")?parseFloat(Ft.replace(/^.* os (\d+)_(\d+).*$/,"$1.$2")):navigator.userAgent.includes("Mac")&&"ontouchend"in document,Yt="MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,$t=Vt("opera")||Vt("opr"),zt=/^Mozilla\/5\.0 \(.* Mac OS X.*\(KHTML, like Gecko\)(?: Mobile\/[\S]*|)$/i.test(Ft),Qt=Vt("safari")&&Vt("apple")&&!Vt("chrome")&&!Vt("android");function Jt(e){if(!Qt)return!1;const t=e.split("."),n=function(){if(!Vt("safari"))return[];const e=Ft.split(" ").find((function(e){return/version\//.test(e)}));return e?e.replace("version/","").split(".").map((function(e){return parseInt(e,10)})):[]}();for(let r=0;r<3;r++){const e=parseInt(t[r],10)||0,i=n[r]||0;if(e<i)return!0;if(e>i)return!1}return!0}const Zt={autoplayPolicy:Jt("11"),hevc:Jt("11"),dolbyVision:Jt("14.1"),spatial:Jt("11.0.2"),fullscreenRequiresDataLoaded:Jt("17.2")},en={airPlay:"WebKitPlaybackTargetAvailabilityEvent"in window,android:Ht,appleMail:zt,hasAutoplayPolicy:Ht||Kt||Zt.autoplayPolicy||function(){if(!Vt("chrome"))return[];const e=Ft.split(" ").find((function(e){return Kt?/CriOS\//.test(e):/chrome\//.test(e)}));return e?e.replace("chrome/","").split(".").map((function(e){return parseInt(e,10)})):[]}()[0]>=66,iOS:Kt,iPadOS:Yt,mobileAndroid:Ht&&Vt("mobile"),browser:{bb10:Vt("bb10"),chrome:Vt("chrome"),firefox:Vt("firefox"),ie:Wt||Gt,edge:Vt("edge"),opera:$t,safari:Qt,chromium:"chrome"in window},devicePixelRatio:Xt,iPhone:Vt("iphone;")||Vt("ipod touch;")||Vt("ipod;"),iPad:Vt("ipad;"),iPadNonRetina:Vt("ipad;")&&Xt<2,mac:Vt("mac os"),pictureInPictureSupportType:function(){if("pictureInPictureEnabled"in document)return"pip-api";const e=document.createElement("video");return!("function"!=typeof e.webkitSetPresentationMode||!e.webkitSupportsPresentationMode("picture-in-picture"))&&"webkit-presentation-mode"}(),pointerEvents:window.navigator.pointerEnabled||window.navigator.msPointerEnabled||!1,passiveEvents:function(){let e=!1;try{const t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassive",null,t),window.removeEventListener("testPassive",null,t)}catch(kh){}return e}(),svg:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||Vt("windows phone")||window.navigator.maxTouchPoints>1||window.navigator.msMaxTouchPoints||!1,transformProperty:Bt("transform"),transitionProperty:Bt("transition"),webp:function(){const e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))&&0===e.toDataURL("image/webp").indexOf("data:image/webp")}(),windowsPhone:qt,mediaCapabilities:"mediaCapabilities"in navigator,isGoogleBot:(()=>{const e=Ft.toLowerCase();return jt.some(t=>e.includes(t))})(),storageAccessAPI:"requestStorageAccess"in document&&"hasStorageAccess"in document,clipboardAPI:"clipboard"in navigator&&"write"in navigator.clipboard,videoContentPreload:!Vt("iphone"),intersectionObserver:"IntersectionObserver"in window},tn=/mac os x 10_13/.test(Ft),nn=en.iOS&&en.iOS>=11,rn="undefined"!=typeof matchMedia&&(matchMedia("(color-gamut: p3)").matches&&screen.pixelDepth>24||matchMedia("(dynamic-range: high), (video-dynamic-range: high)").matches);function on(e="hvc1"){return void 0!==Ge?Ge.isTypeSupported(`video/mp4; codecs="${e}"`):Zt.hevc&&(tn||nn)}function sn(){return!(en.iOS||en.iPad||en.browser.ie||Vt("safari")&&!Zt.spatial)}function an(e){return"symbol"==typeof e||H(e)&&"[object Symbol]"==m(e)}en.hevc=on(),en.hevcMain10=on("hvc1.2.4.H150.90"),en.hdr=rn,en.dolbyVision=function(){let e=void 0!==Ge&&Ge.isTypeSupported('video/mp4; codecs="dvh1"');if(!e){const t=document.createElement("video");"canPlayType"in t&&(e="probably"===t.canPlayType('video/mp4; codecs="dvh1"'))}return!((Yt||en.iOS)&&!Zt.dolbyVision)&&e}(),en.vp9hdr=(window.matchMedia("(color-gamut: p3)").matches||window.matchMedia("(color-gamut: rec2020)").matches)&&screen.colorDepth>=48&&(Ge.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.00"')||Ge.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.01"')||Ge.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.00"')||Ge.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.01"')),en.av1=void 0!==Ge&&Ge.isTypeSupported('video/mp4; codecs="av01.0.31M.08.0.110.01.01.01.0"'),en.webvr=!!(window.navigator&&"getVRDisplays"in window.navigator),en.webxr=!!(window.navigator&&"xr"in window.navigator&&"supportsSession"in window.navigator.xr),en.spatialPlayback=sn(),en.spatialHEVC=!en.browser.safari&&sn()&&on(),en.stereoscopic=en.spatialPlayback&&en.mobileAndroid,en.fullscreenRequiresDataLoaded=en.iOS>=17||en.iPadOS&&Zt.fullscreenRequiresDataLoaded;var un=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,cn=/^\w*$/,ln=P(Object,"create"),dn=Object.prototype.hasOwnProperty,hn=Object.prototype.hasOwnProperty;function fn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function pn(e,t){return e===t||e!=e&&t!=t}function _n(e,t){for(var n=e.length;n--;)if(pn(e[n][0],t))return n;return-1}fn.prototype.clear=function(){this.__data__=ln?ln(null):{},this.size=0},fn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},fn.prototype.get=function(e){var t=this.__data__;if(ln){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return dn.call(t,e)?t[e]:void 0},fn.prototype.has=function(e){var t=this.__data__;return ln?void 0!==t[e]:hn.call(t,e)},fn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ln&&void 0===t?"__lodash_hash_undefined__":t,this};var mn=Array.prototype.splice;function vn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function gn(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function yn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function En(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function n(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(En.Cache||yn),n}vn.prototype.clear=function(){this.__data__=[],this.size=0},vn.prototype.delete=function(e){var t=this.__data__,n=_n(t,e);return!(n<0||(n==t.length-1?t.pop():mn.call(t,n,1),--this.size,0))},vn.prototype.get=function(e){var t=this.__data__,n=_n(t,e);return n<0?void 0:t[n][1]},vn.prototype.has=function(e){return _n(this.__data__,e)>-1},vn.prototype.set=function(e,t){var n=this.__data__,r=_n(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},yn.prototype.clear=function(){this.size=0,this.__data__={hash:new fn,map:new(O||vn),string:new fn}},yn.prototype.delete=function(e){var t=gn(this,e).delete(e);return this.size-=t?1:0,t},yn.prototype.get=function(e){return gn(this,e).get(e)},yn.prototype.has=function(e){return gn(this,e).has(e)},yn.prototype.set=function(e,t){var n=gn(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},En.Cache=yn;var Tn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Sn=/\\(\\)?/g,bn=function(e){var t=En((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Tn,(function(e,n,r,i){t.push(r?i.replace(Sn,"$1"):n||e)})),t}),(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}(),An=c?c.prototype:void 0,wn=An?An.toString:void 0;function Rn(e){if("string"==typeof e)return e;if(Y(e))return function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}(e,Rn)+"";if(an(e))return wn?wn.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function In(e){return null==e?"":Rn(e)}function kn(e,t){return Y(e)?e:function(e,t){if(Y(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!an(e))||cn.test(e)||!un.test(e)||null!=t&&e in Object(t)}(e,t)?[e]:bn(In(e))}function Pn(e){if("string"==typeof e||an(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Dn(e,t){for(var n=0,r=(t=kn(t,e)).length;null!=e&&n<r;)e=e[Pn(t[n++])];return n&&n==r?e:void 0}function On(e,t,n){var r=null==e?void 0:Dn(e,t);return void 0===r?n:r}var Ln="object"==typeof global&&global&&global.Object===Object&&global,Cn="object"==typeof self&&self&&self.Object===Object&&self,Nn=(Ln||Cn||Function("return this")()).Symbol,Mn=Object.prototype,xn=Mn.hasOwnProperty,Un=Mn.toString,Fn=Nn?Nn.toStringTag:void 0,jn=Object.prototype.toString,Vn=Nn?Nn.toStringTag:void 0;var Bn=function(e,t){return function(n){return e(t(n))}}(Object.getPrototypeOf,Object),Hn=Function.prototype,Xn=Object.prototype,qn=Hn.toString,Wn=Xn.hasOwnProperty,Gn=qn.call(Object),Kn=function(e){var t,n=("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()).Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}();function Yn(e,t,n){var r;if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(Yn)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var i=e,o=t,s=[],a=s,u=!1;function c(){a===s&&(a=s.slice())}function l(){return o}function d(e){if("function"!=typeof e)throw new Error("Expected listener to be a function.");var t=!0;return c(),a.push(e),function(){if(t){t=!1,c();var n=a.indexOf(e);a.splice(n,1)}}}function h(e){if(!function(e){if(!function(e){return null!=e&&"object"==typeof e}(e)||"[object Object]"!=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Vn&&Vn in Object(e)?function(e){var t=xn.call(e,Fn),n=e[Fn];try{e[Fn]=void 0;var r=!0}catch(kh){}var i=Un.call(e);return r&&(t?e[Fn]=n:delete e[Fn]),i}(e):function(e){return jn.call(e)}(e)}(e))return!1;var t=Bn(e);if(null===t)return!0;var n=Wn.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&qn.call(n)==Gn}(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(u)throw new Error("Reducers may not dispatch actions.");try{u=!0,o=i(o,e)}finally{u=!1}for(var t=s=a,n=0;n<t.length;n++)(0,t[n])();return e}return h({type:"@@redux/INIT"}),(r={dispatch:h,subscribe:d,getState:l,replaceReducer:function(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");i=e,h({type:"@@redux/INIT"})}})[Kn]=function(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(l())}return n(),{unsubscribe:t(n)}}})[Kn]=function(){return this},e},r}function $n(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}var zn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function Qn(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(n,r,i){var o,s=e(n,r,i),a=s.dispatch,u={getState:s.getState,dispatch:function(e){return a(e)}};return o=t.map((function(e){return e(u)})),a=$n.apply(void 0,o)(s.dispatch),zn({},s,{dispatch:a})}}}var Jn=new WeakMap,Zn=new WeakMap;let er=function(){function e(){Jn.set(this,{writable:!0,value:Object.create(null)}),Zn.set(this,{writable:!0,value:void 0}),_e(this,"eventNames",()=>Object.keys(De(this,Jn))),_e(this,"fire",(e,...t)=>{if(!e)throw new Error("Tried to fire an undefined event.");if(e in De(this,Jn)){const n=De(this,Jn)[e].slice(0);for(let e=0,r=n.length;e<r;e++)if(n[e].apply(this,t),De(this,Zn)){Oe(this,Zn,!1);break}}return this}),_e(this,"halt",()=>(Oe(this,Zn,!0),this)),_e(this,"on",(e,t,n)=>{const r=[].concat(e);for(let i=0,o=r.length;i<o;i++){const e=r[i];if(!e)throw new Error("Tried to listen for an undefined event.");De(this,Jn)[e]||(De(this,Jn)[e]=[]),n?De(this,Jn)[e].unshift(t):De(this,Jn)[e].push(t)}return this}),_e(this,"once",(e,t,n)=>{const r=(...n)=>{this.off(e,r),t.apply(this,n)};return r.handler=t,this.on(e,r,n)}),_e(this,"off",(e,t)=>{if(!e)return Oe(this,Jn,Object.create(null)),this;const n=[].concat(e);for(let r=0,i=n.length;r<i;r++){const e=n[r];if(!e)throw new Error("Tried to remove an undefined event.");if(e in De(this,Jn)){const n=De(this,Jn)[e];if(t){let r=n.indexOf(t);if(-1===r)for(let e=0,i=n.length;e<i;e++)if(n[e].handler===t){r=e;break}if(-1===r)return this;n.splice(r,1),0===n.length&&delete De(this,Jn)[e]}else delete De(this,Jn)[e]}}return this}),_e(this,"prependOn",(e,t)=>this.on(e,t,!0))}return e.extend=function(t){return Object.assign(t,new e),t},e}();function tr(e){var t=this.__data__=new vn(e);this.size=t.size}tr.prototype.clear=function(){this.__data__=new vn,this.size=0},tr.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},tr.prototype.get=function(e){return this.__data__.get(e)},tr.prototype.has=function(e){return this.__data__.has(e)},tr.prototype.set=function(e,t){var n=this.__data__;if(n instanceof vn){var r=n.__data__;if(!O||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new yn(r)}return n.set(e,t),this.size=n.size,this};var nr=function(){try{var e=P(Object,"defineProperty");return e({},"",{}),e}catch(kh){}}();function rr(e,t,n){"__proto__"==t&&nr?nr(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var ir=Object.prototype.hasOwnProperty;function or(e,t,n){var r=e[t];ir.call(e,t)&&pn(r,n)&&(void 0!==n||t in e)||rr(e,t,n)}function sr(e,t,n,r){var i=!n;n||(n={});for(var o=-1,s=t.length;++o<s;){var a=t[o],u=r?r(n[a],e[a],a,n,e):void 0;void 0===u&&(u=e[a]),i?rr(n,a,u):or(n,a,u)}return n}var ar=/^(?:0|[1-9]\d*)$/;function ur(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&ar.test(e))&&e>-1&&e%1==0&&e<t}var cr=Object.prototype.hasOwnProperty;function lr(e,t){var n=Y(e),r=!n&&K(e),i=!n&&!r&&ee(e),o=!n&&!r&&!i&&ue(e),s=n||r||i||o,a=s?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],u=a.length;for(var c in e)!t&&!cr.call(e,c)||s&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||ur(c,u))||a.push(c);return a}function dr(e){return z(e)?lr(e):o(e)}var hr=Object.prototype.hasOwnProperty;function fr(e){return z(e)?lr(e,!0):function(e){if(!v(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var n=t(e),r=[];for(var i in e)("constructor"!=i||!n&&hr.call(e,i))&&r.push(i);return r}(e)}var pr="object"==typeof exports&&exports&&!exports.nodeType&&exports,_r=pr&&"object"==typeof module&&module&&!module.nodeType&&module,mr=_r&&_r.exports===pr?u.Buffer:void 0,vr=mr?mr.allocUnsafe:void 0;function gr(e,t){if(t)return e.slice();var n=e.length,r=vr?vr(n):new e.constructor(n);return e.copy(r),r}function yr(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}function Er(){return[]}var Tr=Object.prototype.propertyIsEnumerable,Sr=Object.getOwnPropertySymbols,br=Sr?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s)&&(o[i++]=s)}return o}(Sr(e),(function(t){return Tr.call(e,t)})))}:Er;function Ar(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}var wr=n(Object.getPrototypeOf,Object),Rr=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Ar(t,br(e)),e=wr(e);return t}:Er;function Ir(e,t,n){var r=t(e);return Y(e)?r:Ar(r,n(e))}function kr(e){return Ir(e,dr,br)}function Pr(e){return Ir(e,fr,Rr)}var Dr=Object.prototype.hasOwnProperty,Or=u.Uint8Array;function Lr(e){var t=new e.constructor(e.byteLength);return new Or(t).set(new Or(e)),t}var Cr=/\w*$/,Nr=c?c.prototype:void 0,Mr=Nr?Nr.valueOf:void 0;function xr(e,t){var n=t?Lr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var Ur=Object.create,Fr=function(){function e(){}return function(t){if(!v(t))return{};if(Ur)return Ur(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function jr(e){return"function"!=typeof e.constructor||t(e)?{}:Fr(wr(e))}var Vr=se&&se.isMap,Br=Vr?ne(Vr):function(e){return H(e)&&"[object Map]"==B(e)},Hr=se&&se.isSet,Xr=Hr?ne(Hr):function(e){return H(e)&&"[object Set]"==B(e)},qr={};function Wr(e,t,n,r,i,o){var s,a=1&t,u=2&t,c=4&t;if(n&&(s=i?n(e,r,i,o):n(e)),void 0!==s)return s;if(!v(e))return e;var l=Y(e);if(l){if(s=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Dr.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!a)return yr(e,s)}else{var d=B(e),h="[object Function]"==d||"[object GeneratorFunction]"==d;if(ee(e))return gr(e,a);if("[object Object]"==d||"[object Arguments]"==d||h&&!i){if(s=u||h?{}:jr(e),!a)return u?function(e,t){return sr(e,Rr(e),t)}(e,function(e,t){return e&&sr(t,fr(t),e)}(s,e)):function(e,t){return sr(e,br(e),t)}(e,function(e,t){return e&&sr(t,dr(t),e)}(s,e))}else{if(!qr[d])return i?e:{};s=function(e,t,n){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return Lr(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return function(e,t){var n=t?Lr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return xr(e,n);case"[object Map]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return function(e){var t=new e.constructor(e.source,Cr.exec(e));return t.lastIndex=e.lastIndex,t}(e);case"[object Set]":return new r;case"[object Symbol]":return function(e){return Mr?Object(Mr.call(e)):{}}(e)}}(e,d,a)}}o||(o=new tr);var f=o.get(e);if(f)return f;o.set(e,s),Xr(e)?e.forEach((function(r){s.add(Wr(r,t,n,r,e,o))})):Br(e)&&e.forEach((function(r,i){s.set(i,Wr(r,t,n,i,e,o))}));var p=l?void 0:(c?u?Pr:kr:u?fr:dr)(e);return function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n););}(p||e,(function(r,i){p&&(r=e[i=r]),or(s,i,Wr(r,t,n,i,e,o))})),s}function Gr(e){return Wr(e,5)}function Kr(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function Yr(e){return e}qr["[object Arguments]"]=qr["[object Array]"]=qr["[object ArrayBuffer]"]=qr["[object DataView]"]=qr["[object Boolean]"]=qr["[object Date]"]=qr["[object Float32Array]"]=qr["[object Float64Array]"]=qr["[object Int8Array]"]=qr["[object Int16Array]"]=qr["[object Int32Array]"]=qr["[object Map]"]=qr["[object Number]"]=qr["[object Object]"]=qr["[object RegExp]"]=qr["[object Set]"]=qr["[object String]"]=qr["[object Symbol]"]=qr["[object Uint8Array]"]=qr["[object Uint8ClampedArray]"]=qr["[object Uint16Array]"]=qr["[object Uint32Array]"]=!0,qr["[object Error]"]=qr["[object Function]"]=qr["[object WeakMap]"]=!1;var $r=Math.max;function zr(e,t,n){return t=$r(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=$r(r.length-t,0),s=Array(o);++i<o;)s[i]=r[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=r[i];return a[t]=n(s),Kr(e,this,a)}}function Qr(e){return function(){return e}}var Jr=nr?function(e,t){return nr(e,"toString",{configurable:!0,enumerable:!1,value:Qr(t),writable:!0})}:Yr,Zr=Date.now,ei=function(e){var t=0,n=0;return function(){var r=Zr(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(Jr);function ti(e,t){return ei(zr(e,t,Yr),e+"")}function ni(e,t,n){(void 0===n||pn(e[t],n))&&(void 0!==n||t in e)||rr(e,t,n)}var ri=function(e,t,n){for(var r=-1,i=Object(e),o=n(e),s=o.length;s--;){var a=o[++r];if(!1===t(i[a],a,i))break}return e},ii=Function.prototype,oi=Object.prototype,si=ii.toString,ai=oi.hasOwnProperty,ui=si.call(Object);function ci(e){if(!H(e)||"[object Object]"!=m(e))return!1;var t=wr(e);if(null===t)return!0;var n=ai.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&si.call(n)==ui}function li(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function di(e,t,n,r,i){e!==t&&ri(t,(function(o,s){if(i||(i=new tr),v(o))!function(e,t,n,r,i,o,s){var a=li(e,n),u=li(t,n),c=s.get(u);if(c)ni(e,n,c);else{var l=o?o(a,u,n+"",e,t,s):void 0,d=void 0===l;if(d){var h=Y(u),f=!h&&ee(u),p=!h&&!f&&ue(u);l=u,h||f||p?Y(a)?l=a:function(e){return H(e)&&z(e)}(a)?l=yr(a):f?(d=!1,l=gr(u,!0)):p?(d=!1,l=xr(u,!0)):l=[]:ci(u)||K(u)?(l=a,K(a)?l=function(e){return sr(e,fr(e))}(a):v(a)&&!g(a)||(l=jr(u))):d=!1}d&&(s.set(u,l),i(l,u,r,o,s),s.delete(u)),ni(e,n,l)}}(e,t,s,n,di,r,i);else{var a=r?r(li(e,s),o,s+"",e,t,i):void 0;void 0===a&&(a=o),ni(e,s,a)}}),fr)}function hi(e,t,n,r,i,o){return v(e)&&v(t)&&(o.set(t,e),di(e,t,void 0,hi,o),o.delete(t)),e}function fi(e){return ti((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,s&&function(e,t,n){if(!v(n))return!1;var r=typeof t;return!!("number"==r?z(n)&&ur(t,n.length):"string"==r&&t in n)&&pn(n[t],e)}(n[0],n[1],s)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var a=n[r];a&&e(t,a,r,o)}return t}))}var pi=fi((function(e,t,n,r){di(e,t,n,r)})),_i=ti((function(e){return e.push(void 0,hi),Kr(pi,void 0,e)}));let mi=function(e){function t(t){var n;return(n=e.call(this)||this)._available=!1,n._active=!1,n._video=t,n}ge(t,e),pe(t,null,[{key:"displayName",get:function(){return"ExternalDisplay"}},{key:"supported",get:function(){return!1}},{key:"supportedVideoTypes",get:function(){return[]}}]);var n=t.prototype;return n.showPicker=function(){},n.getFile=function(){const e=this.constructor.displayName.replace("ExternalDisplay","");if(this._video.externalDisplayFiles[e])return this._video.externalDisplayFiles[e];const t=this.constructor.supportedVideoTypes,n=this._video.files.filter(e=>-1!==t.indexOf(e.mime)).sort((e,n)=>e.mime===n.mime?e.priority-n.priority:t.indexOf(e.mime)-t.indexOf(n.mime));if(!n.length)throw new Error(`No files available for ${this.constructor.displayName} external display.`);return n[0]},pe(t,[{key:"active",get:function(){return this._active}},{key:"available",get:function(){return this._available}},{key:"element",get:function(){return document.createElement("div")}}]),t}(er);const vi={ABORT:"abort",CAN_PLAY:"canplay",CAN_PLAY_THROUGH:"canplaythrough",DURATION_CHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",ENTER_PICTURE_IN_PICTURE:"enterpictureinpicture",LEAVE_PICTURE_IN_PICTURE:"leavepictureinpicture",ERROR:"error",LOADED_DATA:"loadeddata",LOADED_METADATA:"loadedmetadata",LOAD_START:"loadstart",PAUSE:"pause",PLAY:"play",PLAYING:"playing",PROGRESS:"progress",RATE_CHANGE:"ratechange",RESIZE:"resize",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIME_UPDATE:"timeupdate",VOLUME_CHANGE:"volumechange",WAITING:"waiting",WEBKIT_BEGIN_FULLSCREEN:"webkitbeginfullscreen",WEBKIT_END_FULLSCREEN:"webkitendfullscreen",WEBKIT_PRESENTATION_MODE_CHANGED:"webkitpresentationmodechanged"},gi={ADD_TRACK:"addtrack",REMOVE_TRACK:"removetrack",CHANGE:"change"},yi={AVAILABLE:"externaldisplayavailable",UNAVAILABLE:"externaldisplayunavailable",ACTIVATED:"externaldisplayactivated",DEACTIVATED:"externaldisplaydeactivated"},Ei={AIRPLAY_AVAILABLE:"available",AIRPLAY_UNAVAILABLE:"unavailable",AIRPLAY_ACTIVATED:"activated",AIRPLAY_DEACTIVATED:"deactivated"},Ti={SCANNER_CHANGE:"scannerchange",SCANNER_ERROR:"scannererror",FILE_ERROR:"fileerror",FILE_SRC_UPDATE:"filesrcupdate",DOWNLOAD_START:"downloadstart",DOWNLOAD_END:"downloadend",DOWNLOAD_ERROR:"downloaderror",DOWNLOAD_TIMEOUT:"downloadtimeout",DRM_AUTH_FAILURE:"drmauthfailure",DRM_AUTH_SUCCESS:"drmauthsuccess",DRM_FAILURE:"drmfailure",DRM_KEY_SWITCH:"drmkeyswitch",DRM_OUTPUT_RESTRICTED:"drmoutputrestricted",EME_UNSUPPORTED:"emeunsupported",CURRENT_FILE_CHANGE:"currentfilechange",MEDIA_URL_EXPIRED:"mediaurlexpired",MEDIA_URL_BAD_REQUEST:"mediaurlbadrequest",STREAM_CHANGE:"streamchange",STREAM_CHANGE_START:"streamchangestart",STREAM_UPDATED:"streamupdated",STREAM_BUFFER_START:"streambufferstart",STREAM_BUFFER_END:"streambufferend",AVAILABLE_STREAMS_CHANGED:"availablestreamschanged",MEDIA_CAPABILITY_STREAMS_UNSUPPORTED:"mediacapabilitystreamsunsupported",DROPPED_FRAMES:"droppedframes",BANDWIDTH:"bandwidth",STREAM_TARGET_CHANGE:"streamtargetchange",CUE_POINT:"cuepoint",BUFFER_OCCUPANCY:"bufferoccupancy",MANIFEST_TIMEOUT:"manifesttimeout",MANIFEST_LOADED:"manifestloaded",STREAMS_LOADED:"streamsloaded",TEXT_SRC_UPDATE:"texttracksrcupdate",TEXT_TRACKS_AVAILABLE:"texttracksavailable",AV_DURATION_MISMATCH:"avdurationmismatch",BUFFER_STARTED:"bufferstarted",BUFFER_ENDED:"bufferended",QUOTA_EXCEEDED_ERROR:"quotaexceedederror",CHAPTER_CUES_UPDATED:"chaptercuesupdated",APPEND_BUFFER_END:"appendbufferend",DROPPED_FRAME_PERCENT_EXCEEDED:"droppedframepercentexceeded",LOAD_SEGMENT_FAILED:"loadsegmentfailed",AUDIO_TRACK_CHANGED:"audiotrackchanged",SEGMENT_CUES_LOADED:"segmentcuesloaded"},Si={STREAM_ONLINE:"livestreamonline",STREAM_OFFLINE:"livestreamoffline",BUFFER_GAP_JUMP:"livebuffergapjump",BUFFER_GAP_JUMP_PREVENT:"livebuffergapjumpprevent",STALL_JUMP:"livestalljump",LATENCY_UPDATED:"latencyupdated"},bi={CAMERA_UPDATE:"cameraupdate",CAMERA_CHANGE:"camerachange",MOTION_START:"motionstart",MOTION_END:"motionend",SPATIAL_UNSUPPORTED:"spatialunsupported",WEBVR_ENTER:"entervr",WEBVR_EXIT:"exitvr",WEBVR_HARDWARE_AVAILABLE:"webvrhardwareavailable",AMBISONIC_UNSUPPORTED:"ambisonicunsupported"},Ai={MEDIASESSION_PLAY:"mediasessionplay",MEDIASESSION_PAUSE:"mediasessionpause",MEDIASESSION_SEEK_FORWARD:"mediasessionseekforward",MEDIASESSION_SEEK_TO:"mediasessionseekto",MEDIASESSION_SEEK_BACKWARD:"mediasessionseekbackward"},wi=Object.assign({},vi,gi,yi,Ei,Ti,bi,Si,Ai);var Ri="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Ii(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}var ki=Ii((function(e,t){
/*! For license information please see hls-parser.min.js.LICENSE.txt */
self,e.exports=function(){return e={851:(e,t,n)=>{var r=n(771),i=r.getOptions,o=r.setOptions,s=n(463),a=n(367),u=n(890);e.exports={parse:s,stringify:a,types:u,getOptions:i,setOptions:o}},463:(e,t,n)=>{function r(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw s}}}}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=n(771),u=n(890),c=u.Rendition,l=u.Variant,d=u.SessionData,h=u.Key,f=u.MediaInitializationSection,p=u.DateRange,_=u.SpliceInfo,m=u.MasterPlaylist,v=u.MediaPlaylist,g=u.Segment,y=u.PartialSegment,E=u.RenditionReport;function T(e){return a.trim(e,'"')}function S(e){var t=a.splitAt(e,",");return{duration:a.toNumber(t[0]),title:decodeURIComponent(escape(t[1]))}}function b(e){var t=a.splitAt(e,"@");return{length:a.toNumber(t[0]),offset:t[1]?a.toNumber(t[1]):-1}}function A(e,t){t.IV&&e.compatibleVersion<2&&(e.compatibleVersion=2),(t.KEYFORMAT||t.KEYFORMATVERSIONS)&&e.compatibleVersion<5&&(e.compatibleVersion=5)}function w(e){var t=a.splitByCommaWithPreservingQuotes(e),n={};return t.forEach((function(e){var t,r,o=i(a.splitAt(e,"="),2),s=o[0],u=o[1],c=T(u);switch(s){case"URI":n[s]=c;break;case"START-DATE":case"END-DATE":n[s]=new Date(c);break;case"IV":n[s]=(t=c,16!==(r=a.hexToByteSequence(t)).length&&a.INVALIDPLAYLIST("IV must be a 128-bit unsigned integer"),r);break;case"BYTERANGE":n[s]=b(c);break;case"RESOLUTION":n[s]=function(e){var t=a.splitAt(e,"x");return{width:a.toNumber(t[0]),height:a.toNumber(t[1])}}(c);break;case"END-ON-NEXT":case"DEFAULT":case"AUTOSELECT":case"FORCED":case"PRECISE":case"CAN-BLOCK-RELOAD":case"INDEPENDENT":case"GAP":n[s]="YES"===c;break;case"DURATION":case"PLANNED-DURATION":case"BANDWIDTH":case"AVERAGE-BANDWIDTH":case"FRAME-RATE":case"TIME-OFFSET":case"CAN-SKIP-UNTIL":case"HOLD-BACK":case"PART-HOLD-BACK":case"PART-TARGET":case"BYTERANGE-START":case"BYTERANGE-LENGTH":case"LAST-MSN":case"LAST-PART":case"SKIPPED-SEGMENTS":n[s]=a.toNumber(c);break;default:s.startsWith("SCTE35-")?n[s]=a.hexToByteSequence(c):s.startsWith("X-")?n[s]=function(e){return e.startsWith('"')?T(e):e.startsWith("0x")||e.startsWith("0X")?a.hexToByteSequence(e):a.toNumber(e)}(u):n[s]=c}})),n}function R(){a.INVALIDPLAYLIST("The file contains both media and master playlist tags.")}function I(e,t,n){var i,o=(i=t.attributes,new c({type:i.TYPE,uri:i.URI,groupId:i["GROUP-ID"],language:i.LANGUAGE,assocLanguage:i["ASSOC-LANGUAGE"],name:i.NAME,isDefault:i.DEFAULT,autoselect:i.AUTOSELECT,forced:i.FORCED,instreamId:i["INSTREAM-ID"],characteristics:i.CHARACTERISTICS,channels:i.CHANNELS})),s=e[a.camelify(n)],u=function(e,t){var n,i=!1,o=r(e);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(s.name===t.name)return"All EXT-X-MEDIA tags in the same Group MUST have different NAME attributes.";s.isDefault&&(i=!0)}}catch(e){o.e(e)}finally{o.f()}return i&&t.isDefault?"EXT-X-MEDIA A Group MUST NOT have more than one member with a DEFAULT attribute of YES.":""}(s,o);u&&a.INVALIDPLAYLIST(u),s.push(o),o.isDefault&&(e.currentRenditions[a.camelify(n)]=s.length-1)}function k(e,t,n,i,o){var s,u=new l({uri:n,bandwidth:t.BANDWIDTH,averageBandwidth:t["AVERAGE-BANDWIDTH"],codecs:t.CODECS,resolution:t.RESOLUTION,frameRate:t["FRAME-RATE"],hdcpLevel:t["HDCP-LEVEL"]}),c=r(e);try{for(c.s();!(s=c.n()).done;){var d=s.value;if("EXT-X-MEDIA"===d.name){var h=d.attributes,f=h.TYPE;if(f&&h["GROUP-ID"]||a.INVALIDPLAYLIST("EXT-X-MEDIA TYPE attribute is REQUIRED."),t[f]===h["GROUP-ID"]&&(I(u,d,f),"CLOSED-CAPTIONS"===f)){var p,_=r(u.closedCaptions);try{for(_.s();!(p=_.n()).done;){var m=p.value.instreamId;if(m&&m.startsWith("SERVICE")&&o.compatibleVersion<7){o.compatibleVersion=7;break}}}catch(e){_.e(e)}finally{_.f()}}}}}catch(e){c.e(e)}finally{c.f()}return function(e,t,n){["AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(r){"CLOSED-CAPTIONS"===r&&"NONE"===e[r]?(n.isClosedCaptionsNone=!0,t.closedCaptions=[]):e[r]&&!t[a.camelify(r)].find((function(t){return t.groupId===e[r]}))&&a.INVALIDPLAYLIST("".concat(r," attribute MUST match the value of the GROUP-ID attribute of an EXT-X-MEDIA tag whose TYPE attribute is ").concat(r,"."))}))}(t,u,o),u.isIFrameOnly=i,u}function P(e,t){if(e.method!==t.method)return!1;if(e.uri!==t.uri)return!1;if(e.iv){if(!t.iv)return!1;if(e.iv.length!==t.iv.length)return!1;for(var n=0;n<e.iv.length;n++)if(e.iv[n]!==t.iv[n])return!1}else if(t.iv)return!1;return e.format===t.format&&e.formatVersion===t.formatVersion}function D(e,t,n,r,i,o,s){for(var u=new g({uri:t,mediaSequenceNumber:i,discontinuitySequence:o}),c=!1,l=!1,d=function(t){var n=e[t],r=n.name,i=n.value,o=n.attributes;if("EXTINF"===r)!Number.isInteger(i.duration)&&s.compatibleVersion<3&&(s.compatibleVersion=3),Math.round(i.duration)>s.targetDuration&&a.INVALIDPLAYLIST("EXTINF duration, when rounded to the nearest integer, MUST be less than or equal to the target duration"),u.duration=i.duration,u.title=i.title;else if("EXT-X-BYTERANGE"===r)s.compatibleVersion<4&&(s.compatibleVersion=4),u.byterange=i;else if("EXT-X-DISCONTINUITY"===r)u.parts.length>0&&a.INVALIDPLAYLIST("EXT-X-DISCONTINUITY must appear before the first EXT-X-PART tag of the Parent Segment."),u.discontinuity=!0;else if("EXT-X-KEY"===r)u.parts.length>0&&a.INVALIDPLAYLIST("EXT-X-KEY must appear before the first EXT-X-PART tag of the Parent Segment."),A(s,o),u.key=new h({method:o.METHOD,uri:o.URI,iv:o.IV,format:o.KEYFORMAT,formatVersion:o.KEYFORMATVERSIONS});else if("EXT-X-MAP"===r)u.parts.length>0&&a.INVALIDPLAYLIST("EXT-X-MAP must appear before the first EXT-X-PART tag of the Parent Segment."),s.compatibleVersion<5&&(s.compatibleVersion=5),s.hasMap=!0,u.map=new f({uri:o.URI,byterange:o.BYTERANGE});else if("EXT-X-PROGRAM-DATE-TIME"===r)u.programDateTime=i;else if("EXT-X-DATERANGE"===r){var d={};Object.keys(o).forEach((function(e){(e.startsWith("SCTE35-")||e.startsWith("X-"))&&(d[e]=o[e])})),u.dateRange=new p({id:o.ID,classId:o.CLASS,start:o["START-DATE"],end:o["END-DATE"],duration:o.DURATION,plannedDuration:o["PLANNED-DURATION"],endOnNext:o["END-ON-NEXT"],attributes:d})}else if("EXT-X-CUE-OUT"===r)u.markers.push(new _({type:"OUT",duration:i}));else if("EXT-X-CUE-IN"===r)u.markers.push(new _({type:"IN"}));else if("EXT-X-CUE-OUT-CONT"===r||"EXT-X-CUE"===r||"EXT-OATCLS-SCTE35"===r||"EXT-X-ASSET"===r||"EXT-X-SCTE35"===r)u.markers.push(new _({type:"RAW",tagName:r,value:i}));else if("EXT-X-PRELOAD-HINT"!==r||o.TYPE)if("EXT-X-PRELOAD-HINT"===r&&"PART"===o.TYPE&&l)a.INVALIDPLAYLIST("Servers should not add more than one EXT-X-PRELOAD-HINT tag with the same TYPE attribute to a Playlist.");else if("EXT-X-PART"!==r&&"EXT-X-PRELOAD-HINT"!==r||o.URI){if("EXT-X-PRELOAD-HINT"===r&&"MAP"===o.TYPE)c&&a.INVALIDPLAYLIST("Servers should not add more than one EXT-X-PRELOAD-HINT tag with the same TYPE attribute to a Playlist."),c=!0,s.hasMap=!0,u.map=new f({hint:!0,uri:o.URI,byterange:{length:o["BYTERANGE-LENGTH"],offset:o["BYTERANGE-START"]||0}});else if("EXT-X-PART"===r||"EXT-X-PRELOAD-HINT"===r&&"PART"===o.TYPE){"EXT-X-PART"!==r||o.DURATION||a.INVALIDPLAYLIST("EXT-X-PART: DURATION attribute is mandatory"),"EXT-X-PRELOAD-HINT"===r&&(l=!0);var m=new y({hint:"EXT-X-PRELOAD-HINT"===r,uri:o.URI,byterange:"EXT-X-PART"===r?o.BYTERANGE:{length:o["BYTERANGE-LENGTH"],offset:o["BYTERANGE-START"]||0},duration:o.DURATION,independent:o.INDEPENDENT,gap:o.GAP});u.parts.push(m)}}else a.INVALIDPLAYLIST("EXT-X-PART / EXT-X-PRELOAD-HINT: URI attribute is mandatory");else a.INVALIDPLAYLIST("EXT-X-PRELOAD-HINT: TYPE attribute is mandatory")},m=n;m<=r;m++)d(m);return u}function O(e,t,n,r,i){var o=t.discontinuity,s=t.key,u=t.map,c=t.byterange,l=t.uri;if(o&&(t.discontinuitySequence=n+1),s||(t.key=r),u||(t.map=i),c&&-1===c.offset){var d=e.segments;if(d.length>0){var h=d[d.length-1];h.byterange&&h.uri===l?c.offset=h.byterange.offset+h.byterange.length:a.INVALIDPLAYLIST("If offset of EXT-X-BYTERANGE is not present, a previous Media Segment MUST be a sub-range of the same media resource")}else a.INVALIDPLAYLIST("If offset of EXT-X-BYTERANGE is not present, a previous Media Segment MUST appear in the Playlist file")}return e.segments.push(t),[t.discontinuitySequence,t.key,t.map]}function L(e,t){var n=i(function(e){var t=e.indexOf(":");return-1===t?[e.slice(1).trim(),null]:[e.slice(1,t).trim(),e.slice(t+1).trim()]}(e),2),r=n[0],o=n[1],s=function(e){switch(e){case"EXTM3U":case"EXT-X-VERSION":return"Basic";case"EXTINF":case"EXT-X-BYTERANGE":case"EXT-X-DISCONTINUITY":case"EXT-X-KEY":case"EXT-X-MAP":case"EXT-X-PROGRAM-DATE-TIME":case"EXT-X-DATERANGE":case"EXT-X-CUE-OUT":case"EXT-X-CUE-IN":case"EXT-X-CUE-OUT-CONT":case"EXT-X-CUE":case"EXT-OATCLS-SCTE35":case"EXT-X-ASSET":case"EXT-X-SCTE35":case"EXT-X-PART":case"EXT-X-PRELOAD-HINT":return"Segment";case"EXT-X-TARGETDURATION":case"EXT-X-MEDIA-SEQUENCE":case"EXT-X-DISCONTINUITY-SEQUENCE":case"EXT-X-ENDLIST":case"EXT-X-PLAYLIST-TYPE":case"EXT-X-I-FRAMES-ONLY":case"EXT-X-SERVER-CONTROL":case"EXT-X-PART-INF":case"EXT-X-RENDITION-REPORT":case"EXT-X-SKIP":return"MediaPlaylist";case"EXT-X-MEDIA":case"EXT-X-STREAM-INF":case"EXT-X-I-FRAME-STREAM-INF":case"EXT-X-SESSION-DATA":case"EXT-X-SESSION-KEY":return"MasterPlaylist";case"EXT-X-INDEPENDENT-SEGMENTS":case"EXT-X-START":return"MediaorMasterPlaylist";default:return"Unknown"}}(r);if(function(e,t){if("Segment"===e||"MediaPlaylist"===e)return void 0===t.isMasterPlaylist?void(t.isMasterPlaylist=!1):void(t.isMasterPlaylist&&R());if("MasterPlaylist"===e){if(void 0===t.isMasterPlaylist)return void(t.isMasterPlaylist=!0);!1===t.isMasterPlaylist&&R()}}(s,t),"Unknown"===s)return null;"MediaPlaylist"===s&&"EXT-X-RENDITION-REPORT"!==r&&(t.hash[r]&&a.INVALIDPLAYLIST("There MUST NOT be more than one Media Playlist tag of each type in any Media Playlist"),t.hash[r]=!0);var u=i(function(e,t){switch(e){case"EXTM3U":case"EXT-X-DISCONTINUITY":case"EXT-X-ENDLIST":case"EXT-X-I-FRAMES-ONLY":case"EXT-X-INDEPENDENT-SEGMENTS":case"EXT-X-CUE-IN":return[null,null];case"EXT-X-VERSION":case"EXT-X-TARGETDURATION":case"EXT-X-MEDIA-SEQUENCE":case"EXT-X-DISCONTINUITY-SEQUENCE":case"EXT-X-CUE-OUT":return[a.toNumber(t),null];case"EXT-X-KEY":case"EXT-X-MAP":case"EXT-X-DATERANGE":case"EXT-X-MEDIA":case"EXT-X-STREAM-INF":case"EXT-X-I-FRAME-STREAM-INF":case"EXT-X-SESSION-DATA":case"EXT-X-SESSION-KEY":case"EXT-X-START":case"EXT-X-SERVER-CONTROL":case"EXT-X-PART-INF":case"EXT-X-PART":case"EXT-X-PRELOAD-HINT":case"EXT-X-RENDITION-REPORT":case"EXT-X-SKIP":return[null,w(t)];case"EXTINF":return[S(t),null];case"EXT-X-BYTERANGE":return[b(t),null];case"EXT-X-PROGRAM-DATE-TIME":return[new Date(t),null];case"EXT-X-PLAYLIST-TYPE":default:return[t,null]}}(r,o),2);return{name:r,category:s,value:u[0],attributes:u[1]}}e.exports=function(e){var t={version:void 0,isMasterPlaylist:void 0,hasMap:!1,targetDuration:0,compatibleVersion:1,isClosedCaptionsNone:!1,hash:{}},n=function(e,t){var n;return t.isMasterPlaylist?n=function(e,t){var n,o=new m,s=r(e.entries());try{for(s.s();!(n=s.n()).done;){var u=i(n.value,2),c=u[0],l=u[1],f=l.name,p=l.value,_=l.attributes;if("EXT-X-VERSION"===f)o.version=p;else if("EXT-X-STREAM-INF"===f){var v=e[c+1];("string"!=typeof v||v.startsWith("#EXT"))&&a.INVALIDPLAYLIST("EXT-X-STREAM-INF must be followed by a URI line");var g=k(e,_,v,!1,t);g&&o.variants.push(g)}else if("EXT-X-I-FRAME-STREAM-INF"===f){var y=k(e,_,_.URI,!0,t);y&&o.variants.push(y)}else"EXT-X-SESSION-DATA"===f?function(){var e=new d({id:_["DATA-ID"],value:_.VALUE,uri:_.URI,language:_.LANGUAGE});o.sessionDataList.find((function(t){return t.id===e.id&&t.language===e.language}))&&a.INVALIDPLAYLIST("A Playlist MUST NOT contain more than one EXT-X-SESSION-DATA tag with the same DATA-ID attribute and the same LANGUAGE attribute."),o.sessionDataList.push(e)}():"EXT-X-SESSION-KEY"===f?function(){"NONE"===_.METHOD&&a.INVALIDPLAYLIST("EXT-X-SESSION-KEY: The value of the METHOD attribute MUST NOT be NONE");var e=new h({method:_.METHOD,uri:_.URI,iv:_.IV,format:_.KEYFORMAT,formatVersion:_.KEYFORMATVERSIONS});o.sessionKeyList.find((function(t){return P(t,e)}))&&a.INVALIDPLAYLIST("A Master Playlist MUST NOT contain more than one EXT-X-SESSION-KEY tag with the same METHOD, URI, IV, KEYFORMAT, and KEYFORMATVERSIONS attribute values."),A(t,_),o.sessionKeyList.push(e)}():"EXT-X-INDEPENDENT-SEGMENTS"===f?(o.independentSegments&&a.INVALIDPLAYLIST("EXT-X-INDEPENDENT-SEGMENTS tag MUST NOT appear more than once in a Playlist"),o.independentSegments=!0):"EXT-X-START"===f&&(o.start&&a.INVALIDPLAYLIST("EXT-X-START tag MUST NOT appear more than once in a Playlist"),"number"!=typeof _["TIME-OFFSET"]&&a.INVALIDPLAYLIST("EXT-X-START: TIME-OFFSET attribute is REQUIRED"),o.start={offset:_["TIME-OFFSET"],precise:_.PRECISE||!1})}}catch(e){s.e(e)}finally{s.f()}if(t.isClosedCaptionsNone){var E,T=r(o.variants);try{for(T.s();!(E=T.n()).done;)E.value.closedCaptions.length>0&&a.INVALIDPLAYLIST("If there is a variant with CLOSED-CAPTIONS attribute of NONE, all EXT-X-STREAM-INF tags MUST have this attribute with a value of NONE")}catch(e){T.e(e)}finally{T.f()}}return o}(e,t):!(n=function(e,t){var n,o=new v,s=-1,u=0,c=!1,l=0,d=null,h=null,f=!1,p=r(e.entries());try{for(p.s();!(n=p.n()).done;){var _=i(n.value,2),m=_[0],g=_[1],y=g.name,T=g.value,S=g.attributes;if("Segment"!==g.category){if("EXT-X-VERSION"===y)void 0===o.version?o.version=T:a.INVALIDPLAYLIST("A Playlist file MUST NOT contain more than one EXT-X-VERSION tag.");else if("EXT-X-TARGETDURATION"===y)o.targetDuration=t.targetDuration=T;else if("EXT-X-MEDIA-SEQUENCE"===y)o.segments.length>0&&a.INVALIDPLAYLIST("The EXT-X-MEDIA-SEQUENCE tag MUST appear before the first Media Segment in the Playlist."),o.mediaSequenceBase=u=T;else if("EXT-X-DISCONTINUITY-SEQUENCE"===y)o.segments.length>0&&a.INVALIDPLAYLIST("The EXT-X-DISCONTINUITY-SEQUENCE tag MUST appear before the first Media Segment in the Playlist."),c&&a.INVALIDPLAYLIST("The EXT-X-DISCONTINUITY-SEQUENCE tag MUST appear before any EXT-X-DISCONTINUITY tag."),o.discontinuitySequenceBase=l=T;else if("EXT-X-ENDLIST"===y)o.endlist=!0;else if("EXT-X-PLAYLIST-TYPE"===y)o.playlistType=T;else if("EXT-X-I-FRAMES-ONLY"===y)t.compatibleVersion<4&&(t.compatibleVersion=4),o.isIFrame=!0;else if("EXT-X-INDEPENDENT-SEGMENTS"===y)o.independentSegments&&a.INVALIDPLAYLIST("EXT-X-INDEPENDENT-SEGMENTS tag MUST NOT appear more than once in a Playlist"),o.independentSegments=!0;else if("EXT-X-START"===y)o.start&&a.INVALIDPLAYLIST("EXT-X-START tag MUST NOT appear more than once in a Playlist"),"number"!=typeof S["TIME-OFFSET"]&&a.INVALIDPLAYLIST("EXT-X-START: TIME-OFFSET attribute is REQUIRED"),o.start={offset:S["TIME-OFFSET"],precise:S.PRECISE||!1};else if("EXT-X-SERVER-CONTROL"===y)S["CAN-BLOCK-RELOAD"]||a.INVALIDPLAYLIST("EXT-X-SERVER-CONTROL: CAN-BLOCK-RELOAD=YES is mandatory for Low-Latency HLS"),o.lowLatencyCompatibility={canBlockReload:S["CAN-BLOCK-RELOAD"],canSkipUntil:S["CAN-SKIP-UNTIL"],holdBack:S["HOLD-BACK"],partHoldBack:S["PART-HOLD-BACK"]};else if("EXT-X-PART-INF"===y)S["PART-TARGET"]||a.INVALIDPLAYLIST("EXT-X-PART-INF: PART-TARGET attribute is mandatory"),o.partTargetDuration=S["PART-TARGET"];else if("EXT-X-RENDITION-REPORT"===y)S.URI||a.INVALIDPLAYLIST("EXT-X-RENDITION-REPORT: URI attribute is mandatory"),0===S.URI.search(/^[a-z]+:/)&&a.INVALIDPLAYLIST("EXT-X-RENDITION-REPORT: URI must be relative to the playlist uri"),o.renditionReports.push(new E({uri:S.URI,lastMSN:S["LAST-MSN"],lastPart:S["LAST-PART"]}));else if("EXT-X-SKIP"===y)S["SKIPPED-SEGMENTS"]||a.INVALIDPLAYLIST("EXT-X-SKIP: SKIPPED-SEGMENTS attribute is mandatory"),t.compatibleVersion<9&&(t.compatibleVersion=9),o.skip=S["SKIPPED-SEGMENTS"],u+=o.skip;else if("string"==typeof g){-1===s&&a.INVALIDPLAYLIST("A URI line is not preceded by any segment tags"),o.targetDuration||a.INVALIDPLAYLIST("The EXT-X-TARGETDURATION tag is REQUIRED");var b=D(e,g,s,m-1,u++,l,t);if(b){var A=i(O(o,b,l,d,h),3);l=A[0],d=A[1],h=A[2],!f&&b.parts.length>0&&(f=!0)}s=-1}}else-1===s&&(s=m),"EXT-X-DISCONTINUITY"===y&&(c=!0)}}catch(e){p.e(e)}finally{p.f()}if(-1!==s){var w=D(e,"",s,e.length-1,u++,l,t);if(w){var R=w.parts;R.length>0&&!o.endlist&&!R[R.length-1].hint&&a.INVALIDPLAYLIST("If the Playlist contains EXT-X-PART tags and does not contain an EXT-X-ENDLIST tag, the Playlist must contain an EXT-X-PRELOAD-HINT tag with a TYPE=PART attribute"),O(o,w,d,h),!f&&w.parts.length>0&&(f=!0)}}return function(e){for(var t=new Map,n=new Map,i=!1,o=!1,s=e.length-1;s>=0;s--){var u=e[s],c=u.programDateTime,l=u.dateRange;if(c&&(o=!0),l&&l.start){i=!0,l.endOnNext&&(l.end||l.duration)&&a.INVALIDPLAYLIST("An EXT-X-DATERANGE tag with an END-ON-NEXT=YES attribute MUST NOT contain DURATION or END-DATE attributes.");var d=l.start.getTime(),h=l.duration||0;l.end&&l.duration&&d+1e3*h!==l.end.getTime()&&a.INVALIDPLAYLIST("END-DATE MUST be equal to the value of the START-DATE attribute plus the value of the DURATION"),l.endOnNext&&(l.end=t.get(l.classId)),t.set(l.classId,l.start);var f=l.end?l.end.getTime():l.start.getTime()+1e3*(l.duration||0),p=n.get(l.classId);if(p){var _,m=r(p);try{for(m.s();!(_=m.n()).done;){var v=_.value;(v.start<=d&&v.end>d||v.start>=d&&v.start<f)&&a.INVALIDPLAYLIST("DATERANGE tags with the same CLASS should not overlap")}}catch(e){m.e(e)}finally{m.f()}p.push({start:d,end:f})}else n.set(l.classId,[{start:d,end:f}])}}i&&!o&&a.INVALIDPLAYLIST("If a Playlist contains an EXT-X-DATERANGE tag, it MUST also contain at least one EXT-X-PROGRAM-DATE-TIME tag.")}(o.segments),o.lowLatencyCompatibility&&function(e,t){var n=e.lowLatencyCompatibility,o=e.targetDuration,s=e.partTargetDuration,u=e.segments,c=e.renditionReports,l=n.canSkipUntil,d=n.holdBack,h=n.partHoldBack;if(l<6*o&&a.INVALIDPLAYLIST("The Skip Boundary must be at least six times the EXT-X-TARGETDURATION."),d<3*o&&a.INVALIDPLAYLIST("HOLD-BACK must be at least three times the EXT-X-TARGETDURATION."),t){void 0===s&&a.INVALIDPLAYLIST("EXT-X-PART-INF is required if a Playlist contains one or more EXT-X-PART tags"),void 0===h&&a.INVALIDPLAYLIST("EXT-X-PART: PART-HOLD-BACK attribute is mandatory"),h<s&&a.INVALIDPLAYLIST("PART-HOLD-BACK must be at least PART-TARGET");var f,p=r(u.entries());try{for(p.s();!(f=p.n()).done;){var _=i(f.value,2),m=_[0],v=_[1].parts;v.length>0&&m<u.length-3&&a.INVALIDPLAYLIST("Remove EXT-X-PART tags from the Playlist after they are greater than three target durations from the end of the Playlist.");var g,y=r(v.entries());try{for(y.s();!(g=y.n()).done;){var E=i(g.value,2),T=E[0],S=E[1].duration;void 0!==S&&(S>s&&a.INVALIDPLAYLIST("PART-TARGET is the maximum duration of any Partial Segment"),T<v.length-1&&S<.85*s&&a.INVALIDPLAYLIST("All Partial Segments except the last part of a segment must have a duration of at least 85% of PART-TARGET"))}}catch(e){y.e(e)}finally{y.f()}}}catch(e){p.e(e)}finally{p.f()}}var b,A=r(c);try{for(A.s();!(b=A.n()).done;){var w=b.value,R=u[u.length-1];w.lastMSN||(w.lastMSN=R.mediaSequenceNumber),!w.lastPart&&R.parts.length>0&&(w.lastPart=R.parts.length-1)}}catch(e){A.e(e)}finally{A.f()}}(o,f),o}(e,t)).isIFrame&&t.hasMap&&t.compatibleVersion<6&&(t.compatibleVersion=6),t.compatibleVersion>1&&(!n.version||n.version<t.compatibleVersion)&&a.INVALIDPLAYLIST("EXT-X-VERSION needs to be ".concat(t.compatibleVersion," or higher.")),n}(function(e,t){var n=[];return e.split("\n").forEach((function(e){var r=e.trim();if(r)if(r.startsWith("#")){if(r.startsWith("#EXT")){var i=L(r,t);return void(i&&n.push(i))}}else n.push(r)})),0!==n.length&&"EXTM3U"===n[0].name||a.INVALIDPLAYLIST("The EXTM3U tag MUST be the first line."),n}(e,t),t);return n.source=e,n}},367:(e,t,n)=>{function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=s(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function s(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){var t="function"==typeof Map?new Map:void 0;return(l=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return d(e,arguments,p(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),f(r,e)})(e)}function d(e,t,n){return(d=h()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&f(i,n.prototype),i}).apply(null,arguments)}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _=n(771),m=["#EXTINF","#EXT-X-BYTERANGE","#EXT-X-DISCONTINUITY","#EXT-X-STREAM-INF","#EXT-X-CUE-OUT","#EXT-X-CUE-IN","#EXT-X-KEY","#EXT-X-MAP"],v=["#EXT-X-MEDIA"],g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(o,e);var t,n,r,i=(t=o,n=h(),function(){var e,r=p(t);if(n){var i=p(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return c(this,e)});function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this)).baseUri=e,t}return(r=[{key:"push",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=function(){var t=a[s];if(!t.startsWith("#"))return u(p(o.prototype),"push",e).call(e,t),"continue";if(m.some((function(e){return t.startsWith(e)})))return u(p(o.prototype),"push",e).call(e,t),"continue";if(e.includes(t)){if(v.some((function(e){return t.startsWith(e)})))return"continue";_.INVALIDPLAYLIST("Redundant item (".concat(t,")"))}u(p(o.prototype),"push",e).call(e,t)},s=0,a=n;s<a.length;s++)i()}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(o.prototype,r),o}(l(Array));function y(e,t){var n=1e3;t&&(n=Math.pow(10,t));var r=Math.round(e*n)/n;return t?r.toFixed(t):r}function E(e){var t=e.toString(10),n=t.indexOf(".");return-1===n?0:t.length-n-1}function T(e){var t=['DATA-ID="'.concat(e.id,'"')];return e.language&&t.push('LANGUAGE="'.concat(e.language,'"')),e.value?t.push('VALUE="'.concat(e.value,'"')):e.uri&&t.push('URI="'.concat(e.uri,'"')),"#EXT-X-SESSION-DATA:".concat(t.join(","))}function S(e,t){var n=t?"#EXT-X-SESSION-KEY":"#EXT-X-KEY",r=["METHOD=".concat(e.method)];return e.uri&&r.push('URI="'.concat(e.uri,'"')),e.iv&&(16!==e.iv.length&&_.INVALIDPLAYLIST("IV must be a 128-bit unsigned integer"),r.push("IV=".concat(_.byteSequenceToHex(e.iv)))),e.format&&r.push('KEYFORMAT="'.concat(e.format,'"')),e.formatVersion&&r.push('KEYFORMATVERSIONS="'.concat(e.formatVersion,'"')),"".concat(n,":").concat(r.join(","))}function b(e,t){var n=t.isIFrameOnly?"#EXT-X-I-FRAME-STREAM-INF":"#EXT-X-STREAM-INF",r=["BANDWIDTH=".concat(t.bandwidth)];if(t.averageBandwidth&&r.push("AVERAGE-BANDWIDTH=".concat(t.averageBandwidth)),t.isIFrameOnly&&r.push('URI="'.concat(t.uri,'"')),t.codecs&&r.push('CODECS="'.concat(t.codecs,'"')),t.resolution&&r.push("RESOLUTION=".concat(t.resolution.width,"x").concat(t.resolution.height)),t.frameRate&&r.push("FRAME-RATE=".concat(y(t.frameRate,3))),t.hdcpLevel&&r.push("HDCP-LEVEL=".concat(t.hdcpLevel)),t.audio.length>0){r.push('AUDIO="'.concat(t.audio[0].groupId,'"'));var i,s=o(t.audio);try{for(s.s();!(i=s.n()).done;){var a=i.value;e.push(A(a))}}catch(e){s.e(e)}finally{s.f()}}if(t.video.length>0){r.push('VIDEO="'.concat(t.video[0].groupId,'"'));var u,c=o(t.video);try{for(c.s();!(u=c.n()).done;){var l=u.value;e.push(A(l))}}catch(e){c.e(e)}finally{c.f()}}if(t.subtitles.length>0){r.push('SUBTITLES="'.concat(t.subtitles[0].groupId,'"'));var d,h=o(t.subtitles);try{for(h.s();!(d=h.n()).done;){var f=d.value;e.push(A(f))}}catch(e){h.e(e)}finally{h.f()}}if(_.getOptions().allowClosedCaptionsNone&&0===t.closedCaptions.length)r.push("CLOSED-CAPTIONS=NONE");else if(t.closedCaptions.length>0){r.push('CLOSED-CAPTIONS="'.concat(t.closedCaptions[0].groupId,'"'));var p,m=o(t.closedCaptions);try{for(m.s();!(p=m.n()).done;){var v=p.value;e.push(A(v))}}catch(e){m.e(e)}finally{m.f()}}e.push("".concat(n,":").concat(r.join(","))),t.isIFrameOnly||e.push("".concat(t.uri))}function A(e){var t=["TYPE=".concat(e.type),'GROUP-ID="'.concat(e.groupId,'"'),'NAME="'.concat(e.name,'"')];return void 0!==e.isDefault&&t.push("DEFAULT=".concat(e.isDefault?"YES":"NO")),void 0!==e.autoselect&&t.push("AUTOSELECT=".concat(e.autoselect?"YES":"NO")),void 0!==e.forced&&t.push("FORCED=".concat(e.forced?"YES":"NO")),e.language&&t.push('LANGUAGE="'.concat(e.language,'"')),e.assocLanguage&&t.push('ASSOC-LANGUAGE="'.concat(e.assocLanguage,'"')),e.instreamId&&t.push('INSTREAM-ID="'.concat(e.instreamId,'"')),e.characteristics&&t.push('CHARACTERISTICS="'.concat(e.characteristics,'"')),e.channels&&t.push('CHANNELS="'.concat(e.channels,'"')),e.uri&&t.push('URI="'.concat(e.uri,'"')),"#EXT-X-MEDIA:".concat(t.join(","))}function w(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=!1;if(t.byterange&&e.push("#EXT-X-BYTERANGE:".concat(I(t.byterange))),t.discontinuity&&e.push("#EXT-X-DISCONTINUITY"),t.key){var s=S(t.key);s!==n&&(e.push(s),n=s)}if(t.map){var a=R(t.map);a!==r&&(e.push(a),r=a)}if(t.programDateTime&&e.push("#EXT-X-PROGRAM-DATE-TIME:".concat(_.formatDate(t.programDateTime))),t.dateRange&&e.push(k(t.dateRange)),t.markers.length>0&&P(e,t.markers),t.parts.length>0&&(o=D(e,t.parts)),o)return[n,r];var u=i<3?Math.round(t.duration):y(t.duration,E(t.duration));return e.push("#EXTINF:".concat(u,",").concat(unescape(encodeURIComponent(t.title||"")))),Array.prototype.push.call(e,"".concat(t.uri)),[n,r]}function R(e){var t=['URI="'.concat(e.uri,'"')];return e.byterange&&t.push('BYTERANGE="'.concat(I(e.byterange),'"')),"#EXT-X-MAP:".concat(t.join(","))}function I(e){var t=e.offset,n=e.length;return"".concat(n,"@").concat(t)}function k(e){var t=['ID="'.concat(e.id,'"')];return e.start&&t.push('START-DATE="'.concat(_.formatDate(e.start),'"')),e.end&&t.push('END-DATE="'.concat(e.end,'"')),e.duration&&t.push("DURATION=".concat(e.duration)),e.plannedDuration&&t.push("PLANNED-DURATION=".concat(e.plannedDuration)),e.classId&&t.push('CLASS="'.concat(e.classId,'"')),e.endOnNext&&t.push("END-ON-NEXT=YES"),Object.keys(e.attributes).forEach((function(n){n.startsWith("X-")?"number"==typeof e.attributes[n]?t.push("".concat(n,"=").concat(e.attributes[n])):t.push("".concat(n,'="').concat(e.attributes[n],'"')):n.startsWith("SCTE35-")&&t.push("".concat(n,"=").concat(_.byteSequenceToHex(e.attributes[n])))})),"#EXT-X-DATERANGE:".concat(t.join(","))}function P(e,t){var n,r=o(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if("OUT"===i.type)e.push("#EXT-X-CUE-OUT:".concat(i.duration));else if("IN"===i.type)e.push("#EXT-X-CUE-IN");else if("RAW"===i.type){var s=i.value?":".concat(i.value):"";e.push("#".concat(i.tagName).concat(s))}}}catch(e){r.e(e)}finally{r.f()}}function D(e,t){var n,r=!1,i=o(t);try{for(i.s();!(n=i.n()).done;){var s=n.value;if(s.hint){var a=[];if(a.push("TYPE=PART"),a.push('URI="'.concat(s.uri,'"')),s.byterange){var u=s.byterange,c=u.offset,l=u.length;a.push("BYTERANGE-START=".concat(c)),l&&a.push("BYTERANGE-LENGTH=".concat(l))}e.push("#EXT-X-PRELOAD-HINT:".concat(a.join(","))),r=!0}else{var d=[];d.push("DURATION=".concat(s.duration)),d.push('URI="'.concat(s.uri,'"')),s.byterange&&d.push("BYTERANGE=".concat(I(s.byterange))),s.independent&&d.push("INDEPENDENT=YES"),s.gap&&d.push("GAP=YES"),e.push("#EXT-X-PART:".concat(d.join(",")))}}}catch(e){i.e(e)}finally{i.f()}return r}e.exports=function(e){_.PARAMCHECK(e),_.ASSERT("Not a playlist","playlist"===e.type);var t=new g(e.uri);return t.push("#EXTM3U"),e.version&&t.push("#EXT-X-VERSION:".concat(e.version)),e.independentSegments&&t.push("#EXT-X-INDEPENDENT-SEGMENTS"),e.start&&t.push("#EXT-X-START:TIME-OFFSET=".concat(y(e.start.offset)).concat(e.start.precise?",PRECISE=YES":"")),e.isMasterPlaylist?function(e,t){var n,r=o(t.sessionDataList);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.push(T(i))}}catch(e){r.e(e)}finally{r.f()}var s,a=o(t.sessionKeyList);try{for(a.s();!(s=a.n()).done;){var u=s.value;e.push(S(u,!0))}}catch(e){a.e(e)}finally{a.f()}var c,l=o(t.variants);try{for(l.s();!(c=l.n()).done;)b(e,c.value)}catch(e){l.e(e)}finally{l.f()}}(t,e):function(e,t){var n="",r="";if(t.targetDuration&&e.push("#EXT-X-TARGETDURATION:".concat(t.targetDuration)),t.lowLatencyCompatibility){var s=t.lowLatencyCompatibility,a=s.canBlockReload,u=s.canSkipUntil,c=s.holdBack,l=s.partHoldBack,d=[];d.push("CAN-BLOCK-RELOAD=".concat(a?"YES":"NO")),void 0!==u&&d.push("CAN-SKIP-UNTIL=".concat(u)),void 0!==c&&d.push("HOLD-BACK=".concat(c)),void 0!==l&&d.push("PART-HOLD-BACK=".concat(l)),e.push("#EXT-X-SERVER-CONTROL:".concat(d.join(",")))}t.partTargetDuration&&e.push("#EXT-X-PART-INF:PART-TARGET=".concat(t.partTargetDuration)),t.mediaSequenceBase&&e.push("#EXT-X-MEDIA-SEQUENCE:".concat(t.mediaSequenceBase)),t.discontinuitySequenceBase&&e.push("#EXT-X-DISCONTINUITY-SEQUENCE:".concat(t.discontinuitySequenceBase)),t.playlistType&&e.push("#EXT-X-PLAYLIST-TYPE:".concat(t.playlistType)),t.isIFrame&&e.push("#EXT-X-I-FRAMES-ONLY"),t.skip>0&&e.push("#EXT-X-SKIP:SKIPPED-SEGMENTS=".concat(t.skip));var h,f=o(t.segments);try{for(f.s();!(h=f.n()).done;){var p=i(w(e,h.value,n,r,t.version),2);n=p[0],r=p[1]}}catch(e){f.e(e)}finally{f.f()}t.endlist&&e.push("#EXT-X-ENDLIST");var _,m=o(t.renditionReports);try{for(m.s();!(_=m.n()).done;){var v=_.value,g=[];g.push('URI="'.concat(v.uri,'"')),g.push("LAST-MSN=".concat(v.lastMSN)),void 0!==v.lastPart&&g.push("LAST-PART=".concat(v.lastPart)),e.push("#EXT-X-RENDITION-REPORT:".concat(g.join(",")))}}catch(e){m.e(e)}finally{m.f()}}(t,e),t.join("\n")}},890:(e,t,n)=>{function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&function(e,t){(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=a(e);if(t){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var c=n(771),l=function e(t){u(this,e),c.PARAMCHECK(t),this.type=t},d=function(e){i(n,e);var t=o(n);function n(e){var r,i=e.isMasterPlaylist,o=e.uri,s=e.version,a=e.independentSegments,l=void 0!==a&&a,d=e.start,h=e.source;return u(this,n),r=t.call(this,"playlist"),c.PARAMCHECK(i),r.isMasterPlaylist=i,r.uri=o,r.version=s,r.independentSegments=l,r.start=d,r.source=h,r}return n}(l),h=function(e){i(n,e);var t=o(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,n),r.isMasterPlaylist=!0,e=t.call(this,r);var i=r.variants,o=void 0===i?[]:i,s=r.currentVariant,a=r.sessionDataList,c=void 0===a?[]:a,l=r.sessionKeyList,d=void 0===l?[]:l;return e.variants=o,e.currentVariant=s,e.sessionDataList=c,e.sessionKeyList=d,e}return n}(d),f=function(e){i(n,e);var t=o(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,n),r.isMasterPlaylist=!1,e=t.call(this,r);var i=r.targetDuration,o=r.mediaSequenceBase,s=void 0===o?0:o,a=r.discontinuitySequenceBase,c=void 0===a?0:a,l=r.endlist,d=void 0!==l&&l,h=r.playlistType,f=r.isIFrame,p=r.segments,_=void 0===p?[]:p,m=r.lowLatencyCompatibility,v=r.partTargetDuration,g=r.renditionReports,y=void 0===g?[]:g,E=r.skip,T=void 0===E?0:E,S=r.hash;return e.targetDuration=i,e.mediaSequenceBase=s,e.discontinuitySequenceBase=c,e.endlist=d,e.playlistType=h,e.isIFrame=f,e.segments=_,e.lowLatencyCompatibility=m,e.partTargetDuration=v,e.renditionReports=y,e.skip=T,e.hash=S,e}return n}(d),p=function(e){i(n,e);var t=o(n);function n(e){var r,i=e.uri,o=e.mimeType,s=e.data,a=e.duration,c=e.title,l=e.byterange,d=e.discontinuity,h=e.mediaSequenceNumber,f=void 0===h?0:h,p=e.discontinuitySequence,_=void 0===p?0:p,m=e.key,v=e.map,g=e.programDateTime,y=e.dateRange,E=e.markers,T=void 0===E?[]:E,S=e.parts,b=void 0===S?[]:S;return u(this,n),(r=t.call(this,"segment")).uri=i,r.mimeType=o,r.data=s,r.duration=a,r.title=c,r.byterange=l,r.discontinuity=d,r.mediaSequenceNumber=f,r.discontinuitySequence=_,r.key=m,r.map=v,r.programDateTime=g,r.dateRange=y,r.markers=T,r.parts=b,r}return n}(l),_=function(e){i(n,e);var t=o(n);function n(e){var r,i=e.hint,o=void 0!==i&&i,s=e.uri,a=e.duration,l=e.independent,d=e.byterange,h=e.gap;return u(this,n),r=t.call(this,"part"),c.PARAMCHECK(s),r.hint=o,r.uri=s,r.duration=a,r.independent=l,r.duration=a,r.byterange=d,r.gap=h,r}return n}(l);e.exports={Rendition:function e(t){var n=t.type,r=t.uri,i=t.groupId,o=t.language,s=t.assocLanguage,a=t.name,l=t.isDefault,d=t.autoselect,h=t.forced,f=t.instreamId,p=t.characteristics,_=t.channels;u(this,e),c.PARAMCHECK(n,i,a),c.CONDITIONALASSERT(["SUBTITLES"===n,r],["CLOSED-CAPTIONS"===n,f],["CLOSED-CAPTIONS"===n,!r],[h,"SUBTITLES"===n]),this.type=n,this.uri=r,this.groupId=i,this.language=o,this.assocLanguage=s,this.name=a,this.isDefault=l,this.autoselect=d,this.forced=h,this.instreamId=f,this.characteristics=p,this.channels=_},Variant:function e(t){var n=t.uri,r=t.isIFrameOnly,i=void 0!==r&&r,o=t.bandwidth,s=t.averageBandwidth,a=t.codecs,l=t.resolution,d=t.frameRate,h=t.hdcpLevel,f=t.audio,p=void 0===f?[]:f,_=t.video,m=void 0===_?[]:_,v=t.subtitles,g=void 0===v?[]:v,y=t.closedCaptions,E=void 0===y?[]:y,T=t.currentRenditions,S=void 0===T?{audio:0,video:0,subtitles:0,closedCaptions:0}:T;u(this,e),c.PARAMCHECK(n,o),this.uri=n,this.isIFrameOnly=i,this.bandwidth=o,this.averageBandwidth=s,this.codecs=a,this.resolution=l,this.frameRate=d,this.hdcpLevel=h,this.audio=p,this.video=m,this.subtitles=g,this.closedCaptions=E,this.currentRenditions=S},SessionData:function e(t){var n=t.id,r=t.value,i=t.uri,o=t.language;u(this,e),c.PARAMCHECK(n,r||i),c.ASSERT("SessionData cannot have both value and uri, shoud be either.",!(r&&i)),this.id=n,this.value=r,this.uri=i,this.language=o},Key:function e(t){var n=t.method,r=t.uri,i=t.iv,o=t.format,s=t.formatVersion;u(this,e),c.PARAMCHECK(n),c.CONDITIONALPARAMCHECK(["NONE"!==n,r]),c.CONDITIONALASSERT(["NONE"===n,!(r||i||o||s)]),this.method=n,this.uri=r,this.iv=i,this.format=o,this.formatVersion=s},MediaInitializationSection:function e(t){var n=t.hint,r=void 0!==n&&n,i=t.uri,o=t.mimeType,s=t.byterange;u(this,e),c.PARAMCHECK(i),this.hint=r,this.uri=i,this.mimeType=o,this.byterange=s},DateRange:function e(t){var n=t.id,r=t.classId,i=t.start,o=t.end,s=t.duration,a=t.plannedDuration,l=t.endOnNext,d=t.attributes,h=void 0===d?{}:d;u(this,e),c.PARAMCHECK(n),c.CONDITIONALPARAMCHECK([!0===l,r]),c.CONDITIONALASSERT([o,i],[o,i<=o],[s,s>=0],[a,a>=0]),this.id=n,this.classId=r,this.start=i,this.end=o,this.duration=s,this.plannedDuration=a,this.endOnNext=l,this.attributes=h},SpliceInfo:function e(t){var n=t.type,r=t.duration,i=t.tagName,o=t.value;u(this,e),c.PARAMCHECK(n),c.CONDITIONALPARAMCHECK(["OUT"===n,r]),c.CONDITIONALPARAMCHECK(["RAW"===n,i]),this.type=n,this.duration=r,this.tagName=i,this.value=o},Playlist:d,MasterPlaylist:h,MediaPlaylist:f,Segment:p,PartialSegment:_,RenditionReport:function e(t){var n=t.uri,r=t.lastMSN,i=t.lastPart;u(this,e),c.PARAMCHECK(n),this.uri=n,this.lastMSN=r,this.lastPart=i}}},771:e=>{function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(e,t)||r(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw s}}}}function r(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var o={};function s(e){if(o.strictMode)throw e;o.silent}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;if("number"==typeof e)return e;var n=10===t?Number.parseFloat(e,t):Number.parseInt(e,t);return Number.isNaN(n)?0:n}e.exports={THROW:s,ASSERT:function(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var a,u=n(i.entries());try{for(u.s();!(a=u.n()).done;){var c=t(a.value,2),l=c[0],d=c[1];d||s(new Error("".concat(e," : Failed at [").concat(l,"]")))}}catch(e){u.e(e)}finally{u.f()}},CONDITIONALASSERT:function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];var o,a=n(r.entries());try{for(a.s();!(o=a.n()).done;){var u=t(o.value,2),c=u[0],l=t(u[1],2),d=l[0],h=l[1];d&&(h||s(new Error("Conditional Assert : Failed at [".concat(c,"]"))))}}catch(e){a.e(e)}finally{a.f()}},PARAMCHECK:function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];var o,a=n(r.entries());try{for(a.s();!(o=a.n()).done;){var u=t(o.value,2),c=u[0],l=u[1];void 0===l&&s(new Error("Param Check : Failed at [".concat(c,"]")))}}catch(e){a.e(e)}finally{a.f()}},CONDITIONALPARAMCHECK:function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];var o,a=n(r.entries());try{for(a.s();!(o=a.n()).done;){var u=t(o.value,2),c=u[0],l=t(u[1],2),d=l[0],h=l[1];d&&void 0===h&&s(new Error("Conditional Param Check : Failed at [".concat(c,"]")))}}catch(e){a.e(e)}finally{a.f()}},INVALIDPLAYLIST:function(e){s(new Error("Invalid Playlist : ".concat(e)))},toNumber:a,hexToByteSequence:function(e){(e.startsWith("0x")||e.startsWith("0X"))&&(e=e.slice(2));for(var t=[],n=0;n<e.length;n+=2)t.push(a(e.slice(n,n+2),16));return Buffer.from(t)},byteSequenceToHex:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;n<=t&&s(new Error("end must be larger than start : start=".concat(t,", end=").concat(n)));for(var r=[],i=t;i<n;i++)r.push("0".concat((255&e[i]).toString(16).toUpperCase()).slice(-2));return"0x".concat(r.join(""))},tryCatch:function(e,t){try{return e()}catch(e){return t(e)}},splitAt:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=-1,i=0,o=0;i<e.length;i++)if(e[i]===t){if(o++===n)return[e.slice(0,i),e.slice(i+1)];r=i}return-1!==r?[e.slice(0,r),e.slice(r+1)]:[e]},trim:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e?(e=e.trim()," "===t||(e.startsWith(t)&&(e=e.slice(1)),e.endsWith(t)&&(e=e.slice(0,-1))),e):e},splitByCommaWithPreservingQuotes:function(e){for(var t=[],n=!0,r=0,i=[],o=0;o<e.length;o++){var s=e[o];n&&","===s?(t.push(e.slice(r,o).trim()),r=o+1):'"'!==s&&"'"!==s||(n?(i.push(s),n=!1):s===i[i.length-1]?(i.pop(),n=!0):i.push(s))}return t.push(e.slice(r).trim()),t},camelify:function(e){var t,r=[],i=!1,o=n(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;"-"!==s&&"_"!==s?i?(r.push(s.toUpperCase()),i=!1):r.push(s.toLowerCase()):i=!0}}catch(e){o.e(e)}finally{o.f()}return r.join("")},formatDate:function(e){var t=e.getUTCFullYear(),n=("0"+(e.getUTCMonth()+1)).slice(-2),r=("0"+e.getUTCDate()).slice(-2),i=("0"+e.getUTCHours()).slice(-2),o=("0"+e.getUTCMinutes()).slice(-2),s=("0"+e.getUTCSeconds()).slice(-2),a=("00"+e.getUTCMilliseconds()).slice(-3);return"".concat(t,"-").concat(n,"-").concat(r,"T").concat(i,":").concat(o,":").concat(s,".").concat(a,"Z")},hasOwnProp:function(e,t){return Object.hasOwnProperty.call(e,t)},setOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o=Object.assign(o,e)},getOptions:function(){return Object.assign({},o)}}}},t={},function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}(851);var e,t}()}));const Pi={},Di={variant:0,audio:0,subtitles:0};let Oi=function(e){function t(t,n){var r;return(r=e.call(this,t)||this).type=r.type.toLowerCase(),r.index=Di[r.type]++,r.id=r.uri,r.label=r.name,r.codecs=Mi(n,r.type),r.url=null,r.playlist=null,r}return ge(t,e),t.prototype.getSegmentBySN=function(e){return this.playlist.getSegmentBySN(e)},pe(t,[{key:"mimeType",get:function(){return this.playlist&&xi(this.playlist.segments[0].uri,this.type)}},{key:"initSegment",get:function(){const e=this;return{get url(){var t;return null==(t=e.playlist)?void 0:t.initSegment.url}}}},{key:"segments",get:function(){var e;return(null==(e=this.playlist)?void 0:e.segments)||[]}},{key:"targetDuration",get:function(){var e;return null==(e=this.playlist)?void 0:e.targetDuration}},{key:"hasProgramDateTime",get:function(){return this.playlist.hasProgramDateTime}},{key:"age",get:function(){var e;return null==(e=this.playlist)?void 0:e.age}},{key:"edge",get:function(){var e;return null==(e=this.playlist)?void 0:e.edge}},{key:"parts",get:function(){var e;return(null==(e=this.playlist)?void 0:e.parts)||[]}},{key:"partTargetDuration",get:function(){var e;return null==(e=this.playlist)?void 0:e.partTargetDuration}},{key:"lowLatencyCompatibility",get:function(){return this.playlist.lowLatencyCompatibility}}]),t}(ki.types.Rendition),Li=function(e){function t(t){var n,r,i;return(i=e.call(this,t)||this).audio=i.audio.map(e=>Pi[e.uri]||(Pi[e.uri]=new Oi(e,i.codecs))),i.subtitles=i.subtitles.map(e=>Pi[e.uri]||(Pi[e.uri]=new Oi(e,i.codecs))),i.type="video",i.index=Di.variant++,i.id=i.uri,i.bitrate=i.bandwidth,i.avg_bitrate=i.averageBandwidth,i.framerate=i.frameRate||30,i.height=null==(n=i.resolution)?void 0:n.height,i.width=null==(r=i.resolution)?void 0:r.width,i.codecs=function(e,t="avc1.42E01E,mp4a.40.2"){return e?t:Mi(t,"video")}(!i.audio.length,t.codecs),i.url=null,i.playlist=null,i}return ge(t,e),t.prototype.getSegmentBySN=function(e){return this.playlist.getSegmentBySN(e)},pe(t,[{key:"mimeType",get:function(){return this.playlist&&xi(this.playlist.segments[0].uri,"video")}},{key:"initSegment",get:function(){const e=this;return{get url(){var t;return null==(t=e.playlist)?void 0:t.initSegment.url}}}},{key:"segments",get:function(){var e;return(null==(e=this.playlist)?void 0:e.segments)||[]}},{key:"targetDuration",get:function(){var e;return null==(e=this.playlist)?void 0:e.targetDuration}},{key:"hasProgramDateTime",get:function(){return this.playlist.hasProgramDateTime}},{key:"age",get:function(){var e;return null==(e=this.playlist)?void 0:e.age}},{key:"edge",get:function(){var e;return null==(e=this.playlist)?void 0:e.edge}},{key:"parts",get:function(){var e;return(null==(e=this.playlist)?void 0:e.parts)||[]}},{key:"partTargetDuration",get:function(){var e;return null==(e=this.playlist)?void 0:e.partTargetDuration}},{key:"lowLatencyCompatibility",get:function(){return this.playlist.lowLatencyCompatibility}}]),t}(ki.types.Variant),Ci=function(e){function t(t){var n;return(n=e.call(this,t)||this).variants=n.variants.map(e=>new Li(e)),n}return ge(t,e),pe(t,[{key:"video",get:function(){return this.variants}},{key:"audio",get:function(){return Ce(Ne(this.variants,e=>e.audio))}},{key:"subtitles",get:function(){return Ce(Ne(this.variants,e=>e.subtitles))}},{key:"captions",get:function(){return this.subtitles}}]),t}(ki.types.MasterPlaylist);const Ni={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/]};function Mi(e="avc1.42E01E,mp4a.40.2",t){const n=e.split(","),r=Ni[t.toLowerCase()]||[];return n.find(e=>r.some(t=>t.test(e.trim())))}function xi(e,t){const n=e.split(".").pop().split("?")[0],r={fmp4:"mp4",m4s:"mp4",ts:"mp2t"}[n]||n||"mp4";return`${t.toLowerCase()}/${r}`}const Ui=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(kh){return Promise.reject(kh)}}}((function(e){let t=!1;return function(n,r){var i=function(){if(/json=1/.test(e))return t=!0,function(e,t,n){return e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e}(kt(e).json(),(function(e){return e.url}))}();return i&&i.then?i.then(r):r(i)}(0,(function(n){return t?n:e}))}));function Fi(e){return e.substr(0,e.lastIndexOf("/")+1)}function ji(e,t){if(t)return/^https?:\/\//.test(t)?t:e+t}function Vi(e){const t=window.atob(e),n=t.length,r=new Uint8Array(n);for(let i=0;i<n;i++)r[i]=t.charCodeAt(i);return r}const Bi={};let Hi=function(e){function t(t,{url:n,type:r,index:i}){var o;return(o=e.call(this,t)||this).url=n,o.type=r,o.stream=i,o.advancedDateTime=0,o.misses=0,o.parts=null,o.initSegment=t.segments[0].map||{uri:t.segments[0].uri},o.initSegment.url=ji(Fi(o.url),o.initSegment.uri),function(e,t){let n=(t.segments[0].mediaSequenceNumber||0)*t.targetDuration,r=-1;e.segments=[],e.parts=[],t.segments.forEach((i,o)=>{var s,a;if(void 0===i.mediaSequenceNumber)throw new Error("No valid segment sequence number found");let u=ji(Fi(e.url),i.uri);const c=(null==(s=Bi[u])?void 0:s.update(i))||new Xi(ve(ve({},i),{},{type:e.type,stream:e.stream,targetDuration:t.targetDuration,url:u,start:n}));u&&(Bi[u]=c);const l=i.parts.map((n,r)=>{var i;return u=ji(Fi(e.url),n.uri),(null==(i=Bi[u])?void 0:i.update(n))||(Bi[u]=new qi(ve(ve({},n),{},{type:e.type,stream:e.stream,partTargetDuration:t.partTargetDuration,mediaSequenceNumber:c.mediaSequenceNumber,url:u,part:r})))});c.parts=l,(a=e.parts).push.apply(a,Re(l)),function(e,t){e.programDateTime?e.programDateTime=new Date(e.programDateTime).getTime():(null==t?void 0:t.programDateTime)&&(e.programDateTime=t.endProgramDateTime),Number.isFinite(e.programDateTime)||(e.programDateTime=null)}(c,e.segments[e.segments.length-1]),c.programDateTime&&-1===r&&(r=e.segments.length),n+=c.duration||0,e.segments.push(c)}),r>0&&function(e,t){let n=e[t];for(let r=t;r--;){const t=e[r];if(!t)return;t.programDateTime=n.programDateTime-1e3*t.duration,n=t}}(e.segments,r)}(we(o),t),o}ge(t,e);var n=t.prototype;return n.reloaded=function(e){if(!e)return this.advanced=!0,void(this.updated=!0);const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t,this.advanced=this.endSN>e.endSN||t>0||0===t&&n>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1,this.timeOffset=e.timeOffset},n.getSegmentBySN=function(e){return this.segments.find(t=>t.mediaSequenceNumber===e)},pe(t,[{key:"availableParts",get:function(){var e;return(null==(e=this.parts)?void 0:e.length)?this.parts.filter(e=>!e.hint):[]}},{key:"timeOffset",get:function(){return this._timeOffset||0},set:function(e){this._timeOffset=e,this.segments.forEach(t=>{t.timeOffset=e})}},{key:"segmentEnd",get:function(){var e;return(null==(e=this.segments)?void 0:e.length)?this.segments[this.segments.length-1].end:0}},{key:"segmentEndPDT",get:function(){var e;return(null==(e=this.segments)?void 0:e.length)?this.segments[this.segments.length-1].programDateTime:0}},{key:"endSN",get:function(){var e;return(null==(e=this.segments)?void 0:e.length)?this.segments[this.segments.length-1].mediaSequenceNumber:0}},{key:"hasProgramDateTime",get:function(){return!!this.segments.length&&Number.isFinite(this.segmentEndPDT)}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"partEnd",get:function(){var e;return(null==(e=this.parts)?void 0:e.length)?this.parts[this.parts.length-1].end:0}},{key:"lastPartIndex",get:function(){var e;return(null==(e=this.parts)?void 0:e.length)?this.parts[this.parts.length-1].part:-1}},{key:"lastAvailablePartIndex",get:function(){var e;return(null==(e=this.availableParts)?void 0:e.length)?this.availableParts[this.availableParts.length-1].part:-1}},{key:"lastPartSn",get:function(){var e;return(null==(e=this.parts)?void 0:e.length)?this.parts[this.parts.length-1].mediaSequenceNumber:this.endSN}},{key:"lastAvailablePartSn",get:function(){var e;return(null==(e=this.availableParts)?void 0:e.length)?this.availableParts[this.availableParts.length-1].mediaSequenceNumber:this.endSN}},{key:"edge",get:function(){return this.partEnd||this.segmentEnd}}]),t}(ki.types.MediaPlaylist),Xi=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=t.type,n.stream=t.stream,n.targetDuration=t.targetDuration,n.start=t.start,n.parts=t.parts,n.url=t.url,n}ge(t,e);var n=t.prototype;return n.getPart=function(e){return e>=0&&e<this._parts.length?this._parts[e]:null},n._linkParts=function(){var e;if((null==(e=this._parts)?void 0:e.length)>1&&!0===this._parts[0].independent&&!this._parts[1].independent){var t;let e;null==(t=this._parts)||t.forEach(t=>{t.dependentOn=!0===t.independent?null:e,e=t})}},n._syncPartsWithStart=function(){var e;let t=this._start;null==(e=this._parts)||e.forEach(e=>{e.start=t,t+=e.duration||e.partTargetDuration||0})},n._syncPartsWithPDT=function(){var e;let t=this.programDateTime;null==(e=this._parts)||e.forEach(e=>{e.programDateTime=t,t+=1e3*(e.duration||e.partTargetDuration||0)})},n.update=function({uri:e}){return this.uri=e,this},pe(t,[{key:"timeOffset",get:function(){return this._timeOffset||0},set:function(e){this._timeOffset=e,this.parts.forEach(t=>{t.timeOffset=e})}},{key:"start",set:function(e){this._start=e,this._syncPartsWithStart()},get:function(){return this._start+this.timeOffset}},{key:"programDateTime",set:function(e){this._programDateTime=e,this._syncPartsWithPDT()},get:function(){return this._programDateTime}},{key:"parts",set:function(e){this._parts=e,this._linkParts(),this._syncPartsWithStart(),this._syncPartsWithPDT()},get:function(){return this._parts}},{key:"segment",get:function(){return this.mediaSequenceNumber}},{key:"end",get:function(){return this.start+(this.duration||this.targetDuration||0)}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!Number.isFinite(this.programDateTime))return null;const e=Number.isFinite(this.duration)?this.duration:0;return this.programDateTime+1e3*e}}]),t}(ki.types.Segment),qi=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=t.type,n.stream=t.stream,n.partTargetDuration=t.partTargetDuration,n.start=t.start,n.url=t.url,n.mediaSequenceNumber=t.mediaSequenceNumber,n.part=t.part,n.programDateTime=null,n.timeOffset=0,n.dependentOn=null,n}return ge(t,e),t.prototype.update=function({hint:e,duration:t,independent:n}){return this.hint=e,this.duration=t,this.independent=n,this},pe(t,[{key:"segment",get:function(){return this.mediaSequenceNumber}},{key:"start",set:function(e){this._start=e},get:function(){return this._start+this.timeOffset}},{key:"end",get:function(){return this.start+(this.duration||this.partTargetDuration||0)}}]),t}(ki.types.PartialSegment);function Wi(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function Gi(e,t){try{var n=e()}catch(kh){return t(kh)}return n&&n.then?n.then(void 0,t):n}function Ki(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(kh){return Promise.reject(kh)}}}function Yi(){}function $i(e,t){if(!t)return e&&e.then?e.then(Yi):Promise.resolve()}const zi=Ki((function(e){return Wi(kt(e).json(),(function(e){return Ui(e.url.hls)}))}));ki.setOptions({silent:!0});let Qi=function(){function e(e,t,n){this.lowLatencyMode=e.lowLatencyMode,this.dvrEnabled=e.dvrEnabled,this.disableDeltaUpdates=e.disableDeltaUpdates,this._masterLoader=e,this._oldPlaylist=null==n?void 0:n._oldPlaylist,this._type=t,this._expirationTime=1/0,this.alive=!0}var t=e.prototype;return t.update=function(e,t,n){try{const r=this;if(!e||!r.alive)return;return Gi((function(){return Wi(r._requestPromise,(function(){var i,o,s,a;e.url=ji(r.baseUrl,e.uri);const u=new URL(e.url).searchParams;r.dvrEnabled||null!==u.get("max_segments")||(e.url=it(e.url,{max_segments:10}));const c=(null==(i=e.playlist)||null==(o=i.lowLatencyCompatibility)?void 0:o.canSkipUntil)||0;return(null!==(s=null==(a=e.playlist)?void 0:a.age)&&void 0!==s?s:1/0)<c/2&&!r.disableDeltaUpdates&&(n=ve(ve({},n),{},{_HLS_skip:"YES"})),r._requestPromise=kt(e.url,{searchParams:n,retryStatus:eo,type:de.MANIFEST,retry:3,hooks:{beforeRequest:r._isExpired()?[r._beforeRetry(e)]:[],beforeRetry:[r._beforeRetry(e)]}}),Wi(r._requestPromise,(function(n){return Wi(n.text(),(function(i){var o;const s=ki.parse(i),a=new Hi(s,e),u=a.skip>0?r._mergeDeltaPlaylistUpdates(e.playlist,a):a;if(e.playlist=u,e.playlist.advancedDateTime=Date.now()-n.perfTimings.duration,e.playlist.reloaded(r._oldPlaylist),r._oldPlaylist=e.playlist,r._masterLoader.fire("1",e,t),r.lowLatencyMode&&(null==(o=e.playlist.lowLatencyCompatibility)?void 0:o.canBlockReload)){const t=a.lastAvailablePartIndex,n=-1!==t?a.lastAvailablePartSn:a.endSN+1,i=-1!==t?t+1:void 0;r.update(e,!1,{_HLS_msn:n,_HLS_part:i})}else if(r.alive){clearTimeout(r._timer);const t=function(e,t){return 1e3*(t&&e.partTargetDuration||e.targetDuration)}(e,r.lowLatencyMode);r._timer=setTimeout(()=>r.update(e),t)}}))}))}))}),(function(e){e instanceof ut||r._masterLoader.fire("2",e)}))}catch(kh){return Promise.reject(kh)}},t.stop=function(){var e;clearTimeout(this._timer),null==(e=this._requestPromise)||e.abort(),this._requestPromise=null,this.alive=!1},t._isExpired=function(){return this._expirationTime&&this._expirationTime-1e4<=Date.now()},t._beforeRetry=function(e){const t=this;return Ki((function(n,r){return Wi(t._masterLoader.refreshBaseUrl(),(function(r){n.url=ji(r,e.uri),t._expirationTime=function(e){const t=rt(e),n=t&&t.pathname.match(/^\/(exp=)?(\d{10,})/);return n&&1e3*n[2]}(n.url)}))}))},t._mergeDeltaPlaylistUpdates=function(e,t){e.mediaSequenceBase<t.mediaSequenceBase&&(e.segments=e.segments.filter(e=>e.mediaSequenceNumber>=t.mediaSequenceBase));const n=t.segments.filter(t=>t.mediaSequenceNumber>e.endSN);return t.segments=[].concat(Re(e.segments),Re(n)),t},pe(e,[{key:"baseUrl",get:function(){var e;return null==(e=this._masterLoader)?void 0:e.baseUrl}}]),e}();const Ji={disableDeltaUpdates:!1};let Zi=function(e){function t(t=Ji){var n;return(n=e.call(this)||this).video=new Qi(we(n),"video"),n.audio=new Qi(we(n),"audio"),n.subtitles=new Qi(we(n),"subtitles"),n._disableDeltaUpdates=t.disableDeltaUpdates,n._activeStreamIndex={},n}ge(t,e);var n=t.prototype;return n.start=function(e,t){try{const n=this;return n._refreshUrl=t,Wi(Ui(e),(function(e){return n._masterPlaylistUrl=e,Wi(n._fetchMasterPlaylist(n._masterPlaylistUrl),(function(e){return n.manifest=new Ci(ki.parse(e)),n.manifest}))}))}catch(kh){return Promise.reject(kh)}},n.stop=function(){this.video.stop(),this.audio.stop(),this.subtitles.stop(),this.video=new Qi(this,"video",this.video),this.audio=new Qi(this,"audio",this.audio),this.subtitles=new Qi(this,"subtitles",this.subtitles)},n.update=function(e){try{const t=this;return Wi(t.video.update(t.activeStream("video"),e),(function(){return $i(Promise.all([t.audio.update(t.activeStream("audio"),e),t.subtitles.update(t.activeStream("subtitles"),e)]))}))}catch(kh){return Promise.reject(kh)}},n.switchTo=function(e,t){try{const n=this;if(t===n._activeStreamIndex[e])return;return n[e].stop(),n[e]=new Qi(n,e,n[e]),n._activeStreamIndex[e]=t,$i(n[e].update(n.activeStream(e),!0))}catch(kh){return Promise.reject(kh)}},n.activeStream=function(e){return this.manifest[e].find(({index:t})=>t===this._activeStreamIndex[e])},n.activeStreamIndex=function(e){return this._activeStreamIndex[e]},n.refreshBaseUrl=function(){try{const e=this;return Wi(zi(e._refreshUrl),(function(t){return e._masterPlaylistUrl=t,e.baseUrl}))}catch(kh){return Promise.reject(kh)}},n._fetchMasterPlaylist=function(e){try{let t=!1;const n=this;let r;return function(e,t){return e&&e.then?e.then(t):t(e)}(Gi((function(){const t={type:de.MANIFEST,retry:8,retryStatus:eo,hooks:{beforeRetry:[n._beforeRetryMasterPlaylist.bind(n)]}};return n.dvrEnabled||(t.searchParams={min_seconds:30}),Wi(kt(e,t).text(),(function(e){r=e}))}),(function(){throw new Error("Master playlist failed to load. Giving up updating after 8 attempts.")})),(function(e){return t?e:r}))}catch(kh){return Promise.reject(kh)}},n._beforeRetryMasterPlaylist=function(e,t,n){try{const t=this;return Wi(zi(t._refreshUrl),(function(n){t._masterPlaylistUrl=n,e.url=t._masterPlaylistUrl}))}catch(kh){return Promise.reject(kh)}},pe(t,[{key:"baseUrl",get:function(){return Fi(this._masterPlaylistUrl)}},{key:"lowLatencyMode",get:function(){var e;return!!(null==(e=this.video)?void 0:e.lowLatencyMode)},set:function(e){this.video.lowLatencyMode=e,this.audio.lowLatencyMode=e,this.subtitles.lowLatencyMode=e}},{key:"dvrEnabled",get:function(){var e;return!!(null==(e=this.video)?void 0:e.dvrEnabled)},set:function(e){this.video.dvrEnabled=e,this.audio.dvrEnabled=e,this.subtitles.dvrEnabled=e}},{key:"disableDeltaUpdates",get:function(){return this._disableDeltaUpdates}}]),t}(er);function eo(e){return[403,404,410].includes(e)||he.retryStatus(e)}const to=["width","height","bandwidth","duration","timescale","presentationTimeOffset"];function no(e){const t={};for(let n=0;n<e.length;n++){const r=e[n].nodeName;let i=e[n].nodeValue;-1!==to.indexOf(r)&&(i=parseInt(i,10)),"duration"===r&&isNaN(i)&&(i=uo(e[n].nodeValue)),t[r]=i}return t}function ro(e,t,n){return Array.prototype.filter.call(e.childNodes,(function(e){return e instanceof Element&&e.localName===n&&e.namespaceURI===t}))}function io(e,t){return e.hasAttribute(t)?e.getAttribute(t):null}function oo(e,t,n){return e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}function so(e=""){let t,n;return n=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1]/t[2]):Number(e),isNaN(n)?null:n}function ao(e){return Array.prototype.every.call(e.childNodes,e=>e.nodeType===Node.TEXT_NODE||e.nodeType===Node.CDATA_SECTION_NODE)?e.textContent.trim():null}function uo(e){if(!e)return null;const t=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/.exec(e);let n=31536e3*parseFloat(t[2]||0)+2592e3*parseFloat(t[4]||0)+86400*parseFloat(t[6]||0)+3600*parseFloat(t[8]||0)+60*parseFloat(t[10]||0)+parseFloat(t[12]||0);return void 0!==t[1]&&(n=-n),n}const co={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"};var lo=Object.freeze({__proto__:null,fetchMasterPlaylistUrl:Ui,PLAYLIST_UPDATE:"1",PLAYLIST_ERROR:"2",M3U8Loader:Zi,Rendition:Oi,Variant:Li,M3U8Manifest:Ci,convertTsCodecs:function(e){let t=e.replace(/mp2t/i,"mp4");const n=/avc1\.(66|77|100)\.(\d+)/.exec(t);if(n){let e="avc1.";const r=n[1];e+="66"===r?"4200":"77"===r?"4d00":"6400";const i=Number(n[2]);e+=(i>>4).toString(16),e+=(15&i).toString(16),t=t.replace(n[0],e)}return t},parseMPD:function(e,t){let n,r,i,o,s,a;function u(e,t){const n=e[0].adaptationSets.find(e=>e.mimeType?0===e.mimeType.indexOf(t):e.representations.find(e=>0===e.mimeType.indexOf(t)))||{};return(n.representations||[]).map(e=>{var t;return ve(ve({},e),{},{base_url:"",bitrate:e.bandwidth,duration:i,framerate:so(e.frameRate),init_segment:e.initSegment,max_segment_duration:o,mime_type:null!==(t=n.mimeType)&&void 0!==t?t:e.mimeType})})}function c(e,t){const n=[];for(let r=0;r<e.length;r++){const i=no(e[r].attributes),o=e[r].getElementsByTagName("Representation");i.representations=l(o,t),i.frameRate&&i.representations.forEach(e=>{e.framerate=parseInt(i.frameRate,10)}),1===i.representations.length&&(i.width&&(i.representations[0].width=i.width),i.height&&(i.representations[0].height=i.height)),n.push(i)}return n}function l(e,t){const n=[];for(let r=0;r<e.length;r++){const i=no(e[r].attributes),o=e[r].getElementsByTagName("SegmentList")[0];let s="";e[r].getElementsByTagName("BaseURL")[0]&&(s=e[r].getElementsByTagName("BaseURL")[0].textContent),o&&Object.assign(i,h(o,s,t));const a=e[r].getElementsByTagName("SegmentTemplate")[0];a&&Object.assign(i,d(a,i)),n.push(i)}return n}function d(e,t){const n=e.getElementsByTagName("S")[0],r=e.getElementsByTagName("S"),i=no(e.attributes);i.startNumber=parseInt(i.startNumber,10),Number.isNaN(i.startNumber)&&(i.startNumber=1),i.timescale=parseInt(i.timescale,10)||1,i.initSegment=i.initialization.replace("$RepresentationID$",t.id),i.segments=[];let o=io(n,"t")/i.timescale,s=i.startNumber;for(let a=0;a<r.length;a++){const e=r[a],n=io(e,"d")/i.timescale,u=parseInt(io(e,"r")||0,10)+1;for(let r=0;r<u;r++){const e=o+n,r=i.media.replace("$RepresentationID$",t.id).replace("$Time$",o).replace("$Number$",s);i.segments.push({url:r,start:o,end:e,index:s}),o+=n,s+=1}}return i}function h(e,t,n){const r=e.getElementsByTagName("Initialization")[0],i=e.getElementsByTagName("SegmentURL"),o=no(e.attributes);o.startNumber=parseInt(o.startNumber,10),o.initSegment=t+io(r,"sourceURL"),o.segments=[];let s=0;const a=o.duration/o.timescale;for(let u=0;u<i.length;u++){let e=s+a;if(e>n){if(u!==i.length-1)throw new Error("segment list duration is greater than the period's duraton");e=s+(n-s)}const r=io(i[u],"media");o.segments.push({url:t+r,start:s,end:e}),s+=a}return o}return function(){const l=(new DOMParser).parseFromString(e,"application/xml");n=l.getElementsByTagName("MPD")[0],r=function(){const e=function(e,t){let n=function(e,t){return Array.prototype.filter.call(e.childNodes,(function(e){return e instanceof Element&&e.tagName===t}))}(e,t);return 1!==n.length?null:n[0]}(n,"BaseURL");return e&&ao(e)||t.substr(0,t.lastIndexOf("/")+1)}(),i=uo(io(n,"mediaPresentationDuration")),o=uo(io(n,"maxSegmentDuration"));const d=function(){const e=[],t=n.getElementsByTagName("Period");for(let n=0;n<t.length;n++){const r=no(t[n].attributes),i=t[n].getElementsByTagName("AdaptationSet");r.adaptationSets=c(i,r.duration),e.push(r)}return e}();return d.length&&(s=u(d,"video"),a=u(d,"audio")),ve(ve({},function(){const e="urn:mpeg:cenc:2013",t=n.getElementsByTagName("ContentProtection");let r,i=[],o={};for(const n in t){const s=t[n];if(!(s instanceof Element))continue;let a=io(s,"schemeIdUri");a&&co[a]&&i.push(co[a]),r||(r=oo(s,e,"default_KID"));const u=ro(s,e,"pssh").map(ao);let c=[];try{c=u.map(e=>({initDataType:"cenc",initData:Vi(e)}))}catch(kh){throw new Error("Bad pshh encoding")}c.length>0&&(o[co[a]]=o[co[a]]||{},o[co[a]].cenc=c[0]);const l=ro(s,"usn:microsoft:playready","pro").map(ao);c=[];try{c=l.map(e=>({initDataType:"mspr",initData:Vi(e)}))}catch(kh){throw new Error("Bad pro encoding")}c.length>0&&(o[co[a]]=o[co[a]]||{},o[co[a]].mspr=c[0])}return r?{is_drm:!0,key_info:{cdms:Re(new Set(i)),key_id:r,inits:o}}:{}}()),{},{audio:a,video:s,mediaPresentationDuration:i,maxSegmentDuration:o,baseUrl:r,base_url:r,get profiles(){return io(n,"profiles")},get type(){return io(n,"type")},get minimumUpdatePeriod(){return uo(io(n,"minimumUpdatePeriod"))},get publishTime(){return io(n,"publishTime")},get availabilityStartTime(){return io(n,"availabilityStartTime")},get timeShiftBufferDepth(){return uo(io(n,"timeShiftBufferDepth"))},get suggestedPresentationDelay(){return uo(io(n,"suggestedPresentationDelay"))},get minBufferTime(){return uo(io(n,"minBufferTime"))}})}()}});let ho=function(e){function t(t){var n;return(n=e.call(this,t)||this)._videoElement=document.createElement("video"),n._videoElement.setAttribute("data-airplay",""),n._videoElement.setAttribute("x-webkit-airplay","allow"),n.addVideoEventListeners(),n}ge(t,e),pe(t,null,[{key:"displayName",get:function(){return"AirPlayExternalDisplay"}},{key:"supported",get:function(){return"WebKitPlaybackTargetAvailabilityEvent"in window}},{key:"supportedVideoTypes",get:function(){return["application/vnd.apple.mpegurl","video/mp4"]}}]);var n=t.prototype;return n.addVideoEventListeners=function(e=this._videoElement){e.addEventListener(vi.LOADED_METADATA,e=>{this.fire(vi.LOADED_METADATA,e)}),e.addEventListener("webkitplaybacktargetavailabilitychanged",e=>{switch(e.availability){case"available":this._available||(this._available=!0,this.fire(Ei.AIRPLAY_AVAILABLE));break;case"not-available":this._available&&(this._available=!1,this.fire(Ei.AIRPLAY_UNAVAILABLE))}}),e.addEventListener("webkitcurrentplaybacktargetiswirelesschanged",e=>{if(e.target.webkitCurrentPlaybackTargetIsWireless)return this._active=!0,void this.fire(Ei.AIRPLAY_ACTIVATED);this._active=!1,this.fire(Ei.AIRPLAY_DEACTIVATED)})},n.showPicker=function(){this._videoElement.webkitShowPlaybackTargetPicker(),this.loadMetadata().then(()=>this._videoElement.webkitShowPlaybackTargetPicker()).catch(()=>{})},n.loadMetadata=function(){try{const e=this;return e._videoElement.readyState>=1?Promise.resolve():new Promise(function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(kh){return Promise.reject(kh)}}}((function(t,n){return e._videoElement.addEventListener(vi.LOADED_METADATA,()=>{t()}),function(e,t,n){return e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e}(Ui(e.getFile().src),(function(t){e._videoElement.src=t}))})))}catch(kh){return Promise.reject(kh)}},pe(t,[{key:"element",get:function(){return this._videoElement},set:function(e){if(!(e instanceof HTMLVideoElement))throw new TypeError("The element for AirPlay must be a <video>.");e!==this._videoElement&&(this.addVideoEventListeners(e),this._videoElement=e,this._videoElement.setAttribute("x-webkit-airplay","allow"))}}]),t}(mi);(()=>{const e=navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\./);e&&(parseInt(e[1],10),parseInt(e[2],10))})();const fo=function(e){for(let t=0,n=this.length;t<n;t++)if(this[t].id===`${e}`)return this[t];return null};function po(e=[]){return e.item=function(e){return this[e]},e.getTrackById=fo,e}function _o(e){const t=window.atob(e),n=t.length,r=new Uint8Array(n);for(let i=0;i<n;i++)r[i]=t.charCodeAt(i);return r}function mo(e,t,n,r){let i=0,o=0,s=0,a=0;const u=e,c=t,l=n/r;return u/c>=l?(o=c,i=(l*c).toFixed(2)):(i=u,o=(u/l).toFixed(2)),s=Math.max((u-i)/2,0),a=Math.max((c-o)/2,0),{width:i,height:o,left:s,top:a}}function vo(e){if(function(e){return"webkitDisplayingFullscreen"in e&&e.webkitDisplayingFullscreen}(e))return!0;const t=[document.fullscreenElement,document.webkitFullscreenElement,document.webkitCurrentFullScreenElement,document.mozFullScreenElement,document.msFullscreenElement].find(e=>void 0!==e);return Boolean(t)}function go(e,t){let n=e;return t&&(n+=`;codecs="${t}"`),n}function yo(e,t=3){if(e=parseFloat(e),isNaN(e))return 0;const n=Math.pow(10,t);return Math.round(e*n)/n}let Eo=function(e,t){this.name=e,this.message=t,Object.freeze(this)};const To=new WeakMap;let So=function(){function e(e,t={}){const n=parseFloat(e);if(isNaN(n))throw new TypeError("Time must be a number.");if(n<0)throw new TypeError("Time must be a positive number.");this.time=e,this.data=t,this.id=st();try{const n="undefined"==typeof VTTCue?TextTrackCue:VTTCue;this.vttCue=new n(e,e+.25,JSON.stringify(t)),this.vttCue.id=this.id}catch(kh){throw new Eo("CuePointsNotSupported","Cue points are not supported in this browser.")}To.set(this.vttCue,this),Object.freeze(this)}return e.fromVTTCue=function(t){if(To.has(t))return To.get(t);let n={};try{n=JSON.parse(t.text)}catch(kh){}return new e(t.startTime,n)},e}();function bo(e,t,n){let r;try{document.removeChild({})}catch(kh){r=Object.create(Object.getPrototypeOf(kh),{name:{value:t,configurable:!0,writable:!0},code:{value:e,configurable:!0,writable:!0},message:{value:n,configurable:!0,writable:!0},toString:{value:()=>`${t}: DOM Exception ${e}`,configurable:!0,writable:!0}})}return Object.freeze(r)}const Ao=(e,t)=>{if(!e||void 0===e[t])throw bo(1,"INDEX_SIZE_ERR");return e[t]};function wo(e=[],t=[]){return Object.freeze({get length(){return e.length},start:t=>Ao(e,t),end:e=>Ao(t,e),[Symbol.iterator]:()=>function(e,t){let n=0;return{[Symbol.iterator](){return this},next:()=>n<e.length?{done:!1,value:t?[e[n],t[n++]]:e[n++]}:{done:!0}}}(e,t)})}wo.from=function(e){if(!(e instanceof TimeRanges))throw new TypeError("Can only create a TelecineTimeRange from a TimeRanges object.");const t=[],n=[];for(let r=0,i=e.length;r<i;r++)t.push(e.start(r)),n.push(e.end(r));return wo(t,n)};const Ro="DRMFailure",Io="MediaUrlBadRequest",ko="PlayInterrupted",Po="TextTracksNotSupported";function Do(){}const Oo=document.createElement("video"),Lo={"application/vnd.apple.mpegurl":"application/vnd.apple.mpegurl","video/mp4":'video/mp4; codecs="avc1.64001E"',"video/webm":'video/webm; codecs="vp8, vorbis"',"video/x-flv":'video/x-flv; codecs="vp6"'},Co=function(){const e="undefined"==typeof TextTrack?{}:TextTrack;return{disabled:"DISABLED"in e?e.DISABLED:"disabled",hidden:"HIDDEN"in e?e.HIDDEN:"hidden",showing:"SHOWING"in e?e.SHOWING:"showing"}}(),No=function(){const e=document.createElement("track");return"track"in e&&"oncuechange"in e.track}(),Mo=new WeakMap;let xo=function(e){function t(t,n={}){var r;(r=e.call(this)||this)._element=t,r._options=n,r._telecineVideo=null,r._currentFile=null,r._externalDisplays=[];let i=t.querySelector("video");return i||(i=document.createElement("video"),i.preload="none",r._element.appendChild(i)),i.setAttribute("tabindex","-1"),r._video=i,n.playRequest&&(r._playRequest=n.playRequest,r._playRequest.video=i),n.htmlScanner&&n.htmlScanner.controls&&(r._video.controls=!0),r._boundHandleVideoEvent=r.handleVideoEvent.bind(we(r)),r._boundHandleAudioEvent=r.handleAudioEvent.bind(we(r)),r.addVideoEventListeners(),r.addAudioEventListeners(),r._preload="none",r._externalDisplayActivated=!1,r._inFullscreen=!1,r._lastCurrentTime=-1,r._switchingVideo=!1,r}ge(t,e),t.supported=function(){return t.supportedVideoTypes.length>0},pe(t,null,[{key:"displayName",get:function(){return"HTMLScanner"}},{key:"supportedVideoTypes",get:function(){const e=[];if("function"!=typeof Oo.canPlayType)return e;for(const t in Lo){const n=Lo[t];en.android&&"application/vnd.apple.mpegurl"===t||(en.android&&!en.mobileAndroid&&"video/mp4"===t&&en.android instanceof String?parseInt(en.android.split(".")[0],10)>3&&e.push(t):Oo.canPlayType(n).replace(/^no$/,"")&&e.push(t))}return e}},{key:"supportedAudioTypes",get:function(){return[]}},{key:"supportedExternalDisplays",get:function(){return[ho]}},{key:"supportsVideoElementAudioTracks",get:function(){return void 0!==Oo.audioTracks&&this.supportedVideoTypes.includes("application/vnd.apple.mpegurl")}}]);var n=t.prototype;return n.deactivate=function(){this._telecineVideo&&(this._telecineVideo.off(Ti.FILE_SRC_UPDATE),this._telecineVideo.off("texttracksrcupdate")),this.removeVideoEventListeners(),this.removeAudioEventListeners(),this._switchingVideo||this.removeSnapshot(),this._video.style.display="none"},n.reactivate=function(){this.addVideoEventListeners(),this.addAudioEventListeners(),this._video.style.display=""},n.addVideoEventListeners=function(e=this._video){Object.keys(vi).forEach(t=>{const n=vi[t];e.addEventListener(n,this._boundHandleVideoEvent)})},n.addAudioEventListeners=function(e=this._video){var t;(null==e?void 0:e.audioTracks)&&"function"==typeof(null==(t=e.audioTracks)?void 0:t.addEventListener)&&(e.audioTracks.addEventListener(gi.ADD_TRACK,this._boundHandleAudioEvent),e.audioTracks.addEventListener(gi.REMOVE_TRACK,this._boundHandleAudioEvent),e.audioTracks.addEventListener(gi.CHANGE,this._boundHandleAudioEvent))},n.removeVideoEventListeners=function(e=this._video){Object.keys(vi).forEach(t=>{const n=vi[t];e.removeEventListener(n,this._boundHandleVideoEvent)})},n.removeAudioEventListeners=function(e=this._video){var t;(null==e?void 0:e.audioTracks)&&"function"==typeof(null==(t=e.audioTracks)?void 0:t.removeEventListener)&&(e.audioTracks.removeEventListener(gi.ADD_TRACK,this._boundHandleAudioEvent),e.audioTracks.removeEventListener(gi.REMOVE_TRACK,this._boundHandleAudioEvent),e.audioTracks.removeEventListener(gi.CHANGE,this._boundHandleAudioEvent))},n.play=function(e){return this._playRequest.start(e).catch(e=>{throw this._onPlayError(e),e})},n._onPlayError=function(e){this.fire(vi.ERROR,new Eo(null==e?void 0:e.name,null==e?void 0:e.message))},n.pause=function(){this._playRequest.cancel(),this._video.pause()},n.onpause=function(){},n.ontimeupdate=function(){this._lastCurrentTime=this.currentTime},n.addTextTrack=function(e){let t,n;return e.src?(t=document.createElement("track"),t.kind=e.kind,t.src=e.src,t.id=`telecine-track-${e.id}`,t.srclang=e.language,t.label=e.label,this._video.appendChild(t),n=t.track):(n=this._video.addTextTrack(e.kind,e.label,e.language),this._textTracks=this._textTracks||{},this._textTracks[`telecine-track-${e.id}`]=n),this._addTextTrackListeners(e,n,t),n},n._addTextTrackListeners=function(e,t,n){t.addEventListener("cuechange",()=>e.dispatchEvent("cuechange")),this._video.addEventListener("timeupdate",()=>{vo(this._video)&&(e.mode=t.mode)});const r=()=>{const n=en.iOS&&vo(this._video);!e._modeHasBeenSet||n?e.mode=t.mode:t.mode=Co[e.mode]},i=[];if(n?n.addEventListener("load",r):r(),["loadeddata","seeking"].forEach(e=>{this._video.addEventListener(e,r),i.push([e,r])}),e._modeHasBeenSet&&(t.mode=Co[e.mode]),!No){let n=[];const r=()=>{if(t&&"disabled"!==Co[t.mode]){if(n.length!==t.activeCues.length)return e.dispatchEvent("cuechange"),void(n=Array.from(t.activeCues));for(let r=0,i=t.activeCues.length;r<i;r++)if(t.activeCues[r].startTime!==n[r].startTime)return e.dispatchEvent("cuechange"),void(n=Array.from(e.activeCues))}};this._video.addEventListener("timeupdate",r),i.push(["timeupdate",r])}return Mo.set(e,i),t},n.removeTextTrack=function(e){const t=this._video.querySelector(`#telecine-track-${e.id}`);t&&this._video.removeChild(t);const n=Mo.get(e);Array.isArray(n)&&n.forEach(([e,t])=>{this._video.removeEventListener(e,t)})},n.getCuesForTrack=function(e){const t=this.getTrackById(`telecine-track-${e.id}`);return t?Array.from(t.cues):[]},n.getActiveCuesForTrack=function(e){const t=this.getTrackById(`telecine-track-${e.id}`);return t&&t.activeCues?Array.from(t.activeCues):[]},n.setModeForTrack=function(e,t){const n=this.getTrackById(`telecine-track-${e.id}`);return n&&n.mode!==Co[t]&&(n.mode=Co[t],No||"disabled"===t||e.dispatchEvent("cuechange")),this},n.setSrcForTrack=function(e,t){const n=this._video.querySelector(`#telecine-track-${e.id}`);return n&&null===n.track.cues&&(n.src=t),this},n.enableAudioTrack=function(e){if(!this.constructor.supportsVideoElementAudioTracks||!this.audioTracks)return null;if(!e)return null;if(!this.audioTracks.getTrackById(e))return null;let t=null;for(let n=0;n<this.audioTracks.length;n++){const r=this.audioTracks[n].id===e;this.audioTracks[n].enabled=r,r&&(t=this.audioTracks[n])}return t},n._createChapterCue=function(e,t,n=null){let r;this._chaptersTrack||(this._chaptersTrack=this._video.addTextTrack("chapters"),this._chaptersTrack.mode="hidden");const i=e.timecode,o=n?n.timecode:t,s=window.VTTCue||window.TextTrackCue;try{r=new s(i,o,e.title)}catch(kh){throw new Eo("ChaptersNotSupported","Chapters are not supported in this browser.")}r.size=(o-i)/t,r.id=i,this._chaptersTrack.addCue(r)},n.addChapter=function(e,t){const n=this.video.chapters,r={timecode:e,title:t};n.push(r),n.sort((e,t)=>e.timecode-t.timecode);const i=n[n.indexOf(r)+1];this._createChapterCue(r,this.video.duration,i),this._updateChapterCues(this._chaptersTrack,this.video.duration)},n.removeChapter=function(e){try{this._chaptersTrack.removeCue(e)}catch(kh){throw new Eo("ChaptersNotSupported","Chapters are not supported in this browser.")}const t=this.video.chapters.find(t=>t.timecode===e.timecode);this.video.chapters.splice(t,1),this._updateChapterCues(this._chaptersTrack,this.video.duration)},n._updateChapterCues=function(e,t){for(let n=0;n<e.cues.length;n++){let r=e.cues[n],i=e.cues[n+1];const o=i?i.startTime:t;r.endTime=o,r.size=(o-r.startTime)/t}this.fire(Ti.CHAPTER_CUES_UPDATED)},n.addChapters=function(e,t){0!==e.length&&t&&(e=e.filter(e=>this._isValidChapter(e,t))).sort((e,t)=>e.timecode-t.timecode).forEach((n,r)=>this._createChapterCue(n,t,e[r+1]))},n.addCuePoint=function(e,t={}){if(this._cuePointTrack||(this._cuePointTrack=this._video.addTextTrack("metadata"),this._cuePointTrack.mode="hidden",this._cuePointTrack.addEventListener("cuechange",e=>{Array.from(e.target.activeCues).forEach(e=>{this.fire(Ti.CUE_POINT,So.fromVTTCue(e))})}),this._video.addEventListener("canplay",e=>{this._cuePointTrack.mode="hidden"})),e=parseFloat(e),isNaN(e))throw new TypeError("Time must be a number.");if(e<0||e>=this.duration)throw new TypeError("Time must be a positive number less than the duration of the video.");const n=new So(e,t);return this._cuePointTrack.addCue(n.vttCue),n},n.removeCuePoint=function(e){if(!e)throw new Eo("InvalidCuePoint","The specified cue point is not valid.");return this._cuePointTrack.removeCue(e.vttCue),!0},n.removeAllCuePoints=function(){return this._cuePointTrack&&this._cuePointTrack.length&&Array.from(this._cuePointTrack.cues).forEach(e=>{this._cuePointTrack.removeCue(e)}),!0},n.requestPictureInPicture=function(){try{const e=this;return function(t,n){var r=function(){if(e._video.readyState<1)return function(e,t){return e&&e.then?e.then(Do):Promise.resolve()}(e._initPreload())}();return r&&r.then?r.then(n):n()}(0,(function(){switch(en.pictureInPictureSupportType){case"pip-api":return e._video.requestPictureInPicture();case"webkit-presentation-mode":return e._video.webkitSetPresentationMode("picture-in-picture");default:throw new Error("Picture-in-picture is not supported by this browser")}}))}catch(kh){return Promise.reject(kh)}},n._initPreload=function(){return this.preload="auto",new Promise(e=>{this.once(vi.LOADED_METADATA,e)})},n.exitPictureInPicture=function(){try{const e=this;switch(en.pictureInPictureSupportType){case"pip-api":return document.exitPictureInPicture();case"webkit-presentation-mode":return e._video.webkitSetPresentationMode("inline");default:throw new Error("Picture-in-picture is not supported by this browser")}}catch(kh){return Promise.reject(kh)}},n.onerror=function(){if(!this._video.error)return!1;switch(this._video.error.code){case this._video.error.MEDIA_ERR_SRC_NOT_SUPPORTED:return this._fireVideoError("MediaSrcNotSupportedError","The media was not suitable."),this._switchToNextFile(),!1;case this._video.error.MEDIA_ERR_DECODE:return-1!==this._lastCurrentTime&&en.iOS?(this._video.load(),this.currentTime=this._lastCurrentTime,this._lastCurrentTime=-1,!1):(this._fireVideoError("MediaDecodeError","The media could not be decoded."),this._switchToNextFile(),!1);case this._video.error.MEDIA_ERR_NETWORK:return this._fireVideoError("MediaNetworkError","A network error ocurred while fetching the media."),!1;case this._video.error.MEDIA_ERR_ABORTED:return this._fireVideoError("MediaAbortedError","The user agent aborted the fetching of the media."),!1;default:return this._fireVideoError("MediaUnknownError","An unknown error occurred."),!1}},n._fireVideoError=function(e,t){this.fire(vi.ERROR,new Eo(e,t))},n.onended=function(){if(this._video.paused||this._video.pause(),this.currentTime<this._video.duration)return!1},n.onwaiting=function(){return!1},n.onwebkitbeginfullscreen=function(){this._inFullscreen=!0},n.onwebkitendfullscreen=function(){"inline"===this._video.webkitPresentationMode&&!0===this._video.controls&&(this._video.controls=!1),this._inFullscreen=!1},n.onwebkitpresentationmodechanged=function(){this.fire(this.pictureInPictureActive?vi.ENTER_PICTURE_IN_PICTURE:vi.LEAVE_PICTURE_IN_PICTURE)},n.shouldHandleVideoEvent=function(e){return!0},n.handleVideoEvent=function(e){e.target===this._video&&!1!==this.shouldHandleVideoEvent(e)&&("function"==typeof this[`on${e.type}`]&&!1===this[`on${e.type}`](e)||this.fire(e.type))},n.handleAudioEvent=function(){this.fire(Ti.AUDIO_TRACK_CHANGED)},n.swapVideo=function(e,t){const n=e.paused;this.removeVideoEventListeners(e),this.removeAudioEventListeners(e),e.parentElement.replaceChild(t,e),e.pause(),t.currentTime=e.currentTime,n||t.play(),this.addVideoEventListeners(t),this.addAudioEventListeners(t),this._video=t},n.onexternaldisplayactivated=function(e){this._externalDisplayActivated||(this._video!==e.element&&(this._originalVideo=this._video,this.swapVideo(this._video,e.element)),this._externalDisplayActivated=!0)},n.onexternaldisplaydeactivated=function(e){this._externalDisplayActivated&&(this._originalVideo&&(this.swapVideo(e.element,this._originalVideo),this._originalVideo=null),this._externalDisplayActivated=!1)},n.setVideoSrc=function(e){this._video.src=e},n.canSeekTo=function(e){const t=this.duration;if(t&&e>t&&(e=t),this._video.seekable.length>0)for(let n=0,r=this._video.seekable.length;n<r;n++)if(this._video.seekable.start(n)<=e&&this._video.seekable.end(n)>=e)return!0;return!1},n.seekToTime=function(e){return this.canSeekTo(e)?(this._video.currentTime=e,Promise.resolve(this._video.currentTime)):new Promise((t,n)=>{const r=()=>{this.canSeekTo(e)&&(Object.keys(vi).forEach(e=>{const t=vi[e];this._video.removeEventListener(t,r)}),this._video.currentTime=e,t(this._video.currentTime))};Object.keys(vi).forEach(e=>{const t=vi[e];this._video.addEventListener(t,r)})})},n.takeSnapshot=function(){let e=this._element.querySelector("[telecine-snapshot]");e||(e=document.createElement("canvas"),e.setAttribute("telecine-snapshot",""),this._element.appendChild(e)),e.setAttribute("width",`${this._element.clientWidth}px`),e.setAttribute("height",`${this._element.clientHeight}px`),e.style.display="";const{width:t,height:n,left:r,top:i}=mo(this._video.clientWidth,this._video.clientHeight,this._video.videoWidth,this._video.videoHeight);e.style.cssText=`position:absolute;width:${t}px;height:${n}px;left:${r}px;top:${i}px`;const o=e.getContext("2d");e.width>0&&e.height>0&&o.drawImage(this._video,0,0,e.width,e.height)},n.removeSnapshot=function(){const e=this._element.querySelector("[telecine-snapshot]");e&&(e.style.display="none")},n.getTrackById=function(e){if(this._textTracks&&this._textTracks[e])return this._textTracks[e];if("function"==typeof this._video.textTracks.getTrackById)return this._video.textTracks.getTrackById(e);const t=document.getElementById(e);return t?t.track:null},n.initDrm=function(){const e=this._telecineVideo.drmHandler;e&&e.init(this)},n.showExternalDisplayPicker=function(e){if(!this._externalDisplays.length)throw new Eo("ExternalDisplayUnvailable","No external displays are available.");if(!e)return void this._externalDisplays[0].showPicker();const t=this._externalDisplays.filter(t=>t.constructor.displayName.replace("ExternalDisplay","")===e)[0];if(!t)throw new Eo("InvalidExternalDisplay","The specified external display is not available.");t.showPicker()},n.setCaptionsShouldDisplay=function(e){},n.setCaptionsShouldLoad=function(e){},n._pickFile=function(){return this._files.length<1?null:this._files.slice(0).sort((e,t)=>e.priority-t.priority)[0]},n._updateCurrentFile=function(){const e=this._pickFile();e?this.currentFile=e:this.fire(Ti.SCANNER_ERROR,{reason:"all files failed"})},n._isValidChapter=function(e,t){return void 0!==e.timecode&&e.timecode>=0&&e.timecode<=t&&void 0!==e.title},n._switchToNextFile=function(){const e=this._files.indexOf(this._currentFile);this._files.splice(e,1),this._updateCurrentFile()},pe(t,[{key:"audioTracks",get:function(){return this._video.audioTracks}},{key:"chaptersTrack",get:function(){return this._chaptersTrack}},{key:"manifest",get:function(){return this._manifest}},{key:"manifestLoaded",get:function(){return!!this._manifest}},{key:"buffered",get:function(){return wo.from(this._video.buffered)}},{key:"cuePoints",get:function(){var e,t;return(null==(e=this._cuePointTrack)?void 0:e.cues)&&"function"==typeof(null==(t=this._cuePointTrack)?void 0:t.cues[Symbol.iterator])?Array.from(this._cuePointTrack.cues).map(e=>So.fromVTTCue(e)):[]}},{key:"currentFile",get:function(){return this._currentFile},set:function(e){const n=!this._video.paused,r=this.currentTime,i=!this._currentFile||e.video.id!==this._currentFile.video.id;if(i||this.takeSnapshot(),this._currentFile=e,i&&(this._video.preload=this._preload),this.constructor===t&&this._video.readyState>0&&(this._video.currentTime=0),(en.iOS||en.android)&&this._currentFile.video.title){let e=this._currentFile.video.title;this._currentFile.video.subtitle&&(e=`${e} ${this._currentFile.video.subtitle}`),this._video.setAttribute("title",e)}else this._video.removeAttribute("title");this.setVideoSrc(this._currentFile.src,i),this.fire(Ti.CURRENT_FILE_CHANGE,e),en.iOS&&!i&&this.play().catch(this._onPlayError.bind(this)),this.constructor!==t||i?n&&this.play().catch(this._onPlayError.bind(this)):(this.seekToTime(r).then(e=>(n&&this.play().catch(this._onPlayError.bind(this)),e)).catch(()=>{}),this.once("canplay",()=>this.removeSnapshot()),this.once("playing",()=>this.removeSnapshot()))}},{key:"currentTime",get:function(){return this._video.currentTime},set:function(e){this.seekToTime(e)}},{key:"duration",get:function(){return this._video.duration}},{key:"ended",get:function(){return this._video.ended}},{key:"externalDisplayAvailable",get:function(){return this._externalDisplays.some(e=>e.available)}},{key:"externalDisplayActive",get:function(){return this._externalDisplays.some(e=>e.active)}},{key:"loop",get:function(){return this._video.loop},set:function(e){this._video.loop=e}},{key:"isLowerProfileAvailable",get:function(){return null}},{key:"muted",get:function(){return this._video.muted},set:function(e){this._video.muted=e}},{key:"playsinline",get:function(){return this._video.playsinline},set:function(e){this._video.playsinline=e,e?this._video.setAttribute("playsinline",""):this._video.removeAttribute("playsinline")}},{key:"paused",get:function(){return this._video.paused}},{key:"defaultPlaybackRate",get:function(){return this._video.defaultPlaybackRate},set:function(e){this._video.defaultPlaybackRate=e}},{key:"playbackRate",get:function(){return this._video.playbackRate},set:function(e){this._video.playbackRate=e}},{key:"played",get:function(){return this._video.played}},{key:"seekable",get:function(){return this._video.seekable}},{key:"seeking",get:function(){return this._video.seeking}},{key:"preload",get:function(){return this._preload},set:function(e){this._video.preload=e,this._preload=e}},{key:"autoPictureInPicture",get:function(){return this._video.autoPictureInPicture},set:function(e){this._video.autoPictureInPicture=e}},{key:"disablePictureInPicture",get:function(){return this._video.disablePictureInPicture},set:function(e){this._video.disablePictureInPicture=e}},{key:"pictureInPictureActive",get:function(){return"picture-in-picture"===this._video.webkitPresentationMode||!!document.pictureInPictureElement}},{key:"pictureInPictureEnabled",get:function(){if(this.disablePictureInPicture)return!1;switch(en.pictureInPictureSupportType){case"pip-api":return document.pictureInPictureEnabled;case"webkit-presentation-mode":return!0;default:return!1}}},{key:"video",get:function(){return this._telecineVideo},set:function(e){if(this.reactivate(),this._telecineVideo!==e){if(this._telecineVideo&&(this._telecineVideo.off(Ti.FILE_SRC_UPDATE),this._telecineVideo.off("texttracksrcupdate")),this.removeAllCuePoints(),this._telecineVideo=e,this._files=e.files.filter(e=>-1!==this.constructor.supportedVideoTypes.indexOf(e.mime)),this._telecineVideo.on(Ti.FILE_SRC_UPDATE,e=>{e===this._currentFile&&this._updateCurrentFile()}),this._telecineVideo.on("texttracksrcupdate",e=>{this.video.currentScanner&&this.video.currentScanner.setSrcForTrack(e,e.src)}),this._options.externalDisplays&&this._options.externalDisplays.length){this._externalDisplays=[];let t=this.constructor.supportedExternalDisplays;Array.isArray(t)||(t=[]);const n=t.map(e=>e.displayName);this._options.externalDisplays.filter(e=>e.supported&&-1!==n.indexOf(e.displayName)).forEach(t=>{const n=new t(e),r=t.displayName.replace("ExternalDisplay","");n.on(vi.LOADED_METADATA,e=>this.fire(vi.LOADED_METADATA,e)),n.on("available",()=>this.fire(yi.AVAILABLE,{type:r})),n.on("unavailable",()=>this.fire(yi.UNAVAILABLE,{type:r})),n.on("activated",()=>{"function"==typeof this.onexternaldisplayactivated&&this.onexternaldisplayactivated(n),this.fire(yi.ACTIVATED,{type:r})}),n.on("deactivated",()=>{"function"==typeof this.onexternaldisplaydeactivated&&this.onexternaldisplaydeactivated(n),this.fire(yi.DEACTIVATED,{type:r})}),this._externalDisplays.push(n)})}this._updateCurrentFile(),en.iOS&&this._externalDisplays.forEach(e=>{"AirPlay"===e.constructor.displayName&&(e.element=this._video)}),this.initDrm()}}},{key:"videoElement",get:function(){return this._video}},{key:"videoWidth",get:function(){return this._video.videoWidth}},{key:"videoHeight",get:function(){return this._video.videoHeight}},{key:"volume",get:function(){return Xe(this._video.volume)},set:function(e){this._video.volume=He(e)}},{key:"readyState",get:function(){return this._video.readyState}}]),t}(er);function Uo(e,t=[]){if(0===e.length)return 0;let n=0,r=0;for(let i=0;i<e.length;i++){const o=t[i]||1;r+=o,n+=e[i]*o}return n/r}function Fo(e){const t=Re(e).sort((e,t)=>e-t),n=Math.floor(t.length/2);return t.length%2?t[n]:(t[n-1]+t[n])/2}let jo=function(e){function t(){return e.apply(this,arguments)||this}return ge(t,e),t}(be(Error));function Vo(){}const Bo=[],Ho=[],Xo=[];function qo(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}const Wo=[];let Go=function(e){function t(t={}){var n;n=e.call(this)||this;const{retryCount:r=3,parallel:i=1,includeWithSpeeds:o=!0,timeout:s=0,retryAbortErrors:a=!0}=t;return n._queue=[],n._activeRequests=new Set,n._retries=new WeakMap,n._retryCount=r,n._running=!1,n._processingQueue=!1,n._parallel=i,n._includeWithSpeeds=o,n._timeout=s,n._retryAbortErrors=a,n._initialize(),n}ge(t,e),t.getPercentileSpeed=function(e=5,t=.8){return function(e,t){if(0===e.length)return 0;const n=Re(e).sort((e,t)=>e-t);if(t<=0)return n[0];if(t>=1)return n[n.length-1];const r=n.length*t,i=Math.floor(r),o=i+1,s=r%1;return o>=n.length?n[i]:n[i]*(1-s)+n[o]*s}(Bo.slice(-e),t)},t.getAverageSpeed=function(e=5,t=[]){return Uo(Bo.slice(-e),t)},t.getHarmonicAverageSpeed=function(e=5){return function(e){if(0===e.length)return 0;let t=0;for(let n=0;n<e.length;n++)t+=1/e[n];return e.length/t}(Bo.slice(-e))},t.getVolatilityScaler=function(e=5){const t=Bo.slice(-e);if(t.length<3)return null;const n=Uo(t,[]);return Math.min.apply(Math,Re(t))/n},t.getMedianSpeed=function(e=5){return Fo(Bo.slice(-e))},t.getResponseSpeeds=function(){return Bo},t.getProgressSpeeds=function(){return Wo},t.getFailedSegments=function(){return Ho},t.getSuccessfulSegments=function(){return Xo},t.resetResponseSpeeds=function(){Bo.length=0};var n=t.prototype;return n.add=function(e,t){return new Promise((n,r)=>{const i=this._createSegmentInfo(e,n,r);this._addSegmentToQueue(i,t),this._running&&!this._processingQueue&&this._processQueue()})},n.start=function(){this._running||(this._running=!0,this._processQueue())},n.stop=function(){this._running=!1},n.abort=function(e=null){this._queue.filter(t=>!e||e===t.stream).forEach(e=>{e.reject(new jo("Stream manually aborted")),this.fire("downloadabort",e.identifier)}),this._queue=this._queue.filter(t=>e&&e!==t.stream),this._activeRequests.forEach(t=>{e&&e!==t.stream||t.request.abort()})},n._insertAtPosition=function(e){let t=0;for(;t<this._queue.length&&!(this._queue[t].priority>e.priority);t++);this._queue.splice(t,0,e)},n._initialize=function(){this._pendingFetchMap=new WeakMap,window.addEventListener("online",()=>{this.start(),this._waitUntilOnline&&(this._waitUntilOnline.resolve(),this._waitUntilOnline=null)}),window.addEventListener("offline",()=>{this.stop(),this.abort(),this._waitUntilOnline=new Ke})},n._addSegmentToQueue=function(e,t){e.hasOwnProperty("priority")?this._insertAtPosition(e):this._queue[t?"unshift":"push"](e)},n._processQueue=function(){if(!this._running)return;this._processingQueue=!0;const e=this._parallel-this._activeRequests.size;for(let t=0;t<e;t++)this._fetchOne()},n._createSegmentInfo=function(e,t,n){let r=e;return e.id&&(r=e.id),ve(ve({},e),{},{identifier:r,resolve:t,reject:n})},n._continueProcessingQueue=function(){0!==this._activeRequests.size||0!==this._queue.length?this._activeRequests.size<this._parallel&&this._processQueue():this._processingQueue=!1},n._fetchOne=function(){if(0===this._queue.length)return void(this._processingQueue=!1);const e=this._queue.shift(),{url:t,byteRange:n,isInitSegmentRequest:r,identifier:i,timeout:o}=e,s={stream:e.stream,data:{url:t,isInitSegmentRequest:r,requestSendTime:ze(),uuid:st()}};let a=this._timeout;const u=parseInt(o,10);u>=0&&(a=u);const c={url:t,type:de.SEGMENT,responseType:xt.ARRAY_BUFFER,retry:this._retryCount,hooks:{beforeRetry:[this._beforeRetry.bind(this)]},onDownloadProgress:this._makeOnDownloadProgress(i,s),headers:n&&{Range:`bytes=${n}`},retryAbortErrors:this._retryAbortErrors,timeout:a};this.fire("downloadstart",i),s.request=kt(c).then(this._makeOnRequestLoad(s,e)).catch(this._makeOnRequestError(s,e)),this._activeRequests.add(s)},n._beforeRetry=function(){try{const e=this;return function(t){var n=function(){if(e._waitUntilOnline)return function(e,t){return e&&e.then?e.then(Vo):Promise.resolve()}(e._waitUntilOnline)}();if(n&&n.then)return n.then(Vo)}()}catch(kh){return Promise.reject(kh)}},n._makeOnDownloadProgress=function(e,t){let n=0,r=0,i=ze();return o=>{if(o.lengthComputable){const s=8*(o.loaded-r),a=ze(),u=a-i,c={startTime:i,length:u,bitrate:s/(u/1e3),index:n};n>0&&(Wo.length>=100&&Wo.shift(),Wo.push(c)),i=a,r=o.loaded,n+=1,this._pendingFetchMap.set(t,{bytesTotal:o.total,bytesLoaded:o.loaded,percent:o.loaded/o.total,identifier:e}),this.fire("progress",e)}}},n._makeOnRequestLoad=function(e,t){const n=this,r=ze(),{identifier:i,resolve:o}=t;return function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(kh){return Promise.reject(kh)}}}((function(s){let a=ze()-r;return qo(s.arrayBuffer(),(function(r){return Object.prototype.hasOwnProperty.call(s,"perfTimings")&&Object.prototype.hasOwnProperty.call(s.perfTimings,"responseStart")&&(t.perfTimings=s.perfTimings),e.data.duration=ze()-e.data.requestSendTime,n._activeRequests.delete(e),n._pendingFetchMap.delete(e),n._saveResponseSpeeds(t,a,r.byteLength),n.fire("downloadend",i,{request:e,response:s}),Xo.push({url:e.data.url,status:200,duration:e.data.duration}),qo(n._processBuffer(e,r),(function(e){o(r=e),n._continueProcessingQueue()}))}))}))},n._saveResponseSpeeds=function(e,t,n){const r=t/1e3,i=e.perfTimings;if(this._includeWithSpeeds&&e.includeWithBandwidthChecks){const t=8*n,o=i&&n<=16e3;let s=t/r;if(e.excludeConnectTime&&n>16e3&&n<=2e5){const e=(50*Math.max(0,1-t/16e5)+150)/1e3;s=t/Math.max(.1,r-e)}else if(o){const e=i.fetchStart||i.workerStart||i.requestStart||0;s=t/(r-Math.max(0,i.responseStart-e)/1e3)}Bo.push(s)}Bo.length>100&&Bo.shift()},n._processBuffer=function(e,t){return e.data.url&&e.data.url.match(".ts$")?this._feedMuxer(e,t):Promise.resolve(new Uint8Array(t))},n._feedMuxer=function(e,t){try{const n=this;return function(e,t){var r=function(){if(!n._transmuxer)return qo(n._loadMux(),(function(e){n._transmuxer=new e({keepOriginalTimestamps:!0})}))}();return r&&r.then?r.then(t):t()}(0,(function(){return new Promise(r=>{n._transmuxer.on("data",t=>{n._transmuxer.off("data");let i=new Uint8Array(t.initSegment.byteLength+t.data.byteLength);i.set(t.initSegment,0),i.set(t.data,t.initSegment.byteLength),r(e.data.isInitSegmentRequest?t.initSegment:i)}),n._transmuxer.push(new Uint8Array(t)),n._transmuxer.flush()})}))}catch(kh){return Promise.reject(kh)}},n._makeOnRequestError=function(e,t){const{identifier:n,reject:r,size:i}=t;return t=>{const o=ze()-e.data.requestSendTime;if(e.data.duration=o,t instanceof ut)Ho.push({url:e.data.url,status:"abort",duration:o}),this.fire("downloadabort",n);else if(t instanceof ct)Ho.push({url:e.data.url,status:t.response.status,duration:o}),this.fire("downloaderror",n,t.response.status);else if(t instanceof dt){if(Ho.push({url:e.data.url,status:"timeout",duration:o}),i>0&&t.timeoutMs>0){let e=8*i/(t.timeoutMs/1e3);e*=.5,Bo.push(e)}this.fire("downloadtimeout",n,{timeoutMs:t.timeoutMs})}this._pendingFetchMap.delete(e),this._activeRequests.delete(e),r(t),this._continueProcessingQueue()}},n._loadMux=function(){return import("./mux-mp4.module.js").then(({default:e})=>e)},pe(t,[{key:"parallel",get:function(){return this._parallel},set:function(e){this._parallel=e}},{key:"pendingFetches",get:function(){const e=[];return this._activeRequests.forEach(t=>{if(this._pendingFetchMap.get(t)){const n=this._pendingFetchMap.get(t);n.elapsedTime=ze()-t.data.requestSendTime,e.push(n)}}),e}}]),t}(er);const Ko=(e=!1)=>e?window.MediaSource:Ge,Yo=e=>"undefined"!=typeof ManagedMediaSource&&e instanceof ManagedMediaSource,$o=e=>"undefined"!=typeof ManagedSourceBuffer&&e instanceof ManagedSourceBuffer;var zo=new WeakMap,Qo=new WeakMap,Jo=new WeakMap,Zo=new WeakMap,es=new WeakMap,ts=new WeakMap,ns=new WeakMap,rs=new WeakMap,is=new WeakMap,os=new WeakMap,ss=new WeakMap,as=new WeakMap,us=new WeakMap,cs=new WeakMap,ls=new WeakMap,ds=new WeakMap,hs=new WeakMap,fs=new WeakMap,ps=new WeakSet,_s=new WeakMap,ms=new WeakSet,vs=new WeakSet,gs=new WeakMap,ys=new WeakMap,Es=new WeakSet,Ts=new WeakSet,Ss=new WeakSet,bs=new WeakSet,As=new WeakSet,ws=new WeakSet,Rs=new WeakSet;let Is=function(e){function t(t,n){var r;return r=e.call(this)||this,Rs.add(we(r)),ws.add(we(r)),As.add(we(r)),bs.add(we(r)),Ss.add(we(r)),Ts.add(we(r)),Es.add(we(r)),vs.add(we(r)),ms.add(we(r)),ps.add(we(r)),zo.set(we(r),{writable:!0,value:void 0}),Qo.set(we(r),{writable:!0,value:void 0}),Jo.set(we(r),{writable:!0,value:null}),Zo.set(we(r),{writable:!0,value:!1}),es.set(we(r),{writable:!0,value:!1}),ts.set(we(r),{writable:!0,value:{}}),ns.set(we(r),{writable:!0,value:void 0}),rs.set(we(r),{writable:!0,value:!0}),is.set(we(r),{writable:!0,value:null}),os.set(we(r),{writable:!0,value:!0}),ss.set(we(r),{writable:!0,value:!1}),as.set(we(r),{writable:!0,value:!1}),us.set(we(r),{writable:!0,value:null}),cs.set(we(r),{writable:!0,value:null}),ls.set(we(r),{writable:!0,value:null}),ds.set(we(r),{writable:!0,value:[]}),hs.set(we(r),{writable:!0,value:null}),fs.set(we(r),{writable:!0,value:[]}),_s.set(we(r),{writable:!0,value:()=>{const e=De(we(r),Qo)._mediaSource.duration,t=Le(we(r),ps,ks).call(we(r),e);for(let n=0;n<t;n++)De(we(r),ts)[n]={segment:n,stream:null,type:De(we(r),zo)}}}),gs.set(we(r),{writable:!0,value:()=>{Le(we(r),Ts,Ls).call(we(r)),Le(we(r),Ss,Cs).call(we(r)),Le(we(r),bs,Ns).call(we(r))}}),ys.set(we(r),{writable:!0,value:e=>{var t;null==(t=e.removedRanges)||t.length}}),Oe(we(r),zo,n),Oe(we(r),Qo,t),De(we(r),Qo).on("durationset",De(we(r),_s)),r}ge(t,e);var n=t.prototype;return n.addStream=function(e){e.on("segmentadd",()=>Le(this,bs,Ns).call(this));const t=De(this,ds).push(e)-1;e.index=t,null===De(this,Jo)&&(Le(this,vs,Ds).call(this,t),Oe(this,ss,!0))},n.getBufferState=function(){return De(this,ts)},n.setBufferState=function(e){Oe(this,ts,e)},n.streamIndexAtTime=function(e){if(De(this,ts)[void 0])return this.activeStreamIndex;const t=Le(this,ps,ks).call(this,e)-1,n=De(this,ts)[t];return null==n?void 0:n.stream},n.switchTo=function(e,t=!0,n={}){let r;r="number"==typeof e?e:e.index;let i=De(this,Jo)!==r;const o=i;if(!i&&De(this,ss)&&(i=!0),i){Oe(this,ss,!1);const e=De(this,Jo),n=De(this,ds)[e];this.fire("streamchangestart",e,r),n&&o&&t&&n.abort(),Oe(this,hs,r),Le(this,vs,Ds).call(this,r)}return Le(this,bs,Ns).call(this),new Promise(e=>{i?Oe(this,cs,()=>{De(this,hs)===r&&(Oe(this,cs,null),e(),this.fire("streamchange",r,n))}):e()})},n.isTimeInBuffer=function(e){for(let t=0;t<De(this,ls).buffered.length;t++){const n=De(this,ls).buffered.start(t),r=De(this,ls).buffered.end(t);if(n<=e&&r>=e)return!0}return!1},n.hasAppendedFinalSegment=function(){return void 0!==De(this,ns)&&this.isTimeInBuffer(De(this,ns))},n.clear=function(){De(this,ds).forEach(e=>e.clear())},n.remove=function(e,t=De(this,Qo)._mediaSource.duration){return new Promise(n=>{De(this,fs).push([e,t,n]),Le(this,bs,Ns).call(this)})},n.removeEventListeners=function(){De(this,ls)&&(De(this,ls).removeEventListener("updateend",De(this,gs)),$o(De(this,ls))&&De(this,ls).removeEventListener("bufferedchange",De(this,ys)))},n.removeSorcerer=function(){De(this,Qo).off("durationset",De(this,_s)),Oe(this,Qo,null)},pe(t,[{key:"activeStream",get:function(){return De(this,ds)[De(this,Jo)]}},{key:"activeStreamIndex",get:function(){return De(this,Jo)}},{key:"endTime",get:function(){const e=De(this,ls).buffered;if(e.length>0)return e.end(e.length-1)}},{key:"sourceBuffer",get:function(){return De(this,ls)},set:function(e){Oe(this,ls,e),Le(this,ms,Ps).call(this),this.fire("sourcebufferattach")}},{key:"streams",get:function(){return De(this,ds)}}]),t}(er);function ks(e){let t=Math.floor(e/6);return e>6&&e%6>=2?t+=1:e<8&&(t=1),t}function Ps(){De(this,ls).addEventListener("updateend",De(this,gs)),$o(De(this,ls))&&De(this,ls).addEventListener("bufferedchange",De(this,ys))}function Ds(e){Oe(this,os,!0),Oe(this,Jo,e),De(this,Qo)._frameDropper.streamIndex=e}function Os(){try{const e=De(this,ls).buffered,t=De(this,Qo)._video.buffered;if(e.length&&t.length){const n=e.start(0),r=t.start(0);n<r&&De(this,Qo).removeBuffer(0,r)}}catch(e){}}function Ls(){if(De(this,es)&&this.endTime)return Oe(this,es,!1),Oe(this,ns,this.endTime),De(this,Qo).checkEndOfStream(),void Le(this,Es,Os).call(this);!this.activeStream.hasNextSegment()&&De(this,ns)>0&&"open"===De(this,Qo)._mediaSource.readyState&&De(this,Qo).checkEndOfStream()}function Cs(){De(this,is)&&(this.fire("appendbufferend",De(this,is)),Oe(this,is,null),De(this,cs)&&De(this,cs).call(this))}function Ns(){if(De(this,ls)){if(this.activeStream&&"closed"!==De(this,Qo)._mediaSource.readyState&&!De(this,ls).updating)if(De(this,fs).length)Le(this,As,Ms).call(this);else if(!De(this,as)&&!De(this,Zo))return De(this,os)?(Oe(this,os,!1),void Le(this,ws,xs).call(this)):void Le(this,Rs,Us).call(this)}else this.on("sourcebufferattach",Le(this,bs,Ns))}function Ms(){const[e,t,n]=De(this,fs).shift(),r=()=>{De(this,ls).removeEventListener("updateend",r),n(),clearTimeout(De(this,us)),Oe(this,us,window.setTimeout(()=>{Oe(this,as,!1),Le(this,bs,Ns).call(this)},5e3))};De(this,ls).addEventListener("updateend",r),De(this,ls).remove(e,t)}function xs(){Oe(this,Zo,!0),this.activeStream.getInitSegment().then(e=>(Oe(this,is,null),De(this,ls).appendBuffer(e),Oe(this,Zo,!1),e)).catch(e=>{Oe(this,os,!0),Oe(this,Zo,!1)})}function Us(){const e=this.activeStream.getNextSegment();if(null===e)return;const t=this.activeStream.getIdForSegment(e);this.activeStream.isFinal(e)&&Oe(this,es,!0),Oe(this,is,t),this.fire("appendbufferstart",t);try{De(this,ls).appendBuffer(e),De(this,ts)[t.segment]=t,De(this,rs)&&(Oe(this,rs,!1),this.fire("initialbufferstart"))}catch(kh){if("QuotaExceededError"===kh.name){Oe(this,as,!0),this.fire("quotaexceedederror",De(this,ls).buffered);const t=6;if(De(this,Qo)._video.currentTime>t){const e=0,n=De(this,Qo)._video.currentTime-t;De(this,Qo).removeBuffer(e,n)}this.activeStream._readyToAppend.unshift(e)}}}function Fs(){}let js=function(e){function t(t,n="",r=new Go){var i;return(i=e.call(this)||this)._readyToAppend=[],i._initSegment=t,i._needInitSegment=!0,i._index=NaN,i._codec=n,i._fetcher=r,i._fetcher.start(),i._bufferData=new WeakMap,i._segmentToId={},i}ge(t,e),t.isValidSegmentUrl=function(e){return"string"==typeof e||"string"==typeof e.url&&"string"==typeof e.byteRange};var n=t.prototype;return n.getIdForSegment=function(e){return t.isValidSegmentUrl(e)?this._segmentToId[e]:this._bufferData.get(e).id},n.isFinal=function(e){return this._bufferData.get(e).final},n.addSegment=function(e,{identifier:n=null,isFinalSegment:r=!1,loadOnly:i=!1,priority:o=0,includeWithBandwidthChecks:s=!0,excludeConnectTime:a=!1,timeout:u=null,size:c=null}={}){return this._needInitSegment&&this.getInitSegment(),t.isValidSegmentUrl(e)?(this._segmentToId[e]=n||e,this.fire("queued",this.getIdForSegment(e)),this._fetcher.add({url:e.url||e,byteRange:e.byteRange,id:this.getIdForSegment(e),stream:this,includeWithBandwidthChecks:s,excludeConnectTime:a,isInitSegmentRequest:!1,priority:o,timeout:u,size:c}).then(t=>{this._bufferData.set(t,{id:n||e,final:r}),this._readyToAppend.push(t),this.fire("bufferqueueadd",this.getIdForSegment(e)),i||this.fire("segmentadd")})):(this._bufferData.set(e,{id:n,final:r}),this._readyToAppend.push(e),this.fire("bufferqueueadd",n),Promise.resolve())},n.clear=function(){this._readyToAppend=[]},n.abort=function(){try{const e=this;return function(t,n){var r=function(){if(e._needInitSegment)return function(e){if(e&&e.then)return e.then(Fs)}(function(t,n){try{var r=function(e,t){return e&&e.then?e.then(Fs):Promise.resolve()}(e.getInitSegment())}catch(kh){return}return r&&r.then?r.then(void 0,n):r}(0,(function(e){})))}();return r&&r.then?r.then(n):n()}(0,(function(){e._fetcher.abort(e)}))}catch(kh){return Promise.reject(kh)}},n.hasNextSegment=function(){return this._readyToAppend.length>0},n.getNextSegment=function(){return 0===this._readyToAppend.length?null:this._readyToAppend.shift()},n.getInitSegment=function(){const e="object"==typeof this._initSegment&&"url"in this._initSegment?this._initSegment.url:this._initSegment;return e?(this._needInitSegment=!1,t.isValidSegmentUrl(e)?this._fetcher.add({url:e,byteRange:this._initSegment.byteRange,id:null,stream:this,isInitSegmentRequest:!0,priority:0}).then(e=>(this._initSegment=e,this._initSegment)):Promise.resolve(this._initSegment)):Promise.resolve(null)},pe(t,[{key:"codec",get:function(){return this._codec},set:function(e){this._codec=e}},{key:"index",get:function(){return this._index},set:function(e){this._index=e}},{key:"pendingFetches",get:function(){return this._fetcher.pendingFetches}}]),t}(er);var Vs=new WeakMap,Bs=new WeakMap,Hs=new WeakMap,Xs=new WeakMap,qs=new WeakMap,Ws=new WeakMap,Gs=new WeakMap,Ks=new WeakMap,Ys=new WeakSet,$s=new WeakSet,zs=new WeakMap,Qs=new WeakMap,Js=new WeakSet,Zs=new WeakMap,ea=new WeakSet,ta=new WeakSet,na=new WeakSet;let ra=function(){function e(e,t="default"){na.add(this),ta.add(this),ea.add(this),Js.add(this),$s.add(this),Ys.add(this),Vs.set(this,{writable:!0,value:void 0}),Bs.set(this,{writable:!0,value:!1}),Hs.set(this,{writable:!0,value:null}),Xs.set(this,{writable:!0,value:{}}),qs.set(this,{writable:!0,value:{}}),Ws.set(this,{writable:!0,value:0}),Gs.set(this,{writable:!0,value:0}),Ks.set(this,{writable:!0,value:!1}),_e(this,"streamIndex",void 0),zs.set(this,{writable:!0,value:()=>{Oe(this,Bs,!0),Le(this,Js,sa).call(this)}}),Qs.set(this,{writable:!0,value:()=>{Oe(this,Bs,!1)}}),Zs.set(this,{writable:!0,value:()=>{!en.browser.safari||document.hidden&&"hidden"===document.visibilityState||Le(this,Js,sa).call(this)}}),Oe(this,Vs,e),this.streamIndex=t}var t=e.prototype;return t.init=function(){Le(this,Ys,ia).call(this)},t.start=function(){De(this,zs).call(this)},t.stop=function(){De(this,Qs).call(this)},t.destroy=function(){this.stop(),Le(this,$s,oa).call(this)},t.getDroppedFrameRate=function(e,t,n="average"){const r=De(this,Xs)[t];if(!r)return 0;if(r.length<e)return 0;const i=r.slice(-e);return"median"===n?Fo(i):Uo(i)},t.getDroppedFrameTotal=function(){return{dropped:Le(this,ea,aa).call(this),total:Le(this,ta,ua).call(this)}},e}();function ia(){De(this,Ks)||(De(this,Vs).addEventListener("playing",De(this,zs)),De(this,Vs).addEventListener("pause",De(this,Qs)),De(this,Vs).addEventListener("ended",De(this,Qs)),document.addEventListener("visibilitychange",De(this,Zs)),Oe(this,Ks,!0))}function oa(){De(this,Vs).removeEventListener("playing",De(this,zs)),De(this,Vs).removeEventListener("pause",De(this,Qs)),De(this,Vs).removeEventListener("ended",De(this,Qs)),document.removeEventListener("visibilitychange",De(this,Zs)),Oe(this,Ks,!1)}function sa(){if(!De(this,Bs)||null===this.streamIndex)return;if(en.browser.safari&&(document.hidden||"hidden"===document.visibilityState))return;clearTimeout(De(this,Hs));const e=Le(this,ea,aa).call(this),t=e-De(this,Ws);Oe(this,Ws,e);const n=Le(this,na,ca).call(this),r=n-De(this,Gs);Oe(this,Gs,n),De(this,Xs)[this.streamIndex]||(De(this,Xs)[this.streamIndex]=[]),De(this,qs)[this.streamIndex]||(De(this,qs)[this.streamIndex]=[]),De(this,Xs)[this.streamIndex].length>100&&De(this,Xs)[this.streamIndex].shift(),De(this,qs)[this.streamIndex].length>100&&De(this,qs)[this.streamIndex].shift(),De(this,Xs)[this.streamIndex].push(t),De(this,qs)[this.streamIndex].push(r),Oe(this,Hs,setTimeout(()=>{Le(this,Js,sa).call(this)},1e3))}function aa(){return"function"==typeof De(this,Vs).getVideoPlaybackQuality?De(this,Vs).getVideoPlaybackQuality().droppedVideoFrames:De(this,Vs).webkitDroppedFrameCount||0}function ua(){return"function"==typeof De(this,Vs).getVideoPlaybackQuality?De(this,Vs).getVideoPlaybackQuality().totalVideoFrames:De(this,Vs).webkitDecodedFrameCount||0}function ca(){if("function"==typeof De(this,Vs).getVideoPlaybackQuality){const e=De(this,Vs).getVideoPlaybackQuality();return e.totalVideoFrames-e.droppedVideoFrames}return De(this,Vs).webkitDecodedFrameCount||0}let la=function(e){function t(t,n={}){var r;(r=e.call(this)||this)._video=t,r._options=n,r.allowSegmentRequests=!0,r._mediaSource=new(Ko(r._options.disableMMS));const{fetcherTimeout:i=0,fetcherRetryAbortErrors:o=!0}=r._options;return r._frameDropper=new ra(t),r._fetcher=new Go({parallel:1,timeout:i,retryAbortErrors:o}),r._buffersForCodec={},r._buffers=[],r._readyPromiseResolve=null,r._boundHandleSourceOpen=r._handleSourceOpen.bind(we(r)),r._boundHandleSourceClose=r._handleSourceClose.bind(we(r)),r._attachEvents(),r}ge(t,e);var n=t.prototype;return n.switchTo=function(e){return 1===this._buffers.length&&this.video.switchTo(e)},n.getCurrentSpeed=function({type:e="average",howMany:t=10,weights:n=[],percentile:r=null}={}){return"harmonicAverage"===e?Go.getHarmonicAverageSpeed(t):"average"===e?Go.getAverageSpeed(t,n):"median"===e?Go.getMedianSpeed(t):Go.getPercentileSpeed(t,r)},n.getVolatilityScaler=function(e){return Go.getVolatilityScaler(e)},n.getResponseSpeeds=function(){return Go.getResponseSpeeds()},n.getFailedSegments=function(){return Go.getFailedSegments()},n.getSuccessfulSegments=function(){return Go.getSuccessfulSegments()},n.getDroppedFrameRate=function(e,t=this.activeStreamIndex,n="average"){return this._frameDropper.getDroppedFrameRate(e,t,n)},n.getDroppedFrameTotal=function(){return this._frameDropper.getDroppedFrameTotal()},n.clear=function(){this._buffers.forEach(e=>e.clear())},n.initFrameDropper=function(){this._frameDropper.init()},n.streamIndexAtTime=function(e,t){return this._buffersForCodec[t].streamIndexAtTime(e)?this._buffersForCodec[t].streamIndexAtTime(e):null},n.removeBuffer=function(e=0,t=this._video.duration){if(e>=(t=t||0))return Promise.resolve();const n=this._buffers.map(n=>n.remove(e,t));return Promise.all(n)},n.setLiveSeekableRange=function(e,t){var n;"open"===this._mediaSource.readyState&&(null==(n=this._mediaSource)||n.setLiveSeekableRange(e,t))},n.addStream=function(e,t){const n=this._getCodecType(e);if(!this._buffersForCodec[n]){const t=new Is(this,n);this._buffersForCodec[n]=t,this._buffers.push(t),this.readyPromise.then(()=>{let r;try{r=this._mediaSource.addSourceBuffer(e)}catch(kh){if(22!==kh.code)return void this.fire("srcnotsupported",kh);r=this._buffersForCodec[n]}if(this._options.duration){const e=.1;r.appendWindowEnd=this._options.duration+e}t.sourceBuffer=r}).catch(e=>{}),["appendbufferstart","appendbufferend","streamchange","streamchangestart","initialbufferstart","quotaexceedederror"].forEach(e=>{t.on(e,t=>{this.fire(e,t)})})}const r=new js(t,e,this._fetcher);return["queued","bufferqueueadd"].forEach(e=>{r.on(e,t=>{this.fire(e,t)})}),this._buffersForCodec[n].addStream(r),r},n.checkEndOfStream=function(){if(!this._buffers.every(e=>e.hasAppendedFinalSegment()))return;const e=()=>{this._video.removeEventListener("timeupdate",e),this.endOfStream()};this._video.addEventListener("timeupdate",e)},n.abortFetches=function(){this._fetcher.abort()},n.endOfStream=function(){if(!this._buffers.every(e=>e.isTimeInBuffer(this._video.currentTime))){const e=1;if(!(en.browser.firefox&&this._video.currentTime<e))return}"open"===this._mediaSource.readyState&&(this._sourceBuffersAreUpdating()||(this._mediaSource.endOfStream(),this.fire("endofstream")))},n.destroy=function(){this.clear(),this._removeEventListeners(),this.off(),this._frameDropper.destroy(),this._fetcher.abort();const e=this._video.querySelectorAll("source");(this._video.src||e.length>0)&&(this._video.removeAttribute("src"),e.forEach(e=>{this._video.removeChild(e)}),this._video.load())},n._attachEvents=function(){this.readyPromise=new Promise((e,t)=>{this._readyPromiseResolve=e,this._mediaSource.addEventListener("sourceopen",this._boundHandleSourceOpen),this._mediaSource.addEventListener("sourceclose",this._boundHandleSourceClose)}),["downloadstart","downloadend","downloadabort","downloaderror","downloadtimeout","progress"].forEach(e=>{this._fetcher.on(e,(...t)=>{this.fire.apply(this,[e].concat(t))})}),Yo(this._mediaSource)&&(this._mediaSource.addEventListener("startstreaming",e=>{this.allowSegmentRequests=!0}),this._mediaSource.addEventListener("endstreaming",e=>{this.allowSegmentRequests=!1}))},n._sourceBuffersAreUpdating=function(){for(let e=0;e<this._mediaSource.sourceBuffers.length;e++)if(this._mediaSource.sourceBuffers[e].updating)return!0;return!1},n._handleSourceOpen=function(){URL.revokeObjectURL(this._video.src),this._video.querySelectorAll("source").forEach(e=>{var t;0===(null==(t=e.src)?void 0:t.indexOf("blob"))&&URL.revokeObjectURL(e.src)}),this._mediaSource.removeEventListener("sourceopen",this._boundHandleSourceOpen),this._options.duration&&(this._mediaSource.duration=this._options.duration,this.fire("durationset")),this._readyPromiseResolve()},n._handleSourceClose=function(){this._mediaSource.removeEventListener("sourceclose",this._boundHandleSourceClose),this.fire("sourceclose",event)},n._removeEventListeners=function(){this._buffers.forEach(e=>e.removeEventListeners())},n._getCodecType=function(e){return 0===e.indexOf("audio")?"audio":"video"},pe(t,[{key:"mediaSource",get:function(){return this._mediaSource}},{key:"pendingFetches",get:function(){return this._fetcher.pendingFetches}},{key:"streams",get:function(){return 1===this._buffers.length&&this.video.streams}},{key:"activeStreamIndex",get:function(){return 1===this._buffers.length&&this.video.activeStreamIndex}},{key:"video",get:function(){return!!this._buffersForCodec.video&&this._buffersForCodec.video}},{key:"audio",get:function(){return!!this._buffersForCodec.audio&&this._buffersForCodec.audio}}]),t}(er);let da=function(e){function t(t,n={}){var r;return(r=e.call(this,t,n)||this).BANDWIDTH_UPSWITCH_THRESHOLD=.85,r.BANDWIDTH_DOWNSWITCH_THRESHOLD=.9,r.DEFAULT_TIMEOUT=8e3,r.SEGMENT_RELATIVE_TIMEOUT_RATIO=4/3,r.MINIMUM_TIMEOUT=1e3,r.FRAME_DROP_WINDOW_SECONDS=10,r}ge(t,e),pe(t,[{key:"displayName",get:function(){return"Skyfire"}}]);var n=t.prototype;return n.shouldPowerUp=function(e,t,n){n&&this._options.startingBandwidthThreshold&&(this.BANDWIDTH_UPSWITCH_THRESHOLD=this._options.startingBandwidthThreshold);let r=e.indexOf(t);if(-1===r&&(r=0),!this.canPowerUp(e,r))return Promise.resolve({index:!1,reasonForSwitch:null});const i=this.getCurrentSpeed();if(!i)return Promise.resolve({index:!1,reasonForSwitch:null});const o=this._getStreamFromSpeed(i,this.BANDWIDTH_UPSWITCH_THRESHOLD,e);return o===r||!n&&o>r&&$e(this.scanner.currentTime,this.scanner._video.buffered)<1.5*this.SEGMENT_DURATION?Promise.resolve({index:!1,reasonForSwitch:null}):Promise.resolve({index:o,reasonForSwitch:3})},n.shouldPowerDown=function(e,t){const n=e.indexOf(t);if(-1===n){const t=this.isTimeInBuffer(this.scanner._video.duration,this.scanner._video.buffered,this.scanner._video.duration);return this.whitelisted.length||this.blacklisted.length||!t?Promise.resolve({index:e.length-1,reasonForSwitch:6}):Promise.resolve({index:!1,reasonForSwitch:null})}if(!this.canPowerDown(e,n))return Promise.resolve({index:!1,reasonForSwitch:null});const r=this.getCurrentSpeed();if(!r)return Promise.resolve({index:!1,reasonForSwitch:null});if(this.hasTooManyDroppedFrames(n,t,this._options.droppedFrameSwitchPercent))return this.blacklist(n),Promise.resolve({index:n-1,reasonForSwitch:2});const i=this._getStreamFromSpeed(r,this.BANDWIDTH_DOWNSWITCH_THRESHOLD,e);return i===n?Promise.resolve({index:!1,reasonForSwitch:null}):Promise.resolve({index:i,reasonForSwitch:1})},n.hasTooManyDroppedFrames=function(e,t,n){return this.scanner.sorcerer.getDroppedFrameRate(this.FRAME_DROP_WINDOW_SECONDS,e,"median")/t.framerate*100>=n},n.getTimeEstimateToLoad=function(e,t){if(null===t)return 3;const n=t.segments[e],r=n.end-n.start,i=this.getCurrentSpeed();return r*(t.bitrate+t.audioBitrate)/i*1.3},n.canPlayFromTimeInStream=function(e,t){if(!this.isTimeInBuffer(e,this.scanner._video.buffered,this.scanner._video.duration))return!1;if(!t)return!1;const n=this.getSegmentsToLoad(!1,this.STREAM_TYPE_VIDEO,t);if(0===n.length)return!0;const r=$e(e,this.scanner._video.buffered);return this.getTimeEstimateToLoad(n[0],t)<r},n.getSegmentsToLoad=function(e,t=this.STREAM_TYPE_VIDEO,n){const r=this.scanner._video;if(r.webkitCurrentPlaybackTargetIsWireless)return[];const i=this.scanner.currentTime,o=[],s=i+this._getSecondsToLoadAhead(i,r.duration,n),a=this.scanner.sorcerer[t].activeStreamIndex,u=this.scanner._streams[t][a];if(!u)return o;const c=this.scanner.sorcerer[t].sourceBuffer;let l=null;c&&(l=c.buffered);for(let d=0;d<u.segments.length;d++){const t=u.segments[d];if(t.end<i||t.start>s)continue;const n=i>=t.start&&i<t.end,r=this._isSegmentInBuffer(t,l,this.scanner._video.duration,this.scanner._streams);!e&&r||e&&r&&n||(n||s>=t.start)&&o.push(d)}return o},n.getSegmentRelativeTimeout=function(e,t,n){var r;const i=null==t?void 0:t.bitrate,o=null==(r=e[0])?void 0:r.bitrate;if(!i||!o||!n)return this.DEFAULT_TIMEOUT;if(i===o)return this.DEFAULT_TIMEOUT;const s=n*this.SEGMENT_RELATIVE_TIMEOUT_RATIO;return Math.max(this.MINIMUM_TIMEOUT,Math.min(this.DEFAULT_TIMEOUT,s))},n._getStreamFromSpeed=function(e,t,n){let r=0;for(let i=r;i<n.length;i++)e*t>n[i].bitrate+n[i].audioBitrate&&(r=i);return r},t}(function(e){function t(t,n={}){var r;return(r=e.call(this,t)||this)._options=n,r.blacklisted=[],r.whitelisted=[],r.MAX_LOADABLE_SEGMENTS_AUTO=3,r.MAX_LOADABLE_SEGMENTS_LOCKED=15,r.SEGMENT_DURATION=6,r}ge(t,e),pe(t,[{key:"displayName",get:function(){return"MediaSource"}}]);var n=t.prototype;return n.isTimeInBuffer=function(e,t,n){return this._timesAreInRange(e,e,t,n,1)},n.getDistanceFromBuffer=function(e,t){let n=e;for(let r=0;r<t.length;r++)if(t.start(r)<=e&&t.end(r)>=e){n=t.end(r);break}return n-e},n.blacklist=function(e){this.blacklisted[e]=1},n.lock=function(e=[]){this.whitelisted=e},n.filterStreams=function(e,t,n,r=null){const i=[];let o,s=!1;for(let a=0;a<e.length;a++)if(o&&o[0]===e[a].width&&o[1]===e[a].height)i.push(e[a]);else{if(s)break;this.blacklisted[a]&&-1===this.whitelisted.indexOf(a)||this.whitelisted.length&&-1===this.whitelisted.indexOf(a)||(this.whitelisted.length?i.push(e[a]):(this._getScaleFromDimensions(t,n,e[a].width,e[a].height,r)>=(n<1e3/(window.devicePixelRatio||1)?1.75:1)&&(s=!0),i.push(e[a]),o=[e[a].width,e[a].height]))}return i},n.getCurrentSpeed=function(){let e="average",t=3,n=[1,2,5];return this._options.tests&&this._options.tests.harmonic_average&&this._options.tests.harmonic_average.group&&(e="harmonicAverage",t=this._getMaxLoadableSegmentsAuto(),n=[]),this.scanner.sorcerer.getCurrentSpeed({type:e,howMany:t,weights:n})},n.shouldUseSurroundSound=function(e,t){return"240p"!==e[t].quality},n.getAudioIndexFromVideo=function(e,t,n){if(0===t.length)return!1;if(!e[n])return 0;const r=t.filter(({channels:e})=>e>2);if(r.length>0&&this.shouldUseSurroundSound(e,n)){const e=r[r.length-1];return t.indexOf(e)}return t.length>1&&0===n&&e[n].height<=360&&e.length>1?"mp4a.40.2"===t[0].codecs&&t[0].bitrate<8e4&&"240p"!==e[n].quality?1:0:t.length-1},n._getVisibleDimensions=function(e,t,n,r){const i=n/r,o=e-t*i,s=t-e/i;let a=e-o,u=t-s;return o>0&&(u=t),s>0&&(a=e),[a,u]},n._getScaleFromDimensions=function(e,t,n,r,i=null){const o=this._getVisibleDimensions(e,t,n,r);let s=n*r;i&&(s*=i);const a=window.devicePixelRatio||1;return s/(o[0]*o[1]*a*a)},n._getMaxLoadableSegmentsAuto=function(){const e=function(e,t){return e&&e.tests&&e.tests.lookahead_count?e.tests.lookahead_count:null}(this._options);return e&&e.group&&e.data.count?e.data.count:e&&e.data.segment_lookahead_count?e.data.segment_lookahead_count:this.MAX_LOADABLE_SEGMENTS_AUTO},n._getSecondsToLoadAhead=function(e,t,n){const r=n&&n.bitrate>11e6;return 1===this.whitelisted.length?r?30:this.MAX_LOADABLE_SEGMENTS_LOCKED*this.SEGMENT_DURATION:this._getMaxLoadableSegmentsAuto()*this.SEGMENT_DURATION},n._timesAreInRange=function(e,t,n,r,i=0){if(!n)return!1;t=Math.min(t,r);for(let o=0;o<n.length;o++){const r=n.start(o),s=n.end(o),a=yo(r)-i,u=yo(s)+i;if(a<=e&&u>=t){if(t<r||e>s)continue;return!0}}return!1},n._hasSeparateStreams=function(e){return e.video.length>0&&e.audio.length>0},n._isSegmentInBuffer=function(e,t,n,r){let i=1;return this._hasSeparateStreams(r)&&(i=.1),this._timesAreInRange(e.start,e.end,t,n,i)},t}(function(){function e(e){this.scanner=e,this.STREAM_TYPE_VIDEO="video",this.STREAM_TYPE_AUDIO="audio"}pe(e,[{key:"displayName",get:function(){return"Brain"}}]);var t=e.prototype;return t.destroy=function(){},t.shouldPowerUp=function(e,t){return!1},t.shouldPowerDown=function(e,t){return!1},t.canPowerUp=function(e,t){return 1!==e.length&&t<e.length-1},t.canPowerDown=function(e,t){return 1!==e.length&&t>0},t.filterStreams=function(e){return e},e}())),ha=function(){function e(e,t){this._video=e,this._getCurrentStream=t}var t=e.prototype;return t.start=function(){return clearInterval(this._checkGapInterval),this._checkGapInterval=setInterval(this._checkGap.bind(this),200),this._checkGap()},t.stop=function(){clearInterval(this._checkGapInterval)},t.onSegmentAppended=function(){this._checkGap()},t._checkGap=function(){const e=this._video.buffered,t=this._video.currentTime,n=this._getGapIndex(e,t);if(0===this._video.readyState)return!1;if(this._video.paused)return!1;const r=this._video.duration;if(t>=r)return this._video.currentTime=r-.1,!0;if(e.length<=n)return!1;const i=e.start(n);return!(i>=r||i-t>.5||0!==n||(this.stop(),this._correctFirstSegmentStart("audio",i),this._correctFirstSegmentStart("video",i),this._video.currentTime=i,0))},t._getGapIndex=function(e,t){if(!e||!e.length)return null;let n=0;for(;n<e.length;n++){const r=e.start(n),i=e.end(n);if(r>t&&(0===n||i-t<=.1))break}return n>=0?n:null},t._correctFirstSegmentStart=function(e,t){const n=this._getCurrentStream(0,e);n&&n.segments&&n.segments[0]&&(n.segments[0].start=t)},e}();let fa=function(){function e(e,t={}){this._scanner=e,this.sessionId=t.sessionId,this.clipId=t.clipId}var t=e.prototype;return t.getLogAsQueryParam=function(e,t){return this._buildCMCDQueryParam(this._getLog(e,t))},t._getLog=function(e,t){let n={};return Object.assign(n,this._getStaticSessionData()),Object.assign(n,this._getDynamicSessionData(e,t)),n},t._buildCMCDQueryParam=function(e){return tt({CMCD:this._getObjectAsAlphabetizedString(e)})},t._getStaticSessionData=function(){return{sid:`"${this.sessionId}"`,cid:`"${this.clipId}"`,st:this._getStreamType(),sf:this._getStreamingFormat()}},t._getDynamicSessionData=function(e,t){return{pr:this._scanner.playbackRate,br:this._scanner.getBitrateAtTime(this._scanner.currentTime,t,"max")/1e3,ot:this._getObjectType(t),bl:this._getBufferLength(e)}},t._getObjectType=function(e){switch(e){case"audio":return"a";case"video":return"v";default:return"av"}},t._getBufferLength=function(e){return Math.round(1e3*(parseFloat(e.end)-parseFloat(e.start)))},t._getStreamType=function(){switch(this._scanner.displayName){case"HLSLiveScanner":case"NativeHLSLiveScanner":return"l";case"MediaSourceScanner":default:return"v"}},t._getStreamingFormat=function(){switch(this._scanner.displayName){case"HLSLiveScanner":case"NativeHLSLiveScanner":return'"hls"';case"MediaSourceScanner":default:return'"dash"'}},t._getObjectAsAlphabetizedString=function(e){let t=[],n="";for(var r=0,i=Object.entries(e);r<i.length;r++){const[e,n]=i[r];t.push({key:e,value:n})}return t.sort((function(e,t){return e.key.localeCompare(t.key)})).forEach(({key:e,value:t})=>{n+=`${e}=${t},`}),n.replace(/,\s*$/,"")},e}();function pa(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}const _a=["supported"];function ma(e,t){var n=e();return n&&n.then?n.then(t):t(n)}const va=new Map;function ga(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(kh){return Promise.reject(kh)}}}const ya=qe("MediaCapabilities","color: white; background-color: green"),Ea=ga((function(e){let t;const n=ba(e);return va.get(n)||ma((function(){if(en.mediaCapabilities){const r=e.codecs.replace(/,.+/,""),i={type:"media-source",video:{contentType:`${e.mime_type}; codecs=${r}`,width:e.width,height:e.height,bitrate:e.bitrate,framerate:e.framerate}};return pa(navigator.mediaCapabilities.decodingInfo(i),(function(e){t=e,va.set(n,t)}))}}),(function(){return t}))})),Ta=ga((function(e=[]){let t=!1,n=e,r=[],i=[];return ma((function(){if(en.mediaCapabilities)return function(){if(0!==e.length)return function(o,s){try{var a=pa(Promise.all(e.map((function(e){return pa(Ea(e))}))),(function(o){if(o){if(n=function(e,t){return e.filter((e,n)=>_a.every(e=>t[n][e])||(ya(`Stream ${e.quality} is not supported`,t[n]),!1))}(e,o),0===n.length)return ya("No compatible streams found. Returning all available streams as safeguard."),t=!0,{compatibleStreams:e,incompatibleStreams:r,incompatibleStreamsAttributes:i};n.length<e.length?(r=e.filter(e=>-1===n.indexOf(e)),i=r.map(Sa),ya("Some streams are not supported. Returning compatible streams.")):ya("All streams are supported.")}}))}catch(kh){return s(kh)}return a&&a.then?a.then(void 0,s):a}(0,(function(e){ya("Error checking stream capabilities",e)}));ya("No streams to check for MediaCapabilities support")}();ya("MediaCapabilities API not supported")}),(function(e){return t?e:{compatibleStreams:n,incompatibleStreams:r,incompatibleStreamsAttributes:i}}))}));function Sa(e){const t=ba(e),n=va.get(t);return n?_a.filter(e=>!n[e]):[]}function ba(e){return`${e.mime_type};${e.codecs};${e.width};${e.height};${e.bitrate};${e.framerate}`}function Aa(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function wa(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(kh){return Promise.reject(kh)}}}let Ra=function(e){function t(t,n={}){var r;return(r=e.call(this,t,n)||this).reset(),r.manifestLoadDurations=[],r._preserveCurrentTime=!1,n.mediaSourceScanner&&(r._maxPreloadStreamIndex=n.mediaSourceScanner.maxPreloadStreamIndex),r}ge(t,e),t.supported=function(e){const t=Ko(e);return void 0!==t&&t.isTypeSupported},pe(t,null,[{key:"displayName",get:function(){return"MediaSourceScanner"}},{key:"supportedVideoTypes",get:function(){return["application/vnd.vimeo.dash+json","video/vnd.mpeg.dash.mpd"]}}]);var n=t.prototype;return n.deactivate=function(){e.prototype.deactivate.call(this),this.sorcerer&&this.sorcerer.destroy(),this.reset()},n.reset=function(){this._waitingOnSet=new Set,this._streamsForSegment={},en.browser.safari&&(this._gapJumper=new ha(this._video,this._getCurrentStream.bind(this))),this.resetBrain(),this._setupCMCDLogger(),this._ready=!1,this._startedPlaying=!1,this._manifest=null,this._streams={},this._streams.audio=[],this._streams.video=[],this._audioStreams=[],this._onReady=null,this._baseUrl=null,this._lastTargetStreamId=null,this._timeToSeekTo=null,this._resolveSeek=null,this._resolveStartPreload=null,this._reloadingExistingVideo=!1,this._lastStreamIndex=null,this._checkSwitchUp=!1,this._clearBufferAtTime=!1,this._preloadStream=null,this._removeBufferPromise=null,this._ranIntoBuffer=!1,this._restrictedStreamIndexes=[],this._switching={},this._lastDownloadBitrate=0,this._preloadSegmentStreamIndex=null,this._preserveCurrentTime=!1,clearInterval(this._loadSegmentsInterval),clearTimeout(this._slowLoadSegmentTimeout)},n.resetBrain=function(){const e=this._options.mediaSourceScanner||{};e.tests=this._options.tests,this._brain&&this._brain.destroy(),this._brain=new da(this,e)},n.preloadStream=function(){if(this._preloadStream)return this._preloadStream;let e=0,t=1;this._streams.audio.length&&(t=2);let n=this.sorcerer.video.activeStreamIndex;this._restrictedStreamIndexes.length&&(n=this._restrictedStreamIndexes[0]);let r=0;const i=this._brain.getSegmentsToLoad(!1,"video",n);i.length>0&&(r=i[0]);let o=()=>{};const s=(e=!1)=>{e&&(n=this.sorcerer.video.activeStreamIndex),this._preloadSegmentStreamIndex=n,this._restartLoadSegmentsIntervalWithBackoff(!0)},a=n=>{e+=1,e<t||(n.segment===r&&0===this._restrictedStreamIndexes.length?this._getStreamIndexToLoadAndSwitchReason(!0).then(t=>{let{index:r,reasonForSwitch:i}=t,a={reasonForSwitch:i};if(!1!==r&&r>n.stream){if(this.sorcerer.video.switchTo(r,!1,a),this._streams.audio.length){const e=this._brain.getAudioIndexFromVideo(this._streams.video,this._streams.audio,r);this.sorcerer.audio.switchTo(e,!1)}return e=0,void s(!0)}o()}).catch(console.error):o())};return this._preloadStream=new Promise((e,t)=>{o=()=>{const t=this._getCurrentStream(n).segments[0].end,r=this._getDuration(!0);if(this.currentTime>=r&&(this.currentTime=r),this.currentTime>t&&(this.sorcerer.clear(),this._waitingOnSet=new Set),this.sorcerer.video.switchTo(n,!1),this._streams.audio.length){const e=this._brain.getAudioIndexFromVideo(this._streams.video,this._streams.audio,n);this.sorcerer.audio.switchTo(e,!1)}this.sorcerer.off("bufferqueueadd",a),this._preloadSegmentStreamIndex=null,this._ready=!0,e()},this.sorcerer.on("bufferqueueadd",a),s()}),this._preloadStream},n.loadManifest=function(e){try{const t=this;return Aa(t.video.metadata.p2pReady,(function(){const n=Date.now();return en.browser.ie&&e&&-1!==e.indexOf("archive_playlist")?(setTimeout(()=>{t._fireVideoError("MediaUnknownError","An unknown error occurred.")},250),new Promise(()=>{})):kt({url:e,timeout:1e4,type:de.MANIFEST}).then(r=>(r.url&&r.url!==e&&-1!==r.url.indexOf("live-archive")&&(t._baseUrl=r.url.split("/").slice(0,-2).join("/")),t.manifestLoadDurations.push({url:e,status:r.status,duration:Date.now()-n}),t.fire(Ti.MANIFEST_LOADED),r.text())).then(wa((function(n){let r;return function(i,o){var s=function(){if(-1!==e.indexOf(".mpd"))return Aa(t._loadMediaManifest(),(function({parseMPD:t}){r=t(n,e)}));r=JSON.parse(n)}();return s&&s.then?s.then(o):o()}(0,(function(){return r}))}))).catch(r=>{if(t.manifestLoadDurations.push({url:e,status:r.response&&r.response.status,duration:Date.now()-n}),t.reset(),r instanceof ct&&410===r.response.status)return t.fire(Ti.MEDIA_URL_EXPIRED),new Promise(()=>{});throw r instanceof ct&&400===r.response.status?t.fire(Ti.MEDIA_URL_BAD_REQUEST,r.response.url):r instanceof dt&&t.fire(Ti.MANIFEST_TIMEOUT),r})}))}catch(kh){return Promise.reject(kh)}},n.setVideoSrc=function(e,t,n=!0){if(n&&!t&&this._onReady){var r;if(("metadata"===this._preload||"none"===this._preload&&!this.paused)&&!this._ready)return void this._onReady.then(()=>{const t=this.paused;this.setVideoSrc(e,t,!1)}).catch(console.error);if("sd-fallback"===(null==(r=this._telecineVideo.drmHandler)?void 0:r.state))return void this._onReady.then(()=>{this.setVideoSrc(e,!0,!1)}).catch(console.error);if("auto"===this._preload)return void this._onReady.then(()=>{this.setVideoSrc(e,!1,!1)}).catch(console.error)}t&&this.reset(),t||!this.paused||this.sorcerer||(t=!0);let i=this._initializeManifest;t&&(i=this._initialize);const o=e.split("/");o.pop();const s=`${o.join("/")}/`;this._reloadingExistingVideo=!t,this._onReady=this._startPreload(e,this._preload).then(this.loadManifest.bind(this)).then(e=>("string"==typeof this._baseUrl&&-1!==this._baseUrl.indexOf("live-archive")||(this._baseUrl=s),e)).then(i.bind(this)),t&&"auto"===this._preload&&(this._onReady=this._addCallbackToPromise(this._onReady,this.preloadStream.bind(this),!1)),this._onReady=this._addCatchToPromise(this._onReady)},n.getBitrateAtTime=function(e,t="video",n="average"){if(!this.sorcerer)return 0;const r=this.sorcerer.streamIndexAtTime(e,t),i=this._streams[t][r];var o;return i?null!==(o=i["average"===n?"avg_bitrate":"bitrate"])&&void 0!==o?o:i.bitrate:0},n.lockStreamIndexes=function(){const e=this._restrictedStreamIndexes.map(e=>this._streams.video.indexOf(this._streams.video[e])),t=!this.paused;if(t&&(this._ignorePauseEvent=!0,this._video.pause()),this._switching.video=!1,this._brain.lock(e),!this._startedPlaying&&"auto"!==this._preload)return;const n=Math.max(this.currentTime-7,0),r=Math.min(this.currentTime+7,this._video.duration);this.sorcerer.removeBuffer(n,r).then(()=>{!this._startedPlaying&&"auto"===this._preload||this.ended?this._loadSegments():(this.seekToTime(this.currentTime),t&&this.paused&&(this._ignorePlayEvent=!0,this._video.play()))}).catch(console.error)},n.seekToTime=function(e){if(e===this.currentTime)return Promise.resolve();if(null===this._timeToSeekTo||(this._lastSeekReject&&(this._lastSeekReject(),this._lastSeekReject=null),this._seekInProgressPromise=null,this._timeToSeekTo=null,this._resolveSeek=null),this._timeToSeekTo=e,this._handleScrubbing(),this._ready)for(const t in this._streams)if(this._streams[t].length>0){const e=this.sorcerer[t].activeStreamIndex;this.sorcerer[t].streams[e].abort()}return this._seekInProgressPromise=this._getSeekReadyPromiseForTime(e),Promise.all([this._onReady,this._removeBufferPromise]).then(()=>{this._loadSegments()}).catch(console.error),this._paused&&0===e&&this.fire(vi.SEEKING),this._onReady.then(()=>this._seekInProgressPromise).catch(e=>{})},n.takeSnapshot=function(){this._switchingVideo&&e.prototype.takeSnapshot.call(this)},n.initDrm=function(){},n.onstalled=function(){return!1},n.onseeked=function(e){this._startedPlaying&&this._restartLoadSegmentsIntervalWithBackoff()},n.onended=function(t){return e.prototype.onended.call(this,t),!0},n.onseeking=function(e){this._startedPlaying},n._handleScrubbing=function(){this._scrubStart(),clearTimeout(this._scrubTimeout),this._scrubTimeout=setTimeout(()=>{this._scrubEnd()},200)},n._scrubStart=function(){this._scrubbing||(this._scrubbing=!0)},n._scrubEnd=function(){this._scrubbing=!1},n.ontimeupdate=function(t){if(!this.sorcerer)return!1;if(e.prototype.ontimeupdate.call(this),this._gapJumper&&this._gapJumper.stop(),0===this.currentTime)return this._startedPlaying;if(this._timeToSeekTo)return!1;if(this._startedPlaying||(this._startedPlaying=!0),this._clearBufferAtTime&&this.currentTime>=this._clearBufferAtTime){const e=2;this.sorcerer.removeBuffer(0,this._clearBufferAtTime-e),this._clearBufferAtTime=!1}const n=this.sorcerer.getDroppedFrameTotal();this.fire(Ti.DROPPED_FRAMES,n);const r=this.sorcerer.getResponseSpeeds(),i=this._streams.video[this.sorcerer.video.activeStreamIndex],o=this._options.tests&&this._options.tests.download_bitrate;if((!o||!o.group)&&i&&this._brain.getCurrentSpeed){const e={speed:this._brain.getCurrentSpeed(),bitrate:i.bitrate,speeds:r};this.fire(Ti.BANDWIDTH,e)}const s=this._video.buffered.length;if(!s)return!0;const a=this._video.buffered.end(s-1);return Math.ceil(a)===Math.ceil(this._video.duration)||(Math.abs(this.currentTime-a)<.2?(this._ranIntoBuffer||(this.fire(Ti.STREAM_BUFFER_START,{hasLowerStreamIndex:this.sorcerer.video.activeStreamIndex>0}),this._ranIntoBuffer=!0),!1):void 0)},n._isEnded=function(){return!!this.ended||Math.ceil(this.currentTime)===Math.ceil(this._video.duration)},n._loadSegmentsIntervalTick=function(){if(!this.sorcerer)return!1;if("closed"===this.sorcerer._mediaSource.readyState)return!1;if(this._video.webkitCurrentPlaybackTargetIsWireless)return!1;if(this._isEnded())return!1;if(null!==this._preloadSegmentStreamIndex){try{this._loadPreloadSegments()}catch(kh){return this._handleLoadSegmentFailures(kh),!1}return!0}if(0===this.currentTime&&!this._ready)return this._startedPlaying;const e=this._loadSegments();return e&&"function"==typeof e.catch&&e.catch(this._handleLoadSegmentFailures.bind(this)),!0},n._handleLoadSegmentFailures=function(e){e.code===DOMException.INVALID_STATE_ERR?this.fire(Ti.SCANNER_ERROR,{reason:e}):this.fire(Ti.LOAD_SEGMENT_FAILED,new Eo(`${Ti.LOAD_SEGMENT_FAILED} - ${e.name}`,e.message)),clearInterval(this._loadSegmentsInterval)},n.onprogress=function(){this._brain.canPlayFromTimeInStream(this.currentTime,this._getCurrentStream())&&this._ranIntoBuffer&&(this.fire(Ti.STREAM_BUFFER_END),this._ranIntoBuffer=!1)},n.onwaiting=function(){return!this._gapJumper||!this._gapJumper.start()},n.onerror=function(){return!!this._video.error&&(this._video.error.code===this._video.error.MEDIA_ERR_DECODE?(this.fire(Ti.SCANNER_ERROR,{reason:`encountered media decode error. Message: "${this._video.error.message}"`}),!1):this._video.error.code===this._video.error.MEDIA_ERR_SRC_NOT_SUPPORTED?(this._preserveCurrentTime=!0,this.fire(Ti.SCANNER_ERROR,{reason:`encountered media source not supported error. Message: "${this._video.error.message}"`}),!1):e.prototype.onerror.call(this))},n.pause=function(){e.prototype.pause.call(this)},n.play=function(){return this._restartLoadSegmentsIntervalWithBackoff(),e.prototype.play.call(this,()=>(this._resolveStartPreload&&this._resolveStartPreload(),this._reloadingExistingVideo||this._ready||"auto"===this._preload||(this._onReady=this._addCallbackToPromise(this._onReady,this.preloadStream.bind(this))),this._onReady.then(()=>Promise.resolve(this._seekInProgressPromise))))},n.onpause=function(){return this._ignorePauseEvent?(this._ignorePauseEvent=!1,!1):(e.prototype.onpause.call(this),!0)},n.onplay=function(){return!this._ignorePlayEvent||(this._ignorePlayEvent=!1,!1)},n._addCallbackToPromise=function(e,t,n=!0){let r=e.then(t);return n&&(r=this._addCatchToPromise(r)),r},n._addCatchToPromise=function(e){return e.catch(e=>(this.fire(Ti.FILE_ERROR,{reason:e}),new Promise((e,t)=>{})))},n._handleBufferForSeek=function(){this._ready&&this._streams.video[this.sorcerer.video.activeStreamIndex].bitrate/1e3>12e3&&(this._removeBufferPromise=this.sorcerer.removeBuffer())},n._startPreload=function(e,t){return new Promise((n,r)=>{"none"!==t||this._reloadingExistingVideo&&!this.paused?n(e):this._resolveStartPreload=()=>{n(e),this._resolveStartPreload=null}})},n._getSeekReadyPromiseForTime=function(e=this._timeToSeekTo){return new Promise((t,n)=>{const r=this._startedPlaying&&0===e,i=this._brain.canPlayFromTimeInStream(e,this._getCurrentStream());r||i?t(e):(this._handleBufferForSeek(),this._resolveSeek=t)}).then(e=>{this._timeToSeekTo=null,this._seekInProgressPromise=null;const t=new Promise((e,t)=>{this._lastSeekReject=t;const n=()=>{e(this._video.currentTime),this._video.removeEventListener("seeked",n)};this._video.addEventListener("seeked",n)});return this._video.currentTime=e,t})},n._handlePreloadChanged=function(e,t){"auto"!==e&&"auto"===t&&(this._onReady=this._addCallbackToPromise(this._onReady,this.preloadStream.bind(this))),e!==t&&"none"!==t&&this._resolveStartPreload&&this._resolveStartPreload()},n._avDurationDifference=function(e){const t=e.audio.reduce((e,t)=>e+t.duration,0),n=e.video.reduce((e,t)=>e+t.duration,0),r=t/e.audio.length,i=n/e.video.length;return r+4<i?i-r:0},n._manifestContainsSegmentSizes=function(e){return e.video.every(e=>e.segments.every(e=>"size"in e))},n._initializeManifest=function(e){const t=this;return new Promise(wa((function(n,r){if(t._manifest=e,t._streams.video=t._sortVideoStreams(e.video),e.audio){const n=t._avDurationDifference(e);if(n>0)return t.fire(Ti.AV_DURATION_MISMATCH,n),t.fire(Ti.SCANNER_ERROR,{reason:"Encountered A/V duration mismatch"}),void r();const i=e.audio.filter(e=>"opus"===e.codecs),o=e.audio.filter(e=>"opus"!==e.codecs),s=en.browser.safari||en.iOS||en.iPadOS||!MediaSource.isTypeSupported('audio/mp4; codecs="opus"')||!i.length?o:i;t._streams.audio=t._sortAudioStreams(s)}for(let i=0;i<t._streams.video.length;i++){let n=0;if(e.audio){const e=t._brain.getAudioIndexFromVideo(t._streams.video,t._streams.audio,i),r=t._streams.audio[e];r&&(n=r.bitrate)}t._streams.video[i].audioBitrate=n}return t._initDrm(t._streams.video,t._streams.audio,t._manifest.key_info),t._manifestContainsSegmentSizes(e)||t.resetBrain(),t.fire(Ti.STREAMS_LOADED,t._streams),Aa(Ta(t._streams.video),(function({compatibleStreams:e,incompatibleStreams:r,incompatibleStreamsAttributes:i}){t._streams.video=e,r.length&&(t.fire(Ti.AVAILABLE_STREAMS_CHANGED),t.fire(Ti.MEDIA_CAPABILITY_STREAMS_UNSUPPORTED,{incompatibleStreams:r,incompatibleStreamsAttributes:i})),n()}))})))},n._setUpSorcerer=function(e,t){if(this.sorcerer&&this.sorcerer.destroy(),this.sorcerer=new la(e,t),Yo(this.sorcerer.mediaSource)){const t=document.createElement("source");t.type="video/mp4",t.src=URL.createObjectURL(this.sorcerer.mediaSource),e.appendChild(t);const{src:n,mime:r}=this._telecineVideo.externalDisplayFiles.AirPlay,i=document.createElement("source");i.type=r,i.src=n,e.appendChild(i)}else e.src=URL.createObjectURL(this.sorcerer.mediaSource);this.successfulSegments=this.sorcerer.getSuccessfulSegments(),this.failedSegments=this.sorcerer.getFailedSegments(),this._restartLoadSegmentsIntervalWithBackoff()},n._restartLoadSegmentsIntervalWithBackoff=function(e=!1){this._restartLoadSegmentsInterval(500),clearTimeout(this._slowLoadSegmentTimeout),this._slowLoadSegmentTimeout=setTimeout(()=>{this._restartLoadSegmentsInterval(5e3)},6e4),e&&this._loadSegmentsIntervalTick()},n._restartLoadSegmentsInterval=function(e){clearInterval(this._loadSegmentsInterval),this._loadSegmentsInterval=setInterval(()=>{this._loadSegmentsIntervalTick()},e)},n._getDuration=function(e=!1){let t=e?1/0:0;for(const n in this._streams)this._streams[n].length&&(t=Math[e?"min":"max"](t,this._streams[n][0].duration));return t},n._initialize=function(e){return this._initializeManifest(e).then(()=>{const t=this.video&&this.video.metadata.percentShown?this.video.metadata.percentShown:null,n=this._brain.filterStreams(this._streams.video,this._video.clientWidth,this._video.clientHeight,t).length-1;let r=this._streams.video[0];this._restrictedStreamIndexes.length&&(r=this._streams.video[this._restrictedStreamIndexes[0]]),void 0!==this._maxPreloadStreamIndex&&n<=this._streams.video.indexOf(e.video[this._maxPreloadStreamIndex])&&(r=this._streams.video[n]),this._setUpSorcerer(this._video,{duration:this._getDuration(),fetcherTimeout:8e3,fetcherRetryAbortErrors:!1,disableMMS:this._options.disableMMS}),this.sorcerer.on("srcnotsupported",()=>{this.fire(Ti.SCANNER_ERROR,{reason:"this codec is not supported for mediasource playback"})}),this._video.addEventListener("webkitcurrentplaybacktargetiswirelesschanged",e=>{const t=!this._video.webkitCurrentPlaybackTargetIsWireless,n="closed"===this.sorcerer._mediaSource.readyState;t&&n&&this.fire(Ti.SCANNER_ERROR,{reason:"MediaSource was closed during AirPlay, falling back to Native HLS playback."})});const i=this._streams.video.indexOf(r);for(const e in this._streams)this._streams[e].forEach((t,n)=>{let r=this._getSegmentUrl(n,"init",e);this._useRangeRequests(n,e)&&this._streams[e][n].init_segment_range&&(r={url:r,byteRange:this._getRangeForSegment(n,"init",e)}),this.sorcerer.addStream(`${t.mime_type}; codecs="${this._streams[e][n].codecs}"`,r)});this.sorcerer.video.switchTo(i,!0,{reasonForSwitch:7}),this.sorcerer.on("queued",this._handleQueued.bind(this)),this.sorcerer.on("downloadabort",this._handleAborted.bind(this)),this.sorcerer.on("appendbufferend",this._handleAppendBufferEnd.bind(this)),this.sorcerer.on("downloadstart",this._handleDownloadStart.bind(this)),this.sorcerer.on("downloadend",this._handleDownloadEnd.bind(this)),this.sorcerer.on("downloaderror",this._handleDownloadError.bind(this)),this.sorcerer.on("downloadtimeout",this._handleDownloadTimeout.bind(this)),this.sorcerer.on("quotaexceedederror",this._handleQuotaExceededError.bind(this)),this.sorcerer.video.on("streamchange",this._handleStreamChange.bind(this)),this.sorcerer.video.on("streamchangestart",this._handleStreamChangeStart.bind(this)),this.sorcerer.mediaSource.addEventListener("sourceended",()=>{this.fire(vi.PROGRESS)})})},n._sortVideoStreams=function(e){const t=e.slice(0);return t.sort((function(e,t){const n=e.width*e.height*e.bitrate,r=t.width*t.height*t.bitrate;return e.width===t.width&&e.height===t.height?e.framerate-t.framerate:n-r})),t},n._sortAudioStreams=function(e){const t=e.slice(0);return t.sort((function(e,t){return e.bitrate*e.channels-t.bitrate*t.channels})),t},n._useRangeRequests=function(e,t){return!!this._streams[t][e].segments[0].range},n._getRangeForSegment=function(e,t,n){return"init"===t?this._streams[n][e].init_segment_range:this._streams[n][e].segments[t].range},n._getSegmentPriority=function(e,t,n="video"){return"init"===t?0:this._streams[n][e].segments[t].start},n._getSegmentUrl=function(e,t,n="video",r=!1){if("init"===t&&!this._streams[n][e].init_segment_range&&-1===this._streams[n][e].init_segment.indexOf("."))return function(e){return _o(e).buffer}(this._streams[n][e].init_segment);let i=this._baseUrl;const o=this._manifest.base_url&&-1!==this._manifest.base_url.indexOf("//");if(o&&(i=this._manifest.base_url),this._manifest.base_url&&!o&&(i+=this._manifest.base_url),this._streams[n][e].base_url&&(i+=this._streams[n][e].base_url),this._useRangeRequests(e,n))return i;if("init"===t)return i+=this._streams[n][e].init_segment,i;const s=this._streams[n][e].segments[t];s.url&&(i+=s.url);const a=-1!==i.indexOf("akamaized"),u=-1===i.indexOf("?")?"?":"&";return r&&this.CMCDLogger&&a&&(i+=`${u}${this.CMCDLogger.getLogAsQueryParam(s,n)}`),i},n._key=function(e,t,n){return`${e}:${t}:${n}`},n._isFinalSegment=function(e,t,n){return t===this._streams[n][e].segments.length-1},n._getCurrentlyLoadingStreamsForSegment=function(e,t){const n=[],r=this._streamsForSegment[e];if(!r)return n;for(let i=0;i<r.length;i++)this._waitingOnSet.has(this._key(r[i],e,t))&&n.push(r[i]);return n},n.getCurrentStream=function(e="video"){return this._getCurrentStream(0,e)},n._getCurrentStream=function(e=0,t="video"){return void 0!==this.sorcerer&&(e=this.sorcerer[t].activeStreamIndex),this._streams[t][e]},n._getStreamIndexToLoadAndSwitchReason=function(e){let t=this._streams.video;const n=this.video&&this.video.metadata.percentShown?this.video.metadata.percentShown:null;if(t=this._brain.filterStreams(t,this._video.clientWidth,this._video.clientHeight,n),0===t.length)return Promise.resolve({index:!1,reasonForSwitch:null});if(this._switching.video)return Promise.resolve({index:!1,reasonForSwitch:null});const r=t[t.length-1];if(r.id!==this._lastTargetStreamId){this._lastTargetStreamId=r.id;const e={index:this._streams.video.indexOf(r),streams:this._streams.video};this.fire(Ti.STREAM_TARGET_CHANGE,e)}const i=this._getCurrentStream();return this._brain.shouldPowerUp(t,i,e).then(e=>!1===e.index?this._brain.shouldPowerDown(t,i).then(e=>!1===e.index?{index:e.index,reasonForSwitch:e.reasonForSwitch}:{index:this._streams.video.indexOf(t[e.index]),reasonForSwitch:e.reasonForSwitch}):{index:this._streams.video.indexOf(t[e.index]),reasonForSwitch:e.reasonForSwitch})},n._loadSegmentsForType=function(e="video"){return this.sorcerer.allowSegmentRequests?this._getStreamIndexToLoadAndSwitchReason(!1).then(t=>{let{index:n,reasonForSwitch:r}=t,i={reasonForSwitch:r};"audio"===e&&(!1===n&&(n=this.sorcerer.video.activeStreamIndex),n=this._brain.getAudioIndexFromVideo(this._streams.video,this._streams.audio,n),this.sorcerer.audio.activeStreamIndex===n&&(n=!1));let o=!1;!1!==n&&(o=n>this.sorcerer[e].activeStreamIndex,this._switching[e]=!0,this.sorcerer[e].switchTo(n,!0,i).then(()=>{this._switching[e]=!1}).catch(console.error));let s=o;const a=this._brain.getSegmentsToLoad(s,e,this._getCurrentStream()),u=this.sorcerer[e].activeStreamIndex;for(let c=0;c<a.length;c++){const t=this._getSegmentUrl(u,a[c],e,!0),n=this._getCurrentlyLoadingStreamsForSegment(a[c],e);if(n.length>1)continue;if(1===n.length&&u<=n[0])continue;const r=this._isFinalSegment(u,a[c],e),i={stream:u,segment:a[c],type:e},o=this.sorcerer[e].streams[u];let s=t;this._useRangeRequests(u,e)&&(s={url:s,byteRange:this._getRangeForSegment(u,a[c],e)});const l=this._getSegmentPriority(u,a[c],e),d="video"===e;let h=null;0===u&&"video"===e&&(h=16e3);let f=null;try{f=this._streams[e][u].segments[a[c]].size}catch(kh){}o.addSegment(s,{identifier:i,isFinalSegment:r,priority:l,includeWithBandwidthChecks:d,timeout:h,size:f}).catch(e=>{})}}).catch(e=>{throw e}):Promise.resolve()},n._loadPreloadSegments=function(){for(const e in this._streams){if(0===this._streams[e].length)continue;let t=0;const n=this._brain.getSegmentsToLoad(!1,e,this._getCurrentStream());n.length>0&&(t=n[0]);let r=this._preloadSegmentStreamIndex;"audio"===e&&(r=this._brain.getAudioIndexFromVideo(this._streams.video,this._streams.audio,this._preloadSegmentStreamIndex));const i=this._key(r,t,e);if(this._waitingOnSet.has(i))continue;const o=this._getSegmentUrl(r,t,e),s=this._isFinalSegment(r,t,e),a=this.sorcerer[e].streams[r],u={stream:r,segment:t,type:e},c=!0;let l=o;this._useRangeRequests(r,e)&&(l={url:l,byteRange:this._getRangeForSegment(r,t,e)}),a.addSegment(l,{identifier:u,isFinalSegment:s,loadOnly:c,priority:0}).catch(e=>{})}},n._loadSegments=function(){const e=this._video.webkitCurrentPlaybackTargetIsWireless,t="closed"===this.sorcerer._mediaSource.readyState;return e||t?Promise.resolve():this._onReady&&this._onReady.then(e=>{const t=[];for(const n in this._streams)this._streams[n].length>0&&t.push(this._loadSegmentsForType(n));return Promise.all(t)})},n._handleQueued=function(e){this._waitingOnSet.add(this._key(e.stream,e.segment,e.type)),this._streamsForSegment[e.segment]||(this._streamsForSegment[e.segment]=[]),-1===this._streamsForSegment[e.segment].indexOf(e.stream)&&this._streamsForSegment[e.segment].push(e.stream)},n._clearWaitingOn=function(e){(this._streamsForSegment[e.segment]||[]).forEach(t=>{this._waitingOnSet.delete(this._key(t,e.segment,e.type))})},n._handleAborted=function(e){this._streamsForSegment[e.segment]&&this._clearWaitingOn(e)},n._handleAppendBufferEnd=function(e){this.fire(Ti.APPEND_BUFFER_END,{identifier:e}),this._restartLoadSegmentsIntervalWithBackoff(),this._checkSwitchUp&&e.stream===this._lastStreamIndex&&(this._checkSwitchUp=!1,this._clearBufferAtTime=this._streams.video[e.stream].segments[e.segment].start),this._streamsForSegment[e.segment]&&this._clearWaitingOn(e);const t=this._brain.canPlayFromTimeInStream(this._timeToSeekTo,this._getCurrentStream());null!==this._timeToSeekTo&&this._resolveSeek&&t&&(this._resolveSeek(this._timeToSeekTo),this._resolveSeek=null),this._gapJumper&&this._gapJumper.onSegmentAppended()},n._handleDownloadStart=function(e){this.fire(Ti.DOWNLOAD_START,{identifier:e})},n._handleDownloadEnd=function(e,t){this.fire(Ti.DOWNLOAD_END,{identifier:e,data:t})},n._handleDownloadError=function(e,t){this._clearWaitingOn(e);let n=Ti.DOWNLOAD_ERROR;410===t&&(n=Ti.MEDIA_URL_EXPIRED),502===t&&this.video.metadata.drm&&(n=Ti.DRM_FAILURE),this.fire(n,{identifier:e,status:t})},n._handleDownloadTimeout=function(e,t){this.fire(Ti.DOWNLOAD_TIMEOUT,{identifier:e,data:t}),this._streamsForSegment[e.segment]&&this._clearWaitingOn(e),"video"===e.type?this._switching.video=!1:"audio"===e.type&&(this._switching.audio=!1)},n._handleQuotaExceededError=function(e){this.fire(Ti.QUOTA_EXCEEDED_ERROR,{buffered:e})},n._handleStreamChangeStart=function(e,t){const n={previousStreamIndex:this._manifest.video.indexOf(this._streams.video[e]),index:this._manifest.video.indexOf(this._streams.video[t]),streams:this._manifest.video};this.fire(Ti.STREAM_CHANGE_START,n)},n._handleStreamChange=function(e,t){var n;if(!(null==(n=this._manifest)?void 0:n.video))return;e>this._lastStreamIndex&&this.currentTime>0&&(this._checkSwitchUp=!0),this._lastStreamIndex=e;const r={index:this._manifest.video.indexOf(this._streams.video[e]),streams:this._manifest.video,metadata:t};this.fire(Ti.STREAM_CHANGE,r)},n._initDrm=function(e=[],t=[],n={}){const r=this._telecineVideo.drmHandler;if(!r)return;const i={audio:t.map(e=>`${e.mime_type};codecs="${e.codecs}"`),video:e.map(e=>`${e.mime_type};codecs="${e.codecs}"`)};r.init(this,i,n),r.setFallbackCallback(()=>this.pause())},n._setupCMCDLogger=function(){var e,t;(null==(e=this._options.tests)||null==(t=e.cmcd)?void 0:t.group)&&(this.CMCDLogger=new fa(this,this._options.sessionMetadata))},n._loadMediaManifest=function(){return Promise.resolve().then((function(){return lo}))},pe(t,[{key:"preload",get:function(){return this._preload},set:function(e){this._handlePreloadChanged(this._preload,e),this._preload=e}},{key:"videoElement",get:function(){return this._video}},{key:"videoWidth",get:function(){const e=this._getCurrentStream();return e?e.width:this._video.videoWidth}},{key:"videoHeight",get:function(){const e=this._getCurrentStream();return e?e.height:this._video.videoHeight}},{key:"restrictedStreamIndexes",get:function(){return this._restrictedStreamIndexes},set:function(e){this._restrictedStreamIndexes.join(",")!==e.join(",")&&(this._restrictedStreamIndexes=e,this._onReady.then(()=>this.lockStreamIndexes()).catch(console.error))}},{key:"currentTime",get:function(){return null!==this._timeToSeekTo?this._timeToSeekTo:this._video.currentTime},set:function(e){(this._startedPlaying||0!==e)&&this.seekToTime(e)}},{key:"downloadSpeed",get:function(){return this._lastDownloadBitrate}},{key:"brainDebug",get:function(){const e=this.sorcerer&&this._brain&&this._brain.getCurrentSpeed?this._brain.getCurrentSpeed():null;let t=this.sorcerer&&this.sorcerer.getResponseSpeeds?this.sorcerer.getResponseSpeeds():null;return t=t?t.slice(-20):[],{currentSpeed:e,responseSpeeds:t}}},{key:"isLowerProfileAvailable",get:function(){return this.sorcerer?this.sorcerer.video.activeStreamIndex>0:null}},{key:"videoStreams",get:function(){return this._streams.video}}]),t}(xo),Ia=function(){function e(e){this._scanner=e,this._currentTime=0,this._latencyInterval=setInterval(this._onLatencyInterval.bind(this),500)}var t=e.prototype;return t.destroy=function(){clearInterval(this._latencyInterval)},t._onLatencyInterval=function(){const e=this._scanner.videoElement,t=this._scanner.getCurrentStream();if(!e||!t)return;this._currentTime=e.currentTime;const n=this._computeLatency();null!==n&&(this._latency=n,this._scanner.fire(Si.LATENCY_UPDATED,n),this._scanner.lowLatencyMode&&(en.browser.ie||en.browser.safari||null!==this._scanner.presentationDelay&&(e.playbackRate=1)))},t._estimateLiveEdge=function(){const e=this._scanner.getCurrentStream();return e?e.edge+e.age:null},t._computeLatency=function(){const e=this._estimateLiveEdge();return null===e||0===this._currentTime?null:e-this._currentTime},t._getForwardBufferLength=function(){const e=this._scanner.videoElement,t=this._scanner.getCurrentStream();if(!e||!t)return 0;const n=e.buffered.length;return n?e.buffered.end(n-1):t.edge-this._currentTime},pe(e,[{key:"latency",get:function(){return this._latency}},{key:"liveSyncPosition",get:function(){const e=this._estimateLiveEdge(),t=this._scanner.presentationDelay,n=this._scanner.getCurrentStream();return null===e||null===t||null===n?0:e-t-this.edgeStalled}},{key:"edgeStalled",get:function(){const e=this._scanner.getCurrentStream();if(!e)return 0;const t=3*(this._scanner.lowLatencyMode&&e.partTargetDuration||e.targetDuration);return Math.max(e.age-t,0)}}]),e}();const ka=[1,2,5];let Pa=function(e){function t(t,n={}){var r;return(r=e.call(this,t,n)||this)._UPSHIFT_BANDWIDTH_THRESHOLD=.4,r._DOWNSHIFT_BANDWIDTH_THRESHOLD=.6,r.consecutiveStreamIndex={},r.isNewPlayback=!0,r}ge(t,e),pe(t,[{key:"displayName",get:function(){return"Live"}}]);var n=t.prototype;return n.optimalStream=function(e,t){var n,r;this.isNewPlayback&&((null==(r=this.scanner.sorcerer)?void 0:r.getResponseSpeeds().length)>=2&&(this.isNewPlayback=!1));if(1===e.length)return{index:0,reasonForSwitch:6};if(this.isNewPlayback){let t=0,n=0,r=this.scanner.videoElement.clientHeight,i=[];for(let o=0;o<e.length;o++){let s=e[o].height;i.push(s),s<r&&s>n&&(t=o,n=e[o].height)}return t=Math.max(0,t-1),{index:t,reasonForSwitch:4}}const i=this.getCurrentSpeed();let o=t,s=t;for(let f=0;f<e.length;f++)i*this._UPSHIFT_BANDWIDTH_THRESHOLD>e[f].bandwidth&&(o=f),i*this._DOWNSHIFT_BANDWIDTH_THRESHOLD>e[f].bandwidth&&(s=f);const a=t<o?o:s;this._clearConsecutiveStreamIndexes(a),this.consecutiveStreamIndex[a]++;const u=this.scanner.lowLatencyMode?.5:1.5,c=this.scanner.segmentLength*u,l=this.scanner.videoElement,d=l.buffered,h=null==(n=this._options.mediaSourceScanner)?void 0:n.droppedFrameSwitchPercent;return d&&0!==d.length?d.end(d.length-1)-l.currentTime<c?{index:0!==t?t-1:0,reasonForSwitch:1}:t>0&&!isNaN(h)&&this.hasTooManyDroppedFrames(t,this.scanner.getCurrentStream(),h)?(this.blacklist(t),this.scanner.fire(Ti.DROPPED_FRAME_PERCENT_EXCEEDED),{index:t-1,reasonForSwitch:2}):this.consecutiveStreamIndex[a]>2&&a!==t?{index:a,reasonForSwitch:3}:{index:t,reasonForSwitch:null}:{index:0,reasonForSwitch:5}},n.getCurrentSpeed=function(){var e;return null==(e=this.scanner.sorcerer)?void 0:e.getCurrentSpeed({type:"average",howMany:5,weights:ka})},n._clearConsecutiveStreamIndexes=function(e){this.consecutiveStreamIndex[e]||(this.consecutiveStreamIndex[e]=0);for(const t in this.consecutiveStreamIndex)this.consecutiveStreamIndex.hasOwnProperty(t)&&parseInt(t,10)!==e&&(this.consecutiveStreamIndex[t]=0)},n.getAvailabilityStart=function(e,t){return this._getSegmentAvailabilityStart(e,t.edge)},n.getAvailabilityEnd=function(e,t){return this._getSegmentAvailabilityEnd(e,t.edge)},n.canPlayFromTimeInStream=function(e,t){return!!t&&this.isTimeInBuffer(e,this.scanner._video.buffered,this.scanner._video.duration)},n.getSegmentsToLoad=function(e,t,n){var r,i,o,s;const{currentTime:a,liveTailTime:u,sorcerer:c,bufferTarget:l,atLiveEdge:d}=this.scanner,h=null==(r=c[t])||null==(i=r.sourceBuffer)?void 0:i.buffered,f=(null==h?void 0:h.length)?h.start(h.length-1):0,p=Ye(Math.max(a,f),h);if(!e&&p>=l)return[];const _=Math.max(a,u),m=d?n.edge:_,v=this._getSegmentAvailabilityStart(m,n.edge),g=this._getSegmentAvailabilityEnd(m,n.edge),y=this.scanner.lowLatencyMode&&(null==(o=n.parts)?void 0:o.length),E=[].concat(Re(n.segments),Re(null!==(s=n.parts)&&void 0!==s?s:[])),T=(y?n.parts:E).filter(t=>!!t.uri&&(e||!this.scanner.isSegmentAdded(t))&&!(t.end<v||t.start>g));return y&&T.forEach((e,t)=>{for(;e=e.dependentOn;)T.includes(e)||this.scanner.isStreamSegmentAdded(e)||T.splice(t,0,e)}),c[t].activeStreamIndex,T},n._getSegmentAvailabilityStart=function(e,t){const n=t-this._getPresentationDelay();return Math.max(0,Math.min(e,n))},n._getSegmentAvailabilityEnd=function(e,t){const n=e+this.scanner.bufferTarget;return Math.min(n,t)},n._getPresentationDelay=function(){return this.scanner.presentationDelay||this.scanner.manifest.presentationDelay},t}(da);const Da=["disabled","hidden","showing"],Oa=["subtitles","captions","descriptions","chapters","metadata"],La=["ar","fa","he","iw","ku","ps","sd","ur","yi"],Ca=new WeakMap,Na=new WeakMap;let Ma=function(e){function t({kind:t,src:n=null,label:r="",language:i="",id:o=st()},s){var a;if(a=e.call(this)||this,-1===Oa.indexOf(t))throw bo(12,"SYNTAX_ERR","Syntax Error");return Object.defineProperties(we(a),{kind:{value:t,enumerable:!0},label:{value:r,enumerable:!0},language:{value:i,enumerable:!0},id:{value:`${o}`,enumerable:!0},rtl:{value:-1!==La.indexOf(i.substr(0,2)),enumerable:!0}}),a.video=s,a.src=n,a._modeHasBeenSet=!1,Ca.set(we(a),"disabled"),a}return ge(t,e),t.prototype.dispatchEvent=function(e){this.fire(e,{target:this})},pe(t,[{key:"mode",get:function(){return Ca.get(this)},set:function(e){if(Da.indexOf(e)>-1){if(this._modeHasBeenSet=!0,Ca.get(this)===e)return;Ca.set(this,e),this.video.currentScanner&&this.video.currentScanner.setModeForTrack(this,e),this.dispatchEvent("modechange")}}},{key:"src",get:function(){return Na.get(this)},set:function(e){Na.set(this,e),this.video.fire(Ti.TEXT_SRC_UPDATE,this)}},{key:"cues",get:function(){return this.video.currentScanner?this.video.currentScanner.getCuesForTrack(this):[]}},{key:"activeCues",get:function(){return this.video.currentScanner?this.video.currentScanner.getActiveCuesForTrack(this):[]}},{key:"trackElement",get:function(){return document.getElementById(`telecine-track-${this.id}`)}}]),t}(er);function xa(e){var t=/^(?:(\d{2,}):)?(\d{2}):(\d{2})[,.](\d{3})$/.exec(e);if(!t)return-1;var n=parseInt(t[4],10)/1e3;return n+=parseInt(t[3],10),t[2]&&(n+=60*parseInt(t[2],10)),t[1]&&(n+=60*parseInt(t[1],10)*60),n}function Ua(e){var t=0,n=e.split(/(?:(?:\r\n|\n){2,})/),r=[],i=null;do{0===t&&/^\uFEFF?WEBVTT(?: .*)?/.test(n[t])&&t++,(i=/^(?:(.*)(?:\r\n|\n))?([\d:,.]+) --> ([\d:,.]+)(.*)?(?:\r\n|\n)([\s\S]*)/.exec(n[t]))&&r.push({startTime:xa(i[2]),endTime:xa(i[3]),text:i[5]}),t++}while(t<n.length);return r}function Fa(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function ja(e,t){try{var n=e()}catch(kh){return t(kh)}return n&&n.then?n.then(void 0,t):n}function Va(e,t){return e&&e.then?e.then(t):t(e)}function Ba(){}function Ha(e,t){var n=e();return n&&n.then?n.then(t):t(n)}function Xa(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(kh){return Promise.reject(kh)}}}function qa(e,t){if(!t)return e&&e.then?e.then(Ba):Promise.resolve()}const Wa=en.browser.ie||en.browser.edge?.5:.2;let Ga=function(e){function t(t,n={}){var r,i,o,s,a,u,c,l;return(l=e.call(this,t,n)||this)._playInitiated=!1,l._captionsVisible=!1,l._captionsLoading=!1,l._atLiveEdge=!0,l._atLiveTail=!1,l._STREAM_SWITCH_CHECK_INTERVAL=2e3,l._DOWN_SHIFT_CHECK_INTERVAL=1e4,l.reset(),l.defaultPresentationDelay=null!==(r=n.presentationDelay)&&void 0!==r?r:n.lowLatencyMode?3:12,l.defaultBufferTarget=n.lowLatencyMode?3:12,l.bufferTarget=l.defaultBufferTarget,l.presentationDelay=l.defaultPresentationDelay,l.lowLatencyMode=null!==(i=n.lowLatencyMode)&&void 0!==i&&i,l.disableDeltaUpdates=null!==(o=n.disableDeltaUpdates)&&void 0!==o&&o,Object.defineProperty(we(l),"eventIsLowLatency",{value:null!==(s=n.lowLatencyMode)&&void 0!==s&&s,writable:!1}),Object.defineProperty(we(l),"eventHasDVREnabled",{value:null!==(a=n.dvrEnabled)&&void 0!==a&&a,writable:!1}),l._timeoutTest=null==(u=l._options.tests)||null==(c=u.llhls_timeout)?void 0:c.group,window.addEventListener("online",()=>{l.play()}),l}ge(t,e),t.supported=function(e){const t=Ko(e);return void 0!==t&&t.isTypeSupported},pe(t,null,[{key:"displayName",get:function(){return"HLSLiveScanner"}},{key:"supportedVideoTypes",get:function(){return["application/x-mpegURL"]}}]);var n=t.prototype;return n.deactivate=function(){e.prototype.deactivate.call(this),this.reset()},n.reset=function(){var e,t,n;null==(e=this._sorcerer)||e.destroy(),null==(t=this._manifestLoader)||t.stop(),null==(n=this._latencyController)||n.destroy(),this._videoReady=new Ke,this._sorcerer=null,this._streams={},this._streams.video=[],this._streams.audio=[],this._lastStreamIndex=0,this._isOnline=!1,this._hasLiveEventEnded=!1,this._timeSinceLastStreamSwitchCheck=0,this._timeSinceLastDownShift=Number.NEGATIVE_INFINITY,this._lastStallCurrentTime=-1,this._timeToSeekTo=null,this._resolveSeek=null,this._abr=new Pa(this,this._options),this._latencyController=new Ia(this),this._restrictedStreamIndexes=[],this._switching={},this._segmentsAdded={},this._captionsAddedToTextTrack={},this._captionsAddedToTranscript={},this._fetchedCues={}},n.endLive=function(){var t;this._isOnline=!1,this._hasLiveEventEnded=!0,this.eventHasDVREnabled&&!this.atLiveEdge||(null==(t=this._manifestLoader)||t.stop(),this._sorcerer&&(this._sorcerer.abortFetches(),this._sorcerer.endOfStream()),this.eventHasDVREnabled||e.prototype.deactivate.call(this),this.fire(vi.ENDED))},n._signalOnline=function(){this._isOnline||(this._isOnline=!0,this.fire(Si.STREAM_ONLINE))},n._signalOffline=function(){this._isOnline&&(this._isOnline=!1,this.fire(Si.STREAM_OFFLINE))},n._toggleConnection=function(e){e?this._signalOnline():this._signalOffline()},n._loadManifest=function(e){try{const t=this;if(t._hasLiveEventEnded)return;t._manifestLoader&&(t._manifestLoader.stop(),t._manifestLoader.off());let n=[t._loadMediaManifest()];return t.video.metadata.p2pReady&&n.push(t.video.metadata.p2pReady),Fa(Promise.allSettled(n),(function([n]){const{M3U8Loader:r,PLAYLIST_UPDATE:i,PLAYLIST_ERROR:o,convertTsCodecs:s}=n.value;return t._manifestLoader=new r({disableDeltaUpdates:t.disableDeltaUpdates}),t._manifestLoader.lowLatencyMode=t.lowLatencyMode,t._manifestLoader.dvrEnabled=t.eventHasDVREnabled,t._manifestLoader.on(i,t._onPlaylistUpdate.bind(t)),t._manifestLoader.on(o,e=>{t._signalOffline()}),Va(ja((function(){const n=t.video.metadata.playlistRefreshUrl;return Fa(t._manifestLoader.start(e,n),(function(e){t._manifest=e,t._signalOnline()}))}),(function(e){throw t._signalOffline(),t.endLive(),e})),(function(e){t._streams.video=Ka(function(e){return e.filter(t=>t.codecs.split(".")[0]===e[0].codecs.split(".")[0])}(function(e){const t=e.slice(0);return t.sort((function(e,t){const n=e.width*e.height*e.bitrate,r=t.width*t.height*t.bitrate;return e.width===t.width&&e.height===t.height?e.framerate-t.framerate:n-r})),t}(t._manifest.video))),t._streams.audio=Ka(Ce(Ne(t._streams.video,({audio:e})=>e)));const{index:n,reasonForSwitch:r}=t._getStream("video",!0);let i={reasonForSwitch:r};return Fa(t._manifestLoader.switchTo("video",n),(function(){let e,r=[];if(t._streams.audio.length){let{index:n}=t._getStream("audio",!0);e=n,r.push(t._manifestLoader.switchTo("audio",e))}if(t.manifest.captions&&t.manifest.captions.length>0){const{index:e}=t._getStream("subtitles",!0);r.push(t._manifestLoader.switchTo("subtitles",e))}return Fa(Promise.all(r),(function(){var r,o;null==(r=t._sorcerer)||r.destroy(),t._sorcerer=new la(t._video,{fetcherRetryAbortErrors:!1,fetcherTimeout:8e3,disableMMS:t._options.disableMMS}),t._sorcerer.initFrameDropper(),t._streams.video.forEach(e=>{t._sorcerer.addStream(s(go(t._manifestLoader.activeStream("video").mimeType,e.codecs)),e.initSegment)}),t._streams.audio.forEach(e=>{t._sorcerer.addStream(s(go(t._manifestLoader.activeStream("audio").mimeType,e.codecs)),e.initSegment)}),t.fire(Ti.STREAMS_LOADED,t._streams),t.manifest.captions&&t.manifest.captions.length>0&&(t.manifest.captions.forEach(t._loadTextTrack.bind(t)),t.fire(Ti.TEXT_TRACKS_AVAILABLE)),t._setUpMediaSorcererEvents(),t._sorcerer.video.switchTo(n,!1,i),t._streams.audio.length&&(null==(o=t._sorcerer.audio)||o.switchTo(e,!1))}))}))}))}))}catch(kh){return Promise.reject(kh)}},n._refreshManifest=function(){try{const e=this;return function(e){if(e&&e.then)return e.then(Ba)}(ja((function(){return Fa(e._manifestLoader.update(),(function(){e._signalOnline()}))}),(function(){e._signalOffline()})))}catch(kh){return Promise.reject(kh)}},n._setUpMediaSorcererEvents=function(){this._sorcerer.video.on("streamchange",this._handleStreamChange.bind(this)),this._sorcerer.video.on("streamchangestart",this._handleStreamChangeStart.bind(this)),this._sorcerer.on("downloadend",this._handleDownloadEnd.bind(this)),this._sorcerer.on("downloadtimeout",this._handleDownloadTimeout.bind(this)),this._sorcerer.on("downloadabort",this._handleDownloadAbort.bind(this)),this._sorcerer.on("appendbufferend",this._handleBufferAppend.bind(this))},n._handleDownloadEnd=function(e,t){if(e&&e.isInitSegmentRequest)return;const n=this._getCurrentStream();t.extraContext={liveAvail:{start:this._abr.getAvailabilityStart(this.currentTime,n),end:this._abr.getAvailabilityEnd(this.currentTime,n)}},this.fire(Ti.DOWNLOAD_END,{identifier:e,data:t})},n._handleDownloadTimeout=function(e,t){e&&e.isInitSegmentRequest||(this._key(e),this._clearSegment(e),this._switching[e.type]=!1,this.fire(Ti.DOWNLOAD_TIMEOUT,{identifier:e,data:t}))},n._handleDownloadAbort=function(e){e&&e.isInitSegmentRequest||(this._key(e),this._clearSegment(e))},n._handleStreamChangeStart=function(e,t){const n={previousStreamIndex:this._streams.video.indexOf(this._streams.video[e]),index:this._streams.video.indexOf(this._streams.video[t]),streams:this._streams.video};this.fire(Ti.STREAM_CHANGE_START,n)},n._handleStreamChange=function(e,t={}){this.fire(Ti.STREAM_CHANGE,{index:e,streams:this._streams.video,metadata:t})},n._firstBufferAheadIndex=function(e,t){for(let n=0;n<(null==t?void 0:t.length);n++)if(t.start(n)>e)return n},n._handleBufferAppend=function(e){var t;const{type:n,stream:r}=e,i=this.sorcerer[n].sourceBuffer.buffered,o=this._getSegmentById(e);if(o&&i.length&&(this._streams[n][r].playlist.timeOffset=i.end(i.length-1)-(o.end-o.timeOffset)),null===this._timeToSeekTo||!this._resolveSeek)return;const s=this._firstBufferAheadIndex(this.currentTime,i),a=null!==(t=null==i?void 0:i.start(s))&&void 0!==t?t:0,u=Ye(a,i);void 0!==s&&u>this.bufferTarget?(Number((a-this.currentTime).toFixed(3)),this.currentTime=a):(this._timeToSeekTo<this.liveTailTime&&(this._timeToSeekTo=this.liveTailTime),this._abr.canPlayFromTimeInStream(this._timeToSeekTo,this._getCurrentStream())&&(this._resolveSeek(this._timeToSeekTo),this._resolveSeek=null))},n._key=function({type:e,segment:t,part:n}){return`${e}_${t}_${n}`},n._getSegmentById=function({type:e,stream:t,segment:n,part:r}){const i=this._streams[e][t].getSegmentBySN(n);return(null==i?void 0:i.getPart(r))||i},n._clearSegment=function(e){if(e.part>0){const t=ve(ve({},e),{},{part:e.part-1});this._clearSegment(t)}const t=this._key(e);delete this._segmentsAdded[t]},n.isSegmentAdded=function(e){return!!this._segmentsAdded[this._key(e)]},n.isStreamSegmentAdded=function(e){const t=this._key(e),n=this._sorcerer[e.type].activeStreamIndex;return!!this._segmentsAdded[t]&&this._segmentsAdded[t].stream===n},n._onPlaylistUpdate=function(e,t){try{var n;const i=this,{type:o}=e;var r;return null==(n=i._sorcerer)||n.setLiveSeekableRange(i.liveTailTime,i.liveEdgeTime),i.fire(Ti.STREAM_UPDATED,e),"subtitles"===o?void((i._captionsVisible||i._captionsLoading)&&(null==(r=i.manifest.captions)?void 0:r.length)>0&&i._addTextTrackCue()):(t||i._loadSegmentsForType(o),i._toggleConnection(i._hasNewSegments(o)||!i._atDurationEnd()),i._checkForPlaybackGap(),(i.lowLatencyMode||i.video.metadata.p2pReady)&&i._checkForPlaybackStall(),Fa())}catch(kh){return Promise.reject(kh)}},n._loadTextTrack=function({label:e,language:t},n){if(!this._captionsTrack){const r=new Ma({label:e,id:n,kind:"captions",language:t},this._telecineVideo);this._telecineVideo.textTracks=po([r]),this._captionsTrack=this.addTextTrack(r)}},n._getSegmentIdentifier=function(e){return`${e.type}_${e.mediaSequenceNumber}`},n._shouldAddSegmentCuesToTextTrack=function(e){const t=this._getSegmentIdentifier(e),n=this._captionsAddedToTextTrack[t],r=e.end>=this.currentTime&&e.start<=this.currentTime+this.bufferTarget;return this._captionsVisible&&!n&&r},n._shouldAddSegmentCuesToTranscript=function(e){const t=this._getSegmentIdentifier(e),n=this._captionsAddedToTranscript[t],r=e.end>=this.liveEdgeTime-e.duration&&e.start<=this.liveEdgeTime+this.bufferTarget;return this._captionsLoading&&!n&&r},n._getSegmentCues=function(e){try{const t=this,n=t._getSegmentIdentifier(e);return Ha((function(){if(!t._fetchedCues[n])return Fa(kt(e.url).text(),(function(e){const r=Ua(e),i=function(e){const t=e.match(/=MPEGTS:(\d+),/);return(t&&t[1]||0)/9e4}(e),o=r.map(e=>(e.startTime=i+e.startTime,e.endTime=i+e.endTime,new(window.VTTCue||window.TextTrackCue)(e.startTime,e.endTime,e.text)));t._fetchedCues[n]=o}))}),(function(){return t._fetchedCues[n]}))}catch(kh){return Promise.reject(kh)}},n._addTextTrackCue=function(){try{const e=this;return Fa(e._videoReady,(function(){e.manifest.captions&&e.manifest.captions[0].segments.forEach(Xa((function(t){const n=e._getSegmentIdentifier(t),r=e._shouldAddSegmentCuesToTextTrack(t),i=e._shouldAddSegmentCuesToTranscript(t);return function(o){var s=function(){if(r||i)return Fa(e._getSegmentCues(t),(function(t){r&&(e._captionsAddedToTextTrack[n]=!0,t.forEach(t=>{e._captionsTrack.addCue(t)})),i&&(e._captionsAddedToTranscript[n]=!0,e.fire(Ti.SEGMENT_CUES_LOADED,t))}))}();if(s&&s.then)return s.then(Ba)}()})))}))}catch(kh){return Promise.reject(kh)}},n._hasNewSegments=function(e){var t;const n=this._getCurrentStream(e),r=3*(this.lowLatencyMode?3:1);return(null==(t=n.playlist)?void 0:t.misses)<r},n._loadSegments=function(){try{const e=this;return Fa(e._videoReady,(function(){const t=e._video.webkitCurrentPlaybackTargetIsWireless,n="closed"===e._sorcerer.mediaSource.readyState;if(!t&&!n)for(const r in e._streams)e._streams[r].length>0&&e._loadSegmentsForType(r)}))}catch(kh){return Promise.reject(kh)}},n._loadSegmentsForType=function(e){try{const t=this;return Fa(t._videoReady,(function(){if(!t._sorcerer.allowSegmentRequests)return;const{index:n,reasonForSwitch:r}=t._getStream(e);let i;return Ha((function(){if(n>=0&&n!==t.sorcerer[e].activeStreamIndex)return i=n>t.sorcerer[e].activeStreamIndex,t._switching[e]=!0,Fa(t._manifestLoader.switchTo(e,n),(function(){let i={reasonForSwitch:r};t.sorcerer[e].switchTo(n,!0,i).then(()=>{t._switching[e]=!1}).catch(console.error)}))}),(function(){return Fa(je(0),(function(){const n=t.lowLatencyMode&&void 0!==i,r=t._sorcerer[e].activeStreamIndex,o=t._getCurrentStream(e,r),s=t._abr.getSegmentsToLoad(n,e,o),a=t._getSegmentTimeoutMs();s.forEach(n=>{const i=t._key(n),s={type:e,stream:r,segment:n.segment,part:n.part},u="video"===e&&!n.hint;let c=a;if(n.hint&&t._playInitiated&&n.start>t.currentTime){const e=1e3*(n.start-t.currentTime);c=Math.min(8e3,e+a)}const l=o.bitrate/8*n.duration,d=t.sorcerer[e].streams[r],h=t._preventExpiredSegmentUsage(n);d.addSegment(h,{identifier:s,includeWithBandwidthChecks:u,priority:n.programDateTime,excludeConnectTime:t.lowLatencyMode,timeout:t._timeoutTest||t.lowLatencyMode?c:8e3,size:t._timeoutTest||t.lowLatencyMode?l:void 0}).catch(e=>{e instanceof jo||e instanceof ut||t._clearSegment(s)}),t._segmentsAdded[i]=s})}))}))}))}catch(kh){return Promise.reject(kh)}},n._preventExpiredSegmentUsage=function(e){var t;let n=null==e?void 0:e.url;const r=null==(t=this._manifestLoader)?void 0:t.baseUrl;return r&&n&&!n.startsWith(r)&&(n=`${r}${e.uri}`),n},n._getStream=function(e,t=!1){var n,r;if(this._switching[e])return{index:-1,reasonForSwitch:null};if("subtitles"===e){const e=this._manifestLoader.activeStream("video");return{index:e.subtitles[e.currentRenditions.subtitles].index,reasonForSwitch:null}}if("audio"===e){const e=this._manifestLoader.activeStream("video");return{index:e.audio[e.currentRenditions.audio].index,reasonForSwitch:null}}if(!t&&Ze(this._timeSinceLastStreamSwitchCheck)<this._STREAM_SWITCH_CHECK_INTERVAL)return{index:this._lastStreamIndex,reasonForSwitch:null};this._timeSinceLastStreamSwitchCheck=ze();const i=null==(n=this.video)||null==(r=n.metadata)?void 0:r.percentShown,o=this._abr.filterStreams(this._streams.video,this._video.clientWidth,this._video.clientHeight,i);if(0===o.length)return{index:this._lastStreamIndex,reasonForSwitch:null};const{index:s,reasonForSwitch:a}=this._abr.optimalStream(o,this._lastStreamIndex),u=o[s],c=this._streams.video.indexOf(u);if(c>=0&&(t||c!==this._lastStreamIndex)){if(c>this._lastStreamIndex&&Ze(this._timeSinceLastDownShift)<this._DOWN_SHIFT_CHECK_INTERVAL)return{index:this._lastStreamIndex,reasonForSwitch:a};c<this._lastStreamIndex&&(this._timeSinceLastDownShift=ze());const e={index:c,streams:this._streams.video};return this.fire(Ti.STREAM_TARGET_CHANGE,e),this._lastStreamIndex=c,{index:c,reasonForSwitch:a}}return{index:this._lastStreamIndex,reasonForSwitch:a}},n.getCurrentStream=function(e="video"){return this._getCurrentStream(e)},n._getCurrentStream=function(e="video",t=0){return void 0!==this._sorcerer&&null!==this._sorcerer&&(t=this._sorcerer[e].activeStreamIndex),this._streams[e][t]},n._checkForPlaybackStall=function(){if(this._video.currentTime===this._lastStallCurrentTime&&ze()-this._lastStallCheckTime>=1e3&&this._shouldBeMakingProgress()){const e="Jumping forward 0.1s"+` because of stall at time of ${this._video.currentTime}`;this.fire(Si.STALL_JUMP,{msg:e}),this._video.currentTime+=.1}this._lastStallCurrentTime=this._video.currentTime,this._lastStallCheckTime=ze()},n._shouldBeMakingProgress=function(){return 0!==this._video.readyState&&!!this._video.buffered.length&&!this._video.paused&&this._hasContentFor(this._video.buffered,this._video.currentTime)},n._hasContentFor=function(e,t){for(let n=0;n<e.length;n++)if(!(t<e.start(n)-.1||t>e.end(n)-.5))return!0;return!1},n._checkForPlaybackGap=function(){const e=this.buffered;if(!e.length)return;const t=e.length,n=this._video.currentTime;let r,i,o;try{r=function(e,t){if(!e||!e.length)return null;if(1===e.length&&e.end(0)-e.start(0)<1e-6)return null;let n;for(let r=0;r<e.length;r++)if(e.start(r)>t&&(0===r||e.end(r-1)-t<=.5)){n=r;break}return n>=0?n:null}(e,n)}catch(kh){throw DOMException,kh}if(null===r)return;if(0===this._video.readyState)return;if(this._video.paused)return;if(t<=r)return;try{i=e.start(r),o=e.end(t-1)}catch(kh){throw DOMException,kh}const s=i-n,a=o-i,u=this.lowLatencyMode?1:2;if(a>0&&a<=this.segmentLength*u){const e="Preventing jump too close to buffered end time."+` Would have jumped to: ${i}.`+` Last buffered end time ${o}.`;this.fire(Si.BUFFER_GAP_JUMP_PREVENT,{msg:e})}else{if(0===r){const e=`Jumping forward ${s}`+` seconds because of gap before start time of ${i}`;this.fire(Si.BUFFER_GAP_JUMP,{msg:e})}else{const t=`Jumping forward ${s} seconds because of gap starting at`+` ${e.end(r-1)} and ending at ${i}`;this.fire(Si.BUFFER_GAP_JUMP,{msg:t})}this._video.currentTime=i+.1}},n._atDurationEnd=function(){const e=this.buffered;return!!(e&&e.length&&this._video.currentTime+Wa>e.end(e.length-1))},n.setVideoSrc=function(e){try{const t=this;return Fa(t._startPreload(t._preload),(function(){return Fa(t._loadManifest(e),(function(){return Ha((function(){if(Yo(t.sorcerer.mediaSource)){const e=document.createElement("source");e.type="video/mp4",e.src=URL.createObjectURL(t.sorcerer.mediaSource),t._video.appendChild(e);let{src:n,mime:r}=t._telecineVideo.externalDisplayFiles.AirPlay;const i=document.createElement("source");return i.type=r,Fa(Ui(n),(function(e){i.src=e,t._video.appendChild(i)}))}t._video.src=URL.createObjectURL(t.sorcerer.mediaSource)}),(function(){t._videoReady.resolve()}))}))}))}catch(kh){return Promise.reject(kh)}},n._startPreload=function(e){try{const t=this;return t._preloadReady=new Ke,"none"===e&&t.paused||t._preloadReady.resolve(),t._preloadReady}catch(kh){return Promise.reject(kh)}},n.getBitrateAtTime=function(e,t="video",n="average"){if(!this._sorcerer)return 0;const r=this._sorcerer.streamIndexAtTime(e,t),i=this._streams[t][r];var o;return i?null!==(o=i["average"===n?"avg_bitrate":"bitrate"])&&void 0!==o?o:i.bitrate:0},n.onprogress=function(){this._checkForPlaybackGap()},n.ondurationchange=function(){this._checkForPlaybackGap()},n.ontimeupdate=function(){if(!this._sorcerer)return;if(e.prototype.ontimeupdate.call(this),null!==this._timeToSeekTo)return;this.atLiveTail=this._isNearLiveTail(this._video.currentTime),this._shouldSnapToLiveEdge(this._video.currentTime)?this.atLiveEdge=!0:(this._video.playbackRate<1||this._hasDriftedBehindLiveEdge())&&(this.atLiveEdge=!1),this.fire(Ti.DROPPED_FRAMES,this._sorcerer.getDroppedFrameTotal());const t=this._getCurrentStream();if(t){const e={speed:this._abr.getCurrentSpeed(),bitrate:t.bitrate,speeds:this._sorcerer.getResponseSpeeds()};this.fire(Ti.BANDWIDTH,e)}!this._isOnline&&this._atDurationEnd()&&this.fire(Si.STREAM_OFFLINE),!this.lowLatencyMode&&Ze(this._timeSinceLastStreamSwitchCheck)>this._STREAM_SWITCH_CHECK_INTERVAL&&this._loadSegments()},n._shouldSnapToLiveEdge=function(e){return e>=this.liveEdgeTime-1*this.segmentLength},n._hasDriftedBehindLiveEdge=function(e){return e>=this.liveEdgeTime-2*this.segmentLength},n._isNearLiveTail=function(e){return e<=this.liveTailTime+2*this.segmentLength},n._getSeekReadyPromiseForTime=function(e=this._timeToSeekTo){return new Promise((t,n)=>{this._abr.canPlayFromTimeInStream(e,this._getCurrentStream())?t(e):this._resolveSeek=t}).then(e=>(this._timeToSeekTo=null,this._seekInProgressPromise=null,this._video.currentTime=e,new Promise((e,t)=>{this._lastSeekReject=t;const n=()=>{e(this._video.currentTime),this._video.removeEventListener("seeked",n)};this._video.addEventListener("seeked",n)})))},n.seekToTime=function(e){if(!this.eventHasDVREnabled||e===this.currentTime)return Promise.resolve();let t;if(null===this._timeToSeekTo||(this._lastSeekReject&&(this._lastSeekReject(),this._lastSeekReject=null),this._seekInProgressPromise=null,this._timeToSeekTo=null,this._resolveSeek=null),this._timeToSeekTo=e,!this._abr.canPlayFromTimeInStream(e,this._getCurrentStream()))try{this._segmentsAdded={};for(const e in this._streams)if(this._streams[e].length>0){const t=this.sorcerer[e].activeStreamIndex;this.sorcerer[e].streams[t].abort()}t=this._sorcerer.removeBuffer()}catch(n){}return this._seekInProgressPromise=this._getSeekReadyPromiseForTime(e),Promise.all([this._videoReady,t]).then(()=>(this._loadSegments(),this._seekInProgressPromise)).catch(e=>{})},n.onpause=function(){var t;e.prototype.onpause.call(this),this.eventHasDVREnabled?this.atLiveEdge=!1:(null==(t=this._manifestLoader)||t.stop(),this._sorcerer&&(this._sorcerer.abortFetches(),this._segmentsAdded={},this._sorcerer.removeBuffer().catch(()=>{})))},n.onplay=function(){this.eventHasDVREnabled||this._playInitiated&&this._refreshManifest()},n.pause=function(){this.eventHasDVREnabled&&(this.atLiveEdge=!1),e.prototype.pause.call(this)},n.play=function(){const t=this;return e.prototype.play.call(this,Xa((function(){return t._preloadReady.resolve(),null!==t._timeToSeekTo?Promise.resolve(t._seekInProgressPromise):Ha((function(){if(t._playInitiated&&!t.eventHasDVREnabled)return t._segmentsAdded={},Va(ja((function(){return qa(t._sorcerer.removeBuffer())}),(function(e){})),(function(){return qa(t._refreshManifest())}))}),(function(){return Fa(t._videoReady,(function(){return t._loadSegments(),Fa(t._bufferAvailable(),(function(){const e=Math.max(t._latencyController.liveSyncPosition,t._video.buffered.start(0));return t._atLiveEdge?t.currentTime=e:t.currentTime=t._video.currentTime,t._playInitiated=!0,Promise.resolve()}))}))}))})))},n._bufferAvailable=function(){return new Promise(e=>{const t=()=>{this.buffered.length&&(this._sorcerer.off("appendbufferend",t),e())};this._sorcerer.on("appendbufferend",t),t()})},n._getSegmentTimeoutMs=function(){return this._abr.getSegmentRelativeTimeout(this._streams.video,this._getCurrentStream("video"),1e3*this.segmentLength)},n._loadMediaManifest=function(){return Promise.resolve().then((function(){return lo}))},n.setCaptionsShouldDisplay=function(e){this._captionsVisible=e},n.setCaptionsShouldLoad=function(e){this._captionsLoading=e},pe(t,[{key:"preload",get:function(){return this._preload},set:function(e){this._preload!==e&&"none"!==e&&this._preloadReady.resolve(),this._preload=e}},{key:"latency",get:function(){var e;return null==(e=this._latencyController)?void 0:e.latency}},{key:"lowLatencyMode",get:function(){return this._lowLatencyMode},set:function(e){this._lowLatencyMode=e,this._manifestLoader&&(this._manifestLoader.lowLatencyMode=e)}},{key:"downloadSpeed",get:function(){return this._abr.getCurrentSpeed()}},{key:"restrictedStreamIndexes",get:function(){return this._restrictedStreamIndexes},set:function(e){this._restrictedStreamIndexes.join(",")!==e.join(",")&&(this._restrictedStreamIndexes=e,this._abr.lock(this._restrictedStreamIndexes))}},{key:"videoWidth",get:function(){return this._stream?this._stream.width:this._video.videoWidth}},{key:"videoHeight",get:function(){return this._stream?this._stream.height:this._video.videoHeight}},{key:"currentTime",get:function(){return null!==this._timeToSeekTo?this._timeToSeekTo:this._video.currentTime},set:function(e){this._video.readyState<=0||(this.eventHasDVREnabled&&this._playInitiated?this._shouldSnapToLiveEdge(e)?(this.atLiveEdge=!0,this.seekToTime(this.liveEdgeTime)):(this.atLiveEdge=!1,this.seekToTime(Math.max(e,this.liveTailTime))):this._video.currentTime=e)}},{key:"liveEdgeTime",get:function(){return this._latencyController.liveSyncPosition}},{key:"atLiveEdge",get:function(){return this._atLiveEdge},set:function(e){this.atLiveEdge!==e&&this.eventHasDVREnabled&&(this._atLiveEdge=e,this._video.playbackRate>1&&e&&(this._video.playbackRate=1),this.lowLatencyMode=!!this.eventIsLowLatency&&e,this.bufferTarget=e?this.defaultBufferTarget:18,e&&(this.presentationDelay=this.defaultPresentationDelay))}},{key:"atLiveTail",get:function(){return this._atLiveTail},set:function(e){this.atLiveTail!==e&&this.eventHasDVREnabled&&(this._atLiveTail=e,this._video.playbackRate<1&&e&&(this._video.playbackRate=1))}},{key:"liveTailTime",get:function(){var e,t,n,r;const i=null!==(e=null==(t=this._getCurrentStream())||null==(n=t.segments)||null==(r=n[0])?void 0:r.start)&&void 0!==e?e:0;return Math.max(i,0)}},{key:"ended",get:function(){return this._hasLiveEventEnded}},{key:"isLowerProfileAvailable",get:function(){return this._sorcerer?this._sorcerer.video.activeStreamIndex>0:null}},{key:"sorcerer",get:function(){return this._sorcerer}},{key:"segmentLength",get:function(){var e,t,n,r;return this.lowLatencyMode&&(null==(e=this._manifestLoader)||null==(t=e.activeStream("video"))?void 0:t.partTargetDuration)||(null==(n=this._manifestLoader)||null==(r=n.activeStream("video"))?void 0:r.targetDuration)}}]),t}(xo);function Ka(e){return e.forEach((e,t)=>{e.index=t}),e}const Ya=document.createElement("video"),$a={"application/x-mpegURL":"application/x-mpegURL"};let za=function(e){function t(t,n={}){var r,i;return(i=e.call(this,t,n)||this)._apiManifestUrl=null,i._playInitiated=!1,i._atLiveEdge=!0,i._atLiveTail=!1,i._secondsBehindPlaylistStart=0,i._playlistOffsetSet=!1,i.reset(),i.dvrEnabled=null!==(r=n.dvrEnabled)&&void 0!==r&&r,i.getLiveEventStartTimeEpoch=n.getLiveEventStartTimeEpoch,window.addEventListener("online",()=>{i.play()}),i}ge(t,e),t.supported=function(){return t.supportedVideoTypes.length>0},pe(t,null,[{key:"displayName",get:function(){return"NativeHLSLiveScanner"}},{key:"supportedVideoTypes",get:function(){const e=[];if("function"!=typeof Ya.canPlayType)return e;for(const t in $a){const n=$a[t];Ya.canPlayType(n).replace(/^no$/,"")&&e.push(t)}return e}}]);var n=t.prototype;return n.deactivate=function(){e.prototype.deactivate.call(this),this.reset()},n.reset=function(){this._manifestRefreshTimeout&&clearTimeout(this._manifestRefreshTimeout),this._onReady=null,this._manifestRefreshTimeout=null,this._isOnline=!1,this._hasLiveEventEnded=!1,this._hlsAvailabilityCheckTimeout=null,this._bufferedIndex=0,this._manifestRefreshTimeout=null,this._secondsBehindPlaylistStart=0,this._playlistOffsetSet=!1,this._abr=new Pa(this,this._options),this._restrictedStreamIndexes=[]},n.endLive=function(){this._isOnline=!1,this._hasLiveEventEnded=!0,clearTimeout(this._manifestRefreshTimeout),this._video.pause(),function(e){setTimeout(e,0)}(()=>{e.prototype.deactivate.call(this),this.fire(vi.ENDED)})},n._setUpRefreshTimer=function(){const e=nt(this.video.metadata.playlistRefreshUrl.split("?")[1]);e.expires&&(this._manifestRefreshTimeout=setTimeout(()=>{this._refreshLiveApiPlaylistUrl()},1e3*(e.expires-10)))},n._refreshLiveApiPlaylistUrl=function(e=0){const t=this.video.metadata.playlistRefreshUrl;return kt(t).json().then(n=>{if(!("url"in n))throw new Error(`Error parsing 'url' key from player live API refresh endpoint: ${t} ${n}`);return this._loadNativeHlsManifest(n.url.hls).then(()=>(this.play(),this._checkHlsAvailability(5e3),null)).catch(()=>this._refreshLiveApiPlaylistUrl(++e))}).catch(()=>{if(e>=3)throw new Error(`Manifest failed to load after ${e} attempts.`);return++e,this._refreshLiveApiPlaylistUrl(e)})},n._setUpLiveEventListeners=function(){this.on(Si.STREAM_OFFLINE,()=>{this._isOnline=!1})},n._setUpNativeHls=function(e){return this._setUpLiveEventListeners(),this._isOnline=!0,this.fire(Si.STREAM_ONLINE),this._checkHlsAvailability(5e3),Promise.resolve(e)},n._loadNativeHlsManifest=function(e){return this._apiManifestUrl=e,/json=1/.test(e)?kt(e).json().then(e=>{if(!("url"in e))throw new Error(`Error parsing 'url' key from Live API manifest endpoint: ${this._apiManifestUrl} ${e}`);this._video.src=this._getUrlWithMinSecondsParam(e.url),this._setUpRefreshTimer()}).catch(e=>{const t=this.video.metadata.playlistRefreshUrl;return kt(t).json().then(e=>{if(!("url"in e))throw new Error(`Error parsing 'url' key from player live API refresh endpoint: ${t} ${e}`);this._apiManifestUrl=e.url.ios,this._video.src=this._getUrlWithMinSecondsParam(e.url.ios),this._setUpRefreshTimer()})}):(this._video.src=this._getUrlWithMinSecondsParam(e),this._setUpRefreshTimer(),Promise.resolve())},n._getUrlWithMinSecondsParam=function(e){if(this.dvrEnabled)return e;const t=new URL(e);return t.searchParams.set("min_seconds","30"),t.toString()},n._loadTextTracks=function(){const e=this._video.textTracks;if(null==e?void 0:e.length)for(let t=0;t<e.length;t++){const n=e[t];this._loadTextTrack(n)}},n._loadTextTrack=function(e){if(e&&!this._captionsTrack){const{label:t,kind:n,language:r,id:i}=e,o=new Ma({label:t,kind:n,language:r,id:i},this._telecineVideo);this._telecineVideo.textTracks=po([o]),this._addTextTrackListeners(o,e),this.fire(Ti.TEXT_TRACKS_AVAILABLE),this._captionsTrack=e}},n.setModeForTrack=function(e,t){return this._captionsTrack&&this._captionsTrack.mode!==t&&(this._captionsTrack.mode=t),this},n.getActiveCuesForTrack=function(e){return this._captionsTrack&&"disabled"!==this._captionsTrack.mode?this._captionsTrack.activeCues:[]},n.addTextTrack=function(e){return this._captionsTrack||this._loadTextTracks(),this._captionsTrack},n._checkHlsAvailability=function(e){"number"==typeof en.iOS&&en.iOS<9||this._hlsAvailabilityCheckTimeout||(this._hlsAvailabilityCheckTimeout=setTimeout(()=>{if(!this._isOnline)return;const e=new XMLHttpRequest;e.onload=()=>{410!==e.status?(200!==e.status&&this.fire(Si.STREAM_OFFLINE),e.response.match(/^#EXTM3U\n#EXT-X-VERSION:3\n$/)&&this.fire(Si.STREAM_OFFLINE)):this._refreshLiveApiPlaylistUrl()},e.onerror=()=>{this.fire(Si.STREAM_OFFLINE)},/json=1/.test(this._apiManifestUrl)?kt(this._apiManifestUrl).json().then(t=>{"url"in t||this.fire(Si.STREAM_OFFLINE),e.open("GET",t.url),e.send()}).catch(()=>{e.open("GET",this._apiManifestUrl),e.send()}):(e.open("GET",this._apiManifestUrl),e.send())},e))},n._shouldSnapToLiveEdge=function(e){return e>=this.liveEdgeTime-3},n._hasDriftedBehindLiveEdge=function(e){return e>=this.liveEdgeTime-6},n._isNearLiveTail=function(e){return e<=this.liveTailTime+6},n.setVideoSrc=function(e){this._onReady=this._setUpNativeHls(e).then(()=>(this._apiManifestUrl=e,this._loadNativeHlsManifest(e)))},n.ontimeupdate=function(){e.prototype.ontimeupdate.call(this),this.atLiveTail=this._isNearLiveTail(this._video.currentTime),this._shouldSnapToLiveEdge(this._video.currentTime)?this.atLiveEdge=!0:(this._video.playbackRate<1||this._hasDriftedBehindLiveEdge())&&(this.atLiveEdge=!1)},n.onplaying=function(){this._playInitiated=!0},n.oncanplay=function(){if(!this._playInitiated){const e=this._video.seekable.length;e>0&&(this._video.currentTime=this._video.seekable.end(e-1))}if(!this._playlistOffsetSet){this._playlistOffsetSet=!0;const e=this._video.getStartDate().getTime()/1e3;this._secondsBehindPlaylistStart=e-this.getLiveEventStartTimeEpoch()}this._loadTextTracks()},n.onprogress=function(){this._hlsAvailabilityCheckTimeout&&(clearTimeout(this._hlsAvailabilityCheckTimeout),this._hlsAvailabilityCheckTimeout=null)},n.onstalled=function(){this._checkHlsAvailability(1e4)},n.onerror=function(){return this._video.error.code===this._video.error.MEDIA_ERR_SRC_NOT_SUPPORTED?(kt(this._apiManifestUrl).then(()=>{e.prototype.onerror.call(this)}).catch(t=>{t instanceof lt?this.fire(vi.ERROR,new Eo("MediaNetworkError","A network error ocurred while fetching the media.")):e.prototype.onerror.call(this)}),!1):e.prototype.onerror.call(this)},n.onwaiting=function(){this._checkHlsAvailability(1e4)},n.pause=function(){this.dvrEnabled&&(this.atLiveEdge=!1),e.prototype.pause.call(this)},n.play=function(){return e.prototype.play.call(this,()=>this._onReady)},pe(t,[{key:"currentTime",get:function(){return this._secondsBehindPlaylistStart+this._video.currentTime},set:function(e){if(this.liveEdgeTime){const t=e>=this.liveEdgeTime-3;this.atLiveEdge=t}this._video.currentTime=e-this._secondsBehindPlaylistStart}},{key:"liveEdgeTime",get:function(){const e=this._video.seekable.length;return e>0?this._secondsBehindPlaylistStart+this._video.seekable.end(e-1):0}},{key:"atLiveEdge",get:function(){return this._atLiveEdge},set:function(e){this.dvrEnabled&&(this._atLiveEdge=e,this._video.playbackRate>1&&e&&(this._video.playbackRate=1))}},{key:"atLiveTail",get:function(){return this._atLiveTail},set:function(e){this.dvrEnabled&&(this._atLiveTail=e,this._video.playbackRate<1&&e&&(this._video.playbackRate=1))}},{key:"liveTailTime",get:function(){return this._video.seekable.length>0?this._secondsBehindPlaylistStart+this._video.seekable.start(0):0}},{key:"ended",get:function(){return this._hasLiveEventEnded}},{key:"supportsPlaybackRate",get:function(){return e.prototype.supportsPlaybackRate&&this.dvrEnabled}}]),t}(xo),Qa=function(){function e(e,t={}){this._telecine=e,this._element=e._element,this._options=t}pe(e,null,[{key:"displayName",get:function(){return"Effect"}},{key:"supported",get:function(){return!1}},{key:"supportedScanners",get:function(){return[]}}]);var t=e.prototype;return t.activate=function(){throw new Eo("NotImplemented","The effect must implement the activate method.")},t.deactivate=function(){throw new Eo("NotImplemented","The effect must implement the deactivate method.")},e}();const Ja=new WeakMap,Za=new WeakMap;let eu=function(){function e({src:e,mime:t,id:n=st(),priority:r=0,metadata:i={}},o){if(!e)throw new TypeError("Must provide a src for the file.");if(!t)throw new TypeError("Must provide a mime type for the file.");Object.defineProperties(this,{mime:{value:t,enumerable:!0},id:{value:`${n}`,enumerable:!0},metadata:{value:i,enumerable:!0}}),this.video=o,this.priority=r,this.src=e}return pe(e,[{key:"priority",get:function(){return Ja.get(this)},set:function(e){if(!("number"==typeof(e=parseInt(e,10))&&isFinite(e)&&Math.floor(e)===e&&e>=0))throw new TypeError("The file priority must be an integer greater than or equal to 0.");Ja.set(this,e)}},{key:"src",get:function(){return Za.get(this)},set:function(e){Za.set(this,e),this.video.fire(Ti.FILE_SRC_UPDATE,this)}},{key:"restrictedStreamIndexes",get:function(){if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.video.currentScanner),"restrictedStreamIndexes"))throw new ReferenceError("The current scanner does not support streams.");return this.video.currentScanner.restrictedStreamIndexes},set:function(e){if(!Array.isArray(e))throw new TypeError("Indexes must be an array.");if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.video.currentScanner),"restrictedStreamIndexes"))throw new ReferenceError("The current scanner does not support streams.");this.video.currentScanner.restrictedStreamIndexes=e}}]),e}(),tu=function(e){function t({enabled:t=!1,id:n=st(),kind:r="",label:i="",language:o="",provenance:s=""},a){var u;return(u=e.call(this)||this)._enabled=t,Object.defineProperties(we(u),{kind:{value:r,enumerable:!0},label:{value:i,enumerable:!0},language:{value:o,enumerable:!0},id:{value:`${n}`,enumerable:!0},provenance:{value:s,enumerable:!0}}),u.video=a,u}return ge(t,e),t.prototype.dispatchEvent=function(e){this.fire(e,{target:this})},pe(t,[{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled=e}},{key:"active",get:function(){return this._enabled}}]),t}(er);let nu=function(){function e(){this._cdmList={},this._preferredKeySystems={},this._licenseTokenUrls={},this._licenseUrls={},this._certificateUrls={},this._keySessions={},this._keyChainState="default",this._keyTypes={KEYCHAIN_DEFAULT:"default",KEYCHAIN_SD_FALLBACK:"sd-fallback"}}var t=e.prototype;return t.getAllKeySessions=function(){return Object.values(this._keySessions)||[]},t.getCdms=function(e){return this._cdmList[e]},t.getAllPreferredKeySystems=function(){return this._preferredKeySystems},t.addCdms=function(e,t){this._cdmList[t]=e},t.addKeySession=function(e,t){this._keySessions[t]=e},t.addLicenseTokenUrl=function(e,t){this._licenseTokenUrls[t]=e},t.addLicenseUrl=function(e,t){this._licenseUrls[t]=e},t.addPreferedKeySystem=function(e,t){this._preferredKeySystems[t]=e},t.closeAllKeySessions=function(){for(let e in this._keySessions)this._keySessions[e]&&this._keySessions[e].sessionId&&this._keySessions[e].close()},pe(e,[{key:"state",get:function(){return this._keyChainState},set:function(e){Object.values(this._keyTypes).indexOf(e)<0||(this._keyChainState=e)}},{key:"activeKeySession",get:function(){return this._keySessions[this._keyChainState]}},{key:"activeKeySystem",get:function(){return this._preferredKeySystems[this._keyChainState]}},{key:"keyTypes",get:function(){return this._keyTypes}},{key:"activeLicenseTokenUrl",get:function(){return this._licenseTokenUrls[this._keyChainState]}},{key:"activeLicenseUrl",get:function(){return this._licenseUrls[this._keyChainState]}}]),e}(),ru=function(){function e(e,t){this._hasFallbackAssets=!!e.fallback_asset,this._useHls=t,this._fallbackCallback=()=>null,this._currentTime=0,this._encryptedEventName=null,this._boundGenerateRequest=this._generateRequest.bind(this),this._boundOnKeyStatus=this._onKeyStatus.bind(this),this._keyChain=new nu,this._keyTypes=this._keyChain.keyTypes,this._keyChain.state=this._keyTypes.KEYCHAIN_DEFAULT,this._keyChain.addCdms(e.cdms,this._keyTypes.KEYCHAIN_DEFAULT),this._hasFallbackAssets&&this._keyChain.addCdms(e.fallback_cdms,this._keyTypes.KEYCHAIN_SD_FALLBACK)}var t=e.prototype;return t.init=function(e,t={},n={}){return this._video=e._video,this._scanner=e,this._useMs=!!window.MSMediaKeys,window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration||window.WebKitMediaKeys||this._useMs?this._keyChain.state===this._keyTypes.KEYCHAIN_SD_FALLBACK?this.setUpKeySystem(t,n,this._keyTypes.KEYCHAIN_SD_FALLBACK).then(()=>{this._scanner.currentTime=this._currentTime,this._scanner.play()}):this.setUpKeySystem(t,n).then(()=>this.setUpKeySystem(t,n,this._keyTypes.KEYCHAIN_SD_FALLBACK)):(this._scanner.fire(Ti.EME_UNSUPPORTED),Promise.reject())},t.setUpKeySystem=function(e,t,n=this._keyTypes.KEYCHAIN_DEFAULT){return new Promise((r,i)=>{const o=this._keyChain.getCdms(n);return o||i(),function(e,t,n,r){const i=r.audio||[],o=r.video||[],s=[{video:"HW_SECURE_ALL",audio:"SW_SECURE_CRYPTO"},{video:"HW_SECURE_DECODE",audio:"SW_SECURE_CRYPTO"},{video:"HW_SECURE_CRYPTO",audio:"SW_SECURE_CRYPTO"},{video:"SW_SECURE_DECODE",audio:"SW_SECURE_CRYPTO"},{video:"SW_SECURE_CRYPTO",audio:"SW_SECURE_CRYPTO"}].map(e=>{const t={persistentState:"optional",sessionTypes:["temporary"]};return o.length&&(t.videoCapabilities=o.map(t=>({contentType:t,robustness:e.video}))),i.length&&(t.audioCapabilities=i.map(t=>({contentType:t,robustness:e.audio}))),t}),a=Object.keys(e).map(r=>{const i=e[r].id;if(t||n){let e=null;const n=t?window.WebKitMediaKeys:window.MSMediaKeys;try{e=new n(i)}catch(kh){}return Promise.resolve({name:i,keySystem:e})}return navigator.requestMediaKeySystemAccess(i,s).then(e=>e.createMediaKeys()).catch(e=>{}).then(e=>({name:i,keySystem:e}))});return Promise.all(a)}(o,this._useHls,this._useMs,e).then(e=>{this._keyChain.addPreferedKeySystem(e.find(e=>e.keySystem),n);const r=this._keyChain.activeKeySystem&&function(e,t){let n=null;return Object.keys(e).forEach(r=>{t.name===e[r].id&&(n=e[r])}),n}(o,this._keyChain.activeKeySystem);if(!r)throw this._scanner.fire(Ti.EME_UNSUPPORTED),new Error("No valid key system was found.");this._keyChain.addLicenseTokenUrl(r.license_url,n);const i=t&&t.inits&&t.inits[r.id];return i||this._addEncryptedHandler(r,n),this._setMediaKeys(n).then(()=>{const e=this._keyChain.state===n;return i&&e&&this._generateRequest(i.cenc,n)})}).then(r)})},t.destroy=function(){this._keyChain&&this._keyChain.closeAllKeySessions(),this._video&&this._video.removeEventListener(this._encryptedEventName,this._boundGenerateRequest)},t._switchKeyChainState=function(e){return new Promise(t=>{this._keyChain.state=e,this._keyChain.activeKeySession.addEventListener("message",e=>this._getLicense(e)),t()})},t._addEncryptedHandler=function(e,t){this._encryptedEventName="encrypted",this._keyChain.addLicenseUrl(e.license_url,t),this._useHls?(this._certificateUrl=e.certificate_url,this._encryptedEventName="webkitneedkey"):this._useMs&&(this._encryptedEventName="msneedkey"),this._video.addEventListener(this._encryptedEventName,this._boundGenerateRequest)},t._setMediaKeys=function(e){return new Promise(t=>{if(this._useMs){const e=()=>{this._video.msSetMediaKeys(this._keyChain.activeKeySystem.keySystem),this._video.removeEventListener("loadedmetadata",e),t()};this._video.readyState>=1?e():this._video.addEventListener("loadedmetadata",e)}else{if(this._useHls)this._video.webkitSetMediaKeys(this._keyChain.activeKeySystem.keySystem);else{const t=this._video.mediaKeys||this._keyChain.activeKeySystem.keySystem;this._keyChain.addKeySession(this._createSession(t),e),e===this._keyChain.state&&this._keyChain.activeKeySession.addEventListener("message",e=>this._getLicense(e)),this._video.mediaKeys||this._video.setMediaKeys(this._keyChain.activeKeySystem.keySystem)}t()}})},t._createSession=function(e,t,n){const r=e.createSession(t,n);if(!r)throw new Error("Could not create key session");return r},t._generateRequest=function(e,t){t=t||this._keyChain.state;const n=new Error("A decryption key error was encountered");return"com.apple.fps.1_0"===this._keyChain.activeKeySystem.name?(this._loadFairPlayCertificate(this._certificateUrl).then(r=>{this._contentId=function(e){var t=function(e){const t=new Uint16Array(e.buffer);return String.fromCharCode.apply(null,t)}(e),n=document.createElement("a");return n.href=t,n.hostname}(e.initData);const i=function(e,t,n){"string"==typeof t&&(t=function(e){const t=new ArrayBuffer(2*e.length),n=new Uint16Array(t);for(let r=0,i=e.length;r<i;r++)n[r]=e.charCodeAt(r);return n}(t));let r=0;const i=new ArrayBuffer(e.byteLength+4+t.byteLength+4+n.byteLength),o=new DataView(i);new Uint8Array(i,r,e.byteLength).set(e),r+=e.byteLength,o.setUint32(r,t.byteLength,!0),r+=4;const s=new Uint8Array(i,r,t.byteLength);return s.set(t),r+=s.byteLength,o.setUint32(r,n.byteLength,!0),r+=4,new Uint8Array(i,r,n.byteLength).set(n),new Uint8Array(i,0,i.byteLength)}(e.initData,this._contentId,r);return this._keyChain.addKeySession(this._createSession(this._keyChain.activeKeySystem.keySystem,"video/mp4",i),t),this._keyChain.activeKeySession.contentId=this._contentId,this._keyChain.activeKeySession.addEventListener("webkitkeymessage",e=>this._getLicense(e)),this._keyChain.activeKeySession.addEventListener("webkitkeyerror",e=>{throw n}),r}).catch(e=>{this._scanner.fire(e.error,e.payload)}),!0):"com.microsoft.playready"===this._keyChain.activeKeySystem.name?(this._keyChain.addKeySession(this._createSession(this._video.msKeys,"video/mp4",e.initData),t),this._keyChain.activeKeySession.addEventListener("mskeymessage",e=>this._getLicense(e)),this._keyChain.activeKeySession.addEventListener("mskeyerror",e=>{throw n}),!0):!this._keyChain.activeKeySession.sessionId&&!this._activeKeySession&&(this._keyChain.activeKeySession.addEventListener("keystatuseschange",this._boundOnKeyStatus),this._activeKeySession=this._keyChain.activeKeySession.generateRequest(e.initDataType,e.initData).catch(()=>{this._scanner.fire(Ti.DRM_FAILURE)}),!0)},t._onKeyStatus=function(){let e=!1;const t=Array.from(this._keyChain.activeKeySession.keyStatuses.values());if(t.forEach((t,n)=>{switch(t){case"expired":e=!0}}),t.every(e=>"output-restricted"===e)){if(this._hasFallbackAssets)return this._currentTime=this._scanner.currentTime,void this._switchKeyChainState(this._keyTypes.KEYCHAIN_SD_FALLBACK).then(()=>{this._fallbackCallback(),this._scanner.fire(Ti.DRM_KEY_SWITCH,this._keyTypes.KEYCHAIN_SD_FALLBACK)}).catch(e=>{this._scanner.fire(Ti.DRM_OUTPUT_RESTRICTED)});this._scanner.fire(Ti.DRM_OUTPUT_RESTRICTED)}e&&this._keyChain.activeKeySession.close()},t._getLicense=function(e){return this._getLicenseUrl(this._keyChain.activeLicenseTokenUrl).then(t=>new Promise((n,r)=>{this._keyChain.addLicenseUrl(t,this._keyChain.state),this._activeKeySession=null;const i=new XMLHttpRequest;i.keySession=e.target,i.open("POST",this._keyChain.activeLicenseUrl),i.responseType="arraybuffer";let o=e.message;if("com.microsoft.playready"===this._keyChain.activeKeySystem.name){const t=function(e,t=!0){const n=t?e.buffer:e,r=String.fromCharCode.apply(null,new Uint16Array(n)),i=(new DOMParser).parseFromString(r,"application/xml"),o={},s=i.getElementsByTagName("HttpHeader");for(let a=0;a<s.length;++a){const e=s[a].querySelector("name"),t=s[a].querySelector("value");o[e.textContent]=t.textContent}return[o,e=_o(i.querySelector("Challenge").textContent)]}(e.message),n=t[0];Object.keys(n).forEach(e=>{i.setRequestHeader(e,n[e])}),o=t[1]}"com.apple.fps.1_0"===this._keyChain.activeKeySystem.name&&(o=new Uint8Array(o),i.setRequestHeader("Content-type","application/octet-stream")),i.onload=()=>{if(403!==i.status)if(i.status>=400)r(new Eo(Ti.DRM_FAILURE));else try{this._scanner.fire(Ti.DRM_AUTH_SUCCESS);const e=new Uint8Array(i.response);i.keySession.update(e),n()}catch(kh){r(new Eo(Ti.DRM_FAILURE,`Error updating key session: ${kh}`))}else r(new Eo(Ti.DRM_AUTH_FAILURE))},i.onerror=r,i.send(o)}).catch(e=>{this._scanner.fire(e.name,{text:e.message||"License request failed."})}))},t._getLicenseUrl=function(e){return new Promise((t,n)=>{const r=new XMLHttpRequest;r.withCredentials=!0,r.open("GET",e),r.onload=()=>{if(r.status>=400)n(new Eo(Ti.DRM_FAILURE));else try{try{const e=JSON.parse(r.response),{licenseAcquisitionUrl:n,token:i}=e;if(!n&&!i)throw new Error;t(`${n}?ExpressPlayToken=${i}`)}catch(e){t(r.response)}}catch(kh){n(new Eo(Ti.DRM_FAILURE,`Error retrieving License Acquisition URL (LA_URL): ${kh}`))}},r.onerror=n,r.send()})},t._loadFairPlayCertificate=function(e){return new Promise((t,n)=>{const r=new XMLHttpRequest;r.open("GET",e),r.responseType="arraybuffer",r.setRequestHeader("Pragma","Cache-Control: no-cache"),r.setRequestHeader("Cache-Control","max-age=0"),r.onload=()=>{if(403!==r.status)if(r.status>=400)n({error:Ti.DRM_FAILURE});else try{t(new Uint8Array(r.response))}catch(kh){n(kh)}else n({error:Ti.DRM_AUTH_FAILURE})},r.onerror=n,r.send()})},t.setFallbackCallback=function(e){this._fallbackCallback=()=>e()},pe(e,[{key:"state",get:function(){return this._keyChain.state}},{key:"hasFallbackAssets",get:function(){return this._hasFallbackAssets}}]),e}();const iu=(()=>{const e=navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\./);return!!e&&{major:parseInt(e[1],10),minor:parseInt(e[2],10)}})(),ou=document.createElement("video"),su={settingPlaybackRate:(()=>{if(en.android&&iu&&"object"==typeof iu&&iu.major<52)return!1;const e=ou.playbackRate;ou.playbackRate=.5*e;const t=e!==ou.playbackRate;return ou.playbackRate=e,t})(),settingVolume:(()=>{if(en.android||en.iOS||en.iPadOS)return!1;const e=ou.volume;return ou.volume=.5*e,ou.volume!==e})(),textTracks:void 0!==ou.textTracks&&"undefined"!=typeof TextTrackList&&ou.textTracks instanceof TextTrackList},au=new WeakMap;let uu=function(e){function t({files:t,id:n=st(),title:r=null,subtitle:i=null,metadata:o={},textTracks:s=po(),audioTracks:a=po(),externalDisplayFiles:u={},chapters:c=[],duration:l}){var d;if(d=e.call(this)||this,!t||!Array.isArray(t))throw new TypeError("Must provide files for the video.");const h=function(e=[]){return e.getFileById=fo,e}(t.map(e=>e instanceof eu?(e.video=we(d),e):new eu(e,we(d)))),f=po(s.map(e=>e instanceof Ma?(e.video=we(d),e):new Ma(e,we(d))));return d._audioTracksFromConfig=a,Object.keys(u).forEach(e=>{!u[e]||u[e]instanceof eu||(u[e]=new eu(u[e],we(d)))}),Object.defineProperties(we(d),{id:{value:`${n}`,enumerable:!0},title:{value:r,enumerable:!0},subtitle:{value:i,enumerable:!0},metadata:{value:o,enumerable:!0},files:{value:h,enumerable:!0},textTracks:{value:f,enumerable:!0,writable:!0},chapters:{value:c,enumerable:!0},duration:{value:l,enumerable:!0},externalDisplayFiles:{value:u,enumerable:!0}}),o.drm&&(d._drmHandler=new ru(o.drm,o.useHls)),d}return ge(t,e),t.prototype.deactivate=function(){this._drmHandler&&this._drmHandler.destroy(),this.textTracks.forEach(e=>this.currentScanner.removeTextTrack(e))},pe(t,[{key:"drmHandler",get:function(){return this._drmHandler||null}},{key:"currentFile",get:function(){return this.currentScanner.currentFile},set:function(e){this.currentScanner.currentFile=e}},{key:"currentScanner",get:function(){return au.get(this)},set:function(e){this.currentScanner&&su.textTracks&&this.textTracks.forEach(e=>this.currentScanner.removeTextTrack(e)),su.textTracks&&this.textTracks.forEach(t=>e.addTextTrack(t)),au.set(this,e)}},{key:"chapters",get:function(){return this.chapters}},{key:"audioTracks",get:function(){return po((this.currentScanner.constructor.supportsVideoElementAudioTracks?Array.from(this.currentScanner.audioTracks):this._audioTracksFromConfig).map(e=>e instanceof tu?(e.video=this,e):new tu(e,this)))}}]),t}(er),cu=function(e){function t(t,n={}){var r;return(r=e.call(this)||this)._telecine=t,r._options=n,r._bufferInterval=null,r._lastBufferCheckVideoTime=r._options.embedTime?r._options.embedTime:0,r._isBuffering=!1,r._isSeeking=!1,r._userPlayState=!1,r.playInitiated=!1,r._isLiveStreamOnline=!1,r._checkInterval=250,r._boundEndBuffering=r._endBuffering.bind(we(r)),r._boundOnPause=r._onPause.bind(we(r)),r._boundOnSeeking=r._onSeeking.bind(we(r)),r._boundOnSeeked=r._onSeeked.bind(we(r)),r._boundOnLiveOnline=r._onLiveOnline.bind(we(r)),r._boundOnLiveOffline=r._onLiveOffline.bind(we(r)),r._toggleEvents(r._telecine.on),r._options.noInterval||r._setUpRebufferMonitor(),r}ge(t,e);var n=t.prototype;return n.destroy=function(){clearInterval(this._bufferInterval),this._toggleEvents(this._telecine.off),this._endBuffering()},n._toggleEvents=function(e){e(vi.PAUSE,this._boundOnPause),e(vi.PLAYING,this._boundEndBuffering),e(vi.SEEKING,this._boundOnSeeking),e(vi.SEEKED,this._boundOnSeeked),e(Si.STREAM_ONLINE,this._boundOnLiveOnline),e(Si.STREAM_OFFLINE,this._boundOnLiveOffline)},n._onPause=function(){this.userPlayState=!1},n._endBuffering=function(){this._isBuffering&&(this._isBuffering=!1,this.fire(Ti.BUFFER_ENDED))},n._onSeeking=function(){this._isSeeking=!0},n._onSeeked=function(){this._isSeeking=!1},n._onLiveOnline=function(){this._isLiveStreamOnline=!0},n._onLiveOffline=function(){this._isLiveStreamOnline=!1},n._setUpRebufferMonitor=function(){clearInterval(this._bufferInterval),this._bufferInterval=setInterval(this.runIntervalCheck.bind(this),this._checkInterval)},n.runIntervalCheck=function(){if(!this._telecine.video)return;const e=this._telecine.video.currentScanner;if(!e)return;const t=this._telecine.isLive(),n=e.currentTime,r=this._checkInterval/2/1e3;if(this.playInitiated&&(!this._isSeeking||t)&&(!this._telecine.paused||this.userPlayState)&&!this._isBuffering&&n<this._lastBufferCheckVideoTime+r){if(t&&!this._isLiveStreamOnline)return;const e=this._telecine.buffered;for(let t=0;t<e.length;t++)if(n>=e.start(t)&&n+.2<=e.end(t))return void(this._lastBufferCheckVideoTime=n);if(n+r>=this._telecine.duration)return;this._isBuffering=!0,this.fire(Ti.BUFFER_STARTED)}(this.playInitiated&&this._isBuffering&&n>this._lastBufferCheckVideoTime+r||t&&!this._isLiveStreamOnline&&this._isBuffering)&&(this._isBuffering=!1,this.fire(Ti.BUFFER_ENDED)),this._lastBufferCheckVideoTime=n},pe(t,[{key:"userPlayState",get:function(){return this._userPlayState},set:function(e){this._userPlayState=e,e||this._endBuffering()}}]),t}(er);function lu(){let e,t;function n(){if(!t)return Promise.reject();e.preload="";let n=e.play();return void 0===n&&(n=new Promise(t=>{e.addEventListener("playing",t)})),n}function r(){t&&(t.resolve(),t=null)}function i(e){t&&(t.reject(e),t=null)}return{set video(t){e=t},get video(){return e},get active(){return!!t},start:function(o=Promise.resolve.bind(Promise)){return t||(t=new Ke),function(){const t=e.querySelectorAll("source").length>0;e.src||t?document.createElement("video").load():e.load()}(),o().then(n).then(r).catch(i),t},cancel:function(){t&&(t.reject(new Eo("PlayInterrupted","The play() request was interrupted by a call to pause()")),t=null)}}}let du=function(e){function t(t,n,r={}){var i;return(i=e.call(this)||this)._element=t,i._scanners=n,i._options=r,i._video=null,i._textTracks=po(),i._properties={},i._currentScanner=new xo(t),i._options.playRequest=new lu,i._blacklistedScanners=[],i._activeEffects=[],i._previousScanner=null,i._switchingVideo=!1,i._snapshotDisplayed=!1,i}ge(t,e);var n=t.prototype;return n.supportsEffect=function(e){return!!e.supported&&e.supportedScanners.some(e=>this._getScannerName(this._currentScanner)===e.displayName)},n.getEffectByName=function(e){let t=null;return this._activeEffects.forEach(n=>{e===this._getEffectName(n)&&(t=n)}),t},n.activateEffect=function(e,t){const n=new e(this,t);return n.activate(),this._activeEffects.push(n),n},n.deactivateEffect=function(e){return this._activeEffects.some((t,n)=>t.constructor===e&&(t.deactivate(),this._activeEffects.splice(n,1),!0))},n.deactivateEffects=function(){this._activeEffects.forEach(e=>this.deactivateEffect(e.constructor))},n.play=function(){if(!this._video||this._video.files.length<1)throw new Eo("NoFiles","There are no files to play.");this._rebufferMonitor.playInitiated||(this._rebufferMonitor.playInitiated=!0),this._rebufferMonitor.userPlayState=!0;const e=this._currentScanner.play();return this._properties.paused=!1,e},n.pause=function(){if(!this._video||this._video.files.length<1)throw new Eo("NoFiles","There are no files to play.");return this._rebufferMonitor.userPlayState=!1,this._currentScanner.pause(),this._properties.paused=!0,this},n.isLive=function(){return this.currentScannerName.includes("Live")},n.endLive=function(){this._currentScanner.endLive()},n.getBitrateAtTime=function(e,t="video",n="average"){var r,i;return"MediaSourceScanner"!==this._getScannerName(this._currentScanner)&&"HLSLiveScanner"!==this._getScannerName(this._currentScanner)||"audio"===t&&this._currentScanner._streams[t].length<=1?0:(null==(r=(i=this._currentScanner).getBitrateAtTime)?void 0:r.call(i,e,t,n))||0},n.getCurrentStream=function(e="video"){var t,n;return null==(t=(n=this._currentScanner).getCurrentStream)?void 0:t.call(n,e)},n.showExternalDisplayPicker=function(e){this._currentScanner.showExternalDisplayPicker(e)},n.requestPictureInPicture=function(){return this._currentScanner.requestPictureInPicture()},n.exitPictureInPicture=function(){return this._currentScanner.exitPictureInPicture()},n.addChapter=function(e,t){this._currentScanner.addChapter(e,t)},n.removeChapter=function(e){this._currentScanner.removeChapter(e)},n.addCuePoint=function(e,t){return this._currentScanner.addCuePoint(e,t)},n.removeCuePoint=function(e){return this._currentScanner.removeCuePoint(e)},n.removeAllCuePoints=function(){return this._currentScanner.removeAllCuePoints()},n.enableAudioTrack=function(e){return this._currentScanner.enableAudioTrack(e)},n.addVideoEventListeners=function(){return this._currentScanner.addVideoEventListeners()},n.removeVideoEventListeners=function(){return this._currentScanner.removeVideoEventListeners()},n._findScanner=function({textTrackSupport:e=!1}={}){if(e&&!su.textTracks)return null;const t=this._video.files.sort((e,t)=>e.priority-t.priority),n=this._scanners;for(const r in t){let e=t[r];for(const t in n){let r=n[t];if(r.supported(this._options.disableMMS)&&-1===this._blacklistedScanners.indexOf(this._getScannerName(r))&&r.supportedVideoTypes.some(t=>e.mime===t))return r}}return null},n.reactivate=function(){var e;(null==(e=this._currentScanner)?void 0:e.reactivate)&&this._currentScanner.reactivate(),this.play()},n.checkRebuffer=function(e,t){this._rebufferMonitor&&(this._rebufferMonitor.playInitiated=e,this._rebufferMonitor.userPlayState=t,this._rebufferMonitor.runIntervalCheck())},n._initScanner=function(e,t){if(this._currentScanner.constructor===e&&this._currentScanner.video===t)return;const n=!this.isLive()&&this._currentScanner._preserveCurrentTime;this._switchingVideo?(this._previousScanner=this._currentScanner,this._previousScanner._switchingVideo=!0,this._snapshotDisplayed||(this._previousScanner.takeSnapshot(),this._snapshotDisplayed=!0),this._previousScanner.deactivate()):this._currentScanner.deactivate();const r=new e(this._element,this._options);Object.keys(wi).forEach(e=>{const t=wi[e];r.on(t,e=>this._handleEvent(t,e,r))}),this._currentScanner=r,t.currentScanner=r,this._currentScanner.video=t;const i=Object.keys(this._properties);for(let o=0;o<i.length;o++){const e=i[o];"paused"!==e?("currentTime"!==e||n)&&(this._currentScanner[e]=this._properties[e]):!1===this._properties.paused&&this._currentScanner.play()}this._currentScanner.addChapters(t.chapters,t.duration),this.fire(Ti.SCANNER_CHANGE,this._getScannerName(this._currentScanner)),this._currentScanner.on(["canplay","playing"],()=>{this._previousScanner&&(this._previousScanner._switchingVideo=!1,this._previousScanner.removeSnapshot(),this._previousScanner=null,this._snapshotDisplayed=!1)})},n._updateScanner=function(){if(null===this._video)return;const e=this._findScanner({textTrackSupport:this._video.textTracks.length>0});e?this._initScanner(e,this._video):this._fireVideoError("FilesNotPlayable","None of the files could be played in this browser.")},n._resetScanner=function(){this._currentScanner.deactivate(),this._currentScanner=new xo(this._element)},n._handleEvent=function(e,t,n){if(n===this._currentScanner){switch(e){case vi.ERROR:return void(t instanceof Eo&&this.fire(vi.ERROR,t));case Ti.SCANNER_ERROR:this._fireVideoError("ScannerError",`The current scanner can no longer be used because ${t.reason}`),this._blacklistedScanners.push(this._getScannerName(this._currentScanner)),this._updateScanner([]);break;case Ti.FILE_ERROR:this._fireVideoError("FileError",`The current file can no longer be used because ${t.reason}`),this._currentScanner._switchToNextFile();break;case Ti.DOWNLOAD_ERROR:this._fireVideoError("DownloadError",t),this._currentScanner._switchToNextFile();break;case Ti.EME_UNSUPPORTED:this._fireVideoError("DRMFailure",{text:null,code:"emeunsupported"});break;case Ti.DRM_FAILURE:case Ti.DRM_AUTH_FAILURE:this._fireVideoError("DRMFailure",{text:t.text,code:t.code});break;case Ti.DRM_OUTPUT_RESTRICTED:this._fireVideoError("DRMFailure",{text:null,code:"outputrestricted"});break;case Ti.DRM_AUTH_SUCCESS:this.fire(Ti.DRM_AUTH_SUCCESS);break;case vi.TIME_UPDATE:this._properties.currentTime=this._currentScanner.currentTime;break;case Ti.MEDIA_URL_EXPIRED:this._fireVideoError("MediaUrlExpired",t);break;case Ti.MEDIA_URL_BAD_REQUEST:this._fireVideoError("MediaUrlBadRequest",t);break;case bi.SPATIAL_UNSUPPORTED:this.getEffectByName("ThreeSixtyEffect").deactivate();break;case vi.ENDED:const e=!this._options.dvrEnabled||this.atLiveEdge;this._properties.paused=e;break;case vi.WAITING:this.fire(vi.WAITING)}this._activeEffects.forEach(t=>{"function"==typeof t[`on${e}`]&&t[`on${e}`]()}),this.fire(e,t)}},n._fireVideoError=function(e,t){this.fire(vi.ERROR,new Eo(e,t))},n._getScannerName=function(e){return e instanceof xo?e.constructor.displayName:e.prototype.constructor.displayName},n._setUpRebufferMonitor=function(){this._rebufferMonitor&&this._rebufferMonitor.destroy(),this._rebufferMonitor=new cu(this,this._options),this._rebufferMonitor.on(Ti.BUFFER_STARTED,()=>{this.fire(Ti.BUFFER_STARTED)}),this._rebufferMonitor.on(Ti.BUFFER_ENDED,()=>{this.fire(Ti.BUFFER_ENDED)})},n._getEffectName=function(e){return e instanceof Qa?e.constructor.displayName:e.prototype.constructor.displayName},n.setCaptionsShouldDisplay=function(e){"HLSLiveScanner"===this._getScannerName(this._currentScanner)&&this._currentScanner.setCaptionsShouldDisplay(e)},n.setCaptionsShouldLoad=function(e){"HLSLiveScanner"===this._getScannerName(this._currentScanner)&&this._currentScanner.setCaptionsShouldLoad(e)},pe(t,[{key:"element",get:function(){return this._element}},{key:"videoElement",get:function(){return this._currentScanner.videoElement}},{key:"manifest",get:function(){return this._currentScanner.manifest||{video:[]}}},{key:"supportsVideoElementAudioTracks",get:function(){return this._currentScanner.constructor.supportsVideoElementAudioTracks}},{key:"activeEffects",get:function(){return this._activeEffects}},{key:"latency",get:function(){return this._currentScanner.latency}},{key:"downloadSpeed",get:function(){return this._currentScanner.downloadSpeed||0}},{key:"pictureInPictureActive",get:function(){return this._currentScanner.pictureInPictureActive}},{key:"pictureInPictureEnabled",get:function(){return this._currentScanner.pictureInPictureEnabled}},{key:"isLowerProfileAvailable",get:function(){return this._currentScanner.isLowerProfileAvailable}},{key:"buffered",get:function(){return this._currentScanner.buffered}},{key:"bufferTarget",get:function(){return this._currentScanner.bufferTarget},set:function(e){this._properties.bufferTarget=e,this._currentScanner.bufferTarget=e}},{key:"presentationDelay",get:function(){return this._currentScanner.presentationDelay},set:function(e){this._properties.presentationDelay=e,this._currentScanner.presentationDelay=e}},{key:"lowLatencyMode",get:function(){return this._currentScanner.lowLatencyMode},set:function(e){this._properties.lowLatencyMode=e,this._currentScanner.lowLatencyMode=e}},{key:"manifestLoadDurations",get:function(){return this._currentScanner.manifestLoadDurations?this._currentScanner.manifestLoadDurations:[]}},{key:"successfulSegments",get:function(){return this._currentScanner.successfulSegments?this._currentScanner.successfulSegments:[]}},{key:"failedSegments",get:function(){return this._currentScanner.failedSegments?this._currentScanner.failedSegments:[]}},{key:"cuePoints",get:function(){return this._currentScanner.cuePoints}},{key:"currentChapterID",get:function(){if(this._currentScanner&&this._currentScanner.chaptersTrack&&this._currentScanner.chaptersTrack.activeCues.length){const{activeCues:e}=this._currentScanner.chaptersTrack;return e[e.length-1].id}return null}},{key:"chapters",get:function(){return this._currentScanner.chaptersTrack?this._currentScanner.chaptersTrack.cues:[]}},{key:"chaptersTrack",get:function(){return this._currentScanner.chaptersTrack}},{key:"currentFile",get:function(){return this._currentScanner.currentFile},set:function(e){if("string"==typeof e&&(e=this._files.filter(t=>t.id===e)[0]),!e)throw new Eo("FileNotValid","The file is not valid.");this._currentScanner.currentFile=e}},{key:"currentScannerName",get:function(){return this._getScannerName(this._currentScanner)}},{key:"currentScanner",get:function(){return this._currentScanner}},{key:"currentTime",get:function(){return this._currentScanner.currentTime},set:function(e){this._properties.currentTime=e,this._currentScanner.currentTime=e}},{key:"liveEdgeTime",get:function(){const e=this._currentScanner.liveEdgeTime;return null==e?this._previousLiveEdgeTime:(this._previousLiveEdgeTime=e,e)}},{key:"atLiveEdge",get:function(){var e;return null!==(e=this._currentScanner.atLiveEdge)&&void 0!==e?e:this.isLive()}},{key:"liveTailTime",get:function(){const e=this._currentScanner.liveTailTime;return null==e?this._previousLiveTailTime:(this._previousLiveTailTime=e,e)}},{key:"atLiveTail",get:function(){var e;return null!==(e=this._currentScanner.atLiveTail)&&void 0!==e&&e}},{key:"duration",get:function(){return this._currentScanner.duration}},{key:"ended",get:function(){return this._currentScanner.ended}},{key:"externalDisplayAvailable",get:function(){return this._currentScanner.externalDisplayAvailable}},{key:"externalDisplayActive",get:function(){return this._currentScanner.externalDisplayActive}},{key:"loop",get:function(){return this._currentScanner.loop},set:function(e){this._properties.loop=e,this._currentScanner.loop=e}},{key:"muted",get:function(){return this._currentScanner.muted},set:function(e){this._properties.muted=!!e,this._currentScanner.muted=!!e}},{key:"playsinline",get:function(){return this._currentScanner.playsinline},set:function(e){this._properties.playsinline=!!e,this._currentScanner.playsinline=!!e}},{key:"paused",get:function(){return this._currentScanner.paused}},{key:"played",get:function(){return this._currentScanner.played}},{key:"seekable",get:function(){return this._currentScanner.seekable}},{key:"seeking",get:function(){return this._currentScanner.seeking}},{key:"defaultPlaybackRate",get:function(){return this._currentScanner.defaultPlaybackRate},set:function(e){this._properties.defaultPlaybackRate=e,this._currentScanner.defaultPlaybackRate=e}},{key:"playbackRate",get:function(){return this._currentScanner.playbackRate},set:function(e){this._properties.playbackRate=e,this._currentScanner.playbackRate=e}},{key:"preload",get:function(){return this._currentScanner.preload},set:function(e){this._properties.preload=e,this._currentScanner.preload=e}},{key:"autoPictureInPicture",get:function(){return this._currentScanner.autoPictureInPicture},set:function(e){this._properties.autoPictureInPicture=!!e,this._currentScanner.autoPictureInPicture=!!e}},{key:"disablePictureInPicture",get:function(){return this._currentScanner.disablePictureInPicture},set:function(e){this._properties.disablePictureInPicture=!!e,this._currentScanner.disablePictureInPicture=!!e}},{key:"video",get:function(){return this._video},set:function(e){this._video&&this._video.deactivate(),this._blacklistedScanners=[],this._setUpRebufferMonitor(),null===e?(this._video=null,this._resetScanner()):(this._video=new uu(e),this._updateScanner())}},{key:"videoWidth",get:function(){return this._currentScanner.videoWidth}},{key:"videoHeight",get:function(){return this._currentScanner.videoHeight}},{key:"volume",get:function(){return this._currentScanner.volume},set:function(e){if(e<0||e>1)throw new Eo("IndexSizeError",`Failed to set the 'volume' property: The volume provided (${e}) is outside of the range [0, 1].`);this._properties.volume=e,this._currentScanner.volume=e}},{key:"videoElementAudioTracks",get:function(){return this._currentScanner.audioTracks}},{key:"brainDebug",get:function(){return this._currentScanner.brainDebug}}]),t}(er),hu=function(e){function t(t,n={}){var r;return(r=e.call(this,t,n)||this)._activated=!1,r._video=r._telecine._currentScanner._video,r}ge(t,e),pe(t,null,[{key:"displayName",get:function(){return"CanvasEffect"}},{key:"supported",get:function(){return!0}},{key:"supportedScanners",get:function(){return[xo,Ra]}}]);var n=t.prototype;return n.activate=function(){this._activated=!0,this._canvas=document.createElement("canvas"),this._canvas.className="vp-canvas-effect",this._canvas.style.cssText="\n            position: absolute;\n            top:0;\n            left:0;\n            bottom:0;\n            right:0;\n        ",this._ctx=this._canvas.getContext("2d",{alpha:!1}),this._element.appendChild(this._canvas),this._startRendering()},n.deactivate=function(){this._canvas&&this._element.removeChild(this._canvas),this._stopRendering(),this._activated=!1},n._startRendering=function(){this._requestFrame()},n._requestFrame=function(){this._animationFrame=window.requestAnimationFrame(this._renderFrame.bind(this))},n._renderFrame=function(){const e=this._video,t=this._canvas;t.width=e.clientWidth,t.height=e.clientHeight;const n=Math.floor(this._videoContentWidth()),r=Math.floor(this._videoContentHeight()),i=Math.floor((e.clientWidth-n)/2),o=Math.floor((e.clientHeight-r)/2);this._ctx.fillStyle="#000",this._ctx.fillRect(0,0,t.width,t.height),this._ctx.drawImage(e,i,o,n,r),this._requestFrame()},n._videoRatio=function(){return this._video.videoHeight/this._video.videoWidth},n._videoContentWidth=function(){return Math.min(this._video.clientHeight/this._videoRatio(),this._video.clientWidth)},n._videoContentHeight=function(){return Math.min(this._video.clientWidth*this._videoRatio(),this._video.clientHeight)},n._stopRendering=function(){this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=null)},t}(Qa),fu=function(){function e(){}return pe(e,null,[{key:"Equirect",get:function(){return"equirectangular"}}]),e}(),pu=function(){function e(){}return pe(e,null,[{key:"Mono",get:function(){return"mono"}},{key:"TopBottom",get:function(){return"top-bottom"}},{key:"LeftRight",get:function(){return"left-right"}}]),e}(),_u=function(){function e(e,t,n){switch(this.isStereo=t!==pu.Mono,this._leftEye=null,this._rightEye=null,e){case fu.Equirect:this.createEquirectProjection(n,t);break;default:this.createEquirectProjection(n,pu.Mono)}}var t=e.prototype;return t.createEquirectProjection=function(e,t){t!==pu.Mono?(this._leftEye=this._createEquirectangularSphereMesh(e),this._rightEye=this._createEquirectangularSphereMesh(e),this._leftEye.layers.set(1),this._rightEye.layers.set(2),t===pu.TopBottom&&(this._chopGeometryUvs(this._leftEye.geometry,.5,.5),this._chopGeometryUvs(this._rightEye.geometry,.5,0)),t===pu.LeftRight&&(this._chopGeometryUvs(this._leftEye.geometry,.5,0,0),this._chopGeometryUvs(this._rightEye.geometry,.5,.5,0))):this._leftEye=this._createEquirectangularSphereMesh(e)},t._createEquirectangularSphereMesh=function(t,n,r,i){const o=new THREE.SphereBufferGeometry(n||e.SPHERE_RADIUS,r||e.TESSELATION_WIDTH,i||e.TESSELATION_HEIGHT);o.scale(-1,1,1);const s=new THREE.MeshBasicMaterial({map:t});return new THREE.Mesh(o,s)},t._chopGeometryUvs=function(e,t,n,r=1){for(let i=0;i<e.attributes.uv.array.length;i+=2)e.attributes.uv.array[i+r]*=t,e.attributes.uv.array[i+r]+=n},pe(e,[{key:"left",get:function(){return this._leftEye}},{key:"right",get:function(){return this._rightEye}}],[{key:"TESSELATION_WIDTH",get:function(){return 120}},{key:"TESSELATION_HEIGHT",get:function(){return 80}},{key:"SPHERE_RADIUS",get:function(){return 500}}]),e}(),mu=function(){function e(e){this._renderer=e}var t=e.prototype;return t.hasVRHeadset=function(){return en.webvr?navigator.getVRDisplays().then(e=>e.length>0?(this._renderer.vr.setDevice(e[0]),e[0]):null):null},t.enter=function(){return this._renderer.vr.getDevice()&&this._renderer.vr.getDevice().requestPresent([{source:this._renderer.domElement}])},t.exit=function(){return this._renderer.vr.getDevice()&&this._renderer.vr.getDevice().exitPresent()},pe(e,[{key:"supported",get:function(){return en.webvr}},{key:"device",get:function(){return this._renderer&&this._renderer.vr.getDevice()?this._renderer.vr.getDevice():null}},{key:"isPresenting",get:function(){return!(!this._renderer||!this._renderer.vr.getDevice())&&this._renderer.vr.getDevice().isPresenting}}]),e}(),vu=function(e){function t(t,n={}){var r;return(r=e.call(this,t,n)||this)._activated=!1,r._camera=null,r._scene=null,r._renderer=null,r.isUserInteracting=!1,r._onMouseDownMouseX=0,r._onMouseDownMouseY=0,r._coordinates={lat:0,long:0},r._previousCoordinates={lat:0,long:0},r._onMouseDownCoordinates={lat:0,long:0},r._previousCameraProps=r.cameraProps,r._phi=0,r._theta=0,r._rotation=0,r._video=r._telecine._currentScanner._video,r._videoRefreshLoop=null,r._gyroVector={x:0,y:0},r._offset={lat:0,long:0},r._writeSpeeds={videoFps:r._options.fps,motionRenderSpeed:60},r._maxTimeBetweenWrites=1e3/r._writeSpeeds.videoFps,r._motionTimeouts=[],r._movingAutomatically=!1,r._deviceMotionHasOccurred=!1,r._updateFromGyroscopePending=!1,r._keysPressed={up:!1,down:!1,left:!1,right:!1},r}ge(t,e),pe(t,[{key:"isUserInteracting",set:function(e){e!==this._isUserInteracting&&(this._isUserInteracting=e,e?this._options.isMobile||this._telecine.fire(bi.MOTION_START):this._options.isMobile||this._telecine.fire(bi.MOTION_END))},get:function(){return this._isUserInteracting}}],[{key:"displayName",get:function(){return"ThreeSixtyEffect"}},{key:"supported",get:function(){try{const e=document.createElement("canvas");return!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(kh){return this._telecine._currentScanner.fire(bi.SPATIAL_UNSUPPORTED),!1}}},{key:"supportedScanners",get:function(){return[xo,Ra]}}]),t.frustumSurfaceArea=function(e,t,n){const r=2*_u.SPHERE_RADIUS*2*Math.sin(Math.PI/180*(e/2));return r*(r*t/n)/(4*Math.PI*Math.pow(_u.SPHERE_RADIUS,2))};var n=t.prototype;return n.activate=function(){return new Promise((e,t)=>{if(window.THREE)return void e();const n=document.createElement("script");n.src=this._options.threeUrl,document.body.appendChild(n),n.onload=()=>{e()}}).then(()=>this._initialize())},n._initialize=function(){this._activated=!0,this._camera=new THREE.PerspectiveCamera(this._options.fieldOfView,this._video.clientWidth/this._video.clientHeight,1,2*_u.SPHERE_RADIUS),this._camera.target=new THREE.Vector3(0,0,0),this._camera.layers.enable(1),this._initializeAutoMovement(this._options.directorTimeline),this._scene=new THREE.Scene,this._texture=new THREE.VideoTexture(this._video),this._texture.generateMipmaps=!1,this._texture.minFilter=THREE.NearestFilter,this._texture.maxFilter=THREE.NearestFilter,this._texture.format=THREE.RGBFormat,this._projector=new _u(this._options.projection,this._options.stereoMode,this._texture),this._projector.isStereo&&this._scene.add(this._projector.right),this._scene.add(this._projector.left),this._renderer=new THREE.WebGLRenderer,this._renderer.vr.enabled=!0,this._renderer.setPixelRatio(window.devicePixelRatio),this._output=document.createElement("div"),this._renderer.domElement.style.margin="0 auto",this._output.appendChild(this._renderer.domElement),this._element.appendChild(this._output),this._hideOutput(),this._telecine._currentScanner._video.setAttribute("crossorigin","anonymous"),this._startRendering(),this._telecine._currentScanner.paused||this._showOutput(),this._webvr=new mu(this._renderer),this._webvr.supported&&this._webvr.hasVRHeadset().then(e=>{setTimeout(()=>{this._telecine.fire(bi.WEBVR_HARDWARE_AVAILABLE,this._webvr.device)},100)}).catch(e=>{})},n.toggleVR=function(){if(this._webvr.isPresenting)this._webvr.exit().then(()=>{this.adjustRenderSize()}).catch(e=>{});else{if(this._telecine._currentScanner.paused)return;this._webvr.enter().then(()=>{this.adjustRenderSize()}).catch(e=>{})}},n.onplay=function(){this._activated&&(this._showOutput(),this.adjustRenderSize())},n.deactivate=function(){this._output&&this._element.removeChild(this._output),this._stopRendering(),this._activated=!1},n.snapToCenter=function(){this._motionTimeouts.forEach(e=>clearTimeout(e));const e=((this._coordinates.long>=180?360:0)-this._coordinates.long)/11,t=(0-this._coordinates.lat)/11;this._rotation=0;for(let n=0;n<50;n++)this._motionTimeouts.push(setTimeout(()=>{0===n&&(this._movingAutomatically=!0,this._options.isMobile||(this._maxTimeBetweenWrites=1e3/this._writeSpeeds.motionRenderSpeed)),49===n&&(this._movingAutomatically=!1,this._options.isMobile||(this._maxTimeBetweenWrites=1e3/this._writeSpeeds.videoFps)),this._updateViewpoint(this._coordinates.lat+t/Math.pow(1.1,n),this._coordinates.long+e/Math.pow(1.1,n)),this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)+this._coordinates.lat+t/Math.pow(1.1,n),this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._coordinates.long+t/Math.pow(1.1,n)},n*this._maxTimeBetweenWrites))},n.isStereo=function(){return!!this._projector&&this._projector.isStereo},n._initializeAutoMovement=function(e){e&&e[0]&&void 0!==e[0].p&&"undefined"!==e[0].y&&this._updateViewpoint(e[0].p,e[0].y)},n._updateViewpoint=function(e,t){this._previousCoordinates.long=this._coordinates.long,this._previousCoordinates.lat=this._coordinates.lat,e%=360,this._coordinates.lat=Math.max(-85,Math.min(85,e)),t=(t%=360)>=0?t:360+t,this._coordinates.long=t},n.makeContact=function(e){this.isUserInteracting=!0,this._motionTimeouts.forEach(e=>clearTimeout(e)),this._movingAutomatically=!1,this._contactPoint={x:e.x,y:e.y},this._onMouseDownCoordinates.long=this._coordinates.long,this._onMouseDownCoordinates.lat=this._coordinates.lat,this._motionStart={long:this._coordinates.long,lat:this._coordinates.lat},this._options.isMobile||(this._maxTimeBetweenWrites=1e3/this._writeSpeeds.motionRenderSpeed)},n.move=function(e){this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)+this._previousCoordinates.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._previousCoordinates.long;const t=this._motionStart.lat-.2*(this._contactPoint.y-e.y),n=.2*(this._contactPoint.x-e.x)+this._motionStart.long;this._updateViewpoint(t,n)},n.moveWheel=function(e){this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)+this._previousCoordinates.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._previousCoordinates.long;const t=this._coordinates.lat-.1*e.y,n=this._coordinates.long+.1*e.x;this._updateViewpoint(t,n)},n.moveDevice=function(e,t,n,r){this._updateFromGyroscopePending=!0;const i=new THREE.Quaternion;let o=window.orientation;null===o&&(o=this._video.clientWidth>this._video.clientHeight?90:0),e=e?THREE.Math.degToRad(e):0,t=t?THREE.Math.degToRad(t):0,n=n?THREE.Math.degToRad(n):0;const s=o?THREE.Math.degToRad(o):0,a=new THREE.Vector3(0,0,1),u=new THREE.Euler,c=new THREE.Quaternion,l=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));u.set(t,e,-n,"YXZ"),i.setFromEuler(u),i.multiply(l),i.multiply(c.setFromAxisAngle(a,-s)),this._gyroVector=(new THREE.Euler).setFromQuaternion(i,"YXZ"),this._rotation=this._gyroVector.z,this.isUserInteracting||this._movingAutomatically||this._updateViewpoint(THREE.Math.radToDeg(this._gyroVector.x)-this._offset.lat,-THREE.Math.radToDeg(this._gyroVector.y)+this._offset.long),this._deviceMotionHasOccurred||(this.snapToCenter(),this._telecine.fire(bi.MOTION_START),this._deviceMotionHasOccurred=!0)},n.releaseContact=function(e){if(this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)-this._coordinates.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._coordinates.long,this.isUserInteracting=!1,this._motionStart&&!e){const e=Math.hypot(this._coordinates.long-this._motionStart.long,this._coordinates.lat-this._motionStart.lat);this._moveDueToMomentum(e)}},n.abandonMotion=function(){this.isUserInteracting=!1,this._motionStart=null},n.keyPress=function(e){this._options.keyboardDisabled||(this._keyIsDown()||(this.isUserInteracting=!0,this._motionTimeouts&&this._motionTimeouts.forEach(e=>clearTimeout(e))),this._keysPressed[e]||(this._keysPressed[e]=!0))},n.keyUp=function(e){this._keysPressed[e]=!1,this._keyIsDown()||(this.isUserInteracting=!1,this._moveDueToMomentum(1/0))},n._moveFromKeyPress=function(){Object.keys(this._keysPressed).forEach(e=>{if(this._keysPressed[e])switch(e){case"up":this._updateViewpoint(this._coordinates.lat+2,this._coordinates.long);break;case"down":this._updateViewpoint(this._coordinates.lat-2,this._coordinates.long);break;case"left":this._updateViewpoint(this._coordinates.lat,this._coordinates.long-2);break;case"right":this._updateViewpoint(this._coordinates.lat,this._coordinates.long+2)}})},n._keyIsDown=function(){return Object.keys(this._keysPressed).map(e=>this._keysPressed[e]).some(e=>e)},n._moveDueToMomentum=function(e){if(e>=20){const t={long:this._coordinates.long-this._previousCoordinates.long,lat:this._coordinates.lat-this._previousCoordinates.lat};e===1/0&&(t.long/=2,t.lat/=2);for(let e=1;e<50;e++)this._motionTimeouts.push(setTimeout(()=>{1===e&&(this._movingAutomatically=!0),49===e&&(this._movingAutomatically=!1,this._maxTimeBetweenWrites=1e3/this._writeSpeeds.videoFps);const n=2/Math.pow(e,1.5);this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)+this._coordinates.lat+t.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._coordinates.long+t.long,this._updateViewpoint(this._coordinates.lat+t.lat*n,this._coordinates.long+t.long*n)},e*this._maxTimeBetweenWrites))}},n.onseeked=function(){this._activated&&this._update()},n.onresize=function(){this.adjustRenderSize(),this.isUserInteracting=!1},n._update=function(){if(!this.isVRPresenting){this._phi=THREE.Math.degToRad(90+this._coordinates.lat),this._theta=THREE.Math.degToRad(this._coordinates.long),this._camera.position.set(Math.sin(this._phi)*Math.cos(this._theta),Math.cos(this._phi),Math.sin(this._phi)*Math.sin(this._theta)),this._camera.lookAt(this._camera.target),this._camera.rotation.z+=this._rotation;const e=this.cameraProps;this._telecine.fire(bi.CAMERA_UPDATE,e),this._previousCameraProps.yaw===e.yaw&&this._previousCameraProps.pitch===e.pitch&&this._previousCameraProps.roll===e.roll&&this._previousCameraProps.fov===e.fov||(this._previousCameraProps=e,this._telecine.fire(bi.CAMERA_CHANGE,e))}this._renderer.render(this._scene,this._camera)},n.adjustRenderSize=function(){if(this.isVRPresenting)this._camera.aspect=this._video.clientWidth/this._video.clientHeight,this._camera.updateProjectionMatrix(),this._renderer.setSize(this._video.clientWidth,this._video.clientHeight);else{this._video.clientWidth>this._video.clientHeight?this._camera.aspect=Math.max(1,Math.min(2,this._video.clientWidth/this._video.clientHeight)):this._camera.aspect=Math.max(1/3,Math.min(3,this._video.clientWidth/this._video.clientHeight)),this._camera.updateProjectionMatrix();const e=mo(this._video.clientWidth,this._video.clientHeight,this._camera.aspect,1);this._renderer.setSize(e.width,e.height),this._output.style.paddingTop=`${e.top}px`}},n._startRendering=function(){this._renderer.setAnimationLoop(()=>{this._keyIsDown()&&this._moveFromKeyPress(),this._update()})},n._stopRendering=function(){this._renderer.setAnimationLoop(null)},n._showOutput=function(){this._styleOutput({backgroundColor:"#000",display:"block"})},n._hideOutput=function(){this._styleOutput({backgroundColor:"#000",display:"none"})},n._styleOutput=function({backgroundColor:e,display:t}={}){this._output.style.cssText=`position:absolute;left:0;top:0;margin-left:auto;margin-right:auto;padding:0;background:${e};width:100%;height:100%;text-align:center;display:${t}`},pe(t,[{key:"currentCoordinates",get:function(){return this._coordinates},set:function([e,t]){if(e>90||e<-90)throw new RangeError("Latitude should be a float between -90 and 90.");if(t<0||t>360)throw new RangeError("Longitude should be a float between 0 and 360.");this._updateViewpoint(e,t),this._update()}},{key:"cameraProps",get:function(){return{yaw:this._coordinates.long,pitch:this._coordinates.lat,roll:this.roll,fov:this.fieldOfView}},set:function(e){e=ve(ve({},this.cameraProps),e),this.fieldOfView=e.fov,this.roll=e.roll,this.currentCoordinates=[e.pitch,e.yaw]}},{key:"roll",get:function(){return 180*this._rotation/Math.PI},set:function(e){if(e<-180||e>180)throw new RangeError("Roll should be a float between -180 and 180.");this._rotation=THREE.Math.degToRad(e)}},{key:"isVRPresenting",get:function(){return this._webvr&&this._webvr.isPresenting}},{key:"fieldOfView",get:function(){return this._camera?this._camera.fov:this._options.fieldOfView},set:function(e){this._camera.fov=e,this._camera.updateProjectionMatrix(),this._renderer.render(this._scene,this._camera)}},{key:"hasVRHeadset",get:function(){return this._webvr&&!!this._webvr.device}}]),t}(Qa),gu=function(e){function t(t,n={}){var r;return(r=e.call(this,t,n)||this).connected=!1,r._context=null,r._source=null,r._mirror=null,r._rotator=null,r._decoder=null,r}ge(t,e),pe(t,null,[{key:"displayName",get:function(){return"AmbisonicEffect"}},{key:"supported",get:function(){return void 0!==window.AudioContext}},{key:"supportedScanners",get:function(){return[xo,Ra]}}]);var n=t.prototype;return n.activate=function(){return this._context=new AudioContext,new Promise((e,t)=>{if("undefined"!=typeof ambisonics)return void e();const n=document.createElement("script");n.src=this._options.ambisonicsUrl,document.body.appendChild(n),n.onload=()=>e(),n.onerror=()=>t()}).then(()=>this.toggleAmbisonics()).catch(()=>{this._telecine._currentScanner.fire(bi.AMBISONIC_UNSUPPORTED)})},n.deactivate=function(){this._disconnect(!0)},n.toggleAmbisonics=function(){var e,t;(null!==(e=null==(t=this._telecine.getCurrentStream("audio"))?void 0:t.ambisonic_order)&&void 0!==e?e:0)<1?this._disconnect():this._connect()},n._connect=function(){var e,t;if(!this._context)return;const n=null!==(e=null==(t=this._telecine.getCurrentStream("audio"))?void 0:t.ambisonic_order)&&void 0!==e?e:0;if(this.connected||n<1)return;const r=this._telecine._currentScanner._video;this._source=this._context.createMediaElementSource(r),this._mirror=new ambisonics.sceneMirror(this._context,n),this._rotator=new ambisonics.sceneRotator(this._context,n),this._decoder=new ambisonics.binDecoder(this._context,n),this._source.connect(this._mirror.in),this._mirror.out.connect(this._rotator.in),this._rotator.out.connect(this._decoder.in),this._decoder.out.connect(this._context.destination),this._mirror.mirror(1),this.connected=!0},n._disconnect=function(e=!1){this._source&&this._source.disconnect(),e&&this._context&&(this._context.close(),this._context=null),this._source=null,this._mirror=null,this._rotator=null,this._decoder=null,this.connected=!1},n.updateRotation=function(e,t,n){this._rotator&&(this._rotator.yaw!==e||this._rotator.pitch!==t||this._rotator.roll!==n)&&(this._rotator.yaw=e,this._rotator.pitch=t,this._rotator.roll=n,this._rotator.updateRotMtx())},t}(Qa);const yu={h264:"video/mp4",hls:"application/vnd.apple.mpegurl",hlsLive:"application/x-mpegURL",dash:"application/vnd.vimeo.dash+json",dashMpd:"video/vnd.mpeg.dash.mpd",vp6:"video/x-flv",vp8:"video/webm",webm:"video/webm",hds:"application/f4m"},Eu={"application/vnd.apple.mpegurl":"hls","application/vnd.vimeo.dash+json":"dash","video/vnd.mpeg.dash.mpd":"dash","video/mp4":"progressive","video/webm":"progressive","video/x-flv":"progressive","application/x-mpegURL":"hlslive"};var Tu=/\s/,Su=/^\s+/;var bu=/^[-+]0x[0-9a-f]+$/i,Au=/^0b[01]+$/i,wu=/^0o[0-7]+$/i,Ru=parseInt;function Iu(e){if("number"==typeof e)return e;if(an(e))return NaN;if(v(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=v(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=function(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&Tu.test(e.charAt(t)););return t}(e)+1).replace(Su,""):e}(e);var n=Au.test(e);return n||wu.test(e)?Ru(e.slice(2),n?2:8):bu.test(e)?NaN:+e}var ku=u.isFinite,Pu=Math.min,Du=function(e){var t=Math.round;return function(e,n){if(e=Iu(e),(n=null==n?0:Pu(function(e){var t=function(e){return e?(e=Iu(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}(e),n=t%1;return t==t?n?t-n:t:0}(n),292))&&ku(e)){var r=(In(e)+"e").split("e");return+((r=(In(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}();function Ou(e){return!isNaN(e)}function Lu(e){return Du(e,3)}function Cu(e){return"webkitDisplayingFullscreen"in e&&e.webkitDisplayingFullscreen}let Nu=0;function Mu(e="b"){return`${e}${++Nu}`}Mu(),Mu();const xu=Mu(),Uu=Mu(),Fu=Mu(),ju=Mu(),Vu=Mu(),Bu=Mu(),Hu=Mu(),Xu=Mu(),qu=Mu(),Wu=Mu(),Gu=Mu(),Ku=Mu(),Yu=Mu(),$u=Mu(),zu=Mu(),Qu=Mu(),Ju=Mu(),Zu=Mu(),ec=Mu(),tc=Mu();var nc=Object.freeze({__proto__:null,CONFIG_CHANGED:Hu,TELECINE_READY:Xu,TELECINE_VIDEO_INIT:qu,PLAY_INITIATED:Wu,QUALITY_CHANGED:Gu,FORCED_QUALITY:Ku,CUE_CHANGED:Yu,CAPTIONS_CHANGED:$u,SPATIAL_PLAYBACK_TOGGLED:zu,PICTURE_IN_PICTURE_AVAILABLE_SAFARI:Qu,HLS_QUALITY_CHANGED:Ju,REQUEST_COMPLETE_LIVE_SUBTITLES:Zu,COMPLETE_LIVE_SUBTITLES_LOADED:ec,COMPLETE_LIVE_SUBTITLES_ERROR:tc}),rc=Object.freeze({__proto__:null,EVENT_PENDING:"liveeventpending",EVENT_ACTIVE:"liveeventactive",EVENT_STARTING:"liveeventstarting",EVENT_STARTED:"liveeventstarted",EVENT_ENDED:"liveeventended",ARCHIVE_STARTED:"livearchivestarted",ARCHIVE_DONE:"livearchivedone",ARCHIVE_ERROR:"livearchiveerror",SETTINGS_UPDATED:"livesettingsupdated",LOW_LATENCY_FALLBACK:"lowlatencyfallback",LIVE_STATS_SUCCESS:"livestatssuccess",LIVE_STATS_FAILURE:"livestatsfailure"});ve(ve(ve(ve(ve(ve(ve(ve({},vi),Ti),Si),rc),bi),yi),Ai),nc);const ic=ve(ve({},Si),rc);function oc(e){var t;return"done"===(null==e||null==(t=e.archive)?void 0:t.status)}function sc(e){return"pending"===(null==e?void 0:e.status)}function ac(e){return"started"===(null==e?void 0:e.status)}function uc(e){return"ended"===(null==e?void 0:e.status)}function cc(e){return lc(e,"/playlist/refresh")}function lc(e,t){var n;const r=null==(n=e.request.files.hls)?void 0:n.default_cdn,{signature:i,timestamp:o,expires:s}=e.request;return`${`https://${e.player_url}/live/${e.video.id}`}${t}${`?signature=${i}&time=${o}&expires=${s}&cdn=${r}`}`}function dc(e){const t=this;let n={};const r={get attributes(){return Object.assign({},t)},get previousAttributes(){return n},clear(){i();var e=t.attributes;for(var n in e)delete t[n]},set(e){for(var n in i(),e=Gr(e))t[n]=e[n]},clone:()=>new dc(t.attributes),toJSON:()=>Gr(t.attributes)};function i(){le(t.attributes)||(n=Gr(t.attributes))}return r.set(e),xe(t,r)}function hc(e,t){const n=new dc(_i(e,t));let r=!1;return Ue(n,{reset:function(e){return n.clear(),function(e){r=!0,n.set(e),_i(n,t)}(e),n},isNewVideo:function(){const e=n.previousAttributes;return!r||e.video.id!==n.video.id||e.video.version.current!==n.video.version.current||e.video.live_event&&!oc(e.video.live_event)&&(!n.video.live_event||oc(n.video.live_event))}})}function fc(e){return e.quality||e.metadata.quality}function pc(e,t){e.embed.settings.audio_tracks||(t=null);const n=e.request.files,r=yc(n),i=wc(e),o=e.request.cookie.quality||i||function(e){const t=yc(e.request.files);let n=t.some(bc);en.mobileAndroid&&(n=!1);let r="720p";if(n){const e=t.map(fc);-1!==e.indexOf("1080p")&&-1===e.indexOf("720p")&&(r="1080p")}return e.request.cookie.hd||e.video.default_to_hd?r:"360p"}(e);let s=function({files:e=[],preference:t="360p",priorityOffset:n=0}){(e=Array.from(e)).sort(Ic());const r=e.map(fc);if(t){-1===r.indexOf(t)&&(r.push(t),r.sort((e,t)=>Ac(t)-Ac(e)));const e=r.indexOf(t),n=r.splice(0,e);n.reverse(),r.push.apply(r,Re(n))}return e.map(e=>({id:e.id,src:e.url,mime:e.mime,priority:r.indexOf(e.quality)+1+n,metadata:{profile:e.profile,cdn:e.cdn,origin:e.origin,quality:e.quality,fps:e.fps}}))}({files:r,preference:o,priorityOffset:3});return n.hls&&(s=s.concat(vc(e,!1,t)),e.request.drm&&en.browser.safari)||n.dash&&(s=s.concat(gc(e,!1,t))),s}function _c(e,t=!1,n=!1){let r=e.url;if("avc_url"in e&&(r=e.avc_url),n)return r;const i=en.hevc&&(!t||en.spatialHEVC),o=en.hdr&&en.hevcMain10&&(!t||en.spatialHEVC);return en.dolbyVision&&"hevc_dvh1_url"in e?r=e.hevc_dvh1_url:o&&"hevc_hdr_url"in e?r=e.hevc_hdr_url:i&&"hevc_sdr_url"in e?r=e.hevc_sdr_url:en.av1&&"av1_url"in e&&(r=e.av1_url),r}function mc(e){return e.fallback_url}function vc(e,t=!1,n=null){var r;const i=e.request.files,o=i.hls.default_cdn,s=e.request.drm,a=i.hls.cdns[o],u=(null==a||null==(r=a.alternatives)?void 0:r[n])||a,c=t?mc(u):_c(u,e.video.spatial,s);return{id:`hls-${o}-${e.video.id}`,src:c,mime:yu.hls,priority:3,metadata:{cdn:o,origin:i.hls.cdns[o].origin,quality:"sd"}}}function gc(e,t=!1,n=null){const r=e.request.files;return le(r.dash)?[]:Object.keys(r.dash.cdns).map(i=>{var o;const s=r.dash.cdns[i],a=(null==s||null==(o=s.alternatives)?void 0:o[n])||s,u=t?mc(a):_c(a,e.video.spatial);return{id:`dash-${i}-${e.video.id}`,src:u,mime:e.request.drm?yu.dashMpd:yu.dash,priority:i===r.dash.default_cdn?1:2,metadata:{cdn:i,origin:r.dash.cdns[i].origin,quality:"sd"}}})}function yc(e){if(le(e.progressive))return[];let t=e.progressive;return"progressive_avc"in e&&(t=e.progressive_avc),t.filter(Tc(t))}function Ec(e){if("number"==typeof e)return e;const t=e.split("-");return 5===t.length?t[0]:parseInt(t[0],10)}function Tc(e){const t=e.filter(Sc).map(fc);return e=>-1===t.indexOf(fc(e))||Sc(e)}function Sc(e){let t=e.fps;return"metadata"in e&&(t=e.metadata.fps),t>30}function bc(e){return Ac(e)>=720}function Ac(e){return"string"!=typeof e&&(e=fc(e)),parseInt(e,10)}function wc(e){const t=yc(e.request.files).map(e=>e.quality);return Rc(e,e.embed.quality,t)}function Rc(e,t,n=[]){return e.embed.on_site||en.android||en.iOS||en.windowsPhone||!t||n.length&&-1===n.indexOf(t)?null:t}function Ic(e="desc"){return(t,n)=>{const r=Ac(t),i=kc(t),o=Ac(n),s=kc(n);return"asc"===e?r-o||i-s:o-r||s-i}}function kc(e){return"object"!=typeof e?0:"fps"in e?e.fps:"metadata"in e&&"fps"in e.metadata?e.metadata.fps:0}function Pc(e){const t=e.video.live_event,n=e.request.files;if(!le(n.hls)){const r=n.hls.default_cdn,i=n.hls.cdns[r].json_url||function(e){var t;const n=e.dvr,r=e.low_latency;var i,o;return n?null==(i=e.playback_urls)?void 0:i["akamai-fmp4"].hls_noredirect:r?null==(o=e.playback_urls)?void 0:o["akamai-low-latency"].hls_noredirect:null==(t=e.playback)?void 0:t.hls_noredirect}(t),o=e.request.flags.live_dash?2:1;return{id:`hls-${r}-${e.video.id}`,src:i,mime:yu.hlsLive,priority:o,metadata:{cdn:r,origin:n.hls.cdns[r].origin,quality:"sd"}}}return null}function Dc(e,t){let n=[];if(t.video){const i=t.video.currentFile.mime;if(i===yu.hlsLive)return t.manifest.video.map(e=>ve(ve({},e),{},{quality:`${e.height}p`}));if([yu.dash,yu.dashMpd].includes(i)){var r;const i=!!t.video.drmHandler,o=i&&"sd-fallback"===t.video.drmHandler.state;n=function(e,t=!1,n=!1){if(!e)return[];let r=e.streams;"streams_avc"in e&&(r=e.streams_avc);const i=t?en.spatialHEVC&&en.hevc:en.hevc,o=t?en.spatialHEVC&&en.hdr:en.hdr;return en.dolbyVision&&"streams_hevc_dvh1"in e?r=e.streams_hevc_dvh1:o&&"streams_hevc_hdr"in e?r=e.streams_hevc_hdr:i&&"streams_hevc_sdr"in e?r=e.streams_hevc_sdr:en.av1&&"streams_av1"in e&&(r=e.streams_av1),n&&"streams_fallback"in e&&(r=e.streams_fallback),r}(e.request.files.dash,e.video.spatial,o),!i&&(null==t||null==(r=t.currentScanner)?void 0:r.manifestLoaded)&&(n=function(e,t){const n=t.map(e=>e.id);return e.filter(e=>{const t=Ec(e.id);return n.includes(e.id)||n.includes(t)})}(n,t.currentScanner.videoStreams))}else n=t.video.files.filter(e=>"progressive"===Eu[e.mime])}return n.filter(Tc(n)).sort(Ic())}function Oc(e){let t=fc(e);const n={"1440p":"2K","2160p":"4K","2700p":"5K","3240p":"6K","3780p":"7K","4320p":"8K"};for(const r in n)t=t.replace(r,n[r]);return t}function Lc(e){return en.spatialPlayback&&e.video.spatial?35:75}function Cc(e){return e.request.text_tracks.map(e=>({id:e.id,src:e.url,kind:e.kind,label:e.label,language:e.lang}))}let Nc={captureException(e){},captureMessage(e){},captureBreadcrumb(){}},Mc=Nc;var xc={set:function(e){Mc=Object.assign({},Nc,e)},captureException:function(e,t){return Mc.captureException(e,t)},captureMessage:function(e,t){return Mc.captureMessage(e,t)},captureBreadcrumb:function(e,t,n="backbone",r="info"){return Mc.captureBreadcrumb(e,t,n,r)}};function Uc(e,t,n){const r=!0===en.iOS,i=e.embed.playsinline&&(en.mobileAndroid||en.iOS>=10||r);let o=!1,s=!1,a=!1,u=!0,c="auto";function l(e){if(!u&&n.buffered&&n.buffered.length>0){e=e||n.currentTime;const r=function(e,t){var n=e.length-1;if(e.length>1)for(var r=0,i=e.length;r<i;r++)if(e.start(r)<=t&&e.end(r)>=t){n=r;break}return n}(n.buffered,e),i=n.buffered.end(r),s=i/n.duration,u=n.duration;if(t.fire(vi.PROGRESS,{loaded:i,duration:u,loadProgress:s}),a&&o&&i===n.duration)return void(o&&n.paused&&n.play().catch(xc.captureException))}}function d(t){if("auto"===t)return void(n.video.currentFile.restrictedStreamIndexes=[]);const r=Dc(e,n).reverse().map(e=>e.quality).indexOf(t);-1!==r&&(xc.captureBreadcrumb(`Switched to ${t}`,{},"video"),n.video.currentFile.restrictedStreamIndexes=[r])}function h(r){const i=Dc(e,n).map(e=>e.quality),o=Rc(e,e.embed.quality,i);o&&t.fire(Ku,o),d(o||"auto")}return t.on(qu,(function(){var t;n.playsinline=i,n.muted=e.embed.muted,n.lowLatencyMode=null==(t=e.video.live_event)?void 0:t.low_latency})),t.on(Uu,(function(){u=!0,n.paused||n.pause(),s=!1,o=!1,n.currentTime=0})),t.on(Fu,(function(){n.paused||n.pause(),n.video=null})),n.on(vi.PLAY,(function(){u=!1,t.fire(vi.PLAY,n.currentTime)})),n.on(vi.PAUSE,(function(){o=!1,t.fire(vi.PAUSE,n.currentTime,n.ended)})),n.on(vi.PLAYING,(function(e){l()})),n.on(vi.TIME_UPDATE,(function(){if(u)return;const{currentTime:e,liveEdgeTime:r,atLiveEdge:i,liveTailTime:o,atLiveTail:s,duration:a,playbackRate:c}=n,l=e/a;t.fire(vi.TIME_UPDATE,{currentTime:e,liveEdgeTime:r,atLiveEdge:i,liveTailTime:o,atLiveTail:s,duration:a,playbackRate:c,timeProgress:l})})),n.on(vi.ENDED,(function(e){n.loop?n.play().catch(xc.captureException):(o=!1,t.fire(vi.ENDED,e))})),n.on(vi.LOADED_METADATA,(function(t){const r=n.duration;if(isFinite(r)&&r>0){if(r<e.video.duration-1||r>e.video.duration+1)return;e.video.duration=r}e.video.video_width=n.videoWidth,e.video.video_height=n.videoHeight})),n.on(vi.DURATION_CHANGE,(function(t){const r=n.duration;isFinite(r)&&(e.video.duration>0&&(r<e.video.duration-1||r>e.video.duration+1)||(e.video.duration=r))})),n.on(vi.PROGRESS,l),n.on(Ti.BUFFER_STARTED,()=>{a=!0}),n.on(Ti.BUFFER_ENDED,()=>{a=!1}),t.on(xu,(function(t){n.isLive()&&0===n.liveEdgeTime||(t=function(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=Iu(n))==n?n:0),void 0!==t&&(t=(t=Iu(t))==t?t:0),function(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}(Iu(e),t,n)}(t,Lu(n.isLive()?n.liveTailTime:0),Lu(n.isLive()?n.liveEdgeTime:n.duration||e.video.duration)),n.currentTime=t)})),n.on(vi.SEEKING,(function(){const e=n.currentTime,r=n.duration,i=e/r;t.fire(vi.SEEKING,{currentTime:e,duration:r,timeProgress:i})})),n.on(vi.SEEKED,(function(){l();const e=n.currentTime,r=n.duration,i=e/r;t.fire(vi.SEEKED,{currentTime:e,duration:r,timeProgress:i})})),n.on(Ti.CURRENT_FILE_CHANGE,(function(r){xc.captureBreadcrumb("Current file changed",{id:r.id,mime:r.mime,src:r.src,metadata:r.metadata},"video"),r.metadata.quality,[yu.dash,yu.dashMpd].includes(r.mime)&&h(),[yu.hlsLive].includes(r.mime)?n.once(Ti.STREAMS_LOADED,()=>{h()}):function(n){const r=wc(e);r&&t.fire(Ku,r)}()})),n.on(vi.RESIZE,(function(){n.video.currentFile.mime===yu.hls&&n.videoHeight&&t.fire(Ju,{height:n.videoHeight})})),{play:function(){return o=!0,s||(t.fire(Wu),s=!0),n.play()},pause:function(){o=!1,n.pause()},get quality(){return c},set quality(r){!function(r){const i=n.video.currentFile.mime;if([yu.dash,yu.dashMpd,yu.hlsLive].includes(i))d(r);else{const t=Dc(e,n).filter(e=>e.metadata.quality===r);t.length>0&&(u=!0,n.video.currentFile=t[0])}c=r,t.fire(Gu,r)}(r)}}}function Fc(e,t,n){let r=null;en.spatialPlayback&&(t.on(qu,(function(){r&&(n.deactivateEffect(vu),r=null,t.fire(zu,r));const i=e.video.spatial;i&&(e.request.drm||n.supportsEffect(vu)&&(r=n.activateEffect(vu,{threeUrl:e.request.urls.three_js,fps:e.video.fps,fieldOfView:i.fov,directorTimeline:i.director_timeline,projection:i.projection,stereoMode:i.stereo_mode,initialView:i.initial_view,isMobile:en.android,dimensions:e.embed.on_site?{width:1080,height:540}:{width:640,height:360},keyboardDisabled:!e.embed.keyboard}),t.fire(zu,r)))})),n.on(bi.SPATIAL_UNSUPPORTED,(function(){r&&(n.deactivateEffect(vu),r=null,t.fire(zu,r))})))}function jc(e,t,n){let r=null;t.on(qu,(function(){r&&(n.deactivateEffect(hu),r=null),e.video.canvas&&(e.request.drm||n.supportsEffect(hu)&&(r=n.activateEffect(hu)))}))}var Vc=fi((function(e,t,n){di(e,t,n)}));function Bc(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function Hc(e,t){try{var n=e()}catch(kh){return t(kh)}return n&&n.then?n.then(void 0,t):n}let Xc=function(e){function t(t,n,r,i){var o;return(o=e.call(this)||this)._liveEventHasID=new Ke,o._liveEvent=Gr(t),o._sessionUrl=t.session_url||t.sessionUrl,o._subtitleUrl=t.subtitleUrl,o._sessionRefreshUrl=n,o._subtitleRefreshUrl=i,o._appPollUrl=r,o._forcedPoll=!1,o._disabled=!1,o._dvrEnabled=t.dvr,o._setupPolling(),o}ge(t,e);var n=t.prototype;return n.requestCompleteLiveSubtitles=function(){try{const e=this;return Hc((function(){return Bc(kt({url:e._subtitleUrl,retry:3,retryStatus:e=>[410].includes(e)||he.retryStatus(e),hooks:{beforeRetry:[e._beforeSubtitleRetry.bind(e)]}}).json(),(function(e){if(!(null==e?void 0:e.url))throw new Error("No webvtt url was available to fetch");return Bc(kt(e.url).text(),Ua)}))}),(function(e){throw e}))}catch(kh){return Promise.reject(kh)}},n._beforeSubtitleRetry=function(e,t){try{return Bc(this._refreshSubtitleUrl(),(function(t){e.url=t}))}catch(kh){return Promise.reject(kh)}},n._refreshSubtitleUrl=function(){try{const e=this;return Bc(kt(e._subtitleRefreshUrl).json(),(function(t){return e._subtitleUrl=t.url,t.url}))}catch(kh){return Promise.reject(kh)}},n.disable=function(){this._disabled=!0},n.forcePolling=function(){this.isForcePolling||(this._forcedPoll=!0,this._setupPolling())},n.unforcePolling=function(){this._forcedPoll=!1},n._setupPolling=function(){!1!==this._liveEvent.polling&&(this._liveEvent.id&&this._liveEventHasID.resolve(),this._shouldPollApp()?this._pollApp():this._shouldPoll()&&this._pollLiveApi())},n._shouldPoll=function(){var e;return!(uc(this._liveEvent)&&"started"!==(null==(e=this._liveEvent.archive)?void 0:e.status)||!this.isForcePolling&&ac(this._liveEvent))},n._shouldPollApp=function(){return!this._sessionUrl||!(!sc(this._liveEvent)||null!==this._liveEvent.id)},n._refreshSessionUrl=function(){try{const e=this;return Bc(kt(e._sessionRefreshUrl).json(),(function(t){return e._sessionUrl=t.url,t.url}))}catch(kh){return Promise.reject(kh)}},n._pollLiveApi=function(){try{const e=this;if(e._disabled)return;let t,n={};return en.browser.ie&&(n={Pragma:"no-cache","Cache-Control":"no-cache"}),function(e,t){return e&&e.then?e.then(t):t()}(Hc((function(){return Bc(kt({url:e._sessionUrl,retry:3,retryStatus:e=>[410].includes(e)||he.retryStatus(e),hooks:{beforeRetry:[e._beforeRetry.bind(e)]},headers:n}).json(),(function(e){t=e}))}),(function(){throw new Error(`Hit max retries polling ${e._sessionUrl}`)})),(function(n){if(e._dvrEnabled&&(t.dvr=e._dvrEnabled),t.status!==e._liveEvent.status){if(uc(t)&&"provision_expire"===t.terminate_reason)return e._sessionUrl=null,e._liveEvent.id=null,void setTimeout(e._setupPolling.bind(e),5e3);const n={active:ic.EVENT_ACTIVE,pending:ic.EVENT_PENDING,started:ic.EVENT_STARTED,ended:ic.EVENT_ENDED}[t.status];try{e.fire(n,t)}catch(r){throw new Error(`Error firing live event status change ${r}`)}}if(t.archive&&(!e._liveEvent.archive||t.archive.status!==e._liveEvent.archive.status)){const n={started:ic.ARCHIVE_STARTED,done:ic.ARCHIVE_DONE,error:ic.ARCHIVE_ERROR}[t.archive.status];e.fire(n,t)}e._liveEvent=Vc(e._liveEvent,t),e._shouldPoll()&&setTimeout(e._pollLiveApi.bind(e),5e3)}))}catch(kh){return Promise.reject(kh)}},n._beforeRetry=function(e,t){try{return Bc(this._refreshSessionUrl(),(function(t){e.url=t}))}catch(kh){return Promise.reject(kh)}},n._pollApp=function(){try{const e=this;if(e._disabled)return;return Bc(kt(e._appPollUrl).json(),(function(t){let n=!1;return function(r,i){var o=function(){if(null!==t.ingest.session_id)return e._liveEventHasID.resolve(),e._liveEvent.id=t.ingest.session_id,Bc(e._refreshSessionUrl(),(function(){e._pollLiveApi(),n=!0}))}();return o&&o.then?o.then(i):i(o)}(0,(function(t){if(n)return t;setTimeout(e._pollApp.bind(e),5e3)}))}))}catch(kh){return Promise.reject(kh)}},pe(t,[{key:"isForcePolling",get:function(){return this._forcedPoll}},{key:"liveEventIDReady",get:function(){return this._liveEventHasID}}]),t}(er);function qc(){}function Wc(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(kh){return Promise.reject(kh)}}}function Gc(e,t,n){const r=Wc((function(){return function(e,t){return e&&e.then?e.then(qc):Promise.resolve()}({hive:()=>{},kollective:()=>{}}[e.video.ecdn.ecdn_provider]())}));let i,o,s,a=!1,u=0,c=0;function l(){o&&(o.disable(),o=null)}function d(){n.endLive()}return t.on(Hu,(function(){i&&!e.isNewVideo()||(i=!0,l(),e.video.live_event&&!oc(e.video.live_event)&&(function(n){o=new Xc(n,function(e){return lc(e,"/session/refresh")}(e),function(e){return`https://${e.vimeo_url}/live_event/status?clip_id=${e.video.id}`}(e),function(e){return lc(e,"/subtitle/refresh")}(e)),o.on(ic.EVENT_ENDED,d),Object.keys(ic).forEach(e=>{const n=ic[e];o.on(n,e=>{t.fire(n,e)})}),t.on(Zu,Wc((function(){return function(e){if(e&&e.then)return e.then(qc)}(function(e,n){try{var r=function(){var e;return function(e,t,n){return e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e}(null==(e=o)?void 0:e.requestCompleteLiveSubtitles(),(function(e){t.fire(ec,e)}))}()}catch(kh){return n()}return r&&r.then?r.then(void 0,n):r}(0,(function(e){t.fire(tc)})))})))}(e.video.live_event),function(){u=0,c=0;let e=!1;n.once(vi.PLAYING,()=>e=!0);let r=ze();clearInterval(s),s=setInterval(()=>{n.paused||(u+=Ze(r)/1e3),e&&a&&(c+=Ze(r)/1e3),function(e){if(n.lowLatencyMode&&e>12&&n.latency>10&&a){const e="Rebuffer ratio > 12% and latency > 10s, fallback to normal HLS w/ target latency of 12s.";t.fire(ic.LOW_LATENCY_FALLBACK,{msg:e}),n.lowLatencyMode=!1,n.presentationDelay=12,n.bufferTarget=12}}(c/u*100),r=ze()},500)}()),e.video.ecdn&&r())})),t.on(Fu,(function(){l()})),n.on(ic.STREAM_ONLINE,(function(){o.isForcePolling&&o.unforcePolling()})),n.on(ic.STREAM_OFFLINE,(function(){o.isForcePolling||o.forcePolling()})),n.on(Ti.BUFFER_STARTED,(function(){a=!0})),n.on(Ti.BUFFER_ENDED,(function(){a=!1})),{get p2pReady(){}}}function Kc(e,t,n){if(n)return t?t(e()):e();try{var r=Promise.resolve(e());return t?r.then(t):r}catch(kh){return Promise.reject(kh)}}function Yc(e,t){var n=e();return n&&n.then?n.then(t):t(n)}function $c(e,t){try{var n=e()}catch(kh){return t(kh)}return n&&n.then?n.then(void 0,t):n}function zc(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(kh){return Promise.reject(kh)}}}function Qc(e,t,n){var r;const i=zc((function(){return $c((function(){return Kc(m,(function(t){return t(n,e)}))}),(function(e){throw xc.captureException(e),new Error("Failed to create Hive Module",e)}))})),o=zc((function(){return $c((function(){return Kc(_,(function(e){return e(n)}))}),(function(e){return xc.captureException(e),null}))})),s=function(){return function(e,t,n){return e&&e.then||(e=Promise.resolve(e)),e}(Yc((function(){if(!u)return Kc(o,(function(e){u=e}))}),(function(){var t;return null==(t=u)?void 0:t.setUp(e)})))},a=zc((function(){return $c((function(){return Yc((function(){if(!c)return Kc(i,(function(e){c=e}))}),(function(){var e;return null==(e=c)?void 0:e.setUp(d)}))}),(function(e){var t;return null==(t=c)||t.stop(),null}))}));let u,c,l=!1,d=!1,h=!1;const f=null==(r=e.video.ecdn)?void 0:r.ecdn_provider;let p;function _(){return import("./kollective.module.js").then(({default:e})=>e)}function m(){return import("./hive.module.js").then(({default:e})=>e)}function v(){try{u&&(u.destroy(),u=null),c&&(c.destroy(),c=null)}catch(e){}}return t.on(Hu,(function(){var t;e.isNewVideo()&&(l=!1),!0!==e.preload||!1!==h||"kollective"!==f?l||("pending"!==(null==(t=e.video.live_event)?void 0:t.status)?(l=!0,v(),f&&(p={hive:a,kollective:s}[f]())):d=!0):h=!0})),t.on(Fu,v),{get p2pReady(){return p}}}function Jc(e,t,n){let r=null;function i(){n.deactivateEffect(gu),r=null}t.on(Wu,(function(){var t;r&&i(),(null==(t=e.video.channel_layout)?void 0:t.startsWith("ambisonic"))&&n.supportsEffect(gu)&&(r=n.activateEffect(gu,{ambisonicsUrl:e.request.urls.ambisonics_js}))})),n.on(bi.CAMERA_UPDATE,(function({yaw:e,pitch:t,roll:n}){r&&r.updateRotation(e,t,n)})),n.on(bi.AMBISONIC_UNSUPPORTED,(function(){r&&i()})),n.on(Ti.STREAM_CHANGE,(function(){r&&r.toggleAmbisonics()}))}function Zc(e,t=[]){if(!e||"null"===e||0===t.length)return{track:null};const[n,r]=e.split("."),[i]=n.split(/[-_]/),o=n!==i,s=t.filter(e=>o&&e.language===n||e.language===i).sort((e,t)=>{const o=2*(e.language===i&&e.kind===r)+2*(e.language===n)+1*(e.kind===r);return 2*(t.language===i&&t.kind===r)+2*(t.language===n)+1*(t.kind===r)-o});return s.length>0?{track:s[0],exactMatch:s[0].language===n&&s[0].kind===r}:{track:null}}function el(e){const t=e.split(/\n/g);let n=[],r=[];return t.forEach(e=>{let t=e.match(/<[a-zA-Z]+ ?.*?>/g)||[],i=e.match(/<\/[a-zA-Z]+ ?.*?>/g)||[];const o=r.map(({startTag:e})=>e);r=[],t=o.concat(t),t.forEach(e=>{let[t]=e.replace(/<|>/g,"").split(" ");const n=i.indexOf(`</${t}>`);-1!==n?i.splice(n,1):r.push({startTag:e,closeTag:`</${t}>`})});const s=r.map(({closeTag:e})=>e).reverse().join(""),a=`${o.join("")}${e}${s}`;n.push(a)}),n.join("<br>")}function tl(e){return e?e.split(/\n/g).join("↵"):e}function nl(e,t,n,r){let i;function o(){return t.pictureInPictureActive||Cu(t.videoElement)?"showing":"hidden"}function s(){if(0!==t.video.textTracks.length){if(t.video.textTracks.forEach(e=>{e.on("cuechange",a),e.on("modechange",u)}),t.video.textTracks.language){const[n]=t.video.textTracks.language.split(/[-_]/),[r]=t.video.textTracks.language.split(/[-_]/);if(n!==r){const n=`${t.video.textTracks.language}.subtitles`,{track:r}=Zc(n,t.video.textTracks);if(r)return void e.fire(ju,n)}}e.fire(Vu)}else e.fire(Vu)}function a(t){const n=t.target,r=n.activeCues,i=[];let o;for(var s=0,a=r.length;s<a;s++)""!==r[s].text.replace(/^\s+|\s+$/gm,"")&&(o=document.createElement("span"),o.appendChild(r[s].getCueAsHTML()),i.push({html:el(o.innerHTML),text:tl(r[s].text)}));e.fire(Yu,n,i)}function u(n){const r=n.target;Cu(t.videoElement)&&"showing"===r.mode&&e.fire($u,r)}e.on(qu,s),e.on(ju,(function(n){if(i&&i.id===n)return;let r=t.video.textTracks.getTrackById(n),s=!0;r||({track:r,exactMatch:s}=Zc(n,t.video.textTracks)),r!==i&&setTimeout(()=>{t.video&&t.video.textTracks.forEach(e=>{e.mode=e===r?o():"disabled"}),e.fire($u,r,!s),i=r},0)})),e.on(Vu,(function(){setTimeout(()=>{t.video&&t.video.textTracks.forEach(e=>{e.mode="disabled"}),e.fire(Yu),i&&(i=null,e.fire($u,null))},0)})),e.on(Ti.TEXT_TRACKS_AVAILABLE,s),e.on([vi.ENTER_PICTURE_IN_PICTURE,vi.LEAVE_PICTURE_IN_PICTURE],(function(){!function(e){i&&i.mode!==e&&(i.mode=e)}(o())}))}const rl=["main","translation"];function il(e,t){return Array.from(e).map(e=>ve(ve({},e),{},{enabled:e.id===t}))}function ol(e){return Array.from(e).find(e=>e.enabled)}function sl(e,t){let n="translation";return"1"===e.id?n="main":e.label.includes("(Audio description)")?n="descriptions":e.label.includes("(Commentary)")&&(n="commentary"),e.language===t.language&&n===t.kind}function al(e,t,n,r){let i,o,s,a,u,c;function l(){var t;const n=e.video.live_event,r=null==n?void 0:n.dvr;if(sc(n)||function(e){return"active"===(null==e?void 0:e.status)}(n)||uc(n)&&!oc(n))return void(i.video=null);if(ac(n)&&i.video&&!e.isNewVideo())return;const o=e.request.audio_tracks||[],s=null==(t=ol(o))?void 0:t.id,a=ac(n)?function(e){const t=[],n=Pc(e);n&&t.push(n);const r=function(e){var t;const n=e.video.live_event,r=e.request.files;if(le(r.dash))return null;const i=r.dash.default_cdn,o=r.dash.cdns[i].url||(null==(t=n.playback)?void 0:t.dash_noredirect),s=e.request.flags.live_dash?2:1;return{id:`dash-${i}-${e.video.id}`,src:o,mime:yu.dashMpd,priority:s,metadata:{cdn:i,origin:r.dash.cdns[i].origin,quality:"sd"}}}(e);return r&&t.push(r),t}(e):pc(e,s),c=Cc(e);!i.video||e.isNewVideo()||u||r&&!oc(n)?h({files:a,textTracks:c,audioTracks:o,switchingVideo:r,startTime:r&&i.currentTime}):d(a,c)}function d(e,t){e.forEach(e=>{const t=i.video.files.getFileById(e.id);t&&t.src!==e.src&&(t.src=e.src)}),t.forEach(e=>{const t=i.video.textTracks.getTrackById(e.id);t&&t.src!==e.src&&(t.src=e.src)})}function h({files:r,textTracks:o,audioTracks:u=[],switchingVideo:l=!1,startTime:d}){var h,f;const p=e.video.live_event,_=n.getBoundingClientRect(),m=ac(p)?Pc(e):function(e){const t=e.request.files;if(!le(t.hls)){const e=t.hls.default_cdn,n=t.hls.cdns[e],r=n.captions||n.url;return r?{src:r,mime:yu.hls,metadata:{cdn:e,origin:n.origin,quality:"sd"}}:null}return null}(e);var v;c||(c=(null==(v=i.played)?void 0:v.length)>0);const g=!i.paused||(null==(h=i._rebufferMonitor)?void 0:h._isBuffering);i._switchingVideo=l,i.video={id:e.video.id,title:e.video.title,subtitle:`from ${e.video.owner.name}`,files:r,textTracks:o,audioTracks:u,chapters:On(e,"embed.chapters",[]),duration:e.video.duration,externalDisplayFiles:{AirPlay:m},metadata:{playlistRefreshUrl:cc(e),useHls:e.request.drm&&en.browser.safari,drm:e.request.drm,p2pReady:e.video.ecdn&&(null!==(f=s.p2pReady)&&void 0!==f?f:a.p2pReady),percentShown:vu.frustumSurfaceArea(e.video.spatial.fov,_.width,_.height)}},l?i.checkRebuffer(c,g):t.fire(qu),"number"==typeof d&&(i.currentTime=d)}return function(){var t,r;const o=[Ra,Ga,za,xo],s=e.video.ecdn&&!e.request.flags.ecdn_delta_updates;i=new du(n,o,{externalDisplays:[ho],mediaSourceScanner:{droppedFrameSwitchPercent:Lc(e)},tests:e.request.ab_tests,fileCodecs:e.request.file_codecs,presentationDelay:e.video.presentation_delay,lowLatencyMode:null==(t=e.video.live_event)?void 0:t.low_latency,dvrEnabled:null==(r=e.video.live_event)?void 0:r.dvr,disableDeltaUpdates:s,getLiveEventStartTimeEpoch:()=>function(e){var t;return(null==e?void 0:e.started_on)?new Date(e.started_on).getTime()/1e3:null==e||null==(t=e.ingest)?void 0:t.start_time}(e.video.live_event),sessionMetadata:{clipId:e.video.id,sessionId:e.request.session},disableMMS:!!e.request.flags.disable_mms})}(),Object.values(vi).filter(e=>![vi.TIME_UPDATE,vi.PROGRESS,vi.SUSPEND,vi.ERROR].includes(e)).forEach(e=>{i.on(e,(t="")=>{xc.captureBreadcrumb(e,t,"video event")})}),i.on(Ti.STREAMS_LOADED,(function(t){t.video.forEach(t=>{const n=function(e,t){return t.find(t=>Ec(t.id)===String(e)||Ec(t.id)===Ec(e))}(t.id,Dc(e,i));n?(t.profile=n.profile,t.quality=n.quality,t.fps=n.fps):(t.profile=null,t.quality=`${t.height}p`,t.fps=t.framerate)})})),i.on(Ti.STREAM_CHANGE,(function({index:e,streams:n,metadata:r}){const i=n[e];xc.captureBreadcrumb("Stream changed",i,"video"),t.fire(Ti.STREAM_CHANGE,i,e,n,r)})),i.on(Ti.STREAM_TARGET_CHANGE,(function({index:e,streams:n}){const r=n[e];t.fire(Ti.STREAM_TARGET_CHANGE,r,e,n)})),i.on(Ti.DRM_KEY_SWITCH,(function(){if(!e.request.drm.fallback_asset)return;const t=Cc(e);d(function(e){const t=e.request.files;let n=[];const r=e.request.drm&&en.browser.safari;return(t.hls&&(en.iPhone||en.iPad)||r)&&(n=n.concat(vc(e,!0))),t.dash&&!r&&(n=n.concat(gc(e,!0))),n}(e),t)})),function(e,t,n){[yi.ACTIVATED,yi.AVAILABLE,yi.DEACTIVATED,yi.UNAVAILABLE,Si.STREAM_OFFLINE,Si.STREAM_ONLINE,Si.BUFFER_GAP_JUMP,Si.BUFFER_GAP_JUMP_PREVENT,Si.STALL_JUMP,Si.LATENCY_UPDATED,Ai.MEDIASESSION_PAUSE,Ai.MEDIASESSION_PLAY,Ai.MEDIASESSION_SEEK_BACKWARD,Ai.MEDIASESSION_SEEK_FORWARD,Ai.MEDIASESSION_SEEK_TO,Ti.AUDIO_TRACK_CHANGED,Ti.AV_DURATION_MISMATCH,Ti.BANDWIDTH,Ti.BUFFER_ENDED,Ti.BUFFER_OCCUPANCY,Ti.BUFFER_STARTED,Ti.CHAPTER_CUES_UPDATED,Ti.CUE_POINT,Ti.CURRENT_FILE_CHANGE,Ti.DOWNLOAD_END,Ti.DOWNLOAD_TIMEOUT,Ti.DRM_AUTH_SUCCESS,Ti.DRM_KEY_SWITCH,Ti.DROPPED_FRAMES,Ti.MANIFEST_LOADED,Ti.MANIFEST_TIMEOUT,Ti.QUOTA_EXCEEDED_ERROR,Ti.SCANNER_CHANGE,Ti.STREAM_CHANGE_START,Ti.STREAM_BUFFER_END,Ti.STREAM_BUFFER_START,Ti.AVAILABLE_STREAMS_CHANGED,Ti.MEDIA_CAPABILITY_STREAMS_UNSUPPORTED,Ti.TEXT_TRACKS_AVAILABLE,Ti.DROPPED_FRAME_PERCENT_EXCEEDED,Ti.LOAD_SEGMENT_FAILED,Ti.SEGMENT_CUES_LOADED,bi.CAMERA_UPDATE,bi.CAMERA_CHANGE,bi.MOTION_END,bi.MOTION_START,bi.SPATIAL_UNSUPPORTED,bi.WEBVR_ENTER,bi.WEBVR_EXIT,bi.WEBVR_HARDWARE_AVAILABLE,vi.DURATION_CHANGE,vi.ERROR,vi.LOAD_START,vi.LOADED_DATA,vi.LOADED_METADATA,vi.PLAYING,vi.RATE_CHANGE,vi.RESIZE,vi.STALLED,vi.VOLUME_CHANGE,vi.WAITING,vi.ENTER_PICTURE_IN_PICTURE,vi.LEAVE_PICTURE_IN_PICTURE,vi.WEBKIT_BEGIN_FULLSCREEN,vi.WEBKIT_END_FULLSCREEN].forEach(n=>{e(n,(...e)=>{t.apply(void 0,[n].concat(e))})})}(i.on,t.fire),t.fire(Xu),new nl(t,i,n,e),new Fc(e,t,i),new jc(e,t,i),new Jc(e,t,i),s=new Gc(e,t,i),o=new Uc(e,t,i),a=new Qc(e,t,i),t.on(Hu,l),t.on(Bu,(function(n){var r,o;if(!(null==(r=e.embed)||null==(o=r.settings)?void 0:o.audio_tracks))return;if(i.supportsVideoElementAudioTracks)return void i.enableAudioTrack(null==n?void 0:n.id);const s=function(e,t={}){if(!(null==e?void 0:e.length))return[];const n=t.language,r=t.kind;let i=null==t?void 0:t.id;if(i)return il(e,i);if(r&&n){const t=e.find(e=>e.language===n&&e.kind===r);if(i=null==t?void 0:t.id,i)return il(e,i)}if(n){const t=e.find(e=>e.language===n&&rl.includes(e.kind));if(i=null==t?void 0:t.id,i)return il(e,i)}const o=e.find(e=>"main"===e.kind);return i=null==o?void 0:o.id,il(e,i)}(e.request.audio_tracks,n),a=ol(s);h({files:pc(e,null==a?void 0:a.id),textTracks:i.video.textTracks,audioTracks:s,switchingVideo:!0,startTime:i.currentTime}),t.fire(Ti.AUDIO_TRACK_CHANGED)})),t.on(vi.LOADED_DATA,(function(){var t,n,r;if(i.supportsVideoElementAudioTracks&&(null==e||null==(t=e.request)||null==(n=t.audio_tracks)?void 0:n.length)&&(null==(r=i.videoElementAudioTracks)?void 0:r.length)){const t=ol(e.request.audio_tracks||[]),n=function(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(sl(r,t))return r}return null}(i.videoElementAudioTracks,t);n&&i.enableAudioTrack(n.id)}})),en.browser.safari&&window.addEventListener("pageshow",e=>{e.persisted&&(u=!0,l())}),Fe({telecine:i},o)}function ul(e,t,n){this.constructorName="BackboneError",this.message=e,this.name=t,this.source=n}ul.prototype=new Error;var cl={embed:{},request:{cookie:{},files:{},flags:{},urls:{},text_tracks:[],file_codecs:{}},video:{owner:{},thumbnail_url:"",version:{}},user:{}};function ll(e,t,n){let r;const i=new er;let o,s,a=null,u=new hc(t,cl);function c(e,t){return i.fire(Hu,e,t),e}const l={play:()=>o.play(),pause:()=>o.pause(),get currentTime(){return s.currentTime>.1?Lu(s.currentTime):0},set currentTime(e){if(e=parseFloat(e),isNaN(e)||e<0)throw new ul("Seconds must be a positive number less than the duration of the video.","RangeError","setCurrentTime");i.fire(xu,e)},get liveEdgeTime(){return s.liveEdgeTime},get atLiveEdge(){return s.atLiveEdge},get liveTailTime(){return s.liveTailTime},get atLiveTail(){return s.atLiveTail},get duration(){return Lu(u.video.duration)},get enabledTextTrack(){return a},loadVideo(e){const t=Gr(u);return u.reset(e),u=c(u,t),this},reactivate(){var e;return(null==(e=s)?void 0:e.reactivate)&&s.reactivate(),this},unload(){return i.fire(Uu),this},destroy(){return i.fire(Fu),this},on(e,t){return i.on(e,t),this},once(e,t){return i.once(e,t),this},off(e,t){return i.off(e,t),this},get events(){return i},hasTextTrack(e){let t,n,r=this.textTracks;if(Ou(e))n=r.getTrackById(e);else{let n=e.split(".")[0];t=r.some(e=>e.language.toLowerCase()===n.toLowerCase())}return!(!n&&!t)},enableTextTrack(e,t=null){let n,r,o=this.textTracks;if(Ou(e))a=o.getTrackById(e);else{if([n,r=t]=e.split("."),!this.hasTextTrack(e))throw new ul(`There are no tracks for “${n.toUpperCase()}”.`,"InvalidTrackLanguageError","enableTextTrack");a=Zc(r?`${n}.${r}`:n,o).track}if(!a||r&&a.kind!==r)throw new ul(`There are no ${r} tracks for “${n.toUpperCase()}”.`,"InvalidTrackError","enableTextTrack");s.setCaptionsShouldDisplay(!0),i.fire(ju,a.id)},disableTextTrack(){a=null,s.setCaptionsShouldDisplay(!1),i.fire(Vu)},enableAudioTrack(e){i.fire(Bu,e)},get qualities(){return function(e){var t;const n=e.representations.map(t=>{const n=fc(t);return{id:n,label:Oc(t),active:e.quality===n}}),r=null==(t=e.video)?void 0:t.currentFile.mime;return[yu.dash,yu.dashMpd,yu.hlsLive,yu.hls].includes(r)&&n.unshift({id:"auto",label:"Auto",active:!e.quality||"auto"===e.quality}),n}(this)},get quality(){return o.quality},set quality(e){o.quality=e},get playbackRate(){return s?s.playbackRate:1},set playbackRate(e){s.playbackRate=e,s.defaultPlaybackRate=e},get textTracks(){return s.video?s.video.textTracks:[]},get representations(){return Dc(u,s)},get volume(){return s?s.volume:Lu(u.request.cookie.volume)},set volume(e){if(e=parseFloat(e),isNaN(e)||e<0||e>1)throw new ul("Volume should be a number between 0 and 1.","RangeError","setVolume");s.volume=e},get videoId(){return u.video.id},get videoWidth(){return s.videoWidth||u.video.width},get videoHeight(){return s.videoHeight||u.video.height},get readyState(){return s.videoElement.readyState},get telecine(){return s},get audioTracks(){var e,t;return(null==(e=s)||null==(t=e.video)?void 0:t.audioTracks)||[]},requestCompleteLiveSubtitles(){i.fire(Zu)},get hasAudio(){var e,t,n,r,i;return!!(null==(e=s)||null==(t=e.video)||null==(n=t.audioTracks)?void 0:n.length)||!!(null==(r=s.manifest)||null==(i=r.audio)?void 0:i.length)}};return u=c(u),o=new al(u,i,e,n),s=o.telecine,r=Object.create(s),Fe(r,l)}function dl(e){return"string"==typeof e||!Y(e)&&H(e)&&"[object String]"==m(e)}function hl(e){return Math.round(parseInt(e,16)/255*100)/100}function fl(...e){if(1===e.length&&e[0]instanceof fl){var t=e[0];return this.red=t.red,this.green=t.green,this.blue=t.blue,this.alpha=t.alpha,this.hue=t.hue,this.saturation=t.saturation,this.lightness=t.lightness,this}if(1===e.length){if("string"==typeof e[0]&&e[0].indexOf("rgb")>=0)return this.rgba=function(e){var t=/rgba?\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})(,\s*([\d.]+))?\)/.exec(e);if(!t)throw new Error("Invalid rgb value");return{red:parseInt(t[1],10),green:parseInt(t[2],10),blue:parseInt(t[3],10),alpha:parseFloat(t[5])||1}}(e[0]),this;if(!function(e){return"string"==typeof(e=e.replace("#",""))&&[3,4,6,8].includes(e.length)&&!isNaN(parseInt(e,16))}(`${e[0]}`))throw new Error("Invalid hex value");const{hex:t,alpha:n}=function(e){let t=1;return 4===(e=e.replace("#","")).length&&(t=hl(e.slice(3)+e.slice(3)),e=e.slice(0,3)),8===e.length&&(t=hl(e.slice(6,8)),e=e.slice(0,6)),{hex:e,alpha:t}}(`${e[0]}`);return this.hex=t,this.alpha=n,this}if(3===e.length||4===e.length){for(var n=0;n<3;n++)if(isNaN(parseInt(e[n],10))||parseInt(e[n],10)<0||parseInt(e[n],10)>255)throw new Error("Invalid rgb value");if(e[3]&&parseFloat(e[3])<0||parseFloat(e[3])>1)throw new Error("Invalid alpha value");return this.rgba={red:e[0],green:e[1],blue:e[2],alpha:parseFloat(e[3])||1},this}throw new Error("Invalid color")}function pl(){let e=0,t=null,n=0,r=!1;function i(){return e/1e3}return{trackBufferStart:function(e,i){t=ze(),n++,r=!0,e(i)},trackBufferEnd:function(n,i={}){if(!r)return;const o=Ze(t);e+=o,i.buffer_duration=o/1e3,r=!1,n(i)},trackVideoExit:function(n){r&&!n&&(e+=Ze(t))},resetLastBufferTime:function(){t=null},getBufferRatio:function(e){const t=i()/e*100;return isNaN(t)?0:Math.round(100*t)/100},getBufferCount:function(){return n},getTotalBufferDuration:i,isVideoBuffering:function(){return r}}}fl.prototype={get complement(){var e=this.clone();return e.rgb={red:255-this.red,green:255-this.green,blue:255-this.blue},e},get hex(){return fl.rgbToHex(this.red,this.green,this.blue)},get hexWithAlpha(){const e=("0"+Math.round(255*this.alpha).toString(16)).slice(-2);return fl.rgbToHex(this.red,this.green,this.blue)+e},set hex(e){return this.rgba=fl.hexToRgb(e),this},get hsl(){return"hsl("+this.hue+","+this.saturation+"%,"+Math.round(this.lightness)+"%)"},set hsl(e){this.hue=e.hue,this.saturation=e.saturation,this.lightness=e.lightness;var t=fl.hslToRgb(e.hue,e.saturation,e.lightness);return this.red=t.red,this.green=t.green,this.blue=t.blue,this.alpha=t.alpha,this},get luminance(){function e(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}return.2126*e(this.red/255)+.7152*e(this.green/255)+.0722*e(this.blue/255)},get rgb(){return"rgb("+this.red+","+this.green+","+this.blue+")"},set rgb(e){return this.rgba=e,this},get rgba(){return"rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")"},set rgba(e){this.red=e.red,this.green=e.green,this.blue=e.blue,this.alpha=e.alpha||1;var t=fl.rgbToHsl(e.red,e.green,e.blue);return this.hue=t.hue,this.saturation=t.saturation,this.lightness=t.lightness,this},get yiq(){return(299*this.red+587*this.green+114*this.blue)/1e3},clone:function(){return new fl(this)},lighten:function(e,t,n){if(this.hsl={hue:this.hue,saturation:this.saturation,lightness:this.lightness+e},t&&n)for(var r=n.contrast(this).ratio;r<t&&(this.lighten(5),r=n.contrast(this).ratio,!(this.lightness>=100)););return this},darken:function(e,t,n){if(this.hsl={hue:this.hue,saturation:this.saturation,lightness:this.lightness-e},t&&n)for(var r=n.contrast(this).ratio;r<t&&(this.darken(5),r=n.contrast(this).ratio,!(this.lightness<=0)););return this},overlayOn:function(e){if(this.alpha>=1)return this;var t=this.clone();return t.rgba={red:t.red*this.alpha+e.red*e.alpha*(1-this.alpha),green:t.green*this.alpha+e.green*e.alpha*(1-this.alpha),blue:t.blue*this.alpha+e.blue*e.alpha*(1-this.alpha),alpha:t.alpha+e.alpha*(1-this.alpha)},t},contrast:function(e){var t=this.alpha;if(t>=1){e.alpha<1&&(e=e.overlayOn(this));var n=this.luminance+.05,r=e.luminance+.05,i=n/r;return r>n&&(i=1/i),{ratio:i=Math.round(10*i)/10,error:0,min:i,max:i}}var o=this.overlayOn(fl.white).contrast(e).ratio,s=this.overlayOn(fl.black).contrast(e).ratio,a=Math.max(o,s),u={red:Math.min(Math.max(0,(e.red-this.red*t)/(1-t)),255),green:Math.min(Math.max(0,(e.green-this.green*t)/(1-t)),255),blue:Math.min(Math.max(0,(e.blue-this.blue*t)/(1-t)),255)},c=this.clone();c.rgb=u;var l=this.overlayOn(c).contrast(e).ratio;return{ratio:Math.round((l+a)/2*10)/10,error:Math.round((a-l)/2*10)/10,min:l,max:a,closest:c,farthest:s===a?fl.white:fl.black}},wcagAACompliant:function(e){return this.contrast(e).ratio>=4.5},wcagAAACompliant:function(e){return this.contrast(e).ratio>=7},yiqContrastColor:function(){return this.yiq>=120?new fl(0,0,0):new fl(255,255,255)}},fl.hexToRgb=function(e){var t;return 3===(e=String(e)).length||4===e.length?(t=/^#?([A-Fa-f0-9])([A-Fa-f0-9])([A-Fa-f0-9])$/i.exec(e))&&(t[1]+=t[1],t[2]+=t[2],t[3]+=t[3]):t=/^#?([A-Fa-f0-9]{2})([A-Fa-f0-9]{2})([A-Fa-f0-9]{2})$/i.exec(e),t?{red:parseInt(t[1],16),green:parseInt(t[2],16),blue:parseInt(t[3],16),alpha:1}:null},fl.rgbToHex=function(e,t,n){return"#"+((1<<24)+(Math.round(e)<<16)+(Math.round(t)<<8)+Math.round(n)).toString(16).slice(1)},fl.rgbToHsl=function(e,t,n){e/=255,t/=255,n/=255;var r,i=Math.max(e,t,n),o=Math.min(e,t,n),s=(i+o)/2,a=s;if(i===o)return{hue:0,saturation:0,lightness:100*a};var u=i-o;return r=a>.5?u/(2-i-o):u/(i+o),i===e?s=(t-n)/u+(t<n?6:0):i===t?s=(n-e)/u+2:i===n&&(s=(e-t)/u+4),s/=6,{hue:Math.round(360*s),saturation:Math.round(100*r),lightness:Math.round(100*a)}},fl.hslToRgb=function(e,t,n){function r(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),6*n<1?e+6*(t-e)*n:2*n<1?t:3*n<2?e+6*(2/3-n)*(t-e):e}if(e/=360,n/=100,0==(t/=100))return{red:Math.floor(255*n),green:Math.floor(255*n),blue:Math.floor(255*n)};var i=n<.5?n*(1+t):n+t-t*n,o=2*n-i;return{red:Math.floor(255*r(o,i,e+1/3)),green:Math.floor(255*r(o,i,e)),blue:Math.floor(255*r(o,i,e-1/3))}},fl.hslToHex=function(e,t,n){var r=fl.hslToRgb(e,t,n);return fl.rgbToHex(r.red,r.green,r.blue)},fl.white=new fl("fff"),fl.black=new fl("000");const _l={VIDEO_BUFFER_END:"video-buffer-end",VIDEO_BUFFER_START:"video-buffer-start",VIDEO_ENDED:"video-ended",VIDEO_EXIT:"video-exit",VIDEO_LOAD_FAILURE:"video-load-failure",VIDEO_MINUTE_WATCHED:"video-minute-watched",VIDEO_PAUSED:"video-paused",VIDEO_PLAYED:"video-played",VIDEO_PLAYBACK_ERROR:"video-playback-error",VIDEO_READY:"video-ready",VIDEO_START_ATTEMPT:"video-start-attempt",VIDEO_START_FAILURE:"video-start-failure",VIDEO_START_TIME:"video-start-time",VIDEO_SEEK:"video-seek",VIDEO_SEEKED:"video-seeked",CHUNK_DOWNLOADED:"chunk_downloaded"};function ml(e){function t(e,t,n=!0,r="POST"){return new Promise((i,o)=>{"POST"===r&&navigator.sendBeacon?i({status:navigator.sendBeacon(e,t)}):kt({url:e,body:t,method:r,async:n,headers:{"Content-Type":"text/plain; charset=UTF-8"}}).then(e=>{i({response:e,status:e.status})}).catch(o)})}return{log:function(n,r=!0,i=!0){i&&(n.event_time=n.event_time||ze());const o=[n];return t(e,JSON.stringify(o),r)},logRequestPromiseWithUrl:t}}function vl(e){let t=0,n=0,r=0,i=0,o=!1,s=-1,a=null,u=null,c=null,l={satisfied:0,tolerable:0,frustrated:0},d=null;function h(){const t=e.getBoundingClientRect(),n=e.videoWidth,r=e.videoHeight;if(0===n&&0===r)return;let i="satisfied";if(t.width>n&&t.height>r&&(n/t.width<.4?i="satisfied":n/t.width<1?i="tolerable":n/t.width>1&&(i="frustrated")),u){const e=Ze(u);l[c]+=e}c=i,u=ze()}function f(){return o?0:1}function p(){return-1===s?null:s>8e3||-1===s?0:s>2e3?.5:1}function _(){return d?(i=r/Ze(d),t>=4||i>=.12?0:t<4&&0!==t?i<.12?.5:0:1):null}function m(){if(-1===s)return null;switch(h(),Object.keys(l).reduce((e,t)=>l[e]>l[t]?e:t)){case"satisfied":return 1;case"tolerable":return.5;case"frustrated":return 0}return null}return e.addEventListener("playing",()=>{-1===s&&(a=ze())}),e.addEventListener("progress",()=>{-1===s&&(d=ze(),s=Ze(a)),h()}),{startupTimeScore:p,rebufferScore:_,failureScore:f,videoQualityScore:m,overallScore:function(){return Math.min(f(),p(),_(),m())},trackBufferStart:function(){-1!==s&&(t++,n=ze())},trackBufferEnd:function(){-1!==s&&(r+=Ze(n))},onError:function(e){e.final&&(o=!0)}}}function gl(e,t=3){if(e=parseFloat(e),isNaN(e))return 0;var n=Math.pow(10,t);return Math.round(e*n)/n}function yl(e,t){let n,r,i,o,s,a,u,c,l,d,h,f,p,_,m=0;function v(){n=0,r=0,i=0,o=0,s=0,a=null,u=0,c=!1,l=!1,d=null,h=!1,f=new vl(e),p=new pl,_={bufferTracker:p,videoBufferCheck:()=>{setInterval(()=>{let t=e.currentTime;l&&!h&&!e.paused&&!_.bufferTracker.isVideoBuffering()&&t<s+.125&&_.bufferTracker.trackBufferStart(y),l&&!e.paused&&_.bufferTracker.isVideoBuffering()&&t>s+.125&&(_.bufferTracker.trackBufferEnd(E),_.bufferTracker.resetLastBufferTime()),s=t},250)},addEventData:e=>null,playbackSessionTimer:()=>{let t=ze();setInterval(()=>{(!e.paused&&c||h||_.bufferTracker.isVideoBuffering())&&(u+=Ze(t)/1e3),t=ze()},500)},customMinuteTracker:{shouldCount:()=>!1,onCount:()=>{}}}}function g(e,n={}){0===m&&(n=Object.assign(n,_.addEventData(e)),t(e,n))}function y(e={}){f.trackBufferStart(),g(_l.VIDEO_BUFFER_START,e)}function E(e={}){f.trackBufferEnd(),g(_l.VIDEO_BUFFER_END,e)}return v(),g(_l.VIDEO_READY),function(){let t=Math.ceil(59*Math.random());setInterval(()=>{var s,a,u;function l(e,n){return 0===e?n===t:n>=60}!e.paused&&c&&(n++,(null==(s=_.customMinuteTracker)||null==s.shouldCount?void 0:s.shouldCount())&&r++,l(i,n)&&(n=0,i++,g(_l.VIDEO_MINUTE_WATCHED)),l(o,r)&&(null==(a=_.customMinuteTracker)||null==a.shouldCount?void 0:a.shouldCount())&&(r=0,o++,null==(u=_.customMinuteTracker)||null==u.onCount||u.onCount(o)))},1e3)}(),window.addEventListener("pagehide",t=>{_.bufferTracker.trackVideoExit(e.paused);const n={startup:f.startupTimeScore(),rebuffer:f.rebufferScore(),failure:f.failureScore(),quality:f.videoQualityScore(),overall:f.overallScore()};d&&g(_l.VIDEO_EXIT,{vxs:n})},!1),e.addEventListener("playing",()=>{c=!0,h||l&&g(_l.VIDEO_PLAYED)}),e.addEventListener("timeupdate",()=>{if(l)return;let e={startup_duration:d?gl(Ze(d)/1e3,2):null};g(_l.VIDEO_START_TIME,e),l=!0}),e.addEventListener("pause",()=>{c=!1,g(_l.VIDEO_PAUSED)}),e.addEventListener("seeking",()=>{h||(a=ze(),h=!0,c=!1,g(_l.VIDEO_SEEK))}),e.addEventListener("seeked",()=>{h=!1,e.paused||(c=!0),g(_l.VIDEO_SEEKED,{seek_duration:Ze(a)/1e3}),a=null}),e.addEventListener("ended",()=>{g(_l.VIDEO_ENDED)}),e.addEventListener("waiting",()=>{c=!1}),e.addEventListener("canplay",()=>{h||_.bufferTracker.isVideoBuffering()&&!c&&(_.bufferTracker.trackBufferEnd(E),_.bufferTracker.resetLastBufferTime())}),{globalProperties:function(){return{autoplay:e.autoplay,buffer_count:_.bufferTracker.getBufferCount(),total_buffer_duration:_.bufferTracker.getTotalBufferDuration(),buffer_ratio:_.bufferTracker.getBufferRatio(u),client_time:ze(),is_buffering:_.bufferTracker.isVideoBuffering(),looping:e.loop,minutes_watched:i,network_state:e.networkState,playback_rate:e.playbackRate,player_width:e.getBoundingClientRect().width,player_height:e.getBoundingClientRect().height,session_playback_duration:gl(u,2),video_time:e.currentTime,video_height:e.videoHeight,video_width:e.videoWidth,volume:gl(e.volume,2)}},logStartRequest:function(){d=ze(),g(_l.VIDEO_START_ATTEMPT)},customizeHooks:function(e){_=Object.assign(_,e)},initHooks:function(){_.videoBufferCheck(),_.playbackSessionTimer()},logBufferStart:y,logBufferEnd:E,setDisplayContext:function(e){m=e},handleExternalError:function(e,t){c=!1,f.onError(t),g(l?_l.VIDEO_PLAYBACK_ERROR:l?_l.VIDEO_START_FAILURE:_l.VIDEO_LOAD_FAILURE,e)},reset:v}}var El=function(){return u.Date.now()},Tl=Math.max,Sl=Math.min;function bl(e,t,n){var r,i,o,s,a,u,c=0,l=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var n=r,o=i;return r=i=void 0,c=t,s=e.apply(o,n)}function p(e){return c=e,a=setTimeout(m,t),l?f(e):s}function _(e){var n=e-u;return void 0===u||n>=t||n<0||d&&e-c>=o}function m(){var e=El();if(_(e))return g(e);a=setTimeout(m,function(e){var n=t-(e-u);return d?Sl(n,o-(e-c)):n}(e))}function g(e){return a=void 0,h&&r?f(e):(r=i=void 0,s)}function y(){var e=El(),n=_(e);if(r=arguments,i=this,u=e,n){if(void 0===a)return p(u);if(d)return clearTimeout(a),a=setTimeout(m,t),f(u)}return void 0===a&&(a=setTimeout(m,t)),s}return t=Iu(t)||0,v(n)&&(l=!!n.leading,o=(d="maxWait"in n)?Tl(Iu(n.maxWait)||0,t):o,h="trailing"in n?!!n.trailing:h),y.cancel=function(){void 0!==a&&clearTimeout(a),c=0,r=u=i=a=void 0},y.flush=function(){return void 0===a?s:g(El())},y}function Al(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return v(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),bl(e,t,{leading:r,maxWait:t,trailing:i})}var wl=Ii((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Tracker=void 0;var n=function(){function e(){}return e.getAttributeTypeMap=function(){return e.attributeTypeMap},e.attributeTypeMap=[{name:"name",baseName:"name",type:"string"},{name:"version",baseName:"version",type:"string"}],e}();t.Tracker=n}));let Rl;const Il=new Uint8Array(16);function kl(){if(!Rl&&(Rl="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Rl))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Rl(Il)}var Pl=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Dl(e){return"string"==typeof e&&Pl.test(e)}const Ol=[];for(let L_=0;L_<256;++L_)Ol.push((L_+256).toString(16).slice(1));function Ll(e,t=0){return Ol[e[t+0]]+Ol[e[t+1]]+Ol[e[t+2]]+Ol[e[t+3]]+"-"+Ol[e[t+4]]+Ol[e[t+5]]+"-"+Ol[e[t+6]]+Ol[e[t+7]]+"-"+Ol[e[t+8]]+Ol[e[t+9]]+"-"+Ol[e[t+10]]+Ol[e[t+11]]+Ol[e[t+12]]+Ol[e[t+13]]+Ol[e[t+14]]+Ol[e[t+15]]}let Cl,Nl,Ml=0,xl=0;function Ul(e){if(!Dl(e))throw TypeError("Invalid UUID");let t;const n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n}function Fl(e,t,n){function r(e,r,i,o){var s;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof r&&(r=Ul(r)),16!==(null===(s=r)||void 0===s?void 0:s.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let a=new Uint8Array(16+e.length);if(a.set(r),a.set(e,r.length),a=n(a),a[6]=15&a[6]|t,a[8]=63&a[8]|128,i){o=o||0;for(let e=0;e<16;++e)i[o+e]=a[e];return i}return Ll(a)}try{r.name=e}catch(i){}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r}function jl(e){return 14+(e+64>>>9<<4)+1}function Vl(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function Bl(e,t,n,r,i,o){return Vl(function(e,t){return e<<t|e>>>32-t}(Vl(Vl(t,e),Vl(r,o)),i),n)}function Hl(e,t,n,r,i,o,s){return Bl(t&n|~t&r,e,t,i,o,s)}function Xl(e,t,n,r,i,o,s){return Bl(t&r|n&~r,e,t,i,o,s)}function ql(e,t,n,r,i,o,s){return Bl(t^n^r,e,t,i,o,s)}function Wl(e,t,n,r,i,o,s){return Bl(n^(t|~r),e,t,i,o,s)}const Gl=Fl("v3",48,(function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){const t=[],n=32*e.length;for(let r=0;r<n;r+=8){const n=e[r>>5]>>>r%32&255,i=parseInt("0123456789abcdef".charAt(n>>>4&15)+"0123456789abcdef".charAt(15&n),16);t.push(i)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[jl(t)-1]=t;let n=1732584193,r=-271733879,i=-1732584194,o=271733878;for(let s=0;s<e.length;s+=16){const t=n,a=r,u=i,c=o;n=Hl(n,r,i,o,e[s],7,-680876936),o=Hl(o,n,r,i,e[s+1],12,-389564586),i=Hl(i,o,n,r,e[s+2],17,606105819),r=Hl(r,i,o,n,e[s+3],22,-1044525330),n=Hl(n,r,i,o,e[s+4],7,-176418897),o=Hl(o,n,r,i,e[s+5],12,1200080426),i=Hl(i,o,n,r,e[s+6],17,-1473231341),r=Hl(r,i,o,n,e[s+7],22,-45705983),n=Hl(n,r,i,o,e[s+8],7,1770035416),o=Hl(o,n,r,i,e[s+9],12,-1958414417),i=Hl(i,o,n,r,e[s+10],17,-42063),r=Hl(r,i,o,n,e[s+11],22,-1990404162),n=Hl(n,r,i,o,e[s+12],7,1804603682),o=Hl(o,n,r,i,e[s+13],12,-40341101),i=Hl(i,o,n,r,e[s+14],17,-1502002290),r=Hl(r,i,o,n,e[s+15],22,1236535329),n=Xl(n,r,i,o,e[s+1],5,-165796510),o=Xl(o,n,r,i,e[s+6],9,-1069501632),i=Xl(i,o,n,r,e[s+11],14,643717713),r=Xl(r,i,o,n,e[s],20,-373897302),n=Xl(n,r,i,o,e[s+5],5,-701558691),o=Xl(o,n,r,i,e[s+10],9,38016083),i=Xl(i,o,n,r,e[s+15],14,-660478335),r=Xl(r,i,o,n,e[s+4],20,-405537848),n=Xl(n,r,i,o,e[s+9],5,568446438),o=Xl(o,n,r,i,e[s+14],9,-1019803690),i=Xl(i,o,n,r,e[s+3],14,-187363961),r=Xl(r,i,o,n,e[s+8],20,1163531501),n=Xl(n,r,i,o,e[s+13],5,-1444681467),o=Xl(o,n,r,i,e[s+2],9,-51403784),i=Xl(i,o,n,r,e[s+7],14,1735328473),r=Xl(r,i,o,n,e[s+12],20,-1926607734),n=ql(n,r,i,o,e[s+5],4,-378558),o=ql(o,n,r,i,e[s+8],11,-2022574463),i=ql(i,o,n,r,e[s+11],16,1839030562),r=ql(r,i,o,n,e[s+14],23,-35309556),n=ql(n,r,i,o,e[s+1],4,-1530992060),o=ql(o,n,r,i,e[s+4],11,1272893353),i=ql(i,o,n,r,e[s+7],16,-155497632),r=ql(r,i,o,n,e[s+10],23,-1094730640),n=ql(n,r,i,o,e[s+13],4,681279174),o=ql(o,n,r,i,e[s],11,-358537222),i=ql(i,o,n,r,e[s+3],16,-722521979),r=ql(r,i,o,n,e[s+6],23,76029189),n=ql(n,r,i,o,e[s+9],4,-640364487),o=ql(o,n,r,i,e[s+12],11,-421815835),i=ql(i,o,n,r,e[s+15],16,530742520),r=ql(r,i,o,n,e[s+2],23,-995338651),n=Wl(n,r,i,o,e[s],6,-198630844),o=Wl(o,n,r,i,e[s+7],10,1126891415),i=Wl(i,o,n,r,e[s+14],15,-1416354905),r=Wl(r,i,o,n,e[s+5],21,-57434055),n=Wl(n,r,i,o,e[s+12],6,1700485571),o=Wl(o,n,r,i,e[s+3],10,-1894986606),i=Wl(i,o,n,r,e[s+10],15,-1051523),r=Wl(r,i,o,n,e[s+1],21,-2054922799),n=Wl(n,r,i,o,e[s+8],6,1873313359),o=Wl(o,n,r,i,e[s+15],10,-30611744),i=Wl(i,o,n,r,e[s+6],15,-1560198380),r=Wl(r,i,o,n,e[s+13],21,1309151649),n=Wl(n,r,i,o,e[s+4],6,-145523070),o=Wl(o,n,r,i,e[s+11],10,-1120210379),i=Wl(i,o,n,r,e[s+2],15,718787259),r=Wl(r,i,o,n,e[s+9],21,-343485551),n=Vl(n,t),r=Vl(r,a),i=Vl(i,u),o=Vl(o,c)}return[n,r,i,o]}(function(e){if(0===e.length)return[];const t=8*e.length,n=new Uint32Array(jl(t));for(let r=0;r<t;r+=8)n[r>>5]|=(255&e[r/8])<<r%32;return n}(e),8*e.length))}));var Kl={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function Yl(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:return t^n^r;case 2:return t&n^t&r^n&r;case 3:return t^n^r}}function $l(e,t){return e<<t|e>>>32-t}const zl=Fl("v5",80,(function(e){const t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let n=0;n<t.length;++n)e.push(t.charCodeAt(n))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const r=e.length/4+2,i=Math.ceil(r/16),o=new Array(i);for(let s=0;s<i;++s){const t=new Uint32Array(16);for(let n=0;n<16;++n)t[n]=e[64*s+4*n]<<24|e[64*s+4*n+1]<<16|e[64*s+4*n+2]<<8|e[64*s+4*n+3];o[s]=t}o[i-1][14]=8*(e.length-1)/Math.pow(2,32),o[i-1][14]=Math.floor(o[i-1][14]),o[i-1][15]=8*(e.length-1)&4294967295;for(let s=0;s<i;++s){const e=new Uint32Array(80);for(let t=0;t<16;++t)e[t]=o[s][t];for(let t=16;t<80;++t)e[t]=$l(e[t-3]^e[t-8]^e[t-14]^e[t-16],1);let r=n[0],i=n[1],a=n[2],u=n[3],c=n[4];for(let n=0;n<80;++n){const o=Math.floor(n/20),s=$l(r,5)+Yl(o,i,a,u)+c+t[o]+e[n]>>>0;c=u,u=a,a=$l(i,30)>>>0,i=r,r=s}n[0]=n[0]+r>>>0,n[1]=n[1]+i>>>0,n[2]=n[2]+a>>>0,n[3]=n[3]+u>>>0,n[4]=n[4]+c>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]}));var Ql=function(e){return e&&e.default||e}(Object.freeze({__proto__:null,v1:function(e,t,n){let r=t&&n||0;const i=t||new Array(16);let o=(e=e||{}).node||Cl,s=void 0!==e.clockseq?e.clockseq:Nl;if(null==o||null==s){const t=e.random||(e.rng||kl)();null==o&&(o=Cl=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==s&&(s=Nl=16383&(t[6]<<8|t[7]))}let a=void 0!==e.msecs?e.msecs:Date.now(),u=void 0!==e.nsecs?e.nsecs:xl+1;const c=a-Ml+(u-xl)/1e4;if(c<0&&void 0===e.clockseq&&(s=s+1&16383),(c<0||a>Ml)&&void 0===e.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Ml=a,xl=u,Nl=s,a+=122192928e5;const l=(1e4*(268435455&a)+u)%4294967296;i[r++]=l>>>24&255,i[r++]=l>>>16&255,i[r++]=l>>>8&255,i[r++]=255&l;const d=a/4294967296*1e4&268435455;i[r++]=d>>>8&255,i[r++]=255&d,i[r++]=d>>>24&15|16,i[r++]=d>>>16&255,i[r++]=s>>>8|128,i[r++]=255&s;for(let h=0;h<6;++h)i[r+h]=o[h];return t||Ll(i)},v3:Gl,v4:function(e,t,n){if(Kl.randomUUID&&!t&&!e)return Kl.randomUUID();const r=(e=e||{}).random||(e.rng||kl)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return Ll(r)},v5:zl,NIL:"00000000-0000-0000-0000-000000000000",version:function(e){if(!Dl(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)},validate:Dl,stringify:function(e,t=0){const n=Ll(e,t);if(!Dl(n))throw TypeError("Stringified UUID is invalid");return n},parse:Ul})),Jl=Ii((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Envelope=void 0;var n=function(){function e(e,t){this.event=e,this.eid=(0,Ql.v4)(),this.ts_ms=Date.now(),this.created_at=Date.now(),this._tracker=new wl.Tracker,this._globalBPO=t}return Object.defineProperty(e.prototype,"tracker",{get:function(){return this._tracker},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"global",{get:function(){return this._globalBPO},enumerable:!1,configurable:!0}),e.getAttributeTypeMap=function(){return e.attributeTypeMap},e.attributeTypeMap=[{name:"eid",baseName:"eid",type:"string"},{name:"ts_ms",baseName:"ts_ms",type:"number"},{name:"created_at",baseName:"created_at",type:"number"},{name:"event",baseName:"event",type:"Event"},{name:"global",baseName:"global",type:"Event"},{name:"tracker",baseName:"tracker",type:"Tracker"}],e}();t.Envelope=n})),Zl=Ii((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Event=void 0;var n=function(){function e(e,t,n){this.name=e,this.ts_ms=Date.now(),this.version=t,this.fields=n}return e.getAttributeTypeMap=function(){return e.attributeTypeMap},e.attributeTypeMap=[{name:"name",baseName:"name",type:"string"},{name:"ts_ms",baseName:"ts_ms",type:"number"},{name:"version",baseName:"version",type:"number"},{name:"fields",baseName:"fields",type:"object"}],e}();t.Event=n})),ed=Ii((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EventContext=void 0;var n=function(){function e(e,t,n){this.name=e,this.ts_ms=Date.now(),this.version=t,this.fields=n}return e.getAttributeTypeMap=function(){return e.attributeTypeMap},e.attributeTypeMap=[{name:"name",baseName:"name",type:"string"},{name:"ts_ms",baseName:"ts_ms",type:"number"},{name:"version",baseName:"version",type:"number"},{name:"fields",baseName:"fields",type:"object"}],e}();t.EventContext=n})),td=Ii((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalContext=void 0;t.GlobalContext=function(e,t,n){this.name=e,this.ts_ms=Date.now(),this.version=t,this.fields=n}})),nd=Ii((function(e,t){var n=Ri&&Ri.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),r=Ri&&Ri.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectSerializer=void 0,r(Jl,t),r(Zl,t),r(ed,t),r(wl,t),r(td,t);var i=Zl,o=ed,s=wl,a=["string","boolean","double","integer","long","float","number","any"],u={},c={Envelope:Jl.Envelope,Event:i.Event,Tracker:s.Tracker,EventContext:o.EventContext},l=function(){function e(){}return e.findCorrectType=function(e,t){if(null==e)return t;if(-1!==a.indexOf(t.toLowerCase()))return t;if("Date"===t)return t;if(u[t])return t;if(!c[t])return t;var n=c[t].discriminator;if(null==n)return t;if(e[n]){var r=e[n];return c[r]?r:t}return t},e.serialize=function(t,n){if(null==t)return t;if(-1!==a.indexOf(n.toLowerCase()))return t;if(0===n.lastIndexOf("Array<",0)){var r=n.replace("Array<","");r=r.substring(0,r.length-1);var i=[];for(var o in t){var s=t[o];i.push(e.serialize(s,r))}return i}if("Date"===n)return t.toISOString();if(u[n])return t;if(!c[n])return t;n=this.findCorrectType(t,n);var l=c[n].getAttributeTypeMap(),d={};for(var o in l){var h=l[o];d[h.baseName]=e.serialize(t[h.name],h.type)}return d},e.deserialize=function(t,n){if(n=e.findCorrectType(t,n),null==t)return t;if(-1!==a.indexOf(n.toLowerCase()))return t;if(0===n.lastIndexOf("Array<",0)){var r=n.replace("Array<","");r=r.substring(0,r.length-1);var i=[];for(var o in t){var s=t[o];i.push(e.deserialize(s,r))}return i}if("Date"===n)return new Date(t);if(u[n])return t;if(!c[n])return t;var l=new c[n],d=c[n].getAttributeTypeMap();for(var o in d){var h=d[o];l[h.name]=e.deserialize(t[h.baseName],h.type)}return l},e}();t.ObjectSerializer=l})),rd=Ii((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.formatRequestEvent=t.parseJwt=t.getCookie=void 0,t.getCookie=function(e){if("undefined"==typeof document)return null;var t=document.cookie.match(new RegExp("(;\\s)?".concat(e,"=")));if(!t||0==t.length||void 0===t.index)return null;var n=document.cookie.indexOf(";",t.index+1),r=t.index+t[0].length,i=-1===n?document.cookie.substr(r):document.cookie.substring(r,n);return decodeURIComponent(i)},t.parseJwt=function(e){var t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(n)},t.formatRequestEvent=function(e){var t=e.split(".");if(t.length<=2)return e;var n=t.pop();return"".concat(t.join("_"),".").concat(n)}})),id=Ii((function(e,t){var n,r=Ri&&Ri.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(kh){o(kh)}}function a(e){try{u(r.throw(e))}catch(kh){o(kh)}}function u(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(s,a)}u((r=r.apply(e,t||[])).next())}))},i=Ri&&Ri.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(kh){a=[6,kh],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},o=Ri&&Ri.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=Ri&&Ri.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s};Object.defineProperty(t,"__esModule",{value:!0}),t.BigPictureClient=t.Configuration=t.Service=void 0,function(e){e.FRESNEL_PROD="https://fresnel-events.vimeocdn.com",e.FRESNEL_PROD_CN="https://fresnel-events.videoji.cn",e.FRESNEL_DEV="https://fresnel-event-staging.vimeows.com"}(n=t.Service||(t.Service={}));var a=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.service=e,this.globalBPO=t,this.contexts=n};t.Configuration=a;var u=function(){function e(){}return Object.defineProperty(e,"isInitalized",{get:function(){return Boolean(e.conf.globalBPO)},enumerable:!1,configurable:!0}),e.configure=function(t){e.conf=t,e.WAIT_QUEUE.length>0&&(e.WAIT_QUEUE.map((function(t){return e.sendEvent(t)})),e.WAIT_QUEUE=[])},e.updateObject=function(t,n){return r(this,void 0,void 0,(function(){var r,a,u,c,l,d,h;return i(this,(function(i){try{for(r=o(Object.entries(t)),a=r.next();!a.done;a=r.next())if(u=s(a.value,2),c=u[0],l=u[1],c in n){if(l instanceof Object)return n[c]instanceof Object?(e.updateObject(l,n[c]),[2]):(n[c]=l,[2]);n[c]=l}}catch(f){d={error:f}}finally{try{a&&!a.done&&(h=r.return)&&h.call(r)}finally{if(d)throw d.error}}return[2]}))}))},e.updateContext=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(n){return"global"==t.context&&e.conf.globalBPO&&e.updateObject(t.fields,e.conf.globalBPO.fields),[2]}))}))},e.sendEvent=function(t,n){return r(this,void 0,void 0,(function(){var r,o,s,a,u;return i(this,(function(i){switch(i.label){case 0:if(null==t)throw new Error("Required parameter event was null or undefined when calling sendEvent.");return e.isInitalized?(r=JSON.stringify(nd.ObjectSerializer.serialize([new Jl.Envelope(t,this.conf.globalBPO)],"Array<Envelope>")),o=(0,rd.formatRequestEvent)(t.name),s="".concat(this.conf.service,"/add/").concat(encodeURIComponent(o)),navigator.sendBeacon&&!n?[3,2]:(a={method:"POST",headers:{"Content-Type":"application/json","User-Agent":navigator.userAgent,Origin:location.origin,Referer:document.referrer},body:r},n&&(a.headers.Authorization=n),[4,fetch(s,a)])):(e.WAIT_QUEUE.push(t),e.waitAndFlushQueue(),[2]);case 1:return i.sent(),[3,3];case 2:u=new Blob([r]),navigator.sendBeacon(s,u),i.label=3;case 3:return[2]}}))}))},e.sendEventWithContexts=function(t,n,a){return r(this,void 0,void 0,(function(){var r,u,c,l,d,h,f,p,_,m,v,g,y,E,T;return i(this,(function(i){switch(i.label){case 0:if(null==t)throw new Error("Required parameter event was null or undefined when calling sendEvent.");if(!e.isInitalized)return e.WAIT_QUEUE.push(t),e.waitAndFlushQueue(),[2];r=new Jl.Envelope(t,this.conf.globalBPO),(u=nd.ObjectSerializer.serialize([r],"Array<Envelope>"))[0].contexts={};try{for(c=o(Object.entries(n)),l=c.next();!l.done;l=c.next())d=s(l.value,2),h=d[0],f=d[1],p=nd.ObjectSerializer.serialize(f,"EventContext"),u[0].contexts[h]=p}catch(S){E={error:S}}finally{try{l&&!l.done&&(T=c.return)&&T.call(c)}finally{if(E)throw E.error}}return _=JSON.stringify(u),m=(0,rd.formatRequestEvent)(t.name),v="".concat(this.conf.service,"/add/").concat(encodeURIComponent(m)),navigator.sendBeacon&&!a?[3,2]:(g={method:"POST",headers:{"Content-Type":"application/json","User-Agent":navigator.userAgent,Origin:location.origin,Referer:document.referrer},body:_},a&&(g.headers.Authorization=a),[4,fetch(v,g)]);case 1:return i.sent(),[3,3];case 2:y=new Blob([_]),navigator.sendBeacon(v,y),i.label=3;case 3:return[2]}}))}))},e.waitAndFlushQueue=function(){e.flushQueueTimeoutHandler||(e.flushQueueTimeoutHandler=setTimeout((function(){e.WAIT_QUEUE.length>0&&(e.WAIT_QUEUE=[])}),e.FLUSH_QUEUE_TIMEOUT))},e.FLUSH_QUEUE_TIMEOUT=1e4,e.conf=new a(n.FRESNEL_PROD),e.WAIT_QUEUE=[],e}();t.BigPictureClient=u})),od=Ii((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})})),sd=Ii((function(e,t){var n=Ri&&Ri.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),r=Ri&&Ri.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),r(id,t),r(nd,t),r(od,t)}));const ad={SETUP_DONE:"SETUP_DONE",NOT_SETUP:"NOT_SETUP"};let ud=function(){function e(){this.version="1.2.36",this.remotePlayer=null,this.remotePlayerController=null,this.CastContextEventType=null,this.RemotePlayerEventType=null,this.CastState=ad,this.SessionState=null,this.PlayerState=null,this.currentLoadRequestId=null,this.currentLoadRequestPromise=null}var t=e.prototype;return t.init=function({receiverApplicationId:e="",resumeSavedSession:t=!0,language:n=null,autoJoinPolicy:r="TAB_AND_ORIGIN_SCOPED"}={}){if(!this.isGCastApiAvailable)throw new Error("CAF is not available. Call setup() first.");if("string"!=typeof e||""===e.trim())throw new Error("Parameter 'receiverApplicationId' must be valid.");switch(r){case chrome.cast.AutoJoinPolicy.TAB_AND_ORIGIN_SCOPED:case chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED:case chrome.cast.AutoJoinPolicy.PAGE_SCOPED:break;default:r=chrome.cast.AutoJoinPolicy.TAB_AND_ORIGIN_SCOPED}return this.CastContextEventType=cast.framework.CastContextEventType,this.RemotePlayerEventType=cast.framework.RemotePlayerEventType,this.CastState=Object.assign(this.CastState,cast.framework.CastState),this.SessionState=cast.framework.SessionState,this.PlayerState=chrome.cast.media.PlayerState,cast.framework.CastContext.getInstance().setOptions({receiverApplicationId:e.trim(),resumeSavedSession:t,language:n,autoJoinPolicy:r}),this.isInitialized?this.remotePlayerController:this.initRemotePlayer()},t.initRemotePlayer=function(){if(!this.isGCastApiAvailable)throw new ReferenceError("CAF is not available. Call setup() first.");return this.remotePlayer=new cast.framework.RemotePlayer,this.remotePlayerController=new cast.framework.RemotePlayerController(this.remotePlayer),this.remotePlayerController},t.setup=function({loadLibrary:e=!0}={}){return new Promise((t,n)=>{if(this.isGCastApiAvailable)return this.AutoJoinPolicy=chrome.cast.AutoJoinPolicy,void t(!0);window.__onGCastApiAvailable=(e,r)=>{if(r){const e=new Error(r);n(e)}else if(chrome.cast)this.AutoJoinPolicy=chrome.cast.AutoJoinPolicy,t(e);else{const e=new ReferenceError("Cast is not available on this browser.");n(e)}};try{if(!1===e)throw new ReferenceError("Cast is not available. Make sure the library has been loaded.");this.loadLibrary()||t(!1)}catch(r){const e=new Error(r);n(e)}})},t.loadLibrary=function(){if(this.isGCastApiAvailable)return!0;if(null!==window.chrome&&void 0!==window.chrome&&"Google Inc."===window.navigator.vendor){let e="//www.gstatic.com/cv/js/sender/v1/cast_sender.js";if(!(document.querySelectorAll('script[src^="'+e+'"]').length>0)){e+="?loadCastFramework=1";const t=document.createElement("script");return t.src=e,t.async=!0,t.defer=!0,document.head.appendChild(t),!0}}return!1},t.loadMedia=function({contentId:e,contentType:t,currentTime:n=0,duration:r=0,requestCustomData:i=null,mediaCustomData:o=null,autoRequest:s=!1,tracks:a=[],ottCastOptions:u}){return e?this.isSessionEstablished?this.loadMediaOnSession(this.currentSession,{contentId:e,contentType:t,currentTime:n,duration:r,requestCustomData:i,mediaCustomData:o,tracks:a,ottCastOptions:u}):!0!==s?Promise.reject(new TypeError("Option 'autoRequest' must be true when session is not connected.")):this.requestSession().then(s=>this.loadMediaOnSession(s,{contentId:e,contentType:t,currentTime:n,duration:r,requestCustomData:i,mediaCustomData:o,tracks:a,ottCastOptions:u})):Promise.reject(new TypeError("Option 'contentId' must be valid."))},t.loadMediaOnSession=function(e,{contentId:t,contentType:n,currentTime:r=0,duration:i,requestCustomData:o=null,mediaCustomData:s=null,tracks:a=[],ottCastOptions:u}){if(e&&e instanceof cast.framework.CastSession){const c=e.getSessionState();if(c!==this.SessionState.SESSION_STARTING&&c!==this.SessionState.SESSION_STARTED&&c!==this.SessionState.SESSION_RESUMED)return Promise.reject(new ReferenceError("Session must be established."));const l=this.createLoadRequest(t,n,r,i,o,s,a,u);return null!==this.currentLoadRequestId&&this.currentLoadRequestId===l.requestId||(this.currentLoadRequestId=l.requestId,this.currentLoadingMediaPromise=e.loadMedia(l).finally(()=>{this.currentLoadRequestId=null,this.currentLoadingMediaPromise=null})),this.currentLoadingMediaPromise}return Promise.reject(new ReferenceError("Session must be cast.framework.CastSession."))},t.requestSession=function(){return this.isSessionEstablished?Promise.resolve(this.currentSession):this.castContext?this.castContext.requestSession().then(()=>this.currentSession):Promise.reject(new Error("CastContext is not available. Call setup() first."))},t.sendMessage=function({namespace:e,data:t={},autoRequest:n=!1}){return this.isSessionEstablished?this.sendMessageOnSession(this.currentSession,{namespace:e,data:t}):!0!==n?Promise.reject(new TypeError("Option 'autoRequest' must be true when session is not connected.")):this.requestSession().then(n=>this.sendMessageOnSession(n,{namespace:e,data:t}))},t.sendMessageOnSession=function(e,{namespace:t,data:n={}}){if(e||!(e instanceof cast.framework.CastSession)){const r=e.getSessionState();return r!==this.SessionState.SESSION_STARTING&&r!==this.SessionState.SESSION_STARTED&&r!==this.SessionState.SESSION_RESUMED?Promise.reject(new ReferenceError("Session must be established.")):e.sendMessage(t,n)}return Promise.reject(new ReferenceError("Session must be cast.framework.CastSession."))},t.createCastButton=function(e){const t=document.createElement("button","google-cast-button");return e&&e.style&&(null===e.style["--disconnected-color"]&&(e.style["--disconnected-color"]="#00ADEF"),null===e.style["--connected-color"]&&(e.style["--connected-color"]="#E5E500")),e&&Object.keys(e).forEach(n=>{if("string"==typeof e[n])t.setAttribute(n,e[n]);else if("style"===n&&"object"==typeof e[n]){let r="";Object.keys(e[n]).forEach(t=>{r+=t+":"+e[n][t]+";"}),t.setAttribute(n,r)}}),t},t.createLoadRequest=function(e,t,n,r,i,o,s,a){const u=a?new chrome.cast.media.MediaInfo(a.contentId):new chrome.cast.media.MediaInfo(e.toString(),t);u.customData=o,u.duration=r;const c={subtitles:chrome.cast.media.TextTrackType.SUBTITLES,captions:chrome.cast.media.TextTrackType.CAPTIONS};u.tracks=s.map(e=>{const t=new chrome.cast.media.Track(e.id,chrome.cast.media.TrackType.TEXT);return t.trackContentId=e.url,t.trackContentType="text/vtt",t.subtype=c[e.kind],t.name=e.label,t.language=e.lang,t});const l=new chrome.cast.media.LoadRequest(u);return l.customData=a?a.customData:i,l.currentTime=n||0,a&&(l.credentials=a.credentials,l.credentialsType=a.credentialsType),l},pe(e,[{key:"isGCastApiAvailable",get:function(){return!!("undefined"!=typeof cast&&cast&&cast.framework&&cast.framework.VERSION)}},{key:"castState",get:function(){return this.castContext?this.castContext.getCastState():this.isGCastApiAvailable?this.CastState.SETUP_DONE:this.CastState.NOT_SETUP}},{key:"versionGCastApi",get:function(){return this.isGCastApiAvailable?cast.framework.VERSION:null}},{key:"castContext",get:function(){return this.isGCastApiAvailable?cast.framework.CastContext.getInstance():null}},{key:"currentSession",get:function(){return this.castContext?this.castContext.getCurrentSession():null}},{key:"currentSessionObj",get:function(){const e=this.currentSession;return e?e.getSessionObj():null}},{key:"isInitialized",get:function(){return!(!this.isGCastApiAvailable||!this.remotePlayerController)}},{key:"isSessionEstablished",get:function(){const e=this.currentSessionObj;return!!e&&e.status===chrome.cast.SessionStatus.CONNECTED}},{key:"isCastConnected",get:function(){return this.castState===this.CastState.CONNECTED}}]),e}();var cd,ld=0,dd=0,hd={},fd={};function pd(e,t,n){return"_root"==t?n:e!==n?function(e){return cd||(cd=e.matches?e.matches:e.webkitMatchesSelector?e.webkitMatchesSelector:e.mozMatchesSelector?e.mozMatchesSelector:e.msMatchesSelector?e.msMatchesSelector:e.oMatchesSelector?e.oMatchesSelector:gd.matchesSelector)}(e).call(e,t)?e:e.parentNode?(ld++,pd(e.parentNode,t,n)):void 0:void 0}function _d(e,t,n,r){hd[e.id]||(hd[e.id]={}),hd[e.id][t]||(hd[e.id][t]={}),hd[e.id][t][n]||(hd[e.id][t][n]=[]),hd[e.id][t][n].push(r)}function md(e,t,n,r){if(hd[e.id])if(t)if(r||n)if(r){if(hd[e.id][t][n])for(var i=0;i<hd[e.id][t][n].length;i++)if(hd[e.id][t][n][i]===r){hd[e.id][t][n].splice(i,1);break}}else delete hd[e.id][t][n];else hd[e.id][t]={};else for(var o in hd[e.id])hd[e.id].hasOwnProperty(o)&&(hd[e.id][o]={})}function vd(e,t,n,r){if(this.element){e instanceof Array||(e=[e]),n||"function"!=typeof t||(n=t,t="_root");var i,o=this.id;for(i=0;i<e.length;i++)r?md(this,e[i],t,n):(hd[o]&&hd[o][e[i]]||gd.addEvent(this,e[i],s(e[i])),_d(this,e[i],t,n));return this}function s(e){return function(t){!function(e,t,n){if(hd[e][n]){var r,i,o=t.target||t.srcElement,s={},a=0,u=0;for(r in ld=0,hd[e][n])hd[e][n].hasOwnProperty(r)&&(i=pd(o,r,fd[e].element))&&gd.matchesEvent(n,fd[e].element,i,"_root"==r,t)&&(ld++,hd[e][n][r].match=i,s[ld]=hd[e][n][r]);for(t.stopPropagation=function(){t.cancelBubble=!0},a=0;a<=ld;a++)if(s[a])for(u=0;u<s[a].length;u++){if(!1===s[a][u].call(s[a].match,t))return void gd.cancel(t);if(t.cancelBubble)return}}}(o,t,e)}}}function gd(e,t){if(!(this instanceof gd)){for(var n in fd)if(fd[n].element===e)return fd[n];return dd++,fd[dd]=new gd(e,dd),fd[dd]}this.element=e,this.id=t}gd.prototype.on=function(e,t,n){return vd.call(this,e,t,n)},gd.prototype.off=function(e,t,n){return vd.call(this,e,t,n,!0)},gd.matchesSelector=function(){},gd.cancel=function(e){e.preventDefault(),e.stopPropagation()},gd.addEvent=function(e,t,n){var r="blur"==t||"focus"==t,i=en.passiveEvents?{capture:r,passive:!1}:r;e.element.addEventListener(t,n,i)},gd.matchesEvent=function(){return!0};const yd=gd.addEvent,Ed=void 0===window.PointerEvent&&void 0!==window.MSPointerEvent,Td={pointerdown:"MSPointerDown",pointerup:"MSPointerUp",pointercancel:"MSPointerCancel",pointermove:"MSPointerMove",pointerenter:"MSPointerEnter",pointerleave:"MSPointerLeave",pointerover:"MSPointerOver",pointerout:"MSPointerOut"},Sd="onmspointerenter"in document,bd="onmspointerleave"in document;function Ad(e,t){return null==e||e!=e?t:e}gd.addEvent=function(e,t,n){Ed&&Td[t]&&(t=Td[t]),"transitionend"===t&&(yd(e,"webkitTransitionEnd",n),yd(e,"otransitionend",n)),"mouseenter"===t&&(t="mouseover"),"mouseleave"===t&&(t="mouseout"),"MSPointerEnter"!==t||Sd||(t="MSPointerOver"),"MSPointerLeave"!==t||bd||(t="MSPointerOut"),yd(e,t,n)},gd.matchesEvent=function(e,t,n,r,i){return!("mouseenter"===e||"mouseleave"===e||!Sd&&"MSPointerEnter"===e||!bd&&"MSPointerLeave"===e)||function(e,t,n,r){return!r.relatedTarget||(!n||e===t)&&t!==r.relatedTarget&&!t.contains(r.relatedTarget)}(t,n,r,i)};var wd=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var n=-1;return e.some((function(e,r){return e[0]===t&&(n=r,!0)})),n}return(function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var n=e(this.__entries__,t),r=this.__entries__[n];return r&&r[1]},t.prototype.set=function(t,n){var r=e(this.__entries__,t);~r?this.__entries__[r][1]=n:this.__entries__.push([t,n])},t.prototype.delete=function(t){var n=this.__entries__,r=e(n,t);~r&&n.splice(r,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var n=0,r=this.__entries__;n<r.length;n++){var i=r[n];e.call(t,i[1],i[0])}},t}())}(),Rd="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,Id="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),kd="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(Id):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)},Pd=["top","right","bottom","left","width","height","size","weight"],Dd="undefined"!=typeof MutationObserver,Od=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var n=!1,r=!1,i=0;function o(){n&&(n=!1,e()),r&&a()}function s(){kd(o)}function a(){var e=Date.now();if(n){if(e-i<2)return;r=!0}else n=!0,r=!1,setTimeout(s,20);i=e}return a}(this.refresh.bind(this))}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){Rd&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),Dd?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){Rd&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,n=void 0===t?"":t;Pd.some((function(e){return!!~n.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),Ld=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];Object.defineProperty(e,i,{value:t[i],enumerable:!1,writable:!1,configurable:!0})}return e},Cd=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||Id},Nd=jd(0,0,0,0);function Md(e){return parseFloat(e)||0}function xd(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce((function(t,n){return t+Md(e["border-"+n+"-width"])}),0)}var Ud="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof Cd(e).SVGGraphicsElement}:function(e){return e instanceof Cd(e).SVGElement&&"function"==typeof e.getBBox};function Fd(e){return Rd?Ud(e)?function(e){var t=e.getBBox();return jd(0,0,t.width,t.height)}(e):function(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return Nd;var r=Cd(e).getComputedStyle(e),i=function(e){for(var t={},n=0,r=["top","right","bottom","left"];n<r.length;n++){var i=r[n],o=e["padding-"+i];t[i]=Md(o)}return t}(r),o=i.left+i.right,s=i.top+i.bottom,a=Md(r.width),u=Md(r.height);if("border-box"===r.boxSizing&&(Math.round(a+o)!==t&&(a-=xd(r,"left","right")+o),Math.round(u+s)!==n&&(u-=xd(r,"top","bottom")+s)),!function(e){return e===Cd(e).document.documentElement}(e)){var c=Math.round(a+o)-t,l=Math.round(u+s)-n;1!==Math.abs(c)&&(a-=c),1!==Math.abs(l)&&(u-=l)}return jd(i.left,i.top,a,u)}(e):Nd}function jd(e,t,n,r){return{x:e,y:t,width:n,height:r}}var Vd=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=jd(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=Fd(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),Bd=function(e,t){var n=function(e){var t=e.x,n=e.y,r=e.width,i=e.height,o="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,s=Object.create(o.prototype);return Ld(s,{x:t,y:n,width:r,height:i,top:n,right:t+r,bottom:i+n,left:t}),s}(t);Ld(this,{target:e,contentRect:n})},Hd=function(){function e(e,t,n){if(this.activeObservations_=[],this.observations_=new wd,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=n}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof Cd(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new Vd(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof Cd(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new Bd(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),Xd="undefined"!=typeof WeakMap?new WeakMap:new wd,qd=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=Od.getInstance(),r=new Hd(t,n,this);Xd.set(this,r)};["observe","unobserve","disconnect"].forEach((function(e){qd.prototype[e]=function(){var t;return(t=Xd.get(this))[e].apply(t,arguments)}}));var Wd=void 0!==Id.ResizeObserver?Id.ResizeObserver:qd;function Gd(e,t,n){this.constructorName="MessageApiError",this.message=e,this.name=t,this.source=n}function Kd(e){return e}function Yd(e){if(!e||""===e)return{};if("object"==typeof e)return e;try{return JSON.parse(e)}catch(t){return{}}}function $d(e){}Gd.prototype=new Error;let zd={captureException(e){},captureMessage(e){},captureBreadcrumb(){}},Qd=zd;var Jd={set:function(e){Qd=Object.assign({},zd,e)},captureException:function(e,t){return Qd.captureException(e,t)},captureMessage:function(e,t){return Qd.captureMessage(e,t)},captureBreadcrumb:function(e,t,n="backbone",r="info"){return Qd.captureBreadcrumb(e,t,n,r)}};function Zd(){const e={},t={},n={parseMessage:Yd,buildMessage:Kd,logError:$d};let r,i,o={};const s={get methods(){return e},extendMethods(...t){Fe.apply(void 0,[e].concat(t))},get listeners(){return o},set listeners(e){o=e},emit(e,...t){a.apply(void 0,[e].concat(t))&&c(u.apply(void 0,[e].concat(t)))},emitMethodEvent(e,t){c({method:e,value:t})},filter(e,n){n||"function"!=typeof e||(n=e,e=null),e?function(e,n){t.event=t.event||{},t.event[e]=t.event[e]||[],t.event[e].push(n)}(e,n):function(e){t.global=t.global||[],t.global.push(e)}(n)},hooks:(...e)=>Fe.apply(void 0,[n].concat(e)),configureClient(e,t){r=e,i=t}};function a(...e){if(t){let n,r;if(t.global&&t.global.length)for(n=0;n<t.global.length;n++)if(r=t.global[n],!r.apply(r,e))return!1;let i=e[0];if(t.event&&t.event[i]&&t.event[i].length)for(n=0;n<t.event[i].length;n++)if(r=t.event[i][n],!r.apply(r,e))return!1}return!0}function u(e,...t){const n={event:e};return t&&void 0!==t[0]&&(n.data=t[0]),n}function c(e){if(i&&function(e=window.parent){return!(!window.postMessage||!e.postMessage)}(r)){e=n.buildMessage(e);try{r.postMessage(e,i)}catch(t){}}}return window.addEventListener("message",(function(t){if(r!==t.source)return;let i=n.parseMessage(t.data),{method:o,value:s,id:a}=i;if(!(void 0===o||"string"!=typeof o||o.indexOf("_")>-1))try{let r=function(e,t){if(!e)return null;let n=Object.getOwnPropertyDescriptor(t,e);if(n&&"function"==typeof n.value)return n.value;if(n&&"function"==typeof n.get)return n.get;const r=e.substr(0,3),i=e.substr(3,1).toLowerCase()+e.substr(4);return n=Object.getOwnPropertyDescriptor(t,i),"get"===r&&n&&"function"==typeof n.get?n.get:"set"===r&&n&&"function"==typeof n.set?n.set:null}(o,e);if(!r)throw new Gd(`“${t}” is not a valid method. Valid methods are: ${function(e){return Object.keys(e).reduce((t,n)=>{if(n.indexOf("_")>-1)return t;const r=Object.getOwnPropertyDescriptor(e,n);return"function"==typeof r.value?(t.push(n),t):("function"==typeof r.get&&t.push("get"+n.charAt(0).toUpperCase()+n.slice(1)),"function"==typeof r.set&&t.push("set"+n.charAt(0).toUpperCase()+n.slice(1)),t)},[]).sort()}(e).join(", ")}.`,"TypeError",o);Jd.captureBreadcrumb("API message received",i,"api"),Promise.resolve(r.call(t,s,a)).then(e=>c({method:o,value:null==e?s:e})).catch(n.logError)}catch(u){n.logError(u)}}),!1),s}var eh=self!==top,th=function(){var e=document.createElement("video"),t={request:["requestFullscreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen"],exit:["exitFullscreen","webkitCancelFullScreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],enabled:["fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled"],element:["fullscreenElement","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","msFullscreenElement"],change:["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],error:["fullscreenerror","webkitfullscreenerror","mozfullscreenerror","MSFullscreenError"]},n={};for(var r in t)for(var i=0,o=t[r].length;i<o;i++)if(t[r][i]in e||t[r][i]in document||"on"+t[r][i].toLowerCase()in document){n[r]=t[r][i];break}return n}(),nh={ENTER:"enter",EXIT:"exit",CHANGE:"change",ERROR:"error"},rh=[],ih={};function oh(){var e=Array.prototype.slice.apply(arguments),t=e.shift();ih[t].forEach((function(t){"function"==typeof t&&t.apply(t,e)}))}function sh(e){return function(t,n){-1!==rh.indexOf(t)&&e.call(this,t,n)}}function ah(e){var t=null;if("VIDEO"===e.tagName)t=e;else{var n=e.getElementsByTagName("video");n[0]&&(t=n[0])}return t}Object.keys(nh).forEach((function(e){rh.push(nh[e]),ih[nh[e]]=[]}));var uh=null,ch=function(){},lh=[];function dh(e){var t=ah(e);if(t&&t.webkitEnterFullscreen){try{t.readyState<t.HAVE_CURRENT_DATA?t.addEventListener("loadeddata",(function n(){t.removeEventListener("loadeddata",n,!1);try{t.webkitEnterFullscreen()}catch(r){return ph("cannot_enter_fullscreen",e)}}),!1):t.webkitEnterFullscreen(),uh=t}catch(n){return ph("not_supported",e)}return!0}return ph(void 0===th.request?"not_supported":"not_enabled",e)}var hh=function(e){var t=lh[lh.length-1];t&&(e!==t.element&&e!==uh||!t.hasEntered)&&("VIDEO"===e.tagName&&(uh=e),1===lh.length&&_h.onenter(_h.element),t.enter.call(t.element,e||t.element),t.hasEntered=!0,oh(nh.ENTER,_h.element))},fh=function(){uh=null;var e=lh.pop();e&&(e.exit.call(e.element),oh(nh.EXIT,e.element),_h.element||(lh.forEach((function(e){e.exit.call(e.element),oh(nh.EXIT,e.element)})),lh=[],_h.onexit()))},ph=function(e,t){if(lh.length>0){var n=lh.pop();t=t||n.element,n.error.call(t,e),_h.onerror(t,e),oh(nh.ERROR,t,e)}},_h={request:function(e,t,n,r){if(e=e||document.body,lh.push({element:e,enter:t||ch,exit:n||ch,error:r||ch}),void 0===th.request)return dh(e);if(eh&&!1===document[th.enabled])return dh(e);try{e[th.request]()}catch(i){ph("not_enabled",e)}},exit:function(){!document[th.exit]&&_h.element?_h.element[th.exit]():document[th.exit]()},toggle:function(e,t,n,r){_h.element?_h.exit():_h.request(e,t,n,r)},videoEnabled:function(e){if(_h.enabled)return!0;var t=ah(e=e||document.body);return!(!t||void 0===t.webkitSupportsFullscreen)&&(t.readyState<t.HAVE_METADATA?"maybe":t.webkitSupportsFullscreen)},on:sh((function(e,t){ih[e].push(t)})),off:sh((function(e,t){var n=ih[e].indexOf(t);n>-1&&ih[e].splice(n,1)})),onenter:ch,onexit:ch,onchange:ch,onerror:ch};try{Object.defineProperties(_h,{element:{enumerable:!0,get:function(){return uh&&uh.webkitDisplayingFullscreen?uh:document[th.element]||null}},enabled:{enumerable:!0,get:function(){return document[th.enabled]||!1}}})}catch(O_){_h.element=null,_h.enabled=!1}function mh(){return window.parent!=window}th.change&&document.addEventListener(th.change,(function(e){if(_h.onchange(_h.element),oh(nh.CHANGE,_h.element),_h.element){var t=lh[lh.length-2];t&&t.element===_h.element?fh():hh(_h.element)}else fh()}),!1),document.addEventListener("webkitbeginfullscreen",(function(e){var t=!0;if(lh.length>0)for(var n=0,r=lh.length;n<r;n++)if(ah(lh[n].element)===e.srcElement){t=!1;break}t&&lh.push({element:e.srcElement,enter:ch,exit:ch,error:ch}),_h.onchange(e.srcElement),oh(nh.CHANGE,_h.srcElement),hh(e.srcElement)}),!0),document.addEventListener("webkitendfullscreen",(function(e){_h.onchange(e.srcElement),oh(nh.CHANGE,e.srcElement),fh(e.srcElement)}),!0),th.error&&document.addEventListener(th.error,(function(e){ph("not_allowed")}),!1);var vh=Object.prototype.hasOwnProperty,gh=fi((function(e,n){if(t(n)||z(n))sr(n,dr(n),e);else for(var r in n)vh.call(n,r)&&or(e,r,n[r])}));const yh=function(e){return(t,...n)=>(n.forEach(n=>{for(const r in n){const i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,Object.assign(i,e))}}),t)}({enumerable:!0,configurable:!0,writeable:!1}),Eh={AD_BUFFERING:"ad-buffering",AD_COMPLETE:"ad-complete",AD_CLICK:"ad-click",AD_SKIPPED:"ad-skipped",ALL_ADS_COMPLETED:"all-ads-completed",AD_ERROR:"ad-error",AD_STARTED:"ad-started",ADS_MANAGER_LOADED:"ads-manager-loaded",CONTENT_PAUSE_REQUESTED:"content-pause-requested",CONTENT_RESUME_REQUESTED:"content-resume-requested"};function Th(e,t){const n=new er;let r,i,o,s,a;function u(e){var o=new r.AdsRenderingSettings;o.restoreCustomPlaybackStateOnAdBreakComplete=!0,o.uiElements=[],i=e.getAdsManager(t.videoPlayer,o),n.fire(Eh.ADS_MANAGER_LOADED),i.addEventListener(r.AdErrorEvent.Type.AD_ERROR,v),i.addEventListener(r.AdEvent.Type.CONTENT_PAUSE_REQUESTED,c),i.addEventListener(r.AdEvent.Type.CONTENT_RESUME_REQUESTED,l),i.addEventListener(r.AdEvent.Type.AD_BUFFERING,d),i.addEventListener(r.AdEvent.Type.STARTED,h),i.addEventListener(r.AdEvent.Type.COMPLETE,f),i.addEventListener(r.AdEvent.Type.CLICK,p),i.addEventListener(r.AdEvent.Type.SKIPPED,_),i.addEventListener(r.AdEvent.Type.ALL_ADS_COMPLETED,m)}function c(e){n.fire(Eh.CONTENT_PAUSE_REQUESTED,e)}function l(e){n.fire(Eh.CONTENT_RESUME_REQUESTED,e)}function d(e){n.fire(Eh.AD_BUFFERING,e)}function h(e){n.fire(Eh.AD_STARTED,e)}function f(e){n.fire(Eh.AD_COMPLETE,e)}function p(e){i.pause(),n.fire(Eh.AD_CLICK,e)}function _(e){n.fire(Eh.AD_SKIPPED,e)}function m(e){n.fire(Eh.ALL_ADS_COMPLETED,e)}function v(e){n.fire(Eh.AD_ERROR,e.getError()),i&&i.destroy()}const g={start:(e,t)=>(a.initialize(),i.init(e,t,r.ViewMode.NORMAL),i.start()),stop:()=>i.stop(),pause:()=>i.pause(),play:()=>i.resume(),skip:()=>i.skip(),resize:(e,t,n)=>n?i.resize(e,t,r.ViewMode.FULLSCREEN):i.resize(e,t,r.ViewMode.NORMAL),destroy(){n.off(),i.destroy(),o.destroy(),a.destroy()},get volume(){return Xe(i.getVolume())},set volume(e){i.setVolume(He(e))},get adsManager(){return i},get adsLoader(){return o},get remainingTime(){return i.getRemainingTime()},setContentComplete(){o.contentComplete()},on(e,t){return n.on(e,t),this},off(e,t){return n.off(e,t),this}};return function(e,t,n){if(document.getElementById("vp-ima-sdk"))n();else{var r=document.createElement("script");r.id="vp-ima-sdk",r.src="https://imasdk.googleapis.com/js/sdkloader/ima3.js",r.onreadystatechange=r.onload=()=>{n&&n()},document.getElementsByTagName("body")[0].appendChild(r)}}(0,0,(function(){r=google.ima;let n=en.iOS?t.videoPlayer.videoElement:t.videoPlayer;a=new r.AdDisplayContainer(e,n),o=new r.AdsLoader(a),o.addEventListener(r.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,u),o.addEventListener(r.AdErrorEvent.Type.AD_ERROR,v),s=new r.AdsRequest,t.adUrl&&(s.adTagUrl=t.adUrl),s.linearAdSlotWidth=t.width.linear,s.linearAdSlotHeight=t.height.linear,s.nonLinearAdSlotWidth=t.width.nonlinear,s.nonLinearAdSlotHeight=t.height.nonlinear,o.requestAds(s)})),yh(this,g)}function Sh(e,t,n,r){if(!v(e))return e;for(var i=-1,o=(t=kn(t,e)).length,s=o-1,a=e;null!=a&&++i<o;){var u=Pn(t[i]),c=n;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(i!=s){var l=a[u];void 0===(c=r?r(l,u,a):void 0)&&(c=v(l)?l:ur(t[i+1])?[]:{})}or(a,u,c),a=a[u]}return e}function bh(e,t){return null!=e&&t in Object(e)}function Ah(e,t){return function(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var s=t[r],a=Dn(e,s);n(0,s)&&Sh(o,kn(s,e),a)}return o}(e,t,(function(t,n){return function(e,t){return null!=e&&function(e,t,n){for(var r=-1,i=(t=kn(t,e)).length,o=!1;++r<i;){var s=Pn(t[r]);if(!(o=null!=e&&n(e,s)))break;e=e[s]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&$(i)&&ur(s,i)&&(Y(e)||K(e))}(e,t,bh)}(e,n)}))}var wh=c?c.isConcatSpreadable:void 0;function Rh(e){return Y(e)||K(e)||!!(wh&&e&&e[wh])}function Ih(e){return null!=e&&e.length?function e(t,n,r,i,o){var s=-1,a=t.length;for(r||(r=Rh),o||(o=[]);++s<a;){var u=t[s];n>0&&r(u)?n>1?e(u,n-1,r,i,o):Ar(o,u):i||(o[o.length]=u)}return o}(e,1):[]}var kh,Ph,Dh,Oh,Lh,Ch,Nh,Mh,xh,Uh,Fh,jh=function(e){return ei(zr(e,void 0,Ih),e+"")}((function(e,t){return null==e?{}:Ah(e,t)})),Vh=function(e,t){return{name:e,value:void 0===t?-1:t,delta:0,entries:[],id:"v2-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}},Bh=function(e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){if("first-input"===e&&!("PerformanceEventTiming"in self))return;var n=new PerformanceObserver((function(e){return e.getEntries().map(t)}));return n.observe({type:e,buffered:!0}),n}}catch(e){}},Hh=function(e,t){var n=function n(r){"pagehide"!==r.type&&"hidden"!==document.visibilityState||(e(r),t&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0)},Xh=function(e){addEventListener("pageshow",(function(t){t.persisted&&e(t)}),!0)},qh=function(e,t,n){var r;return function(i){t.value>=0&&(i||n)&&(t.delta=t.value-(r||0),(t.delta||void 0===r)&&(r=t.value,e(t)))}},Wh=-1,Gh=function(){return"hidden"===document.visibilityState?0:1/0},Kh=function(){Hh((function(e){var t=e.timeStamp;Wh=t}),!0)},Yh=function(){return Wh<0&&(Wh=Gh(),Kh(),Xh((function(){setTimeout((function(){Wh=Gh(),Kh()}),0)}))),{get firstHiddenTime(){return Wh}}},$h=function(e,t){var n,r=Yh(),i=Vh("FCP"),o=function(e){"first-contentful-paint"===e.name&&(a&&a.disconnect(),e.startTime<r.firstHiddenTime&&(i.value=e.startTime,i.entries.push(e),n(!0)))},s=window.performance&&performance.getEntriesByName&&performance.getEntriesByName("first-contentful-paint")[0],a=s?null:Bh("paint",o);(s||a)&&(n=qh(e,i,t),s&&o(s),Xh((function(r){i=Vh("FCP"),n=qh(e,i,t),requestAnimationFrame((function(){requestAnimationFrame((function(){i.value=performance.now()-r.timeStamp,n(!0)}))}))})))},zh=!1,Qh=-1,Jh=function(e,t){zh||($h((function(e){Qh=e.value})),zh=!0);var n,r=function(t){Qh>-1&&e(t)},i=Vh("CLS",0),o=0,s=[],a=function(e){if(!e.hadRecentInput){var t=s[0],r=s[s.length-1];o&&e.startTime-r.startTime<1e3&&e.startTime-t.startTime<5e3?(o+=e.value,s.push(e)):(o=e.value,s=[e]),o>i.value&&(i.value=o,i.entries=s,n())}},u=Bh("layout-shift",a);u&&(n=qh(r,i,t),Hh((function(){u.takeRecords().map(a),n(!0)})),Xh((function(){o=0,Qh=-1,i=Vh("CLS",0),n=qh(r,i,t)})))},Zh={passive:!0,capture:!0},ef=new Date,tf=function(e,t){kh||(kh=t,Ph=e,Dh=new Date,of(removeEventListener),nf())},nf=function(){if(Ph>=0&&Ph<Dh-ef){var e={entryType:"first-input",name:kh.type,target:kh.target,cancelable:kh.cancelable,startTime:kh.timeStamp,processingStart:kh.timeStamp+Ph};Oh.forEach((function(t){t(e)})),Oh=[]}},rf=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){tf(e,t),i()},r=function(){i()},i=function(){removeEventListener("pointerup",n,Zh),removeEventListener("pointercancel",r,Zh)};addEventListener("pointerup",n,Zh),addEventListener("pointercancel",r,Zh)}(t,e):tf(t,e)}},of=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,rf,Zh)}))},sf=function(e,t){var n,r=Yh(),i=Vh("FID"),o=function(e){e.startTime<r.firstHiddenTime&&(i.value=e.processingStart-e.startTime,i.entries.push(e),n(!0))},s=Bh("first-input",o);n=qh(e,i,t),s&&Hh((function(){s.takeRecords().map(o),s.disconnect()}),!0),s&&Xh((function(){var r;i=Vh("FID"),n=qh(e,i,t),Oh=[],Ph=-1,kh=null,of(addEventListener),r=o,Oh.push(r),nf()}))},af={},uf=function(e,t){var n,r=Yh(),i=Vh("LCP"),o=function(e){var t=e.startTime;t<r.firstHiddenTime&&(i.value=t,i.entries.push(e),n())},s=Bh("largest-contentful-paint",o);if(s){n=qh(e,i,t);var a=function(){af[i.id]||(s.takeRecords().map(o),s.disconnect(),af[i.id]=!0,n(!0))};["keydown","click"].forEach((function(e){addEventListener(e,a,{once:!0,capture:!0})})),Hh(a,!0),Xh((function(r){i=Vh("LCP"),n=qh(e,i,t),requestAnimationFrame((function(){requestAnimationFrame((function(){i.value=performance.now()-r.timeStamp,af[i.id]=!0,n(!0)}))}))}))}},cf={},lf=[],df=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function hf(e,t){for(var n in t)e[n]=t[n];return e}function ff(e){var t=e.parentNode;t&&t.removeChild(e)}function pf(e,t,n){var r,i,o,s={};for(o in t)"key"==o?r=t[o]:"ref"==o?i=t[o]:s[o]=t[o];if(arguments.length>2&&(s.children=arguments.length>3?Lh.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(o in e.defaultProps)void 0===s[o]&&(s[o]=e.defaultProps[o]);return _f(e,s,r,i,null)}function _f(e,t,n,r,i){var o={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==i?++Nh:i};return null==i&&null!=Ch.vnode&&Ch.vnode(o),o}function mf(e){return e.children}function vf(e,t){this.props=e,this.context=t}function gf(e,t){if(null==t)return e.__?gf(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?gf(e):null}function yf(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return yf(e)}}function Ef(e){(!e.__d&&(e.__d=!0)&&Mh.push(e)&&!Tf.__r++||Uh!==Ch.debounceRendering)&&((Uh=Ch.debounceRendering)||xh)(Tf)}function Tf(){for(var e;Tf.__r=Mh.length;)e=Mh.sort((function(e,t){return e.__v.__b-t.__v.__b})),Mh=[],e.some((function(e){var t,n,r,i,o,s;e.__d&&(o=(i=(t=e).__v).__e,(s=t.__P)&&(n=[],(r=hf({},i)).__v=i.__v+1,Df(s,i,r,t.__n,void 0!==s.ownerSVGElement,null!=i.__h?[o]:null,n,null==o?gf(i):o,i.__h),Of(n,i),i.__e!=o&&yf(i)))}))}function Sf(e,t,n,r,i,o,s,a,u,c){var l,d,h,f,p,_,m,v=r&&r.__k||lf,g=v.length;for(n.__k=[],l=0;l<t.length;l++)if(null!=(f=n.__k[l]=null==(f=t[l])||"boolean"==typeof f?null:"string"==typeof f||"number"==typeof f||"bigint"==typeof f?_f(null,f,null,null,f):Array.isArray(f)?_f(mf,{children:f},null,null,null):f.__b>0?_f(f.type,f.props,f.key,null,f.__v):f)){if(f.__=n,f.__b=n.__b+1,null===(h=v[l])||h&&f.key==h.key&&f.type===h.type)v[l]=void 0;else for(d=0;d<g;d++){if((h=v[d])&&f.key==h.key&&f.type===h.type){v[d]=void 0;break}h=null}Df(e,f,h=h||cf,i,o,s,a,u,c),p=f.__e,(d=f.ref)&&h.ref!=d&&(m||(m=[]),h.ref&&m.push(h.ref,null,f),m.push(d,f.__c||p,f)),null!=p?(null==_&&(_=p),"function"==typeof f.type&&f.__k===h.__k?f.__d=u=bf(f,u,e):u=wf(e,f,h,v,p,u),"function"==typeof n.type&&(n.__d=u)):u&&h.__e==u&&u.parentNode!=e&&(u=gf(h))}for(n.__e=_,l=g;l--;)null!=v[l]&&("function"==typeof n.type&&null!=v[l].__e&&v[l].__e==n.__d&&(n.__d=gf(r,l+1)),Nf(v[l],v[l]));if(m)for(l=0;l<m.length;l++)Cf(m[l],m[++l],m[++l])}function bf(e,t,n){for(var r,i=e.__k,o=0;i&&o<i.length;o++)(r=i[o])&&(r.__=e,t="function"==typeof r.type?bf(r,t,n):wf(n,r,r,i,r.__e,t));return t}function Af(e,t){return t=t||[],null==e||"boolean"==typeof e||(Array.isArray(e)?e.some((function(e){Af(e,t)})):t.push(e)),t}function wf(e,t,n,r,i,o){var s,a,u;if(void 0!==t.__d)s=t.__d,t.__d=void 0;else if(null==n||i!=o||null==i.parentNode)e:if(null==o||o.parentNode!==e)e.appendChild(i),s=null;else{for(a=o,u=0;(a=a.nextSibling)&&u<r.length;u+=2)if(a==i)break e;e.insertBefore(i,o),s=o}return void 0!==s?s:i.nextSibling}function Rf(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]=null==n?"":"number"!=typeof n||df.test(t)?n:n+"px"}function If(e,t,n,r,i){var o;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||Rf(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||Rf(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])o=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?r||e.addEventListener(t,o?Pf:kf,o):e.removeEventListener(t,o?Pf:kf,o);else if("dangerouslySetInnerHTML"!==t){if(i)t=t.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null!=n&&(!1!==n||"a"===t[0]&&"r"===t[1])?e.setAttribute(t,n):e.removeAttribute(t))}}function kf(e){this.l[e.type+!1](Ch.event?Ch.event(e):e)}function Pf(e){this.l[e.type+!0](Ch.event?Ch.event(e):e)}function Df(e,t,n,r,i,o,s,a,u){var c,l,d,h,f,p,_,m,v,g,y,E=t.type;if(void 0!==t.constructor)return null;null!=n.__h&&(u=n.__h,a=t.__e=n.__e,t.__h=null,o=[a]),(c=Ch.__b)&&c(t);try{e:if("function"==typeof E){if(m=t.props,v=(c=E.contextType)&&r[c.__c],g=c?v?v.props.value:c.__:r,n.__c?_=(l=t.__c=n.__c).__=l.__E:("prototype"in E&&E.prototype.render?t.__c=l=new E(m,g):(t.__c=l=new vf(m,g),l.constructor=E,l.render=Mf),v&&v.sub(l),l.props=m,l.state||(l.state={}),l.context=g,l.__n=r,d=l.__d=!0,l.__h=[]),null==l.__s&&(l.__s=l.state),null!=E.getDerivedStateFromProps&&(l.__s==l.state&&(l.__s=hf({},l.__s)),hf(l.__s,E.getDerivedStateFromProps(m,l.__s))),h=l.props,f=l.state,d)null==E.getDerivedStateFromProps&&null!=l.componentWillMount&&l.componentWillMount(),null!=l.componentDidMount&&l.__h.push(l.componentDidMount);else{if(null==E.getDerivedStateFromProps&&m!==h&&null!=l.componentWillReceiveProps&&l.componentWillReceiveProps(m,g),!l.__e&&null!=l.shouldComponentUpdate&&!1===l.shouldComponentUpdate(m,l.__s,g)||t.__v===n.__v){l.props=m,l.state=l.__s,t.__v!==n.__v&&(l.__d=!1),l.__v=t,t.__e=n.__e,t.__k=n.__k,t.__k.forEach((function(e){e&&(e.__=t)})),l.__h.length&&s.push(l);break e}null!=l.componentWillUpdate&&l.componentWillUpdate(m,l.__s,g),null!=l.componentDidUpdate&&l.__h.push((function(){l.componentDidUpdate(h,f,p)}))}l.context=g,l.props=m,l.state=l.__s,(c=Ch.__r)&&c(t),l.__d=!1,l.__v=t,l.__P=e,c=l.render(l.props,l.state,l.context),l.state=l.__s,null!=l.getChildContext&&(r=hf(hf({},r),l.getChildContext())),d||null==l.getSnapshotBeforeUpdate||(p=l.getSnapshotBeforeUpdate(h,f)),y=null!=c&&c.type===mf&&null==c.key?c.props.children:c,Sf(e,Array.isArray(y)?y:[y],t,n,r,i,o,s,a,u),l.base=t.__e,t.__h=null,l.__h.length&&s.push(l),_&&(l.__E=l.__=null),l.__e=!1}else null==o&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=Lf(n.__e,t,n,r,i,o,s,u);(c=Ch.diffed)&&c(t)}catch(e){t.__v=null,(u||null!=o)&&(t.__e=a,t.__h=!!u,o[o.indexOf(a)]=null),Ch.__e(e,t,n)}}function Of(e,t){Ch.__c&&Ch.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){Ch.__e(e,t.__v)}}))}function Lf(e,t,n,r,i,o,s,a){var u,c,l,d=n.props,h=t.props,f=t.type,p=0;if("svg"===f&&(i=!0),null!=o)for(;p<o.length;p++)if((u=o[p])&&"setAttribute"in u==!!f&&(f?u.localName===f:3===u.nodeType)){e=u,o[p]=null;break}if(null==e){if(null===f)return document.createTextNode(h);e=i?document.createElementNS("http://www.w3.org/2000/svg",f):document.createElement(f,h.is&&h),o=null,a=!1}if(null===f)d===h||a&&e.data===h||(e.data=h);else{if(o=o&&Lh.call(e.childNodes),c=(d=n.props||cf).dangerouslySetInnerHTML,l=h.dangerouslySetInnerHTML,!a){if(null!=o)for(d={},p=0;p<e.attributes.length;p++)d[e.attributes[p].name]=e.attributes[p].value;(l||c)&&(l&&(c&&l.__html==c.__html||l.__html===e.innerHTML)||(e.innerHTML=l&&l.__html||""))}if(function(e,t,n,r,i){var o;for(o in n)"children"===o||"key"===o||o in t||If(e,o,null,n[o],r);for(o in t)i&&"function"!=typeof t[o]||"children"===o||"key"===o||"value"===o||"checked"===o||n[o]===t[o]||If(e,o,t[o],n[o],r)}(e,h,d,i,a),l)t.__k=[];else if(p=t.props.children,Sf(e,Array.isArray(p)?p:[p],t,n,r,i&&"foreignObject"!==f,o,s,o?o[0]:n.__k&&gf(n,0),a),null!=o)for(p=o.length;p--;)null!=o[p]&&ff(o[p]);a||("value"in h&&void 0!==(p=h.value)&&(p!==e.value||"progress"===f&&!p||"option"===f&&p!==d.value)&&If(e,"value",p,d.value,!1),"checked"in h&&void 0!==(p=h.checked)&&p!==e.checked&&If(e,"checked",p,d.checked,!1))}return e}function Cf(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){Ch.__e(e,n)}}function Nf(e,t,n){var r,i;if(Ch.unmount&&Ch.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||Cf(r,null,t)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){Ch.__e(e,t)}r.base=r.__P=null}if(r=e.__k)for(i=0;i<r.length;i++)r[i]&&Nf(r[i],t,"function"!=typeof e.type);n||null==e.__e||ff(e.__e),e.__e=e.__d=void 0}function Mf(e,t,n){return this.constructor(e,n)}function xf(e,t,n){var r,i,o;Ch.__&&Ch.__(e,t),i=(r="function"==typeof n)?null:n&&n.__k||t.__k,o=[],Df(t,e=(!r&&n||t).__k=pf(mf,null,[e]),i||cf,cf,void 0!==t.ownerSVGElement,!r&&n?[n]:i?null:t.firstChild?Lh.call(t.childNodes):null,o,!r&&n?n:i?i.__e:t.firstChild,r),Of(o,e)}function Uf(e,t){xf(e,t,Uf)}function Ff(e,t,n){var r,i,o,s=hf({},e.props);for(o in t)"key"==o?r=t[o]:"ref"==o?i=t[o]:s[o]=t[o];return arguments.length>2&&(s.children=arguments.length>3?Lh.call(arguments,2):n),_f(e.type,s,r||e.key,i||e.ref,null)}function jf(e,t){var n={__c:t="__cC"+Fh++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var n,r;return this.getChildContext||(n=[],(r={})[t]=this,this.getChildContext=function(){return r},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&n.some(Ef)},this.sub=function(e){n.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){n.splice(n.indexOf(e),1),t&&t.call(e)}}),e.children}};return n.Provider.__=n.Consumer.contextType=n}Lh=lf.slice,Ch={__e:function(e,t){for(var n,r,i;t=t.__;)if((n=t.__c)&&!n.__)try{if((r=n.constructor)&&null!=r.getDerivedStateFromError&&(n.setState(r.getDerivedStateFromError(e)),i=n.__d),null!=n.componentDidCatch&&(n.componentDidCatch(e),i=n.__d),i)return n.__E=n}catch(t){e=t}throw e}},Nh=0,vf.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=hf({},this.state),"function"==typeof e&&(e=e(hf({},n),this.props)),e&&hf(n,e),null!=e&&this.__v&&(t&&this.__h.push(t),Ef(this))},vf.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Ef(this))},vf.prototype.render=mf,Mh=[],xh="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Tf.__r=0,Fh=0;var Vf,Bf,Hf,Xf=0,qf=[],Wf=Ch.__b,Gf=Ch.__r,Kf=Ch.diffed,Yf=Ch.__c,$f=Ch.unmount;function zf(e,t){Ch.__h&&Ch.__h(Bf,e,Xf||t),Xf=0;var n=Bf.__H||(Bf.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function Qf(e){return Xf=1,Jf(fp,e)}function Jf(e,t,n){var r=zf(Vf++,2);return r.t=e,r.__c||(r.__=[n?n(t):fp(void 0,t),function(e){var t=r.t(r.__[0],e);r.__[0]!==t&&(r.__=[t,r.__[1]],r.__c.setState({}))}],r.__c=Bf),r.__}function Zf(e,t){var n=zf(Vf++,3);!Ch.__s&&hp(n.__H,t)&&(n.__=e,n.__H=t,Bf.__H.__h.push(n))}function ep(e,t){var n=zf(Vf++,4);!Ch.__s&&hp(n.__H,t)&&(n.__=e,n.__H=t,Bf.__h.push(n))}function tp(e){return Xf=5,np((function(){return{current:e}}),[])}function np(e,t){var n=zf(Vf++,7);return hp(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function rp(e,t){return Xf=8,np((function(){return e}),t)}function ip(e){var t=Bf.context[e.__c],n=zf(Vf++,9);return n.c=e,t?(null==n.__&&(n.__=!0,t.sub(Bf)),t.props.value):e.__}function op(e,t){Ch.useDebugValue&&Ch.useDebugValue(t?t(e):e)}function sp(e){var t=zf(Vf++,10),n=Qf();return t.__=e,Bf.componentDidCatch||(Bf.componentDidCatch=function(e){t.__&&t.__(e),n[1](e)}),[n[0],function(){n[1](void 0)}]}function ap(){for(var e;e=qf.shift();)if(e.__P)try{e.__H.__h.forEach(lp),e.__H.__h.forEach(dp),e.__H.__h=[]}catch(Xh){e.__H.__h=[],Ch.__e(Xh,e.__v)}}Ch.__b=function(e){Bf=null,Wf&&Wf(e)},Ch.__r=function(e){Gf&&Gf(e),Vf=0;var t=(Bf=e.__c).__H;t&&(t.__h.forEach(lp),t.__h.forEach(dp),t.__h=[])},Ch.diffed=function(e){Kf&&Kf(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(1!==qf.push(t)&&Hf===Ch.requestAnimationFrame||((Hf=Ch.requestAnimationFrame)||function(e){var t,n=function(){clearTimeout(r),cp&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);cp&&(t=requestAnimationFrame(n))})(ap)),Bf=null},Ch.__c=function(e,t){t.some((function(e){try{e.__h.forEach(lp),e.__h=e.__h.filter((function(e){return!e.__||dp(e)}))}catch(Vh){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Ch.__e(Vh,e.__v)}})),Yf&&Yf(e,t)},Ch.unmount=function(e){$f&&$f(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{lp(e)}catch(e){t=e}})),t&&Ch.__e(t,n.__v))};var up,cp="function"==typeof requestAnimationFrame;function lp(e){var t=Bf,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),Bf=t}function dp(e){var t=Bf;e.__c=e.__(),Bf=t}function hp(e,t){return!e||e.length!==t.length||t.some((function(t,n){return t!==e[n]}))}function fp(e,t){return"function"==typeof t?t(e):t}!function(e){e[e.APPEAR=0]="APPEAR",e[e.APPEARING=1]="APPEARING",e[e.APPEARED=2]="APPEARED",e[e.ENTER=3]="ENTER",e[e.ENTERING=4]="ENTERING",e[e.ENTERED=5]="ENTERED",e[e.EXIT=6]="EXIT",e[e.EXITING=7]="EXITING",e[e.EXITED=8]="EXITED"}(up||(up={}));var pp,_p=function(){},mp=setTimeout(_p),vp=function(e){var t=e.children,n=e.in,r=void 0!==n&&n,i=e.appear,o=void 0!==i&&i,s=e.enter,a=void 0===s||s,u=e.exit,c=void 0===u||u,l=e.duration,d=void 0===l?500:l,h=e.alwaysMounted,f=void 0!==h&&h,p=e.onEnter,_=void 0===p?_p:p,m=e.onEntering,v=void 0===m?_p:m,g=e.onEntered,y=void 0===g?_p:g,E=e.onExit,T=void 0===E?_p:E,S=e.onExiting,b=void 0===S?_p:S,A=e.onExited,w=void 0===A?_p:A,R=tp(mp),I=!1,k=Qf((function(){return I=!0,r?o?up.APPEAR:up.APPEARED:up.EXITED})),P=k[0],D=k[1];Zf((function(){switch(P){case up.APPEAR:_(),D(up.APPEARING);break;case up.APPEARING:v(),R.current=setTimeout((function(){D(up.APPEARED)}),d);break;case up.APPEARED:y();break;case up.ENTER:_(),D(up.ENTERING);break;case up.ENTERING:v(),R.current=setTimeout((function(){D(up.ENTERED)}),d);break;case up.ENTERED:y();break;case up.EXIT:T(),D(up.EXITING);break;case up.EXITING:b(),R.current=setTimeout((function(){D(up.EXITED)}),d);break;case up.EXITED:w()}return function(){clearTimeout(R.current)}}),[P]),ep((function(){if(!I)switch(!0){case!(!r||!a):D(up.ENTER);break;case!(!r||a):D(up.ENTERED);break;case!(r||!c):D(up.EXIT);break;case!(r||c):D(up.EXITED)}}),[r]);var O=np((function(){return{appear:P===up.APPEAR,appearActive:P===up.APPEARING,appearDone:P===up.APPEARED,enter:P===up.ENTER,enterActive:P===up.ENTERING,enterDone:P===up.ENTERED,exit:P===up.EXIT,exitActive:P===up.EXITING,exitDone:P===up.EXITED}}),[P]);return(f||P!==up.EXITED)&&t(O)};function gp(){return(gp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}!function(e){e.APPEAR="-appear",e.APPEAR_ACTIVE="-appear-active",e.APPEAR_DONE="-appear-done",e.ENTER="-enter",e.ENTER_ACTIVE="-enter-active",e.ENTER_DONE="-enter-done",e.EXIT="-exit",e.EXIT_ACTIVE="-exit-active",e.EXIT_DONE="-exit-done"}(pp||(pp={}));var yp=["children","styles"],Ep=function(e){var t=e.children,n=e.styles,r=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)t.indexOf(n=o[r])>=0||(i[n]=e[n]);return i}(e,yp);return pf(vp,r,(function(e){var r=t.props.style,i=np((function(){return gp({},function(e,t){switch(!0){case e.appear:return t.appear;case e.appearActive:return gp({},t.appear,t.appearActive);case e.appearDone:return t.appearDone;case e.enter:return t.enter;case e.enterActive:return gp({},t.enter,t.enterActive);case e.enterDone:return t.enterDone;case e.exit:return t.exit;case e.exitActive:return gp({},t.exit,t.exitActive);case e.exitDone:return t.exitDone;default:return{}}}(e,n),r)}),[r,n,e]);return Ff(t,{style:i})}))};function Tp(e,t){for(var n in t)e[n]=t[n];return e}function Sp(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function bp(e){this.props=e}(bp.prototype=new vf).isPureReactComponent=!0,bp.prototype.shouldComponentUpdate=function(e,t){return Sp(this.props,e)||Sp(this.state,t)};var Ap=Ch.__b;Ch.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),Ap&&Ap(e)};var wp="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Rp(e){function t(t,n){var r=Tp({},t);return delete r.ref,e(r,(n=t.ref||n)&&("object"!=typeof n||"current"in n)?n:null)}return t.$$typeof=wp,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var Ip=function(e,t){return null==e?null:Af(Af(e).map(t))},kp={map:Ip,forEach:Ip,count:function(e){return e?Af(e).length:0},only:function(e){var t=Af(e);if(1!==t.length)throw"Children.only";return t[0]},toArray:Af},Pp=Ch.__e;Ch.__e=function(e,t,n){if(e.then)for(var r,i=t;i=i.__;)if((r=i.__c)&&r.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),r.__c(e,t);Pp(e,t,n)};var Dp=Ch.unmount;function Op(){this.__u=0,this.t=null,this.__b=null}function Lp(e){var t=e.__.__c;return t&&t.__e&&t.__e(e)}function Cp(){this.u=null,this.o=null}Ch.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),Dp&&Dp(e)},(Op.prototype=new vf).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var i=Lp(r.__v),o=!1,s=function(){o||(o=!0,n.__R=null,i?i(a):a())};n.__R=s;var a=function(){if(!--r.__u){if(r.state.__e){var e=r.state.__e;r.__v.__k[0]=function e(t,n,r){return t&&(t.__v=null,t.__k=t.__k&&t.__k.map((function(t){return e(t,n,r)})),t.__c&&t.__c.__P===n&&(t.__e&&r.insertBefore(t.__e,t.__d),t.__c.__e=!0,t.__c.__P=r)),t}(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__e:r.__b=null});t=r.t.pop();)t.forceUpdate()}},u=!0===t.__h;r.__u++||u||r.setState({__e:r.__b=r.__v.__k[0]}),e.then(s,s)},Op.prototype.componentWillUnmount=function(){this.t=[]},Op.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=function e(t,n,r){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),t.__c.__H=null),null!=(t=Tp({},t)).__c&&(t.__c.__P===r&&(t.__c.__P=n),t.__c=null),t.__k=t.__k&&t.__k.map((function(t){return e(t,n,r)}))),t}(this.__b,n,r.__O=r.__P)}this.__b=null}var i=t.__e&&pf(mf,null,e.fallback);return i&&(i.__h=null),[pf(mf,null,t.__e?null:e.children),i]};var Np=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};function Mp(e){return this.getChildContext=function(){return e.context},e.children}function xp(e){var t=this,n=e.i;t.componentWillUnmount=function(){xf(null,t.l),t.l=null,t.i=null},t.i&&t.i!==n&&t.componentWillUnmount(),e.__v?(t.l||(t.i=n,t.l={nodeType:1,parentNode:n,childNodes:[],appendChild:function(e){this.childNodes.push(e),t.i.appendChild(e)},insertBefore:function(e,n){this.childNodes.push(e),t.i.appendChild(e)},removeChild:function(e){this.childNodes.splice(this.childNodes.indexOf(e)>>>1,1),t.i.removeChild(e)}}),xf(pf(Mp,{context:t.context},e.__v),t.l)):t.l&&t.componentWillUnmount()}function Up(e,t){return pf(xp,{__v:e,i:t})}(Cp.prototype=new vf).__e=function(e){var t=this,n=Lp(t.__v),r=t.o.get(e);return r[0]++,function(i){var o=function(){t.props.revealOrder?(r.push(i),Np(t,e,r)):i()};n?n(o):o()}},Cp.prototype.render=function(e){this.u=null,this.o=new Map;var t=Af(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},Cp.prototype.componentDidUpdate=Cp.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){Np(e,n,t)}))};var Fp="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,jp=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Vp="undefined"!=typeof document,Bp=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};vf.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(vf.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var Hp=Ch.event;function Xp(){}function qp(){return this.cancelBubble}function Wp(){return this.defaultPrevented}Ch.event=function(e){return Hp&&(e=Hp(e)),e.persist=Xp,e.isPropagationStopped=qp,e.isDefaultPrevented=Wp,e.nativeEvent=e};var Gp,Kp={configurable:!0,get:function(){return this.class}},Yp=Ch.vnode;Ch.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var i=-1===t.indexOf("-");for(var o in r={},n){var s=n[o];Vp&&"children"===o&&"noscript"===t||"value"===o&&"defaultValue"in n&&null==s||("defaultValue"===o&&"value"in n&&null==n.value?o="value":"download"===o&&!0===s?s="":/ondoubleclick/i.test(o)?o="ondblclick":/^onchange(textarea|input)/i.test(o+t)&&!Bp(n.type)?o="oninput":/^onfocus$/i.test(o)?o="onfocusin":/^onblur$/i.test(o)?o="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(o)?o=o.toLowerCase():i&&jp.test(o)?o=o.replace(/[A-Z0-9]/,"-$&").toLowerCase():null===s&&(s=void 0),r[o]=s)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=Af(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=Af(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(Kp.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",Kp))}e.$$typeof=Fp,Yp&&Yp(e)};var $p=Ch.__r;function zp(e){return!!e&&e.$$typeof===Fp}Ch.__r=function(e){$p&&$p(e),Gp=e.__c};var Qp={useState:Qf,useReducer:Jf,useEffect:Zf,useLayoutEffect:ep,useRef:tp,useImperativeHandle:function(e,t,n){Xf=6,ep((function(){"function"==typeof e?e(t()):e&&(e.current=t())}),null==n?n:n.concat(e))},useMemo:np,useCallback:rp,useContext:ip,useDebugValue:op,version:"17.0.2",Children:kp,render:function(e,t,n){return null==t.__k&&(t.textContent=""),xf(e,t),"function"==typeof n&&n(),e?e.__c:null},hydrate:function(e,t,n){return Uf(e,t),"function"==typeof n&&n(),e?e.__c:null},unmountComponentAtNode:function(e){return!!e.__k&&(xf(null,e),!0)},createPortal:Up,createElement:pf,createContext:jf,createFactory:function(e){return pf.bind(null,e)},cloneElement:function(e){return zp(e)?Ff.apply(null,arguments):e},createRef:function(){return{current:null}},Fragment:mf,isValidElement:zp,findDOMNode:function(e){return e&&(e.base||1===e.nodeType&&e)||null},Component:vf,PureComponent:bp,memo:function(e,t){function n(e){var n=this.props.ref,r=n==e.ref;return!r&&n&&(n.call?n(null):n.current=null),t?!t(this.props,e)||!r:Sp(this.props,e)}function r(t){return this.shouldComponentUpdate=n,pf(e,t)}return r.displayName="Memo("+(e.displayName||e.name)+")",r.prototype.isReactComponent=!0,r.__f=!0,r},forwardRef:Rp,flushSync:function(e,t){return e(t)},unstable_batchedUpdates:function(e,t){return e(t)},StrictMode:mf,Suspense:Op,SuspenseList:Cp,lazy:function(e){var t,n,r;function i(i){if(t||(t=e()).then((function(e){n=e.default||e}),(function(e){r=e})),r)throw r;if(!n)throw t;return pf(n,i)}return i.displayName="Lazy",i.__f=!0,i},__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentDispatcher:{current:{readContext:function(e){return Gp.__n[e.__c].props.value}}}}};const Jp="undefined"==typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?Zf:ep;function Zp(e){const t="function"==typeof e?function(e){let t;const n=new Set,r=(e,r)=>{const i="function"==typeof e?e(t):e;if(i!==t){const e=t;t=r?i:Object.assign({},t,i),n.forEach(n=>n(t,e))}},i=()=>t,o={setState:r,getState:i,subscribe:(e,r,o)=>r||o?((e,r=i,o=Object.is)=>{let s=r(t);function a(){const n=r(t);if(!o(s,n)){const t=s;e(s=n,t)}}return n.add(a),()=>n.delete(a)})(e,r,o):(n.add(e),()=>n.delete(e)),destroy:()=>n.clear()};return t=e(r,i,o),o}(e):e,n=(e=t.getState,n=Object.is)=>{const[,r]=Jf(e=>e+1,0),i=t.getState(),o=tp(i),s=tp(e),a=tp(n),u=tp(!1),c=tp();let l;void 0===c.current&&(c.current=e(i));let d=!1;(o.current!==i||s.current!==e||a.current!==n||u.current)&&(l=e(i),d=!n(c.current,l)),Jp(()=>{d&&(c.current=l),o.current=i,s.current=e,a.current=n,u.current=!1});const h=tp(i);Jp(()=>{const e=()=>{try{const e=t.getState(),n=s.current(e);a.current(c.current,n)||(o.current=e,c.current=n,r())}catch(e){u.current=!0,r()}},n=t.subscribe(e);return t.getState()!==h.current&&e(),n},[]);const f=d?l:c.current;return op(f),f};return Object.assign(n,t),n[Symbol.iterator]=function(){const e=[n,t];return{next(){const t=e.length<=0;return{value:e.shift(),done:t}}}},n}function e_(){const e=jf(void 0);return{Provider:({initialStore:t,createStore:n,children:r})=>{const i=tp();return i.current||(t&&(n||(n=()=>t)),i.current=n()),pf(e.Provider,{value:i.current},r)},useStore:(t,n=Object.is)=>{const r=ip(e);if(!r)throw new Error("Seems like you have not used zustand provider as an ancestor.");return r(t,n)},useStoreApi:()=>{const t=ip(e);if(!t)throw new Error("Seems like you have not used zustand provider as an ancestor.");return np(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe,destroy:t.destroy}),[t])}}}const t_=e=>(t,n,r)=>{const i=r.subscribe;return r.subscribe=(e,t,n)=>{let o=e;if(t){const i=(null==n?void 0:n.equalityFn)||Object.is;let s=e(r.getState());o=n=>{const r=e(n);if(!i(s,r)){const e=s;t(s=r,e)}},(null==n?void 0:n.fireImmediately)&&t(s,s)}return i(o)},e(t,n,r)};var n_=0;function r_(e,t,n,r,i){var o,s,a={};for(s in t)"ref"==s?o=t[s]:a[s]=t[s];var u={type:e,props:a,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--n_,__source:r,__self:i};if("function"==typeof e&&(o=e.defaultProps))for(s in o)void 0===a[s]&&(a[s]=o[s]);return Ch.vnode&&Ch.vnode(u),u}function i_(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new yn;++t<n;)this.add(e[t])}function o_(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function s_(e,t){return e.has(t)}function a_(e,t,n,r,i,o){var s=1&n,a=e.length,u=t.length;if(a!=u&&!(s&&u>a))return!1;var c=o.get(e),l=o.get(t);if(c&&l)return c==t&&l==e;var d=-1,h=!0,f=2&n?new i_:void 0;for(o.set(e,t),o.set(t,e);++d<a;){var p=e[d],_=t[d];if(r)var m=s?r(_,p,d,t,e,o):r(p,_,d,e,t,o);if(void 0!==m){if(m)continue;h=!1;break}if(f){if(!o_(t,(function(e,t){if(!s_(f,t)&&(p===e||i(p,e,n,r,o)))return f.push(t)}))){h=!1;break}}else if(p!==_&&!i(p,_,n,r,o)){h=!1;break}}return o.delete(e),o.delete(t),h}function u_(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function c_(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}i_.prototype.add=i_.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},i_.prototype.has=function(e){return this.__data__.has(e)};var l_=c?c.prototype:void 0,d_=l_?l_.valueOf:void 0,h_=Object.prototype.hasOwnProperty,f_=Object.prototype.hasOwnProperty;function p_(e,t,n,r,i){return e===t||(null==e||null==t||!H(e)&&!H(t)?e!=e&&t!=t:function(e,t,n,r,i,o){var s=Y(e),a=Y(t),u=s?"[object Array]":B(e),c=a?"[object Array]":B(t),l="[object Object]"==(u="[object Arguments]"==u?"[object Object]":u),d="[object Object]"==(c="[object Arguments]"==c?"[object Object]":c),h=u==c;if(h&&ee(e)){if(!ee(t))return!1;s=!0,l=!1}if(h&&!l)return o||(o=new tr),s||ue(e)?a_(e,t,n,r,i,o):function(e,t,n,r,i,o,s){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new Or(e),new Or(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return pn(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var a=u_;case"[object Set]":var u=1&r;if(a||(a=c_),e.size!=t.size&&!u)return!1;var c=s.get(e);if(c)return c==t;r|=2,s.set(e,t);var l=a_(a(e),a(t),r,i,o,s);return s.delete(e),l;case"[object Symbol]":if(d_)return d_.call(e)==d_.call(t)}return!1}(e,t,u,n,r,i,o);if(!(1&n)){var f=l&&f_.call(e,"__wrapped__"),p=d&&f_.call(t,"__wrapped__");if(f||p){var _=f?e.value():e,m=p?t.value():t;return o||(o=new tr),i(_,m,n,r,o)}}return!!h&&(o||(o=new tr),function(e,t,n,r,i,o){var s=1&n,a=kr(e),u=a.length;if(u!=kr(t).length&&!s)return!1;for(var c=u;c--;){var l=a[c];if(!(s?l in t:h_.call(t,l)))return!1}var d=o.get(e),h=o.get(t);if(d&&h)return d==t&&h==e;var f=!0;o.set(e,t),o.set(t,e);for(var p=s;++c<u;){var _=e[l=a[c]],m=t[l];if(r)var v=s?r(m,_,l,t,e,o):r(_,m,l,e,t,o);if(!(void 0===v?_===m||i(_,m,n,r,o):v)){f=!1;break}p||(p="constructor"==l)}if(f&&!p){var g=e.constructor,y=t.constructor;g!=y&&"constructor"in e&&"constructor"in t&&!("function"==typeof g&&g instanceof g&&"function"==typeof y&&y instanceof y)&&(f=!1)}return o.delete(e),o.delete(t),f}(e,t,n,r,i,o))}(e,t,n,r,p_,i))}function __(e,t){return p_(e,t)}var m_=[],v_=[];function g_(e,t){if(e&&"undefined"!=typeof document){var n,r=!0===t.prepend?"prepend":"append",i=!0===t.singleTag,o="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(i){var s=m_.indexOf(o);-1===s&&(s=m_.push(o)-1,v_[s]={}),n=v_[s]&&v_[s][r]?v_[s][r]:v_[s][r]=a()}else n=a();65279===e.charCodeAt(0)&&(e=e.substring(1)),n.styleSheet?n.styleSheet.cssText+=e:n.appendChild(document.createTextNode(e))}function a(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var n=Object.keys(t.attributes),i=0;i<n.length;i++)e.setAttribute(n[i],t.attributes[n[i]]);var s="prepend"===r?"afterbegin":"beforeend";return o.insertAdjacentElement(s,e),e}}function y_(){return(y_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var E_,T_=["bottom","height","left","right","top","width"],S_=new Map,b_="undefined"!=typeof window?Qp.useLayoutEffect:Qp.useEffect;function A_(e,t){void 0===t&&(t={width:0,height:0});var n=Qp.useState(e.current),r=n[0],i=n[1],o=Qp.useReducer(w_,t),s=o[0],a=o[1],u=Qp.useRef(!1);return b_((function(){e.current!==r&&i(e.current)})),b_((function(){if(r&&!u.current){u.current=!0;var e=r.getBoundingClientRect();a({rect:e})}}),[r]),Qp.useEffect((function(){if(r){var e=function(e,t){return{observe:function(){var n=0===S_.size;S_.has(e)?S_.get(e).callbacks.push(t):S_.set(e,{rect:void 0,hasRectChanged:!1,callbacks:[t]}),n&&function e(){var t=[];S_.forEach((function(e,n){var r=n.getBoundingClientRect();(function(e,t){return void 0===e&&(e={}),void 0===t&&(t={}),T_.some((function(n){return e[n]!==t[n]}))})(r,e.rect)&&(e.rect=r,t.push(e))})),t.forEach((function(e){e.callbacks.forEach((function(t){return t(e.rect)}))})),E_=window.requestAnimationFrame(e)}()},unobserve:function(){var n=S_.get(e);if(n){var r=n.callbacks.indexOf(t);r>=0&&n.callbacks.splice(r,1),n.callbacks.length||S_.delete(e),S_.size||cancelAnimationFrame(E_)}}}}(r,(function(e){a({rect:e})}));return e.observe(),function(){e.unobserve()}}}),[r]),s}function w_(e,t){var n=t.rect;return e.height!==n.height||e.width!==n.width?n:e}var R_=function(){return 50},I_=function(e){return e},k_=function(e,t){return e[t?"offsetWidth":"offsetHeight"]},P_=function(e){for(var t=Math.max(e.start-e.overscan,0),n=Math.min(e.end+e.overscan,e.size-1),r=[],i=t;i<=n;i++)r.push(i);return r};function D_(e){var t,n=e.size,r=void 0===n?0:n,i=e.estimateSize,o=void 0===i?R_:i,s=e.overscan,a=void 0===s?1:s,u=e.paddingStart,c=void 0===u?0:u,l=e.paddingEnd,d=void 0===l?0:l,h=e.parentRef,f=e.horizontal,p=e.scrollToFn,_=e.useObserver,m=e.initialRect,v=e.onScrollElement,g=e.scrollOffsetFn,y=e.keyExtractor,E=void 0===y?I_:y,T=e.measureSize,S=void 0===T?k_:T,b=e.rangeExtractor,A=void 0===b?P_:b,w=f?"width":"height",R=f?"scrollLeft":"scrollTop",I=Qp.useRef({scrollOffset:0,measurements:[]}),k=Qp.useState(0),P=k[0],D=k[1];I.current.scrollOffset=P;var O=(_||A_)(h,m)[w];I.current.outerSize=O;var L=Qp.useCallback((function(e){h.current&&(h.current[R]=e)}),[h,R]),C=p||L;p=Qp.useCallback((function(e){C(e,L)}),[L,C]);var N=Qp.useState({}),M=N[0],x=N[1],U=Qp.useCallback((function(){return x({})}),[]),F=Qp.useRef([]),j=Qp.useMemo((function(){var e=F.current.length>0?Math.min.apply(Math,F.current):0;F.current=[];for(var t=I.current.measurements.slice(0,e),n=e;n<r;n++){var i=E(n),s=M[i],a=t[n-1]?t[n-1].end:c,u="number"==typeof s?s:o(n),l=a+u;t[n]={index:n,start:a,size:u,end:l,key:i}}return t}),[o,M,c,r,E]),V=((null==(t=j[r-1])?void 0:t.end)||c)+d;I.current.measurements=j,I.current.totalSize=V;var B=v?v.current:h.current,H=Qp.useRef(g);H.current=g,b_((function(){if(B){var e=function(e){var t=H.current?H.current(e):B[R];D(t)};return e(),B.addEventListener("scroll",e,{capture:!1,passive:!0}),function(){B.removeEventListener("scroll",e)}}D(0)}),[B,R]);var X=function(e){for(var t=e.measurements,n=e.outerSize,r=e.scrollOffset,i=t.length-1,o=function(e,t,n,r){for(;e<=t;){var i=(e+t)/2|0,o=n(i);if(o<r)e=i+1;else{if(!(o>r))return i;t=i-1}}return e>0?e-1:0}(0,i,(function(e){return t[e].start}),r),s=o;s<i&&t[s].end<r+n;)s++;return{start:o,end:s}}(I.current),q=X.start,W=X.end,G=Qp.useMemo((function(){return A({start:q,end:W,overscan:a,size:j.length})}),[q,W,a,j.length,A]),K=Qp.useRef(S);K.current=S;var Y=Qp.useMemo((function(){for(var e=[],t=function(t,n){var r=G[t],i=y_(y_({},j[r]),{},{measureRef:function(e){if(e){var t=K.current(e,f);if(t!==i.size){var n=I.current.scrollOffset;i.start<n&&L(n+(t-i.size)),F.current.push(r),x((function(e){var n;return y_(y_({},e),{},((n={})[i.key]=t,n))}))}}}});e.push(i)},n=0,r=G.length;n<r;n++)t(n);return e}),[G,L,f,j]),$=Qp.useRef(!1);b_((function(){$.current&&x({}),$.current=!0}),[o]);var z=Qp.useCallback((function(e,t){var n=(void 0===t?{}:t).align,r=void 0===n?"start":n,i=I.current,o=i.scrollOffset,s=i.outerSize;"auto"===r&&(r=e<=o?"start":e>=o+s?"end":"start"),"start"===r?p(e):"end"===r?p(e-s):"center"===r&&p(e-s/2)}),[p]),Q=Qp.useCallback((function(e,t){var n=void 0===t?{}:t,i=n.align,o=void 0===i?"auto":i,s=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(n,["align"]),a=I.current,u=a.measurements,c=a.scrollOffset,l=a.outerSize,d=u[Math.max(0,Math.min(e,r-1))];if(d){if("auto"===o)if(d.end>=c+l)o="end";else{if(!(d.start<=c))return;o="start"}var h="center"===o?d.start+d.size/2:"end"===o?d.end:d.start;z(h,y_({align:o},s))}}),[z,r]),J=Qp.useCallback((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Q.apply(void 0,t),requestAnimationFrame((function(){Q.apply(void 0,t)}))}),[Q]);return{virtualItems:Y,totalSize:V,scrollToOffset:z,scrollToIndex:J,measure:U}}export{Io as $,$u as A,Yu as B,fl as C,Qu as D,er as E,Ku as F,gd as G,Xu as H,qu as I,Ju as J,ec as K,ml as L,tc as M,yi as N,ic as O,Wu as P,Gu as Q,Zu as R,zu as S,Ti as T,Ai as U,vi as V,bi as W,su as X,ko as Y,Po as Z,Re as _,it as a,he as a$,Ro as a0,je as a1,En as a2,g as a3,Ad as a4,Ii as a5,Wd as a6,Gd as a7,Zd as a8,mh as a9,__ as aA,t_ as aB,Ep as aC,Rp as aD,pf as aE,ip as aF,jf as aG,mf as aH,Af as aI,Ff as aJ,Lt as aK,Up as aL,g_ as aM,xf as aN,Si as aO,xc as aP,Yn as aQ,Qn as aR,$n as aS,tt as aT,ll as aU,Ve as aV,Jd as aW,Be as aX,Ut as aY,D_ as aZ,np as a_,_h as aa,ci as ab,_l as ac,Qe as ad,yl as ae,Je as af,Ye as ag,pl as ah,Ic as ai,ot as aj,gh as ak,Th as al,Eh as am,jh as an,sf as ao,Jh as ap,uf as aq,$e as ar,Zf as as,Qf as at,tp as au,rp as av,sp as aw,r_ as ax,e_ as ay,Zp as az,qe as b,Ui as b0,Gr as c,nt as d,le as e,de as f,On as g,Pe as h,dl as i,Ae as j,ze as k,Al as l,ve as m,sd as n,_e as o,Vc as p,rt as q,kt as r,en as s,et as t,st as u,pe as v,bl as w,ht as x,ge as y,ud as z};
