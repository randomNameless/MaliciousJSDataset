!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.sophiAudienceSegmentation=t():e.sophiAudienceSegmentation=t()}(self,(()=>(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{allocateUser:()=>v,version:()=>i});var n="sophiTag",o="073a",r={USER_TYPE:n+".vatP",CLIENT_USER_ID:n+".uid",SOPHI_USER_ID:n+"id."+o,SOPHI_SESSION:n+"ses."+o},i="23.6.0",a="5,47.5,47.5".split(","),c=1,u=[];a.map((function(e){u.push({id:c,weightPercentage:parseFloat(e)}),c++}));var d=u;function s(e,t){var n,o,r,i,a,c,u,d;for(n=3&e.length,o=e.length-n,r=t,a=3432918353,c=461845907,d=0;d<o;)u=255&e.charCodeAt(d)|(255&e.charCodeAt(++d))<<8|(255&e.charCodeAt(++d))<<16|(255&e.charCodeAt(++d))<<24,++d,r=27492+(65535&(i=5*(65535&(r=(r^=u=(65535&(u=(u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295)<<15|u>>>17))*c+(((u>>>16)*c&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+((58964+(i>>>16)&65535)<<16);switch(u=0,n){case 3:u^=(255&e.charCodeAt(d+2))<<16;case 2:u^=(255&e.charCodeAt(d+1))<<8;case 1:r^=u=(65535&(u=(u=(65535&(u^=255&e.charCodeAt(d)))*a+(((u>>>16)*a&65535)<<16)&4294967295)<<15|u>>>17))*c+(((u>>>16)*c&65535)<<16)&4294967295}return r^=e.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0}var l=function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)},p=function(e,t,n){var o=window.location.hostname.replace("www.","."),r=["".concat(e,"=").concat(t),"expires=".concat(n),"domain=".concat(o),"path=/","SameSite=None","Secure"].join(";");window.document.cookie=r},f=function(e){if(!document.cookie)return"";var t=document.cookie.split("; ").find((function(t){return 0===t.indexOf(e)}));return t?t.split("=")[1]:""},h=function(e){var t;return window.localStorage&&(t=localStorage.getItem(e)),t||(t=f(e)),t&&"false"!==t?t:""},w=1e4;function g(e,t,n){var o,r,i,a,c,u,d,g,v,S,m=function(e){if(100!==e.map((function(e){return e.weightPercentage})).reduce((function(e,t){return e+t})))throw new Error("Total weight percentages must equal 100%");var t=0;return e.map((function(e){var n=t+e.weightPercentage*w/100,o={id:e.id,range_start:0===t?t:t+1,range_end:n};return t=n,o}))}(e),_=(o=t.CLIENT_USER_ID,window.sophi&&window.sophi.data&&window.sophi.data.visitor&&window.sophi.data.visitor.uid?window.sophi.data.visitor.uid:h(o)),y=function(e){if(window.sophi&&window.sophi.data&&window.sophi.data.visitor&&window.sophi.data.visitor.type)return window.sophi.data.visitor.type;var t=h(e);return["Anonymous","Registered","Subscribed"].includes(t)?t:""}(t.USER_TYPE),I=f(t.SOPHI_USER_ID).split(".")[0];return I||(r=t.SOPHI_USER_ID,i=t.SOPHI_SESSION,a=new Date,c=new Date(a.setTime(a.getTime()+18e5)).toUTCString(),u=new Date(a.setFullYear(a.getFullYear()+2)).toUTCString(),d=l(),g=l(),v=a.getTime(),S=[d,v,"1",v,v,g].join("."),f(r)||(p(r,S,u),p(i,"*",c)),I=d),function(e,t,n,o){var r=function(e){try{var t=null,n=new URL(window.location.href).searchParams.get("sophiVariant");if(null!==n){var o=parseInt(n);if(e.some((function(e){return e.id===o})))t=o,console.log("Sophi Segments: Assigned variant ".concat(o," based on URL override."));else{var r=e.map((function(e){return e.id})).join(", ");console.log("Sophi Segments: The provided test variant ".concat(o," is not valid. Variants in this test are: ").concat(r,"."))}}return t}catch(e){return null}}(e);if(null!==r)return r;var i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w,n=e/Math.pow(2,32);return parseInt(n*t,10)}(function(){return s(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}(function(e,t){var n=e.uid,o=e.userType;return"".concat(t).concat(n).concat(o)}({uid:n,userType:o},t)));return function(e,t){var n=null;return e.forEach((function(e){t>=e.range_start&&t<=e.range_end&&(n=e.id)})),n}(e,i)}(m,n,_||I,y)}var v=function(){return g(d,r,"mlive_ab4")};return t})()));